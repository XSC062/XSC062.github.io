<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>è¿‘æœŸæ‚é¢˜</title>
      <link href="/20250809/"/>
      <url>/20250809/</url>
      
        <content type="html"><![CDATA[<p>è¿™æ®µæ—¶é—´æ¯”èµ›çš„ä¸€äº›é¢˜ å’Œ nKessiã€duanyu è®²çš„é¢˜ç›®ã€‚å¤ªåè®¡æ•°ã€æ•°å­¦çš„åŸºæœ¬ä¸Šæ²¡åŠæ³•åšäº†ã€‚</p><span id="more"></span><hr /><h2 id="a.-å‡ºå…³">A. å‡ºå…³</h2><p><a href="http://222.180.160.110:61235/contest/6462/problem/1" class="uri">http://222.180.160.110:61235/contest/6462/problem/1</a></p><blockquote><p>ç»™å®š <span class="math inline">\(s\)</span>ï¼Œå¯¹äºä¸€ä¸ªç©ºä¸²ï¼Œä»»æ„åˆ©ç”¨ä¸‹åˆ—ä¸‰ç§æ“ä½œï¼Œä½¿å…¶å˜ä¸º <span class="math inline">\(s\)</span>ï¼Œæ±‚æœ€å°ä»£ä»·ï¼š</p><ol type="1"><li>åœ¨æœ«å°¾æ·»åŠ å­—ç¬¦ <span class="math inline">\(c\)</span>ï¼Œä»£ä»·ä¸º <span class="math inline">\(t_{0,c}\)</span>ï¼›</li><li>å¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²å¹¶ç²˜è´´åœ¨æœ«å°¾ï¼Œä»£ä»·ä¸º <span class="math inline">\(t_1\)</span>ï¼›</li><li>åˆ é™¤æœ«å°¾å­—ç¬¦ï¼Œä»£ä»·ä¸º <span class="math inline">\(t_2\)</span>ã€‚</li></ol><p><span class="math inline">\(|s|\le 10^6\)</span>ã€‚</p></blockquote><p>å¯ä»¥é¢„å¤„ç†å‡ºå¯¹äºæ¯ä¸ª <span class="math inline">\(i\)</span> ç»“å°¾ï¼Œæœ€å¤šå¯ä»¥å¤åˆ¶åˆ°å“ªä¸ªåœ°æ–¹ï¼Œå‘ç°è¦æ±‚ <span class="math inline">\(z_i=lcp(s_{1\dots n},s_{i+1\dots n})\)</span>ã€‚é‚£ä¹ˆä¸€ä¸ª <span class="math inline">\(i\)</span> çš„æœ€è¿œè½¬ç§»ç‚¹ <span class="math inline">\(r_i=i+z_{i+1}\)</span>ï¼Œç”¨å•è°ƒé˜Ÿåˆ—å°±èƒ½ç»´æŠ¤ï¼Œä¼š exkmp å°±èƒ½çº¿æ€§ï¼›</p><p>å¦åˆ™å¯ä»¥äºŒåˆ† + å“ˆå¸Œå¤šä¸ª logï¼Œåé¢ä¹Ÿæœ‰ç†ç”±å·æ‡’ç”¨ä¼˜å…ˆé˜Ÿåˆ—äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int p = 31;const int mod = 998244353;int main() &#123;    std::freopen(&quot;laozi.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;laozi.out&quot;, &quot;w&quot;, stdout);    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    std::string s;    std::cin &gt;&gt; s;    int n = (int)s.length(), t1, t2;    std::vector&lt;long long&gt; h(n + 1), base(n + 1);    std::vector&lt;int&gt; a(n + 1), t0(27), z(n + 1), r(n + 1);    base[0] = 1ll;    for (int i = 1; i &lt;= n; ++i) &#123;        a[i] = s[i - 1] - &#39;a&#39; + 1;        h[i] = (h[i - 1] * p + a[i]) % mod;        base[i] = base[i - 1] * p % mod;    &#125;    auto gethash = [&amp;](int l, int r) &#123;        return (h[r] - h[l - 1] * base[r - l + 1] % mod + mod) % mod;    &#125;;    for (int i = 1; i &lt;= n; ++i)        for (int l = 1, r = std::min(i - 1, n - i + 1), mid; l &lt;= r; ) &#123;            mid = (l + r) &gt;&gt; 1;            if (gethash(1, mid) == gethash(i, i + mid - 1))                z[i] = mid, l = mid + 1;            else                r = mid - 1;        &#125;    for (int i = 1; i &lt; n; ++i)        r[i] = i + std::min(i, z[i + 1]);    for (int i = 1; i &lt;= 26; ++i)        std::cin &gt;&gt; t0[i];    std::cin &gt;&gt; t1 &gt;&gt; t2;    std::vector&lt;long long&gt; f(n + 1);    std::priority_queue&lt;std::pair&lt;long long, int&gt; &gt; q;    for (int i = 1; i &lt;= n; ++i) &#123;        f[i] = f[i - 1] + t0[a[i]];        for (; !q.empty() &amp;&amp; r[q.top().second] &lt; i; q.pop());        if (!q.empty())            f[i] = std::min(f[i], t1 - q.top().first - (long long)t2 * i);        if (i != n)            q.emplace(-(f[i] + 2ll * t2 * i), i);    &#125;    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d.-éæ”»">D. éæ”»</h2><p><a href="http://222.180.160.110:61235/contest/6462/problem/4" class="uri">http://222.180.160.110:61235/contest/6462/problem/4</a></p><blockquote><p>ç»™å®š <span class="math inline">\(n\)</span>ï¼Œå¯¹äºä¸€ä¸ª <span class="math inline">\(1\sim n\)</span> çš„æ’åˆ—ï¼Œä½¿ç”¨æœ€å°çš„äº¤æ¢æ¬¡æ•°ä½¿å¾—å…¶å•å¢ã€‚åœ¨è¯¥å‰æä¸‹ï¼Œå®šä¹‰ä»£ä»·ä¸ºæ¯æ¬¡äº¤æ¢çš„ä¸¤ä¸ªæ•°ä¹‹ç§¯ã€‚å¯¹äºæ‰€æœ‰ <span class="math inline">\(n!\)</span> ä¸ªæ’åˆ—ï¼Œè®¡ç®—æœ€å°ä»£ä»·ä¹‹å’Œã€‚</p><p><span class="math inline">\(n\le 10^7\)</span>ã€‚</p></blockquote><p>è½¬åŒ–æˆï¼ŒæŠŠ <span class="math inline">\(1\sim n\)</span> åˆ†æˆæ— æ ‡å·çš„è‹¥å¹²ç»„ï¼Œæ¯ç»„çš„ä»£ä»·æ˜¯ æœ€å°å€¼ <span class="math inline">\(\times\)</span> å…¶ä»–å…ƒç´ çš„å’Œï¼Œè¿˜æœ‰ä¸€ä¸ªé¡¹é“¾é—®é¢˜çš„ç³»æ•°ï¼Œå‘ç°ç»„é—´çš„ç¬¦å·æ˜¯æ±‚å’Œï¼Œè€ƒè™‘è®¡ç®—è´¡çŒ®ã€‚</p><p>æšä¸¾ <span class="math inline">\(i,j\)</span> å¹¶é’¦å®šä¸¤ä¸ªåŒå±ä¸€ä¸ªç¯ï¼Œä¸” <span class="math inline">\(i\)</span> ä¸ºæœ€å°å€¼ï¼Œæšä¸¾ç¯å¤§å° <span class="math inline">\(s+2\)</span>ï¼Œé‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[\begin{aligned}res&amp;=\sum_{i=1}^{n-1}\sum_{j=i+1}^n i\cdot j \cdot \sum_{s=0}^{n-i-1}\binom{n-i-1}s \cdot (s+1)!\cdot (n-s-2)!\\&amp;=\sum_{i=1}^{n-1}i\cdot \dfrac {(i+n+1)(n-i)}2 \cdot \sum_{s=0}^{n-i-1}\binom{n-i-1}s\cdot (s+1)!\cdot (n-s-2)!\\&amp;=\frac 12\times\sum_{i=1}^{n-1}i\cdot (i+n+1)\cdot (n-i)!\cdot\sum_{s=0}^{n-i-1}\dfrac {(s + 1)\cdot (n-s-2)!}{(n-i-1-s)!}\\\end{aligned}\]</span></p><p>ä»¤ <span class="math inline">\(T=n-i-1\)</span>ï¼Œå‘ç°æˆ‘ä»¬éœ€è¦å¿«é€Ÿè®¡ç®— <span class="math inline">\(f_T=\sum\limits_{i=0}^T \dfrac{(i+1)\cdot (n-i-2)!}{(T-i)!}\)</span>ã€‚è®° <span class="math inline">\(m=n-2\)</span>ï¼Œå˜å½¢å¾— <span class="math inline">\(f_T=(m-T)!\cdot \sum\limits_{i=0}^{T} (i+1) \binom{m-i}{m-T}\)</span>ï¼Œå‘ç°ä¼¼ä¹å¯ä»¥ç®€åŒ–ï¼Œä»¤ <span class="math inline">\(k=m-T,t=T+1\)</span>ï¼Œåˆ™ <span class="math inline">\(f_T=\sum\limits_{i=1}^T i\cdot \binom {k+t-i}k\)</span>ã€‚</p><p>ç„¶åæ˜¯ç»å…¸çš„ç»„åˆæ„ä¹‰ä¿å¹³å®‰ç¯èŠ‚ï¼Œå³ä» <span class="math inline">\(k+t\)</span> ä¸ªæœ‰æ ‡å·å°çƒä¸­é€‰æ‹©ä¸€æ¡åˆ†ç•Œçº¿ï¼Œåˆ†ç•Œçº¿å·¦è¾¹é€‰ä¸€ä¸ªçƒã€å³è¾¹é€‰ <span class="math inline">\(k\)</span> ä¸ªçƒçš„æ–¹æ¡ˆæ•°ã€‚å‘ç°åˆ†ç•Œçº¿çš„å­˜åœ¨å¾ˆè¯¡å¼‚ï¼Œæ•…ç”¨åˆ†ç•Œçº¿åæ–¹çš„ç¬¬ä¸€ä¸ªçƒä»£æ›¿ï¼Œåœ¨ <span class="math inline">\(t+1\)</span> å¤„æ–°å»ºä¸€ä¸ªè™šçƒï¼Œè§„å®šåœ¨å‰ <span class="math inline">\(t+1\)</span> ä¸ªçƒä¸­é€‰ä¸¤ä¸ªçƒï¼Œå¹¶ä»¤åä¸€ä¸ªä¸ºåˆ†ç•Œçº¿ï¼Œä¸”ä»¤å‰ <span class="math inline">\(t+1\)</span> ä¸ªä¸­çš„å…¶ä»–çƒä¸ºå®çƒï¼Œå°±èƒ½å»ºç«‹åŒå°„ã€‚åœ¨åˆ†ç•Œçº¿åå†é€‰ <span class="math inline">\(k\)</span> ä¸ªçƒï¼Œå®¹æ˜“å‘ç°ç›´æ¥åœ¨èŒƒå›´å†…é€‰ <span class="math inline">\(k+2\)</span> ä¸ªçƒå°±èƒ½æ»¡è¶³æ¡ä»¶ï¼Œæ•… <span class="math inline">\(f_T=(n-T-2)!\cdot \binom{t+k+1}{k+2}\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    std::freopen(&quot;mozi.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;mozi.out&quot;, &quot;w&quot;, stdout);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1), f(n + 1);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= n; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [&amp;](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[n] = qkp(fac[n], mod - 2);    for (int i = n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    int m = n - 2;    for (int T = 0; T &lt;= n - 2; ++T) &#123;        int k = m - T, t = T + 1;        f[T] = C(t + k + 1, k + 2) * fac[m - T] % mod;    &#125;    auto res = 0ll;    for (int i = 1; i &lt;= n - 1; ++i)        (res += (long long)i * (i + n + 1) % mod * fac[n - i] % mod * f[n - i - 1] % mod) %= mod;    std::cout &lt;&lt; res * inv[2] % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---destruction-of-walls">C - Destruction of Walls</h2><p><a href="https://atcoder.jp/contests/arc203/tasks/arc203_c" class="uri">https://atcoder.jp/contests/arc203/tasks/arc203_c</a></p><hr /><h2 id="d---insert-xor">D - Insert XOR</h2><p><a href="https://atcoder.jp/contests/arc203/tasks/arc203_d" class="uri">https://atcoder.jp/contests/arc203/tasks/arc203_d</a></p><hr /><h2 id="a---è®°å¿†">A - è®°å¿†</h2><p><a href="https://ac.nowcoder.com/acm/problem/274793" class="uri">https://ac.nowcoder.com/acm/problem/274793</a></p><p>éœ€è¦æ„è¯†åˆ°é—®é¢˜æ˜¯é™æ€çš„ï¼Œå¹¶ä¸”ä¸èƒ½ç”¨çº¿æ®µæ ‘ä¹‹ç±»ç»´æŠ¤ï¼›æ•…è€ƒè™‘ç¦»çº¿ä¸‹æ¥ï¼Œæƒ³åŠæ³•åœ¨ LCA å¤„ç»Ÿè®¡ç­”æ¡ˆã€‚</p><p>è¿™ä¸ªæ—¶å€™å‘ç°éœ€è¦åˆå¹¶å­æ ‘çŠ¶æ€ã€æ•´ä½“å¼‚æˆ–ã€æ•´ä½“ +1ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° Trieã€‚æŠŠ <span class="math inline">\(u\to\)</span> LCA çš„ç­”æ¡ˆä¿å­˜åœ¨ LCA å¤„ï¼Œç„¶åå†ç”¨ DFS + å›æº¯ç»Ÿè®¡ LCA <span class="math inline">\(\to v\)</span> çš„ç­”æ¡ˆã€‚æƒ³äº†åŠå¤©æ²¡æƒ³åˆ°æŠŠä¸Šä¸‹æ‹†å¼€æ¥åšä¹Ÿæ˜¯ç¥äº† ğŸ˜…</p><p>å¯èƒ½æ¯”è¾ƒè€ƒéªŒå¯¹å­—å…¸æ ‘çš„ç†è§£ï¼Ÿåšä¸ªæ¯”å–»ï¼Œå­—å…¸æ ‘çš„ id å°±ç›¸å½“äºå¯¹è¿™ä¸ªç‚¹ä¸Šä¿¡æ¯çš„ã€å¼•ç”¨ã€ã€‚</p><details><p>å­—å…¸æ ‘åˆå¹¶çš„æ—¶å€™å¯ä»¥è€ƒè™‘å›æ”¶åºŸå¼ƒç‚¹ï¼Œä¸ç„¶å¯èƒ½æœ‰ç‚¹å¡ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int X = 50;const int maxn = 2e7 + 5;long long d[maxn];int tot, T[maxn][2], f[maxn], fa[maxn];#define lc(p) T[p][0]#define rc(p) T[p][1]int find(int x) &#123; return x == f[x] ? x : f[x] = find(f[x]); &#125;int newnode(void) &#123;    int p = ++tot;    assert(p &lt; maxn);    d[p] = lc(p) = rc(p) = 0, f[p] = p;    return p;&#125;void pushdown(int p) &#123;    if (d[p]) &#123;        if (d[p] &amp; 1)            std::swap(lc(p), rc(p));        d[p] &gt;&gt;= 1;        if (lc(p))            d[lc(p)] ^= d[p];        if (rc(p))            d[rc(p)] ^= d[p];        d[p] = 0;    &#125;    return;&#125;int ins(int p, long long x) &#123;    for (int i = 0; i &lt; X; ++i) &#123;        pushdown(p);        if (!T[p][(x &gt;&gt; i) &amp; 1]) &#123;            T[p][(x &gt;&gt; i) &amp; 1] = newnode();            fa[T[p][(x &gt;&gt; i) &amp; 1]] = p;        &#125;        p = T[p][(x &gt;&gt; i) &amp; 1];    &#125;    return p;&#125;void merge(int &amp;p, int q) &#123;    if (!q)        return;    if (!p) &#123;        p = q;        return;    &#125;    pushdown(p), pushdown(q);    fa[lc(q)] = p, fa[rc(q)] = p;    merge(lc(p), lc(q)), merge(rc(p), rc(q));    assert(f[p] == p), assert(f[q] == q), f[q] = p;    return;&#125;long long ask(int p) &#123;    std::vector&lt;int&gt; st;    for (int i = 0, j = p; i &lt; X; ++i)        st.push_back(fa[j]), j = fa[j];    for (int i = 0; i &lt; X; ++i)        pushdown(st.back()), st.pop_back();    long long x = 0;    for (int i = 0; i &lt; X; ++i) &#123;        x = x * 2 + (p == rc(fa[p]));        p = fa[p];    &#125;    return x;&#125;void add(int p) &#123;    for (int i = 0; p &amp;&amp; i &lt; X; ++i) &#123;        pushdown(p);        std::swap(lc(p), rc(p));        p = lc(p);    &#125;    return;&#125;void del(int p) &#123;    for (int i = 0; p &amp;&amp; i &lt; X; ++i) &#123;        pushdown(p);        std::swap(lc(p), rc(p));        p = rc(p);    &#125;    return;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; siz(n + 1), son(n + 1), top(n + 1), fa(n + 1), dep(n + 1);    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        siz[x] = 1;        for (auto i : g[x])            if (i != fa[x]) &#123;                dep[i] = dep[x] + 1;                fa[i] = x, DFS(i);                siz[x] += siz[i];                if (siz[i] &gt; siz[son[x]])                    son[x] = i;            &#125;        return;    &#125;;    DFS(1);    DFS = [&amp;](int x) &#123;        if (son[x])            top[son[x]] = top[x], DFS(son[x]);        for (auto i : g[x])            if (i != son[x] &amp;&amp; i != fa[x])                top[i] = i, DFS(i);        return;    &#125;;    top[1] = 1, DFS(1);    auto askLCA = [&amp;](int x, int y) &#123;        for (; top[x] != top[y]; x = fa[top[x]])            if (dep[top[x]] &lt; dep[top[y]])                std::swap(x, y);        return dep[x] &lt; dep[y] ? x : y;    &#125;;    struct node &#123; long long x; int u, v; &#125;;    std::vector&lt;node&gt; q(m + 1);    std::vector&lt;int&gt; id(m + 1);    std::vector&lt;long long&gt; res(m + 1), ans(m + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; up(n + 1), dn(n + 1), ed(n + 1);    for (int i = 1, x, u, v; i &lt;= m; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; u &gt;&gt; v;        q[i] = &#123; x, u, v &#125;;        up[u].push_back(i), dn[askLCA(u, v)].push_back(i), ed[v].push_back(i);    &#125;    std::vector&lt;int&gt; rt(n + 1);    DFS = [&amp;](int x) &#123;        rt[x] = newnode();        for (auto i : g[x])            if (i != fa[x]) &#123;                DFS(i);                merge(rt[x], rt[i]);            &#125;        add(rt[x]);        for (auto i : up[x])            id[i] = ins(rt[x], q[i].x);        d[rt[x]] ^= a[x];        for (auto i : dn[x])            res[i] = ask(find(id[i]));        return;    &#125;;    DFS(1);    tot = 0, rt[0] = newnode();    std::fill(id.begin() + 1, id.end(), 0);    DFS = [&amp;](int x) &#123;        d[rt[0]] ^= a[x];        for (auto i : dn[x])            id[i] = ins(rt[0], res[i]);        for (auto i : ed[x])            ans[i] = ask(id[i]);        add(rt[0]);        for (auto i : g[x])            if (i != fa[x])                DFS(i);        del(rt[0]);        d[rt[0]] ^= a[x];        return;    &#125;;    DFS(1);    for (int i = 1; i &lt;= m; ++i)        std::cout &lt;&lt; ans[i] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ-2-meetings-2">B - ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ 2 (Meetings 2)</h2><p><a href="https://www.luogu.com.cn/problem/AT_joisc2021_j" class="uri">https://www.luogu.com.cn/problem/AT_joisc2021_j</a></p><p>å®šä¹‰æ‰€æ±‚ç‚¹ä¸ºã€å±€éƒ¨é‡å¿ƒã€ï¼›ç±»ä¼¼æ ‘çš„é‡å¿ƒï¼Œå®¹æ˜“å‘ç°å½“å…³é”®ç‚¹æ•°é‡ä¸ºå¥‡æ—¶ï¼Œåªå­˜åœ¨ä¸€ä¸ªå±€éƒ¨é‡å¿ƒï¼›å¦åˆ™ï¼Œå±€éƒ¨é‡å¿ƒç»„æˆä¸€æ¡é“¾ã€‚</p><p>å³å¯¹äºæ¯ä¸€ä¸ª <span class="math inline">\(i\)</span>ï¼Œéœ€è¦æ‰¾åˆ°ä¸€æ¡æœ€é•¿é“¾ï¼Œä½¿å¾—å…¶ä¸¤ç«¯å­˜åœ¨å¤§å°ä¸º <span class="math inline">\(i\)</span> çš„å­æ ‘ï¼ˆå®¹æ˜“å‘ç°å–åç¼€ max å³å¯å¾—åˆ°çœŸå®ç­”æ¡ˆï¼‰ã€‚ä½¿ç”¨ç‚¹åˆ†æ²»ï¼Œç²¾ç»†å®ç°å®¹æ˜“åšåˆ° <span class="math inline">\(O(n\log n)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; mx(n + 1), siz(n + 1), p, tag(n + 1), res(n + 1, 1);    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int fa) &#123;        p.push_back(x);        siz[x] = 1, mx[x] = 0;        for (auto i : g[x])            if (!tag[i] &amp;&amp; i != fa) &#123;                DFS1(i, x);                siz[x] += siz[i];                mx[x] = std::max(mx[x], siz[i]);            &#125;        return;    &#125;;    auto findrt = [&amp;](int x) &#123;        p.clear(), DFS1(x, -1);        int n = (int)p.size();        for (auto i : p)            if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)                return i;        assert(0);        return -1;    &#125;;    struct node &#123;        int u1, u2, id1, id2;        node(): u1(0), u2(0), id1(0), id2(0) &#123;&#125;        void upd(int u, int id) &#123;            if (id1 == id)                u1 = std::max(u1, u);            else if (u &gt;= u1)                u2 = u1, id2 = id1, u1 = u, id1 = id;            else if (u &gt;= u2)                u2 = u, id2 = id;            return;        &#125;    &#125;;    std::vector&lt;node&gt; s(n + 1);    std::function&lt;void(int, int, int, int)&gt; DFS2 = [&amp;](int x, int fa, int dep, int anc) &#123;        s[siz[x]].upd(dep, anc);        for (auto i : g[x])            if (!tag[i] &amp;&amp; i != fa)                DFS2(i, x, dep + 1, anc);        return;    &#125;;    std::function&lt;void(int, int, int, int)&gt; DFS3 = [&amp;](int x, int fa, int dep, int anc) &#123;        int v = ((s[siz[x]].id1 == anc) ? s[siz[x]].u2 : s[siz[x]].u1);        res[2 * siz[x]] = std::max(res[2 * siz[x]], dep + 1 + v);        for (auto i : g[x])            if (!tag[i] &amp;&amp; i != fa)                DFS3(i, x, dep + 1, anc);        return;    &#125;;    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        x = findrt(x), p.clear(), DFS1(x, -1);        // printf(&quot;rt = %d\n&quot;, x);        for (auto i : g[x])            if (!tag[i])                DFS2(i, x, 1, i);        for (int i = siz[x] - 1; i; --i) &#123;            s[i].upd(s[i + 1].u1, s[i + 1].id1);            s[i].upd(s[i + 1].u2, s[i + 1].id2);        &#125;        for (auto i : g[x])            if (!tag[i])                DFS3(i, x, 1, i);        tag[x] = 1;        for (int i = 1; i &lt; siz[x]; ++i)            s[i] = node();        for (auto i : g[x])            if (!tag[i])                DFS(i);        return;    &#125;;    DFS(1);    for (int i = (n &gt;&gt; 1) * 2; i; --i)        if (i + 2 &lt;= n)            res[i] = std::max(res[i], res[i + 2]);    for (int i = 1; i &lt;= n; ++i)        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---the-closest-pair">C - The Closest Pair</h2><p><a href="https://ac.nowcoder.com/acm/problem/262593" class="uri">https://ac.nowcoder.com/acm/problem/262593</a></p><p><strong>å¸¸è§„æ–¹æ³•</strong>ï¼šè€ƒè™‘<strong>æ”¯é…å¯¹</strong>ï¼Œå¯¹äºæ¯ä¸ª <span class="math inline">\(a_i\)</span>ï¼Œæ‰¾åˆ°æ‰€æœ‰åˆæ³•çš„ <span class="math inline">\(a_j\)</span>ã€‚å®¹æ˜“æƒ³åˆ°æšä¸¾ <span class="math inline">\(a_i\div a_j\)</span> æ¥åšï¼›å‡è®¾å­˜åœ¨ <span class="math inline">\(a_k\div a_i=a_j\div a_i\)</span> ä¸” <span class="math inline">\(k&gt;j\)</span>ã€‚</p><p>ä¸å¦¨è®¾ <span class="math inline">\(a_j=K\cdot a_i+p,a_k=K\cdot a_i+q\)</span>ï¼Œ<span class="math inline">\((a_i,a_j),(a_i,a_k)\)</span> å‡åˆæ³•å½“ä¸”ä»…å½“ä¸‹åˆ—æ¡ä»¶å…¨éƒ¨æˆç«‹ï¼š</p><ul><li><span class="math inline">\(a_j\bmod a_i&gt;a_k\bmod a_i\)</span>ï¼› åˆ™ <span class="math inline">\(a_j&gt;a_k\)</span>ã€‚</li><li><span class="math inline">\(a_j\bmod a_k&gt;a_k\bmod a_i\)</span>ï¼›åˆ <span class="math inline">\(p-q\ge a_j\bmod a_k\)</span>ï¼ˆ<strong>å¤ªç‰›äº†è¿™ä¸€æ­¥</strong>ï¼‰ï¼Œå³ <span class="math inline">\(p-q&gt;q\iff p&gt;2q\)</span>ã€‚</li></ul><p>è¯å¾—åªå…³å¿ƒåŒä¸€ä¸ª <span class="math inline">\(a_j\div a_i\)</span> æ—¶çš„æ”¯é…å¯¹æ•°é‡ä¸º <span class="math inline">\(\log n\)</span> çº§åˆ«ï¼›æ€»å¯¹æ•° <span class="math inline">\(O(n\log n\ln n)\)</span>ã€‚ç¦»çº¿ä¸‹æ¥æ‰«æçº¿å°±è¡Œäº†ã€‚</p><details><p>å¯¹ç€ å•ç‚¹ä¿®æ”¹ åŒºé—´æœ€å€¼ æƒ³äº† 1h çš„å• log åšæ³• ğŸ˜° æœç„¶å°è„‘æ‰çº¿å¤ªå¯æ€•äº†ï¼Œç¬¬äºŒå¤©æ—©ä¸Šé‡ç½®å¤§è„‘ 1s å‘ç°è‡ªå·±æ˜¯æ–¯æ³¢ ğŸ˜“</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int LEN = (1 &lt;&lt; 20);int nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF;        p = buf;    &#125;    return *p++;&#125;bool read(int &amp;x) &#123;    x = 0;    bool f = 0;    char ch = nec();    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;void print(int x) &#123;    if (x &lt; 0)        putchar(&#39;-&#39;), x = -x;    if (x &gt;= 10) print(x / 10);    putchar(x % 10 + &#39;0&#39;);    return;&#125;void print(int x, char ch) &#123;    print(x), putchar(ch);    return;&#125;const int maxn = 4e6 + 5;struct &#123; int l, r, u[2]; &#125; t[maxn];#define lt (t[p].l)#define rt (t[p].r)int tot[2];void add(int &amp;p, int l, int r, int x, int v, int i) &#123;    if (!p)        p = ++tot[i], t[p].u[0] = -1, t[p].u[1] = 0x3f3f3f3f;    if (i == 0)        t[p].u[0] = std::max(t[p].u[0], v);    else        t[p].u[1] = std::min(t[p].u[1], v);    if (l == r)        return;    int mid = (l + r) &gt;&gt; 1;    if (x &lt;= mid)        add(lt, l, mid, x, v, i);    else        add(rt, mid + 1, r, x, v, i);    return;&#125;int ask(int p, int l, int r, int ql, int qr, int i) &#123;    if (!p || (ql &lt;= l &amp;&amp; r &lt;= qr))        return t[p].u[i];    int mid = (l + r) &gt;&gt; 1;    if (qr &lt;= mid)        return ask(lt, l, mid, ql, qr, i);    if (ql &gt; mid)        return ask(rt, mid + 1, r, ql, qr, i);    if (i == 0)        return std::max(ask(lt, l, mid, ql, qr, 0), ask(rt, mid + 1, r, ql, qr, 0));    return std::min(ask(lt, l, mid, ql, qr, 1), ask(rt, mid + 1, r, ql, qr, 1));&#125;#undef lt#undef rtint main() &#123;#ifndef ONLINE_JUDGE    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);    const auto stime = std::chrono::steady_clock::now();#endif    const int m = 1e6;    int rt[2] = &#123; 0 &#125;, n;    t[0].u[0] = -1, t[0].u[1] = 0x3f3f3f3f;    read(n);    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        read(a[i]);    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; t(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        if (i != 1) &#123;            for (int K = a[i]; K &lt;= m; K += a[i]) &#123;                for (int mx = std::min(a[i] - 1, m - K); ; ) &#123;                    int k = ask(rt[0], 1, m, K, K + mx, 0);                    if (k == -1)                        break;                    t[i].emplace_back(k, a[k] - K);                    if (k == 1 || !(a[k] - K))                        break;                    mx = (a[k] - K - 1) / 2;                &#125;            &#125;        &#125;        add(rt[0], 1, m, a[i], i, 0);    &#125;    for (int i = n; i; --i) &#123;        if (i != n)            for (int K = a[i]; K &lt;= m; K += a[i])                for (int mx = std::min(a[i] - 1, m - K); ; ) &#123;                    int k = ask(rt[1], 1, m, K, K + mx, 1);                    if (k == 0x3f3f3f3f)                        break;                    t[k].emplace_back(i, a[k] - K);                    if (k == n || !(a[k] - K))                        break;                    mx = (a[k] - K - 1) / 2;                &#125;        add(rt[1], 1, m, a[i], i, 1);    &#125;    int q;    read(q);    std::vector&lt;int&gt; res(q + 1);    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; u(n + 1);    for (int i = 1, l, r; i &lt;= q; ++i) &#123;        read(l), read(r);        if (l &gt; r)            std::swap(l, r);        u[r].emplace_back(l, i);    &#125;    std::vector&lt;int&gt; bit(n + 1, 0x3f3f3f3f);    auto lowbit = [&amp;](int x) &#123; return x &amp; -x; &#125;;    auto add = [&amp;](int x, int v) &#123;        for (; x &lt;= n; x += lowbit(x))            bit[x] = std::min(bit[x], v);        return;    &#125;;    auto ask = [&amp;](int x) &#123;        auto res = 0x3f3f3f3f;        for (; x; x -= lowbit(x))            res = std::min(res, bit[x]);        return res;    &#125;;    for (int r = 1; r &lt;= n; ++r) &#123;        for (auto [l, v] : t[r])            add(n - l + 1, v);        for (auto [l, i] : u[r])            res[i] = ask(n - l + 1);    &#125;    for (int i = 1; i &lt;= q; ++i)        print(res[i], &#39;\n&#39;);#ifndef ONLINE_JUDGE    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\n&quot;;#endif    return 0;&#125;</code></pre></details><p>æ±‚æ”¯é…å¯¹çš„è¿‡ç¨‹ä¹Ÿè¦å¸¦ logï¼ˆçº¿æ®µæ ‘ï¼‰ï¼Œå†åŠ ä¸Šæ‰«æçº¿çš„ 3logï¼Œæ€»å…±æ˜¯å¸¸æ•°æ¯”è¾ƒå¤§çš„ 3logï¼ˆå¡äº†ä¸€ä¸ªä¸Šåˆçš„å¸¸ä¹Ÿæ˜¯æœ‰äº†ï¼‰ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è®²è§£å¦ä¸€ç§å¥‡æŠ€æ·«å·§ã€‚</p><p><strong>æš´åŠ›åˆ†æ²»</strong>ï¼šæ³¨æ„åˆ°å¯¹äºæ¯”è¾ƒé•¿ï¼ˆ<span class="math inline">\(len&gt; B\)</span>ï¼‰çš„åŒºé—´ï¼Œç­”æ¡ˆæ¯”è¾ƒå°ï¼›æ•…è€ƒè™‘åˆ†æ²»ã€‚</p><ul><li>å¯¹äºé•¿è¯¢é—®ï¼ˆ<span class="math inline">\(len&gt;B\)</span>ï¼‰ï¼Œä»å°åˆ°å¤§æšä¸¾ç­”æ¡ˆå¹¶ checkï¼›é¢„å¤„ç†æŸä¸ªèŒƒå›´ï¼ˆ<span class="math inline">\(V\)</span>ï¼‰å†…çš„ <span class="math inline">\(res\)</span> å‡ºç°çš„æ‰€æœ‰ä½ç½®ï¼Œå¹³è¡¡çš„æ—¶å€™è¿˜è¦ç®—ä¸Šè°ƒå’Œçº§æ•°å’Œ bitã€‚</li><li>å¯¹äºçŸ­è¯¢é—®ï¼ˆ<span class="math inline">\(len\le B\)</span>ï¼‰ï¼Œå‘ç°æ¯æ¬¡åŒºé—´å†…æš´åŠ›æ˜¯ <span class="math inline">\(O(B^2q)\)</span> çš„ï¼›æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥ï¼Œç²¾ç»†å®ç°ï¼Œåˆ©ç”¨è¯¢é—®çš„å…¬å…±éƒ¨åˆ†ä½¿å¾—<strong>æ¯ä¸€å¯¹æ•°åªè¢«æšä¸¾ä¸€æ¬¡</strong>å°±èƒ½è¾¾åˆ° <span class="math inline">\(O(B^2 + Bq)\)</span>ã€‚</li></ul><p>æœ€ä¼˜è§£å– <span class="math inline">\(B=333,V=483\)</span>ï¼Œä¸è‡ªå·±å®ç°ä¸€éäº†ã€‚</p><hr /><h2 id="d---ä»™äººæŒ">D - ä»™äººæŒ</h2><p><a href="https://www.luogu.com.cn/problem/P3687" class="uri">https://www.luogu.com.cn/problem/P3687</a></p><p>æŠŠè¾¹åŒä»å›¾ä¸­åˆ é™¤ã€é—®é¢˜è½¬åŒ–ä¸ºæ ‘ä¸Š<strong>è¾¹</strong>ä¸äº¤çš„é“¾è¦†ç›–ï¼Œä½¿å¾—<strong>æ‰€æœ‰é“¾é•¿ <span class="math inline">\(\ge 2\)</span></strong> çš„æ–¹æ¡ˆæ•°ã€‚å‘ç°ç”±äº<strong>è¾¹å¯ä»¥ä¸è¢«è¦†ç›–</strong>ï¼Œå¸¸è§„ DP ä¼šä½¿å¾—åœ¨çˆ¶èŠ‚ç‚¹å¤„åˆå¹¶æ—¶éœ€è¦é¢å¤–çš„æ•°é‡ç»´ï¼Œå‚è€ƒæ ‘ä¸ŠèƒŒåŒ…ï¼Œå¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ã€‚</p><p>æ€è€ƒæ—¶ä¼šæ³¨æ„åˆ°ä¸¤ä¸ªé™åˆ¶å¯ä»¥æŠµæ¶ˆâ€”â€”å¦‚æœè®¤ä¸ºé•¿ä¸º <span class="math inline">\(1\)</span> çš„é“¾å°±æ˜¯ä¸è¢«è¦†ç›–çš„è¾¹ï¼Œè¦†ç›–æ‰€æœ‰æ ‘è¾¹ï¼Œæ˜¾ç„¶å¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚æ­¤æ—¶åˆå¹¶æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œæ³¨æ„åˆ°æ¯ä¸ªå„¿å­çš„ç³»æ•°ä¸€å®šéƒ½å‚ä¸ã€åˆ†æ­¥ã€ï¼Œåªéœ€è¦æ±‚å‡ºã€åˆ†ç±»ã€çš„ç³»æ•°ã€‚è¿™ä¸ªå¯ä»¥é¢„å¤„ç†ï¼ˆå’Œ <a href="/20250407/#a.-äºŒåˆ†å›¾æŸ“è‰²">äºŒåˆ†å›¾æŸ“è‰²</a> è¿™ä¸ªé¢˜æœ‰ç‚¹åƒï¼‰ï¼Œä»¤ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºä¸€ä¸ªç‚¹åº¦æ•°ä¸º <span class="math inline">\(i\)</span> æ—¶çš„ç­”æ¡ˆï¼Œå‚è€ƒé”™æ’çš„æ€è·¯ï¼Œåˆ™ <span class="math inline">\(i\)</span> å¯ä»¥ä¸å‚ä¸é…å¯¹ï¼Œä¹Ÿå¯ä»¥ä¹±é€‰ä¸€ä¸ªç‚¹é…å¯¹ï¼Œå¦‚æœé€‰ä¸­äº†å·²é…å¯¹çš„ç‚¹å°±ä»¤å…¶å’Œ <span class="math inline">\(i-1\)</span> äº¤æ¢ï¼Œå¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚åˆ™ <span class="math inline">\(f_i=f_{i-1}+(n-1)f_{i-2}\)</span>ã€‚</p><p>é¦–å…ˆéœ€è¦ check åŸå›¾æ˜¯å¦ä¸ºä»™äººæŒï¼Œé¡ºå¸¦å›å¿†ä¸€ä¸‹è¿é€šæ€§çš„çŸ¥è¯†â€”â€”åœ¨ DFS æ ‘ä¸Šå·®åˆ†ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰è¾¹è¢«è¦†ç›–ä¸¤æ¬¡å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);    const auto stime = std::chrono::steady_clock::now();#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n, m;        std::cin &gt;&gt; n &gt;&gt; m;        std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);        for (int x, y; m--; ) &#123;            std::cin &gt;&gt; x &gt;&gt; y;            g1[x].push_back(y), g1[y].push_back(x);        &#125;        bool flag = 1;        int now = 0, cnt = 0;        std::vector&lt;int&gt; st, dfn(n + 1), low(n + 1), col(n + 1), diff(n + 1);        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;            st.push_back(x);            dfn[x] = low[x] = ++now;            for (auto i : g1[x])                if (!dfn[i]) &#123;                    // printf(&quot;x = %d, %d -&gt; %d\n&quot;, x, x, i);                    DFS(i, x);                    diff[x] += diff[i];                    // printf(&quot;x = %d, diff[%d] += diff[%d]\n&quot;, x, x, i);                    low[x] = std::min(low[x], low[i]);                &#125;                else if (i != fa &amp;&amp; dfn[i] &lt; dfn[x]) &#123;                    low[x] = std::min(low[x], dfn[i]);                    ++diff[x], --diff[i];                    // printf(&quot;x = %d, ++diff[%d], --diff[%d]\n&quot;, x, x, i);                &#125;            if (diff[x] &gt;= 2)                flag = 0;            // printf(&quot;x = %d, diff[%d] = %d\n&quot;, x, x, diff[x]);            if (low[x] == dfn[x]) &#123;                ++cnt;                for (int p = -1; p != x; ) &#123;                    p = st.back(), st.pop_back();                    col[p] = cnt;                &#125;            &#125;            return;        &#125;;        DFS(1, -1);        if (!flag) &#123;            std::cout &lt;&lt; 0 &lt;&lt; &#39;\n&#39;;            continue;        &#125;        std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);        for (int i = 1; i &lt;= n; ++i)            for (auto j : g1[i])                if (col[i] != col[j])                    g[i].push_back(j);        std::vector&lt;long long&gt; f(n + 1), dp(n + 1);        dp[0] = 1ll, dp[1] = 1ll;        for (int i = 2; i &lt;= n; ++i)            dp[i] = (dp[i - 1] + (i - 1) * dp[i - 2]) % mod;        std::vector&lt;int&gt; tag(n + 1);        DFS = [&amp;](int x, int fa) &#123;            f[x] = 1ll, tag[x] = 1;            for (auto i : g[x])                if (i != fa) &#123;                    DFS(i, x);                    (f[x] *= f[i]) %= mod;                &#125;            (f[x] *= dp[(int)g[x].size()]) %= mod;            return;        &#125;;        auto res(1ll);        for (int i = 1; i &lt;= n; ++i)            if (!tag[i])                DFS(i, -1), (res *= f[i]) %= mod;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;#ifndef ONLINE_JUDGE    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\n&quot;;#endif    return 0;&#125;</code></pre></details><hr /><p>E. Many Minimizations æ˜¯æ•°å­¦é¢˜ï¼Œè·³äº†ã€‚</p><hr /><h2 id="f---å¯¹æ•°æ®ç»“æ„çš„çˆ±">F - å¯¹æ•°æ®ç»“æ„çš„çˆ±</h2><p><a href="https://www.luogu.com.cn/problem/P5609" class="uri">https://www.luogu.com.cn/problem/P5609</a></p><p><strong>çº¿æ®µæ ‘åšæ³•</strong>ï¼šçŒœæµ‹å¯¹äºä¸€ä¸ªå›ºå®šçš„è¯¢é—®åŒºé—´ï¼Œå½“ <span class="math inline">\(x\)</span> å°äºä¸€ä¸ªç‰¹å®šçš„ä¸Šç•Œæ—¶ç­”æ¡ˆä¸ºæŸä¸ªå€¼ <span class="math inline">\(v\)</span>ï¼Œå¦åˆ™ä¸º <span class="math inline">\(v+1\)</span>ã€‚æ•…è€ƒè™‘çº¿æ®µæ ‘ç»´æŠ¤å‡½æ•°ã€‚å®šä¹‰ <span class="math inline">\(f(x)\)</span> è¡¨ç¤ºåŒºé—´ä¸Šæƒ³è¦å‡å» <span class="math inline">\(x\)</span> æ¬¡ <span class="math inline">\(p\)</span> éœ€è¦çš„æœ€å°åˆå§‹å€¼ï¼ˆè¿™æ ·æ‰èƒ½è®©å®šä¹‰åŸŸå’ŒåŒºé—´é•¿æœ‰å…³ï¼‰ï¼ŒæŸ¥è¯¢æ—¶ç›´æ¥äºŒåˆ†å³å¯ï¼›è€ƒè™‘åˆå§‹åŒ–æ—¶å¦‚ä½•åˆå¹¶ã€‚</p><p>é¦–å…ˆæ€è€ƒè¾ƒä¸ºæš´åŠ›çš„åšæ³•ï¼Œå¯¹äºå·¦ä¾§ç‚¹ <span class="math inline">\(a\)</span> å’Œå³ä¾§ç‚¹ <span class="math inline">\(b\)</span>ï¼Œè‹¥ <span class="math inline">\(f(a+1)-1+s_l-a\cdot p\ge f(b)\)</span>ï¼Œä¹Ÿå³å¯ä»¥å‡å» <span class="math inline">\(a+b\)</span> æ¬¡ï¼Œå°±å¯ä»¥ç”¨ <span class="math inline">\(\max(f(a),f(b)-s_l+a\cdot p)\)</span> æ¥æ›´æ–° <span class="math inline">\(f(a+b)\)</span>ã€‚</p><p>å‘ç° <span class="math inline">\((a,b)\)</span> çš„è´¡çŒ®ä¸€å®šå°äº <span class="math inline">\((a+1,b-1)\)</span> çš„è´¡çŒ®ï¼›å…·ä½“åœ°ï¼Œå‘ç° <span class="math inline">\(f(x+1)-f(x)\ge p\)</span> åå°±å¾ˆæ˜¾ç„¶äº†ã€‚é‡‡ç”¨åŒæŒ‡é’ˆï¼Œä¼˜å…ˆç§»åŠ¨ <span class="math inline">\(b\)</span>ï¼Œå°±èƒ½æŠŠæœ€çŸ­åŒºé—´æ‰«ä¸€éã€‚</p><p><strong>åˆ†æ²»åšæ³•</strong>ï¼šAst è‡ªå·±è¿˜æ²¡åˆ‡ï¼Œè¹²ä¸€ä¸ª solã€‚</p><hr /><h2 id="æ— åé¢˜">æ— åé¢˜</h2><blockquote><p>èƒŒæ™¯ï¼šç»™å®š <span class="math inline">\(n,k\)</span>ï¼Œå¯¹äº <span class="math inline">\(\forall\, 1\le i\le n\)</span>ï¼Œä»¤ <span class="math inline">\(a_i=i\bmod k\)</span>ï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ä¸ªæœ¬è´¨ä¸åŒçš„å­åºåˆ—ï¼Ÿå¯¹äº <span class="math inline">\(k=1,2,\cdots,n\)</span> åˆ†åˆ«æ±‚å‡ºç­”æ¡ˆã€‚</p></blockquote><hr /><h2 id="maimai">maimai</h2><p><a href="https://ac.nowcoder.com/acm/contest/66112/F" class="uri">https://ac.nowcoder.com/acm/contest/66112/F</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å­—å…¸æ ‘ </tag>
            
            <tag> å­—ç¬¦ä¸² </tag>
            
            <tag> ç»„åˆæ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ ç¬”è®°ï¼šåˆ†æ‹†æ•°ä¸ Ferrers å›¾</title>
      <link href="/20250807/"/>
      <url>/20250807/</url>
      
        <content type="html"><![CDATA[<p>æ€ä¹ˆä¸ä¸‹é›¨äº†ï¼Ÿ</p><span id="more"></span><hr /><h2 id="åˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°">åˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°</h2><p>è¦æ±‚ï¼šç»™å®šä¸€ä¸ªæ­£æ•´æ•° <span class="math inline">\(n\)</span>ï¼Œè¦æ±‚å°†å…¶åˆ’åˆ†ä¸º <span class="math inline">\(m\)</span> ä¸ªå¯é‡ / ä¸å¯é‡çš„æ­£æ•´æ•°ï¼Œé—®æœ¬è´¨ä¸åŒçš„æ–¹æ¡ˆæ•°ã€‚ï¼ˆæ˜¾ç„¶ <span class="math inline">\(m\)</span> ä¸ <span class="math inline">\(\sqrt n\)</span> åŒé˜¶ã€‚ï¼‰</p><p>ä¸å¦¨ä»¤åˆ’åˆ†ç»“æœå•è°ƒä¸é™ï¼Œåˆ™æœ‰ä¸¤ç§ DP è·¯å¾„ï¼š</p><ul><li><p>æ³•ä¸€ï¼šä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºæŠŠ <span class="math inline">\(i\)</span> åˆ†æˆ <span class="math inline">\(j\)</span> ä¸ªæ­£æ•´æ•°çš„æ–¹æ¡ˆæ•°ã€‚</p><ul><li>ä¸å¯é‡ï¼šè€ƒè™‘å°†è¿™ <span class="math inline">\(j\)</span> ä¸ªæ•°å‡å» <span class="math inline">\(1\)</span>ã€‚æœ€å¤šä¸€ä¸ªå…ƒç´ ç”± <span class="math inline">\(1\)</span> å˜ä¸º <span class="math inline">\(0\)</span>ï¼Œç»„æ•°å‡å°‘ <span class="math inline">\(1\)</span>ï¼›å…¶ä»–æ—¶å€™è¿˜æ˜¯ <span class="math inline">\(j\)</span> ç»„ã€‚æ•…äº‘ <span class="math inline">\(f_{i,j}=f_{i-j,j-1}+f_{i-j,j}\)</span>ã€‚</li><li>å¯é‡ï¼šå¦‚æœå­˜åœ¨ <span class="math inline">\(1\)</span>ï¼Œå¯ä»¥åˆ é™¤ä¹‹ç„¶åè½¬ç§»ï¼›å¦åˆ™ä»æ•´ä½“å‡ <span class="math inline">\(1\)</span> è½¬ç§»ã€‚æ•…æ›° <span class="math inline">\(f_{i,j}=f_{i-1,j-1}+f_{i-j,j}\)</span>ã€‚</li></ul>è¯¥è½¬ç§»æ–¹æ³•å”¯ä¸€æ€§å¾ˆæ˜¾ç„¶ã€‚<strong>æ³¨æ„åˆ°ç¬¬äºŒç»´åªå’Œ <span class="math inline">\(j,j-1\)</span> æœ‰å…³ï¼›å¯ä»¥äº¤æ¢å‰åä¸¤ç»´é¡ºåºç„¶åæ»šåŠ¨ã€‚</strong></li><li><p>æ³•äºŒï¼šä»¤ <span class="math inline">\(n=\sum a_i\)</span>ï¼Œå»ºç«‹ <span class="math inline">\(a\)</span> çš„å·®åˆ†æ•°ç»„ <span class="math inline">\(d\)</span>ï¼Œåˆ™æœ‰ <span class="math inline">\(n=\sum\limits_{i=1}^m \sum\limits_{j=1}^i c_j=\sum\limits_{i=1}^m (n-i+1)\times a_i\)</span>ã€‚å‘ç° <span class="math inline">\(a_i\)</span> æ¯å¢å¤§ <span class="math inline">\(1\)</span>ï¼Œç­”æ¡ˆä¼šå¢å¤§ <span class="math inline">\(n-i+1\)</span>ã€‚æ•…è½¬åŒ–ä¸ºã€ç¬¬ <span class="math inline">\(i\)</span> ä¸ªç‰©å“é‡é‡ä¸º <span class="math inline">\(n-i+1\)</span>ã€çš„å®Œå…¨èƒŒåŒ…ã€‚</p><ul><li>ä¸å¯é‡ï¼šè¦æ±‚æ¯ä¸ªç‰©å“è‡³å°‘é€‰ä¸€æ¬¡ã€‚</li><li>å¯é‡ï¼šæ— é™åˆ¶ã€‚</li></ul><p>è¯¥æ–¹æ³•å”¯ä¸€æ€§æ›´æ˜¾ç„¶ã€‚</p></li></ul><p>å¤æ‚åº¦å‡ä¸º <span class="math inline">\(O(nm)\)</span>ï¼Œå³ <span class="math inline">\(O(V\sqrt V)\)</span>ã€‚</p><h3 id="ä¾‹sets-of-complementary-sums">ä¾‹ï¼šSets of Complementary Sums</h3><p><a href="/20250723/#e.-sets-of-complementary-sums">link</a></p><h2 id="ferrers-å›¾">Ferrers å›¾</h2><p>å°† <span class="math inline">\(k\)</span> ä¸ªåˆ†æ‹†å‡ºæ¥çš„æ•°ç”¨æ¨ªå‘æŸ±çŠ¶å›¾è¡¨ç¤ºå¹¶å•è°ƒä¸å¢æ’åˆ—ï¼Œå¾—åˆ° Ferrers å›¾ã€‚</p><figure><img src="image-1.png" alt="ä¾‹ï¼š12=5+4+2+1 çš„ Ferrers å›¾ï¼ˆå›¾æº OI Wikiï¼‰" /><figcaption>ä¾‹ï¼š<span class="math inline">\(12=5+4+2+1\)</span> çš„ Ferrers å›¾ï¼ˆå›¾æº OI Wikiï¼‰</figcaption></figure><p>å°†å›¾åƒæ–œå‘ç¿»æŠ˜å¾—åˆ°ä¸€ç»„å…±è½­è§£ï¼ŒåŸå›¾ä¸­çš„ <span class="math inline">\(k\)</span> å³ä¸ºå…±è½­è§£ä¸­çš„å…ƒç´ æœ€å€¼ã€‚æ•…äº¦å¯é™å®šåˆ†æ‹†ç»“æœçš„æœ€å€¼ä¸º <span class="math inline">\(k\)</span>ï¼Œåˆ™ç»“æœä»ä¸º <span class="math inline">\(f_{n,k}\)</span>ã€‚åŒæ—¶é€‚ç”¨äºåˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°ã€‚</p><p>é¡ºå¸¦æä¸€å˜´æ¨è¡¨ï¼šæŠŠç‚¹æ›¿æ¢æˆ <span class="math inline">\(1\sim n\)</span>ï¼Œå¹¶ä½¿å¾—ä¸€ä¸ªç‚¹åŒæ—¶å¤§äºå·¦ä¾§å’Œä¸Šæ–¹çš„å€¼ã€‚</p><p>ä¼¼ä¹å°±ä¸æ˜¯å¾ˆæœ‰ç”¨äº†ã€‚è®¡æ•°é¢˜å¯èƒ½ä¼šè€ƒã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŠ¶å‹ DP</title>
      <link href="/20250805/"/>
      <url>/20250805/</url>
      
        <content type="html"><![CDATA[<p>å‘ç°å¦‚æœ <code>&lt;!-- more --&gt;</code> å‰é¢æ˜¯ç©ºç™½å­—ç¬¦ä¼šè¢«è®¤ä¸º excerpt ä¸å­˜åœ¨ï¼Œæ—©è¯¥æƒ³åˆ°è¿™ä¸ªçš„</p><span id="more"></span><hr /><h2 id="a---åªä¸è¿‡æ˜¯é•¿çš„é¢†å¸¦-2-just-long-neckties-2">A - åªä¸è¿‡æ˜¯é•¿çš„é¢†å¸¦ 2 / Just Long Neckties 2</h2><p><a href="https://www.luogu.com.cn/problem/P11665" class="uri">https://www.luogu.com.cn/problem/P11665</a></p><p>éœ€è¦è§‚å¯Ÿåˆ°ï¼Œä»»æ„æ—¶åˆ» <span class="math inline">\(B\)</span> ä¸­ä¸å­˜åœ¨é‡å¤å…ƒç´ ã€‚æŠŠ <span class="math inline">\(B\)</span> å‹å‡ºæ¥ï¼Œä»¤ <span class="math inline">\(f_{i,S}\)</span> è¡¨ç¤ºé€‰äº† <span class="math inline">\(i\)</span>ï¼Œå½“å‰ <span class="math inline">\(B\)</span> ä¸º <span class="math inline">\(S\)</span> æ˜¯å¦å¯è¡Œï¼Œèƒ½å¤Ÿ <span class="math inline">\(O(n\cdot 2^V)\)</span>ã€‚å¯¹äºæŸä¸ª <span class="math inline">\(S\)</span>ï¼Œåªå…³å¿ƒå®ƒæœ€è¿œèƒ½åˆ°è¾¾å“ªä¸ª <span class="math inline">\(i\)</span>ï¼Œæ•…ä»¤ <span class="math inline">\(f_S\)</span> è®°å½•ä¹‹ã€‚å¯¹äºæ¯ä¸€ä¸ª <span class="math inline">\(S\)</span>ï¼Œéƒ½å¯ä»¥æ‰¾åˆ° <span class="math inline">\(f_S\)</span> åç¬¬ä¸€å¯¹ <span class="math inline">\(a_i,a_{i+1}\notin S\)</span>ï¼Œç”¨å…¶åˆ·è¡¨ã€‚</p><p>å‘ç°ã€æ‰¾ <span class="math inline">\(f_S\)</span> åç¬¬ä¸€å¯¹éæ³•å…ƒç´ ã€æ˜¯å¾ˆæ…¢çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ï¼›å¯¹äºæ¯ä¸ª <span class="math inline">\(i\)</span> ç»´æŠ¤ <span class="math inline">\(p\)</span> åœ¨å…¶åç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® <span class="math inline">\(x\)</span>ï¼Œå¯¹äºæ¯ä¸ª <span class="math inline">\(a_x=p\)</span> ç»´æŠ¤ <span class="math inline">\(x\)</span> åæ–¹ <span class="math inline">\(a_y=p,a_{y+1}=q\)</span> ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œç›¸å½“äº<strong>å…ˆæ‰¾ <span class="math inline">\(p\)</span> å†æ‰¾ <span class="math inline">\((p,q)\)</span></strong>ï¼Œå°±å¯ä»¥åšåˆ° <span class="math inline">\(O(V^2\cdot 2^V+n\cdot V)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    int V = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        V = std::max(V, a[i]--);    &#125;    std::vector&lt;std::vector&lt;int&gt; &gt; tx(n + 1, std::vector&lt;int&gt; (V)), ty(n + 1, std::vector&lt;int&gt; (V));    std::vector&lt;int&gt; lp(V);    std::vector&lt;std::vector&lt;int&gt; &gt; lpq(V, std::vector&lt;int&gt; (V));    for (int i = n; ~i; --i) &#123;        if (i &amp;&amp; i != n)            lpq[a[i]][a[i + 1]] = i;        for (int j = 0; j &lt; V; ++j) &#123;            tx[i][j] = lp[j];            if (i != n)                ty[i][j] = lpq[a[i]][j];        &#125;        if (i != 0)            lp[a[i]] = i;    &#125;    int siz = 1 &lt;&lt; V, res = 21;    std::vector&lt;int&gt; f(siz);    for (int i = 0; i &lt; siz; ++i) &#123;        std::vector&lt;int&gt; p0, p1;        for (int j = 0; j &lt; V; ++j)            if ((i &gt;&gt; j) &amp; 1)                p1.push_back(j);            else                p0.push_back(j);        int j = n;        for (auto p : p0)            if (tx[f[i]][p])                for (auto q : p0)                    if (ty[tx[f[i]][p]][q])                        j = std::min(j, ty[tx[f[i]][p]][q]);        if (j != n) &#123;            f[i ^ (1 &lt;&lt; a[j])] = std::max(f[i ^ (1 &lt;&lt; a[j])], j);            f[i ^ (1 &lt;&lt; a[j + 1])] = std::max(f[i ^ (1 &lt;&lt; a[j + 1])], j + 1);            for (auto k : p1) &#123;                f[i ^ (1 &lt;&lt; k) ^ (1 &lt;&lt; a[j])] = std::max(f[i ^ (1 &lt;&lt; k) ^ (1 &lt;&lt; a[j])], j);                f[i ^ (1 &lt;&lt; k) ^ (1 &lt;&lt; a[j + 1])] = std::max(f[i ^ (1 &lt;&lt; k) ^ (1 &lt;&lt; a[j + 1])], j + 1);            &#125;        &#125;        else            res = std::min(res, __builtin_popcount(i));    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---cut-and-reorder">B - Cut and Reorder</h2><p><a href="https://atcoder.jp/contests/abc328/tasks/abc328_g" class="uri">https://atcoder.jp/contests/abc328/tasks/abc328_g</a></p><p>ä¸å¦¨å…ˆé‡æ’å†ä¿®æ”¹ï¼Œä»¤ <span class="math inline">\(f_{i,S}\)</span> è¡¨ç¤ºå·²ç»é‡æ’å¥½æ–°åºåˆ—çš„å‰ <span class="math inline">\(i\)</span> ä¸ªå…ƒç´ ï¼Œå¯¹åº”åŸåºåˆ—çŠ¶æ€ <span class="math inline">\(S\)</span> çš„æœ€å°ä»£ä»·ã€‚æšä¸¾æ–°åŒºé—´å®¹æ˜“è½¬ç§»ã€‚å¯ä»¥å‘ç°æšä¸¾ <span class="math inline">\(i,S\)</span> çš„å®é™…å¤æ‚åº¦ä¸º <span class="math inline">\(O(2^n)\)</span>ï¼ˆç©ºé—´ä¹Ÿå¯ä»¥è¿™ä¹ˆä¼˜åŒ–ï¼‰ï¼Œé¢„å¤„ç†ä¹‹åæ€»æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n^2\cdot 2^n)\)</span>ï¼Œè·‘ä¸æ»¡ï¼Œå¯ä»¥é€šè¿‡ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    long long c;    std::cin &gt;&gt; n &gt;&gt; c;    std::vector&lt;long long&gt; a(n), b(n);    for (int i = 0; i &lt; n; ++i)        std::cin &gt;&gt; a[i];    for (int i = 0; i &lt; n; ++i)        std::cin &gt;&gt; b[i];    using arr = std::vector&lt;long long&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    brr p(n, arr(n));    crr g(n, brr(n, arr(n)));    for (int l = 0; l &lt; n; ++l)        for (int r = l; r &lt; n; ++r) &#123;            for (int k = l; k &lt;= r; ++k)                p[l][r] ^= (1 &lt;&lt; k);            for (int R = r - l; R &lt; n; ++R)                for (int L = R, j = r; j &gt;= l; --L, --j)                    g[l][r][R] += std::abs(b[L] - a[j]);        &#125;    int siz = 1 &lt;&lt; n;    std::vector&lt;long long&gt; f(siz, inf);    f[0] = 0ll;    for (int j = 1; j &lt; siz; ++j) &#123;        int i = __builtin_popcount(j) - 1;        for (int r = 0; r &lt; n; ++r)            for (int l = r; ~l &amp;&amp; ((j &gt;&gt; l) &amp; 1); --l)                f[j] = std::min(f[j], f[j ^ p[l][r]] + g[l][r][i] + c);    &#125;    std::cout &lt;&lt; f[siz - 1] - c &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---electric-circuit">C - Electric Circuit</h2><p><a href="https://atcoder.jp/contests/abc321/tasks/abc321_g" class="uri">https://atcoder.jp/contests/abc321/tasks/abc321_g</a></p><p>å¾ˆåƒ<a href="/20250430/#æœ‰æ ‡å·æ— å‘å›¾è®¡æ•°">æ— å‘å›¾å®¹æ–¥</a>ï¼Ÿä»¤ <span class="math inline">\(f_S\)</span> è¡¨ç¤ºè®© <span class="math inline">\(S\)</span> å†…éƒ¨å®Œæˆé…å¯¹ï¼Œå¯ä»¥ä¸è¿é€šçš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå½“ä¸”ä»…å½“ <span class="math inline">\(S\)</span> å†…éƒ¨ç‚¹å‡ºã€å…¥åº¦ä¹‹å’Œç›¸ç­‰ï¼ˆè®°ä¸º <span class="math inline">\(cnt\)</span>ï¼‰æ—¶ï¼Œ<span class="math inline">\(f_S\)</span> æœ‰å€¼ <span class="math inline">\(cnt!\)</span>ã€‚ç›¸ä¼¼åœ°ï¼Œè®¾ <span class="math inline">\(g_S\)</span> è¡¨ç¤ºè®© <span class="math inline">\(S\)</span> å®Œæˆé…å¯¹ï¼Œæˆä¸ºä¸€ä¸ªè¿é€šå—çš„æ–¹æ¡ˆæ•°ï¼Œå¾—åˆ° <span class="math inline">\(g_S=f_S-\sum\limits_{v\in S} f_{S\oplus v}\cdot g_v\)</span>ã€‚è®© <span class="math inline">\(v\)</span> å¿…é¡»åŒ…å« <span class="math inline">\(S\)</span> ä¸­ç¼–å·æœ€å°çš„ç‚¹å°±å¯ä»¥å»é‡ã€‚</p><p>ä»è´¡çŒ®çš„è§’åº¦å‡ºå‘ï¼Œ<span class="math inline">\(S\)</span> å¸¦æ¥çš„è´¡çŒ®å°±æ˜¯ <span class="math inline">\(g_S\cdot f_{U\oplus S}\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(U\)</span> æ˜¯å…¨é›†ã€‚æœ€åé™¤ä»¥ <span class="math inline">\(M!\)</span> æ±‚å‡ºæœŸæœ›ã€‚</p><p>å¤æ‚åº¦ <span class="math inline">\(O(3^n)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; ci(n), co(n);    for (int i = 1, x; i &lt;= m; ++i)        std::cin &gt;&gt; x, ++ci[x - 1];    for (int i = 1, x; i &lt;= m; ++i)        std::cin &gt;&gt; x, ++co[x - 1];    std::vector&lt;long long&gt; fac(m + 1);    fac[0] = 1ll;    for (int i = 1; i &lt;= m; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [&amp;](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    int siz = 1 &lt;&lt; n;    std::vector&lt;long long&gt; f(siz), g(siz);    for (int i = 1; i &lt; siz; ++i) &#123;        int si = 0, so = 0;        for (int j = 0; j &lt; n; ++j)            if ((i &gt;&gt; j) &amp; 1)                si += ci[j], so += co[j];        if (si == so)            f[i] = fac[si];    &#125;    auto res(0ll);    for (int i = 1; i &lt; siz; ++i) &#123;        g[i] = f[i];        int mn = 0;        for (int j = 0; j &lt; n; ++j)            if ((i &gt;&gt; j) &amp; 1) &#123;                mn = j;                break;            &#125;        int s = i ^ (1 &lt;&lt; mn);        (g[i] += mod - g[1 &lt;&lt; mn] * f[s] % mod) %= mod;        for (int j = (s - 1) &amp; s; j; j = (j - 1) &amp; s)            (g[i] += mod - g[j ^ (1 &lt;&lt; mn)] * f[s ^ j] % mod) %= mod;        if (i != siz - 1)            (res += g[i] * f[(siz - 1) ^ i]) %= mod;        else            (res += g[i]) %= mod;    &#125;    std::cout &lt;&lt; res * qkp(fac[m], mod - 2) % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d---count-grid-3-coloring">D - Count Grid 3-coloring</h2><p><a href="https://atcoder.jp/contests/abc379/tasks/abc379_g" class="uri">https://atcoder.jp/contests/abc379/tasks/abc379_g</a></p><p>è½®å»“çº¿ DPã€‚æŠŠæ¯ä¸€åˆ—å·²ç»ç¡®å®šçš„æœ€é ä¸‹çš„å…ƒç´ å‹èµ·æ¥ï¼Œæ¯è¡Œé€ä¸ªç¡®å®šå³å¯ã€‚</p><p>å‘ç°æœ‰æ•ˆçŠ¶æ€ä¸­åªèƒ½å®¹è®¸æœ€å¤šä¸€å¯¹ç›¸é‚»ç›¸åŒå…ƒç´ ï¼Œè¿™æ ·å¤æ‚åº¦å°±èƒ½é™ä¸‹æ¥äº†ã€‚æ³¨æ„ç‰¹åˆ¤ <span class="math inline">\(1\times 1\)</span> çš„æƒ…å†µã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::array&lt;int, 15&gt; p;    p[0] = 1;    for (int i = 1; i &lt; 15; ++i)        p[i] = p[i - 1] * 3;    std::vector&lt;std::vector&lt;int&gt; &gt; a;    if (n &gt;= m) &#123;        a.assign(n + 1, std::vector&lt;int&gt; (m + 1));        for (int i = 1; i &lt;= n; ++i)             for (int j = 1; j &lt;= m; ++j) &#123;                char t;                std::cin &gt;&gt; t, a[i][j] = (t == &#39;?&#39; ? -1 : t - &#39;1&#39;);            &#125;    &#125;    else &#123;        std::swap(n, m);        a.assign(n + 1, std::vector&lt;int&gt; (m + 1));        for (int i = 1; i &lt;= m; ++i)            for (int j = 1; j &lt;= n; ++j) &#123;                char t;                std::cin &gt;&gt; t, a[j][i] = (t == &#39;?&#39; ? -1 : t - &#39;1&#39;);            &#125;    &#125;    int siz = p[m];    using arr = std::vector&lt;long long&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    std::vector&lt;int&gt; s, tab(siz, -1);    auto getv_1 = [&amp;](int j, int i) &#123;        return (j / p[i - 1]) % 3;    &#125;;    auto getv = [&amp;](int j, int i) &#123;        return (s[j] / p[i - 1]) % 3;    &#125;;    auto chg = [&amp;](int j, int i, int v) &#123;        return tab[s[j] - p[i - 1] * getv(j, i) + p[i - 1] * v];    &#125;;    auto out = [&amp;](int i) &#123;        std::string s;        for (int j = 1; j &lt;= m; ++j)            s += &#39;1&#39; + getv_1(i, j);        return s.c_str();    &#125;;    for (int i = 0; i &lt; siz; ++i) &#123;        s.push_back(i);        int cnt = 0;        for (int j = 2; j &lt;= m; ++j)            if (getv_1(i, j - 1) == getv_1(i, j) &amp;&amp; ++cnt &gt;= 2) &#123;                s.pop_back();                break;            &#125;    &#125;    for (int i = 0; i &lt; (int)s.size(); ++i)        tab[s[i]] = i;    siz = (int)s.size();    if (n == 1) &#123;        std::cout &lt;&lt; (a[1][1] == -1 ? 3 : 1) &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    crr f(n + 1, brr(m + 1, arr(siz)));    for (int i = 0; i &lt; siz; ++i)        if ([&amp;](int i, int s) &#123;            for (int j = 1; j &lt;= m; ++j) &#123;                if (a[i][j] != -1 &amp;&amp; a[i][j] != getv(s, j))                    return false;                if (j != 1 &amp;&amp; getv(s, j) == getv(s, j - 1))                    return false;            &#125;            return true;        &#125; (1, i)) &#123;            for (int p = 0; p &lt; 3; ++p)                if ((a[2][1] == -1 || a[2][1] == p) &amp;&amp; getv(i, 1) != p &amp;&amp; ~chg(i, 1, p))                    (++f[2][1][chg(i, 1, p)]) %= mod;        &#125;    for (int i = 2; i &lt;= n; ++i) &#123;        for (int k = 1; k &lt; m; ++k)            for (int j = 0; j &lt; siz; ++j)                if (f[i][k][j]) &#123;                    // printf(&quot;f[%d][%d][%s] = %lld\n&quot;, i, k, out(s[j]), f[i][k][j]);                    for (int p = 0; p &lt; 3; ++p)                        if ((a[i][k + 1] == -1 || a[i][k + 1] == p) &amp;&amp; getv(j, k) != p &amp;&amp; getv(j, k + 1) != p &amp;&amp; ~chg(j, k + 1, p))                            (f[i][k + 1][chg(j, k + 1, p)] += f[i][k][j]) %= mod;                &#125;        for (int j = 0; j &lt; siz; ++j)            if (i != n &amp;&amp; f[i][m][j])                for (int p = 0; p &lt; 3; ++p)                    if ((a[i + 1][1] == -1 || a[i + 1][1] == p) &amp;&amp; getv(j, 1) != p &amp;&amp; ~chg(j, 1, p))                        (f[i + 1][1][chg(j, 1, p)] += f[i][m][j]) %= mod;    &#125;    auto res = 0ll;    for (int i = 0; i &lt; siz; ++i)        (res += f[n][m][i]) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="e---pure-straight">E - Pure Straight</h2><p><a href="https://atcoder.jp/contests/arc126/tasks/arc126_d" class="uri">https://atcoder.jp/contests/arc126/tasks/arc126_d</a></p><p>æ‰‹ç©å‘ç°åªè¦æœ€ç»ˆåºåˆ—ç¡®å®šï¼Œé‚£ä¹ˆç§»åŠ¨çš„é¡ºåºä¸å½±å“ç­”æ¡ˆã€‚æ•…è€ƒè™‘ç¡®å®šç›®æ ‡ä½ç½®å’Œç§»åŠ¨åºåˆ—ã€‚è€ƒè™‘ç»å¯¹å€¼çš„å‡ ä½•æ„ä¹‰ï¼Œä¸å¦¨ä»¤ç›®æ ‡å­åºåˆ—ä¸­å…ƒç´ é›†ä¸­åˆ°è¢«é€‰ä¸­ä½ç½®çš„ä¸­é—´å…ƒç´ ï¼Œæ­¤æ—¶çš„ä»£ä»·å¯ä»¥è®¡ç®—ã€‚ç”¨ç‚¹äºŒè¿›åˆ¶æŠ€å·§å’Œåº“å‡½æ•°å¯ä»¥ <span class="math inline">\(O(1)\)</span> ç®—ä»£ä»·ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    int siz = 1 &lt;&lt; k;    std::vector&lt;int&gt; a(n + 1), f(siz, 0x3f3f3f3f);    auto out = [&amp;](int j) &#123;        std::string s;        for (int i = 0; i &lt; k; ++i)            s += (&#39;0&#39; + ((j &gt;&gt; i) &amp; 1));        return s.c_str();    &#125;;    f[0] = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i], --a[i];        for (int j = siz - 1; j &gt;= 0; --j) &#123;            if (!((j &gt;&gt; a[i]) &amp; 1))                f[j | (1 &lt;&lt; a[i])] = std::min(f[j | (1 &lt;&lt; a[i])], f[j] + __builtin_popcount(j &amp; (~((1 &lt;&lt; a[i]) - 1))));            f[j] += std::min(__builtin_popcount(j), k - __builtin_popcount(j));        &#125;    &#125;    std::cout &lt;&lt; f[siz - 1] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="f---123-set">F - 123 Set</h2><p><a href="https://atcoder.jp/contests/arc184/tasks/arc184_b" class="uri">https://atcoder.jp/contests/arc184/tasks/arc184_b</a></p><p>åšè¿‡ <a href="https://www.luogu.com.cn/problem/P3226">é›†åˆé€‰æ•°</a>ï¼ˆè¿™ä¸ª trick è§è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œåº”è¯¥ä¸åªè¿™ä¸€é“ï¼Œä½†æˆ‘æƒ³ä¸èµ·æ¥äº†ï¼‰å¾ˆå®¹æ˜“æƒ³åˆ°ç”»ä¸€ä¸ªè¡¨æ ¼æˆ–è€… DAG å‡ºæ¥ï¼Œå…¶å®éƒ½èƒ½åš</p><p>å¯¹äºè¡¨æ ¼å·¦ä¸Šè§’å’Œ DAG çš„æºç‚¹ï¼Œè‚¯å®šæ˜¯ä¸€ä¸ª <span class="math inline">\(x\)</span>ï¼Œå…¶ä¸æ˜¯ <span class="math inline">\(2\)</span> æˆ– <span class="math inline">\(3\)</span> çš„å€æ•°ã€‚å¦‚æœç”»è¡¨ï¼Œæ¨ªä¹˜ 3 ç«–ä¹˜ 2ï¼Œè§‚å¯Ÿä¸€ä¸‹æ˜¯åŒ…å«äº† <span class="math inline">\(1\sim n\)</span> æ°å¥½ä¸€æ¬¡çš„å¾ˆå¤šä¸ªæ¨è¡¨ï¼ˆæ²¡ä»€ä¹ˆç”¨ï¼Œæä¸€å˜´è€Œå·²ï¼‰ï¼Œè€ƒè™‘è½¬åŒ–ç›®æ ‡ï¼Œå‘ç°æ˜¯ç”¨ä¸€ä¸ªä¸å¯æ—‹è½¬çš„å€’ L å½¢éª¨ç‰Œå¯å æ”¾åœ°é“ºæ»¡å¼‚å½¢è¡¨æ ¼ï¼Œå¯ä»¥è€ƒè™‘è½®å»“çº¿ DP</p><p>å…·ä½“åœ°ï¼Œç”¨ 1 æ¥è¡¨ç¤ºæ‹è§’å¤„ï¼Œ0 è¡¨ç¤ºå…¶ä»–ï¼Œå æ”¾çš„æ—¶å€™ 1 çš„ä¼˜å…ˆçº§æ¯” 0 é«˜ï¼Œç„¶åå°±å¯ä»¥åšäº†ã€‚ä»¥ 3 ä¸ºè¡Œï¼Œæ‚²è§‚ä¼°è®¡å•ä¸ªè¡¨æ ¼å¤§æ¦‚æœ‰ <span class="math inline">\(31\times 2^{19}\)</span> ä¸ªçŠ¶æ€ï¼Œè¿ç®—æ¬¡æ•°å·®ä¸å¤š <span class="math inline">\(31\times 19\times 2^{19}\)</span>ï¼›å†å‘ç°é•¿å¾—ä¸€æ¨¡ä¸€æ ·çš„è¡¨æ ¼è‚¯å®šæ–¹æ¡ˆæ•°æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœæŠŠä»»æ„ä¸€ä¸ªè¡¨æ ¼å…¨éƒ¨é™¤ä»¥ <span class="math inline">\(x\)</span>ï¼Œå°±ä¼šå¾—åˆ° <span class="math inline">\(n=10^9\div x\)</span> æ—¶ <span class="math inline">\(1\)</span> ä¸ºå·¦ä¸Šè§’çš„æ¨è¡¨ï¼Œå°±æ˜¯è¯´é•¿ç›¸åªå’Œ <span class="math inline">\(10^9\div x\)</span> çš„å€¼æœ‰å…³ï¼Œå¯ä»¥æ•´é™¤åˆ†å— ğŸ˜± å¯é¢„è®¡çš„è·‘å¾—éå¸¸ä¸æ»¡ï¼Œå®è·µä¸‹æ¥æ˜¯å¯ä»¥è¿‡çš„ï¼ˆä½†æ˜¯å¾ˆæ…¢ï¼‰</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    auto calc = [&amp;](int r) &#123;        return r - r / 2 - r / 3 + r / 6;    &#125;;    auto dp = [&amp;](int lim) &#123;        if (lim == 1) &#123;            // printf(&quot;lim = 1, ret 1&quot;);            return 1;        &#125;        int n = 1, m = 1;        for (int k = 1; k * 2 &lt;= lim; ++n, k *= 2);        for (int k = 1; k * 3 &lt;= lim; ++m, k *= 3);        int siz = 1 &lt;&lt; m;        std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(2, std::vector&lt;std::vector&lt;int&gt; &gt; (2, std::vector&lt;int&gt; (siz))), p(n + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (m));        std::vector&lt;std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; &gt; t(2, std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; (2, std::vector&lt;std::pair&lt;int, int&gt; &gt; (siz))); // sb        auto upd = [&amp;](int i, int k, int j, int v) &#123;            if (t[i &amp; 1][k &amp; 1][j] != std::make_pair(i, k)) &#123;                p[i][k].push_back(j);                t[i &amp; 1][k &amp; 1][j] = &#123; i, k &#125;, f[i &amp; 1][k &amp; 1][j] = v;            &#125;            else                f[i &amp; 1][k &amp; 1][j] = std::min(f[i &amp; 1][k &amp; 1][j], v);            return;        &#125;;        auto chg = [&amp;](int i, int j, int v) &#123;            return i ^ (((i &gt;&gt; j) &amp; 1) &lt;&lt; j) ^ (v &lt;&lt; j);        &#125;;        for (int i = 0; i &lt; siz; ++i) &#123;            bool flag = 0;            for (int j = 0; j &lt; m; ++j)                if (((i &gt;&gt; j) &amp; 1) || (j &amp;&amp; ((i &gt;&gt; (j - 1)) &amp; 1)));                else &#123;                    flag = 1;                    break;                &#125;            if (!flag)                upd(1, m - 1, i, __builtin_popcount(i));        &#125;        for (int i = 2; i &lt;= n; i++) &#123;            int m1 = 1;            for (int x = (1 &lt;&lt; (i - 1)); x * 3ll &lt;= lim; ++m1, x *= 3);            int siz1 = 1 &lt;&lt; m1;            for (auto j : p[i - 1][m - 1]) &#123;                if (j &amp; 1)                    upd(i, 0, chg(j &amp; (siz1 - 1), 0, 0), f[(i - 1) &amp; 1][(m - 1) &amp; 1][j]);                upd(i, 0, chg(j &amp; (siz1 - 1), 0, 1), f[(i - 1) &amp; 1][(m - 1) &amp; 1][j] + 1);            &#125;            m = m1, siz = siz1;            for (int k = 0; k &lt; m - 1; ++k)                for (auto j : p[i][k]) &#123;                    if (((j &gt;&gt; k) &amp; 1) || ((j &gt;&gt; (k + 1)) &amp; 1))                        upd(i, k + 1, chg(j, k + 1, 0), f[i &amp; 1][k &amp; 1][j]);                    upd(i, k + 1, chg(j, k + 1, 1), f[i &amp; 1][k &amp; 1][j] + 1);                &#125;        &#125;        int res = 0x3f3f3f3f;        for (auto i : p[n][m - 1])            res = std::min(res, f[n &amp; 1][(m - 1) &amp; 1][i]);        return res;    &#125;;    int res = 0;    for (int l = 1, r; l &lt;= n; l = r + 1) &#123;        r = n / (n / l);        if (calc(r) - calc(l - 1))            res += (calc(r) - calc(l - 1)) * dp(n / l);    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> çŠ¶å‹ DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ ‘ DP</title>
      <link href="/20250803/"/>
      <url>/20250803/</url>
      
        <content type="html"><![CDATA[<p>æ ‘ä¸Šçš„ DP ä»¥åŠ å’Œæ ‘æœ‰å…³çš„ DP</p><span id="more"></span><hr /><h2 id="a---svjetlo">A - Svjetlo</h2><p><a href="https://www.luogu.com.cn/problem/P7163" class="uri">https://www.luogu.com.cn/problem/P7163</a></p><p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œå³ä»¤ <span class="math inline">\(f_{x,0/1/2}\)</span> åˆ†åˆ«è¡¨ç¤ºæœ‰ <span class="math inline">\(0/1/2\)</span> ä¸ªç«¯ç‚¹åœ¨å­æ ‘å†…éƒ¨çš„æƒ…å†µï¼›ç„¶åå°±å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ»¡è¶³å¯¹äºå¼€å…³çŠ¶æ€çš„è¦æ±‚ï¼Ÿ</p><p>è¿˜æ˜¯æƒ³å°‘äº†ã€‚å¦‚æœå†åŠ ä¸€ç»´ï¼Œä»ã€çŠ¶æ€ä¸ºå¼€æˆ–å…³ã€æ€è€ƒå°±ä¼šè½»æ¾å¾ˆå¤šï¼Œä»¤ <span class="math inline">\(f_{x,0/1/2,0/1}\)</span> è¡¨ç¤ºæœ‰ <span class="math inline">\(0/1/2\)</span> ä¸ªç«¯ç‚¹å†å­æ ‘å¤–éƒ¨ï¼Œä¸”å­æ ‘å†…æ“ä½œå®Œå <span class="math inline">\(x\)</span> ä¸ºå…³ / å¼€çš„æœ€å°‘æ­¥æ•°ã€‚ç„¶ååˆ†ç±»è®¨è®ºè½¬ç§»æ–¹å¼å³å¯ã€‚</p><p>ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„è®¨è®ºæ–¹å¼æ˜¯ï¼Œå…ˆç¡®å®šæŸç§æƒ…å†µä¸‹ï¼Œè®¿é—® <span class="math inline">\(u\)</span> ä¸ <span class="math inline">\(v\)</span> çš„æ¬¡æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°å®ƒä»¬åŸæœ¬çš„çŠ¶æ€ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, rt = -1;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        char t;        std::cin &gt;&gt; t;        a[i] = t - &#39;0&#39;;        if (!a[i])            rt = i;    &#125;    if (rt == -1) &#123;        std::cout &lt;&lt; 0 &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; tag(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        tag[x] = a[x];        for (auto i : g[x])            if (i != fa)                DFS(i, x), tag[x] &amp;= tag[i];        return;    &#125;;    DFS(rt, -1);    std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(n + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (3, std::vector&lt;int&gt; (2, 0x3f3f3f3f)));    DFS = [&amp;](int x, int fa) &#123;        f[x][0][a[x]] = 0;        for (auto i : g[x])            if (i != fa &amp;&amp; !tag[i]) &#123;                DFS(i, x);                auto g = f[x];                f[x][0][0] = std::min(g[0][0] + f[i][0][1] + 4, g[0][1] + f[i][0][0] + 2);                f[x][0][1] = std::min(g[0][1] + f[i][0][1] + 4, g[0][0] + f[i][0][0] + 2);                f[x][1][0] = std::min(&#123; g[1][0] + f[i][0][1] + 4, g[1][1] + f[i][0][0] + 2, g[0][0] + f[i][1][0] + 3, g[0][1] + f[i][1][1] + 1 &#125;);                f[x][1][1] = std::min(&#123; g[1][1] + f[i][0][1] + 4, g[1][0] + f[i][0][0] + 2, g[0][1] + f[i][1][0] + 3, g[0][0] + f[i][1][1] + 1 &#125;);                f[x][2][0] = std::min(&#123; g[2][0] + f[i][0][1] + 4, g[2][1] + f[i][0][0] + 2, g[1][0] + f[i][1][1], g[1][1] + f[i][1][0] + 2, g[0][0] + f[i][2][1] + 4, g[0][1] + f[i][2][0] + 2 &#125;);                f[x][2][1] = std::min(&#123; g[2][1] + f[i][0][1] + 4, g[2][0] + f[i][0][0] + 2, g[1][1] + f[i][1][1], g[1][0] + f[i][1][0] + 2, g[0][1] + f[i][2][1] + 4, g[0][0] + f[i][2][0] + 2 &#125;);            &#125;        f[x][1][0] = std::min(f[x][1][0], f[x][0][1] + 1);        f[x][1][1] = std::min(f[x][1][1], f[x][0][0] + 1);        f[x][2][0] = std::min(f[x][2][0], f[x][1][0]);        f[x][2][1] = std::min(f[x][2][1], f[x][1][1]);        // for (int i = 0; i &lt; 3; ++i)        //     for (int j = 0; j &lt; 2; ++j)        //         printf(&quot;f[%d][%d][%d] = %d\n&quot;, x, i, j, f[x][i][j]);        return;    &#125;;    DFS(rt, -1);    std::cout &lt;&lt; f[rt][2][1] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---one-to-one">B - One to One</h2><p><a href="https://atcoder.jp/contests/arc140/tasks/arc140_d" class="uri">https://atcoder.jp/contests/arc140/tasks/arc140_d</a></p><p>è§‚å¯ŸåŸå›¾ä¸Šè¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯æ²¡æœ‰æœªç¡®å®šè¾¹çš„åŸºç¯æ ‘ï¼Œè¦ä¹ˆæ˜¯æœ‰æ°å¥½ä¸€æ¡æœªç¡®å®šè¾¹çš„æ ‘ã€‚ç¼©ç‚¹ï¼Œä»»æ„ä¸ºæœªç¡®å®šè¾¹èµ‹å€¼ï¼Œè€ƒå¯Ÿæœ€åå¾—åˆ°çš„è¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯ä»¥ã€åŸºç¯æ ‘ç‚¹ã€ä¸ºæ ¹çš„æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸åŒ…å«ã€åŸºç¯æ ‘ç‚¹ã€çš„ï¼ˆå†…å‘ï¼‰åŸºç¯æ ‘ã€‚</p><p>è¿™é‡Œè¦ç”¨åˆ°è´¡çŒ®çš„æ€æƒ³ã€‚è€ƒè™‘å°†å…¨å±€åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œä¿è¯æ¯éƒ¨åˆ†çš„å•æ­¥ä»·å€¼æ˜¯å¯ç¡®å®šçš„ã€‚å°†ç¬¬ä¸€æ­¥ï¼Œå³å¯¹æ ‘å’ŒåŸºç¯æ ‘çš„è®¨è®ºæ‹†å¼€ï¼Œå¯¹äºæ ‘ï¼Œå…¶æ•°é‡ç¡®å®šï¼›å¯¹äºåŸºç¯æ ‘ï¼Œå‘ç°ç¯çš„æ•°é‡å³ä¸ºåŸºç¯æ ‘çš„æ•°é‡ï¼Œè¿›ä¸€æ­¥å°†æ‰€æœ‰æ­¥ä¸­çš„ã€ç¯ã€è¿™ä¸€ç±»åˆ†å¼€ï¼Œç»Ÿè®¡æˆç¯çš„æ–¹æ¡ˆæ•°å°±å¯ä»¥å¾—åˆ°åŸºç¯æ ‘çš„è´¡çŒ®ã€‚å…·ä½“åœ°ï¼Œä»¤ <span class="math inline">\(f_{i,j}\)</span> ä¸ºåœ¨å‰ <span class="math inline">\(i\)</span> ä¸ªç‚¹ä¸­é€‰æ‹© <span class="math inline">\(j\)</span> ä¸ªæˆä¸€ä¸ªç¯çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š</p><p><span class="math display">\[f_{i,j}=f_{i-1,j}+f_{i-1,j-1}\times siz_i\]</span></p><p>æœ€åè®¡ç®—æ¯ä¸ªç¯çš„è´¡çŒ®å³å¯ã€‚æ³¨æ„è¿˜è¦ç®—ä¸Šç¯å†…éƒ¨çš„æ’åˆ—ï¼ˆæ³¨æ„å¾ªç¯ä½ç§»ï¼‰ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1), tag(n + 1), s(n + 1, 1), fa(n + 1), siz(n + 1);    std::iota(fa.begin() + 1, fa.end(), 1);    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;        return x == fa[x] ? x : fa[x] = find(fa[x]);    &#125;;    auto merge = [&amp;](int x, int y) &#123;        x = find(x), y = find(y);        if (x != y) &#123;            tag[y] += tag[x];            s[y] += s[x];            fa[x] = y;        &#125;        return;    &#125;;    for (int i = 1; i &lt;= n; ++i)  &#123;        std::cin &gt;&gt; a[i], fa[i] = i;        if (a[i] == -1)            tag[i] = 1;        else            merge(i, a[i]);    &#125;    int cnt1 = 0, cnt2 = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        cnt1 += (fa[i] == i &amp;&amp; !tag[i]);        if (fa[i] == i &amp;&amp; tag[i])            siz[++cnt2] = s[i];    &#125;    auto qkp = [&amp;](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    auto res(cnt1 * qkp(n, cnt2) % mod);    std::vector&lt;std::vector&lt;long long&gt; &gt; f(cnt2 + 1, std::vector&lt;long long&gt; (cnt2 + 1));    f[0][0] = 1ll;    for (int i = 1; i &lt;= cnt2; ++i) &#123;        // printf(&quot;i = %d, siz = %d: \n&quot;, i, siz[i]);        for (int j = 0; j &lt;= i; ++j) &#123;            f[i][j] = f[i - 1][j];            if (j != 0)                (f[i][j] += f[i - 1][j - 1] * siz[i]) %= mod;            // printf(&quot;  f[%d][%d] = %lld\n&quot;, i, j, f[i][j]);        &#125;    &#125;    for (int i = 1; i &lt;= cnt2; ++i) &#123;        static auto fac(1ll);        (res += f[cnt2][i] * fac % mod * qkp(n, cnt2 - i) % mod) %= mod;        (fac *= i) %= mod;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---diameter-cuts">C - Diameter Cuts</h2><p><a href="https://codeforces.com/problemset/problem/1499/F" class="uri">https://codeforces.com/problemset/problem/1499/F</a></p><p>ä»¤ <span class="math inline">\(f_{x,i}\)</span> è¡¨ç¤º <span class="math inline">\(x\)</span> ä¸Šçš„æœ€é•¿é“¾é•¿ä¸º <span class="math inline">\(i\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªç±»ä¼¼èƒŒåŒ…çš„è¿‡ç¨‹æ±‚ç­”æ¡ˆäº†ã€‚å‘ç°è¿™ä¸ªèƒŒåŒ…æ»¡è¶³å¯ä»¥è¢«ä¼˜åŒ–çš„å½¢å¼ï¼Œæ•…èƒ½åœ¨ <span class="math inline">\(O(nk)\)</span> å†…è§£å†³é—®é¢˜ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k, ++k;    if (k == 0) &#123;        std::cout &lt;&lt; 1 &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; h(n + 1);    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (k + 1));    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        f[x][1] = 1ll, h[x] = 1;        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                std::vector&lt;long long&gt; g(k + 1);                g.swap(f[x]);                for (int j = std::min(h[x], k); j; --j)                    for (int l = std::min(h[i], k - j); ~l; --l)                        (f[x][std::max(j, l + 1)] += g[j] * f[i][l] % mod) %= mod;                h[x] = std::max(h[x], h[i] + 1);            &#125;        for (int i = 1; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)            (f[x][0] += f[x][i]) %= mod;        // for (int i = 0; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)        //     printf(&quot;f[%d][%d] = %lld\n&quot;, x, i, f[x][i]);        return;    &#125;;    DFS(1, -1);    auto res(0ll);    for (int i = 1; i &lt;= k; ++i)        (res += f[1][i]) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d---leaf-partition">D - Leaf Partition</h2><p><a href="https://codeforces.com/problemset/problem/1146/F" class="uri">https://codeforces.com/problemset/problem/1146/F</a></p><p>å‡è®¾å·²ç»å®Œæˆåˆ†ç»„ï¼Œæ¬²åˆ¤å®šè¿™ç§æ–¹å¼æ˜¯å¦åˆæ³•ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ¯ä¸€ç»„å¶å­å»ºç«‹è™šæ ‘ï¼Œåˆ™è¯¥åˆ†ç»„æ–¹å¼åˆæ³•ï¼Œå½“ä¸”ä»…å½“æ²¡æœ‰ä¸€ä¸ªç‚¹è¢«å¤šä¸ªè™šæ ‘å ç”¨ã€‚ä¹Ÿå³ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ€»çš„è™šæ ‘ä¸Šé€‰å‡ºä¸€äº›ç‚¹ï¼Œè®©å®ƒä»¬å¯ä»¥è¦†ç›–æ‰€æœ‰å¶å­ã€‚</p><p>è™šæ ‘ä¸Š DPï¼Œå®¹æ˜“å‘ç°å½“ä¸”ä»…å½“å­˜åœ¨ <span class="math inline">\(\ge 2\)</span> ä¸ªå„¿å­æƒ³è¦åˆ†è¿›åŒä¸€ä¸ªè™šæ ‘æ—¶ï¼Œ<span class="math inline">\(i\)</span> ä¼šè¢«é€‰åˆ°ã€‚æ•…ä»¤ <span class="math inline">\(f_{i, 0/1/2}\)</span> è¡¨ç¤ºå½“å‰æœ‰ <span class="math inline">\(0/1/\ge 2\)</span> ä¸ªå„¿å­æƒ³è¦é€‰æ‹© <span class="math inline">\(i\)</span> æ—¶çš„æ–¹æ¡ˆæ•°ï¼ŒDP å³å¯ã€‚</p><p>åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç°æ ¹æœ¬ä¸éœ€è¦æ±‚è™šæ ‘ï¼ŒåŸæ ‘ä¸Š DP å°±å¯ä»¥äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; fa(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 2; i &lt;= n; ++i)        std::cin &gt;&gt; fa[i], g[fa[i]].push_back(i);    std::vector&lt;std::array&lt;long long, 3&gt; &gt; f(n + 1);    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        if (g[x].empty())            f[x][2] = 1ll;        else            f[x][0] = 1ll;        for (auto i : g[x]) &#123;            DFS(i);            auto F0 = (f[i][0] + f[i][2]) % mod, F1 = (f[i][1] + f[i][2]) % mod;            f[x][2] = (f[x][2] * F0 % mod + f[x][2] * F1 % mod + f[x][1] * F1 % mod) % mod;            f[x][1] = (f[x][1] * F0 % mod + f[x][0] * F1 % mod) % mod;            (f[x][0] *= F0) %= mod;        &#125;        // printf(&quot;%d: %lld / %lld / %lld\n&quot;, x, f[x][0], f[x][1], f[x][2]);        return;    &#125;;    DFS(1);    std::cout &lt;&lt; (f[1][0] + f[1][2]) % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="e---uniformly-branched-trees">E - Uniformly Branched Trees</h2><p><a href="https://codeforces.com/problemset/problem/724/F" class="uri">https://codeforces.com/problemset/problem/724/F</a></p><p>æ„Ÿè§‰æ˜¯å¾ˆå¸¸è§çš„å¥—è·¯ï¼Œä½†æ˜¯æˆ‘ä¸ä¼š ğŸ˜±</p><p>åœ¨æ‰‹ç©æ ·ä¾‹çš„æ—¶å€™å¯ä»¥æ„Ÿæ€§è®¤çŸ¥åˆ°ï¼Œæ¯ä¸ªæ ‘ä¼šè¢«æ¯ç§ç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µç»Ÿè®¡ä¸€æ¬¡ã€‚ä¸”å¦‚æœå›ºå®šä»¥æŸç§ï¼ˆåŒ–å­¦ç¯å¢ƒï¼‰çš„ç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥é€šè¿‡æŒ‰ siz ä»å°åˆ°å¤§æ’åˆ—å”¯ä¸€æ±‚è§£å‡ºè¯¥æ ‘ã€‚</p><p>å‘ç°ä»¥é‡å¿ƒä¸ºæ ¹ï¼ˆå³é’¦å®šæ ¹ä¸ºé‡å¿ƒï¼‰å¯ä»¥å¸¦æ¥å¾ˆå¤šä¼˜ç¾çš„æ€§è´¨ã€‚å› ä¸º siz æ˜¯å¥½ç¡®å®šçš„ï¼Œä¸”æ˜¯å„¿å­çš„æ’åºä¾æ®ï¼Œæ‰€ä»¥é€‰é‡å¿ƒä¾¿äºç»Ÿè®¡ï¼ŒåŒæ—¶æ»¡è¶³æ¯ç§æ ‘æœ€å¤šè¢«ç»Ÿè®¡ä¸¤æ¬¡ï¼ˆå½“ä¸”ä»…å½“æœ‰ä¸¤ä¸ªé‡å¿ƒï¼‰ã€‚</p><p>å‘ç°è¿™å°±å˜æˆäº†å¤šé‡é›†çš„ç»„åˆæ•°ï¼Œè®¾ <span class="math inline">\(f_{i,j,k}\)</span> è¡¨ç¤ºå·²ç»èŠ±è´¹ <span class="math inline">\(i\)</span> ä¸ªç‚¹ç»„æˆä¸€ä¸ªå­æ ‘ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹å½“å‰å·²ç»ç¡®è®¤äº† <span class="math inline">\(j\)</span> ä¸ªå„¿å­ï¼Œæœ€é å³çš„ä¸€ä¸ª siz <span class="math inline">\(\le k\)</span> çš„æ–¹æ¡ˆæ•°ã€‚å¾—åˆ° <span class="math inline">\(f_{i,j,k}=\sum_{x=0} f_{i-x\cdot k,j-x,k-1}\cdot \binom{f_{k,d-1,k}+x-1}{x}\)</span>ï¼ˆç›¸å½“äºå°† <span class="math inline">\(x\)</span> ä¸ªæ— æ ‡å·çš„ä½ç½® / çƒåˆ†é…ç»™ <span class="math inline">\(f_{k,d-1,k}\)</span> ä¸ªæœ‰æ ‡å·çš„é€‰é¡¹ / ç›’å­ï¼Œæ’æ¿å³å¯ï¼‰ã€‚</p><p>è‹¥ <span class="math inline">\(n\)</span> ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ç›´æ¥è¾“å‡º <span class="math inline">\(f_{n,d,\lfloor\frac n2\rfloor}\)</span>ï¼›è‹¥ <span class="math inline">\(n\)</span> ä¸ºå¶æ•°ï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸¤ä¸ªé‡å¿ƒï¼Œå³éœ€è¦ç»Ÿè®¡æ‹¥æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸”ä»¥ä¸¤ä¸ªé‡å¿ƒåˆ†åˆ«ä¸ºæ ¹æ—¶é•¿ç›¸ä¸åŒçš„æ ‘ç§ç±»ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¾ç„¶å­˜åœ¨ä¸€æ¡è¾¹ï¼Œå·¦å³ä¸¤è¾¹ siz ç›¸åŒä¸”é•¿ç›¸ä¸åŒã€‚æ•…æ•°é‡ä¸º <span class="math inline">\(\binom{f_{\lfloor \frac n2\rfloor, d-1,\lfloor \frac n2\rfloor}}{2}\)</span>ï¼Œå®¹æ–¥æ‰å³å¯ã€‚</p><p>éœ€è¦ç‰¹åˆ¤ <span class="math inline">\(n\le2\)</span> çš„æƒ…å†µã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, d, mod;    std::cin &gt;&gt; n &gt;&gt; d &gt;&gt; mod;    if (n &lt;= 2) &#123;        std::cout &lt;&lt; 1 &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    using arr = std::vector&lt;long long&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    auto qkp = [&amp;](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    arr inv(d + 1);    inv[0] = inv[1] = 1ll;    auto fac = 1ll;    for (int i = 2; i &lt;= d; ++i) &#123;        (fac *= i) %= mod;        inv[i] = qkp(fac, mod - 2);    &#125;    auto C = [&amp;](long long n, int m) &#123;        if (m == 0)            return 1ll;        if (m &gt; n)            return 0ll;        auto res(1ll);        for (auto i = 0; i &lt; m; ++i)            (res *= n - i) %= mod;        return res * inv[m] % mod;    &#125;;    crr f(n + 1, brr(d + 1, arr(n / 2 + 1)));    f[1][0][0] = 1ll;    for (int i = 1; i &lt;= n; ++i)        for (int j = 0; j &lt;= d &amp;&amp; 1 + j &lt;= i; ++j) &#123;            for (int x = 0; x &lt;= j &amp;&amp; x &lt;= i; ++x)                f[i][j][1] += f[i - x][j - x][0];            f[i][j][1] %= mod;            for (int k = 2; k &lt;= n / 2; ++k) &#123;                // bool flag = (i == 10 &amp;&amp; j == 3 &amp;&amp; k == 3);                for (int x = 0; x &lt;= j &amp;&amp; x * k &lt;= i; ++x) &#123;                    f[i][j][k] += f[i - x * k][j - x][k - 1] * C(f[k][d - 1][k - 1] + x - 1, x);                    // if (flag)                    //     printf(&quot;x = %d, f[%d][%d][%d](%lld) * C(%lld, %d)(%lld)\n&quot;, x, i - x * k, j - x, k - 1, f[i - x * k][j - x][k - 1], f[k][d - 1][k - 1] + x - 1, x, C(f[k][d - 1][k - 1] + x - 1, x));                &#125;                f[i][j][k] %= mod;            &#125;        &#125;    // for (int i = 1; i &lt;= n; ++i)    //     for (int j = 0; j &lt;= d &amp;&amp; j &lt;= i - 1; ++j, puts(&quot;&quot;))    //         for (int k = 0; k &lt;= n / 2; ++k) &#123;    //             printf(&quot;f[%d][%d][%d] = %lld\n&quot;, i, j, k, f[i][j][k]);    //         &#125;    if (n &amp; 1)        std::cout &lt;&lt; f[n][d][n / 2] &lt;&lt; &#39;\n&#39;;    else &#123;        auto res(f[n][d][n / 2]);        res = (res + mod - C(f[n / 2][d - 1][n / 2 - 1], 2)) % mod;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="a---dominant-indices">A - Dominant Indices</h2><p><a href="https://codeforces.com/problemset/problem/1009/F" class="uri">https://codeforces.com/problemset/problem/1009/F</a></p><p>é•¿å‰–æ¿å­ï¼›éš¾ç‚¹åœ¨äºå¯èƒ½è¦å¤ä¹ ä¸€ä¸‹é•¿å‰–æ€ä¹ˆå†™ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; h(n + 1), son(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        h[x] = 1;        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                h[x] = std::max(h[x], h[i] + 1);                if (h[i] &gt; h[son[x]])                    son[x] = i;            &#125;        return;    &#125;;    DFS(1, -1);    std::vector&lt;int&gt; _f(2 * n + 1), res(n + 1);    auto pos(_f.begin());    std::vector&lt;decltype(pos)&gt; f(n + 1);    DFS = [&amp;](int x, int fa) &#123;        ++f[x][0];        if (!son[x]) &#123;            res[x] = 0;            return;        &#125;        f[son[x]] = std::next(f[x]);        DFS(son[x], x);        int mx = -std::max(std::make_pair(f[x][res[son[x]] + 1], -(res[son[x]] + 1)), std::make_pair(1, 0)).second;        for (auto i : g[x])            if (i != fa &amp;&amp; i != son[x]) &#123;                f[i] = pos, pos = std::next(pos, h[i] + 1);                DFS(i, x);                for (int j = 0; j &lt;= h[i]; ++j) &#123;                    f[x][j + 1] += f[i][j];                    if (j + 1 != mx &amp;&amp; std::make_pair(f[x][j + 1], -(j + 1)) &gt; std::make_pair(f[x][mx], -mx))                        mx = j + 1;                &#125;            &#125;        // printf(&quot;%d: &quot;, x);        // for (int i = 0; i &lt;= h[x]; ++i)        //     printf(&quot;%d &quot;, f[x][i]);        // puts(&quot;&quot;);        res[x] = mx;        return;    &#125;;    f[1] = pos, pos = std::next(pos, h[1]);    DFS(1, -1);    for (int i = 1; i &lt;= n; ++i)        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---æ ‘ä¸Šå¼‚æˆ–">B - æ ‘ä¸Šå¼‚æˆ–</h2><p><a href="https://www.luogu.com.cn/problem/P9745" class="uri">https://www.luogu.com.cn/problem/P9745</a></p><p>å’Œ <a href="#a---svjetlo">Svjetlo</a> å¾ˆåƒï¼ŒæŠŠè¿é€šå—çš„å¼‚æˆ–å’Œæ”¾åˆ°çŠ¶æ€é‡Œï¼Œæ‹†ä½åä»¤ <span class="math inline">\(f_{i,j,0/1}\)</span> è¡¨ç¤ºç‚¹ <span class="math inline">\(i\)</span> æ‰€åœ¨çš„è¿é€šå—åœ¨ç¬¬ <span class="math inline">\(j\)</span> ä½å¼‚æˆ–å’Œä¸º <span class="math inline">\(0/1\)</span> çš„æƒå€¼ï¼ˆ<strong>ä¸è®¡ <span class="math inline">\(i\)</span> æ‰€åœ¨è¿é€šå—</strong>ï¼‰ï¼Œè½¬ç§»å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 2, x; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; x;        g[x].push_back(i), g[i].push_back(x);    &#125;    std::vector&lt;long long&gt; dp(n + 1);    std::vector&lt;std::array&lt;std::array&lt;long long, 2&gt;, 60&gt; &gt; f(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        for (int i = 0; i &lt; 60; ++i)            f[x][i][(a[x] &gt;&gt; i) &amp; 1] = 1ll;        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                for (int j = 0; j &lt; 60; ++j) &#123;                    auto f1 = f[x][j];                    f[x][j][0] = (f1[0] * dp[i] % mod + f1[0] * f[i][j][0] % mod + f1[1] * f[i][j][1] % mod) % mod;                    f[x][j][1] = (f1[1] * dp[i] % mod + f1[0] * f[i][j][1] % mod + f1[1] * f[i][j][0] % mod) % mod;                &#125;            &#125;        for (int i = 0; i &lt; 60; ++i)            dp[x] += (1ll &lt;&lt; i) % mod * f[x][i][1] % mod;        dp[x] %= mod;        return;    &#125;;    DFS(1, -1);    std::cout &lt;&lt; dp[1] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---ä¸€ä¸ªç½‘çš„è·¯">C - ä¸€ä¸ªç½‘çš„è·¯</h2><p><a href="https://www.luogu.com.cn/problem/P8595" class="uri">https://www.luogu.com.cn/problem/P8595</a></p><p>é¦–å…ˆéœ€è¦æ„è¯†åˆ°ï¼Œæ ‘å’Œé“¾çš„è¾¹æ•°æ˜¯ä¸€æ ·çš„ï¼Œç‚¸æ‰äº†å¤šå°‘æ¡è¾¹ï¼Œåœ¨ä¹‹åå°±ä¼šèŠ±å¤šå°‘ä»£ä»·è¡¥å›æ¥ã€‚æ•…ç‚¸ä¸€ä¸ªç‚¹çš„ä»£ä»·ä¸ºåº¦æ•° +1ã€‚å¯¹äºä¸€ä¸ªç‚¹ <span class="math inline">\(u\)</span>ï¼Œåˆ†ä¸ºå››ç§å¯èƒ½æ€§ï¼š</p><ul><li>è¢«ç‚¸äº†ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿é€šå—ã€‚</li><li>æ²¡è¢«ç‚¸ï¼Œå„¿å­å…¨éƒ¨è¢«ç‚¸äº†ã€‚</li><li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 1 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li><li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 2 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li></ul><p>åˆ†åˆ«ç”¨ <span class="math inline">\(f_{u,0/1/2/3}\)</span> ä»£è¡¨ä¸Šé¢å››ç§å¯èƒ½æ€§ï¼Œè½¬ç§»å³å¯ã€‚</p><p>è´ºäº†ä¸ª freadï¼Œæ“¦è¾¹è·‘è¿‡äº†ã€‚è¿™ä¸ªä¸æ˜¯ <span class="math inline">\(O(n)\)</span> çš„å—ï¼Ÿ</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int LEN = (1 &lt;&lt; 20);#ifdef ONLINE_JUDGEint nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF;        p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifbool read(int &amp;x) &#123;    x = 0;    bool f = 0;    char ch = nec();    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;void print(int x) &#123;    if (x &lt; 0)        putchar(&#39;-&#39;), x = -x;    if (x &gt;= 10) print(x / 10);    putchar(x % 10 + &#39;0&#39;);    return;&#125;void print(int x, char ch) &#123;    print(x), putchar(ch);    return;&#125;int main() &#123;    int n, m;    read(n), read(m);    int res = (n - 1) - m;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int x, y; m--; ) &#123;        read(x), read(y);        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; tag(n + 1);    std::vector&lt;std::array&lt;int, 4&gt; &gt; f(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        tag[x] = 1;        f[x][0] = (fa != -1) + 1;        f[x][2] = f[x][3] = 0x3f3f3f3f;        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                f[x][3] = std::min(f[x][3] + f[i][0], f[x][2] + std::min(f[i][1], f[i][2]));                f[x][2] = std::min(f[x][2] + f[i][0], f[x][1] + std::min(f[i][1], f[i][2]));                f[x][1] += f[i][0];                f[x][0] += std::min(&#123; f[i][0] - 1, f[i][1], f[i][2], f[i][3] &#125;) + 1;            &#125;        return;    &#125;;    for (int i = 1; i &lt;= n; ++i)        if (!tag[i]) &#123;            DFS(i, -1);            res += *std::min_element(f[i].begin(), f[i].end());        &#125;    print(res, &#39;\n&#39;);    return 0;&#125;</code></pre></details><hr /><h2 id="d---éšæœºæ ‘">D - éšæœºæ ‘</h2><p><a href="https://www.luogu.com.cn/problem/P3830" class="uri">https://www.luogu.com.cn/problem/P3830</a></p><p>å¯¹äºç¬¬ä¸€é—®ï¼Œä»¤ <span class="math inline">\(f_x\)</span> è¡¨ç¤ºå…±æœ‰ <span class="math inline">\(x\)</span> ä¸ªå¶å­æ—¶çš„æœŸæœ›æ·±åº¦ï¼Œä¸¤ä¸ªæ–°å¶å­çš„æœŸæœ›æ·±åº¦ä¸º <span class="math inline">\(f_{x-1}+1\)</span>ï¼Œdelta ä¸º <span class="math inline">\(f_{x-1}+2\)</span>ï¼Œæ•…æœ‰ <span class="math inline">\(f_x=\dfrac {(x-1)f_{x-1}+f_{x-1}+2}x\)</span>ï¼Œé€’æ¨å³å¯ã€‚</p><p>å¯¹äºç¬¬äºŒé—®ï¼Œä»¤ <span class="math inline">\(f_{x,k}\)</span> è¡¨ç¤ºæœ‰ <span class="math inline">\(x\)</span> ä¸ªå¶å­ï¼Œæ·±åº¦ <span class="math inline">\(\ge k\)</span> çš„æ¦‚ç‡ï¼ˆä¸€ç§ç†è§£æ˜¯ä»æ•´æ•°æ¦‚ç‡å…¬å¼çš„è§’åº¦å‡ºå‘ï¼‰ã€‚åˆ™è€ƒè™‘æšä¸¾å·¦ã€å³å¶å­æ•°ï¼Œå¯¹äºå·¦ä¾§å¶å­æ•°ä¸º <span class="math inline">\(i\)</span> çš„æƒ…å†µï¼Œ<strong>ä¸ºäº†å»é‡ï¼Œåªé€‰æ‹©æ·±åº¦ä¸º <span class="math inline">\(k-1\)</span> çš„å¶å­å±•å¼€</strong>ã€‚åªè€ƒè™‘æŸç§ç»„åˆçš„å‡ºç°æ¦‚ç‡ï¼Œä¸º <span class="math inline">\(f_{i,k-1}+f_{x-i,k-1}-f_{i,k-1}\cdot f_{x-i,k-1}\)</span>ã€‚æ•°å½’å¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»æ„ <span class="math inline">\(i\)</span>ï¼Œæ·±åº¦ä¸º <span class="math inline">\(k-1\)</span> çš„å¶å­è¢«é€‰ä¸­çš„æ¦‚ç‡å‡ä¸º <span class="math inline">\(\dfrac 1{x-1}\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int q, n;    std::cin &gt;&gt; q &gt;&gt; n;    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(6);    if (q == 1) &#123;        std::vector&lt;double&gt; f(n + 1);        for (int i = 2; i &lt;= n; ++i)            f[i] = (f[i - 1] * (i - 1) + f[i - 1] + 2.) / i;        std::cout &lt;&lt; f[n] &lt;&lt; &#39;\n&#39;;    &#125;    else &#123;        std::vector&lt;std::vector&lt;double&gt; &gt; f(n + 1, std::vector&lt;double&gt; (n + 1));        for (int i = 1; i &lt;= n; ++i) &#123;            f[i][0] = 1.;            for (int j = 1; j &lt; i; ++j) &#123;                auto s(0.);                for (int k = 1; k &lt; i; ++k)                    s += f[k][j - 1] + f[i - k][j - 1] - f[k][j - 1] * f[i - k][j - 1];                f[i][j] = s / (i - 1);            &#125;        &#125;        auto res(0.);        for (int i = 1; i &lt; n; ++i)            res += f[n][i];        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="e---complete-compress">E - Complete Compress</h2><p><a href="https://atcoder.jp/contests/agc034/tasks/agc034_e" class="uri">https://atcoder.jp/contests/agc034/tasks/agc034_e</a></p><p>å¯¹äºé“¾ï¼Œå‘ç°å¯ä»¥æšä¸¾æœ€åèšé›†çš„ç‚¹ï¼Œç­”æ¡ˆä¸é…å¯¹æ–¹å¼æ— å…³ï¼Œcheck æ˜¯å¦èƒ½é…å¯¹å³å¯ã€‚</p><p>å¦‚æœä¸æ˜¯é“¾ï¼Œåˆ™ç›¸æ¯”é“¾ï¼Œè¿˜å¯ä»¥é€‰æ‹©åŒä¸€å­æ ‘ä¸­ä¸å­˜åœ¨ç¥–å­™å…³ç³»çš„ä¸¤ä¸ªç‚¹ï¼Œå°†å®ƒä»¬éƒ½å‘ LCA ç§»ä¸€æ­¥ã€‚</p><p>æ•…è€Œï¼Œå¯ä»¥åœ¨é“¾çš„åšæ³•ä¸Šæ‰“ä¸€ä¸ªè¡¥ä¸ï¼Œè§‚å¯Ÿåˆ°å…ˆã€å†…éƒ¨æ¶ˆåŒ–ã€ï¼Œå†åœ¨å­æ ‘é—´é…å¯¹ä¸€å®šä¸åŠ£ï¼Œä¸”ç­”æ¡ˆä»ç„¶å’Œé…å¯¹æ–¹å¼æ— å…³ã€‚æ•…ä»¤ <span class="math inline">\(f_x\)</span> è¡¨ç¤ºç‚¹ <span class="math inline">\(x\)</span> å†…æœ€å¤šæ¶ˆæ‰å¤šå°‘å¯¹ï¼Œå°±å¯ä»¥ check äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;line_02.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        char t;        std::cin &gt;&gt; t;        a[i] = t - &#39;0&#39;;    &#125;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    auto res(inf);    for (int i = 1; i &lt;= n; ++i) &#123;        std::vector&lt;int&gt; s(n + 1);        std::vector&lt;long long&gt; f(n + 1), cnt(n + 1);        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;            s[x] = a[x];            int son = 0;            auto sum(0ll);            for (auto i : g[x])                if (i != fa) &#123;                    DFS(i, x), s[x] += s[i];                    sum += cnt[i];                    if (cnt[i] &gt; cnt[son])                        son = i;                &#125;            if (son) &#123;                if (cnt[son] * 2 &lt;= sum)                    f[x] = sum / 2;                else                    f[x] = sum - cnt[son] + std::min(f[son], (cnt[son] - (sum - cnt[son])) / 2);            &#125;            cnt[x] = sum;            if (x != i)                cnt[x] += s[x];            return;        &#125;;        DFS(i, -1);        if (cnt[i] % 2 == 0 &amp;&amp; f[i] == cnt[i] / 2)            res = std::min(res, cnt[i] / 2);    &#125;    if (res == inf)        std::cout &lt;&lt; -1 &lt;&lt; &#39;\n&#39;;    else        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> æ ‘å½¢ DP </tag>
            
            <tag> é•¿é“¾å‰–åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£é¢˜æŠ¥å‘Š [GCJ 2018 #1B] Transmutation</title>
      <link href="/20250726/"/>
      <url>/20250726/</url>
      
        <content type="html"><![CDATA[<p>å¯¹äºã€è·‘ <span class="math inline">\(n\)</span> éã€æ€§è´¨çš„åˆ©ç”¨ã€‚</p><span id="more"></span><hr /><p><a href="https://www.luogu.com.cn/problem/P10805" class="uri">https://www.luogu.com.cn/problem/P10805</a></p><p>å®¹æ˜“æ³¨æ„åˆ°å¯ä»¥äºŒåˆ†ç­”æ¡ˆï¼›ä½†ä¼¼ä¹æ²¡åŠæ³•æ‰¾åˆ°ä¸€ç§å¾ˆå¥½çš„æ–¹æ³•åœ¨ <span class="math inline">\(O(n)\)</span> å†…å®Œæˆä¸€æ¬¡ checkã€‚</p><p>åŒ–ç”¨ä¸€ä¸‹ç½‘ç»œæµä¸­æµé‡çš„æ¦‚å¿µï¼›ä¾‹å¦‚ä¸‹é¢è¿™ä¸ªå›¾ï¼Œå‡å¦‚å…ˆä» <span class="math inline">\(0\)</span> å¼€å§‹è·‘ï¼Œå‘ç°æ²¡åŠæ³•å¾ˆå¥½åœ°ç¡®å®š <span class="math inline">\(8\to 2\)</span> è¿™æ¡è¾¹çš„æµé‡ï¼ˆåŸå› ï¼šæ²¡åŠæ³•ç¡®å®š <span class="math inline">\(8\)</span> å’Œ <span class="math inline">\(2\)</span> çš„æœç´¢é¡ºåºï¼‰ã€‚</p><p><img src="image.png" /></p><p>è¿™ä¸ªæ—¶å€™æƒ³åˆ°ï¼›å¦‚æœæ˜¯ <span class="math inline">\(2\)</span> å…ˆè¢«æœåˆ°ï¼Œè‡ªç„¶å¾ˆå¥½ï¼›ä½†å¦‚æœæ˜¯ <span class="math inline">\(8\)</span> å…ˆè¢«æœåˆ°ï¼Œå¯ä»¥å¿½ç•¥è¿™æ¡ç”±å®ƒå‡ºå‘ã€ä¸”æœªç¡®å®šçš„è¾¹ï¼Œå…ˆç”±ç°åœ¨è®¤ä¸ºçš„æµå‡ºé‡ç¡®å®šæµå…¥é‡ã€‚ç­‰æœåˆ° <span class="math inline">\(2\)</span> çš„æ—¶å€™ï¼Œå†æ›´æ–°ä¸€ä¸‹ <span class="math inline">\(8\to 2\)</span> çš„æµé‡ã€‚è¿™æ · <span class="math inline">\(8\)</span> çš„æµå…¥é‡å°±æ˜¯é”™çš„ï¼›å®¹æ˜“æƒ³åˆ°å†æœä¸€æ¬¡æ¥æ›´æ–°ã€‚</p><p><strong>ç±»æ¯”ä¸€ä¸‹ SPFAï¼Œå¯ä»¥è®¤ä¸ºè·‘ <span class="math inline">\(n\)</span> éå°±å·²ç»è¾¾åˆ°èƒ½æ›´æ–°çš„æœ€ç»ˆçŠ¶æ€</strong>ã€‚æ­¤æ—¶ check ä¸€ä¸‹æ˜¯å¦æ¯ä¸ªç‚¹éƒ½åˆæ³•ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> äºŒåˆ† </tag>
            
            <tag> æš´åŠ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vp è®°å½• edu 181</title>
      <link href="/20250723/"/>
      <url>/20250723/</url>
      
        <content type="html"><![CDATA[<p>tzl å¤ªå¼ºäº†ï¼çœŸæŒšçš„è†œæ‹œ</p><span id="more"></span><p>lhy å¤ªå¼ºäº†ï¼çœŸæŒšçš„è†œæ‹œ</p><hr /><h2 id="e.-sets-of-complementary-sums">E. Sets of Complementary Sums</h2><p><a href="https://codeforces.com/contest/2125/problem/E" class="uri">https://codeforces.com/contest/2125/problem/E</a></p><p>åˆ†æ‹†æ•°ã€å…¶å®æ˜¯ä¸ªä¸ç‰›çš„ä¸œè¥¿ï¼Œä½†æ˜¯å†™å‡äº† ğŸ˜…</p><p>ä»¤é›†åˆå…ƒç´ å‡åºæ’åˆ—ä¸º <span class="math inline">\(b_{1\sim n}\)</span>ã€‚æ˜¾ç„¶æœ‰ç»“è®º <span class="math inline">\(\sum b\geqslant (n-1)(b_n+1)\)</span>ï¼ŒåŒ–ä¸€ä¸‹å°±æœ‰ <span class="math inline">\(b_n\geqslant \left(\sum\limits_{i=1}^{n-1} b_n-b_i\right)+(n-1)\)</span>ã€‚å‘ç° RSH å–å€¼å¯¹ LSH æ— å½±å“ï¼ˆä»å–ç­‰å¼€å§‹ï¼ŒRSH ä¸å˜ï¼Œè‹¥ <span class="math inline">\(b_n\gets b_n+1\)</span>ï¼Œåªéœ€å°†æ¯ä¸ª <span class="math inline">\(b_i\gets b_i+1\)</span> å³å¯æ„é€ å‡ºä¸€ç»„è§£ï¼‰ï¼Œæ•…åªç”¨è€ƒè™‘ RSH çš„æ¯ç§å–å€¼ä¸‹çš„æ–¹æ¡ˆã€‚</p><p>ç„¶åå°±å¯ä»¥åš <a href="/20250807/">åˆ†æ‹†æ•°</a> äº†ã€‚å‘ç°ä¼š MLEï¼Œæ»šåŠ¨å³å¯ã€‚æ¯æ¬¡æš´åŠ› assign ä¼šå¾ˆæ…¢ï¼Œå¯ä»¥ç”¨ä¸€ç‚¹å·§æ€æ¸…ç©ºæ»šåŠ¨æ•°ç»„ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        long long n, m;        std::cin &gt;&gt; n &gt;&gt; m;        if (n * (n - 1) / 2 &gt; m) &#123;            std::cout &lt;&lt; 0 &lt;&lt; &#39;\n&#39;;            continue;        &#125;        if (n == 1) &#123;            std::cout &lt;&lt; m &lt;&lt; &#39;\n&#39;;            continue;        &#125;        --n;        std::vector&lt;std::vector&lt;long long&gt; &gt; f(2, std::vector &lt;long long&gt; (m + 1));        f[0][0] = 1ll;        for (int j = 1, at = 1; j &lt;= n; ++j, at ^= 1)            for (int i = 0; i &lt;= m; ++i) &#123;                if (i &lt; j)                    f[at][i] = 0;                else                    f[at][i] = (f[at ^ 1][i - j] + f[at][i - j]) % mod;            &#125;        auto res(0ll);        for (int i = 1; i &lt;= m - n; ++i)            (res += f[n &amp; 1][i] * (m - (i + n) + 1)) %= mod;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="vp-è®°å½•">vp è®°å½•</h2><h3 id="a">A</h3><p>1:43 åˆ‡ã€‚æ‰“ <code>std::</code> è¿˜æ˜¯å¤ªè´¹æ—¶é—´äº†ã€‚</p><h3 id="b">B</h3><p>5:46 åˆ‡ï¼Œçœ‹å®Œé¢˜æ²¡æƒ³åˆ° gcdï¼Œè¾“å‡ºçš„æ—¶å€™æƒ³åˆ°äº†ã€‚è¼èœã€‚</p><h3 id="c">C</h3><p>11:23 åˆ‡ï¼ŒåŸå› æ˜¯å®¹æ–¥ç¬¦å·ä¹±å†™ã€‚</p><h3 id="d">D</h3><p>24:21 åˆ‡ï¼Œä¸­é—´é‡æ„äº†ä¸€æ¬¡å¹¶ä¸”å‰ç¼€å’Œçš„éƒ¨åˆ†è€ƒè™‘å¾—æœ‰ç‚¹é—®é¢˜ã€‚ç»…å£«ï¼ˆ38:35ï¼‰é—®æˆ‘ä¸ºå•¥åšè¿™ä¹ˆå¿«ã€‚</p><h3 id="e.0">E.0</h3><p>çœ‹äº†ä¸€çœ¼æ„Ÿè§‰ä¸å¤ªå¯åšã€‚quack è¯´ F æ¿æ¿ï¼Œæ•…è·³ã€‚</p><h3 id="f">F</h3><p>01:13:41 è‰å®Œã€‚å¥‡æ€ªçš„ WQS äºŒåˆ†æ¿æ¿ã€‚åƒäº†ä¸€å‘ç½šæ—¶ï¼ŒåŸå› æ˜¯æ²¡äººåˆæ³•çš„æ—¶å€™è¦è¾“å‡º <span class="math inline">\(0\)</span>ã€‚ä½†å’Œ maimai çš„ 30 å‘æ¯”èµ·æ¥è¿˜æ˜¯ç›¸å½¢è§ç»Œã€‚ç»…å£«è€ƒè™‘äº†è¿™ä¸ªï¼Œä½†æ˜¯æ²¡åˆ¤ç›®æ ‡ <span class="math inline">\(&lt;\)</span> å½“å‰çš„æƒ…å†µé—æ†¾ 4 é¢˜ç¦»åœºã€‚</p><p>åœºä¸‹çœ‹äº† Diagnosticsï¼Œå‘ç°å…¶å®ç¬¬äºŒå‘æœ‰ä¸ªåœ°æ–¹æ˜¯ RE äº†çš„ï¼ˆé•¿åº¦ä¸è¶³ <span class="math inline">\(6\)</span> æˆ‘çš„ <code>*std::max_element</code> ä¼šé£èµ·æ¥ï¼‰ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥å°±æ˜¯ A äº†ã€‚</p><h3 id="e.1">E.1</h3><p>çŒœåˆ°ç»“è®ºä¹‹åæ­¢æ­¥äºæ­¤ã€‚è¯•ç€æ‰“äº†åˆ†æ‹†æ•°ç„¶åï¼ˆå®é™…ä¸Šæ˜¯ï¼‰å†™æŒ‚äº†ï¼Œæ€€ç–‘è‡ªå·±ç»“è®ºå‡ºé”™ç›´åˆ° 5 é¢˜æ‹›ç¬‘ç¦»åœº ğŸ˜…</p><h3 id="b.1">B.1</h3><p>å“ˆå“ˆ B çš„ gcd æ²¡å¼€ <code>long long</code> è¢« hack äº†ï¼Œrk55 to 6000+</p>]]></content>
      
      
      
        <tags>
            
            <tag> å·®åˆ† </tag>
            
            <tag> èƒŒåŒ… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£é¢˜æŠ¥å‘Š CF1804F Approximate Diameter</title>
      <link href="/20250721/"/>
      <url>/20250721/</url>
      
        <content type="html"><![CDATA[<p>å”‰ç¡®å®æ²¡è§è¿‡è¿™ç§äºŒåˆ†å½¢å¼ã€‚</p><span id="more"></span><hr /><p><a href="https://codeforces.com/problemset/problem/1804/F" class="uri">https://codeforces.com/problemset/problem/1804/F</a></p><p>æ³¨æ„åˆ°è¿™ä¸ªèŒƒå›´åŸºæœ¬ä¸Šå°±æ˜¯ <a href="/20231117/#æ ‘çš„ç›´å¾„å›¾çš„ç›´å¾„">å›¾ç›´å¾„çš„è¿™ä¸ªæ€§è´¨</a>ï¼Œä½†æ˜¯æˆ‘ä¸è®¤è¯† ğŸ˜…</p><p>æ¯æ¬¡ä¿®æ”¹åšä¸€æ¬¡ BFS è¿‡äºæŠ½è±¡ï¼Œå‘ç°è¿™ä¸ªä¸Šç•Œå¤šäº†ä¸ª <span class="math inline">\(2\)</span> çš„ç³»æ•°ï¼ŒæŠŠä¸»å…ƒæ¢æˆ <span class="math inline">\(d\)</span> å¯ä»¥å¾—åˆ° <span class="math inline">\(d\in[0.5s,2s]\)</span>ã€‚æœ‰ä¸€ä¸ªå¾ˆç‰›çš„æ“ä½œï¼Œå‡è®¾åœ¨å½“å‰å›¾ä¸Šæ±‚å‡ºæ¥äº†ä¸€ä¸ª <span class="math inline">\(s&#39;\)</span>ï¼Œæ˜¾ç„¶ä¸€ç›´åŠ è¾¹ï¼Œ<span class="math inline">\(2s\)</span> è¿™ä¸ªä¸Šç•Œæ˜¯åœ¨å˜å°çš„ï¼Œä½†åªè¦ <span class="math inline">\(s&#39;\le 2s\)</span> æˆç«‹ï¼Œ<span class="math inline">\(s&#39;\)</span> å°±ä¸€ç›´å¯ä»¥ä½œä¸ºåŒºé—´é‡Œçš„ä¸€ä¸ªä¼°å€¼ã€‚å¦‚æœä¸æˆç«‹ï¼Œå‘ç°é™¤ä»¥äºŒå°±æˆç«‹äº†ã€‚</p><p>è½¬åŒ–æˆäºŒåˆ† <span class="math inline">\(s&#39;\)</span> æœ€è¿œå¯ä»¥è¾¾åˆ°çš„è·ç¦»å³å¯ã€‚æ¯æ¬¡ <span class="math inline">\(s&#39;\)</span> é™¤ä»¥äºŒï¼Œå…±é™¤äº† <span class="math inline">\(\log n\)</span> æ¬¡ï¼›å¤æ‚åº¦ <span class="math inline">\(O(n\log^2 n)\)</span>ã€‚</p><p>ç„¶åæ³¨æ„ä¸è¦æ¯æ¬¡ check éƒ½å¤åˆ¶ä¸€éåŸæ•°ç»„ç„¶ååŠ è¾¹ï¼›åº”è¯¥é¢„å…ˆåœ¨åŸå›¾ä¸ŠåŠ å¥½æ‰€æœ‰è¾¹ï¼Œè®°å½•ç‰ˆæœ¬ã€‚åŸå› æ˜¯ç”³è¯·ç©ºé—´ç‰¹åˆ«è´¹æ—¶é—´ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, q;    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);    for (int x, y; m--; ) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].emplace_back(y, 0), g[y].emplace_back(x, 0);    &#125;    for (int i = 1, x, y; i &lt;= q; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].emplace_back(y, i), g[y].emplace_back(x, i);    &#125;    std::vector&lt;int&gt; mem(q + 1, -1);    auto calc = [&amp;](int id) &#123;        if (~mem[id])            return mem[id];        std::queue&lt;std::pair&lt;int, int&gt; &gt; q;        std::vector&lt;int&gt; tag(n + 1);        q.emplace(1, 0), tag[1] = 1;        int mx = 0;        for (; !q.empty(); ) &#123;            auto [x, w] = q.front();            q.pop(), mx = w;            for (auto [i, ver] : g[x])                if (ver &lt;= id &amp;&amp; !tag[i]) &#123;                    tag[i] = 1;                    q.emplace(i, w + 1);                &#125;        &#125;        return mem[id] = mx;    &#125;;    int s = calc(0);    for (int i = 0; i &lt;= q; ) &#123;        int j = i;        for (int l = i + 1, r = q, mid; l &lt;= r; ) &#123;            mid = (l + r) &gt;&gt; 1;            if (s &lt;= 2 * calc(mid))                j = mid, l = mid + 1;            else                r = mid - 1;        &#125;        for (; i &lt;= j; ++i)            std::cout &lt;&lt; s &lt;&lt; &#39; &#39;;        s /= 2;    &#125;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> äºŒåˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€é€šçŸ¥ã€‘åŒºé—´æœ€å€¼ä¸æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼</title>
      <link href="/20250720/"/>
      <url>/20250720/</url>
      
        <content type="html"><![CDATA[<p>èŠ±è´¹ä¸¤å¤©ï¼Œç‰¹æ­¤é€šå‘Šã€‚</p><span id="more"></span><p>ä»¥ä¸Šã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> DP ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»ƒä¹  æ ‘çš„å„ç§æ€§è´¨ II</title>
      <link href="/20250717/"/>
      <url>/20250717/</url>
      
        <content type="html"><![CDATA[<p>å¥½åƒç¡®å®æ¯”æ–œä¼˜åšç€èˆ’æœã€‚</p><span id="more"></span><hr /><h2 id="a---perfect-matching-on-a-tree">A - Perfect Matching on a Tree</h2><p><a href="https://atcoder.jp/contests/abc362/tasks/abc362_f" class="uri">https://atcoder.jp/contests/abc362/tasks/abc362_f</a></p><p>è‚¯å®šç›´æ¥çŒœä»¥é‡å¿ƒä¸ºæ ¹ã€‚</p><p>è‡³äºå’‹æ±‚ç­”æ¡ˆï¼Œï¼ˆæ˜¾ç„¶å€¼æ˜¯æ‰€æœ‰ç‚¹çš„æ·±åº¦ä¹‹å’Œï¼‰ï¼Œè¿™ä¸ªæˆ‘å»å¹´åœ¨åœºä¸Šè¢«å¡ä½äº†ï¼Œè¿˜æ˜¯å¤ªèœäº†ã€‚ç°åœ¨çœ‹æ¥ä¸æ˜¯å¾ˆç‰›çš„ã€‚</p><p>éšä¾¿ä¹±èƒ¡ä¸€ä¸‹ï¼Œå‘ç°å°±æ˜¯æŠŠè‹¥å¹²æ¡çº¿æ®µé™ˆåˆ—åˆ°ä¸¤ä¸ªä¸Šä¸‹å¯¹é½ã€é•¿åº¦ä¸º <span class="math inline">\(n\div 2\)</span> çš„ç›’å­é‡Œã€‚å®¹æ˜“æƒ³åˆ°å“ªè¾¹æ›´ç©ºæ”¾å“ªè¾¹çš„è´ªå¿ƒç­–ç•¥ï¼Œå½“æœ€åè¿˜å‰©ä¸€æ¡çº¿æ®µçš„æ—¶å€™ï¼Œä¸¤ä¸ªç›’å­éƒ½ä¼šå‰©ä¸‹ä¸€æˆªã€‚</p><p>å¦‚æœç›´æ¥å¡è¿›å»è‚¯å®šæ˜¯éæ³•çš„ï¼Œè¿™ä¸ªæ—¶å€™æƒ³åˆ°æŠŠä¸‹é¢çš„è¿™ä¸€èŠ‚æ”¾åˆ°ä¸‹é¢ç›’å­çš„å¼€å¤´ï¼Œå…¶ä»–çš„ä¾æ¬¡åç§»å³å¯ã€‚ç”±äºé‡å¿ƒçš„æ¯ä¸ªå„¿å­å¤§å°ä¸è¶…è¿‡ç›’å­é•¿åº¦ï¼Œæ‰€ä»¥ç§»äº†ä¹‹åè‚¯å®šä¸é‡åˆã€‚ä¸”å®¹æ˜“å‘ç°åªä¼šæ¢è¡Œä¸€æ¬¡ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; siz(n + 1);    int rt = 0;    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        siz[x] = 1;        bool flag = 1;        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                siz[x] += siz[i];                if (siz[i] &gt; n / 2)                    flag = 0;            &#125;        if (flag &amp;&amp; n - siz[x] &lt;= n / 2)            rt = x;        return;    &#125;;    DFS(1, -1);    std::vector&lt;std::vector&lt;int&gt; &gt; t(n + 1);    for (auto i : g[rt]) &#123;        DFS = [&amp;](int x, int fa) &#123;            t[i].push_back(x);            for (auto i : g[x])                if (i != fa)                    DFS(i, x);            return;        &#125;;        DFS(i, rt);    &#125;    std::deque&lt;int&gt; p1, p2;    int to = n / 2;    for (auto i : g[rt]) &#123;        auto &amp;q1 = (p1.size() &gt; p2.size() ? p2 : p1), &amp;q2 = (p1.size() &gt; p2.size() ? p1 : p2);        for (; !t[i].empty() &amp;&amp; (int)q1.size() &lt; to; q1.push_back(t[i].back()), t[i].pop_back());        for (; !t[i].empty() &amp;&amp; (int)q2.size() &lt; to; q2.push_front(t[i].back()), t[i].pop_back());    &#125;    if (n % 2 == 0)        (p1.size() &lt; p2.size() ? p1 : p2).push_back(rt);    for (; to--; ) &#123;        std::cout &lt;&lt; p1.back() &lt;&lt; &#39; &#39; &lt;&lt; p2.back() &lt;&lt; &#39;\n&#39;;        p1.pop_back(), p2.pop_back();    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="b---miracle-tree">B - Miracle Tree</h2><p><a href="https://atcoder.jp/contests/arc117/tasks/arc117_d" class="uri">https://atcoder.jp/contests/arc117/tasks/arc117_d</a></p><p>å®¹æ˜“å‘ç°ä»»å– <span class="math inline">\(a,b,c\)</span> ä¸‰ç‚¹ï¼Œç”±äºå®ƒä»¬ä¹‹é—´åªæœ‰ä¸€æ¡ç®€å•è·¯å¾„ï¼Œå¯ä»¥è§†ä¸ºä¸€æ¡çº¿æ®µï¼Œå³é€€åŒ–çš„ä¸‰è§’å½¢ã€‚é‚£ä¹ˆç”±ä¸‰è§’å½¢ä¸‰è¾¹å…³ç³»ï¼Œä»»å–ä¸¤è¾¹ä¹‹å’Œéƒ½å¤§äºç­‰äºç¬¬ä¸‰è¾¹ã€‚</p><p>ä¸å¦¨ä»¤ <span class="math inline">\(E(a)&gt;E(b)&gt;E(c)\)</span>ï¼Œä»¥ <span class="math inline">\(d(b,a)+d(b,c)\ge d(a,c)\)</span> ä¸¾ä¾‹ï¼Œæœ‰ <span class="math inline">\(E(a)-E(b)+E(b)-E(c)\ge d(a,c)\)</span> æˆç«‹ï¼›å³ï¼Œè‹¥ <span class="math inline">\((b,a)\)</span> å’Œ <span class="math inline">\((b,c)\)</span> åˆ†åˆ«å·²ç»æ‰¾åˆ°å¯è¡Œè§£ï¼Œåˆ™ <span class="math inline">\((a,c)\)</span> åˆæ³•ã€‚</p><p>ä»è€Œæ¨æ–­å‡ºï¼ŒæŒ‰ç‚¹æƒå°†æ‰€æœ‰ç‚¹ä»å°åˆ°å¤§æ’åºåï¼Œåªéœ€è®©ä»»æ„ç›¸é‚»ä¸¤ç‚¹åˆæ³•ï¼Œåˆ™å…¨æ ‘åˆæ³•ã€‚æ˜“å‘ç°ç­”æ¡ˆæ˜¯æ‰€æœ‰ç›¸é‚»ä¸¤ç‚¹ <span class="math inline">\(dis\)</span> ä¹‹å’Œï¼›ä¹Ÿå³ï¼Œä»ä»»æ„ä¸€ç‚¹å‡ºå‘ï¼Œç»è¿‡å…¨æ ‘æ‰€æœ‰ç‚¹çš„è·¯å¾„å’Œã€‚è¿™ç§é—®é¢˜æˆ‘ä»¬å¾ˆç†Ÿæ‚‰ï¼Œç”±æ¬§æ‹‰åºå¯çŸ¥æ˜¯ä» <span class="math inline">\(2(n-1)\)</span> ä¸ª <span class="math inline">\(w\)</span> ä¸­æŠ èµ°ä¸€æ®µè·¯å¾„é•¿ï¼ˆç»ˆç‚¹åˆ°èµ·ç‚¹ï¼‰ã€‚æƒ³è¦æœ€å°åŒ–ç­”æ¡ˆå°±è¦æœ€å¤§åŒ–è¿™æ®µè·¯å¾„é•¿ï¼Œå–ç›´å¾„å³å¯ã€‚</p><p>æœ€åçš„ç­”æ¡ˆåºåˆ—æŒ‰ç…§æ¬§æ‹‰åºç›´æ¥æ±‚å³å¯ï¼ˆæ³¨æ„ç›´å¾„çš„ç«¯ç‚¹è¦åœ¨åºåˆ—ä¸¤ç«¯ï¼‰ï¼Œå®ç°ä¸Šåº”è¯¥å¯ä»¥æœ‰ä¸€äº› <span class="math inline">\(O(n)\)</span> å°å·§æ€ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; dep(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        for (auto i : g[x])            if (i != fa) &#123;                dep[i] = dep[x] + 1;                DFS(i, x);            &#125;        return;    &#125;;    dep[1] = 1, DFS(1, -1);    int p = std::max_element(dep.begin() + 1, dep.end()) - dep.begin();    dep[p] = 1, DFS(p, -1);    int q = std::max_element(dep.begin() + 1, dep.end()) - dep.begin();    std::vector&lt;int&gt; tag(n + 1);    std::function&lt;bool(int, int)&gt; DFS1 = [&amp;](int x, int fa) &#123;        if (x == q) &#123;            tag[x] = 1;            return true;        &#125;        for (auto i : g[x])            if (i != fa &amp;&amp; DFS1(i, x)) &#123;                tag[x] = 1;                return true;            &#125;        return false;    &#125;;    DFS1(p, -1);    std::vector&lt;int&gt; res(n + 1);    DFS = [&amp;](int x, int fa) &#123;        static int now = 1;        int son = 0;        if (x != p)            res[x] = now;        for (auto i : g[x])            if (i != fa) &#123;                if (tag[i])                    son = i;                else                    ++now, DFS(i, x), ++now;            &#125;        if (son)            ++now, DFS(son, x); // å›ä¸æ¥äº†ï¼Œæ•…å¯ä»¥ä¸åŠ  ;-)        return;    &#125;;    res[p] = 1, DFS(p, -1);    for (int i = 1; i &lt;= n; ++i)        std::cout &lt;&lt; res[i] &lt;&lt; &#39; &#39;;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---æ ‘çš„è®¡æ•°">C - æ ‘çš„è®¡æ•°</h2><p><a href="https://www.luogu.com.cn/problem/P1232" class="uri">https://www.luogu.com.cn/problem/P1232</a></p><p>éœ€è¦æ„è¯†åˆ° DFS å’Œ BFS åœ°ä½æ˜¯ä¸ç­‰ä»·çš„ï¼šäºŒè€…éƒ½æœ‰è‡ªå·±ç›¸åº”çš„æ€§è´¨ï¼Œä½† BFS çš„æ·±åº¦æ€§è´¨æ›´æ˜“äºä¸Šæ‰‹ã€‚</p><p>ä¸å¦¨è¿›è¡Œé‡æ ‡å·ï¼Œä»¤ BFS åºä¸º <span class="math inline">\(1\sim n\)</span>ã€‚å¯ä»¥åœ¨ BFS ä¸­ä¸æ–­è¿›è¡Œã€åˆ†å±‚ã€å¾—åˆ°ç‚¹çš„æ·±åº¦ä¿¡æ¯ã€‚å‘ç° <span class="math inline">\(1\)</span> åå¿…é¡»åˆ†å‰²ä¸€æ¬¡ï¼Œé™¤æ­¤ä¹‹å¤–æ²¡æœ‰ BFS åºæœ¬èº«å¸¦æ¥çš„é™åˆ¶ã€‚è€ƒè™‘ DFS åºå¯¹æ·±åº¦å¸¦æ¥çš„é¢å¤–é™åˆ¶ï¼š</p><ul><li>å¯¹äº <span class="math inline">\(D_i\)</span> å’Œ <span class="math inline">\(D_{i+1}\)</span>ï¼Œåˆ™ <span class="math inline">\(D_{i+1}\)</span> çš„æ’å…¥ä½ç‚¹ä½äº <span class="math inline">\(1\sim D_i\)</span> çš„é“¾ä¸Šï¼Œåˆ™ <span class="math inline">\(dep_{D_{i+1}}\le dep_{D_i}+1\)</span>ï¼Œå³ BFS åºä¸­ï¼Œ<span class="math inline">\([D_i,D_{i+1})\)</span> é—´æœ‰è‡³å¤šä¸€ä¸ªåˆ†æ®µç‚¹ã€‚</li><li>è™½ç„¶é¢˜é¢æ²¡è¯´ï¼Œä½†æ˜¯è¿™é‡Œ BFS å’Œ DFS éå†å„¿å­çš„é¡ºåºæ˜¯ç›¸åŒçš„ï¼›ç”±äºåœ¨ BFS åºä¸­ <span class="math inline">\(i\)</span> å…ˆäº <span class="math inline">\(i+1\)</span> è¢«éå†ï¼Œï¼ˆç”±äº <span class="math inline">\(dep_i\le dep_{i+1}\le dep_i+1\)</span>ï¼‰ï¼Œæ•…è€Œè‹¥ <span class="math inline">\(dep_i= dep_{i+1}\)</span>ï¼Œåˆ™ DFS å…ˆéå† <span class="math inline">\(i\)</span>ï¼›åä¹‹ï¼Œè‹¥ DFS åºä¸­ <span class="math inline">\(i+1\)</span> æ—©äº <span class="math inline">\(i\)</span> å‡ºç°ï¼ŒBFS åºä¸­ <span class="math inline">\(i\)</span> å¤„å¿…é¡»åˆ†å±‚ã€‚</li></ul><p>åˆ™å¾—åˆ°è‹¥å¹²æ¡é™åˆ¶ï¼Œå½¢å¦‚æŸå¤„å¿…é¡»æ–­ã€æŸåŒºé—´å¿…é¡»æ°å¥½æ–­ä¸€æ¬¡ä¹‹ç±»ã€‚å‘ç°æ¯”è¾ƒéš¾å¤„ç†çš„æ˜¯åŒºé—´å†…æ²¡æœ‰è¦æ±‚ã€æŸä¸ªç‚¹å¿…é¡»æ–­ã€çš„æƒ…å†µï¼›<del>å¯ä»¥å·®åˆ†çº¦æŸ</del> æƒŠè®¶åœ°å‘ç°ï¼Œè¿™ç§æƒ…å†µä¸‹æœ‰ <span class="math inline">\(D_{i+1}=D_i+1\)</span>ï¼ˆå¯ä»¥è€ƒå¯Ÿç¬¬ä¸€ä¸ªæ»¡è¶³ <span class="math inline">\(D_i\ne i\)</span> çš„ç‚¹æ¥æ€è€ƒï¼‰ã€‚è¿™ç‚¹å…¶å®æ˜¯æ¯”è¾ƒéš¾è®ºè¯çš„ï¼Œæ‰€ä»¥æˆ‘ä¹Ÿæ²¡æœ‰æƒ³å¾—å¾ˆæ¸…æ¥šï¼›å¥½åœ¨ä¿¡æ¯ä¹Ÿä¸æ˜¯å¾ˆè¦æ±‚è¯æ˜è¿™ä¸€å—å°±æ˜¯äº†ã€‚</p><p>ç”¨å·®åˆ†å¤„ç†ã€æ°å¥½ä¸€æ¬¡ã€çš„é™åˆ¶ï¼Œæ ‡è®°æŸäº›ç‚¹ä¸èƒ½æ–­ã€‚åˆå§‹é«˜åº¦ä¸º <span class="math inline">\(1\)</span>ï¼›æ¯æ¬¡ã€å¿…é¡»åˆ†æ®µã€ä¼šå¸¦æ¥ <span class="math inline">\(1\)</span> çš„é«˜åº¦ï¼›æ¯æ¬¡ã€å¯èƒ½åˆ†æ®µã€ä¼šå¸¦æ¥ <span class="math inline">\(0.5\)</span> çš„é«˜åº¦ã€‚åŠ èµ·æ¥å°±å¯ä»¥äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;P1232_2.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; d(n + 1), b(n + 1), p(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; d[i];    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; b[i], p[b[i]] = i;    for (int i = 1; i &lt;= n; ++i)        d[i] = p[d[i]];    for (int i = 1; i &lt;= n; ++i)        p[d[i]] = i;    int res = 4;    std::vector&lt;int&gt; tag(n + 1), forbid(n + 1);    for (int i = 2; i &lt; n; ++i)        if (p[i + 1] &lt; p[i])            tag[i] = 1;    std::partial_sum(tag.begin() + 1, tag.end(), tag.begin() + 1);    for (int i = 2; i &lt; n; ++i)        if (d[i + 1] &gt; d[i] &amp;&amp; tag[d[i + 1] - 1] - tag[d[i] - 1]) &#123;            // fprintf(stderr, &quot;forbid [%d, %d)\n&quot;, d[i], d[i + 1]);            forbid[d[i]] += 1, forbid[d[i + 1]] -= 1;        &#125;    std::partial_sum(forbid.begin() + 1, forbid.end(), forbid.begin() + 1);    for (int i = 2; i &lt; n; ++i)        if (p[i] &gt; p[i + 1])            res += 2;        else if (!forbid[i] &amp;&amp; p[i + 1] == p[i] + 1)            res += 1;    std::cout &lt;&lt; res / 2;    if (res &amp; 1)        std::cout &lt;&lt; &quot;.500&quot;;    else        std::cout &lt;&lt; &quot;.000&quot;;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d---alice-and-bob">D - Alice and Bob</h2><p><a href="https://www.luogu.com.cn/problem/P3971" class="uri">https://www.luogu.com.cn/problem/P3971</a></p><p>ä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„æƒ³æ³•æ˜¯ BSTï¼›ä½†æ˜¯è¿™ä¸ªä¸œè¥¿åªèƒ½æ±‚å¯è¡Œè§£ï¼Œæ±‚ä¸äº†æœ€ä¼˜è§£ã€‚</p><p>é¢˜è§£è¯´è§‚å¯Ÿåˆ° <span class="math inline">\(i\)</span> çš„å†³ç­–ç‚¹ä¸€å®šæ˜¯å·¦ä¾§æœ€é å³çš„ä¸€ä¸ª <span class="math inline">\(a_j=a_i-1\)</span>ï¼ˆå¯ä»¥å‡è®¾ <span class="math inline">\(a_j&gt;a_i\)</span> ç„¶ååè¯ï¼‰ã€‚å¦‚æœæŠŠ <span class="math inline">\(j\)</span> å‘ <span class="math inline">\(i\)</span> è¿è¾¹å¯ä»¥å»ºæ ‘ï¼›æ³¨æ„åˆ°å…±ç”¨ä¸€ä¸ªçˆ¶äº²çš„ç‚¹å€¼æ˜¯é€’å‡çš„ã€‚</p><p>è¦å¾€æ ‘ä¸Šå¡«å€¼ã€‚å®¹æ˜“æƒ³åˆ°ä¸€å±‚ä¸€å±‚å¡«ï¼›å¯æƒœä¸æœ€ä¼˜ï¼ˆåä¾‹å¦‚ä¸‹å›¾ï¼‰ã€‚</p><figure><img src="image.png" alt="è€ƒå¯Ÿä» 1 å¼€å§‹çš„æœ€é•¿ä¸‹é™å­åºåˆ—ï¼Œå‘ç°æŒ‰å±‚å€’åºå¡«ä¸ä¼˜ã€‚" /><figcaption>è€ƒå¯Ÿä» 1 å¼€å§‹çš„æœ€é•¿ä¸‹é™å­åºåˆ—ï¼Œå‘ç°æŒ‰å±‚å€’åºå¡«ä¸ä¼˜ã€‚</figcaption></figure><p>è€ƒè™‘ã€ä»¥ <span class="math inline">\(i\)</span> å¼€å¤´çš„æœ€é•¿ä¸‹é™å­åºåˆ—é•¿åº¦ã€åœ¨æ ‘ä¸Šçš„å†…æ¶µï¼Œå‘ç°ï¼š</p><ol type="1"><li>åªèƒ½å– <span class="math inline">\(i\)</span> æ‰€åœ¨å­æ ‘å¾€å³çš„éƒ¨åˆ†ï¼›</li><li>å–äº†ç¥–å…ˆå°±ä¸èƒ½å–å„¿å­ï¼›å„¿å­æ ‡å·æ¯”ç¥–å…ˆå¤§ï¼›æ ‡å·è¶Šå¤§è¶Šèƒ½å–ï¼›æœ€ä¼˜è‚¯å®šå–å¶å­ã€‚</li></ol><p><strong>æƒ³è¦å°½é‡å–æ»¡æ‰€æœ‰ <span class="math inline">\(i\)</span> å­æ ‘å³ä¾§çš„æ‰€æœ‰æ¯” <span class="math inline">\(i\)</span> æ ‡å·å¤§çš„å¶å­ï¼Œå°±è¦è®©å®ƒä»¬æ¯” <span class="math inline">\(i\)</span> éƒ½å°</strong>ã€‚è¿™ä¸ªé—®é¢˜æ˜¯ç®€å•çš„ï¼›ä¸€ç§æ–¹æ³•æ˜¯æŒ‰å„¿å­æ ‡å·ä»å¤§åˆ°å°ï¼Œä¸€è¾¹ DFS ä¸€è¾¹èµ‹å€¼ã€‚æš‚æ—¶æ²¡æƒ³åˆ°ä¸ç”¨è¿˜åŸåºåˆ—ã€log æ±‚ç­”æ¡ˆçš„ç»Ÿè®¡æ–¹æ³•ã€‚</p><figure><img src="image-1.png" alt="é™„ï¼šä¸¤ç§æ–¹å¼å¯¹æ¯”" /><figcaption>é™„ï¼šä¸¤ç§æ–¹å¼å¯¹æ¯”</figcaption></figure><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 1e5 + 5;struct &#123; int l, r, u; &#125; t[maxn &lt;&lt; 2];#define lt (p &lt;&lt; 1)#define rt (lt | 1)void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r;    if (l == r)        return;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    return;&#125;void add(int p, int x, int v) &#123;    t[p].u = std::max(t[p].u, v);    if (t[p].l == t[p].r)        return;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (x &lt;= mid)        add(lt, x, v);    else        add(rt, x, v);    return;&#125;int ask(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p].u;    int mid = (t[p].l + t[p].r) &gt;&gt; 1, res = 0;    if (l &lt;= mid)        res = ask(lt, l, r);    if (r &gt; mid)        res = std::max(res, ask(rt, l, r));    return res;&#125;#undef lt#undef rtint main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    std::vector&lt;int&gt; a(n + 1), la(n + 1), deg(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        g[la[a[i] - 1]].push_back(i), ++deg[la[a[i] - 1]];        la[a[i]] = i;    &#125;    std::vector&lt;int&gt; u(n + 1), b(n + 1);    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        static int now = 0;        u[x] = now++;        std::reverse(g[x].begin(), g[x].end());        for (auto i : g[x])            DFS(i);        return;    &#125;;    DFS(0);    bld(1, 1, n);    for (int i = n; i; --i) &#123;        b[i] = ask(1, 1, u[i] - 1) + 1;        add(1, u[i], b[i]);    &#125;    // for (int i = 1; i &lt;= n; ++i)    //     std::cout &lt;&lt; b[i] &lt;&lt; &#39; &#39;;    // std::cout &lt;&lt; &#39;\n&#39;;    std::cout &lt;&lt; std::accumulate(b.begin() + 1, b.end(), 0ll) &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="e---tree-factory">E - Tree Factory</h2><p><a href="https://codeforces.com/problemset/problem/1225/F" class="uri">https://codeforces.com/problemset/problem/1225/F</a></p><p>é¦–å…ˆæŠŠé¢˜æ„è½¬åŒ–ä¸ºã€æ¯æ¬¡å¯ä»¥æŠŠä¸€ä¸ªå­æ ‘ä¸‹ç§»ï¼Œè¦æ±‚æŠŠä¸€ä¸ªæ ‘è½¬åŒ–ä¸ºä¸€æ¡é“¾ã€ã€‚å¯ä»¥è¿›è¡Œä¸€äº›è§‚å¯Ÿï¼š</p><ul><li>ä¸€æ¬¡ç§»åŠ¨èƒ½äº§ç”Ÿè´¡çŒ®å½“ä¸”ä»…å½“å…¶è®©æ ‘é«˜å¢åŠ  <span class="math inline">\(1\)</span>ã€‚</li><li>å¦‚æœæ¯æ¬¡ç§»åŠ¨éƒ½äº§ç”Ÿè´¡çŒ®ï¼Œæ˜“å‘ç°ç­”æ¡ˆä¸‹ç•Œä¸º <span class="math inline">\(n-\sum mxd_i\)</span>ï¼Œå¯ä»¥å–åˆ°ã€‚</li></ul><p>çœ‹åˆ°æ·±åº¦ç›¸å…³å°±è¦æƒ³åˆ°é•¿å‰– ğŸ˜… bro è¿˜æ²¡ ptsd</p><p>å–ä»¥æ ¹ä¸º top çš„é•¿é“¾ï¼Œä»åº•åˆ°é¡¶ä¾æ¬¡å®Œæˆã€å¹¶åˆ°çŸ­é“¾æ‰€åœ¨æ ‘ä¸Šï¼ŒæŠŠæ ‘æ‹†æˆé“¾ã€çš„æ“ä½œã€‚å…·ä½“è¿‡ç¨‹å¤§æ¦‚æ˜¯ä¸€ä¸ª dfn çš„æ„Ÿè§‰ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 2, x; i &lt;= n; ++i)        std::cin &gt;&gt; x, g[x + 1].push_back(i);    std::vector&lt;int&gt; mxd(n + 1), son(n + 1), res, nex(n + 1);    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        mxd[x] = 1;        for (auto i : g[x]) &#123;            DFS(i);            if (mxd[i] + 1 &gt; mxd[x])                son[x] = i, mxd[x] = mxd[i] + 1;        &#125;        return;    &#125;;    DFS(1);    std::vector&lt;int&gt; p;    for (int i = 1; son[i]; i = son[i])        p.push_back(i);    std::function&lt;void(int, int)&gt; merge = [&amp;](int son, int x) &#123;        int la = son;        res.push_back(son);        for (auto i : g[x])            merge(la, i), la = i;        nex[x] = la;        return;    &#125;;    for (int i = (int)p.size() - 1; ~i; --i) &#123;        int la = son[p[i]];        for (auto j : g[p[i]])            if (j != son[p[i]])                merge(la, j), la = j;        nex[p[i]] = la;    &#125;    for (int i = 1; i; i = nex[i])        std::cout &lt;&lt; i - 1 &lt;&lt; &#39; &#39;;    std::cout &lt;&lt; &#39;\n&#39; &lt;&lt; res.size() &lt;&lt; &#39;\n&#39;;    std::reverse(res.begin(), res.end());    for (auto i : res)        std::cout &lt;&lt; i - 1 &lt;&lt; &#39; &#39;;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»ƒä¹  æ ‘çš„å„ç§æ€§è´¨ I</title>
      <link href="/20250716/"/>
      <url>/20250716/</url>
      
        <content type="html"><![CDATA[<p>è¿™ä¸æ¯”æ–œä¼˜åšç€çˆ½ã€‚</p><span id="more"></span><hr /><h2 id="a---tree">A - Tr/ee</h2><p><a href="https://atcoder.jp/contests/arc103/tasks/arc103_c" class="uri">https://atcoder.jp/contests/arc103/tasks/arc103_c</a></p><p>å¯ä»¥å‘ç°ï¼Œç±»ä¼¼åˆ è¾¹çš„é—®é¢˜ï¼Œåˆ å‡ºæ¥çš„è¿é€šå—å½“ä¸­ï¼Œé ä¸‹çš„æ˜¯ä¸€ä¸ªå®Œæ•´çš„å­æ ‘ï¼›å°±å¯ä»¥è½¬åŒ–ä¸ºå­æ ‘é—®é¢˜äº†ã€‚</p><p>å®¹æ˜“æƒ³åˆ°æšä¸¾ <span class="math inline">\(i-1\)</span> æ—¶æ ‘çš„çŠ¶æ€ï¼Œå°è¯•è½¬åŒ–ä¸º <span class="math inline">\(i\)</span> æ—¶çš„çŠ¶æ€ï¼›è¿›ä¸€æ­¥å¯ä»¥èƒ¡å‡ºæ¥ä¸€å †æ–¹æ¡ˆï¼ˆå¤§æ¦‚ï¼‰ï¼Œè¿™é‡Œæˆ‘èƒ¡çš„æ˜¯ï¼Œåˆå§‹è®¾ç½®ä¸€ä¸ªå•ç‚¹ï¼Œ<span class="math inline">\(0\to 1\)</span> å•¥ä¹Ÿä¸å¹²ï¼Œ<span class="math inline">\(0\to 0\)</span> åœ¨å½“å‰æ ¹ä¸Šå†åŠ ä¸€ä¸ªå¶å­ï¼Œ<span class="math inline">\(1\to 0\)</span> æ–°å»ºä¸€ä¸ªå¸¦å¶å­çš„æ ¹å¹¶ä»¤å…¶æˆä¸ºå½“å‰æ ¹çš„çˆ¶äº²ï¼Œ<span class="math inline">\(1\to 1\)</span> åŠ ä¸€ä¸ªçˆ¶äº²ã€‚</p><p>ç„¶åç‰¹åˆ¤ä¸€ä¸‹ <span class="math inline">\(s_1=0\)</span> å’Œ <span class="math inline">\(s_n=1\)</span> å’Œ <span class="math inline">\(s_i\ne s_{n-i}\)</span> çš„æƒ…å†µï¼Œå‘ç°å…¶ä»–æ—¶å€™éƒ½æœ‰è§£ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::string s;    std::cin &gt;&gt; s, n = (int)s.length();    s = &quot;#&quot; + s;    if (s[1] == &#39;0&#39; || s[n] == &#39;1&#39;) &#123;        std::cout &lt;&lt; -1 &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    for (int i = 1; i &lt; n; ++i)        if (s[i] != s[n - i]) &#123;            std::cout &lt;&lt; -1 &lt;&lt; &#39;\n&#39;;            return 0;        &#125;    int tot = 1, rt = 1;    for (int i = 2; i &lt; n; ++i) &#123;        if (tot == i - 1) &#123;            if (s[i] == &#39;0&#39;) &#123;                std::cout &lt;&lt; rt &lt;&lt; &#39; &#39; &lt;&lt; ++tot &lt;&lt; &#39;\n&#39;;                rt = tot;                std::cout &lt;&lt; rt &lt;&lt; &#39; &#39; &lt;&lt; ++tot &lt;&lt; &#39;\n&#39;;            &#125;            else &#123;                std::cout &lt;&lt; rt &lt;&lt; &#39; &#39; &lt;&lt; ++tot &lt;&lt; &#39;\n&#39;;                rt = tot;            &#125;        &#125;        else if (s[i] == &#39;0&#39;)            std::cout &lt;&lt; rt &lt;&lt; &#39; &#39; &lt;&lt; ++tot &lt;&lt; &#39;\n&#39;;    &#125;    if (tot != n)        std::cout &lt;&lt; rt &lt;&lt; &#39; &#39; &lt;&lt; n &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---keep-perfectly-matched">B - Keep Perfectly Matched</h2><p><a href="https://atcoder.jp/contests/arc183/tasks/arc183_d" class="uri">https://atcoder.jp/contests/arc183/tasks/arc183_d</a></p><p>å‘ç°è¿™ä¸ªã€å®Œç¾åŒ¹é…ã€å°±æ˜¯åœ¨æ ‘ä¸Šç»™æ¯ä¸ªç‚¹æ‰¾ç›¸é‚»ç‚¹é…å¯¹ï¼Œçœ‹çœ‹èƒ½ä¸èƒ½é…ä¸Šï¼›ç»§è€Œå‘ç°ç”±äºç‚¹çš„æ€»æ•°ä¸ºå¶ï¼Œä¸€ä¸ªç‚¹æœ‰ä¸”ä»…èƒ½æœ‰ä¸€ä¸ª siz ä¸ºå¥‡çš„å­æ ‘ï¼ˆä¸ç„¶éæ³•ï¼‰ï¼Œå†å‘ç°å¯¹äºä»»æ„ä¸€ä¸ªç‚¹ï¼Œåˆ æ‰çš„ç‚¹å¯¹è¦ä¹ˆæ¥è‡ªå…¶åŒä¸€ä¸ªå­æ ‘ï¼›è¦ä¹ˆä¸€ä¸ªæ¥è‡ªå…¶å¥‡å­æ ‘ï¼Œå¦ä¸€ä¸ªæ¥è‡ªå…¶å¶å­æ ‘ã€‚</p><p>å‘ç°è¦æ±‚æœ€å¤§åŒ–è·ç¦»ï¼Œåˆåªèƒ½åˆ å¶å­ï¼Œæ‰€ä»¥éœ€è¦æœ€å°åŒ– LCA æ·±åº¦ï¼›æœ‰æ²¡æœ‰åŠæ³•è®©æ¯æ¬¡çš„ LCA éƒ½æ˜¯æ ¹å‘¢ï¼Ÿè®©é‡å¿ƒæˆä¸ºæ ¹ï¼Œå¹¶ä¿è¯æ¯æ¬¡æ“ä½œçš„ä¸¤ä¸ªç‚¹éƒ½ä¸æ¥è‡ªåŒä¸€ä¸ªå„¿å­å³å¯ï¼ˆæ˜¾ç„¶è¿™æ ·æ˜¯å®Œå…¨å¯èƒ½çš„ï¼‰ã€‚</p><p>æ¥ç€å†™äº†ä¸€å‘å‘ç°è¿‡ä¸äº†æ ·ä¾‹ï¼ŒåŸå› æ˜¯å‘ç°åœ¨å¶å­æ ‘ä¸­ä¼šå‡ºç°ã€ä¸€ä¸ªä¸­é€”çš„èŠ‚ç‚¹æœ¬æ¥æœ‰ä¸€ä¸ªå¥‡å„¿å­ï¼Œåˆ å»å¶å­æ ‘ä¸­çš„ä¸€ä¸ªå¶å­åéæ³•ã€çš„æƒ…å†µã€‚æ˜¾ç„¶è¿™æ ·çš„èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå¶å„¿å­ã€‚ç¡®ä¿æ¯ä¸ªå¶å„¿å­çš„å¥‡å„¿å­å…ˆè¢«åˆ æ‰å°±å¯ä»¥è§£å†³é—®é¢˜ã€‚</p><p>å¯¹é‡å¿ƒçš„æ¯ä¸ªå„¿å­ï¼Œæå‰è§„åˆ’å…¶èŠ‚ç‚¹è¢«åˆ é™¤çš„é¡ºåºå³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; siz(n + 1);    int rt = 0;    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        siz[x] = 1;        bool flag = 1;        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                siz[x] += siz[i];                if (siz[i] &gt; n / 2)                    flag = 0;            &#125;        if (flag &amp;&amp; n - siz[x] &lt;= n / 2)            rt = x;        return;    &#125;;    DFS(1, -1);    std::vector&lt;std::vector&lt;int&gt; &gt; lf(n + 1);    int f1 = -1;    auto comp = [&amp;](int i, int j) &#123; return siz[i] &lt; siz[j]; &#125;;    std::priority_queue&lt;int, std::vector&lt;int&gt;, decltype(comp)&gt; f0(comp);    siz.assign(n + 1, 0);    for (auto t : g[rt]) &#123;        DFS = [&amp;](int x, int fa) &#123;            siz[x] = 1;            for (auto i : g[x])                if (i != fa) &#123;                    DFS(i, x);                    siz[x] += siz[i];                &#125;            return;        &#125;;        DFS(t, rt);        DFS = [&amp;](int x, int fa) &#123;            if (siz[x] % 2 == 0) &#123;                for (auto i : g[x])                    if (i != fa &amp;&amp; siz[x] % 2 == 1)                        DFS(i, x);                for (auto i : g[x])                    if (i != fa &amp;&amp; siz[x] % 2 == 0)                        DFS(i, x);            &#125;            else                for (auto i : g[x])                    if (i != fa)                        DFS(i, x);            lf[t].push_back(x);            return;        &#125;;        DFS(t, rt);        if (siz[t] &amp; 1)            assert(f1 == -1), f1 = t;        else            f0.push(t);        std::reverse(lf[t].begin(), lf[t].end());    &#125;    fprintf(stderr, &quot;rt = %d\n&quot;, rt);    assert(~f1);    for (int _ = n / 2; _--; ) &#123;        assert(~f1);        if (!_ &amp;&amp; f0.empty()) &#123;            std::cout &lt;&lt; f1 &lt;&lt; &#39; &#39; &lt;&lt; rt &lt;&lt; &#39;\n&#39;;            break;        &#125;        assert(!f0.empty());        int t = f0.top();        f0.pop();        assert(!lf[f1].empty());        assert(!lf[t].empty());        std::cout &lt;&lt; lf[f1].back() &lt;&lt; &#39; &#39; &lt;&lt; lf[t].back() &lt;&lt; &#39;\n&#39;;        lf[f1].pop_back(), --siz[f1];        lf[t].pop_back(), --siz[t];        if (siz[f1])            f0.push(f1);        f1 = t;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="c---fiolki">C - Fiolki</h2><p><a href="https://www.luogu.com.cn/problem/P5578" class="uri">https://www.luogu.com.cn/problem/P5578</a></p><p>éš¾ç‚¹åœ¨äºåˆ¤æ–­æ¯ä¸€æ­¥æœ‰å“ªäº›ååº”å‘ç”Ÿï¼›æ˜¾ç„¶ä¸€ä¸ªååº”åªä¼šåœ¨æŸä¸€æ­¥å‘ç”Ÿã€‚</p><p>å‘ç°å°†å€’æ°´çš„æ“ä½œè§†ä¸ºè¿è¾¹ <span class="math inline">\(b_i\to a_i\)</span>ï¼Œé‚£ä¹ˆå½¢æˆäº†æ£®æ—ï¼ŒæŠŠæ¯ä¸ªååº”ä¸¢åˆ° LCA å¤„ç­‰å¾… checkã€‚</p><p>å‘ç°åœ¨ LCA ä¹‹å¤–ï¼Œä¸¤ç§è¯•å‰‚ä¸å¯èƒ½ç›¸é‡ï¼›æ•…æœ€åéå†ä¸€éååº”åºåˆ—ï¼Œç»´æŠ¤æ¯ç§è¯æ°´å½“å‰æ•°é‡ï¼Œåœ¨æ¯ä¸ªç‚¹å¤„ check å³å¯ã€‚</p><p>å†å‘ç°å¦‚æœæ¯æ¬¡åŠ è¾¹éƒ½åœ¨çˆ¶äº²å¤„ check æ‰€æœ‰å¯èƒ½å‘ç”Ÿçš„ååº”ï¼Œå¤æ‚åº¦è‚¯å®šæ˜¯é”™çš„ï¼›æ•…ç”¨å€å¢æ±‚å‡ºä¸¤ä¸ªç‚¹åœ¨ LCA ä¸‹æ–¹çš„ç‚¹ä½œä¸ºã€æ£€æŸ¥ç‚¹ã€ï¼Œå½“ã€æ£€æŸ¥ç‚¹ã€è¢«åˆå¹¶åˆ°å…¶çˆ¶äº²æ—¶ï¼Œå°±å¯ä»¥ check ä¸€ä¸‹æ£€æŸ¥ç‚¹ä¸Šé¢æŒ‚çš„æ‰€æœ‰è¯¢é—®ã€‚æ˜¾ç„¶æ¯ä¸ªç‚¹ä¸Šçš„è¯¢é—®åªä¼šè¢«æ£€æŸ¥ä¸€æ¬¡ï¼›å¤æ‚åº¦çº¿æ€§ã€‚</p><p>åŠ ä¸Šå€å¢ LCA çš„å¤æ‚åº¦ï¼Œå°±å¯ä»¥ <span class="math inline">\(O(n\log n)\)</span> åœ°å®Œæˆã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, k;    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    std::vector&lt;int&gt; f(n + 1), deg(n + 1), now(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; now[i];    std::iota(f.begin() + 1, f.end(), 1);    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;        return x == f[x] ? x : f[x] = find(f[x]);    &#125;;    auto merge = [&amp;](int x, int y) &#123;        f[find(x)] = find(y);        return;    &#125;;    std::vector&lt;std::pair&lt;int, int&gt; &gt; a(m + 1);    for (int i = 1; i &lt;= m; ++i) &#123;        auto &amp;[x, y] = a[i];        std::cin &gt;&gt; x &gt;&gt; y, ++deg[x];        g[y].push_back(x), merge(x, y);    &#125;    std::vector&lt;int&gt; dep(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; fa(n + 1, std::vector&lt;int&gt; (21));    for (int i = 1; i &lt;= n; ++i)        if (!deg[i]) &#123;            std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;                for (auto i : g[x]) &#123;                    fa[i][0] = x;                    for (int j = 1; j &lt;= 20; ++j)                        fa[i][j] = fa[fa[i][j - 1]][j - 1];                    dep[i] = dep[x] + 1, DFS(i);                &#125;                return;            &#125;;            dep[i] = 1, DFS(i);        &#125;    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; t(n + 1);    for (int x, y; k--; ) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        if (find(x) == find(y)) &#123;            std::pair&lt;int, int&gt; p(x, y);            if (dep[x] != dep[y]) &#123;                if (dep[x] &lt; dep[y])                    std::swap(x, y);                for (int i = 20; ~i; --i)                    if (dep[fa[x][i]] &gt; dep[y])                        x = fa[x][i];                if (fa[x][0] == y) &#123;                    t[x].push_back(p);                    // printf(&quot;add (%d, %d) to %d\n&quot;, p.first, p.second, x);                    continue;                &#125;                x = fa[x][0];            &#125;            for (int i = 20; ~i; --i)                if (fa[x][i] != fa[y][i])                    x = fa[x][i], y = fa[y][i];            t[x].push_back(p), t[y].push_back(p);        &#125;    &#125;    std::iota(f.begin() + 1, f.end(), 1);    auto res(0ll);    for (int i = 1; i &lt;= m; ++i) &#123;        auto [x, y] = a[i];        merge(x, y);        for (auto [p, q] : t[x])            if (find(p) == find(x) &amp;&amp; find(q) == find(x)) &#123;                int u = std::min(now[p], now[q]);                res += 2 * u, now[p] -= u, now[q] -= u;            &#125;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125; </code></pre></details><hr /><h2 id="d---permutation-tree">D - Permutation Tree</h2><p><a href="https://atcoder.jp/contests/arc095/tasks/arc095_d" class="uri">https://atcoder.jp/contests/arc095/tasks/arc095_d</a></p><p>éšä¾¿ç”»å›¾ï¼Œä¼šå‘ç°ï¼Œå¦‚æœæŒ‰å±‚æ•°ä»å°åˆ°å¤§æ ‡å·ï¼Œä¸€ä¸ªç‚¹çš„å„¿å­åªæœ‰æœ€å¤šä¸€ä¸ªä¸æ˜¯å¶å­ã€‚ä¸€è¨€ä»¥è”½ä¹‹ï¼šæ¯›æ¯›è™«ã€‚</p><p>ç„¶åå°±å¯ä»¥åˆ¤æ–­å¯è¡Œæ€§äº†ï¼ˆç›´å¾„å°±æ˜¯è™«èº«ï¼‰ã€‚æ¥ä¸‹æ¥éœ€è¦è€ƒè™‘æœ€å°åŒ–ç­”æ¡ˆå­—å…¸åºçš„é—®é¢˜ï¼Œå‘ç°å¯¹äºä¸€ä¸ªç‚¹çš„å„¿å­ï¼Œå¿…é¡»æ˜¯è™«è¶³åœ¨å…¶å·¦ã€è™«èº«åœ¨å…¶å³ä¸”å¿…é¡»ä¸¥æ ¼æŒ‰ç…§å±‚æ•°æ ‡å·ã€‚</p><p>å­—å…¸åºæ˜¯ä¸ªåè´ªå¿ƒçš„ä¸œè¥¿ï¼Œæ‰€ä»¥å¯ä»¥å¼€å§‹çæï¼šå‘ç°è™«è¶³è¶Šå¤šï¼Œæ ‡å·æ›´å°çš„çˆ¶äº²å°±ä¼šè¶Šé åï¼Œæ‰€ä»¥ä¾æ¬¡æ¯”è¾ƒç”¨ä¸¤ç«¯å¼€å¤´çš„æƒ…å†µï¼Œå¦‚æœåˆ°äº†è™«èº«çš„æŸä¸€æ®µï¼Œå“ªç§çš„å„¿å­æ›´å°‘å°±é€‰è°ï¼Œç„¶åç›´æ¥æŒ‰æœ€å°æ¥æ ‡å·å³å¯ã€‚</p><p>å®é™…ä¸Šç”±äºåªæœ‰ä¸¤ç§æ–¹æ¡ˆï¼Œä½ ä¹Ÿå¯ä»¥ä¸¤è¾¹éƒ½è¯•è¯•ï¼ˆï¼‰</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; dep(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        for (auto i : g[x])            if (i != fa) &#123;                dep[i] = dep[x] + 1;                DFS(i, x);            &#125;        return;    &#125;;    dep[1] = 1, DFS(1, -1);    int p = std::max_element(dep.begin() + 1, dep.end()) - dep.begin();    bool flag = 0;    std::vector&lt;int&gt; node, cnt(n + 1), siz(n + 1);    DFS = [&amp;](int x, int fa) &#123;        siz[x] = 1;        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                siz[x] += siz[i], ++cnt[x];            &#125;        if (siz[x] &gt; 1) &#123;            node.push_back(0), --cnt[x];            for (auto i : g[x]) &#123;                if (i != fa &amp;&amp; siz[node.back()] &gt; 1 &amp;&amp; siz[i] &gt; 1)                    flag = 1;                if (i != fa &amp;&amp; siz[i] &gt; siz[node.back()])                    node.back() = i;            &#125;        &#125;        return;    &#125;;    DFS(p, -1), node.push_back(p);    if (flag) &#123;        std::cout &lt;&lt; -1 &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    for (int i = 0, j = (int)node.size() - 1; i &lt;= j; ++i, --j)        if (cnt[node[i]] &gt; cnt[node[j]]) &#123;            std::reverse(node.begin(), node.end());            break;        &#125;        else if (cnt[node[i]] &lt; cnt[node[j]])            break;    int now = 0;    for (auto i : node) &#123;        int rt = ++now;        for (; cnt[i]--; std::cout &lt;&lt; ++now &lt;&lt; &#39; &#39;);        std::cout &lt;&lt; rt &lt;&lt; &#39; &#39;;    &#125;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="e---isomorphism-freak">E - Isomorphism Freak</h2><p><a href="https://atcoder.jp/contests/agc024/tasks/agc024_d" class="uri">https://atcoder.jp/contests/agc024/tasks/agc024_d</a></p><p><del>åƒåœ¨æ•°æœ‰å¤šå°‘ç§åŒ–å­¦ç¯å¢ƒçš„ H æ˜¯å¯ä»¥è¯´çš„å—</del></p><p>é‰´äºè¿™ä¸ªï¼Œé«˜ä¸­åŒ–å­¦é€‰æ‹©æ€§å¿…ä¿®ä¸‰ï¼Œç»™æˆ‘ä»¬æ‰“ä¸‹çš„åšå®åŸºç¡€ï¼Œæˆ‘ä»¬å¯ä»¥éå¸¸è¿…é€Ÿåœ°æ³¨æ„åˆ°ç­”æ¡ˆå°±æ˜¯åŠå¾„é•¿ã€‚</p><p>ç„¶åæœ€å°‘å¶å­ï¼Œå‘ç°ä¸€çœ¼çªä¸å‡ºæ¥ï¼Œç³Ÿç³•ï¼æ²¡å…³ç³»ï¼Œè§‚å¯Ÿæ ·ä¾‹è¾“å‡ºï¼Œå‘ç°è¿™äº›ç­”æ¡ˆçš„å› æ•°éƒ½æŒºå¤šï¼Œæ•…çŒœæµ‹æ˜¯è‹¥å¹²ä¸ªæ•°ä¹˜èµ·æ¥çš„ï¼›ç„¶åå†å‘ç°æ˜¯æ¯å±‚æœ€å¤§å„¿å­æ•°çš„ä¹˜ç§¯ã€‚</p><p>æšä¸¾ä¸­é—´çš„è¾¹ï¼ˆä»…å½“ç›´å¾„é•¿åº¦ä¸ºå¶æ—¶ï¼‰ã€ç‚¹ï¼ˆå¥‡å¶éƒ½è¡Œï¼‰ä½œä¸ºå¯¹ç§°è½´ / å¯¹ç§°ä¸­å¿ƒçš„æƒ…å†µå– min å³å¯ï¼ˆåŸå› æ˜¯è¦å°½é‡å–é è¿‘ä¸­å¿ƒçš„ <strong>ç‚¹</strong>ï¼‰ï¼Œæ³¨æ„è¾¹ä¸¤ç«¯ç®—ä¸¤ä¸ªå„¿å­æ•°ã€‚</p><p><del>æ‰€ä»¥ä¸ºå•¥ <span class="math inline">\(n\)</span> è¿™ä¹ˆå°</del></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; dep(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        for (auto i : g[x])        if (i != fa) &#123;            dep[i] = dep[x] + 1;            DFS(i, x);        &#125;        return;    &#125;;    dep[1] = 1, DFS(1, -1);    int p = std::max_element(dep.begin() + 1, dep.end()) - dep.begin();    dep[p] = 1, DFS(p, -1);    int q = std::max_element(dep.begin() + 1, dep.end()) - dep.begin();    std::cout &lt;&lt; (dep[q] + 1) / 2 &lt;&lt; &#39; &#39;;    std::vector&lt;int&gt; node;    std::vector&lt;std::pair&lt;int, int&gt; &gt; edge;    if (dep[q] &amp; 1) &#123;        DFS = [&amp;](int x, int fa) &#123;            for (auto i : g[x])                if (i != fa)                    DFS(i, x);            if (dep[x] == (dep[q] + 1) / 2)                node.push_back(x), edge.emplace_back(x, fa);            if (dep[x] == (dep[q] + 1) / 2 + 1)                edge.emplace_back(x, fa);            return;        &#125;;        DFS(p, -1);    &#125;    else &#123;        std::function&lt;bool(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;            if (x == q)                return true;            bool ret = false;            for (auto i : g[x])                if (i != fa)                    ret |= DFS(i, x);            if (ret &amp;&amp; dep[x] == dep[q] / 2 + 1)                edge.emplace_back(x, fa);            return ret;        &#125;;        DFS(p, -1);    &#125;    long long res = inf;    for (auto [x, y] : edge) &#123;        std::vector&lt;int&gt; cnt(n + 1);        std::function&lt;void(int, int, int)&gt; DFS = [&amp;](int x, int fa, int dep) &#123;            int son = 0;            for (auto i : g[x])                if (i != fa)                    ++son, DFS(i, x, dep + 1);            cnt[dep] = std::max(cnt[dep], son);            return;        &#125;;        DFS(x, y, 1), DFS(y, x, 1);        auto now(2ll);        for (int i = 1; i &lt;= n &amp;&amp; cnt[i]; ++i)            now *= cnt[i];        res = std::min(res, now);    &#125;    for (auto rt : node) &#123;        std::vector&lt;int&gt; cnt(n + 1);        std::function&lt;void(int, int, int)&gt; DFS = [&amp;](int x, int fa, int dep) &#123;            int son = 0;            for (auto i : g[x])                if (i != fa)                    ++son, DFS(i, x, dep + 1);            cnt[dep] = std::max(cnt[dep], son);            return;        &#125;;        DFS(rt, -1, 1);        auto now(1ll);        for (int i = 1; i &lt;= n &amp;&amp; cnt[i]; ++i)            now *= cnt[i];        res = std::min(res, now);    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ€ç»´ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»ƒä¹  å†³ç­–å•è°ƒæ€§</title>
      <link href="/20250715/"/>
      <url>/20250715/</url>
      
        <content type="html"><![CDATA[<p>ã€å¿ƒé™è‡ªç„¶å‡‰ã€å¤§æŠµæ˜¯å› ä¸ºæƒ…ç»ªå¹³å’Œæ—¶å‰¯äº¤æ„Ÿç¥ç»å…´å¥‹ï¼Œä½“æ¸©ç•¥æœ‰é™ä½å¯¼è‡´çš„ã€‚å—ï¼Ÿ</p><span id="more"></span><p>å…¶å®æ˜¯å› ä¸ºå¿ƒè„åœè·³åè¡€æ¶²å¾ªç¯ç»ˆæ­¢ã€ä»£è°¢ä¸­æ–­ï¼Œå¯¼è‡´äº§çƒ­ä½äºæ•£çƒ­ï¼ˆï¼Ÿï¼‰</p><hr /><h2 id="a---å¾é€”">A - å¾é€”</h2><p><a href="https://www.luogu.com.cn/problem/P4072" class="uri">https://www.luogu.com.cn/problem/P4072</a></p><p>ç”¨å®Œå…¨å¹³æ–¹å…¬å¼å±•å¼€å¾—åˆ° <span class="math inline">\(m^2\sigma^2=m\left(\sum {x_i}^2\right)-S^2\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(S\)</span> ä¸ºæ±‚å’Œã€‚</p><p>æ‰€ä»¥ç›®æ ‡æ˜¯æœ€å°åŒ– <span class="math inline">\(\sum {x_i}^2\)</span> è¿™ä¸ªä¸œè¥¿ã€‚ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> å¤©èµ°åˆ° <span class="math inline">\(j\)</span>ï¼Œå¾—åˆ°ï¼š</p><p><span class="math display">\[\begin{aligned}f_{i,j}&amp;=\min\{f_{i-1,k}+(s_j-s_k)^2\}\\&amp;=\min\{f_{i-1,k}-2\times s_j\times s_k+{s_k}^2\}+{s_j}^2\end{aligned}\]</span></p><p>æœ€åå¾—åˆ°çš„æ–œç‡å¼å­æ˜¯ <span class="math inline">\(\dfrac {f_{i - 1, a}-f_{i - 1, b}+{s_a}^2-{s_b}^2}{2(s_a-s_b)}&lt;s_j\)</span>ï¼Œç”±äº <span class="math inline">\(s_j\)</span> å•å¢ï¼Œ<del>å•è°ƒé˜Ÿåˆ—ç»´æŠ¤é€’å‡æ–œç‡å³å¯</del> <strong>æ›´æ­£ï¼šæ˜¯é€’å¢æ–œç‡ã€‚åŸå› æ˜¯ <span class="math inline">\(&lt;\)</span> æ˜¯å¼¹å‡ºæ¡ä»¶ï¼Œè€Œéä¿ç•™æ¡ä»¶â€¦â€¦</strong></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e9;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; a(n + 1);    std::vector&lt;long long&gt; s(n + 1);    auto sum(0ll);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        s[i] = s[i - 1] + a[i];        sum += a[i];    &#125;    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));    f[0][0] = 0ll;    for (int i = 1; i &lt;= m; ++i) &#123;        auto f1 = [&amp;](int a, int b) &#123;            return f[i - 1][a] - f[i - 1][b] + s[a] * s[a] - s[b] * s[b];        &#125;;        auto f2 = [&amp;](int a, int b) &#123;            return 2 * (s[a] - s[b]);        &#125;;        std::vector&lt;int&gt; q(n + 1);        int h = 0, t = -1;        q[++t] = i - 1;        for (int j = i; j &lt;= n; ++j) &#123;            for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &lt; s[j] * f2(q[h + 1], q[h]); ++h);            f[i][j] = f[i - 1][q[h]] + (s[j] - s[q[h]]) * (s[j] - s[q[h]]);            for (; h &lt; t &amp;&amp; f1(j, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(j, q[t]); --t);            q[++t] = j;        &#125;    &#125;    std::cout &lt;&lt; m * f[m][n] - sum * sum &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---åˆ·é‡-iii">B - åˆ·é‡ III</h2><p><a href="https://www.luogu.com.cn/problem/P10074" class="uri">https://www.luogu.com.cn/problem/P10074</a></p><p>å‘ç°æœ€åæƒ…å†µå°±æ˜¯æ¯æ¬¡ã€è¯•æ¢ã€éƒ½ä¸ä¸­çš„æƒ…å†µï¼Œå†è¯•æ¢ä¸­æœ€åçš„é‚£ä¸€ä¸ªã€‚ä¸ºå•¥å‘¢ï¼Œç›¸å½“äºæˆ‘ä»¬æ¯æ¬¡æ”»å‡»çš„ä¸€å®šæ˜¯æœªçŸ¥å…ƒç´ ä¸­è¡€æœ€å¤šçš„ä¸€ä¸ªã€‚æ—¢ç„¶å·²ç»è¯•æ¢å‡ºäº†æ¯”é˜ˆå€¼å¤§çš„æ‰€æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ”»å‡»çš„å°±ä¸€å®šæ˜¯é˜ˆå€¼æœ¬èº«ï¼Œå¦‚æœè¿™æ¬¡è·³è¿‡å®ƒï¼Œå®ƒå°±ä¼šæˆä¸ºä¸‹ä¸€æ¬¡è¯•æ¢å¤±è´¥çš„å…ƒç´ ã€‚è¿™æ˜¾ç„¶ä¸å¦‚ä¸€å¼€å§‹å°±ç›´æ¥ç”¨æ–°é˜ˆå€¼è¯•æ¢ã€‚</p><p>ä»å¤§åˆ°å°æ’åºã€‚ä»¤ <span class="math inline">\(f_{j, i}\)</span> è¡¨ç¤ºåªç¡®å®šäº†å‰ <span class="math inline">\(i\)</span> å¤§çš„æ•°ï¼Œå·²ç»æ€äº† <span class="math inline">\(j\)</span> ä¸ªäººçš„æœ€åæƒ…å†µæœ€å°ä»£ä»·ã€‚é‚£ä¹ˆæ˜¾ç„¶è¿™ä¸€æ¬¡çš„é˜ˆå€¼æ˜¯ <span class="math inline">\(a_i\)</span>ã€‚éšä¾¿é€‰å‡ºä¸Šä¸€æ¬¡çš„é˜ˆå€¼ <span class="math inline">\(a_k\)</span>ï¼Œé‚£ä¹ˆä¸­é—´è¿™ä¸€æ®µå¾…ç¡®å®šçš„å…ƒç´ æ•°é‡ä¸º <span class="math inline">\(i-k\)</span>ã€‚é‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[\begin{aligned}f_{j, i}&amp;=\min\limits_{k&lt;i}\{f_{j-1,k}+(i-k)\times a_i\}\\&amp;=\min\limits_{k&lt;i}\{f_{j-1,k}-k\times a_i\}+i\times a_i\end{aligned}\]</span></p><p>ç»è¿‡éªŒè¯ï¼Œè™½ç„¶è¿™ä¸ªå¼å­å’Œé¢˜è§£é•¿å¾—ä¸ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¯¹çš„ <del>å› ä¸ºæˆ‘ n^3 æš´åŠ› A äº†</del></p><p>æ¨å‡ºæ–œä¼˜å½¢å¼ <span class="math inline">\(\dfrac {f_{j-1,A}-f_{j-1,B}}{A-B}&lt;a_i\)</span>ï¼Œä½†æˆ‘çš„æœ‹å‹ï¼Œ<span class="math inline">\(a_i\)</span> æ˜¯é€’å‡çš„ã€‚æ‰€ä»¥ç”¨å•è°ƒæ ˆç»´æŠ¤é€’å¢æ–œç‡å³å¯ã€‚<del>æˆ–è€…ä½ ä¹Ÿå¯ä»¥å­¦ä¹  grisses æ‰“ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—ä¸ŠäºŒåˆ†</del></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e12;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;P10074_4.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;long long&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::sort(a.begin() + 1, a.end(), std::greater&lt;long long&gt; ());    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));    f[0][0] = 0ll;    for (int j = 1; j &lt;= m; ++j) &#123;        std::vector&lt;int&gt; q(n + 1);        int t = -1;        q[++t] = j - 1;        auto f1 = [&amp;](int A, int B) &#123;            return f[j - 1][A] - f[j - 1][B];        &#125;;        auto f2 =[&amp;](int A, int B) &#123;            return A - B;        &#125;;        for (int i = j; i &lt;= n; ++i) &#123;            for (; t &gt;= 1 &amp;&amp; f1(q[t], q[t - 1]) &gt; a[i] * f2(q[t], q[t - 1]); --t);            f[j][i] = f[j - 1][q[t]] + (i - q[t]) * a[i];            for (; t &gt;= 1 &amp;&amp; f1(i, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(i, q[t]); --t);            q[++t] = i;        &#125;    &#125;    auto res(inf);    for (int i = m; i &lt;= n; ++i)        res = std::min(res, f[m][i]);    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---traka">C - TRAKA</h2><p><a href="https://www.luogu.com.cn/problem/P7747" class="uri">https://www.luogu.com.cn/problem/P7747</a></p><p>ç¨å¾®æ‰‹ç©ä¸€ä¸‹å°±å¯ä»¥å‘ç°ï¼Œå‡å¦‚ç¬¬ <span class="math inline">\(j\)</span> ä¸ªäººåœ¨ç¬¬ <span class="math inline">\(i\)</span> æ¬¡çš„å·¥ä½œæ—¶é—´ä¸º <span class="math inline">\([L_{j,i},R_{j,i}]\)</span>ï¼Œç¬¬ <span class="math inline">\(i-1\)</span> æ¬¡ä¸º <span class="math inline">\([L_{j,i-1},R_{j,i-1}]\)</span>ï¼Œé‚£ä¹ˆè¦æ±‚ <span class="math inline">\(L_{j,i}\ge R_{j,i-1}\)</span>ã€‚</p><p>ä»¤ <span class="math inline">\(s_j\)</span> ä¸º <span class="math inline">\(t\)</span> çš„å‰ç¼€å’Œã€‚å‡è®¾ç¬¬ <span class="math inline">\(i-1\)</span> æ¬¡åŠ å·¥äº <span class="math inline">\(x_{i-1}\)</span> å¼€å§‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠä¸Šå¼è½¬å†™ä¸º <span class="math inline">\(x_{i}+s_{j-1}\times f_{i}\ge x_{i-1}+s_j\times f_{i-1}\)</span>ã€‚ä¹Ÿå³ <span class="math inline">\(x_i-x_{i-1}\ge s_j\times f_{i-1}-s_{j-1}\times f_i\)</span>ã€‚</p><p>æ˜¾ç„¶éœ€è¦æ‰¾åˆ°ä¸€ä¸ª <span class="math inline">\(j\)</span> ä½¿å¾— RSH å–å¾—æœ€å¤§å€¼ï¼›ç°åœ¨å°±å¯ä»¥è€ƒè™‘æ–œç‡ä¼˜åŒ–äº†ã€‚ç”±äºæ‰€æœ‰é¡¹éƒ½å’Œ <span class="math inline">\(i\)</span> æœ‰å…³ï¼Œæƒ³åˆ°ä¸¤è¾¹åŒé™¤ <span class="math inline">\(f_{i}\)</span> æ¶ˆæ‰ä¸€ä¸ª <span class="math inline">\(i\)</span> æœ‰å…³çš„ç³»æ•°ï¼Œæœ€ååŒ–å‡ºæ¥çš„æ–œä¼˜å½¢å¼æ˜¯ <span class="math inline">\(\dfrac {s_A-s_B}{s_{A-1}-s_{B-1}}&gt;\dfrac {f_{i-1}}{f_i}\)</span>ã€‚ç”±äº RSH ä¸å•è°ƒï¼ŒæŠŠæ‰€æœ‰ <span class="math inline">\(j\)</span> å¡åˆ°é˜Ÿåˆ—é‡Œç»´æŠ¤é€’å‡æ–œç‡ï¼Œæ‰“äºŒåˆ†å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;long long&gt; a(n + 1), w(m + 1), s(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i], s[i] = s[i - 1] + a[i];    for (int i = 1; i &lt;= m; ++i)        std::cin &gt;&gt; w[i];    std::vector&lt;long long&gt; f(m + 1);    std::vector&lt;int&gt; q(n + 1);    int h = 0, t = -1;    q[++t] = 1;    for (int i = 2; i &lt;= n; ++i) &#123;        for (; h &lt; t &amp;&amp; (s[i] - s[q[t]]) * (s[q[t] - 1] - s[q[t - 1] - 1]) &gt; (s[q[t]] - s[q[t - 1]]) * (s[i - 1] - s[q[t] - 1]); --t);        q[++t] = i;    &#125;    for (int i = 2; i &lt;= m; ++i) &#123;        int to = q[h];        for (int l = h + 1, r = t, mid; l &lt;= r; ) &#123;            mid = (l + r) &gt;&gt; 1;            if ((s[q[mid]] - s[q[mid - 1]]) * w[i - 1] &gt; w[i] * (s[q[mid] - 1] - s[q[mid - 1] - 1]))                to = q[mid], l = mid + 1;            else                r = mid - 1;        &#125;        f[i] = f[i - 1] + s[to] * w[i - 1] - s[to - 1] * w[i];    &#125;    std::cout &lt;&lt; f[m] + w[m] * s[n] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d---æŸ æª¬">D - æŸ æª¬</h2><p><a href="https://www.luogu.com.cn/problem/P5504" class="uri">https://www.luogu.com.cn/problem/P5504</a></p><ul><li>è§‚å¯Ÿé›¶ï¼šåŸé—®é¢˜ã€ä»ä¸¤ç«¯å–ã€å¯ä»¥è½¬åŒ–ä¸ºåˆ†æ®µé—®é¢˜ï¼Œæ•…ä»å…¶ä¸­ä¸€ç«¯è€ƒè™‘å³å¯ã€‚</li><li>è§‚å¯Ÿä¸€ï¼šè‹¥æœ‰ä¸€æ®µè¿ç»­çš„ <span class="math inline">\(x\)</span>ï¼Œå®Œæ•´çš„æ¯”æ‹†å¼€çš„æ›´ä¼˜ã€‚</li><li>è§‚å¯ŸäºŒï¼šå¦‚æœä¸€æ®µ <span class="math inline">\(x\)</span> ä¸­å¤¹æ‚äº†ä¸€äº›å…¶ä»–å…ƒç´ ï¼Œé‚£ä¹ˆåœ¨å“ªé‡Œåˆ†æ®µæ˜¯è¯´ä¸å‡†çš„ã€‚</li><li>è§‚å¯Ÿä¸‰ï¼šå¦‚æœé€‰å–çš„åŒºé—´æ˜¯ <span class="math inline">\([1,r]\)</span>ï¼Œé‚£ä¹ˆè´ªå¿ƒåœ°æƒ³ï¼Œ<span class="math inline">\(a_r\)</span> ä¸€å®šæ˜¯å…³é”®å€¼ï¼Œä¸ç„¶å– <span class="math inline">\(a_r\)</span> å°±æµªè´¹äº†ã€‚</li><li>è§‚å¯Ÿå››ï¼šå¦‚æœé€‰å–çš„åŒºé—´æ˜¯ <span class="math inline">\([l,r]\)</span>ï¼Œé‚£ä¹ˆç”±è§‚å¯Ÿå››ï¼Œ<span class="math inline">\(a_l=a_r\)</span>ï¼Œä¸”è¯¥å€¼ä¸ºå…³é”®å€¼ã€‚</li></ul><p>ç»“åˆè¿™å‡ ä¸ªè§‚å¯Ÿï¼Œä»¤ <span class="math inline">\(c_i\)</span> è¡¨ç¤º <span class="math inline">\(a_i\)</span> åœ¨ <span class="math inline">\([1,i]\)</span> ä¸­å‡ºç°æ¬¡æ•°ï¼Œ<span class="math inline">\(f_i\)</span> è¡¨ç¤ºè¿™ä¸€æ®µä»¥ <span class="math inline">\(i\)</span> ç»“å°¾çš„æœ€å¤§ä»·å€¼ï¼š</p><p><span class="math display">\[\begin{aligned}f_i&amp;=\max\limits_{j&lt;i,a_{j+1}=a_i}\{f_j+a_i\times (c_i-c_{j + 1} + 1)^2\}\\&amp;=\max\limits_{j&lt;i,a_{j+1}=a_i}\{f_j+a_{j+1}\times {c_{j+1}}^2-2\times c_i\times a_{j+1}\times c_{j+1}-2\times c_{j+1}\times a_{j+1}\}+a_i\times(c_i-1)^2\end{aligned}\]</span></p><p>ï¼ˆæ€ä¹ˆè¿™ä¹ˆå¤§ä¸€å †ã€‚ï¼‰æœ€åå¯ä»¥åŒ–å‡º <span class="math inline">\(\dfrac {f_A-f_B+a_{A+1}\cdot c_{A+1}\cdot (c_{A+1}-2)-a_{B+1}\cdot c_{B+1}\cdot (c_{B+1}-2)}{2(c_{A+1} - c_{B+1})}&gt;c_i\times a_i\)</span>ã€‚å‘ç°å¯¹äºæ¯ä¸€ç§ <span class="math inline">\(a_i\)</span>ï¼Œ<span class="math inline">\(c_i\times a_i\)</span> æ˜¯å•å¢çš„ã€‚å•è°ƒæ ˆç»´æŠ¤å³å¯ã€‚</p><p><em>è¿™å…¶å®æé†’æˆ‘ä»¬å…³äºä»£æ¢çš„é—®é¢˜â€”â€”æ˜¾ç„¶ï¼Œå½“ä¸ <span class="math inline">\(i\)</span> çš„é¡¹ã€ä¸ <span class="math inline">\(j\)</span> æœ‰å…³çš„é¡¹ä¹‹é—´å­˜åœ¨ä»£æ¢å…³ç³»æ—¶ï¼Œåº”è¯¥å°½é‡å¾€ <span class="math inline">\(j\)</span> çš„æ–¹å‘é ã€‚</em></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;7.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; a(n + 1), c(n + 1), la(10001);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        c[i] = c[la[a[i]]] + 1, la[a[i]] = i;    &#125;    std::vector&lt;long long&gt; f(n + 1);    std::vector&lt;int&gt; _t(10001, -1);    std::vector&lt;std::vector&lt;int&gt; &gt; _q(10001);    auto f1 = [&amp;](int A, int B) &#123;        return f[A] - f[B] + a[A + 1] * c[A + 1] * (c[A + 1] - 2) - a[B + 1] * c[B + 1] * (c[B + 1] - 2);    &#125;;    auto f2 = [&amp;](int A, int B) &#123;        return 2 * (c[A + 1] - c[B + 1]);    &#125;;    ++_t[a[1]], _q[a[1]].push_back(0);    for (int i = 1; i &lt;= n; ++i) &#123;        &#123;            auto &amp;t = _t[a[i]];            auto &amp;q = _q[a[i]];            for (; t &gt;= 1 &amp;&amp; f1(q[t], q[t - 1]) &lt; c[i] * a[i] * f2(q[t], q[t - 1]); --t);            f[i] = f[q[t]] + a[i] * (c[i] - c[q[t] + 1] + 1) * (c[i] - c[q[t] + 1] + 1);        &#125;        if (i &lt; n) &#123;            auto &amp;t = _t[a[i + 1]];            auto &amp;q = _q[a[i + 1]];            for (; t &gt;= 1 &amp;&amp; f1(i, q[t]) * f2(q[t], q[t - 1]) &gt; f1(q[t], q[t - 1]) * f2(i, q[t]); --t);            q.resize(++t + 1), q[t] = i;        &#125;    &#125;    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="e---knapsack-with-diminishing-values">E - Knapsack with Diminishing Values</h2><p><a href="https://atcoder.jp/contests/abc373/tasks/abc373_f" class="uri">https://atcoder.jp/contests/abc373/tasks/abc373_f</a></p><p>å‘ç°å’Œ <a href="/20250707-1/#ä¾‹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…</a> æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</p><p>ä¸å¦¨ä»¤ <span class="math inline">\(v_i\)</span> è¡¨ç¤ºä½“ç§¯ï¼Œ<span class="math inline">\(w_i\)</span> è¡¨ç¤ºä»·å€¼ã€‚å¯¹äºæ¯ä¸€ä¸ª <span class="math inline">\(i\)</span>ï¼ŒæŠŠæ‰€æœ‰ä½“ç§¯æŒ‰æ¨¡ <span class="math inline">\(v_i\)</span> çš„ä½™æ•°åˆ†ç±»ï¼Œè®¾ä¸º <span class="math inline">\(j\cdot v_i+x\)</span>ã€‚å¯¹äº <span class="math inline">\(k\cdot v_i+x\)</span>ï¼Œæœ‰ï¼š</p><p><span class="math display">\[\begin{aligned}f_{i,j\cdot v_i+x}&amp;=\max\limits_{k&lt;j}\{f_{i-1,k\cdot v_i+x}+(j-k)\cdot w_i-(j-k)^2\}\\&amp;=\max\limits_{k&lt;j}\{f_{i-1,k\cdot v_i+x}-k\cdot w_i-k^2+2\times j\times k\}-j^2+j\cdot w_i\end{aligned}\]</span></p><p>åˆ™å¾—åˆ° <span class="math inline">\(\dfrac {f_{i-1,A\cdot v_i+x}-f_{i-1,B\cdot v_i+x}+(B-A)\cdot w_i - A^2+B^2}{2(B-A)}&lt;j\)</span>ã€‚æ³¨æ„åˆ†æ¯ä¸ºè´Ÿã€‚æ€»ä¹‹å•è°ƒé˜Ÿåˆ—ç»´æŠ¤é€’å¢æ–œç‡å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;long long&gt; v(n + 1), w(n + 1);    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (m + 1));    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; v[i] &gt;&gt; w[i];        for (int x = 0; x &lt; v[i]; ++x) &#123;            int h = 0, t = -1;            std::vector&lt;int&gt; q;            auto f1 = [&amp;](int A, int B) &#123;                return f[i - 1][A * v[i] + x] - f[i - 1][B * v[i] + x] + (B - A) * w[i] - A * A + B * B;            &#125;;            auto f2 = [&amp;](int A, int B) &#123;                return 2 * (B - A);            &#125;;            for (int j = 0, J = x; J &lt;= m; ++j, J += v[i]) &#123;                for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &gt; j * f2(q[h + 1], q[h]); ++h);                f[i][J] = f[i - 1][J];                if (h &lt;= t)                    f[i][J] = std::max(f[i][J], f[i - 1][q[h] * v[i] + x] + (j - q[h]) * w[i] - (j - q[h]) * (j - q[h]));                for (; h &lt; t &amp;&amp; f1(j, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(j, q[t]); --t);                q.resize(++t + 1), q[t] = j;            &#125;        &#125;    &#125;    std::cout &lt;&lt; f[n][m] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="f---managing-telephone-poles">F - Managing Telephone Poles</h2><p><a href="https://codeforces.com/problemset/problem/1575/M" class="uri">https://codeforces.com/problemset/problem/1575/M</a></p><p>ï¼Ÿè§‚å¯Ÿåˆ°æ€§è´¨ç„¶åè¢«è‡ªå·±å¿½ç•¥äº†ã€‚éå¸¸å€¼å¾—æ‰¹è¯„ã€‚</p><p>ä¸éš¾å†™å‡ºç±»ä¼¼æ–œç‡ä¼˜åŒ–çš„å¼å­ <span class="math inline">\(S(i,j)=\min\{ {x_k}^2-2\times i\times x_k+{y_k}^2-2\times j \times y_k\}+i^2+j^2\)</span>ã€‚</p><p>ä¼šä¸‹æ„è¯†å°è¯•å›ºå®š <span class="math inline">\(i\)</span>ï¼Œå°±å¯ä»¥ <span class="math inline">\(O(n^2m)\)</span> å®Œæˆä»»åŠ¡ï¼Œä¼¼ä¹ä¸å¤ªè¡Œã€‚é¡ºç€è¿™ä¸ªæƒ³æ³•ä¼šè§‚å¯Ÿåˆ°ï¼Œå›ºå®š <span class="math inline">\(i\)</span> ä¹‹åï¼Œæ¯ä¸€åˆ—çš„ poles ä¸­åªæœ‰å’Œç¬¬ <span class="math inline">\(i\)</span> è¡Œæœ€è¿‘çš„æ‰ä¼šæœ‰è´¡çŒ®ã€‚</p><p>è¿™ä¸ªæ˜¯å¥½åšçš„ï¼Œä¸”è¿™æ ·çš„ç›¸é‚»ç‚¹æ•°é‡æ˜¯ <span class="math inline">\(O(m)\)</span> çš„ï¼›äºæ˜¯å°† <span class="math inline">\(i\)</span> è§†ä¸ºå¸¸æ•°è¿›è¡Œå˜å½¢ï¼Œè‹¥å°†æ‰€æœ‰ poles æŒ‰ <span class="math inline">\(y\)</span> ä»å°åˆ°å¤§æ’åºå°±èƒ½å¾—åˆ°æ–œç‡å½¢å¼ <span class="math inline">\(\dfrac { {x_A}^2-{x_B}^2+{y_A}^2-{y_B}^2-2\times i\times(x_A-x_B)}{2(y_A-y_B)}&lt;j\)</span>ã€‚ç»´æŠ¤é€’å¢æ–œç‡å°±èƒ½ <span class="math inline">\(O(n^2)\)</span> å®Œæˆé—®é¢˜ã€‚</p><p>é‚£ä¹ˆæ‰¾ç›¸é‚»ç‚¹è¿™ä¸€æ­¥å¤§å¯ä»¥æ‘†çƒ‚å†™äºŒåˆ†ã€‚æ‰€ä»¥æ€»å…±æ˜¯ <span class="math inline">\(O(nm\log m)\)</span> çš„ã€‚</p><p>ä¸è¦åƒæˆ‘ä¸€æ ·æŠŠä¸¤è¾¹æœ€è¿‘çš„éƒ½åŠ è¿›é˜Ÿåˆ—ï¼Œä¸ç„¶ä½ ä¼šæœ‰åˆ†æ¯ä¸º <span class="math inline">\(0\)</span> çš„æ–œç‡ <img src="/em/hsh.gif" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m, ++n, ++m;    std::vector&lt;std::vector&lt;int&gt; &gt; tag(n + 1, std::vector&lt;int&gt; (m + 1));    std::vector&lt;std::vector&lt;int&gt; &gt; g(m + 1);    for (int i = 1; i &lt;= n; ++i)        for (int j = 1; j &lt;= m; ++j) &#123;            char t;            std::cin &gt;&gt; t;            if (t == &#39;1&#39;)                g[j].push_back(i), tag[i][j] = 1;        &#125;    struct node &#123; long long x, y; &#125;;    auto res(0ll);    for (int i = 1; i &lt;= n; ++i) &#123;        std::vector&lt;node&gt; p;        for (int j = 1; j &lt;= m; ++j) &#123;            int to = std::lower_bound(g[j].begin(), g[j].end(), i) - g[j].begin();            if (to &lt; (int)g[j].size()) &#123;                p.push_back(&#123; g[j][to], j &#125;);                if (g[j][to] != i &amp;&amp; to != 0 &amp;&amp; g[j][to] - i &gt; i - g[j][to - 1])                    p.back() = &#123; g[j][to - 1], j &#125;;            &#125;            else if (to != 0)                p.push_back(&#123; g[j][to - 1], j &#125;);        &#125;        std::vector&lt;int&gt; q(m + 1);        int h = 0, t = -1;        auto f1 = [&amp;](node A, node B) &#123;            return A.x * A.x - B.x * B.x + A.y * A.y - B.y * B.y - 2 * i * (A.x - B.x);        &#125;;        auto f2 = [&amp;](node A, node B) &#123;            return 2 * (A.y - B.y);        &#125;;        for (int j = 0; j &lt; (int)p.size(); ++j) &#123;            for (; h &lt; t &amp;&amp; f1(p[j], p[q[t]]) * f2(p[q[t]], p[q[t - 1]]) &lt; f1(p[q[t]], p[q[t - 1]]) * f2(p[j], p[q[t]]); --t);            q[++t] = j;        &#125;        for (int j = 1; j &lt;= m; ++j) &#123;              for (; h &lt; t &amp;&amp; f1(p[q[h + 1]], p[q[h]]) &lt; j * f2(p[q[h + 1]], p[q[h]]); ++h);            res += (p[q[h]].x - i) * (p[q[h]].x - i) + (p[q[h]].y - j) * (p[q[h]].y - j);        &#125;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="g---partition-game">G - Partition Game</h2><p><a href="https://codeforces.com/problemset/problem/1527/E" class="uri">https://codeforces.com/problemset/problem/1527/E</a></p><p>å‘ç°ä¸å¤ªæ–œä¼˜ï¼Œç»ˆäºç»™æˆ‘æµ¸æ³¡äº†ä¸¤å¤©æ–œä¼˜å†…å®¹çš„å¤§è„‘åŠ äº†å‹ºæ–°çš„åº•ç‰©ã€‚</p><p>ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> æ®µä»¥ <span class="math inline">\(j\)</span> ç»“å°¾çš„æœ€å°ä»£ä»·ï¼›å¯¹ <span class="math inline">\(w\)</span> å¥—ç”¨å››è¾¹å½¢ä¸ç­‰å¼å˜å¼ <span class="math inline">\(w(l-1,r+1)+w(l,r)\ge w(l-1,r)+w(l,r+1)\)</span> å‘ç°æˆç«‹ï¼ˆå…¶ä¸­å¤§å¤šæ•°æ—¶å€™èƒ½å–ç­‰ï¼›éƒ¨åˆ†ç‰¹æ®Šæƒ…å†µå–åˆ°å¤§äºå·ï¼‰ã€‚</p><p>é‚£ä¹ˆå‘ç°å¯ä»¥ç”¨åˆ†æ²»ä¼˜åŒ–ã€‚å‘ç° <span class="math inline">\(w\)</span> ä¸é‚£ä¹ˆèƒ½å¿«é€Ÿæ±‚ï¼›è¿˜æ˜¯å¥—ç”¨ <a href="/20250707-1/#ä¾‹yet-another-minimization-problem">Yet Another Minimization Problem</a> ä¸­çš„æ–¹æ³•ï¼Œç”¨ç±»ä¼¼è«é˜Ÿçš„æ–¹å¼æ±‚è§£ã€‚</p><p>å‘ç°è¿™ä¸ªè«é˜Ÿå¥—è·¯ä¹Ÿå¾ˆç†Ÿæ‚‰äº†ï¼Œç›´æ¥ç”¨åŒç«¯é˜Ÿåˆ—ç»´æŠ¤å³å¯ã€‚å¤æ‚åº¦ <span class="math inline">\(O(nk\log n)\)</span>ï¼Œçœ‹ç€ä¸å¤ªå®‰å…¨ã€‚ä½†æ³¨æ„åˆ°æˆ‘ä»¬åœ¨ 20 ä¸ªæœˆå‰çš„æäº¤ä¸­ä½¿ç”¨äº† <span class="math inline">\(O(nk\log n)\)</span> çš„çº¿æ®µæ ‘ï¼Œæ‰€ä»¥èƒ½è¿‡çš„å…„å¼Ÿã€‚</p><details><p>é‰´äº deque çš„æ—¶ç©ºå¸¸æ•°éƒ½å¤§å¾—å“äººï¼Œæ‰€ä»¥æˆ‘ç”¨é™æ€ vector æ¨¡æ‹Ÿ deque äº†ã€‚</p><p>è·‘å¾—æ¯”æˆ‘ä¹‹å‰çº¿æ®µæ ‘çš„ä¸€åŠè¿˜å¿«ï¼Œå…„å¼Ÿã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;std::vector&lt;int&gt; &gt; pos(n + 1);    std::vector&lt;int&gt; a(n + 1), _h(n + 1), _t(n + 1, -1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i], pos[a[i]].push_back(i);    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));    f[0][0] = 0ll;    auto w = [&amp;](int ql, int qr) &#123;        static int l = 1, r = 0;        static auto res(0ll);        for (; l &gt; ql; ) &#123;            --l;            auto &amp;h = _h[a[l]], &amp;t = _t[a[l]];            auto &amp;q = pos[a[l]];            if (h &lt;= t)                res -= q[t] - q[h];            res += q[t] - q[--h];        &#125;        for (; r &gt; qr; ) &#123;            auto &amp;h = _h[a[r]], &amp;t = _t[a[r]];            auto &amp;q = pos[a[r]];            res -= q[t--] - q[h];            if (h &lt;= t)                res += q[t] - q[h];            --r;        &#125;        for (; r &lt; qr; ) &#123;            ++r;            auto &amp;h = _h[a[r]], &amp;t = _t[a[r]];            auto &amp;q = pos[a[r]];            if (h &lt;= t)                res -= q[t] - q[h];            res += q[++t] - q[h];        &#125;        for (; l &lt; ql; ) &#123;            auto &amp;h = _h[a[l]], &amp;t = _t[a[l]];            auto &amp;q = pos[a[l]];            res -= q[t] - q[h++];            if (h &lt;= t)                res += q[t] - q[h];            ++l;        &#125;        return res;    &#125;;    for (int t = 1; t &lt;= m; ++t) &#123;        std::function&lt;void(int, int, int, int)&gt; calc = [&amp;](int l, int r, int lp, int rp) &#123;            if (l &gt; r)                return;            if (l == r) &#123;                for (int i = lp; i &lt;= rp &amp;&amp; i &lt; l; ++i)                    f[t][l] = std::min(f[t][l], f[t - 1][i] + w(i + 1, l));                return;            &#125;            int mid = (l + r) &gt;&gt; 1, p = -1;            for (int i = lp; i &lt;= rp &amp;&amp; i &lt; mid; ++i)                if (f[t - 1][i] + w(i + 1, mid) &lt; f[t][mid])                    f[t][mid] = f[t - 1][i] + w(i + 1, mid), p = i;            calc(l, mid - 1, lp, p), calc(mid + 1, r, p, rp);            return;        &#125;;        calc(t, n, t - 1, n - 1);    &#125;    std::cout &lt;&lt; f[m][n] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="h---battle-lemmings">H - Battle Lemmings</h2><p><a href="https://codeforces.com/problemset/problem/1420/E" class="uri">https://codeforces.com/problemset/problem/1420/E</a></p><p>å®¹æ˜“å‘ç° <span class="math inline">\(0\)</span> çš„æ•°ç›®ä¸å˜ï¼Œç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(0\)</span> çš„å¯¹æ•° - è¿ç»­ <span class="math inline">\(0\)</span> çš„å¯¹æ•°ã€‚</p><p>ç„¶åæœ‰ä¸€ä¸ªæˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„ trickï¼Œéšä¾¿æ‰¾ä¸€ä¸ªç›®æ ‡åºåˆ—ï¼Œé‚£ä¹ˆèŠ±è´¹çš„æ“ä½œæ¬¡æ•°å°±æ˜¯æ¯ä¸ªå¯¹åº”çš„ <span class="math inline">\(1\)</span> çš„ä½ç½®å·®ã€‚ä»¤ <span class="math inline">\(f_{i,j,k}\)</span> è¡¨ç¤ºç”¨äº† <span class="math inline">\(i\)</span> æ¬¡æ“ä½œã€<span class="math inline">\(j\)</span> ä¸ª <span class="math inline">\(1\)</span>ã€æœ€åä¸€ä¸ª <span class="math inline">\(1\)</span> åœ¨ <span class="math inline">\(k\)</span> çš„æœ€å°è¿ç»­ <span class="math inline">\(0\)</span> å¯¹æ•°ã€‚é‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[\begin{aligned}f_{i,j,k}&amp;=\min\limits_{p&lt;k}\left\{f_{i-|k-pos_j|,j-1,p}+\dfrac {(k-p-1)(k-p-2)}2\right\}\\&amp;=\min\left\{f_{i-|k-pos_j|,j-1,p}-k\cdot p+\dfrac {p(p + 2)}2\right\}+\dfrac {k^2-3k+2}2\end{aligned}\]</span></p><p>å‘ç°è¿™ä¸ªå¼å­æ˜¯ <span class="math inline">\(O(n^5)\)</span> çš„ï¼Œè€Œä¸”çœ‹èµ·æ¥å¾ˆæ–œä¼˜ï¼ŒåŒ–ä¸ºæ–œç‡å½¢å¼ <span class="math inline">\(\dfrac{2\times f_A-2\times f_B+A(A+2)-B(B+2)}{2(A-B)}&lt;k\)</span>ã€‚ç»´æŠ¤é€’å¢æ–œç‡å°±å¯ä»¥ <span class="math inline">\(O(n^4)\)</span> åšäº†ã€‚</p><p>Tipï¼šå½“æ—¶å†™ç€å†™ç€æ„£ä½äº†ï¼Œæ¯”å¦‚è¿™ä¸ª <span class="math inline">\(i-|k-pos_j|\)</span> ä¸æ˜¯ä¸€ç›´åœ¨åŠ¨å—ã€‚è§£å†³æ–¹æ¡ˆï¼ŸåŒæ—¶ç»´æŠ¤å¾ˆå¤šä¸ªé˜Ÿåˆ—å³å¯ã€‚</p><details><p>æ³¨æ„è¿˜è¦æŠŠæœ€åä¸€ä¸ª <span class="math inline">\(1\)</span> ä¹‹åè¿ç»­ <span class="math inline">\(0\)</span> çš„ä»£ä»·ç®—ä¸Šã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e9;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    std::vector&lt;long long&gt; pos(1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        if (a[i] == 1)            pos.push_back(i);    &#125;    int m = n * (n - 1) / 2;    std::vector&lt;std::vector&lt;std::vector&lt;long long&gt; &gt; &gt; f(pos.size(), std::vector&lt;std::vector&lt;long long&gt; &gt; (m + 1, std::vector&lt;long long&gt; (n + 1, inf)));    f[0][0][0] = 0ll;    for (int j = 1; j &lt; (int)pos.size(); ++j) &#123;        std::vector&lt;std::vector&lt;int&gt; &gt; _q(m + 1, std::vector&lt;int&gt; (n + 1));        std::vector&lt;int&gt; _h(m + 1), _t(m + 1, -1);        for (int k = 0; k &lt;= n; ++k)            for (int i = m; i &gt;= 0; --i) &#123;                if (i &gt;= std::abs(k - pos[j])) &#123;                    auto f1 = [&amp;](long long A, long long B) &#123;                        return 2 * f[j - 1][i - std::abs(k - pos[j])][A] - 2 * f[j - 1][i - std::abs(k - pos[j])][B] + A * (A + 2) - B * (B + 2);                    &#125;;                    auto f2 = [&amp;](long long A, long long B) &#123;                        return 2 * (A - B);                    &#125;;                    auto &amp;h = _h[i - std::abs(k - pos[j])], &amp;t = _t[i - std::abs(k - pos[j])];                    auto &amp;q = _q[i - std::abs(k - pos[j])];                    for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &lt; k * f2(q[h + 1], q[h]); ++h) &#123;&#125;                    if (h &lt;= t)                        f[j][i][k] = std::min(inf, f[j - 1][i - std::abs(k - pos[j])][q[h]] + (k - q[h] - 1) * (k - q[h] - 2) / 2);                &#125;                auto f1 = [&amp;](long long A, long long B) &#123;                    return 2 * f[j - 1][i][A] - 2 * f[j - 1][i][B] + A * (A + 2) - B * (B + 2);                &#125;;                auto f2 = [&amp;](long long A, long long B) &#123;                    return 2 * (A - B);                &#125;;                auto &amp;h = _h[i], &amp;t = _t[i];                auto &amp;q = _q[i];                for (; h &lt; t &amp;&amp; f1(k, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(k, q[t]); --t);                q[++t] = k;            &#125;    &#125;    auto res(-inf);    int cnt = n - (int)pos.size() + 1;    cnt = cnt * (cnt - 1) / 2;    for (int i = 0; i &lt;= m; ++i) &#123;        for (int k = 0; k &lt;= n; ++k)            res = std::max(res, cnt - f.back()[i][k] - (n - k) * (n - k - 1) / 2);        std::cout &lt;&lt; res &lt;&lt; &#39; &#39;;    &#125;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="a---yakiniku-restaurants">A - Yakiniku Restaurants</h2><p><a href="https://atcoder.jp/contests/arc067/tasks/arc067_d" class="uri">https://atcoder.jp/contests/arc067/tasks/arc067_d</a></p><p>å‘ç°å›ºå®šå·¦å³ç«¯ç‚¹åï¼Œæ”¶ç›Šæ˜¯å¯ä»¥è´ªå¿ƒç®—çš„ï¼›ä¸‹æ„è¯†æƒ³åˆ°åªå›ºå®šå·¦ç«¯ç‚¹ï¼Œé‚£ä¹ˆå³ç«¯ç‚¹åº”è¯¥å°±å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ä¹‹ç±»çš„æä¸€æã€‚</p><p>å…ˆæå‰æŠŠæ‰€æœ‰ä¸œè¥¿å¡åˆ°é˜Ÿåˆ—é‡Œã€‚å·¦ç«¯ç‚¹ä¸€å¼€å§‹åœ¨æœ€å³è¾¹ï¼›å¾€å·¦è¾¹åŠ¨ä¸€ä¸‹ä¹‹åï¼Œå°±å¯ä»¥æ›´æ–°æ¯ç§èœçš„é˜Ÿåˆ—ï¼›å‘ç°åœ¨æ‰€æœ‰å…ƒç´ ä¸­ä½œå†³ç­–ç‚¹çš„ä¸æ€»æ˜¯é˜Ÿå¤´ï¼›è¿™ä¸ªåœ°æ–¹ç”¨ <strong>å•è°ƒé€’å‡çš„å•è°ƒæ ˆ</strong> æ˜¯æå¥½çš„ã€‚è¿™é‡Œçš„å•è°ƒæ ˆå…¶å®å°±ç±»ä¼¼ <a href="/20250707-1/#ä¼˜åŒ–-dpå•è°ƒæ•°æ®ç»“æ„">å››è¾¹å½¢ä¸ç­‰å¼ä¸­çš„å•è°ƒæ•°æ®ç»“æ„</a> äº†ã€‚</p><p>ç»´æŠ¤å•è°ƒæ ˆä¸­æ¯ä¸ªå†³ç­–ç‚¹çš„å½±å“åŒºé—´ï¼›æ˜¾ç„¶æ¯ä¸ªå³ç«¯ç‚¹çš„ç­”æ¡ˆå˜åŒ–é‡ç›¸åŒï¼›ç”¨ä¸ªç±»ä¼¼äºå·®åˆ†çš„ä¸œè¥¿è®°å½•ä¸€ä¸‹å°±å¥½äº†ã€‚</p><p>å¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;long long&gt; s(n + 1), f(n + 1);    for (int i = 2; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; s[i], s[i] += s[i - 1];        f[i] = -s[i];    &#125;    std::vector&lt;std::vector&lt;int&gt; &gt; a(n + 1, std::vector&lt;int&gt; (m + 1));    for (int i = 1; i &lt;= n; ++i)        for (int j = 1; j &lt;= m; ++j)            std::cin &gt;&gt; a[i][j];    struct node &#123; int j, l, r; &#125;;    std::vector&lt;std::stack&lt;node&gt; &gt; _q(m + 1);    auto res(-inf);    for (int l = n; l; --l) &#123;        std::vector&lt;long long&gt; d(n + 1);        auto add = [&amp;](int l, int r, long long v) &#123;            d[l] += v;            if (r != n)                d[r + 1] -= v;            return;        &#125;;        for (int j = 1; j &lt;= m; ++j) &#123;            auto &amp;q = _q[j];            node now = &#123; j, l, l &#125;;            add(l, l, a[l][j]);            for (; !q.empty() &amp;&amp; a[l][j] &gt;= a[q.top().l][q.top().j]; q.pop()) &#123;                now.r = q.top().r;                add(q.top().l, q.top().r, a[l][j] - a[q.top().l][q.top().j]);            &#125;            q.push(now);        &#125;        std::partial_sum(d.begin() + 1, d.end(), d.begin() + 1);        for (int r = l; r &lt;= n; ++r) &#123;            f[r] += d[r];            res = std::max(res, f[r] + s[l]);        &#125;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---jellyfish-and-miku">B - Jellyfish and Miku</h2><p><a href="https://codeforces.com/problemset/problem/1874/D" class="uri">https://codeforces.com/problemset/problem/1874/D</a></p><p>å”‰æ•°åˆ—ã€‚å”‰æ¦‚ç»Ÿã€‚åœ¨æ•°å­¦è®²ä¹‰ä¸ŠæŠ˜ç£¨äº†æˆ‘ä¸€éä¹‹åè¿˜è¦åˆ°è¿™å„¿æ¥æŠ˜ç£¨æˆ‘ã€‚</p><p>å‡è®¾å·²ç»çŸ¥é“äº† <span class="math inline">\(a\)</span>ï¼Œè€ƒè™‘æ±‚æœŸæœ›æ­¥æ•°ã€‚è®¾ <span class="math inline">\(E_i\)</span> ä¸ºä» <span class="math inline">\(i\)</span> å‡ºå‘èµ°åˆ° <span class="math inline">\(n\)</span> çš„æœŸæœ›æ­¥æ•°ã€‚é‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[E_i=\begin{cases}E_1+1&amp;i=0\\0&amp;i=n\\E_i=(E_{i-1}+1)\cdot \dfrac {a_i}{a_{i+1}+a_i}+(E_{i+1}+1)\cdot \dfrac {a_{i+1}}{a_{i+1}+a_{i}}&amp;\text{otherwise}\end{cases}\]</span></p><p>ï¼ˆæç¤ºï¼šä»ã€<span class="math inline">\(i\)</span> ä¸‹ä¸€æ­¥ä¼šèµ°å“ªä¸ªæ–¹å‘ã€è€ƒè™‘ã€‚ï¼‰</p><p>æ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨ä½ çš„é«˜ä¸­æ•°å­¦çŸ¥è¯†è¿›è¡Œä¸€ä¸ª <span class="math inline">\(f_0\)</span> çš„æ±‚ï¼Œï¼ˆä¸€å †è¿‡ç¨‹ï¼‰ï¼Œå¾—åˆ° <span class="math inline">\(E_0=n+2\times \sum\limits_{i=1}^n\dfrac {\sum_{j\le i}a_j}{a_i}\)</span>ï¼Œç„¶åæƒ³è¦æœ€å°åŒ–è¿™ä¸ªä¸œè¥¿ã€‚</p><p>ä¸å¦¨ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºåˆ° <span class="math inline">\(i\)</span> æ—¶å·²ç»åˆ†é…èµ°äº† <span class="math inline">\(j\)</span> ä½“ç§¯ï¼Œ<span class="math inline">\(\sum_{k=1}^i \dfrac {\sum_{l\le k}a_l}{a_k}\)</span> çš„æœ€å°å€¼ï¼Œæœ‰ <span class="math inline">\(f_{i,j}=\min\limits_{k&lt;j}\left\{f_{i-1,k}+\dfrac {k}{j - k}\right\}\)</span>ã€‚å‘ç°å®ƒå¤§æŠµæ˜¯æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼çš„ï¼ŒæŒ‰ç…§ <a href="/20250707-1/#d1d-dp-ä¼˜åŒ–">2D/1D DP ä¼˜åŒ–çš„ç»“è®º</a>ï¼Œä»£å…¥ <span class="math inline">\(p_{i,j-1}&lt;p_{i,j}&lt;p_{i+1,j}\)</span> å¯ä»¥ <span class="math inline">\(O(nm)\)</span> è§£å†³é—®é¢˜ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;std::vector&lt;int&gt; &gt; p(n + 1, std::vector&lt;int&gt; (m + 1));    std::vector&lt;std::vector&lt;long double&gt; &gt; f(n + 1, std::vector&lt;long double&gt; (m + 1, 1e18));    f[0][0] = 0ll;    for (int j = 1; j &lt;= m; ++j)        for (int i = std::min(j, n); i; --i) &#123;            int to = ((i == std::min(j, n)) ? j : std::min(p[i + 1][j], j));            for (int k = p[i][j - 1]; k &lt;= to; ++k)                if (f[i - 1][k] + k * 1. / (j - k) &lt; f[i][j])                    f[i][j] = f[i - 1][k] + k * 1. / (j - k), p[i][j] = k;            // printf(&quot;f[%d][%d] = %Lf, p = %d\n&quot;, i, j, f[i][j], p[i][j]);        &#125;    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(10) &lt;&lt; n + 2 * f[n][m] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="cut-the-sequence">Cut the Sequence</h2><p><a href="https://www.luogu.com.cn/problem/P10977" class="uri">https://www.luogu.com.cn/problem/P10977</a></p><h1 id="é€šçŸ¥åŒºé—´æœ€å€¼-ä¸æ»¡è¶³-å››è¾¹å½¢ä¸ç­‰å¼"><mark>é€šçŸ¥ï¼šåŒºé—´æœ€å€¼ ä¸æ»¡è¶³ å››è¾¹å½¢ä¸ç­‰å¼ã€‚</mark></h1><p>å…¶å®åœ¨çŒœçš„æ—¶å€™æ˜¯ä¸¾äº†åä¾‹çš„ï¼Œä½†æ˜¯å¤§è„‘èç¼©äº†æ¨ç€æ¨ç€å¿˜è®°ç¬¦å·äº† ğŸ˜…</p><p>çœ‹åˆ° <span class="math inline">\(f_i=\min\limits_{g(i)\le j&lt;i}\{f_j+\max\{a_{j+1\sim i}\}\}\)</span> è¿™ä¸ª <span class="math inline">\(j\)</span> çš„èŒƒå›´å…¶å®æ˜¯æœ‰ç‚¹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ„Ÿè§‰çš„ï¼Œä½†è¿™ä¸ªæœ€å¤§å€¼ä¼ ç»Ÿçš„å•è°ƒé˜Ÿåˆ—ä¸æ˜¯å¾ˆå¯åšã€‚å¯ä»¥æ³¨æ„åˆ°æœ€å¤§å€¼è¿™ä¸€é¡¹æœ‰ç‚¹ <strong>å•è°ƒé˜Ÿåˆ—</strong> åç¼€æœ€å¤§å€¼çš„æ„Ÿè§‰ï¼ˆå®é™…ä¸Šå°±æ˜¯ï¼‰ï¼›ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•æ˜¯åˆ©ç”¨è¿™ä¸ªæœ€å¤§å€¼å½±å“çš„åŒºé—´ï¼Œç»´æŠ¤ <span class="math inline">\(f\)</span> çš„çº¿æ®µæ ‘æ¥æš´åŠ›åšã€‚</p><p>å¦ä¸€ä¸ªæ¯”è¾ƒç‰›çš„åšæ³•æ˜¯å‘ç°åŒä¸€ä¸ªä¸‹æ ‡çš„ <span class="math inline">\(f\)</span> å’Œ <span class="math inline">\(a\)</span> çš„å…³ç³»ã€‚é¦–å…ˆéœ€è¦æ³¨æ„åˆ° <span class="math inline">\(f\)</span> å•è°ƒä¸é™ï¼›å¯¹äºåŒä¸€ä¸ª <span class="math inline">\(a\)</span>ï¼Œèƒ½å–åˆ°çš„ <span class="math inline">\(f\)</span> å°±æ˜¯æœ€é å‰çš„ï¼›ç»´æŠ¤ä¸€ä¸ª <span class="math inline">\(a\)</span> çš„å•å‡é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå…±ç”¨åŒä¸€ä¸ª <span class="math inline">\(a\)</span> çš„å°±æ˜¯ç›¸é‚»ä¸¤ä¸ªä¸‹æ ‡ä¹‹é—´çš„éƒ¨åˆ†ï¼Œå…¶æœ€ä¼˜å†³ç­–åœ¨èƒ½å–åˆ°çš„æœ€å‰ç«¯å–å¾—ï¼›éœ€è¦æ³¨æ„åˆ°é˜Ÿåˆ—é‡Œçš„è´¡çŒ®å¹¶ä¸å•è°ƒï¼Œéœ€è¦ç”¨ä¸€ä¸ª multiset æ¥å­˜å‚¨æ‰€æœ‰è´¡çŒ®å¹¶æŸ¥æ‰¾ã€æ›´æ–°ã€‚</p><p>éœ€è¦æ³¨æ„å•è°ƒé˜Ÿåˆ—é‡ŒæŸä¸ªå…ƒç´  <span class="math inline">\(f_{q_i}\)</span> ç»“åˆçš„å…¶å®æ˜¯ <span class="math inline">\(a_{q_{i+1}}\)</span>ã€‚è¿˜éœ€è¦æ³¨æ„é˜Ÿå¤´çš„ç»´æŠ¤ï¼Œå¯èƒ½éœ€è¦ä¸€äº›å°å·§æ€ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;1.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; a(n + 1);    std::vector&lt;long long&gt; s(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i], s[i] = s[i - 1] + a[i];    int h = 0, t = -1;    std::multiset&lt;long long&gt; st;    std::vector&lt;long long&gt; f(n + 1);    std::vector&lt;std::pair&lt;int, int&gt; &gt; q(n + 1);    q[++t] = &#123; 0, 0 &#125;, a[0] = 0x3f3f3f3f;    for (int i = 1; i &lt;= n; ++i) &#123;        for (; s[i] - s[q[h].second] &gt; m; ) &#123;            st.erase(st.find(f[q[h].second] + a[q[h + 1].first]));            if (++q[h].second &gt;= q[h + 1].first)                a[q[++h].first] = 0x3f3f3f3f;            else                st.insert(f[q[h].second] + a[q[h + 1].first]);        &#125;        for (; h &lt; t &amp;&amp; a[q[t].first] &lt;= a[i]; --t)            st.erase(st.find(f[q[t - 1].second] + a[q[t].first]));        st.insert(f[q[t].second] + a[i]), q[++t] = &#123; i, i &#125;;        f[i] = *st.begin();    &#125;    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ–œç‡ä¼˜åŒ– </tag>
            
            <tag> DP </tag>
            
            <tag> å››è¾¹å½¢ä¸ç­‰å¼ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20250712/"/>
      <url>/20250712/</url>
      
        <content type="html"><![CDATA[<p>æˆ‘ç”Ÿå¾…æ˜æ—¥ï¼Œä¸‡äº‹æˆè¹‰è·ã€‚</p><span id="more"></span><hr /><h2 id="town">town</h2><p><a href="http://222.180.160.110:61235/contest/6407/problem/1" class="uri">http://222.180.160.110:61235/contest/6407/problem/1</a></p><blockquote><p>ç»™å®šä¸€æ£µå¤§å°ä¸º <span class="math inline">\(n\)</span> çš„æ ‘ï¼Œç‚¹æœ‰ç‚¹æƒï¼Œæ¬²å°†æ ‘åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªè¿é€šå—ï¼Œä½¿å¾—æ¯ä¸ªå—å†…çš„ç‚¹æƒå¼‚æˆ–å’Œéƒ½ä¸º <span class="math inline">\(x\)</span>ï¼Œæ±‚æ–¹æ¡ˆæ•°ï¼Œæ¨¡ <span class="math inline">\(998244353\)</span>ã€‚</p><p><span class="math inline">\(n\le 10^6,0\le x\le 10^9\)</span>ã€‚</p></blockquote><p>è®° <span class="math inline">\(u\)</span> å¼•å¯¼çš„å­æ ‘å¼‚æˆ–å’Œä¸º <span class="math inline">\(s_u\)</span>ã€‚æŠŠè¿é€šå—è½¬åŒ–ä¸ºå¯¹æ–­è¾¹çš„è®¨è®ºã€‚è€ƒå¯Ÿä¸€æ¡æœ€æœ«ç«¯çš„è¾¹ï¼Œå…¶ä¸‹æ–¹å­æ ‘çš„å¼‚æˆ–å’Œä¸€å®šä¸º <span class="math inline">\(x\)</span>ã€‚</p><p>ç®€å•æ•°å½’å¯å¾—æ–­æ‰çš„æ¯ä¸€æ¡è¾¹ï¼Œå…¶ä¸‹æ–¹å­æ ‘å¼‚æˆ–å’Œä¸º <span class="math inline">\(x\)</span> æˆ– <span class="math inline">\(0\)</span>ï¼ˆé‚£ä¹ˆæ˜¾ç„¶æœ‰è§£çš„å……è¦æ¡ä»¶æ˜¯ <span class="math inline">\(s_1=0\lor s_1=x\)</span>ï¼‰ã€‚è€ƒè™‘æ ‘å½¢ DPï¼Œä»¤ <span class="math inline">\(f_{u,0/1}\)</span> è¡¨ç¤ºå½“å‰ DP åˆ° <span class="math inline">\(u\)</span> å­æ ‘å¤´ä¸Šé‚£æ¡è¾¹ï¼Œå®ƒè¿æ¥äº†ä¸€ä¸ªå¼‚æˆ–å’Œä¸º <span class="math inline">\(s_u\)</span> ï¼ˆæˆ– <span class="math inline">\(s_u\oplus x\)</span>ï¼‰çš„è¿é€šå—çš„åˆæ³•æ–¹æ¡ˆæ•°ï¼Œåˆ†åˆ«ä»£è¡¨å·²ç»ã€æ–­ã€æ‰äº†å¶æ•° / å¥‡æ•°ä¸ªåˆæ³•è¿é€šå—ã€‚</p><p>é¦–å…ˆè‡ªç„¶å¯ä»¥ä¸€æ¡è¾¹éƒ½ä¸æ–­ï¼Œ<span class="math inline">\(f_{u,0}=1\)</span>ã€‚é‚£ä¹ˆæ›´æ–°å°±åº”ä¸ºï¼š</p><p><span class="math display">\[f&#39;_{u,0}=f_{u,0}\cdot f_{v,0}+f_{u,1}\cdot f_{v,1}\\f&#39;_{u,1}=f_{u,0}\cdot f_{v,1}+f_{u,1}\cdot f_{v,0}\]</span></p><p>æ¥ç€ï¼Œå¦‚æœ <span class="math inline">\(s_u\)</span> æ°å¥½ä¸º <span class="math inline">\(0\)</span> æˆ– <span class="math inline">\(x\)</span>ï¼Œè¿™æ¡è¾¹è¿æ¥çš„è¿é€šå—çš„å¼‚æˆ–å’Œå°±å¯ä»¥æ˜¯ <span class="math inline">\(x\)</span>ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨è¿™æ¡è¾¹å¤„æ–­å¼€ï¼Œæä¾›ä¸€ä¸ªç©ºè¿é€šå—ï¼ˆåŠ å…¥å¼‚æˆ–å’Œä¸º <span class="math inline">\(0\)</span> çš„æ–¹æ¡ˆï¼‰ã€‚</p><p>æœ€åæ³¨æ„ <span class="math inline">\(x\)</span> å¯èƒ½ä¸º <span class="math inline">\(0\)</span>ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†â€”â€”æ¯ä¸ª <span class="math inline">\(s_u=0\)</span> å¤„éƒ½å¯ä»¥æ–­å¼€ã€‚</p><p>è¿™ä¸ª DP çŠ¶æ€å®åœ¨éå¸¸æ–°å¥‡ï¼›åŒæ—¶ DP å’Œåˆ è¾¹åˆæ˜¯åˆ†å¼€çš„ï¼Œæ˜¾å¾—éå¸¸å‰²è£‚ã€‚çœ‹ solã€å¬ grisses è®²è§£çš„æ—¶å€™éƒ½å®Œå…¨ä¸€å¤´é›¾æ°´ã€‚quack è¯´è¿™æ˜¯å› ä¸ºæˆ‘æ²¡åšè¿‡è¿é€šå— DP /ll</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;ex_town1.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; a(n + 1), s(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        s[x] = a[x];        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                s[x] ^= s[i];            &#125;        return;    &#125;;    DFS(1, -1);    if (s[1] != 0 &amp;&amp; s[1] != m) &#123;        std::cout &lt;&lt; 0 &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    if (m == 0) &#123;        auto res(1ll);        for (int i = 2; i &lt;= n; ++i)            if (s[i] == 0)                (res *= 2) %= mod;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    else &#123;        std::vector&lt;std::array&lt;long long, 2&gt; &gt; f(n + 1);        DFS = [&amp;](int x, int fa) &#123;            f[x][0] = 1ll;            for (auto i : g[x])                if (i != fa) &#123;                    DFS(i, x);                    std::tie(f[x][0], f[x][1]) = std::make_tuple((f[x][0] * f[i][0] + f[x][1] * f[i][1]) % mod, (f[x][0] * f[i][1] + f[x][1] * f[i][0]) % mod);                &#125;            if (x != 1) &#123;                if (s[x] == m)                    (f[x][1] += f[x][0]) %= mod;                if (s[x] == 0)                    (f[x][0] += f[x][1]) %= mod;            &#125;            // printf(&quot;f[%d][0] = %lld, f[%d][1] = %lld\n&quot;, x, f[x][0], x, f[x][1]);            return;        &#125;;        DFS(1, -1);        std::cout &lt;&lt; (s[1] == m ? f[1][0] : f[1][1]) &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="perm">perm</h2><p><a href="http://222.180.160.110:61235/contest/6407/problem/3" class="uri">http://222.180.160.110:61235/contest/6407/problem/3</a></p><blockquote><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span>ã€å…ƒç´ ä¸¤ä¸¤ä¸åŒçš„åºåˆ—ï¼Œä½ å¯ä»¥äº¤æ¢ä»»æ„ä¸¤ä¸ªå…ƒç´ ã€‚è¯•ä½¿ç”¨æœ€å°‘äº¤æ¢æ¬¡æ•°ä½¿å¾—åºåˆ—æœ‰åºï¼Œé—®æ–¹æ¡ˆæ•°ã€‚</p><p><span class="math inline">\(n\le 10^6\)</span>ã€‚</p></blockquote><p>å¯¹äºä¸€ä¸ªä¸‹æ ‡ï¼Œå°†å®ƒå’Œå®ƒä¸Šé¢å…ƒç´ çš„ rank è¿æœ‰å‘è¾¹ï¼Œé‚£ä¹ˆæ¯ä¸ªä¸‹æ ‡çš„å‡ºã€å…¥åº¦éƒ½ä¸º <span class="math inline">\(1\)</span>ï¼Œåˆ™å›¾ç”±è‹¥å¹²ä¸ªç®€å•ç¯ç»„æˆã€‚</p><p>æ¥ç€ï¼Œè€ƒè™‘ä¸€æ¬¡ä»»æ„ä¸€æ¬¡äº¤æ¢ <span class="math inline">\((x,y)\)</span> çš„æ“ä½œä¼šå¸¦æ¥ä»€ä¹ˆï¼š</p><ul><li><p>è‹¥ <span class="math inline">\(x,y\)</span> ä¸åœ¨åŒä¸€ç¯ä¸Šï¼š</p>è¯¥æ“ä½œä½¿å¾— <span class="math inline">\(x,y\)</span> æ‰€åœ¨çš„ç¯åˆä¸ºä¸€ä¸ªå¤§ç¯ã€‚</li><li><p>è‹¥ <span class="math inline">\(x,y\)</span> åœ¨åŒä¸€ç¯ä¸Šï¼š</p><p>è¯¥æ“ä½œä½¿å¾—ç¯ä»¥ <span class="math inline">\(x,y\)</span> ä¸ºåˆ†ç•Œçº¿è£‚æˆä¸¤ä¸ªå°ç¯ã€‚</p></li></ul><p>ä»¥å¾—åˆ° <span class="math inline">\(n\)</span> ä¸ªè‡ªç¯ä¸ºç›®æ ‡ï¼Œæ•°å½’å¾—åˆ°ï¼Œå¯¹äºæœ€ä¼˜æ–¹æ¡ˆï¼Œå½“ä¸”ä»…å½“æ¯æ¬¡äº¤æ¢çš„ç›®æ ‡éƒ½åœ¨åŒä¸€ç¯ä¸Šã€‚</p><p>è€ƒè™‘æ–¹æ¡ˆæ•°ã€‚æŠŠä¸€ä¸ªå¤§å°ä¸º <span class="math inline">\(k\)</span> çš„ç¯ï¼Œæ¬²å°†å…¶æ‹†æˆ <span class="math inline">\(k\)</span> ä¸ªè‡ªç¯ï¼Œå…±éœ€ <span class="math inline">\(k-1\)</span> æ¬¡ <em>æœ‰åº</em> çš„æ‹†è§£ã€‚</p><p>è€ƒè™‘ DPï¼Œä»¤ <span class="math inline">\(f_k\)</span> ä¸ºæ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆ <span class="math inline">\(f_k=\dfrac {k\sum\limits_{j=1}^{k-1} f_j\cdot f_{k-j}\cdot C_{k-2}^j}2\)</span>ã€‚å°è¯•æ‰“è¡¨ï¼Œï¼ˆæƒŠè®¶åœ°ï¼‰å‘ç° <span class="math inline">\(f_k=k^{k-2}\)</span>ã€‚</p><p>ä¸åŒçš„ç¯ä¹‹é—´çš„æ“ä½œå¯ä»¥äº¤é”™ï¼Œçœ‹ä½œå¤šé‡é›†æ’åˆ—å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1), p(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i], p[i] = i;    std::sort(p.begin() + 1, p.end(), [&amp;](int i, int j) &#123; return a[i] &lt; a[j]; &#125;);    std::vector&lt;int&gt; f(n + 1), siz(n + 1, 1);    std::iota(f.begin() + 1, f.end(), 1);    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;        return x == f[x] ? x : f[x] = find(f[x]);    &#125;;    auto merge = [&amp;](int x, int y) &#123;        x = find(x), y = find(y);        if (x != y)            siz[y] += siz[x], f[x] = y;        return;    &#125;;    for (int i = 1; i &lt;= n; ++i)        merge(i, p[i]);    std::vector&lt;long long&gt; g(n + 1), fac(n + 1), inv(n + 1);    g[1] = g[2] = 1ll, fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= n; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [&amp;](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[n] = qkp(fac[n], mod - 2);    for (int i = n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    for (int i = 3; i &lt;= n; ++i)        g[i] = qkp(i, i - 2);    int cnt(0);    auto res(1ll);    for (int i = 1; i &lt;= n; ++i)        if (f[i] == i) &#123;            cnt += siz[i] - 1;            (res *= g[siz[i]]) %= mod;            (res *= inv[siz[i] - 1]) %= mod;        &#125;    (res *= fac[cnt]) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="cf2122d-traffic-lights">CF2122D Traffic Lights</h2><p><a href="https://codeforces.com/contest/2122/problem/D" class="uri">https://codeforces.com/contest/2122/problem/D</a></p><blockquote><p>ç»™ä½ ä¸€ä¸ªç”± <span class="math inline">\(n\)</span> ä¸ªé¡¶ç‚¹å’Œ <span class="math inline">\(m\)</span> æ¡è¾¹ç»„æˆçš„ç®€å•æ— å‘è¿é€šå›¾ã€‚åœ¨é¡¶ç‚¹ <span class="math inline">\(1\)</span> æœ‰ä¸€ä¸ªæ ‡è®°ã€‚è®¤ä¸ºåˆå§‹æ—¶é—´ä¸º <span class="math inline">\(t=0\)</span>ï¼Œåœ¨ <span class="math inline">\(t\)</span> ç§’åï¼Œå¦‚æœæ ‡è®°ä½äºç‚¹ <span class="math inline">\(u\)</span> ï¼Œåˆ™å¿…é¡»æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š</p><ul><li>ç­‰å¾…ä¸€ç§’ã€‚</li><li>å°†æ ‡è®°æ²¿ <span class="math inline">\(u\)</span> çš„ç¬¬ <span class="math inline">\((t \bmod \mathrm{deg}(u) + 1)\)</span> æ¡è¾¹ç§»åŠ¨ï¼ŒèŠ±è´¹ä¸€ç§’ã€‚</li></ul><p>è®¡ç®—å°†æ ‡è®°ä»é¡¶ç‚¹ <span class="math inline">\(1\)</span> ç§»åˆ°é¡¶ç‚¹ <span class="math inline">\(n\)</span> æ‰€éœ€çš„æœ€çŸ­æ—¶é—´ï¼Œä»¥åŠåœ¨ä½¿æ€»æ—¶é—´æœ€å°åŒ–çš„åŒæ—¶æ‰€èƒ½è¾¾åˆ°çš„æœ€çŸ­ç­‰å¾…æ—¶é—´ã€‚<span class="math inline">\(m\le 5\times 10^5\)</span>ã€‚</p></blockquote><p>èƒ½å¤Ÿå‘ç°è¿™æ˜¯ä¸€ä¸ªè¾¹æƒå’Œ dis æœ‰å…³çš„æœ€çŸ­è·¯ï¼Œæœ¬ç€åˆ†å±‚å›¾ä¸€ç±»çš„æƒ³æ³•ï¼Œè€ƒå¯Ÿç­”æ¡ˆçš„æœ€å€¼ã€‚å‘ç°ä¸€ä¸ªå¾ˆæ¾çš„ä¸Šç•Œæ˜¯ <span class="math inline">\(O(m)\)</span>ï¼›å‘ç°å®é™…æƒ…å†µä¼šæ¯”è¿™ä¸ªä¹è§‚å¾—å¤šï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè€ƒè™‘ç”¨ä¸€äº›æš´åŠ›åšæ³•è‰è¿‡å»äº†ã€‚</p><p>å®é™…ä¸Šæœ‰ä¸€ä¸ªä¸Šç•Œæ˜¯ <span class="math inline">\(3n\)</span>ï¼šå–ä¸€æ¡æœ€çŸ­è·¯ï¼Œåˆ™ä¸å­˜åœ¨è·¯å¾„å¤–çš„ç‚¹ï¼Œä¸è·¯å¾„ä¸Šè‡³å°‘å››ä¸ªç‚¹æœ‰è¿è¾¹ï¼Œå¦åˆ™å¯ä»¥æ›´æ–°æœ€çŸ­è·¯ã€‚è®¾æœ€çŸ­è·¯é•¿ <span class="math inline">\(k\)</span>ï¼Œè®©æ¯æ¬¡ç­‰å¾…æ—¶é—´å–æ»¡ï¼Œè€ƒå¯Ÿç­”æ¡ˆå‘ç°ä¸º <span class="math inline">\(2k\)</span>ï¼ˆè·¯å¾„ä¸Šç‚¹ä¹‹é—´ï¼‰ã€<span class="math inline">\(3(n-k)\)</span>ï¼ˆè·¯å¾„ä¸Šä¸è·¯å¾„å¤–ï¼‰ï¼Œå…±ä¸º <span class="math inline">\(\le 3n\)</span>ã€‚è¿˜æœ‰ä¸€ä¸ªä¸Šç¡®ç•Œæ˜¯ <span class="math inline">\(2n-3\)</span>ï¼Œå¯ä»¥æ¬£èµä¸€ä¸‹ <a href="https://codeforces.com/blog/entry/144876?#comment-1295568" class="uri">https://codeforces.com/blog/entry/144876?#comment-1295568</a>ï¼Œæˆ‘æ²¡çœ‹æ‡‚ ğŸ˜°</p><p>æ€»ä¹‹å¯ä»¥çŒœåˆ°æš´åŠ› dij ä¸Š DP å¾—åˆ°â€¦â€¦ å•Šé¢˜è§£æ€ä¹ˆè¯´æ˜¯ <span class="math inline">\(O(n^2+m)\)</span> çš„ã€‚åŸå› æ˜¯æ±‚å¾—ç­”æ¡ˆä¸Šç•Œä¹‹åå°±èƒ½æš´åŠ›æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹äº† ğŸ˜…</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n, m;        std::cin &gt;&gt; n &gt;&gt; m;        std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);        for (int x, y; m--; ) &#123;            std::cin &gt;&gt; x &gt;&gt; y;            g[x].push_back(y), g[y].push_back(x);        &#125;        std::vector&lt;std::vector&lt;int&gt; &gt; dis(2, std::vector&lt;int&gt; (n + 1, inf));        dis[1][1] = 0;        for (int t = 0; ; ++t) &#123;            auto &amp;d = dis[t &amp; 1], &amp;la = dis[(t &amp; 1) ^ 1];            std::vector&lt;int&gt; (n + 1, inf).swap(d);            for (int i = 1; i &lt;= n; ++i) &#123;                int to = t % ((int)g[i].size());                d[g[i][to]] = std::min(d[g[i][to]], la[i]);                d[i] = std::min(d[i], la[i] + 1);            &#125;            if (d[n] != inf) &#123;                std::cout &lt;&lt; t + 1 &lt;&lt; &#39; &#39; &lt;&lt; d[n] &lt;&lt; &#39;\n&#39;;                break;            &#125;        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="arc202a-merge-and-increment">ARC202A Merge and Increment</h2><p><a href="https://atcoder.jp/contests/arc202/tasks/arc202_a" class="uri">https://atcoder.jp/contests/arc202/tasks/arc202_a</a></p><p>å‡è®¾ç›¸é‚»å…ƒç´ å…¨éƒ¨ä¸åŒï¼Œè‡³å°‘åœ¨å½“å‰è¿™ä¸€æ­¥æœ‰ä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„ç­–ç•¥ï¼ˆè®°ä¸º <em>ç­–ç•¥ä¸€</em>ï¼‰æ˜¯é€‰å…¨å±€æœ€å°å€¼ï¼ŒæŠŠå®ƒå’Œå®ƒå·¦è¾¹ã€å³è¾¹æ›´å°çš„ä¸€ä¸ª merge èµ·æ¥ã€‚</p><p>æ³¨æ„åˆ°å¦‚æœå½“å‰å…¨å±€æœ€å°å€¼æœ‰ç›¸é‚»çš„å¶æ•°ä¸ªï¼Œå¯ä»¥æŠŠç›¸é‚»é¡¹åˆå¹¶ä¸€æ¬¡ï¼Œå¾—åˆ°é•¿åº¦å‡åŠçš„åŒºé—´ï¼Œä¸€å®šä¸åŠ£ï¼ˆè®°ä¸º <em>ç­–ç•¥äºŒ</em>ï¼‰ï¼›å‡å¦‚å½“å‰å…¨å±€æœ€å°å€¼å­˜åœ¨ç›¸é‚»çš„å¥‡æ•°ä¸ªï¼Œå¾ˆå®¹æ˜“æ³¨æ„åˆ°æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š</p><ol type="1"><li>é€‰å–å¶æ•°ä¸ªåº”ç”¨ç­–ç•¥äºŒï¼Œå‰©ä½™ä¸€ä¸ªåº”ç”¨ç­–ç•¥ä¸€ã€‚</li><li>èŠ±ä¸€æ­¥ï¼Œè¡¥ä¸€ä¸ªå…¨å±€æœ€å°å€¼ï¼Œè½¬åŒ–ä¸ºç­–ç•¥äºŒã€‚</li></ol><p>å¾ˆå®¹æ˜“å‘ç°ç¬¬äºŒç§æ–¹å¼ä¸€å®šä¸åŠ£ ğŸ˜…ã€‚æ¨¡æ‹Ÿå³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n;        std::cin &gt;&gt; n;        std::vector&lt;std::pair&lt;int, int&gt; &gt; a(1);        &#123;            for (int i = 1, x; i &lt;= n; ++i) &#123;                std::cin &gt;&gt; x;                if (x != a.back().first)                    a.emplace_back(x, 1);                else                    ++a.back().second;            &#125;            n = (int)a.size() - 1;        &#125;        std::vector&lt;int&gt; pre(n + 2), nex(n + 1), tag(n + 1);        std::priority_queue&lt;std::pair&lt;int, int&gt;, std::vector&lt;std::pair&lt;int, int&gt; &gt;, std::greater&lt;std::pair&lt;int, int&gt; &gt; &gt; q;        for (int i = 1; i &lt;= n; ++i) &#123;            q.emplace(a[i].first, i);            pre[i] = i - 1, nex[i] = i + 1;        &#125;        nex[0] = 1, pre[n + 1] = n;        auto del = [&amp;](int i) &#123;            tag[i] = 1;            pre[nex[i]] = pre[i], nex[pre[i]] = nex[i];            return;        &#125;;        auto res(0ll);        for (; (int)q.size() &gt; 1;) &#123;            auto [x, id] = q.top();            q.pop();            if (tag[id] || a[id].first != x)                continue;            if (a[id].second == 1) &#123;                if (!pre[id] || (nex[id] != n + 1 &amp;&amp; a[nex[id]].first &lt;= a[pre[id]].first))                    res += a[nex[id]].first - x, a[id].first = a[nex[id]].first;                else                    res += a[pre[id]].first - x, a[id].first = a[pre[id]].first;            &#125;            else &#123;                if (a[id].second &amp; 1)                    ++res, ++a[id].second;                ++a[id].first, a[id].second /= 2;            &#125;            if (pre[id] &amp;&amp; a[id].first == a[pre[id]].first)                a[id].second += a[pre[id]].second, del(pre[id]);            if (nex[id] != n + 1 &amp;&amp; a[id].first == a[nex[id]].first)                a[id].second += a[nex[id]].second, del(nex[id]);            q.emplace(a[id].first, id);        &#125;        &#123;            auto [x, id] = q.top();            for ( ; a[id].second != 1; ) &#123;                if (a[id].second &amp; 1)                    ++res, ++a[id].second;                ++a[id].first, a[id].second /= 2;            &#125;        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç»ƒä¹  - DP å‡¸ä¼˜åŒ–</title>
      <link href="/20250709/"/>
      <url>/20250709/</url>
      
        <content type="html"><![CDATA[<p>Stewartâ€™s theoremï¼šåœ¨çº¿æ®µ <span class="math inline">\(AB\)</span> ä¸Šå–ä¸€ç‚¹ <span class="math inline">\(M\)</span>ï¼Œä½¿å¾— <span class="math inline">\(\vec{AB}=\lambda \vec{AM}\)</span>ã€‚åœ¨ <span class="math inline">\(AB\)</span> ä¸Šæ–¹ä»»å–ä¸€ç‚¹ <span class="math inline">\(P\)</span>ï¼Œåˆ™æœ‰ <span class="math inline">\(PM^2=(1-\lambda) PA^2+\lambda PB^2-\lambda(1-\lambda) AB^2\)</span>ã€‚</p><span id="more"></span><hr /><h2 id="d.-akvizna">D. Akvizna</h2><p><a href="http://222.180.160.110:61235/contest/6393/problem/4" class="uri">http://222.180.160.110:61235/contest/6393/problem/4</a></p><p>å…¶å®åˆ°è¿™é‡Œåº”è¯¥å‘ç°äº†ï¼ŒWQS çš„å¥–åŠ±éƒ½ä»¥ä¸€æ¬¡é¡¹ç³»æ•°å‡ºç°ï¼ŒåŸå› ä¹Ÿå¾ˆæ˜¾ç„¶ï¼Œå¥–åŠ±çš„å¯¹è±¡æ˜¯ä¸€æ¬¡é¡¹ç³»æ•°å˜›ã€‚æ­¤å¤–ï¼ŒWQS å†…å±‚ DP æ•°ç»„çš„ç»´åº¦éƒ½åº”å’Œæ“ä½œæ¬¡æ•°æ— å…³ï¼Œè€Œ DP å€¼åº”ä¸ºæœ€å¤§æ”¶ç›Šã€‚è¿™ä¸ªä¹Ÿå¾ˆæ˜¾ç„¶ã€‚</p><p>ä»¤ä¸€è½®æ¯”èµ›çš„æƒ©ç½šæ˜¯ <span class="math inline">\(mid\)</span> ç„¶åäºŒåˆ†ã€‚ä»¤ <span class="math inline">\(f_{j}\)</span> è¡¨ç¤ºå‰©ä½™äººæ•°ä¸º <span class="math inline">\(j\)</span> æ—¶çš„æœ€å¤§æ”¶ç›Šï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_{j}=\max\limits_{k\ge j}\left\{f_k+\frac {k-j}k\right\}-mid\)</span>ã€‚æœ€ååœ¨ <span class="math inline">\(f_0\)</span> å¤„æ‰¾ç­”æ¡ˆå³å¯ã€‚</p><p>ç„¶åå°±å‘ç°ä¸€ä¸ªå¾ˆå¯æ€•çš„é—®é¢˜ï¼Œå†…å±‚ DP å’‹å†™ã€‚å‘ç°æŠŠ <span class="math inline">\(\frac {k-j}k\)</span> æ”¹å†™æˆ <span class="math inline">\(1-\frac jk\)</span> åå‡ºç°äº¤å‰é¡¹ï¼Œè€ƒè™‘æ–œä¼˜ã€‚ä»¤ <span class="math inline">\(a&lt;b\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\(a\)</span> ä¼˜äº <span class="math inline">\(b\)</span> å½“ä¸”ä»…å½“ <span class="math inline">\(\dfrac {f_a-f_b}{\frac 1a - \frac 1b} &gt; j\)</span>ã€‚ç»´æŠ¤å•å‡çš„æ–œç‡å³å¯ã€‚</p><details><p>ç¬‘è¯ï¼šäºŒåˆ† 50 æ¬¡ä¸å¤Ÿï¼Œéœ€è¦ 60 æ¬¡ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    double l = 0., r = 1e5, mid;    auto calc = [&amp;](double mid) &#123;        std::vector&lt;double&gt; f(n + 1, -1e18);        f[n] = 0.;        int h = 1, t = 0;        std::vector&lt;int&gt; q(n + 1), p(n + 1);        q[++t] = n;        // printf(&quot;mid = %.3lf: \n&quot;, mid);        for (int i = n - 1; ~i; --i) &#123;            for (; h &lt; t &amp;&amp; (f[q[h + 1]] - f[q[h]]) / (1. / q[h + 1] - 1. / q[h]) &gt;= i; ++h);            f[i] = f[q[h]] + 1. - i * 1.0 / q[h] - mid, p[i] = p[q[h]] + 1;            // printf(&quot;  %d: f = %.3lf, p = %d, q[h] = %d(%.3lf / %d)\n&quot;, i, f[i], p[i], q[h], f[q[h]], p[q[h]]);            if (i) &#123;                for (; h &lt; t &amp;&amp; (f[i] - f[q[t]]) / (1. / i - 1. / q[t]) &gt;= (f[q[t]] - f[q[t - 1]]) / (1. / q[t] - 1. / q[t - 1]); --t);                q[++t] = i;            &#125;        &#125;        // printf(&quot;res = %.3lf\n&quot;, f[0] + p[0] * mid);        return std::make_pair(f[0], p[0]);    &#125;;    // calc(0.);    // return 0;    double res(0.);    for (int i = 1; i &lt;= 60; ++i) &#123;        mid = (l + r) / 2.;        auto t(calc(mid));        if (t.second &gt;= k)            l = mid, res = t.first + k * mid;        else            r = mid;    &#125;    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(8) &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="e.-poborcy-podatkowi">E. Poborcy podatkowi</h2><p><a href="http://222.180.160.110:61235/contest/6393/problem/5" class="uri">http://222.180.160.110:61235/contest/6393/problem/5</a></p><p>é¦–å…ˆä»¤ <span class="math inline">\(f_{u,l}(i),l=0,1,2,3\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(u\)</span> ä¸ŠæŒ‚äº†é•¿åº¦ä¸º <span class="math inline">\(l\)</span> çš„åŠæ¡é“¾ï¼Œå…±æœ‰ <span class="math inline">\(i\)</span> æ¡æ•´é“¾çš„æœ€å¤§æ”¶ç›Šã€‚</p><p>å¯ä»¥è§‚å¯Ÿåˆ°æ˜¯å‡¸çš„ã€‚é‚£ä¹ˆä¸éš¾å‘ç°éœ€è¦é—½å¯å¤«æ–¯åŸºå’Œï¼Œè€ƒè™‘ <span class="math inline">\(u\)</span> ä½ç½®ä¸Šçš„åˆå¹¶ã€‚<strong>é¦–å…ˆéœ€è¦æ³¨æ„åˆ°å„¿å­ä¸Šé•¿åº¦ä¸º <span class="math inline">\(l\)</span> çš„é“¾åˆ°çˆ¶äº²ä¸Šä¼šå˜æˆ <span class="math inline">\(l+1\)</span></strong>ã€‚æ˜¾ç„¶æ¯æ¡å¯ä»¥ä¸é€‰ï¼›å¦‚æœé€‰äº† <span class="math inline">\(cnt_a\)</span> æ¡é•¿åº¦ä¸º <span class="math inline">\(a\)</span> çš„åŠé“¾ï¼Œé‚£ä¹ˆåˆå¹¶å‡ºæ¥çš„ç»“æœæ˜¯ <span class="math inline">\(cnt_1-cnt_3\)</span> æ¡é•¿åº¦ä¸º <span class="math inline">\(1\)</span> æˆ– <span class="math inline">\(3\)</span> çš„é“¾ã€<span class="math inline">\(cnt_2\bmod 2\)</span> æ¡é•¿åº¦ä¸º <span class="math inline">\(2\)</span> çš„é“¾ï¼Œå¹¶ä¸”è¦æ±‚ä¸¤è€…ä¸åŒæ—¶å‡ºç°ã€‚å‘ç°è¿™ä¸ªä¸œè¥¿åŸºæœ¬ä¸Šå¤„ç†ä¸äº†ã€‚</p><p>æ¥ç€æ³¨æ„åˆ°è¿™ä¸ªå½¢å¼æœ‰ç‚¹åƒèƒŒåŒ…ã€‚ä½†æ€ä¹ˆå¤„ç† <span class="math inline">\(cnt_1\)</span> å’Œ <span class="math inline">\(cnt_3\)</span> é…å¯¹çš„è¿™ä¸ªè¦æ±‚å‘¢ï¼Ÿæœ‰ä¸ªéå¸¸ç²¾å¦™çš„åœ¨ç‰©å“ä½“ç§¯ä¸Šåšæ–‡ç« çš„æ–¹æ³•ï¼š</p><p>é¦–å…ˆæ³¨æ„åˆ°æˆ‘ä»¬æœ€åçš„æŸ¥è¯¢çš„ç­”æ¡ˆè‚¯å®šè¦æ±‚æŠŠæ‰€æœ‰å„¿å­ç”¨å®Œã€‚é‚£ä¹ˆä¸å¦¨è®¾ä½“ç§¯ä¹‹å’Œä¸ºå„¿å­æ€»æ•° <span class="math inline">\(tot\)</span>ã€‚æ¥ç€ï¼Œå¯¹ <span class="math inline">\(cnt_0\)</span>ï¼ˆåŒæ—¶ä¹Ÿæ˜¯ <span class="math inline">\(cnt_4\)</span>ï¼‰æ²¡æœ‰é™åˆ¶ï¼Œç›´æ¥ä»¤å…¶ä½“ç§¯ä¸º <span class="math inline">\(1\)</span>ã€‚<span class="math inline">\(cnt_2\)</span> å•ç‹¬å¤„ç†ï¼ˆç­‰ä¼šå„¿ä¼šè¯´ï¼‰ï¼Œä¸ºäº†ä¸å¯¹ç°åœ¨çš„é—®é¢˜äº§ç”Ÿå½±å“ä¹Ÿä»¤å…¶ä½“ç§¯ä¸º <span class="math inline">\(1\)</span>ã€‚å¯¹äº <span class="math inline">\(cnt_1\)</span> å’Œ <span class="math inline">\(cnt_3\)</span>ï¼Œæ˜¾ç„¶ä¸¤è€…å¹³å‡ä½“ç§¯éœ€è¦ä¸º <span class="math inline">\(1\)</span>ï¼›ä½ å¯ä»¥ä»¤ <span class="math inline">\(cnt_3\)</span> ä½“ç§¯ä¸º <span class="math inline">\(2\)</span>ï¼Œä»¤ <span class="math inline">\(cnt_1\)</span> ä½“ç§¯ä¸º <span class="math inline">\(0\)</span>ã€‚</p><p>æ¥ä¸‹æ¥å°±æœ‰ä¸ªå¾ˆå¥½çš„æ€§è´¨ï¼š<span class="math inline">\(cnt_1\)</span> å¿…é¡»å’Œ <span class="math inline">\(cnt_3\)</span> é…å¯¹æ‰èƒ½è®©å¹³å‡ä½“ç§¯ä¸º <span class="math inline">\(1\)</span>ã€‚åœ¨ <span class="math inline">\(tot\)</span> å¤„æŸ¥æ‰¾çš„ç­”æ¡ˆï¼Œç”± <span class="math inline">\(x\)</span> ä¸ªä½“ç§¯ä¸ä¸º <span class="math inline">\(0\)</span> çš„ç‰©å“å’Œ <span class="math inline">\(tot-x\)</span> ä¸ªä½“ç§¯ä¸º <span class="math inline">\(0\)</span> çš„ç‰©å“ï¼ˆ<span class="math inline">\(cnt_1\)</span>ï¼‰ç»„æˆï¼ŒåŸå› æ˜¯èƒŒåŒ…ä¼šè´ªå¿ƒåœ°åœ¨æ‰€æœ‰ã€å‰©ä½™ã€çš„åˆ†ç»„ä¸­é€‰æ‹©ä½“ç§¯ä¸º <span class="math inline">\(0\)</span> çš„ä¸€é¡¹ã€‚å†è®¡ç®—ä¸€ä¸‹ <span class="math inline">\(cnt_3\)</span>ï¼Œå‘ç°æ˜¾ç„¶ä¸º <span class="math inline">\(tot-x\)</span>ã€‚ç¬¦åˆç›®çš„ã€‚</p><p>åœ¨ <span class="math inline">\(dp_{tot}\)</span> å¤„æŸ¥æ‰¾å¯ä»¥æ‰¾åˆ° <span class="math inline">\(cnt_1=cnt_3\)</span> æ—¶çš„ç­”æ¡ˆï¼›åŒç†ï¼Œåœ¨ <span class="math inline">\(dp_{tot-1},dp_{tot1+1}\)</span> å¤„å¯ä»¥æŸ¥æ‰¾åˆ° <span class="math inline">\(cnt_1=cnt_3\pm 1\)</span> çš„ç­”æ¡ˆã€‚</p><p>æ¥ä¸‹æ¥å†è€ƒè™‘ <span class="math inline">\(cnt_2\)</span>ï¼Œè§£å†³ã€<span class="math inline">\(cnt\bmod2=1\)</span> å’Œ <span class="math inline">\(cnt_1\ne cnt_3\)</span> ä¸èƒ½åŒæ—¶æˆç«‹ã€çš„é™åˆ¶ã€‚é‚£å¤ªå¥½äº†ï¼Œç›´æ¥å¤šå¼€ä¸€ç»´è®°å½• <span class="math inline">\(cnt_2\bmod 2\)</span> å³å¯ã€‚</p><p>å•Šå•Šå¤ªå¦™äº†ã€‚åƒåˆ©ç”¨ä½“ç§¯ä¸º <span class="math inline">\(-1,1\)</span> çš„éšæœºæ•°æ®èƒŒåŒ…æœŸæœ›æœ€å¤§ä½“ç§¯ä¸è¶…è¿‡ <span class="math inline">\(\sqrt V\)</span> çš„é‚£ä¸ªæ–¹æ³•ï¼Œæ˜¾ç„¶å°±æ²¡æœ‰åŠæ³•åˆ©ç”¨å‡¸æ€§äº†ã€‚æ‰€ä»¥è¿™æˆ–è®¸æ˜¯é—½å¯å¤«æ–¯åŸºå’Œåšæ³•çš„å”¯ä¸€è§£ï¼Ÿ</p><p>éœ€è¦çŸ¥é“ï¼Œå¦‚æœè®¾ <span class="math inline">\(cnt_1\)</span> ä¸º <span class="math inline">\(2\)</span> è€Œ <span class="math inline">\(cnt_3\)</span> ä¸º <span class="math inline">\(0\)</span>ï¼Œå§‹ç»ˆä¼šå‡ºä¸€äº›é—®é¢˜ã€‚è¿™ä¸ªæˆ‘å’Œ yly è®¨è®ºäº†ä¸€ä¸‹æ²¡å•¥ç»“æœã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e12;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;1.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);    for (int i = 1, x, y, w; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;        g[x].emplace_back(y, w), g[y].emplace_back(x, w);    &#125;    using arr = std::vector&lt;long long&gt;;    std::vector&lt;arr&gt; f(n + 1, arr(4));    struct node &#123;        std::vector&lt;arr&gt; f;        node(): f(2) &#123;&#125;        node(std::vector&lt;arr&gt; f1): f(f1) &#123;&#125;        arr&amp; operator[](int q) &#123;            return f[q];        &#125;    &#125;;    auto getmax = [&amp;](arr p, arr q) &#123;        arr res(p);        if (q.size() &gt; p.size())            res.resize(q.size());        for (int i = 0; i &lt; (int)q.size(); ++i)            res[i] = std::max(res[i], q[i]);        return res;    &#125;;    auto merge = [&amp;](arr &amp;p, arr &amp;q) &#123;        arr res(p.size() + q.size() - 1), dp(p.size()), dq(q.size());        std::adjacent_difference(p.begin(), p.end(), dp.begin());        std::adjacent_difference(q.begin(), q.end(), dq.begin());        std::merge(dp.begin() + 1, dp.end(), dq.begin() + 1, dq.end(), res.begin() + 1, std::greater&lt;long long&gt; ());        res[0] = p[0] + q[0];        std::partial_sum(res.begin(), res.end(), res.begin());        return res;    &#125;;     std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        if ((int)g[x].size() == 1 &amp;&amp; x != 1) &#123;            f[x][1] = f[x][2] = f[x][3] = -inf;            return;        &#125;        int tot = (int)g[x].size() - (x != 1);        std::vector&lt;arr&gt; w1(1), w2(1);        for (auto [i, w] : g[x])            if (i != fa) &#123;                DFS(i, x);                w1.push_back(&#123; f[i][0] + w, std::max(f[i][0], f[i][3] + w), f[i][2] + w &#125;);                w2.push_back(&#123; -inf, f[i][1] + w &#125;);            &#125;        auto fun = [&amp;](arr &amp;p, arr &amp;q) &#123;            arr res(p.size() + q.size() - 1, -inf);            for (int ip = 0; ip &lt; 2; ++ip)                for (int iq = 0; iq &lt; 2; ++iq) &#123;                    arr tp, tq;                    for (int i = ip; i &lt; (int)p.size(); i += 2)                        tp.push_back(p[i]);                    for (int i = iq; i &lt; (int)q.size(); i += 2)                        tq.push_back(q[i]);                    auto t = merge(tp, tq);                    for (int i = 0; i &lt; (int)t.size(); ++i)                        if (i * 2 + ip + iq &lt; (int)res.size())                            res[i * 2 + ip + iq] = std::max(res[i * 2 + ip + iq], t[i]);                &#125;            return res;        &#125;;         std::function&lt;node(int, int)&gt; calc = [&amp;](int l, int r) &#123;            if (l == r)                return node(&#123; w1[l], w2[l] &#125;);            int mid = (l + r) &gt;&gt; 1;            node t1(calc(l, mid)), t2(calc(mid + 1, r));            return node(&#123; getmax(fun(t1[0], t2[0]), fun(t1[1], t2[1])),                          getmax(fun(t1[0], t2[1]), fun(t1[1], t2[0])) &#125;);        &#125;;        auto t(calc(1, tot));        f[x][0] = t[0][tot], f[x][1] = t[0][tot - 1], f[x][2] = t[1][tot], f[x][3] = t[0][tot + 1];        return;    &#125;;    DFS(1, -1);    std::cout &lt;&lt; f[1][0] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> DP ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å†³ç­–å•è°ƒæ€§</title>
      <link href="/20250707-1/"/>
      <url>/20250707-1/</url>
      
        <content type="html"><![CDATA[<p>ç­‰å’Œçº¿ï¼šåœ¨çº¿æ®µ <span class="math inline">\(AB\)</span> ä¸Šå–ä¸€ç‚¹ <span class="math inline">\(M\)</span>ï¼Œä½¿å¾— <span class="math inline">\(\vec{AB}=\lambda \vec{AM}\)</span>ã€‚åœ¨ <span class="math inline">\(AB\)</span> ä¸Šæ–¹ä»»å–ä¸€ç‚¹ <span class="math inline">\(P\)</span>ï¼Œåˆ™æœ‰ <span class="math inline">\(\vec{PM}=(1-\lambda) \vec{PA}+\lambda \vec{PB}\)</span>ã€‚</p><span id="more"></span><hr /><h2 id="ä»€ä¹ˆæ˜¯-xdyd-dp">ä»€ä¹ˆæ˜¯ xD/yD DP</h2><p>å³ DP æ•°ç»„å…±æœ‰ <span class="math inline">\(x\)</span> ç»´ï¼Œä¸€æ¬¡è½¬ç§»å¤æ‚åº¦ä¸º <span class="math inline">\(O(n^y)\)</span>ã€‚</p><p><del>ä¸ºä»€ä¹ˆè¦ç»™ä¸€å¥è¯å•å¼€ä¸€ä¸ªæ ‡é¢˜</del></p><p>ä¸‹é¢è®¾é€šå¼ <span class="math inline">\(f_i=\max\left\{f_j+w(i,j)\right\}\)</span>ã€‚</p><hr /><h2 id="å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–-dp">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ– DP</h2><p><span class="math inline">\(w(i,j)\)</span> ä»…åŒ…å« <span class="math inline">\(i,j\)</span> çš„æœ€é«˜ä¸€æ¬¡é¡¹ã€‚</p><ul><li>å¦‚æœè¦æ±‚ <span class="math inline">\(j\in [1,i]\)</span>ï¼Œå‰ç¼€æœ€å°å€¼å³å¯ã€‚</li><li>è‹¥ <span class="math inline">\(j\)</span> çš„å–å€¼èŒƒå›´åœ¨åˆ°å¤„ä¹±åŠ¨ï¼Œå¯ä»¥å†™ DS =_=</li><li><p>è‹¥ <span class="math inline">\(j\)</span> çš„å–å€¼èŒƒå›´ <span class="math inline">\([l,r]\)</span> éšç€ <span class="math inline">\(i\)</span> å¢å¤§è€Œ <span class="math inline">\(l,r\)</span> éƒ½ä¸å‡å°ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ã€‚</p><p>é¡ºå¸¦ä¸€æï¼Œå’Œè¿™ç§çš„å•è°ƒé˜Ÿåˆ—ç”¨æ³•ç›¸ä¼¼çš„ã€å•è°ƒæ ˆã€ä¸»è¦åœ¨æ–œä¼˜é‡Œå‡ºç°ã€‚</p></li></ul><p>å…·ä½“è¿‡ç¨‹è¢« grizzly bear åƒæ‰äº† <img src="/em/eat.gif" /></p><h3 id="ä¾‹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…">ä¾‹ï¼šå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…</h3><p>æœ´ç´ çš„å¤šé‡èƒŒåŒ…å¼å­æ˜¯ <span class="math inline">\(f_{i,j}=\max\left\{f_{i-1,j-k\times v_i}+k\times w_i\right\}\)</span>ï¼Œå› ä¸º <span class="math inline">\(i\)</span> å’Œæ•´ä¸ªå¼å­æ— å…³ï¼Œæ‰€ä»¥æ˜¯å…³äº <span class="math inline">\(j\)</span> çš„ 1D/1Dã€‚</p><p>ä¸ºäº†å¥—ç”¨å•è°ƒé˜Ÿåˆ—ï¼Œéœ€è¦æŠŠæŸ¥è¯¢çš„é¡¹å˜æˆè¿ç»­çš„ã€‚å‘ç° <span class="math inline">\(j-k\times v_i\)</span> å’Œ <span class="math inline">\(j\)</span> å…³äº <span class="math inline">\(v_i\)</span> åŒä½™ï¼›ä¸”éšç€ <span class="math inline">\(k\)</span> çš„å¢å¤§ï¼ŒæŸ¥è¯¢çš„ä½ç½®ä¸æ–­ç§»åŠ¨ <span class="math inline">\(v_i\)</span>ã€‚é‚£ä¹ˆä¸å¦¨æŠŠæ‰€æœ‰ <span class="math inline">\(j\)</span> æŒ‰ç…§æ¨¡ <span class="math inline">\(v_i\)</span> çš„ä½™æ•°åˆ†å¼€åšã€‚å…·ä½“åœ°ï¼Œä¸å¦¨è®¾ <span class="math inline">\(j=a\times v_i+b\)</span>ï¼Œå°† <span class="math inline">\(j-k\times v_i\)</span> æ›¿æ¢ä¸ºä½™æ•°å†™æ³•ï¼Œé‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[\begin{aligned}f_{i,j}&amp;=\max\{f_{i-1,x\times v_i+b}+(a-x)\times v_i\}\\&amp;=\max\{f_{i-1,x\times v_i+b}-x\times v_i\}+a\times v_i\end{aligned}\]</span></p><p>é™åˆ¶ <span class="math inline">\((a-x)\)</span> çš„å–å€¼ä¸è¶…è¿‡ç‰©å“æ•°ï¼Œåœ¨ä¸åŒæ¨¡æ•°ä¸‹æŒ‰ <span class="math inline">\(x\)</span> ä»å°åˆ°å¤§å°† <span class="math inline">\(j\)</span> è¿™ä¸€ç»´è¿›è¡Œå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å³å¯ã€‚å®¹æ˜“å‘ç°ä¼šä¸é‡ä¸æ¼æšä¸¾æ‰€æœ‰ä½“ç§¯ï¼›å¤æ‚åº¦ <span class="math inline">\(O(nV)\)</span>ã€‚</p><hr /><h2 id="æ–œç‡ä¼˜åŒ–-dp">æ–œç‡ä¼˜åŒ– DP</h2><p>è‹¥ <span class="math inline">\(w(i,j)\)</span> ç§å«æœ‰ <span class="math inline">\(i,j\)</span> çš„äº¤å‰é¡¹ï¼Œå¯ä»¥è€ƒè™‘æ–œä¼˜ã€‚</p><p>å…·ä½“è¿‡ç¨‹ï¼Œï¼ˆå¦‚æœä½ æ„¿æ„ï¼‰ï¼Œå¯ä»¥çœ‹è¿™ç¯‡ <a href="/20210214/">å››å¹´åŠå‰çš„åšå®¢</a>ã€‚</p><p>å…³äºç¬¦å·ç­‰é—®é¢˜ï¼Œåˆ†äº«ä¸€ä¸‹æˆ‘çš„åšæ³•ï¼š</p><ul><li><p>å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ï¼šé€‚ç”¨äºç¬¦å·å’Œå³ä¾§æ–œç‡è¦æ±‚å•è°ƒæ€§ç›¸åçš„æƒ…å†µã€‚</p><ul><li>é¦–å…ˆï¼Œè®¨è®ºé˜Ÿå¤´ç»´æŠ¤ã€‚ä¸å¦¨å‡è®¾ <span class="math inline">\(a\)</span> ä¸ºé˜Ÿå¤´ç¬¬äºŒä¸ªå…ƒç´ ï¼Œ<span class="math inline">\(b\)</span> ä¸ºé˜Ÿå¤´ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</li><li>å¦‚æœé˜Ÿå¤´ <span class="math inline">\(b\)</span> éœ€è¦è¢«å¼¹å‡ºï¼Œè¯´æ˜ <span class="math inline">\(a\)</span> ä¼˜äº <span class="math inline">\(b\)</span>ï¼›å‡è®¾å¼å­è¦æ±‚ maxï¼Œåˆ™ç”¨ <span class="math inline">\(a\)</span> è½¬ç§»å¾—åˆ°çš„ç­”æ¡ˆ &gt; ç”¨ <span class="math inline">\(b\)</span> è½¬ç§»å¾—åˆ°çš„ç­”æ¡ˆã€‚</li><li>åŒ–å¼å­ï¼Œæ³¨æ„ <span class="math inline">\(a&gt;b\)</span>ï¼›ä¸”è´Ÿæ•°ä¹˜é™¤è¦å˜å·ã€‚</li><li><p>æœ€åå¾—åˆ°çš„å¼å­ä¸­é—´çš„ä¸ç­‰å·å°±å†³å®šäº†éœ€è¦ç»´æŠ¤çš„æ–œç‡å•è°ƒæƒ…å†µã€‚ä»¥æ­¤å†³å®šé˜Ÿå°¾ç»´æŠ¤æ–¹å¼å³å¯ã€‚</p><strong>æ³¨æ„è¿™ä¸ªå¼å­çš„ä¸ç­‰å·ä½“ç°çš„æ˜¯å¼¹å‡ºæ¡ä»¶ï¼›ä¿ç•™æ¡ä»¶å’Œå…¶ç›¸å</strong> <img src="/em/ll.gif" /></li></ul></li><li><p>å•è°ƒæ ˆç»´æŠ¤ï¼šé€‚ç”¨äºç¬¦å·å’Œå³ä¾§æ–œç‡è¦æ±‚å•è°ƒæ€§ç›¸åŒçš„æƒ…å†µï¼›éœ€è¦æ¸…æ¥šï¼Œç»´æŠ¤åˆæ³•æ€§ã€ç»´æŠ¤å•è°ƒå’Œå–ç­”æ¡ˆéƒ½åœ¨æ ˆé¡¶è¿›è¡Œã€‚</p><ul><li>é¦–å…ˆï¼Œéƒ½çŸ¥é“è¦ç”¨å•è°ƒæ ˆäº†ï¼Œè¯´æ˜æ–œä¼˜å½¢å¼å·²ç»è¢«åŒ–å‡ºæ¥äº†ï¼›ä»¥æ­¤ç»´æŠ¤åˆæ³•æ€§å³å¯ã€‚</li><li>ç»´æŠ¤ä¸€ä¸ªä»åº•åˆ°é¡¶ï¼Œã€ä¼˜ã€å¾—è¶Šæ¥è¶Šå°çš„æ–œç‡åºåˆ—ã€‚æ‰¾åˆ°ä»æ›´ä¼˜åˆ°æ›´åŠ£çš„ä¸´ç•Œç‚¹ï¼Œæ›´æ–°ç­”æ¡ˆã€‚</li></ul></li></ul><p>å•Šï¼Œæœç„¶é«˜ä¸­æ–‡åŒ–å­¦ç§‘æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ç®—æ˜¯æ˜ç™½ä¸ºä»€ä¹ˆæˆ‘å°å­¦ / åˆä¸­åŸºæœ¬æ²¡å¼„æ‡‚è¿‡æ–œä¼˜ï¼Œè€Œæ—è¾¹çš„å¤§ä½¬å·²ç»åœ¨ä¹±æ€äº† <img src="/em/hsh.gif" /></p><hr /><p>ç°åœ¨å‡è®¾æ­£åœ¨ç»´æŠ¤ä¸€ä¸ªä¸Šå‡¸åŒ…ï¼Œå¯ä»¥è¿›è¡Œä¸€äº›æ€è€ƒï¼š</p><ul><li><p>å¦‚æœæŸ¥è¯¢åŒºé—´ä¸å•å¢ï¼Ÿ</p>æä¸äº†å•Šè¿™ä¸ªã€‚åºŸäº†ã€‚</li><li><p>æŸ¥è¯¢çš„æ–œç‡ä¸å•å¢ï¼Ÿ</p>å†™ä¸ªäºŒåˆ† + å•è°ƒæ ˆã€‚å‚è§ <a href="https://www.luogu.com.cn/problem/P5785">ä»»åŠ¡å®‰æ’</a>ã€<a href="#ä¾‹traka">TRAKA</a>ã€‚</li><li><p>åŠ å…¥æ–œç‡çš„ä½ç½®ä¸å•å¢ï¼Ÿ</p><p>æè¶… / CDQ / å¹³è¡¡æ ‘ã€‚</p></li></ul><hr /><h2 id="å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–-dp">å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ– DP</h2><h3 id="å…³äºå››è¾¹å½¢ä¸ç­‰å¼">å…³äºå››è¾¹å½¢ä¸ç­‰å¼</h3><p>å¯¹äºä»£ä»·çŸ©é˜µ <span class="math inline">\(w\)</span> å’Œå®šä¹‰åŸŸå†… <span class="math inline">\(\forall\,a\le b\le c\le d\)</span>ï¼Œè‹¥ <span class="math inline">\(w(a,d)+w(b,c)\ge w(a,c)+w(b,d)\)</span>ï¼Œè®¤ä¸º <span class="math inline">\(w\)</span> æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚ç®€è®°ä¸ºé‡å å¤§äºäº¤å‰ã€‚</p><p>å‘½åæ¥æºæ˜¯å››è¾¹å½¢å¯¹è§’çº¿ä¹‹å’Œå¤§äºå¯¹è¾¹ä¹‹å’Œï¼›å°†æ’å¤§äºæ”¹ä¸ºæ’å°äºä¹Ÿèƒ½å¾—åˆ°ç›¸ä¼¼çš„æ€§è´¨ã€‚</p><p>å°±ä¼šå‘ç°å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å’Œæ–œä¼˜å…¶å®æ˜¯å››è¾¹å½¢ä¸ç­‰å¼çš„ç‰¹åŒ–ï¼Œå¯¼è‡´å®ƒä»¬å¯ä»¥å°‘ä¸€ä¸ª logã€‚</p><hr /><h3 id="æ€§è´¨">æ€§è´¨</h3><p>ç”¨äºè¯æ˜ï¼š</p><ul><li>å¯¹äºä»»æ„ <span class="math inline">\(c\le l\le r\)</span>ï¼Œè‹¥ <span class="math inline">\(w(l-c,r+c) + w(l,r)\le w(l-c,r)+ w(l,r+c)\)</span>ï¼Œåˆ™ <span class="math inline">\(w\)</span> æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚</li></ul><p>ç”¨äºé¢˜ç›®ï¼š</p><ul><li><strong>æ€§è´¨ä¸€</strong>ï¼šè‹¥ <span class="math inline">\(f_i\)</span> æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼ˆæˆ–å…¶åå¼ï¼‰ï¼Œé‚£ä¹ˆæœ€ä¼˜å†³ç­–ç‚¹ <span class="math inline">\(p_i\)</span> ä¸ <span class="math inline">\(i\)</span> æœ‰å•è°ƒå…³ç³»ã€‚</li><li><strong>æ€§è´¨äºŒ</strong>ï¼šå½“ <span class="math inline">\(i\)</span> å˜åŒ–æ—¶ï¼Œæ¯ä¸ª <span class="math inline">\(j\)</span> å¸¦æ¥è´¡çŒ®çš„ç›¸å¯¹å¤§å° rank ä¸å˜ã€‚äº¦ä½œï¼šè‹¥ <span class="math inline">\(j_1\)</span> ç›¸å¯¹äº <span class="math inline">\(j_2\)</span> å¯¹ <span class="math inline">\(i\)</span> æ›´ä¼˜ï¼Œå¯¹äºä»»æ„ <span class="math inline">\(i&#39;\)</span>ï¼Œ<span class="math inline">\(j_1\)</span> ç›¸å¯¹äº <span class="math inline">\(j_2\)</span> å¯¹ <span class="math inline">\(i&#39;\)</span> æ›´ä¼˜ã€‚</li></ul><hr /><h3 id="åœ¨ä¼˜åŒ–-dp-ä¹‹å‰">åœ¨ä¼˜åŒ– DP ä¹‹å‰</h3><ul><li><p>é¦–å…ˆæˆ‘å¿…é¡»è¦æä¸€å˜´ã€‚ç”±äºæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦ã€å››è¾¹å½¢ä¸ç­‰å¼ã€æ˜¯åœ¨å››å¹´å‰ï¼Œçœ‹åˆ°ã€çŸ³å­åˆå¹¶çš„ <span class="math inline">\(n^2\)</span> åšæ³•ã€æ—¶ã€‚ç„¶è€Œï¼Œè¿™ä¸€é¢˜çš„ DP æœ¬èº«æœ‰ä¸€ä¸ªç‰¹æ®Šæ€§è´¨ï¼Œå³è´¡çŒ®æ˜¯ä¸€ä¸ªä»¥å†³ç­–ç‚¹ä¸ºæå€¼çš„å‡¸å‡½æ•°ï¼›è¿™ç›´æ¥å¯¼è‡´æˆ‘è¯¯ä»¥ä¸ºè¿™æ˜¯å››è¾¹å½¢ä¸ç­‰å¼æœ¬èº«å¸¦æ¥çš„æ€§è´¨ï¼Œå¯¼è‡´æˆ‘åœ¨ç†è§£ä¸Šæµªè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚<strong>å››è¾¹å½¢ä¸ç­‰å¼å¸¦æ¥çš„æ€§è´¨ï¼Œåªæœ‰ä¸Šè¿°ä¸¤æ¡ï¼</strong></p>å½“ç„¶è¿™ä¹Ÿå‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æœä½ å‘ç°ã€è´¡çŒ®æ˜¯ä¸€ä¸ªä»¥å†³ç­–ç‚¹ä¸ºæå€¼çš„å‡¸å‡½æ•°ã€ï¼Œä½ å°±å¯ä»¥ç”¨ç±»ä¼¼çŸ³å­åˆå¹¶ä¸­çš„çº¿æ€§è½¬ç§»å®Œæˆé—®é¢˜ã€‚</li><li><p>ã€æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€å¹¶ä¸èƒ½ç­‰ä»·äºã€å†³ç­–å•è°ƒæ€§ã€ã€‚å†³ç­–å•è°ƒæ€§å¹¶ä¸å…·å¤‡æ€§è´¨äºŒã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåªæ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œåªæœ‰æœ€ä¼˜å†³ç­–ç‚¹æ˜¯å•è°ƒçš„ï¼Œä½†è´¡çŒ®å‡½æ•°éšç€ <span class="math inline">\(i\)</span> çš„å˜åŒ–ï¼Œå…¶å½¢çŠ¶ä¼šæœ‰å¾ˆå¤§çš„å˜åŠ¨ã€‚</p></li></ul><hr /><h3 id="ä¼˜åŒ–-dpåˆ†æ²»">ä¼˜åŒ– DPï¼šåˆ†æ²»</h3><p>ä¸»è¦é€‚ç”¨äº <span class="math inline">\(f_{i}=g_j+w(j,i)\)</span> çš„åœºæ™¯ï¼Œå…¶ä¸­ <span class="math inline">\(g\)</span> æ˜¯ä¸ <span class="math inline">\(f\)</span> æ— å…³çš„å‡½æ•°ã€‚</p><p>å¯¹äºåˆ†æ²»èŒƒå›´ <span class="math inline">\([l,r]\)</span> å’Œå…¶å†³ç­–ç‚¹èŒƒå›´ <span class="math inline">\([L_p,R_p]\)</span>ï¼Œé¦–å…ˆæŠŠæš´åŠ› <span class="math inline">\(mid\)</span> çš„å†³ç­–ç‚¹ <span class="math inline">\(p_{mid}\)</span> æ‰¾å‡ºæ¥ã€‚</p><p>æ¥ç€å¯¹äº <span class="math inline">\([l,mid)\)</span> å’Œ <span class="math inline">\((mid,R]\)</span>ï¼Œåˆ†åˆ«åœ¨ <span class="math inline">\([L_p,p_{mid}]\)</span> å’Œ <span class="math inline">\([p_{mid},R_p]\)</span> é‡Œæ‰¾å†³ç­–ç‚¹ï¼ˆæ³¨æ„ä¸¤è¾¹éƒ½æ˜¯é—­çš„ï¼‰ã€‚é€’å½’åœ°åšã€‚</p><p>è¿™æ—¶å€™ä½ è‚¯å®šå°±ä¼šæ€€ç–‘äº†ï¼Œä¸»æ’­ä¸»æ’­ï¼Œè™½ç„¶ä½ çš„åŒºé—´æ¯æ¬¡åœ¨å‡åŠï¼Œä½†å†³ç­–ç‚¹èŒƒå›´å¹¶ä¸æ˜¯å‡åˆ†çš„ï¼Œè¿˜ä¼šè¢«å…±ç”¨ï¼Œå¤æ‚åº¦çœŸçš„å¯¹å—ï¼Ÿ</p><p>å¯¹çš„å…„å¼Ÿï¼Œå¯¹çš„ã€‚è§‚å¯Ÿæœç´¢æ ‘ï¼Œä½ ä¼šå‘ç°è™½ç„¶ <span class="math inline">\(p_{mid}\)</span> ä¼šè¢«ç»™ä¸¤ä¸ªå„¿å­å…±ç”¨ï¼Œä½†æ˜¯åœ¨ä»»ä½•ä¸€å±‚ä¸­ï¼Œè¢«é‡å¤ç»è¿‡çš„ç‚¹åªä¼šå‡ºç°åœ¨ä¸¤ä¸ªåŒºé—´çš„äº¤ç•Œå¤„ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯æ•´å±‚å¤§æ¦‚éå† <span class="math inline">\(2n\)</span> æ¬¡ã€‚æ˜¯ä¸æ˜¯å¾ˆå¯¹äº†ã€‚</p><hr /><h4 id="ä¾‹yet-another-minimization-problem">ä¾‹ï¼šYet Another Minimization Problem</h4><p><a href="https://codeforces.com/problemset/problem/868/F" class="uri">https://codeforces.com/problemset/problem/868/F</a></p><details><p><summary>æˆ‘çš„å¤©å“ªï¼æ˜¯ç½•è§çš„å››çº§æ ‡é¢˜ï¼</summary></p><p>ç¬‘ç‚¹è§£æï¼šè¿™ä¸ªäººå› ä¸ºæ‡’å¾—å†™ CSS æ‰€ä»¥åªå†™äº†ç»å¸¸ç”¨çš„ h2 å’Œ h3 çš„æ ·å¼ï¼Œç°åœ¨è¿«ä¸å¾—å·²ç”¨ h4 è¢«å€’é€¼å»å†™äº† h4 çš„ CSSã€‚</p></details><p>å‘ç° <span class="math inline">\(k\le 20\)</span>ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨å†™ WQS äºŒåˆ†ã€‚ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> æ®µåˆ†åœ¨ <span class="math inline">\(j\)</span> å¤„çš„ä»£ä»·ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_{i,j}=\min\{f_{i-1,l}+w(l+1,j)\}\)</span>ï¼Œåˆ†æ²»è§£å†³ã€‚</p><p>æ¥ç€å‘ç°é—®é¢˜ï¼š<span class="math inline">\(w(l+1,j)\)</span> å¹¶ä¸èƒ½å¾ˆå¿«åœ°æ±‚å‡ºæ¥ï¼›ç„¶åæ³¨æ„åˆ°è¿™ä¸ªä»£ä»·çš„å½¢å¼å¾ˆè«é˜Ÿï¼ˆå…¶å®åœ¨çœ‹åˆ°è¿™ä¸ªé¢˜çš„æ—¶å€™å°±ä¼šæœ‰è«é˜Ÿçš„æƒ³æ³•ï¼‰ï¼Œè€ƒè™‘ä½¿ç”¨è«é˜Ÿç§»åŠ¨ç«¯ç‚¹çš„æ–¹å¼è§£å†³é—®é¢˜ã€‚ç”±äºåˆ†æ²»ä¸­æŸ¥è¯¢çš„åŒºé—´ä¸¤ç«¯å•å¢ï¼Œæ¯å±‚çš„æ€»ç§»åŠ¨æ¬¡æ•°æ˜¯ <span class="math inline">\(O(n)\)</span> çš„ï¼Œæ€»å¤æ‚åº¦å°±æ˜¯ <span class="math inline">\(O(nk\log n)\)</span> çš„ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e12;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::vector&lt;long long&gt; cnt(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; p(k + 1, std::vector&lt;int&gt; (n + 1));    std::vector&lt;std::vector&lt;long long&gt; &gt; f(k + 1, std::vector&lt;long long&gt; (n + 1, inf));    auto w = [&amp;](int l, int r) &#123;        static int L = 1, R = 0;        static long long res = 0ll;        for (; L &gt; l; --L, res -= cnt[a[L]] * (cnt[a[L]] - 1) / 2, ++cnt[a[L]], res += cnt[a[L]] * (cnt[a[L]] - 1) / 2);        for (; R &gt; r; res -= cnt[a[R]] * (cnt[a[R]] - 1) / 2, --cnt[a[R]], res += cnt[a[R]] * (cnt[a[R]] - 1) / 2, --R);        for (; R &lt; r; ++R, res -= cnt[a[R]] * (cnt[a[R]] - 1) / 2, ++cnt[a[R]], res += cnt[a[R]] * (cnt[a[R]] - 1) / 2);        for (; L &lt; l; res -= cnt[a[L]] * (cnt[a[L]] - 1) / 2, --cnt[a[L]], res += cnt[a[L]] * (cnt[a[L]] - 1) / 2, ++L);        return res;    &#125;;    f[0][0] = 0ll;    for (int t = 1; t &lt;= k; ++t) &#123;        std::function&lt;void(int, int, int, int)&gt; calc = [&amp;](int l, int r, int lp, int rp) &#123;            if (l &gt; r)                return;            if (l == r) &#123;                for (int i = lp; i &lt;= rp &amp;&amp; i &lt; l; ++i)                    if (f[t - 1][i] + w(i + 1, l) &lt; f[t][l])                        f[t][l] = f[t - 1][i] + w(i + 1, l), p[t][l] = i;                return;            &#125;            int mid = (l + r) &gt;&gt; 1;            for (int i = lp; i &lt;= rp &amp;&amp; i &lt; mid; ++i)                if (f[t - 1][i] + w(i + 1, mid) &lt; f[t][mid])                    f[t][mid] = f[t - 1][i] + w(i + 1, mid), p[t][mid] = i;            calc(l, mid - 1, lp, p[t][mid]), calc(mid + 1, r, p[t][mid], rp);            return;        &#125;;        calc(1, n, 0, n - 1);    &#125;    std::cout &lt;&lt; f[k][n] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="ä¼˜åŒ–-dpå•è°ƒæ•°æ®ç»“æ„">ä¼˜åŒ– DPï¼šå•è°ƒæ•°æ®ç»“æ„</h3><p>æœ‰çš„æ—¶å€™ä¼šå‡ºç° <span class="math inline">\(f_{i}=f_{j}+w(j,i)\)</span> çš„ç»“æ„ï¼Œä¹Ÿå°±æ˜¯ <span class="math inline">\(f\)</span> çš„å–å€¼ä¸è‡ªå·±æœ‰å…³ã€‚</p><p>è¿™ç§æƒ…å†µæˆ‘ä»¬é€šå¸¸é€‰æ‹©å¡«è¡¨æ³•ï¼Œæ±‚å‡º <span class="math inline">\(f_i\)</span> åæ‰¾åˆ° <span class="math inline">\(i\)</span> æ˜¯å“ªäº›ç‚¹çš„æœ€ä¼˜å†³ç­–ï¼ˆé‚£ä¹ˆæ˜¾ç„¶è¿™äº›ç‚¹æ˜¯ä¸€æ®µè¿ç»­åŒºé—´ï¼‰ã€‚ç”¨ <span class="math inline">\((i,l_i,r_i)\)</span> è¿™ä¸ªä¸‰å…ƒç»„è¡¨ç¤ºå½“å‰ç®—å‡ºæ¥çš„ <span class="math inline">\(i\)</span> ç®¡è¾–çš„èŒƒå›´ã€‚</p><p>è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿç»“åˆæ€§è´¨äºŒï¼Œæ¯å½“æˆ‘ä»¬æ‰‹ä¸Šæ‹¿åˆ°ä¸€ä¸ªæ–°çš„ <span class="math inline">\(i\)</span>ï¼Œé‚£ä¹ˆæ¨å‡ºæ¥å…¶ç®¡è¾–èŒƒå›´å³ç«¯ç‚¹å°±ä¼šæ˜¯ <span class="math inline">\(n\)</span>ã€‚æ¥ç€æƒ³åŠæ³•æ‰¾åˆ°å·¦ç«¯ç‚¹ï¼ŒåŒæ ·åˆ©ç”¨æ€§è´¨äºŒï¼ŒäºŒåˆ†å‡ºæœ€é å·¦çš„ä¸€ä¸ª <span class="math inline">\(j\)</span>ï¼Œæ»¡è¶³ä¹‹å‰ç®—å‡ºæ¥çš„å†³ç­–ç‚¹æ²¡æœ‰ <span class="math inline">\(i\)</span> ä¼˜ï¼Œé‚£ä¹ˆ <span class="math inline">\([j,n]\)</span> å°±æ˜¯å½“å‰æ¡ä»¶ä¸‹ <span class="math inline">\(i\)</span> çš„ç®¡è¾–èŒƒå›´ã€‚</p><p>åœ¨é˜Ÿåˆ—é‡ŒåŠ å…¥å½“å‰ç‰ˆæœ¬çš„æ•´ä¸ªä¸‰å…ƒç»„åºåˆ—å°±å¯ä»¥æ–¹ä¾¿åœ°å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚ä¸ºå¯»æ‰¾å½“å‰å…ƒç´ çš„ç­”æ¡ˆï¼Œéœ€è¦å°†é˜Ÿå¤´ä¸Šï¼Œç®¡è¾–èŒƒå›´å®Œå…¨æ—©äºå½“å‰å…ƒç´ çš„å¼¹å‡ºå»ã€‚ç”±äºç»´æŠ¤çš„è¿‡ç¨‹å’Œå•è°ƒé˜Ÿåˆ—å¾ˆåƒï¼Œæ‰€ä»¥ä¹Ÿæœ‰äººç›´æ¥æŠŠè¿™é‡Œçš„é˜Ÿåˆ—å«å•è°ƒé˜Ÿåˆ—ã€‚</p><p>è§†é¢˜ç›®ä¸åŒï¼Œä¹Ÿå¯èƒ½ç”¨åˆ°å•è°ƒæ ˆï¼Œä¹Ÿæœ‰å¯èƒ½ä¸ç”¨äºŒåˆ†ï¼ˆä¾‹å¦‚æ»¡è¶³å‰ä¸¤ç§ç‰¹åŒ–çš„æƒ…å†µï¼‰ã€‚goto <a href="/20250715/#a---yakiniku-restaurants">Yakiniku Restaurants</a>ã€‚</p><hr /><h4 id="ä¾‹è¯—äººå°g">ä¾‹ï¼šè¯—äººå°G</h4><p><a href="https://www.luogu.com.cn/problem/P1912" class="uri">https://www.luogu.com.cn/problem/P1912</a></p><p><del>æˆ‘è§‰å¾—ç»™å‡ºå­—ç¬¦ä¸²å†…å®¹çš„å”¯ä¸€ä»·å€¼æ˜¯è®©å‡ºé¢˜äººæ¬£èµç™½æ—¥ä¾å±±å°½</del></p><p>ä»¤ <span class="math inline">\(f_{j}\)</span> ä¸ºæŸä¸€è¡Œåˆ†åœ¨ç¬¬ <span class="math inline">\(j\)</span> å¥å¤„çš„ä»£ä»·ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_{j}=\min\limits_{k&lt;j}\left\{f_{k}+|(s_j-s_k+j-k-1)-L|^P\right\}\)</span>ã€‚</p><p>é‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘å•è°ƒé˜Ÿåˆ— + äºŒåˆ†äº†ã€‚éœ€è¦æ³¨æ„æ— ç©·å¤§ä¹‹é—´çš„å¤§å°æ¯”è¾ƒï¼Œæˆ‘å†™è¿™ä¸ªå†™çº¢æ¸©äº†ï¼Œç›´æ¥ç”¨æŒ‡æ•°é¡¹ç›¸å¯¹å¤§å°æ¥ä»£æ›¿äº†ï¼Œä¼¼ä¹å¯ä»¥è¿‡ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1000000000000000001ll;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;P1912_2.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n, l, p;        std::cin &gt;&gt; n &gt;&gt; l &gt;&gt; p;        long long to;        switch (p) &#123; // ä¼šæœ‰ç²¾åº¦é—®é¢˜        case 1:            to = 1e18;            break;        case 2:            to = 1e9;            break;        case 3:            to = 1e6;            break;        case 4:            to = 31622;            break;        case 5:            to = 3981;            break;        case 6:            to = 1e3;            break;        case 7:            to = 372;            break;        case 8:            to = 177;            break;        case 9:            to = 100;            break;        default:            to = 63;            break;        &#125;        std::vector&lt;int&gt; s(n + 1);        std::vector&lt;std::string&gt; a(n + 1);        for (int i = 1; i &lt;= n; ++i)            std::cin &gt;&gt; a[i], s[i] = (int)a[i].length();        std::partial_sum(s.begin() + 1, s.end(), s.begin() + 1);        struct node &#123; int i, l, r; &#125;;        std::vector&lt;node&gt; q(n + 1);        int h = 0, t = -1;        q[++t] = &#123; 0, 1, n &#125;;        auto qkp = [&amp;](long long x, int y) &#123;            if (x &gt; to)                return inf;            auto res(1ll);            for (; y--; res *= x);            return res;        &#125;;        std::vector&lt;int&gt; pre(n + 1);        std::vector&lt;long long&gt; f(n + 1);        auto calc = [&amp;](int k, int j) &#123;            return std::min(inf, f[k] + qkp(std::abs(s[j] - s[k] + j - k - 1 - l), p));        &#125;;        auto less = [&amp;](int k1, int j1, int k2, int j2) &#123;            auto t1(calc(k1, j1)), t2(calc(k2, j2));            if (t1 == inf &amp;&amp; t2 == inf)                return std::abs(s[j1] - s[k1] + j1 - k1 - 1 - l) &lt; std::abs(s[j2] - s[k2] + j2 - k2 - 1 - l);            return t1 &lt; t2;        &#125;;        for (int i = 1; i &lt;= n; ++i) &#123;            for (; h &lt;= t &amp;&amp; q[h].r &lt; i; ++h);            f[i] = calc(q[h].i, i), pre[i] = q[h].i;            for (; h &lt;= t &amp;&amp; q[t].l &gt; i &amp;&amp; less(i, q[t].l, q[t].i, q[t].l); --t)                q[t - 1].r = q[t].r;            for (int l = std::max(q[t].l, i + 1), r = q[t].r, mid; l &lt;= r; ) &#123;                mid = (l + r) &gt;&gt; 1;                if (less(i, mid, q[t].i, mid))                    r = q[t].r = mid - 1, q[t + 1] = &#123; i, mid, n &#125;;                else                    l = mid + 1;            &#125;            if (q[t + 1].i == i)                ++t;        &#125;        if (f[n] &gt;= inf)            std::cout &lt;&lt; &quot;Too hard to arrange&quot; &lt;&lt; &#39;\n&#39;;        else &#123;            std::cout &lt;&lt; f[n] &lt;&lt; &#39;\n&#39;;            std::function&lt;void(int)&gt; print = [&amp;](int x) &#123;                if (x == 0)                    return;                print(pre[x]);                for (int i = pre[x] + 1; i &lt;= x; ++i) &#123;                    std::cout &lt;&lt; a[i];                    if (i != x)                        std::cout &lt;&lt; &#39; &#39;;                &#125;                std::cout &lt;&lt; &#39;\n&#39;;                return;            &#125;;            print(n);        &#125;        std::cout &lt;&lt; &quot;--------------------&quot;;        if (T)            std::cout &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><p>éœ€è¦æ³¨æ„ï¼Œæœ¬é¢˜ä¹Ÿå¯ä»¥å†åŠ ä¸€ä¸ªã€æ°å¥½åˆ† <span class="math inline">\(k\)</span> æ®µã€çš„é™åˆ¶ï¼Œç›´æ¥åœ¨å¤–å±‚å¥—ä¸€ä¸ª WQS äºŒåˆ†å°±å¥½äº†ï¼Œå‚è§ <a href="https://www.luogu.com.cn/problem/P6246">é‚®å±€ åŠ å¼ºç‰ˆ åŠ å¼ºç‰ˆ</a>ã€‚</p><h3 id="d1d-dp-ä¼˜åŒ–">2D/1D DP ä¼˜åŒ–</h3><p>è‹¥å­˜åœ¨ <span class="math inline">\(f(i,j)=\min\limits_{k&lt;j} f(i-1,k)+w(k+1,j)\)</span>ï¼Œä¸” <span class="math inline">\(w\)</span> æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼š</p><ul><li><p>è®¾ <span class="math inline">\(p(i,j)\)</span> ä¸ºæœ€ä¼˜å†³ç­–ç‚¹ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(p(i,j)\le p(i,j+1)\le p(i+1,j+1)\)</span>ï¼Œäº¦ä½œ <span class="math inline">\(p(i,j-1)\le p(i,j)\le p(i+1,j)\)</span>ã€‚</p><p>æ­¤æ—¶å¯ä»¥ <span class="math inline">\(O(nm)\)</span> è§£å†³é—®é¢˜ï¼š</p><p><img src="image.png" /></p></li><li><p>è‹¥ <span class="math inline">\(i\)</span> å›ºå®šï¼Œ<span class="math inline">\(f_i(j)\)</span> ä¸ºå‡¸å‡½æ•°ã€‚ï¼ˆä¾‹ï¼šé‚®å±€ åŠ å¼ºç‰ˆ åŠ å¼ºç‰ˆï¼‰</p><p>goto <a href="/20250707/">DP å‡¸ä¼˜åŒ–</a>ã€‚</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> DP ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DP å‡¸ä¼˜åŒ–</title>
      <link href="/20250707/"/>
      <url>/20250707/</url>
      
        <content type="html"><![CDATA[<p>è¢œï¼Œè¿™ç¯‡æ–‡ç« ä¸€ä¸‹å­åˆ›å»ºäº†ä¸‰ä¸ªæ–° tagã€‚</p><span id="more"></span><hr /><h2 id="ä»€ä¹ˆæ˜¯å‡¸å‡½æ•°">ä»€ä¹ˆæ˜¯å‡¸å‡½æ•°</h2><h3 id="å®šä¹‰">å®šä¹‰</h3><p>åœ¨ä¿¡æ¯å­¦ä¸­ç ”ç©¶çš„å‡¸å‡½æ•°å¤§æŠµæ˜¯åªåœ¨æ­£æ•´æ•°åŸŸä¸Šæœ‰å®šä¹‰çš„ï¼Œæ‰€ä»¥åªèƒ½ç›´æ¥æ‘’å¼ƒå¯¼å‡½æ•°çš„æ¦‚å¿µäº†ã€‚</p><p>è‹¥æ–œç‡é€’å¢ï¼Œæ¢è¨€ä¹‹ï¼Œå·®åˆ†æ•°ç»„é€’å¢ï¼Œè®¤ä¸ºå‡½æ•°æ˜¯å‡¸çš„ï¼ˆå¥½åç›´è§‰ï¼‰ã€‚</p><p>æˆ–è€…çœ‹çœ‹ç¬¦å·åŒ–çš„å®šä¹‰ï¼šè‹¥å¯¹äºä»»æ„ <span class="math inline">\(\lambda\in[0,1]\)</span>ï¼Œå‡½æ•° <span class="math inline">\(f(x)\)</span> å‡æ»¡è¶³ï¼š</p><p><span class="math display">\[f(\lambda x+(1-\lambda) y)\le \lambda f(x)+(1-\lambda) f(y).\]</span></p><p>æˆ–ç­‰ä»·åœ°ï¼š</p><p><span class="math display">\[f(x)-f(x - 1)\le f(x + 1) - f(x)\]</span></p><p>é‚£ä¹ˆè®¤ä¸º <span class="math inline">\(f\)</span> æ˜¯å‡¸å‡½æ•°ã€‚</p><p>å› ä¸ºå‡¹å‡¸åœ¨æ€§è´¨ä¸Šæ²¡åŒºåˆ«ï¼Œæ‰€ä»¥ <strong>ä¸‹æ–‡æ–½è¡Œæš´æ”¿ï¼Œå°†å‡¹å‡½æ•°å’Œå‡¸å‡½æ•°ç»Ÿç§°ä¸ºå‡¸å‡½æ•°</strong>ã€‚</p><hr /><h3 id="åˆ¤å®š">åˆ¤å®š</h3><p>å¯¹äºå…·ä½“æƒ…å¢ƒä¸‹çš„é—®é¢˜ï¼Œæ€ä¹ˆåˆ¤æ–­ DP æ•°ç»„æ˜¯å¦å…³äºå…¶æŸä¸€ç»´ä¸ºå‡¸å‡½æ•°ï¼Ÿ</p><ul><li>ç›¸ä¿¡ç›¸ä¿¡çš„åŠ›é‡ï¼ˆæœ€å¸¸ç”¨ï¼‰ã€‚</li><li><p>å¯¹äºåˆ†æ®µé—®é¢˜ï¼Œè¯æ˜åˆ†å‡ºæ¥çš„æ¯ä¸€æ®µæ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚</p><em>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ•°å­¦ä¸Šä¸è®¤ä¸ºæ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼èƒ½å¤Ÿæ¨å‡ºå‡½æ•°ä¸ºå‡¸ã€‚ä½†è¿™æ˜¯ä¿¡æ¯å­¦.jpg</em></li><li><p>å…¶ç”±ä¸¤ä¸ªå‡¸å‡½æ•°çº¿æ€§ç›¸åŠ å¾—åˆ°ï¼š</p><p>å¯¹äº <span class="math inline">\(\forall\, \lambda,\mu\ge 0\)</span> å’Œå‡¸å‡½æ•° <span class="math inline">\(f,g\)</span>ï¼Œè‹¥ <span class="math inline">\(h=\lambda f+\mu g\)</span>ï¼Œåˆ™ <span class="math inline">\(h\)</span> ä¸ºå‡¸å‡½æ•°ã€‚</p>æ­¤å¤–ï¼Œæ­¤æ—¶ <span class="math inline">\(h\)</span> çš„å·®åˆ†æ•°ç»„å’Œ <span class="math inline">\(f,g\)</span> å·®åˆ†æ•°ç»„ä¹Ÿæ»¡è¶³ä¸Šè¿°å…³ç³»ã€‚</li><li>å…¶æ˜¯ä¸¤ä¸ªå‡¸å‡½æ•°çš„ <a href="#é—½å¯å¤«æ–¯åŸºå’Œ">é—½å¯å¤«æ–¯åŸºå’Œ</a>ã€‚</li><li><p>å…¶ç”±ä¸¤ä¸ªå‡¸å‡½æ•°çº¿æ€§ max å¾—åˆ°ã€‚</p><p>å¯¹äºä¸¤ä¸ªå‡¸å‡½æ•°çš„çº¿æ€§ minï¼Œä¸€èˆ¬ä¸æ˜¯å‡¸å‡½æ•°ï¼Œç”šè‡³å¯èƒ½æ˜¯å‡¹çš„ã€‚</p></li></ul><hr /><h3 id="æ€§è´¨">æ€§è´¨</h3><ul><li>æœ€å€¼ä¸ºå”¯ä¸€æå€¼ã€‚</li><li>æ–œç‡ / å·®åˆ†æ•°ç»„å…·æœ‰å•è°ƒæ€§ã€‚</li></ul><p>åœ¨è§£é¢˜ä¸­ä¸»è¦ç”¨åˆ°çš„å¤§æ¦‚å°±æ˜¯ä¸Šé¢ä¸¤æ¡ã€‚</p><hr /><h2 id="wqs-äºŒåˆ†">WQS äºŒåˆ†</h2><h3 id="ä¸»è¦ä»»åŠ¡">ä¸»è¦ä»»åŠ¡</h3><blockquote><p>ä¾‹ï¼šæŠŠ <span class="math inline">\(a_{1\sim n}\)</span> åˆ†ä¸ºæ°å¥½ <span class="math inline">\(k\)</span> æ®µï¼Œæ¯æ®µçš„ä»£ä»·ä¸º <span class="math inline">\(sum^2+c\)</span>ï¼ˆ<span class="math inline">\(c\)</span> ä¸ºç»™å®šçš„å¸¸æ•°ï¼‰ï¼Œé—®æœ€å°ä»£ä»·ã€‚<span class="math inline">\(n\le 2\times 10^5,a_i\le 10^9\)</span>ã€‚</p></blockquote><p>å¦‚æœå¯¹æ®µæ•°æ²¡æœ‰è¦æ±‚ï¼Œå¯ä»¥ç”¨æ–œä¼˜ <span class="math inline">\(O(n)\)</span> åšã€‚</p><p>åŠ ä¸Šäº† <span class="math inline">\(k\)</span> çš„é™åˆ¶ï¼ŒDP å˜æˆäºŒç»´çš„ï¼Œä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(i\)</span> å¤„åˆ†ç¬¬ <span class="math inline">\(j\)</span> æ®µï¼Œå¯ä»¥åœ¨ç¬¬ä¸€ç»´æ–œç‡ä¼˜åŒ–ï¼Œåšåˆ° <span class="math inline">\(O(nk)\)</span>ï¼›äº¦æˆ–å‘ç° <span class="math inline">\((i,j)\)</span> æœ‰å†³ç­–å•è°ƒæ€§ï¼Œç„¶åå››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–åˆ° <span class="math inline">\(O(n^2)\)</span>ã€‚</p><p>æˆ‘ä»¬å‘ç° <span class="math inline">\(f\)</span> å…³äº <span class="math inline">\(j\)</span> è¿™ä¸€ç»´æ˜¯å‡¸çš„ï¼ˆè€Œéä¸Šæ–‡çš„ <span class="math inline">\((i,j)\)</span>ï¼‰ï¼Œæ•…å°† <span class="math inline">\(f(n,j)\)</span> å…³äº <span class="math inline">\(j\)</span> çš„å‡½æ•°æå–å‡ºæ¥ï¼ˆè®°ä¸º <span class="math inline">\(f_n(j)\)</span>ï¼‰ã€‚å‘ç°åªæœ‰æœ€é«˜ç‚¹æ˜¯å¯ä»¥ä¸€æ¬¡æ–œä¼˜å¿«é€Ÿæ±‚å‡ºæ¥çš„ï¼Œæ•…å¯ä»¥è®¤ä¸ºåœ¨å½“å‰å¤æ‚åº¦é™åˆ¶ä¸‹ï¼Œæ•´ä¸ªå‡½æ•°é™¤äº†æœ€é«˜ç‚¹ä»¥å¤–éƒ½æ˜¯æœªçŸ¥çš„ï¼ˆæ³¨æ„å¯ä»¥åœ¨ DP æ—¶è®°å½•æå€¼ç‚¹çš„æ¨ªåæ ‡ï¼Œå³åˆ†äº†å‡ æ®µï¼‰ã€‚</p><p>æˆ‘ä»¬ç»™æ¯ä¸ª <span class="math inline">\(f_n(j)\)</span> åŠ ä¸Š <span class="math inline">\(\alpha\cdot j\)</span>ï¼ˆåœ¨æœ¬é¢˜ä¸­å³å°† <span class="math inline">\(c\gets c+k\)</span>ï¼‰ï¼Œå‹‰å¼ºå¯ä»¥è®¤ä¸º <span class="math inline">\(\alpha\cdot j\)</span> æ˜¯å‡¸çš„ï¼Œæ‰€ä»¥æ–°å‡½æ•° <span class="math inline">\(f&#39;_n(j)\)</span> ä¹Ÿæ˜¯å‡¸çš„ã€‚è‹¥ <span class="math inline">\(k&gt;0\)</span>ï¼Œå¯ä»¥æ„Ÿå—åˆ°æå€¼ç‚¹å‘å·¦åç§»ï¼Œä¸”éšç€ <span class="math inline">\(k\)</span> çš„å¢å¤§ï¼Œæå€¼ç‚¹ä¸ä¼šå³ç§»ï¼›<span class="math inline">\(k&lt;0\)</span> æ—¶åŒç†ã€‚</p><p>ç»“åˆå‡ ä½•è§‚ç‚¹ï¼Œåœ¨ <span class="math inline">\(f_n\)</span> ä¸Šçš„æå€¼ç‚¹å¯ä»¥ç”¨æ–œç‡ä¸º <span class="math inline">\(0\)</span> çš„ç›´çº¿åˆ‡åˆ°ï¼›è€ŒåŠ ä¸Š <span class="math inline">\(\alpha\cdot j\)</span> çš„è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯åˆ‡çº¿æ–œç‡å‡å» <span class="math inline">\(\alpha\)</span> çš„è¿‡ç¨‹ã€‚ç›¸å½“äºä»¤åˆ‡çº¿æ–œç‡ä¸º <span class="math inline">\(-\alpha\)</span>ï¼Œçœ‹çœ‹èƒ½åˆ‡åˆ°å“ªé‡Œã€‚</p><p>æ•…å¯ä»¥äºŒåˆ†ä¸€ä¸ªåˆé€‚çš„ <span class="math inline">\(k\)</span>ï¼Œä½¿å¾—æå€¼ç‚¹çš„æ¨ªåæ ‡ä¸º <span class="math inline">\(k\)</span>ã€‚æ­¤æ—¶ <span class="math inline">\(f&#39;_n(k)-\alpha\cdot k\)</span> å³ä¸ºå¾…æ±‚ã€‚</p><hr /><p>WQS äºŒåˆ†å‚ä¸çš„é—®é¢˜ä¸€èˆ¬ä»¥å¦‚ä¸‹å½¢å¼å‘ˆç°ï¼š</p><blockquote><p>ç»™å®šåºåˆ—ï¼Œå°†å…¶æ°å¥½åˆ†ä¸º <span class="math inline">\(k\)</span> æ®µ / æ°å¥½é€‰ <span class="math inline">\(k\)</span> ä¸ªï¼Œæ±‚æœ€å¤§ / æœ€å°ä»£ä»·ã€‚</p></blockquote><p>é¢˜ç›®è¦æ±‚æœ€å¤§ / æœ€å°å€¼ä¸€èˆ¬èƒ½å¤Ÿåæ˜ å‡½æ•°çš„å‡¹å‡¸æ€§ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸€ç‚¹æ¥çŒœã€‚</p><hr /><h3 id="ç»†èŠ‚å¤„ç†">ç»†èŠ‚å¤„ç†</h3><p>è€ƒè™‘å¦‚ä¸‹å‡¸å‡½æ•°ï¼š</p><p><img src="1.png" /></p><ul><li>æ˜¾ç„¶å¯¹äºã€å‡¸å‡ºæ¥ã€çš„ç‚¹ï¼ˆå³å›¾ä¸­é™¤äº† <span class="math inline">\(E,H\)</span> ä»¥å¤–çš„ç‚¹ï¼‰ï¼Œèƒ½åˆ‡åˆ°çš„ç›´çº¿æ–œç‡ä¸ºä¸€ä¸ªèŒƒå›´ï¼›è€Œä½äºç›´çº¿ä¸Šçš„ç‚¹ï¼ˆé€”ä¸­ <span class="math inline">\(E,H\)</span>ï¼‰ï¼Œèƒ½åˆ‡åˆ°çš„ç›´çº¿æ–œç‡æ›´æ˜¯å®šæ­»äº†ã€‚æ‰€ä»¥è¿™è¦æ±‚ä½ çš„äºŒåˆ†ç²¾åº¦éœ€è¦ç•¥é«˜ä¸€ç‚¹ã€‚</li><li><p>å¯¹äº <span class="math inline">\(E\)</span>ï¼ˆæˆ– <span class="math inline">\(H\)</span>ï¼‰ï¼Œä¸èƒ½æ‰¾åˆ°åªè¿‡å®ƒä¸€ç‚¹çš„åˆ‡çº¿ã€‚æ ¹æ® DP çš„å†™æ³•ï¼Œè®°å½•çš„æ¨ªåæ ‡å¯èƒ½æ˜¯æœ€å°çš„ <span class="math inline">\(D\)</span>ï¼Œä¹Ÿå¯èƒ½æ˜¯æœ€å¤§çš„ <span class="math inline">\(F\)</span>ï¼Œæ­¤æ—¶ä½ å¯ä»¥ï¼š</p><ul><li>åŒæ—¶è®°å½•æœ€å°å’Œæœ€å¤§çš„æ¨ªåæ ‡ï¼Œçœ‹çœ‹ <span class="math inline">\(k\)</span> åœ¨ä¸åœ¨ä¸­é—´ã€‚</li><li><p>é¢˜ç›®è¦æ±‚æœ€å¤§ä»£ä»·æ—¶ï¼Œè®°å½•æœ€å¤§æ¨ªåæ ‡ï¼ŒäºŒåˆ†åˆ°ä¸€ä¸ªæå€¼ç‚¹ <span class="math inline">\(k&#39;\ge k\)</span> æ—¶ï¼Œæ˜¾ç„¶ <span class="math inline">\(\alpha&#39;\ge \alpha\)</span>ï¼Œç”¨ <span class="math inline">\(f&#39;_n(k&#39;)-\alpha&#39;\cdot k\)</span> æ›´æ–°ç­”æ¡ˆï¼ˆæ˜¯èµ‹å€¼è€Œä¸æ˜¯å–æœ€å€¼ï¼‰ï¼›æ±‚æœ€å°ä»£ä»·æ—¶åŒç†ã€‚</p><p>ä¸»è¦æ˜¯éœ€è¦è®°ä½æ–œç‡æ˜¯ <span class="math inline">\(\alpha\)</span> çš„ç›¸åæ•°ï¼Œ<del>å®åœ¨æä¸æ¸…å¯¹åº”å…³ç³»å¯ä»¥éƒ½è¯•ä¸€è¯•</del></p></li></ul></li></ul><hr /><h3 id="ä¾‹ç§æ ‘">ä¾‹ï¼šç§æ ‘</h3><p><a href="https://www.luogu.com.cn/problem/P1484" class="uri">https://www.luogu.com.cn/problem/P1484</a></p><p>é¦–å…ˆï¼Œå‡½æ•°æ˜¯å‡¸çš„â€”â€”æ„Ÿæ€§ç†è§£å³å¯ã€‚</p><p>æ¥ç€ï¼Œè¦æ±‚çš„æ˜¯ <span class="math inline">\(\le k\)</span> æ—¶çš„æœ€å€¼ã€‚åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š<span class="math inline">\(k\)</span> æ˜¯å¦å³äºåŸå‡½æ•°æå€¼ç‚¹ã€‚</p><ul><li>è‹¥ <span class="math inline">\(k\)</span> å³äºåŸå‡½æ•°æå€¼ç‚¹ï¼Œåˆ™åŸå‡½æ•°æå€¼ç‚¹ä¸ºç­”æ¡ˆã€‚</li><li>å¦åˆ™ï¼Œ<span class="math inline">\(k\)</span> ä¸ºç­”æ¡ˆã€‚</li></ul><p>å¥½æ¶ˆæ¯æ˜¯æ•´æ•°åŸŸä¸Šä¸€å®šæœ‰è§£ï¼ˆæœ€åç­”æ¡ˆä¸ºæ•´ã€å€’æ¨å³å¯ï¼‰ï¼Œæ‰€ä»¥ä¸ç”¨æ‰“æµ®ç‚¹æ•°äºŒåˆ†äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int lim = 1e6;const long long inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;long long&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    auto calc = [&amp;](int c) &#123;        std::vector&lt;std::pair&lt;long long, int&gt; &gt; f(n + 1);        auto mx = f.front();        auto upd = [&amp;](auto &amp;x, auto y) &#123;            if (y.first &gt; x.first || (y.first == x.first &amp;&amp; y.second &lt; x.second))                x = y;            return;        &#125;;        for (int i = 1; i &lt;= n; ++i) &#123;            f[i].first = mx.first + a[i] + c;            f[i].second = mx.second + 1;            upd(mx, f[i - 1]);        &#125;        upd(mx, f[n]);        return mx;    &#125;;    auto t(calc(0));    if (t.second &lt;= k) &#123;        std::cout &lt;&lt; t.first &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    auto res(-inf);    for (int l = -lim, r = lim, mid; l &lt;= r; ) &#123;        mid = (l + r) &gt;&gt; 1;        auto t = calc(mid);        if (t.second &lt;= k)            res = t.first - (long long)mid * k, l = mid + 1;        else            r = mid - 1;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="ä¾‹raper">ä¾‹ï¼šRaper</h3><p><a href="https://www.luogu.com.cn/problem/P4694" class="uri">https://www.luogu.com.cn/problem/P4694</a></p><p>ç»™æ‰€æœ‰å…‰ç›˜é™„ä¸€ä¸ªå¥–åŠ± <span class="math inline">\(mid\)</span>ï¼Œè¿›è¡Œ WQS äºŒåˆ†ã€‚</p><p>ç„¶åå†…å±‚å°±å’Œ <a href="#ä¾‹åºåˆ—-sequence">sequence</a> å·®å¾—ä¸æ˜¯ç‰¹åˆ«å¤šï¼Œæ‰€ä»¥è€ƒè™‘åæ‚”è´ªå¿ƒã€‚ï¼ˆï¼Ÿï¼‰</p><p>æŠŠè·¯è¿‡çš„ <span class="math inline">\(-a_j\)</span> ä¸¢åˆ°å¤§æ ¹å †é‡Œï¼Œå°è¯•å’Œ <span class="math inline">\(b_i\)</span> é…å¯¹ã€‚å¦‚æœ <span class="math inline">\(mid-a_i-b_i\ge 0\)</span> é‚£ä¹ˆæš‚æ—¶é…å¯¹ï¼Œé¡ºä¾¿æŠŠ <span class="math inline">\(b_i-mid\)</span> ä¸¢è¿›å»ç”¨äºåæ‚”ï¼Œè‹¥ <span class="math inline">\(b_{i&#39;}\)</span> é€‰ä¸­äº† <span class="math inline">\(b_i-mid\)</span> è¯´æ˜åæ‚”ï¼Œå°† <span class="math inline">\(a_j\)</span> ä¸ <span class="math inline">\(b_{i&#39;}\)</span> é…å¯¹ã€‚</p><p>è´ªå¿ƒçš„æ—¶å€™éœ€è¦è®°å½•å·²ç»é…çš„å¯¹æ•°ï¼Œä¼˜å…ˆé˜Ÿåˆ—ä¸­éœ€è¦å¯¹ <span class="math inline">\(-a_j\)</span> å’Œ <span class="math inline">\(b_i-mid\)</span> æ‰“æ ‡è®°è¿›è¡ŒåŒºåˆ†ï¼ŒåŒ¹é…åˆ°å‰è€…æ—¶æ‰å¢åŠ æˆåŠŸå¯¹æ•°ã€‚</p><p>å‘ç°æ•´æ•°åŸŸä¸Šä»ç„¶å¿…æœ‰è§£ï¼ˆç­”æ¡ˆä¸ºæ•´ï¼Œå€’æ¨ï¼‰ï¼Œä¸ç”¨æ‰“æµ®ç‚¹æ•°äºŒåˆ† neiher.</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 2e9 + 5;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;int&gt; a(n + 1), b(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; b[i];    auto calc = [&amp;](long long mid) &#123;        std::priority_queue&lt;std::pair&lt;long long, int&gt; &gt; q;        int cnt = 0;        auto res(0ll);        for (int i = 1; i &lt;= n; ++i) &#123;            q.emplace(-a[i], 1);            auto [v, ty] = q.top();            if (mid + v - b[i] &gt;= 0) &#123;                q.pop(), cnt += ty;                res += mid + v - b[i], q.emplace(b[i] - mid, 0);            &#125;        &#125;        return std::make_pair(cnt, res);    &#125;;    auto res(inf);    for (long long l = 1ll, r = inf, mid; l &lt;= r; ) &#123;        mid = (l + r) &gt;&gt; 1;        auto t(calc(mid));        if (t.first &gt;= k)            r = mid - 1, res = -(t.second - k * mid);        else            l = mid + 1;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="åŒºé—´åˆ†æ‹†é—®é¢˜">åŒºé—´åˆ†æ‹†é—®é¢˜</h3><p>ç›®æ ‡ï¼šå°è¯•å°† <span class="math inline">\(a_{1\sim n}\)</span> åˆ†å‰²æˆæ°å¥½ <span class="math inline">\(k\)</span> æ®µï¼Œå®šä¹‰ <span class="math inline">\(w(i,j)\)</span> ä¸ºå°† <span class="math inline">\([i,j]\)</span> ä½œä¸ºä¸€æ®µçš„ä»£ä»·ï¼Œæ±‚ä»£ä»·æœ€å€¼ã€‚å…¶ä¸­ <span class="math inline">\(w(i,j)\)</span> æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚</p><p>ä¸å¦¨è®¾æ±‚æœ€å°ä»£ä»·ã€‚å®šä¹‰ <span class="math inline">\(f(i,j)\)</span> åœ¨ <span class="math inline">\(i\)</span> å¤„åˆ†ç¬¬ <span class="math inline">\(j\)</span> æ®µï¼Œé‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[f(i,j)=\min(f(i-1,p-1)+w(p,j)).\]</span></p><blockquote><p>æœ‰å®šç†ï¼šè‹¥ <span class="math inline">\(w(i,j)\)</span> æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f(i-1,j)\le f(i,j)\le f(i,j+1)\)</span>ï¼Œä» <span class="math inline">\(f\)</span> å®šä¹‰å‡ºå‘å¾ˆå¥½æ„Ÿæ€§ç†è§£ã€‚</p></blockquote><p>é‚£ä¹ˆå¯ä»¥ä»è¿™ä¸€ç‚¹å‡ºå‘ï¼Œ<span class="math inline">\(p\)</span> è¿™ä¸€ç»´å°±å¯ä»¥è¢«æ‘Šæ‰ï¼Œåšåˆ° <span class="math inline">\(O(n(n+m))\)</span>ã€‚</p><blockquote><p>æœ‰å®šç†ï¼šè‹¥ <span class="math inline">\(w(i,j)\)</span> æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œé‚£ä¹ˆ <span class="math inline">\(f_i(j)\)</span> æ˜¯å‡¸å‡½æ•°ã€‚</p></blockquote><p>é‚£å¾ˆå¥½äº†ã€‚ç›´æ¥å†²åˆº WQS å³å¯ã€‚</p><hr /><h2 id="é—½å¯å¤«æ–¯åŸºå’Œ">é—½å¯å¤«æ–¯åŸºå’Œ</h2><p>ç»™å®šä¸¤ä¸ªå‡¸å‡½æ•°ï¼ˆå½“ç„¶æ˜¯æŒ‡ OI ä¸­é‚£ç§é•¿å¾—å¾ˆç›´çš„å‡½æ•°ï¼‰ï¼Œå°†å®ƒä»¬çš„ã€è¾¹ã€æ‹†ä¸‹æ¥è¿‡åï¼Œä»¥æŸç§æ–¹å¼æ‹¼åœ¨ä¸€èµ·ï¼Œä½¿å¾—æœ€åå¾—åˆ°ä¸€ä¸ªæ–°çš„å‡¸å‡½æ•°ã€‚</p><p>æŒ‰æ¯æ¡ã€è¾¹ã€çš„æ–œç‡å½’å¹¶ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°ï¼Œæ˜¾ç„¶ç­”æ¡ˆå­˜åœ¨ä¸”å”¯ä¸€ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºé—½å¯å¤«æ–¯åŸºå’Œã€‚å¯ä»¥å‘ç°è¿™æ˜¯ä¸€ç§æœ€å€¼ - åŠ å·ç§¯ã€‚</p><p>å‡è®¾æˆ‘ä»¬è¦æ±‚çš„ DP æ•°ç»„æ˜¯ä¸¤ä¸ªå·²çŸ¥çš„å­æ•°ç»„ä»¥ç±»ä¼¼çš„æ–¹æ³•å·èµ·æ¥çš„ï¼Œæœ€åè¦æ±‚å®Œæ•´çš„ DP æ•°ç»„ï¼ˆè€Œé WQS ä¸­çš„å•ç‚¹å€¼ï¼‰ï¼Œå°±å¯ä»¥è€ƒè™‘é—½å¯å¤«æ–¯åŸºå’Œã€‚</p><p>å‘ç°è¿™ä¸ªç»“æ„æ˜¯å¾ˆé€‚åˆå½’å¹¶çš„ï¼Œä½¿ç”¨å½’å¹¶è¦æ±‚çŠ¶æ€ä¸­å«æœ‰ç‰ˆæœ¬ç»´ã€å› å˜é‡ç»´ã€‚</p><hr /><h3 id="ä¾‹its-mooin-time-p">ä¾‹ï¼šIt's Mooin' Time P</h3><p><a href="https://www.luogu.com.cn/problem/P11459" class="uri">https://www.luogu.com.cn/problem/P11459</a></p><p>å®šä¹‰ <span class="math inline">\(w_i\)</span> ä¸ºå°† <span class="math inline">\([i,i+L)\)</span> æ”¹ä¸º <code>MOO</code> çš„ä»£ä»·ï¼Œé—®é¢˜è½¬åŒ–ä¸ºé€‰å– <span class="math inline">\(1\sim \frac nL\)</span> ä¸ªä¸é‡åŒºé—´çš„æœ€å°ä»£ä»·å’Œã€‚</p><p>å°è¯•å½’å¹¶ï¼Œæ¯æ¬¡å°† <span class="math inline">\([l,mid]\)</span> å’Œ <span class="math inline">\((mid, r]\)</span> å·èµ·æ¥ã€‚ä½†æ˜¯ä¼šæœ‰ä¸€ç‚¹é—®é¢˜ï¼šå¦‚æœæ°å¥½æœ‰åŒºé—´å¡åœ¨ä¸­é—´å‘¢ï¼Ÿ</p><p>å¯ä»¥ä»¤ <span class="math inline">\(f_{l,r,0/1/2,0/1/2}(i)\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\([l,r]\)</span> å†…é€‰äº† <span class="math inline">\(i\)</span> ä¸ª <code>MOO</code>ï¼Œä¸”ä¸¤ä¾§æœ€è¿œçš„è¢«é€‰ç‚¹è·ç¦»ç«¯ç‚¹ä¸º <span class="math inline">\(0/1/\ge 2\)</span> çš„ DP å€¼ã€‚ç„¶åå¯ä»¥è¿›è¡Œç›¸åº”çš„è®¨è®ºã€å¹³ç§»ã€é—½å¯å¤«æ–¯åŸºå’Œï¼Œæœ€åå°†æ‰€æœ‰æƒ…å†µçº¿æ€§å– max å¾—åˆ°è¿™ä¸€å±‚çš„ç­”æ¡ˆï¼Œå®¹æ˜“å‘ç°å¾—åˆ°çš„ç­”æ¡ˆä¹Ÿæ˜¯å‡¸çš„ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;int L;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; L &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    std::vector&lt;char&gt; t(n + 1);    std::vector&lt;long long&gt; w(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; t[i];    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    for (int i = 1; i &lt;= n - L + 1; ++i) &#123;        w[i] = a[i] * (t[i] != &#39;M&#39;);        for (int j = i + 1; j &lt; i + L; ++j)            w[i] += a[j] * (t[j] != &#39;O&#39;);        // printf(&quot;[%d, %d]: %lld\n&quot;, i, i + L - 1, w[i]);    &#125;    if (L == 1) &#123;        std::sort(w.begin() + 1, w.end());        auto s(0ll);        for (int i = 1; i &lt;= n; ++i) &#123;            s += w[i];            std::cout &lt;&lt; s &lt;&lt; &#39;\n&#39;;        &#125;        return 0;    &#125;    using arr = std::vector&lt;long long&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    struct node &#123;        crr f;        node(int len): f(L, brr(L, arr(len, inf))) &#123;            for (int i = 0; i &lt; L; ++i)                for (int j = 0; j &lt; L; ++j)                    f[i][j][0] = 0ll;            return;        &#125;        brr&amp; operator[] (int q) &#123; return f[q]; &#125;    &#125;;    auto upd = [&amp;](arr &amp;x, arr y) &#123;        if (x.size() &lt; y.size())            x.resize(y.size(), inf);        for (int i = 0; i &lt; (int)y.size(); ++i)            x[i] = std::min(x[i], y[i]);        return;    &#125;;    auto merge = [&amp;](arr l, arr r) &#123;        arr out((int)(l.size() + r.size()) - 1), dl(l.size()), dr(r.size());        for (int i = 1; i &lt; (int)l.size(); ++i)            dl[i] = l[i] - l[i - 1];        for (int i = 1; i &lt; (int)r.size(); ++i)            dr[i] = r[i] - r[i - 1];        std::merge(dl.begin() + 1, dl.end(), dr.begin() + 1, dr.end(), out.begin() + 1);        out[0] = l[0] + r[0];        std::partial_sum(out.begin(), out.end(), out.begin());        return out;    &#125;;    std::function&lt;node(int, int)&gt; calc = [&amp;](int l, int r) &#123;        if (r - l + 1 &lt; 2 * L) &#123;            node res(1);            for (int ll = 0; ll &lt; L; ++ll)                for (int rr = 0; rr &lt; L; ++rr)                    if (l + ll &lt;= r - rr - L + 1) &#123;                        res[ll][rr].resize(2, inf);                        for (int i = l + ll; i &lt;= r - rr - L + 1; ++i)                            res[ll][rr][1] = std::min(res[ll][rr][1], w[i]);                        // printf(&quot;[%d, %d]: (%d, %d) = %lld\n&quot;, l, r, ll, rr, res[ll][rr][1]);                    &#125;            // for (int i = 0; i &lt; L; ++i)            //     if (l + i + L - 1 &lt;= r) &#123;            //         printf(&quot;[%d, %d]: (%d, %d) = %lld\n&quot;, l, r, i, r - (l + i + L - 1), w[l + i]);            //         res[i][r - (l + i + L - 1)].emplace_back(w[l + i]);            //     &#125;            return res;        &#125;           int mid = (l + r) &gt;&gt; 1;        node tl(calc(l, mid)), tr(calc(mid + 1, r)), res((r - l + 1) / L + 1);        for (int ll = 0; ll &lt; L; ++ll)            for (int rr = 0; rr &lt; L; ++rr)                res[ll][rr] = merge(tl[ll][0], tr[0][rr]);        for (int ll = 0; ll &lt; L; ++ll)            for (int rr = 0; rr &lt; L; ++rr)                for (int i = 1; i &lt; L &amp;&amp; i &lt; mid; ++i)                    upd(res[ll][rr], merge(merge(tl[ll][i], tr[L - i][rr]), &#123; 0, w[mid - i + 1] &#125;));        for (int ll = 0; ll &lt; L; ++ll)            for (int rr = L - 1; rr; --rr)                upd(res[ll][rr - 1], res[ll][rr]);        for (int rr = 0; rr &lt; L; ++rr)            for (int ll = L - 1; ll; --ll)                upd(res[ll - 1][rr], res[ll][rr]);        // for (int i = 0; i &lt; L; ++i)        //     for (int j = 0; j &lt; L; ++j) &#123;        //         printf(&quot;  (%d, %d): &quot;, i, j);        //         for (auto p : res[i][j])        //             printf(&quot;%lld &quot;, p);        //         puts(&quot;&quot;);        //     &#125;        return res;    &#125;;    auto res(calc(1, n));    for (int i = 1; i &lt;= n / L; ++i)        std::cout &lt;&lt; res[0][0][i] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="ä¾‹å‡äºº">ä¾‹ï¼šå‡äºº</h3><p><a href="http://222.180.160.110:61235/problem/47728" class="uri">http://222.180.160.110:61235/problem/47728</a></p><p>ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºå‰ <span class="math inline">\(i\)</span> ç»„é€‰å®Œå äº† <span class="math inline">\(j\)</span> ä½“ç§¯çš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆæœ‰ <span class="math inline">\(f_{i,j}=\max\{f_{i-1,k}+a_{i,j-k}\}\)</span>ã€‚</p><p><em>è¢œï¼Œè¿™ä¸ªä¸œè¥¿å¥½å‡¸çš„æ ·å­ï¼å•Šï¼Ÿå±…ç„¶ä¸æ˜¯å‡¸çš„ï¼Ÿ</em></p><p>äº‹å®ä¸Šï¼Œæœ‰ç»“è®ºï¼šè‹¥å¹²ä¸ªä½“ç§¯ä¸º <span class="math inline">\(0\sim 4\)</span> çš„ç‰©å“åšèƒŒåŒ…ï¼Œå¯ä»¥å‡‘å‡ºå€¼åŸŸå†…ä»»æ„ <span class="math inline">\(24\)</span> çš„å€æ•°ã€‚æ‰€ä»¥å…ˆæŠŠä½“ç§¯å…¨éƒ¨ <span class="math inline">\(-1\)</span>ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°ä½“ç§¯ä¸º <span class="math inline">\(0\sim 4\)</span> çš„ç‰©å“ã€‚ç„¶åä¼šå‘ç°ä»–ä»¬æŒ‰ç…§æ¨¡ <span class="math inline">\(12\)</span> çš„ä½™æ•°åˆ†åˆ«æ˜¯å‡¸çš„ã€‚</p><p>èƒ½æ„Ÿå—åˆ°æ¶æ„äº†ã€‚ç„¶åå°±å¯ä»¥æšä¸¾ä½“ç§¯ï¼Œå†é—½å¯å¤«æ–¯åŸºå’Œäº†ã€‚åŒæ ·éœ€è¦åœ¨çŠ¶æ€ä¸­å¼•å…¥ä½œä¸ºç‰ˆæœ¬å·çš„ <span class="math inline">\([l,r]\)</span> ç»´ï¼Œæ˜¾ç„¶å› å˜é‡æ˜¯ä½“ç§¯ã€ç‰ˆæœ¬å·æ˜¯ç»„æ•°ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;fake2.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m = 0;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; siz(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; siz[i], m += siz[i];        a[i].resize(siz[i] + 1);        for (int j = 1; j &lt;= siz[i]; ++j)            std::cin &gt;&gt; a[i][j];    &#125;    using arr = std::vector&lt;long long&gt;;    struct node &#123;        std::vector&lt;arr&gt; f;        node(): f(12) &#123;&#125;        arr &amp;operator[] (int q) &#123;            return f[q];        &#125;    &#125;;    auto merge = [&amp;](arr &amp;p, arr &amp;q) &#123;        arr res((int)(p.size() + q.size()) - 1), dp(p.size()), dq(q.size());        std::adjacent_difference(p.begin(), p.end(), dp.begin());        std::adjacent_difference(q.begin(), q.end(), dq.begin());        std::merge(dp.begin() + 1, dp.end(), dq.begin() + 1, dq.end(), res.begin() + 1, std::greater&lt;long long&gt; ());        res[0] = p[0] + q[0];        std::partial_sum(res.begin(), res.end(), res.begin());        return res;    &#125;;    auto upd = [&amp;](arr y, arr &amp;x, int tag) &#123;        if (tag)            y.insert(y.begin(), -inf);        if (y.size() &gt; x.size())            x.resize(y.size(), -inf);        for (int i = 0; i &lt; (int)y.size(); ++i)            x[i] = std::max(x[i], y[i]);        return;    &#125;;    std::function&lt;node(int, int)&gt; calc = [&amp;](int l, int r) &#123;        if (l == r) &#123;            node res;            for (int i = 1; i &lt;= siz[l]; ++i)                res[i - 1].push_back(a[l][i]);            return res;        &#125;        int mid = (l + r) &gt;&gt; 1;        node tl(calc(l, mid)), tr(calc(mid + 1, r)), res;        for (int p = 0; p &lt; 12; ++p)            for (int q = 0; q &lt; 12; ++q)                if (!tl[p].empty() &amp;&amp; !tr[q].empty())                    upd(merge(tl[p], tr[q]), res[(p + q) % 12], p + q &gt;= 12);        return res;    &#125;;    auto res(calc(1, n));    for (int i = 0; i &lt;= m - n; ++i)        std::cout &lt;&lt; res[i % 12][i / 12] &lt;&lt; &#39; &#39;;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="slope-trick">slope trick</h2><p>å¯¹äºä¸€ä¸ª OI ä¸­çš„å‡¸å‡½æ•°ï¼Œå®ƒæ˜¯ç”±ä¸€äº›æ–œç‡å•è°ƒçš„çº¿æ®µæ‹¼æ¥æˆçš„å›¾å½¢ã€‚</p><p>åœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå‘ç°å¯ä»¥ç”¨æ•´ä¸ªå‡½æ•°çš„å·¦ / å³ç«¯ç‚¹å€¼ï¼ˆæˆªè·ï¼‰å’Œ <span class="math inline">\((n-1)\)</span> ä¸ªæ–œç‡ / å·®åˆ†ä¿¡æ¯æè¿°å‡½æ•°ã€‚è€Œè¿™æœ‰æ—¶æ¯”ç›´æ¥ç»´æŠ¤ <span class="math inline">\(n\)</span> ä¸ªç‚¹å€¼æœ‰ç€æ›´ä¼˜ç¾çš„æ€§è´¨ï¼Œå”¤å…¶ä¸º slope trickã€‚</p><p>ä¾‹å¦‚ï¼Œå…³äºæ–œç‡åºåˆ—ï¼Œå¦‚æœå®šä¹‰åŸŸä¸å¤§ï¼Œå¯ä»¥ç›´æ¥ç»´æŠ¤ï¼›å¦‚æœå®ƒçš„å˜åŒ–æ¬¡æ•°ä¸å¤šï¼Œå¯ä»¥åˆ©ç”¨å®ƒçš„å•è°ƒæ€§è´¨ï¼Œç”¨å•è°ƒæ•°æ®ç»“æ„ç»´æŠ¤ï¼›å¦‚æœå®ƒçš„å€¼åŸŸå¾ˆå°ï¼Œå¯ä»¥ç›´æ¥ç»´æŠ¤æ‹ç‚¹ã€‚</p><p>æ³¨æ„å‰ä¸¤ç§æ–¹æ³•ä¸€èˆ¬å…³æ³¨æ¨ªåæ ‡å¯¹åº”çš„å‡½æ•°å€¼ï¼Œæ‰€ä»¥è‡ªå˜é‡ä¸€èˆ¬æ˜¯å’Œæ“ä½œæ¬¡æ•°ä¸€ç±»æœ‰å…³çš„ï¼›è€Œè¿™é‡Œå…³æ³¨å‡½æ•°æœ€å€¼è€Œå¼±åŒ–äº†å…·ä½“æ¨ªåæ ‡ï¼Œæ“ä½œæ¬¡æ•°ä¸€èˆ¬ä¼šä½œä¸ºå¾…æœ€ä¼˜åŒ–çš„å› å˜é‡ï¼Œä¾‹å¦‚ï¼š</p><ul><li>æˆ‘æƒ³è¦å°†æ•°åˆ—é€šè¿‡è‹¥å¹²æ¬¡å•ç‚¹ä¿®æ”¹ä½¿åºåˆ—å•è°ƒï¼Œä½†ä¸å…³å¿ƒåºåˆ—æœ€ç»ˆå½¢æ€ï¼Œé—®æœ€å°æ“ä½œæ¬¡æ•°ã€‚</li><li>æˆ‘æƒ³è¦è®©æ ‘ä¸Šæ‰€æœ‰å¶å­åˆ°æ ¹çš„è·¯å¾„è¾¹æƒå’Œç›¸ç­‰ï¼Œä½†ä¸å…³å¿ƒè¿™ä¸ªå€¼æ˜¯å¤šå°‘ï¼Œé—®æœ€å°æ“ä½œæ¬¡æ•°ã€‚</li></ul><p>ä¸‹é¢ä¾æ¬¡è§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p><hr /><h3 id="ä¾‹åºåˆ—-sequence">ä¾‹ï¼šåºåˆ— sequence</h3><p><a href="https://www.luogu.com.cn/problem/P4597" class="uri">https://www.luogu.com.cn/problem/P4597</a></p><p>æš´åŠ›åœ°ï¼Œä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤º <span class="math inline">\(a_i\)</span> æœ€ç»ˆè¢«ä¿®æ”¹ä¸º <span class="math inline">\(j\)</span>ï¼Œå®¹æ˜“å†™å‡º DP å¼å­ <span class="math inline">\(f_{i,j}=\min\limits_{k\le j}\{f_{i-1,k}\}+|a_i-j|\)</span>ã€‚</p><p>ç„¶åå°±ä¼šå‘ç°å®ƒçš„å®šä¹‰åŸŸå®åœ¨æ˜¯å¤ªå¤§äº†ï¼é‚£å¦‚æœå…³æ³¨æ–œç‡çš„å˜åŒ–æƒ…å†µå‘¢ï¼Ÿ</p><p>ä»¤ <span class="math inline">\(f_{i-1}(k)\)</span> çš„æå€¼ç‚¹ä¸º <span class="math inline">\(k_m\)</span>ï¼Œåˆ†ç±»è®¨è®ºæ‹†ç»å¯¹å€¼å’Œ minï¼š</p><ul><li><p>å½“ <span class="math inline">\(j\le a_i\)</span> æ—¶ï¼Œ<span class="math inline">\(f_i(j)=\min\limits_{k\le j}\{f_{i-1}(k)\}+a_i - j\)</span>ã€‚</p><ul><li>å½“ <span class="math inline">\(j &lt; k_m\)</span> æ—¶ï¼Œ<span class="math inline">\(f_i(j)=f_{i-1}(j)+a_i-j\)</span>ï¼Œæ–œç‡ç›¸å¯¹äº <span class="math inline">\(f_{i-1}(j)\)</span> æ•´ä½“å‡ <span class="math inline">\(1\)</span>ã€‚<del>æˆ‘å°±è¯´å¯¼æ•°æ²¡ç™½å­¦å§</del></li><li>å½“ <span class="math inline">\(j \ge k_m\)</span> æ—¶ï¼Œ<span class="math inline">\(f_i(j)=f_{i-1}(k_m)+a_i-j\)</span>ï¼Œæ–œç‡ä¸º <span class="math inline">\(-1\)</span>ã€‚</li></ul></li><li><p>å½“ <span class="math inline">\(j &gt; a_i\)</span> æ—¶ï¼Œ<span class="math inline">\(f_i(j)=\min\limits_{k\le j}\{f_{i-1}(k)\}+j-a_i\)</span>ã€‚</p><ul><li>å½“ <span class="math inline">\(j &lt; k_m\)</span> æ—¶ï¼Œ<span class="math inline">\(f_i(j)=f_{i-1}(j)+j-a_i\)</span>ï¼Œæ–œç‡ç›¸å¯¹äº <span class="math inline">\(f_{i-1}(j)\)</span> æ•´ä½“åŠ  <span class="math inline">\(1\)</span>ã€‚</li><li>å½“ <span class="math inline">\(j\ge k_m\)</span> æ—¶ï¼Œ<span class="math inline">\(f_i(j) = f_{i-1}(k_m)+j-a_i\)</span>ï¼Œæ–œç‡ä¸º <span class="math inline">\(1\)</span>ã€‚</li></ul></li></ul><p>å¦‚æœç°åœ¨æˆ‘ä»¬æä¸€ä¸ªæ”¯æŒåŒºé—´åŠ æ–œç‡ã€åŒºé—´æ¨å¹³æ–œç‡ä¸”ç»´æŠ¤åŒºé—´å‡½æ•°æœ€å€¼ç‚¹çš„æ•°æ®ç»“æ„ï¼Œé‚£å°±å¤ªé€†å¤©äº†ã€‚ä¸€ä¸ªç»å…¸çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨å †ç»´æŠ¤çº¿æ®µæ–œç‡çš„å·®åˆ†ï¼ˆä¹Ÿå°±æ˜¯å·®åˆ†çš„å·®åˆ†ï¼‰ã€‚</p><p>å‘ç°æ•´ä½“ä¿®æ”¹æ¬¡æ•°æ˜¯ <span class="math inline">\(O(n)\)</span> çš„ï¼Œä¸”å¦‚æœåªçœ‹æ¯” <span class="math inline">\(k_m\)</span> æ›´å·¦çš„ <span class="math inline">\(j\)</span>ï¼ˆæ›´é å³çš„å·²ç»ä¸æå€¼æ— å…³æ‰€ä»¥ä¸ç”¨ç»´æŠ¤ï¼‰ï¼Œé‚£ä¹ˆå°±åªéœ€è¦ç»´æŠ¤åŒºé—´å‡æ³•ã€‚</p><p>å¦‚æœå°†ä¸€æ¬¡åŒºé—´å‰ç¼€å‡æ³•çœ‹ä½œä¸€æ¬¡å‰ç¼€å³ç«¯ç‚¹å…¥é˜Ÿï¼Œæ˜¾ç„¶å·¦ä¾§æŸç‚¹ <span class="math inline">\(a\)</span> çš„å®é™…è¢«å‡æ¬¡æ•°ä¸º <span class="math inline">\(a\)</span> å…¥é˜Ÿçš„æ¬¡æ•° + æ‰€æœ‰å³äº <span class="math inline">\(a\)</span> ç‚¹çš„å…ƒç´ çš„å…¥é˜Ÿæ¬¡æ•°ã€‚ç”¨å¤§æ ¹å †ç»´æŠ¤è¿™äº›å…ƒç´ ï¼Œå°±å¯ä»¥å¿«é€Ÿç»´æŠ¤æ•´ä¸ªæ–œç‡åºåˆ—ã€‚ä¾‹å¦‚ <code>3 2 2 1</code>ï¼Œä»£è¡¨ <span class="math inline">\(3\)</span> å¤„æ–œç‡ä¸º <span class="math inline">\(-1\)</span>ï¼Œ<span class="math inline">\(2\)</span> å¤„æ–œç‡ä¸º <span class="math inline">\(-3\)</span>ï¼Œ<span class="math inline">\(1\)</span> å¤„æ–œç‡ä¸º <span class="math inline">\(-4\)</span>ã€‚</p><ul><li><p>å½“ <span class="math inline">\(a_i\ge k_m\)</span> æ—¶ï¼ˆå®¹æ˜“å‘ç°å®ƒä¼šæˆä¸ºæ–°çš„ <span class="math inline">\(k_m\)</span>ï¼‰ï¼Œç›´æ¥æŠŠ <span class="math inline">\(a_i\)</span> åŠ å…¥å¤§æ ¹å †ï¼Œå°±å¯ä»¥æŠŠ <span class="math inline">\(\le a_i\)</span> çš„æ‰€æœ‰ä½ç½®æ–œç‡å‡å» <span class="math inline">\(1\)</span>ã€‚</p>ä»€ä¹ˆä½ é—®åœ¨ <span class="math inline">\(k_m\)</span> å’Œ <span class="math inline">\(a_i\)</span> ä¹‹é—´çš„æ¨å¹³æ€ä¹ˆåŠï¼Ÿç”±äºå”¯ä¸€å³äºå®ƒä»¬çš„æ‹ç‚¹ <span class="math inline">\(a_i\)</span> å…¥äº†ä¸€æ¬¡é˜Ÿï¼Œæ‰€ä»¥ä¸­é—´çš„å…ƒç´ æ–œç‡è‡ªç„¶æ˜¯ <span class="math inline">\(-1\)</span> å•Šã€‚</li><li><p>å½“ <span class="math inline">\(a_i&lt;k_m\)</span> æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ï¼š</p><ol type="1"><li>å°† <span class="math inline">\(a_i\)</span> ä»¥å·¦çš„ä½ç½®æ–œç‡å‡å» <span class="math inline">\(1\)</span>ï¼Œç›´æ¥å°† <span class="math inline">\(a_i\)</span> å…¥é˜Ÿå³å¯ã€‚</li><li>å°† <span class="math inline">\(a_i\)</span> å’Œ <span class="math inline">\(k_m\)</span> ä¹‹é—´çš„ä½ç½®æ–œç‡åŠ ä¸Š <span class="math inline">\(1\)</span>ï¼ŒæŠŠ <span class="math inline">\(k_m\)</span> å¼¹å‡ºï¼ˆå¤ªå¥½äº†å°±åœ¨é˜Ÿé¦–ï¼‰å†æŠŠ <span class="math inline">\(a_i\)</span> åŠ å…¥å³å¯ã€‚ç”±äº <span class="math inline">\(k_m\)</span> æ˜¾ç„¶æ˜¯ä¸€ä¸ªæ‹ç‚¹ï¼Œæ‰€ä»¥åˆ é™¤ <span class="math inline">\(k_m\)</span> å¹¶éè™šç©ºç´¢æ•Œï¼Œä½†æ³¨æ„ <span class="math inline">\(k_m\)</span> å¯èƒ½ä¼šå˜åŒ–æˆå…¶åç»§ã€‚</li></ol></li></ul><p>å…¶å®å°±ä¼šå‘ç°è¿˜æœ‰ä¸€äº›æœ‰è¶£çš„å°æ€§è´¨ï¼Œæ¯”å¦‚ <span class="math inline">\(k_m\)</span> ä¸é˜Ÿé¦–ç­‰ä»·ï¼ˆç”¨äºå®ç°ï¼‰ï¼›<span class="math inline">\(k_m\)</span> å³ä¾§æ–œç‡å…¨éƒ¨ä¸º <span class="math inline">\(1\)</span>ï¼Œä¹Ÿæ˜¯å”¯ä¸€å¯ä»¥å–åˆ°çš„æ­£æ–œç‡ã€‚</p><details><p>è¢œå†™èµ·æ¥å¥½ç®€å•ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    long long res = 0ll;    std::priority_queue&lt;int&gt; q;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        if (i == 1 || a[i] &gt;= q.top())            q.push(a[i]);        else &#123;            res += q.top() - a[i];            q.pop(), q.push(a[i]), q.push(a[i]);        &#125;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="ä¾‹çƒŸèŠ±è¡¨æ¼”">ä¾‹ï¼šçƒŸèŠ±è¡¨æ¼”</h3><p><a href="https://www.luogu.com.cn/problem/P3642" class="uri">https://www.luogu.com.cn/problem/P3642</a></p><p>è®¾ <span class="math inline">\(f_{u,d}\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(u\)</span> å­æ ‘ä¸­æ‰€æœ‰å¶å­è·æ ¹å‡ä¸º <span class="math inline">\(d\)</span> çš„æœ€å°ä»£ä»·ã€‚é‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[f_{u,d}=\sum\limits_{(v, w)\in u}\min\limits_{0\le w&#39;\le d}\{f_{v,d-w&#39;}+|w-w&#39;|\}.\]</span></p><p>å¯ä»¥å½’çº³è¯æ˜ <span class="math inline">\(f_{u,d}\)</span> ä¸ºå‡¸ï¼›å’Œä¸Šä¸€é¢˜ç›¸ä¼¼åœ°ï¼Œè€ƒè™‘ç”¨ <span class="math inline">\(f_v\)</span> çš„å †å¾—åˆ° <span class="math inline">\(f_u\)</span> çš„å †ã€‚</p><p>é¦–å…ˆæœ€å¤–å±‚æ˜¯ä¸€ä¸ªçº¿æ€§åŠ ï¼Œè¿™å…¶å®å°±æ˜¯æŠŠå·®åˆ†æ•°ç»„ / æ–œç‡åŠ èµ·æ¥ï¼Œæ”¾åˆ°æˆ‘ä»¬è¿™ä¸ªå †é‡Œé¢å°±æ˜¯åˆå¹¶ä¸¤ä¸ªå †ã€‚è™½ç„¶ä½ å¯èƒ½å’Œæˆ‘ä¸€æ ·ä¸è®¤è¯†å¯å¹¶å †ï¼Œä½†æ˜¯ä½ å¯ä»¥å’Œæˆ‘ä¸€æ ·ä¸ä¼š pd_dsã€‚</p><p>å†çœ‹å†…å±‚ï¼Œå‘ç°å’Œä¸Šä¸€é¢˜é•¿å¾—åƒä½†å…¶å®ä¸ä¸€æ ·ï¼Œå‘œå‘œå‘œã€‚å‘ç° <span class="math inline">\(|w-w&#39;|\)</span> æ˜¯ä¸€ä¸ªå·¦å³æ–œç‡åˆ†åˆ«ä¸º <span class="math inline">\(-1,1\)</span> çš„åˆ†æ®µå‡½æ•°ï¼Œè€Œå·¦è¾¹ç±»æ¯”å¯å¾—æ–œç‡æœ€å¤§ä¸º <span class="math inline">\(1\)</span>ã€‚</p><p>ç”±é—½å¯å¤«æ–¯åŸºå’Œï¼Œå†…å±‚å‡½æ•°æ–œç‡ <span class="math inline">\(&lt;-1\)</span> çš„éƒ¨åˆ†æ¥è‡ª <span class="math inline">\(f_{v,d-w&#39;}\)</span>ï¼›<span class="math inline">\(=-1\)</span> çš„éƒ¨åˆ†æ¥è‡ª <span class="math inline">\(f_{v,d-w&#39;}\)</span> å’Œ <span class="math inline">\(|w-w&#39;|\)</span> çš„å·¦åŠè¾¹ï¼ˆæ„Ÿè°¢ <span class="math inline">\(w&#39;\)</span> æ˜¯æœ‰ä¸‹ç¡®ç•Œçš„ï¼‰ï¼›<span class="math inline">\(=0\)</span> çš„éƒ¨åˆ†æ¥è‡ª <span class="math inline">\(f_{v,d-w&#39;}\)</span>ï¼›<span class="math inline">\(&gt;0\)</span> çš„éƒ¨åˆ†æˆ‘ä»¬ä¸å…³å¿ƒã€‚</p><p>æœ€ç»ˆå‡½æ•°å›¾åƒçš„å˜åŒ–ï¼šæ°´å¹³éƒ¨åˆ†çš„å·¦ç«¯ç‚¹å³ç§»äº† <span class="math inline">\(w\)</span>ã€‚æ‰¾åˆ° <span class="math inline">\(f_{v,d}\)</span> ä¸­çš„æ°´å¹³çº¿æ®µå’Œæ–œç‡ä¸º <span class="math inline">\(1\)</span> çš„çº¿æ®µï¼Œä»¤å…¶åœ¨å †ä¸­çš„å€¼ <span class="math inline">\(+w\)</span> å°±èƒ½è¾¾åˆ°å¹³ç§»çš„ç›®çš„ã€‚</p><p>ä½†éœ€è¦æ³¨æ„ï¼Œæ­¤æ—¶ä»ç„¶éœ€è¦ <strong>ä¿ç•™å†…å±‚å‡½æ•°ä¸­æ–œç‡ä¸º <span class="math inline">\(1\)</span> çš„éƒ¨åˆ†ï¼Œä½†æ–œç‡ <span class="math inline">\(&gt;1\)</span> çš„éƒ¨åˆ†è¢«åˆ é™¤</strong>ã€‚åŸå› å¦‚ä¸‹ï¼š</p><ul><li>ç»å¯¹å€¼å‡½æ•°ä¸å†…å±‚å‡½æ•°å®šä¹‰åŸŸç›¸åŒï¼Œä½œé—½å¯å¤«æ–¯åŸºå’Œåï¼Œæ–œç‡ä¸º <span class="math inline">\(1\)</span> çš„å³ä¾§çº¿æ®µä¼šå°† <span class="math inline">\(f_{v,d-w&#39;}\)</span> ä¸­åŸæœ‰çš„ <span class="math inline">\(&gt;1\)</span> çš„éƒ¨åˆ†ã€æŒ¤ã€å‡ºå®šä¹‰åŸŸï¼Œæ•…å¯ä»¥å°†å…¶ç›´æ¥åˆ é™¤ã€‚</li><li>æ–œç‡ä¸º <span class="math inline">\(1\)</span> çš„éƒ¨åˆ†ï¼Œè™½ç„¶å¯¹å†…å±‚å‡½æ•°ä¸­æå€¼ç‚¹æ— è´¡çŒ®ï¼Œä½†åœ¨å¤–å±‚å‡½æ•°ä¸­æå€¼ç‚¹å¯èƒ½å‘å³åç§»ï¼Œæ­¤æ—¶ä¼šå¯¹å…¶äº§ç”Ÿå½±å“ï¼Œéœ€è¦ç»´æŠ¤ã€‚</li></ul><p>å®¹æ˜“å‘ç°ç”±äº <span class="math inline">\(w&#39;\)</span> çš„å–å€¼ä¸Šé™æ˜¯ <span class="math inline">\(d\)</span>ï¼Œä½† <span class="math inline">\(d\)</span> æ²¡æœ‰ä¸Šç•Œï¼Œæ‰€ä»¥æ¯ä¸ªå†…å±‚å‡½æ•°çš„å³ä¾§éƒ½ä¸€å®šæ˜¯ä¸€æ¡æ–œç‡ä¸º <span class="math inline">\(1\)</span> çš„å°„çº¿ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªå¤–å±‚å‡½æ•°ä¸€å®šæœ‰ï¼ˆå„¿å­ä¸ªæ•°ï¼‰ä¸ªæ‹ç‚¹ï¼ˆå †ä¸­å…ƒç´ ï¼‰ï¼Œå¼¹å‡ºè¿™ä¹ˆå¤šä¸ªå°±å¯ä»¥åˆ é™¤å¤–å±‚å‡½æ•°ä¸­æ–œç‡ <span class="math inline">\(&gt;1\)</span> çš„çº¿æ®µï¼Œé¡ºä¾¿æ‰¾åˆ°æ–œç‡ä¸º <span class="math inline">\(0\)</span> å’Œ <span class="math inline">\(1\)</span> çš„çº¿æ®µã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;#include &lt;ext/pb_ds/priority_queue.hpp&gt;const int inf= 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m, n += m;    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);    auto res(0ll);    for (int i = 2, fa, w; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; fa &gt;&gt; w, res += w;        g[fa].emplace_back(i, w);    &#125;    std::vector&lt;__gnu_pbds::priority_queue&lt;long long&gt; &gt; q(n + 1);    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        if (g[x].empty())            q[x].push(0), q[x].push(0);        else            for (auto [i, w] : g[x]) &#123;                DFS(i);                for (int j = 1; j &lt; (int)g[i].size(); ++j)                    q[i].pop();                long long t1 = q[i].top(), t0;                q[i].pop(), t0 = q[i].top(), q[i].pop();                q[i].push(t1 + w), q[i].push(t0 + w);                q[x].join(q[i]);            &#125;        // fprintf(stderr, &quot;size(%d) = %d\n&quot;, x, (int)q[x].size());        return;    &#125;;    DFS(1);    for (int i = 1; i &lt;= (int)g[1].size(); ++i)        q[1].pop();    for (; !q[1].empty(); q[1].pop())        res -= q[1].top();    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="ä¾‹buy-low-sell-high">ä¾‹ï¼šBuy Low Sell High</h3><p><a href="https://codeforces.com/problemset/problem/865/D" class="uri">https://codeforces.com/problemset/problem/865/D</a></p><p>ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºåœ¨ç¬¬ <span class="math inline">\(i\)</span> å¤©ç»“æŸåæŒæœ‰ <span class="math inline">\(j\)</span> æ”¯è‚¡ç¥¨çš„æœ€å¤§æ”¶ç›Šã€‚åˆ™ <span class="math inline">\(f_{i,j}=\max\{f_{i-1,j},f_{i-1,j-1}-a_i,f_{i-1,j+1}+a_i\}\)</span>ã€‚</p><p>ï¼ˆç”±äºè¿™é‡Œå’Œ max æœ‰å…³æ‰€ä»¥éœ€è¦ç²¾ç»†æè¿°å‡¹å‡¸äº†ï¼‰å‘ç°å°±æ˜¯æŠŠä¸‰ä¸ªï¼ˆå¯èƒ½ï¼‰ç»è¿‡å¹³ç§»çš„ï¼ˆå¯èƒ½ï¼‰å‡¹çš„å‡½æ•°åšçº¿æ€§ maxã€‚è™½ç„¶å®é™…ä¸Šçš„ç»“è®ºã€å‡½æ•°åœ¨æ•´ç‚¹ä¸Šæ˜¯å‡¹çš„ã€ä¸ç®—å¤ªæ˜¾ç„¶ï¼Œä½†æ˜¯å¯ä»¥çŒœæ˜¯å‡¹çš„ã€‚</p><p>çº¿æ€§ max åœ¨ slope trick ä¸­æ˜¯ä¸å¤ªèƒ½ä½“ç°çš„ï¼Œä½†æˆ‘ä»¬å‘ç°è¿™é‡Œæ˜¯åŒä¸€ä¸ªå‡¹å‡½æ•°å‘å·¦ä¸Šã€å³ä¸‹å¹³ç§»åŒä¸€ä¸ªå‘é‡ï¼Œå¸Œæœ›å¾—åˆ°æ–°çš„å‡¹å‡½æ•°ä¸ç®¡æ˜¯ä»å·®åˆ†è§’åº¦è¿˜æ˜¯å›¾è±¡ï¼Œéƒ½èƒ½å¾—åˆ°æ–°å‡½æ•°ç”±å·¦ä¸Šéƒ¨åˆ†æ–œç‡ <span class="math inline">\(&gt;-a_i\)</span> çš„çº¿æ®µã€ä¸¤æ®µæ–œç‡ <span class="math inline">\(=-a_i\)</span> çš„çº¿æ®µã€å³ä¸‹éƒ¨åˆ†æ–œç‡ <span class="math inline">\(&lt;-a_i\)</span> çš„çº¿æ®µç»„æˆã€‚æ­¤å¤–ï¼Œç”±äºå‘å·¦ä¸Šå¹³ç§»çš„å‡½æ•°æœ‰ä¸€å¤„ç¦»å¼€äº†å®šä¹‰åŸŸï¼Œè¿˜éœ€å°†å…¶å‰”é™¤ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“ <span class="math inline">\(-a_i\)</span> æ¯”æœ€å°æ–œç‡è¿˜è¦å°æ—¶ä¼šæœ‰å˜åŒ–ï¼Œå¯ä»¥ç”»å›¾çœ‹ä¸€ä¸‹ã€‚</p><p><img src="2.png" /></p><p>å‘ç°å®šä¹‰åŸŸæ˜¯ç›¸å¯¹å°çš„ï¼ˆ<span class="math inline">\(0\le j\le n\)</span>ï¼‰ï¼Œæ•…ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤æ•´ä¸ªæ–œç‡åºåˆ—å°±å¯ä»¥å¿«é€Ÿæ’å…¥ä¸¤ä¸ª <span class="math inline">\(k=-a_i\)</span> çš„çº¿æ®µã€‚å®¹æ˜“å‘ç°é¡¶ç‚¹åœ¨ <span class="math inline">\(j=0\)</span> å¤„å–å¾—ï¼ˆä»å›¾è±¡å’Œå®šä¹‰éƒ½æ˜“çŸ¥ï¼‰ï¼Œæœ€å³ä¾§æ˜¯åªä¹°ä¸å–çš„æœ€åŠ£æ–¹æ¡ˆï¼Œå¯ä»¥å€’æ¨ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    auto res = 0ll;    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i], res -= a[i];    std::priority_queue&lt;int&gt; q;    q.push(-a[1]);    for (int i = 2; i &lt;= n; ++i)        if (a[i] &lt; -q.top())            q.push(-a[i]);        else            q.pop(), q.push(-a[i]), q.push(-a[i]);    for (; !q.empty(); res -= q.top(), q.pop());    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> åæ‚”è´ªå¿ƒ </tag>
            
            <tag> DP ä¼˜åŒ– </tag>
            
            <tag> WQS äºŒåˆ† </tag>
            
            <tag> é—½å¯å¤«æ–¯åŸºå’Œ </tag>
            
            <tag> slope trick </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‚¹åˆ†æ²»</title>
      <link href="/20250612/"/>
      <url>/20250612/</url>
      
        <content type="html"><![CDATA[<p>ä¸€æ—¶å…´èµ·åœ¨åšå®¢é‡Œæœç´¢ã€ç‚¹åˆ†æ²»ã€ï¼Œå‘ç°æ²¡æœ‰åŒ¹é…é¡¹ã€‚</p><span id="more"></span><hr /><h2 id="å®šä¹‰">å®šä¹‰</h2><p>é€‚ç”¨äºè§£å†³å’Œç‚¹å¯¹ã€è·¯å¾„ç›¸å…³çš„é—®é¢˜ã€‚</p><p>å¯¹äºä»»æ„ç‚¹ <span class="math inline">\(x\)</span>ï¼Œæ ‘ä¸Šä»»æ„ç®€å•è·¯å¾„ <span class="math inline">\((u,v)\)</span> è¢«åˆ†ä¸ºå‡ ç±»ï¼š</p><ol type="1"><li>ä¸ç»è¿‡ <span class="math inline">\(x\)</span>ã€‚</li><li>ç»è¿‡ <span class="math inline">\(x\)</span>ï¼š<ul><li>ä¸€ä¸ªç«¯ç‚¹ä¸º <span class="math inline">\(x\)</span>ã€‚</li><li>ä¸¤ä¸ªç«¯ç‚¹éƒ½ä¸ä¸º <span class="math inline">\(x\)</span>ï¼šå¯ä»¥ç”±ä¸Šä¸€ç§æƒ…å†µæ‹¼æ¥å¾—åˆ°ã€‚</li></ul></li></ol><p>å¦‚æœæˆ‘ä»¬æŠŠæ¯ä¸ªç‚¹ä½œä¸º <span class="math inline">\(x\)</span> çš„æƒ…å†µéƒ½æšä¸¾ä¸€éï¼Œå†ç»Ÿè®¡ä¸é‡å¤çš„ <span class="math inline">\((u,v)\)</span>ï¼Œåœ¨ä¸€ç§ç‰¹å®šçš„æšä¸¾é¡ºåºä¸‹å¯ä»¥åšåˆ° <span class="math inline">\(O(n\log n)\)</span> å®Œæˆæ‰€æœ‰ç‚¹å¯¹çš„æšä¸¾ã€‚</p><p>è¯æ˜ç•¥ï¼Œæ¯æ¬¡å–å­æ ‘é‡å¿ƒï¼Œåªéå†æ²¡éå†è¿‡çš„ç‚¹å³å¯ã€‚</p><p>å…³äºå­æ ‘é‡å¿ƒï¼Œä¸€åˆ™é˜…è¯»ææ–™ï¼š<a href="https://liu-cheng-ao.blog.uoj.ac/blog/2969">ä¸€ç§åŸºäºé”™è¯¯çš„å¯»æ‰¾é‡å¿ƒæ–¹æ³•çš„ç‚¹åˆ†æ²»çš„å¤æ‚åº¦åˆ†æ</a>ã€‚</p><hr /><h2 id="cf1575e-eye-pleasing-city-park-tour">CF1575E Eye-Pleasing City Park Tour</h2><p><a href="https://codeforces.com/problemset/problem/1575/E" class="uri">https://codeforces.com/problemset/problem/1575/E</a></p><p>éšä¾¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤ä¸€ä¸‹å°±è¡Œäº†ã€‚å¤æ‚åº¦ <span class="math inline">\(O(n\log^2 n)\)</span>ã€‚</p><details><p>éšä¾¿ç»´æŠ¤ä¸€ä¸‹ <img src="/em/ll.gif" /></p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);    for (int i = 1, x, y, c; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; c;        g[x].emplace_back(y, c), g[y].emplace_back(x, c);    &#125;    std::vector&lt;std::vector&lt;std::pair&lt;int, long long&gt; &gt; &gt; bit(2, std::vector&lt;std::pair&lt;int, long long&gt; &gt; (n + 1));    auto lowbit = [&amp;](int x) &#123;        return x &amp; -x;    &#125;;    auto add = [&amp;](int id, int x, long long v, int type) &#123;        for (++x; x &lt;= n; x += lowbit(x))            bit[id][x].first += type, (bit[id][x].second += v * type) %= mod;        return;    &#125;;    auto ask = [&amp;](int id, int x) &#123;        std::pair&lt;int, long long&gt; res;        for (++x; x; x -= lowbit(x))            res.first += bit[id][x].first, (res.second += bit[id][x].second) %= mod;        return res;    &#125;;    std::vector&lt;int&gt; p, siz(n + 1), mx(n + 1), tag(n + 1);    std::function&lt;void(int, int)&gt; findp = [&amp;](int x, int fa) &#123;        p.push_back(x);        siz[x] = 1, mx[x] = 0;        for (auto [i, c] : g[x])            if (i != fa &amp;&amp; !tag[i]) &#123;                findp(i, x);                siz[x] += siz[i];                mx[x] = std::max(mx[x], siz[i]);            &#125;        return;    &#125;;    auto findrt = [&amp;](int x) &#123;        std::vector&lt;int&gt;().swap(p), findp(x, -1);        int n = (int)p.size();        for (auto i : p)            if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)                return i;        return -1;    &#125;;    auto res(0ll);    std::function&lt;void(int, int, int, int, int, long long, int, int)&gt; calc = [&amp;](int x, int fa, int oc, int la, int cnt, long long s, int os, int type) &#123;        if (cnt &gt; k)            return;        if (type == 0) &#123;            auto t0(ask(oc, k - cnt)), t1(ask(!oc, k - cnt - 1));            // auto lr(res);            (res += t0.first * (s - os) + t0.second) %= mod;            (res += t1.first * (s - os) + t1.second) %= mod;            // printf(&quot;  %d(%d, %lld): ask[0](%d) = (%d, %lld), ask[1](%d) = (%d, %lld), res += %lld\n&quot;, x, cnt, s - os, k - cnt, t0.first, t0.second, k - cnt - 1, t1.first, t1.second, res - lr);        &#125;        else if (type != 0) &#123;            // printf(&quot;  %d(%d, %lld): add(%d, %lld)\n&quot;, x, cnt, s - os, oc, s * type);            add(oc, cnt, s, type);        &#125;        for (auto [i, c] : g[x])            if (i != fa &amp;&amp; !tag[i])                calc(i, x, oc, c, cnt + (la != c), (s + a[i]) % mod, os, type);        return;    &#125;;    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        x = findrt(x);        // printf(&quot;DFS %d\n&quot;, x);        for (auto [i, c] : g[x])            if (!tag[i]) &#123;                calc(i, x, c, c, 0, (a[x] + a[i]) % mod, a[x], 0);                calc(i, x, c, c, 0, (a[x] + a[i]) % mod, a[x], 1);            &#125;        (res += ask(0, k).second + ask(1, k).second) %= mod;        (res += a[x]) %= mod;        // printf(&quot;res += %lld + %lld\n&quot;, ask(0, k).second, ask(1, k).second);        for (auto [i, c] : g[x])            if (!tag[i])                calc(i, x, c, c, 0, (a[x] + a[i]) % mod, a[x], -1);        // assert(!ask(0, k).second);        tag[x] = 1;        for (auto [i, c] : g[x])            if (!tag[i])                DFS(i);        return;    &#125;;    DFS(1);    std::cout &lt;&lt; (res + mod) % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="a---ä¸‰å…ƒå›¾-graf">A - ä¸‰å…ƒå›¾ Graf</h2><p><a href="https://www.luogu.com.cn/problem/P10829" class="uri">https://www.luogu.com.cn/problem/P10829</a></p><p>å‘ç°å¾ˆåœ†æ–¹æ ‘ï¼›è§‚å¯Ÿé¢˜å›¾ï¼Œè‚¯å®šæƒ³è¦æŠŠä¸­é—´çš„æ–¹ç‚¹ä½œä¸ºæ ‘æ ¹ã€‚</p><p>å‘ç°å®ƒå°±æ˜¯é‡å¿ƒï¼›è¿›ä¸€æ­¥åœ°ï¼Œæ•´ä¸ªåœ†æ–¹æ ‘å…¶å®æ˜¯ä¸€ä¸ªç‚¹åˆ†æ²»çš„ç»“æ„ã€‚æ˜¾ç„¶é™¤äº†æœ€åä¸€å±‚ï¼Œæ¯æ¬¡æ‰¾åˆ°çš„é‡å¿ƒéƒ½åº”è¯¥æ˜¯æ–¹ç‚¹ï¼›å¹¶ä¸”å…¶åº”è¯¥æœ‰ä¸‰ä¸ªç­‰å¤§çš„å„¿å­ã€‚check ä¸Šè¿°ä¸¤ç‚¹å³å¯ã€‚</p><p>å”‰è¿˜æ˜¯æŒºå¸¸è§„çš„ï¼Œé™åˆ¶æˆ‘åšå‡ºæ¥è¿™é“é¢˜çš„åº”è¯¥æ˜¯æˆ‘å·²ç» &gt; 1y æ²¡å†™è¿‡è¿é€šæ€§é—®é¢˜äº† ğŸ˜…</p><details><p>æ€ä¹ˆè¿˜æœ‰äººä¸ä¼šåˆ¤é‡è¾¹çš„ ğŸ˜…</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1), _g(n + 1);    auto nosol = [](void) &#123;        std::cout &lt;&lt; &quot;ne&quot; &lt;&lt; &#39;\n&#39;;        exit(0);        return;    &#125;;    std::set&lt;std::pair&lt;int, int&gt; &gt; t;    for (int x, y; m--; ) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        if (x == y || t.count(&#123; x, y &#125;))            nosol();        t.insert(&#123; x, y &#125;), t.insert(&#123; y, x &#125;);        _g[x].push_back(y), _g[y].push_back(x);    &#125;    std::vector&lt;int&gt; st, dfn(n + 1), low(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        static int now = 0;        st.push_back(x);        dfn[x] = low[x] = ++now;        for (auto i : _g[x])            if (!dfn[i]) &#123;                DFS(i, x);                low[x] = std::min(low[x], low[i]);                if (low[i] &gt;= dfn[x]) &#123;                    ++n, g.emplace_back();                    for (int p = st.back(); ; p = st.back()) &#123;                        g[n].push_back(p), g[p].push_back(n);                        st.pop_back();                        if (p == i)                            break;                    &#125;                    g[n].push_back(x), g[x].push_back(n);                &#125;            &#125;            else if (i != fa)                low[x] = std::min(low[x], dfn[i]);        return;    &#125;;    int n1 = n;    DFS(1, -1);    std::vector&lt;int&gt; siz(n + 1), p, mx(n + 1), tag(n + 1);    DFS = [&amp;](int x, int fa) &#123;        siz[x] = 1, mx[x] = 0;        p.push_back(x);        for (auto i : g[x])            if (i != fa &amp;&amp; !tag[i]) &#123;                DFS(i, x);                siz[x] += siz[i];                mx[x] = std::max(mx[x], siz[i]);            &#125;        return;    &#125;;    auto findrt = [&amp;](int x) &#123;        p.clear(), DFS(x, -1);        int n = (int)p.size();        for (auto i : p)            if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)                return i;        return -1;    &#125;;    std::function&lt;void(int)&gt; DFS1 = [&amp;](int x) &#123;        x = findrt(x), DFS(x, -1);        int si = -1, cnt = 0;        if (siz[x] == 1) &#123;            if (x &gt; n1)                nosol();            return;        &#125;        if (x &lt;= n1)            nosol();        for (auto i : g[x])            if (!tag[i]) &#123;                ++cnt;                if (~si &amp;&amp; si != siz[i])                    nosol();                if (si == -1)                    si = siz[i];            &#125;        if (cnt != 3)            nosol();        tag[x] = 1;        for (auto i : g[x])            if (!tag[i])                DFS1(i);        return;    &#125;;     DFS1(1);    std::cout &lt;&lt; &quot;da&quot; &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---distance-on-triangulation">B - Distance on Triangulation</h2><p><a href="https://www.luogu.com.cn/problem/P6976" class="uri">https://www.luogu.com.cn/problem/P6976</a></p><p>ä¼—ï¼ˆé™¤äº†æˆ‘ï¼‰æ‰€å‘¨çŸ¥ <a href="/20231117/#ç»å…¸å»ºæ¨¡">å‡¸å¤šè¾¹å½¢çš„ä¸‰è§’å‰–åˆ†å¯ä»¥è½¬åŒ–ä¸ºæ ‘ä¸Šé—®é¢˜</a>ï¼Œæ•…æŠŠæ ‘å»ºå‡ºæ¥ï¼›ä¸€ä¸ªé‡è¦çš„ç‚¹æ˜¯è¦è®¤è¯†åˆ°è¿™ä¸ªæ ‘çš„æ„ä¹‰ã€‚æ ‘ä¸Šçš„ç‚¹å…¶å®æ˜¯æ²¡ä»€ä¹ˆç‰©ç†å«ä¹‰çš„ï¼›ç»è¿‡äº†æŸä¸€ä¸ªæ ‘ä¸Šçš„ç‚¹å’Œç»è¿‡äº†ä¸‰è§’å½¢ä¸Šçš„ä»»ä¸€ç‚¹æ˜¯ç­‰ä»·çš„ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæƒ³è¦ä»æŸä¸ªç‚¹èµ°åˆ°å¦ä¸€ä¸ªç‚¹ï¼Œè‚¯å®šè¦ç»è¿‡å¯¹åº”çš„æ ‘ä¸Šè·¯å¾„ï¼Œä½†è¿™ä¸èƒ½ååº”å®é™…è·ç¦»ä»€ä¹ˆçš„ï¼Œåªæ˜¯èƒ½è·å–è·¯å¾„å¯èƒ½åŒ…å«çš„ç‚¹å’Œå¿…é¡»åŒ…å«çš„ç‚¹ï¼ˆçš„è¶…é›†ï¼‰ï¼Œå…·ä½“è¿˜æ˜¯è¦æœ€çŸ­è·¯ã€‚</p><p>æ¥ç€è½¬åŒ–ä¸ºç‚¹åˆ†æ²»ã€‚ä½†å…¶å®è¿™é‡Œçš„ç‚¹åˆ†æ²»æœ‰ç‚¹åƒåºåˆ—åˆ†æ²»ï¼šå…ˆè·‘ä¸€éæ ¹èŠ‚ç‚¹ï¼ˆä¸‰ä¸ªï¼‰åœ¨å½“å‰åˆ†æ²»èŒƒå›´å†…çš„æœ€çŸ­è·¯ï¼Œç„¶åå¤„ç†ç»è¿‡äº†è¿™ä¸ªç‚¹çš„è¯¢é—®ï¼Œç„¶åé€’å½’ã€‚å®¹æ˜“å‘ç°ä¸‰ä¸ªç‚¹é‡Œæœ‰ä¸€äº›ä¹‹å‰è¢«ç®—è¿‡äº†ï¼Œä¸”ä¸€å®šåŒ…å«äº†è¿™ä¸ªåˆ†æ²»èŒƒå›´ï¼Œç›´æ¥è·³è¿‡å°±è¡Œäº†ã€‚</p><p>æ³¨æ„è¯¢é—®è¦å†™æˆæ•´ä½“äºŒåˆ†é‚£ç§åŠ¨æ€ä¸‹ä¼ çš„å½¢å¼ï¼ŒåªæŠŠè¢«æŸä¸ªå­æ ‘å®Œå…¨åŒ…å«çš„è¯¢é—®ä¼ ä¸‹å»ï¼›ä¸ç„¶å¤æ‚åº¦æ˜¯é”™çš„ã€‚ä»¥åŠè¿™æ ·å°±å¯ä»¥å‰ªæï¼šå‘ç°è¯¢é—®æ•°ç»„ç©ºäº†å°±å¯ä»¥åœäº†ã€‚ç›´æ¥ TLE to 200ms äº† ğŸ˜…</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; deg(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; _g(n + 1), g(n + 1);    for (int i = 1; i &lt; n; ++i) &#123;        _g[i].push_back(i + 1), _g[i + 1].push_back(i);        ++deg[i], ++deg[i + 1];    &#125;    _g[1].push_back(n), _g[n].push_back(1);    ++deg[1], ++deg[n];    for (int i = 1, x, y; i &lt;= n - 3; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        _g[x].push_back(y), _g[y].push_back(x);        ++deg[x], ++deg[y];    &#125;    int cnt = 0;    std::vector&lt;std::vector&lt;int&gt; &gt; t(1);    &#123;        std::queue&lt;int&gt; q;        std::vector&lt;int&gt; inq(n + 1);        for (int i = 1; i &lt;= n; ++i)            if (deg[i] == 2)                q.push(i);        std::map&lt;std::pair&lt;int, int&gt;, int&gt; st;        for (; !q.empty(); ) &#123;            int x = q.front();            q.pop(), inq[x] = 1;            if (deg[x] == 2) &#123;                ++cnt, t.push_back(&#123; x &#125;);                for (auto i : _g[x])                    if (!inq[i]) &#123;                        t[cnt].push_back(i);                    &#125;                std::sort(t[cnt].begin(), t[cnt].end());                for (int a = 0; a &lt; 2; ++a)                    for (int b = a + 1; b &lt; 3; ++b) &#123;                        std::pair&lt;int, int&gt; now(t[cnt][a], t[cnt][b]);                        if (st.count(now)) &#123;                            int to = st[now];                            // printf(&quot;add %d &lt;-&gt; %d\n&quot;, to, cnt);                            g[cnt].push_back(to), g[to].push_back(cnt);                        &#125;                        else                            st[now] = cnt;                    &#125;            &#125;            for (auto i : _g[x])                if (--deg[i] == 2)                    q.push(i);        &#125;    &#125;    int q;    std::cin &gt;&gt; q;    std::vector&lt;int&gt; res(q + 1, 0x3f3f3f3f);    std::vector&lt;std::tuple&lt;int, int, int&gt; &gt; u(q);    for (int i = 1, x, y; i &lt;= q; ++i)        std::cin &gt;&gt; x &gt;&gt; y, u[i - 1] = &#123; x, y, i &#125;;    int tik = 0;    std::vector&lt;int&gt; siz(cnt + 1), mx(cnt + 1), p, now(n + 1), p1;    std::vector&lt;int&gt; dis(n + 1), tag(n + 1), vis(n + 1), faa(n + 1);    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int fa) &#123;        siz[x] = 1, mx[x] = 0;        p.push_back(x);        for (auto i : t[x])            now[i] = tik, p1.push_back(i);        for (auto i : g[x])            if (i != fa &amp;&amp; !tag[i]) &#123;                DFS1(i, x);                siz[x] += siz[i];                mx[x] = std::max(mx[x], siz[i]);            &#125;        return;    &#125;;    auto findrt = [&amp;](int x) &#123;        p.clear(), p1.clear(), DFS1(x, -1);        int n = (int)p.size();        for (auto i : p)            if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)                return i;        return -1;    &#125;;    auto BFS = [&amp;](int x) &#123;        std::queue&lt;int&gt; q;        for (auto i : p1)            dis[i] = 0x3f3f3f3f;        q.push(x), dis[x] = 0;        for (; !q.empty(); ) &#123;            int x = q.front();            q.pop();            for (auto i : _g[x])                if (dis[i] == 0x3f3f3f3f &amp;&amp; now[i] == tik)                    dis[i] = dis[x] + 1, q.push(i);        &#125;        return;    &#125;;    std::function&lt;void(int, int, int)&gt; calc = [&amp;](int x, int fa, int rt) &#123;        for (auto i : t[x])            faa[i] = rt;        for (auto i : g[x])            if (i != fa &amp;&amp; !tag[i])                calc(i, x, rt);        return;    &#125;;    std::vector&lt;std::vector&lt;std::tuple&lt;int, int, int&gt; &gt; &gt; tmp(n + 1);    std::function&lt;void(int, std::vector&lt;std::tuple&lt;int, int, int&gt; &gt;)&gt; DFS = [&amp;](int x, std::vector&lt;std::tuple&lt;int, int, int&gt; &gt; q) &#123;        if (q.empty())            return;        ++tik, x = findrt(x);        for (auto i : g[x])            calc(i, x, i);        for (auto k : t[x])            if (!vis[k]) &#123;                vis[k] = 1, BFS(k);                for (auto [u, v, id] : q)                    res[id] = std::min(res[id], dis[u] + dis[v]);            &#125;        for (auto [u, v, id] : q)            if (faa[u] == faa[v])                tmp[faa[u]].emplace_back(u, v, id);        std::vector&lt;std::tuple&lt;int, int, int&gt; &gt;().swap(q);        tag[x] = 1;        for (auto i : g[x])            if (!tag[i])                DFS(i, std::move(tmp[i]));        return;    &#125;;    DFS(1, std::move(u));    for (int i = 1; i &lt;= q; ++i)        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---shopping">C - Shopping</h2><p><a href="https://www.luogu.com.cn/problem/P6326" class="uri">https://www.luogu.com.cn/problem/P6326</a></p><p>æ„è¯†åˆ°è¿é€šå— DP ä¹Ÿæ˜¯å¯ä»¥æ”¾åœ¨ç‚¹åˆ†ä¸Šåšçš„ï¼Œä»¤ <span class="math inline">\(f_{u,i}\)</span> è¡¨ç¤ºåœ¨ï¼ˆç‚¹åˆ†æ—¶çš„ï¼‰å­æ ‘ <span class="math inline">\(u\)</span> ä¸­ï¼Œ<span class="math inline">\(u\)</span> é€‰äº†è‡³å°‘ä¸€ä¸ªï¼Œå…±ç”¨äº† <span class="math inline">\(i\)</span> ä½“ç§¯çš„æœ€å¤§ä»·å€¼ã€‚å‰©ä¸‹å°±æ˜¯ä¸€ä¸ªæ ‘ä¸Šçš„å¤šé‡ + 01 èƒŒåŒ…ï¼›å‘ç°è¿™ä¸ª 01 èƒŒåŒ…ä¸æ»¡è¶³å¯ä»¥ä¼˜åŒ–çš„å½¢å¼ï¼Œæ‰€ä»¥è€ƒè™‘æ ‘ä¸ŠèƒŒåŒ…åºåˆ—åŒ–ï¼Œè½¬æ¢æˆåºåˆ—ä¸Šå¤šé‡èƒŒåŒ…é—®é¢˜ï¼›ä¸çŸ¥é“çœŸå®æ•°æ®å¼ºåº¦ï¼Œä½†æˆ‘è®¤ä¸ºåº”è¯¥ç”¨ <a href="/20250707-1/#ä¾‹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…</a>ã€‚</p><p>æ³¨æ„æ ‘èƒŒåŒ…åºåˆ—åŒ–çš„ç»†èŠ‚å…¶å®æ˜¯æœ‰ç‚¹å¤šçš„ã€‚å¯èƒ½éœ€è¦ä¸€äº›é‚ªæ€ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n, m;        std::cin &gt;&gt; n &gt;&gt; m;        std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);        std::vector&lt;int&gt; v(n + 1), w(n + 1), c(n + 1);        for (int i = 1; i &lt;= n; ++i)            std::cin &gt;&gt; w[i];        for (int i = 1; i &lt;= n; ++i)            std::cin &gt;&gt; v[i];        for (int i = 1; i &lt;= n; ++i)            std::cin &gt;&gt; c[i];        for (int i = 1, x, y; i &lt; n; ++i) &#123;            std::cin &gt;&gt; x &gt;&gt; y;            g[x].push_back(y), g[y].push_back(x);        &#125;        std::vector&lt;int&gt; siz(n + 1), mx(n + 1), tag(n + 1), p;        std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int fa) &#123;            p.push_back(x);            siz[x] = 1, mx[x] = 0;            for (auto i : g[x])                if (i != fa &amp;&amp; !tag[i]) &#123;                    DFS1(i, x);                    siz[x] += siz[i];                    mx[x] = std::max(mx[x], siz[i]);                &#125;            return;        &#125;;        int now = 0;        std::vector&lt;int&gt; nex(n + 1), tab(n + 1);        auto findrt = [&amp;](int x) &#123;            p.clear(), DFS1(x, -1);            int n = (int)p.size();            for (auto i : p)                if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)                    return i;            assert(0);            return -1;        &#125;;        std::function&lt;void(int, int)&gt; DFS2 = [&amp;](int x, int fa) &#123;            tab[++now] = x;            for (auto i : g[x])                if (i != fa &amp;&amp; !tag[i])                    DFS2(i, x);            nex[x] = now;            return;        &#125;;        int res = -inf;        std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;            x = findrt(x), now = 0, DFS2(x, -1);            std::vector&lt;std::vector&lt;int&gt; &gt; f(now + 1, std::vector&lt;int&gt; (m + 1, -inf));            for (int i = 1; i &lt;= c[x] &amp;&amp; i * v[x] &lt;= m; ++i)                f[1][i * v[x]] = i * w[x];            for (int i = 1; i &lt; now; ++i) &#123;                int V = v[tab[i + 1]], W = w[tab[i + 1]], C = c[tab[i + 1]];                for (int b = 0; b &lt; V; ++b) &#123;                    std::vector&lt;int&gt; q;                    int h = 0, t = -1;                    for (int a = 0; a * V + b &lt;= m; ++a) &#123;                        for (; h &lt;= t &amp;&amp; a - q[h] &gt; C; ++h);                        if (h &lt;= t &amp;&amp; f[i][q[h] * V + b] != -inf)                            f[i + 1][a * V + b] = std::max(f[i + 1][a * V + b], f[i][q[h] * V + b] + (a - q[h]) * W);                        for (; h &lt;= t &amp;&amp; f[i][a * V + b] - a * W &gt;= f[i][q[t] * V + b] - q[t] * W; --t);                        q.resize(++t + 1), q[t] = a;                    &#125;                &#125;                int to = nex[tab[i + 1]];                for (int j = 0; j &lt;= m; ++j)                    f[to][j] = std::max(f[to][j], f[i][j]);            &#125;            res = std::max(res, *std::max_element(f[now].begin(), f[now].end()));            std::vector&lt;std::vector&lt;int&gt; &gt;().swap(f);            tag[x] = 1;            for (auto i : g[x])                if (!tag[i])                    DFS(i);            return;        &#125;;        DFS(1);        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="d---åŠ æ²¹ç«™">D - åŠ æ²¹ç«™</h2><p><a href="https://www.luogu.com.cn/problem/P10805" class="uri">https://www.luogu.com.cn/problem/P10805</a></p><p>ç‚¹åˆ†æ²»ååˆ†ä¸º <span class="math inline">\(u\to rt\)</span> å’Œ <span class="math inline">\(rt\to v\)</span> ä¸¤ä¸ªéƒ¨åˆ†è€ƒè™‘ã€‚å‰è€…åªéœ€è¦å€å¢æ‰¾åˆ°ç¬¬ä¸€æ¬¡åŠ æ²¹çš„ç‚¹å³å¯ï¼›åè€…éœ€è¦å¯¹äºæ¯ä¸ªç‚¹ä½œä¸ºåŠ æ²¹ç«™çš„æƒ…å†µï¼Œç»Ÿè®¡èµ·ç‚¹ä¸ªæ•°ã€‚</p><p>å…·ä½“åœ°ï¼Œéœ€è¦åˆ†ç±»è®¨è®ºï¼šè‹¥ <span class="math inline">\(d(rt,v)&lt;k\)</span>ï¼Œè¯´æ˜<strong>ä¸Šæ¬¡åŠ æ²¹ä¸€å®šä¸åœ¨å½“å‰å­æ ‘å†…</strong>ï¼›åœ¨æ ¹èŠ‚ç‚¹ä¸Šç™»è®°çš„åŠ æ²¹ç«™ä¸­ç»Ÿè®¡èµ°å¾—åˆ° <span class="math inline">\(fa_v\)</span> ä½†èµ°ä¸åˆ° <span class="math inline">\(v\)</span> çš„ï¼Œå°±å¯ä»¥æ‰¾åˆ° <span class="math inline">\(fa_v\)</span> ä½œä¸ºåŠ æ²¹ç«™å¯¹åº”çš„èµ·ç‚¹ä¸ªæ•°ã€‚å¯¹ <span class="math inline">\(d(rt,v)\ge k\)</span>ï¼Œåªéœ€è¦å€å¢æ‰¾åˆ°ä¸Šä¸€æ¬¡åŠ æ²¹çš„ç‚¹å³å¯æ‰¾åˆ° <span class="math inline">\(fa_v\)</span> çš„ç­”æ¡ˆã€‚</p><p>è¯´ç€å¾ˆè½»å·§ï¼Œå®ç°ç€å¾ˆæ¶å¿ƒã€‚æ‘†äº†ã€‚</p><hr /><h2 id="e---é¦–éƒ½">E - é¦–éƒ½</h2><p><a href="https://www.luogu.com.cn/problem/P7215" class="uri">https://www.luogu.com.cn/problem/P7215</a></p><p>å¯ç¤ºæˆ‘ä»¬ç‚¹åˆ†æ²»å¤„ç†çš„é—®é¢˜ä¸ä¸€æ˜¯ä¸ã€æ ‘ç»“æ„ã€å¼ºç›¸å…³è€…ï¼›ä¹Ÿå¯ä»¥ä»…åˆ©ç”¨ç‚¹åˆ†æ²»åˆ’åˆ†å‡ºæ¥çš„å—ï¼Œä¾‹å¦‚ã€è‹¥è¶…å‡ºå½“å‰å—ï¼Œåˆ™ä¸€å®šä¸ä¼˜ã€ä¹‹ç±»çš„ã€‚</p><p>æœ¬é¢˜çš„è¯¥æ€§è´¨é€šè¿‡åˆ†è®¨æ˜¯å¥½è¯çš„ï¼›æ‰€ä»¥ç›´æ¥æ¯ä¸ªå—å†…æš´åŠ›å³å¯ã€‚å¤æ‚åº¦ <span class="math inline">\(O(n\log n)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1), t(k + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; col(n + 1), mx(n + 1), siz(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; col[i];        t[col[i]].push_back(i);    &#125;    std::vector&lt;int&gt; tag(n + 1), p, tik(n + 1), faa(n + 1), vis(n + 1), book(k + 1);    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int fa) &#123;        siz[x] = 1, mx[x] = 0;        p.push_back(x), tik[x] = 1;        for (auto i : g[x])            if (!tag[i] &amp;&amp; i != fa) &#123;                DFS1(i, x);                siz[x] += siz[i];                mx[x] = std::max(mx[x], siz[i]);            &#125;        return;    &#125;;    auto findrt = [&amp;](int x) &#123;        p.clear(), DFS1(x, -1);        int n = (int)p.size();        for (auto i : p)            if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)                return i;        assert(0);        return -1;    &#125;;    std::function&lt;void(int)&gt; DFS2 = [&amp;](int x) &#123;        for (auto i : g[x])            if (!tag[i] &amp;&amp; i != faa[x])                faa[i] = x, DFS2(i);        return;    &#125;;    int res = 0x3f3f3f3f;    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        x = findrt(x);        faa[x] = -1, DFS2(x);        std::queue&lt;int&gt; q;        q.push(col[x]), book[col[x]] = 1;        int cnt = 0;        for (; !q.empty(); ) &#123;            int f = q.front();            q.pop();            for (auto i : t[f])                if (tik[i])                     for (int p = i; ~p &amp;&amp; !vis[p]; p = faa[p]) &#123;                        vis[p] = 1;                        if (!book[col[p]]) &#123;                            if (++cnt &gt;= res)                                goto outo;                            q.push(col[p]), book[col[p]] = 1;                        &#125;                    &#125;                else                    goto outo;        &#125;        res = cnt;        // printf(&quot;x = %d: cnt = %d\n&quot;, x, cnt);    outo:        for (auto i : p)            vis[i] = tik[i] = book[col[i]] = 0;        tag[x] = 1;        for (auto i : g[x])            if (!tag[i])                DFS(i);        return;    &#125;;    DFS(1);    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;        return 0;&#125;</code></pre></details><hr /><h2 id="f---å¼€åº—">F - å¼€åº—</h2><p><a href="https://www.luogu.com.cn/problem/P3241" class="uri">https://www.luogu.com.cn/problem/P3241</a></p><p>è½¬åŒ–é—®é¢˜ï¼ŒåŸé—®é¢˜å³æ±‚è§£æƒå€¼åœ¨ <span class="math inline">\([L,R]\)</span> é—´çš„å…ƒç´ åˆ° <span class="math inline">\(u\)</span> çš„è·ç¦»å’Œã€‚</p><p>ä¸€èˆ¬æ±‚è§£è·ç¦»çš„æ–¹æ³•æ˜¯æ‰¾åˆ° LCA åè®¡ç®—ï¼Œè€ƒè™‘å¦‚æœä¸åˆ©ç”¨æ ‘ä¸Š LCAï¼Œè€Œæ˜¯åˆ©ç”¨ç‚¹åˆ†æ ‘ä¸Š LCA å¦‚ä½•è®¡ç®—ã€‚åˆ†è®¨æ˜“è¯å¾—ç‚¹åˆ†æ ‘ä¸Š LCA ä¸€å®šåœ¨ä¸¤ç‚¹è·¯å¾„ä¸Šã€‚</p><p>å‚¨å­˜ç‚¹åˆ†æ ‘ä¸Šæ¯ä¸ªç‚¹åˆ°å…¶æ¯ä¸ªç¥–å…ˆçš„è·ç¦»ï¼Œå°±å¯ä»¥æ–¹ä¾¿åœ°è®¡ç®—ä»»æ„ä¸¤ç‚¹é—´è·ç¦»ã€‚æ¥ä¸‹æ¥å¤„ç†åŸé—®é¢˜çš„å¼±åŒ–ï¼šå¯¹äºæ¯ä¸ª <span class="math inline">\(u\)</span> æ±‚è§£å…¶åˆ°æ ‘ä¸Šæ‰€æœ‰ç‚¹è·ç¦»å’Œã€‚æ˜¾ç„¶è¿™æ˜¯ä¸€ä¸ªç±»ä¼¼æ¢æ ¹çš„é—®é¢˜ï¼Œéšä¾¿åšå³å¯ã€‚</p><p>ç°åœ¨éœ€è¦åœ¨çº¿åœ°è§£å†³åŸé—®é¢˜ã€‚<strong>å¯ä»¥ç”¨ vector å­˜å‚¨è¿™ä¸€å±‚æ‰€æœ‰ç‚¹çš„æƒå€¼ä¸æ·±åº¦ä¿¡æ¯ï¼ŒæŒ‰æƒå€¼æ’åºåäºŒåˆ†æŸ¥è¯¢</strong>ã€‚å¤æ‚åº¦ <span class="math inline">\(O(n\log^2 n)\)</span>ã€‚å®ç°çš„æ—¶å€™åº”è¯¥å¯ä»¥æ³¨æ„åˆ°åŸé¢˜é™åˆ¶ç‚¹åº¦æ•°å¯¹å¤æ‚åº¦çš„ä¿è¯ã€‚</p><details><p>æ‰“èµ·æ¥çš„æ—¶å€™æ„Ÿè§‰å¾ˆå²ï¼Œä½†å®é™…ä¸Šè°ƒå¾—æ¯”å¤§å¤šæ•°é¢˜å¿«ã€‚</p><p>å¤§æ¦‚æ‡‚å¾—ä¸ºä»€ä¹ˆç»å¸¸çœ‹å¤§ä½¬å†™æ¸¸è®°åšåˆ°å²é¢˜çš„å®ç°é¢„æœŸéƒ½æ˜¯ã€ä¸€éè¿‡ã€äº†ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;const int maxn = 1.5e5 + 5;std::vector&lt;std::pair&lt;int, int&gt; &gt; g[maxn];int top[maxn], siz[maxn], fa[maxn], son[maxn], dep[maxn], dis[maxn];void DFS1(int x) &#123;    siz[x] = 1;    for (auto [i, w] : g[x])        if (i != fa[x]) &#123;            fa[i] = x;            dep[i] = dep[x] + 1, dis[i] = dis[x] + w;            DFS1(i);            siz[x] += siz[i];            if (siz[i] &gt; siz[son[x]])                son[x] = i;        &#125;    return;&#125;void DFS2(int x) &#123;    if (son[x])        top[son[x]] = top[x], DFS2(son[x]);    for (auto [i, w] : g[x])        if (i != fa[x] &amp;&amp; i != son[x])            top[i] = i, DFS2(i);    return;&#125;int ask(int x, int y) &#123;    int sx = x, sy = y;    for (; top[x] != top[y]; x = fa[top[x]])        if (dep[top[x]] &lt; dep[top[y]])            std::swap(x, y);    x = dep[x] &lt; dep[y] ? x : y;    return dis[sx] + dis[sy] - 2 * dis[x];&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, q, A;    std::cin &gt;&gt; n &gt;&gt; q &gt;&gt; A;    std::vector&lt;int&gt; c(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; c[i];    for (int i = 1, x, y, w; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;        g[x].emplace_back(y, w), g[y].emplace_back(x, w);    &#125;    DFS1(1), DFS2(1);    std::vector&lt;int&gt; mx(n + 1), siz(n + 1), p, tag(n + 1);    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int fa) &#123;        siz[x] = 1, mx[x] = 0;        p.push_back(x);        for (auto [i, w] : g[x])            if (!tag[i] &amp;&amp; i != fa) &#123;                DFS1(i, x);                siz[x] += siz[i];                mx[x] = std::max(mx[x], siz[i]);            &#125;        return;    &#125;;    auto findrt = [&amp;](int x) &#123;        p.clear(), DFS1(x, -1);        int n = (int)p.size();        for (auto i : p)            if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)                return i;        assert(0);        return -1;    &#125;;    std::vector&lt;int&gt; dis(n + 1);    std::vector&lt;std::array&lt;std::vector&lt;std::pair&lt;int, long long&gt; &gt;, 3&gt; &gt; t(n + 1);    std::function&lt;void(int, int, std::vector&lt;std::pair&lt;int, long long&gt; &gt;&amp;)&gt; DFS2 = [&amp;](int x, int fa, std::vector&lt;std::pair&lt;int, long long&gt; &gt; &amp;t) &#123;        t.emplace_back(c[x], dis[x]);        for (auto [i, w] : g[x])            if (!tag[i] &amp;&amp; i != fa) &#123;                dis[i] = dis[x] + w;                DFS2(i, x, t);            &#125;        return;    &#125;;    std::vector&lt;std::pair&lt;int, int&gt; &gt; to(n + 1);    std::function&lt;std::pair&lt;int, int&gt; (int)&gt; DFS = [&amp;](int x) &#123;        x = findrt(x);        int ret = dis[x];        for (int j = 0; j &lt; (int)g[x].size(); ++j) &#123;            auto [i, w] = g[x][j];            if (!tag[i]) &#123;                dis[i] = w;                DFS2(i, x, t[x][j]);                std::sort(t[x][j].begin(), t[x][j].end());                // printf(&quot;[%d, %d]: %d(%lld)&quot;, x, j, t[x][j][0].first, t[x][j][0].second);                for (int k = 1; k &lt; (int)t[x][j].size(); ++k) &#123;                    t[x][j][k].second += t[x][j][k - 1].second;                    // printf(&quot; %d(%lld)&quot;, t[x][j][k].first, t[x][j][k].second);                &#125;                // puts(&quot;&quot;);            &#125;        &#125;        tag[x] = 1;        for (int j = 0; j &lt; (int)g[x].size(); ++j) &#123;            auto [i, w] = g[x][j];            if (!tag[i]) &#123;                auto [rt, d] = DFS(i);                to[rt] = &#123; x, j &#125;;            &#125;        &#125;        return std::make_pair(x, ret);    &#125;;    int rt = DFS(1).first;    std::vector&lt;std::vector&lt;int&gt; &gt; fd(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        int now = i;        for (;; now = to[now].first) &#123;            fd[i].push_back(ask(now, i));            if (now == rt)                break;        &#125;    &#125;    for (int u, a, b; q--; ) &#123;        static long long la = 0ll;        std::cin &gt;&gt; u &gt;&gt; a &gt;&gt; b;        int l = std::min((a + la) % A, (b + la) % A), r = std::max((a + la) % A, (b + la) % A);        // printf(&quot;ask %d, [%d, %d]\n&quot;, u, l, r);        auto ask = [&amp;](int x, int j) &#123;            auto res(0ll);            int cnt = 0, p = 0;            p = std::lower_bound(t[x][j].begin(), t[x][j].end(), std::make_pair(l, -1ll)) - t[x][j].begin();            cnt -= p;            if (p != 0)                res -= t[x][j][p - 1].second;            p = std::upper_bound(t[x][j].begin(), t[x][j].end(), std::make_pair(r, inf)) - t[x][j].begin();            cnt += p;            if (p != 0)                res += t[x][j][p - 1].second;            return std::make_pair(res, cnt);        &#125;;        la = ask(u, 0).first + ask(u, 1).first + ask(u, 2).first;        // int U = u;        for (auto d = ++fd[u].begin(); u != rt; ++d) &#123;            auto [fa, k] = to[u];            // fprintf(stderr, &quot;u = %d, fa = %d, d = %d\n&quot;, U, fa, *d);            for (int j = 0; j &lt; 3; ++j)                if (j != k) &#123;                    auto [len, cnt] = ask(fa, j);                    la += len + (long long)cnt * *d;                &#125;            if (c[fa] &gt;= l &amp;&amp; c[fa] &lt;= r)                la += *d;            u = fa;        &#125;        std::cout &lt;&lt; la &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> ç‚¹åˆ†æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è™šæ ‘</title>
      <link href="/20250603/"/>
      <url>/20250603/</url>
      
        <content type="html"><![CDATA[<p>å‡¡æ‰€æœ‰ç›¸ï¼Œçš†æ˜¯è™šå¦„â‘ ã€‚</p><p><em>æ³¨é‡Šï¼šâ‘ è™šå¦„ï¼šçŠ¹è¨€è™šæ ‘æ˜¯ç‹‚å¦„çš„ç®—æ³•ã€‚</em></p><span id="more"></span><hr /><h2 id="å®šä¹‰">å®šä¹‰</h2><p>ç»™å®šä¸€ä¸ªå¤§å°ä¸º <span class="math inline">\(n\)</span> çš„æ ‘å’Œæ ‘ä¸Š <span class="math inline">\(k\)</span> ä¸ªå…³é”®ç‚¹ã€‚å–å‡ºè¿™ <span class="math inline">\(k\)</span> ä¸ªå…³é”®ç‚¹å’Œå®ƒä»¬ä»»æ„ä¸¤ä¸ªé—´çš„ LCA ä½œä¸ºè™šæ ‘çš„ç‚¹é›†ï¼ŒæŒ‰ç…§åŸæ ‘ä¸Šçš„ç¥–å­™å…³ç³»è¿è¾¹å¾—åˆ°è™šæ ‘ã€‚</p><p><img src="1.png" /></p><hr /><h2 id="æ±‚è™šæ ‘">æ±‚è™šæ ‘</h2><p>æŒ‰ç…§ DFN æ’åºï¼Œè·å–ä»»æ„ç›¸é‚»ä¸¤ç‚¹ LCAï¼Œå³å¯ç”Ÿæˆè™šæ ‘ç‚¹é›†ã€‚å°†ç‚¹é›†æŒ‰ DFN æ’åºåè¿è¾¹ï¼Œå¤æ‚åº¦ä¸º <span class="math inline">\(O(k\log k)\)</span>ã€‚</p><p>è‡³å°‘ä¸¤ä¸ªå®ç‚¹å¯¹åº”ä¸€ä¸ªè™šç‚¹ï¼Œæ•…è€Œè™šæ ‘å¤§å°ä¸º <span class="math inline">\(O(k)\)</span>ã€‚</p><hr /><h2 id="ç”¨é€”">ç”¨é€”</h2><p>æ³¨æ„åˆ°æ— è®ºæ˜¯æ„å»ºè¿˜æ˜¯éå†è™šæ ‘å¤æ‚åº¦éƒ½ä¸ <span class="math inline">\(n\)</span> æ— å…³ã€‚å› è€Œé€‚ç”¨äºå¯¹ <span class="math inline">\(\sum k\)</span> æœ‰é™åˆ¶çš„é¢˜ç›®ã€‚</p><hr /><h3 id="b---leaf-color">B - Leaf Color</h3><p><a href="https://atcoder.jp/contests/abc340/tasks/abc340_g" class="uri">https://atcoder.jp/contests/abc340/tasks/abc340_g</a></p><p>æšä¸¾æ‰€æœ‰é¢œè‰²ï¼Œæ¯æ¬¡å¯¹è¯¥é¢œè‰²å¯¹åº”çš„æ‰€æœ‰ç‚¹å»ºç«‹è™šæ ‘ï¼Œå‘ç°ä¸èƒ½é€‰è™šæ ‘å¤–çš„å…¶ä»–ç‚¹ï¼Œè™šæ ‘ä¸Š DP å³å¯ã€‚</p><p>æ³¨æ„æ ¹æœ‰å¯èƒ½æ˜¯å¶å­ã€‚éœ€è¦ç‰¹åˆ¤ä¸€ä¸‹ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1), t(n + 1), g(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i], t[a[i]].push_back(i);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g1[x].push_back(y), g1[y].push_back(x);    &#125;    std::vector&lt;int&gt; siz(n + 1), son(n + 1), dep(n + 1), fa(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int faa) &#123;        siz[x] = 1;        for (auto i : g1[x])            if (i != faa) &#123;                dep[i] = dep[x] + 1;                fa[i] = x;                DFS(i, x);                if (siz[i] &gt; siz[son[x]])                    son[x] = i;            &#125;        return;    &#125;;    DFS(1, -1);    std::vector&lt;int&gt; dfn(n + 1), rfn(n + 1), top(n + 1);    DFS = [&amp;](int x, int fa) &#123;        static int now = 0;        dfn[x] = ++now;        if (son[x])            top[son[x]] = top[x], DFS(son[x], x);        for (auto i : g1[x])            if (i != fa &amp;&amp; i != son[x])                top[i] = i, DFS(i, x);        rfn[x] = now;        return;    &#125;;    top[1] = 1, DFS(1, -1);    auto getLCA = [&amp;](int x, int y) &#123;        for (; top[x] != top[y]; x = fa[top[x]])            if (dep[top[x]] &lt; dep[top[y]])                std::swap(x, y);        return dep[x] &lt; dep[y] ? x : y;    &#125;;    std::vector&lt;int&gt; tag(n + 1);    std::vector&lt;long long&gt; f(n + 1);    auto res(0ll);    for (int k = 1; k &lt;= n; ++k)        if (!t[k].empty()) &#123;            std::sort(t[k].begin(), t[k].end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);            std::vector&lt;int&gt; p;            for (auto i : t[k])                tag[i] = 1, p.push_back(i);            for (int i = 1; i &lt; (int)t[k].size(); ++i) &#123;                int fa = getLCA(t[k][i - 1], t[k][i]);                if (!tag[fa])                    tag[fa] = 1, p.push_back(fa);            &#125;            std::sort(p.begin(), p.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);            std::vector&lt;int&gt; tmp;            for (auto i : p) &#123;                if (!tmp.empty()) &#123;                    for (; rfn[tmp.back()] &lt; dfn[i]; tmp.pop_back());                    g[tmp.back()].push_back(i);                &#125;                tmp.push_back(i);            &#125;            std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;                f[x] = 1ll;                auto s(1ll);                for (auto i : g[x]) &#123;                    DFS(i), (s += f[i]) %= mod;                    (f[x] *= f[i] + 1) %= mod;                &#125;                if (a[x] != k)                    (f[x] += mod - s) %= mod;                // printf(&quot;color = %d, res += f[%d](%lld)\n&quot;, k, x, f[x]);                (res += f[x]) %= mod;                if (a[x] != k)                    --s, (f[x] += s) %= mod;                return;            &#125;;            DFS(p.front());            for (auto i : p) &#123;                tag[i] = 0, f[i] = 0ll;                std::vector&lt;int&gt;().swap(g[i]);            &#125;        &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="c---watching-cowflix-p">C - Watching Cowflix P</h3><p><a href="https://www.luogu.com.cn/problem/P9132" class="uri">https://www.luogu.com.cn/problem/P9132</a></p><p>ä¼šæƒ³åˆ°é’¦å®š <span class="math inline">\(k\)</span> å†æ¥åšã€‚å‘ç°ä»»æ„æƒ…å†µä¸‹éƒ½æœ‰ï¼šå‡å¦‚ä¸¤ä¸ªè¿é€šå—è·ç¦» <span class="math inline">\(\le k\)</span>ï¼Œé‚£ä¹ˆåˆå¹¶èµ·æ¥ä¸åŠ£ã€‚æ‰€ä»¥æŠŠè·ç¦» <span class="math inline">\(\le k\)</span> çš„æ‰€æœ‰ç‚¹éƒ½åˆå¹¶èµ·æ¥å‘ç°åªå‰©ä¸‹ <span class="math inline">\(O(\frac nk)\)</span> ä¸ªç‚¹äº†ï¼Œæƒ³åˆ°ç”¨è™šæ ‘ã€‚</p><p>ç„¶åè™šæ ‘ä¸Šæšä¸¾ç‚¹é€‰ä¸é€‰ï¼ŒDP ä¸€ä¸‹å°±å®Œäº†ã€‚</p><p>ä½†æ˜¯å®ç°èµ·æ¥å¥½å²å•Šã€‚åˆå¹¶éœ€è¦ç”¨å¹¶æŸ¥é›†ç»´æŠ¤çˆ¶äº²ï¼ˆè€Œéæœ¬èº«ï¼‰ï¼Œç‰¹åˆ«æ‰“è„‘å£³ã€‚</p><details><p>æˆ‘çš„å¤©å“ªæ»”å¤©å·¨å²ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, rt;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; p, tag(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        char t;        std::cin &gt;&gt; t;        if (t == &#39;1&#39;)            p.push_back(i), tag[i] = 1;    &#125;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1), g1(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g1[x].push_back(y), g1[y].push_back(x);    &#125;    std::set&lt;int&gt; st;    std::vector&lt;int&gt; to(n + 1), len(n + 1), cnt(n + 1), dfn(n + 1);    &#123;        std::vector&lt;int&gt; siz(n + 1), son(n + 1), fa(n + 1), dep(n + 1);        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int faa) &#123;            siz[x] = 1;            for (auto i : g1[x])                if (i != faa) &#123;                    dep[i] = dep[x] + 1;                    fa[i] = x, DFS(i, x);                    siz[x] += siz[i];                    if (siz[i] &gt; siz[son[x]])                        son[x] = i;                &#125;            return;        &#125;;        DFS(1, -1);        std::vector&lt;int&gt; rfn(n + 1), top(n + 1);        DFS = [&amp;](int x, int fa) &#123;            static int now = 0;            dfn[x] = ++now;            if (son[x])                top[son[x]] = top[x], DFS(son[x], x);            for (auto i : g1[x])                if (i != son[x] &amp;&amp; i != fa)                    top[i] = i, DFS(i, x);            rfn[x] = now;            return;        &#125;;        DFS(1, -1);        auto getLCA = [&amp;](int x, int y) &#123;            for (; top[x] != top[y]; x = fa[top[x]])                if (dep[top[x]] &lt; dep[top[y]])                    std::swap(x, y);            return dep[x] &lt; dep[y] ? x : y;        &#125;;        std::sort(p.begin(), p.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);        std::vector&lt;int&gt; vis(tag), t(p);        for (int i = 1; i &lt; (int)p.size(); ++i) &#123;            int fa = getLCA(p[i - 1], p[i]);            if (!vis[fa])                vis[fa] = 1, t.push_back(fa);        &#125;        std::sort(t.begin(), t.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);        rt = t.front();        std::vector&lt;int&gt; stk;        for (auto i : t) &#123;            if (!stk.empty()) &#123;                for (; rfn[stk.back()] &lt; dfn[i]; stk.pop_back());                to[i] = stk.back(), len[i] = dep[i] - dep[to[i]] - 1;            &#125;            st.insert(i), stk.push_back(i);        &#125;    &#125;    std::vector&lt;int&gt; fa(n + 1), siz(n + 1, 1);    std::iota(fa.begin() + 1, fa.end(), 1);    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;        return x == fa[x] ? x : fa[x] = find(fa[x]);    &#125;;    std::vector&lt;std::array&lt;int, 2&gt; &gt; f(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int k) &#123;        if (tag[x])            f[x][0] = inf;        f[x][1] = siz[x] + k;        for (auto i : g[x]) &#123;            DFS(i, k);            if (!tag[x])                f[x][0] += std::min(f[i][0], f[i][1]);            f[x][1] += std::min(&#123; f[i][0], f[i][1], f[i][1] + len[i] - k &#125;);        &#125;        return;    &#125;;    std::function&lt;void(int, int, int)&gt; DFS1 = [&amp;](int x, bool flag, int k) &#123;        for (auto i : g[x])            if (flag) &#123;                if (f[i][0] &lt;= std::min(f[i][1], f[i][1] + len[i] - k))                    DFS1(i, 0, k);                else &#123;                    DFS1(i, 1, k);                    if (f[i][1] + len[i] - k &lt; f[i][1]) &#123;                        tag[x] |= tag[i];                        siz[x] += siz[i] + len[i];                        st.erase(i), fa[i] = x;                    &#125;                &#125;            &#125;            else &#123;                if (f[i][0] &lt;= f[i][1])                    DFS1(i, 0, k);                else                    DFS1(i, 1, k);            &#125;        return;    &#125;;    for (int k = 1; k &lt;= n; ++k) &#123;        std::vector&lt;int&gt; p;        for (auto i : st) &#123;            p.push_back(i);            if (to[i])                g[find(to[i])].push_back(i);        &#125;        DFS(rt, k);        std::cout &lt;&lt; std::min(f[rt][0], f[rt][1]) &lt;&lt; &#39;\n&#39;;        DFS1(rt, f[rt][1] &lt;= f[rt][0], k);        for (auto i : st)            f[i][0] = f[i][1] = 0, std::vector&lt;int&gt;().swap(g[i]);    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="d---smuggling-marbles">D - Smuggling Marbles</h3><p><a href="https://atcoder.jp/contests/arc086/tasks/arc086_c" class="uri">https://atcoder.jp/contests/arc086/tasks/arc086_c</a></p><p>å®¹æ˜“æƒ³åˆ°ä»è´¡çŒ®è§’åº¦æ€è€ƒé—®é¢˜ï¼›é‚£ä¹ˆæ¯ä¸ªç‚¹åªä¸åŒæ·±åº¦çš„æ‰€æœ‰ç‚¹å­˜åœ¨ç«äº‰å…³ç³»ã€‚</p><p>æŠŠæ¯ä¸ªæ·±åº¦çš„ç‚¹æ‹¿å‡ºæ¥å»ºè™šæ ‘ï¼Œåœ¨è™šæ ‘ä¸Šè·‘ DP å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m = 0;    std::cin &gt;&gt; n, ++n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1), g1(n + 1);    for (int i = 2, x; i &lt;= n; ++i)        std::cin &gt;&gt; x, g1[x + 1].push_back(i);    std::vector&lt;int&gt; top(n + 1), dep(n + 1), dfn(n + 1), rfn(n + 1), fa(n + 1);    &#123;        std::vector&lt;int&gt; siz(n + 1), son(n + 1);        std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;            siz[x] = 1;            m = std::max(m, dep[x]);            for (auto i : g1[x]) &#123;                dep[i] = dep[x] + 1;                fa[i] = x, DFS(i);                siz[x] += siz[i];                if (siz[i] &gt; siz[son[x]])                    son[x] = i;            &#125;            return;        &#125;;        dep[1] = 1, DFS(1);        DFS = [&amp;](int x) &#123;            static int now = 0;            dfn[x] = ++now;            if (son[x])                top[son[x]] = top[x], DFS(son[x]);            for (auto i : g1[x])                if (i != son[x])                    top[i] = i, DFS(i);            rfn[x] = now;            return;        &#125;;        top[1] = 1, DFS(1);    &#125;    auto getLCA = [&amp;](int x, int y) &#123;        for (; top[x] != top[y]; x = fa[top[x]])            if (dep[top[x]] &lt; dep[top[y]])                std::swap(x, y);        return dep[x] &lt; dep[y] ? x : y;    &#125;;    std::vector&lt;std::vector&lt;int&gt; &gt; _p(m + 1);    for (int i = 1; i &lt;= n; ++i)        _p[dep[i]].push_back(i);    std::vector&lt;int&gt; tag(n + 1), flag(n + 1);    std::vector&lt;std::array&lt;long long, 2&gt; &gt; f(n + 1);    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        f[x][0] = 1ll + flag[x], f[x][1] = flag[x];        auto s(1ll);        for (auto i : g[x]) &#123;            DFS(i);            f[x][1] = (f[x][1] * f[i][0] + s * f[i][1]) % mod;            (f[x][0] *= f[i][0] + f[i][1]) %= mod;            (s *= f[i][0]) %= mod;        &#125;        (f[x][0] += mod - f[x][1]) %= mod;        // printf(&quot;f[%d][0] = %lld, f[%d][1] = %lld\n&quot;, x, f[x][0], x, f[x][1]);        return;    &#125;;    auto qkp = [&amp;](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    auto res(0ll);    for (int k = 1; k &lt;= m; ++k) &#123;        auto &amp;p = _p[k], t(p);        for (auto i : p)            flag[i] = 1;        std::sort(p.begin(), p.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);        for (int i = 1; i &lt; (int)p.size(); ++i) &#123;            int fa = getLCA(p[i - 1], p[i]);            if (!tag[fa])                tag[fa] = 1, t.push_back(fa);        &#125;        std::sort(t.begin(), t.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);        int rt = t.front();        std::vector&lt;int&gt; st;        for (auto i : t) &#123;            if (!st.empty()) &#123;                for (; rfn[st.back()] &lt; dfn[i]; st.pop_back());                g[st.back()].push_back(i);            &#125;            st.push_back(i);        &#125;        DFS(rt);        (res += f[rt][1] * qkp(2ll, n - (int)p.size())) %= mod;        // std::cout &lt;&lt; f[rt][1] * qkp(2ll, n - (int)p.size()) % mod &lt;&lt; &#39;\n&#39;;        for (auto i : t) &#123;            tag[i] = flag[i] = 0;            std::vector&lt;int&gt;().swap(g[i]);        &#125;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="e---ä¸–ç•Œæ ‘">E - ä¸–ç•Œæ ‘</h3><p><a href="https://www.luogu.com.cn/problem/P3233" class="uri">https://www.luogu.com.cn/problem/P3233</a></p><p>ä¼šæƒ³åˆ°åœ¨è™šæ ‘ä¸Šä¸¤æ¬¡ DFS æ‰¾åˆ°ç¦»ä»»æ„ç‚¹æœ€è¿‘çš„å®ç‚¹ã€‚å…·ä½“åœ°ï¼Œç¬¬ä¸€æ¬¡æ‰¾ä¸‹æ–¹ï¼Œç¬¬äºŒæ¬¡å°è¯•ç”¨ä¸Šæ–¹æ›´æ–°ã€‚</p><p>æ¥ç€å‘ç°å¯¹äºè™šæ ‘ä¸Šçš„å®ç‚¹æ˜¯å¥½åšçš„ï¼›å¯¹äºå®ç‚¹çš„ä¸åœ¨æ ‘ä¸Šçš„å„¿å­æ˜¯å¥½åšçš„ï¼›æ¥ä¸‹æ¥æ˜¯è™šç‚¹åŠå…¶ä¸åœ¨æ ‘ä¸Šçš„å„¿å­ã€‚</p><p>å°±è¦ç”¨åˆ°åˆšåˆšæ±‚çš„ä¿¡æ¯äº†ã€‚æ˜¾ç„¶äºŒåˆ†ä¸€ä¸‹å°±å¯ä»¥äº†ã€‚è¯´èµ·æ¥å¾ˆç®€å•ï¼Œç„¶è€Œå®é™…ä¸Šå†™èµ·æ¥å¾ˆè‹¦æ¼ <img src="/em/ll.gif" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, q;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1), g1(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g1[x].push_back(y), g1[y].push_back(x);    &#125;    std::vector&lt;std::array&lt;int, 21&gt; &gt; fa(n + 1);    std::vector&lt;int&gt; siz(n + 1), top(n + 1), dep(n + 1), dfn(n + 1), rfn(n + 1);    &#123;        std::vector&lt;int&gt; son(n + 1);        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int faa) &#123;            siz[x] = 1;            for (auto i : g1[x])                if (i != faa) &#123;                    dep[i] = dep[x] + 1;                    fa[i][0] = x;                    for (int j = 1; j &lt;= 20; ++j)                        fa[i][j] = fa[fa[i][j - 1]][j - 1];                    DFS(i, x);                    siz[x] += siz[i];                    if (siz[i] &gt; siz[son[x]])                        son[x] = i;                &#125;            return;        &#125;;        DFS(1, -1);        int now = 0;        DFS = [&amp;](int x, int fa) &#123;            dfn[x] = ++now;            if (son[x])                top[son[x]] = top[x], DFS(son[x], x);            for (auto i : g1[x])                if (i != fa &amp;&amp; i != son[x])                    top[i] = i, DFS(i, x);            rfn[x] = now;            return;        &#125;;        top[1] = 1, DFS(1, -1);    &#125;    auto getLCA = [&amp;](int x, int y) &#123;        for (; top[x] != top[y]; x = fa[top[x]][0])            if (dep[top[x]] &lt; dep[top[y]])                std::swap(x, y);        return dep[x] &lt; dep[y] ? x : y;    &#125;;    auto getfa = [&amp;](int x, int p) &#123;        for (int i = 20; ~i; --i)            if (p &gt;= (1 &lt;&lt; i))                x = fa[x][i], p -= (1 &lt;&lt; i);        return x;    &#125;;    std::vector&lt;int&gt; to(n + 1);    std::vector&lt;int&gt; tag(n + 1), flag(n + 1), res(n + 1);    std::cin &gt;&gt; q;    auto dis = [&amp;](int x, int y) &#123;        return std::make_pair(dep[x] + dep[y] - 2 * dep[getLCA(x, y)], y);    &#125;;    std::function&lt;void(int)&gt; DFS1 = [&amp;](int x) &#123;        to[x] = (flag[x] ? x : -1);        for (auto i : g[x]) &#123;            DFS1(i);            if (~to[i] &amp;&amp; (to[x] == -1 || dis(x, to[i]) &lt; dis(x, to[x])))                to[x] = to[i];        &#125;        // printf(&quot;to[%d] = %d\n&quot;, x, to[x]);        return;    &#125;, DFS2 = [&amp;](int x) &#123;        // printf(&quot;to[%d] = %d\n&quot;, x, to[x]);        for (auto i : g[x]) &#123;            if (to[i] == -1 || dis(i, to[x]) &lt; dis(i, to[i]))                to[i] = to[x];            DFS2(i);        &#125;        return;    &#125;, DFS3 = [&amp;](int x) &#123;        res[to[x]] += siz[x];        for (auto i : g[x]) &#123;            res[to[x]] -= siz[getfa(i, dep[i] - dep[x] - 1)];            DFS3(i);        &#125;        // printf(&quot;res[%d] = %d\n&quot;, x, res[x]);        return;    &#125;, DFS4 = [&amp;](int x) &#123;        for (auto i : g[x]) &#123;            if (to[x] == to[i])                res[to[x]] += siz[getfa(i, dep[i] - dep[x] - 1)] - siz[i];            else &#123;                auto dx(dis(x, to[x])), di(dis(i, to[i]));                int at = -1, len = dep[i] - dep[x] - 1;                for (int l = 0, r = len, mid; l &lt;= r; ) &#123;                    mid = (l + r) &gt;&gt; 1;                    if ([&amp;](auto dx, auto dy) &#123;                        dx.first += mid, dy.first += len - mid + 1;                        return dx &lt; dy;                    &#125; (dx, di))                        at = mid, l = mid + 1;                    else                        r = mid - 1;                &#125;                int fa = getfa(i, len - at);                res[to[x]] += siz[getfa(i, len)] - siz[fa];                res[to[i]] += siz[fa] - siz[i];            &#125;            DFS4(i);        &#125;        return;    &#125;;    for (int k; q--; ) &#123;        std::cin &gt;&gt; k;        std::vector&lt;int&gt; p(k);        for (int i = 0; i &lt; k; ++i)            std::cin &gt;&gt; p[i], tag[p[i]] = flag[p[i]] = 1;        auto org(p);        std::sort(p.begin(), p.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);        std::vector&lt;int&gt; t(p);        for (int i = 1; i &lt; (int)p.size(); ++i) &#123;            int fa = getLCA(p[i - 1], p[i]);            if (!tag[fa])                tag[fa] = 1, t.push_back(fa);        &#125;        if (!tag[1])            t.push_back(1), tag[1] = 1;        std::sort(t.begin(), t.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);        std::vector&lt;int&gt; st;        for (auto i : t) &#123;            if (!st.empty()) &#123;                for (; rfn[st.back()] &lt; dfn[i]; st.pop_back());                g[st.back()].push_back(i);            &#125;            st.push_back(i);        &#125;        DFS1(1), DFS2(1), DFS3(1), DFS4(1);        for (auto i : org)            std::cout &lt;&lt; res[i] &lt;&lt; &#39; &#39;;        std::cout &lt;&lt; &#39;\n&#39;;        for (auto i : t) &#123;            res[i] = 0;            tag[i] = flag[i] = 0;            std::vector&lt;int&gt;().swap(g[i]);        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="f---å¤§å·¥ç¨‹">F - å¤§å·¥ç¨‹</h3><p><a href="https://www.luogu.com.cn/problem/P4103" class="uri">https://www.luogu.com.cn/problem/P4103</a></p><p>è™šæ ‘ä¸Š DP ç»Ÿè®¡ç›¸å…³ä¿¡æ¯å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, q;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1), g1(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g1[x].push_back(y), g1[y].push_back(x);    &#125;    std::vector&lt;int&gt; top(n + 1), dep(n + 1), dfn(n + 1), rfn(n + 1), fa(n + 1);    &#123;        std::vector&lt;int&gt; siz(n + 1), son(n + 1);        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int faa) &#123;            siz[x] = 1;            for (auto i : g1[x])                if (i != faa) &#123;                    dep[i] = dep[x] + 1;                    fa[i] = x, DFS(i, x);                    siz[x] += siz[i];                    if (siz[i] &gt; siz[son[x]])                        son[x] = i;                &#125;            return;        &#125;;        DFS(1, -1);        int now = 0;        DFS = [&amp;](int x, int fa) &#123;            dfn[x] = ++now;            if (son[x])                top[son[x]] = top[x], DFS(son[x], x);            for (auto i : g1[x])                if (i != fa &amp;&amp; i != son[x])                    top[i] = i, DFS(i, x);            rfn[x] = now;            return;        &#125;;        top[1] = 1, DFS(1, -1);    &#125;    auto getLCA = [&amp;](int x, int y) &#123;        for (; top[x] != top[y]; x = fa[top[x]])            if (dep[top[x]] &lt; dep[top[y]])                std::swap(x, y);        return dep[x] &lt; dep[y] ? x : y;    &#125;;    std::vector&lt;long long&gt; s(n + 1);    std::vector&lt;int&gt; mx(n + 1), mn(n + 1);    std::vector&lt;int&gt; tag(n + 1), siz(n + 1), flag(n + 1);    int rmx, rmn;    long long rs;    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        if (flag[x]) &#123;            siz[x] = 1;            mx[x] = mn[x] = s[x] = 0;        &#125;        else &#123;            siz[x] = s[x] = 0;            mn[x] = inf, mx[x] = -inf;        &#125;        for (auto i : g[x]) &#123;            DFS(i);            int len = dep[i] - dep[x];            rmx = std::max(rmx, mx[x] + mx[i] + len);            mx[x] = std::max(mx[x], mx[i] + len);            rmn = std::min(rmn, mn[x] + mn[i] + len);            mn[x] = std::min(mn[x], mn[i] + len);            rs += siz[x] * (s[i] + (long long)siz[i] * len) + siz[i] * s[x];             s[x] += s[i] + (long long)siz[i] * len;            siz[x] += siz[i];            // printf(&quot;%d -&gt; %d, mx = %d, mn = %d, s = %lld\n&quot;, x, i, rmx, rmn, rs);        &#125;        return;    &#125;;    std::cin &gt;&gt; q;    for (int k; q--; ) &#123;        std::cin &gt;&gt; k;        std::vector&lt;int&gt; p(k);        for (int i = 0; i &lt; k; ++i)            std::cin &gt;&gt; p[i], tag[p[i]] = flag[p[i]] = 1;        std::sort(p.begin(), p.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);        std::vector&lt;int&gt; t(p);        for (int i = 1; i &lt; (int)p.size(); ++i) &#123;            int fa = getLCA(p[i - 1], p[i]);            if (!tag[fa])                tag[fa] = 1, t.push_back(fa);        &#125;        std::sort(t.begin(), t.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);        int rt = t.front();        std::vector&lt;int&gt; st;        for (auto i : t) &#123;            if (!st.empty()) &#123;                for (; rfn[st.back()] &lt; dfn[i]; st.pop_back());                g[st.back()].push_back(i);            &#125;            st.push_back(i);        &#125;        rs = 0ll, rmx = -inf, rmn = inf;        DFS(rt);        std::cout &lt;&lt; rs &lt;&lt; &#39; &#39; &lt;&lt; rmn &lt;&lt; &#39; &#39; &lt;&lt; rmx &lt;&lt; &#39;\n&#39;;        for (auto i : t) &#123;            tag[i] = flag[i] = 0;            std::vector&lt;int&gt;().swap(g[i]);        &#125;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> è™šæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é—²ï¼Œæ•…å£å—¨ç‚¹ DS é¢˜</title>
      <link href="/20250529/"/>
      <url>/20250529/</url>
      
        <content type="html"><![CDATA[<p>Thatâ€™s to say æ²¡å†™ä»£ç ã€‚</p><p>DP è¿˜æ˜¯å¤ªæ¶ˆè€—æˆ‘æœ¬å°±ä¸å¯Œè£•çš„è„‘ç¥ç»å…ƒäº†ã€‚è¿˜æ˜¯ DSï¼ˆæ­¤å¤„ç‰¹æŒ‡çº¿æ®µæ ‘é¢˜ï¼‰æ›´å‹å¥½ /tyt</p><span id="more"></span><hr /><p>é¢˜ç›®æ¥æºï¼šåœ¨æ´›è°·æ–‡ç« å¹¿åœºé‡Œä¹±è–…é¢˜è§£ï¼Œçœ‹çœ‹æ˜¯é“ DS å°±åšã€‚æ´›è°·è¿™æ‹›å¤ªç‹ äº†ã€‚</p><hr /><h2 id="p12389-compounds">P12389 COmPoUNdS</h2><p><a href="https://www.luogu.com.cn/problem/P12389" class="uri">https://www.luogu.com.cn/problem/P12389</a></p><blockquote><p>ç»™å®šå¸¸æ•°æ¨¡æ•°ï¼Œç»´æŠ¤æ¨¡æ„ä¹‰ä¸‹çš„åŒºé—´åŠ ã€åŒºé—´å“ˆå¸Œã€‚<span class="math inline">\(n\le 10^6\)</span>ã€‚</p></blockquote><p>å‘ç°çº¿æ®µæ ‘å“ˆå¸Œæ²¡åŠæ³•ç»´æŠ¤å–æ¨¡æ“ä½œï¼Œå¤ªéš¾å—äº†ã€‚</p><p>ä½†<mark>æŠŠå·®åˆ†å€¼ä¹Ÿå–æ¨¡</mark>å®¹æ˜“å‘ç°æ˜¯å¯¹çš„ã€‚å¤ªå¥½äº†ã€‚<mark>è€Œä¸”å°æ€§è´¨ï¼šæ­¤å¤„å–æ¨¡åçš„å·®åˆ†æ•°ç»„æ¨¡æ„ä¹‰ä¸‹å‰ç¼€å’Œä»ç„¶æ˜¯åŸæ•°ç»„</mark>ã€‚</p><p><em>bbï¼šä¼¼ä¹ä¹Ÿæœ‰æŠŠå·®åˆ†å€¼å– abs çš„åšæ³•ï¼Œå®¹æ˜“å‘ç°ä¹Ÿæ˜¯å¯¹çš„ã€‚</em></p><hr /><h2 id="p12598-å‚æ•°è¦å‰ç¥¥">P12598 å‚æ•°è¦å‰ç¥¥</h2><p><a href="https://www.luogu.com.cn/problem/P12598" class="uri">https://www.luogu.com.cn/problem/P12598</a></p><blockquote><p>ç»™å®š <span class="math inline">\(\{a\}\)</span> å’Œ <span class="math inline">\(q\)</span> ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡é—® <span class="math inline">\([l,r]\)</span> ä¸­ <span class="math inline">\(c(x)\times a_x\)</span> çš„æœ€å¤§å€¼ã€‚å…¶ä¸­ <span class="math inline">\(c(x)\)</span> ä¸ºã€å‡ºç°æ¬¡æ•°ä¸º <span class="math inline">\(x\)</span> çš„æ•°ã€çš„ç§ç±»ã€‚</p></blockquote><p>å¤ªå¥½äº†ç›´æ¥ä¸Šè«é˜Ÿã€‚æ¯æ¬¡æ›´æ–°ä¸€ä¸ªæ•°çš„ <span class="math inline">\(cnt\)</span> æ—¶ï¼Œå¦‚æœæ²¡å‡ºç°è¿‡å°±åŠ å…¥é˜Ÿåˆ—ã€‚æœ€åæŸ¥è¯¢çš„æ—¶å€™æŠŠé˜Ÿåˆ—è¿‡ä¸€éï¼Œä¸¢æ‰éæœ€æ–°ç‰ˆæœ¬çš„æ•°æ®ã€‚æ˜¾ç„¶é˜Ÿåˆ—é•¿åº¦å’Œç§»åŠ¨æ¬¡æ•°æ˜¯ä¸€æ ·çš„ã€‚å”‰<mark>è«é˜Ÿç»“åˆé˜Ÿåˆ—</mark>æ„Ÿè§‰è¿˜æ˜¯æœ‰ç‚¹å¸¸ç”¨çš„ã€‚</p><p>æœ€åéœ€è¦è¿‡ä¸€éæ•´ä¸ªé˜Ÿåˆ—ã€‚å¯¹äºé•¿åº¦ä¸º <span class="math inline">\(len\)</span> çš„åŒºé—´ï¼Œä½ ä¼šå‘ç° <span class="math inline">\(\ge \sqrt{len}\)</span> çš„ <span class="math inline">\(cnt\)</span> å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ <span class="math inline">\(\sqrt {len}\)</span>ï¼›<span class="math inline">\(\le \sqrt{len}\)</span> çš„ <span class="math inline">\(cnt\)</span> å‡ºç°æ¬¡æ•°æ›´ä¸è¶…è¿‡ <span class="math inline">\(len\)</span>ã€‚æ‰€ä»¥è¿‡ä¸€éé˜Ÿåˆ—å°±æ˜¯ <span class="math inline">\(O(\sqrt {len})\)</span> çš„ã€‚</p><hr /><h2 id="p3793-ç”±ä¹ƒæ•‘çˆ·çˆ·">P3793 ç”±ä¹ƒæ•‘çˆ·çˆ·</h2><p><a href="https://www.luogu.com.cn/problem/P3793" class="uri">https://www.luogu.com.cn/problem/P3793</a></p><blockquote><p>å°½å¯èƒ½å¿«åœ°ç»´æŠ¤éšæœºåºåˆ—åŒºé—´æœ€å€¼ã€‚</p></blockquote><p>æˆ‘ä»¬çŸ¥é“éšæœºåºåˆ—ç¬›å¡å°”æ ‘æœŸæœ›æ·±åº¦æ˜¯ <span class="math inline">\(\log\)</span>ã€‚å‘ç°æ•°æ®å¤ªè¿‡éšæœºä»¥è‡³äºå¯ä»¥è¿‡ã€‚</p><p>æ¥è‡ª <a href="https://www.luogu.com/article/hj9ci08q">UnyieldingTrilobite çš„æ–‡ç« </a>ï¼šåŒæ ·å¯ä»¥ç”¨æ‚¬çº¿ï¼<a href="/20231117/#éšæœºåºåˆ—æ‚¬çº¿ç»“åˆåˆ†å—">æ‚¬çº¿ + åˆ†å—</a> å°±å¯ä»¥åšäº†ã€‚</p><hr /><h2 id="p4635-shoi2011-æ”¹è¿›ä»£ç ">P4635 [SHOI2011] æ”¹è¿›ä»£ç </h2><p><a href="https://www.luogu.com.cn/problem/P4635" class="uri">https://www.luogu.com.cn/problem/P4635</a></p><blockquote><p>ç»™å®šåºåˆ— <span class="math inline">\(a_{1\sim n}\)</span> å’Œå¸¸æ•° <span class="math inline">\(p\)</span>ï¼Œç»´æŠ¤:</p><ul><li>ä¿®æ”¹ï¼šæ¨¡ <span class="math inline">\(p\)</span> æ„ä¹‰ä¸‹åŒºé—´åŠ ï¼›</li><li>è¯¢é—®ï¼šåŒºé—´ä¸­ <span class="math inline">\(\sum\limits_{i=l}^{r-1}[a_i&gt;a_{i+1}]\)</span>ã€‚</li></ul><p><span class="math inline">\(n\le 10^5,p\le 10^6\)</span>ã€‚</p></blockquote><p>æ€ä¹ˆåˆæ˜¯æ¨¡æ„ä¹‰åŒºé—´åŠ ï¼Ÿ</p><p>å‘ç°ç¬¬äºŒä¸ªä¹Ÿå’Œå·®åˆ†æœ‰å…³ç³»ï¼›<mark>éœ€è¦æ³¨æ„åˆ°æ­¤æ—¶å·®åˆ†æ•°ç»„æ˜¯éè´Ÿçš„</mark>ï¼ˆæœ‰åŠ©äºä½ æƒ³æ­£è§£ï¼‰ï¼Œå‡å¦‚ <span class="math inline">\(s\)</span> ä¸ºå½“å‰å·®åˆ†æ•°ç»„å‰ç¼€å’Œæ¨¡ <span class="math inline">\(p\)</span> çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯åŸæ•°ï¼‰ï¼Œå‘ç°<mark>å‰ä¸€ä¸ªæ•° <span class="math inline">\(&gt;\)</span> åä¸€ä¸ªæ•°å½“ä¸”ä»…å½“ <span class="math inline">\(s\)</span> åŠ çˆ†äº†</mark>ã€‚é‚£ä¹ˆè¿™å°±å¾ˆç®€å•äº†ï¼šé¡ºä¾¿ç»´æŠ¤ä¸€ä¸‹åŸæ•°ç»„ï¼›é‚£ä¹ˆ <span class="math inline">\(p\)</span> çš„åˆå€¼å°±å¯ä»¥ç¡®å®šã€‚ç„¶åç»´æŠ¤åŒºé—´å†…å·®åˆ†æ•°ç»„ä¹‹å’Œï¼ˆæ˜¾ç„¶ä¸ç”¨å–æ¨¡ï¼‰ï¼Œ<mark>åœ¨è¿™ä¸ªå’Œé‡Œæœ‰å¤šå°‘ä¸ª <span class="math inline">\(p\)</span> å°±ä¼šçˆ†å¤šå°‘æ¬¡</mark>ã€‚</p><hr /><h2 id="p12685-å›½å®¶é›†è®­é˜Ÿ-æ’é˜Ÿ-åŠ å¼ºç‰ˆ">P12685 [å›½å®¶é›†è®­é˜Ÿ] æ’é˜Ÿ åŠ å¼ºç‰ˆ</h2><p><a href="https://www.luogu.com.cn/problem/P12685" class="uri">https://www.luogu.com.cn/problem/P12685</a></p><blockquote><p>ç»™å®š <span class="math inline">\(a_{1\sim n}\)</span> å’Œ <span class="math inline">\(m\)</span> æ¬¡äº¤æ¢æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåè¾“å‡ºé€†åºå¯¹æ•°ã€‚</p><p><span class="math inline">\(n,m\le 2\times 10^5\)</span>ã€‚</p></blockquote><p>å“‡æ˜¯åŠ¨æ€é€†åºå¯¹ï¼ˆï¼Ÿï¼‰ã€‚äº¤æ¢çœ‹æˆä¸¤æ¬¡ä¿®æ”¹å°±å¯ä»¥æ— è„‘ CDQ äº†ã€‚</p><p><a href="https://www.luogu.com.cn/article/6rgqdfpb">è–…çš„é¢˜è§£</a> é‡Œç»™äº†ä¸€ä¸ªå¥‡æ€ªå¡å¸¸å°å¯„å·§ï¼šå‘ç° CDQ æ˜¯ <span class="math inline">\(O(len\log n)\)</span> çš„ï¼Œæš´åŠ›æ˜¯ <span class="math inline">\(O(len^2)\)</span> çš„ã€‚æ‰€ä»¥ç­‰åˆ° <span class="math inline">\(len&lt;\log n\)</span> çš„æ—¶å€™å°±å¯ä»¥ä¸Šæš´åŠ›äº†ã€‚</p><hr />]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¤šç»´ DP</title>
      <link href="/20250526/"/>
      <url>/20250526/</url>
      
        <content type="html"><![CDATA[<p>ä¸Šæ¥¼å¬åˆ°æœ‰äººåœ¨å“¼ <em>Climbing on the Trees</em>ï¼Œä¸Šæ¥å¬åˆ°éš”å£ç­åœ¨æ”¾ <em>Burn the House Down</em>ï¼Œæœç„¶æ˜¥å¤©æ˜¯ AJR çš„å­£èŠ‚ï¼ˆï¼‰</p><span id="more"></span><hr /><p>ä¸»è¦æ˜¯å¤šç»´ DP ç‰¹æœ‰çš„ä¼˜åŒ–ï¼</p><h2 id="åˆ†æ­¥è½¬ç§»">åˆ†æ­¥è½¬ç§»</h2><p>å¦‚æœçŠ¶æ€çš„è‹¥å¹²ç»´ä¹‹é—´åªå­˜åœ¨å¾ˆå¼±çš„è”ç³»ï¼Œå¯ä»¥åˆ†æ­¥è½¬ç§»æ¯ä¸€ç»´ã€‚</p><p>å‡è®¾æœ‰äºŒç»´çŠ¶æ€è½¬ç§» <span class="math inline">\((a,b)\to (a&#39;,b&#39;)\)</span>ï¼Œã€å¾ˆå¼±çš„è”ç³»ã€ä¸¾ä¾‹ï¼š</p><ol type="1"><li>DP å€¼ä¸­åŒ…å« <span class="math inline">\(w(a&#39;,b&#39;)\)</span>ï¼Œä½†ä¸åŒ…å«è¯¸å¦‚ <span class="math inline">\(w(a&#39;,b),w(a,b&#39;)\)</span> ä¹‹ç±»ã€‚ä¹Ÿå³è¯¥å€¼çš„æ±‚è§£ä¸ä¾èµ–äºä¸Šä¸€ä¸ªçŠ¶æ€ã€ä¸ä¾èµ–äºè½¬ç§»ã€‚</li><li>å¯¹äº <span class="math inline">\((a&#39;,b&#39;)\)</span> çš„å–å€¼æœ‰é™åˆ¶ï¼Œæ¯”å¦‚ <span class="math inline">\((114,514)\)</span> ä¸èƒ½å–åˆ°ä¹‹ç±»ã€‚æ˜¾ç„¶è¿™ä¹Ÿä¸ä¾èµ–äºä¸Šä¸€ä¸ªçŠ¶æ€ã€ä¸ä¾èµ–äºè½¬ç§»ã€‚</li><li>ç¬¦å·é™åˆ¶ï¼ˆå¦‚è½¬ç§»é—´ä¸º <span class="math inline">\(+\)</span>ï¼ŒçŠ¶æ€é—´ä¸º <span class="math inline">\(\times\)</span> ä¹‹ç±»ï¼‰ï¼Œåœ¨è®¡æ•°ä¸­å¸¸å‡ºç°ã€‚</li><li>ä¸€ä¸ªå˜åŠ¨çš„æ—¶å€™å¦ä¸€ä¸ªå¿…é¡»ä¹Ÿä¸€èµ·åŠ¨ã€‚</li></ol><p>æ³¨æ„ï¼æœ‰çš„æ—¶å€™ä¸€ä¸ªçŠ¶æ€ä¹Ÿå¯ä»¥æ‹†æˆä¸¤ä¸ªçŠ¶æ€ï¼Œç„¶ååˆ†æ­¥è½¬ç§»ã€‚</p><hr /><h3 id="ä¾‹é¢˜ç»å…¸é¢˜">ä¾‹é¢˜ï¼šç»å…¸é¢˜</h3><blockquote><p>ç»™å®š <span class="math inline">\(w_{N\times M}\)</span>ï¼Œæ±‚ <span class="math inline">\((A,B)_{1\sim K}\)</span>ï¼Œæœ€å¤§åŒ– <span class="math inline">\(\sum\limits_{i=1}^K w_{A_i,B_i}+w_{A_{i-1},A_i}+w_{B_{i-1},B_i}\)</span> çš„å€¼ã€‚</p></blockquote><p>å‘ç°å¦‚æœè®¾ <span class="math inline">\(f_{i,a,b}\)</span> è¡¨ç¤º <span class="math inline">\((A,B)_i=(a,b)\)</span> çš„è¯ï¼Œè½¬ç§»å°±ä¼šè¾¾åˆ°å¯è§‚çš„ <span class="math inline">\(O(N\times M)\)</span>ï¼›ä½†å‘ç°é‡Œé¢çš„ <span class="math inline">\(A\)</span> å’Œ <span class="math inline">\(B\)</span> å…¶å®æ²¡ä»€ä¹ˆæœ‰æœºè”ç³»ï¼›å”¯ä¸€çš„è”ç³» <span class="math inline">\(w_{A_i,B_i}\)</span>ï¼ˆä¸Šé¢ã€å¾ˆå¼±çš„è”ç³»ã€ä¸­çš„ç¬¬ä¸€ã€å››ç§æƒ…å†µï¼‰ã€‚å› æ­¤åˆ†å¸ƒè½¬ç§»ï¼š</p><p><span class="math display">\[f&#39;_{a&#39;,b}\gets \max\limits_a f_{a,b}+w_{a&#39;,a}\\f_{a&#39;,b&#39;}\gets \max\limits_b f&#39;_{a&#39;, b} + w_{b,b&#39;}+w_{a&#39;,b&#39;}\]</span></p><p>ç”±æ­¤ä¾¿ä¼˜åŒ–è½¬ç§»å¤æ‚åº¦åˆ° <span class="math inline">\(O(N+M)\)</span>ã€‚</p><hr /><h3 id="ä¾‹é¢˜å½©ç¯æ™šä¼š">ä¾‹é¢˜ï¼šå½©ç¯æ™šä¼š</h3><p>goto <a href="/20250407/#e---kdoi-11å½©ç¯æ™šä¼š">link</a>ã€‚</p><p>Tipsï¼šå‘ç° <span class="math inline">\(l_1,l_2\)</span> ä¹‹é—´ä¹Ÿæ²¡å•¥æœ‰æœºè”ç³»ï¼ˆä¸Šé¢ã€å¾ˆå¼±çš„è”ç³»ã€ä¸­çš„ç¬¬ä¸‰ã€å››ç§æƒ…å†µï¼‰ï¼Œæ•…åˆ†æ­¥è½¬ç§»ã€‚</p><hr /><h3 id="ä¾‹é¢˜åºåˆ—å¦™å¦™å€¼">ä¾‹é¢˜ï¼šåºåˆ—å¦™å¦™å€¼</h3><p><a href="https://uoj.ac/problem/549" class="uri">https://uoj.ac/problem/549</a></p><p>æœ´ç´ åœ°ï¼Œè®¾ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºåœ¨ç¬¬ <span class="math inline">\(i\)</span> ä¸ªå¤„åˆ†ç¬¬ <span class="math inline">\(j\)</span> æ®µçš„æœ€å¤§ä»·å€¼ï¼Œæ˜¾ç„¶æœ‰ <span class="math inline">\(O(k\times n^2)\)</span>ï¼Œä¸”å¹¶æ²¡æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚</p><p>è€ƒè™‘åˆ©ç”¨ <span class="math inline">\(a_i\)</span> å¾ˆå°è¿™ä¸€æ¡ä»¶ï¼Œå‘ç°ä¸Šä¸€æ¡æ— æ³•ä¼˜åŒ–æ˜¯å› ä¸ºè¦è·å– <span class="math inline">\(sum_{i}\)</span> çš„å€¼ï¼›é‚£ä¹ˆæŠŠ <span class="math inline">\(sum_i\)</span> å¡åˆ°çŠ¶æ€é‡Œã€‚è®¾ <span class="math inline">\(f_{s&#39;,j}\)</span> è¡¨ç¤º <span class="math inline">\(sum=s&#39;\)</span> æ—¶ï¼Œåˆ†äº† <span class="math inline">\(j\)</span> æ®µçš„æœ€å¤§ä»·å€¼ã€‚åŒæ ·å¯ä»¥ <span class="math inline">\(O(k\cdot n^2)\)</span>ã€‚</p><p>æ¥ä¸‹æ¥æœ‰ä¸¤ä¸ªç†è§£è¿™ä¸ªä¼˜åŒ–çš„è§’åº¦ï¼š</p><ol type="1"><li><p>ä»å¹³è¡¡è§’åº¦ï¼ŒåŸé—®é¢˜ç­‰ä»·äº <span class="math inline">\(O(1)\)</span> æ›´æ–° <span class="math inline">\((s,j)\)</span> å¤„çš„æœ€å¤§å€¼ï¼Œ<span class="math inline">\(O(v)\)</span> æŸ¥æ‰¾ <span class="math inline">\(j-1\)</span> å¤„çš„æœ€å¤§å€¼ï¼›æŠŠ <span class="math inline">\(s\)</span> æ‹†æˆå‰ <span class="math inline">\(8\)</span> ä½ã€å <span class="math inline">\(8\)</span> ä½ä¸¤ä¸ª partï¼Œå½“æ›´æ–°</p><p>å¯¹äºä¿®æ”¹ï¼šç›¸å½“äºå›ºå®šå‰ <span class="math inline">\(8\)</span> ä½ <span class="math inline">\(s\)</span>ï¼Œæšä¸¾å <span class="math inline">\(8\)</span> ä½ <span class="math inline">\(x\)</span>ï¼Œå¹¶æ›´æ–° <span class="math inline">\((s,x)\)</span>ã€‚</p>å¯¹äºæŸ¥è¯¢ï¼šç›¸å½“äºå›ºå®šå <span class="math inline">\(8\)</span> ä½ <span class="math inline">\(x\)</span>ï¼Œæšä¸¾å‰ <span class="math inline">\(8\)</span> ä½ <span class="math inline">\(s\)</span>ï¼Œå¹¶æŸ¥è¯¢ <span class="math inline">\((s,x)\)</span>ã€‚</li><li><p>ä»åˆ†æ­¥è½¬ç§»è§’åº¦ï¼Œç”±äºã€ç°æ—¶åˆ»ã€çš„è´¡çŒ®æ˜¯æŒ‰ä½çš„ï¼ŒäºŒè¿›åˆ¶çŠ¶æ€çš„å‰ <span class="math inline">\(8\)</span> ä½å’Œå <span class="math inline">\(8\)</span> ä½æ²¡å•¥æœ‰æœºè”ç³»ï¼Œæ•…ç›´æ¥æ‹†å¼€ï¼Œå…ˆè½¬ç§»å‰ <span class="math inline">\(8\)</span> ä½ï¼Œå†è½¬ç§»å <span class="math inline">\(8\)</span> ä½ã€‚</p></li></ol><p>è¿™æ ·å°±è¢«ä¼˜åŒ–ä¸º <span class="math inline">\(O(k\cdot n\times \sqrt v)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxv = 1 &lt;&lt; 8;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    using arr = std::vector&lt;int&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    arr s(n + 1), tag0(maxv), d0;    crr f(maxv, brr(maxv, arr(k + 1, inf))), g(maxv, brr(maxv, arr(k + 1, inf)));    f[0][0][0] = 0;    for (int j = 0; j &lt; maxv; ++j)        g[0][j][1] = j;    tag0[0] = 1, d0.push_back(0);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; s[i], s[i] ^= s[i - 1];        int p0 = s[i] &gt;&gt; 8, p1 = s[i] &amp; ((1 &lt;&lt; 8) - 1);        for (int j = k; j; --j) &#123;            for (auto a : d0)                f[p0][p1][j] = std::min(f[p0][p1][j], g[a][p1][j] + ((a ^ p0) &lt;&lt; 8));            // printf(&quot;f[%d][%d][%d] = %d\n&quot;, p0, p1, j, f[p0][p1][j]);            if (j != k)                for (int a = 0; a &lt; maxv; ++a)                    g[p0][a][j + 1] = std::min(g[p0][a][j + 1], f[p0][p1][j] + (a ^ p1));        &#125;        if (i &gt;= k)            std::cout &lt;&lt; f[p0][p1][k] &lt;&lt; &#39; &#39;;        if (!tag0[p0])            tag0[p0] = 1, d0.push_back(p0);    &#125;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="å‰²è£‚">å‰²è£‚</h2><p>å¦‚æœçŠ¶æ€çš„è‹¥å¹²ç»´ä¹‹é—´è¿æ— æœºè”ç³»éƒ½æ²¡äº†ï¼Œå¯ä»¥ç›´æ¥æŠŠ DP æ•°ç»„æ‹†å¼€ï¼Œå„è‡ªè½¬ç§»å„è‡ªçš„ã€‚</p><p>æœ€åç­”æ¡ˆçš„æ‹¼æ¥ï¼Œå¯èƒ½æ˜¯æšä¸¾ã€ç›´æ¥æ‹¼ã€ç”¨ä¸€ä¸ªè½¬ç§»å¦ä¸€ä¸ªä¹‹ç±»ã€‚</p><hr /><h3 id="ä¾‹é¢˜ç»å…¸é¢˜-1">ä¾‹é¢˜ï¼šç»å…¸é¢˜</h3><blockquote><p>ç»™å®š <span class="math inline">\(w_{N\times M}\)</span>ï¼Œæ±‚ <span class="math inline">\((A,B)_{1\sim K}\)</span>ï¼Œæœ€å¤§åŒ– <span class="math inline">\(\sum\limits_{i=1}^K w_{A_{i-1},A_i}+w_{B_{i-1},B_i}\)</span> çš„å€¼ã€‚</p></blockquote><p>å…ˆ DP å‡ºæ¥ <span class="math inline">\(A\)</span>ï¼Œå† DP å‡ºæ¥ <span class="math inline">\(B\)</span>ï¼Œç›´æ¥ç›¸åŠ å³å¯ã€‚</p><hr /><h3 id="ä¾‹é¢˜mnogomet">ä¾‹é¢˜ï¼šMNOGOMET</h3><p><a href="https://www.luogu.com.cn/problem/P7648" class="uri">https://www.luogu.com.cn/problem/P7648</a></p><p>æƒ³åˆ°è®¾ <span class="math inline">\(f_{t,i,a,b}\)</span> è¡¨ç¤ºã€è¿‡å»äº† <span class="math inline">\(t\)</span> ç§’ï¼Œä¸”çƒåœ¨çƒå‘˜ <span class="math inline">\(i\)</span> æ‰‹ä¸Šï¼Œä¸”ä¸¤ä¸ªé˜Ÿä¼å¾—åˆ†åˆ†åˆ«ä¸º <span class="math inline">\(a,b\)</span>ã€çš„æ¦‚ç‡ã€‚é‚£ä¹ˆæšä¸¾çƒä¸Šä¸€æ¬¡åœ¨è°æ‰‹ä¸Šï¼Œæœ‰ç¾è§‚çš„ <span class="math inline">\(O(T\cdot N^2R^2)\)</span>ã€‚</p><p>å‘ç°æ¯”åˆ†å˜åŠ¨æ—¶ï¼ˆä¸ŠåŠä¸ªæ—¶åˆ»å®Œæˆå°„é—¨å¹¶ä¼ çƒï¼‰çƒä¸€å®šåœ¨æŸä¸ªé˜Ÿçš„ <span class="math inline">\(1\)</span> å·æ‰‹ä¸Šï¼›<span class="math inline">\(i\)</span> è¿™ä¸€ç»´å’Œ <span class="math inline">\(a,b\)</span> ä¹Ÿæ²¡æœ‰ç›¸äº’çš„å¹²æ‰°ï¼›æ•…å¯ä»¥å°† <span class="math inline">\(i\)</span> æå–å‡ºæ¥ï¼ˆä½œä¸ºå¯¹æ¯”ï¼Œå°„é—¨å’Œå¤ºçƒã€ä¼ çƒéƒ½ä¼šå½±å“ <span class="math inline">\(t\)</span>ï¼Œæ‰€ä»¥åˆ†è£‚å‡ºæ¥çš„çŠ¶æ€ä¸­å¿…é¡»åŒ…å« <span class="math inline">\(t\)</span>ï¼‰ã€‚å…·ä½“åœ°ï¼š</p><ol type="1"><li><p>ä»¤ <span class="math inline">\(g_{t,0/1,i}\)</span> è¡¨ç¤ºã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ <span class="math inline">\(1\)</span> å·ï¼ŒèŠ±è´¹ <span class="math inline">\(t\)</span> ç§’ï¼Œä¸”æ²¡äººå°„é—¨ï¼Œä¸”çƒåœ¨çƒå‘˜ <span class="math inline">\(i\)</span> æ‰‹ä¸Šã€çš„æ¦‚ç‡ã€‚å‘ç°å¯ä»¥ <span class="math inline">\(O(T\times N^2)\)</span> è®¡ç®—ã€‚</p><p>å½“ç„¶è¿™é‡Œå°±æ˜¯æ¡ä»¶æ¦‚ç‡äº†ã€‚å…¶ä¸­ã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ <span class="math inline">\(1\)</span> å·ã€å°±æ˜¯æ¡ä»¶ã€‚</p>å†é¢„å¤„ç†å¯ä»¥å¾—åˆ° <span class="math inline">\(G_{t,0/1,0/1,0/1}\)</span> è¡¨ç¤ºã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ <span class="math inline">\(1\)</span> å·ï¼ŒèŠ±è´¹ <span class="math inline">\(t\)</span> ç§’ï¼Œå“ªä¸ªçƒé˜Ÿå°„é—¨ï¼Œï¼ˆæ²¡ï¼‰å°„è¿›ã€çš„æ¦‚ç‡ã€‚</li><li><p>ä»¤ <span class="math inline">\(f_{t,0/1,a,b}\)</span> è¡¨ç¤ºã€è¿‡å»äº† <span class="math inline">\(t\)</span> ç§’ï¼Œçƒåœ¨å“ªä¸ªé˜Ÿçš„ <span class="math inline">\(1\)</span> å·ï¼Œä¸”å¾—åˆ†ä¸º <span class="math inline">\(a,b\)</span>ã€çš„æ¦‚ç‡ã€‚æšä¸¾è·ç¦»ä¸Šä¸€æ¬¡å°„é—¨çš„æ—¶é—´ï¼Œå¯ä»¥ <span class="math inline">\(O(T^2\times R^2)\)</span> å®Œæˆè½¬ç§»ã€‚</p></li></ol><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, r, T;    std::cin &gt;&gt; n &gt;&gt; r &gt;&gt; T;    using arr = std::vector&lt;double&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    brr p(2 * n + 1, arr(2)), pp(2 * n + 1, arr(2 * n + 1));    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; p[i][1], p[i][0] = 1. - p[i][1];        int ss, sd;        std::cin &gt;&gt; ss &gt;&gt; sd;        double P = 1. / (ss + sd + 1);        p[i][0] *= P, p[i][1] *= P;        for (int x; ss--; pp[i][x] = P)            std::cin &gt;&gt; x;        for (int x; sd--; pp[i][x + n] = P)            std::cin &gt;&gt; x;    &#125;    for (int i = n + 1; i &lt;= 2 * n; ++i) &#123;        std::cin &gt;&gt; p[i][1], p[i][0] = 1. - p[i][1];        int ss, sd;        std::cin &gt;&gt; ss &gt;&gt; sd;        double P = 1. / (ss + sd + 1);        p[i][0] *= P, p[i][1] *= P;        for (int x; ss--; pp[i][x + n] = P)            std::cin &gt;&gt; x;        for (int x; sd--; pp[i][x] = P)            std::cin &gt;&gt; x;    &#125;    brr s(T + 1, arr(2));    crr g(T + 1, brr(2, arr(2 * n + 1)));    std::vector&lt;crr&gt; G(T + 1, crr(2, brr(2, arr(2)))), f(T + 1, crr(2, brr(r + 1, arr(r + 1))));    g[0][0][1] = g[0][1][n + 1] = 1.;    for (int t = 1; t &lt;= T; ++t) &#123;        for (int f1 = 0; f1 &lt;= 1; ++f1)            for (int i = 1; i &lt;= 2 * n; ++i) &#123;                G[t][f1][i &gt; n][0] += g[t - 1][f1][i] * p[i][0];                G[t][f1][i &gt; n][1] += g[t - 1][f1][i] * p[i][1];                for (int j = 1; j &lt;= 2 * n; ++j)                    if (j != i)                        g[t][f1][i] += pp[j][i] * g[t - 1][f1][j];                // printf(&quot;spend %ds, start from %d, now at %d: %.10lf\n&quot;, t, 1 + f1 * n, i, g[t][f1][i]);                s[t][f1] += g[t][f1][i];            &#125;    &#125;    // puts(&quot;------------------------------------&quot;);    // for (int t = 1; t &lt;= T; ++t) &#123;    //     for (int f1 = 0; f1 &lt;= 1; ++f1)    //         for (int f2 = 0; f2 &lt;= 1; ++f2)    //             for (int f3 = 0; f3 &lt;= 1; ++f3)    //                 printf(&quot;spend %ds, start from %d, %d shoots, STATUS: %d, P = %.10lf\n&quot;, t, 1 + f1 * n, 1 + f2, f3, G[t][f1][f2][f3]);    // &#125;    // puts(&quot;------------------------------------&quot;);    f[0][0][0][0] = 1.;    for (int t = 0; t &lt; T; ++t)        for (int f1 = 0; f1 &lt;= 1; ++f1)            for (int a = 0; a &lt; r; ++a)                for (int b = 0; b &lt; r; ++b) &#123;                    for (int t1 = 1; t + t1 &lt;= T; ++t1) &#123;                        f[t + t1][0][a][b] += f[t][f1][a][b] * G[t1][f1][1][0];                        f[t + t1][0][a][b + 1] += f[t][f1][a][b] * G[t1][f1][1][1];                        f[t + t1][1][a][b] += f[t][f1][a][b] * G[t1][f1][0][0];                        f[t + t1][1][a + 1][b] += f[t][f1][a][b] * G[t1][f1][0][1];                        if (t + t1 == T)                            f[T][0][a][b] += f[t][f1][a][b] * s[t1][f1];                    &#125;                &#125;    // for (int t = 0; t &lt;= T; ++t)    //     for (int f1 = 0; f1 &lt;= 1; ++f1)    //         for (int a = 0; a &lt;= r; ++a)    //             for (int b = 0; b &lt;= r; ++b)    //                 if (f[t][f1][a][b] &gt; 1e-10)    //                     printf(&quot;%ds later, %d shoots, %d : %d, P = %.10lf\n&quot;, t, 1 + !f1 * n, a, b, f[t][f1][a][b]);    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(10);    for (int a = 0; a &lt;= r; ++a) &#123;        for (int b = 0; b &lt;= r; ++b) &#123;            if (a == r &amp;&amp; b == r)                continue;            double res(0.);            if (a == r)                for (int t = r; t &lt;= T; ++t)                    res += f[t][1][r][b];            else if (b == r)                for (int t = r; t &lt;= T; ++t)                    res += f[t][0][a][r];            else                res = f[T][0][a][b] + f[T][1][a][b];            std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;        &#125;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> DP ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘¨è€ƒ</title>
      <link href="/20250524/"/>
      <url>/20250524/</url>
      
        <content type="html"><![CDATA[<p>å¹¶éå‘¨è€ƒã€‚</p><span id="more"></span><hr /><h2 id="b---carousel-of-combinations">B - Carousel of Combinations</h2><p><a href="https://codeforces.com/problemset/problem/1957/E" class="uri">https://codeforces.com/problemset/problem/1957/E</a></p><blockquote><p><span class="math inline">\(q\)</span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®šä¸€ä¸ª <span class="math inline">\(n\)</span>ï¼Œæ±‚ï¼š</p><p><span class="math display">\[\left(\sum\limits_{i=1}^n\sum\limits_{j=1}^i \dfrac {i!}{(i-j)!\cdot j!}\bmod j\right) \bmod 10^9+7\]</span></p><p><span class="math inline">\(n,q\le 10^6\)</span>ã€‚</p></blockquote><p>èµ›æ—¶æ‰“è¡¨ <span class="math inline">\(\dfrac {i!}{(i-j)!\cdot j!}\bmod j\)</span> æ˜“å‘ç°åªæœ‰ <span class="math inline">\(j=4\)</span> æˆ– <span class="math inline">\(j\)</span> ä¸ºè´¨æ•°çš„åˆ—ä¸Šæœ‰å€¼ï¼›ä¸”ä»…å½“ <span class="math inline">\(\left\lfloor \dfrac ij\right\rfloor\)</span> å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<span class="math inline">\((i,j)\)</span> çš„å€¼ä¸åŒã€‚</p><p>äºæ˜¯ä¹åŸƒç­›æ‰¾æ¯ä¸ª <span class="math inline">\(j\)</span> çš„å€æ•°ï¼Œç”±äºæ¯ä¸ªå€¼ä¼šæŒç»­ä¸€æ®µ <span class="math inline">\(i\)</span> ä¸Šçš„åŒºé—´ï¼Œè€ƒè™‘ç»´æŠ¤å·®åˆ†æ•°ç»„ã€‚å‰ç¼€å’Œå¾—åˆ°åŸæ•°ç»„ï¼Œå†å‰ç¼€å’Œå°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚</p><details><p><summary>è¯æ˜</summary></p><p>è€ƒè™‘è½¬åŒ–ä¸ºç»„åˆæ•°å½¢å¼æ–¹ä¾¿è¯æ˜ã€‚å½“ <span class="math inline">\(j\)</span> ä¸ºè´¨æ•°æ—¶ï¼š</p><p><span class="math display">\[\begin{aligned}\dfrac {i!}{(i-j)!\cdot j!}\bmod j&amp;=C_i^j\cdot (j-1)!\bmod j\\&amp;=C_{i\bmod j}^{j\bmod j}\cdot C_{\lfloor \frac ij\rfloor}^{\frac jj}\cdot (j-1)!\bmod j\\&amp;=\left\lfloor \frac ij\right\rfloor\cdot (j-1)!\bmod j\\&amp;=\left\lfloor \frac ij\right\rfloor\cdot (j-1)\bmod j\end{aligned}\]</span></p><p>å½“ <span class="math inline">\(j\)</span> ä¸ºåˆæ•°æ—¶ï¼š</p><p><span class="math display">\[\dfrac {i!}{(i-j)!\cdot j!}\bmod j=\left\lfloor \frac ij\right\rfloor\cdot (j-1)!\bmod j\]</span></p><ul><li><p>å½“ <span class="math inline">\(j=p^2\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(p\)</span> ä¸ºè´¨æ•°æ—¶ï¼š</p><ul><li>å½“ <span class="math inline">\(j\ne 4\)</span> æ—¶ï¼Œ<span class="math inline">\(\dfrac jp \ge 3\)</span>ï¼Œä»£è¡¨åœ¨ <span class="math inline">\(1\sim j-1\)</span> ä¸­è‡³å°‘å‡ºç°äº†ä¸¤ä¸ª <span class="math inline">\(p\)</span> çš„å€æ•°ï¼Œå³ <span class="math inline">\((j-1)\bmod j = 0\)</span>ã€‚</li><li>å¦åˆ™ï¼ŒåŸå¼è½¬åŒ–ä¸º <span class="math inline">\(2\cdot \left\lfloor \frac i4\right\rfloor\bmod 4\)</span>ã€‚</li></ul></li><li><p>å¦åˆ™ï¼šå¯ä»¥æ‰¾åˆ°è‡³å°‘ä¸€ç»„ <span class="math inline">\(j=i\cdot k\)</span> æ»¡è¶³ <span class="math inline">\(i\ne k\)</span>ï¼Œåˆ™ <span class="math inline">\(i,k\)</span> å‡ºç°åœ¨ <span class="math inline">\(1\sim j-1\)</span> ä¸­ï¼Œå³ <span class="math inline">\((j-1)\bmod j = 0\)</span>ã€‚</p></li></ul><p>å¾—åˆ°ä¸Šè¿°ç»“è®ºã€‚</p><p>Tipsï¼š</p><ul><li>å¢å¡æ–¯å®šç†ï¼šæ‡’å¾—å†™äº†ã€‚</li><li>å¨å°”é€Šå®šç†ï¼šå¯¹äºè´¨æ•° <span class="math inline">\(p\)</span>ï¼Œ<span class="math inline">\((p-1)!\equiv -1\pmod p\)</span>ã€‚</li></ul></details><hr /><h2 id="c---ç»åˆ©ç»´äºš-bolivija">C - ç»åˆ©ç»´äºš / Bolivija</h2><p><a href="https://www.luogu.com.cn/problem/P12401" class="uri">https://www.luogu.com.cn/problem/P12401</a></p><blockquote><p>ç»™å®šè‹¥å¹²æ¬¡åŒºé—´çš„æ’å…¥ä¸åˆ é™¤æ“ä½œï¼Œå¯¹äºæ‰€æœ‰å€¼åŸŸå†…æœªè¢«è¦†ç›–æé•¿æ®µ <span class="math inline">\(i\)</span>ï¼Œä»¤ <span class="math inline">\(len_i\)</span> ä¸ºå…¶é•¿åº¦ï¼›æ¯æ¬¡æ“ä½œåè¯¢é—® <span class="math inline">\(\sum \frac {len_i\cdot (len_i-1)}2+len_i\)</span>ã€‚</p></blockquote><p>æ¥ä¸€ç‚¹æ–°å¥‡çš„æ€è·¯ã€‚å‡å¦‚ä½ å’Œæˆ‘ä¸€æ ·ï¼Œå¾ˆä¸å¹¸åœ°ä¸çŸ¥é“ç»´æŠ¤æœ€å°å€¼è¿™ä¸ª trickï¼Œæ€ä¹ˆè§£å†³è¿™é“é¢˜ï¼Ÿ</p><p>å®¹æ˜“æƒ³åˆ°çº¿æ®µæ ‘ç»´æŠ¤èŠ‚ç‚¹å†…è´¡çŒ®å’Œå·¦ä¾§ã€å³ä¾§æé•¿æœªè¦†ç›–é•¿åº¦ã€‚åŠ å…¥åŒºé—´æ˜¯ç®€å•çš„ï¼šå¯¹äºçº¿æ®µæ ‘ä¸Šè¢«å®Œå…¨è¦†ç›–çš„èŠ‚ç‚¹ï¼Œæ›´æ–°å…¶è´¡çŒ®ä¸º <span class="math inline">\(0\)</span>ã€‚ä¾æ¬¡ <code>pushup</code> å³å¯ã€‚</p><p>åˆ é™¤åŒºé—´ï¼Œå¯¹äºè¢«è¿™æ®µåŒºé—´å®Œå…¨è¦†ç›–çš„èŠ‚ç‚¹ï¼Œå‘ç°å¦‚æœæ•´ä½“è¢«è¦†ç›–æ¬¡æ•°å‡å°‘ <span class="math inline">\(1\)</span>ï¼Œæœ‰å¯èƒ½å‡ºç°æ–°çš„ã€æœªè¢«è¦†ç›–çš„ç‚¹ï¼Œå¦‚æœæš´åŠ› check å·¦å³å„¿å­æ˜¯å¦å‡ºç°äº†è¿™æ ·çš„ç‚¹å¹¶æ›´æ–°ï¼Œå¤æ‚åº¦å°±ä¸å¤ªç¾è§‚äº†ã€‚</p><p>æ•…è€Œå¯¹äºä¸€ä¸ªèŠ‚ç‚¹ï¼Œ<strong>å°†ã€å®Œå…¨è¦†ç›–å®ƒçš„åŒºé—´ã€å’Œã€éƒ¨åˆ†è¦†ç›–å®ƒçš„åŒºé—´ã€åˆ†å¼€è€ƒè™‘</strong>ï¼Œåœ¨ç»´æŠ¤è¯¥èŠ‚ç‚¹æ‰€æœ‰å®æ—¶ä¿¡æ¯ï¼ˆè®°ä¸º <span class="math inline">\(s\)</span>ï¼‰çš„åŒæ—¶ï¼Œ<strong>ç»´æŠ¤å¦ä¸€ä»½åªè€ƒè™‘äº†ã€éƒ¨åˆ†è¦†ç›–å®ƒåœ°åŒºé—´ã€çš„ä¿¡æ¯ï¼ˆè®°ä¸º <span class="math inline">\(s&#39;\)</span>ï¼‰</strong>ï¼š</p><ul><li><p>å¦‚æœä¸€ä¸ªã€éƒ¨åˆ†è¦†ç›–å®ƒçš„åŒºé—´ã€è¢«åˆ é™¤ï¼š</p><ul><li>å¦‚æœå­˜åœ¨ã€å®Œå…¨è¦†ç›–å®ƒçš„åŒºé—´ã€ï¼š<span class="math inline">\(s\)</span> ä¸å˜ï¼›å‘ä¸‹ä¿®æ”¹å„¿å­çš„ <span class="math inline">\(s\)</span>ï¼Œ<span class="math inline">\(s&#39;\)</span> éœ€è¦ä»å„¿å­çš„ <span class="math inline">\(s\)</span> æ›´æ–°ã€‚</li></ul></li><li><p>å¦‚æœä¸€ä¸ªã€å®Œå…¨è¦†ç›–å®ƒçš„åŒºé—´ã€è¢«åˆ é™¤ï¼š</p><ul><li>å¦‚æœè¿˜å­˜åœ¨å…¶ä»–ã€å®Œå…¨è¦†ç›–å®ƒçš„åŒºé—´ã€ï¼š<span class="math inline">\(s,s&#39;\)</span> éƒ½ä¸å˜ã€‚</li><li>å¦‚æœä¸å­˜åœ¨å…¶ä»–ã€å®Œå…¨è¦†ç›–å®ƒçš„åŒºé—´ã€ï¼šç”¨ <span class="math inline">\(s&#39;\)</span> æ›´æ–° <span class="math inline">\(s\)</span>ã€‚</li></ul></li></ul><p>è¿™æ ·å°±èƒ½ <span class="math inline">\(O(q\log V)\)</span> è§£å†³ä¸Šè¿°é—®é¢˜ã€‚æœ¬æ–¹æ³•è¾ƒç»´æŠ¤æœ€å°å€¼çš„ä¼˜åŠ¿åœ¨äºâ€”â€”ä¼¼ä¹æ²¡æœ‰ã€‚æƒ³äº†è®¸å¤šç§æƒ…å†µï¼Œå®ƒä»¬å¤§æŠµæ˜¯ç­‰ä»·çš„â€”â€”ä¸”æœ¬æ–¹æ³•æ›´éš¾å†™ï¼ˆå“­ï¼‰ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 654205;struct &#123;    int cnt;    long long u, s;    int l, r, lu, ru, ls, rs;&#125; t[maxn &lt;&lt; 2];#define lt (p &lt;&lt; 1)#define rt (lt | 1)#define len(p) (t[p].r - t[p].l + 1)void pushup(int p) &#123;    t[p].s = t[lt].u + t[rt].u + (long long)t[lt].ru * t[rt].lu;    if (t[lt].lu == len(lt))        t[p].ls = len(lt) + t[rt].lu;    else        t[p].ls = t[lt].lu;    if (t[rt].ru == len(rt))        t[p].rs = t[lt].ru + len(rt);    else        t[p].rs = t[rt].ru;    if (!t[p].cnt)        t[p].u = t[p].s, t[p].lu = t[p].ls, t[p].ru = t[p].rs;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r;    if (l == r) &#123;        t[p].u = t[p].s = 1ll;        t[p].lu = t[p].ru = t[p].ls = t[p].rs = 1;        return;    &#125;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    pushup(p);    return;&#125;void add(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        ++t[p].cnt, t[p].u = 0ll, t[p].lu = t[p].ru = 0;        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (l &lt;= mid)        add(lt, l, r);    if (r &gt; mid)        add(rt, l, r);    pushup(p);    return;&#125;void rem(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        if (!--t[p].cnt)            t[p].u = t[p].s, t[p].lu = t[p].ls, t[p].ru = t[p].rs;        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (l &lt;= mid)        rem(lt, l, r);    if (r &gt; mid)        rem(rt, l, r);    pushup(p);    return;&#125;int main() &#123;    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    int n, q;    std::cin &gt;&gt; n &gt;&gt; q;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    int u = (n + 1) / 2;    const int N = a[u];    bld(1, 1, N);    for (int i = 1; i &lt; u; ++i)        if (a[i] != a[n - i + 1])            add(1, std::min(a[i], a[n - i + 1]) + 1, std::max(a[i], a[n - i + 1]));    std::cout &lt;&lt; t[1].u &lt;&lt; &#39;\n&#39;;    for (int i, v; q--; ) &#123;        std::cin &gt;&gt; i &gt;&gt; v;        if (a[i] != a[n - i + 1])            rem(1, std::min(a[i], a[n - i + 1]) + 1, std::max(a[i], a[n - i + 1]));        a[i] = v;        if (a[i] != a[n - i + 1])            add(1, std::min(a[i], a[n - i + 1]) + 1, std::max(a[i], a[n - i + 1]));        std::cout &lt;&lt; t[1].u &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="d---ç§»åŠ¨é‡‘å¸">D - ç§»åŠ¨é‡‘å¸</h2><p><a href="https://www.luogu.com.cn/problem/P5363" class="uri">https://www.luogu.com.cn/problem/P5363</a></p><p>æœ€åä¸€ä¸ªæ£‹å­çš„ç§»åŠ¨ç­‰ä»·äºä¸¢æ‰æœ€åä¸€éƒ¨åˆ†ç©ºæ ¼ï¼›ä¸­é—´æ£‹å­çš„ç§»åŠ¨ç­‰ä»·äºæŠŠå·¦è¾¹é—´éš”é‡Œçš„ä¸€æ®µç©ºæ ¼æ‹¿åˆ°å³è¾¹çš„é—´éš”é‡Œã€‚å‘ç°åŸé—®é¢˜è½¬åŒ–ä¸ºã€é˜¶æ¢¯ Nim åšå¼ˆã€ã€‚</p><details><p><summary>å…³äºé˜¶æ¢¯ Nim åšå¼ˆâ€¦</summary></p><blockquote><p>ç»™å®š <span class="math inline">\(n\)</span> å±‚çŸ³å¤´ï¼Œæ¯æ¬¡è¡ŒåŠ¨å¯ä»¥é€‰æ‹©ä»¥ä¸‹æ“ä½œä¸­çš„ä¸€ç§ï¼š</p><ol type="1"><li>é€‰æ‹© <span class="math inline">\(2\le i\le n\)</span>ï¼Œä»ç¬¬ <span class="math inline">\(i\)</span> å±‚çŸ³å¤´ä¸­æ‹¿èµ°è‹¥å¹²é¢—ï¼Œå…¨éƒ¨æ”¾åˆ°ç¬¬ <span class="math inline">\(i-1\)</span> å±‚é‡Œã€‚</li><li>ä»ç¬¬ <span class="math inline">\(1\)</span> å±‚çŸ³å¤´ä¸­æ‹¿èµ°è‹¥å¹²é¢—ï¼Œå…¨éƒ¨ä¸¢å¼ƒã€‚</li></ol><p>ä¸èƒ½è¡ŒåŠ¨è€…è¾“ã€‚</p></blockquote><p>æœ¬é—®é¢˜å¯ä»¥ç­‰æ•ˆä¸º Nim æ¸¸æˆï¼š</p><p>å¯¹äºç¬¬å¶æ•°å±‚ï¼Œè‹¥ Alice é€‰æ‹©ä»ç¬¬ <span class="math inline">\(2i\)</span> å±‚ä¸­ç§»åŠ¨ <span class="math inline">\(x\)</span> ä¸ªçŸ³å¤´åˆ° <span class="math inline">\(2i-1\)</span>ï¼ŒBob å¯ä»¥ç«‹å³ä» <span class="math inline">\(2i-1\)</span> å±‚ä¸­å°†è¿™ <span class="math inline">\(x\)</span> ä¸ªçŸ³å¤´ç§»åŠ¨åˆ° <span class="math inline">\(2i-2\)</span>ï¼ˆæˆ–ä¸¢å¼ƒï¼‰ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒAlice åœ¨å¶æ•°å±‚ä¸­çš„æ“ä½œä¸ä¼šå¯¹ Bob å¸¦æ¥ä»»ä½•é™åˆ¶ã€‚å¶æ•°å±‚çš„çŸ³å¤´å¯ä»¥è¢«è§†ä½œä¸å­˜åœ¨ï¼›ä»å¥‡æ•°å±‚ç§»åŠ¨åˆ°å¶æ•°å±‚çš„çŸ³å¤´å¯ä»¥è¢«è§†ä¸ºä¸¢å¼ƒï¼›è¿›è€Œï¼Œå¥‡æ•°å †ä¸­çš„ç§»åŠ¨ç­‰æ•ˆä¸ºã€ä¸¢å¼ƒã€ï¼Œå°†åŸé—®é¢˜ä¸­æ‰€æœ‰å¥‡æ•°å †æŠ½ç¦»å‡ºæ¥ï¼Œç­‰æ•ˆæˆæ™®é€šçš„ Nim æ¸¸æˆã€‚</p></details><p>é—®é¢˜è½¬åŒ–æˆï¼Œå°† <span class="math inline">\(n-m\)</span> ä¸ªå…ƒç´ æ”¾åˆ°ç¼–å· <span class="math inline">\(0\sim m+1\)</span> çš„ç›’å­é‡Œï¼Œæ»¡è¶³å¥‡æ•°å·ç›’å­çƒä¸ªæ•°å¼‚æˆ–å’Œä¸º <span class="math inline">\(0\)</span> çš„æ–¹æ¡ˆæ•°ã€‚å°å®¹æ–¥ä¸€ä¸‹ï¼Œç”¨æ€»æ•°å‡å»å¼‚æˆ–å’Œä¸º <span class="math inline">\(0\)</span> è€…ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> åšå¼ˆè®º </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20250520/"/>
      <url>/20250520/</url>
      
        <content type="html"><![CDATA[<p>manual æ˜¯ anual çš„ m è¯å½¢å¼ï¼ˆèƒ¡è¨€ä¹±è¯­ï¼‰</p><p>Everyone is potential. ï¼ˆæ¯ä¸ªäººéƒ½æ˜¯è›‹ç™½è´¨ã€‚ï¼‰</p><span id="more"></span><hr /><h2 id="cf2043e-matrix-transformation">CF2043E Matrix Transformation</h2><p><a href="https://codeforces.com/problemset/problem/2043/E" class="uri">https://codeforces.com/problemset/problem/2043/E</a></p><blockquote><p>ç»™å®š <span class="math inline">\(n\times m\)</span> çš„ <span class="math inline">\(01\)</span> çŸ©é˜µ <span class="math inline">\(A,B\)</span>ï¼Œå¯ä»»æ„å°† <span class="math inline">\(A\)</span> çš„ä¸€è¡Œç½®ä¸º <span class="math inline">\(0\)</span> æˆ–ä¸€åˆ—ç½®ä¸º <span class="math inline">\(1\)</span>ï¼Œé—®æ˜¯å¦èƒ½å°† <span class="math inline">\(A\)</span> å˜æˆ <span class="math inline">\(B\)</span>ã€‚</p></blockquote><p>å‘ç°å¦‚æœ <span class="math inline">\(B\)</span> çš„æŸä¸€è¡Œæ˜¯ <span class="math inline">\(0\)</span>ï¼Œé‚£ä¹ˆä¸ç®¡ <span class="math inline">\(A\)</span> è¿™ä¸€è¡Œæ˜¯ä»€ä¹ˆä¸œè¥¿éƒ½å¯ä»¥é€šè¿‡ä¸€æ¬¡æ“ä½œè®©è¿™ä¸€è¡Œæ»¡è¶³æ¡ä»¶ï¼ˆå½“ç„¶ï¼Œè¦æ±‚è¿™æ­¥æ“ä½œæœ€åè¿›è¡Œï¼‰ã€‚åˆ—ä¹Ÿæ˜¯ç›¸ä¼¼çš„ã€‚</p><p>é‚£ä¹ˆå°±æœ‰ä¸€ä¸ªæ’¤é”€çš„æ€è·¯ï¼Œä» <span class="math inline">\(B\)</span> ä¸­ä¸æ–­åˆ é™¤å…¨ <span class="math inline">\(0\)</span> è¡Œæˆ–å…¨ <span class="math inline">\(1\)</span> åˆ—ï¼Œä¸èƒ½åˆ äº†å°±å¯¹æ¯”äºŒè€…å‰©ä¸‹çš„éƒ¨åˆ†æ˜¯å¦å…¨ç­‰ï¼ˆå› ä¸ºæ­¤æ—¶ä»»ä½•æ“ä½œéƒ½æ˜¯éæ³•çš„ï¼‰ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n, m;        std::cin &gt;&gt; n &gt;&gt; m;        using arr = std::vector&lt;int&gt;;        using brr = std::vector&lt;arr&gt;;        using crr = std::vector&lt;brr&gt;;        brr cn(31, arr(n + 1)), cm(31, arr(m + 1));        crr a(31, brr(n + 1, arr(m + 1))), b(31, brr(n + 1, arr(m + 1)));        for (int i = 1; i &lt;= n; ++i)            for (int j = 1, x; j &lt;= m; ++j) &#123;                std::cin &gt;&gt; x;                for (int k = 0; k &lt; 31; ++k)                    a[k][i][j] = (x &gt;&gt; k) &amp; 1;            &#125;        for (int i = 1; i &lt;= n; ++i)            for (int j = 1, x; j &lt;= m; ++j) &#123;                std::cin &gt;&gt; x;                for (int k = 0; k &lt; 31; ++k) &#123;                    b[k][i][j] = (x &gt;&gt; k) &amp; 1;                    cn[k][i] += b[k][i][j];                    cm[k][j] += !b[k][i][j];                &#125;            &#125;        for (int k = 0; k &lt; 31; ++k) &#123;            std::queue&lt;int&gt; qn, qm;            std::vector&lt;int&gt; tn(n + 1, 1), tm(m + 1, 1);            for (int i = 1; i &lt;= n; ++i)                if (!cn[k][i])                    tn[i] = 0, qn.push(i);            for (int j = 1; j &lt;= m; ++j)                if (!cm[k][j])                    tm[j] = 0, qm.push(j);            for (; !qn.empty() || !qm.empty(); ) &#123;                if (!qn.empty()) &#123;                    int i = qn.front();                    // printf(&quot;delete line %d\n&quot;, i);                    qn.pop();                    for (int j = 1; j &lt;= m; ++j)                        if (!b[k][i][j] &amp;&amp; !--cm[k][j])                            tm[j] = 0, qm.push(j);                &#125;                else &#123;                    int j = qm.front();                    // printf(&quot;delete column %d\n&quot;, j);                    qm.pop();                    for (int i = 1; i &lt;= n; ++i)                        if (b[k][i][j] &amp;&amp; !--cn[k][i])                            tn[i] = 0, qn.push(i);                &#125;            &#125;            for (int i = 1; i &lt;= n; ++i)                if (tn[i])                    for (int j = 1; j &lt;= m; ++j)                        if (tm[j] &amp;&amp; a[k][i][j] != b[k][i][j]) &#123;                            // printf(&quot;k = %d: (%d, %d)\n&quot;, k, i, j);                            goto nosol;                        &#125;        &#125;        std::cout &lt;&lt; &quot;Yes\n&quot;;        continue;    nosol :        std::cout &lt;&lt; &quot;No\n&quot;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="cf2043f-nim">CF2043F Nim</h2><p><a href="https://codeforces.com/contest/2043/problem/F" class="uri">https://codeforces.com/contest/2043/problem/F</a></p><blockquote><p>ç»™å®š <span class="math inline">\(m\)</span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡é—®ä» <span class="math inline">\(a_l\sim a_r\)</span> é€‰éç©ºå­åºåˆ—ä½¿å¾—å¼‚æˆ–å’Œä¸º <span class="math inline">\(0\)</span>ï¼Œé—®å­åºåˆ—æœ€å°é•¿åº¦ã€è¯¥å‰æä¸‹çš„æ–¹æ¡ˆæ•°ã€‚</p></blockquote><p>å‘ç°å­åºåˆ—é—®é¢˜å¯ä»¥ç­‰ä»·ä¸ºèƒŒåŒ…ï¼›èƒŒåŒ…å¯ä»¥åˆå¹¶ï¼ˆå³æŠŠæ•´åŒºé—´æ‹†æˆè‹¥å¹²æ®µåï¼Œä¸¤ä¸¤ä¿¡æ¯å¯ä»¥åˆå¹¶ï¼‰ï¼›<a href="/20231117/#å…³äºèƒŒåŒ…">èƒŒåŒ…å¯ä»¥æ”¾åœ¨åˆ†æ²»ä¸Š</a>ï¼›</p><p>ç”±æ­¤ï¼ŒæŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥æ”¾åœ¨ <span class="math inline">\(a_{1\sim n}\)</span> çš„åˆ†æ²»ä¸Šï¼Œæ¯æ¬¡åªå¤„ç†åœ¨ <span class="math inline">\([l,r]\)</span> é—´ä¸”è·¨è¶Š <span class="math inline">\(mid\)</span> çš„è¯¢é—®å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆã€‚å¤æ‚åº¦ <span class="math inline">\(O(n\cdot v^2\log n)\)</span>ã€‚</p><details><p>ä¸è¦ç”¨æ–¹æ¡ˆæ•°æ˜¯å¦ä¸º <span class="math inline">\(0\)</span> æ¥åˆ¤æ–­æ˜¯å¦æ— è§£ï¼å› ä¸ºæ–¹æ¡ˆæ•°å¯èƒ½æ˜¯ <span class="math inline">\(998244353\)</span> çš„å€æ•°â€¦â€¦</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int siz = 63;const int mod = 998244353;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    struct _ &#123; int l, r, id; &#125;;    std::vector&lt;_&gt; q(m + 1);    std::vector&lt;std::pair&lt;int, long long&gt; &gt; res(m + 1, &#123; inf, 0ll &#125;);    for (int i = 1; i &lt;= m; ++i) &#123;        std::cin &gt;&gt; q[i].l &gt;&gt; q[i].r;        q[i].id = i;    &#125;    std::function&lt;void(int, int, std::vector&lt;_&gt; &amp;q)&gt; calc = [&amp;](int l, int r, std::vector&lt;_&gt; &amp;q) &#123;        if (l == r) &#123;            for (auto [l, r, id] : q)                if (a[l] == 0)                    res[id] = &#123; 0, 1ll &#125;;            return;        &#125;        int mid = (l + r) &gt;&gt; 1;        std::vector&lt;_&gt; ql, qr, qm;        for (; !q.empty(); q.pop_back()) &#123;            if (q.back().r &lt;= mid)                ql.push_back(std::move(q.back()));            else if (q.back().l &gt; mid)                qr.push_back(std::move(q.back()));            else                qm.push_back(std::move(q.back()));        &#125;        calc(l, mid, ql), calc(mid + 1, r, qr);        std::vector&lt;std::vector&lt;int&gt; &gt; f(r - l + 1, std::vector&lt;int&gt; (siz + 1, inf));        std::vector&lt;std::vector&lt;long long&gt; &gt; g(r - l + 1, std::vector&lt;long long&gt; (siz + 1));        f[mid - l][a[mid]] = 1ll, g[mid - l][a[mid]] = 1ll;        for (int i = mid - l - 1; ~i; --i) &#123;            int k = a[i + l];            f[i] = f[i + 1], g[i] = g[i + 1];            if (f[i][k] == 1)                (++g[i][k]) %= mod;            else                f[i][k] = 1, g[i][k] = 1ll;            for (int j = 0, k = a[i + l]; j &lt;= siz; ++j)                if (f[i + 1][j ^ k] + 1 &lt; f[i][j])                    f[i][j] = f[i + 1][j ^ k] + 1, g[i][j] = g[i + 1][j ^ k];                else if (f[i + 1][j ^ k] + 1 == f[i][j])                    (g[i][j] += g[i + 1][j ^ k]) %= mod;        &#125;        f[mid - l + 1][a[mid + 1]] = 1ll, g[mid - l + 1][a[mid + 1]] = 1ll;        for (int i = mid - l + 2; i &lt;= r - l; ++i) &#123;            int k = a[i + l];            f[i] = f[i - 1], g[i] = g[i - 1];            if (f[i][k] == 1)                (++g[i][k]) %= mod;            else                f[i][k] = 1, g[i][k] = 1ll;            for (int j = 0; j &lt;= siz; ++j)                if (f[i - 1][j ^ k] + 1 &lt; f[i][j])                    f[i][j] = f[i - 1][j ^ k] + 1, g[i][j] = g[i - 1][j ^ k];                else if (f[i - 1][j ^ k] + 1 == f[i][j])                    (g[i][j] += g[i - 1][j ^ k]) %= mod;        &#125;        for (auto [ql, qr, id] : qm) &#123;            // printf(&quot;at [%d, %d], mid = %d: ASK [%d, %d]: \n&quot;, l, r, mid, ql, qr);            ql -= l, qr -= l;            if (f[ql][0] &lt; inf)                res[id].first = f[ql][0], res[id].second = g[ql][0];            if (f[qr][0] &lt; res[id].first)                res[id].first = f[qr][0], res[id].second = g[qr][0];            else if (f[qr][0] == res[id].first)                (res[id].second += g[qr][0]) %= mod;            for (int i = 1; i &lt;= siz; ++i) &#123;                // printf(&quot;  %d[%d]: %d(%lld)  |  %d[%d]: %d(%lld)\n&quot;, ql + l, i, f[ql][i], g[ql][i], qr + l, i, f[qr][i], g[qr][i]);                if (f[ql][i] + f[qr][i] &lt; res[id].first)                    res[id].first = f[ql][i] + f[qr][i], res[id].second = g[ql][i] * g[qr][i] % mod;                else if (f[ql][i] + f[qr][i] == res[id].first)                    (res[id].second += g[ql][i] * g[qr][i]) %= mod;            &#125;            if (res[id].first &lt; inf)                res[id].first = (qr - ql + 1) - res[id].first;        &#125;        return;    &#125;;    calc(1, n, q);    for (int i = 1; i &lt;= m; ++i)        if (res[i].first &lt; inf)            std::cout &lt;&lt; res[i].first &lt;&lt; &#39; &#39; &lt;&lt; res[i].second &lt;&lt; &#39;\n&#39;;        else            std::cout &lt;&lt; -1 &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="è´ªç©è“æœˆ">è´ªç©è“æœˆ</h2><p><a href="https://loj.ac/p/6515" class="uri">https://loj.ac/p/6515</a></p><p><em>å·®ä¸å¤šçš„é¢˜ï¼š<a href="https://atcoder.jp/contests/jag2018summer-day2/tasks/jag2018summer_day2_d" class="uri">https://atcoder.jp/contests/jag2018summer-day2/tasks/jag2018summer_day2_d</a>ï¼Œæ³¨æ„åŠ å…¥æ˜¯æŒ‰ä½“ç§¯å•å¢çš„</em></p><p>å‘ç°æ–­ç‚¹ç¡®å®šæ—¶å¯ä»¥èƒŒåŒ… <span class="math inline">\(O(p)\)</span> ç»´æŠ¤æ’å…¥åˆ é™¤ï¼›ä½¿ç”¨ <a href="/20231117/#åŒæ ˆæ¨¡æ‹ŸåŒç«¯é˜Ÿåˆ—">åŒæ ˆæ¨¡æ‹ŸåŒç«¯é˜Ÿåˆ—</a> å°±å¯ä»¥å‡æ‘Š <span class="math inline">\(O(pm)\)</span> å®ç°æ’å…¥åˆ é™¤ã€‚</p><p>å¯¹äºè¯¢é—®ï¼Œå½“ç„¶å¯ä»¥ <span class="math inline">\(O(p^2)\)</span> æšä¸¾æœ€å€¼å†æšä¸¾æ–¹æ¡ˆï¼ˆå³æšä¸¾ä¸€ç«¯çš„è´¡çŒ®ï¼‰ï¼›ä½†å¤æ‚åº¦ä¸å¤ªç¾è§‚ã€‚è€ƒè™‘å€’è¿‡æ¥ï¼Œå…ˆ <span class="math inline">\(O(v)\)</span> æšä¸¾ä¸€ç«¯è´¡çŒ®ï¼Œå†æšä¸¾ã€èƒ½å‡‘å‡º <span class="math inline">\([l,r]\)</span> ä¸­çš„å€¼ã€çš„å¦ä¸€ç«¯çš„è´¡çŒ®ã€‚è¿™æ ·å°±å‘ç°æˆ‘ä»¬æ˜¯åœ¨æ±‚åŒºé—´æœ€å¤§å€¼ï¼›æ¯æ¬¡è¯¢é—®æ—¶æ„å»º ST è¡¨é¢„å¤„ç†å¦ä¸€ç«¯çš„åŒºé—´æœ€å¤§å€¼å³å¯ã€‚</p><p>å¤æ‚åº¦ <span class="math inline">\(O(mq\log q)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int m, mod;    std::cin &gt;&gt; m &gt;&gt; m &gt;&gt; mod;    std::array&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt;, 2&gt; T;    std::array&lt;std::vector&lt;std::vector&lt;long long&gt; &gt;, 2&gt; F;    F[0].emplace_back(mod, -inf), F[1].emplace_back(mod, -inf);    F[0][0][0] = 0ll, F[1][0][0] = 0ll;    for (; m--; ) &#123;        std::string op;        std::cin &gt;&gt; op;        if (op[0] == &#39;I&#39;) &#123;            int v, w;            std::cin &gt;&gt; v &gt;&gt; w, v %= mod;            auto &amp;t = T[op[1] == &#39;G&#39;];            auto &amp;f = F[op[1] == &#39;G&#39;];            t.emplace_back(v, w);            f.emplace_back(f.back());            for (int i = (int)f.size() - 1, j = 0; j &lt; mod; ++j)                if (f[i - 1][(j + mod - v) % mod] + w &gt; f[i][j])                    f[i][j] = f[i - 1][(j + mod - v) % mod] + w;        &#125;        else if (op[0] == &#39;D&#39;) &#123;            auto &amp;t0 = T[op[1] == &#39;G&#39;], &amp;t1 = T[op[1] == &#39;F&#39;];            auto &amp;f0 = F[op[1] == &#39;G&#39;], &amp;f1 = F[op[1] == &#39;F&#39;];            if (t0.empty()) &#123;                t1.erase(t1.begin());                int to = t1.size() / 2;                std::vector&lt;std::pair&lt;int, int&gt; &gt; (t1.begin(), t1.begin() + to).swap(t0);                std::reverse(t0.begin(), t0.end());                std::vector&lt;std::pair&lt;int, int&gt; &gt; (t1.begin() + to, t1.end()).swap(t1);                f0.resize(1), f1.resize(1);                for (auto [v, w] : t0) &#123;                    f0.emplace_back(f0.back());                    for (int i = (int)f0.size() - 1, j = 0; j &lt; mod; ++j)                        if (f0[i - 1][(j + mod - v) % mod] + w &gt; f0[i][j])                            f0[i][j] = f0[i - 1][(j + mod - v) % mod] + w;                &#125;                for (auto [v, w] : t1) &#123;                    f1.emplace_back(f1.back());                    for (int i = (int)f1.size() - 1, j = 0; j &lt; mod; ++j)                        if (f1[i - 1][(j + mod - v) % mod] + w &gt; f1[i][j])                            f1[i][j] = f1[i - 1][(j + mod - v) % mod] + w;                &#125;            &#125;            else                t0.pop_back(), f0.pop_back();        &#125;        else &#123;            int l, r;            std::cin &gt;&gt; l &gt;&gt; r;            auto res(-inf);            std::vector&lt;std::vector&lt;long long&gt; &gt; st(std::__lg(mod) + 1, std::vector&lt;long long&gt; (mod + 1));            st[0] = F[1].back();            for (int j = 1; (1 &lt;&lt; j) &lt;= mod; ++j)                for (int i = 0; i + (1 &lt;&lt; j) - 1 &lt; mod; ++i)                    st[j][i] = std::max(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);            auto ask = [&amp;](int l, int r) &#123;                int k = std::__lg(r - l + 1);                return std::max(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);            &#125;;            for (int j = 0; j &lt; mod; ++j)                if (j &lt;= l)                    res = std::max(res, F[0].back()[j] + ask(l - j, r - j));                else if (l &lt; j &amp;&amp; j &lt;= r)                    res = std::max(&#123; res, F[0].back()[j] + ask(0, r - j), F[0].back()[j] + ask(l + mod - j, mod - 1) &#125;);                else                    res = std::max(res, F[0].back()[j] + ask(l + mod - j, r + mod - j));            std::cout &lt;&lt; std::max(-1ll, res) &lt;&lt; &#39;\n&#39;;        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="apio2025-è½¬æ†">APIO2025 è½¬æ†</h2><p><a href="https://www.luogu.com.cn/problem/P12543" class="uri">https://www.luogu.com.cn/problem/P12543</a></p><p><del>æ€»æœ‰ä¸€å¤©æˆ‘è¦è®©å…¨å¤©ä¸‹çš„æ•°å­¦é¢˜ DP é¢˜å­—ç¬¦ä¸²é¢˜å›¾è®ºé¢˜æ¨¡æ‹Ÿé¢˜æ•°æ®ç»“æ„é¢˜æ€ç»´é¢˜å…¨éƒ¨æ¶ˆå¤±</del></p><p>ä¸è¦æŠŠå®ƒè½¬åŒ–æˆåºåˆ—é—®é¢˜æ¥è€ƒè™‘ï¼è¿™å¯¹è§‚å¯Ÿåˆ°ç»“è®ºæ²¡æœ‰å¥½å¤„ï¼</p><p>è€ƒè™‘ <span class="math inline">\(n=2\)</span> çš„æƒ…å†µï¼Œå½“ä¸”ä»…å½“å‚ç›´æ—¶æœ€ä¼˜ã€‚<span class="math inline">\(n=3\)</span> æ—¶ï¼Œéšä¾¿å›ºå®šå…¶ä¸­ä¸€æ¡çº¿ï¼Œå‘ç°å‰©ä¸‹ä¸¤æ¡çº¿å¦‚æœå¤¹è§’å›ºå®šï¼Œåˆ™ä»£ä»·å›ºå®šï¼›å½“å¤¹è§’å– <span class="math inline">\(90^{\circ}\)</span> æ—¶æœ€ä¼˜ã€‚</p><p>äºæ˜¯çŒœæ˜¯ä¸æ˜¯ä»»æ„ä¸€å¯¹éƒ½è¦å‚ç›´ã€‚è€ƒè™‘æ•°å½’ï¼Œå½“å‰ <span class="math inline">\(2n\)</span> å¯¹ <del>ä¸çŸ¥é“æ€ä¹ˆæ‘†çš„ï¼Œåæ­£å°±æ˜¯</del> æœ€ä¼˜æ—¶ï¼š</p><ul><li>è€ƒè™‘åŠ å…¥ç¬¬ <span class="math inline">\(2n+1\)</span> æ¡ï¼›å‚ç…§ <span class="math inline">\(n=3\)</span> çš„æƒ…å½¢ï¼ŒæŠŠå‰ <span class="math inline">\(2n\)</span> æ¡ä»»æ„ä¸¤ä¸¤é…å¯¹ï¼Œåˆ™ç¬¬ <span class="math inline">\(2n+1\)</span> çš„ä½ç½®å¯¹ä»£ä»·æ²¡æœ‰ä»»ä½•å½±å“ã€‚</li><li>è€ƒè™‘åŠ å…¥ç¬¬ <span class="math inline">\(2n+2\)</span> æ¡ï¼›ç›¸ä¼¼åœ°ï¼Œå®ƒçš„ä½ç½®å¯¹å‰ <span class="math inline">\(2n\)</span> æ¡æ²¡æœ‰ä»»ä½•å½±å“ï¼›æ•…éœ€è¦æœ€å¤§åŒ–å®ƒå’Œç¬¬ <span class="math inline">\(2n+1\)</span> æ¡çš„è´¡çŒ®ã€‚å–å‚ç›´å³å¯ã€‚</li></ul><p>å› æ­¤å¾—åˆ°ä»»æ„ä¸€å¯¹éƒ½è¦å‚ç›´ã€‚å…·ä½“æ€ä¹ˆè°ƒæ•´å‘¢ï¼Ÿé¦–å…ˆä¸‹æ„è¯†æ’åºï¼›é…å¯¹æ–¹å¼å³å°† <span class="math inline">\(i\)</span> ä¸ <span class="math inline">\(\dfrac i+\lfloor \frac n2\rfloor\)</span> é…å¯¹ï¼›å› ä¸ºèƒ½æ„Ÿå—åˆ°è¿™æ ·å½±å“çš„çº¿æ®µæœ€å°‘ã€‚ä¸¥è°¨çš„è¯æ˜å¥½åƒæ²¡çœ‹åˆ°ã€‚</p><details><pre class="cpp"><code>#include&lt;bits/stdc++.h&gt;void energy(int, std::vector&lt;int&gt;);void rotate(std::vector&lt;int&gt;, int);void energy(int n, std::vector&lt;int&gt; a) &#123;    std::vector&lt;int&gt; id(n);    std::iota(id.begin(), id.end(), 0);    std::sort(id.begin(), id.end(), [&amp;](int x, int y) &#123; return a[x] &lt; a[y]; &#125;);    for (int i = 0, j = n / 2; i &lt; n / 2; ++i, ++j)        rotate(&#123; id[j] &#125;, (a[id[i]] + 75000 - a[id[j]]) % 50000);    return;&#125;</code></pre></details><hr /><h2 id="abc407e-most-valuable-parentheses">ABC407E Most Valuable Parentheses</h2><p><a href="https://atcoder.jp/contests/abc407/tasks/abc407_e" class="uri">https://atcoder.jp/contests/abc407/tasks/abc407_e</a></p><p>è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå…¸ï¼ˆå¯æƒœæˆ‘ä¸çŸ¥é“ï¼‰çš„ trickï¼š<a href="/20231117/#è´ªå¿ƒé€‰å–æ‹¬å·åºåˆ—">è´ªå¿ƒæ„é€ æœ€ä¼˜æ‹¬å·åºåˆ—</a>ã€‚</p><p>ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤ï¼Œè´ªå¿ƒé€‰å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n;        std::cin &gt;&gt; n;        std::vector&lt;int&gt; a(2 * n + 1);        for (int i = 1; i &lt;= 2 * n; ++i)            std::cin &gt;&gt; a[i];        long long res = a[1];        std::priority_queue&lt;int&gt; q;        for (int i = 2; i &lt; 2 * n; i += 2) &#123;            q.push(a[i]), q.push(a[i + 1]);            res += q.top(), q.pop();        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> åˆ†æ²» </tag>
            
            <tag> èƒŒåŒ… </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ„é€ ç±»é—®é¢˜çš„å¾ˆå°‘è§£é¢˜æ–¹æ³•</title>
      <link href="/20250518/"/>
      <url>/20250518/</url>
      
        <content type="html"><![CDATA[<p>ç—…æ¯’å¯èƒ½å…·æœ‰è†œç»“æ„ï¼Œä½†ä¸å­˜åœ¨ç”Ÿç‰©è†œç³»ç»Ÿã€‚æ ¸ç³–ä½“æ˜¯å”¯ä¸€æ‰€æœ‰ç»†èƒå‡å«æœ‰çš„ç»†èƒå™¨ï¼Œä½†ç—…æ¯’ä¸­æ— æ ¸ç³–ä½“ã€‚</p><span id="more"></span><p>ç—…æ¯’çš„ä¸»è¦ç»„æˆæ˜¯ <span class="math inline">\(10\%\sim 20\%\)</span> çš„æ ¸é…¸ï¼Œ<span class="math inline">\(60\%\sim 70\%\)</span> çš„è›‹ç™½è´¨å¤–å£³ï¼Œ<span class="math inline">\(&lt;10\%\)</span> çš„ç»“åˆæ°´ï¼Œå¯èƒ½å…·æœ‰é€†è½¬å½•é…¶ã€RNA èšåˆé…¶ã€‚ç—…æ¯’çš„å«æ°´é‡ï¼ˆ<span class="math inline">\(&lt;10\%\)</span>ï¼‰è¿œè¿œå°äºç»†èƒï¼ˆ<span class="math inline">\(70\%\)</span>ï¼‰ã€‚</p><hr /><h2 id="type-iè°ƒæ•´æ³•---1">Type Iï¼šè°ƒæ•´æ³• - 1</h2><p>è™½ç„¶è¯æ˜¯è¿™ä¹ˆè¯´ï¼Œæ„Ÿè§‰è¿™å°±æ˜¯å¹³å¸¸æ­£å¸¸çš„åšé¢˜è·¯å¾„ï¼Œã€æƒ³åšæ³•ã€â€”â€”ã€å‘ç°æœ‰é”…ã€â€”â€”ã€æ‰“è¡¥ä¸ã€ã€‚</p><p>åªæ˜¯å¯èƒ½è¿™æ˜¯åœ¨æé†’ä½ åœ¨æ„é€ é¢˜ä¸­å‘ç°æœ‰é”…ä¸è¦æ€¥ç€æ¢åšæ³•ï¼ˆï¼Ÿï¼‰</p><hr /><h3 id="ä¾‹é¢˜c---stations">ä¾‹é¢˜ï¼šC - Stations</h3><p><a href="https://qoj.ac/problem/1139" class="uri">https://qoj.ac/problem/1139</a></p><p>ä¸€ä¸ªç®€å•çš„æƒ³æ³•æ˜¯ï¼Œå½“å¯ç”¨çš„ç¼–å·èŒƒå›´å¾ˆå¤§æ—¶ï¼Œå¯ä»¥è®°ä¸‹æ¯ä¸ªç‚¹ <span class="math inline">\(u\)</span> çš„ <span class="math inline">\(DFN_u\)</span> å’Œå‡ºæ ˆåºï¼ˆè®°ä¸º <span class="math inline">\(RFN_u\)</span>ï¼‰ï¼Œè¿™æ ·å°±èƒ½è§£å†³æŸ¥è¯¢ï¼›ä½†æ ‡å·æ˜¯ <span class="math inline">\(N^2\)</span> çº§åˆ«çš„ã€‚</p><p>ç°åœ¨æ€è€ƒï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦è®°å½• <span class="math inline">\(RFN_u\)</span> å‘¢ï¼Ÿå› ä¸ºåœ¨è¯¢é—®æ—¶ï¼Œéœ€è¦åˆ¤æ–­ <span class="math inline">\(t\)</span> çš„ä½ç½®ï¼šå¦‚æœåœ¨ <span class="math inline">\(x\)</span> æŸä¸€å„¿å­çš„å­æ ‘å†…ï¼Œç­”æ¡ˆä¸ºè¯¥å„¿å­ï¼›å¦åˆ™ï¼Œç­”æ¡ˆä¸º <span class="math inline">\(fa\)</span>ã€‚å½“ <span class="math inline">\(DFN_t\)</span> æ¯” <span class="math inline">\(u\)</span> æœ€é åçš„å„¿å­ <span class="math inline">\(v\)</span> çš„ <span class="math inline">\(DFN\)</span> è¿˜è¦å¤§æ—¶ï¼Œæ— æ³•åˆ¤æ–­ <span class="math inline">\(t\)</span> åœ¨ <span class="math inline">\(v\)</span> å†…è¿˜æ˜¯åœ¨ <span class="math inline">\(u\)</span> å¤–ã€‚</p><p>æ­¤å¤„æœ‰ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼ˆåŸè°…æˆ‘å®åœ¨æ— æ³•çŒœå‡ºæ˜¯æ€ä¹ˆæƒ³åˆ°çš„ï¼‰ï¼Œå°†æ ‘æŒ‰å¥‡æ•°å±‚ã€å¶æ•°å±‚åˆ†å±‚ï¼Œè®¡æ•°å±‚è®°å½• <span class="math inline">\(DFN\)</span>ï¼Œå¶æ•°å±‚è®°å½• <span class="math inline">\(RFN\)</span>ï¼ˆå…·ä½“åœ°ï¼Œå¥‡æ•°å±‚åœ¨å…¥æ ˆæ—¶ç¼–å·ï¼Œå¶æ•°å±‚åœ¨å‡ºæ ˆæ—¶ç¼–å·ï¼‰ï¼›æ¥ä¸‹æ¥è¿›è¡Œåˆ¤æ–­ï¼ˆæ³¨æ„æˆ‘ä»¬å¹¶ä¸çŸ¥é“ <span class="math inline">\(u\)</span> æ‰€åœ¨å±‚æ•°çš„å¥‡å¶æ€§ï¼‰ï¼š</p><ul><li>è‹¥ä¸å­˜åœ¨ <span class="math inline">\(id_i&gt;id_u\)</span>ï¼Œè¯´æ˜ <span class="math inline">\(id_u\)</span> ä¸º <span class="math inline">\(RFN_u\)</span>ï¼›æ­¤æ—¶ å¯ä»¥åˆ¤æ–­ <span class="math inline">\(t\)</span> æ˜¯å¦ä½äº <span class="math inline">\(u\)</span> å†…ã€‚</li><li>å¦åˆ™ï¼Œ<span class="math inline">\(id_u\)</span> ä¸º <span class="math inline">\(DFN_u\)</span>ã€‚ç”±äºçŸ¥é“ <span class="math inline">\(RFN_v\)</span>ï¼Œå¯ä»¥åˆ¤æ–­ <span class="math inline">\(t\)</span> æ˜¯å¦ä½äº <span class="math inline">\(v\)</span> å†…ã€‚</li></ul><p>å®¹æ˜“è¯æ˜å…¶ä»–ä¸€èˆ¬æƒ…å†µä¹Ÿå¯ä»¥åˆ¤æ–­ <span class="math inline">\(t\)</span> çš„ä½ç½®ã€‚å¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &quot;stations.h&quot;#include &lt;bits/stdc++.h&gt;std::vector&lt;int&gt; label(int n, int k, std::vector&lt;int&gt; u, std::vector&lt;int&gt; v) &#123;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n);    for (int i = 0; i &lt; n - 1; ++i)        g[u[i]].push_back(v[i]), g[v[i]].push_back(u[i]);    std::vector&lt;int&gt; id(n, -1);    int now = 0;    std::function&lt;void(int, int, int)&gt; DFS = [&amp;](int x, int fa, int tag) &#123;        if (tag)            id[x] = now++;        for (auto i : g[x])            if (i != fa)                DFS(i, x, tag ^ 1);        if (!tag)            id[x] = now++;        return;    &#125;;    DFS(0, -1, 1);    return id;&#125;int find_next_station(int s, int t, std::vector&lt;int&gt; c) &#123;    if (c.back() &lt; s) &#123;        int fa = c.front();        if (t &gt; s)            return fa;        for (int i = (int)c.size() - 1; ~i; --i)            if (t &gt;= c[i])                return c[i];        return fa;    &#125;    else &#123;        int fa = c.back();        if (t &lt; s)            return fa;        for (int i = 0; i &lt; (int)c.size() - 1; ++i)            if (t &lt;= c[i])                return c[i];        return fa;    &#125;    // assert(0);    return 114514;&#125;</code></pre></details><hr /><h2 id="type-iiè°ƒæ•´æ³•---2">Type IIï¼šè°ƒæ•´æ³• - 2</h2><p>é¢˜ç›®è¦æ±‚æ„é€ ã€æ°å¥½ä¸º <span class="math inline">\(k\)</span>ã€ï¼Œå¯ä»¥å…ˆä¸çœ‹è¿™ä¸ªé™åˆ¶ï¼Œå¯¹äºå±€é¢æ±‚å‡ºä¸Šç•Œå’Œä¸‹ç•Œï¼Œç„¶åå†çœ‹æ˜¯ä¸æ˜¯ä¸Šä¸‹ç•Œä¸­å…¨éƒ¨ï¼ˆæˆ–å¤§å¤šæ•°ï¼‰éƒ½èƒ½å–åˆ°ï¼Œæ­¤æ—¶æœ‰ä¸¤ä¸ªè·¯å¾„ï¼š</p><ul><li>ç›´æ¥åœ¨æŸä¸ªä¸Šç•Œ / ä¸‹ç•Œå±€é¢ä¸­é€šè¿‡è‹¥å¹²æ­¥æå°æ”¹åŠ¨è°ƒæ•´åˆ°æ°å¥½ä¸º <span class="math inline">\(k\)</span>ï¼›</li><li>é€šè¿‡è¿™ä¸€ç‚¹ä¼˜åŒ– DP çŠ¶æ€ï¼ˆè¿™æ ·å°±å¯ä»¥å¤§é‡å‹ç¼©ã€å¯åˆ°è¾¾å±€é¢ã€è¿™ä¸€ä¿¡æ¯ï¼‰ã€‚è§ <a href="/20250510/#b---miriany-and-matchstick">æ­¤</a>ã€‚</li></ul><hr /><h3 id="ä¾‹é¢˜d---construct-the-binary-tree">ä¾‹é¢˜ï¼šD - Construct the Binary Tree</h3><p><a href="https://codeforces.com/problemset/problem/1311/E" class="uri">https://codeforces.com/problemset/problem/1311/E</a></p><p>é¦–å…ˆä»æ‰¾ä¸Šä¸‹ç•Œçš„è§’åº¦å‡ºå‘ï¼Œå‘ç°é“¾ä¸ºä¸Šç•Œï¼Œå®Œå…¨äºŒå‰æ ‘ä¸ºä¸‹ç•Œã€‚</p><p>é‚£ä¹ˆåªéœ€å…ˆ check <span class="math inline">\(d\)</span> æ˜¯å¦åœ¨è¯¥èŒƒå›´å†…ï¼›å›ºå®šæ ‘æœ€å·¦ä¾§çš„ä¸€æ¡é“¾ï¼Œæ¯æ¬¡æ‹¿èµ°å³ä¸‹è§’çš„ä¸€ä¸ªå¶å­ï¼ˆè¿™æ ·å°±èƒ½<strong>ç»´æŒå®Œå…¨äºŒå‰æ ‘æ€§è´¨</strong>ï¼‰ï¼Œå¦‚æœå¯ä»¥æ’å…¥åˆ°é“¾åº•å°± do soï¼›å¦åˆ™ç”±äºè¿™æ˜¯ä¸ªå·¦è¾¹æŒ‚ç€å•é“¾çš„å®Œå…¨äºŒå‰æ ‘ï¼Œå¯ä»¥è¯æ˜ä½ æƒ³å–çš„ä»»æ„æ·±åº¦éƒ½å¯ä»¥å–åˆ°ï¼Œæš´åŠ›è·³å³å¯ï¼Œä¸”è·³å®Œåå°±æ„é€ å®Œäº†ã€‚</p><p>å¤æ‚åº¦ <span class="math inline">\(O(n)\)</span>ã€‚</p><p><span class="math inline">\(O(nd)\)</span> æ˜¯æ¯æ¬¡å–ç‚¹æ—¶æ‰«ä¸€éå®Œå…¨äºŒå‰æ ‘æ‰¾ä¸€ä¸ªèƒ½è®©å½“å‰ç‚¹æ·±åº¦ <span class="math inline">\(+1\)</span> çš„çˆ¶èŠ‚ç‚¹ã€‚<span class="math inline">\(O(d)\)</span> çš„åšæ³•æ˜¯æ…¢æ…¢æŠŠæ ‘å˜çª„å˜é«˜ï¼Œä¸€æ¬¡è¿˜æ˜¯åª <span class="math inline">\(+1\)</span>ï¼ŒäºŒè€…çš„å¼Šç«¯éƒ½åœ¨äºæ²¡åˆ©ç”¨ã€ä¸Šç•Œä¸ºé“¾ã€å³é“¾å’Œå®Œå…¨äºŒå‰æ ‘çš„ä¼˜ç¾æ€§è´¨ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n, d;        std::cin &gt;&gt; n &gt;&gt; d;        std::vector&lt;int&gt; tag(n + 1), dep(n + 1), cnt(n + 1), fa(n + 1);        int L = 0, R = n * (n - 1) / 2;        for (int i = 1; i &lt;= n; ++i) &#123;            L += std::__lg(i), dep[i] = std::__lg(i);            if (i * 2 &lt;= n)                ++cnt[i], fa[i * 2] = i;            if (i * 2 + 1 &lt;= n)                ++cnt[i], fa[i * 2 + 1] = i;        &#125;        if (L &lt;= d &amp;&amp; d &lt;= R) &#123;            std::cout &lt;&lt; &quot;YES\n&quot;;            int t = 1;            for (int i = 1; i &lt;= n; i *= 2)                tag[i] = 1, t = i;            for (int i = n; i &amp;&amp; L != d; --i)                if (!tag[i]) &#123;                    // printf(&quot;i = %d\n&quot;, i);                    if (L + (dep[t] + 1) - dep[i] &lt;= d) &#123;                        // printf(&quot;L += %d - %d\n&quot;, dep[t] + 1, dep[i]);                        L += (dep[t] + 1) - dep[i];                        --cnt[fa[i]], cnt[i] = 0, ++cnt[t];                        dep[i] = dep[t] + 1, fa[i] = t;                        t = i, tag[i] = 1;                    &#125;                    else &#123;                        for (int j = 1; j &lt;= n; ++j)                            if (cnt[j] != 2 &amp;&amp; L + (dep[j] + 1) - dep[i] == d) &#123;                                fa[i] = j, L = d;                                break;                            &#125;                    &#125;                &#125;            for (int i = 2; i &lt;= n; ++i)                std::cout &lt;&lt; fa[i] &lt;&lt; &#39; &#39;;            std::cout &lt;&lt; &#39;\n&#39;;        &#125;        else &#123;            // printf(&quot;[%d, %d]\n&quot;, L, R);            std::cout &lt;&lt; &quot;NO\n&quot;;        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="type-iiiå¢é‡æ³•-è§„çº¦æ³•">Type IIIï¼šå¢é‡æ³• / è§„çº¦æ³•</h2><p>å¢é‡æ³•ï¼šç±»ä¼¼æ•°å½’ï¼Œå‘ç°å¯ä»¥æ–¹ä¾¿åœ°ä» <span class="math inline">\(n-k\)</span> æ‰©å±•åˆ° <span class="math inline">\(n\)</span>ï¼Œè€ƒè™‘ <span class="math inline">\(n-k\)</span> ç»™ <span class="math inline">\(k\)</span> å¸¦æ¥çš„é™åˆ¶ / æ€§è´¨ï¼Œå°±å¯ä»¥ç±»é€’æ¨åœ°åšäº†ã€‚</p><p>è§„çº¦æ³•ï¼šå‘ç°æŠ æ‰ä¸€ä¸ªå¥½å¤„ç†çš„ <span class="math inline">\(k\)</span> ä¹‹åå¯ä»¥è½¬åŒ–ä¸ºè§„æ¨¡ä¸º <span class="math inline">\(n-k\)</span> çš„å­é—®é¢˜ï¼Œè€ƒè™‘ <span class="math inline">\(k\)</span> ç»™ <span class="math inline">\(n - k\)</span> å¸¦æ¥çš„é™åˆ¶ï¼Œä¹Ÿå¯ä»¥ç±»é€’æ¨åœ°åšã€‚</p><p>å…¶å®çœŸå·®ä¸å¤šå“ˆï¼Œå¹¶ä¸èƒ½è¯´æ˜¯ä¸€æ­£ä¸€åä¹‹ç±»çš„ï¼Œå› ä¸ºæ€ç»´è·¯å¾„çœŸæ²¡å¤ªå·®ã€‚</p><hr /><h3 id="ä¾‹é¢˜ç»å…¸é¢˜">ä¾‹é¢˜ï¼šç»å…¸é¢˜</h3><blockquote><p>ç»™å®šå¤§å°ä¸º <span class="math inline">\(n\)</span> çš„ç«èµ›å›¾ï¼Œ<span class="math inline">\(O(n^2)\)</span> å†…æ±‚å‡ºä¸€æ¡å“ˆå¯†é¡¿è·¯å¾„ã€‚</p><ul><li>ç«èµ›å›¾ï¼šç»™å®Œå…¨å›¾çš„æ¯æ¡è¾¹å®šå‘ã€‚</li><li>å“ˆå¯†é¡¿è·¯å¾„ï¼šç»è¿‡æ¯ä¸ªç‚¹æ°å¥½ä¸€æ¬¡ï¼Œå¯¹è¾¹æ— è¦æ±‚ã€‚</li></ul></blockquote><p>å‡è®¾å·²ç»çŸ¥é“è§„æ¨¡ä¸º <span class="math inline">\(n-1\)</span> çš„å­é—®é¢˜çš„è§£æ³•ï¼Œå¡ä¸€ä¸ªæ–°ç‚¹è¿›å»ï¼Œè€ƒå¯Ÿ <span class="math inline">\(P(n-1)\)</span> ä¸­çš„ <span class="math inline">\(\forall\, u\to v\)</span>ï¼š</p><ul><li>è‹¥åªå­˜åœ¨ <span class="math inline">\(n\to u,n\to v\)</span>ï¼šå¯¹äºè·¯å¾„èµ·ç‚¹ <span class="math inline">\(s\)</span> ä¹Ÿæœ‰ <span class="math inline">\(n\to s\)</span>ï¼ŒæŠŠ <span class="math inline">\(n\)</span> æ·»åŠ åˆ°å¼€å¤´å³å¯ã€‚</li><li>è‹¥åªå­˜åœ¨ <span class="math inline">\(u\to n,v\to n\)</span>ï¼šå¯¹äºè·¯å¾„ç»ˆç‚¹ <span class="math inline">\(t\)</span> ä¹Ÿæœ‰ <span class="math inline">\(t\to n\)</span>ï¼ŒæŠŠ <span class="math inline">\(n\)</span> æ·»åŠ åˆ°æœ«å°¾å³å¯ã€‚</li><li>è‹¥åªå­˜åœ¨ <span class="math inline">\(n\to u,v\to n\)</span>ï¼šå¯¹äºè·¯å¾„èµ·ç‚¹ <span class="math inline">\(s\)</span> ä¹Ÿæœ‰ <span class="math inline">\(n\to s\)</span>ï¼Œå¯¹äºè·¯å¾„ç»ˆç‚¹ <span class="math inline">\(t\)</span> ä¹Ÿæœ‰ <span class="math inline">\(t\to n\)</span>ï¼Œçˆ±åŠ å“ªå„¿å°±åŠ å“ªå„¿ã€‚</li><li>å¦åˆ™ï¼šå­˜åœ¨ <span class="math inline">\(u\to n,n\to v\)</span>ï¼Œçš†å¤§æ¬¢å–œï¼Œå°† <span class="math inline">\(u\to v\)</span> æ”¹ä¸º <span class="math inline">\(u\to n\to v\)</span> å³å¯ã€‚</li></ul><p>ç”±æ­¤å°±å¯ä»¥è§£å†³é—®é¢˜ã€‚</p><hr /><h3 id="ä¾‹é¢˜e---travelling-salesperson">ä¾‹é¢˜ï¼šE - Travelling Salesperson</h3><p><a href="https://www.luogu.com.cn/problem/P6644" class="uri">https://www.luogu.com.cn/problem/P6644</a></p><p>æ³¨æ„æœ¬é¢˜ä¸ºæ— å‘è¾¹ï¼</p><p>ç›¸ä¼¼åœ°ï¼Œå¯¹äº <span class="math inline">\(P(n-1)\)</span>ï¼Œå‡å¦‚å­˜åœ¨ <span class="math inline">\(u\to v\)</span>ï¼Œæ¬²åŠ å…¥ <span class="math inline">\(u\to n\to v\)</span> è®¨è®ºä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li>è‹¥ <span class="math inline">\(P(n - 1)\)</span> ä¸­åªå«æœ‰ä¸€ç§é¢œè‰²çš„è¾¹ï¼šç›´æ¥åŠ å…¥é¦– / å°¾å³å¯ã€‚</li><li>è‹¥å­˜åœ¨ <span class="math inline">\(\color{red}{\to} u\color{red}{\to}v\color{red}{\to}\)</span>ã€<span class="math inline">\(u\color{red}{\to} n\)</span> å’Œ <span class="math inline">\(n\color{red}{\to} v\)</span>ï¼ˆè“è‰²åŒç†ï¼‰ï¼šç›´æ¥åŠ å…¥ï¼Œçš†å¤§æ¬¢å–œã€‚</li><li><p>å…¶ä½™æƒ…å†µï¼Œå°±æ˜¯ <span class="math inline">\(\color{red}{\to} u\color{blue}{\to} v\color{blue}{\to}\)</span> çš„æƒ…å†µäº†ã€‚å®¹æ˜“å‘ç°é™¤äº† <span class="math inline">\(u\color{blue}{\to} n\land n\color{red}{\to} v\)</span> ä¹‹å¤–çš„æƒ…å†µéƒ½å¯ä»¥ç›´æ¥å°†è¾¹åŠ å…¥ã€‚æ•…æ¥ä¸‹æ¥è®¨è®ºè¯¥ç‰¹ä¾‹ã€‚</p><p>æ­¤æ—¶åœ¨ <span class="math inline">\((u,v)\)</span> å¤„æ— æ³•åŠ å…¥ï¼›å°è¯•è€ƒè™‘ç›¸é‚»çš„ç‚¹ã€‚ç”±äºåœ¨ <span class="math inline">\(u\color{blue}{\to} v\)</span> å¤„åˆ‡æ¢é¢œè‰²ï¼Œæ˜“çŸ¥ <span class="math inline">\(u\ne s\)</span>ï¼Œå³ <span class="math inline">\(u\)</span> å­˜åœ¨å‰é©±ï¼ˆè®°ä¸º <span class="math inline">\(p\)</span>ï¼‰ã€‚</p><ul><li>è‹¥å­˜åœ¨ <span class="math inline">\(p\color{blue}{\to} i\)</span>ï¼šè¿æ¥ <span class="math inline">\(p,i,u\)</span>ï¼Œæœ€ç»ˆå±€é¢ä¸º <span class="math inline">\(\color{red}{\to} p\color{blue}{\to} i\color{blue}{\to} u\color{blue}{\to} v\color{blue}{\to}\)</span>ï¼Œå³å°†å˜æ¢å¤„æå‰ä¸¤ä½ã€‚</li><li>å¦åˆ™ï¼šå­˜åœ¨ <span class="math inline">\(p\color{red}{\to} i\)</span>ï¼Œä»ç„¶è¿æ¥ <span class="math inline">\(p,i,u\)</span>ï¼Œæœ€ç»ˆå±€é¢ä¸º <span class="math inline">\(\color{red}{\to} p\color{red}{\to} i\color{blue}{\to} u\color{blue}{\to} v\color{blue}{\to}\)</span>ï¼Œå³å°†å˜æ¢å¤„æå‰ä¸€ä½ã€‚</li></ul></li></ul><p>ç”±æ­¤å¯è§£å†³é—®é¢˜ã€‚å¯ä»¥å‘ç°å¹¶ä¸å­˜åœ¨æ‰€è°“æ— è§£çš„æƒ…å†µ <img src="/em/ll.gif" /> â€”â€” å€’ä¸å¦‚è¯´å¯ä»¥å¯¹æ‰€æœ‰ç‚¹å¥—ç”¨æœ€åä¸€ç§æƒ…å†µï¼ˆå’Œç¬¬ä¸€ç§ï¼‰â€”â€”å°±èƒ½å¤Ÿ <span class="math inline">\(O(n^2)\)</span> è§£å†³åŸé—®é¢˜äº†ã€‚</p><details><p>loj ä¸Šè¿‡äº†ä½†æ´›è°·è¿‡ä¸äº† <img src="/em/kt.gif" /></p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    if (n == 1) &#123;        std::cout &lt;&lt; &quot;1\n1&quot; &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    std::vector&lt;std::vector&lt;char&gt; &gt; g(n + 1, std::vector&lt;char&gt; (n + 1));    for (int i = 2; i &lt;= n; ++i)        for (int j = 1; j &lt; i; ++j)            std::cin &gt;&gt; g[i][j], g[j][i] = g[i][j];    for (int i = 1; i &lt;= n; ++i) &#123;        std::vector&lt;int&gt; tag(n + 1);        std::list&lt;int&gt; p(&#123; i, i == 1 ? 2 : 1 &#125;);        tag[p.front()] = tag[p.back()] = 1;        bool flag = 1;        char R = g[p.front()][p.back()], B = ((R == &#39;R&#39;) ? &#39;B&#39; : &#39;R&#39;);        auto pos = --p.end();        for (int j = 1; j &lt;= n; ++j)            if (!tag[j]) &#123;                if (flag &amp;&amp; g[j][p.back()] == R)                    // printf(&quot;%d: 30  &quot;, j),                    p.push_back(j), ++pos;                else if (g[j][p.back()] == B)                    // printf(&quot;%d: 33  &quot;, j),                    p.push_back(j), flag = 0;                else &#123;                    auto u = pos, v = std::next(pos);                    if (g[*u][j] == R &amp;&amp; g[j][*v] == R) &#123;                        // printf(&quot;%d: 38  &quot;, j),                        p.insert(v, j), ++++pos;                        if (v == --p.end())                            flag = 1;                    &#125;                    else if (g[*u][j] == R &amp;&amp; g[j][*v] == B)                        // printf(&quot;%d: 41  &quot;, j),                        p.insert(v, j), ++pos;                    else if (g[*u][j] == B &amp;&amp; g[j][*v] == B)                        // printf(&quot;%d: 44  &quot;, j),                        p.insert(v, j);                    else &#123;                        auto pr(std::prev(u));                        if (g[*pr][j] == B)                            // printf(&quot;%d: 49  &quot;, j),                            p.insert(u, j), ----pos;                        else                            // printf(&quot;%d: 52  &quot;, j),                            p.insert(u, j), --pos;                    &#125;                &#125;                // for (auto j : p)                //     std::cout &lt;&lt; j &lt;&lt; &#39; &#39;;                // printf(&quot; flag = %d\n&quot;, flag);            &#125;        std::cout &lt;&lt; n &lt;&lt; &#39;\n&#39;;        for (auto j : p)            std::cout &lt;&lt; j &lt;&lt; &#39; &#39;;        std::cout &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="f---sergeys-problem">F - Sergeyâ€™s problem</h3><p><a href="https://codeforces.com/problemset/problem/1019/C" class="uri">https://codeforces.com/problemset/problem/1019/C</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ„é€  </tag>
            
            <tag> è°ƒæ•´æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20250510/"/>
      <url>/20250510/</url>
      
        <content type="html"><![CDATA[<p>å•Šå•Šã€‚å°å°æ¡ã€‚</p><span id="more"></span><hr /><h2 id="a---pass-to-next">A - Pass to Next</h2><p><a href="https://atcoder.jp/contests/arc124/tasks/arc124_e" class="uri">https://atcoder.jp/contests/arc124/tasks/arc124_e</a></p><p>æ„Ÿè§‰å…¶ä»–ä¸€äº›é¢˜è§£è®²å¾—ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šï¼Œè¿™é‡Œå‚è€ƒäº† <a href="https://blog.csdn.net/weixin_43960287/article/details/119140590">XJX çš„æ–‡ç« </a>ã€‚</p><p>è¦æ±‚çš„ç­”æ¡ˆæ˜¯ <span class="math inline">\(\prod a&#39;_i\)</span>ï¼Œ<mark>å‘ç°è¿ç®—æ˜¯ä¹˜æ³•ï¼Œæ¯”è¾ƒæ€ªï¼›ç”±æ­¤è€ƒè™‘è½¬åŒ–ä¸ºæ–¹æ¡ˆæ•°ï¼Œä¹Ÿå°±æ˜¯å‡è®¾æ¯ä¸ªäººæœ‰ <span class="math inline">\(a&#39;_i\)</span> ä¸ªäº’ä¸ç›¸åŒçš„çƒï¼Œæ¯ä¸ªäººåœ¨å…¶ä¸­é€‰å‡ºæ°å¥½ä¸€ä¸ªçš„æ–¹æ¡ˆæ•°</mark>ã€‚</p><p>è€ƒè™‘ DPã€‚å‘ç°æ¯ä¸ªäººæ‰‹ä¸Šçš„çƒåˆ†ä¸ºã€è‡ªå·±çš„ã€å’Œã€å·¦è¾¹çš„äººä¼ è¿‡æ¥çš„ã€ä¸¤ç§ç±»å‹ï¼›<mark>æ˜¾ç„¶ç¬¬äºŒç§ä¼šæœ‰æ¥è‡ªä¸Šä¸€ä¸ªäººçš„é™åˆ¶ï¼Œè€ƒè™‘æŠŠç¬¬äºŒç§åœ¨ä¸Šä¸€ä¸ªäººå°±å®Œæˆæ±‚è§£</mark>ã€‚å…·ä½“åœ°ï¼Œè®¾ <span class="math inline">\(f_{i,0}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> ä¸ªäººé€‰å–è‡ªå·±çš„çƒï¼Œä½†åªè®°å½• <span class="math inline">\(1\sim i-1\)</span> çš„æ–¹æ¡ˆï¼›<span class="math inline">\(f_{i,1}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> ä¸ªäººé€‰å–ç¬¬ <span class="math inline">\(i-1\)</span> ä¸ªäººçš„çƒï¼Œå¹¶è®°å…¥ç­”æ¡ˆçš„æ–¹æ¡ˆã€‚<em>ä½ å¯èƒ½éœ€è¦æ³¨æ„åˆ°ï¼šæœ€åä¸€ä¸ªè¢«è®°å…¥æ–¹æ¡ˆçš„çƒæ¥è‡ªç¬¬ <span class="math inline">\(i-1\)</span> ä¸ªäºº</em>ã€‚</p><p>ä½†è¿™æ ·ä¼šæœ‰ä¸ªå°é—®é¢˜ã€‚æˆ‘ä»¬è®©æ‰€æœ‰äººå¤šå¾€å³è¾¹ä¼ ä¸€ä¸ªçƒï¼Œé‚£ä¹ˆåœ¨æˆ‘ä»¬çš„è¿™ç§åˆ†å‰²æ–¹æ³•çœ‹æ¥æ˜¯ä¸ä¸€æ ·çš„å±€é¢ï¼›ä½†å®é™…ä¸Šå®ƒä»¬æ˜¯ç­‰ä»·çš„ã€‚ä»æ¯ä¸ªäººä¼ å‡ºäº†å¤šå°‘ä¸ªçƒï¼ˆè®¾ä¸º <span class="math inline">\(x_i\)</span>ï¼‰çš„è§’åº¦æ¥çœ‹ï¼Œå¯¹äº <span class="math inline">\(\min\{x_n\}\ne 0\)</span>ï¼Œåªéœ€è¦ä¸æ–­æ‰§è¡Œ <span class="math inline">\(\forall\, x_i\gets x_i-1\)</span> å°±å¯ä»¥åœ¨å±€é¢ä¸å˜çš„æƒ…å†µä¸‹ä½¿ <span class="math inline">\(\min\{x_n\}\ne 0\)</span>ã€‚è¿™æ˜¯åœ¨è¯´ï¼Œå¯ä»¥è®© <span class="math inline">\(\min\{x_n\}\ne 0\)</span> çš„æ–¹æ¡ˆå’Œç»ˆå±€ä¸€ä¸€å¯¹åº”ã€‚</p><p>å‘ç°å¯ä»¥å®¹æ–¥ï¼šé’¦å®š <span class="math inline">\(x_i\ge 1\)</span>ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªäººå¿…é¡»å¾€å³ä¼ è‡³å°‘ä¸€ä¸ªï¼Œç›¸ä¼¼åœ°ç®—ä¸€éå°±èƒ½å¾—åˆ°éæ³•æ–¹æ¡ˆã€‚</p><p>è€ƒè™‘è½¬ç§»ï¼Œä»¤ <span class="math inline">\(x_i\)</span> å¯é€‰æœ€å°å€¼ä¸º <span class="math inline">\(l\)</span>ï¼Œæœ‰ï¼š</p><ul><li><span class="math inline">\(f_{i+1,0}\gets f_{i,0}\)</span>ï¼šå°†ç¬¬ <span class="math inline">\(i\)</span> ä¸ªäººæœªè¢«è®°å…¥çš„è‡ªå·±çš„çƒè®°å…¥ï¼Œçƒæ•°å¯èƒ½ä¸º <span class="math inline">\([0,a_i-l]\)</span>ã€‚ç­‰å·®æ•°åˆ—æ±‚å’Œå³å¯ã€‚</li><li><span class="math inline">\(f_{i+1,0}\gets f_{i,1}\)</span>ï¼šæ²¡æœ‰çƒéœ€è¦è¢«è®°å…¥ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µå¯¹åº”å¤šç§ <span class="math inline">\(x_i\)</span>ã€‚å…·ä½“åœ°ï¼Œ<span class="math inline">\(x_i\in [l,a_i]\)</span>ã€‚å…±æœ‰ <span class="math inline">\(a_i-l+1\)</span> ç§æ–¹æ¡ˆã€‚</li><li><span class="math inline">\(f_{i+1,1}\gets f_{i,0}\)</span>ï¼šå°†ç¬¬ <span class="math inline">\(i\)</span> ä¸ªäººçš„ <span class="math inline">\(a_i\)</span> ä¸ªçƒåˆ†ç»™ <span class="math inline">\(i\)</span> å’Œ <span class="math inline">\(i+1\)</span>ã€‚å…±æœ‰ <span class="math inline">\(x_i\cdot (a_i-x_i)\)</span> ç§å¯èƒ½ï¼Œä¹Ÿå°±æ˜¯ <span class="math inline">\(\left(a_i\cdot \sum_{x_i=l}^{a_i} x_i\right)-\left(\sum_{x_i=l}^{a_i}{x_i}^2\right)\)</span> ç§æ–¹æ¡ˆã€‚</li><li><span class="math inline">\(f_{i+1,1}\gets f_{i,1}\)</span>ï¼šå°†ç¬¬ <span class="math inline">\(i+1\)</span> ä¸ªäººå¾—åˆ°çš„ç¬¬ <span class="math inline">\(i\)</span> ä¸ªäººçš„çƒè®°å…¥ï¼ŒåŒç¬¬ä¸€æ¡ã€‚</li></ul><p>ç ´ç¯ä¸ºé“¾ï¼Œåˆ†åˆ«é’¦å®šç¬¬ä¸€ä¸ªäººæ˜¯ç”¨è‡ªå·±çš„çƒè¿˜æ˜¯ä¸Šä¸€ä¸ªäººçš„çƒæ¥è§£å†³é—®é¢˜ï¼ˆå¿…é¡»å¯¹äºä¸¤ç§å¯èƒ½æ€§åˆ†å¼€è®¡ç®—ï¼›å¦åˆ™å°±ä¸çŸ¥é“ç­”æ¡ˆåº”è¯¥å– <span class="math inline">\(f_{n,0}\)</span> è¿˜æ˜¯ <span class="math inline">\(f_{n,1}\)</span>ï¼‰ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353, inv2 = (mod + 1) &gt;&gt; 1, inv6 = 166374059;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; a(n);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i % n];    auto sum = [&amp;](long long r) &#123;        return r * (r + 1) % mod * inv2 % mod;    &#125;;    auto sum2 = [&amp;](long long r) &#123;        return r * (r + 1) % mod * (2 * r % mod + 1) % mod * inv6 % mod;    &#125;;    std::vector&lt;std::vector&lt;long long&gt; &gt; f0(n, std::vector&lt;long long&gt; (2)), f1(n, std::vector&lt;long long&gt; (2));    auto calc = [&amp;](long long l, std::vector&lt;std::vector&lt;long long&gt; &gt; &amp;f) &#123;        f[0][0] = 1ll;        for (int i = 0; i &lt; n; ++i) &#123;            int j = (i + 1) % n;            f[j][0] = f[i][0] * sum(a[i] - l) % mod;            (f[j][0] += f[i][1] * (a[i] - l + 1)) %= mod;            f[j][1] = f[i][0] * (a[i] * sum(a[i]) % mod - sum2(a[i])) % mod;            (f[j][1] += f[i][1] * sum(a[i]) % mod) %= mod;            // printf(&quot;0, l = %lld, f[%d]: %lld / %lld\n&quot;, l, j, f[j][0], f[j][1]);        &#125;        auto res(f[0][0]);        f.assign(n, std::vector&lt;long long&gt; (2));        f[0][1] = 1ll;        for (int i = 0; i &lt; n; ++i) &#123;            int j = (i + 1) % n;            f[j][0] = f[i][0] * sum(a[i] - l) % mod;            (f[j][0] += f[i][1] * (a[i] - l + 1)) %= mod;            f[j][1] = f[i][0] * (a[i] * sum(a[i]) % mod - sum2(a[i])) % mod;            (f[j][1] += f[i][1] * sum(a[i]) % mod) %= mod;            // printf(&quot;1, l = %lld, f[%d]: %lld / %lld\n&quot;, l, j, f[j][0], f[j][1]);        &#125;        return (res + f[0][1]) % mod;    &#125;;    std::cout &lt;&lt; (calc(0, f0) + mod - calc(1, f1)) % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---ç»¿å®çŸ³ä¹‹å²›">B - ç»¿å®çŸ³ä¹‹å²›</h2><p><a href="https://loj.ac/p/6406" class="uri">https://loj.ac/p/6406</a></p><p>å› ä¸ºåªå…³å¿ƒæœ€ç»ˆçŠ¶æ€ï¼ŒåŸé¢˜å¯ä»¥è½¬åŒ–ä¸ºï¼šå°† <span class="math inline">\(d\)</span> åˆ†æˆ <span class="math inline">\(n\)</span> ä¸ªéè´Ÿæ•´æ•°ï¼Œå‰ <span class="math inline">\(r\)</span> å¤§æ•°ä¹‹å’Œçš„æœŸæœ›ï¼ˆå½“ç„¶ä½ éœ€è¦åŠ ä¸Šåˆå§‹çš„ <span class="math inline">\(r\)</span> ä¸ªï¼‰ã€‚</p><p>å…³äºéè´Ÿæ•´æ•°æ‹†åˆ†ï¼šè®¾ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºå°† <span class="math inline">\(i\)</span> åˆ†æˆ <span class="math inline">\(j\)</span> ä¸ª <strong>éè´Ÿæ•´æ•°</strong> çš„æ–¹æ¡ˆï¼Œé’¦å®šå…¶ä¸­æ°æœ‰ <span class="math inline">\(k\)</span> ä¸ª <strong>æ­£æ•´æ•°</strong> è¿›è¡Œè½¬ç§»ï¼Œç»™è¿™ <span class="math inline">\(k\)</span> ä¸ªæ•°å…ˆåˆ†ä¸€ä¸ª <span class="math inline">\(1\)</span>ï¼Œåˆ™ <span class="math inline">\(f_{i,j}=\sum\limits_{k=0}^{\min(i,j)} C_j^k\cdot f_{i-k,k}\)</span>ã€‚</p><p>å†è®¾ <span class="math inline">\(g_{i,j}\)</span> è¡¨ç¤ºå°† <span class="math inline">\(i\)</span> åˆ†æˆ <span class="math inline">\(j\)</span> ä¸ªéè´Ÿæ•´æ•°çš„æ‰€æœ‰æ–¹æ¡ˆä¸­ã€å‰ <span class="math inline">\(r\)</span> å¤§çš„æ•°ä¹‹å’Œã€‚ç±»ä¼¼åœ°ï¼Œæœ‰ <span class="math inline">\(g_{i,j}=\sum\limits_{k=0}^{\min(i,j)} C_j^k\cdot (g_{i-k,k}+\min(k,r)\cdot f_{i-k,k})\)</span>ã€‚å…¶ä¸­ï¼Œ<span class="math inline">\(\min(k,r)\)</span> çš„æ¥æºæ˜¯ï¼Œåªæœ‰ <span class="math inline">\(k\)</span> ä¸ªæ•°æœ‰å€¼ï¼Œå‰ <span class="math inline">\(r\)</span> å¤§çš„æ•°ä¸€å®šåœ¨è¿™ <span class="math inline">\(k\)</span> ä¸ªæ•°é‡Œé¢ã€‚</p><p>ç­”æ¡ˆä¸º <span class="math inline">\(\dfrac {g_{d,n}}{f_{d,n}}+r\)</span>ï¼Œå¤æ‚åº¦ <span class="math inline">\(O(n^3)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, d, r;    std::cin &gt;&gt; n &gt;&gt; d &gt;&gt; r;    using arr = std::vector&lt;double&gt;;    std::vector&lt;arr&gt; f(d + 1, arr(n + 1)), g(d + 1, arr(n + 1)), C(n + 1, arr(n + 1));    for (int i = 0; i &lt;= n; ++i) &#123;        C[i][0] = 1.;        for (int j = 1; j &lt;= i; ++j)            C[i][j] = C[i - 1][j - 1] + C[i - 1][j];    &#125;    f[0].assign(n + 1, 1.);    for (int i = 1; i &lt;= d; ++i)        for (int j = 1; j &lt;= n; ++j) &#123;            for (int k = 1; k &lt;= i &amp;&amp; k &lt;= j; ++k) &#123;                f[i][j] += C[j][k] * f[i - k][k];                g[i][j] += C[j][k] * (g[i - k][k] + std::min(k, r) * f[i - k][k]);                // printf(&quot;  k = %d, %.0lf + %.0lf\n&quot;, k, C[j][k] * g[i - k][k], std::min(k, r) * f[i - k][k]);            &#125;            // printf(&quot;f[%d][%d] = %.0lf, g[%d][%d] = %.0lf\n&quot;, i, j, f[i][j], i, j, g[i][j]);        &#125;    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(8) &lt;&lt; g[d][n] / f[d][n] + r &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---uddered-but-not-herd-g">C - Uddered but not Herd G</h2><p><a href="https://www.luogu.com.cn/problem/P7296" class="uri">https://www.luogu.com.cn/problem/P7296</a></p><p>ç»™æ¯ä¸ªå­—æ¯åˆ†é…ä¸€ä¸ªæ ‡å· <span class="math inline">\(x\)</span>ï¼Œé‚£ä¹ˆæœ€å°æ®µæ•°å°±æ˜¯ <span class="math inline">\(\sum \left[x_i\ge x_{i+1}\right]\)</span>ã€‚</p><p>è€ƒè™‘çŠ¶å‹å®Œæˆæ˜ å°„æ“ä½œï¼Œä»¤ <span class="math inline">\(f_{s}\)</span> è¡¨ç¤ºç»™æ ‡å· <span class="math inline">\(1\sim |s|\)</span> åˆ†é…å­—æ¯åï¼Œå ç”¨å­—ç¬¦é›† <span class="math inline">\(s\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå°±èƒ½ <span class="math inline">\(O(1)\)</span> å¾—åˆ°è´¡çŒ®â€”â€”åªéœ€é¢„å¤„ç†å‡º <span class="math inline">\(f_{c, s}\)</span> è¡¨ç¤ºåˆ†é…åˆ°å­—æ¯ <span class="math inline">\(c\)</span> æ—¶ï¼Œå·²ç»å…ˆç»™ <span class="math inline">\(s\)</span> ä¸­å­—æ¯åˆ†é…äº†æ›´å°æ ‡å·æ—¶çš„è´¡çŒ®ã€‚</p><p>æ³¨æ„å­—ç¬¦é›†å¤§å°åªæœ‰ <span class="math inline">\(20\)</span>ï¼Œå¯ä»¥ <span class="math inline">\(O(|S|\cdot 2^{|S|})\)</span> è§£å†³é—®é¢˜ï¼Œ<mark>æ³¨æ„åˆ°é¢„å¤„ç†çš„å†…å®¹æ˜¯ç±»é«˜ç»´å‰ç¼€æœ€å€¼çš„å½¢å¼ï¼Œå¯ä»¥é€’æ¨é™ä½å¤æ‚åº¦</mark>ã€‚</p><details><pre data-line="26-28" class="cpp language-cpp"><code data-line="26-28" class="cpp language-cpp">#include &lt;bits/stdc++.h>const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(".in", "r", stdin);    std::freopen(".out", "w", stdout);#endif    int n;    std::string t;    std::cin >> t, n = (int)t.length(), t = "#" + t;    std::vector&lt;int> a, tag(26, -1), s(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        if (tag[t[i] - 'a'] == -1)            tag[t[i] - 'a'] = (int)a.size(), a.push_back(t[i] - 'a');        s[i] = tag[t[i] - 'a'];    &#125;    int m = (int)a.size(), siz = 1 &lt;&lt; m;    std::vector&lt;std::vector&lt;int> > cnt(m, std::vector&lt;int> (m));    for (int i = 1; i &lt; n; ++i)        ++cnt[s[i]][s[i + 1]];    std::vector&lt;std::vector&lt;int> > g(m, std::vector&lt;int> (siz));    for (int i = 0; i &lt; m; ++i)        for (int k = 0; k &lt; m; ++k) // æ³¨æ„è¿™é‡Œç›¸å½“äºæ˜¯é’¦å®šä» k å¤„è½¬ç§»            for (int j = (1 &lt;&lt; k); j &lt; (2 &lt;&lt; k); ++j) // æšä¸¾çš„æ˜¯ k ä½ä¸º 1 çš„æ‰€æœ‰æ•°ï¼›è¿™ä¸¤å±‚å¾ªç¯çš„å¤æ‚åº¦ä¸º O(siz)                g[i][j] = g[i][j ^ (1 &lt;&lt; k)] + cnt[i][k]; // ç›®çš„æ˜¯æ­¤å¤„çš„å†…å­˜è¿ç»­è®¿é—®ä¼˜åŒ–ï¼ŒæŠŠ ^ çœ‹ä½œ - åº”è¯¥å°±èƒ½ç†è§£ä¸ºä»€ä¹ˆç¬¬äºŒç»´æ˜¯è¿ç»­çš„    std::vector&lt;int> f(siz, inf);    f[0] = 1;    for (int i = 1; i &lt; siz; ++i)        for (int j = 0; j &lt; m; ++j)            if ((i >> j) & 1)                f[i] = std::min(f[i], f[i ^ (1 &lt;&lt; j)] + g[j][i]);    std::cout &lt;&lt; f[siz - 1] &lt;&lt; '\n';    return 0;&#125;</code></pre></details><hr /><h2 id="d---min-max-subarrays-p">D - Min Max Subarrays P</h2><p><a href="https://www.luogu.com.cn/problem/P11845" class="uri">https://www.luogu.com.cn/problem/P11845</a></p><p>å…ˆè€ƒè™‘ <span class="math inline">\(01\)</span> åºåˆ—çš„ç­”æ¡ˆï¼šå¦‚æœåºåˆ—ä¸­å­˜åœ¨ç›¸é‚»çš„ <span class="math inline">\(2\)</span> ä¸ª <span class="math inline">\(1\)</span>ï¼Œæ€»èƒ½ä¿è¯æœ€åçš„ä¸€ä¸ªæ˜¯ <span class="math inline">\(1\)</span>ã€‚</p><p>å¦‚æœåºåˆ—ä¸­å­˜åœ¨ <span class="math inline">\(\ge 3\)</span> ä¸ª <span class="math inline">\(1\)</span>ï¼Œå¯ä»¥ç‰ºç‰²å…¶ä¸­çš„ä¸€äº›ä½¿å¾— <span class="math inline">\(2\)</span> ä¸ª <span class="math inline">\(1\)</span> ç›¸é‚»ã€‚</p><p>å½“åºåˆ—ä¸­åªæœ‰ <span class="math inline">\(2\)</span> ä¸ª <span class="math inline">\(1\)</span> æ—¶ï¼Œåªæœ‰å› ä¸ºå‰©ä¸‹çš„ <span class="math inline">\(0\)</span> ä¸å¤ªå¤Ÿï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•éšæ„ã€ä¸Šä¸‹å…¶æ‰‹ã€æ—¶ä¸èƒ½å°† <span class="math inline">\(2\)</span> ä¸ª <span class="math inline">\(1\)</span> æŒªåˆ°ä¸€èµ·ã€‚</p><p>ä»¤ä¸¤ä¸ª <span class="math inline">\(1\)</span> ä¸ºåºåˆ—æœ€å¤§å€¼ä¸æ¬¡å¤§å€¼ï¼Œæš´æœå¤„ç†åºåˆ—é•¿åº¦è¾ƒå°çš„æƒ…å†µï¼Œå‰©ä¸‹çš„ç›´æ¥ç”¨å¥‡å¶æ€§åˆ¤æ–­ä¸¤ä¸ª <span class="math inline">\(1\)</span> å–å“ªä¸ªã€‚</p><hr /><h2 id="a---mst-on-line">A - MST on Line++</h2><p><a href="https://atcoder.jp/contests/arc167/tasks/arc167_c" class="uri">https://atcoder.jp/contests/arc167/tasks/arc167_c</a></p><p>ç›¸å½“äºæŠŠ <span class="math inline">\(a\)</span> æ‰“ä¹±ç„¶åå¤„ç†åŸé—®é¢˜ã€‚è€ƒè™‘æ¯ä¸ª <span class="math inline">\(a_i\)</span> çš„è´¡çŒ®æ¬¡æ•°ã€‚æ¨¡æ‹Ÿ Kruskal è¿è¾¹ï¼Œä»å°åˆ°å¤§æŠŠç‚¹ <span class="math inline">\(a_i\)</span> åŠ å…¥å›¾ï¼Œ<span class="math inline">\(a_i\)</span> å¯ä»¥å‘ <span class="math inline">\(a_{[i-K,i+K]}\)</span> å†…æ‰€æœ‰è¿é€šå—è¿è¾¹ã€‚</p><p>è¿é€šå—æ•°é‡å½“ä¸”ä»…å½“ <span class="math inline">\([i-K,i)\)</span> å†…æœ€é å³çš„ç‚¹å’Œ <span class="math inline">\((i, i+K]\)</span> å†…æœ€é å·¦çš„ç‚¹è·ç¦» <span class="math inline">\(&gt;K\)</span> æ—¶ä¸º <span class="math inline">\(2\)</span>ï¼Œå…¶ä½™æƒ…å†µä¸º <span class="math inline">\(1\)</span>ã€‚</p><p>ä½†è¦æ˜¯ä»è¿™ä¸ªè§’åº¦æƒ³è¿™ä¸ªé¢˜å°±ä¸å¤ªå¥½åšäº†ã€‚æ­£ç¡®çš„æƒ³æ³•åº”è¯¥æ˜¯<mark>æ‹†åˆ†ä¸ºã€è‹¥ <span class="math inline">\([i-K,i)\)</span> ä¸­æœ‰ç‚¹ï¼Œè´¡çŒ®æ¬¡æ•° <span class="math inline">\(+1\)</span>ã€å’Œã€è‹¥ <span class="math inline">\((i,i+K]\)</span> ä¸­æœ‰ç‚¹ <span class="math inline">\(j\)</span> æ»¡è¶³ <span class="math inline">\([j-K,j)\)</span> ä¸­æ— ç‚¹ï¼Œè´¡çŒ®æ¬¡æ•° <span class="math inline">\(+1\)</span>ã€</mark>ã€‚å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œè´¡çŒ®æ¬¡æ•°å°†å‰ <span class="math inline">\(i-1\)</span> å¤§çš„æ•°åˆ†é…è‡³å°‘ä¸€ä¸ªåˆ° <span class="math inline">\([i-K,i)\)</span> ä¸­çš„æ–¹æ¡ˆæ•°ï¼›å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œæšä¸¾ <span class="math inline">\(j\)</span>ï¼Œè´¡çŒ®æ¬¡æ•°ä¸ºå°†å‰ <span class="math inline">\(i-1\)</span> å¤§çš„æ•°åˆ†é…åˆ° <span class="math inline">\(j\)</span> å’Œ <span class="math inline">\([1,j-K)\cup (j, n]\)</span> ä¸­çš„æ–¹æ¡ˆæ•°ã€‚</p><details><p>å®ç°çš„æ—¶å€™åƒä¸‡æ³¨æ„å¾ªç¯å˜é‡æšä¸¾çš„æ˜¯ä½ç½®è¿˜æ˜¯å€¼ï¼ä¸ç„¶ä½ ä¼šè°ƒå¾—å¾ˆç—›è‹¦ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;03-max-01.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::sort(a.begin() + 1, a.end());    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= n; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[n] = qkp(fac[n], mod - 2);    for (int i = n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto A = [&amp;](int n, int m) &#123;        if (n &lt; m)            return 0ll;        return fac[n] * inv[n - m] % mod;    &#125;;    auto C = [&amp;](int n, int m) &#123;        return A(n, m) * inv[m] % mod;    &#125;;    long long res = 0ll;    for (int i = 2; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j)            (res += a[i] * (fac[n - 1] + mod - A(n - 1 - (j - std::max(1, j - k)), i - 1) * fac[n - i] % mod) % mod) %= mod;        for (int j = 2; j &lt;= n; ++j)            (res += a[i] * C(i - 1, i - 2) % mod * C(j - std::max(1, j - k), 1) % mod * A(n - (j - std::max(1, j - k) + 1), i - 2) % mod * fac[n - i] % mod) %= mod;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---existence-counting">B - Existence Counting</h2><p><a href="https://atcoder.jp/contests/arc174/tasks/arc174_e" class="uri">https://atcoder.jp/contests/arc174/tasks/arc174_e</a></p><p>å‘ç°å¯ä»¥åˆ†ç±»è®¨è®ºã€‚å‡è®¾ <span class="math inline">\(a&#39;\)</span> ä¸­ç¬¬ä¸€ä¸ªå¼‚äº <span class="math inline">\(a\)</span> çš„ä½ç½®ä¸º <span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\(x\)</span> åœ¨ <span class="math inline">\(a\)</span> ä¸­ä½ç½®ä¸º <span class="math inline">\(pos_x\)</span>ï¼ˆä¸å­˜åœ¨åˆ™ <span class="math inline">\(pos_x=k+1\)</span>ï¼‰ã€‚ä»¤ <span class="math inline">\(f_i\)</span> ä¸ºè‹¥ <span class="math inline">\(1\sim i-1\)</span> å‡ç›¸åŒï¼Œ<span class="math inline">\(i\)</span> ä½ç½®å¯é€‰çš„é€‰é¡¹æ•°ã€‚åˆ™ <span class="math inline">\(x\)</span> å‡ºç°çš„æ¬¡æ•°ï¼š</p><table><colgroup><col style="width: 25%" /><col style="width: 25%" /><col style="width: 25%" /><col style="width: 25%" /></colgroup><thead><tr class="header"><th style="text-align: center;"></th><th style="text-align: center;"><span class="math inline">\(pos_x&lt;i\)</span></th><th style="text-align: center;"><span class="math inline">\(pos_x=i\)</span></th><th style="text-align: center;"><span class="math inline">\(pos_x&gt;i,i&lt;k\)</span></th></tr></thead><tbody><tr class="odd"><td style="text-align: center;"><span class="math inline">\(x\le a_i\)</span></td><td style="text-align: center;"><span class="math inline">\(1+f_i\cdot A_{n-i}^{k-i}\)</span></td><td style="text-align: center;"><span class="math inline">\(f_i\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\)</span></td><td style="text-align: center;"><span class="math inline">\((f_i-1)\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}+A_{n-i}^{k-i}\)</span></td></tr><tr class="even"><td style="text-align: center;"><span class="math inline">\(x&gt;a_i\)</span></td><td style="text-align: center;"><span class="math inline">\(f_i\cdot A_{n-i}^{k-i}\)</span></td><td style="text-align: center;"><span class="math inline">\(0\)</span></td><td style="text-align: center;"><span class="math inline">\(f_i\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\)</span></td></tr></tbody></table><p>æ•…ï¼Œå¯¹äºä»»æ„ <span class="math inline">\(x\)</span>ï¼Œç­”æ¡ˆä¸ºï¼š</p><p><span class="math display">\[\begin{aligned}&amp;1+\left(\sum_{i=pos_x+1}^k f_i\cdot A_{n-i}^{k-i}\right)+\sum_{i=1}^{pos_x} (f_i-[x&lt; a_i])\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}+[x&lt; a_i]\cdot A_{n-i}^{k-i}\\=&amp;1+\left(\sum_{i=pos_x+1}^k f_i\cdot A_{n-i}^{k-i}\right)+\left(\sum_{i=1}^{pos_x} f_i\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\right)+\sum_{i=1,a_i&gt; x}^{pos_x}A_{n-i}^{k-i}-C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\\\end{aligned}\]</span></p><p>é¢„å¤„ç†å‡º <span class="math inline">\(f_i=\sum\limits_{j=i+1}^k [a_j&lt; a_i]\)</span>ï¼ˆéœ€è¦æ•°æ®ç»“æ„ï¼‰ã€<span class="math inline">\(g_i=\sum\limits_{j=1}^i f_j\cdot A_{n-j}^{k-j}\)</span> å’Œ <span class="math inline">\(h_j=\sum\limits_{j=1}^i f_i\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\)</span>ï¼Œå†ç”¨æ•°æ®ç»“æ„è®¡ç®— <span class="math inline">\(\sum\limits_{i=1,a_i&gt;x}^{pos_x}C_{k-i}^1\cdot A_{n-i-1}^{k-i-1} - A_{n-i}^{k-i}\)</span> å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;int&gt; a(k + 1), p(n + 1, k + 1);    for (int i = 1; i &lt;= k; ++i)        std::cin &gt;&gt; a[i], p[a[i]] = i;    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);    &#123;        fac[0] = inv[0] = 1ll;        for (int i = 1; i &lt;= n; ++i)            fac[i] = fac[i - 1] * i % mod;        auto qkp = [](long long x, int y) &#123;            auto res(1ll);            for (; y; (x *= x) %= mod, y &gt;&gt;= 1)                if (y &amp; 1)                    (res *= x) %= mod;            return res;        &#125;;        inv[n] = qkp(fac[n], mod - 2);        for (int i = n - 1; i; --i)            inv[i] = inv[i + 1] * (i + 1) % mod;    &#125;    auto A = [&amp;](int n, int m) &#123;        if (n &lt; m || m &lt; 0)            return 0ll;        return fac[n] * inv[n - m] % mod;    &#125;;    std::vector&lt;long long&gt; f(k + 1), g(k + 1), h(k + 1);    std::vector&lt;long long&gt; bit(n + 1);    auto lowbit = [](int x) &#123;        return x &amp; -x;    &#125;;    auto add = [&amp;](int x, int v) &#123;        for (; x &lt;= n; x += lowbit(x))            (bit[x] += v) %= mod;        return;    &#125;;    auto ask = [&amp;](int x) &#123;        auto res(0ll);        for (; x; x -= lowbit(x))            (res += bit[x]) %= mod;        return res;    &#125;;    for (int i = 1; i &lt;= n; ++i)        if (p[i] == k + 1)            add(i, 1);    for (int i = k; i; --i)        f[i] = ask(a[i]), add(a[i], 1);    for (int i = 1; i &lt;= k; ++i) &#123;        g[i] = (g[i - 1] + f[i] * A(n - i, k - i)) % mod;        h[i] = (h[i - 1] + f[i] * (k - i) % mod * A(n - i - 1, k - i - 1)) % mod;        // printf(&quot;%d: f = %lld, g = %lld, h = %lld\n&quot;, i, f[i], g[i], h[i]);    &#125;    std::vector&lt;long long&gt; res(n + 1);    bit.assign(n + 1, 0ll);    auto s(0ll);    for (int i = 1; i &lt;= k; ++i) &#123;        // printf(&quot;%d: %lld + %lld + %lld\n&quot;, a[i], 1 + g[k] - g[i], h[i], s - ask(a[i]));        res[a[i]] = (1 + g[k] - g[i] + h[i] + (s - ask(a[i]))) % mod;        res[a[i]] = (res[a[i]] + mod) % mod;        (s += A(n - i, k - i) - (k - i) * A(n - i - 1, k - i - 1)) %= mod;        add(a[i], (A(n - i, k - i) - (k - i) * A(n - i - 1, k - i - 1)) % mod);    &#125;    for (int i = 1; i &lt;= n; ++i)        if (p[i] == k + 1) &#123;            res[i] = (h[k] + (s - ask(i))) % mod;            res[i] = (res[i] + mod) % mod;        &#125;    for (int x = 1; x &lt;= n; ++x)        std::cout &lt;&lt; res[x] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---1-loop-bubble-sort">C - 1 Loop Bubble Sort</h2><p><a href="https://atcoder.jp/contests/arc187/tasks/arc187_c" class="uri">https://atcoder.jp/contests/arc187/tasks/arc187_c</a></p><p>é¦–å…ˆæ˜¯è¢«è€ƒçƒ‚äº†çš„ï¼šå¯¹åºåˆ—è¿›è¡Œä¸€æ¬¡å†’æ³¡æ’åºï¼Œç­‰ä»·äºå°†åºåˆ—åœ¨å‰ç¼€æœ€å¤§å€¼å¤„åˆ†æ®µï¼Œå¹¶å°†å…¶ä»æ®µé¦–ç§»åˆ°æ®µå°¾ï¼›ä¸”æ»¡è¶³æ’åºå‰ä¸ºå‰ç¼€æœ€å¤§å€¼çš„å…ƒç´ ï¼Œæ’åºåä»ä¸ºå‰ç¼€æœ€å¤§å€¼ã€‚</p><p>è€ƒè™‘ç”¨ DP è§£å†³é—®é¢˜ã€‚æ³¨æ„çŠ¶æ€è¦ä» <span class="math inline">\(P\)</span> çš„è§’åº¦å‡ºå‘â€”â€”å‡å¦‚ <span class="math inline">\(Q\)</span> ä¸­ä¸å­˜åœ¨ <span class="math inline">\(-1\)</span>ï¼Œå‘ç°ä¹Ÿéœ€è¦ DPã€‚æ­¤æ—¶å†è®¾è®¡æœ‰å…³ <span class="math inline">\(Q\)</span> çš„çŠ¶æ€å°±å¾ˆæ‰¯æ·¡äº†ï¼Œè€ƒè™‘ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤º <span class="math inline">\(P\)</span> ä¸­ç›´åˆ°ç¬¬ <span class="math inline">\(i\)</span> ä½çš„å‰ç¼€æœ€å¤§å€¼ä¸º <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ã€‚ä¸ºä»€ä¹ˆæŠŠå‰ç¼€æœ€å¤§å€¼ä½œä¸ºçŠ¶æ€å‘¢ï¼Ÿå› ä¸ºå®ƒå¯ä»¥è¡¨ç¤ºåˆ†æ®µï¼›åŒæ—¶é™åˆ¶æ®µé—´æ•°çš„å–å€¼ã€‚å…·ä½“åœ°ï¼Œè€ƒè™‘è½¬ç§»ï¼š</p><ol type="1"><li>è‹¥ä»¤ <span class="math inline">\(P_i=j\)</span>ï¼Œåˆ™åœ¨ <span class="math inline">\(i\)</span> å¤„åˆ†æ®µã€‚å¯¹åº”åˆ° <span class="math inline">\(Q\)</span> ä¸­ï¼Œ<span class="math inline">\(i-1\)</span> ä½æ˜¯ä¸Šä¸€ä¸ªå‰ç¼€æœ€å¤§å€¼ï¼Œé‚£ä¹ˆè¿™è¦æ±‚ <span class="math inline">\(Q_{i-1}&lt;j\)</span>ï¼Œä¸” <span class="math inline">\(Q_{i-1}\)</span> æ˜¯ä¸€ä¸ªå‰ç¼€æœ€å¤§å€¼ã€‚ä¹Ÿå³ï¼šå½“ <span class="math inline">\(Q_{i-1}\ne -1\)</span> æ—¶ï¼Œ<span class="math inline">\(f_{i,j}\gets f_{i-1, Q_{i-1}}\)</span>ï¼›å¦åˆ™ï¼Œ<span class="math inline">\(f_{i,j}\gets \sum\limits_{k&lt;j} f_{i-1,k}\)</span>ã€‚å…¶ä¸­ï¼ŒäºŒå¼éƒ½è¦æ±‚è½¬ç§»æ¥æºä¸ºå‰ç¼€æœ€å¤§å€¼ã€‚</li><li>è‹¥ä»¤ <span class="math inline">\(P_i&lt;j\)</span>ï¼Œåˆ™ <span class="math inline">\(i\)</span> åœ¨ <span class="math inline">\(Q\)</span> ä¸­æ°å¥½å‰ç§»ä¸€ä½ï¼Œå³ <span class="math inline">\(Q_{i-1}=P_i&lt;j\)</span>ã€‚åˆ™å½“ <span class="math inline">\(Q_{i-1}\ne -1\)</span> æ—¶ï¼Œè¯¥ä½ç¡®å®šï¼Œ<span class="math inline">\(f_{i,j}\gets f_{i-1,j}\)</span>ï¼›å¦åˆ™ï¼Œ<span class="math inline">\(Q_{i-1}\)</span> å¯é€‰çš„å€¼ä¸º <span class="math inline">\(&lt;j\)</span> çš„æ‰€æœ‰æœªé€‰æ•°ï¼ˆå®šå€¼ï¼Œå¯é¢„å¤„ç†ï¼‰ã€‚</li></ol><p>å…³äºåˆå€¼ï¼Œå¯ä»¥åœ¨ <span class="math inline">\(P\)</span> å‰åŠ ä¸€ä¸ª <span class="math inline">\(0\)</span> ä½œä¸ºæ’åˆ—çš„ä¸€éƒ¨åˆ†ï¼ˆé‚£ä¹ˆæŒ‰ç…§å†’æ³¡æ’åºçš„è§„åˆ™ <span class="math inline">\(Q\)</span> çš„ç¬¬ä¸€ä½ä¹Ÿä¸€å®šæ˜¯ <span class="math inline">\(0\)</span>ï¼‰æ¥å¤„ç†å°±å¥½äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; q(n + 1), t(n + 1), c(n + 1), pos(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; q[i], c[i] = c[i - 1];        if (q[i] == -1)            ++c[i];        else            pos[q[i]] = i;    &#125;    for (int i = 1; i &lt; n; ++i) &#123;        // printf(&quot;t[%d] = %d\n&quot;, i, t[i]);        if (!pos[i])            for (int j = i + 1; j &lt;= n; ++j)                ++t[j];    &#125;    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (n + 1)), s(n + 1, std::vector&lt;long long&gt; (n + 1));    f[0][0] = 1ll;    s[0].assign(n + 1, 1ll);    for (int i = 1; i &lt;= n; ++i)        for (int j = 1; j &lt;= n; ++j) &#123;            if (q[i - 1] == -1)                f[i][j] = (s[i - 1][j - 1] + f[i - 1][j] * std::max(0, 1 + t[j] - c[i - 1])) % mod;            else if (q[i - 1] &lt; j)                f[i][j] = (f[i - 1][q[i - 1]] + f[i - 1][j]) % mod;            s[i][j] = s[i][j - 1];            if (q[i] == j || !pos[j]) // æ»¡è¶³å‰ç¼€æœ€å¤§å€¼                (s[i][j] += f[i][j]) %= mod;            // printf(&quot;f[%d][%d] = %lld\n&quot;, i, j, f[i][j]);        &#125;    std::cout &lt;&lt; f[n][n] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="f---1.-intro">(F - 1). Intro</h2><blockquote><p>ç»™å®šä¸€ä¸ªå¤§å°ä¸º <span class="math inline">\(n\)</span> çš„æ ‘ï¼Œç‚¹æœ‰ç‚¹æƒã€‚ç»™å®š <span class="math inline">\(q\)</span> æ¬¡æ“ä½œï¼Œåˆ†ä¸ºä¸¤ç§ï¼š</p><ol type="1"><li><code>1 x</code>ï¼šæŸ¥è¯¢ <span class="math inline">\(x\)</span> çš„ç‚¹æƒã€‚</li><li><code>2 x d v</code> å¯¹äºæ‰€æœ‰è· <span class="math inline">\(x\)</span> ä¸è¶…è¿‡ <span class="math inline">\(d\)</span> çš„ç‚¹ï¼Œå°†å®ƒä»¬çš„æƒå€¼åŠ ä¸Š <span class="math inline">\(v\)</span>ã€‚</li></ol><p><span class="math inline">\(n,q\le 10^5,d\le 20\)</span>ã€‚</p></blockquote><p>ç”±äº <span class="math inline">\(d\)</span> å¾ˆå°ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æšä¸¾ä¸ <span class="math inline">\(x\)</span> è·ç¦» <span class="math inline">\(0\sim d\)</span> çš„ç‚¹è¿›è¡Œä¿®æ”¹ï¼›é‚£ä¹ˆå¯¹è·ç¦» <span class="math inline">\(x\)</span> ä¸º <span class="math inline">\(i\)</span> çš„ç‚¹çš„æ›´æ”¹å­˜å‚¨åœ¨ <span class="math inline">\(f_{x,i}\)</span>ï¼ŒæŸ¥è¯¢ <span class="math inline">\(v\)</span> æ—¶å°±å¯ä»¥ä» <span class="math inline">\(\sum\limits_i f_{fa(v,i),i}\)</span> æ±‚å¾—ç­”æ¡ˆã€‚</p><p>è€ƒè™‘ä¿®æ”¹ã€‚è®° <span class="math inline">\(S_{x,d}\)</span> ä¸ºè· <span class="math inline">\(x\)</span> ä¸º <span class="math inline">\(d\)</span> çš„ç‚¹é›†ã€‚<span class="math inline">\(x\)</span> å­æ ‘å†…æ˜¯å¥½å¤„ç†çš„ï¼Œä½†å­æ ‘å¤–çš„å‘¢ï¼Ÿå‘ç° <span class="math inline">\(S_{fa,d-1}\)</span> ä¸­ <span class="math inline">\(x\)</span> å­æ ‘å¤–çš„ç‚¹ï¼Œå°±æ˜¯ <span class="math inline">\(fa\)</span> å­æ ‘ä¸‹ã€<span class="math inline">\(x\)</span> å­æ ‘å¤–è·ç¦» <span class="math inline">\(x\)</span> ä¸º <span class="math inline">\(d\)</span> çš„æ‰€æœ‰ç‚¹ã€‚</p><p>ç”±äºæ‰€æœ‰ <span class="math inline">\(S_{fa(x,i),d-i}\)</span> æ— äº¤ï¼Œè¿™å¯èƒ½æ»¡è¶³æˆ‘ä»¬æ¯ä¸ªå¾…æ“ä½œç‚¹è¢«ä¸é‡ä¸æ¼åŠ ä¸€æ¬¡çš„è¦æ±‚ã€‚è€ƒè™‘å°†æ‰€æœ‰ <span class="math inline">\(S_{fa(x,i),d-i}\)</span> æ ‡è®°å‡ºæ¥ï¼š</p><figure><img src="1.png" alt="ç²‰è‰²è™šçº¿æ¡†æ˜¯å¾…æ“ä½œç‚¹é›†" /><figcaption>ç²‰è‰²è™šçº¿æ¡†æ˜¯å¾…æ“ä½œç‚¹é›†</figcaption></figure><p>ç„¶åæˆ‘ä»¬å¯ä»¥ä¸€çœ¼å‘ç°è¢«å‰çš„ç‚¹å’Œæœªè¢«å‰çš„å¾…æ“ä½œç‚¹æ˜¯äº¤é”™çš„ï¼è¿™æ„å‘³ç€æˆ‘ä»¬åªéœ€è¦å†è¡¥å……ä¸Šæ‰€æœ‰ <span class="math inline">\(S_{fa(x,i),d-i-1}\)</span> å³å¯ï¼ˆæ˜¾ç„¶å®ƒä»¬ä¹‹é—´ã€å®ƒä»¬å’Œæ‰€æœ‰ <span class="math inline">\(S_{fa(x,i),d-i}\)</span> ä¹‹é—´éƒ½ä¸äº¤ï¼‰ã€‚</p><figure><img src="2.png" alt="è™šçº¿å‰ä¸º S_{fa(x,i),d-i-1}" /><figcaption>è™šçº¿å‰ä¸º <span class="math inline">\(S_{fa(x,i),d-i-1}\)</span></figcaption></figure><p>æ­¤æ—¶å°±å¯ä»¥ä¸é‡ä¸æ¼ã€‚å½“ç„¶ï¼Œä¹Ÿä¼šå­˜åœ¨ä¸€äº›ç»†èŠ‚ï¼šæ¯”å¦‚è¯´ <span class="math inline">\(fa(x,i)\)</span> ä¸å­˜åœ¨ä¹‹ç±»ã€‚åªéœ€è¦åœ¨æ ¹èŠ‚ç‚¹ <span class="math inline">\(1\)</span> å¤„å°†å‰©ä½™çš„ <span class="math inline">\(S_{1,i\to 0}\)</span> å…¨éƒ¨æ›´æ–°å³å¯ã€‚</p><p>æ•…æ¯æ¬¡ä¿®æ”¹æ“ä½œåªéœ€è¦ä¿®æ”¹ <span class="math inline">\(O(d)\)</span> å¨ç‚¹ã€‚æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(qd)\)</span>ã€‚</p><hr /><h2 id="f.-distance-to-the-path">F. Distance to the Path</h2><p><a href="https://codeforces.com/problemset/problem/1749/F" class="uri">https://codeforces.com/problemset/problem/1749/F</a></p><p>æœ¬ä¾‹ä¸­å°†å•ç‚¹ä¿®æ”¹æ›¿æ¢ä¸ºè·¯å¾„ä¿®æ”¹ï¼›è€ƒè™‘æ ‘å‰–è§£å†³é—®é¢˜ã€‚</p><p>å¯¹äºè·¯å¾„ä¸Šçš„æ‰€æœ‰ç‚¹ <span class="math inline">\(u\)</span>ï¼Œå®¹æ˜“å‘ç°åªéœ€è¦ä¿®æ”¹æ‰€æœ‰çš„ <span class="math inline">\(S_{u,d}\)</span> å°±å¯ä»¥å®Œæˆå¯¹ã€<strong>ä¸€éƒ¨åˆ†è·¯å¾„å†…ä¾§çš„ç‚¹</strong>ã€çš„ä¿®æ”¹ã€‚è¿™ã€ä¸€éƒ¨åˆ†ã€ï¼Œæ˜¯å› ä¸ºä¸åŒ…æ‹¬è·ç¦» LCA <span class="math inline">\(\le d\)</span> çš„ç‚¹ã€‚</p><p>è€Œã€<strong>å¦ä¸€éƒ¨åˆ†è·¯å¾„å†…ä¾§çš„ç‚¹</strong>ï¼ˆè· LCA <span class="math inline">\(\le d\)</span>ï¼šè§ä¸Šä¸€è¡Œè¯´æ˜ï¼‰ã€åŠã€<strong>è·¯å¾„å¤–ä¾§çš„ç‚¹</strong>ï¼ˆè· LCA <span class="math inline">\(\le d\)</span>ï¼šå› ä¸ºè·¯å¾„åœ¨ LCA å­æ ‘å†…ï¼ŒLCA èƒ½å¤Ÿåˆ°æœ€è¿œçš„å¤–ä¾§ç‚¹ï¼‰ã€ï¼Œç­‰ä»·äºã€<strong>è· LCA <span class="math inline">\(\le d\)</span> çš„ç‚¹</strong>ã€ï¼Œåªéœ€è¦æŠŠ LCA ä»£å…¥ä¸Šä¾‹ä¸­æ–¹å¼ä¿®æ”¹å³å¯ã€‚</p><p>ä¿®æ”¹è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹ <span class="math inline">\(u\)</span> çš„ <span class="math inline">\(S_{u,d}\)</span> æ—¶ï¼Œå¯ä»¥å¯¹æ‰€æœ‰ <span class="math inline">\(f_{*,i}\)</span> å»ºç«‹æ•°æ®ç»“æ„ï¼Œç”±äºåªéœ€è¦åŒºé—´ä¿®æ”¹ã€å•ç‚¹æŸ¥è¯¢ï¼Œä½¿ç”¨å·®åˆ†æ ‘çŠ¶æ•°ç»„å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt; int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int&gt; siz(n + 1), dep(n + 1), fa(n + 1), son(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int faa) &#123;        siz[x] = 1;        for (auto i : g[x])            if (i != faa) &#123;                fa[i] = x, dep[i] = dep[x] + 1;                DFS(i, x);                siz[x] += siz[i];                if (siz[i] &gt; siz[son[x]])                    son[x] = i;            &#125;        return;    &#125;;    DFS(1, -1);    std::vector&lt;int&gt; dfn(n + 1), top(n + 1);    DFS = [&amp;](int x, int toop) &#123;        static int now = 0;        dfn[x] = ++now, top[x] = toop;        if (son[x])            DFS(son[x], toop);        for (auto i : g[x])            if (i != fa[x] &amp;&amp; i != son[x])                DFS(i, i);        return;    &#125;;    DFS(1, 1);    std::vector&lt;std::vector&lt;long long&gt; &gt; bit(21, std::vector&lt;long long&gt; (n + 1));    auto lowbit = [&amp;](int x) &#123;        return x &amp; -x;    &#125;;    auto add = [&amp;](auto &amp;bit, int x, int v) &#123;        for (; x &lt;= n; x += lowbit(x))            bit[x] += v;        return;    &#125;;    auto ask = [&amp;](auto &amp;bit, int x) &#123;        auto res(0ll);        for (; x; x -= lowbit(x))            res += bit[x];        return res;    &#125;;    std::cin &gt;&gt; m;    for (int op; m--; ) &#123;        std::cin &gt;&gt; op;        if (op == 1) &#123;            int x;            std::cin &gt;&gt; x;            auto res(0ll);            for (int i = 0; i &lt;= 20 &amp;&amp; x; ++i, x = fa[x])                res += ask(bit[i], dfn[x]);            std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;        &#125;        else &#123;            int x, y, v, d;            std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; v &gt;&gt; d;            for (; top[x] != top[y]; x = fa[top[x]]) &#123;                if (dep[top[x]] &lt; dep[top[y]])                    std::swap(x, y);                add(bit[d], dfn[top[x]], v);                add(bit[d], dfn[x] + 1, -v);            &#125;            if (dep[x] &gt; dep[y])                std::swap(x, y);            add(bit[d], dfn[x] + 1, v), add(bit[d], dfn[y] + 1, -v);            for (x = x, y = d; ~y &amp;&amp; x; x = fa[x], --y) &#123;                add(bit[y], dfn[x], v), add(bit[y], dfn[x] + 1, -v);                if (y &amp;&amp; fa[x])                    add(bit[y - 1], dfn[x], v), add(bit[y - 1], dfn[x] + 1, -v);            &#125;            if (x == 0)                for (; ~y; --y)                    add(bit[y], dfn[1], v), add(bit[y], dfn[1] + 1, -v);        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="a---ina-of-the-mountain">A - Ina of the Mountain</h2><p><a href="https://codeforces.com/problemset/problem/1852/C" class="uri">https://codeforces.com/problemset/problem/1852/C</a></p><p>è€ƒè™‘è¿™ä¹ˆä¸€ä¸ªç®€åŒ–ç‰ˆçš„é—®é¢˜ï¼š</p><blockquote><p>ç»™å®š <span class="math inline">\(\{a_n\}\)</span>ï¼Œæ¯æ¬¡å¯ä»¥è¿›è¡ŒåŒºé—´ <span class="math inline">\(-1\)</span>ï¼Œé—®æ“ä½œå¤šå°‘æ¬¡æ‰èƒ½å°†æ‰€æœ‰å…ƒç´ å˜ä¸º <span class="math inline">\(0\)</span>ã€‚</p></blockquote><p>ä¼šæƒ³åˆ°å·®åˆ†ï¼›å¯¹åŸæ•°ç»„è¿›è¡Œå·®åˆ†ï¼Œä¸€æ¬¡æ“ä½œç›¸å½“äºä»¤ <span class="math inline">\(d_l\gets d_l-1\)</span> è€Œ <span class="math inline">\(d_{r+1}\gets d_{r+1}+1\)</span>ï¼Œæœ€åè¦è®© <span class="math inline">\(\forall \,d_i=0\)</span>ã€‚é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯å·®åˆ†æ•°ç»„ä¸­æ­£æ•°ä¹‹å’Œå˜›ã€‚</p><p>å›åˆ°åŸé—®é¢˜ã€‚åŸé—®é¢˜ç­‰ä»·äºæŠŠä¸Šè¿°é—®é¢˜å˜ä¸ºï¼š</p><blockquote><p>ç»™å®š <span class="math inline">\(\{a_n\}\)</span>ï¼Œæ¯æ¬¡å¯ä»¥è¿›è¡ŒåŒºé—´ <span class="math inline">\(-1\)</span>ï¼Œæ¯ä¸ªæ•°çš„æ€»æ“ä½œæ¬¡æ•°å¯¹ <span class="math inline">\(k\)</span> å–æ¨¡ï¼Œé—®æ“ä½œå¤šå°‘æ¬¡æ‰èƒ½å°†æ‰€æœ‰å…ƒç´ å˜ä¸º <span class="math inline">\(0\)</span>ã€‚</p></blockquote><p>æ€ä¹ˆå¥—å›åˆ°åˆšåˆšçš„é—®é¢˜ä¸Šå‘¢ï¼Ÿè¿˜åŸè¢«å–æ¨¡æ‰çš„æ“ä½œå³å¯ã€‚å…·ä½“æ¥è¯´ï¼Œæå‰åœ¨ <span class="math inline">\(d\)</span> ä¸Šè¿›è¡Œè‹¥å¹²æ¬¡æ“ä½œï¼ˆè®°ä¸ºæ“ä½œ 1ï¼‰ï¼Œå½¢å¦‚ä»¤ <span class="math inline">\(d_i\gets d_i+k\)</span>ï¼ŒåŒæ—¶ <span class="math inline">\(d_{i+1}\gets d_{i+1}-k\)</span>ã€‚</p><p>ä¼šå‘ç°ç›¸é‚»çš„æ“ä½œ <span class="math inline">\(1\)</span> å¯¹ä¸€ä¸ªæ•°åŠ åŠ å‡å‡å½±å“åˆ¤æ–­ï¼›å‘ç°å¯ä»¥åˆå¹¶ä¸€æ®µè¿ç»­çš„æ“ä½œ 1ï¼Œè¡¨ç°åœ¨ <span class="math inline">\(a\)</span> ä¸Šä¹Ÿå°±æ˜¯åŒºé—´ <span class="math inline">\(+k\)</span>ã€‚æ­¤æ—¶å¯ä»¥å‘ç°ï¼Œä¸€ä¸ªä½ç½®ä¸Šåªä¼šå‰©ä¸‹è‹¥å¹²æ¬¡ <span class="math inline">\(+k\)</span> æˆ–è‹¥å¹²æ¬¡ <span class="math inline">\(-k\)</span> ï¼ˆå¦åˆ™å¯ä»¥æŠŠ <span class="math inline">\(+k\)</span> å’Œ <span class="math inline">\(-k\)</span> ä»£è¡¨çš„ä¸åŒæ“ä½œåˆå¹¶ï¼‰ï¼Œå°±ä¸ä¼šæœ‰äº’ç›¸å½±å“ä¸€è¯´äº†ã€‚è¿™ä¹Ÿæ˜¯æœ‰çš„é¢˜è§£è¯´å¯ä»¥æå‰åœ¨ <span class="math inline">\(a\)</span> ä¸ŠåŒºé—´ <span class="math inline">\(+k\)</span> çš„åŸå› ã€‚</p><p>æ­¤æ—¶é—®é¢˜å˜ä¸ºåœ¨ <span class="math inline">\(d\)</span> è¿›è¡Œä»»æ„æ¬¡å‰åŠ  <span class="math inline">\(k\)</span> åå‡ <span class="math inline">\(k\)</span> çš„æ“ä½œï¼Œä½¿å¾— <span class="math inline">\(\sum\limits_{d_i&gt;0}d_i\)</span> æœ€å¤§åŒ–ã€‚é‚£ä¹ˆæ˜¾ç„¶å¦‚æœè¦ä½¿ä»£ä»·æ›´å°ï¼Œåªå¯èƒ½åœ¨åŸæœ¬ <span class="math inline">\(&lt;0\)</span> çš„ä½ç½®åšåŠ æ³•ã€<span class="math inline">\(&gt;0\)</span> çš„ä½ç½®åšå‡æ³•ï¼ˆå…¶ä»–æƒ…å†µä¼šå‘ç°ä¸€å®šä¸ä¼˜ï¼‰ã€‚è€ƒè™‘ä¸¤ä¸ªæ•° <span class="math inline">\(d_l,d_r\)</span>ï¼Œå¯ä»¥æ„Ÿå—åˆ°å¯¹äºä¸€ä¸ª <span class="math inline">\(r\)</span>ï¼Œé€‰æœ€å°çš„ <span class="math inline">\(d_l\)</span> æ˜¯æœ€ä¼˜çš„ï¼Œä½†ä»€ä¹ˆæ—¶å€™åº”è¯¥é€‰å‘¢ï¼Ÿ</p><ul><li><span class="math inline">\(d_l\le -k,d_r\ge k\)</span>ï¼šå½“ç„¶å¯é€‰ï¼Œ<span class="math inline">\(k\)</span> è¢«å®Œå…¨åˆ©ç”¨ï¼Œç­”æ¡ˆå‡å°‘ <span class="math inline">\(k\)</span>ã€‚</li><li><p><span class="math inline">\(d_l&gt;-k,d_r\ge k\)</span>ï¼šæ­¤æ—¶ <span class="math inline">\(k\)</span> æœªè¢«å®Œå…¨åˆ©ç”¨ï¼Œä½†å¿…é¡»é€‰ï¼šé€‰æ‹©å…¶ä»–æ›´å¤§çš„æ•°ï¼Œ<span class="math inline">\(k\)</span> çš„åˆ©ç”¨ç‡åªä¼šæ›´ä½ï¼›å¦‚æœä¸é€‰ï¼Œç­”æ¡ˆä¹Ÿæ— æ³•å‡å°‘ã€‚</p><p>Qï¼šæ­¤æ—¶æ˜¯å¦éœ€è¦å°è¯•æ‰¾åˆ°ä¸€ä¸ª <span class="math inline">\(l&#39;&lt;l\)</span> ä¸ <span class="math inline">\(l\)</span> åšæ“ä½œï¼Œä½¿å¾— <span class="math inline">\(l\)</span> é‡æ–°å˜ä¸ºè´Ÿæ•°å‘¢ï¼Ÿ</p>Aï¼šå¦ã€‚å› ä¸ºä½ å¯ä»¥å°†è¿™ä¸¤æ¬¡æ“ä½œåˆå¹¶ï¼Œå‘ç°ç›¸å½“äºæ˜¯ç›´æ¥å¯¹ <span class="math inline">\((l&#39;,r)\)</span> åšæ“ä½œï¼Œæ˜¯æ›´åŠ£çš„ã€‚</li><li><span class="math inline">\(d_l\le -k,d_r&lt;k\)</span>ï¼šæ­¤æ—¶ <span class="math inline">\(k\)</span> æœªè¢«å®Œå…¨åˆ©ç”¨ï¼Œ<span class="math inline">\(d_r\)</span> æˆä¸ºè´Ÿæ•°ã€‚è¿™æ„å‘³ç€ <span class="math inline">\(d_r\)</span> å°†ä¼šæˆä¸ºæŸä¸ª <span class="math inline">\(r&#39;\)</span> çš„å¯é€‰é¡¹ã€‚è€ƒå¯Ÿ <span class="math inline">\(d_{r&#39;}\)</span> å¯ç”¨çš„æœ€å°å€¼ã€‚å¦‚æœ <span class="math inline">\(d_r\)</span> åœ¨å½“å‰ä¸åº”è¯¥ä½œä¸ºå³ç«¯ç‚¹ï¼Œå®ƒå°±ä¸€å®šä¼šè¢« <span class="math inline">\(d_{r&#39;}\)</span> é€‰æ‹©ã€‚å…·ä½“çš„æœ‰ç‚¹æŠ½è±¡ï¼Œä½†æ˜¯ä½ å¯ä»¥ç†è§£ä¸º <span class="math inline">\(d_r\)</span> é€‰äº† <span class="math inline">\(d_l\)</span> çš„è´¡çŒ®æ˜¯è¢«æ•´åˆåˆ° <span class="math inline">\(d_r\)</span> é‡Œçš„ï¼›å¦‚æœ <span class="math inline">\(d_r\)</span> è¢«é€‰äº†å°±è¯´æ˜ <span class="math inline">\(d_{r&#39;}\)</span> é€‰ <span class="math inline">\(d_l\)</span> ä¼šæ‹¥æœ‰æ›´å¤§çš„ä¼˜åŠ¿ã€‚</li><li><p><span class="math inline">\(d_l&gt;-k,d_r&lt;k\)</span>ï¼šå’Œä¸Šé¢çš„æƒ…å†µç›¸ä¼¼ï¼›ä½†è¿™ç§æƒ…å†µä¸‹ç­”æ¡ˆå¯èƒ½åè€Œå˜å¾—æ›´å¤§ï¼Œå› ä¸ºæ²¡æœ‰åæ•ˆæ€§ï¼Œæ‰€ä»¥è‡³å°‘è¦ä¿è¯å•æ­¥æœ€ä¼˜ã€‚æ­¤æ—¶ä¸èƒ½é€‰ã€‚</p><p>è¯´åˆ°å•æ­¥æœ€ä¼˜ï¼Œå°±ä¼šå‘ç°è¿™é‡Œå°±æ˜¯åæ‚”è´ªå¿ƒï¼›å•æ­¥æœ€ä¼˜ä¸€å®šæ˜¯å…¨å±€æœ€ä¼˜ï¼Œä½†æ›´é å‰çš„å±€éƒ¨æœ€ä¼˜å¯èƒ½è¢«å¦å®šæ‰ã€‚è€Œã€å¦å®šã€çš„æ–¹æ³•è¡¨ç°ä¸ºä¸€æ¬¡æ“ä½œã€‚</p></li></ul><p>ç»¼ä¸Šï¼Œä»å‰å¾€åæ‰«ï¼Œä¼˜å…ˆé˜Ÿåˆ—å®æ—¶ç»´æŠ¤è´Ÿæ•°æœ€å°å€¼ï¼Œå¯¹äºæ¯ä¸ªæ­£æ•°ï¼Œcheck é€‰æœ€å°å€¼æ˜¯å¦ä¼˜äºå½“å‰ç­”æ¡ˆï¼Œæœ‰å°±é€‰ã€‚å¦‚æœæ­£æ•°è¢«å‡ä¸ºè´Ÿï¼ŒåŠ å…¥é˜Ÿåˆ—ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n, k;        std::cin &gt;&gt; n &gt;&gt; k;        std::vector&lt;int&gt; a(n + 1), d(n + 1);        long long res(0ll);        for (int i = 1; i &lt;= n; ++i) &#123;            std::cin &gt;&gt; a[i], a[i] %= k;            d[i] = a[i] - a[i - 1];            if (d[i] &gt; 0)                (res += d[i]);        &#125;        std::priority_queue&lt;int&gt; q;        for (int i = 1; i &lt;= n; ++i)            if (d[i] &lt; 0)                q.push(-d[i]);            else &#123;                for (; !q.empty() &amp;&amp; d[i] &gt; 0; ) &#123;                    int x = -q.top(), y = d[i];                    auto t(res - y);                    x += k, y -= k;                    if (x &gt; 0)                        t += x;                    if (y &gt; 0)                        t += y;                    if (t &gt;= res)                        break;                    q.pop();                    res = t, d[i] = y;                    if (d[i] &lt; 0)                        q.push(-d[i]);                &#125;            &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="b---miriany-and-matchstick">B - Miriany and Matchstick</h2><p><a href="https://codeforces.com/problemset/problem/1852/D" class="uri">https://codeforces.com/problemset/problem/1852/D</a></p><p>ä»æ„é€ çš„è§’åº¦å‡ºå‘ï¼Œçœ‹åˆ°ã€æ°å¥½ä¸º <span class="math inline">\(k\)</span>ã€ï¼Œä¼šæƒ³åˆ°æ‰¾åˆ°ä¸Šç•Œå’Œä¸‹ç•Œå¹¶è¯æ˜ä¸­é—´æ¯ä¸€ä¸ªæ•°éƒ½èƒ½å–åˆ°ã€‚</p><p>ä½†ä¼¼ä¹å¾ˆå®¹æ˜“è¯ä¼ªï¼šä¾‹å¦‚å¯¹äº <code>AAAA</code>ï¼Œä¸‹ç•Œä¸º <span class="math inline">\(0\)</span>ï¼Œä¸Šç•Œä¸º <span class="math inline">\(4\)</span>ï¼Œä½†æœ‰ä¸”ä»…æœ‰ <span class="math inline">\(1\)</span> å–ä¸åˆ°ã€‚ä½†è¯¥æƒ³æ³•å¹¶æœªç ´äº§â€”â€”å¯ä»¥æ„Ÿå—åˆ°è¿™æ ·çš„ä½ç½®å¾ˆå°‘ã€‚è¿›ä¸€æ­¥åœ°ï¼Œä½  <a href="https://www.luogu.com.cn/article/2mmg5rjd">å¯ä»¥è¯æ˜åªæœ‰ä¸€ä¸ªè¿™æ ·çš„ä½ç½®</a>ï¼Œä¹Ÿå¯ä»¥ <a href="https://www.luogu.com.cn/article/679cwjgl">å¤§èƒ†çŒœæƒ³è¿™æ ·çš„ä½ç½®ä¸€å®šå‡ºç°åœ¨ <span class="math inline">\(l+1\)</span>ï¼Œ<span class="math inline">\(r-1\)</span></a>ã€‚æ€»ä¹‹ç°åœ¨æˆ‘ä»¬çš„çŠ¶æ€å°±å‡å°‘äº†ï¼ˆæˆ–è€…è¯´çŠ¶æ€å˜æˆ DP å€¼äº†ï¼‰ã€‚é¢„å¤„ç†å‡ºè¿™ä¸ªä¸œè¥¿ä¹‹åå¤§åŠ›æœç´¢æ‰¾æ–¹æ¡ˆå³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n, k;        std::cin &gt;&gt; n &gt;&gt; k;        std::vector&lt;int&gt; a(n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            char t;            std::cin &gt;&gt; t, a[i] = (t == &#39;A&#39;);            if (i &gt;= 2)                k -= (a[i] ^ a[i - 1]);        &#125;        std::vector&lt;std::array&lt;std::tuple&lt;int, int, int&gt;, 2&gt; &gt; f(n + 1);        f[n][0] = &#123; a[n], a[n], 0 &#125;, f[n][1] = &#123; !a[n], !a[n], 0 &#125;;        auto merge = [&amp;](int i, int l0, int r0, int p0, int l1, int r1, int p1) &#123;            if (l0 &gt; l1)                std::swap(l0, l1), std::swap(r0, r1), std::swap(p0, p1);            int l = l0, r = std::max(r0, r1), p = 0;            if (!p0 &amp;&amp; !p1) &#123;                if (r0 &lt; l1 - 1)                    assert(r0 == l1 - 2), p = r0 + 1;                else;            &#125;            else if (p0 &amp;&amp; p1) &#123;                if (p0 == p1)                    p = p0;                else &#123;                    int tag0 = (l1 &lt;= p0 &amp;&amp; p0 &lt;= r1), tag1 = (l0 &lt;= p1 &amp;&amp; p1 &lt;= r0);                    if (!tag0 &amp;&amp; !tag1);                    else if (!tag0)                        p = p0;                    else if (!tag1)                        p = p1;                    else;                &#125;            &#125;            else if (p0) &#123;                if (l1 &lt;= p0 &amp;&amp; p0 &lt;= r1);                else                    p = p0;            &#125;            else &#123;                if (l0 &lt;= p1 &amp;&amp; p1 &lt;= r0);                else                    p = p1;            &#125;            assert(p != l &amp;&amp; p != r &amp;&amp; l &lt;= r);            return std::make_tuple(l, r, p);        &#125;;        for (int i = n - 1; i; --i) &#123;            &#123;                auto [l0, r0, p0] = f[i + 1][0];                auto [l1, r1, p1] = f[i + 1][1];                if (a[i]) &#123;                    ++l0, ++r0, ++l1, ++r1;                    if (p0) ++p0;                    if (p1) ++p1;                &#125;                ++l1, ++r1;                if (p1) ++p1;                f[i][0] = merge(i, l0, r0, p0, l1, r1, p1);            &#125;            &#123;                auto [l0, r0, p0] = f[i + 1][0];                auto [l1, r1, p1] = f[i + 1][1];                if (!a[i]) &#123;                    ++l0, ++r0, ++l1, ++r1;                    if (p0) ++p0;                    if (p1) ++p1;                &#125;                ++l0, ++r0;                if (p0) ++p0;                f[i][1] = merge(i, l0, r0, p0, l1, r1, p1);            &#125;        &#125;        std::vector&lt;int&gt; res(n + 1);        std::function&lt;bool(int, int, int)&gt; DFS = [&amp;](int x, int cnt, int la) &#123;            if (x == n + 1)                return cnt == k;            auto [l0, r0, p0] = f[x][0];            auto [l1, r1, p1] = f[x][1];            if (cnt + (la == 1) + l0 &lt;= k &amp;&amp; cnt + (la == 1) + r0 &gt;= k &amp;&amp; (!p0 || cnt + (la == 1) + p0 != k) &amp;&amp; DFS(x + 1, cnt + (la == 1) + a[x], 0))                res[x] = 0;            else if (cnt + !la + l1 &lt;= k &amp;&amp; cnt + !la + r1 &gt;= k &amp;&amp; (!p1 || cnt + !la + p1 != k) &amp;&amp; DFS(x + 1, cnt + !la + !a[x], 1))                res[x] = 1;            else                return false;            return true;        &#125;;        if (DFS(1, 0, -1)) &#123;            std::cout &lt;&lt; &quot;YES\n&quot;;            for (int i = 1; i &lt;= n; ++i)                std::cout &lt;&lt; (res[i] ? &#39;A&#39; : &#39;B&#39;);            std::cout &lt;&lt; &#39;\n&#39;;        &#125;        else            std::cout &lt;&lt; &quot;NO\n&quot;;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
            <tag> æ ‘é“¾å‰–åˆ† </tag>
            
            <tag> åæ‚”è´ªå¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£é¢˜æŠ¥å‘Š å–é†‰çš„å…”å­</title>
      <link href="/20250505/"/>
      <url>/20250505/</url>
      
        <content type="html"><![CDATA[<p>è€é¢˜è§£æ‰¹é‡è¡¥æ¡£ã€‚</p><span id="more"></span><hr /><p><a href="http://222.180.160.110:61235/contest/6248/problem/2" class="uri">http://222.180.160.110:61235/contest/6248/problem/2</a></p><blockquote><p>ç»™å®š <span class="math inline">\(q\)</span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡ç»™å®š <span class="math inline">\(f(0)\)</span>ï¼Œæ±‚æœ€å°çš„ <span class="math inline">\(t\)</span>ï¼Œä½¿å¾— <span class="math inline">\(n | f(t)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(f(t)=d\cdot f(t-1) + \Delta_t\)</span>ï¼Œ<span class="math inline">\(n,d,l,r\)</span> ä¸ºå¸¸æ•°ï¼Œ<span class="math inline">\(\Delta_t\)</span> ä¸ºä½ è‡ªé€‰çš„ <span class="math inline">\([l,r]\)</span> é—´çš„æ•´æ•°ï¼Œæ¯æ¬¡è¯¢é—®ç‹¬ç«‹ã€‚</p><p><span class="math inline">\(q, n\le 10^7\)</span>ã€‚</p></blockquote><p>å¦‚æœè¿™æ˜¯æ•°è®ºé¢˜ï¼Œ<span class="math inline">\(n\)</span> å°±ä¸ä¼šå’Œ <span class="math inline">\(q\)</span> åŒé˜¶äº†ï¼Œæ‰€ä»¥è¿™å¯èƒ½æ˜¯ä¸€é“åæ¨¡æ‹Ÿçš„é¢˜ç›®ã€‚</p><p>å¾ˆå®¹æ˜“æƒ³åˆ°å»ºåŒä½™å›¾ï¼ˆè¿™é‡Œè¯´çš„æ˜¯ä» <span class="math inline">\([0-r,0-l]\)</span> å‡ºå‘ï¼›è¿™æ ·æ¯ä¸ªç‚¹ç¬¬ä¸€æ¬¡è¢« BFS åˆ°çš„æ—¶å€™å°±èƒ½ç¡®å®šç­”æ¡ˆäº†ï¼‰ã€‚ä½†å¦‚æœç›´æ¥æŠŠå›¾å»ºå‡ºæ¥ï¼Œå¤§å°å°±æ˜¯ <span class="math inline">\(O(n^2)\)</span> çº§åˆ«çš„äº†ã€‚æ¯æ¬¡è¿çš„ç‚¹éƒ½æ˜¯è¿ç»­çš„ä¸€æ®µï¼Œå®¹æ˜“æƒ³åˆ°çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ã€‚è¿™æ ·å°±èƒ½ <span class="math inline">\(O(n\log n)\)</span> è§£å†³é—®é¢˜äº†ã€‚ä½†æ˜¯é¢˜ç›®è¦æ±‚çº¿æ€§ã€‚</p><p>åœ¨å®ç°çš„æ—¶å€™ä¸€å®šä¼šæ³¨æ„åˆ°æˆ‘ä»¬ä¼šè¿åˆ°ä¸€äº›å·²ç»è¢«è®¿é—®è¿‡çš„ç‚¹ã€‚è¿™æ ·çš„è¾¹æ˜¯ã€æ— æ•ˆã€çš„â€”â€”æˆ‘ä»¬ä¸èƒ½å°†è®¿é—®è¿‡çš„ç‚¹å†æ¬¡åŠ å…¥é˜Ÿåˆ—ã€‚èƒ½ä¸èƒ½è§„é¿æ‰è¿™äº›ç‚¹å‘¢ï¼Ÿ</p><p><mark>æ¯æ¬¡è¢«è®¿é—®è¿‡çš„ç‚¹ä¸€å®šæ˜¯è¿ç»­çš„ã€é•¿åº¦ä¸º <span class="math inline">\(r - l + 1\)</span> çš„ä¸€æ®µâ€”â€”æœ‰æ²¡æœ‰<a href="/20250202/#texttt-aa-%E5%BC%8F%E5%AD%90%E4%B8%B2%E5%A4%84%E7%90%86">è”æƒ³åˆ°ä»€ä¹ˆ</a>ï¼Ÿç±»ä¼¼åœ°ï¼Œç»™ <span class="math inline">\(0\sim n-1\)</span> æ¯éš” <span class="math inline">\(r-l+1\)</span> æ‰“ä¸€ä¸ªæ ‡è®°â€”â€”æˆ–è€…è¯´ <strong>åˆ†ä¸€æ®µ</strong></mark>ï¼Œé‚£ä¹ˆæ¯æ¬¡è¯•å›¾è®¿é—® <span class="math inline">\([l_0, r_0]\)</span> æ—¶ï¼š</p><ol type="1"><li><span class="math inline">\([l_0,r_0]\)</span> ä¸ºä¸¤ä¸ªç›¸é‚»æ®µçš„å‰åç¼€ã€‚</li><li><span class="math inline">\([l_0,r_0]\)</span> æ°å¥½ä¸ºä¸€æ®µã€‚</li></ol><p>è¿™æ—¶æˆ‘ä»¬å°±å‘ç°äº†ï¼Œæ¯æ¬¡è®¿é—®çš„æ˜¯å®Œæ•´çš„å‰åç¼€ï¼Œåˆ©ç”¨å‰åç¼€å’Œä¼˜åŒ–å»ºå›¾ï¼Œç”±äºè¾¹æ•°æ˜¯ <span class="math inline">\(O(n)\)</span> çš„ï¼Œä¸”è¾¹æƒåªæœ‰ <span class="math inline">\(0\)</span> å’Œ <span class="math inline">\(1\)</span>ï¼Œå°±å¯ä»¥åšåˆ° <span class="math inline">\(O(n)\)</span> 01BFS è§£å†³é—®é¢˜ã€‚</p><details><p>æ³¨ï¼šå¸¸æ•°å¤§åˆ°å¿…å¯ç¥æœºè·‘ä¸è¿‡</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;struct IO &#123;    static const int N = 1 &lt;&lt; 22;    char buf[N], pbuf[N], *p1 = buf, *p2 = buf, *pp = pbuf;#define gc() (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + fread(buf, 1, N, stdin), p1 == p2) ? EOF : *p1++)    template &lt;typename T&gt;    void read(T&amp; x) &#123;        x = 0;        char ch;        int f = 0;        while ((ch = gc()) &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) f |= (ch == &#39;-&#39;);        while (x = (x &lt;&lt; 1) + (x &lt;&lt; 3) + (ch ^ 48), (ch = gc()) &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;)            ;        if (f)            x = ~x + 1;    &#125;    void putc(char c) &#123;        if (pp - pbuf == N)            fwrite(pbuf, 1, N, stdout), pp = pbuf;        *pp++ = c;    &#125;    void puts(const char* s) &#123;        while (*s) putc(*s), ++s;        putc(&#39;\n&#39;);    &#125;    template &lt;typename T&gt;    void print(T x) &#123;        static int st[20];        int tp = 0;        if (x &lt; 0)            putc(&#39;-&#39;), x = ~x + 1;        do            st[++tp] = x % 10, x /= 10;        while (x);        while (tp) putc(st[tp--] + &#39;0&#39;);    &#125;    ~IO() &#123; fwrite(pbuf, pp - pbuf, 1, stdout); &#125;&#125; io;int main() &#123;#ifdef ONLINE_JUDGE    std::freopen(&quot;calculate.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;calculate.out&quot;, &quot;w&quot;, stdout);#else    std::freopen(&quot;ex_calculator3.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (io.read(T); T--; ) &#123;        int n, l, r, m, to;        long long d, len;        io.read(n), io.read(d), io.read(l), io.read(r), io.read(m);        len = r - l + 1, to = (n - 1) / len + 1;        std::vector&lt;std::vector&lt;int&gt; &gt; t(n), lid(to), rid(to);        for (int i = 0; i &lt; n; ++i)            t[i * d % n].push_back(i);        std::vector&lt;std::vector&lt;int&gt; &gt; g(3 * n);        for (int i = 0, id = n - 1; i &lt; to; ++i) &#123;            int at = ((i != to - 1 || !(n % len)) ? len : (n % len));            lid[i].resize(at), rid[i].resize(at);            for (int j = 0; j &lt; at; ++j) &#123;                lid[i][j] = ++id;                g[id].push_back(i * len + j);                if (j != 0)                    g[id].push_back(id - 1);            &#125;            for (int j = at - 1; ~j; --j) &#123;                rid[i][j] = ++id;                g[id].push_back(i * len + j);                if (j != at - 1)                    g[id].push_back(id - 1);            &#125;        &#125;        auto add = [&amp;](int p, int l0, int r0) &#123;            int p1 = l0 / len, p2 = r0 / len;            if (p1 == p2)                g[p].push_back(lid[p1].back());            else &#123;                g[p].push_back(rid[p1][l0 % len]);                if ((p1 + 1) % to != p2) &#123;                    // fprintf(stderr, &quot;p1 = %d, p2 = %d, to = %d, get %d(%d)\n&quot;, p1, p2, to, (p1 + 1) % to, (int)lid[(p1 + 1) % to].size());                    g[p].push_back(lid[(p1 + 1) % to].back());                &#125;                g[p].push_back(lid[p2][r0 % len]);            &#125;            return;        &#125;;        for (int i = 0; i &lt; n; ++i)            for (auto j : t[i]) &#123;                // printf(&quot;%d -&gt; %d[%d, %d]\n&quot;, i, j, (j + n - r) % n, (j + n - l) % n);                add(i, (j + n - r) % n, (j + n - l) % n);            &#125;        std::list&lt;std::pair&lt;int, int&gt; &gt; q;        std::vector&lt;int&gt; f(n + 1, -1), tag(3 * n + 1);        for (int i = l, p = (n - r) % n; i &lt;= r; ++i, (++p) %= n)            f[p] = 0, q.emplace_back(p, 0), tag[p] = 1;        for (; !q.empty(); ) &#123;            auto [u, d] = q.front();            q.pop_front();            if (u &lt; n)                f[u] = d;            // printf(&quot;u = %d, d = %d\n&quot;, u, d);            for (auto i : g[u]) &#123;                // printf(&quot;  i = %d\n&quot;, i);                if (!tag[i]) &#123;                    if (i &gt;= n)                        q.emplace_front(i, d), tag[i] = 1;                    else                        q.emplace_back(i, d + 1), tag[i] = 1;                &#125;            &#125;        &#125;        for (int x; m--; )            io.read(x), io.print(f[x]), io.putc(&#39;\n&#39;);    &#125;    return 0;&#125;</code></pre></details><p>æˆ–è€…ï¼Œå‘ç°<mark>æ¯æ¬¡ä»»æ„æ ‡è®°å‰åç¼€ï¼Œåˆ™ä¸€æ®µå†…æœªè®¿é—®çš„ä¸€å®šæ˜¯ä¸­é—´çš„ä¸€æ•´æˆª</mark>ã€‚æ ¹æ®è¿™ä¸€ç‚¹å¯ç»´æŠ¤æ¯ä¸€æ®µå†…å¯è®¿é—®å…ƒç´ ï¼Œå°±èƒ½ <span class="math inline">\(O(n)\)</span> BFSï¼›</p><p>å¦‚æœæŠŠå›¾å»ºå‡ºæ¥äº†ï¼Œè¿˜å¯ä»¥è§£å†³æ‰©å±•é—®é¢˜ï¼š</p><blockquote><p>å‡å¦‚ <span class="math inline">\(\Delta_i\)</span> åœ¨ <span class="math inline">\([l,r]\)</span> é—´çš„æ•´æ•°ä¸­ç­‰æ¦‚ç‡å–å€¼ï¼Œåˆ™æœ€ä¼˜è§£å‡ºç°çš„æ¦‚ç‡ï¼Ÿ</p></blockquote><p>ä¸ºä»€ä¹ˆ BFS ä¸èƒ½è§£å†³è¯¥é—®é¢˜å‘¢ï¼Ÿå› ä¸ºåŒå±‚åŒä»£ä»·çš„ç‚¹å¯¹å…±åŒèƒ½è®¿é—®åˆ°çš„ç‚¹çš„è´¡çŒ®ä¸ä¼šè¢« BFS è®°å…¥ï¼ˆæ³¨æ„åˆ°ä¸€ä¸ªç‚¹åªä¼šè¢«ä¸€ä¸ªç‚¹è®¿é—®åˆ°ï¼‰ï¼Œæ‰€ä»¥åªæœ‰å»ºå›¾å‡ºæ¥æ‰èƒ½è§£å†³é—®é¢˜ã€‚</p><p>è¿™ä¹Ÿä¾§é¢åæ˜ è¯¥å›¾åœ¨å¿½ç•¥ç¯åæ‰€å¯¹åº”çš„å°±æ˜¯æœ€ä¼˜è§£ï¼Œè¿™å…¶å®æ˜¯æœ‰ç‚¹ BFS æ‰©å±•å‡ºæ¥çš„æ„å‘³åœ¨çš„ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ä¼˜åŒ–å»ºå›¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è¿é€šå›¾è®¡æ•°</title>
      <link href="/20250430/"/>
      <url>/20250430/</url>
      
        <content type="html"><![CDATA[<figure><img src="/20250430/neko.png" alt="çŒ«" style="width: 75px"><figcaption>çŒ«</figcaption></figure><span id="more"></span><p>å¤ªå¯æ€•äº†ï¼2025 å¹´æ‰è¿‡å» 4 ä¸ªæœˆï¼Œæ­£ç»æ–‡ç« çš„æ€»æ•°å·²ç»å’Œ 2024 å¹´ä¸­æ­£ç»æ–‡ç« çš„æ€»æ•°ä¸€æ ·å¤šäº†ã€‚</p><hr /><h2 id="æœ‰æ ‡å·æ— å‘å›¾è®¡æ•°">æœ‰æ ‡å·æ— å‘å›¾è®¡æ•°</h2><p>é—®é¢˜æ¨¡å‹å¤§æ¦‚å¦‚ä¸‹ï¼š</p><blockquote><p>ç»™å®š <span class="math inline">\(N\)</span> ä¸ªç‚¹ï¼Œä½ å¯ä»¥åœ¨å®ƒä»¬é—´ä»»æ„è¿è¾¹ï¼Œä½†å­˜åœ¨é™åˆ¶ï¼š</p><ul><li>å…¶ä¸­ä¸€ä¸ªè¾ƒå¥½å¤„ç†ï¼ˆå¦‚è¦æ±‚å›¾å¿…é¡»æ˜¯äºŒåˆ†å›¾ï¼‰ï¼›</li><li>å¦ä¸€ä¸ªè¾ƒéš¾å¤„ç†ï¼ˆå¦‚å»é‡é—®é¢˜ç­‰ï¼‰ï¼›</li><li>æœ€åï¼Œå¯èƒ½è¦æ±‚å›¾è¿é€šã€‚</li></ul></blockquote><p>é¦–å…ˆéœ€è¦çŸ¥é“æ€ä¹ˆå¤„ç†è¿™æ ·çš„è®¡æ•°é—®é¢˜ã€‚ä»¥ä¸‹çš†å»ºç«‹åœ¨æ— é‡è¾¹ã€è‡ªç¯çš„åŸºç¡€ä¸Šã€‚</p><ol type="1"><li><p>å…ˆåªè€ƒè™‘å®¹æ˜“çš„é™åˆ¶ï¼Œä¸”ä¸è¦æ±‚è¿é€šï¼š</p><p><em>æ³¨ï¼šå¦‚æœå‘ç° <strong>ä¸è¿é€š</strong> çš„æ—¶å€™æ²¡åŠæ³•å¾ˆæ–¹ä¾¿åœ°è®¡ç®—ç²¾ç¡®æ–¹æ¡ˆæ•°ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¼šç®—é‡ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥æŠŠ <strong>å»é‡</strong> ä½œä¸ºè¾ƒéš¾çš„é™åˆ¶ï¼Œè¿™ä¸€æ­¥ç®—é‡å°±ä¸é‡è¦äº†</em>ã€‚</p><p>è¯¥æ€ä¹ˆæ±‚æ€ä¹ˆæ±‚ã€‚ä¾‹å¦‚ï¼Œè‹¥è¯¥é™åˆ¶æ˜¯äºŒåˆ†å›¾ä¸”å¯ä»¥ç®—é‡ï¼Œæšä¸¾å·¦éƒ¨ç‚¹æ•°åŠè¾¹ï¼Œé‚£ä¹ˆæ–¹æ¡ˆæ•°å°±æ˜¯ <span class="math inline">\(\sum\limits_{i=0}^n C_n^i\cdot C_{i\cdot (n-i)}^m\)</span>ã€‚</p>è¿™ä¸ªæ—¶å€™éœ€è¦æ³¨æ„åˆ°ç®—é‡éƒ¨åˆ†çš„æ„ä¹‰æ˜¯ä»€ä¹ˆã€‚æ¯”å¦‚æ­¤å¤„ï¼Œè®¡ç®—ä¸­ä¸€ä¸ªè¿é€šå—å°†å·¦å³éƒ¨ç¿»è½¬åè¢«è§†ä½œä¸åŒçš„å­å›¾ï¼Œä½†åœ¨å…¨å±€çœ‹æ¥å¯¹åº”çš„æ€»å›¾æ˜¯åŒä¸€ä¸ªäºŒåˆ†å›¾ã€‚å› æ­¤ï¼Œå¯¹äºæ‹¥æœ‰ <span class="math inline">\(k\)</span> ä¸ªè¿é€šå—çš„å›¾ï¼Œå…¶è¢«è®¡ç®—äº† <span class="math inline">\(2^k\)</span> æ¬¡ã€‚</li><li><p>å†åŠ ä¸Šå¿…é¡»è¿é€šçš„é™åˆ¶ï¼Œä»åªè€ƒè™‘å®¹æ˜“çš„é™åˆ¶ï¼š</p><p>å¦‚æœä¸å­˜åœ¨å…¶ä»–é™åˆ¶ï¼Œé‚£ä¹ˆå°±æ˜¯ <a href="https://oeis.org/A001187">A001187</a>ã€‚</p><p>è¿é€šçš„æ–¹æ¡ˆå°±æ˜¯ä»»æ„çš„æ–¹æ¡ˆå‡å»ä¸è¿é€šçš„æ–¹æ¡ˆã€‚</p><ul><li>ä»»æ„çš„æ±‚æ³•å°±æ˜¯ç¬¬ä¸€ç‚¹ï¼›</li><li>ä¸è¿é€šçš„æ–¹æ¡ˆï¼Œæšä¸¾ <span class="math inline">\(1\)</span> æ‰€åœ¨å­é›†ï¼Œè®©å…¶è¡¥é›†é‡Œé¢ä»»æ„è¿è¾¹ï¼ˆç¬¬ 1 ç‚¹çš„å­é—®é¢˜ï¼‰ä¸”ä¸å’Œ <span class="math inline">\(1\)</span> æ‰€åœ¨å­é›†ç›¸è¿ã€‚</li></ul></li><li><p>æ¥ç€ï¼Œå¯¹è¿é€šçš„æƒ…å†µåº”ç”¨è¾ƒéš¾å¤„ç†çš„é™åˆ¶ï¼š</p><p><em>å› ä¸ºè¿é€šä¼šå¸¦æ¥ä¸€äº›æ¯”è¾ƒå¥½çš„æ€§è´¨ç®€åŒ–è¿ç®—ï¼Œæ‰€ä»¥é€‰æ‹©åœ¨è¿™ä¸€æ­¥åŠ ä¸Šè¾ƒéš¾çš„é™åˆ¶</em>ã€‚</p>ä¾‹å¦‚ï¼Œå¯¹äºä¸Šæ–‡ä¸­äºŒåˆ†å›¾å»é‡çš„ä¾‹å­ï¼Œè¿é€šå›¾ä¸­æ˜¾ç„¶åªæœ‰ä¸€ä¸ªè¿é€šå—ï¼Œå°†è¿é€šå›¾çš„æ–¹æ¡ˆ <span class="math inline">\(\div 2\)</span> å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆã€‚</li><li><p>æœ€åï¼Œå¦‚æœé¢˜ç›®è¦æ±‚ä»»æ„å›¾çš„æ–¹æ¡ˆï¼Œç”¨ç¬¬ä¸‰æ­¥ä¸­çš„ç­”æ¡ˆå†æ¬¡ç®—å‡ºä»»æ„å›¾çš„ç­”æ¡ˆã€‚</p><p>ç›¸å½“äºæ˜¯æŠŠç¬¬ 2 ç‚¹ä¸­çš„è¿‡ç¨‹åè¿‡æ¥ï¼Œæšä¸¾ <span class="math inline">\(1\)</span> æ‰€åœ¨å­é›†ï¼Œåœ¨å…¶è¡¥é›†ä¸­ä»»æ„è¿è¾¹ï¼ˆè¯¥é—®çš„å­é—®é¢˜ï¼‰ä¸”å¯ä»¥å’Œ <span class="math inline">\(1\)</span> æ‰€åœ¨çš„å­é›†è¿è¾¹ã€‚</p></li></ol><p>è¿™æ ·å°±å¯ä»¥è§£å†³é—®é¢˜ã€‚</p><hr /><h3 id="a---many-good-tuple-problems">A - Many Good Tuple Problems</h3><p><a href="https://atcoder.jp/contests/abc327/tasks/abc327_g" class="uri">https://atcoder.jp/contests/abc327/tasks/abc327_g</a></p><p>å¦‚æœæŠŠä¸€ç»„ <span class="math inline">\((S_i,T_i)\)</span> çœ‹ä½œä¸€æ¡è¾¹çš„è¯ï¼ŒåŸé™åˆ¶å°±å¯ä»¥è½¬åŒ–ä¸ºï¼šåœ¨ <span class="math inline">\(N\)</span> ä¸ªç‚¹ä¸­è¿ <span class="math inline">\(M\)</span> æ¡å¯é‡è¾¹ï¼Œå½¢æˆäºŒåˆ†å›¾çš„æ–¹æ¡ˆæ•°ã€‚è¾¹æœ‰åºã€‚</p><p><del>ä½ å¯ä»¥å‘ç°æˆ‘å·æ‡’æŠŠè¿™é“é¢˜æ‹¿å»ä¸Šé¢ä¸¾ä¾‹äº†</del>ï¼Œç”±äºè¾¹æ˜¯å¯é‡çš„ï¼Œè€Œæˆ‘ä»¬çš„æ¨¡å‹è¦æ±‚æ— é‡è¾¹ï¼Œä½†å‘ç°è¿™ä¸ªé™åˆ¶æ˜¯ç‹¬ç«‹äºæ¨¡å‹å¤–çš„ï¼Œä¹Ÿå°±æ˜¯å¯ä»¥åœ¨æœ€åæšä¸¾æœ‰å¤šå°‘æ¡ä¸åŒè¾¹ï¼Œå†ç”¨ä¸€ç‚¹ç»„åˆæ‰‹æ®µè®¡ç®—å®é™…è´¡çŒ®ã€‚</p><p>é¦–å…ˆä»¤ <span class="math inline">\(f_{0,n,m}\)</span> è¡¨ç¤º <span class="math inline">\(n\)</span> ä¸ªç‚¹ã€<span class="math inline">\(m\)</span> æ¡è¾¹ã€<strong>ä¸å»é‡</strong>ã€<strong>è¿é€šæ€§ä»»æ„</strong> çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆ <span class="math inline">\(f_{0,n,m}=\sum_{i=0}^n C_n^i\cdot C_{i\cdot (n-i)}^m\)</span>ã€‚</p><p>ä»¤ <span class="math inline">\(f_{1,n,m}\)</span> è¡¨ç¤º <strong>ä¸å»é‡</strong>ã€è¦æ±‚ <strong>è¿é€š</strong> çš„æ–¹æ¡ˆï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_{1,n,m}=f_{0,n,m}-\sum\limits_{i,j} C_{n - 1}^{i-1}\cdot f_{1,i,j}\cdot f_{0,n-i,m-j}\)</span>ã€‚</p><p>ä»¤ <span class="math inline">\(f_{2,n,m}\)</span> è¡¨ç¤º <strong>å»é‡</strong>ï¼Œè¦æ±‚ <strong>è¿é€š</strong> çš„æ–¹æ¡ˆï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_{2,n,m}=\dfrac {f_{1,n,m}}{2}\)</span>ã€‚</p><p>ä»¤ <span class="math inline">\(f_{3,n,m}\)</span> è¡¨ç¤º <strong>å»é‡</strong>ï¼Œ<strong>è¿é€šæ€§ä»»æ„</strong> çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_{3,n,m}=\sum\limits_{i,j} C_{n-1}^{i-1} \cdot f_{2,i,j} \cdot f_{3,n-i,m-j}\)</span>ã€‚</p><p>æœ€åçš„æ–¹æ¡ˆæ•°ä¸º <span class="math inline">\(\sum\limits_{j} f_{3,n,j}\cdot F(m,j)\)</span>ã€‚å…¶ä¸­ <span class="math inline">\(F(m,j)\)</span> è¡¨ç¤ºæŠŠ <span class="math inline">\(m\)</span> ä¸ªæœ‰æ ‡å·çš„çƒæ”¾åœ¨ <span class="math inline">\(j\)</span> ä¸ªæœ‰æ ‡å·çš„ç›’å­é‡Œï¼Œä¸ç©ºæ”¾çš„æ–¹æ¡ˆæ•°ï¼Œå¯ä»¥å®¹æ–¥ã€‚æœ€åæ³¨æ„è¾¹åå‘ç®—ä¸¤ç§ï¼Œæ‰€ä»¥ä¹˜ä¸Š <span class="math inline">\(2^m\)</span>ã€‚</p><p>å¤æ‚åº¦ <span class="math inline">\(O(n^6)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;const int inv2 = (mod + 1) &gt;&gt; 1;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, M, m;    std::cin &gt;&gt; n &gt;&gt; M, m = std::min(n * (n - 1) / 2, M);    std::vector&lt;std::vector&lt;long long&gt; &gt; C(n * n + 1, std::vector&lt;long long&gt; (n * n + 1));    for (int i = 0; i &lt;= n * n; ++i) &#123;        C[i][0] = 1ll;        for (int j = 1; j &lt;= i; ++j)            C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % mod;    &#125;    std::vector&lt;std::vector&lt;std::vector&lt;long long&gt; &gt; &gt; f(4, std::vector&lt;std::vector&lt;long long&gt; &gt; (n + 1, std::vector&lt;long long&gt; (m + 1)));    for (int i = 1; i &lt;= n; ++i)        for (int j = 0; j &lt;= m &amp;&amp; j &lt;= i * (i - 1) / 2; ++j)            for (int k = 0; k &lt;= i; ++k)                (f[0][i][j] += C[i][k] * C[k * (i - k)][j]) %= mod;    for (int i = 1; i &lt;= n; ++i)        for (int j = 0; j &lt;= m; ++j) &#123;            auto t(0ll);            for (int k = 1; k &lt;= i; ++k)                for (int l = 0; l &lt;= j; ++l)                    (t += C[i - 1][k - 1] * f[1][k][l] % mod * f[0][i - k][j - l]) %= mod;            f[1][i][j] = (f[0][i][j] + mod - t) % mod;            f[2][i][j] = f[1][i][j] * inv2 % mod;        &#125;    f[3][0][0] = 1ll;    for (int i = 1; i &lt;= n; ++i)        for (int j = 0; j &lt;= m; ++j)            for (int k = 1; k &lt;= i; ++k)                for (int l = 0; l &lt;= j; ++l)                    (f[3][i][j] += C[i - 1][k - 1] * f[2][k][l] % mod * f[3][i - k][j - l]) %= mod;    auto qkp = [](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    std::vector&lt;long long&gt; F(m + 1);    for (int i = 1; i &lt;= m; ++i) &#123;        F[i] = qkp(i, M);        for (int j = 1, p = mod - 1; j &lt; m; ++j, p = mod - p)            (F[i] += p * C[i][j] % mod * qkp(i - j, M)) %= mod;    &#125;    auto res(0ll);    for (int j = 1; j &lt;= m; ++j)        (res += f[3][n][j] * F[j]) %= mod;    std::cout &lt;&lt; res * qkp(2, M) % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="b---many-mst">B - Many MST</h3><p><a href="https://atcoder.jp/contests/abc386/tasks/abc386_g" class="uri">https://atcoder.jp/contests/abc386/tasks/abc386_g</a></p><p>è¿™é‡Œéœ€è¦æ³¨æ„åˆ° MST å’Œè¿é€šå—çš„éšå«è”ç³»ã€‚æŒ‰ç…§ Kruskal çš„ç”Ÿæˆæ–¹å¼å¯ä»¥å‘ç°åªéœ€è¦åœ¨åˆå¹¶ä¸¤ä¸ªè¿é€šå—æ—¶åŠ ä¸Šå®ƒä»¬ä¹‹é—´è¿è¾¹ä¸­æœ€å°çš„è¾¹æƒå°±å¯ä»¥å¾—åˆ° MSTã€‚</p><p>å› æ­¤å®¹æ˜“æƒ³åˆ°åœ¨ DP æ—¶å¯¹æœ€å°è¾¹æƒè¿›è¡Œé™åˆ¶ï¼›æšä¸¾ <span class="math inline">\(k\)</span>ï¼Œè®©è¾¹æƒ <span class="math inline">\(\le k\)</span> æˆä¸ºç®€å•é™åˆ¶ï¼›è®©æ±‚è§£ MST æˆä¸ºæŸç§æ„ä¹‰ä¸Šçš„è¾ƒéš¾é™åˆ¶ã€‚</p><p>ä»¤ <span class="math inline">\(f_{0,n,k}\)</span> è¡¨ç¤º <span class="math inline">\(n\)</span> ä¸ªç‚¹ï¼Œè¾¹æƒ <span class="math inline">\(\le k\)</span>ã€<strong>å¯¹è¿é€šæ€§æ²¡æœ‰è¦æ±‚</strong> çš„æ–¹æ¡ˆæ•°ï¼›ç›¸åº”åœ°ï¼Œ<span class="math inline">\(f_{1,n,k}\)</span> è¡¨ç¤º <strong>è¦æ±‚è¿é€š</strong> çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™ï¼š</p><ul><li><p><span class="math inline">\(f_{0,n,k}=\sum\limits_i C_{n-1}^{i-1}\cdot f_{1,i,k-1} \cdot f_{0,n-i,k}\cdot (M-k+1)^{i\times(n-i)}\)</span>ã€‚</p><p>æ³¨è§£ï¼šå¼å­æ­£ç¡®æ€§å»ºç«‹åœ¨ <strong><span class="math inline">\(1\)</span> æ‰€åœ¨ çš„ç”±æƒå€¼ <span class="math inline">\(&lt;k\)</span> çš„è¾¹æ„æˆçš„æœ€å¤§è¿é€šå— å¤§å°ä¸º <span class="math inline">\(i\)</span></strong> çš„åŸºç¡€ä¹‹ä¸Šï¼Œæ•…ä¸¤ä¸ªè¿é€šå—ä¹‹é—´çš„è¾¹æƒåªèƒ½ <span class="math inline">\(\ge k\)</span>ã€‚è¿™ä¹Ÿæé†’æˆ‘ä»¬ï¼Œæ­¤å¤„çš„ <strong>ä¸è¿é€š</strong> å«ä¹‰å®é™…ä¸Šæ˜¯ç»™è¿™äº›è¾¹ä¸€ä¸ª <span class="math inline">\((M-k)\)</span> çš„ç³»æ•°ã€‚</p>é‚£ä¹ˆè¿™æ ·ä½ ä¼šæ³¨æ„åˆ°ï¼Œ<span class="math inline">\(f_0\)</span> çš„æ„ä¹‰å°±ä¸ <span class="math inline">\(k\)</span> æ— å…³äº†ï¼ˆé‚£ä¹ˆæ˜¾ç„¶å€¼ä¹Ÿä¸ <span class="math inline">\(k\)</span> æ— å…³ï¼‰ï¼Œä½†æ˜¯ä»ç„¶ä¿ç•™ <span class="math inline">\(k\)</span> å¯¹æ€è€ƒæœ‰å¸®åŠ©ï¼Œæ•…ç•™ä¹‹ã€‚</li><li><p><span class="math inline">\(f_{1,n,k}=f_{0, n, k} - \sum\limits_i C_{n - 1}^{i-1} \cdot f_{1,i,k}\cdot f_{0,n-i,k}\times (M-k)^{i\times (n - i)}\)</span>ã€‚</p></li></ul><p>ä»¤ <span class="math inline">\(g_{0, n, k}\)</span> è¡¨ç¤º <span class="math inline">\(n\)</span> ä¸ªç‚¹ã€è¾¹æƒ <span class="math inline">\(\le k\)</span>ã€<strong>å¯¹è¿é€šæ€§æ²¡æœ‰è¦æ±‚</strong> çš„ MST ä¹‹å’Œï¼›ç›¸åº”åœ°ï¼Œ<span class="math inline">\(g_{1,n,k}\)</span> è¡¨ç¤ºå¯¹åº”æ¡ä»¶ä¸‹ <strong>è¦æ±‚è¿é€š</strong> çš„ MST ä¹‹å’Œã€‚åˆ™ï¼š</p><ul><li><p><span class="math inline">\(g_{0,n,k}=\sum\limits_{i} C_{n-1}^{i-1}\cdot (f_{1,i,k - 1}\cdot g_{0,n-i,k}+g_{1,i,k - 1} \cdot f_{0,n-i,k}+f_{1,i,k-1}\cdot f_{0,n-i,k}\cdot k)\cdot (M-k+1)^{i\times (n-i)}\)</span>ã€‚</p>æ³¨è§£ï¼šç±»æ¯” <span class="math inline">\(f_0\)</span> çš„è®¡ç®—æ–¹å¼å¾—åˆ° <span class="math inline">\(g_0\)</span>ã€‚åœ¨ <span class="math inline">\(i\times (n-i)\)</span> ä¸­ä»»é€‰ä¸€æ¡ä½œä¸º MST ä¸Šæƒå€¼ä¸º <span class="math inline">\(k\)</span> çš„è¾¹ï¼Œæ•…æœ‰ <span class="math inline">\(f_{1,i,k-1}\cdot f_{0,n-i,k}\cdot k\)</span>ã€‚ä¹‹æ‰€ä»¥å¿…é¡»è¦æ±‚æœ‰è¿™ä¹ˆä¸€æ¡è¾¹æ˜¯ä¸ºäº†å’Œ <span class="math inline">\(g_{k-1}\)</span> å’Œ <span class="math inline">\(g_{k+1}\)</span> ç­‰åŒºåˆ†ã€‚</li><li><p><span class="math inline">\(g_{1,n,k}=g_{0,n,k}-\sum\limits_i C_{n-1}^{i-1}\cdot (f_{1,i,k}\cdot g_{0,n-i,k}+g_{1,i,k}\cdot f_{0,n-i,k}+f_{1,i,k}\cdot f_{0,n-i,k}\cdot k)\cdot (M-k)^{i\times (n-i)}\)</span>ã€‚</p></li></ul><p>å¤æ‚åº¦ <span class="math inline">\(O(n^2\cdot M)\)</span>ã€‚è¦æ±‚é¢„å¤„ç†å¹‚ï¼Œä¸ç„¶ä¼š Tã€‚ä»¥åŠå¯èƒ½éœ€è¦æŠŠ <span class="math inline">\(f_0,f_1,g_0,g_1\)</span> æ”¾åœ¨åŒä¸€ä¸ªå†…å±‚å¾ªç¯æ±‚ï¼Œä¸ç„¶ä¼šå¡å¸¸ï¼›<del>åœ¨æ­¤åŸºç¡€ä¸Šä½¿ç”¨å†…å­˜è¿ç»­è®¿é—®ä¼˜åŒ–ä¼¼ä¹å¹¶ä¸æ˜æ˜¾</del> <img src="/em/kt.gif" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int N, M;    std::cin &gt;&gt; N &gt;&gt; M;    using arr = std::vector&lt;long long&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    crr f(2, brr(N + 1, arr(M + 1))), g(2, brr(N + 1, arr(M + 1)));    brr C(N + 1, arr(N + 1)), p(M + 1, arr(N * N + 1));    for (int i = 0; i &lt;= M; ++i) &#123;        p[i][0] = 1ll;        for (int j = 1; j &lt;= N * N; ++j)            p[i][j] = p[i][j - 1] * i % mod;    &#125;    for (int i = 0; i &lt;= N; ++i) &#123;        C[i][0] = 1ll;        for (int j = 1; j &lt;= i; ++j)            C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % mod;    &#125;    f[1][0][0] = f[1][1][0] = 1ll;    for (int n = 1; n &lt;= N; ++n)        for (int k = 1; k &lt;= M; ++k) &#123;            f[0][n][k] = f[1][n][k - 1];            for (int i = 1; i &lt; n; ++i) &#123;                (f[0][n][k] += C[n - 1][i - 1] * f[1][i][k - 1] % mod * f[0][n - i][k] % mod * p[M - k + 1][i * (n - i)]) %= mod;                (f[1][n][k] += mod - C[n - 1][i - 1] * f[1][i][k] % mod * f[0][n - i][k] % mod * p[M - k][i * (n - i)] % mod) %= mod;            &#125;            (f[1][n][k] += f[0][n][k]) %= mod;        &#125;    for (int n = 1; n &lt;= N; ++n)        for (int k = 1; k &lt;= M; ++k) &#123;            g[0][n][k] = g[1][n][k - 1];            for (int i = 1; i &lt; n; ++i) &#123;                (g[0][n][k] += (f[1][i][k - 1] * g[0][n - i][k] % mod + g[1][i][k - 1] * f[0][n - i][k] % mod + f[1][i][k - 1] * f[0][n - i][k] % mod * k) % mod * C[n - 1][i - 1] % mod * p[M - k + 1][i * (n - i)]) %= mod;                (g[1][n][k] += mod - (f[1][i][k] * g[0][n - i][k] % mod + g[1][i][k] * f[0][n - i][k] % mod + f[1][i][k] * f[0][n - i][k] % mod * k) % mod * C[n - 1][i - 1] % mod * p[M - k][i * (n - i)] % mod) %= mod;            &#125;            (g[1][n][k] += g[0][n][k]) %= mod;        &#125;    // for (int n = 1; n &lt;= N; ++n)    //     for (int k = 1; k &lt;= M; ++k) &#123;    //         printf(&quot;f[0][%d][%d] = %lld\n&quot;, n, k, f[0][n][k]);    //         printf(&quot;f[1][%d][%d] = %lld\n&quot;, n, k, f[1][n][k]);    //         printf(&quot;g[0][%d][%d] = %lld\n&quot;, n, k, g[0][n][k]);    //         printf(&quot;g[1][%d][%d] = %lld\n&quot;, n, k, g[1][n][k]);    //     &#125;    std::cout &lt;&lt; g[1][N][M] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="æœ‰æ ‡å·-dag-è®¡æ•°">æœ‰æ ‡å· DAG è®¡æ•°</h2><blockquote><p>ç»™å®š <span class="math inline">\(N\)</span> ä¸ªç‚¹ï¼Œä½ å¯ä»¥åœ¨å®ƒä»¬é—´ä»»æ„è¿è¾¹ï¼Œè¦æ±‚æœ€åå›¾ä¸º DAGï¼Œå¯èƒ½è¦æ±‚å›¾å¼±è¿é€šã€‚</p></blockquote><p>å¦‚æœè¯´æ— å‘å›¾è®¡æ•°å…³é”®åœ¨äºè¿é€šå—ï¼Œé‚£ä¹ˆ DAG åœ¨æ­¤åŸºç¡€ä¸Šå…³é”®åœ¨äºå…¥åº¦ä¸º <span class="math inline">\(0\)</span> çš„ç‚¹é›†ã€‚</p><p>ä»¤ <span class="math inline">\(f(i)\)</span> è¡¨ç¤º <span class="math inline">\(i\)</span> ä¸ªç‚¹çš„ DAG çš„ç­”æ¡ˆï¼›<span class="math inline">\(g_{0, i,j}\)</span> è¡¨ç¤º <span class="math inline">\(i\)</span> ä¸ªç‚¹çš„ DAGï¼Œå…¶ä¸­ <span class="math inline">\(j\)</span> ä¸ªå…¥åº¦ä¸º <span class="math inline">\(0\)</span> çš„æ–¹æ¡ˆï¼Œä¸éš¾æƒ³åˆ°å®¹æ–¥ï¼šä»¤ <span class="math inline">\(g_{1,i,j}\)</span> è¡¨ç¤ºè‡³å°‘ <span class="math inline">\(j\)</span> ä¸ªçš„æ–¹æ¡ˆï¼Œé‚£ä¹ˆï¼š</p><p><span class="math display">\[g_{1,i,j}=C_i^j\times f(i-j)\times 2^{j\times (i-j)}\\g_{0,i,j}=\sum_{k=j}^i (-1)^{k-j}\cdot C_k^j\cdot g_{1,i,j}\\f(i)=\sum_{j=1}^i g_{0,i,j}\]</span></p><p>æ•´ç†æœ‰ï¼š</p><p><span class="math display">\[\begin{aligned}f(i)&amp;=\sum_{j=1}^i \sum_{k=j}^i (-1)^{k-j}\cdot C_k^j\cdot g_{1,i,k}\\&amp;=\sum_{k=1}^i (-1)^k\cdot g_{1,i,k}\cdot \sum_{j=1}^k (-1)^j\cdot C_k^j\\&amp;=\sum_{k=1}^i (-1)^k\cdot g_{1,i,k}\cdot (0^k-1)\\&amp;=\sum_{k=1}^i (-1)^{k+1}\cdot C_i^k\times f(i-k)\times 2^{(i-k)}\end{aligned}\]</span></p><p>å³å¾—é€’æ¨å¼ã€‚å¦‚æœè¦æ±‚è¿é€šä»¿ç…§æ— å‘å›¾è¿é€šçš„æ–¹æ³•ï¼Œç”¨ä»»æ„å‡å»ä¸è¿é€šå³å¯ã€‚</p><hr /><h3 id="c---amusement-park">C - Amusement Park</h3><p><a href="https://codeforces.com/problemset/problem/1193/A" class="uri">https://codeforces.com/problemset/problem/1193/A</a></p><p>å…ˆè€ƒè™‘è®¡ç®—æ–¹æ¡ˆæ•°ã€‚æšä¸¾ <span class="math inline">\(1\)</span> æ‰€åœ¨å­é›†ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f(S)=\sum\limits_{T\in S} (-1)^{|T|+1}\cdot f(S - T)\)</span>ã€‚ç›¸è¾ƒäºä¸€èˆ¬çš„ DAG è®¡æ•°ï¼Œå› ä¸ºæ¯æ¡è¾¹å–ä¸å–æ˜¯å›ºå®šçš„ï¼Œæ‰€ä»¥æ²¡æœ‰äº† <span class="math inline">\(2\)</span> çš„æ¬¡å¹‚çš„ç³»æ•°ï¼›åŒæ—¶å› ä¸ºç›´æ¥æšä¸¾å­é›†ï¼Œæ‰€ä»¥æ²¡æœ‰äº†ç»„åˆç³»æ•°ã€‚</p><p>æ³¨æ„æ­¤å¤„ <span class="math inline">\(T\)</span> å¯æ„æˆä¸€è½®æ–°çš„å…¥åº¦ä¸º <span class="math inline">\(0\)</span> çš„ç‚¹é›†å½“ä¸”ä»…å½“ <span class="math inline">\(T\)</span> ä¹‹å†…æ²¡æœ‰è¿è¾¹ï¼Œå³ <span class="math inline">\(T\)</span> ä¸ºç‹¬ç«‹é›†ã€‚</p><p>ç®—å‡ºæ–¹æ¡ˆæ•°åå¦‚ä½•ç®—ç­”æ¡ˆå‘¢ï¼Ÿå‘ç°å¯¹äºä¸€ç§åˆæ³•çš„æ–¹æ¡ˆï¼ŒæŠŠé‡Œé¢æ‰€æœ‰çš„è¾¹åå‘ä¸€å®šå”¯ä¸€å¯¹åº”å¦ä¸€ç§åˆæ³•æ–¹æ¡ˆï¼Œä¸¤ç§æ–¹æ¡ˆå–åè¾¹æ•°ç›¸åŠ ä¸º <span class="math inline">\(m\)</span>ï¼›é‚£ä¹ˆç»™æ‰€æœ‰æ–¹æ¡ˆé™¤ä»¥ <span class="math inline">\(2\)</span>ï¼Œå†ä¹˜ä¸Š <span class="math inline">\(m\)</span> å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚</p><p>å¤æ‚åº¦ <span class="math inline">\(O(3^n)\)</span>ã€‚éœ€è¦æå‰æŠŠæ¯ä¸ªç‚¹é›†æ˜¯å¦ç‹¬ç«‹é¢„å¤„ç†ä¸‹æ¥ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353, inv2 = (mod + 1) &gt;&gt; 1;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; g(n + 1);    for (int i = 1, x, y; i &lt;= m; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x] |= (1 &lt;&lt; (y - 1));        g[y] |= (1 &lt;&lt; (x - 1));    &#125;    auto check = [&amp;](int s) &#123;        for (int i = 1; i &lt;= n; ++i)            if ((s &gt;&gt; (i - 1)) &amp; 1)                if (s &amp; g[i])                    return false;        return true;    &#125;;    int siz = 1 &lt;&lt; n;    std::vector&lt;int&gt; tag(siz);    for (int i = 0; i &lt; siz; ++i)        tag[i] = check(i);    std::vector&lt;long long&gt; f(siz);    f[0] = 1ll;    for (int i = 1; i &lt; siz; ++i)        for (int j = i; j; j = (j - 1) &amp; i)            if (tag[j])                (f[i] += ((__builtin_popcount(j) &amp; 1) ? 1 : mod - 1) * f[i ^ j]) %= mod;    std::cout &lt;&lt; f[siz - 1] * inv2 % mod * m % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="d---balance-scale">D - Balance Scale</h3><p><a href="https://atcoder.jp/contests/abc306/tasks/abc306_h" class="uri">https://atcoder.jp/contests/abc306/tasks/abc306_h</a></p><p>å¯ä»¥å‘ç°ï¼Œå¦‚æœå°†è¢« <code>=</code> è¿èµ·æ¥çš„ç‚¹ç¼©èµ·æ¥ï¼Œå°±å¯ä»¥è½¬åŒ–æˆä¸Šä¸€ä¸ªé—®é¢˜ã€‚ä½†æšä¸¾è¢«ç¼©çš„ç‚¹é›†æ˜¾ç„¶æ˜¯ä¸èƒ½é€šè¿‡çš„ï¼Œè¿™é‡Œä»‹ç»ä¸€ç§æ–¹æ³•ã€‚</p><p>ä¸æŠŠç¼©ç‚¹æ”¾åœ¨å¼€å¤´ã€‚åœ¨ä¸Šä¸€é¢˜ä¸­çš„ DP å¼å­ <span class="math inline">\(f(S)=\sum\limits_{T\in S} (-1)^{|T|+1}\cdot f(S - T)\)</span> ä¸­ï¼Œè€ƒè™‘å’Œæˆ‘ä»¬æœ€ç»ˆçš„ç­”æ¡ˆæœ‰ä»€ä¹ˆå·®å¼‚ï¼š</p><ol type="1"><li>åœ¨ç°åœ¨çš„é—®é¢˜ä¸­ï¼Œæœ‰çš„è¾¹æ˜¯å¯ä»¥ä¸é€‰çš„ï¼è€ƒè™‘è¿™ä¼šç»™å®¹æ–¥å¸¦æ¥æ€æ ·çš„å½±å“ã€‚</li></ol><p>é¦–å…ˆåº”è¯¥çŸ¥é“ä¸€ä»¶äº‹æƒ…ï¼šä½ å†³å®šæŠŠä¸€éƒ¨åˆ†ç‚¹ç¼©åˆ°ä¸€èµ·ï¼Œå½“ä¸”ä»…å½“å®ƒä»¬å…¨éƒ¨ç”± <code>=</code> è¿æ¥ã€‚è¦è®©ä¸€äº›è¾¹åŠ å…¥ DPï¼Œä¹Ÿå°±æ˜¯è®©å®ƒä»¬ä¸æ˜¯ <code>=</code>ï¼Œå½“ä¸”ä»…å½“å®ƒä»¬æˆä¸ºè¿é€šå—çš„ã€å‰²ã€â€”â€”æŠŠè¿é€šå—åˆ†æˆå¤šä¸ªè¿é€šå—ã€‚è¿™ç§æƒ…å†µæ˜¾ç„¶å·²ç»ç”±å¦ä¸€æ¡è·¯å¾„è½¬ç§»è¿‡äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå°±ç”¨è¿™ä¸ªå¼å­å¯ä»¥å¾—åˆ°æ‰€æœ‰ç­”æ¡ˆã€‚ 1. å¦ä¸€ä¸ªé—®é¢˜ï¼Œåœ¨ä¸Šä¸€é¢˜ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥è½»æ˜“åœ°åˆ¤æ–­ <span class="math inline">\(T\)</span> æ˜¯å¦ä¸ºç‹¬ç«‹é›†ï¼›ä½†åœ¨æœ¬é—®ä¸­ï¼Œä¸æ˜¯ç‹¬ç«‹é›†çš„ç‚¹é›†ä¹Ÿå¯èƒ½ç¼©ç‚¹æˆä¸ºç‹¬ç«‹é›†ã€‚</p><p>å‘ç°æœ‰ä¸€ç§å”¯ä¸€æ–¹æ³•ï¼Œå°±æ˜¯ä½¿ <span class="math inline">\(T\)</span> ä¸­ä½äºåŒä¸€è¿é€šå—çš„ç‚¹ç¼©åˆ°ä¸€èµ·ï¼›æ‰€ä»¥åº”è¯¥å°† <span class="math inline">\(-1\)</span> çš„æ¬¡æ•°æ›¿æ¢ä¸º <span class="math inline">\(T\)</span> æ‰€åœ¨è¿é€šå—ä¸ªæ•° <span class="math inline">\(+1\)</span>ã€‚</p><p>æ³¨æ„è¿™é‡Œè¯´çš„è¿é€šå—æ˜¯ <span class="math inline">\(T\)</span> çš„å¯¼å‡ºå­å›¾ä¸­çš„è¿é€šå—ã€‚</p><p>è¿™ä¹Ÿå¯ç¤ºæˆ‘ä»¬ä¸è¦æŠŠç¼©ç‚¹å’Œå›¾çš„è¿é€šæ€§ç­‰ç­‰å…³è”å¾—å¤ªæ­»ï¼Œéœ€è¦æŠŠç‚¹ç­‰ä»·çš„åœºæ™¯éƒ½å¯èƒ½ç”¨åˆ°ç¼©ç‚¹ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353, inv2 = (mod + 1) &gt;&gt; 1;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; fa(n + 1);    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;        return fa[x] == x ? x : fa[x] = find(fa[x]);    &#125;;    auto merge = [&amp;](int x, int y) &#123;        fa[find(x)] = find(y);        return;    &#125;;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    for (int x, y; m--; ) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    int siz = 1 &lt;&lt; n;    std::vector&lt;int&gt; cnt(siz);    for (int i = 0; i &lt; siz; ++i) &#123;        std::iota(fa.begin(), fa.end(), 0);        std::vector&lt;int&gt; tag(n + 1);        for (int j = 1; j &lt;= n; ++j)            if ((i &gt;&gt; (j - 1)) &amp; 1)                for (auto k : g[j])                    if ((i &gt;&gt; (k - 1)) &amp; 1)                        merge(k, j);        for (int j = 1; j &lt;= n; ++j)            if ((i &gt;&gt; (j - 1)) &amp; 1)                cnt[i] += (fa[j] == j);    &#125;    std::vector&lt;long long&gt; f(siz);    f[0] = 1ll;    for (int i = 1; i &lt; siz; ++i)        for (int j = i; j; j = (j - 1) &amp; i)            if (cnt[j])                (f[i] += ((cnt[j] &amp; 1) ? 1 : mod - 1) * f[i ^ j]) %= mod;    std::cout &lt;&lt; f[siz - 1] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="e---ä¸»æ—‹å¾‹">E - ä¸»æ—‹å¾‹</h3><p><a href="https://www.luogu.com.cn/problem/P11714" class="uri">https://www.luogu.com.cn/problem/P11714</a></p><p>å³ï¼Œç»™å®šä¸€ä¸ªæœ‰å‘å›¾ï¼Œé—®è¾¹é›†æœ‰å¤šå°‘ä¸ªå­é›†æ˜¯å¼ºè¿é€šçš„ã€‚</p><p>å†æ¬¡æ¶‰åŠåˆ°äº†è¿é€šæ€§é—®é¢˜ï¼Œä½†åœ¨è¿™é‡Œéœ€è¦ç»“åˆ SCC ç¼©ç‚¹æ¥è€ƒè™‘ã€‚å®¹æ˜“å‘ç°å¼ºè¿é€šå³ç¼©å‡ºæ¥æ˜¯ä¸€ä¸ªç‚¹ï¼›æ•…éœ€è¦å…³æ³¨ç¼©å‡ºæ¥çš„ç‚¹æ•°ã€‚</p><p>ä»¤ <span class="math inline">\(f(S)\)</span> è¡¨ç¤º <span class="math inline">\(S\)</span> çš„å¯¼å‡ºå­å›¾å†…åˆæ³•è¾¹å­é›†çš„æ•°é‡ï¼Œ<span class="math inline">\(g(S)\)</span> è¡¨ç¤º <span class="math inline">\(S\)</span> çš„å¯¼å‡ºå­å›¾ä¸­éæ³•è¾¹å­é›†çš„æ•°é‡ï¼›<span class="math inline">\(h(S,k)\)</span> è¡¨ç¤º <span class="math inline">\(S\)</span> çš„å¯¼å‡ºå­å›¾ä¸­è¾¹çš„å­é›†ç¼©å‡ºæ¥æœ‰ <span class="math inline">\(k\)</span> ä¸ªç‚¹çš„æ•°é‡ï¼Œ ä»¤ <span class="math inline">\(E(S_1, S_2)\)</span> è¡¨ç¤ºä» <span class="math inline">\(S_1\)</span> æŒ‡å‘ <span class="math inline">\(S_2\)</span> çš„è¾¹æ•°ï¼Œåˆ™ï¼š</p><p><span class="math display">\[f(S) = 2^{E(S,S)}-g(S)\\g(S)=\sum_{T \subseteq S}2^{E(T, S - T)}\cdot 2^{E(T, T)}\cdot \sum_{k=1+[T=\varnothing]} (-1)^{k+1}\cdot h(S - T, k)\\h(S, k) = \sum_{T\subset S} f(T) \cdot h(S - T, k-1)\]</span></p><p>æ³¨æ„ä¸ºä»€ä¹ˆè¦ç”¨ä¸€ä¸ª <span class="math inline">\(h\)</span> æ¥è½¬ç§» <span class="math inline">\(g\)</span> å‘¢ï¼Ÿæˆ‘ä»¬å‘ç° <span class="math inline">\(-1\)</span> çš„æ¬¡æ•°å’Œç¼©å‡ºæ¥çš„ç‚¹æ•°æ˜¯æœ‰å…³çš„ï¼Œè€Œå…‰å‡­ <span class="math inline">\(g\)</span> æ— æ³•è¡¨ç¤ºç‚¹æ•°ä¿¡æ¯ï¼Œæ‰€ä»¥éœ€è¦ç”¨ <span class="math inline">\(h\)</span> æ¥æ­ä¸ªæ¡¥ã€‚</p><p>ç›´æ¥ DPï¼Œå¤æ‚åº¦ <span class="math inline">\(O(n\cdot 3^n)\)</span>ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> è®¡æ•° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20250421/"/>
      <url>/20250421/</url>
      
        <content type="html"><![CDATA[<figure><img src="/20250421/neko.png" alt="çŒ«" style="width: 75px"><figcaption>çŒ«</figcaption></figure><span id="more"></span><hr /><h2 id="a---t-shirt">A - T-shirt</h2><p><a href="https://codeforces.com/problemset/problem/183/D" class="uri">https://codeforces.com/problemset/problem/183/D</a></p><p>å¦‚æœçŸ¥é“ä¸€ä¸ªè¡£æœåºåˆ—ï¼Œæ€ä¹ˆç®—å‡ºæœŸæœ›å‘¢ï¼Ÿ</p><hr /><h2 id="b---two-melodies">B - Two Melodies</h2><p><a href="https://codeforces.com/problemset/problem/813/D" class="uri">https://codeforces.com/problemset/problem/813/D</a></p><p>å¦‚æœè®¾ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºç¬¬ä¸€ä¸ªä»¥ <span class="math inline">\(i\)</span> ç»“å°¾ï¼Œç¬¬äºŒä¸ªä»¥ <span class="math inline">\(j\)</span> ç»“å°¾çš„æ–¹æ¡ˆæ•°ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªå¼Šç«¯â€”â€”å‡è®¾ç°åœ¨æœ‰ <span class="math inline">\(i&gt;j\)</span>ï¼Œåˆå‡è®¾æœ‰ <span class="math inline">\(j&lt;j&#39;&lt;i\)</span>ï¼Œé‚£ä¹ˆå°±ä¸å¯ä»¥ç›´æ¥æŠŠ <span class="math inline">\(f_{i,j}\)</span> è½¬ç§»åˆ° <span class="math inline">\(f_{i,j&#39;}\)</span>ï¼Œå› ä¸º <span class="math inline">\(j&#39;\)</span> å¯èƒ½å·²ç»è¢«ç¬¬ä¸€ä¸ªé€‰è¿‡äº†ã€‚ä½†å¦‚æœä» <span class="math inline">\(i\)</span> è½¬ç§»å°±æ²¡æœ‰è¿™æ ·çš„é—®é¢˜ï¼ˆä¸ç®¡ <span class="math inline">\(i&#39;\)</span> æ˜¯æ¯” <span class="math inline">\(j\)</span> å¤§è¿˜æ˜¯æ¯” <span class="math inline">\(j\)</span> å°ï¼‰ã€‚</p><p>é‚£å°±å¯ä»¥å›ºå®šä»è¾ƒå¤§çš„ä¸€ç»´è½¬ç§»ï¼Œä¹Ÿå¯ä»¥æšä¸¾æ‰€æœ‰æƒ…å†µã€‚ä½†æ˜¯è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯ä¸€ä¸ª <span class="math inline">\(n^3\)</span> çš„è¿‡ç¨‹ï¼Œè€Œä¸”å¯¹äºä¸å•è°ƒçš„å†…å±‚ <span class="math inline">\(j\)</span>ï¼Œç»´æŠ¤å®ƒçš„æ•°å€¼åªèƒ½ç”¨å¸¦ <span class="math inline">\(\log\)</span> çš„æ•°æ®ç»“æ„ä¼˜åŒ–ï¼Œä¼¼ä¹ä¸å¤ªè¿‡å¾—äº†ï¼›ä½† <span class="math inline">\(i\)</span> å´å¯ä»¥å‰ç¼€ä¼˜åŒ–ã€‚</p><p>å…¶å®ï¼Œä¸¤ä¸ªç»„æ˜¯æ— åºçš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥å¼ºåˆ¶ <span class="math inline">\(i&gt;j\)</span> å†ä» <span class="math inline">\(i\)</span> è½¬ç§»ï¼›è¿™ä¸ªæ—¶å€™è½¬ç§»å°±å’Œ <span class="math inline">\(j\)</span> æ²¡æœ‰å¤ªå¤§çš„å…³ç³»äº†ï¼Œå¯ä»¥æŠŠ <span class="math inline">\(j\)</span> æ”¾åˆ°å¤–å±‚ï¼Œå¯¹ <span class="math inline">\(i\)</span> å‰ç¼€ä¼˜åŒ–ã€‚å¯èƒ½éœ€è¦æ³¨æ„è¾¹ç•Œçš„å¤„ç†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, res = 0;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::vector&lt;std::vector&lt;int&gt; &gt; f(n + 1, std::vector&lt;int&gt; (n + 1));    for (int j = 0; j &lt; n; ++j) &#123;        std::vector&lt;int&gt; mx(100002), mmx(7);        for (int i = 1; i &lt; j; ++i) &#123;            mx[a[i]] = std::max(mx[a[i]], f[j][i]);            mmx[a[i] % 7] = std::max(mmx[a[i] % 7], f[j][i]);        &#125;        for (int i = j + 1; i &lt;= n; ++i) &#123;            f[i][j] = std::max(&#123; !!i + !!j, mx[a[i] - 1] + 1, mx[a[i] + 1] + 1, mmx[a[i] % 7] + 1, f[j][0] + 1 &#125;);            mx[a[i]] = std::max(mx[a[i]], f[i][j]);            mmx[a[i] % 7] = std::max(mmx[a[i] % 7], f[i][j]);            // printf(&quot;f[%d][%d] = %d\n&quot;, i, j, f[i][j]);            res = std::max(res, f[i][j]);        &#125;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="cf633f-the-chocolate-spree">CF633F The Chocolate Spree</h2><p><a href="https://codeforces.com/problemset/problem/633/F" class="uri">https://codeforces.com/problemset/problem/633/F</a></p><p>æ•°æ€§ DP æ±‚ç›´å¾„çš„æ—¶å€™ï¼Œæœ‰ä¸€ç§æ–¹æ³•æ˜¯æ‰¾åˆ°æ¯ä¸ªç‚¹ä¸‹é¢çš„æœ€å¤§ä¸¤æ¡ä¸äº¤é“¾ã€‚</p><p>è¿™é‡Œä¹Ÿå¯ä»¥æœ‰ç±»ä¼¼çš„æ±‚æ³•ã€‚å‡è®¾ç­”æ¡ˆå‡ºç°åœ¨å­æ ‘ <span class="math inline">\(u\)</span> ä¸­ï¼ˆä¸‹é¢çš„ <span class="math inline">\(v_i\)</span> éƒ½æ˜¯ <span class="math inline">\(u\)</span> çš„ç›´æ¥å„¿å­ï¼‰ï¼Œå¯ä»¥è®¨è®º <span class="math inline">\(u\)</span> å‚ä¸æ„æˆä¸¤æ¡è·¯å¾„çš„æƒ…å†µï¼š</p><ol type="1"><li>ä¸å‚ä¸æ„æˆä»»ä½•ä¸€æ¡è·¯å¾„ï¼Œç­”æ¡ˆæ˜¯ <span class="math inline">\(v_1,v_2\)</span> å­æ ‘ä¸­çš„æœ€é•¿è·¯å¾„ä¹‹å’Œã€‚</li><li><p>å‚ä¸æ„æˆå…¶ä¸­ä¸€æ¡ï¼š</p><ol type="1"><li>è¿™ä¸€æ¡ä¸å­æ ‘ <span class="math inline">\(v\)</span> å®Œå…¨ç›¸ç¦»ï¼Œç­”æ¡ˆæ˜¯ <span class="math inline">\(v\)</span> ä¸­æœ€é•¿è·¯å¾„ï¼Œå’Œ <span class="math inline">\(u\)</span> ä¸‹é¢ä¸ç»è¿‡ <span class="math inline">\(v\)</span> çš„æœ€å¤§ä¸¤æ¡ä¸äº¤é“¾ã€‚</li><li>è¿™ä¸€æ¡æœ‰ä¸€æ”¯æ¥è‡ª <span class="math inline">\(v\)</span> å­æ ‘ï¼Œä½†å’Œ <span class="math inline">\(v\)</span> ä¸­æœ€é•¿è·¯å¾„æ²¡æœ‰é‡åˆçš„ç‚¹ã€‚ç­”æ¡ˆæ˜¯ <span class="math inline">\(u\)</span> çš„ç‚¹æƒã€<span class="math inline">\(u\)</span> ä¸‹é¢ä¸ç»è¿‡ <span class="math inline">\(v\)</span> çš„æœ€å¤§é“¾ã€<span class="math inline">\(v\)</span> ä¸­ä¸€æ¡è·¯å¾„ï¼ˆä¸ç»è¿‡ <span class="math inline">\(v\)</span>ï¼‰å’Œ <span class="math inline">\(v\)</span> ä¸‹é¢ä¸€æ¡é“¾ä¹‹å’Œçš„æœ€å¤§å€¼ï¼›</li><li>è¿™ä¸€æ¡ä¸¤æ”¯éƒ½æ¥è‡ª <span class="math inline">\(v\)</span> å­æ ‘ï¼šæœ‰é‡åˆï¼Œä¸å¯èƒ½å‘ç”Ÿã€‚</li></ol></li><li><p>å‚ä¸æ„æˆå…¶ä¸­ä¸¤æ¡ï¼Œç­”æ¡ˆæ˜¯ <span class="math inline">\(u\)</span> ä¸‹é¢æœ€é•¿çš„å››æ¡é“¾ï¼šè·¯å¾„é‡å¤ç»è¿‡ <span class="math inline">\(u\)</span>ï¼Œä¸å¯èƒ½å‘ç”Ÿã€‚</p></li></ol><p><img src="2.png" /></p><p>å¯ä»¥è®°å½• <span class="math inline">\(u\)</span> ä¸‹æ–¹æœ€å¤§çš„å››æ¡ä¸äº¤é“¾ã€<span class="math inline">\(u\)</span> ä¸­é€‰å–ä¸€æ¡ä¸ç»è¿‡ <span class="math inline">\(u\)</span> çš„è·¯å¾„å’Œ <span class="math inline">\(u\)</span> ä¸‹æ–¹ä¸€æ¡é“¾ä¹‹å’Œçš„æœ€å¤§å€¼ã€<span class="math inline">\(u\)</span> ä¸­æœ€é•¿è·¯å¾„æ±‚è§£ã€‚</p><details><pre class="cpp language-cpp" data-line="42-44"><code class="cpp langauage-cpp">#include &lt;bits/stdc++.h>int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(".in", "r", stdin);    std::freopen(".out", "w", stdout);#endif    int n;    std::cin >> n;    std::vector&lt;int> a(n + 1);    std::vector&lt;std::vector&lt;int> > g(n + 1);    for (int i = 1; i <= n; ++i)        std::cin >> a[i];    for (int i = 1, x, y; i < n; ++i) &#123;        std::cin >> x >> y;        g[x].push_back(y), g[y].push_back(x);    &#125;    auto res(0ll);    std::vector&lt;long long> s(n + 1), w(n + 1);    std::vector&lt;std::vector&lt;std::pair&lt;long long, int> > > f(n + 1, std::vector&lt;std::pair&lt;long long, int> > (4));    std::function&lt;void(int, int)> DFS = [&](int x, int fa) &#123;        f[x][0] = &#123; 0, x &#125;;        w[x] = s[x] = a[x];        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                &#123;                    if (f[i][0].first + a[i] > f[x][3].first)                        f[x][3].first = f[i][0].first + a[i], f[x][3].second = i;                    std::sort(f[x].begin(), f[x].end(), std::greater&lt;std::pair&lt;long long, int> > ());                &#125;                w[x] = std::max(w[x], w[i] + a[x]);            &#125;        auto mx(0ll);        for (auto i : g[x])            if (i != fa) &#123;                s[x] = std::max(&#123; s[x], s[i], f[x][0].first + f[x][1].first + a[x] &#125;);                w[x] = std::max(w[x], (f[x][0].second != i ? f[x][0] : f[x][1]).first + s[i] + a[x]);                res = std::max(&#123; res,                    mx + s[i], // æƒ…å†µ 1                    (f[x][0].second == i ? f[x][1].first + f[x][2].first : (f[x][1].second == i ? f[x][0].first + f[x][2].first : f[x][0].first + f[x][1].first)) + s[i] + a[x], // æƒ…å†µ 2.1                    (f[x][0].second == i ? f[x][1].first : f[x][0].first) + w[i] + a[x], // æƒ…å†µ 2.2                &#125;);                mx = std::max(mx, s[i]);            &#125;    //     printf("%d: res = %lld\n  f: \n", a[x], res);    //     for (int i = 0; i < 4; ++i)    //         printf("    [%d] %lld\n", f[x][i].second, f[x][i].first);    //     printf("  s: %lld\n  w: %lld\n", s[x], w[x]);    &#125;;    DFS(1, -1);    std::cout << res << '\n';    return 0;&#125;</code></pre></details><hr /><h2 id="c---å·¡é€»">C - å·¡é€»</h2><p><a href="https://www.luogu.com.cn/problem/P3629" class="uri">https://www.luogu.com.cn/problem/P3629</a></p><p>ä½ å¯èƒ½éœ€è¦æ³¨æ„ï¼šç›®çš„æ˜¯éå†æ‰€æœ‰è¾¹è€Œéæ‰€æœ‰ç‚¹ã€‚</p><p><span class="math inline">\(K=1\)</span> çš„æ—¶å€™ï¼Œç¯ä¸Šé™¤äº†å…³é”®è¾¹çš„æ‰€æœ‰è¾¹ç»è¿‡æ¬¡æ•°ä¼šå‡ <span class="math inline">\(1\)</span>ã€‚æ‰€ä»¥é€‰æ ‘çš„ç›´å¾„å°±å¯ä»¥æœ€ä¼˜ã€‚</p><p><span class="math inline">\(K=2\)</span> çš„æ—¶å€™ï¼Œç­”æ¡ˆæ˜¯ <span class="math inline">\(2\times (m + 2)\)</span> å‡å»ä¸¤ä¸ªè¾¹æ„æˆçš„ç¯çš„ <em>å¹¶é›†å‡äº¤é›†</em> å¤§å° <span class="math inline">\(L\)</span>ã€‚ç¯å®é™…ä¸Šæ˜¯ä¸å­˜åœ¨çš„ï¼Œ<span class="math inline">\(L\)</span> å…¶å®æ˜¯ä¸¤æ¡è·¯å¾„ <em>å¹¶é›†å‡äº¤é›†</em> å†åŠ ä¸Šä¸¤æ¡æ–°è¾¹çš„å€¼ã€‚</p><p>ä¸¤æ¡è·¯å¾„æœ‰äº¤çš„æ—¶å€™ï¼Œå¯ä»¥ç­‰æ•ˆæˆæ— äº¤çš„æƒ…å†µï¼š</p><p><img src="1.png" /></p><p>å°±åˆ’å½’æˆä¸Šä¸€ä¸ªé—®é¢˜äº†ã€‚æ³¨æ„æ­¤æ—¶æƒ…å†µ 3 å¯èƒ½å‘ç”Ÿï¼›åŒæ—¶æƒ…å†µ 2.2 å¯ä»¥é€‰å–ç»è¿‡ <span class="math inline">\(v\)</span> çš„è·¯å¾„ã€‚</p><details><pre class="cpp language-cpp" data-line="55-56,64-67"><code class="cpp langauage-cpp">#include &lt;bits/stdc++.h>int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(".in", "r", stdin);    std::freopen(".out", "w", stdout);#endif    int n, k;    std::cin >> n >> k;    std::vector&lt;std::vector&lt;int> > g(n + 1);    for (int i = 1, x, y; i < n; ++i) &#123;        std::cin >> x >> y;        g[x].push_back(y), g[y].push_back(x);    &#125;    int res = 0;    if (k == 1) &#123;        std::vector&lt;std::vector&lt;std::pair&lt;int, int> > > f(n + 1, std::vector&lt;std::pair&lt;int, int> > (2));        std::function&lt;void(int, int)> DFS = [&](int x, int fa) &#123;            f[x][0] = &#123; 0, x &#125;;            for (auto i : g[x])                if (i != fa) &#123;                    DFS(i, x);                    &#123;                        if (f[i][0].first + 1 > f[x][1].first)                            f[x][1].first = f[i][0].first + 1, f[x][1].second = i;                        std::sort(f[x].begin(), f[x].end(), std::greater&lt;std::pair&lt;int, int> > ());                    &#125;                &#125;            res = std::max(res, f[x][0].first + f[x][1].first);        &#125;;        DFS(1, -1);        std::cout << 2 * n - res - 1 << '\n';    &#125;    else &#123;        std::vector&lt;int> s(n + 1), w(n + 1);        std::vector&lt;std::vector&lt;std::pair&lt;int, int> > > f(n + 1, std::vector&lt;std::pair&lt;int, int> > (4));        std::function&lt;void(int, int)> DFS = [&](int x, int fa) &#123;            f[x][0] = &#123; 0, x &#125;;            for (auto i : g[x])                if (i != fa) &#123;                    DFS(i, x);                    &#123;                        if (f[i][0].first + 1 > f[x][3].first)                            f[x][3].first = f[i][0].first + 1, f[x][3].second = i;                        std::sort(f[x].begin(), f[x].end(), std::greater&lt;std::pair&lt;int, int> > ());                    &#125;                    w[x] = std::max(w[x], w[i] + 1);                &#125;            &#123;                int t = 0;                for (auto [v, id] : f[x])                    t += v;                res = std::max(res, t); // æƒ…å†µ 3                w[x] = std::max(w[x], t - f[x][3].first); // è·¯å¾„å¯ç»è¿‡ u            &#125;            int mx = 0;            for (auto i : g[x])                if (i != fa) &#123;                    s[x] = std::max(&#123; s[x], s[i], f[x][0].first + f[x][1].first &#125;);                    w[x] = std::max(w[x], (f[x][0].second != i ? f[x][0] : f[x][1]).first + std::max(s[i], f[i][0].first + 1));                    res = std::max(&#123; res,                        mx + s[i], // æƒ…å†µ 1                        (f[x][0].second == i ? f[x][1].first + f[x][2].first : (f[x][1].second == i ? f[x][0].first + f[x][2].first : f[x][0].first + f[x][1].first)) + s[i], // æƒ…å†µ 2.1                        (f[x][0].second == i ? f[x][1].first : f[x][0].first) + w[i] + 1, // æƒ…å†µ 2.2                    &#125;);                    mx = std::max(mx, s[i]);                &#125;        &#125;;        DFS(1, -1);        std::cout << 2 * (n + 1) - res - 2 << '\n';    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="d---ç¬é—´ä¼ é€-teleport">D - ç¬é—´ä¼ é€ / Teleport</h2><p><a href="https://www.luogu.com.cn/problem/P11915" class="uri">https://www.luogu.com.cn/problem/P11915</a></p><p>éœ€è¦è§‚å¯Ÿåˆ°ä¸€ä¸ªå¾ˆå‰å®³çš„è´ªå¿ƒç­–ç•¥ï¼šå¦‚æœé’¦å®šæ‰€æœ‰ç‚¹çš„è·ç¦»ä¸å¤§äº <span class="math inline">\(r\)</span>ï¼Œä¸”å­˜åœ¨ <span class="math inline">\(d(i,j)&gt;r\)</span>ã€‚<strong>å‡è®¾</strong> ä¸€ç§æ»¡è¶³æ¡ä»¶çš„æ–°è¾¹æ˜¯ <span class="math inline">\((u,v)\)</span>ï¼ˆç”±äºä¸¤è€…æ— åºï¼Œä¸å¦¨é’¦å®š <span class="math inline">\(d(i,u)&lt;d(i,v)\)</span>ï¼‰ï¼Œå¯ä»¥è¿›è¡Œè®¨è®ºï¼š</p><ol type="1"><li><p><span class="math inline">\(d(j,v)&lt;d(j,u)\)</span>ï¼š</p>æ­¤æ—¶æœ€ä¼˜è·¯å¾„ä¸º <span class="math inline">\(i\to u\to v\to j\)</span>ï¼Œåˆ¤æ–­ä¸€ä¸‹è¿™ç§æ–¹æ¡ˆæ˜¯å¦ä¸å¤§äº <span class="math inline">\(r\)</span> å°±å¯ä»¥äº†ã€‚</li><li><p><span class="math inline">\(d(j,v)\ge d(j, u)\)</span>ï¼š</p><p>æ­¤æ—¶ä¸ç®¡æ˜¯èµ° <span class="math inline">\(i\to u\to v\to j\)</span> è¿˜æ˜¯ <span class="math inline">\(i\to v\to u\to j\)</span> éƒ½ä¸å¦‚èµ°å·²ç»å­˜åœ¨çš„ <span class="math inline">\(i\to u\to j\)</span> è¿™æ¡è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¦èµ°æ–°è¾¹ï¼Œä»£ä»·æ˜¯ä¸€å®šæ¯”åŸè·ç¦»å¤§ï¼Œæ›´æ˜¯æ¯” <span class="math inline">\(r\)</span> å¤§çš„ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class="math inline">\((u,v)\)</span> ä¸èƒ½è§£å†³ <span class="math inline">\((i,j)\)</span> ä¹‹é—´çš„é—®é¢˜ï¼Œå‡è®¾å°±ä¸æˆç«‹äº†ã€‚</p></li></ol><p>ç»¼ä¸Šï¼Œåªéœ€è¦åˆ¤æ–­ <span class="math inline">\(i\to u\to v\to j\le r\)</span> æ˜¯å¦æˆç«‹ï¼Œå°±å¯ä»¥åˆ¤æ–­ <span class="math inline">\((u,v)\)</span> æ˜¯å¦åˆæ³•ã€‚ä»å¤§åˆ°å°æšä¸¾ <span class="math inline">\(r\)</span>ï¼ŒåŒæ—¶ç»´æŠ¤å½“å‰ä¾ç„¶åˆæ³•çš„ <span class="math inline">\((u,v)\)</span>ï¼ˆæ˜¾ç„¶æ˜¯æœ‰å•è°ƒæ€§çš„ï¼‰ï¼Œå¯¹äºä¸åˆæ³•çš„ <span class="math inline">\((i,j)\)</span>ï¼Œæšä¸¾æ¯ä¸ª <span class="math inline">\(i\)</span>ï¼Œç»´æŠ¤ <span class="math inline">\(\max\{d(v,j)\}\)</span>ï¼Œç²¾ç»†å®ç°ï¼ˆä¸»è¦æ˜¯åˆ©ç”¨å„ç§å‡æ‘Šï¼‰ä¸€ä¸‹å°±èƒ½ <span class="math inline">\(O(n^3)\)</span>ã€‚</p><p>è¿™é‡Œå…·ä½“æä¸€ä¸‹éœ€è¦æ‘Šçš„å‡ ä¸ªç‚¹ï¼š</p><ol type="1"><li>æšä¸¾åˆ° <span class="math inline">\(r\)</span> çš„æ—¶å€™ç”¨æ‰€æœ‰ <span class="math inline">\(d(i,j)=r+1\)</span> æŠŠ <span class="math inline">\(v\)</span> åœ¨ <span class="math inline">\(i\)</span> å¤„çš„æœ€å¤§ <span class="math inline">\(d(v,j)\)</span> æ›´æ–°ï¼Œæ–¹ä¾¿åé¢ <span class="math inline">\(O(n)\)</span> åœ° checkã€‚æ‘Šå‡ºæ¥æ˜¯ <span class="math inline">\(O(n^3)\)</span> çš„ã€‚</li><li>æšä¸¾ä»ç„¶å¤„åœ¨åˆæ³•é˜Ÿåˆ—é‡Œçš„ <span class="math inline">\((u,v)\)</span>ï¼Œå¦‚æœ check åˆæ³•ï¼Œå°±è¯´æ˜å¯¹äºå½“å‰ <span class="math inline">\(r\)</span> è‡³å°‘å­˜åœ¨ä¸€ä¸ªåˆæ³•è§£ï¼Œå°±å¯ä»¥ <code>break</code> äº†ï¼›å¦åˆ™ï¼ŒæŠŠ <span class="math inline">\((u,v)\)</span> å¼¹å‡ºï¼Œç»§ç»­ check ä¸‹ä¸€æ¡è¾¹ã€‚è¿™æ ·æ¯æ¡è¾¹åªä¼šè¢«å¼¹å‡ºä¸€æ¬¡ï¼Œè€Œæœªå¼¹å‡ºè¾¹çš„ check æ¬¡æ•°æœ€å¤šæ˜¯ <span class="math inline">\(O(n)\)</span>ï¼›åŠ ä¸Š <span class="math inline">\(O(n)\)</span> çš„ checkï¼Œæ‘Šå‡ºæ¥æ˜¯ <span class="math inline">\(O(n^3)\)</span> çš„ã€‚</li></ol><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n;        std::cin &gt;&gt; n;        std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1, std::vector&lt;int&gt; (n + 1, inf));        for (int i = 1; i &lt;= n; ++i)            for (int j = 1; j &lt;= n; ++j) &#123;                char t;                std::cin &gt;&gt; t;                if (t == &#39;1&#39; || i == j)                    g[i][j] = t - &#39;0&#39;;            &#125;        for (int k = 1; k &lt;= n; ++k)            for (int i = 1; i &lt;= n; ++i)                if (i != k)                    for (int j = 1; j &lt;= n; ++j)                        if (j != i &amp;&amp; j != k)                            g[i][j] = std::min(g[i][j], g[i][k] + g[k][j]);        std::queue&lt;std::pair&lt;int, int&gt; &gt; q;        std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; p(n + 1);        std::vector&lt;std::vector&lt;int&gt; &gt; mx(n + 1, std::vector&lt;int&gt; (n + 1));        for (int i = 1; i &lt; n; ++i)            for (int j = i + 1; j &lt;= n; ++j) &#123;                q.emplace(i, j);                p[g[i][j] - 1].emplace_back(i, j);            &#125;        auto check = [&amp;](int u, int v, int r) &#123;            for (int i = 1; i &lt;= n; ++i) &#123;                if (g[u][i] &gt; g[v][i])                    std::swap(u, v);                if (g[u][i] + mx[v][i] &gt; r)                    return false;            &#125;            return true;        &#125;;        for (int r = n; r &gt;= -1; --r) &#123;            for (auto [i, j] : p[r])                for (int v = 1; v &lt;= n; ++v) &#123;                    mx[v][i] = std::max(mx[v][i], g[v][j]);                    mx[v][j] = std::max(mx[v][j], g[v][i]);                &#125;            for (; !q.empty(); ) &#123;                auto [u, v] = q.front();                if (!check(u, v, r))                    q.pop();                else                    break;            &#125;            if (q.empty()) &#123;                std::cout &lt;&lt; r + 1 &lt;&lt; &#39;\n&#39;;                break;            &#125;        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="e.-two-tanks">E. Two Tanks</h2><p><a href="https://codeforces.com/problemset/problem/1809/E" class="uri">https://codeforces.com/problemset/problem/1809/E</a></p><p>æœç„¶è¿˜æ˜¯ä¸ä¼šç®€å• DP <img src="/em/ll.gif" /></p><p>å¯ä»¥è§‚å¯Ÿåˆ°å¦‚æœæ€»æ°´é‡ç›¸åŒï¼Œä¸”æŸä¸ªæ—¶åˆ»ä¸¤ç§åˆå§‹çŠ¶æ€å½“å‰æ˜¯ç›¸åŒçŠ¶æ€ï¼Œé‚£ä¹ˆä»¥åå®ƒä»¬ä¹Ÿä¼šæ˜¯ç›¸åŒçŠ¶æ€ã€‚ä½†å…‰å‡­è¿™ä¸ªå¥½åƒè¿˜æ˜¯ä¸å¤ªèƒ½åšå‡ºæ¥çš„æ ·å­ <img src="/em/kt.gif" /></p><p>è¿™é‡Œå¤§æ¦‚ç®—ä¸€ä¸ªå®šå¼ï¼Œå¯¹äºç±»ä¼¼è¿™ç§ä¸¤ä¸ªå…ƒç´ æ€»å’Œä¸å˜çš„é—®é¢˜ï¼Œå¯ä»¥æŠŠä¸¤ä¸ªå…ƒç´ çš„å®¹é‡ç”»åˆ°æ•°è½´ä¸Šï¼ŒåŸç‚¹è¡¨ç¤ºåˆ†ç•Œï¼Œå½“å‰æ°´ä¸ºä¸€æ¡å®šé•¿çº¿æ®µï¼Œå€’æ°´å°±ç›¸å½“äºå·¦å³å¹³ç§»è¿™æ¡çº¿æ®µï¼š</p><p><img src="3.png" /></p><p>éœ€è¦æ„è¯†åˆ°ï¼Œ<mark></mark></p>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> è´ªå¿ƒ </tag>
            
            <tag> å‡æ‘Š </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘æ ¼å›¾è·¯å¾„è®¡æ•°</title>
      <link href="/20250419/"/>
      <url>/20250419/</url>
      
        <content type="html"><![CDATA[<figure><img src="/20250419/neko.jpeg" alt="çŒ«" style="width: 75px"><figcaption>çŒ«</figcaption></figure><span id="more"></span><hr /><h2 id="ç‚¹åˆ°ç‚¹çš„æ–¹æ¡ˆæ•°">ç‚¹åˆ°ç‚¹çš„æ–¹æ¡ˆæ•°</h2><p>ä» <span class="math inline">\((x_1,y_1)\)</span> åªèƒ½å‘å³ã€å‘ä¸‹èµ°åˆ° <span class="math inline">\((x_2,y_2)\)</span> çš„æ–¹æ¡ˆæ•°ï¼š<span class="math inline">\(C_{x_2-x_1+y_2-y_1}^{x_2-x_1}\)</span>ã€‚å°±æ˜¯è¯´ï¼Œå› ä¸ºå¿…é¡»å‘ä¸‹èµ° <span class="math inline">\(x_2-x_1\)</span> æ­¥ï¼Œåˆå¿…é¡»å‘å³èµ° <span class="math inline">\(y_2-y_1\)</span> æ­¥ï¼›ä½†é¡ºåºæ˜¯å¯ä»¥ä»»æ„æ‰“ä¹±çš„ã€‚</p><hr /><h3 id="a---gerald-and-giant-chess">A - Gerald and Giant Chess</h3><p><a href="https://codeforces.com/problemset/problem/560/E" class="uri">https://codeforces.com/problemset/problem/560/E</a></p><p>æŠŠä¸èƒ½èµ°çš„ç‚¹æŒ‰ <span class="math inline">\(x\)</span> ä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œ<span class="math inline">\(y\)</span> ä¸ºç¬¬äºŒå…³é”®å­—æ’åºï¼Œå°±å¯ä»¥å¾—åˆ°å®ƒä»¬æŒ‰å¤§è‡´æ‹“æ‰‘åºæ’åˆ—çš„ç»“æœã€‚</p><p>ä»¤ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºä¸ç»è¿‡ <span class="math inline">\(1\sim i-1\)</span> çš„éæ³•ç‚¹èµ°åˆ°ç¬¬ <span class="math inline">\(i\)</span> ä¸ªéæ³•ç‚¹çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥å¾—åˆ° <span class="math inline">\(f_i=C_{x_i+y_i,x_i}-\sum_{j=1}^{i-1} f_j\times C_{x_i-x_j+y_i-y_j}^{x_i-x_j}\)</span>ã€‚å¯ä»¥å‘ç°åé¢å‡å»çš„æ–¹æ¡ˆï¼Œå› ä¸ºç¢°åˆ°çš„ç¬¬ä¸€ä¸ªéæ³•ç‚¹ä¸åŒï¼Œæ‰€ä»¥æ˜¯ä¸¤ä¸¤ä¸åŒçš„ã€‚</p><p>è®© <span class="math inline">\((h,w)\)</span> æˆä¸ºç¬¬ <span class="math inline">\((n+1)\)</span> ä¸ªéæ³•ç‚¹ï¼Œ<span class="math inline">\(f_{n+1}\)</span> å°±æ˜¯ç­”æ¡ˆã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int h, w, n;    std::cin &gt;&gt; h &gt;&gt; w &gt;&gt; n, --h, --w;    std::vector&lt;std::pair&lt;int, int&gt; &gt; a(n + 2);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i].first &gt;&gt; a[i].second;        --a[i].first, --a[i].second;    &#125;    a[n + 1] = &#123; h, w &#125;;    std::sort(a.begin() + 1, a.end());    std::vector&lt;long long&gt; fac(h + w + 1), inv(h + w + 1);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= h + w; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [](long long x, int y) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[h + w] = qkp(fac[h + w], mod - 2);    for (int i = h + w - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    std::vector&lt;long long&gt; f(n + 2);    for (int i = 1; i &lt;= n + 1; ++i) &#123;        f[i] = C(a[i].first + a[i].second, a[i].first);        for (int j = 1; j &lt; i; ++j)            if (a[j].second &lt;= a[i].second)                (f[i] += mod - f[j] * C(a[i].first - a[j].first + a[i].second - a[j].second, a[i].first - a[j].first) % mod) %= mod;        // printf(&quot;f[(%d, %d)] = %lld\n&quot;, a[i].first, a[i].second, f[i]);    &#125;    std::cout &lt;&lt; f[n + 1] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="b---bbq-hard">B - BBQ Hard</h3><p><a href="https://atcoder.jp/contests/agc001/tasks/agc001_e" class="uri">https://atcoder.jp/contests/agc001/tasks/agc001_e</a></p><p>ä¸ä»…ä»…å¯ä»¥åœ¨å…³é”®ç‚¹ä¸Š DPï¼Œä¹Ÿå¯ä»¥åœ¨ç½‘æ ¼ä¸Šç›´æ¥ DPã€‚</p><p><span class="math inline">\(A_i+B_i+A_j+B_j\)</span> å°±æ˜¯ <span class="math inline">\(A_i+B_i-(-A_j)-(-B_j)\)</span>ã€‚æŠŠæ£‹ç›˜æ‰©å¤§åˆ° <span class="math inline">\(-2000\to 2000\)</span> å°±å¯ä»¥äº†ã€‚</p><p>è®¾ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºå¯ä»¥åˆ°è¾¾ <span class="math inline">\((i,j)\)</span> çš„æ‰€æœ‰å‘å‡ºå…³é”®ç‚¹ <span class="math inline">\((-A_j,-B_j)\)</span> å¸¦æ¥çš„è´¡çŒ®ï¼Œé‚£ä¹ˆ <span class="math inline">\(f_{i,j}=f_{i-1,j}+f_{i,j-1}\)</span>ã€‚æšä¸¾æ‰€æœ‰æ¥æ”¶å…³é”®ç‚¹ <span class="math inline">\((A_i,B_i)\)</span>ï¼Œ<span class="math inline">\(\sum f_{A_i,B_i}\)</span> å°±æ˜¯ç­”æ¡ˆçš„ä¸¤å€ï¼Œå†å‡å»å¯¹è§’çº¿ï¼Œä¹Ÿå°±æ˜¯ <span class="math inline">\(\sum (-A_i,B_i)\to (A_i,B_i)\)</span> åçš„å€¼ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int N = 2000;const int mod = 1e9 + 7;const int inv2 = 500000004;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; fac(4 * N + 1), inv(4 * N + 1);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= 4 * N; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[4 * N] = qkp(fac[4 * N], mod - 2);    for (int i = 4 * N - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    std::vector&lt;std::pair&lt;int, int&gt; &gt; a(n + 1);    std::vector&lt;std::vector&lt;long long&gt; &gt; f(2 * N + 1, std::vector&lt;long long&gt; (2 * N + 1));    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i].first &gt;&gt; a[i].second;        ++f[N - a[i].first][N - a[i].second];    &#125;    for (int i = 0; i &lt;= 2 * N; ++i)        for (int j = 0; j &lt;= 2 * N; ++j) &#123;            if (i &gt;= 1)                (f[i][j] += f[i - 1][j]) %= mod;            if (j &gt;= 1)                (f[i][j] += f[i][j - 1]) %= mod;            // printf(&quot;f(%2d, %2d) = %lld\n&quot;, i - N, j - N, f[i][j]);        &#125;    long long res = 0ll;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    for (int i = 1; i &lt;= n; ++i) &#123;        (res += f[a[i].first + N][a[i].second + N]) %= mod;        (res += mod - C(a[i].first * 2 + a[i].second * 2, 2 * a[i].first)) %= mod;    &#125;    std::cout &lt;&lt; res * inv2 % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="c---iroha-and-a-grid">C - Iroha and a Grid</h3><p><a href="https://atcoder.jp/contests/arc058/tasks/arc058_b" class="uri">https://atcoder.jp/contests/arc058/tasks/arc058_b</a></p><p>å…ˆæŠŠç»¿è‰²éƒ¨åˆ†çš„ç­”æ¡ˆè®¡ç®—å‡ºæ¥ï¼š</p><figure><img src="1.png" alt="ç½‘æ ¼" /><figcaption>ç½‘æ ¼</figcaption></figure><p>å¦‚æœæŠŠç»¿è‰²çš„æ¯ä¸€ä¸ªæ ¼å­åˆ°ç»ˆç‚¹çš„æ–¹æ¡ˆæ•°æ±‚å’Œï¼Œå°±ä¼šç®—é‡ï¼Œå› ä¸ºä¸Šé¢çš„ç»¿è‰²ç‚¹å¯ä»¥èµ°åˆ°ä¸‹é¢çš„ç»¿è‰²ç‚¹ã€‚</p><p>è®©ç»¿è‰²ç‚¹ç¬¬ä¸€æ­¥åªèƒ½å¾€å³èµ°åˆ°é»„è‰²ç‚¹ï¼Œç”¨è¿™æ ·çš„æ–¹æ¡ˆä¸ºé»„è‰²ç‚¹èµ‹åˆå€¼ï¼Œå†è®©é»„è‰²ç‚¹è‡ªç”±èµ°å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int h, w, a, b;    std::cin &gt;&gt; h &gt;&gt; w &gt;&gt; a &gt;&gt; b;    std::vector&lt;long long&gt; fac(h + w + 1), inv(h + w + 1);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= h + w; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[h + w] = qkp(fac[h + w], mod - 2);    for (int i = h + w - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    auto res = 0ll;    for (int i = 1; i &lt;= h - a; ++i) &#123;        // (i, B)        auto f(C(i + b - 2, i - 1));        // printf(&quot;(%d, %d): %lld\n&quot;, i, b, f);        // (i, B + 1)        (res += f * C(h - i + w - (b + 1), h - i) % mod) %= mod;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="ç‚¹åˆ°çŸ©å½¢çš„æ–¹æ¡ˆæ•°">ç‚¹åˆ°çŸ©å½¢çš„æ–¹æ¡ˆæ•°</h2><p>ä» <span class="math inline">\((x_0,y_0)\)</span> èµ°åˆ°çŸ©å½¢ <span class="math inline">\((x_1,y_1,x_2,y_2)\)</span> çš„æ–¹æ¡ˆæ•°ï¼š</p><p><span class="math display">\[\sum\limits_{i\in [x_1,x_2],j\in [y_1,y_2]} G(x_0,y_0, i, j) = G(x_0,y_0,x_2 + 1,y_2 + 1)-G(x_0,y_0,x_2+1,y_1)-G(x_0,y_0,x_1,y_2+1)+G(x_0,y_0,x_1,y_1)\]</span></p><p>è¯æ˜ï¼š<span class="math inline">\(G(x_0,y_0,x_2+1,y_2+1)=\sum\limits_i G(x_0,y_0,i,y_2)=\sum\limits_{i,j} G(x_0,y_0,i,j)\)</span>ï¼Œç±»ä¼¼çš„ï¼ŒæŠŠåé¢å‡ é¡¹å±•å¼€ï¼Œå¯ä»¥å¾—åˆ°å‰ç¼€å’Œçš„ç»“æ„ã€‚</p><p>ç°åœ¨ï¼ŒçŸ©å½¢å°±å¯ä»¥è¢«æ¦‚æ‹¬æˆ 4 ä¸ªç‚¹äº†ã€‚</p><hr /><h2 id="çŸ©å½¢åˆ°çŸ©å½¢çš„æ–¹æ¡ˆæ•°">çŸ©å½¢åˆ°çŸ©å½¢çš„æ–¹æ¡ˆæ•°</h2><p>æšä¸¾ç¬¬ä¸€ä¸ªçŸ©å½¢é‡Œçš„æ‰€æœ‰ç‚¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°å…³äºç¬¬äºŒä¸ªçŸ©å½¢é‡Œå››ä¸ªç‚¹çš„è¡¨è¾¾å¼ã€‚åè¿‡æ¥æŠŠç¬¬ä¸€ä¸ªçŸ©å½¢æ¦‚æ‹¬ä¸º 4 ä¸ªç‚¹å°±å¯ä»¥å¿«é€Ÿæ±‚è§£äº†ã€‚</p><p>å…·ä½“ä¸€ç‚¹ï¼Œç¬¬ä¸€ä¸ªçŸ©å½¢ <span class="math inline">\((x_1,y_1,x_2,y_2)\)</span> å¯ä»¥è¢«æ¦‚æ‹¬ä¸º <span class="math inline">\((x_1-1,y_1-1)\)</span>ï¼Œ<span class="math inline">\((x_1-1,y_2)\)</span>ï¼Œ<span class="math inline">\((x_2,y_1-1)\)</span>ï¼Œ<span class="math inline">\((x_2,y_2)\)</span>ã€‚æ³¨æ„æ–¹å‘é¢ å€’å¯¼è‡´ç¬¦å·å‘ç”Ÿå˜åŒ–ã€‚æ­¤æ—¶å¯¹ <span class="math inline">\(4\times 4=16\)</span> ä¸ª <span class="math inline">\(G\)</span> æŒ‰å¯¹åº”çš„ <span class="math inline">\(-1/1\)</span> ç³»æ•°æ±‚å’Œå°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚</p><hr /><h3 id="d---sightseeing-plan">D - Sightseeing Plan</h3><p><a href="https://atcoder.jp/contests/agc018/tasks/agc018_e" class="uri">https://atcoder.jp/contests/agc018/tasks/agc018_e</a></p><ol type="1"><li>æ’ç­‰å¼ï¼š<span class="math inline">\(\sum\limits_{i\in [x_1,x_2]}G_(x_1,y_1,i,y_2-1)=G(x_1,y_1,x_2,y_2)\)</span>ï¼Œæ”¾åœ¨ç½‘æ ¼å›¾ä¸Šå°±æ˜¯å¼ºåˆ¶èµ°åˆ° <span class="math inline">\((i,y_2-1)\)</span>ï¼Œå†å¼ºåˆ¶å‘å³èµ°ä¸€æ­¥ï¼Œç„¶åå‘ä¸Šèµ°åˆ° <span class="math inline">\((x_2,y_2)\)</span>ã€‚å’Œä¸Šä¸€é¢˜ç±»ä¼¼çš„ï¼Œå¯ä»¥å‘ç°ä¸é‡ä¸æ¼ã€‚</li><li>ä¸‰ä¸ªçŸ©å½¢ï¼Œ<span class="math inline">\(M_1\)</span> ç»è¿‡ <span class="math inline">\(M_2\)</span> åˆ°è¾¾ <span class="math inline">\(M_3\)</span> çš„è·¯å¾„æ•°é‡ï¼šç»è¿‡ <span class="math inline">\(M_2\)</span> æ—¶ï¼Œæ ¹æ®é™åˆ¶ï¼Œåªå¯èƒ½ä»ä¸‹é¢æˆ–å·¦è¾¹è¿›å…¥ã€‚æšä¸¾è¿›å…¥çš„ç‚¹ <span class="math inline">\((x_0,y_0)\)</span>ï¼ˆæ•°é‡ä¸º <span class="math inline">\(O(n)\)</span>ï¼‰ï¼Œå†è®¡ç®— <span class="math inline">\(G(x_0,y_0,M_3)\)</span> å°±èƒ½å¾—åˆ°ä¸é‡ä¸æ¼çš„ç­”æ¡ˆã€‚</li><li>åŸé—®é¢˜ï¼šè¦æ±‚ <span class="math inline">\(M_2\)</span> å†…éƒ¨è·¯å¾„ä¸Šç‚¹çš„è´¡çŒ®å’Œï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯ <span class="math inline">\(M_2\)</span> å†…éƒ¨è·¯å¾„é•¿åº¦ã€‚è‹¥ä» <span class="math inline">\((x_1,y_1)\)</span> è¿›å…¥ï¼Œå†ä» <span class="math inline">\((x_2,y_2)\)</span> ç¦»å¼€ï¼Œé•¿åº¦å°±æ˜¯ <span class="math inline">\(x_2-x_1+y_2-y_1+1\)</span>ã€‚æ‹†æˆ <span class="math inline">\((x_2+y_2+1)\)</span> å’Œ <span class="math inline">\(-(x_1+y_1)\)</span> åå‘ç°ä¸€æ¬¡è¿›å…¥å’Œä¸€æ¬¡ç¦»å¼€çš„è´¡çŒ®æ˜¯ç‹¬ç«‹çš„ã€‚åˆ†åˆ«æšä¸¾è¿›å…¥ç‚¹å’Œç¦»å¼€ç‚¹è®¡ç®—è´¡çŒ®å°±å¯ä»¥äº†ã€‚</li></ol><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int N = 2e6;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int x1, x2, x3, x4, x5, x6, y1, y2, y3, y4, y5, y6;    std::cin &gt;&gt; x1 &gt;&gt; x2 &gt;&gt; x3 &gt;&gt; x4 &gt;&gt; x5 &gt;&gt; x6;    std::cin &gt;&gt; y1 &gt;&gt; y2 &gt;&gt; y3 &gt;&gt; y4 &gt;&gt; y5 &gt;&gt; y6;    std::vector&lt;long long&gt; fac(N + 1), inv(N + 1);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= N; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[N] = qkp(fac[N], mod - 2);    for (int i = N - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    std::vector&lt;std::tuple&lt;int, int, int&gt; &gt; f(4), g(4);    f[0] = &#123; x1 - 1, y1 - 1, 1 &#125;, f[1] = &#123; x1 - 1, y2, mod - 1 &#125;, f[2] = &#123; x2, y1 - 1, mod - 1 &#125;, f[3] = &#123; x2, y2, 1 &#125;;    g[0] = &#123; x5, y5, 1 &#125;, g[1] = &#123; x5, y6 + 1, mod - 1 &#125;, g[2] = &#123; x6 + 1, y5, mod - 1 &#125;, g[3] = &#123; x6 + 1, y6 + 1, 1 &#125;;     auto G = [&amp;](int x1, int y1, int x2, int y2) &#123;        auto a(std::abs(x1 - x2)), b(std::abs(y1 - y2));        return C(a + b, a);    &#125;;    auto res = 0ll;    for (auto [x1, y1, k1] : f)        for (auto [x2, y2, k2] : g) &#123;            auto t(0ll);            for (int x = x3; x &lt;= x4; ++x) &#123;                (t += G(x1, y1, x, y4) * G(x, y4 + 1, x2, y2) % mod * (x + y4 + 1) % mod) %= mod;                (t += mod - G(x1, y1, x, y3 - 1) * G(x, y3, x2, y2) % mod * (x + y3) % mod) %= mod;            &#125;            for (int y = y3; y &lt;= y4; ++y) &#123;                (t += G(x1, y1, x4, y) * G(x4 + 1, y, x2, y2) % mod * (x4 + y + 1) % mod) %= mod;                (t += mod - G(x1, y1, x3 - 1, y) * G(x3, y, x2, y2) % mod * (x3 + y) % mod) %= mod;            &#125;            // printf(&quot;(%d, %d, %d), (%d, %d, %d): %lld\n&quot;, x1, y1, k1, x2, y2, k2, t * k1 % mod * k2 % mod);            (res += t * k1 % mod * k2 % mod) %= mod;        &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="ä¸ç»è¿‡-yxc-çš„æ–¹æ¡ˆæ•°">ä¸ç»è¿‡ <span class="math inline">\(y=x+c\)</span> çš„æ–¹æ¡ˆæ•°</h2><p>Catalan æ•°çš„ä¸€ç§æ¨å¯¼æ–¹å¼æ˜¯ï¼Œåœ¨ <span class="math inline">\(n\times n\)</span> çš„ç½‘æ ¼ä¸Šï¼Œè¦æ±‚ä¸èƒ½è¶Šè¿‡ <span class="math inline">\(y=x\)</span> çš„æ–¹æ¡ˆæ•°ã€‚å¯ä»¥ç”¨æ€»æ–¹æ¡ˆæ•°å‡å»è¶Šè¿‡çš„æ–¹æ¡ˆæ•°ã€‚</p><p>æ€ä¹ˆè®¡ç®—éæ³•çš„æ–¹æ¡ˆå‘¢ï¼Ÿè¶Šè¿‡ <span class="math inline">\(y=x\)</span> çš„è·¯å¾„å¿…å®šå­˜åœ¨ä¸€ä¸ªç‚¹ç»è¿‡ <span class="math inline">\(y=x+1\)</span>ï¼ŒåŸé—®é¢˜è½¬åŒ–ä¸ºä¸èƒ½ç¢°åˆ° <span class="math inline">\(y=x+1\)</span> çš„æ–¹æ¡ˆæ•°ã€‚</p><p>æŠŠç»ˆç‚¹ <span class="math inline">\((n, n)\)</span> ç¿»æŠ˜åˆ° <span class="math inline">\(y=x+1\)</span> ä¸Šæ–¹ï¼Œå¾—åˆ° <span class="math inline">\((n-1, n + 1)\)</span>ï¼›å¯¹äºä»»æ„åˆ°è¾¾ <span class="math inline">\((n-1,n+1)\)</span> çš„è·¯å¾„ï¼Œä¸€å®šä¼šæ¥è§¦ <span class="math inline">\(y=x+1\)</span> è‡³å°‘ä¸€æ¬¡ï¼›å°†ç¬¬ä¸€æ¬¡æ¥è§¦ä»¥åçš„è·¯å¾„ç¿»æŠ˜åˆ° <span class="math inline">\(y=x+1\)</span> ä¸‹æ–¹ï¼Œåˆ™ä¸€å®šå’ŒåŸå›¾ä¸­çš„éæ³•è·¯å¾„ä¸€ä¸€å¯¹åº”ã€‚</p><p><img src="4.png" /></p><p>å°±å¯ä»¥å¾—åˆ° <span class="math inline">\(C_{2n}^n-C_{2n}^{n-1}\)</span>ã€‚</p><p>å¦‚æœé—®é¢˜å˜å¾—æ›´åŠ ä¸€èˆ¬ï¼Œæ±‚è§£åˆ°è¾¾ <span class="math inline">\((n, m)\)</span> ä¸èƒ½ç¢°åˆ° <span class="math inline">\(y=x+c\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œè¿˜æ˜¯å¯ä»¥æŠŠ <span class="math inline">\((n,m)\)</span> ç¿»æŠ˜åˆ° <span class="math inline">\((m-c,n+c)\)</span>ï¼Œç­”æ¡ˆæ˜¯ <span class="math inline">\(C_{n+m}^n-C_{n+m}^{m-c}\)</span>ã€‚</p><hr /><h2 id="ä¸ç»è¿‡-yx-l-å’Œ-yxr-çš„æ–¹æ¡ˆæ•°">ä¸ç»è¿‡ <span class="math inline">\(y=x-l\)</span> å’Œ <span class="math inline">\(y=x+r\)</span> çš„æ–¹æ¡ˆæ•°</h2><p>ç°åœ¨æœ‰ <span class="math inline">\(y=x-l\)</span> å’Œ <span class="math inline">\(y=x+r\)</span> ä¸¤æ¡çº¿ä½œä¸ºé™åˆ¶ï¼Œç°åœ¨çš„ç¿»æŠ˜æ„ä¹‰å°±ä¼šæœ‰ä¸€ç‚¹æ”¹å˜ã€‚</p><p><img src="5.png" /></p><p>æ¯”å¦‚å›¾ä¸­çš„ <span class="math inline">\(A&#39;\)</span>ï¼Œæ˜¯ <span class="math inline">\(A\)</span> æ²¿ç€ <span class="math inline">\(y=x-l\)</span> ç¿»æŠ˜ä¸€æ¬¡åçš„ç»“æœã€‚è¿˜æ˜¯æŒ‰ç…§ä¹‹å‰çš„æ–¹å¼æ¥ç†è§£ï¼Œé‚£ä¹ˆèµ°åˆ° <span class="math inline">\(A&#39;\)</span> çš„è·¯å¾„ä»£è¡¨è‡³å°‘ç»è¿‡ä¸€æ¬¡ <span class="math inline">\(y=x-l\)</span> çš„æ–¹æ¡ˆã€‚<span class="math inline">\(A&#39;&#39;\)</span> æ˜¯ <span class="math inline">\(A&#39;\)</span> æ²¿ç€ <span class="math inline">\(y=x+r\)</span> ç¿»æŠ˜ä¸€æ¬¡ä¹‹åå¾—åˆ°çš„ç»“æœï¼Œèµ°åˆ° <span class="math inline">\(A&#39;&#39;\)</span> çš„è·¯å¾„å°±ä»£è¡¨è‡³å°‘å…ˆç¢°åˆ°ä¸€æ¬¡ <span class="math inline">\(y=x-l\)</span>ï¼Œå†ç¢°åˆ°ä¸€æ¬¡ <span class="math inline">\(y=x+r\)</span> çš„æ–¹æ¡ˆæ•°ã€‚</p><p>å¦‚æœæŠŠç›¸é‚»å¤šæ¬¡ç¢°åˆ° <span class="math inline">\(y=x-l\)</span> æˆ– <span class="math inline">\(y=x+r\)</span> åˆå¹¶ä¸ºä¸€æ¬¡ï¼Œæœ€ç»ˆçš„éæ³•è·¯å¾„å°±æ˜¯ <code>LRLRLR...</code> æˆ–è€… <code>RLRLRL...</code> çš„å½¢å¼ã€‚å› ä¸ºå¯ä»¥è®¡ç®—çš„æ˜¯ã€Œè‡³å°‘ã€çš„å½¢å¼ï¼Œç”¨å®¹æ–¥åŸç†å¾—åˆ°ï¼Œç­”æ¡ˆæ˜¯ <span class="math inline">\(f_{\varnothing}-(f_{\texttt L} + f_{\texttt R}) + (f_{\texttt {LR}} + f_{\texttt {RL}}) - \cdots\)</span>ã€‚å¯¹åº”è®¡ç®—æ¯ä¸ªç¿»æŠ˜å¯¹åº”ç»ˆç‚¹å’Œç­”æ¡ˆå°±å¯ä»¥äº†ã€‚æœ€åçš„ç­”æ¡ˆæ˜¯ <span class="math inline">\(C_{n+m}^n-C_{n+m}^{n+l}-C_{n+m}^{n + r}+C_{n+m}^{n+l-r}+C_{n+m}^{n+r-l}-\cdots\)</span>ï¼Œå¯ä»¥ç®€åŒ–æˆ <span class="math inline">\(\sum\limits_{k\in \mathbb{Z}} C_{n+m}^{n-k\cdot (r-l)}-C_{n+m}^{n-k\cdot (r-l)+r}\)</span>ã€‚</p><hr /><h3 id="e---éª—æˆ‘å‘¢">E - éª—æˆ‘å‘¢</h3><p><a href="https://www.luogu.com.cn/problem/P3266" class="uri">https://www.luogu.com.cn/problem/P3266</a></p><p>æ¯è¡Œå†…éƒ¨é€’å¢ï¼Œè€Œä¸”é€‰é¡¹åªæœ‰ <span class="math inline">\([0,m]\)</span>ï¼Œé‚£ä¹ˆæ¯è¡Œå°±ä¼šåˆšå¥½åœ¨ <span class="math inline">\([0,m]\)</span> é‡Œé¢è·³è¿‡ä¸€ä¸ªæ•°ã€‚</p><p>å¦‚æœç¬¬ <span class="math inline">\(i\)</span> è¡Œè·³è¿‡çš„æ•°æ˜¯ <span class="math inline">\(j\)</span>ï¼Œé‚£ä¹ˆç”»ä¸€ç”»å›¾å°±å¯ä»¥å‘ç°ç¬¬ <span class="math inline">\(i+1\)</span> å¯èƒ½è·³è¿‡çš„æ•°æ˜¯ <span class="math inline">\([j-1,m]\)</span>ï¼›åè¿‡æ¥ï¼Œç¬¬ <span class="math inline">\(i-1\)</span> è¡Œå¯èƒ½è·³è¿‡çš„æ•°å°±æ˜¯ <span class="math inline">\([0,j+1]\)</span>ã€‚</p><p>å¦‚æœè®© <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºç¡®å®šäº†ç¬¬ <span class="math inline">\(1\to i\)</span> è¡Œï¼Œå…¶ä¸­ç¬¬ <span class="math inline">\(i\)</span> è¡Œè·³è¿‡ <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥å¾—åˆ° <span class="math inline">\(f_{i,j}=\sum\limits_{k=0}^{j+1} f_{i-1,k}\)</span>ã€‚å‰ç¼€å’Œå¾—åˆ° <span class="math inline">\(f_{i,j}=f_{i,j-1}+f_{i-1,j+1}\)</span>ã€‚æ³¨æ„è¾¹ç•Œï¼š<span class="math inline">\(f_{0,j}=1\)</span>ï¼›<span class="math inline">\(f_{i,0}=f_{i-1,0}+f_{i-1,1}\)</span>ï¼›<span class="math inline">\(f_{i,m}=f_{i,m-1}\)</span>ã€‚</p><p>ä¸ºäº†å¾—åˆ°ç­”æ¡ˆï¼Œè®© <span class="math inline">\(g_{i,j}\)</span> è¡¨ç¤º <span class="math inline">\(i\times j\)</span> çŸ©é˜µçš„æ–¹æ¡ˆæ•°ï¼ˆè¿™æ ·å°±æœ‰æœºä¼šé€šè¿‡æ‰‹æ®µä¼˜åŒ–äº†ï¼‰ï¼š</p><p><span class="math display">\[\begin{aligned}g_{i,j}&amp;=\sum_{k=0}^j f_{i,k}\\&amp;= f_{i-1,0}+f_{i-1,1}+\sum_{k=1}^j f_{i,k-1}+f_{i-1,k+1}\\&amp;= g_{i,j-1}+g_{i-1,j+1}\end{aligned}\]</span></p><p>è¾¹ç•Œæƒ…å†µå‘¢ï¼Œ <span class="math inline">\(g_{i, 0} = f_{i,0} = f_{i-1, 0} + f_{i - 1, 1} = g_{i-1,1}\)</span>ï¼›<span class="math inline">\(g_{i,m}=g_{i, m - 1} + f_{i,m}=g_{i-1,m}+g_{i,m-1}\)</span>ã€‚ <span class="math inline">\(g_{i,m+1}=g_{i,m}\)</span> é¿å…è¾¹ç•Œã€‚</p><p>é‚£ä¹ˆåœ¨ç½‘æ ¼å›¾ä¸Šè½¬ç§»å¦‚ä¸‹ï¼š</p><p><img src="2.png" /></p><p>è€ƒè™‘å°†è¿™ä¸ªå›¾å½¢æ‹‰æ­£ï¼Œä»¤ <span class="math inline">\((i+i,j)\gets g_{i,j}\)</span> å¾—åˆ°ï¼š</p><p><img src="3.png" /></p><p>é—®é¢˜å°±è½¬åŒ–ä¸ºï¼Œä» <span class="math inline">\((0, 0)\)</span> èµ°åˆ° <span class="math inline">\((m+n+1,n)\)</span> ä¸”ä¸èƒ½è§¦ç¢° <span class="math inline">\(y=x+1\)</span> å’Œ <span class="math inline">\(y=x-m-2\)</span> ä¸¤æ¡ç›´çº¿çš„æ–¹æ¡ˆæ•°ã€‚</p><details></details><hr /><h2 id="ä¸ç»è¿‡ä¸€èˆ¬è¿‡åŸç‚¹ç›´çº¿çš„æ–¹æ¡ˆæ•°">ä¸ç»è¿‡ä¸€èˆ¬è¿‡åŸç‚¹ç›´çº¿çš„æ–¹æ¡ˆæ•°</h2><ol type="1"><li><p>ç±»å‹ä¸€ï¼š<span class="math inline">\((0,0)\to (n,m)\)</span>ï¼Œä¸ç»è¿‡ <span class="math inline">\(y=\dfrac mnx\)</span> çš„æ–¹æ¡ˆï¼Œå…¶ä¸­è¦æ±‚ <span class="math inline">\((m,n)=1\)</span>ã€‚</p><p>æ–¹æ¡ˆä¸º <span class="math inline">\(\dfrac {C_{n+m}^n}{n+m}\)</span>ã€‚</p></li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> æ’åˆ—ç»„åˆ </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
            <tag> æ•°å­¦ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç»„åˆè®¡æ•°</title>
      <link href="/20250407/"/>
      <url>/20250407/</url>
      
        <content type="html"><![CDATA[<p>æ¯…æ¯…ï¼šç»Ÿè®¡ä¸æ˜¯æ•°å­¦ï¼ˆæ–­ç« å–ä¹‰ edï¼‰ã€‚<del>æ•…åˆ æ‰äº†æ•°å­¦æ ‡ç­¾ã€‚</del> å…¶å®å¹¶æ²¡æœ‰ã€‚</p><span id="more"></span><hr /><h2 id="a.-äºŒåˆ†å›¾æŸ“è‰²">A. äºŒåˆ†å›¾æŸ“è‰²</h2><p><a href="http://222.180.160.110:61235/contest/6181/problem/1" class="uri">http://222.180.160.110:61235/contest/6181/problem/1</a></p><p>é¦–å…ˆåªçœ‹çº¢è‰²ã€‚æ˜¾ç„¶ä¸€ä¸ªå·¦éƒ¨ç‚¹æœ€å¤šåªèƒ½ç”¨çº¢è¾¹è¿æ¥ä¸€ä¸ªå³éƒ¨ç‚¹ï¼Œåä¹‹åŒç†ã€‚æŠŠå·¦éƒ¨ç‚¹è§†ä¸ºä¸‹æ ‡ï¼Œå…¶ç”¨çº¢è¾¹ç›¸è¿çš„å³éƒ¨ç‚¹è§†ä¸ºå€¼ï¼Œåˆ™ä¸€ä¸ªåˆæ³•çš„æ–¹æ¡ˆä¸º <span class="math inline">\(n\)</span> çš„åªä¿ç•™ä¸€éƒ¨åˆ†å…ƒç´ çš„æ’åˆ—ã€‚æ˜¾ç„¶ä¸º <span class="math inline">\(f(n)=\sum\limits_{i=0}^nC_n^i\cdot A_n^i\)</span>ã€‚</p><p>å†åŠ ä¸Šè“è‰²ï¼Œ<span class="math inline">\(f^2(n)\)</span> ä¼šç»™ä¸€æ¡è¾¹æ¶‚ä¸¤ç§é¢œè‰²ï¼Œæ•…é’¦å®šæœ‰ä¸¤ç§é¢œè‰²çš„è¾¹æ•°ï¼Œå®¹æ–¥å¾—åˆ° <span class="math inline">\(\sum\limits_{i=0}^n(-1)^i\cdot C_n^i\cdot A_n^i\cdot f^2(n-i)\)</span>ã€‚å‘ç° <span class="math inline">\(f\)</span> çš„è®¡ç®—å¯èƒ½éœ€è¦ä¼˜åŒ–ä¸€ä¸‹ã€‚è€ƒè™‘å·²ç»çŸ¥é“ <span class="math inline">\(f(n-1)\)</span>ï¼Œæ­¤æ—¶å¯¹äºæ–°å¢çš„ç¬¬ <span class="math inline">\(n\)</span> å¯¹ç‚¹ï¼š</p><ol type="1"><li>ä»»æ„è¿è¾¹ï¼ˆæ˜¾ç„¶ä¸¤ä¸ªå½“ä¸­åªèƒ½æœ‰ä¸€ä¸ªç‚¹å‘å‡ºè¾¹ï¼‰ï¼Œå…±æœ‰ <span class="math inline">\(2n-1\)</span> ç§æ–¹æ¡ˆï¼Œå› ä¸º <span class="math inline">\((n, n)\)</span> ä¼šè¢«ç®—é‡ã€‚</li><li>ä¸è¿ï¼Œå…± <span class="math inline">\(1\)</span> ç§æ–¹æ¡ˆã€‚</li><li>å‘ç° 1 ä¸­å¯èƒ½è¿åˆ°å·²ç»æœ‰è¿è¾¹çš„ç‚¹ä¸Šäº†ï¼Œæ–°è¾¹çš„ç›®çš„åœ°æœ‰ <span class="math inline">\(n-1\)</span> ä¸ªé€‰é¡¹ï¼Œç›®çš„åœ°åŸæœ¬è¿æ¥çš„ç‚¹ä¹Ÿæœ‰ <span class="math inline">\(n-1\)</span> ä¸ªé€‰é¡¹ï¼Œå»æ‰ä¸¤è¾¹å…± <span class="math inline">\(4\)</span> ä¸ªç‚¹ï¼Œéæ³•çš„å³ä¸º <span class="math inline">\((n-1)^2\cdot f(n-2)\)</span>ã€‚</li></ol><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; f(n + 1), fac(n + 1), inv(n + 1);    f[0] = 1ll, f[1] = 2ll;    fac[0] = 1ll, fac[1] = 1ll, inv[0] = 1ll;    for (int i = 2; i &lt;= n; ++i) &#123;        fac[i] = fac[i - 1] * i % mod;        f[i] = (f[i - 1] * 2 * i % mod + mod - f[i - 2] * (i - 1) % mod * (i - 1) % mod) % mod;    &#125;    auto qkp = [](long long x, int y) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[n] = qkp(fac[n], mod - 2);    for (int i = n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    auto A = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod;    &#125;;    long long res = 0ll;    for (int i = 0, k = 1; i &lt;= n; ++i, k = mod - k)        (res += k * C(n, i) % mod * A(n, i) % mod * f[n - i] % mod * f[n - i]) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b.-ä¸ƒé€‰äº”">B. ä¸ƒé€‰äº”</h2><p><a href="http://222.180.160.110:61235/contest/6181/problem/2" class="uri">http://222.180.160.110:61235/contest/6181/problem/2</a></p><p>é¦–å…ˆ <span class="math inline">\(p\)</span> å›ºå®šï¼Œé’¦å®šæœ‰ <span class="math inline">\(x\)</span> ä¸ªæ•°ç›¸ç­‰ï¼Œæœ‰ <span class="math inline">\(C_k^x\)</span> ä¸ªæ–¹æ¡ˆï¼Œå‰©ä¸‹çš„å°±æ˜¯ä» <span class="math inline">\(n-x\)</span> ä¸ªå…ƒç´ é‡Œé€‰å‡º <span class="math inline">\(k-x\)</span> ä¸ªæ¥é”™æ’ï¼Œè€ƒè™‘é’¦å®šç›¸åŒçš„ä¸ªæ•°æ¥å®¹æ–¥ï¼š</p><p><span class="math display">\[\sum_{i=0}^{k-x}(-1)^i\cdot C_{k-x}^i\cdot A_{n-x-i}^{k-x-i}\]</span></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k, x;    std::cin &gt;&gt; n &gt;&gt; k &gt;&gt; x;    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);    fac[0] = 1ll, fac[1] = 1ll, inv[0] = 1ll;    for (int i = 2; i &lt;= n; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [](long long x, int y) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[n] = qkp(fac[n], mod - 2);    for (int i = n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    auto A = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod;    &#125;;    long long res = C(k, x), sum = 0ll;    for (int i = 0, p = 1; i &lt;= k - x; ++i, p = mod - p)        (sum += p * C(k - x, i) % mod * A(n - x - i, k - x - i) % mod) %= mod;    std::cout &lt;&lt; res * sum % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d.-ç¡¬å¸è´­ç‰©">D. ç¡¬å¸è´­ç‰©</h2><p><a href="http://222.180.160.110:61235/contest/6181/problem/4" class="uri">http://222.180.160.110:61235/contest/6181/problem/4</a></p><p>æ¯æ¬¡å¤šé‡èƒŒåŒ…ä¼šè¶…æ—¶ï¼Œè€ƒè™‘ç”¨é’¦å®šæ¯ç§ç¡¬å¸æ˜¯å¦è¶…é¢æ¥å®¹æ–¥ã€‚ä»¤ <span class="math inline">\(f_s\)</span> è¡¨ç¤ºå‡‘å‡º <span class="math inline">\(s\)</span> çš„æ–¹æ¡ˆæ•°ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰ï¼Œé‚£ä¹ˆ <span class="math inline">\(f_{s-c_1\times (d_1 + 1)}\)</span> å°±è¡¨ç¤ºé’¦å®šç¬¬ 1 ç§ç¡¬å¸è¶…é¢æ—¶å‡‘å‡º <span class="math inline">\(s\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int c[4], T, m = 1e5;    std::vector&lt;long long&gt; f(m + 1);    f[0] = 1;    for (int i = 0; i &lt; 4; ++i) &#123;        std::cin &gt;&gt; c[i];        for (int j = c[i]; j &lt;= m; ++j)            f[j] += f[j - c[i]];    &#125;    std::cin &gt;&gt; T;    for (int d[4], m; T--; ) &#123;        for (int i = 0; i &lt; 4; ++i)            std::cin &gt;&gt; d[i];        std::cin &gt;&gt; m;        long long res = 0ll;        for (int i = 0; i &lt; (1 &lt;&lt; 4); ++i) &#123;            int s = m;            for (int j = 0; j &lt; 4; ++j)                if ((i &gt;&gt; j) &amp; 1)                    s -= (d[j] + 1) * c[j];            if (s &gt;= 0) &#123;                int k = (__builtin_popcount(i) &amp; 1) ? -1 : 1;                res += k * f[s];            &#125;        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="e.-distinct-multiples">E. Distinct Multiples</h2><p><a href="http://222.180.160.110:61235/contest/6181/problem/5" class="uri">http://222.180.160.110:61235/contest/6181/problem/5</a></p><p>æ¨å¼å­é¢˜ã€‚é¢˜æ„è½¬åŒ–ä¸ºï¼Œç»™å®š <span class="math inline">\(n\)</span> ä¸ªä½ç½®å¯é€‰çš„å€¼é›†åˆï¼Œè¦æ±‚ä»»æ„ä¸¤ä¸ªä½ç½®å€¼ä¸ç­‰ï¼Œé—®æ–¹æ¡ˆæ•°ã€‚</p><p>å¦‚æœæŠŠä¸¤ä¸ªä½ç½®å–ç­‰è§†ä½œåœ¨å›¢ä¸Šé€‰ä¸­è¾¹ï¼Œé‚£ä¹ˆæœ‰æœ´ç´ åšæ³•é’¦å®šé€‰è¾¹çš„é›†åˆ <span class="math inline">\(S\)</span> ç„¶åå®¹æ–¥ï¼Œè€ƒè™‘å®ƒä»¬æ„æˆçš„è¿é€šå— <span class="math inline">\(\{s\} \subseteq S\)</span>ï¼Œæœ‰ <span class="math inline">\(res=\sum\limits_{S\subseteq V}(-1)^{|S|}\cdot \prod\limits_{s_i} \left\lfloor \frac m{\operatorname{lcm} s_i} \right\rfloor\)</span>ã€‚</p><p>æœ‰ä¸ªå¾ˆç¥å¥‡çš„æ“ä½œæ˜¯æŠŠ <span class="math inline">\(S\)</span> ä¸¢æ‰ï¼Œç›´æ¥æšä¸¾ <span class="math inline">\(\{s\}\)</span> å°è¯•å­é›† DPã€‚æœ‰ï¼š<span class="math inline">\(res=\sum\limits_{\{s\}}\prod\limits_s f(s)\cdot\left\lfloor \frac m{\operatorname{lcm} s} \right\rfloor\)</span>ã€‚å…¶ä¸­ <span class="math inline">\(f(s)\)</span> è¡¨ç¤ºé€‰å–ä¸€ä¸ª <span class="math inline">\(s\)</span> çš„å¯¼å‡ºå­å›¾çš„å®¹æ–¥ç³»æ•°ä¹‹å’Œï¼Œå…¶ä¸­æ¬¡æ•°ä¸ºå¯¼å‡ºå­å›¾ä¸­è¾¹æ•°ã€‚</p><p>æ€ä¹ˆæŠŠ <span class="math inline">\(f\)</span> ç®—å‡ºæ¥å‘¢ï¼Ÿå®¹æ˜“å‘ç°å…¶å€¼åªä¸ <span class="math inline">\(|s|\)</span> æœ‰å…³ï¼Œè€ƒè™‘é’¦å®šä¸ <span class="math inline">\(1\)</span> è¿é€šçš„ç‚¹æ•°å®¹æ–¥ï¼Œåˆ™æœ‰ï¼š</p><p><span class="math display">\[f(n)=\sum\limits_{i=0}^{n - 1} (-1)^i \times C_{n-1}^{i-1} \times f(i) \cdot \sum_{j=0}^{m\gets i\times (i-1)\div 2} (-1)^j\cdot C_m^j\]</span></p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒäºŒé¡¹å¼å®šç†å– <span class="math inline">\(a=1, b = -1\)</span> æœ‰ <span class="math inline">\(0^m=[m=0]=\sum_{j=0}^m(-1)^j\cdot C_m^j\)</span>ï¼Œä»£å…¥å¾—ï¼š</p><p><span class="math display">\[\begin{aligned}f(n)&amp;=\sum\limits_{i=0}^{n - 1} (-1)^i \times C_{n-1}^{n-i-1} \times f(n-i)\cdot [m=0\iff i=1]\\&amp;=(1 - n)\cdot f(n-1)\end{aligned}\]</span></p><p>ç„¶åå°±èƒ½çº¿æ€§æ±‚å‡ºã€‚å†ç”¨ä¸€ä¸ªå­é›† DPï¼Œä¸ºäº†ä¿è¯é¡ºåºæšä¸¾æœ€å°çš„æœªè¢«ç¡®å®šçš„ç‚¹æ‰€åœ¨è¿é€šå—è¿›è¡Œè½¬ç§»ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, l;    long long m;    std::cin &gt;&gt; n &gt;&gt; m, l = 1 &lt;&lt; n;    std::vector&lt;long long&gt; d(n), f(n + 1), dp(l), g(l);    f[1] = 1ll;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; d[i - 1];        if (i &gt;= 2)            f[i] = (1 + mod - i) * f[i - 1] % mod;        // printf(&quot;f[%d] = %lld\n&quot;, i, f[i]);    &#125;    for (int i = 0; i &lt; l; ++i) &#123;        long long now = 1ll;        for (int j = 0; j &lt; n; ++j)            if ((i &gt;&gt; j) &amp; 1) &#123;                if (now / std::__gcd(now, d[j]) &gt; m / d[j])                    goto nosol;                now = now / std::__gcd(now, d[j]) * d[j];            &#125;        g[i] = (m / now) % mod;        // printf(&quot;lcm = %lld, g[%d] = %lld\n&quot;, now, i, g[i]);    nosol: ;    &#125;    dp[0] = 1ll;    auto lowbit = [](int x) &#123;        return x &amp; -x;    &#125;;    for (int i = 1; i &lt; l; ++i) &#123;        int to = std::__lg(lowbit(i));        for (int j = i; j; j = (j - 1) &amp; i)            if ((j &gt;&gt; to) &amp; 1)                (dp[i] += dp[i ^ j] * f[__builtin_popcount(j)] % mod * g[j] % mod) %= mod;    &#125;    std::cout &lt;&lt; dp[l - 1] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="f.-permutation">F. Permutation</h2><p><a href="http://222.180.160.110:61235/contest/6181/problem/6" class="uri">http://222.180.160.110:61235/contest/6181/problem/6</a></p><p>å¦‚æœå…¨æ˜¯ <code>&lt;</code>ï¼Œæ–¹æ¡ˆæ•°ä¸º <span class="math inline">\(1\)</span>ã€‚</p><p>ç°åœ¨æŠŠå…¶ä¸­ä¸€äº› <code>&lt;</code> å˜æˆ <code>?</code>ï¼Œæ¯”å¦‚ <code>&lt;&lt;??&lt;?&lt;&lt;&lt;&lt;</code> çš„æ–¹æ¡ˆæ•°ï¼Œ<del>å¤ªå¥½äº†æ˜¯å¤šé‡é›†æ’åˆ—ï¼Œæˆ‘ä»¬æ²¡æ•‘äº†</del> æ˜¾ç„¶è¢« <code>&lt;</code> è¿æ¥èµ·æ¥çš„ä¸€æ®µå…ƒç´ åªæœ‰ä¸€ç§æ’åˆ—æ–¹å¼ï¼Œæ‰€ä»¥å¯ä»¥è§†ä¸ºå¤šé‡é›†æ’åˆ—ï¼Œæ–¹æ¡ˆæ•°ä¸º <span class="math inline">\(\dfrac {11!}{3!\times 2!\times 5!}\)</span>ã€‚</p><p>ä¼¼ä¹åªéœ€è¦æšä¸¾æŠŠ <code>&gt;</code> å˜æˆ <code>&lt;</code> æˆ– <code>=</code> çš„ <span class="math inline">\(2^k\)</span> ç§æƒ…å†µå†è®¡ç®—å°±å¯ä»¥äº†ï¼Œå¯æƒœ <span class="math inline">\(k\)</span> æœ‰ç‚¹å¤§ã€‚ä½†æˆ‘ä»¬å‘ç°å®ƒåœ¨ä¸€å®šç¨‹åº¦ä¸Šæ˜¯æ²¡æœ‰åæ•ˆæ€§çš„ï¼Œæ¯”å¦‚ <code>&lt;&lt;??&lt;</code> å’Œ <code>&lt;&lt;?&lt;&lt;</code>ï¼Œå‰é¢çš„ <code>&lt;&lt;</code> ä¸ä¼šå¯¹åé¢çš„å†…å®¹å¸¦æ¥å½±å“ã€‚</p><p>æ•…ä»¤ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºå¯¹äºå‰ <span class="math inline">\(i\)</span> ä¸ªå…ƒç´ çš„æ–¹æ¡ˆæ•°ï¼Œæšä¸¾æœ€åä¸€ä¸ªè¢«é’¦å®šä¸º <code>?</code> çš„ <code>&gt;</code> <span class="math inline">\(j\)</span>ï¼ˆå³ <span class="math inline">\([j + 1, i-1]\)</span> é—´çš„ <code>&gt;</code> éƒ½è¢«æ›¿æ¢ä¸º <code>&lt;</code>ï¼‰ï¼Œå¸¦ä¸Šå®¹æ–¥ç³»æ•°ï¼Œæœ‰ <span class="math inline">\(f_i=\sum\limits_{s_j=\texttt{&#39;&gt;&#39;}}(-1)^{cnt_\texttt{&#39;&gt;&#39;}[j + 1, i - 1]}\times f_j\times\dfrac1{(i-j)!}\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);    fac[0] = 1ll, inv[0] = 1ll;    for (int i = 1; i &lt;= n; ++i)        fac[i] = fac[i - 1] * i % mod;    auto qkp = [](long long x, int y) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[n] = qkp(fac[n], mod - 2);    for (int i = n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    std::vector&lt;char&gt; s(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; s[i];    std::vector&lt;long long&gt; f(n + 1);    s[0] = &#39;&gt;&#39;, f[0] = 1ll;    for (int i = 1; i &lt;= n; ++i) &#123;        int cnt = 0;        for (int j = i - 1; ~j; --j)            if (s[j] == &#39;&gt;&#39;) &#123;                long long k = (cnt &amp; 1) ? mod - 1 : 1;                (k *= f[j]) %= mod, (k *= inv[i - j]) %= mod;                (f[i] += k) %= mod;                ++cnt;            &#125;        // printf(&quot;f[%d] = %lld\n&quot;, i, f[i]);    &#125;    std::cout &lt;&lt; f[n] * fac[n] % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><p><em>å¿³éƒé‚‘ä½™ä¾˜å‚ºå…®ï¼Œä½™ç‹¬ç©·å›°ä¹æ­¤æ—¶ä¹Ÿã€‚</em></p><hr /><h2 id="h.-k-perm-counting">H. ~K Perm Counting</h2><p><a href="http://222.180.160.110:61235/contest/6181/problem/8" class="uri">http://222.180.160.110:61235/contest/6181/problem/8</a></p><p>è€ƒè™‘é’¦å®šä»¤å‡ ä¸ªå…ƒç´ ä¸æ»¡è¶³æ¡ä»¶è¿›è¡Œå®¹æ–¥ï¼Œå³ç­”æ¡ˆä¸º <span class="math inline">\(\sum\limits_{i=0}^n (-1)^i\cdot f(i)\)</span>ã€‚ä½†æˆ‘ä»¬å‘ç° <span class="math inline">\([n-k,n+k]\)</span> éƒ½æœ‰ä¸¤ä¸ªä¸èƒ½é€‰çš„å€¼ï¼Œç›´æ¥å– <span class="math inline">\(f(i)=\prod 2\)</span> è‚¯å®šä¼šé€‰åˆ°ç›¸åŒå€¼ï¼Œä¸€ä¸ªè‡ªç„¶ï¼ˆï¼Ÿï¼‰çš„æƒ³æ³•æ˜¯å†å®¹æ–¥ä¸€éï¼Œå¯æƒœæ‰‹ç©ä¸€ä¸‹å‘ç°ä¼¼ä¹å®¹ä¸åŠ¨ã€‚è€ƒè™‘æŠŠç©æ„å„¿æ‹åœ¨æ£‹ç›˜ä¸Šï¼š</p><figure><img src="1.png" alt="ä»¥ k=2 ä¸ºä¾‹" /><figcaption>ä»¥ <span class="math inline">\(k=2\)</span> ä¸ºä¾‹</figcaption></figure><p>å…¶ä¸­ <span class="math inline">\(\times\)</span> æ˜¯éæ³•æ ¼å­ï¼Œè¾¹æ˜¯éæ³•æ ¼å­é—´çš„ä¸åŒé€‰å…³ç³»ï¼ŒåŒé¢œè‰²çš„è¾¹éš¶å±åŒä¸€æ¡é“¾ã€‚å®¹æ˜“å‘ç°å¦‚æœæ£‹ç›˜ç»§ç»­æ‰©å¤§ï¼Œè¿™äº›é“¾è¿˜ä¼šç»§ç»­å»¶é•¿ã€‚</p><p>ä¼šå‘ç°è¿™äº›é“¾äº’ä¸å¹²æ‰°ï¼Œå°±æ˜¯è¯´æˆ‘é€‰äº†è¿™æ¡é“¾ä¸Šçš„æŸä¸ªç‚¹å’Œé“¾å¤–çš„ç‚¹æ²¡æœ‰ä»»ä½•å…³ç³»ï¼ˆæ˜¾ç„¶ï¼‰ã€‚æŠŠè¿™äº›é“¾é¦–å°¾ç›¸è¿æ‹¼èµ·æ¥ï¼Œè¦åšçš„å°±æ˜¯æ‹¼æ¥å¤„å¯ä»¥é€‰ç›¸é‚»ï¼Œå…¶ä½™ä½ç½®ä¸èƒ½é€‰ç›¸é‚»ï¼Œé€‰å‡ºæ¥ <span class="math inline">\(i\)</span> ä¸ªçš„æ–¹æ¡ˆæ•°ã€‚æå‰é¢„å¤„ç†å‡ºæ¥æ•´ä¸ªåºåˆ—ï¼Œä»¤ <span class="math inline">\(tag_j\)</span> è¡¨ç¤º <span class="math inline">\(j\)</span> æ˜¯å¦èƒ½å’Œ <span class="math inline">\(j-1\)</span> åŒé€‰ï¼Œè®¾ <span class="math inline">\(dp_{j,i,0/1}\)</span> è¡¨ç¤º DP åˆ°äº† <span class="math inline">\(j\)</span>ï¼Œå·²ç»é€‰äº† <span class="math inline">\(i\)</span> ä¸ªæ•°ï¼Œç¬¬ <span class="math inline">\(j\)</span> ä¸ªå…ƒç´ ï¼ˆä¸ï¼‰é€‰çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[dp_{j,i,0} = dp_{j - 1, i, 0} + dp_{j-1, i, 1}\\dp_{j,i,1} = \begin{cases}dp_{j-1, i - 1, 1} + dp_{j-1,i - 1,0}&amp;tag_j=1\\dp_{j-1,i,0}&amp;\text{otherwise}\end{cases}\]</span></p><p>å¤§åŠ› DP å³å¯ã€‚<span class="math inline">\(f(i)\)</span> å³ä¸º <span class="math inline">\((n-i)!\times (dp_{m, i, 0} + dp_{m, i, 1})\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(m\)</span> ä¸ºæ€»é“¾é•¿ã€‚</p><details><p>æ³¨æ„ä¸æ»šåŠ¨å¯èƒ½ä¼š MLE <img src="/em/kt.gif" /></p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 924844033;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;int&gt; tag(1);    std::vector&lt;long long&gt; fac(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; vis(n + 1, std::vector&lt;int&gt; (n + 1));    auto calc = [&amp;](int i, int j, int s) &#123;        tag.push_back(1);        for (; ; s ^= 1) &#123;            // printf(&quot;(%d, %d) &quot;, i, j);            vis[i][j] = 1;            if (!s) &#123;                i = j + k;                if (i &lt;= n)                    tag.push_back(0);                else                    break;            &#125;            else &#123;                j = i + k;                if (j &lt;= n)                    tag.push_back(0);                else                    break;            &#125;        &#125;        // puts(&quot;&quot;);        return;    &#125;;    fac[0] = 1ll;    for (int i = 1; i &lt;= n; ++i) &#123;        fac[i] = fac[i - 1] * i % mod;        int j = i - k;        if (j &gt;= 1 &amp;&amp; !vis[i][j])            calc(i, j, 1);        j = i + k;        if (j &lt;= n &amp;&amp; !vis[i][j])            calc(i, j, 0);    &#125;    int m = (int)tag.size() - 1;    // printf(&quot;m = %d\n&quot;, m);    std::vector&lt;std::vector&lt;std::vector&lt;long long&gt; &gt; &gt; dp(2, std::vector&lt;std::vector&lt;long long&gt; &gt; (n + 1, std::vector&lt;long long&gt; (2)));    dp[0][0][0] = 1ll;    for (int j = 1, now = 1; j &lt;= m; ++j, now ^= 1) &#123;        for (int i = 0; i &lt;= n &amp;&amp; i &lt;= j; ++i) &#123;            dp[now][i][0] = dp[!now][i][0];            dp[now][i][1] = 0ll;            if (i) &#123;                (dp[now][i][0] += dp[!now][i][1]) %= mod;                dp[now][i][1] = dp[!now][i - 1][0];                if (tag[j]) &#123;                    (dp[now][i][1] += dp[!now][i - 1][1]) %= mod;                    // assert(0);                &#125;            &#125;            // printf(&quot;dp[%d][%d] = %lld / %lld\n&quot;, j, i, dp[j][i][0], dp[j][i][1]);        &#125;    &#125;    long long res = 0ll;    for (int i = 0, p = 1; i &lt;= n; ++i, p = mod - p)        (res += p * fac[n - i] % mod * (dp[m &amp; 1][i][0] + dp[m &amp; 1][i][1]) % mod) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="a---positions-in-permutations">A - Positions in Permutations</h2><p><a href="https://codeforces.com/problemset/problem/285/E" class="uri">https://codeforces.com/problemset/problem/285/E</a></p><p><del>ï¼ˆçœ‹å‘ä¸Šä¸€é¢˜ï¼‰è¿™ç…§ç‰‡æ˜¯ä½ å—ï¼Ÿ</del></p><p>åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šï¼Œä»¤ <span class="math inline">\(k=1\)</span>ã€‚ä½†æ˜¯æœ‰ä¸ªå°å°çš„é—®é¢˜â€”â€”æ‰€æ±‚çš„ã€Œè‡³å°‘ã€ä¸ä¸º <span class="math inline">\(0\)</span>ï¼Œæ— æ³•ç®€å•å®¹æ–¥ã€‚å…·ä½“åœ°ï¼Œå¦‚æœä¸€ä¸ªæ’åˆ—ä¸€å…±æœ‰ <span class="math inline">\(p\)</span> ä¸ªéæ³•æ’åˆ—ï¼Œé‚£ä¹ˆå®ƒä¼šè¢« <span class="math inline">\(f(i)\)</span> ç»Ÿè®¡ <span class="math inline">\(C_p^i\)</span> æ¬¡ã€‚ä»¤ <span class="math inline">\(g(p)\)</span> è¡¨ç¤ºéæ³•æ ¼å­æ•°æ°å¥½ä¸º <span class="math inline">\(p\)</span> çš„æ’åˆ—çš„çœŸå®æ•°é‡ï¼Œåˆ™ <span class="math inline">\(f(i)=\sum\limits_{j=i}^n C_j^i\cdot g(j)\)</span>ï¼ŒäºŒé¡¹å¼åæ¼”å³å¯å¾—åˆ°çœŸå®å€¼ <span class="math inline">\(g(m)=\sum\limits_{j=m}^n (-1)^{j-m}\cdot C_j^m\cdot f(j)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;int&gt; tag(1);    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; vis(n + 1, std::vector&lt;int&gt; (n + 1));    auto calc = [&amp;](int i, int j, int s) &#123;        tag.push_back(1);        for (; i &lt;= n &amp;&amp; j &lt;= n; s ^= 1) &#123;            vis[i][j] = 1;            if (!s) &#123;                i = j + 1;                if (i &lt;= n)                    tag.push_back(0);            &#125;            else &#123;                j = i + 1;                if (j &lt;= n)                    tag.push_back(0);            &#125;        &#125;        return;    &#125;;    auto qkp = [&amp;](long long x, int y) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    fac[0] = 1ll, inv[0] = 1ll;    for (int i = 1; i &lt;= n; ++i) &#123;        fac[i] = fac[i - 1] * i % mod;        int j = i - 1;        if (j &gt;= 1 &amp;&amp; !vis[i][j])            calc(i, j, 1);        j = i + 1;        if (j &lt;= n &amp;&amp; !vis[i][j])            calc(i, j, 0);    &#125;    inv[n] = qkp(fac[n], mod - 2);    for (int i = n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    int m = (int)tag.size() - 1;    std::vector&lt;std::vector&lt;std::vector&lt;long long&gt; &gt; &gt; dp(2, std::vector&lt;std::vector&lt;long long&gt; &gt; (n + 1, std::vector&lt;long long&gt; (2)));    dp[0][0][0] = 1ll;    for (int j = 1, now = 1; j &lt;= m; ++j, now ^= 1) &#123;        for (int i = 0; i &lt;= n &amp;&amp; i &lt;= j; ++i) &#123;            dp[now][i][0] = dp[!now][i][0];            dp[now][i][1] = 0ll;            if (i) &#123;                (dp[now][i][0] += dp[!now][i][1]) %= mod;                dp[now][i][1] = dp[!now][i - 1][0];                if (tag[j])                    (dp[now][i][1] += dp[!now][i - 1][1]) %= mod;            &#125;        &#125;    &#125;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    long long res = 0ll;    for (int i = k, p = 1; i &lt;= n; ++i, p = mod - p) &#123;        // printf(&quot;%d: %lld\n&quot;, i, C(i, k) * fac[n - i] % mod * (dp[m &amp; 1][i][0] + dp[m &amp; 1][i][1]) % mod);        (res += p * C(i, k) % mod * fac[n - i] % mod * (dp[m &amp; 1][i][0] + dp[m &amp; 1][i][1]) % mod) %= mod;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d---all-pairs-similarity-p">D - All Pairs Similarity P</h2><p><a href="https://www.luogu.com.cn/problem/P11458" class="uri">https://www.luogu.com.cn/problem/P11458</a></p><p>çœæµï¼šæ±‚ <span class="math inline">\(\forall\,i,f_i=\sum\limits_{j=1}^n \dfrac{|a_i\cap a_j|}{|a_i\cup a_j|}\)</span>ã€‚</p><p>é¦–å…ˆåˆ†ç¦»å¸¸æ•°ï¼Œæœ‰ï¼š</p><p><span class="math display">\[\begin{aligned}f_i&amp;=\sum\limits_{j=1}^n \dfrac{|a_i\cap a_j|}{|a_i\cup a_j|}\\&amp;=\sum_{j=1}^n\dfrac {|a_i|+|a_j|-|a_i\cup a_j|}{|a_i\cup a_j|}\\&amp;=\sum_{j=1}^n \dfrac {|a_i|+|a_j|}{|a_i\cup a_j|}-1\end{aligned}\]</span></p><p>å°½é‡æŠŠåˆ†å­å˜å¾—æ›´ç®€ï¼š</p><p><span class="math display">\[\begin{aligned}f_i&amp;=\sum_{j=1}^n \dfrac {|a_i|+|a_j|}{|a_i\cup a_j|}-1\\&amp;=|a_i|\cdot\left(\sum_{j=1}^n\dfrac 1{|a_i\cup a_j|}\right)-n+\sum_{j=1}^n \dfrac {|a_j|}{|a_i\cup a_j|}\end{aligned}\]</span></p><p>é—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£ <span class="math inline">\(\sum\limits_{j=1}^n\dfrac 1{|a_i\cup a_j|}\)</span> å’Œ <span class="math inline">\(\sum\limits_{j=1}^n\dfrac {|a_j|}{|a_i\cup a_j|}\)</span>ï¼Œä»¥ <span class="math inline">\(*=\sum\limits_{j=1}^n\dfrac 1{|a_i\cup a_j|}\)</span> ä¸ºä¾‹ã€‚ä»¤ <span class="math inline">\(b_i\)</span> ä¸º <span class="math inline">\(a_i\)</span> è¡¥é›†ï¼Œåˆ™ï¼š</p><p><span class="math display">\[\begin{aligned}*&amp;=\sum\limits_{j=1}^n\dfrac 1{|a_i\cup a_j|}\\&amp;=\sum_{j=1}^n\dfrac 1{k-|b_i\cap b_j|}\end{aligned}\]</span></p><p>ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªè½¬æ¢å‘¢ï¼Ÿç›¸æ¯”èµ·å¹¶é›†è¿ç®—ï¼Œäº¤é›†è¿ç®—æœ‰ç€ä¼˜ç§€çš„æ€§è´¨ï¼š<span class="math inline">\(s\subseteq(b_i\cap b_j)\iff s\subseteq b_i\land s\subseteq b_j\)</span>ï¼Œ<del>ç›´æ¥å–æˆ–å½“ç„¶ä¹Ÿæœ‰ç›¸ä¼¼çš„æ€§è´¨ï¼Œä½†æ˜¯å¤ªçƒ§è„‘äº†</del>ã€‚</p><p>åŸºäºè¿™ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæƒ³æ³•ï¼šå¯¹äºæ‰€æœ‰ <span class="math inline">\(j\)</span>ï¼Œåœ¨ <span class="math inline">\(\forall \, s\subseteq b_j\)</span> å¤„æ”¾ç½® <span class="math inline">\(\dfrac 1{k-|s|}\)</span> çš„è´¡çŒ®ï¼›å¯¹äº <span class="math inline">\(i\)</span>ï¼Œå°† <span class="math inline">\(\forall \, s\subseteq b_i\)</span> å¤„çš„è´¡çŒ®æ±‚å’Œã€‚ä½†æ˜¯è¿™æ ·è‚¯å®šä¼šæ‹¿åˆ°å¾ˆå¤šæˆ‘ä»¬ä¸æƒ³è¦çš„è´¡çŒ®ï¼Œä¾‹å¦‚ <span class="math inline">\(\forall \, s\subset (b_i\cap b_j)\)</span>ã€‚</p><p>è€ƒè™‘ç²¾ç»†å¸ƒç½®è´¡çŒ®â€”â€”æ„é€  <span class="math inline">\(g(|s|)\)</span> æ»¡è¶³ <span class="math inline">\(\sum\limits_{j=1}^n\sum\limits_{s\subseteq b_j}g(|s|)=*\)</span>ã€‚</p><p>è¿™é‡Œå¯ä»¥äºŒé¡¹å¼åæ¼”å¾—åˆ° <span class="math inline">\(g\)</span>ï¼Œå…·ä½“åœ°ï¼Œä»¤ <span class="math inline">\(F(|S|)=\dfrac 1{k-|S|}=\sum\limits_{s\subseteq S}g(|s|)=\sum\limits_{j=0}^{|S|} C_{|S|}^j g(j)\)</span>ï¼Œåˆ™ <span class="math inline">\(g(i)=\sum\limits_{j=0}^iC_i^j\cdot \dfrac {(-1)^{i-j}}{k-j}\)</span>ã€‚</p><p>å†ä»¤ <span class="math inline">\(h(s)=\sum\limits_{b_j\supseteq s}g(|s|)=g(|s|)\cdot \sum\limits_{b_j\supseteq s}1\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\(h\)</span> å°±æ˜¯é«˜ç»´åç¼€å’Œã€‚æˆ‘ä»¬æ­£åœ¨åšçš„äº‹æƒ…å°±æ˜¯æ±‚è§£ <span class="math inline">\(*=\sum\limits_{s\subseteq b_i}h(s)\)</span>ï¼Œè¿™å°±åˆæ˜¯ä¸€ä¸ªé«˜ç»´å‰ç¼€å’Œäº†ã€‚</p><p>å¯¹äº <span class="math inline">\(\sum\limits_{j=1}^n\dfrac {|a_j|}{|a_i\cup a_j|}\)</span> å‘¢ï¼Œä»¤ <span class="math inline">\(h(s)=\sum\limits_{b_j\supseteq s}g(|s|)\cdot {\color{red}{|a_j|}} = g(|s|) \cdot \sum\limits_{b_j\supseteq s} \color{red}{k - |b_j|}\)</span>ï¼Œæ”¹å˜é«˜ç»´åç¼€å’Œæ±‚å’Œå¯¹è±¡å³å¯ã€‚</p><p>å¤æ‚åº¦å°±æ˜¯ <span class="math inline">\(O(n+k\cdot 2^k)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(k\cdot 2^k\)</span> æ¥è‡ªæ•´ä½“é«˜ç»´å‰ / åç¼€å’Œï¼Œ<span class="math inline">\(n\cdot k\)</span> æ¥è‡ªæšä¸¾ <span class="math inline">\(i\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k, l;    std::cin &gt;&gt; n &gt;&gt; k, l = 1 &lt;&lt; k;    std::vector&lt;int&gt; a(n + 1), b(n + 1), cnt(l);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i], b[i] = (l - 1) ^ a[i];        ++cnt[b[i]];    &#125;    std::vector&lt;long long&gt; g(k + 1), fac(k + 1);    auto qkp = [&amp;](long long x, int y = mod - 2) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * qkp(fac[n - m]) % mod * qkp(fac[m]) % mod;    &#125;;    fac[0] = 1ll;    for (int i = 1; i &lt;= k; ++i)        fac[i] = fac[i - 1] * i % mod;    for (int i = 0; i &lt;= k; ++i) &#123;        for (int j = 0, p = (i &amp; 1) ? mod - 1 : 1; j &lt;= i; ++j, p = mod - p)            (g[i] += C(i, j) * p % mod * qkp(k - j) % mod) %= mod;        // printf(&quot;g[%d] = %lld\n&quot;, i, g[i]);    &#125;    // for (int i = 0; i &lt;= k; ++i) &#123;    //     long long F = 0ll;    //     for (int j = 0; j &lt;= i; ++j)    //         (F += C(i, j) * g[j] % mod) %= mod;    //     printf(&quot;%d: %lld / %lld\n&quot;, i, F, qkp(k - i));    // &#125;    std::vector&lt;long long&gt; h(l);    std::copy(cnt.begin(), cnt.end(), h.begin());    for (int i = 0; i &lt; k; ++i)        for (int j = l - 1; ~j; --j)            if (!((j &gt;&gt; i) &amp; 1))                (h[j] += h[j ^ (1 &lt;&lt; i)]) %= mod;    auto f1(h);    for (int i = 0; i &lt; l; ++i)        (f1[i] *= g[__builtin_popcount(i)]) %= mod;    for (int i = 0; i &lt; k; ++i)        for (int j = 0; j &lt; l; ++j)            if ((j &gt;&gt; i) &amp; 1)                (f1[j] += f1[j ^ (1 &lt;&lt; i)]) %= mod;    for (int i = 0; i &lt; l; ++i)        h[i] = cnt[i] * (k - __builtin_popcount(i));    for (int i = 0; i &lt; k; ++i)        for (int j = l - 1; ~j; --j)            if (!((j &gt;&gt; i) &amp; 1))                (h[j] += h[j ^ (1 &lt;&lt; i)]) %= mod;    auto f2(h);    for (int i = 0; i &lt; l; ++i)        (f2[i] *= g[__builtin_popcount(i)]) %= mod;    for (int i = 0; i &lt; k; ++i)        for (int j = 0; j &lt; l; ++j)            if ((j &gt;&gt; i) &amp; 1)                (f2[j] += f2[j ^ (1 &lt;&lt; i)]) %= mod;    for (int i = 1; i &lt;= n; ++i) &#123;        // fprintf(stderr, &quot;%d: %d * %lld - %d + %lld\n&quot;, i, __builtin_popcount(a[i]), f1[b[i]], n, f2[b[i]]);        std::cout &lt;&lt; (__builtin_popcount(a[i]) * f1[b[i]] % mod + mod - n + f2[b[i]]) % mod &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="e---prefix-xors">E - Prefix XORs</h2><p><a href="https://atcoder.jp/contests/arc137/tasks/arc137_d" class="uri">https://atcoder.jp/contests/arc137/tasks/arc137_d</a></p><p>çœæµï¼šåš <span class="math inline">\(k\)</span> æ¬¡å‰ç¼€å’Œï¼Œ<span class="math inline">\(k=1,2,\cdots,m\)</span>ï¼Œåˆ†åˆ«è¯¢é—®ï¼šä»¤ <span class="math inline">\(x_i\gets a_i\)</span> å¯¹ <span class="math inline">\(s_n\)</span> çš„è´¡çŒ®æ¬¡æ•°ï¼Œåˆ™ <span class="math inline">\(\sum a_i\cdot (x_i\bmod 2)\)</span>ï¼Ÿ</p><p>å¯¹äº <span class="math inline">\(a_p\)</span>ï¼Œå®¹æ˜“å‘ç°ç¬¬ä¸€è½®å…¶å¯¹ä»»æ„ <span class="math inline">\(s_q\)</span> æœ‰ <span class="math inline">\(1\)</span> æ¬¡è´¡çŒ®ï¼Œæ‹‰å¼€æ¥å°±æ˜¯å¸¸æ•°åˆ—ï¼›ç¬¬äºŒè½®æœ‰ <span class="math inline">\((q-p+1)\)</span> æ¬¡è´¡çŒ®ï¼Œæ˜¯å…¬å·®ä¸º <span class="math inline">\(1\)</span> çš„ç­‰å·®æ•°åˆ—ï¼›ç¬¬ä¸‰è½®æ˜¯ç±»ä¸‰è§’å½¢æ•°â€”â€”è‡³æ­¤ï¼Œè‚¯å®šå’Œç»„åˆæ•°æœ‰å…³äº†ã€‚æ‰‹ç©å¯ä»¥å‘ç°ç¬¬ <span class="math inline">\(k\)</span> è½® <span class="math inline">\(a_p\)</span> å¯¹ <span class="math inline">\(s_n\)</span> çš„è´¡çŒ®ä¸º <span class="math inline">\(C_{n-p+(k-2)}^{n-p}\)</span>ï¼Œå°½é‡ä»¤å…¶ä¸­ä¸€ä¸ªä¸åŠ¨ï¼Œå¾—åˆ° <span class="math inline">\(C_{n-p+(k-2)}^{k-1}\)</span>ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬å‘ç°ç›´æ¥æšä¸¾æ¯è½®æ¯ä¸ªæ•°ä¼šèµ·é£ï¼Œè€Œä¸”æ¨¡æ•°ä¸º <span class="math inline">\(2\)</span> ä¼¼ä¹åªèƒ½ Lucasï¼ˆå†å¸¦ä¸ª <span class="math inline">\(\log\)</span>ï¼‰ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>é‚£å°± Lucas å‘—ã€‚ç”±å…¶è§‚å¯Ÿå®¹æ˜“å‘ç° <span class="math inline">\(C_{n-p+(k-2)}^{k-2}\bmod2=1\)</span> å½“ä¸”ä»…å½“ <span class="math inline">\((k-2)\subseteq (n-p+k-2)\iff (k-2)\subseteq \complement_U(n-p)\)</span>ï¼Œæ•…é—®é¢˜è½¬åŒ–ä¸ºé«˜ç»´åç¼€å’Œï¼Œ<del>å½“ç„¶ä½ ä¹Ÿå¯ä»¥åšä¸€æ¬¡ and-FWT</del>ï¼Œé‚£ä¹ˆ <span class="math inline">\(res_k=\sum (C_{n-p+(k-2)}^{k-2}\bmod 2)\cdot a_p=S_{k-2}\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(S\)</span> ä¸ºé«˜ç»´åç¼€å’Œï¼Œåˆå€¼ä¸º <span class="math inline">\(S_{\complement_u(n-i)}\gets a_i\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, l, k;    std::cin &gt;&gt; n &gt;&gt; m, k = std::__lg(n + m) + 1, l = 1 &lt;&lt; k;    std::vector&lt;int&gt; s(l);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; s[l - 1 - (n - i)];    for (int i = 0; i &lt; k; ++i)        for (int j = l - 1; ~j; --j)            if (!((j &gt;&gt; i) &amp; 1))                s[j] ^= s[j ^ (1 &lt;&lt; i)];    for (int i = 1; i &lt;= m; ++i)        std::cout &lt;&lt; s[i - 1] &lt;&lt; &#39; &#39;;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---the-top-scorer">B - The Top Scorer</h2><p><a href="https://codeforces.com/problemset/problem/1096/E" class="uri">https://codeforces.com/problemset/problem/1096/E</a></p><p>é‰´äºæ¯ç§æ–¹æ¡ˆç­‰æ¦‚ç‡ï¼ˆç¿»è¯‘æ²¡è¯´ï¼Œä½†åŸé¢˜é¢æœ‰æåˆ°ï¼‰ï¼Œè€ƒè™‘è®¡ç®—å°æ˜èƒ½å¤Ÿå–èƒœçš„æ–¹æ¡ˆæ•°ï¼Œå†å¯¹æ€»æ–¹æ¡ˆæ•°åšé™¤æ³•ã€‚å…ˆæšä¸¾æœ€é«˜åˆ† <span class="math inline">\(k\ge r\)</span>ï¼Œå†æšä¸¾åŒ…æ‹¬å°æ˜åœ¨å†…æ°æœ‰ <span class="math inline">\(c\ge 1\)</span> ä¸ªäºº æ‹¿åˆ° <span class="math inline">\(k\)</span> åˆ†ã€‚ä½†å‰©ä¸‹çš„äººå‘¢ï¼Ÿæ˜¾ç„¶æ˜¯ä¸èƒ½æ’æ¿éšæœºåˆ†é…çš„ï¼Œå› ä¸ºå­˜åœ¨ <span class="math inline">\(&lt;k\)</span> çš„é™åˆ¶ã€‚</p><p>è€ƒè™‘å®¹æ–¥ï¼Œé’¦å®šå‰©ä¸‹çš„ <span class="math inline">\(p-c\)</span> ä¸ªäººä¸­æ‹¿åˆ° <span class="math inline">\(\ge k\)</span> åˆ†çš„äººæ•°åå†å¯ç©ºåœ°æ’æ¿å³å¯ï¼Œåˆ™æ€»æ–¹æ¡ˆæ•°ä¸ºï¼š</p><p><span class="math display">\[\sum_{k=r}^s\sum_{c=1}^p\dfrac {C_{p - 1}^{c-1}}c\cdot \sum_{i=0}^{p-c}C_{p-c}^i\cdot C_{s-k\cdot (c+i)+(p-c-1)}^{p-c-1}\]</span></p><p>å…¶ä¸­åˆ†æ¯ä¸Šçš„ <span class="math inline">\(c\)</span> æ¥æºäºç­‰æ¦‚ç‡åˆ†é…ç»™æœ€é«˜åˆ†ï¼Œè™½ç„¶ä¸æ˜¯æ•´æ•°ï¼Œä½†ä¹Ÿä»£è¡¨ç€ã€Œå°æ˜è·èƒœå¯è¡Œæ–¹æ¡ˆæ•°ã€ã€‚æœ€åå°†ç­”æ¡ˆé™¤ä¸Šæ€»æ–¹æ¡ˆæ•° <span class="math inline">\(C_{s-r+p-1}^{p-1}\)</span> å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int p, s, r;    std::cin &gt;&gt; p &gt;&gt; s &gt;&gt; r;    std::vector&lt;long long&gt; fac(s + p), inv(s + p);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt; s + p; ++i) &#123;        fac[i] = fac[i - 1] * i % mod;    &#125;    auto qkp = [&amp;](long long x, int y) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv.back() = qkp(fac.back(), mod - 2);    for (int i = s + p - 2; i &gt; 0; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        if (n == -1 &amp;&amp; m == -1)            return 1ll;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    auto res(0ll);    for (int k = r; k &lt;= s; ++k)        for (int c = 1; c &lt;= p; ++c)            if ((p - c) * (k - 1) + c * k &gt;= s) &#123;                auto t(0ll);                for (int i = 0, now = 1; i &lt;= p - c &amp;&amp; k * (c + i) &lt;= s; ++i, now = mod - now)                    (t += now * C(p - c, i) % mod * C(s - k * (c + i) + (p - c - 1), p - c - 1) % mod) %= mod;                (res += C(p - 1, c - 1) * qkp(c, mod - 2) % mod * t % mod) %= mod;            &#125;    std::cout &lt;&lt; res * qkp(C(s - r + p - 1, p - 1), mod - 2) % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c---sky-full-of-stars">C - Sky Full of Stars</h2><p><a href="https://codeforces.com/problemset/problem/997/C" class="uri">https://codeforces.com/problemset/problem/997/C</a></p><p>å‘ç°ç”¨ <span class="math inline">\(3^{n\times n}\)</span> å‡å»ä»»æ„ä¸€è¡Œä¸€åˆ—ä¸åŒè‰²çš„æ–¹æ¡ˆå°±æ˜¯ç­”æ¡ˆã€‚</p><p>è€ƒè™‘ä¸€å…ƒå®¹æ–¥ï¼Œå¦‚ä»¤ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºè‡³å°‘ <span class="math inline">\(i\)</span> è¡Œ <span class="math inline">\(i\)</span> åˆ—åŒè‰²çš„æ–¹æ¡ˆï¼Œä½†ä¼šå‘ç° <span class="math inline">\(f_0\)</span> ä¸­åŒ…å« <span class="math inline">\(0\)</span> è¡Œ <span class="math inline">\(1\)</span> åˆ—åŒè‰²ç­‰ä¸é¢„æœŸä¸ç¬¦çš„æƒ…å†µã€‚å—æ­¤å¯å‘è€ƒè™‘ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºè‡³å°‘ <span class="math inline">\(i\)</span> è¡Œ <span class="math inline">\(j\)</span> åˆ—åŒè‰²è¿›è¡ŒäºŒå…ƒå®¹æ–¥ã€‚å®¹æ˜“å‘ç°å½“ <span class="math inline">\(i\times j\ne 0\)</span> æ—¶ï¼Œè¢«é€‰ä¸­çš„ <span class="math inline">\(i\)</span> è¡Œ <span class="math inline">\(j\)</span> åˆ—å…¨éƒ¨è¿é€šï¼Œåº”ä¸ºåŒä¸€ç§é¢œè‰²ï¼›å°†å®ƒä»¬æŒªåˆ°è§’è½ï¼Œå¯ä»¥å‘ç°æœªè¢«é€‰ä¸­çš„æ ¼å­å…±æœ‰ <span class="math inline">\((n-i)\times (n-j)\)</span> ä¸ªã€‚æ•…æœ‰ï¼š</p><p><span class="math display">\[f_{i,j}=\begin{cases}C_n^j\times 3^j\times 3^{n\times(n - j)}&amp;i=0\\C_n^i\times 3^i\times 3^{n\times(n-i)}&amp;j=0\\C_n^i\times C_n^j\times 3\times 3^{(n-i)\times (n-j)}&amp;\text{otherwise}\end{cases}\]</span></p><p>ä»¤ <span class="math inline">\(g_{i,j}\)</span> è¡¨ç¤ºæ°å¥½ <span class="math inline">\(i\)</span> è¡Œ <span class="math inline">\(j\)</span> åˆ—åŒè‰²çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º <span class="math inline">\(3^{n\times n}-g_{0,0}\)</span>ã€‚äºŒé¡¹å¼åæ¼” / å®¹æ–¥åŸç†å¾— <span class="math inline">\(g_{0,0}=\sum\limits_{i=0}^n\sum\limits_{j=0}^n (-1)^{i+j}\cdot f_{i,j}\)</span>ã€‚å¾ˆæƒŠè®¶åœ°å‘ç°è¿™æ˜¯ <span class="math inline">\(O(n^2)\)</span> çš„ï¼è€ƒè™‘ä¼˜åŒ–ã€‚æŠŠ <span class="math inline">\(f_{1\to n,1\to n}\)</span> åˆå¹¶åŒç±»é¡¹ï¼Œå¾—åˆ°ï¼š</p><p><span class="math display">\[\begin{aligned}g_{0, 0}&amp;=\left[\sum_{j=0}^n (-1)^j\cdot f_{0,j}\right]+\sum_{i=1}^n (-1)^i\cdot f_{i,0}+\sum_{j=1}^n (-1)^{i+j}\cdot C_n^i\times C_n^j\times 3^{(n-i)\times (n-j)+1}\\&amp;=\left[\sum_{j=0}^n (-1)^j\cdot f_{0,j}\right]+\sum_{i=1}^n (-1)^i\cdot f_{i,0}+(-1)^i\cdot C_n^i\times 3^{n^2-n\times i+1}\times\sum_{j=1}^n (-1)^j\cdot C_n^j\times 3^{j\times(-n+i)}\\&amp;=\left[\sum_{j=0}^n (-1)^j\cdot f_{0,j}\right]+\sum_{i=1}^n (-1)^i\cdot f_{i,0}+(-1)^i\cdot C_n^i\times 3^{n^2-n\times i+1}\times\left[\left(\sum_{j=0}^n (-1)^j\cdot C_n^j\times (3^{-n+i})^j\right)-1\right]\\&amp;=\left[\sum_{j=0}^n (-1)^j\cdot f_{0,j}\right]+\sum_{i=1}^n (-1)^i\cdot f_{i,0}+(-1)^i\cdot C_n^i\times 3^{n^2-n\times i+1}\times\left[(-3^{-n+i}+1)^n-1\right]\end{aligned}\]</span></p><p>ç”±æ­¤ä¾¿å¯ <span class="math inline">\(O(n\log n)\)</span> è®¡ç®—ã€‚æ‹…å¿ƒè¶…æ—¶å¯ä»¥æŠŠæ‰€æœ‰ <span class="math inline">\(3^{-n+i}\)</span> å’Œ <span class="math inline">\(3^{n\times i}\)</span> çº¿æ€§é¢„å¤„ç†å‡ºæ¥ï¼Œå¤æ‚åº¦ä¸ä¼šå˜å°±æ˜¯äº†ã€‚</p><p>è¿™é‡Œè§£é‡Šä¸€ä¸‹æœ€åä¸€æ­¥çš„äºŒé¡¹å¼å®šç†ï¼Œéå¸¸é—æ†¾åœ°å‘ç° <span class="math inline">\(-1\)</span> å’Œ <span class="math inline">\(3^{-n+i}\)</span> éƒ½æ˜¯ <span class="math inline">\(j\)</span> æ¬¡çš„ï¼Œæ²¡åŠæ³•æŠŠäºŒè€…ç›¸åŠ å‡åšäºŒé¡¹å¼å®šç†ï¼›ä½†ç”±äºæ¬¡æ•°ç›¸åŒï¼Œè¿™æç¤ºæˆ‘ä»¬å¯ä»¥æŠŠ <span class="math inline">\(-1\)</span> ä¹˜åˆ° <span class="math inline">\(3^{-n+i}\)</span> é‡Œå»ï¼Œç»™æ¯ä¸€é¡¹é…ä¸Š <span class="math inline">\(1^{n-k}\)</span> å°±å¯ä»¥åš <span class="math inline">\(-3^{n-i}\)</span>ï¼ˆæ³¨æ„ä¸æ˜¯ <span class="math inline">\((-3)^{n-i}\)</span>ï¼‰ å’Œ <span class="math inline">\(1\)</span> çš„äºŒé¡¹å¼å®šç†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    long long n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1), invn(n + 1), invi(n + 1), powi(n + 1), pown(n + 1);    auto qkp = [&amp;](long long x, long long y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    const long long pnn = qkp(3ll, n * n), pn = qkp(3ll, n);    fac[0] = inv[0] = invn[0] = invi[0] = powi[0] = pown[0] = 1ll;    for (int i = 1; i &lt;= n; ++i) &#123;        fac[i] = fac[i - 1] * i % mod;        powi[i] = powi[i - 1] * 3 % mod;        pown[i] = pown[i - 1] * pn % mod;    &#125;    inv[n] = qkp(fac[n], mod - 2);    invi[n] = qkp(powi[n], mod - 2);    invn[n] = qkp(pown[n], mod - 2);    for (int i = n - 1; i; --i) &#123;        inv[i] = inv[i + 1] * (i + 1) % mod;        invi[i] = invi[i + 1] * 3 % mod;        invn[i] = invn[i + 1] * pn % mod;    &#125;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    long long g = 0ll;    auto f = [&amp;](int i, int j) &#123; // make sure (!i || !j)        if (i == 0 &amp;&amp; j == 0)            return pnn;        else if (i == 0)            return C(n, j) * powi[j] % mod * pown[n - j] % mod;        return C(n, i) * powi[i] % mod * pown[n - i] % mod;    &#125;;    for (int j = 0, p = 1; j &lt;= n; ++j, p = mod - p)        (g += p * f(0, j)) %= mod;    for (int i = 1, p = mod - 1; i &lt;= n; ++i, p = mod - p)        (g += p * f(i, 0) % mod + p * C(n, i) % mod * pnn % mod * invn[i] % mod * 3 % mod * (qkp(mod - invi[n - i] + 1, n) + mod - 1) % mod) %= mod;    std::cout &lt;&lt; (pnn + mod - g) % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d---å»-m-nom">D - å» M / NoM</h2><p><a href="https://www.luogu.com.cn/problem/P11316" class="uri">https://www.luogu.com.cn/problem/P11316</a></p><p>å‡è®¾ <span class="math inline">\(f(i)\)</span> ä¸ºè‡³å°‘æœ‰ <span class="math inline">\(i\)</span> å¯¹ä¸åˆæ³•å…ƒç´ çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™å®¹æ–¥å¾—åˆ°ç­”æ¡ˆ <span class="math inline">\(\sum\limits_{i=0}^n (-1)^i\cdot f(i)\)</span>ã€‚è€ƒè™‘æ€ä¹ˆè®¡ç®— <span class="math inline">\(f(i)\)</span>ã€‚</p><p><mark><span class="math inline">\(M\)</span> æ•´é™¤ <span class="math inline">\(dis(x, y) \iff (pos_x - pos_y)\bmod M=0\iff pos_x\equiv pos_y\pmod M\)</span>ã€‚</mark></p><p>è€ƒè™‘æŠŠå…³äº <span class="math inline">\(M\)</span> åŒä½™çš„ä½ç½®æ”¾åœ¨ä¸€ä¸ªç»„ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦è®©ä¸€å¯¹å…ƒç´ ä¸èƒ½é€‰åŒä¸€ç»„çš„ä½ç½®ã€‚</p><p>è€ƒè™‘å®¹æ–¥ï¼Œä»¤ <span class="math inline">\(f(i)\)</span> è¡¨ç¤ºè‡³å°‘æœ‰ <span class="math inline">\(i\)</span> å¯¹ç‚¹é€‰åˆ°ä¸€ç»„çš„æ–¹æ¡ˆæ•°ï¼Œè€ƒè™‘æ€ä¹ˆè®¡ç®—ã€‚å‡è®¾æˆ‘ä»¬è¦åœ¨ç¬¬ <span class="math inline">\(k\)</span> ç»„ï¼ˆsize ä¸º <span class="math inline">\(s_k\)</span>ï¼‰ä¸­é€‰å‡º <span class="math inline">\(x\)</span> å¯¹ä½ç½®ï¼Œå®é™…ä¸Šåªéœ€è¦é€‰æ‹© <span class="math inline">\(2x\)</span> ä¸ªä½ç½®ç„¶åä»»æ„åˆ†é…ç»™è¿™ <span class="math inline">\(x\)</span> å¯¹æ•°ï¼Œå³ <span class="math inline">\(A_{s_k}^{2x}\)</span>ã€‚è®¾ <span class="math inline">\(dp_{i, j}\)</span> è¡¨ç¤º DP åˆ°ç¬¬ <span class="math inline">\(i\)</span> ä¸ªç»„ï¼Œå·²ç»é€‰äº† <span class="math inline">\(j\)</span> å¯¹ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(dp_{i,j}=\sum\limits_{k=0}^jC_{n-(j - k)}^{j-k}\times dp_{i-1,j-k}\times A_{s_i}^{2k}\)</span>ã€‚ä¹ä¸€çœ‹å¥½åƒæ˜¯ <span class="math inline">\(O(n^3)\)</span> çš„ï¼Œä½†æ˜¯åˆ«å¿˜äº† <span class="math inline">\(\sum s_i=2n\)</span>ï¼Œæ‰€ä»¥åªæœ‰ <span class="math inline">\(O(n^2)\)</span>ã€‚<span class="math inline">\(f(i)\)</span> å³ä¸º <span class="math inline">\(dp_{m,i}\times (2n-2i)!\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; s(m + 1);    std::vector&lt;long long&gt; fac(2 * n + 1), inv(2 * n + 1);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= 2 * n; ++i)        ++s[i % m + 1], fac[i] = fac[i - 1] * i % mod;    auto qkp = [](long long x, int y) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[2 * n] = qkp(fac[2 * n], mod - 2);    for (int i = 2 * n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto A = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod;    &#125;;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    std::vector&lt;std::vector&lt;long long&gt; &gt; dp(m + 1, std::vector&lt;long long&gt; (n + 1));    dp[0][0] = 1ll;    for (int i = 1; i &lt;= m; ++i)        for (int j = 0; j &lt;= n; ++j) &#123;            for (int k = 0; k &lt;= j &amp;&amp; 2 * k &lt;= s[i]; ++k)                (dp[i][j] += C(n - (j - k), k) * dp[i - 1][j - k] % mod * A(s[i], 2 * k) % mod) %= mod;            // printf(&quot;s = %d, dp[%d][%d] = %lld\n&quot;, s[i], i, j, dp[i][j]);        &#125;    long long res = 0ll;    for (int i = 0, p = 1; i &lt;= n; ++i, p = mod - p)        (res += p * dp[m][i] % mod * fac[2 * n - 2 * i] % mod) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="e---kdoi-11å½©ç¯æ™šä¼š">E - ã€ŒKDOI-11ã€å½©ç¯æ™šä¼š</h2><p><a href="https://www.luogu.com.cn/problem/P11292" class="uri">https://www.luogu.com.cn/problem/P11292</a></p><p>è€ƒè™‘ <span class="math inline">\({cnt_i}^2\)</span> çš„å«ä¹‰ï¼Œå³åœ¨æ‰€æœ‰é¢œè‰²ä¸º <span class="math inline">\(i\)</span>ã€é•¿åº¦ä¸º <span class="math inline">\(l\)</span> çš„é“¾ä¸­æœ‰æ”¾å›åœ°é€‰ä¸¤æ¬¡çš„æ–¹æ¡ˆæ•°ã€‚</p><p>æ˜¾ç„¶å¤æ‚åº¦é‡Œæ˜¯ä¸èƒ½åŒ…å« <span class="math inline">\(k\)</span> çš„ï¼Œæ‰€ä»¥æ”¾å¼ƒç›´æ¥ç»Ÿè®¡ <span class="math inline">\(cnt_i\)</span> çš„æƒ³æ³•ã€‚æ˜¾ç„¶æ¯ç§é¢œè‰²æ˜¯ç­‰ä»·çš„ï¼Œè€ƒè™‘è®¡ç®—é€‰æ‹©ä¸¤æ¡é“¾å¯ä»¥ç»™ç­”æ¡ˆå¸¦æ¥çš„è´¡çŒ®ï¼šç­”æ¡ˆçš„å½¢å¼æ˜¯ä¸ªå’Œå¼ï¼›å¯¹äºä¸¤æ¡åŒè‰²é“¾ <span class="math inline">\(p,q\)</span>ï¼Œå‡è®¾é¢œè‰²ä¸º <span class="math inline">\(i\)</span>ï¼Œé‚£ä¹ˆä¼šå¯¹ <span class="math inline">\({cnt_i}^2\)</span> å¸¦æ¥ <span class="math inline">\(k^{n-2l-|p\cap q|}\)</span> çš„è´¡çŒ®ï¼Œå¯¹æ€»ç­”æ¡ˆå¸¦æ¥ <span class="math inline">\(k^{n-2l-|p\cap q| + 1}\)</span> çš„è´¡çŒ®ã€‚</p><p>ç„¶è€Œå¦‚æœè¦æšä¸¾è®¡ç®— <span class="math inline">\(|p\cap q|\)</span> å°±æ— æ³•é¿å… <span class="math inline">\(O(n^5)\)</span>ï¼Œè€ƒè™‘æ›´æœ‰æ½œåŠ›çš„æ–¹æ³•ï¼šå°†é—®é¢˜è½¬åŒ–ä¸ºå¯¹äºæ¯ä¸ª <span class="math inline">\(x\)</span>ï¼Œæ±‚äº¤é›†å¤§å°æ°å¥½ä¸º <span class="math inline">\(x\)</span> çš„é“¾å¯¹ä¸ªæ•°ã€‚ç„¶è€Œã€Œæ°å¥½ã€æ˜¯ä¸æ–¹ä¾¿è®¡ç®—çš„â€”â€”å‡å¦‚å½“å‰ä¸¤é“¾åœ¨ <span class="math inline">\(u\)</span> æ¬¡é‡åˆï¼Œå¦‚æœå‡è®¾ä¸‹ä¸€æ¬¡åœ¨ <span class="math inline">\(v\)</span> æ¬¡é‡åˆï¼Œå°±éœ€è¦ä¿è¯åœ¨ <span class="math inline">\(u,v\)</span> ä¹‹é—´ä¸èƒ½é‡åˆâ€”â€”è¿™å¹¶ä¸å¥½æ“ä½œã€‚äºŒé¡¹å¼åæ¼”å°†æ°å¥½è½¬åŒ–ä¸ºè‡³å°‘ï¼Œåˆ™é™åˆ¶å‡å¼±ã€‚</p><p>ä»¤ <span class="math inline">\(f_{u,c,l_1,l_2}\)</span> è¡¨ç¤º <span class="math inline">\(p,q\)</span> å½“å‰åœ¨ <span class="math inline">\(u\)</span> å¤„é‡åˆï¼Œè§†é‡å†…çš„ <span class="math inline">\(p,q\)</span> é•¿åº¦ä¸º <span class="math inline">\(l_1,l_2\)</span>ï¼Œè‡³å°‘å·²ç»é‡åˆäº† <span class="math inline">\(c\)</span> æ¬¡çš„æ–¹æ¡ˆæ•°ã€‚é¢„å¤„ç†å‡ºèµ°åˆ° <span class="math inline">\(u\)</span> æ­¥æ•°ä¸º <span class="math inline">\(l_1,l_2\)</span> çš„æ–¹æ¡ˆæ•°ä¸ºåˆå§‹å€¼ã€‚æšä¸¾å¯èƒ½çš„åç»­é‡åˆç‚¹ <span class="math inline">\(v\)</span>ï¼ˆæ»¡è¶³ <span class="math inline">\(v\)</span> çš„æ‹“æ‰‘åº <span class="math inline">\(&gt;u\)</span>ï¼‰æœ‰ <span class="math inline">\(f_{v,c+1,l_1&#39;,l_2&#39;}\gets f_{v,c+1,l_1&#39;,l_2&#39;} + f_{u,c,l_1,l_2}\)</span>ã€‚é¢„å¤„ç†å‡º <span class="math inline">\(u\to v\)</span> é•¿åº¦ä¸º <span class="math inline">\(\Delta\)</span> çš„æ–¹æ¡ˆæ•°ï¼ˆè¿™æ˜¯ <span class="math inline">\(O(n^3l)\)</span> çš„ï¼‰ä¼˜åŒ–è½¬ç§»ï¼Œåœ¨ç®—å‡º <span class="math inline">\(nex_{u,l}\)</span> è¡¨ç¤ºä» <span class="math inline">\(u\)</span> å‡ºå‘èµ° <span class="math inline">\(l\)</span> æ­¥çš„æ–¹æ¡ˆæ•°å¤„ç†ç­”æ¡ˆï¼Œåˆ™ <span class="math inline">\(F(i)=\sum_{u,l_1,l_2}f_{u,l_1,l_2}\cdot nex_{u,l-l_1}\cdot nex_{u,l-l_2}\)</span>ï¼Œæšä¸¾ <span class="math inline">\(u,c,l_1,l_2,v,l_1&#39;,l_2&#39;\)</span>ï¼Œå°±å¯ä»¥è¾¾åˆ°ä¼˜ç§€çš„ <span class="math inline">\(O(n^2l^5+n^3l)\)</span>ï¼ç®€ç›´æ˜¯ä»¤äººéœ‡æ’¼ <img src="/em/kt.gif" /></p><p>ç»™å‡ºç¬¬ä¸€ä¸ªä¼˜åŒ–ï¼šå‘ç° <span class="math inline">\(l_1\)</span> å’Œ <span class="math inline">\(l_2\)</span> çš„è½¬ç§»å½¼æ­¤ä¸å¹²æ‰°ï¼Œè€ƒè™‘å»ºç«‹ä¸€ä¸ªä¸´æ—¶æ•°ç»„ <span class="math inline">\(g\)</span>ï¼Œå…ˆä» <span class="math inline">\(f_u,c\)</span> è½¬ç§» <span class="math inline">\(l_1\)</span> åˆ° <span class="math inline">\(g\)</span>ï¼Œå†ä» <span class="math inline">\(g\)</span> è½¬ç§» <span class="math inline">\(l_2\)</span> åˆ° <span class="math inline">\(f_{v,c+1}\)</span>ï¼Œåˆ™å¤æ‚åº¦é™ä¸º <span class="math inline">\(O(n^2l^4+n^3l)\)</span>ï¼Œä»ä¸è¶³ä»¥é€šè¿‡ã€‚</p><p>DP è¿‡ç¨‹ä¸Šçš„ä¼˜åŒ–å·²ç»ä¸‡ç­–å°½ï¼Œè€ƒè™‘ä»å¼å­æœ¬èº«æ¶ˆå…ƒå‡å°‘ DP ç»´åº¦å…¥æ‰‹ã€‚ä»¤ <span class="math inline">\(h(i)\)</span> è¡¨ç¤ºäº¤é›†å¤§å°æ°å¥½æ°å¥½ä¸º <span class="math inline">\(i\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æ­¤æ—¶ç­”æ¡ˆå¼ä¸º <span class="math inline">\(\sum\limits_{i=0}^l k^{n-2l+i+1}\times h(i)\)</span>ã€‚åˆ <span class="math inline">\(F(i)=\sum\limits_{j=i}^lC_j^i\cdot h(j)\)</span>ï¼ŒäºŒé¡¹å¼åæ¼”å¾—ï¼š</p><p><span class="math display">\[\begin{aligned}res&amp;=\sum\limits_{i=0}^lk^{n-2l+i+1}\cdot \sum_{j=i}^l(-1)^{j-i}\cdot C_j^i\cdot F(j)\\&amp;=k^{n-2l+1}\cdot\sum_{j=0}^l \sum_{i=0}^j k^i\cdot (-1)^{j-i}\cdot C_j^i\cdot F(j)\\&amp;=k^{n-2l+1}\cdot \sum_{j=0}^l (k-1)^j\cdot F(j)\end{aligned}\]</span></p><p><mark>æ³¨æ„è¿™é‡Œåˆ©ç”¨äº†äºŒé¡¹å¼åæ¼”çš„ç³»æ•°å¯ä»¥å’Œäº¤æ¢æ±‚å’Œé¡ºåºåçš„ <span class="math inline">\(i\)</span> æ¬¡é¡¹ï¼ˆæˆ– <span class="math inline">\(j-i\)</span> æ¬¡é¡¹ï¼Œå‚è§ <a href="#c---sky-full-of-stars">Sky Full of Stars ä¸­æœ€åä¸€æ­¥çš„å¤„ç†</a>ï¼‰ç»„æˆäºŒé¡¹å¼å®šç†çš„ç‰¹ç‚¹</mark>ï¼Œä»¥ä¾¿åŸºäºå¼å­ç»“æ„å°½å¯èƒ½æ¶ˆå…ƒã€‚</p><p>é‚£ä¹ˆæ­¤æ—¶ç­”æ¡ˆå¼å·²ç»å’Œ <span class="math inline">\(c\)</span> æ— å…³ï¼Œå¯ä»¥ä¸¢æ‰ <span class="math inline">\(c\)</span> è¿™ä¸€ç»´ï¼Œå’Œ <span class="math inline">\(c\)</span> æœ‰å…³çš„è®¡ç®—å·²ç»åœ¨è½¬ç§»æ—¶å¤„ç†äº†ã€‚åˆ™ <span class="math inline">\(f_{v,l_1&#39;,l_2&#39;}=\sum f_{u,l_1,l_2}\times (k-1)\)</span>ï¼Œå¤æ‚åº¦é™ä¸º <span class="math inline">\(O(n^2l^3+n^3l)\)</span>ã€‚</p><details><p>è®°å¾—è¿˜è¦ç®—ä¸Š <span class="math inline">\(F(0)\)</span>ï¼Œå³ä»»é€‰ä¸€æ¡åˆæ³•é“¾çš„æ–¹æ¡ˆæ•°å¹³æ–¹ã€‚</p><pre class="cpp"><code>// å…„å¼Ÿä½ å¥½é¦™// å…„å¼Ÿä½ æ˜¯ä¾æ‰˜æ‰“åˆ†ï¼Œæˆ‘è¸é©¬åƒåƒåƒåƒåƒ#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;party3.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    using arr = std::vector&lt;long long&gt;;    using arrr = std::vector&lt;arr&gt;;    using arrrr = std::vector&lt;arrr&gt;;    int n, k, l, m;    std::cin &gt;&gt; n, std::cin &gt;&gt; n &gt;&gt; k &gt;&gt; l &gt;&gt; m;    std::vector&lt;int&gt; deg(n + 1), id;    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);    for (int x, y, c; m--; ) &#123;        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; c;        ++deg[y], g[x].emplace_back(y, c);    &#125;    arrrr to(n + 1, arrr(n + 1, arr(l + 1)));    arrr pre(n + 1, arr(l + 1)), nex(n + 1, arr(l + 1));    &#123;        std::queue&lt;int&gt; q;        for (int i = 1; i &lt;= n; ++i)            if (!deg[i])                q.push(i);        for (int u; !q.empty(); ) &#123;            u = q.front(), q.pop();            to[u][u][0] = 1ll, id.push_back(u);            for (auto i : id)                for (int j = 0; j &lt;= l; ++j) &#123;                    (pre[u][j] += to[i][u][j]) %= mod;                    // printf(&quot;to[%d][%d][%d] = %lld\n&quot;, i, u, j, to[i][u][j]);                &#125;            // for (int j = 0; j &lt;= l; ++j)            //     printf(&quot;pre[%d][%d] = %lld\n&quot;, u, j, pre[u][j]);            for (auto [v, c] : g[u]) &#123;                for (auto i : id)                    for (int j = 1; j &lt;= l; ++j)                        (to[i][v][j] += to[i][u][j - 1] * c) %= mod;                if (!--deg[v])                    q.push(v);            &#125;        &#125;        for (int u = 1; u &lt;= n; ++u)            for (int v = 1; v &lt;= n; ++v)                for (int i = 0; i &lt;= l; ++i)                    (nex[u][i] += to[u][v][i]) %= mod;    &#125;    arrrr f(n + 1, arrr(l + 1, arr(l + 1)));    &#123;        for (int i = 1; i &lt;= n; ++i)            for (int l1 = 1; l1 &lt;= l; ++l1)                for (int l2 = 1; l2 &lt;= l; ++l2)                    f[i][l1][l2] = pre[i][l1 - 1] * pre[i][l2 - 1] % mod * (k - 1) % mod;        for (auto i = 0; i &lt; n; ++i) &#123;            int u = id[i];            // for (int l1 = 1; l1 &lt;= l; ++l1)            //     for (int l2 = 1; l2 &lt;= l; ++l2)            //         printf(&quot;f[%d][%d][%d] = %lld\n&quot;, u, l1, l2, f[u][l1][l2]);            for (auto j = i + 1; j &lt; n; ++j) &#123;                arrr g(l + 1, arr(l + 1));                int v = id[j];                for (int l1 = 1; l1 &lt; l; ++l1)                    for (int _l1 = l1 + 1; _l1 &lt;= l; ++_l1) &#123;                        auto K = to[u][v][_l1 - l1];                        if (K)                            for (int l2 = 1; l2 &lt; l; ++l2)                                (g[_l1][l2] += f[u][l1][l2] * K) %= mod;                    &#125;                for (int _l1 = 2; _l1 &lt;= l; ++_l1)                    for (int l2 = 1; l2 &lt; l; ++l2)                        if (g[_l1][l2])                            for (int _l2 = l2 + 1; _l2 &lt;= l; ++_l2)                                (f[v][_l1][_l2] += g[_l1][l2] * to[u][v][_l2 - l2] % mod * (k - 1)) %= mod;             &#125;        &#125;    &#125;    auto qkp = [](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    auto res(0ll);    for (int u = 1; u &lt;= n; ++u)        for (int v = 1; v &lt;= n; ++v)            (res += to[u][v][l - 1]) %= mod;    (res *= res) %= mod;    for (int u = 1; u &lt;= n; ++u)        for (int l1 = 1; l1 &lt;= l; ++l1)            for (int l2 = 1; l2 &lt;= l; ++l2)                (res += f[u][l1][l2] * nex[u][l - l1] % mod * nex[u][l - l2] % mod) %= mod;    res = res % mod * (qkp(k, n + 1) * qkp(qkp(k, 2 * l), mod - 2) % mod) % mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="g---å°æ˜Ÿæ˜Ÿ">G - å°æ˜Ÿæ˜Ÿ</h2><p><a href="https://www.luogu.com.cn/problem/P3349" class="uri">https://www.luogu.com.cn/problem/P3349</a></p><p>é¦–å…ˆè€ƒè™‘æ¯”è¾ƒæš´åŠ›çš„åšæ³•ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_{i,j,S}\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(i\)</span> è¿™ä¸ªå­æ ‘é‡Œé¢é€‰äº†é›†åˆ <span class="math inline">\(S\)</span>ï¼Œä¸” <span class="math inline">\(i\)</span> çš„é¢œè‰²ä¸º <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œç»´æ•°é‡Œä¹‹æ‰€ä»¥æœ‰ <span class="math inline">\(j\)</span> æ˜¯ä¸ºäº†æ»¡è¶³è¿è¾¹é™åˆ¶ã€‚</p><p>ç„¶åæ ‘ä¸Šå­é›† DPï¼Œå‘ç°æ˜¯ <span class="math inline">\(O(n^4\cdot 2^n)\)</span> çš„ï¼Œ</p><hr /><h2 id="cf785d-anton-and-school---2">CF785D Anton and School - 2</h2><p><a href="https://codeforces.com/problemset/problem/785/D" class="uri">https://codeforces.com/problemset/problem/785/D</a></p><p>å®¹æ˜“æƒ³åˆ°æšä¸¾æ¯ä¸ª <code>(</code> ä½œä¸ºåˆ†ç•Œç‚¹çš„æƒ…å†µï¼Œé‚£ä¹ˆé’¦å®šå½“å‰æšä¸¾çš„ <code>(</code> æ˜¯è¦é€‰çš„ã€‚å¯¹äºå½“å‰ <code>(</code>ï¼Œè‹¥å…¶å·¦è¾¹ï¼ˆä¸å«ï¼‰çš„ <code>(</code> æœ‰ <span class="math inline">\(n\)</span> ä¸ªè€Œå³è¾¹çš„ <code>)</code> æœ‰ <span class="math inline">\(m\)</span> ä¸ªï¼Œæšä¸¾é™¤äº†å½“å‰ <code>(</code> è¿˜è¦é€‰ <span class="math inline">\(i\)</span> ä¸ª <code>(</code>ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º <span class="math inline">\(\sum_{i=0}C_n^{i-1}\cdot C_m^i\)</span>ã€‚</p><p>å‘ç°è¿™ä¸ªå½¢å¼å¯ä»¥èŒƒå¾·è’™å¾·å·ç§¯ï¼š<span class="math inline">\(\sum_{i=0}C_n^{i-1}\cdot C_m^i=\sum_{i=0}C_n^{n-i+1}\cdot C_m^i=C_{n+m}^{n+1}\)</span>ã€‚</p><p>å…³äºæ€ä¹ˆè®°å¿†èŒƒå¾·è’™å¾·å·ç§¯ï¼Œå‘ç°ä¸Šä¸‹ç›¸åŠ ï¼Œä¹Ÿå¯ä»¥ä»ç»„åˆæ„ä¹‰è®°å¿†ï¼šåœ¨ <span class="math inline">\(n\)</span> ä¸ªçƒä¸­é€‰å‡º <span class="math inline">\(k-i\)</span> ä¸ªçƒï¼Œå†ä» <span class="math inline">\(m\)</span> ä¸ªçƒä¸­é€‰å‡º <span class="math inline">\(i\)</span> ä¸ªçƒçš„æ€»æ–¹æ¡ˆå°±æ˜¯ä» <span class="math inline">\(n+m\)</span> ä¸ªçƒä¸­ç›´æ¥é€‰å‡º <span class="math inline">\(k\)</span> ä¸ªçƒçš„æ–¹æ¡ˆã€‚</p><p>æ³¨æ„åˆ¤æ–­å³ä¾§æ²¡æœ‰ <code>)</code> çš„æ—¶å€™è´¡çŒ®ä¸º <span class="math inline">\(0\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    std::string s;    std::cin &gt;&gt; s;    int n = s.length();    s = &quot; &quot; + s;    std::vector&lt;int&gt; cnt1(n + 1), cnt2(n + 1);    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);    fac[0] = inv[0] = 1ll;    for (int i = 1; i &lt;= n; ++i) &#123;        fac[i] = fac[i - 1] * i % mod;        cnt1[i] = cnt1[i - 1] + (s[i] == &#39;(&#39;);    &#125;    auto qkp = [](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[n] = qkp(fac[n], mod - 2);    cnt2[n] = (s[n] == &#39;)&#39;);    for (int i = n - 1; i; --i) &#123;        cnt2[i] = cnt2[i + 1] + (s[i] == &#39;)&#39;);        inv[i] = inv[i + 1] * (i + 1) % mod;    &#125;    long long res = 0ll;    auto C = [&amp;](int n, int m) &#123;        if (n &lt; m)            return 0ll;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    for (int i = 1; i &lt;= n; ++i)        if (s[i] == &#39;(&#39;)            (res += C(cnt1[i] + cnt2[i] - 1, cnt1[i])) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="cf1332e-height-all-the-same">CF1332E Height All the Same</h2><p><a href="https://codeforces.com/problemset/problem/1332/E" class="uri">https://codeforces.com/problemset/problem/1332/E</a></p><p>å®¹æ˜“å‘ç°ç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ç”¨æ¥æ”¹å˜ä¸¤ä¸ªæ•°å¥‡å¶æ€§çš„ï¼›è€Œç¬¬äºŒä¸ªæ“ä½œèƒ½åœ¨å…¨å›¾å¥‡å¶æ€§ç›¸åŒçš„ä»»ä½•æƒ…å†µä¸‹è¾¾æˆè¦æ±‚ã€‚</p><p>æ³¨æ„åˆ°å¦‚æœæˆ‘ä»¬æƒ³åŒæ—¶ä»…æ”¹å˜ä»»æ„ä¸¤ä¸ªæ•°çš„å¥‡å¶æ€§ï¼Œå¯ä»¥åœ¨æ£‹ç›˜ä¸Šä»»æ‰¾ä¸€æ¡è·¯å¾„ä¸€è·¯ä½¿ç”¨æ“ä½œä¸€ã€‚åªè¦æŸç§å¥‡å¶æ€§çš„å…ƒç´ ä¸ªæ•°å…±æœ‰å¶æ•°ä¸ªï¼Œå°±èƒ½é€šè¿‡è‹¥å¹²æ¬¡æ“ä½œä¸€æŠŠå®ƒä»¬å…¨éƒ¨å˜æˆå¦ä¸€ç§å¥‡å¶æ€§ã€‚</p><p>ä»¤ <span class="math inline">\(K_1\)</span> ä¸º <span class="math inline">\(L\sim R\)</span> ä¸­å¥‡æ•°çš„ä¸ªæ•°ï¼Œ<span class="math inline">\(K_2\)</span> ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[res=\sum_{i=0}^{nm} C_{nm}^i\times {K_1}^i\cdot {K_2}^{nm-i}\cdot [i\bmod 2=0]\]</span></p><p>æˆ‘ä»¬å‘ç°è¿™ä¸ªä¸œè¥¿å’ŒäºŒé¡¹å¼å®šç†ç®€ç›´åƒå¾—ä¸èƒ½å†åƒäº†ï¼ä½†å¤šäº†ä¸€ä¸ªç³»æ•°å¯¼è‡´æ²¡åŠæ³•çœç•¥æšä¸¾è¿‡ç¨‹ã€‚å¦‚æœè¿›è¡Œå˜å½¢å‘¢ï¼Ÿ</p><p><span class="math display">\[res=(K_1+K_2)^{nm}-\sum_{i=0}^{nm} C_{nm}^i\times {K_1}^i\cdot {K_2}^{nm-i}\cdot [i\bmod 2=1]\]</span></p><p>ä¼¼ä¹ä¾ç„¶æ²¡æœ‰å‡ºè·¯ï¼ä½†è¿™é‡Œæœ‰ä¸ªç¥å¥‡çš„æ“ä½œï¼š</p><p><span class="math display">\[res=(-K_1+K_2)^{nm}+\sum_{i=0}^{nm} C_{nm}^i\times {K_1}^i\cdot {K_2}^i\cdot [i\bmod 2=1]\]</span></p><p>äºŒå¼ç›¸åŠ å°±å¯ä»¥<mark>æ¶ˆå…ƒ</mark>ï¼Œå¾—åˆ° <span class="math inline">\(2\cdot res=(K_1+K_2)^{nm}+(K_1-K_2)^{nm}\)</span>ã€‚<mark>è¿™å¯ç¤ºæˆ‘ä»¬äºŒé¡¹å¼å®šç†ä¸­çš„ç¬¦å·å’Œå¥‡å¶æ€§çš„æ·±åˆ‡è”ç³»ã€‚</mark></p><details><p>å¦‚æœä½ ä½¿ç”¨è´¹é©¬å°å®šç†å¯¹æ¬¡æ•°è¿›è¡Œäº†å¤„ç†ï¼Œä½ å¯èƒ½éœ€è¦æ³¨æ„æ¬¡æ•°å¯èƒ½ä¸º <span class="math inline">\(\text{mod} -1\)</span> çš„å€æ•°ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;const int inv2 = 499122177;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    long long n, m, l, r, k1, k2;    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; l &gt;&gt; r, k1 = (r - l + 1) / 2, k2 = (r - l + 1) - k1;    auto qkp = [](long long x, long long y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    if (n * m % 2)        std::cout &lt;&lt; qkp(r - l + 1, n * m) &lt;&lt; &#39;\n&#39;;    else        std::cout &lt;&lt; (qkp(r - l + 1, n * m) + qkp((k1 + mod - k2) % mod, n * m)) % mod * inv2 % mod &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="a---äº¤é”™åºåˆ—">A - äº¤é”™åºåˆ—</h2><p><a href="https://www.luogu.com.cn/problem/P4456" class="uri">https://www.luogu.com.cn/problem/P4456</a></p><figure><img src="2.png" alt="å‡ºé¢˜äººç–‘ä¼¼éœ€è¦åŠ å¼ºæ•°å­¦åŠŸåº•ï¼ˆï¼Ÿï¼‰" /><figcaption>å‡ºé¢˜äººç–‘ä¼¼éœ€è¦åŠ å¼ºæ•°å­¦åŠŸåº•ï¼ˆï¼Ÿï¼‰</figcaption></figure><p>å®¹æ˜“æƒ³åˆ°æŠŠç­”æ¡ˆç”¨äºŒé¡¹å¼å®šç†æ‹†å¼€ï¼š</p><p><span class="math display">\[\begin{aligned}res&amp;=\sum_y f_y\cdot y^b\cdot (n-y)^a\\&amp;=\sum_y f_y\cdot y^b\cdot \sum_{i=0}^a C_a^i\cdot n^i\cdot(-y)^{a-i}\\&amp;=\sum_y\sum_{i=0}^a f_y\cdot C_a^i\cdot n^i\cdot(-1)^{a-i}\cdot y^{a+b-i}\\&amp;=\sum_{i=0}^a C_a^i\cdot n^i\cdot(-1)^{a-i}\cdot \sum_y f_y\cdot y^{a+b-i}\\\end{aligned}\]</span></p><p>ç„¶åå‘ç°åé¢é‚£ä¸ª sigma ä¸å¤ªæœ‰åŠæ³•æ±‚ã€‚ä¸€ä¸ªæ¯”è¾ƒä¼˜é›…çš„æ–¹æ³•æ˜¯æŠŠ <span class="math inline">\(y^{a+b-i}\)</span> ç›´æ¥ä½œä¸ºç³»æ•°è€Œéä¸‹æ ‡å¡åˆ° <span class="math inline">\(f\)</span> é‡Œå»ï¼Œå³ä»¤ <span class="math inline">\(f_{i}\)</span> è¡¨ç¤º <span class="math inline">\(\forall \,y\)</span>ï¼Œ<span class="math inline">\(\sum y^i\)</span> ä¹‹å’Œã€‚</p><p>å…·ä½“åœ°ï¼Œä»¤ <span class="math inline">\(dp_{n,i,0/1}\)</span> è¡¨ç¤ºå½“å‰ DP åˆ°ç¬¬ <span class="math inline">\(n\)</span> ä½ï¼Œè¦æ±‚å¹‚æ¬¡ä¸º <span class="math inline">\(i\)</span>ï¼Œæœ€åä¸€ä½ä¸º <span class="math inline">\(0/1\)</span> çš„ç­”æ¡ˆã€‚åˆ™æ˜¾ç„¶æœ‰ <span class="math inline">\(dp_{n,i,0}=dp_{n-1,i,0}+dp_{n-1,i,1}\)</span>ã€‚å¯¹äº <span class="math inline">\(dp_{n,i,1}\)</span>ï¼Œå› ä¸ºæ­¤æ—¶ <span class="math inline">\(\forall\, k,k\gets k+1\)</span>ï¼Œåˆ™ <span class="math inline">\((k+1)^i=\sum\limits_{j=0}^i C_i^j \cdot k^j\)</span> å³ <span class="math inline">\(dp_{n,i,1}=\sum\limits_{j=0}^i C_i^j\cdot dp_{n-1,j,0}\)</span>ã€‚å‘ç° <span class="math inline">\(i,j\)</span> çš„èŒƒå›´æ˜¯ <span class="math inline">\(90\)</span>ï¼Œå¾ˆææ€–çš„äº‹æƒ…æ˜¯è¿™æ˜¯å¯ä»¥çŸ©é˜µçš„ã€‚</p><details><p>å°±åƒæˆ‘ä»¬éƒ½çŸ¥é“çš„é‚£æ ·ï¼ŒçŸ©é˜µåœ¨åŠ å®Œä¹‹åå†å–æ¨¡å°±ä¼šå¿«å¾ˆå¤šâ€¦â€¦</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int mod;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, a, b;    std::cin &gt;&gt; n &gt;&gt; a &gt;&gt; b &gt;&gt; mod;    std::vector&lt;std::vector&lt;long long&gt; &gt; C(a + b + 1, std::vector&lt;long long&gt;(a + b + 1));    for (int i = 0; i &lt;= a + b; ++i) &#123;        C[i][0] = 1ll;        for (int j = 1; j &lt;= i; ++j)            C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % mod;    &#125;    struct mat &#123;        int n, m;        std::vector&lt;std::vector&lt;long long&gt; &gt; a;        mat(int n, int m, bool flag = 0): n(n), m(m), a(n, std::vector&lt;long long&gt; (m)) &#123;            if (flag)                for (int i = 0; i &lt; n; ++i)                    a[i][i] = 1ll;            return;        &#125;        mat operator* (const mat &amp;q) const &#123;            mat res(n, q.m);            for (int i = 0; i &lt; n; ++i)                for (int k = 0; k &lt; q.m; ++k) &#123;                    for (int j = 0; j &lt; m; ++j)                        res.a[i][k] += a[i][j] * q.a[j][k];                    res.a[i][k] %= mod;                &#125;            return res;        &#125;        mat operator^ (int q) const &#123;            mat res(n, n, 1), x(*this);            for (; q; x = x * x, q &gt;&gt;= 1)                if (q &amp; 1)                    res = res * x;            return res;        &#125;    &#125; f(1, 2 * (a + b + 1)), op(2 * (a + b + 1), 2 * (a + b + 1));    auto fun = [&amp;](int i, int j) &#123;        return i + j * (a + b + 1);    &#125;;    f.a[0][fun(0, 0)] = 1ll;    for (int i = 0; i &lt;= a + b; ++i)        op.a[fun(i, 0)][fun(i, 0)] = op.a[fun(i, 1)][fun(i, 0)] = 1ll;    for (int i = 0; i &lt;= a + b; ++i)        for (int j = 0; j &lt;= i; ++j)            op.a[fun(j, 0)][fun(i, 1)] = C[i][j];    f = f * (op ^ n);    // for (int i = 0; i &lt;= n; ++i) &#123;    //     if (i)    //         f = f * op;    //     for (int j = 0; j &lt;= a + b; ++j)    //         printf(&quot;f[%d][%d] = %lld / %lld\n&quot;, i, j, f.a[0][fun(j, 0)], f.a[0][fun(j, 1)]);    // &#125;    auto res = 0ll;    for (int i = 0; i &lt;= a; ++i) &#123;        static auto p(1ll), k((a % 2) ? mod - 1ll : 1ll);        (res += C[a][i] * p % mod * k % mod * (f.a[0][fun(a + b - i, 0)] + f.a[0][fun(a + b - i, 1)]) % mod) %= mod;        (p *= n) %= mod, k = mod - k;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---different-subsets-for-all-tuples">B - Different Subsets For All Tuples</h2><p><a href="https://www.luogu.com.cn/problem/CF660E" class="uri">https://www.luogu.com.cn/problem/CF660E</a></p><p>é¦–å…ˆä½ å¯èƒ½éœ€è¦çŸ¥é“ï¼Œå¦‚æœå·²çŸ¥ä¸€ä¸ªåºåˆ—ï¼Œå¦‚ä½•å¾—åˆ°ç­”æ¡ˆï¼Ÿ</p><p>ä»¤ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(i\)</span> å¤„å–ä¸€ä¸ªå­åºåˆ—çš„æœ«å°¾ï¼Œæšä¸¾ä¸Šä¸€ä¸ªå…ƒç´  <span class="math inline">\(x\)</span>ï¼Œæ‰¾åˆ° <span class="math inline">\(i\)</span> ä¹‹å‰æœ€é åçš„ä¸€ä¸ª <span class="math inline">\(a_j=x\)</span>ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_i=\sum f_j\)</span>ï¼Œæ¢è¨€ä¹‹éœ€è¦ä¿è¯ <span class="math inline">\((j,i)\)</span> èŒƒå›´å†…æ²¡æœ‰ <span class="math inline">\(x\)</span> å‡ºç°ã€‚</p><p>æ­¤æ—¶åºåˆ—æœªçŸ¥ï¼Œä»¤ <span class="math inline">\(f_{i, x}\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(i\)</span> å¤„å–ä¸€ä¸ªå­åºåˆ—æœ«å°¾ï¼Œä¸” <span class="math inline">\(i\)</span> çš„å€¼ä¸º <span class="math inline">\(x\)</span>ï¼›æŒ‰ç…§è´¡çŒ®çš„è§†è§’æ¥çœ‹å¾…ï¼Œæ¯ä¸ªå¯ä»¥å’Œ <span class="math inline">\(i\)</span> ç»„æˆæ–°å­åºåˆ—çš„æ–¹æ¡ˆå¯ä»¥å¸¦æ¥ <span class="math inline">\(m^{i-1}\)</span> çš„è´¡çŒ®ï¼ˆå› ä¸º <span class="math inline">\(a_i\)</span> å·²ç»å›ºå®šä¸º <span class="math inline">\(x\)</span>ï¼Œå…¶ä»–ä½ç½®å¯ä»¥ä»»é€‰ï¼‰ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_{i,x}=m^i\times \sum_{j&lt;i,y}f_{j,y}\times (m-1)^{i-j-1}\)</span>ã€‚</p><p>ç„¶åå°±æƒŠè®¶åœ°å‘ç°å¼å­å’Œ <span class="math inline">\(x\)</span> è¿™ä¸€ç»´æ²¡æœ‰å…³ç³»äº†ã€‚æ‰€ä»¥ç›´æ¥å¸¦ä¸Šç³»æ•°å¾—åˆ°ï¼š</p><p><span class="math display">\[\begin{aligned}f_i&amp;=m^i\times \sum_{j&lt;i} f_j\times (m-1)^{i-j-1}\times m\\&amp;=m^i\times (m-1)^{i-1}\times m\cdot \sum_{j&lt;i} f_j\times (m-1)^{-j}\end{aligned}\]</span></p><p>å‰ç¼€å’Œä¼˜åŒ–ä¸€ä¸‹å°±å¯ä»¥å¿«é€Ÿæ±‚äº†ã€‚æœ€ç»ˆçš„ç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(res=m^n+\sum f_i\times (m-1)^{n-i}\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    if (m == 1)        std::cout &lt;&lt; (n + 1) &lt;&lt; &#39;\n&#39;;    else &#123;        std::vector&lt;long long&gt; f(n + 1), s(n + 1), pm1(n + 1);        pm1[0] = 1ll;        for (int i = 1; i &lt;= n; ++i)            pm1[i] = pm1[i - 1] * (m - 1) % mod;        auto qkp = [](long long x, int y) &#123;            auto res(1ll);            for (; y; (x *= x) %= mod, y &gt;&gt;= 1)                if (y &amp; 1)                    (res *= x) %= mod;            return res;        &#125;;        auto res(qkp(m, n));        const auto invm = qkp(m - 1, mod - 2);        for (int i = 1; i &lt;= n; ++i) &#123;            static long long p(m), inv(invm);            f[i] = (p + pm1[i - 1] * m % mod * s[i - 1] % mod) % mod;            s[i] = (s[i - 1] + f[i] * inv % mod) % mod;            (res += f[i] * pm1[n - i] % mod) %= mod;            (p *= m) %= mod, (inv *= invm) %= mod;        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;     &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="g---gardens">G - Gardens</h2><p><a href="https://atcoder.jp/contests/abc235/tasks/abc235_g" class="uri">https://atcoder.jp/contests/abc235/tasks/abc235_g</a></p><p>å¦‚æœæ²¡æœ‰ã€æ¯ä¸ªäººå¿…é¡»æœ‰ä¸€ä¸ªå…ƒç´ ã€è¿™ä¸ªé™åˆ¶ï¼Œå°±å¯ä»¥éšä¾¿åšäº†ã€‚ç°åœ¨åŠ ä¸Šäº†è¿™ä¸ªé™åˆ¶ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨æ²¡å¾—åˆ°çš„äººæ¥å®¹æ–¥ã€‚é’¦å®šè‡³å°‘æœ‰ <span class="math inline">\(i\)</span> ä¸ªäººæ²¡æ‹¿åˆ°ï¼Œå¾—åˆ°ç­”æ¡ˆä¸º <span class="math inline">\(\sum\limits_{i=0}^n (-1)^i\cdot C_n^i\cdot \left(\sum\limits_{j=0}^a C_i^j\right)\cdot \left(\sum\limits_{j=0}^b C_i^j\right)\cdot \left(\sum\limits_{j=0}^c C_i^j\right)\)</span>ã€‚</p><p>æ€ä¹ˆç®— <span class="math inline">\(\sum\limits_{j=0}^a C_i^j\)</span> å‘¢ï¼Ÿå½“ <span class="math inline">\(a&gt; i\)</span> æ—¶ï¼ŒäºŒé¡¹å¼æ˜¯å¥½æ±‚çš„ï¼›å½“ <span class="math inline">\(a\le i\)</span> æ—¶å‘¢ï¼Ÿçœ‹åˆ°è¿™ä¸ªå¼å­å¾ˆå®¹æ˜“å¸¦åˆ°æ¨è¾‰ä¸‰è§’é‡Œå»ï¼Œä¹Ÿå°±æ˜¯æ±‚ä¸€è¡Œçš„å‰ <span class="math inline">\(a\)</span> ä¸ªæ•°ã€‚æ³¨æ„åˆ°å¯ä»¥ç”¨ä¸Šä¸€è¡Œçš„å‰ <span class="math inline">\(a\)</span> ä¸ªæ•° <span class="math inline">\(O(1)\)</span> å¾—åˆ°ï¼ˆå‡è®¾ç¬¬ <span class="math inline">\(j-1\)</span> è¡Œå‰ <span class="math inline">\(a\)</span> ä¸ªæ•°ä¹‹å’Œä¸º <span class="math inline">\(f_a(j-1)\)</span>ï¼‰ï¼š<span class="math inline">\(f_a(j)=f_a(j-1)\times 2-C_{j-1,a}\)</span>ã€‚<mark>ä½ éœ€è¦æ„è¯†åˆ°ï¼Œç”±äºä¸Šä¸€è¡Œä¹Ÿæ˜¯ç­”æ¡ˆä¸­è¦æ±‚çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨é€’æ¨è§£å†³é—®é¢˜ã€‚<strong>åœ¨ç»„åˆè®¡æ•°ä¸­ï¼Œé€’æ¨ / DP æ— è®ºæ˜¯åœ¨åŒ–ç®€å¼å­è¿˜æ˜¯æ±‚å®¹æ–¥ / äºŒé¡¹å¼åæ¼”é‡Œå…·ä½“æŸä¸€é™åˆ¶ä¸‹çš„æ–¹æ¡ˆæ•°éƒ½æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œåœ¨éœ€è¦ä¼˜åŒ–å¤æ‚åº¦æ—¶ï¼Œå¯ä»¥ä»é€’æ¨ / DPã€æ’ç­‰å¼ã€å‰ç¼€å’Œã€é¢„å¤„ç†ç­‰æ–¹æ³•å…¥æ‰‹è€ƒè™‘</strong></mark>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, a, b, c;    std::cin &gt;&gt; n &gt;&gt; a &gt;&gt; b &gt;&gt; c;    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1), fa(n + 1), fb(n + 1), fc(n + 1), pow2(n + 1);    fac[0] = inv[0] = pow2[0] = 1ll;    for (int i = 1; i &lt;= n; ++i) &#123;        fac[i] = fac[i - 1] * i % mod;        pow2[i] = pow2[i - 1] * 2 % mod;    &#125;    auto qkp = [&amp;](long long x, int y) &#123;        auto res(1ll);        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[n] = qkp(fac[n], mod - 2);    for (int i = n - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    for (int i = 0; i &lt;= a; ++i)        (fa[a] += C(a, i)) %= mod;    for (int i = a + 1; i &lt;= n; ++i)        fa[i] = (2 * fa[i - 1] % mod + mod - C(i - 1, a)) % mod;    for (int i = 0; i &lt;= b; ++i)        (fb[b] += C(b, i)) %= mod;    for (int i = b + 1; i &lt;= n; ++i)        fb[i] = (2 * fb[i - 1] % mod + mod - C(i - 1, b)) % mod;    for (int i = 0; i &lt;= c; ++i)        (fc[c] += C(c, i)) %= mod;    for (int i = c + 1; i &lt;= n; ++i)        fc[i] = (2 * fc[i - 1] % mod + mod - C(i - 1, c)) % mod;    auto res(0ll);    for (int i = n, p = 1; ~i; --i, p = mod - p)        (res += p * C(n, i) % mod * (i &gt;= a ? fa[i] : pow2[i]) % mod * (i &gt;= b ? fb[i] : pow2[i]) % mod * (i &gt;= c ? fc[i] : pow2[i]) % mod) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ’åˆ—ç»„åˆ </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> äºŒé¡¹å¼å®šç† </tag>
            
            <tag> äºŒé¡¹å¼åæ¼” </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜é€‰è°ˆ</title>
      <link href="/20250404/"/>
      <url>/20250404/</url>
      
        <content type="html"><![CDATA[<p>NOI Linux 2.0ï¼Œæ‹¼å°½å…¨åŠ›æ— æ³•æˆ˜èƒœã€‚</p><span id="more"></span><p>æ¯”æ–¹è¯´æˆ‘è¯•å›¾å¯¹æˆ‘ä¸€ç‰‡ç‹¼è—‰çš„å±å¹•è¿›è¡Œä¸€ä¸ªå›¾çš„æˆªï¼Œä½†æ˜¯æˆ‘å¹¶ä¸çŸ¥é“ where the so-called <code>$PICTURE</code> is <img src="/em/kt.gif" /></p><hr /><p>è¿™åœºæœ‰ä¸¤ä¸ªé¢˜éƒ½ç”¨åˆ°äº† <mark>ä¼˜å…ˆé˜Ÿåˆ—</mark> + <mark>æœ€ä¼˜ç­”æ¡ˆæ‰©å±•</mark> çš„æ€è·¯ï¼Œå¯ä»¥è®°å½•ä¸€ä¸‹ã€‚</p><hr /><h2 id="a.-åºåˆ—åŠ æ³•æœº">A. åºåˆ—åŠ æ³•æœº</h2><p><a href="http://222.180.160.110:61235/contest/6174/problem/1" class="uri">http://222.180.160.110:61235/contest/6174/problem/1</a></p><p>è½¬åŒ–é¢˜æ„å¯ä»¥å‘ç°ï¼Œä¸‰ä¸ªä¸ä¸‹é™çš„é™åˆ¶æ‹¼èµ·æ¥å…¶å®å°±æ˜¯æ²¡æœ‰é™åˆ¶ã€‚è‹¥ä»¤ <span class="math inline">\(c_i=|a_i-b_i|\)</span>ï¼Œåˆ™é¢˜æ„è½¬åŒ–å¦‚ä¸‹ï¼š</p><blockquote><p>ç»™å®š <span class="math inline">\(c_{1\sim n}\)</span>ï¼Œå®šä¹‰ä¸€æ¬¡æ“ä½œä¸ºï¼š</p><ul><li>é€‰æ‹©ä¸€ä¸ª <span class="math inline">\(x&gt;0\)</span>ï¼Œå†é€‰æ‹© <span class="math inline">\(c_i\ge x\)</span>ï¼Œä»¤ <span class="math inline">\(c_i\gets c_i-x\)</span>ï¼Œå¹¶èŠ±è´¹ <span class="math inline">\(x^2\)</span> çš„ä»£ä»·ã€‚</li></ul><p>ç°å¯è¿›è¡Œä¸è¶…è¿‡ <span class="math inline">\(m\)</span> æ¬¡æ“ä½œï¼Œé—®å°† <span class="math inline">\(c_i\)</span> å…¨éƒ¨ç½®ä¸º <span class="math inline">\(0\)</span> çš„æœ€å°ä»£ä»·ã€‚</p></blockquote><p>æœ‰ä¸€ä¸ªæ¯”è¾ƒæ˜¾ç„¶çš„äº‹æƒ…ï¼Œå¦‚æœç»™ <span class="math inline">\(c_i\)</span> åˆ†é… <span class="math inline">\(k\)</span> æ¬¡æ“ä½œæœºä¼šï¼Œé‚£ä¹ˆæ¯æ¬¡å‡å» <span class="math inline">\(\dfrac {c_i}k\)</span> æ˜¯æœ€ä¼˜çš„ã€‚å…·ä½“åœ°ï¼Œä»¤ <span class="math inline">\(p=\left\lfloor\dfrac {c_i}k\right\rfloor\)</span>ï¼Œé‚£ä¹ˆç»™ <span class="math inline">\(k\)</span> ä¸ªä¸­çš„ <span class="math inline">\(c_i\bmod k\)</span> åˆ†é… <span class="math inline">\(p+1\)</span>ï¼Œç»™å‰©ä½™çš„ <span class="math inline">\(k-c_i\bmod k\)</span> åˆ†é… <span class="math inline">\(p\)</span> å³å¯ã€‚è¿™ä¸ªéšä¾¿ç”¨åè¯ä»€ä¹ˆçš„è¯ä¸€ä¸‹å³å¯ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆçŸ¥é“åº”è¯¥ç»™æ¯ä¸ª <span class="math inline">\(c_i\)</span> åˆ†é…å¤šå°‘æ¬¡æ“ä½œæ¬¡æ•°å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸ª trickï¼šåˆå§‹å…ˆç»™æ¯ä¸ª <span class="math inline">\(c_i\)</span> åˆ†é…ä¸€æ¬¡æ¬¡æ•°ï¼Œ<mark>å¯¹äºæ¯ä¸ª <span class="math inline">\(c_i\)</span>ï¼Œè®°å½•ç»™å…¶å¤šåˆ†é…ä¸€æ¬¡åèƒ½å‡å°‘çš„ä»£ä»·ï¼Œå…¨éƒ¨ä¸¢è¿›ä¼˜å…ˆé˜Ÿåˆ—é‡Œï¼Œå°†æœ€ä¼˜çš„æ‹¿å‡ºæ¥ä¹‹åï¼Œè®°å½•å†ç»™å…¶å¤šåˆ†é…ä¸€æ¬¡åèƒ½å‡å°‘çš„ä»£ä»·ï¼Œå†ä¸¢è¿›å»</mark>ã€‚èƒ½è¿™æ ·åšçš„æ ¹æœ¬åŸå› åœ¨äºï¼š</p><ol type="1"><li>æ¯ä¸ªå…ƒç´ çš„æ¯ä¸€æ¬¡æ‰©å±•ä»£ä»·ç›¸åŒã€‚</li><li>å¯¹äºåŒä¸€ä¸ªå…ƒç´ ï¼Œä¸¢åˆ°ä¼˜å…ˆé˜Ÿåˆ—é‡Œçš„å€¼æ˜¯é€’å‡çš„ï¼ˆå³æ— åæ•ˆæ€§ï¼Œå¯ä»¥è´ªå¿ƒï¼‰ã€‚</li></ol><details><p>æœ‰äººå¯¹ç€å¯¹çš„ä»£ç è°ƒäº†åŠä¸ªå°æ—¶ï¼Œæ˜¯è°å‘¢ <img src="/em/kt.gif" /></p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    std::freopen(&quot;seq.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;seq.out&quot;, &quot;w&quot;, stdout);#else    std::freopen(&quot;ex_seq2.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;long long&gt; c(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; c[i];    struct _ &#123;        int k;        long long org, d;        bool operator&lt; (const _ &amp;q) const &#123;            return d &lt; q.d;         &#125;    &#125;;    std::priority_queue&lt;_&gt; q;    long long res = 0ll;    auto calc = [&amp;](long long x, int k) &#123;        auto p = x / k;        return (x % k) * (p + 1) * (p + 1) + (k - x % k) * p * p;    &#125;;    for (int i = 1, x; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; x;        c[i] = std::abs(c[i] - x);        if (c[i]) &#123;            (res += calc(c[i], 1) % mod) %= mod;            q.push(&#123; 2, c[i], calc(c[i], 1) - calc(c[i], 2) &#125;);        &#125;    &#125;    // printf(&quot;res = %lld\n&quot;, res);    if ((int)q.size() &gt; m)        std::cout &lt;&lt; -1 &lt;&lt; &#39;\n&#39;;    else &#123;        m -= (int)q.size();        for (; m--; ) &#123;            auto [k, org, d] = q.top();            q.pop();            // printf(&quot;org = %lld, k = %d, d = %lld\n&quot;, org, k, d);            (res += mod - d % mod) %= mod;            q.push(&#123; k + 1, org, calc(org, k) - calc(org, k + 1) &#125;);        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="b.-æ‘¸é±¼å†›è®­">B. æ‘¸é±¼å†›è®­</h2><p><a href="http://222.180.160.110:61235/contest/6174/problem/2" class="uri">http://222.180.160.110:61235/contest/6174/problem/2</a></p><blockquote><p>å®šä¹‰ä¸€æ¬¡å†’æ³¡æ’åºä¸ºï¼š</p><pre class="cpp"><code>for (int i = 1; i &lt; n; ++i)    if (a[i] &gt; a[i + 1])        std::swap(a[i], a[i + 1]);</code></pre><p>ç°ç»™å®šä¸€ä¸ªæ’åˆ—å’Œ <span class="math inline">\(m\)</span> æ¬¡è¯¢é—®ï¼Œé—®ç¬¬ <span class="math inline">\(k\)</span> è½®å†’æ³¡æ’åºåå…ƒç´  <span class="math inline">\(x\)</span> çš„ä½ç½®ã€‚</p></blockquote><p>å‘ç°ä¸€ä¸ªå…ƒç´ ç§»åŠ¨çš„åŸå› æœ‰ä¸¤ç§ï¼š</p><ol type="1"><li>å‰é¢æœ‰ä¸ªæ¯”å®ƒå¤§çš„å…ƒç´ ã€Œå†’æ³¡ã€åˆ°å®ƒåé¢å»äº†ï¼Œæœ¬è½®è¯¥å…ƒç´ å‘å‰ç§»åŠ¨æ°å¥½ä¸€æ­¥ã€‚</li><li>å‰é¢æ²¡æœ‰æ¯”å®ƒæ›´å¤§çš„å…ƒç´ ï¼Œè½®åˆ°å®ƒæ¥å‘åé¢ã€Œå†’æ³¡ã€äº†ã€‚æ‰¾åˆ°å…·ä½“çš„ä½ç½®æ˜¯ä¸å®¹æ˜“çš„ï¼Œä½†æˆ‘ä»¬å‘ç°æ¯æ¬¡ <span class="math inline">\(i\)</span> å‘å³ç§»åŠ¨ä¸€æ­¥ï¼Œéƒ½ä¸€å®šä¼šæœ‰ä¸€ä¸ªæ¯” <span class="math inline">\(i\)</span> æ›´å°çš„å…ƒç´ è¢«å®ƒäº¤æ¢åˆ° <span class="math inline">\(i\)</span> å·¦è¾¹ã€‚æ‰¾åˆ°æœ‰å¤šå°‘ä¸ªåœ¨ <span class="math inline">\(i\)</span> å³è¾¹ä¸”æ¯” <span class="math inline">\(i\)</span> å°çš„å…ƒç´ åˆ°äº† <span class="math inline">\(i\)</span> å·¦è¾¹å°±å¯ä»¥å¾—åˆ°è¿™ä¸€ç§æƒ…å†µä¸‹ <span class="math inline">\(i\)</span> çš„ä½ç½®ã€‚</li></ol><p>å®¹æ˜“å‘ç°ï¼Œåªè¦å‰é¢å­˜åœ¨æ¯”å®ƒå¤§çš„å…ƒç´ ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¡å§‹ç»ˆæˆç«‹ã€‚æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡ <span class="math inline">\(f_i\)</span> ä¸ºå…ƒç´  <span class="math inline">\(i\)</span> å‰æ¯”å®ƒå¤§çš„å…ƒç´ ä¸ªæ•°ï¼Œå¯¹äºè¯¢é—® <span class="math inline">\((k,i)\)</span>ï¼Œè‹¥ <span class="math inline">\(k\le f_i\)</span>ï¼Œé‚£ä¹ˆç­”æ¡ˆå³ä¸º <span class="math inline">\(pos_i-k\)</span>ã€‚</p><p>ç¬¬ <span class="math inline">\(f_i+1\)</span> è½®ï¼Œ<span class="math inline">\(i\)</span> å‘åã€Œå†’æ³¡ã€ï¼Œç¢°åˆ°ä¸€ä¸ªæ¯”å®ƒæ›´å¤§çš„å…ƒç´  <span class="math inline">\(j\)</span> å³åœæ­¢ï¼Œæ­¤æ—¶ <span class="math inline">\(j\)</span> æ¥æ›¿ <span class="math inline">\(i\)</span> å‘åã€Œå†’æ³¡ã€ï¼Œç›´åˆ°ç¢°åˆ°ä¸€ä¸ª <span class="math inline">\(j&#39;&gt;j\)</span> ä¸ºæ­¢ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>å¦‚ä½•å°† <span class="math inline">\(k\)</span> è½®å <span class="math inline">\(i\)</span> åœä¸‹çš„ä½ç½®å¯¹åº”åˆ°åŸæ•°ç»„ä¸Šå‘¢ï¼Ÿæˆ‘ä»¬å‘ç°æ¯ä¸€è½® <span class="math inline">\(i\)</span> è·¨è¶Šçš„å…ƒç´ ä¸€å®šæ˜¯æ¯” <span class="math inline">\(i\)</span> å°çš„å¯ç©ºæé•¿æ®µï¼Œæ‰‹ç©å¯ä»¥å‘ç°æ®µçš„æ•°é‡ä¸ä¼šå› ä¸º <span class="math inline">\(i\)</span> ä¹‹åä»»ä½•å…ƒç´ çš„ç§»åŠ¨è€Œæ”¹å˜ï¼Œæ•…æ‰¾åˆ° <span class="math inline">\(i\)</span> åç¬¬ <span class="math inline">\(k\)</span> ä¸ªæ¯” <span class="math inline">\(i\)</span> å¤§çš„å…ƒç´ ï¼Œä¸­é—´æ¯” <span class="math inline">\(i\)</span> å°çš„å…ƒç´ ä¸ªæ•°å°±æ˜¯ <span class="math inline">\(i\)</span> çš„å³ç§»æ­¥æ•°ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    std::freopen(&quot;bubble.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;bubble.out&quot;, &quot;w&quot;, stdout);    int n, m;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1), bit(n + 1), p(n + 1), f(n + 1), bit1(n + 1);    auto lowbit = [&amp;](int x) &#123;        return x &amp; -x;    &#125;;    auto add = [&amp;](std::vector&lt;int&gt; &amp;bit, int x, int v) &#123;        for (; x &lt;= n; x += lowbit(x))            bit[x] += v;        return;    &#125;;    auto qry = [&amp;](std::vector&lt;int&gt; &amp;bit, int x) &#123;        int res = 0;        for (; x; x -= lowbit(x))            res += bit[x];        return res;    &#125;;    auto ask = [&amp;](std::vector&lt;int&gt; &amp;bit, int l, int r) &#123;        if (l &gt; n || r &lt; 1)            return 0;        return qry(bit, r) - qry(bit, l - 1);    &#125;;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i], p[a[i]] = i;        f[a[i]] = ask(bit, a[i] + 1, n), add(bit, a[i], 1);    &#125;    struct _ &#123; int k, id; &#125;;    std::vector&lt;std::vector&lt;_&gt; &gt; t(n + 1);    std::cin &gt;&gt; m;    std::vector&lt;int&gt; res(m + 1);    for (int i = 1, x, k; i &lt;= m; ++i) &#123;        std::cin &gt;&gt; k &gt;&gt; x;        t[x].push_back(&#123; k, i &#125;);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        add(bit, p[i], -1);        for (auto [k, id] : t[i])            if (k &lt;= f[i])                res[id] = p[i] - k;            else &#123;                int now = n;                for (int l = p[i] + 1, r = n, mid; l &lt;= r; ) &#123;                    mid = (l + r) &gt;&gt; 1;                    if (ask(bit, p[i] + 1, mid) &gt;= k - f[i])                        r = mid - 1, now = mid;                    else                        l = mid + 1;                &#125;                // printf(&quot;%d: now = %d\n&quot;, i, now);                res[id] = p[i] - f[i] + ask(bit1, p[i] + 1, now);            &#125;        add(bit1, p[i], 1);    &#125;    for (int i = 1; i &lt;= m; ++i)        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c0.-è¶…çº§é’¢ç´">C0. è¶…çº§é’¢ç´</h2><p><a href="https://www.luogu.com.cn/problem/P2048" class="uri">https://www.luogu.com.cn/problem/P2048</a></p><p>é¦–å…ˆåšå‰ç¼€å’Œï¼Œå®¹æ˜“æƒ³åˆ°æšä¸¾å³ç«¯ç‚¹ï¼Œé‚£ä¹ˆå·¦ç«¯ç‚¹å°±æ˜¯ä¸€æ®µè¿ç»­çš„åŒºé—´ã€‚æ˜¾ç„¶åœ¨è¿™é‡Œæœ€ä¼˜é€‰æ‹©æ˜¯é€‰æ‹©å·¦ç«¯ç‚¹ä¸­ <span class="math inline">\(s\)</span> æœ€å°çš„ä¸€ä¸ªã€‚</p><p>æ€ä¹ˆæ±‚å‰ <span class="math inline">\(k\)</span> å¤§å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå›ºå®šçš„ trickï¼šæŠŠæ¯ä¸ªå³ç«¯ç‚¹åŠå…¶å¯¹åº”çš„å·¦ç«¯ç‚¹åŒºé—´ä¸¢åˆ°ä¼˜å…ˆé˜Ÿåˆ—é‡Œï¼ŒæŒ‰ç…§æœ€ä¼˜è§£ï¼ˆç”¨ ST è¡¨æ‰¾ä¸€ä¸‹å³å¯ï¼‰ä»ä¼˜åˆ°åŠ£æ’åºã€‚</p><p><mark>æ¯æ¬¡å–å‡ºæœ€ä¼˜è§£ <span class="math inline">\([l_1, l_2], r\)</span>ï¼Œå‡è®¾æœ€ä¼˜å†³ç­–ä¸º <span class="math inline">\(x\in [l_1, l_2]\)</span>ï¼Œé‚£ä¹ˆæŠŠ <span class="math inline">\([l_1, x), r\)</span> å’Œ <span class="math inline">\((x, l_2], r\)</span> åˆ†åˆ«ä¸¢åˆ°ä¼˜å…ˆé˜Ÿåˆ—é‡Œå»</mark>ã€‚è¿™ä¸ªåšæ³•æˆç«‹çš„æ ¹æœ¬åŸå› ä¹Ÿæ˜¯ï¼š</p><ol type="1"><li>ä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½å¯ä»¥è´¡çŒ®ä¸€æ¬¡ç­”æ¡ˆã€‚</li><li>å¯¹äºåŒä¸€ä¸ª <span class="math inline">\(r\)</span>ï¼Œéšç€æ‹†åˆ†æ¬¡æ•°çš„å¢åŠ ï¼Œæœ€ä¼˜è§£é€æ¸å˜åŠ£ï¼ˆæ— åæ•ˆæ€§ï¼Œå¯è´ªå¿ƒï¼‰ã€‚</li></ol><details><pre class="cpp language-cpp" data-line="17"><code class="cpp langauage-cpp">#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(".in", "r", stdin);    std::freopen(".out", "w", stdout);#endif    int n, k, l, r;    std::cin >> n >> k >> l >> r;    std::vector&lt;long long> a(n + 1);    std::vector&lt;std::vector&lt;long long> > st(21, std::vector&lt;long long> (n + 1));    for (int i = 1; i <= n; ++i)        std::cin >> a[i], st[0][i] = i;    std::partial_sum(a.begin() + 1, a.end(), a.begin() + 1);    for (int j = 1; (1 << j) <= n + 1; ++j) // ä¸€ä¸ªä¼˜ç§€çš„ç¬‘è¯æ˜¯ï¼Œä½ çš„ ST è¡¨éœ€è¦ä» 0 å¼€å§‹ã€‚è€Œé•¿åº¦è‡ªç„¶ä¹Ÿåº”è¯¥ä¸º n + 1ã€‚        for (int i = 0; i + (1 << j) - 1 <= n; ++i)            st[j][i] = (a[st[j - 1][i]] <= a[st[j - 1][i + (1 << (j - 1))]] ? st[j - 1][i] : st[j - 1][i + (1 << (j - 1))]);    auto ask = [&](int l, int r) &#123;        int k = std::__lg(r - l + 1);        return a[st[k][l]] <= a[st[k][r - (1 << k) + 1]] ? st[k][l] : st[k][r - (1 << k) + 1];    &#125;;    struct _ &#123;        int l1, l2, r, x;        long long v;        bool operator< (const _ &q) const &#123;            return v < q.v;        &#125;    &#125;;    std::priority_queue<_> q;    for (int i = l; i <= n; ++i) &#123;        _ t;        t.l1 = std::max(i - r, 0), t.l2 = i - l, t.r = i, t.x = ask(t.l1, t.l2), t.v = a[i] - a[t.x];        q.push(t);    &#125;    long long res = 0ll;    for (int to; k--; ) &#123;        auto [l1, l2, r, x, v] = q.top();        q.pop();        res += v;        if (x != l1) &#123;            to = ask(l1, x - 1);            q.push(&#123; l1, x - 1, r, to, a[r] - a[to] &#125;);        &#125;        if (x != l2) &#123;            to = ask(x + 1, l2);            q.push(&#123; x + 1, l2, r, to, a[r] - a[to] &#125;);        &#125;    &#125;    std::cout << res << '\n';    return 0;&#125;</code></pre></details><hr /><h2 id="c1.-çš®å¡ä¸˜">C1. çš®å¡ä¸˜</h2><p><a href="http://222.180.160.110:61235/contest/6174/problem/3" class="uri">http://222.180.160.110:61235/contest/6174/problem/3</a></p><blockquote><p>ç»™å®š <span class="math inline">\(a_{1\sim n}\)</span> å’Œ <span class="math inline">\(m\)</span> ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡é—® <span class="math inline">\([l, r]\)</span> ä¸­å‰ <span class="math inline">\(k\)</span> å¤§ <span class="math inline">\(a_l-a_r\)</span> çš„å’Œã€‚<span class="math inline">\(\sum k\le 3\times 10^5\)</span>ã€‚</p></blockquote><p>æˆ‘ä»¬å‘ç°ä¸èƒ½ç›´æ¥æŒ‰ç…§ä¸Šä¸€é¢˜çš„æ–¹æ³•æ¥åšâ€”â€”æ¯æ¬¡è¯¢é—®éƒ½æŠŠ <span class="math inline">\(len\)</span> ä¸ªå…ƒç´ ä¸¢è¿›ä¼˜å…ˆé˜Ÿåˆ—æ˜¯ä¸ç°å®çš„ã€‚ä½†æˆ‘ä»¬ä¼¼ä¹å¿½ç•¥äº†ä»€ä¹ˆâ€”â€”è¿™æ¬¡çš„åˆå§‹æœ€ä¼˜è§£æ˜¯å¦å¯ä»¥ç›´æ¥åœ¨ <span class="math inline">\([l,r]\)</span> ä¸Šå…¨å±€æ±‚è§£ï¼Ÿ</p><p>åŒºé—´ä¿®æ”¹æ“ä½œå°±æ˜¯åœ¨æ˜ç¤ºçº¿æ®µæ ‘ã€‚æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥å·®åˆ†è¿‡åçº¿æ®µæ ‘ä¸Šæ±‚è§£æœ€å¤§å­æ®µå’Œâ€”â€”ä¸å·®åˆ†ä¹Ÿå¯ä»¥ç…§æ ·ç»´æŠ¤ç­”æ¡ˆï¼Œæ–¹æ³•å·®ä¸å¤šã€‚å‡è®¾ç°åœ¨æ±‚å¾—çš„æœ€ä¼˜è§£ä¸º <span class="math inline">\((x, y)\)</span>ã€‚</p><p>ä½†æ­¤æ—¶æˆ‘ä»¬æ²¡æœ‰ä¸€ä¸ªç«¯ç‚¹æ˜¯å›ºå®šçš„ï¼åº”è¯¥æ€æ ·æ‹†åˆ†å‘¢ï¼Ÿè¿™é‡Œåˆè¦ç”¨åˆ°å¦ä¸€ä¸ªç»å…¸çš„ trickâ€”â€”æŠ½è±¡ä¸€ä¸ªçŸ©é˜µ <span class="math inline">\(b_{i,j}=a_i-a_j\)</span>ï¼Œé‚£ä¹ˆå¯¹äºä¸€æ¬¡è¯¢é—®ï¼Œå¯ç”¨çš„ <span class="math inline">\(b\)</span> æ„æˆä¸€ä¸ªä¸‰è§’å½¢ï¼š</p><p><img src="1.png" /></p><p>è¿™é‡Œéœ€è¦æ³¨æ„ä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥å¯ä»¥é€šè¿‡æœ€å¤§å­æ®µå’Œæ±‚å¾—æœ€ä¼˜è§£æ˜¯å› ä¸ºçŸ©é˜µçš„è¡Œå·èŒƒå›´å’Œåˆ—å·èŒƒå›´æ˜¯ä¸€è‡´çš„ï¼ˆè®°ä¸ºæƒ…å†µ 1ï¼‰ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œé™¤äº†è¡Œå·å’Œåˆ—å·å®Œå…¨ç›¸ç¦»ï¼ˆå³ <span class="math inline">\(l_2&lt;r_1\)</span>ï¼Œè®°ä¸ºæƒ…å†µ 2ï¼‰ æ—¶å¯ä»¥ç›´æ¥ç”¨ <span class="math inline">\(l_{\max}-r_{\min}\)</span> æ±‚è§£ï¼Œå…¶ä»–æƒ…å†µéƒ½æ— æ³•ç®€å•å¾—åˆ°ç­”æ¡ˆã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬çš„æ‹†åˆ†æ–¹å¼è¦å°½å¯èƒ½åœ°è´´è¿‘ä¸Šé¢ä¸¤ç§å¯æ±‚è§£çš„æƒ…å†µã€‚å¹¸è¿åœ°æ˜¯ï¼Œç›´è§‰åœ°åˆ’åˆ†å¯ä»¥æ¯”è¾ƒè½»æ¾åœ°åœ¨åˆå§‹çŠ¶æ€ä¸‹å¾—åˆ°ä¸€ç§å¯èƒ½çš„æ–¹å¼ï¼š</p><p><img src="2.png" /></p><p>å®¹æ˜“æ³¨æ„åˆ°åˆå§‹çŠ¶æ€å±äºæƒ…å†µ 1ï¼Œå¯ä»¥æŒ‰ç…§å›¾æ‰€ç¤ºï¼ŒæŒ‰ç…§è¡Œå·ä¸ <span class="math inline">\(x\)</span> çš„å¤§å°å…³ç³»åˆ†ç±»ï¼Œå¾—åˆ°ï¼š</p><ol type="1"><li>è¡Œ <span class="math inline">\(&lt;x\)</span>ï¼Œåˆ— <span class="math inline">\(&lt;x\)</span>ï¼›</li><li>è¡Œ <span class="math inline">\(&lt;x\)</span>ï¼Œåˆ— <span class="math inline">\(\ge x\)</span>ï¼›</li><li>è¡Œ <span class="math inline">\(=x\)</span>ï¼Œåˆ— <span class="math inline">\(=x\)</span>ï¼›</li><li>è¡Œ <span class="math inline">\(=x\)</span>ï¼Œåˆ— <span class="math inline">\(\in (x,y)\)</span>ï¼›</li><li>è¡Œ <span class="math inline">\(=x\)</span>ï¼Œåˆ— <span class="math inline">\(&gt;y\)</span>ï¼›</li><li>è¡Œ <span class="math inline">\(&gt;x\)</span>ï¼Œåˆ— <span class="math inline">\(&gt;x\)</span>ã€‚</li></ol><p>å‡ ä¸ª partã€‚</p><p>å¦‚æœæˆ‘ä»¬è¦å¯¹æƒ…å†µ 2 è¿›è¡Œåˆ’åˆ†å‘¢ï¼Ÿè¿™ä¹Ÿæ˜¯è½»æ¾çš„ï¼Œå‡è®¾å½“å‰å›¾å½¢æ»¡è¶³è¡Œï¼š <span class="math inline">\([l_1, l_2]\)</span>ï¼Œåˆ—ï¼š<span class="math inline">\([r_1, r_2]\)</span>ï¼ˆæ˜¾ç„¶è¿™æ˜¯ä¸ªå®Œæ•´çš„çŸ©å½¢ï¼‰ï¼Œä¸”æœ€ä¼˜è§£ <span class="math inline">\((x, y)\)</span>ã€‚å®¹æ˜“å‘ç°ä»»æ„è¡Œã€åˆ—ä¸€å®šç›¸ç¦»ï¼Œæ•…æ ¹æ® <span class="math inline">\((x, y)\)</span> åˆ’åˆ†å³å¯ï¼š</p><p><img src="3.png" /></p><p>ä¹Ÿå³ä»¥ä¸‹å‡ ä¸ª partï¼š</p><ol type="1"><li>è¡Œ <span class="math inline">\(&lt;x\)</span>ï¼›</li><li>è¡Œ <span class="math inline">\(=x\)</span>ï¼Œåˆ— <span class="math inline">\(&lt;y\)</span>ï¼›</li><li>è¡Œ <span class="math inline">\(=x\)</span>ï¼Œåˆ— <span class="math inline">\(&gt;y\)</span>ï¼›</li><li>è¡Œ <span class="math inline">\(&gt;x\)</span>ã€‚</li></ol><p>å¤æ‚åº¦ <span class="math inline">\(O(\sum k\log)\)</span>ã€‚æ³¨æ„åˆ°çº¿æ®µæ ‘çš„ <span class="math inline">\(\log\)</span> å’Œä¼˜å…ˆé˜Ÿåˆ—çš„ <span class="math inline">\(\log\)</span> å¹¶ä¸ä¼šå èµ·æ¥ã€‚</p><details><p>æ„å¤–çš„å¾ˆéš¾å†™ <img src="/em/qd.gif" /></p><p>ä¸»è¦æ˜¯çº¿æ®µæ ‘å†™èµ·æ¥æœ‰ç‚¹ç­”è¾©äº† <img src="/em/kt.gif" /></p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 1e5 + 5;struct __ &#123;    int l, r;    int i0, i1, s0, s1;    long long u, d, u0, u1;    __ operator+ (const __ &amp;q) const &#123;        __ res;        res.l = l, res.r = q.r, res.d = 0ll;        res.u = std::max(&#123; u, q.u, u1 - q.u0 &#125;);        if (res.u == u)            res.s0 = s0, res.s1 = s1;        else if (res.u == q.u)            res.s0 = q.s0, res.s1 = q.s1;        else            res.s1 = i1, res.s0 = q.i0;        if (u0 &lt; q.u0)            res.u0 = u0, res.i0 = i0;        else            res.u0 = q.u0, res.i0 = q.i0;        if (u1 &gt; q.u1)            res.u1 = u1, res.i1 = i1;        else            res.u1 = q.u1, res.i1 = q.i1;        return res;    &#125;&#125; t[maxn &lt;&lt; 2];long long a[maxn];#define lt (p &lt;&lt; 1)#define rt (lt | 1)void pushdown(int p) &#123;    if (t[p].d) &#123;        t[lt].d += t[p].d, t[rt].d += t[p].d;        t[lt].u0 += t[p].d, t[lt].u1 += t[p].d;        t[rt].u0 += t[p].d, t[rt].u1 += t[p].d;        t[p].d = 0;    &#125;    return;&#125;void pushup(int p) &#123;    t[p] = t[lt] + t[rt];    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r;    if (l == r) &#123;        t[p].i0 = t[p].i1 = t[p].s0 = t[p].s1 = l;        t[p].u0 = t[p].u1 = a[l];        return;    &#125;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    pushup(p);    return;&#125;void add(int p, int l, int r, long long v) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        t[p].u0 += v, t[p].u1 += v, t[p].d += v;        return;    &#125;    pushdown(p);    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (l &lt;= mid)        add(lt, l, r, v);    if (r &gt; mid)        add(rt, l, r, v);    pushup(p);    return;&#125;auto ask(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p];    pushdown(p);    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (r &lt;= mid)        return ask(lt, l, r);    if (l &gt; mid)        return ask(rt, l, r);    return ask(lt, l, r) + ask(rt, l, r);&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    std::freopen(&quot;pi.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;pi.out&quot;, &quot;w&quot;, stdout);#else    std::freopen(&quot;ex_pi2.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    bld(1, 1, n);    for (int op; m--; ) &#123;        std::cin &gt;&gt; op;        if (op == 1) &#123;            int l, r, x;            std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; x;            add(1, l, r, x);        &#125;        else &#123;            int l, r, k;            std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; k;            struct _ &#123;                int ty, l1, l2, r1, r2, x, y;                long long v;                bool operator&lt; (const _ &amp;q) const &#123;                    return v &lt; q.v;                &#125;            &#125;;            long long res = 0ll;            std::priority_queue&lt;_&gt; q;            auto calc = [&amp;](int ty, int l1, int l2, int r1, int r2) &#123;                if (l1 &lt;= l2 &amp;&amp; r1 &lt;= r2) &#123;                    if (ty == 1) &#123;                        auto ts(ask(1, l1, l2));                        q.push(&#123; 1, l1, l2, r1, r2, ts.s1, ts.s0, ts.u &#125;);                    &#125;                    else &#123;                        auto ls(ask(1, l1, l2)), rs(ask(1, r1, r2));                        q.push(&#123; 2, l1, l2, r1, r2, ls.i1, rs.i0, ls.u1 - rs.u0 &#125;);                    &#125;                &#125;                return;            &#125;;            calc(1, l, r, l, r);            for (; k--; ) &#123;                auto [ty, l1, l2, r1, r2, x, y, v] = q.top();                res += v;                q.pop();                if (ty == 1) &#123;                    calc(1, l1, x - 1, r1, x - 1);                    calc(2, l1, x - 1, x, r2);                    if (x != y)                        calc(1, x, x, x, x);                    calc(2, x, x, x + 1, y - 1);                    calc(2, x, x, y + 1, r2);                    calc(1, x + 1, l2, x + 1, r2);                &#125;                else &#123;                    calc(2, l1, x - 1, r1, r2);                    calc(2, x, x, r1, y - 1);                    calc(2, x, x, y + 1, r2);                    calc(2, x + 1, l2, r1, r2);                &#125;            &#125;            std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="d.-é“¶è¡Œçš„å´›èµ·">D. é“¶è¡Œçš„å´›èµ·</h2><p><a href="http://222.180.160.110:61235/contest/6174/problem/4" class="uri">http://222.180.160.110:61235/contest/6174/problem/4</a></p><p>åŸé¢˜ï¼š<a href="https://www.codechef.com/problems/CTREE?tab=statement">CodeChef CTREE - Chef and Chefcoin</a>ã€‚</p><p>å‡è®¾åªéœ€è¦ä¸€ä¸ªå…³é”®ç‚¹ï¼Œé‚£ä¹ˆå®¹æ˜“æƒ³åˆ°æ¢æ ¹ DP çš„åšæ³•ã€‚ä½†ä»…å‡­è¿™ä¸ªæ¯”è¾ƒ naive çš„æ€è·¯æ˜¯æ— æ³•é è¿‘æ­£è§£çš„ã€‚æ‰¾é¢˜è§£çš„æ—¶å€™çœ‹åˆ°ä¸€ä¸ªæƒŠä¸ºå¤©äººçš„å¼å­ï¼š<mark><span class="math inline">\(res=\sum\limits_{(u, v): w} f(v)=w\cdot \min(s_v,n-s_v)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(s_v\)</span> è¡¨ç¤º <span class="math inline">\(v\)</span> çš„ size</mark>ã€‚</p><p>ä¹ä¸€çœ‹æ˜¯åœ¨è®¨è®ºå…³é”®ç‚¹è¦é€‰åœ¨ <span class="math inline">\(v\)</span> å¤–éƒ¨è¿˜æ˜¯å†…éƒ¨ï¼Œä½†æ˜¯ <span class="math inline">\(\min\)</span> çš„å«ä¹‰å¾ˆå¥‡æ€ªâ€”â€”å‡å¦‚æœ‰å¤šä¸ªç‚¹éƒ½è§‰å¾—åº”è¯¥å¾€è‡ªå·±å†…éƒ¨èµ°å‘¢ï¼Ÿè€ƒè™‘å¦‚ä¸‹æ™®é€‚åœºæ™¯ï¼š</p><p><img src="4.png" /></p><p>å‡å¦‚ <span class="math inline">\(a\)</span> å’Œ <span class="math inline">\(c\)</span> éƒ½è§‰å¾—åº”è¯¥å¾€è‡ªå·±å†…éƒ¨èµ°ï¼Œå°±ä¼šæœ‰ <span class="math inline">\(\begin{cases}a&gt;b+c\\c&gt;a+b\end{cases}\Rightarrow 0&gt;2\times b\)</span>ï¼Œç”±æ­¤å°±åè¯äº†ã€‚</p><p>é‚£ä¹ˆæ˜¾ç„¶ <span class="math inline">\(f(v)=w\cdot s_v\iff s_v\le \dfrac n2\)</span>ï¼Œè½¬åŒ–æˆå¸¦æƒé‡å¿ƒé—®é¢˜ï¼Œå¯ä»¥ <span class="math inline">\(O(n)\)</span> ä¸€æ¬¡ DFS è§£å†³ã€‚é‚£æ‰©å±•åˆ°ä¸¤ä¸ªå‘¢ï¼Ÿæ‰‹ç©å‘ç°å­˜åœ¨ä¸€æ¡è¾¹ä½œä¸ºä¸¤ä¸ªé€‰æ‹©å€¾å‘çš„ç‚¹çš„åˆ†ç•Œï¼Œä¸ä¼šè¢«ä»»ä½•ä¸€æ–¹ç»è¿‡ï¼ˆæ˜¾ç„¶ï¼‰ï¼Œæšä¸¾è¿™æ¡åˆ†å‰²çº¿åˆ‡æ–­å°±å¯ä»¥å¾—åˆ°ä¸¤ä¸ªå­æ ‘ï¼›åœ¨å­æ ‘ä¸Šåˆ†åˆ«ä½œä¸€æ¬¡ä¸€ä¸ªå…³é”®ç‚¹çš„åšæ³•ï¼ŒåŠ èµ·æ¥å°±æ˜¯è¿™æ¡è¾¹çš„ç­”æ¡ˆã€‚</p><p>æ˜¾ç„¶è¿™æ˜¯ <span class="math inline">\(O(n^2)\)</span> çš„ï¼Œéœ€è¦ä¼˜åŒ–ã€‚èƒ½å¤Ÿæ„Ÿå—åˆ°æšä¸¾è¾¹çš„è¿‡ç¨‹ä¸å¤ªèƒ½è¢«ä¼˜åŒ–ï¼Œè€ƒè™‘ä¼˜åŒ–æ±‚è§£ä¸Šé¢å¼å­çš„è¿‡ç¨‹ã€‚å®¹æ˜“æƒ³åˆ°æ¢æ ¹ï¼Œè®° <span class="math inline">\(s&#39;\)</span> ä¸ºå½“å‰ç‰ˆæœ¬æ—¶åˆ»å˜åŒ–çš„ sizeï¼Œ<span class="math inline">\(s\)</span> ä¸ºåˆå§‹å€¼ï¼Œé‚£ä¹ˆæœ‰ï¼š</p><ul><li><span class="math inline">\(u\)</span> ä¾§ï¼Œå¯¹äº <span class="math inline">\(u\)</span> çš„æ‰€æœ‰ç¥–å…ˆ <span class="math inline">\(\{fa\}\)</span>ï¼Œ<span class="math inline">\(s&#39;_{fa}=s_{fa}-s_v\)</span>ï¼Œ<span class="math inline">\(n&#39;=n-s_v\)</span>ã€‚</li><li><span class="math inline">\(v\)</span> ä¾§ï¼Œæ‰€æœ‰ç‚¹ <span class="math inline">\(\{son\}\)</span> æœ‰ <span class="math inline">\(s&#39;_{son}=s_{son}\)</span>ï¼Œ<span class="math inline">\(n&#39;=s_v\)</span>ã€‚</li></ul><p>æˆ‘ä»¬éœ€è¦ç»´æŠ¤æ‰€æœ‰ <span class="math inline">\(s&#39;\)</span> å’Œ <span class="math inline">\(\dfrac {n&#39;}2\)</span> çš„å¤§å°å…³ç³»â€”â€”å‘ç°è¿™æ˜¯ä¸€ä¸ªç±»ä¼¼äºŒç»´ååºçš„é—®é¢˜ï¼Œå³æ±‚ï¼š</p><ol type="1"><li>DFN åœ¨ <span class="math inline">\(v\)</span> å­æ ‘èŒƒå›´å†…ï¼Œä¸” <span class="math inline">\(s\le \dfrac {s_v}2\)</span> çš„æƒå€¼ã€‚</li><li>DFN åœ¨ <span class="math inline">\(v\)</span> ä¹‹å‰ / ä¹‹åï¼Œä¸” <span class="math inline">\(s\le \dfrac {n-s_v}2\)</span> çš„æƒå€¼ã€‚</li></ol><p>è®°å½•è¯¢é—®çš„ DFN åŒºé—´ï¼Œç¦»çº¿ï¼ˆï¼Ÿï¼‰ä¸‹æ¥æŒ‰ç…§ <span class="math inline">\(n&#39;\)</span> æ’åºï¼Œéšä¾¿ç”¨ä¸ª DFN ä¸Šçš„ DS ç»Ÿè®¡ä¸€ä¸‹å³å¯ã€‚ä½† <span class="math inline">\(u\)</span> ä¾§çš„ <span class="math inline">\(s&#39;_{fa}\)</span> ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ²¡åŠæ³•ç¦»çº¿å¤„ç†ï¼Œè€ƒè™‘<mark>è´¹ç”¨æå‰è®¡ç®—æ¶ˆé™¤è¯¯å·®â€”â€”æ‰¾åˆ°æ¯” <span class="math inline">\(\dfrac {n-s_v}2\)</span> å¤§ï¼Œä½†å‡å» <span class="math inline">\(s_v\)</span> åæ¯”ä¹‹å°çš„ <span class="math inline">\(fa\)</span> æå‰å¤„ç†</mark>ã€‚</p><p><mark>å‘ç°ç”±äº <span class="math inline">\(s\)</span> éšç€ <span class="math inline">\(fa\)</span> å¾€ä¸Šæ˜¯å•è°ƒé€’å¢çš„ï¼Œæ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„ <span class="math inline">\(fa\)</span> æ˜¯è¿ç»­çš„ã€‚</mark>ç”¨æ ‘ä¸Šå€å¢æ¡†å‡ºä¸Šä¸‹ç«¯ç‚¹ <span class="math inline">\((fa_p\to fa_q]\)</span> è¿›è¡Œè´¹ç”¨æå‰è®¡ç®—ã€‚é‚£ä¹ˆå°±å¯ä»¥ <span class="math inline">\(O(n\log)\)</span> çš„è§£å†³é—®é¢˜äº†ã€‚</p><details><p><summary>å…·ä½“åœ°ï¼Œå¦‚ä½•æå‰è®¡ç®—ï¼Ÿ</summary></p><p>è®° <span class="math inline">\(diw_x\)</span> ä¸ºä» <span class="math inline">\(1\)</span> åˆ° <span class="math inline">\(x\)</span> çš„è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹ <span class="math inline">\(s\cdot w\)</span> ä¹‹å’Œã€‚</p><p>é‚£ä¹ˆæœ‰ï¼š</p><table><colgroup><col style="width: 25%" /><col style="width: 25%" /><col style="width: 25%" /><col style="width: 25%" /></colgroup><thead><tr class="header"><th style="text-align: center;">é¡¹</th><th style="text-align: center;">çœŸå®å€¼</th><th style="text-align: center;">è®¡ç®—å€¼</th><th style="text-align: center;"><span class="math inline">\(\sum\Delta\)</span></th></tr></thead><tbody><tr class="odd"><td style="text-align: center;"><span class="math inline">\(x\notin\{fa\}\land x\notin\{son\}\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot \min(s_x,n&#39;-s_x)\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot \min(s_x,n&#39;-s_x)\)</span></td><td style="text-align: center;"><span class="math inline">\(0\)</span></td></tr><tr class="even"><td style="text-align: center;"><span class="math inline">\(x\in[1\to fa_p]\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot (s_x - s_v)\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot s_x\)</span></td><td style="text-align: center;"><span class="math inline">\(-dis_p\times s_v\)</span></td></tr><tr class="odd"><td style="text-align: center;"><span class="math inline">\(x\in (fa_p\to fa_q]\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot (n-s_x)\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot s_x\)</span></td><td style="text-align: center;"><span class="math inline">\(n\times(dis_q-dis_p)-2\times (diw_q - diw_p)\)</span></td></tr><tr class="even"><td style="text-align: center;"><span class="math inline">\(x\in(fa_q,v)\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot (n-s_x)\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot (n-s_x-s_v)\)</span></td><td style="text-align: center;"><span class="math inline">\(s_v\cdot (dis_u-dis_q)\)</span></td></tr><tr class="odd"><td style="text-align: center;"><span class="math inline">\(x\in \{son\}\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot \min(s_x,n&#39;-s_x)\)</span></td><td style="text-align: center;"><span class="math inline">\(w_x\cdot \min(s_x,n&#39;-s_x)\)</span></td><td style="text-align: center;"><span class="math inline">\(0\)</span></td></tr></tbody></table><p>å³éœ€å°†ç­”æ¡ˆ <strong>å‡å»</strong> <span class="math inline">\(n\times(dis_q-dis_p)-2\times (diw_q - diw_p)+s_v\cdot (dis_u-dis_q-dis_p)\)</span>ã€‚</p></details><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#ifdef ONLINE_JUDGE    std::freopen(&quot;banking.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;banking.out&quot;, &quot;w&quot;, stdout);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n;        std::cin &gt;&gt; n;        std::vector&lt;long long&gt; a(n + 1);        long long sw = 0ll;        for (int i = 1; i &lt;= n; ++i)            std::cin &gt;&gt; a[i], sw += a[i];        std::vector&lt;std::vector&lt;std::pair&lt;int, long long&gt; &gt; &gt; g(n + 1);        for (int i = 1, x, y, w; i &lt; n; ++i) &#123;            std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;            g[x].emplace_back(y, w), g[y].emplace_back(x, w);        &#125;        struct _ &#123; int l, r, id; long long v; &#125;;        int now = 0;        std::vector&lt;_&gt; q;        std::vector&lt;int&gt; dfn(n + 1), rfn(n + 1);        std::vector&lt;std::vector&lt;int&gt; &gt; f(n + 1, std::vector&lt;int&gt; (21));        std::vector&lt;long long&gt; dis(n + 1), diw(n + 1), w(n + 1), res(n + 1), s(n + 1);        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123; // å‰ç½®å·¥ä½œ            dfn[x] = ++now, s[x] = a[x];            for (auto [i, tw] : g[x])                if (i != fa) &#123;                    w[i] = tw;                    f[i][0] = x;                    for (int j = 1; j &lt;= 20; ++j)                        f[i][j] = f[f[i][j - 1]][j - 1];                    DFS(i, x);                    s[x] += s[i];                &#125;            rfn[x] = now;            return;        &#125;;        DFS(1, -1);        DFS = [&amp;](int x, int fa) &#123;            for (auto [i, tw] : g[x])                if (i != fa) &#123;                    dis[i] = dis[x] + tw;                    diw[i] = diw[x] + tw * s[i];                    q.push_back(&#123; dfn[i], rfn[i], i, s[i] &#125;);                    q.push_back(&#123; 1, dfn[i] - 1, i, sw - s[i] &#125;);                    q.push_back(&#123; rfn[i] + 1, n, i, sw - s[i] &#125;);                    int p, q;                    long long t = (sw - s[i]) / 2;                    &#123;   // æ‰¾ä¸Šç«¯ç‚¹ï¼ˆå¼€çš„ï¼‰                        p = i;                        for (int j = 20; ~j; --j)                            if (f[p][j] &amp;&amp; s[f[p][j]] - s[i] &lt;= t)                                p = f[p][j];                        p = f[p][0];                    &#125;                    &#123;   // æ‰¾ä¸‹ç«¯ç‚¹ï¼ˆé—­çš„ï¼‰                        q = i;                        for (int j = 20; ~j; --j)                            if (f[q][j] &amp;&amp; s[f[q][j]] &lt;= t)                                q = f[q][j];                        q = f[q][0];                    &#125;                    res[i] -= sw * (dis[q] - dis[p]) - 2 * (diw[q] - diw[p]) + (dis[x] - dis[p] - dis[q]) * s[i];                    DFS(i, x);                &#125;            return;        &#125;;        DFS(1, -1);        std::vector&lt;int&gt; id(n + 1);        std::iota(id.begin() + 1, id.end(), 1);        std::sort(id.begin() + 1, id.end(), [&amp;](int x, int y) &#123; return s[x] &lt; s[y]; &#125;);        std::sort(q.begin(), q.end(), [&amp;](_ x, _ y) &#123; return x.v &lt; y.v; &#125;);        std::vector&lt;std::pair&lt;long long, long long&gt; &gt; bit(n + 1);        auto lowbit = [&amp;](int x) &#123; return x &amp; -x; &#125;;        auto add = [&amp;](int x, std::pair&lt;long long, long long&gt; v) &#123;            for (; x &lt;= n; x += lowbit(x))                bit[x].first += v.first, bit[x].second += v.second;            return;        &#125;;        auto ask = [&amp;](int x) &#123;            std::pair&lt;long long, long long&gt; res;            for (; x; x -= lowbit(x))                res.first += bit[x].first, res.second += bit[x].second;            return res;        &#125;;        auto j = ++id.begin();        for (auto &amp;[l, r, x, v] : q) &#123;            for (; j != id.end() &amp;&amp; s[*j] &lt;= v / 2; ++j)                add(dfn[*j], &#123; w[*j], s[*j] * w[*j] &#125;);            auto ls(ask(l - 1)), rs(ask(r));            rs.first -= ls.first, rs.second -= ls.second;            res[x] += rs.second;        &#125;        bit.assign(n + 1, &#123; 0ll, 0ll &#125;);        std::reverse(q.begin(), q.end());        std::reverse(id.begin(), id.end());        j = ++id.begin();        for (auto &amp;[l, r, x, v] : q) &#123;            for (; j != id.end() &amp;&amp; s[*j] &gt; v / 2; ++j)                add(dfn[*j], &#123; w[*j], s[*j] * w[*j] &#125;);            auto ls(ask(l - 1)), rs(ask(r));            rs.first -= ls.first, rs.second -= ls.second;            res[x] += rs.first * v - rs.second;        &#125;        std::cout &lt;&lt; *std::min_element(res.begin() + 2, res.end()) &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> å † </tag>
            
            <tag> æ ‘çš„é‡å¿ƒ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ ç¬”è®°ï¼šFWT</title>
      <link href="/20250329/"/>
      <url>/20250329/</url>
      
        <content type="html"><![CDATA[<p>æ´»äº†å“¥ä»¬ï¼Œå¤æ´»äº†ã€‚</p><span id="more"></span><hr /><p>è€ƒè™‘ä»¥ä¸‹é—®é¢˜ï¼š</p><ul><li>å¯¹äº <span class="math inline">\(\forall \,i\in U\)</span>ï¼Œæ±‚ <span class="math inline">\(c_i=\sum\limits_{j\cup k=i}a_j\cdot b_k\)</span>ã€‚</li></ul><p>å½“ç„¶è¿™é‡Œå¯ä»¥æŠŠé›†åˆçœ‹æˆäºŒè¿›åˆ¶çŠ¶æ€ï¼Œé‚£ä¹ˆå–å¹¶é›†å°±æ˜¯æŒ‰ä½æˆ–äº†ã€‚</p><p>å’•å’•å’•</p><hr /><h2 id="emiya-å®¶æ˜å¤©çš„é¥­">Emiya å®¶æ˜å¤©çš„é¥­</h2><p><a href="https://www.luogu.com.cn/problem/P10242" class="uri">https://www.luogu.com.cn/problem/P10242</a></p><p>å†·çŸ¥è¯†ï¼š<em>Emiya å®¶æ˜å¤©çš„é¥­</em> å’Œ <em>Emiya å®¶ä»Šå¤©çš„é¥­</em> æ‹¥æœ‰ç›¸åŒçš„éš¾åº¦è¯„çº§ <img src="/em/kt.gif" alt="ç£•å¤´" /></p><p>è€ƒè™‘æš´åŠ›çš„åšæ³•ï¼Œå¦‚æœæˆ‘ä»¬å…ˆé’¦å®šå¿…é¡»åˆ°è¾¾çš„äººï¼ˆè¿™æ˜¯ <span class="math inline">\(O(2^n)\)</span> çš„ï¼‰ï¼Œå†èŠ±è´¹ <span class="math inline">\(O(nm)\)</span> çš„æ—¶é—´ä¾æ¬¡åˆ¤å®šæ¯é“èœæ˜¯å¦å¯ä»¥è¢«é€‰æ‹©ï¼Œå°±å¯ä»¥ è§£å†³é—®é¢˜ã€‚ä½†å‘ç°æ—¶é—´æ˜¯ä¸èƒ½æ‰¿å—çš„ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä¼˜åŒ– <span class="math inline">\(O(nm)\)</span> çš„åˆ¤å®šã€‚</p><p>ç°åœ¨å·²çŸ¥äººå‘˜é›†åˆ <span class="math inline">\(s\)</span>ï¼Œå¯¹äºä¸€é“èœ <span class="math inline">\(i\)</span>ï¼Œè®¾å®ƒé€‚é…çš„äººå‘˜é›†åˆä¸º <span class="math inline">\(T_i\)</span>ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(s\subseteq T_i\)</span>ã€‚æ‰€æ±‚å³ä¸º <span class="math inline">\(\max\limits_s\{\sum\limits_{T_i\supseteq s}\sum\limits_{j\in s}a_{i,j}\}\)</span>ã€‚<span class="math inline">\(O(nm)\)</span> é¢„å¤„ç†å‡º <span class="math inline">\(f_j(u)=\sum\limits_{T_i=u}a_{j, i}\)</span>ï¼Œé‚£ä¹ˆå¾…æ±‚å³ä¸º <span class="math inline">\(\max\limits_{s}\{\sum\limits_{j\in s}\sum\limits_{u\supseteq s}f_j(u)\}\)</span>ï¼Œå‘ç°è¿™ä¸ªä¸œè¥¿å¯ä»¥ç”¨ FWT æ±‚ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, k;    std::cin &gt;&gt; k &gt;&gt; m, n = 1 &lt;&lt; k;    using arr = std::vector&lt;long long&gt;;    std::vector&lt;int&gt; t(m + 1);    std::vector&lt;arr&gt; a(k + 1, arr(m + 1)), f(k + 1, arr(n));    for (int i = 1; i &lt;= k; ++i)        for (int j = 1; j &lt;= m; ++j) &#123;            std::cin &gt;&gt; a[i][j];            if (a[i][j] &gt;= 0)                t[j] |= 1 &lt;&lt; (i - 1);        &#125;    for (int i = 1; i &lt;= k; ++i)        for (int j = 1; j &lt;= m; ++j)            if (a[i][j] &gt;= 0)                f[i][t[j]] += a[i][j];    &#123;        std::vector&lt;arr&gt; mT(2, arr(2));        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 0ll, mT[1][1] = 1ll;        auto calc = [&amp;](arr a, arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;            f = a;            for (int len = 2; len &lt;= n; len &lt;&lt;= 1) &#123;                for (int i = 0; i &lt; n; i += len)                    for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)                        std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);            &#125;            return;        &#125;;        for (int i = 1; i &lt;= k; ++i)            calc(f[i], f[i], mT);    &#125;    long long res = 0ll;    for (int s = 0; s &lt; n; ++s) &#123;        long long sum = 0ll;        for (int i = 1; i &lt;= k; ++i)            if ((s &gt;&gt; (i - 1)) &amp; 1)                sum += f[i][s];        res = std::max(res, sum);    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="nim-counting">Nim Counting</h2><p><a href="https://atcoder.jp/contests/abc212/tasks/abc212_h" class="uri">https://atcoder.jp/contests/abc212/tasks/abc212_h</a></p><p>å³ï¼Œä» <span class="math inline">\(A_N\)</span> ä¸­æœ‰æ”¾å›åœ°é€‰æ‹© <span class="math inline">\(\le M\)</span> ä¸ªæ•°ï¼Œé—®å®ƒä»¬å¼‚æˆ–èµ·æ¥ä¸ä¸º <span class="math inline">\(0\)</span> çš„æ–¹æ¡ˆæ•°ã€‚</p><p>å¦‚æœä»¤ <span class="math inline">\(f_{i, j}\)</span> è¡¨ç¤ºé€‰äº† <span class="math inline">\(i\)</span> æ¬¡ï¼Œå¼‚æˆ–å’Œä¸º <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œæ˜¾ç„¶ <span class="math inline">\(f_{1,i}=\sum [a_j=i]\)</span> ä¸ºå…³äº <span class="math inline">\(a\)</span> çš„æ¡¶ã€‚æ­¤æ—¶æœ‰ <span class="math inline">\(f_{i,j}=\sum\limits_{k=1}^n f_{i-1,j\oplus a_k}=\sum\limits_{k=0}^V f_{i-1,j\oplus k}\cdot f_{1,k}\)</span>ï¼Œå‘ç°æŠŠ <span class="math inline">\(f_1\)</span> è¿™ä¸ªæ¡¶åœ¨ <span class="math inline">\(f\)</span> ä¸Šåš <span class="math inline">\(N\)</span> æ¬¡ xor-FWT å°±å¯ä»¥å¾—åˆ° <span class="math inline">\(f_n\)</span>ã€‚</p><p>ä½†å¦‚æœç›´æ¥å· <span class="math inline">\(N\)</span> æ¬¡æ˜¯ <span class="math inline">\(O(N\cdot V\log V)\)</span> çš„ï¼Œä¸å¤ªç¾å¥½ï¼Œä½†æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å®é™…ä¸Šéœ€è¦åšä»€ä¹ˆï¼š</p><ol type="1"><li>æ±‚ <span class="math inline">\(f_i\)</span> çš„ FWTã€‚</li><li>æ±‚åˆå§‹æ¡¶ <span class="math inline">\(f_1\)</span> çš„ FWTã€‚</li><li>å¯¹ä½ç›¸ä¹˜å¾—åˆ° <span class="math inline">\(f_{i+1}\)</span> çš„ FWTã€‚</li><li>é€šè¿‡ FWT æ±‚å¾—åŸæœ¬çš„ <span class="math inline">\(f_{i+1}\)</span>ã€‚</li></ol><p>å½“è¿™ä¸ªæ“ä½œè¢«æ”¾åœ¨ <span class="math inline">\(i=1\sim n\)</span> ä¸Šä¾æ¬¡è¿›è¡Œæ—¶ï¼Œæˆ‘ä»¬å‘ç°ç¬¬ä¸€æ­¥å’Œæœ€åä¸€æ­¥ä¼šç›¸äº’æŠµæ¶ˆï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡º <span class="math inline">\(f_1\)</span> çš„ FWTï¼Œ<span class="math inline">\(FWT_{i, j}(f)\)</span> å³ä¸º <span class="math inline">\(FWT_{1, j}(f)^i\)</span>ã€‚å› ä¸ºæˆ‘ä»¬è¦æ±‚çš„æ˜¯ <span class="math inline">\(\sum\limits_{i, j}f_{i,j}\)</span> å¯ä»¥é€šè¿‡ç­‰æ¯”æ•°åˆ—æ±‚å’Œæ±‚å‡º <span class="math inline">\(FWT_j(s)=\sum f_{i, j}\)</span>ã€‚ç”±å‰æ–‡æ¨å¯¼å¯çŸ¥ç›´æ¥åšä¸€æ¬¡é€†å˜æ¢æ±‚å¾— <span class="math inline">\(s_j\)</span> å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    struct mint &#123;        const int mod = 998244353;        long long x;        mint(): x(0ll) &#123;&#125;        mint(long long x1): x((x1 + mod) % mod) &#123;&#125;        mint&amp; operator= (const mint q) &#123;            x = q.x;            return *this;        &#125;        bool operator== (const mint q) const &#123;            return x == q.x;        &#125;        mint operator* (const mint q) const &#123;            return x * q.x % mod;        &#125;        mint&amp; operator*= (const mint q) &#123;            return *this = *this * q;        &#125;        mint operator+ (const mint q) &#123;            return (x + q.x) % mod;        &#125;        mint&amp; operator+= (const mint q) &#123;            return *this = *this + q;        &#125;        mint operator- (const mint q) &#123;            return (x + mod - q.x) % mod;        &#125;        mint qkp(int y) &#123;            mint res(1ll), x(this-&gt;x);            for (; y; y &gt;&gt;= 1, x *= x)                if (y &amp; 1)                    res *= x;            return res;        &#125;        mint inv(void) &#123;            return qkp(mod - 2);        &#125;    &#125;;    int n, m, k = 16, l = 1 &lt;&lt; k;    std::cin &gt;&gt; m &gt;&gt; n;    using arr = std::vector&lt;mint&gt;;    arr a(n + 1), c(l);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i].x, c[a[i].x] += 1;    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));    mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = -1ll;    mI[0][0] = mI[0][1] = mI[1][0] = mint(2ll).inv(), mI[1][1] = mint(-2ll).inv();    auto calc = [&amp;](arr a, arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;        f = a;        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)            for (int i = 0; i &lt; l; i += len)                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)                    std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);        return;    &#125;;    calc(c, c, mT);    arr s(l);    for (int i = 0; i &lt; l; ++i)        if (c[i] == 1ll)            s[i] = m;        else            s[i] = c[i] * (mint(1ll) - c[i].qkp(m)) * (mint(1ll) - c[i]).inv();    calc(s, s, mI);    mint res;    for (int i = 1; i &lt; l; ++i)        res += s[i];    std::cout &lt;&lt; res.x &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="binary-table">Binary Table</h2><p><a href="https://codeforces.com/problemset/problem/662/C" class="uri">https://codeforces.com/problemset/problem/662/C</a></p><p>å‘ç°è¿™ä¸ªé¢˜å’Œ <em>Emiya å®¶ä»Šå¤©çš„é¥­</em> å¾ˆåƒï¼Œéƒ½æ˜¯æœ‰ä¸€ä¸ªå¾ˆå°çš„ç»´å’Œä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå¤§çš„ç»´ã€‚</p><p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„æ“ä½œé¡ºåºéƒ½å¯ä»¥ä»»æ„è°ƒæ¢ï¼›æœ´ç´ åœ°ï¼Œæˆ‘ä»¬æšä¸¾ <span class="math inline">\(2^n\)</span> ç§ç»™è¿™ <span class="math inline">\(n\)</span> è¡Œåè½¬çš„æƒ…å†µï¼›å†å¯¹äºæ¯ä¸€åˆ—ï¼Œ<span class="math inline">\(O(n)\)</span> é€‰æ‹©åº”è¯¥åè½¬è¿˜æ˜¯ä¸åè½¬ï¼Œè¿™æ ·æ€»å…±æ˜¯ <span class="math inline">\(O(2^n\cdot nm)\)</span> çš„ã€‚</p><p>å‘ç°æŠŠä¸€åˆ—åˆå§‹çŠ¶æ€å‹æˆä¸€ä¸ªäºŒè¿›åˆ¶æ•° <span class="math inline">\(a\)</span>ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æšä¸¾çš„è¡Œåè½¬çŠ¶æ€ä¸º <span class="math inline">\(s\)</span>ï¼Œæ˜¾ç„¶ç”¨ <span class="math inline">\(s\oplus a\)</span> å¯ä»¥å¾—åˆ°å½“å‰çŠ¶æ€ã€‚æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªå» FWT å‘¢ï¼Ÿè¿™å¼•å¯¼æˆ‘ä»¬ä¾ç„¶æšä¸¾ <span class="math inline">\(s\)</span>ï¼Œç”¨ä¸€ä¸ªå’Œ <span class="math inline">\(s\oplus a\)</span> æœ‰å…³çš„é‡è·Ÿä¸€ä¸ªå’Œ <span class="math inline">\(a\)</span> æœ‰å…³çš„é‡ç›¸ä¹˜å¾—åˆ°å…³äº <span class="math inline">\(s\)</span> çš„ç­”æ¡ˆã€‚</p><p>å®¹æ˜“å‘ç°ä»¤ <span class="math inline">\(f_{s\oplus a}\)</span> è¡¨ç¤º <span class="math inline">\(s\oplus a\)</span> è¿™ä¸ªçŠ¶æ€åè½¬å’Œä¸åè½¬ä¸¤ä¸ªé€‰é¡¹ä¸­å¯ä»¥è·å–çš„æœ€å°‘ 1 çš„ä¸ªæ•°ï¼›å†ä»¤ <span class="math inline">\(c_s\)</span> è¡¨ç¤ºçŠ¶æ€ä¸º <span class="math inline">\(s\)</span> çš„åˆ—çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆ <span class="math inline">\(\sum\limits_s c_s\times f_{s\oplus a}\)</span> å°±å¯ä»¥å¾—åˆ°æšä¸¾çš„åè½¬æ–¹æ¡ˆä¸º <span class="math inline">\(s\)</span> çš„ç­”æ¡ˆï¼Œæ±‚æœ€å°å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    struct mint &#123;        const int mod = 998244353;        long long x;        mint(): x(0ll) &#123;&#125;        mint(long long x1): x((x1 + mod) % mod) &#123;&#125;        mint&amp; operator= (const mint q) &#123;            x = q.x;            return *this;        &#125;        bool operator== (const mint q) const &#123;            return x == q.x;        &#125;        mint operator* (const mint q) const &#123;            return x * q.x % mod;        &#125;        mint&amp; operator*= (const mint q) &#123;            return *this = *this * q;        &#125;        mint operator+ (const mint q) &#123;            return (x + q.x) % mod;        &#125;        mint&amp; operator+= (const mint q) &#123;            return *this = *this + q;        &#125;        mint operator- (const mint q) &#123;            return (x + mod - q.x) % mod;        &#125;        mint qkp(int y) &#123;            mint res(1ll), x(this-&gt;x);            for (; y; y &gt;&gt;= 1, x *= x)                if (y &amp; 1)                    res *= x;            return res;        &#125;        mint inv(void) &#123;            return qkp(mod - 2);        &#125;    &#125;;    int n, m, l;    std::cin &gt;&gt; n &gt;&gt; m, l = 1 &lt;&lt; n;    using arr = std::vector&lt;mint&gt;;    arr c(l), f(l);    std::vector&lt;std::vector&lt;char&gt; &gt; a(n + 1, std::vector&lt;char&gt; (m + 1));    for (int i = 1; i &lt;= n; ++i)        for (int j = 1; j &lt;= m; ++j)            std::cin &gt;&gt; a[i][j];    for (int j = 1; j &lt;= m; ++j) &#123;        int s = 0;        for (int i = 1; i &lt;= n; ++i)            s = (s &lt;&lt; 1) + a[i][j] - &#39;0&#39;;        c[s] += 1;    &#125;    for (int i = 0, t; i &lt; l; ++i)        t = (__builtin_popcount(i)), f[i] = std::min(t, n - t);    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));    mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = -1ll;    mI[0][0] = mI[0][1] = mI[1][0] = mint(2ll).inv(), mI[1][1] = mint(-2ll).inv();    auto calc = [&amp;](arr a, arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;        f = a;        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)            for (int i = 0; i &lt; l; i += len)                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)                    std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);        return;    &#125;;    calc(c, c, mT), calc(f, f, mT);    arr s(l);    for (int i = 0; i &lt; l; ++i)        s[i] = c[i] * f[i];    calc(s, s, mI);    int res = 0x3f3f3f3f;    for (int i = 0; i &lt; l; ++i)        res = std::min(res, (int)s[i].x);    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="hard-nim">Hard Nim</h2><p><a href="https://hydro.ac/p/bzoj-P4589" class="uri">https://hydro.ac/p/bzoj-P4589</a></p><p><em>Nim Counting</em> ç„¶åç¼äº†ä¸ªç­›å­ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;const int inv2 = 5e8 + 4;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    std::vector&lt;int&gt; p, tag(50001);    for (int i = 2; i &lt;= 50000; ++i)        if (!tag[i]) &#123;            p.push_back(i);            for (int j = 2 * i; j &lt;= 50000; j += i)                tag[j] = 1;        &#125;    auto qkp = [&amp;](long long x, int y) &#123;        long long res = 1ll;        for (; y; y &gt;&gt;= 1, (x *= x) %= mod)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    for (int n, m; std::cin &gt;&gt; n &gt;&gt; m; ) &#123;        int k = std::__lg(m) + 1, l = 1 &lt;&lt; k;        using arr = std::vector&lt;long long&gt;;        arr c(l);        for (auto i : p)            if (i &lt;= m)                c[i] += 1;            else                break;        std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = mod - 1ll;        mI[0][0] = mI[0][1] = mI[1][0] = inv2, mI[1][1] = mod - inv2;        auto calc = [&amp;](arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;            for (int len = 2; len &lt;= l; len &lt;&lt;= 1)                for (int i = 0; i &lt; l; i += len)                    for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)                        std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);            return;        &#125;;        calc(c, mT);        arr s(l);        for (int i = 0; i &lt; l; ++i)            s[i] = qkp(c[i], n);        calc(s, mI);        std::cout &lt;&lt; s[0] &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="å­é›†å·ç§¯">å­é›†å·ç§¯</h2><p><a href="https://www.luogu.com.cn/problem/P6097" class="uri">https://www.luogu.com.cn/problem/P6097</a></p><p>è¿™ä¸ªæ˜¯åœ¨è®¸å¤š DP ä¸­éƒ½å¯èƒ½è§åˆ°è¿‡çš„ç»“æ„ï¼Œç›¸ä¿¡å¤§å®¶éƒ½æ·±æœ‰ä½“ä¼šã€‚</p><p>ç­‰ä»·äºæ±‚ <span class="math inline">\(c_s=\sum\limits_{i\cap j=\varnothing\land i\cup j=s}a_i\cdot b_j\)</span>ï¼Œé¦–å…ˆå…³æ³¨ <span class="math inline">\(i\cup j=s\)</span>ï¼Œå¯ä»¥ç”¨ FWT è§£å†³ï¼›å¯¹äº <span class="math inline">\(i\cap j = \varnothing\)</span> å‘¢ï¼Ÿ</p><p>æœ‰ä¸€ä¸ªå¾ˆèªæ˜çš„åŠæ³•ï¼Œæˆ‘ä»¬å‘ç° <span class="math inline">\(i\cap j=\varnothing\land i\cup j = s\iff \operatorname{ctz}(i)+\operatorname{ctz}(j)=\operatorname{ctz}(s)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(\operatorname{ctz}(i)\)</span> è¡¨ç¤º <span class="math inline">\(i\)</span> ä¸­ <span class="math inline">\(1\)</span> çš„ä¸ªæ•°ï¼Œå³ <code>popcount(i)</code>ã€‚</p><p>æ˜¾ç„¶åè€…æ˜¯ä¸ªç®€å•çš„åŠ æ³•è¿ç®—ï¼Œè¿™é‡Œåˆæœ‰ä¸€ä¸ªå¾ˆèªæ˜åˆå¾ˆåŸºæœ¬çš„åŠæ³•ï¼Œæˆ‘ä»¬ä»¤ <span class="math inline">\(A_{\operatorname{ctz}(i),i}=a_i,B_{\operatorname{ctz}(j),j}=b_j\)</span>ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±è½¬åŒ–ä¸º <span class="math inline">\(\sum\limits_{i}\sum\limits_{j\cup k=s}A_{i,j}\cdot B_{\operatorname{ctz}(s)-i,j}\)</span>ï¼Œå°±å¯ä»¥ <span class="math inline">\(O(n\log^2n)\)</span> åœ°è§£å†³é—®é¢˜äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 9;using arr = std::vector&lt;long long&gt;;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    int l = 1 &lt;&lt; n;    std::vector&lt;arr&gt; a(n + 1, arr(l)), b(n + 1, arr(l)), c(n + 1, arr(l));    for (int i = 0, x; i &lt; l; ++i)        std::cin &gt;&gt; x, a[__builtin_popcount(i)][i] = x;    for (int i = 0, x; i &lt; l; ++i)        std::cin &gt;&gt; x, b[__builtin_popcount(i)][i] = x;    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));    mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;    mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;    auto calc = [&amp;](arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)            for (int i = 0; i &lt; l; i += len)                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);        return;    &#125;;    for (int i = 0; i &lt;= n; ++i)        calc(a[i], mT), calc(b[i], mT);    for (int i = 0; i &lt;= n; ++i) &#123;        for (int k = 0; k &lt;= i; ++k)            for (int j = 0; j &lt; l; ++j)                (c[i][j] += a[k][j] * b[i - k][j]) %= mod;        calc(c[i], mI);    &#125;    for (int j = 0; j &lt; l; ++j)        std::cout &lt;&lt; c[__builtin_popcount(j)][j] &lt;&lt; &#39; &#39;;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="å·åŒºåˆ’åˆ†">å·åŒºåˆ’åˆ†</h2><p><a href="https://www.luogu.com.cn/problem/P4221" class="uri">https://www.luogu.com.cn/problem/P4221</a></p><p>äººè¯ï¼šæŠŠ <span class="math inline">\(n\)</span> ä¸ªç‚¹åˆ’åˆ†æˆè‹¥å¹²ä¸ªç‚¹é›†ï¼Œä¿è¯æ¯ä¸ªç‚¹é›†çš„å¯¼å‡ºå­å›¾ä¸æ˜¯æ¬§æ‹‰å›è·¯ï¼ˆæ¯ä¸ªç‚¹çš„åº¦æ•°ä¸ºå¶ä¸”å›¾è¿é€šï¼‰ã€‚</p><p>é‚£ä¹ˆæšä¸¾æ¯ä¸€ä¸ªç‚¹é›†åˆ¤å®šæ˜¯å¦åˆæ³•ï¼Œå†ä»¤ <span class="math inline">\(f_{i}={w_i}^{-p}\times\sum\limits_{j\cup k = i\land j\cap k=\varnothing}f_{j}\times {w_k}^p\)</span>ã€‚</p><p>å‘ç°åé¢é‚£ä¸ª sigma é‡Œé¢æ˜¯ä¸€ä¸ªç®€å•çš„å­é›†å·ç§¯ï¼›ä½†æ˜¯æˆ‘ä»¬å‘ç°å‰é¢æœ‰ä¸€ä¸ªå’Œ <span class="math inline">\(i\)</span> æœ‰å…³çš„å¸¸æ•°ï¼Œå¯¼è‡´æ²¡åŠæ³•ç›´æ¥å· <span class="math inline">\(n\)</span> æ¬¡ã€‚</p><p>ä½†æˆ‘ä»¬å‘ç°è¿™ä¸ª DP å…¶å®æ˜¯æœ‰ä¸€å®šéšå«æ¡ä»¶çš„â€”â€”éƒ½æ˜¯æŒ‰ç…§ <span class="math inline">\(\text{ctz}\)</span> ä»å°åˆ°å¤§è½¬ç§»ã€‚è€ƒè™‘å­é›†å·ç§¯çš„ç¬¬ä¸€ç»´ï¼Œå¾—åˆ° <span class="math inline">\(FWT_{f_i}\)</span> åå…ˆ IFWT å›æ¥ï¼Œä¹˜ä¸Š <span class="math inline">\({w_i}^{-p}\)</span>ï¼Œå† FWT å›å»å³å¯ã€‚è€ƒå¯Ÿå­é›†å·ç§¯çš„ç»“æ„ï¼Œå‘ç°è¿™ä¸ªæ˜¯å¯ä»¥æƒ³åŠæ³•å¥—è¿›å»çš„ã€‚</p><p>å¤æ‚åº¦ <a href="https://atcoder.jp/contests/abc400/tasks/abc400_c"><span class="math inline">\(O(n^2\cdot 2^n)\)</span></a>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;using arr = std::vector&lt;long long&gt;;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, p;    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; p;    int l = 1 &lt;&lt; n;    auto qkp = [&amp;](long long x, int y = mod - 2) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    arr w(n), inv(l);    std::vector&lt;arr&gt; f(n + 1, arr(l)), s(n + 1, arr(l));    std::vector&lt;std::vector&lt;int&gt; &gt; g(n);    for (int x, y; m--; ) &#123;        std::cin &gt;&gt; x &gt;&gt; y, --x, --y;        g[x].push_back(y);    &#125;    auto check = [&amp;](int s) &#123;        std::vector&lt;int&gt; f(n), deg(n);        std::iota(f.begin(), f.end(), 0);        std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;            return x == f[x] ? x : f[x] = find(f[x]);        &#125;;        auto merge = [&amp;](int x, int y) &#123;            f[find(x)] = find(y);            return;        &#125;;        for (int i = 0; i &lt; n; ++i)            if ((s &gt;&gt; i) &amp; 1)                for (auto j : g[i])                    if ((s &gt;&gt; j) &amp; 1)                        merge(i, j), ++deg[i], ++deg[j];        int fa = -1;        for (int i = 0; i &lt; n; ++i)            if ((s &gt;&gt; i) &amp; 1) &#123;                if (deg[i] &amp; 1)                    return 1;                if (fa == -1 || fa == find(i))                    fa = find(i);                else                    return 1;            &#125;        return 0;    &#125;;    for (int i = 0; i &lt; n; ++i)        std::cin &gt;&gt; w[i];    for (int i = 0; i &lt; l; ++i) &#123;        int ctz = __builtin_popcount(i);        for (int j = 0; j &lt; n; ++j)            if ((i &gt;&gt; j) &amp; 1)                 s[ctz][i] += w[j];        s[ctz][i] = qkp(s[ctz][i], p);        inv[i] = qkp(s[ctz][i]);        if (!check(i))            s[ctz][i] = 0ll;    &#125;    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));    mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;    mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;    auto calc = [&amp;](arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)            for (int i = 0; i &lt; l; i += len)                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);        return;    &#125;;    f[0][0] = 1ll;    for (int i = 0; i &lt;= n; ++i)        calc(s[i], mT);    for (int i = 1; i &lt;= n; ++i) &#123;        calc(f[i - 1], mT);        for (int k = 0; k &lt; i; ++k)            for (int j = 0; j &lt; l; ++j)                (f[i][j] += f[k][j] * s[i - k][j]) %= mod;        calc(f[i], mI);        for (int j = 0; j &lt; l; ++j)            (f[i][j] *= inv[j]) %= mod;    &#125;    std::cout &lt;&lt; f[n][l - 1] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b---sum-the-fibonacci">B - Sum the Fibonacci</h2><p><a href="https://codeforces.com/problemset/problem/914/G" class="uri">https://codeforces.com/problemset/problem/914/G</a></p><p>é¦–å…ˆï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ çš„ <span class="math inline">\(cnt\)</span> æ˜¯å¥½åšçš„â€”â€”åšä¸€æ¬¡å­é›†å·ç§¯å¾—åˆ° <span class="math inline">\(cnt_1(a\cup b)\)</span>ï¼Œåšä¸€æ¬¡ xor-FWT å¾—åˆ° <span class="math inline">\(cnt_2(d\oplus e)\)</span>ï¼Œä¸­é—´çš„ <span class="math inline">\(cnt(c)\)</span> å°±æ˜¯åŸæ ·ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯å¯ä»¥åœ¨ä¸€æ¬¡ and-FWT åæŠŠ <span class="math inline">\(cnt,cnt_1,cnt_2\)</span> ç›´æ¥å·èµ·æ¥â€”â€”ç”±çŸ©é˜µä¹˜æ³•ç»“åˆå¾‹å¾—ï¼ˆå“ˆå“ˆå¤§ç¬‘äº†ï¼‰ã€‚ä½†æ€ä¹ˆæŠŠ <span class="math inline">\(f\)</span> å¡è¿›å»å‘¢ï¼Ÿå¦‚æœä½ æ‹¥æœ‰å°å­¦ç”Ÿçš„æ•°å­¦æ°´å¹³ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°æƒ³åˆ°ç›´æ¥åœ¨ <span class="math inline">\(cnt,cnt_1,cnt_2\)</span> IFWT åçš„ç»“æœåˆ†åˆ«å¯¹ä½ä¹˜ä¸Š <span class="math inline">\(f\)</span> å³å¯ï¼Œå¾ˆå¯æƒœæˆ‘å¹¶æ²¡æœ‰è¿™æ ·çš„æ•°å­¦èƒ½åŠ› <img src="/em/kt.gif" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int N = 17;const int mod = 1e9 + 7;using arr = std::vector&lt;long long&gt;;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, l;    std::cin &gt;&gt; n, l = 1 &lt;&lt; N;    std::vector&lt;int&gt; a(n + 1);    arr f(l), cnt(l), cnt1(l), cnt2(l);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i], ++cnt[a[i]];    f[0] = 0ll, f[1] = 1ll;    for (int i = 2; i &lt; l; ++i)        f[i] = (f[i - 1] + f[i - 2]) % mod;    auto qkp = [&amp;](long long x, int y = mod - 2) &#123;        auto res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    const int inv2 = qkp(2ll);    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));    auto calc = [&amp;](arr a, arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;        f = a;        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)            for (int i = 0; i &lt; l; i += len)                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);        return;    &#125;;    &#123; // orFWT        mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;        mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;        std::vector&lt;arr&gt; u(N + 1, arr(l)), d(N + 1, arr(l));        for (int i = 0; i &lt; l; ++i)            u[__builtin_popcount(i)][i] = cnt[i];        for (int i = 0; i &lt;= N; ++i)            calc(u[i], u[i], mT);        for (int i = 0; i &lt;= N; ++i) &#123;            for (int j = 0; j &lt; l; ++j)                for (int k = 0; k &lt;= i; ++k)                    (d[i][j] += u[k][j] * u[i - k][j]) %= mod;            calc(d[i], d[i], mI);        &#125;        for (int i = 0; i &lt; l; ++i)            cnt1[i] = d[__builtin_popcount(i)][i] * f[i] % mod;    &#125;    &#123; // xor FWT        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = mod - 1ll;        mI[0][0] = mI[0][1] = mI[1][0] = inv2, mI[1][1] = mod - inv2;        calc(cnt, cnt2, mT);        for (int i = 0; i &lt; l; ++i)            (cnt2[i] *= cnt2[i]) %= mod;        calc(cnt2, cnt2, mI);        for (int i = 0; i &lt; l; ++i)            (cnt2[i] *= f[i]) %= mod;    &#125;    &#123; // andFWT        mT[0][0] = 0ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = 1ll;        mI[0][0] = mod - 1ll, mI[0][1] = 1ll, mI[1][0] = 1ll, mI[1][1] = 0ll;        for (int i = 0; i &lt; l; ++i) // è¿™ä¸€æ­¥è¦æ”¾åœ¨ FWT ä¹‹å‰ï¼ŒåŸå› æ˜¾ç„¶ ğŸ¤—            (cnt[i] *= f[i]) %= mod;        calc(cnt2, cnt2, mT), calc(cnt1, cnt1, mT), calc(cnt, cnt, mT);        for (int i = 0; i &lt; l; ++i)            cnt[i] = cnt[i] * cnt1[i] % mod * cnt2[i] % mod % mod;        calc(cnt, cnt, mI);    &#125;    long long res = 0ll;    for (int i = 0; i &lt; N; ++i)        (res += cnt[1 &lt;&lt; i] % mod) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> é«˜ç»´å‰ç¼€å’Œ </tag>
            
            <tag> FWT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜é›†</title>
      <link href="/20250219/"/>
      <url>/20250219/</url>
      
        <content type="html"><![CDATA[<p>ä¸åœ¨æ²‰é»˜ä¸­èººå¹³ï¼Œå°±åœ¨å–§åš£ä¸­èººå¹³ã€‚</p><span id="more"></span><p>ä½†è°è¯´äººä¸€å®šè¦èººå¹³ï¼Ÿæˆ‘è¦ work work work work work work work work å‹¤åŠ³åˆå‹‡æ•¢çš„ XSC062 ä¸ºäº† OI çš„å…³é”®æ‚é¢˜é›† å¥¹ä½œå‡ºäº†å·¨å¤§çš„è´¡çŒ® å·¨å¤§çš„ç‰ºç‰² å·¨å¤§çš„ carry æ— æ•Œäº† æ— æ•Œäº† <img src="/em/kt.gif" alt="ç£•å¤´" /></p><hr /><h2 id="usaco23jan-moo-route-g">[USACO23JAN] Moo Route G</h2><p><a href="https://www.luogu.com.cn/problem/P9018" class="uri">https://www.luogu.com.cn/problem/P9018</a></p><p>å…³é”®è¯ï¼š<mark>ç”±å°æ¨å¤§</mark> <mark>æ€ç»´</mark></p><p>å¸Œæœ›å¤§å®¶ä¸è¦å’Œæˆ‘ä¸€æ ·å¿½ç•¥äº†é‡è¦æ¡ä»¶ï¼šç»ˆç‚¹ä¹Ÿæ˜¯ <span class="math inline">\(0\)</span>ã€‚è¿™æ„å‘³ç€æ¯ä¸ªç‚¹éƒ½ä¼šè¢«å·¦å³æˆå¯¹åœ°ç»è¿‡ï¼Œé‚£ä¹ˆä¸å¦¨ä»¤ <span class="math inline">\(A_i\gets \frac 2{A_i}\)</span>ã€‚</p><p>è§‚å¯Ÿåˆ°ç»™äº† <span class="math inline">\(N=2\)</span> çš„ä¸€æ¡£åˆ†ï¼Œè€ƒè™‘è¯¥æƒ…å†µã€‚</p><ol type="1"><li><p>è‹¥ <span class="math inline">\(A_1&gt; A_2\)</span>ï¼š</p><details><p><summary>æ­¤æ—¶æœ€ä¼˜ç­–ç•¥ä¸ºâ€¦â€¦</summary></p><pre class="plain{data-line=&quot;1,2,5,6,9,10&quot;}"><code>|---------&gt;&lt;---------||---------&gt;&lt;---------||---------&gt;&lt;---------||----&gt;&lt;----||----&gt;&lt;----|===========0    1    2</code></pre></details>åªè¦ä¸æ‹†å¼€ä¸€ç»„ï¼Œç®­å¤´æ’åˆ—é¡ºåºä»»æ„ã€‚æ˜¾ç„¶æ–¹æ¡ˆæ•°ä¸º <span class="math inline">\({A_1}\choose {A_2}\)</span>ã€‚</li><li><p>Otherwiseï¼š</p><details><p><summary>æ­¤æ—¶æœ€ä¼˜ç­–ç•¥ä¸ºâ€¦â€¦</summary></p><pre class="plain{data-line=&quot;4,5,7,8&quot;}"><code>|----------&gt;      &lt;----|      |----&gt;      &lt;----|      |----&gt; &lt;---------| |---------&gt; &lt;---------| =========== 0    1    2</code></pre></details><p>ç›¸ä¼¼åœ°ï¼Œåªè¦ä¸æ‹†å¼€ä¸€ç»„ï¼Œç®­å¤´æ’åˆ—é¡ºåºä»»æ„ï¼Œå¯ä»¥æ³¨æ„åˆ°é™¤äº†ç¬¬ä¸€ä¸ªï¼Œæ¯ä¸ªé•¿ <code>|---&gt;</code> çš„å‰é¢ä¸€å®šæ˜¯ä¸€ä¸ªé•¿ <code>&lt;---|</code>ï¼Œé‚£ä¹ˆé—®é¢˜è½¬åŒ–ä¸ºé€‰æ‹© <span class="math inline">\(A_1-1\)</span> ä¸ªçŸ­ <code>&lt;---|</code> æ‹‰é•¿ï¼Œæ–¹æ¡ˆæ•°ä¸º <span class="math inline">\({A_2-1}\choose{A_1-1}\)</span>ã€‚</p></li></ol><p>è¿›ä¸€æ­¥ï¼Œè€ƒè™‘ <span class="math inline">\(N=3\)</span> çš„æƒ…å†µã€‚è‹¥å·²çŸ¥å­é—®é¢˜ <span class="math inline">\(0\to1\to2\)</span> çš„æ–¹æ¡ˆå’Œå­é—®é¢˜ <span class="math inline">\(1\to2\to3\)</span> çš„æ–¹æ¡ˆï¼Œå¯ä»¥ç›´æ¥ä¹˜èµ·æ¥åˆå¹¶ã€‚ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>äºŒè€…ç»è¿‡ <span class="math inline">\(2\)</span> çš„æ¬¡æ•°ç›¸ç­‰ï¼›åœ¨å­é—®é¢˜ <span class="math inline">\(0\to1\to2\)</span> ä¸­ï¼Œ<span class="math inline">\(1\to2\)</span> çš„ä¸‹ä¸€æ­¥ä¸€å®šæ˜¯ <span class="math inline">\(2\to 1\)</span>ï¼›æˆ‘ä»¬æŠŠè¯¥è¿‡ç¨‹æ›¿æ¢ä¸ºå­é—®é¢˜ <span class="math inline">\(1\to 2\to 3\)</span> ä¸­å¯¹åº”çš„ä¸€æ®µ <span class="math inline">\(1\to2\to\cdots\to2\to1\)</span> çš„è·¯å¾„å³å¯ã€‚</p><p>é‚£ä¹ˆä¸¤ä¸¤åˆå¹¶èµ·æ¥ï¼Œå¯ä»¥å¾—åˆ°æœ€ç»ˆç­”æ¡ˆä¸º <span class="math inline">\(\prod\limits_{i=1}^{n-1}\begin{cases}{\binom{A_i}{A_{i+1}}}&amp;A_i&gt;A_{i+1}\\{\binom{A_{i+1}-1}{A_i-1}}&amp;\text{otherwise}\end{cases}\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int lim = 5e5;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i], a[i] /= 2;    std::vector&lt;long long&gt; inv(lim + 1), fac(lim + 1);    auto qkp = [&amp;](long long x, int y) &#123;        long long res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    inv[0] = fac[0] = 1ll;    for (int i = 1; i &lt;= lim; ++i)        fac[i] = fac[i - 1] * i % mod;    inv[lim] = qkp(fac[lim], mod - 2);    for (int i = lim - 1; i; --i)        inv[i] = inv[i + 1] * (i + 1) % mod;    auto C = [&amp;](int n, int m) &#123;        return fac[n] * inv[n - m] % mod * inv[m] % mod;    &#125;;    long long res = 1ll;    for (int i = 1; i &lt; n; ++i)        if (a[i] &gt; a[i + 1])            (res *= C(a[i], a[i + 1])) %= mod;        else            (res *= C(a[i + 1] - 1, a[i] - 1)) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="gdkoi2024-æ™®åŠç»„-æ­£æ–¹å½¢æ‰©å±•">[GDKOI2024 æ™®åŠç»„] æ­£æ–¹å½¢æ‰©å±•</h2><p><a href="https://www.luogu.com.cn/problem/P10078" class="uri">https://www.luogu.com.cn/problem/P10078</a></p><p>å…³é”®è¯ï¼š<mark>åˆ†ç±»è®¨è®º</mark> <mark>æ‰«æçº¿</mark></p><p>ç†è®ºä¸Šçœ‹æ‡‚äº†å°±æ˜¯å¼±æ™ºé¢˜ï¼Œå¯æƒœçœ‹ä¸æ‡‚ã€‚</p><p>å°±æ˜¯è¯´ï¼Œä¸€ä¸ªç‚¹å¦‚æœè¢«æŸ“äº†æŸç§é¢œè‰²ï¼Œå¹¶ä¸”ä»¥å®ƒä¸ºä¸­å¿ƒçš„è¾¹é•¿ä¸º <span class="math inline">\(2\)</span> çš„æ­£æ–¹å½¢ä¸­æ²¡æœ‰å…¶ä»–é¢œè‰²çš„ç‚¹ï¼Œå°±æŠŠè¿™ä¸ªæ­£æ–¹å½¢é‡Œçš„ç‚¹éƒ½æŸ“æˆè¿™ä¸ªé¢œè‰²ï¼Œé—®æ¯ä¸ªé¢œè‰²é¢ç§¯æ˜¯å¦èƒ½è¾¾åˆ°æ— ç©·å¤§ã€‚</p><p>è€ƒè™‘æ— æ³•è¾¾åˆ°æ— ç©·å¤§çš„åŸå› ï¼Œä¸€å®šæ˜¯å› ä¸ºå‘å››ä¸ªæ–¹å‘éƒ½æ— æ³•å»¶ä¼¸åˆ°æ— ç©·è¿œã€‚ä»¥å³è¾¹ä¸ºä¾‹ï¼Œè€ƒè™‘ç‚¹ <span class="math inline">\(i\)</span> ä»€ä¹ˆæ—¶å€™ä¸èƒ½åœ¨ <span class="math inline">\(x\)</span> è½´æ­£æ–¹å‘ä¸Šå»¶ä¼¸åˆ°æ— ç©·è¿œï¼š</p><ul><li><p>å¯¹äº <span class="math inline">\(\forall \, j,x_j\le x_i\)</span>ï¼Œ<span class="math inline">\(j\)</span> <strong>ä¸ä¼š</strong>å¯¹ <span class="math inline">\(i\)</span> å‘å³çš„å»¶ä¼¸å¸¦æ¥ä»»ä½•å½±å“â€”â€”æ‰€æœ‰ç‚¹çš„å»¶ä¼¸é€Ÿåº¦ç›¸åŒã€‚</p></li><li><p>å¯¹äº <span class="math inline">\(x_j&gt;x_i\)</span> ä¸” <span class="math inline">\(y_j=y_i\)</span>ï¼Œ<span class="math inline">\(j\)</span> å¯ä»¥å µä½ <span class="math inline">\(i\)</span>ã€‚</p><p>è¿™æ—¶å€™ä¸å…äº§ç”Ÿç–‘é—®ï¼š<span class="math inline">\(i\)</span> ä¸èƒ½ä»ä¸Šä¸‹ã€Œç¿»è¶Šã€è¿‡ <span class="math inline">\(j\)</span> çš„ç»Ÿæ²»å—ï¼Ÿ</p><p>æ˜¾è€Œæ˜“è§åœ°ï¼Œç”±äºå»¶ä¼¸é€Ÿåº¦ç›¸åŒï¼Œ<span class="math inline">\(i\)</span> åœ¨æŸæ—¶åˆ»èƒ½å¤Ÿåœ¨ <span class="math inline">\(y\)</span> è½´ä¸Šåˆ°è¾¾çš„é«˜åº¦ï¼Œ<span class="math inline">\(j\)</span> ä¹Ÿèƒ½è¾¾åˆ°ï¼Œæ‰€ä»¥ <span class="math inline">\(j\)</span> <strong>èƒ½å¤Ÿ</strong>æŠŠ <span class="math inline">\(i\)</span> å µæ­»ï¼Œå‚è§é¢˜é¢ä¸­ç»™å‡ºçš„ä¾‹å­ã€‚</p></li><li><p>å¯¹äº <span class="math inline">\(x_j&gt;x_i\)</span> ä¸” <span class="math inline">\(y_j \ne y_i\)</span>ï¼Œç”±ä¸Šæ‰€è¿°ï¼Œ<span class="math inline">\(j\)</span> åœ¨ <span class="math inline">\(y\)</span> è½´ä¸‹ / ä¸Šæ–¹å‘<strong>æ— æ³•</strong>è¿½ä¸Š <span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\(i\)</span> å¯ä»¥ä»è¯¥æ–¹å‘è¶Šè¿‡ <span class="math inline">\(j\)</span>ï¼Œåœ¨ <span class="math inline">\(x\)</span> è½´æ­£æ–¹å‘ä¸Šå»¶ä¼¸åˆ°æ— ç©·è¿œï¼›ä½† <span class="math inline">\(j\)</span> åœ¨è‡ªå·±æ‰€åœ¨çš„ä¸€ä¾§ï¼ˆä¸Š / ä¸‹ï¼‰<strong>å¯ä»¥</strong>å µä½ <span class="math inline">\(i\)</span>ã€‚</p></li><li><p>å¯¹äº <span class="math inline">\(x_j,x_k&gt;x_i\)</span> ä¸” <span class="math inline">\((y_j-y_i)(y_k-y_i)&lt;0\)</span>ï¼ˆå³äºŒè€…åˆ†å±… <span class="math inline">\(i\)</span> ç‚¹ä¸Šä¸‹ï¼‰ï¼Œ<span class="math inline">\(j\)</span> å’Œ <span class="math inline">\(k\)</span> <strong>å¯ä»¥</strong>åœ¨ä¸¤ä¸ªæ–¹å‘åˆ†åˆ«æ‹¦æˆªä½ <span class="math inline">\(i\)</span>ã€‚</p><p>æ­¤æ—¶å¯èƒ½æœ‰ç–‘é—®ï¼š<span class="math inline">\(i\)</span> å¯ä¸å¯ä»¥å…ˆè¶Šè¿‡ <span class="math inline">\(j\)</span> ï¼Œå†è¶Šè¿‡ <span class="math inline">\(k\)</span> å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å¦å®šçš„ã€‚ç”±ä¸Šï¼Œ<span class="math inline">\(j\)</span> å’Œ <span class="math inline">\(k\)</span> ä¼šåˆ†åˆ«åœ¨ <span class="math inline">\(y\)</span> è½´è‡ªèº«å¯¹åº”æ–¹å‘ä¸Šå µä½ <span class="math inline">\(i\)</span>ï¼Œåœ¨è¶Šè¿‡å…¶ä¸­ä¹‹ä¸€åæ— æ³•ä»è¿™ä¸€ä¾§è¶Šè¿‡å¦ä¸€ä¸ªç‚¹ï¼Œæ‰€ä»¥ <span class="math inline">\(i\)</span> ä¼šè¢«ä¸¤ä¸ªç‚¹åˆä½œå µæ­»ã€‚</p></li></ul><p>ç”±æ­¤æˆ‘ä»¬æ€»ç»“å‡ºï¼Œ<span class="math inline">\(i\)</span> èƒ½åœ¨ <span class="math inline">\(x\)</span> è½´æ­£æ–¹å‘è¢«æ‹¦æˆªï¼Œå½“ä¸”ä»…å½“ï¼š</p><ul><li>å­˜åœ¨ <span class="math inline">\(x_j&gt;x_i\)</span> ä¸” <span class="math inline">\(y_j=y_i\)</span>ï¼›</li><li>æŠ‘æˆ–ï¼Œå­˜åœ¨ <span class="math inline">\(x_j,x_k&gt;x_i\)</span> ä¸” <span class="math inline">\(y_j&lt;y_i,y_k&gt;y_i\)</span>ã€‚</li></ul><p>é‚£ä¹ˆå¯ä»¥ä»å››ä¸ªæ–¹å‘åˆ†åˆ«ç”¨æ‰«æçº¿æ±‚è§£ã€‚é‰´äºå’Œå®é™…åæ ‡æ•°å€¼æ²¡æœ‰ä»€ä¹ˆç›´æ¥å…³ç³»ï¼Œå¯ä»¥ç¦»æ•£åŒ–åæ ‘çŠ¶æ•°ç»„ä»¥é¿å…è¢«å¡å¸¸ã€‚</p><hr /><h2 id="é‡‘é±¼è‰">é‡‘é±¼è‰</h2><p><a href="http://222.180.160.110:61235/contest/6051/problem/4" class="uri">http://222.180.160.110:61235/contest/6051/problem/4</a></p><blockquote><p>ç»™å®š <span class="math inline">\(n\)</span> ä¸ªåŒºé—´ <span class="math inline">\([l,r]\)</span> æ»¡è¶³ <span class="math inline">\(r\le m\)</span>ï¼Œç»™å‡º <span class="math inline">\(q\)</span> ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—® <span class="math inline">\([L,R]\)</span> æ˜¯å¦èƒ½è¢«è¡¨ç¤ºä¸ºè‹¥å¹² <span class="math inline">\([l,r]\)</span> çš„ ORï¼ˆå¹¶ï¼‰ã€‚</p><p><span class="math inline">\(n,m,q\le 5\times 10^5\)</span>ã€‚</p></blockquote><p>å…³é”®è¯ï¼š<mark>æ‰«æçº¿</mark> <mark>çº¿æ®µæ ‘ç»´æŠ¤ç‰¹æ®Šæ•°æ®</mark></p><p>å°æ¸…æ–°æ•°æ®ç»“æ„é¢˜ã€‚é¢˜ç›®æ‰€æ±‚ç­‰ä»·äº check æ»¡è¶³ <span class="math inline">\(l\ge L\land r\le R\)</span> çš„æ‰€æœ‰åŒºé—´æ˜¯å¦èƒ½å¤Ÿè¦†ç›– <span class="math inline">\([L,R]\)</span>ã€‚</p><p>åœ¨è€ƒè™‘æ˜¯ä¸æ˜¯èƒ½å¤Ÿç”¨æ•°æ®ç»“æ„ç›´æ¥å®Œæˆä»»åŠ¡æ—¶ï¼Œå‘ç°çº¿æ®µæ ‘å¯ä»¥ç»´æŠ¤ã€Œä¸€æ®µè¿ç»­å·¦ç«¯ç‚¹ä¸­æ˜¯å¦èƒ½å¤Ÿå®Œæ•´è¦†ç›–ä¸€æ®µæ•°ã€ï¼Œå…·ä½“åœ°ï¼Œç»´æŠ¤æ¯ä¸€æ®µåŒºé—´èƒ½å¤Ÿæœ€è¿œåˆ°è¾¾çš„å³ç«¯ç‚¹ <span class="math inline">\(rv\)</span>ï¼ˆé‚£ä¹ˆæ˜¾ç„¶ä»åŒºé—´å·¦ç«¯ç‚¹åˆ° <span class="math inline">\(rv\)</span> éƒ½èƒ½è¢«è¿ç»­è¦†ç›–ï¼‰ï¼ŒåŒºé—´å†…æœ€é å³çš„æ²¡æœ‰è¢«è¦†ç›–åˆ°çš„ç‚¹ <span class="math inline">\(p\)</span>ï¼Œå’Œè¡¨ç¤ºåŒºé—´æ˜¯å¦èƒ½è¢«å®Œæ•´è¦†ç›–çš„æ ‡è®° <span class="math inline">\(flag\)</span>ã€‚<span class="math inline">\(rv\)</span> æ˜¯æ˜“ç»´æŠ¤çš„ï¼›è€Œ <span class="math inline">\(flag=0\)</span> å½“ä¸”ä»…å½“ï¼š</p><ul><li><p>å·¦å„¿å­çš„ <span class="math inline">\(flag=0\)</span>ã€‚</p><p>æ­¤æ—¶è‹¥å³å„¿å­ <span class="math inline">\(flag=0\)</span>ï¼Œé‚£ä¹ˆå½“å‰ç»“ç‚¹ <span class="math inline">\(p\)</span> å¯èµ‹ä¸ºå³å„¿å­çš„ <span class="math inline">\(p\)</span>ï¼›å¦åˆ™ï¼Œ<span class="math inline">\(p\)</span> èµ‹ä¸ºå·¦å„¿å­çš„ <span class="math inline">\(p\)</span>ã€‚</p></li><li><p>å·¦å„¿å­çš„ <span class="math inline">\(flag=1\)</span>ï¼Œä½†å³å„¿å­ <span class="math inline">\(flag = 0\)</span>ï¼Œä¸”å·¦å„¿å­çš„ <span class="math inline">\(rv\)</span>å¤Ÿä¸åˆ°å³å„¿å­çš„ <span class="math inline">\(p\)</span>ã€‚</p><p>æ­¤æ—¶å½“å‰ç»“ç‚¹çš„ <span class="math inline">\(p\)</span> ä»ä¸ºå³å„¿å­çš„ <span class="math inline">\(p\)</span>ï¼Œå› ä¸ºæˆ‘ä»¬åªåœ¨æ„æœ€è¿œçš„æ²¡æœ‰è¢«è¦†ç›–åˆ°çš„ç‚¹ã€‚</p></li></ul><p>å®¹æ˜“å‘ç°å¦‚æœæˆ‘ä»¬åœ¨æ ‘ä¸Šè¯¢é—® <span class="math inline">\([L,R]\)</span> ä¸­æ‰€æœ‰å·¦ç«¯ç‚¹çš„ <span class="math inline">\(flag\)</span>ï¼ˆè¯¢é—®æ–¹æ³•å’Œ pushup æ˜¯ç±»ä¼¼çš„ï¼‰ï¼Œæ— æ³•ä¿è¯å‚ä¸è¦†ç›–çš„ <span class="math inline">\(r\le R\)</span>ã€‚æ•…ç¦»çº¿ä¸‹æ¥æ‰«æçº¿ï¼Œä»å·¦åˆ°å³æšä¸¾æ¯ä¸ª <span class="math inline">\(i\)</span> ä½œä¸º <span class="math inline">\(R\)</span> çš„æƒ…å†µï¼ŒæŠŠæ‰€æœ‰ <span class="math inline">\([l,i]\)</span> æ’å…¥çº¿æ®µæ ‘ï¼Œå¯¹äºæ¯ä¸ªè¯¢é—® <span class="math inline">\([L,i]\)</span> å³å¯åœ¨æ ‘ä¸Šç›´æ¥æŸ¥è¯¢ç­”æ¡ˆã€‚</p><p><em>bbï¼šæ®è¯´æ˜¯ d1t2 æ°´å¹³ï¼Œä½†æˆ‘å±…ç„¶ 1min ä¸åˆ°æŠŠè§£æ³•å¤§æ¦‚èƒ¡å‡ºæ¥äº†ï¼Ÿå¸Œæœ› CQOI2025 ä¹Ÿè¿™ä¹ˆèƒ¡ï¼ˆåŒå…³</em></p><p><em>bbï¼šä¼¼ä¹æ˜¯ä¸€ä¸ªå…¨æ–°çš„ä¸éœ€è¦åŒºé—´ä¿®æ”¹çš„åšæ³• <img src="/em/kt.gif" alt="ç£•å¤´" /></em></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 5e5 + 5;struct _ &#123;    bool flag;    int l, r, rv, p;&#125; t[maxn &lt;&lt; 2];#define lt (p &lt;&lt; 1)#define rt (lt | 1)void pushup(int p) &#123;    t[p].rv = std::max(t[lt].rv, t[rt].rv);    if (!t[lt].flag) &#123;        t[p].flag = 0;        if (!t[rt].flag &amp;&amp; t[lt].rv &lt; t[rt].p)            t[p].p = t[rt].p;        else            t[p].p = t[lt].p;    &#125;    else if (!t[rt].flag &amp;&amp; t[lt].rv &lt; t[rt].p)        t[p].flag = 0, t[p].p = t[rt].p;    else        t[p].flag = 1, t[p].p = 0;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = t[p].p = r;    if (l == r)        return;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    return;&#125;void add(int p, int x, int v) &#123;    if(t[p].l == t[p].r) &#123;        t[p].flag = 1, t[p].p = 0;        t[p].rv = std::max(t[p].rv, v);        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (x &lt;= mid)        add(lt, x, v);    else        add(rt, x, v);    pushup(p);    return;&#125;_ ask(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p];    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (r &lt;= mid)        return ask(lt, l, r);    if (l &gt; mid)        return ask(rt, l, r);    auto ls(ask(lt, l, r)), rs(ask(rt, l, r));    if (!ls.flag) &#123;        if (!rs.flag &amp;&amp; ls.rv &lt; rs.p)            ls.p = rs.p;    &#125;    else if (!rs.flag &amp;&amp; ls.rv &lt; rs.p)        ls.flag = 0, ls.p = rs.p;    ls.rv = std::max(ls.rv, rs.rv);    return ls;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    std::freopen(&quot;snapdragon.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;snapdragon.out&quot;, &quot;w&quot;, stdout);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, q;    std::cin &gt;&gt; m &gt;&gt; n &gt;&gt; q;    bld(1, 1, m);    std::vector&lt;std::vector&lt;int&gt; &gt; t(m + 1);    for (int i = 1, l, r; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; l &gt;&gt; r;        t[r].push_back(l);    &#125;    std::vector&lt;int&gt; res(q + 1);    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; tq(m + 1);    for (int i = 1, l, r; i &lt;= q; ++i) &#123;        std::cin &gt;&gt; l &gt;&gt; r;        tq[r].emplace_back(l, i);    &#125;    for (int i = 1; i &lt;= m; ++i) &#123;        for (auto l : t[i])            add(1, l, i);        for (auto [l, id] : tq[i])            res[id] = ask(1, l, i).flag;    &#125;    for (int i = 1; i &lt;= q; ++i)        std::cout &lt;&lt; (res[i] ? &quot;YES&quot; : &quot;NO&quot;) &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘ç»´æŠ¤å‰ç¼€æœ€å€¼åºåˆ—ä¿¡æ¯</title>
      <link href="/20250217/"/>
      <url>/20250217/</url>
      
        <content type="html"><![CDATA[<p>äººç±»ä¸åº”è¯¥ä½¿ç”¨ <code>std::vector</code> å®ç°çº¿æ®µæ ‘çš„ 2 ä¸ªåŸå› ï¼š</p><span id="more"></span><ol type="1"><li>å½“ä½ çš„å‚æ•°åŒ…å«å¼•ç”¨æ—¶ï¼Œæ‰©å®¹æ“ä½œï¼ŒåŒ…æ‹¬æ˜¾å¼çš„ <code>resize()</code> å’Œéšå¼çš„ <code>push_back()</code> å‡ä¼šå¯¼è‡´å¼•ç”¨å¤±æ•ˆã€‚</li><li>å½“ä½ çš„å·¦å€¼ä¸ºå¼•ç”¨æ—¶ï¼Œç”±äº <code>=</code> å·¦å³è®¡ç®—é¡ºåºæ˜¯ä¸ç¡®å®šçš„ï¼ˆC++14ï¼‰ï¼Œç”±äº 1 ä¸­æ‰€è¿°åŸå› ï¼Œå¼•ç”¨å¯èƒ½å¤±æ•ˆã€‚</li><li><code>terminate called after throwing an instance of 'std::bad_alloc' what():  std::bad_alloc</code></li></ol><p>ç¬‘ç‚¹è§£æï¼šé¦–å…ˆé€šè¿‡ã€Œâ€¦â€¦çš„ 2 ä¸ªåŸå› ã€æš—ç¤ºå£°æ˜ä¸€ä¸ªé•¿åº¦ä¸º 2 çš„ <code>vector</code>ï¼Œæ¥ç€åœ¨è¯•å›¾è®¿é—®ç¬¬ 3 ä¸ªå…ƒç´ æ—¶æŠ›å‡ºé”™è¯¯ã€‚</p><p>ä»€ä¹ˆï¼Ÿä½ è¯´æˆ‘çš„ä¸‹æ ‡æ˜¯ä» 1 å¼€å§‹çš„ï¼Ÿæ­å–œä½ å‘ç°äº† <code>vector</code> çš„ç¬¬ 0 ä¸ªç¬‘ç‚¹ã€‚</p><hr /><h2 id="æ¥¼æˆ¿é‡å»º">æ¥¼æˆ¿é‡å»º</h2><p><a href="https://www.luogu.com.cn/problem/P4198" class="uri">https://www.luogu.com.cn/problem/P4198</a></p><p>è€ƒè™‘ç”¨çº¿æ®µæ ‘è§£å†³é—®é¢˜ã€‚éš¾ç‚¹åœ¨äºå¦‚ä½•åˆå¹¶ä¸¤ä¸ªåŒºé—´çš„ä¿¡æ¯â€”â€”ç›´è§‰åœ°ï¼Œå¤§åŒºé—´çš„ä¿¡æ¯ä¸€å®šä¸ä¸¤ä¸ªå­åŒºé—´æœ‰å…³ã€‚</p><p>è€ƒè™‘ç†æƒ³çš„æƒ…å†µï¼šæˆ‘ä»¬ç°åœ¨çŸ¥é“å·¦å³ä¸¤è¾¹åŒºé—´çš„ç­”æ¡ˆåºåˆ—ã€‚æ˜¾ç„¶æˆ‘ä»¬éœ€è¦ä¿ç•™å·¦è¾¹æ•´æ®µåŒºé—´ï¼Œå¯¹äºå·¦åŒºé—´åºåˆ—æœ«çš„å…ƒç´  <span class="math inline">\(rv_l\)</span>ï¼Œæˆ‘ä»¬åœ¨å³åŒºé—´å†…æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºä¹‹çš„å…ƒç´  <span class="math inline">\(x\)</span>ï¼Œä»å®ƒå¼€å§‹çš„åºåˆ—å°±æ˜¯ç­”æ¡ˆã€‚</p><p>åè¯æ³•æ˜“å¾— <span class="math inline">\(x\)</span> ä¸€å®šåœ¨å³åŒºé—´ç­”æ¡ˆåºåˆ—å†…ï¼šè‹¥ <span class="math inline">\(x\)</span> ä¸åœ¨ç­”æ¡ˆåºåˆ—å†…ï¼Œåˆ™å³åŒºé—´å†…å­˜åœ¨ä¸€ä¸ª <span class="math inline">\(&gt;x\)</span> ä¸”ä½äº <span class="math inline">\(x\)</span> ä¹‹å‰çš„å…ƒç´ ï¼Œé‚£ä¹ˆ <span class="math inline">\(x\)</span> å°±ä¸æ˜¯ç¬¬ä¸€ä¸ª <span class="math inline">\(&gt;rv_l\)</span> çš„å…ƒç´ ï¼ŒçŸ›ç›¾ã€‚</p><p>é‚£ä¹ˆç°åœ¨å¯¹äºå·¦å³åºåˆ—æœªçŸ¥çš„æƒ…å†µï¼Œæˆ‘ä»¬å–å·¦åŒºé—´çš„ç­”æ¡ˆï¼Œå†åœ¨å³åŒºé—´ä¸­å• <span class="math inline">\(\log\)</span> æŸ¥æ‰¾èƒ½å¤Ÿæ¥ä¸Šå»çš„åŒºé—´é•¿åº¦ï¼ŒåŠ èµ·æ¥å³å¯ã€‚</p><p>é¢˜ç›®åªè¦æ±‚æ€»åŒºé—´ç­”æ¡ˆï¼Œæ•…ä¸éœ€è¦æŸ¥è¯¢ã€‚åŠ¨æ€å¼€ç‚¹å¯èƒ½éœ€è¦å°å¿ƒå¤„ç†ä¸€ä¸‹ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 1e5 + 5;struct &#123;    int l, r, u;    double lv, rv, mv;&#125; t[maxn &lt;&lt; 2];int tot;#define lt t[p].l#define rt t[p].rint askt(int p, int l, int r, double v) &#123;    if (l == r)        return t[p].u;    int mid = (l + r) &gt;&gt; 1;    if (lt &amp;&amp; t[p].mv &gt; v)        return t[p].u - t[lt].u + askt(lt, l, mid, v);    return askt(rt, mid + 1, r, v);&#125;void pushup(int p, int l, int r) &#123;    t[p].mv = t[lt].rv;    if (lt &amp;&amp; rt) &#123;        t[p].lv = t[lt].lv;        t[p].rv = std::max(t[lt].rv, t[rt].rv);        if (t[lt].rv &lt; t[rt].lv)            t[p].u = t[lt].u + t[rt].u;        else if (t[lt].rv &gt;= t[rt].rv)            t[p].u = t[lt].u;        else &#123;            int mid = (l + r) &gt;&gt; 1;            t[p].u = t[lt].u + askt(rt, mid + 1, r, t[lt].rv);        &#125;    &#125;    else &#123;        t[p].u = t[lt + rt].u;        t[p].lv = t[lt + rt].lv, t[p].rv = t[lt + rt].rv;    &#125;    return;&#125;void upd(int &amp;p, int l, int r, int x, double v) &#123;    if (!p)        p = ++tot;    if (l == r) &#123;        t[p].lv = t[p].rv = v, t[p].u = 1;        return;    &#125;    int mid = (l + r) &gt;&gt; 1;    if (x &lt;= mid)        upd(lt, l, mid, x, v);    else        upd(rt, mid + 1, r, x, v);    pushup(p, l, r);    return;&#125;#undef lt#undef rtint main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;P4198_2.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, rt = 0;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;double&gt; a(n + 1);    for (int x; m--; ) &#123;        double y;        std::cin &gt;&gt; x &gt;&gt; y;        a[x] = y / x;        upd(rt, 1, n, x, y / x);        std::cout &lt;&lt; t[1].u &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Public Round 15 å‰ä¸¤é¢˜</title>
      <link href="/20250216/"/>
      <url>/20250216/</url>
      
        <content type="html"><![CDATA[<p><a href="https://pjudge.ac/contest/1914">PR #15</a> å‰ä¸¤é¢˜é¢˜è§£ã€‚</p><span id="more"></span><hr /><h2 id="æœ€å°è¡¨ç¤ºæ³•">æœ€å°è¡¨ç¤ºæ³•</h2><p><a href="https://pjudge.ac/contest/1914/problem/21888" class="uri">https://pjudge.ac/contest/1914/problem/21888</a></p><p>é¦–å…ˆä¸å¦¨å‡è®¾æ¯ä¸ª <span class="math inline">\(f\)</span> åœ¨å€¼åŸŸå†…ç­‰æ¦‚ç‡å–å€¼ä»¥ç®€åŒ–é—®é¢˜ã€‚é‚£ä¹ˆæ‰‹ç©ä¸€ä¸‹å¯ä»¥è½»æ¾åœ°å¾—åˆ°è§„å¾‹ï¼šä¸å¦¨å°† <span class="math inline">\(\{s\}\)</span> å¾ªç¯å³ç§»ä¸€ä½çš„ç»“æœè®°ä¸º <span class="math inline">\(\{t\}\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\(res=\sum\frac 1{\max(|s_i|,|t_i|)}\)</span>ã€‚</p><p>è¿™çœ‹èµ·æ¥ä»¤äººç–‘æƒ‘ï¼šå¯¹äºä¸åŒçš„ <span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\([f(s_i)=f(t_i)]\)</span> çš„æœŸæœ›ä¼¼ä¹æ˜¯å½¼æ­¤ç‹¬ç«‹çš„ï¼Œååˆ†å¥‡æ€ªã€‚è¿™å…¶å®ä¸è¡¨è¾¾å¼çš„æ¥æºæœ‰å…³ï¼Œè®° <span class="math inline">\(g(s_i, j)\)</span> è¡¨ç¤º <span class="math inline">\(f(s_i)=j\)</span> çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆä¸Šè¿°ç­‰å¼å¯ä»¥è½¬å†™ä¸º <span class="math inline">\(res=\sum\limits_i\sum\limits_jg({s_i},j)\times g(t_i,j)\)</span>ã€‚</p><p>é‚£ä¹ˆå°†æœ€å°è¡¨ç¤ºæ³•å¸¦æ¥çš„åå·®çº³å…¥è€ƒè™‘èŒƒå›´ï¼Œæˆ‘ä»¬å‘ç° <span class="math inline">\(g(s,j)\)</span> å¯¹äºä¸åŒçš„ <span class="math inline">\(j\)</span> å¹¶ä¸æ°¸è¿œç›¸ç­‰ã€‚å…·ä½“åœ°ï¼Œå½“ <span class="math inline">\(s\)</span> å…·æœ‰å¾ªç¯èŠ‚æ—¶ï¼Œæœ€å°å¾ªç¯èŠ‚çš„ç¬¬ä¸€å¤„ç»“å°¾ä¼šäº«æœ‰æ›´å¤§çš„å–å¾—æ¦‚ç‡ã€‚</p><p>æšä¸¾ <span class="math inline">\(s_i\)</span> çš„å› æ•°ä½œä¸ºæœ€å°å¾ªç¯èŠ‚é•¿åº¦çš„æƒ…å†µï¼Œæ˜¾ç„¶ï¼Œå¯¹äºæœ€å°å¾ªç¯èŠ‚ä¸º <span class="math inline">\(j\)</span> çš„æƒ…å†µï¼ˆè¯¥æƒ…å†µå‡ºç°çš„æ¦‚ç‡ï¼Œå®¹æ–¥å¾—åˆ° <span class="math inline">\(p_j=26^j-\sum_{k\mid j}p_k\)</span>ï¼‰ï¼Œ<span class="math inline">\(f(s_i)\)</span> çš„å–å€¼åœ¨ <span class="math inline">\(1\sim j\)</span> ä¸Šç­‰æ¦‚ç‡åˆ†å¸ƒï¼Œå·®åˆ†å³å¯ç»Ÿè®¡æ¯ä¸ªå€¼åœ¨ä¸åŒå¾ªç¯èŠ‚é•¿åº¦ä¸‹è¢«å–åˆ°çš„æ¦‚ç‡å’Œã€‚</p><p>ç”¨åŸƒç­›è§£å†³æ¯ä¸ªæ•°çš„å› æ•°å’Œ <span class="math inline">\(p\)</span> å€¼ï¼Œé‚£ä¹ˆæ­¤æ—¶å¤æ‚åº¦ç“¶é¢ˆåœ¨äº <span class="math inline">\(g(s_i, j)\)</span> å’Œ <span class="math inline">\(\sum\limits_i\sum\limits_jg({s_i},j)\times g(t_i,j)\)</span> çš„æ±‚è§£ã€‚å®¹æ˜“å‘ç°åªæœ‰æ¯ä¸ª <span class="math inline">\(g(s_i,j),j\mid |s_i|\)</span> çš„å€¼æ˜¯æœ‰æ•ˆçš„ï¼ˆå…¶ä»–çš„å’Œå®ƒä»¬å€¼éƒ½ç›¸åŒï¼‰ï¼Œè€ƒè™‘åªæ±‚è§£å’Œåˆ©ç”¨è¿™äº›å€¼ï¼Œç±» <code>std::merge</code>ï¼ˆå³å½’å¹¶æ’åºï¼‰åœ°æ±‚è§£ç­”æ¡ˆã€‚</p><p>æ³¨æ„ç‰¹åˆ¤ <span class="math inline">\(n=1\)</span>ã€‚ä¼šå¾—åˆ°é”™è¯¯ç­”æ¡ˆçš„åŸå› æ˜¯æ­¤æ—¶å­˜åœ¨ <span class="math inline">\(s_i=t_i\)</span>ï¼Œä¸æ»¡è¶³åŸºæœ¬è¦æ±‚ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int lim = 1e5;const int mod = 998244353;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    if (n == 1) &#123;        std::cout &lt;&lt; 1 &lt;&lt; &#39;\n&#39;;        return 0;    &#125;    auto qkp = [](long long x, int y) &#123;        long long res = 1ll;        for (; y; y &gt;&gt;= 1, (x *= x) %= mod)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    auto inv = [&amp;](int x) &#123;        return qkp(x, mod - 2);    &#125;;    std::vector&lt;long long&gt; f(lim + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; fac(lim + 1);    for (int i = 1; i &lt;= lim; ++i) &#123;        static long long now = 26;        (f[i] += now) %= mod;        fac[i].push_back(i);        for (int j = 2 * i; j &lt;= lim; j += i)            (f[j] += mod - f[i]) %= mod, fac[j].push_back(i);        (now *= 26) %= mod;    &#125;    for (int i = 1; i &lt;= lim; ++i)        (f[i] *= inv(i)) %= mod;    std::vector&lt;int&gt; a(n + 1);    struct _ &#123; int l, r; long long f; &#125;;    std::vector&lt;std::vector&lt;_&gt; &gt; g(lim + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        if (g[a[i]].empty()) &#123;            g[a[i]].resize(fac[a[i]].size());            for (int j = 0; j &lt; (int)fac[a[i]].size(); ++j) &#123;                g[a[i]][j].l = (j ? g[a[i]][j - 1].r + 1 : 1);                g[a[i]][j].r = fac[a[i]][j];                (g[a[i]][0].f += f[fac[a[i]][j]]) %= mod;                if (j != (int)fac[a[i]].size() - 1)                    (g[a[i]][j + 1].f += mod - f[fac[a[i]][j]]) %= mod;            &#125;            for (int j = 1; j &lt; (int)fac[a[i]].size(); ++j)                (g[a[i]][j].f += g[a[i]][j - 1].f) %= mod;            int getinv = inv(qkp(26, a[i]));            for (int j = 0; j &lt; (int)fac[a[i]].size(); ++j)                (g[a[i]][j].f *= getinv) %= mod;        &#125;    &#125;    std::vector&lt;int&gt; b(n + 1);    std::rotate_copy(a.begin() + 1, --a.end(), a.end(), b.begin() + 1);    long long res = 0ll;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 0, k = 0, now = 0;            j &lt; (int)fac[a[i]].size() &amp;&amp; k &lt; (int)fac[b[i]].size(); )            if (g[a[i]][j].r &lt; g[b[i]][k].r) &#123;                (res += g[a[i]][j].f * g[b[i]][k].f % mod                    * (g[a[i]][j].r - now) % mod) %= mod;                now = g[a[i]][j].r, ++j;            &#125;            else if (g[a[i]][j].r == g[b[i]][k].r) &#123;                (res += g[a[i]][j].f * g[b[i]][k].f % mod                    * (g[a[i]][j].r - now) % mod) %= mod;                now = g[a[i]][j].r, ++j, ++k;            &#125;            else &#123;                (res += g[a[i]][j].f * g[b[i]][k].f % mod                    * (g[b[i]][k].r - now) % mod) %= mod;                now = g[b[i]][k].r, ++k;            &#125;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="äºŒå‰æœç´¢æ ‘">äºŒå‰æœç´¢æ ‘</h2><p><a href="https://pjudge.ac/contest/1914/problem/21889" class="uri">https://pjudge.ac/contest/1914/problem/21889</a></p><p>å½“æˆ‘ä»¬å¤„ç†é“¾çš„éƒ¨åˆ†åˆ†æ—¶ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨å·®åˆ†è§£å†³é—®é¢˜ã€‚æŠŠæ›´æ–° <span class="math inline">\([l, r]\)</span> çœ‹ä½œåœ¨å·®åˆ†æ•°ç»„ <span class="math inline">\(l\)</span> å¤„æ’å…¥ï¼Œåœ¨ <span class="math inline">\(r+1\)</span> å¤„åˆ é™¤ï¼Œç¦»çº¿ä¸‹æ¥å†ä»å·¦åˆ°å³æ‰«ä¸€éæ“ä½œï¼Œè€ƒè™‘å¦‚ä½•è§£å†³æŸ¥è¯¢é—®é¢˜ã€‚</p><p>è€ƒè™‘å¦‚ä½•è·å– <span class="math inline">\(i\)</span> æ ‘ä¸Š <span class="math inline">\(t_0\)</span> æ—¶åˆ»ç‚¹ <span class="math inline">\(x\)</span> çš„æ‰€æœ‰ç¥–å…ˆã€‚æ ¹æ®å‰é¢çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥è·å– <span class="math inline">\(i\)</span> æ ‘ä¸Šå­˜åœ¨è¿‡çš„æ‰€æœ‰å…ƒç´ ã€‚</p><p>å¯¹äºæ¯” <span class="math inline">\(x\)</span> å¤§çš„å…ƒç´ ï¼Œè€ƒè™‘ç¥–å…ˆ <span class="math inline">\(p_a\)</span> å’Œéç¥–å…ˆ <span class="math inline">\(p\)</span> æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚æ ¹æ® BST çš„æ€§è´¨æ˜“å¾—ï¼Œå¯¹äºæœ€ä½çš„å³ä¾§ç¥–å…ˆ <span class="math inline">\({p_a}_0\)</span>ï¼Œå…¶æ˜¯ <span class="math inline">\(\ge x\)</span> çš„æœ€å°çš„å…ƒç´ ï¼ˆå½“ç„¶å…¶åŠ å…¥æ—¶åˆ» <span class="math inline">\(t_a&lt;t_0\)</span>ï¼‰ï¼›é‚£ä¹ˆåŒç†å¯ä»¥æ‰¾åˆ° <span class="math inline">\({p_a}_0\)</span> å³ä¾§æœ€ä½çš„ç¥–å…ˆï¼ˆå…¶å·¦ä¾§çš„ç¥–å…ˆæ˜¾ç„¶ä¹Ÿ <span class="math inline">\(x\)</span> å·¦ä¾§ï¼‰ï¼Œè¯¥ç¥–å…ˆæ»¡è¶³ <span class="math inline">\(t&lt;t_a\)</span>ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±ä»å·¦å³ä¸¤è¾¹åˆ†åˆ«å¾—åˆ° <span class="math inline">\(x\)</span> çš„æ‰€æœ‰ç¥–å…ˆã€‚å®¹æ˜“è¯æ˜è¯¥è¿‡ç¨‹å¯¹äºä¸åœ¨æ ‘ä¸Šçš„ <span class="math inline">\(x\)</span> ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</p><p>å…·ä½“åœ°ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œèƒ½å¤Ÿæ±‚å‡º <span class="math inline">\(\ge x\)</span> çš„å…ƒç´ ä¸­ï¼Œä»¥ <span class="math inline">\(t_0\)</span> ä¸ºèµ·ç‚¹çš„å‰ç¼€æœ€å°å€¼åºåˆ—çš„åŒºé—´å’Œã€‚</p><p>æ¬¸ â˜ğŸ¤“ è¿™æ˜¯ä»€ä¹ˆï¼Ÿ<a href="/20250217">æ¥¼æˆ¿é‡å»º</a>ï¼ç§’ä¸€ä¸‹ï¼</p><p>è¿›ä¸€æ­¥åœ°ï¼Œæœ¬é¢˜éœ€è¦å®Œæˆå¯¹äº <span class="math inline">\(t_0\)</span> ä¸ºåºåˆ—å¤´çš„æŸ¥è¯¢ã€‚å†æ¬¡åˆ©ç”¨æ€§è´¨ï¼Œæ¯æ¬¡ <span class="math inline">\(O(\log V)\)</span> åœ°åˆå¹¶ç­”æ¡ˆã€‚</p><p>å¥½çš„é‚£ä¹ˆæ€ä¹ˆæŠŠé“¾æåˆ°æ ‘ä¸Šå‘¢ï¼ŸæŠŠå·®åˆ†æ”¾åˆ°æ ‘ä¸Šï¼Œå†™ä¸ªçº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚</p><p><strong>æ³¨æ„ç”±äºè¿™é¢˜ç»†èŠ‚å¤ªå¤šäº†ï¼Œæ‰€ä»¥ä½ å¯èƒ½éœ€è¦èˆå¼ƒä¸å¿…è¦çš„æ—¶ç©ºä¼˜åŒ–æ¢å–ä»£ç ç®€æ´åº¦ä»¥æ–¹ä¾¿è°ƒè¯•ã€‚</strong></p><details><pre data-line="12" class="cpp language-cpp"><code data-line="12" class="cpp language-cpp">#include &lt;bits/stdc++.h&gt;const int lim = 2e5;const int maxn = 2e7 + 5;const int inf = 0x3f3f3f3f;struct &#123;    int l, r, rv;    long long u;&#125; t[maxn];std::vector&lt;int> tr;#define lt t[p].l#define rt t[p].rint newnode(void) &#123;         // æˆ‘çŸ¥é“ä½ è¦è¯´ä»€ä¹ˆï¼Œä½†è¿™å±äºã€Œå¿…è¦çš„ã€ç©ºé—´ä¼˜åŒ– ğŸ˜¥    static int tot = 0;    if (tr.empty())        return ++tot;    auto p(tr.back());    t[p].l = t[p].r = 0;    tr.pop_back();    return p;&#125;long long askv(int p, int l, int r, int v) &#123;    if (l == r)        return t[p].rv < v ? t[p].u : 0;    int mid = (l + r) >> 1;    if (v > t[lt].rv)        return t[p].u - t[lt].u + askv(lt, l, mid, v);    return askv(rt, mid + 1, r, v);&#125;void pushup(int p, int l, int r) &#123;    t[p].rv = std::min(t[lt].rv, t[rt].rv);    int mid = (l + r) >> 1;    t[p].u = t[lt].u + askv(rt, mid + 1, r, t[lt].rv);    return;&#125;void upd(int &p, int l, int r, int x, int v, int u) &#123;    if (!p)        p = newnode();    if (l == r) &#123;        t[p].rv = v, t[p].u = u;        return;    &#125;    int mid = (l + r) >> 1;    if (x <= mid)        upd(lt, l, mid, x, v, u);    else        upd(rt, mid + 1, r, x, v, u);    pushup(p, l, r);    return;&#125;void merge(int &p, int q, int l, int r) &#123;    if (!p || !q) &#123;        p += q;        return;    &#125;    if (l == r) &#123;        t[p].rv = std::min(t[p].rv, t[q].rv);        t[p].u = std::max(t[p].u, t[q].u);        return;    &#125;    int mid = (l + r) >> 1;    merge(t[p].l, t[q].l, l, mid), merge(t[p].r, t[q].r, mid + 1, r);    pushup(p, l, r), tr.push_back(q);    return;&#125;int qv = inf;long long ask(int p, int l, int r, int ql, int qr) &#123;    if (ql <= l && r <= qr) &#123;        auto s(askv(p, l, r, qv));        qv = std::min(qv, t[p].rv);        return s;    &#125;    int mid = (l + r) >> 1;    long long res = 0ll;    if (ql <= mid)        res = ask(lt, l, mid, ql, qr);    if (qr > mid)        res += ask(rt, mid + 1, r, ql, qr);    return res;&#125;#undef lt#undef rtint main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen("ex_problem4.in", "r", stdin);    std::freopen(".out", "w", stdout);#endif    int n, m;    std::cin >> n >> m;    std::vector&lt;std::vector&lt;int> > g(n + 1);    for (int i = 1, x, y; i < n; ++i) &#123;        std::cin >> x >> y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;int> top(n + 1), fa(n + 1), siz(n + 1), son(n + 1), dep(n + 1);    std::function&lt;void(int, int)> DFS = [&](int x, int faa) &#123;        siz[x] = 1;        for (auto i : g[x])            if (i != faa) &#123;                fa[i] = x, dep[i] = dep[x] + 1;                DFS(i, x), siz[x] += siz[i];                if (siz[i] > siz[son[x]])                    son[x] = i;            &#125;        return;    &#125;;    DFS(1, -1);    DFS = [&](int x, int topp) &#123;        top[x] = topp;        if (son[x])            DFS(son[x], topp);        for (auto i : g[x])            if (i != fa[x] && i != son[x])                DFS(i, i);        return;    &#125;;    DFS(1, 1);    auto getLCA = [&](int x, int y) &#123;        for (; top[x] != top[y]; x = fa[top[x]])            if (dep[top[y]] > dep[top[x]])                std::swap(x, y);        return (dep[x] < dep[y] ? x : y);    &#125;;    std::vector&lt;std::vector&lt;int> > d(n + 1);    std::vector&lt;std::vector&lt;std::pair&lt;int, int> > > u(n + 1);    std::vector&lt;std::vector&lt;std::tuple&lt;int, int, int> > > q(n + 1);    int cnt = 0;    for (int i = 1; i <= m; ++i) &#123;        int op;        std::cin >> op;        if (op == 0) &#123;            int x, v;            std::cin >> x >> v;            q[x].emplace_back(++cnt, i, v);        &#125; else &#123;            int x, y, v;            std::cin >> x >> y >> v;            int faa = getLCA(x, y);            u[x].emplace_back(i, v), u[y].emplace_back(i, v);            if (fa[faa])                d[fa[faa]].emplace_back(v);        &#125;    &#125;    std::vector&lt;long long> res(cnt + 1);    std::vector&lt;std::vector&lt;int> > rt(2, std::vector&lt;int> (n + 1));    t[0].rv = inf;    DFS = [&](int x, int fa) &#123;        for (auto i : g[x])            if (i != fa) &#123;                DFS(i, x);                merge(rt[0][x], rt[0][i], 1, lim);                merge(rt[1][x], rt[1][i], 1, lim);            &#125;        for (auto [t, v] : u[x]) &#123;            upd(rt[0][x], 1, lim, v, t, v);            upd(rt[1][x], 1, lim, lim - v + 1, t, v);        &#125;        for (auto v : d[x]) &#123;            upd(rt[0][x], 1, lim, v, inf, 0);            upd(rt[1][x], 1, lim, lim - v + 1, inf, 0);        &#125;        for (auto [id, t, v] : q[x]) &#123;            qv = t, res[id] = ask(rt[0][x], 1, lim, v, lim);            qv = t, res[id] += ask(rt[1][x], 1, lim, lim - v + 1, lim);            qv = t, res[id] -= ask(rt[0][x], 1, lim, v, v);        &#125;    &#125;;    DFS(1, -1);    for (int i = 1; i <= cnt; ++i)        std::cout << res[i] << '\n';    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> æ•°å­¦ </tag>
            
            <tag> æ ‘ä¸Šå·®åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„æ‚çƒ©</title>
      <link href="/20250210/"/>
      <url>/20250210/</url>
      
        <content type="html"><![CDATA[<p>ds is fun â€”â€”<span class="citation" data-cites="crashed">@crashed</span></p><span id="more"></span><hr /><h2 id="warm-up-i">Warm up! I</h2><h3 id="å¤šé‡é›†-å½©è™¹è›‹ç³•">å¤šé‡é›† / å½©è™¹è›‹ç³•</h3><p><a href="http://222.180.160.110:61235/contest/6010/problem/7" class="uri">http://222.180.160.110:61235/contest/6010/problem/7</a></p><p>å¥½åƒå¹¶ä¸æ˜¯ç¬¬ä¸€æ¬¡è§äº†ï¼Ÿ<mark>åƒæ˜¯æŠŠå‡ ä¸ªäºŒå…ƒç»„çš„åŒä¸€ç»´æ‹¿æ¥æ•´æ´»ï¼Œå¯ä»¥è€ƒè™‘æ’ç­‰å˜å½¢è½¬åŒ–ä¸ºååºé—®é¢˜</mark>ã€‚</p><p>è‹¥ <span class="math inline">\(a_{i,0}+b_{j,0}\ge a_{i,1}+b_{j,1}\)</span>ï¼Œåˆ™ <span class="math inline">\(a_{i,0}-a_{i,1}\ge b_{j,1}-b_{j,0}\)</span>ã€‚å¦‚æœæˆ‘ä»¬æŠŠ <span class="math inline">\(a\)</span> æŒ‰ç…§ <span class="math inline">\(a_{i,0}-a_{i,1}\)</span> æ’åºå¹¶æŠŠ <span class="math inline">\(b\)</span> æŒ‰ç…§ <span class="math inline">\(b_{j,1}-b_{j,0}\)</span> æ’åºï¼Œé‚£ä¹ˆè‹¥éœ€è¦æ±‚æŸä¸ªæ—¶åˆ»çš„ç­”æ¡ˆï¼Œéœ€è¦å¯¹äºæ¯ä¸€ä¸ª <span class="math inline">\(i\)</span>ï¼Œæ‰¾åˆ°æœ€å°çš„ <span class="math inline">\(b_{j,0}\)</span>ï¼Œä½¿å¾— <span class="math inline">\(b_{j,1}-b_{j,0}\)</span> åœ¨ <span class="math inline">\([-\infty, a_{i,0}-a_{i,1}]\)</span> ä¸­ï¼ŒåŒæ—¶æ‰¾åˆ°æœ€å°çš„ <span class="math inline">\(b_{j,1}\)</span>ï¼Œä½¿å¾— <span class="math inline">\(b_{j,1}-b_{j,0}\)</span> åœ¨ <span class="math inline">\([a_{i, 0}-a_{i,1},+\infty]\)</span> ä¸­ã€‚</p><p>é‚£ä¹ˆæœ‰ä¸€ä¸ªå¾ˆç¥çš„æ–¹æ³•ï¼ˆä¼¼ä¹ä¹Ÿä¸æ˜¯ç¬¬ä¸€æ¬¡é‡åˆ°äº†ä½†æ€»ç»“ä¸å‡ºæ¥ <img src="/em/yun.gif" alt="æ™•" />ï¼‰ï¼Œæˆ‘ä»¬åœ¨çº¿æ®µæ ‘ pushup çš„æ—¶å€™ï¼Œå°è¯•ç”¨å·¦è¾¹çš„ <span class="math inline">\(b_{j,0}\)</span> æ›´æ–°å³è¾¹çš„ç­”æ¡ˆã€‚</p><p><em>ç‰¢æ¸¸è¯´ä¹‹æ‰€ä»¥è§‰å¾—å¾ˆç†Ÿæ‚‰æ˜¯å› ä¸ºæˆ‘ä¹‹å‰ % ä½ èµ›åšåˆ°è¿‡è¿™é“é¢˜è¿˜ A äº†ï¼Ÿï¼Ÿï¼Ÿç¦»è°±çš„ã€‚</em></p><p>ä¸ºå•¥ llsw ä¸€å®šè¯´æ˜¯ç¦»çº¿å•Š <img src="/em/yun.gif" alt="æ™•" /> æƒ³ä¸åˆ°ä»€ä¹ˆå¥½çš„ç¦»çº¿è§£å†³æ—¶é—´é™åˆ¶çš„æ–¹æ¡ˆ <img src="/em/yun.gif" alt="æ™•" /> æ‰€ä»¥è¿˜æ˜¯åœ¨çº¿ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 2e9 + 1;struct _ &#123; long long aa, ab, ba, bb, u; int l, r, id; &#125;;std::vector&lt;_&gt; t(1);std::vector&lt;std::multiset&lt;long long&gt; &gt; aa(1), ab(1), ba(1), bb(1);int tot, cnt;#define lt t[p].l#define rt t[p].rvoid pushup(int p) &#123;    t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;    if (lt) &#123;        t[p].u = t[lt].u;        t[p].aa = t[lt].aa, t[p].ab = t[lt].ab, t[p].ba = t[lt].ba, t[p].bb = t[lt].bb;    &#125;    if (rt) &#123;        t[p].u = std::min(t[p].u, t[rt].u);        t[p].aa = std::min(t[p].aa, t[rt].aa), t[p].ab = std::min(t[p].ab, t[rt].ab), t[p].ba = std::min(t[p].ba, t[rt].ba), t[p].bb = std::min(t[p].bb, t[rt].bb);    &#125;    if (lt &amp;&amp; rt)        t[p].u = std::min(&#123; t[p].u, t[lt].ba + t[rt].aa, t[lt].ab + t[rt].bb &#125;);    return;&#125;int adda(int p, long long l, long long r, int x, int a, int b) &#123;    if (!p)        p = ++tot, t.emplace_back(), t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;    if (l == r) &#123;        if (!t[p].id)            t[p].id = ++cnt, aa.emplace_back(), ab.emplace_back(), ba.emplace_back(), bb.emplace_back();        int id = t[p].id;        aa[id].insert(a), ab[id].insert(b);        t[p].aa = *aa[id].begin(), t[p].ab = *ab[id].begin();        if (!aa[id].empty() &amp;&amp; !ba[id].empty())            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());        else            t[p].u = inf;        return p;    &#125;    long long mid = (l + r) &gt;&gt; 1;    if (x &lt;= mid) &#123;        auto s(adda(lt, l, mid, x, a, b));        lt = s;    &#125;    else &#123;        auto s(adda(rt, mid + 1, r, x, a, b));        rt = s;    &#125;    pushup(p);    return p;&#125;int addb(int p, long long l, long long r, int x, int a, int b) &#123;    if (!p)        p = ++tot, t.emplace_back(), t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;    if (l == r) &#123;        if (!t[p].id)            t[p].id = ++cnt, aa.emplace_back(), ab.emplace_back(), ba.emplace_back(), bb.emplace_back();        int id = t[p].id;        ba[id].insert(a), bb[id].insert(b);        t[p].ba = *ba[id].begin(), t[p].bb = *bb[id].begin();        if (!aa[id].empty() &amp;&amp; !ba[id].empty())            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());        else            t[p].u = inf;        return p;    &#125;    long long mid = (l + r) &gt;&gt; 1;    if (x &lt;= mid) &#123;        auto s(addb(lt, l, mid, x, a, b));        lt = s;    &#125;    else &#123;        auto s(addb(rt, mid + 1, r, x, a, b));        rt = s;    &#125;    pushup(p);    return p;&#125;void dela(int p, long long l, long long r, int x, int a, int b) &#123;    if (l == r) &#123;        int id = t[p].id;        aa[id].erase(aa[id].find(a)), ab[id].erase(ab[id].find(b));        t[p].aa = (aa[id].empty() ? inf : *aa[id].begin());        t[p].ab = (ab[id].empty() ? inf : *ab[id].begin());        if (!aa[id].empty() &amp;&amp; !ba[id].empty())            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());        else            t[p].u = inf;        return;    &#125;    long long mid = (l + r) &gt;&gt; 1;    if (x &lt;= mid)        dela(lt, l, mid, x, a, b);    else        dela(rt, mid + 1, r, x, a, b);    pushup(p);    return;&#125;void delb(int p, long long l, long long r, int x, int a, int b) &#123;    if (l == r) &#123;        int id = t[p].id;        ba[id].erase(ba[id].find(a)), bb[id].erase(bb[id].find(b));        t[p].ba = (ba[id].empty() ? inf : *ba[id].begin());        t[p].bb = (bb[id].empty() ? inf : *bb[id].begin());        if (!aa[id].empty() &amp;&amp; !ba[id].empty())            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());        else            t[p].u = inf;        return;    &#125;    long long mid = (l + r) &gt;&gt; 1;    if (x &lt;= mid)        delb(lt, l, mid, x, a, b);    else        delb(rt, mid + 1, r, x, a, b);    pushup(p);    return;&#125;#undef lt#undef rtint main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    std::freopen(&quot;set.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;set.out&quot;, &quot;w&quot;, stdout);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int q, rt = 0;    std::cin &gt;&gt; q;    for (int i = 1; i &lt;= q; ++i) &#123;        int op, d, a, b;        std::cin &gt;&gt; op &gt;&gt; d &gt;&gt; a &gt;&gt; b;        if (op == 0 &amp;&amp; d == 0)            dela(rt, -inf, inf, a - b, a, b);        else if (op == 0)            delb(rt, -inf, inf, b - a, a, b);        else if (d == 0)            rt = adda(rt, -inf, inf, a - b, a, b);        else            rt = addb(rt, -inf, inf, b - a, a, b);        std::cout &lt;&lt; (t[1].u == inf ? -1 : t[1].u) &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><h3 id="é’è›™é¢˜">é’è›™é¢˜</h3><p><a href="http://222.180.160.110:61235/contest/6010/problem/1" class="uri">http://222.180.160.110:61235/contest/6010/problem/1</a></p><p><em>å…¨ç¨‹éƒ½æ˜¯è¢«ç‰µç€é¼»å­èµ°æã€‚è‡ªå·±çš„å¤§è„‘å®Œå…¨æ²¡æœ‰è¿è½¬æã€‚å¼€æ‘†ï¼</em></p><p>llswï¼šå“å…¶å® <mark>ç¢°åˆ°è¿™ç§åŒºé—´é‡Œé¢æ‰¾åŒºé—´çš„é—®é¢˜çš„è¯ <strong>æ‰«æçº¿</strong> ç®—æ˜¯å¸¸è§æ€è·¯äº†</mark>ã€‚</p><p>æˆ‘ä»¬ä¼šå‘ç°æƒ³åˆ°åŒºé—´ç§ç±»æ•°æˆ‘ä»¬ä¼šæœ‰å‡ ç§æ€è·¯ï¼šé›†åˆå“ˆå¸Œã€å‰é©±åç»§ + äººç±»æ™ºæ…§ã€è«é˜Ÿä¹‹ç±»çš„ã€‚è¿™é“é¢˜æ„Ÿè§‰æ˜¯å¯ä»¥ç”¨é›†åˆå“ˆå¸Œåšçš„ï¼Œä½†æ˜¯çœ‹äº†ä¸€çœ¼åŸé¢˜å‡ºè‡ª Ynoiï¼Œå“ˆå“ˆï¼Œè¿™é“é¢˜æ„Ÿè§‰æ˜¯ä¸èƒ½ç”¨é›†åˆå“ˆå¸Œåšçš„ <img src="/em/ll.gif" alt="æµæ³ª" />ã€‚</p><p>å¤§è‡´æ€è·¯æ˜¯ï¼Œå¯¹äº <span class="math inline">\(i=1\sim n\)</span>ï¼Œä¾æ¬¡è€ƒè™‘ <span class="math inline">\(i\)</span> ä½œä¸ºå³ç«¯ç‚¹çš„æƒ…å†µã€‚çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ª <span class="math inline">\(j\)</span> ä½œä¸ºå·¦ç«¯ç‚¹æ—¶çš„ <span class="math inline">\(i-r_j\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\([j, r_j]\)</span> æ˜¯ä¸ <span class="math inline">\([j,i]\)</span> ç§ç±»ç›¸åŒçš„æœ€å°åŒºé—´ã€‚</p><p>é‚£ä¹ˆè¯¢é—®çš„æ—¶å€™ï¼Œåªéœ€è¦æ‰¾åˆ°æœ€å¤§çš„ <span class="math inline">\(j&#39;\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\([j, r]\)</span> ä¸ <span class="math inline">\([l, r]\)</span> ç§ç±»ç›¸åŒï¼Œæ±‚è§£ <span class="math inline">\([l, j&#39;]\)</span> çš„åŒºé—´å’Œå³å¯ã€‚æ€ä¹ˆæ‰¾åˆ° <span class="math inline">\(j&#39;\)</span> å‘¢ï¼Ÿè¿™é‡Œå°±ç”¨åˆ°äº†å‰é©±åç»§ + äººç±»æ™ºæ…§æ³•ã€‚åˆå§‹æ¯ä¸ª <span class="math inline">\(l\)</span> å¯¹åº”çš„ <span class="math inline">\(j&#39;\)</span> å°±æ˜¯è‡ªå·±ï¼Œè‹¥åŠ å…¥äº†ä¸€ä¸ªä¸ <span class="math inline">\(l\)</span> ç›¸åŒçš„æ–°å…ƒç´ ï¼Œé‚£ä¹ˆ <span class="math inline">\(l\)</span> å°±ä¸å†æœ‰è´¡çŒ®ï¼Œæ­¤æ—¶ <span class="math inline">\(l\)</span> çš„ <span class="math inline">\(j&#39;\)</span> å°±ä¼šç»§æ‰¿ <span class="math inline">\(l+1\)</span> çš„ <span class="math inline">\(j&#39;\)</span>ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”¨å¹¶æŸ¥é›†å³å¯ç®€å•ç»´æŠ¤ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int lim = 2e6;const int maxn = 2e6 + 5;const int maxm = 5e7 + 5;const int inf = 0x3f3f3f3f;struct &#123; int l, r, u, d; &#125; t[maxn &lt;&lt; 2];int tot;#define lt (p &lt;&lt; 1)#define rt (lt | 1)void pushdown(int p) &#123;    if (~t[p].d) &#123;        t[lt].d = t[rt].d = t[p].d;        t[lt].u = t[p].d - t[lt].r + 1;        t[rt].u = t[p].d - t[rt].r + 1;        t[p].d = -1;    &#125;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r, t[p].d = -1;    if (l == r)        return;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    return;&#125;void upd(int p, int l, int r, int v) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        t[p].d = v, t[p].u = v - t[p].r + 1;        return;    &#125;    pushdown(p);    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (l &lt;= mid)        upd(lt, l, r, v);    if (r &gt; mid)        upd(rt, l, r, v);    t[p].u = std::min(t[lt].u, t[rt].u);    return;&#125;int ask(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p].u;    pushdown(p);    int mid = (t[p].l + t[p].r) &gt;&gt; 1, res = inf;    if (l &lt;= mid)        res = ask(lt, l, r);    if (r &gt; mid)        res = std::min(res, ask(rt, l, r));    return res;&#125;#undef lt#undef rtint main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, q;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1), la(lim + 1), pre(n + 1), f(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        pre[i] = la[a[i]], la[a[i]] = i, f[i] = i;    &#125;    std::cin &gt;&gt; q;    std::vector&lt;int&gt; res(q + 1);    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; t(n + 1);    for (int i = 1, l, r; i &lt;= q; ++i) &#123;        std::cin &gt;&gt; l &gt;&gt; r;        t[r].emplace_back(l, i);    &#125;    bld(1, 1, n);    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;        return x == f[x] ? x : f[x] = find(f[x]);    &#125;;    auto merge = [&amp;](int x, int y) &#123;        x = find(x), y = find(y);        f[std::min(x, y)] = std::max(x, y);        return;    &#125;;    for (int r = 1; r &lt;= n; ++r) &#123;        if (pre[r])            merge(pre[r], pre[r] + 1);        upd(1, pre[r] + 1, r, r);        for (auto [l, i] : t[r])            res[i] = ask(1, l, find(l));    &#125;    for (int i = 1; i &lt;= q; ++i)        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ ç¬”è®°ï¼šåç¼€æ•°ç»„</title>
      <link href="/20250202/"/>
      <url>/20250202/</url>
      
        <content type="html"><![CDATA[<p>éå¸¸åçŸ¥åè§‰åœ°æ„è¯†åˆ° SA(Suffix Array) å’Œ SAM(Suffix Automaton) çš„ A ä¸æ˜¯åŒä¸€ä¸ª A <img src="/em/fad.gif" /></p><span id="more"></span><hr /><h2 id="å®šä¹‰">å®šä¹‰</h2><p>æ˜¾è€Œæ˜“è§ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„å­—ç¬¦ä¸²ä¸­æœ‰ <span class="math inline">\(n\)</span> ä¸ªé•¿åº¦åˆ†åˆ«ä¸º <span class="math inline">\(1\sim n\)</span> çš„åç¼€ï¼Œå¦‚æœæˆ‘ä»¬å¯¹å…¶æŒ‰å­—å…¸åºæ’åºï¼Œåˆ†åˆ«å­˜å‚¨ä¸‹æ’å <span class="math inline">\(i\)</span> çš„åç¼€ <span class="math inline">\(sa_i\)</span> å’Œæ¯ä¸ªåç¼€ <span class="math inline">\(i\)</span> çš„æ’å <span class="math inline">\(rk_i\)</span>ã€‚è™½ç„¶çœ‹ç€æŒºæ²¡å¤´æ²¡å°¾çš„ï¼Œä½†æ˜¯å¾ˆæœ‰ç”¨ã€‚</p><h2 id="æ±‚è§£">æ±‚è§£</h2><h3 id="å“ˆå¸Œ-æ’åº">å“ˆå¸Œ + æ’åº</h3><p>ç›´æ¥æŠŠæ‰€æœ‰åç¼€æ‹¿æ¥æ’åºçš„è¯ï¼Œå­—ç¬¦ä¸²æ¯”è¾ƒæ˜¯ <span class="math inline">\(O(n)\)</span> çš„ã€‚å¦‚æœæˆ‘ä»¬ç”¨å“ˆå¸Œ + äºŒåˆ†ä¼˜åŒ–æ¯”è¾ƒè¿‡ç¨‹ï¼Œå°±å¯ä»¥æŠŠæ•´ä¸ªæ’åºä¼˜åŒ–åˆ° <span class="math inline">\(O(n\log^2 n)\)</span>ã€‚</p><h3 id="å€å¢">å€å¢</h3><p>å…ˆå¯¹æ‰€æœ‰åç¼€æŒ‰ <strong>ç¬¬ä¸€ä¸ªå­—ç¬¦</strong> æ’åºï¼Œè®°æ’åºåæ’ååºåˆ—ä¸º <span class="math inline">\(a\)</span>ã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆæŒ‰ <strong>å‰ä¸¤ä¸ªå­—ç¬¦</strong> æ’åºå‘¢ï¼Ÿå¯¹äºç¬¬ <span class="math inline">\(i\)</span> ç»„å­—ç¬¦ï¼Œæˆ‘ä»¬ç”¨ <span class="math inline">\((a_i,a_{i+1})\)</span> åŒå…³é”®å­—æ’åºå³å¯ã€‚è®°æ­¤æ—¶æ’ååºåˆ—ä¸º <span class="math inline">\(b\)</span>ï¼Œé‚£ä¹ˆå¦‚æœéœ€è¦æŒ‰ç…§å‰å››ä¸ªå­—ç¬¦æ’åºï¼Œç”¨ <span class="math inline">\((b_i,b_{i+2})\)</span> è¿›è¡ŒåŒå…³é”®å­—æ’åºå³å¯ã€‚æ€»å…±éœ€è¦è¿›è¡Œ <span class="math inline">\(\log n\)</span> æ¬¡æ’åºã€‚å¤æ‚åº¦ä¸º <span class="math inline">\(O(n\log^2n)\)</span>ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬æ³¨æ„åˆ°æ’åæ•°ç»„çš„å€¼åŸŸä¸º <span class="math inline">\(n\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”¨æ¡¶æ’å°±èƒ½å°‘ä¸€ä¸ª <span class="math inline">\(\log\)</span>ã€‚</p><h2 id="å®ç°">å®ç°</h2><p>å“ˆå¸Œå¾ˆå¥½å®ç°ï¼Œè¿™é‡Œå°±æŒ‰ä¸‹ä¸è¡¨ï¼Œä¸»è¦è®²è§£å€å¢æ³•çš„å®ç°ã€‚</p><p>æè¿°èµ·æ¥å¾ˆç®€å•ï¼Œå®ç°èµ·æ¥å¾ˆè¦å‘½ã€‚OI wiki ä¸Šçš„å®ç°ç®—æ˜¯ç›¸å¯¹å¥½ç†è§£çš„ï¼š</p><p>é¦–å…ˆäº†è§£åŒå…³é”®å­—æ¡¶æ’çš„æ–¹æ³•ï¼Œé¦–å…ˆç”¨å•å…³é”®å­—æ¡¶æ’å®Œæˆå¯¹ <strong>ç¬¬äºŒå…³é”®å­—</strong> çš„æ’åºï¼›å¯¹äºç¬¬ä¸€å…³é”®å­—ï¼Œä»¤æ¡¶ <span class="math inline">\(i\)</span> è®°å½•å‰ <span class="math inline">\(i\)</span> ä¸ªå…ƒç´ çš„æ•°é‡ï¼›éå†æ’åºåçš„ç¬¬äºŒå…³é”®å­—æ•°ç»„ï¼Œå°†å…ƒç´ æ”¾åˆ°æ¡¶ä¸­è®°å½•æ•°å€¼å¯¹åº”çš„ä¸‹æ ‡ä¸­ï¼Œå¹¶å°†æ¡¶ä¸­æ•°å€¼ <span class="math inline">\(-1\)</span>ã€‚å®é™…ä¸Šæ¡¶ <span class="math inline">\(c\)</span> å……å½“è®¡ç®—ä¸‹æ ‡èŒƒå›´çš„ä½œç”¨ï¼Œ<span class="math inline">\((c_{i-1},c_i]\)</span> å³ä¸º <span class="math inline">\(i\)</span> åˆ†å¸ƒçš„èŒƒå›´ã€‚</p><p>æ˜¾ç„¶ï¼Œå½“ä¸”ä»…å½“æ’åç§ç±»ä¸º <span class="math inline">\(n\)</span>ï¼Œå³æ²¡æœ‰å¹¶åˆ—æ’åæ—¶ï¼Œæ’åºå®Œæˆã€‚è®¾æœ¬è½®åŒºé—´é•¿åº¦ä¸º <span class="math inline">\(w\)</span>ï¼Œå¯¹äºä¸€è½®æ“ä½œï¼š</p><ol type="1"><li>è®¡ç®—æ¯ä¸ªåŒºé—´æŒ‰ååŠæ®µ <span class="math inline">\(\frac w2\)</span> é•¿åº¦å­—ç¬¦æ’åºçš„ç»“æœï¼š<span class="math inline">\((n-w,n]\)</span> å¼€å¤´çš„åŒºé—´ååŠæ®µå‡ä¸ºç©ºï¼Œç›´æ¥æ”¾åœ¨åºåˆ—é¦–ç«¯ï¼›æ¥ç€æŒ‰ç…§ä¸Šä¸€è½® <span class="math inline">\(sa\)</span> ç»“æœï¼ŒæŠŠèƒ½å¤Ÿä½œä¸ºååŠæ®µçš„å…ƒç´ ä¾æ¬¡æ”¾å…¥ã€‚</li><li>ä¾ç…§ä¸Šä¸€è½®çš„ <span class="math inline">\(rk\)</span> ä½œä¸ºå‰åŠæ®µæ’åï¼Œè¿›è¡ŒåŒå…³é”®å­—æ¡¶æ’ã€‚</li><li>ä¾ç…§ <span class="math inline">\(sa\)</span> å’Œç¬¬äºŒå…³é”®å­—ï¼ˆå¤„ç†å¹¶åˆ—ï¼‰ï¼Œæ±‚å‡º <span class="math inline">\(rk\)</span>ã€‚</li></ol><details><pre class="cpp"><code>std::vector&lt;int&gt; la(n + 2);std::copy(s.begin(), s.end(), rk.begin());int m = 128;&#123;    std::vector&lt;int&gt; c(m + 1);    for (int i = 1; i &lt;= n; ++i)        ++c[rk[i]];    std::partial_sum(c.begin(), c.end(), c.begin());    for (int i = n; i; --i)        sa[c[rk[i]]--] = i;&#125; for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;    std::vector&lt;int&gt; id(1);    for (int i = n - w + 1; i &lt;= n; ++i)        id.push_back(i);    for (int i = 1; i &lt;= n; ++i)        if (sa[i] &gt; w)            id.push_back(sa[i] - w);    std::vector&lt;int&gt; c(m + 1);    for (int i = 1; i &lt;= n; ++i)        ++c[rk[i]];    std::partial_sum(c.begin(), c.end(), c.begin());    for (int i = n; i; --i)        sa[c[rk[id[i]]]--] = id[i];    p = 0;    std::copy(rk.begin(), rk.end(), la.begin());    for (int i = 1; i &lt;= n; ++i)        if (la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])            rk[sa[i]] = p;        else            rk[sa[i]] = ++p;    if (p == n)        break;&#125;</code></pre></details><hr /><h2 id="çº¯-sa-çš„åº”ç”¨">çº¯ SA çš„åº”ç”¨</h2><h3 id="æœ€å°è¡¨ç¤ºæ³•">æœ€å°è¡¨ç¤ºæ³•</h3><p>æ¨¡æ¿ï¼š<a href="https://www.luogu.com.cn/problem/P1368" class="uri">https://www.luogu.com.cn/problem/P1368</a>ã€‚</p><p>å¯¹äºå¾ªç¯ä½ç§»ç›¸å…³è¦æ±‚ï¼Œé¦–å…ˆè€ƒè™‘å°†å­—ç¬¦ä¸²é‡å¤ä¸€éã€‚</p><p>åœ¨ <span class="math inline">\(ss\)</span> ä¸­æ‰¾åˆ°æ’åç¬¬ä¸€ä¸ª <span class="math inline">\(sa_i\le n\)</span> å³ä¸ºç­”æ¡ˆã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; s(2 * n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; s[i], s[n + i] = s[i];    std::vector&lt;int&gt; sa(2 * n + 1), rk(s);    &#123;        int m = 29;        &#123;            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= 2 * n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = 2 * n; i; --i)                sa[c[rk[i]]--] = i;        &#125;        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;            std::vector&lt;int&gt; id(1);            for (int i = 2 * n - w + 1; i &lt;= 2 * n; ++i)                id.push_back(i);            for (int i = 1; i &lt;= 2 * n; ++i)                if (sa[i] &gt; w)                    id.push_back(sa[i] - w);            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= 2 * n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = 2 * n; i; --i)                sa[c[rk[id[i]]]--] = id[i];            auto la(rk);            p = 0;            for (int i = 1; i &lt;= 2 * n; ++i)                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])                    rk[sa[i]] = p;                else                    rk[sa[i]] = ++p;            if (p == 2 * n)                break;        &#125;    &#125;    for (int i = 1; i &lt;= 2 * n; ++i)        if (sa[i] &lt;= n) &#123;            for (int j = sa[i]; j &lt; n + sa[i]; ++j)                std::cout &lt;&lt; s[j] &lt;&lt; &#39; &#39;;            std::cout &lt;&lt; &#39;\n&#39;;            break;        &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="å­—ç¬¦ä¸²åŒ¹é…">å­—ç¬¦ä¸²åŒ¹é…</h3><p>äºŒåˆ†ï¼Œå¤æ‚åº¦ <span class="math inline">\(O(|S|\log |T|)\)</span>ã€‚æ±‚å‡ºç°æ¬¡æ•°åˆ™äºŒåˆ†å·¦å³è¾¹ç•Œã€‚</p><p>å¤ªéº»çƒ¦äº†ä¸”æ²¡æœ‰å®é™…åº”ç”¨ä»·å€¼ï¼Œä»£ç ç•¥ã€‚</p><hr /><h2 id="height-æ•°ç»„">height æ•°ç»„</h2><p>å®šä¹‰ <span class="math inline">\(h_i=\text {lcp}(sa_i, sa_i-1)\)</span>ï¼Œç‰¹åˆ«åœ°ï¼Œ<span class="math inline">\(h_1=0\)</span>ã€‚</p><blockquote><p>æœ‰å¼•ç†ï¼š<span class="math inline">\(h_{rk_i}\ge h_{rk_{i-1}}-1\)</span>ã€‚</p></blockquote><p>å‡è®¾å·²ç»æ±‚å‡º <span class="math inline">\(h_{rk_{i-1}}\)</span>ï¼Œé‚£ä¹ˆå¯ä»¥ä» <span class="math inline">\(h_{rk_{i-1}}-1\)</span> å‡ºå‘æš´åŠ›çœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯å¦ç›¸ç­‰å¾—åˆ°ç­”æ¡ˆã€‚é‚£ä¹ˆæˆ‘ä»¬ä¼šå‘ç°ä»å‰å¾€å <span class="math inline">\(h\)</span> å€¼æ¯æ¬¡æœ€å¤š <span class="math inline">\(-1\)</span>ï¼Œæ‰€ä»¥å¤æ‚åº¦æ‘Šä¸‹æ¥æ˜¯ <span class="math inline">\(O(n)\)</span> çš„ã€‚</p><p><mark>è®°ä½è®°ä½ä¸€å®šæ˜¯ <span class="math inline">\(rk_{i-1}\)</span> è€Œä¸æ˜¯ä¸‹æ„è¯†çš„ <span class="math inline">\(rk_i-1\)</span>ï¼ï¼ï¼</mark>æ‰€ä»¥ä¸ºäº†ä¿è¯æ±‚è§£é¡ºåºå¾ªç¯æšä¸¾çš„ä¸€å®šæ˜¯ä¸‹æ ‡è€Œéæ’åã€‚ä½†æ˜¯æ³¨æ„å®šä¹‰å´æ˜¯å’Œ <span class="math inline">\(rk_i-1\)</span> çš„ lcpï¼ï¼ï¼æ‰€ä»¥æ±‚ height çš„å†™æ³•æ˜¯ç›¸å¯¹å›ºå®šçš„ï¼Œä¸èƒ½è§‰å¾—å¥½åƒæ˜¯å¯¹çš„å°±éšä¾¿ä¹±æ”¹ã€‚</p><hr /><h2 id="height-æ•°ç»„çš„åº”ç”¨">height æ•°ç»„çš„åº”ç”¨</h2><p>ç›¸å½“äºèƒŒæ¿å­ï¼Œå› ä¸ºåº”ç”¨å¤ªå¤šä¸”å½¢å¼å¤§å¤šå›ºå®šã€‚</p><h3 id="æ±‚ä»»æ„ä¸¤ä¸ªåç¼€çš„-lcp">æ±‚ä»»æ„ä¸¤ä¸ªåç¼€çš„ lcp</h3><p>æ˜“å¾— <span class="math inline">\(\text{lcp}(sa_i, sa_j)=\min\{h_{i+1}, \cdots, h_j\}\)</span>ã€‚<strong>æ•…åº”å°†ä¸€äº›å¤æ‚ lcp é—®é¢˜çš„è§£å†³æ–¹å¼å’Œ RMQ è”ç³»èµ·æ¥</strong>ã€‚</p><hr /><h3 id="å­ä¸²å¤§å°å…³ç³»">å­ä¸²å¤§å°å…³ç³»</h3><p>å³æ¯”è¾ƒ <span class="math inline">\(S_{l_1, r_1}\)</span> å’Œ <span class="math inline">\(S_{l_2, r_2}\)</span> çš„å¤§å°å…³ç³»ã€‚æ¯”è¾ƒå¯¼è‡´ lcp ä¸èƒ½ç»§ç»­å»¶ä¼¸çš„å…ƒç´ å¤§å°å³å¯ã€‚</p><hr /><h3 id="æœ¬è´¨ä¸åŒå­ä¸²æ•°é‡">æœ¬è´¨ä¸åŒå­ä¸²æ•°é‡</h3><p><strong>å­ä¸²ç­‰ä»·äºã€Œåç¼€çš„å‰ç¼€ã€</strong>ã€‚æŒ‰é¡ºåºæšä¸¾æ¯ä¸ªåç¼€ï¼Œå‡å»å’Œå·²æšä¸¾çš„æ‰€æœ‰åç¼€çš„ lcp å³å¯ã€‚é‰´äº <span class="math inline">\(\min\{h_{j+1},\cdots,h_i\}\)</span> å•è°ƒä¸å‡ï¼Œç›´æ¥å‡å» <span class="math inline">\(h_i\)</span> å³å¯ã€‚</p><p>æœ€åç­”æ¡ˆå³ä¸º <span class="math inline">\(\frac {n(n-1)}2 - \sum\limits_{i=2}^nh_i\)</span>ã€‚</p><hr /><h3 id="è‡³å°‘å‡ºç°-k-æ¬¡å­ä¸²çš„æœ€å¤§é•¿åº¦">è‡³å°‘å‡ºç° <span class="math inline">\(k\)</span> æ¬¡å­ä¸²çš„æœ€å¤§é•¿åº¦</h3><p>æ¨¡æ¿ï¼š<a href="https://www.luogu.com.cn/problem/P2852" class="uri">https://www.luogu.com.cn/problem/P2852</a>ã€‚</p><p>å‡ºç° <span class="math inline">\(k\)</span> æ¬¡ <span class="math inline">\(\iff\)</span> åœ¨åç¼€æ•°ç»„ä¸­è¿ç»­å‡ºç° <span class="math inline">\(k\)</span> æ¬¡ <span class="math inline">\(\iff\)</span> æ˜¯ä»»æ„è¿ç»­ <span class="math inline">\(k-1\)</span> ä¸ª <span class="math inline">\(h\)</span> çš„æœ€å°å€¼ï¼Œéœ€è¦æœ€å¤§åŒ–è¯¥æœ€å°å€¼ï¼Œè€ƒè™‘æ»‘åŠ¨çª—å£ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;P2852_7.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k, --k;    std::vector&lt;int&gt; s(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; s[i];    std::vector&lt;int&gt; sa(n + 1), rk(s), h(n + 1);    &#123;        int m = 1000001;        &#123;            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n; i; --i)                sa[c[rk[i]]--] = i;        &#125;        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;            std::vector&lt;int&gt; id(1);            for (int i = n - w + 1; i &lt;= n; ++i)                id.push_back(i);            for (int i = 1; i &lt;= n; ++i)                if (sa[i] &gt; w)                    id.push_back(sa[i] - w);            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n; i; --i)                sa[c[rk[id[i]]]--] = id[i];            auto la(rk);            p = 0;            for (int i = 1; i &lt;= n; ++i)                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])                    rk[sa[i]] = p;                else                    rk[sa[i]] = ++p;            if (p == n)                break;        &#125;        for (int i = 1, to = 0; i &lt;= n; ++i)            if (rk[i]) &#123;                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);                h[rk[i]] = to;            &#125;    &#125;    std::vector&lt;int&gt; q(n + 1);    int res = 0;    for (int i = 1, l = 1, r = 0; i &lt;= n; ++i) &#123;        // printf(&quot;%d\n&quot;, h[i]);        for (; l &lt;= r &amp;&amp; i - q[l] &gt;= k; ++l);        for (; l &lt;= r &amp;&amp; h[i] &lt;= h[q[r]]; --r);        q[++r] = i;        if (i &gt;= k)            res = std::max(res, h[q[l]]);    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="æœ€é•¿ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²">æœ€é•¿ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²</h3><p><del>bbï¼šå®šå¼å¤ªå¤šå¤ªæ‚ä»¥è‡³äºè®©äººæ€€ç–‘æŸäº›å®šå¼æ˜¯å¦å­˜åœ¨åº”ç”¨åœºæ™¯</del> <img src="/em/kt.gif" /></p><p>å‘ç°æ»¡è¶³å•è°ƒæ€§ï¼ŒäºŒåˆ†å­ä¸²é•¿åº¦ <span class="math inline">\(len\)</span>ï¼Œé‚£ä¹ˆæ˜¾ç„¶ <span class="math inline">\(\text {lcp}\ge len\)</span>ï¼›å°† <span class="math inline">\(h\)</span> åˆ’åˆ†ä¸ºè¿ç»­ <span class="math inline">\(\ge len\)</span> çš„æ®µï¼Œåœ¨æ¯æ®µå†…æ‰¾åˆ°ä¸‹æ ‡æå·®ä¸ <span class="math inline">\(len\)</span> æ¯”è¾ƒå³å¯ã€‚</p><p>ä¹Ÿå¯ä»¥ç”¨äºåˆ¤å®šæ˜¯å¦å­˜åœ¨ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²ã€‚</p><p>ç”šè‡³å¯ä»¥è€ƒè™‘é™åˆ¶è‡³å°‘å‡ºç°æ¬¡æ•°ä¸º <span class="math inline">\(k\)</span>ï¼Œé‚£å¤§æ¦‚å¤šä¸ª <span class="math inline">\(\log\)</span>ï¼Œçœ‹çœ‹ä¸€æ®µé‡Œæœ‰æ²¡æœ‰ <span class="math inline">\(\ge k\)</span> ä¸ªç›¸äº’ç›¸å·® <span class="math inline">\(\ge len\)</span> çš„ã€‚æ’åºè´ªå¿ƒæ±‚è§£ã€‚</p><p>é‚£ä¹ˆä¸Šé¢çš„è‡³å°‘å‡ºç° <span class="math inline">\(k\)</span> æ¬¡å­ä¸²ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥è§£ï¼Œä½†æ˜¯å¤šä¸ª <span class="math inline">\(\log\)</span> æ²¡å¿…è¦ã€‚</p><p>ä¹Ÿå¯ä»¥é™åˆ¶å¤šæ¬¡å‡ºç°ä½†é•¿åº¦è‡³å°‘ä¸º <span class="math inline">\(len\)</span>ï¼Œé‚£ç”šè‡³å°‘äº†äºŒåˆ†çš„ <span class="math inline">\(\log\)</span>ï¼Œç›´æ¥è·‘ä¸€é check å³å¯ã€‚</p><p><del>ï¼Ÿï¼Ÿï¼Ÿåˆ°åº•ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤šå¥‡æ€ªçš„å®šå¼ï¼Œæ˜¯å› ä¸ºçœŸçš„æœ‰é¢˜è¿™ä¹ˆå‡ºå—ï¼Ÿï¼Ÿï¼Ÿ</del> <img src="/em/oh.gif" /></p><hr /><h3 id="æœ€é•¿å…¬å…±å­ä¸²é—®é¢˜">æœ€é•¿å…¬å…±å­ä¸²é—®é¢˜</h3><p>æ±‚ <span class="math inline">\(S\)</span> å’Œ <span class="math inline">\(T\)</span> çš„æœ€é•¿å…¬å…±å­ä¸²ï¼ˆæ³¨æ„ä¸æ˜¯ LCSï¼‰ã€‚è®¾ <span class="math inline">\(S\)</span> é•¿ä¸º <span class="math inline">\(n\)</span>ï¼Œ<span class="math inline">\(T\)</span> é•¿ä¸º <span class="math inline">\(m\)</span>ï¼Œé‚£ä¹ˆå°† <span class="math inline">\(S\)</span> ä¸ <span class="math inline">\(T\)</span> æ‹¼æ¥ï¼Œç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(\max \{\text{lcp}(i,j)\},i\le n&lt;j\)</span>ã€‚</p><p>ä½†è¿™é‡Œä¸ç›´æ¥æšä¸¾ <span class="math inline">\(i\)</span> å’Œ <span class="math inline">\(j\)</span>ï¼Œè¿˜æ˜¯ç…§ä¾‹å…ˆä» <span class="math inline">\(h\)</span> ä¸‹æ‰‹å†å¡æ¡ä»¶ï¼Œè‹¥ <span class="math inline">\(sa_{i-1}\le n&lt;sa_{i}\)</span>ï¼ˆæˆ–è€…åè¿‡æ¥ï¼‰ï¼Œå°±å¯ä»¥ç”¨ <span class="math inline">\(h_i\)</span> æ›´æ–°ç­”æ¡ˆã€‚å®¹æ˜“è¯æ˜è¿™æ ·æ€»å¯ä»¥æ‰¾åˆ°æœ€å¤§å€¼ã€‚</p><h4 id="eg1.-æ‰¾ç›¸åŒå­—ç¬¦">eg1. æ‰¾ç›¸åŒå­—ç¬¦</h4><p><a href="https://www.luogu.com.cn/problem/P3181" class="uri">https://www.luogu.com.cn/problem/P3181</a></p><p>è¦æ±‚æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º <span class="math inline">\(\text{lcp}(i,j),i\le n&lt;j\)</span>ã€‚ï¼ˆæˆ‘å·²ç»å¸®ä½ ä»¬è¯•è¿‡äº†å®¹æ–¥æ¯”ç›´æ¥åšæ›´éº»çƒ¦ï¼‰ï¼Œè€ƒè™‘ç”¨å•è°ƒæ ˆç»´æŠ¤å·¦ / å³ä¾§åŒºé—´ lcp æ±‚è§£å³ / å·¦ä¾§ç­”æ¡ˆã€‚å…³äºå•è°ƒæ ˆçš„æè¿°å¯è§ <a href="#ç»“åˆå•è°ƒæ ˆ">æœ¬é¡µåéƒ¨å†…å®¹</a>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, n1;    std::string s, t;    std::cin &gt;&gt; s &gt;&gt; t;    n = (int)s.length(), n1 = n + (int)t.length() + 1;    s = &quot;#&quot; + s + &quot;$&quot; + t;    std::vector&lt;int&gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);    &#123;        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);        int m = 128;        &#123;            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n1; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n1; i; --i)                sa[c[rk[i]]--] = i;        &#125;        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;            std::vector&lt;int&gt; id(w + 1);            std::iota(id.begin() + 1, id.end(), n1 - w + 1);            for (int i = 1; i &lt;= n1; ++i)                if (sa[i] &gt; w)                    id.push_back(sa[i] - w);            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n1; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n1; i; --i)                sa[c[rk[id[i]]]--] = id[i];            p = 0;            auto la(rk);            for (int i = 1; i &lt;= n1; ++i)                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])                    rk[sa[i]] = p;                else                    rk[sa[i]] = ++p;            if (p == n1)                break;        &#125;        for (int i = 1, to = 0; i &lt;= n1; ++i) &#123;            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);            h[rk[i]] = to;        &#125;    &#125;    std::vector&lt;std::pair&lt;int, long long&gt; &gt; q1, q2;    std::vector&lt;int&gt; tot1(n1 + 1), tot2(n1 + 1);    for (int i = 1; i &lt;= n1; ++i) &#123;        tot1[i] = tot1[i - 1] + (sa[i] &lt;= n);        tot2[i] = tot2[i - 1] + (sa[i] &gt; n + 1);    &#125;    long long res = 0ll;    q1.emplace_back(1, 0ll), q2.emplace_back(1, 0ll);    for (int i = 1; i &lt;= n1; ++i) &#123;        for (; !q1.empty() &amp;&amp; h[i] &lt; h[q1.back().first]; q1.pop_back());        q1.emplace_back(i, (tot1[i - 1] - tot1[q1.back().first - 1]) * h[i] + q1.back().second);        if (sa[i] &gt; n + 1)            res += q1.back().second;        for (; !q2.empty() &amp;&amp; h[i] &lt; h[q2.back().first]; q2.pop_back());        q2.emplace_back(i, (tot2[i - 1] - tot2[q2.back().first - 1]) * h[i] + q2.back().second);        if (sa[i] &lt;= n)            res += q2.back().second;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><h4 id="eg2.-å…¬å…±ä¸²">eg2. å…¬å…±ä¸²</h4><p><a href="https://www.luogu.com.cn/problem/P5546" class="uri">https://www.luogu.com.cn/problem/P5546</a></p><p>è¦æ±‚å¤šä¸²æœ€é•¿å…¬å…±å­ä¸²ï¼Œä»ç„¶è€ƒè™‘å°†å¤šä¸ªä¸²æ‹¼åœ¨ä¸€èµ·ã€‚ä»¿ç…§å‰é¢äºŒåˆ†çš„æ–¹å¼å¤„ç†ï¼Œé—®é¢˜è½¬åŒ–ä¸ºæ‰¾åˆ°æœ€é•¿çš„ <span class="math inline">\(len\)</span>ï¼Œä½¿å¾—å­˜åœ¨ä¸€æ®µæœ€å°å€¼ <span class="math inline">\(\ge len\)</span> çš„åŒºé—´ï¼Œå…¶è¦†ç›–äº† <span class="math inline">\(n\)</span> æ®µä¸²ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, l = 0, r = 0;    std::cin &gt;&gt; n;    std::string s;    std::vector&lt;std::pair&lt;int, int&gt; &gt; lim(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::string t;        std::cin &gt;&gt; t;        lim[i] = &#123; (int)s.length() + 1, s.length() + t.length() &#125;;        s += &quot;#&quot; + t;        r = std::max(r, (int)t.length());        // printf(&quot;[%d, %d]\n&quot;, lim[i].first, lim[i].second);    &#125;    int n1 = lim.back().second;    std::vector&lt;int&gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);    &#123;        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);        int m = 128;        &#123;            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n1; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n1; i; --i)                sa[c[rk[i]]--] = i;        &#125;        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;            std::vector&lt;int&gt; id(w + 1);            std::iota(id.begin() + 1, id.end(), n1 - w + 1);            for (int i = 1; i &lt;= n1; ++i)                if (sa[i] &gt; w)                    id.push_back(sa[i] - w);            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n1; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n1; i; --i)                sa[c[rk[id[i]]]--] = id[i];            p = 0;            auto la(rk);            for (int i = 1; i &lt;= n1; ++i)                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])                    rk[sa[i]] = p;                else                    rk[sa[i]] = ++p;            if (p == n1)                break;        &#125;        for (int i = 1, to = 0; i &lt;= n1; ++i) &#123;            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);            h[rk[i]] = to;        &#125;    &#125;    // for (int i = 1; i &lt;= n1; ++i)    //     printf(&quot;h[%d] = %d\n&quot;, sa[i], h[i]);    int res = 0;    auto check = [&amp;](int len) &#123;        // printf(&quot;check %d: \n&quot;, len);        std::vector&lt;int&gt; cnt(n + 1);        for (int i = 1; i &lt;= n1; ++i) &#123;            if (h[i] &lt; len) &#123;                if (*std::min_element(cnt.begin() + 1, cnt.end()))                    return 1;                cnt.assign(n + 1, 0);            &#125;            else                for (int j = 1; j &lt;= n; ++j) &#123;                    if (lim[j].first &lt;= sa[i - 1] &amp;&amp; sa[i - 1] &lt;= lim[j].second)                        cnt[j] = 1;                    if (lim[j].first &lt;= sa[i] &amp;&amp; sa[i] &lt;= lim[j].second)                        cnt[j] = 1;                &#125;        &#125;        // printf(&quot;\n%d\n&quot;, *std::min_element(cnt.begin() + 1, cnt.end()));        return *std::min_element(cnt.begin() + 1, cnt.end());    &#125;;    for (int mid; l &lt;= r; ) &#123;        mid = (l + r) &gt;&gt; 1;        if (check(mid))            l = mid + 1, res = mid;        else            r = mid - 1;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><p>ä½†æ˜¯çœ‹äº†é¢˜è§£å‘ç°å±…ç„¶è¿˜æœ‰çº¿æ€§åšæ³•ï¼ˆå½“ç„¶ä¸çœ‹å»º SA çš„ <span class="math inline">\(\log\)</span>ï¼‰ï¼Œå¯¹äºè¦†ç›–å…¨éƒ¨ <span class="math inline">\(n\)</span> æ®µä¸²æ‰¾åŒºé—´æœ€å°å€¼ï¼Œå‘ç°éœ€è¦æœ€å°åŒ–åŒºé—´ï¼Œè€ƒè™‘åŒæŒ‡é’ˆã€‚</p><p>åŒºé—´æœ€å°å€¼ç”¨å•è°ƒé˜Ÿåˆ—æ±‚è§£ï¼Œç»†æƒ³å¯èƒ½ä¼šè§‰å¾—ä¸å¤ªå¯¹åŠ²ï¼Œä½†æ˜¯å®¹æ˜“è¯æ˜ç­”æ¡ˆä¸å¤§äºé˜Ÿé¦–ä¸”ä¸å°äºæœ€å¤§é˜Ÿé¦–ï¼Œæ‰€ä»¥æœ€å¤§é˜Ÿé¦–å°±æ˜¯ç­”æ¡ˆã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, l = 0, r = 0;    std::cin &gt;&gt; n;    std::string s;    std::vector&lt;std::pair&lt;int, int&gt; &gt; lim(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::string t;        std::cin &gt;&gt; t;        lim[i] = &#123; (int)s.length() + 1, s.length() + t.length() &#125;;        s += (char)(&#39;A&#39; + i - 1) + t;        r = std::max(r, (int)t.length());    &#125;    int n1 = lim.back().second;    std::vector&lt;int&gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);    &#123;        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);        int m = 128;        &#123;            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n1; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n1; i; --i)                sa[c[rk[i]]--] = i;        &#125;        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;            std::vector&lt;int&gt; id(w + 1);            std::iota(id.begin() + 1, id.end(), n1 - w + 1);            for (int i = 1; i &lt;= n1; ++i)                if (sa[i] &gt; w)                    id.push_back(sa[i] - w);            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n1; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n1; i; --i)                sa[c[rk[id[i]]]--] = id[i];            p = 0;            auto la(rk);            for (int i = 1; i &lt;= n1; ++i)                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])                    rk[sa[i]] = p;                else                    rk[sa[i]] = ++p;            if (p == n1)                break;        &#125;        for (int i = 1, to = 0; i &lt;= n1; ++i) &#123;            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);            h[rk[i]] = to;        &#125;    &#125;    int res = 0;    std::vector&lt;int&gt; q(n1 + 1), cnt(n + 1);    // for (int i = 1; i &lt;= n1; ++i)    //     printf(&quot;%d: %d\n&quot;, sa[i], h[i]);    for (int l = 1, r = 0, ql = 1, qr = 0; l &lt;= n1; ++l) &#123;        for (; r &lt; n1 &amp;&amp; !*std::min_element(cnt.begin() + 1, cnt.end()); ) &#123;            ++r;            for (int i = 1; i &lt;= n; ++i)                if (lim[i].first &lt;= sa[r] &amp;&amp; sa[r] &lt;= lim[i].second) &#123;                    ++cnt[i];                    break;                &#125;            for (; ql &lt;= qr &amp;&amp; h[r] &lt;= h[q[qr]]; --qr);            q[++qr] = r;        &#125;        if (*std::min_element(cnt.begin() + 1, cnt.end())) &#123;            // printf(&quot;[%d, %d]: %d\n&quot;, l, r, h[q[ql]]);            res = std::max(res, h[q[ql]]);        &#125;        for (; ql &lt;= qr &amp;&amp; q[ql] &lt;= l; ++ql);        if (l != 1) &#123;            for (int i = 1; i &lt;= n; ++i)                if (lim[i].first &lt;= sa[l - 1] &amp;&amp; sa[l - 1] &lt;= lim[i].second) &#123;                    --cnt[i];                    break;                &#125;        &#125;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="texttt-aa-å¼å­ä¸²å¤„ç†"><span class="math inline">\(\texttt {AA}\)</span> å¼å­ä¸²å¤„ç†</h3><p>å³å¯¹äºè¿ç»­ç›¸åŒå­ä¸²é—®é¢˜çš„å¤„ç†ï¼Œæœ‰ä¸€ä¸ªå®šçš„æ€è·¯ï¼Œç”±ä¾‹é¢˜åˆ†æã€‚</p><h4 id="eg1.-ä¼˜ç§€çš„æ‹†åˆ†">eg1. ä¼˜ç§€çš„æ‹†åˆ†</h4><p><a href="https://www.luogu.com.cn/problem/P1117" class="uri">https://www.luogu.com.cn/problem/P1117</a></p><p>è¿˜æ˜¯ä»ä¸­é—´åˆ†å¼€ï¼ŒæŒ‰å‰ååˆ†åˆ«å¤„ç†ã€‚è¿™é‡Œæœ‰ä¸ª trickï¼Œæˆ‘ä»¬æšä¸¾ <span class="math inline">\(\texttt B\)</span> çš„é•¿åº¦ <span class="math inline">\(len\)</span>ï¼Œåœ¨ <span class="math inline">\(S\)</span> ä¸­æ¯éš” <span class="math inline">\(len\)</span> æ‰“ä¸€ä¸ªæ ‡è®°ã€‚é‚£ä¹ˆæ˜¾ç„¶ï¼Œä»»æ„ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(2\times len\)</span> çš„å­ä¸²éƒ½ä¼šç»è¿‡æ°å¥½ä¸¤ä¸ªæ ‡è®°ï¼ˆå……åˆ†çš„ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ç­›é€‰å‡ºæ‰€æœ‰å¯èƒ½çš„ä¸²ã€‚</p><p>æˆ‘ä»¬æšä¸¾æ‰€æœ‰è¿ç»­ä¸¤ä¸ªæ ‡è®°ï¼ˆæ€»å¤æ‚åº¦ä¸ºè°ƒå’Œçº§æ•°ï¼‰ï¼Œæ±‚å®ƒä»¬å¯¹åº”åç¼€çš„ lcp å’Œå¯¹åº”å‰ç¼€çš„ lcsï¼ˆç¿»è½¬æ±‚ SA å³å¯ï¼‰ï¼Œå¦‚æœäºŒè€…åŠ èµ·æ¥ <span class="math inline">\(\ge len\)</span> å°±è¯´æ˜å­˜åœ¨è¿™æ ·çš„ <span class="math inline">\(\texttt {AA}\)</span>ã€‚åœ¨ <span class="math inline">\(\text {lcs}+\text {lcp}\)</span> ä¸­ä»»å– <span class="math inline">\(len\)</span> é•¿åº¦å³ä¸ºä¸€å¯¹ <span class="math inline">\(\texttt {AA}\)</span>ã€‚ç”¨å·®åˆ†ç»™å¯èƒ½çš„èµ·ç‚¹å’Œç»ˆç‚¹åŒºé—´åŠ å³å¯ã€‚</p><p>å°ç»†èŠ‚ï¼šlcp å’Œ lcs å‡éœ€è¦å¯¹ <span class="math inline">\(len\)</span> å– <span class="math inline">\(\min\)</span>ï¼Œå¦åˆ™å–åˆ°çš„ä¸²å¯èƒ½ä¸ä¼šç»è¿‡å½“å‰é€‰ä¸­çš„ä¸¤ä¸ªæ ‡è®°ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;class SA &#123;public:    std::vector&lt;int&gt; sa, rk, h;    std::vector&lt;std::vector&lt;int&gt;  &gt; st;    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&lt;int&gt; (n + 1)) &#123;        std::vector&lt;int&gt; la(n + 2);        std::copy(s.begin(), s.end(), rk.begin());        int m = 128;        &#123;            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n; i; --i)                sa[c[rk[i]]--] = i;        &#125;        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;            std::vector&lt;int&gt; id(1);            for (int i = n - w + 1; i &lt;= n; ++i)                id.push_back(i);            for (int i = 1; i &lt;= n; ++i)                if (sa[i] &gt; w)                    id.push_back(sa[i] - w);            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n; i; --i)                sa[c[rk[id[i]]]--] = id[i];            p = 0;            std::copy(rk.begin(), rk.end(), la.begin());            for (int i = 1; i &lt;= n; ++i)                if (la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])                    rk[sa[i]] = p;                else                    rk[sa[i]] = ++p;            if (p == n)                break;        &#125;        for (int i = 1, to = 0; i &lt;= n; ++i)            if (rk[i]) &#123;                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);                h[rk[i]] = to;            &#125;        for (int i = 1; i &lt;= n; ++i)            st[0][i] = h[i];        for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)            for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);        rk.emplace_back();        return;    &#125;private:    int ask(int l, int r) &#123;        // fprintf(stderr, &quot;l = %d, r = %d\n&quot;, l, r);        int k = std::__lg(r - l + 1);        return std::min(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);    &#125;public:    int lcp(int l, int r) &#123;        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));    &#125;&#125;;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        std::string s;        std::cin &gt;&gt; s;        int n = (int)s.length();        s = &quot;#&quot; + s;        SA p(n, s);        std::reverse(s.begin() + 1, s.end());        SA q(n, s);        std::vector&lt;int&gt; f(n + 2), g(n + 2);        for (int len = 1; len &lt;= n / 2; ++len)            for (int i = len; i + len &lt;= n; i += len) &#123;                int l = i, r = i + len, lcp = std::min(len, p.lcp(l, r)), lcs = std::min(len - 1, q.lcp(n - l + 2, n - r + 2));                if (lcp + lcs &gt;= len) &#123;                    int t = lcp + lcs - len + 1;                    // fprintf(stderr, &quot;(%d, %d), %d, %d\n&quot;, l, r, lcp, lcs);                    ++g[l - lcs], --g[l - lcs + t], ++f[r + lcp - t], --f[r + lcp];                &#125;            &#125;        std::partial_sum(f.begin(), f.end(), f.begin());        std::partial_sum(g.begin(), g.end(), g.begin());        long long res = 0ll;        for (int i = 1; i &lt; n; ++i)            res += (long long)f[i] * g[i + 1];        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h4 id="eg2.-tandem">eg2. tandem</h4><p><a href="https://www.codechef.com/problems/TANDEM" class="uri">https://www.codechef.com/problems/TANDEM</a></p><p>æ³¨æ„åˆ°å¤šäº†ä¸€ä¸ªé™åˆ¶ï¼Œå‰ä¸€ä¸ªå¥½å¤„ç†ï¼Œæ‰¾åˆ°ç»è¿‡ <span class="math inline">\(3\)</span> ä¸ªæ ‡è®°çš„ä¸²å³å¯ã€‚å¯¹äºåä¸€ä¸ªé™åˆ¶ï¼Œç”»å›¾å¯ä»¥å‘ç°å¯¹äº interesting onesï¼Œæ¯æ¬¡åªä¼šå‡ºç°æœ€å¤šä¸€ä¸ªï¼›å½“ä¸”ä»…å½“ <span class="math inline">\(\text {lcp}&gt;len\)</span> æ—¶ä¸å­˜åœ¨ã€‚</p><p>å¯¹äº uninteresting onesï¼Œç”¨æ¯æ¬¡èƒ½æä¾›çš„æ€»æ•°å‡å» interesting ones çš„æ•°é‡å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;class SA &#123;public:    std::vector&lt;int&gt; sa, rk, h;    std::vector&lt;std::vector&lt;int&gt;  &gt; st;    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&lt;int&gt; (n + 1)) &#123;        std::vector&lt;int&gt; la(n + 2);        std::copy(s.begin(), s.end(), rk.begin());        int m = 128;        &#123;            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n; i; --i)                sa[c[rk[i]]--] = i;        &#125;        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;            std::vector&lt;int&gt; id(1);            for (int i = n - w + 1; i &lt;= n; ++i)                id.push_back(i);            for (int i = 1; i &lt;= n; ++i)                if (sa[i] &gt; w)                    id.push_back(sa[i] - w);            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n; i; --i)                sa[c[rk[id[i]]]--] = id[i];            p = 0;            std::copy(rk.begin(), rk.end(), la.begin());            for (int i = 1; i &lt;= n; ++i)                if (la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])                    rk[sa[i]] = p;                else                    rk[sa[i]] = ++p;            if (p == n)                break;        &#125;        for (int i = 1, to = 0; i &lt;= n; ++i)            if (rk[i]) &#123;                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);                h[rk[i]] = to;            &#125;        for (int i = 1; i &lt;= n; ++i)            st[0][i] = h[i];        for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)            for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);        rk.emplace_back();        return;    &#125;private:    int ask(int l, int r) &#123;        // fprintf(stderr, &quot;l = %d, r = %d\n&quot;, l, r);        int k = std::__lg(r - l + 1);        return std::min(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);    &#125;public:    int lcp(int l, int r) &#123;        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));    &#125;&#125;;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    std::string s;    std::cin &gt;&gt; s;    int n = (int)s.length();    s = &quot;#&quot; + s;    SA p(n, s);    std::reverse(s.begin() + 1, s.end());    SA q(n, s);    std::reverse(s.begin() + 1, s.end());    long long res1 = 0ll, res2 = 0ll;    for (int len = 1; len &lt;= n; ++len)        for (int i = len, j = 2 * len, k = 3 * len; k &lt;= n; i += len, j += len, k += len) &#123;            int lcp = std::min(p.lcp(i, j), p.lcp(j, k)), lcs = std::min(&#123; len - 1, q.lcp(n - i + 2, n - j + 2), q.lcp(n - j + 2, n - k + 2) &#125;);            if (std::min(len, lcp) + lcs &gt;= len) &#123;                // printf(&quot;(%d, %d, %d), %d, %d, %d\n&quot;, i, j, k, lcs, lcp, len);                int t = (lcp &lt;= len);                res1 += t, res2 += std::min(len, lcp) + lcs - len + 1 - t;            &#125;            // else            //     printf(&quot;# (%d, %d, %d), %d, %d, %d\n&quot;, i, j, k, lcs, lcp, len);        &#125;    std::cout &lt;&lt; res1 &lt;&lt; &#39; &#39; &lt;&lt; res2 &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h4 id="eg3.-repeats">eg3. repeats</h4><p><a href="https://www.spoj.com/problems/REPEATS/" class="uri">https://www.spoj.com/problems/REPEATS/</a></p><p>é‡å¤æ¬¡æ•°æœ€å¤šï¼Œåªéœ€ç»è¿‡æ ‡è®°ç‚¹æœ€å¤šã€‚æ˜¾ç„¶ç»è¿‡æ ‡è®°ç‚¹çš„æ•°é‡å°±æ˜¯è¯¥å­—ç¬¦ä¸²é•¿é™¤ä»¥ <span class="math inline">\(len\)</span> å‘ä¸‹å–æ•´å°±å¯ä»¥å¾—åˆ°é‡å¤æ¬¡æ•°å‡ <span class="math inline">\(1\)</span> çš„å€¼ã€‚</p><p>é€‰æ‹©ä¸¤ä¸ªè¿ç»­æ ‡è®°ç‚¹ï¼Œå¯¹äº lcp å’Œ lcsï¼ˆæ˜¾ç„¶æ­¤æ—¶ä¸éœ€è¦å¯¹ <span class="math inline">\(len\)</span> å– <span class="math inline">\(\min\)</span>ï¼‰ï¼Œè®¡ç®— <span class="math inline">\(\dfrac {\text{lcp}+\text{lcs}}{len}+1\)</span> å–æœ€å¤§å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;class SA &#123;public:    std::vector&lt;int&gt; sa, rk, h;    std::vector&lt;std::vector&lt;int&gt;  &gt; st;    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&lt;int&gt; (n + 1)) &#123;        std::vector&lt;int&gt; la(n + 2);        std::copy(s.begin(), s.end(), rk.begin());        int m = 128;        &#123;            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n; i; --i)                sa[c[rk[i]]--] = i;        &#125;        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;            std::vector&lt;int&gt; id(1);            for (int i = n - w + 1; i &lt;= n; ++i)                id.push_back(i);            for (int i = 1; i &lt;= n; ++i)                if (sa[i] &gt; w)                    id.push_back(sa[i] - w);            std::vector&lt;int&gt; c(m + 1);            for (int i = 1; i &lt;= n; ++i)                ++c[rk[i]];            std::partial_sum(c.begin(), c.end(), c.begin());            for (int i = n; i; --i)                sa[c[rk[id[i]]]--] = id[i];            p = 0;            std::copy(rk.begin(), rk.end(), la.begin());            for (int i = 1; i &lt;= n; ++i)                if (la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])                    rk[sa[i]] = p;                else                    rk[sa[i]] = ++p;            if (p == n)                break;        &#125;        for (int i = 1, to = 0; i &lt;= n; ++i)            if (rk[i]) &#123;                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);                h[rk[i]] = to;            &#125;        for (int i = 1; i &lt;= n; ++i)            st[0][i] = h[i];        for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)            for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);        rk.emplace_back();        return;    &#125;private:    int ask(int l, int r) &#123;        // fprintf(stderr, &quot;l = %d, r = %d\n&quot;, l, r);        int k = std::__lg(r - l + 1);        return std::min(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);    &#125;public:    int lcp(int l, int r) &#123;        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));    &#125;&#125;;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n;        std::cin &gt;&gt; n;        std::string s = &quot;#&quot;;        for (int i = 1; i &lt;= n; ++i) &#123;            char t;            std::cin &gt;&gt; t;            s.push_back(t);        &#125;        SA p(n, s);        std::reverse(s.begin() + 1, s.end());        SA q(n, s);        int res = 0;        for (int len = 1; len &lt;= n; ++len)            for (int i = len, j = 2 * len; j &lt;= n; i += len, j += len) &#123;                int lcp = p.lcp(i, j), lcs = q.lcp(n - i + 2, n - j + 2);                if (lcp + lcs &gt;= len)                    res = std::max(res, (lcp + lcs) / len + 1);            &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="ç»“åˆå¹¶æŸ¥é›†">ç»“åˆå¹¶æŸ¥é›†</h3><hr /><h3 id="ç»“åˆå•è°ƒæ ˆ">ç»“åˆå•è°ƒæ ˆ</h3>]]></content>
      
      
      
        <tags>
            
            <tag> å­—ç¬¦ä¸² </tag>
            
            <tag> SA </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œæµ</title>
      <link href="/20250124/"/>
      <url>/20250124/</url>
      
        <content type="html"><![CDATA[<p>æƒ³å½“å¹´å±è¯§é£äº‘å·¦ç‰µå­—ç¬¦ä¸²å³æ“ç½‘ç»œæµï¼Œè€Œä»Šé£˜é›¶æ†”æ‚´æ²¦è½åˆ°éœ€è¦å­¦è€Œæ—¶ä¹ ä¹‹çš„åœ°æ­¥ <img src="/em/kx.gif" /></p><span id="more"></span><hr /><h2 id="å®šä¹‰">å®šä¹‰</h2><p>å¯¹äºæœ‰ä¸€ä¸ªæºç‚¹ <span class="math inline">\(s\)</span> å’Œæ±‡ç‚¹ <span class="math inline">\(t\)</span> çš„æœ‰å‘å›¾ï¼Œæ¯æ¡è¾¹éƒ½æœ‰ä¸€ä¸ªæƒå€¼ <span class="math inline">\(c\)</span> ä½œä¸ºå®¹é‡ï¼Œç§°è¿™ä¸ªæœ‰å‘å›¾ <span class="math inline">\(G\)</span> æ˜¯ä¸€ä¸ªç½‘ç»œã€‚</p><p>å‡è®¾ç°åœ¨æœ‰ <span class="math inline">\(f\)</span> å‡æ°´ä» <span class="math inline">\(s\)</span> æµå…¥ï¼Œè€Œæˆ‘ä»¬å¯ä»¥è‡ªç”±åˆ†é…æ¯ä¸ªç‚¹çš„æ°´å¯ä»¥æœå“ªä¸ªæ–¹å‘æµå‡ºï¼Œé‚£ä¹ˆæ˜¾ç„¶åœ°ï¼š</p><ul><li>æµå‡º <span class="math inline">\(t\)</span> çš„æ°´ä¸º <span class="math inline">\(f\)</span> å‡ã€‚</li><li>å¯¹äºé™¤ <span class="math inline">\(s\)</span> å’Œ <span class="math inline">\(t\)</span> ä»¥å¤–çš„æ‰€æœ‰ç‚¹ï¼Œæµå…¥çš„æ°´é‡ç­‰äºæµå‡ºçš„æ°´é‡ã€‚</li><li>å¯¹äºä»»æ„ä¸€æ¡è¾¹ï¼Œæµç»çš„æ°´é‡ä¸è¶…è¿‡å®¹é‡ã€‚</li></ul><p>å¯¹äºè¿™ä¸ªç½‘ç»œï¼Œä»»é€‰å‡ºä¸€éƒ¨åˆ†ç‚¹ä¸ <span class="math inline">\(s\)</span> åˆ†ä¸ºä¸€ç»„ï¼Œå‰©ä¸‹ä¸ <span class="math inline">\(t\)</span> åˆ†ä¸ºä¸€ç»„ï¼Œè¯¥æ“ä½œç§°ä¸ºã€Œå‰²ã€ã€‚ä¸€ä¸ªå‰²çš„ã€Œå®¹é‡ã€å®šä¹‰ä¸º <span class="math inline">\(s\)</span> ç»„ä¸ <span class="math inline">\(t\)</span> ç»„é—´è¿è¾¹çš„å®¹é‡å’Œã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±ä¼šç”±è¿™ä¸ªæ¨¡å‹è¡ç”Ÿå‡ºè®¸å¤šé—®é¢˜ï¼š</p><ul><li>æœ€å¤§æµé—®é¢˜ï¼šæ‰¾åˆ°ä¸€ç§åˆ†é…æ–¹å¼æœ€å¤§åŒ– <span class="math inline">\(f\)</span>ã€‚</li><li>æœ€å°å‰²é—®é¢˜ï¼šæ‰¾åˆ°ä¸€ç§å‰²çš„æ–¹æ¡ˆæœ€å°åŒ–å‰²çš„å®¹é‡ã€‚</li><li>æœ€å°è´¹ç”¨æœ€å¤§æµé—®é¢˜ï¼šç»™æ¯æ¡è¾¹é™¤å®¹é‡ <span class="math inline">\(c\)</span> å¤–å¤–åŠ ä¸€ä¸ªè´¹ç”¨æƒå€¼ <span class="math inline">\(w\)</span>ï¼Œéœ€è¦åœ¨ä¿è¯æœ€å¤§åŒ– <span class="math inline">\(f\)</span> çš„å‰æä¸‹æœ€å°åŒ– <span class="math inline">\(\sum f(u, v)\times w(u, v)\)</span>ã€‚</li></ul><p>æ¥ä¸‹æ¥ä¼šåˆ†åˆ«ä»‹ç»è§£å†³è¿™å‡ ç§ä¸åŒé—®é¢˜çš„æ–¹æ³•ã€‚</p><hr /><h2 id="æœ€å¤§æµé—®é¢˜">æœ€å¤§æµé—®é¢˜</h2><p>ä¸€ä¸ªä¸»è¦çš„æ€æƒ³æ˜¯ <strong>è´ªå¿ƒå¯»æ‰¾å¢å¹¿è·¯æ›´æ–°å½“å‰ç­”æ¡ˆ</strong>ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œæµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æŠ€å·§ï¼šå­—ç¬¦ä¸²æ‹†åˆ†</title>
      <link href="/20250121/"/>
      <url>/20250121/</url>
      
        <content type="html"><![CDATA[<p>ç¥åˆ˜å®¶åœ¨èµ°å‰ä½“è‚²è¯¾ä¸Šé—®æˆ‘å¬æ²¡å¬è¿‡ <em>Die For You - The Weekend</em>ã€‚æˆ‘è®©ä»–å“¼ä¸€æ®µï¼Œåˆ˜å®¶ä¾¿å±•ç¤ºäº†è‡ªå·±çš„å¤©ç±ä¹‹éŸ³ï¼Œæˆ‘ç†æ‰€å½“ç„¶åœ°è¿æ—‹å¾‹éƒ½æ²¡è¾¨è®¤å‡ºæ¥ã€‚</p><span id="more"></span><hr /><p>æœ‰çš„æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªå®Œæ•´çš„åŒ¹é…ä¸²ï¼Œæˆ‘ä»¬éœ€è¦ã€Œæšä¸¾æ–­ç‚¹ã€ï¼Œåˆ†ä¸ºå‰åŠæ®µå’ŒååŠæ®µåˆ†åˆ«å’Œæ¨¡å¼ä¸²åŒ¹é…è§£å†³é—®é¢˜ã€‚å½“ç„¶è¿™æ ·çš„æŠ€å·§ä¸æ­¢å±€é™äºå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„å­¦ä¹ ä¸­åœ¨è¯¸å¦‚åŠ¨æ€è§„åˆ’ç­‰é¢˜ç›®ä¸­é‡åˆ°äº†ç›¸ä¼¼çš„æƒ…æ™¯ã€‚</p><p>åœ¨å­—ç¬¦ä¸²é¢˜ç›®ä¸­ï¼Œä¸€ä¸ªå…¸å‹çš„æ ‡å¿—æ˜¯ã€Œæ¨¡å¼ä¸²çš„æ‹¼æ¥ã€ï¼Œå°†ä¸¤æˆªæ¨¡å¼ä¸²æ‹¼æ¥åˆ°ä¸€èµ·ï¼Œå½¢æˆçš„æ–°æ¨¡å¼ä¸²å¹¶ä¸åˆ©å¥½æˆ‘ä»¬çš„å¤„ç†ï¼Œæˆ‘ä»¬éœ€è¦å°½é‡åˆ©ç”¨å·²çŸ¥çš„æ¨¡å¼ä¸²ã€‚å½“ç„¶æˆ‘ä»¬ä¸ä¼šå°†æ–°æ¨¡å¼ä¸²é‡æ–°æ‹†æˆä¸¤åŠï¼Œè€Œæ˜¯è€ƒè™‘è½¬æ¢ï¼Œæšä¸¾åŒ¹é…ä¸²çš„æ–­ç‚¹ï¼Œå°†å‰åŠæ®µçš„åç¼€å’ŒååŠæ®µçš„å‰ç¼€åˆ†åˆ«åŒ¹é…ã€‚</p><hr /><h2 id="ä¸€ä¸ªæ¨¡æ¿cf1202e-you-are-given-some-strings">ä¸€ä¸ªæ¨¡æ¿ï¼šCF1202E You Are Given Some Stringsâ€¦</h2><p><a href="https://codeforces.com/problemset/problem/1202/E" class="uri">https://codeforces.com/problemset/problem/1202/E</a></p><p>è™½ç„¶å¯¹äºæ¯ç§ä¸åŒæ‹¼æ¥éœ€è¦æ±‚è§£åˆ†åˆ«çš„å‡ºç°æ¬¡æ•°ï¼Œä½†æ˜¯æ³¨æ„åˆ°æœ€ååªéœ€è¦è¾“å‡º <span class="math inline">\(f\)</span> çš„æ€»å’Œï¼Œæ‰€ä»¥å°±å¯ä»¥ä¸å†é¡¾åŠä¸åŒæ‹¼æ¥æ–¹å¼é—´çš„åŒºåˆ«ã€‚</p><p>æšä¸¾åŒ¹é…ä¸²çš„æ–­ç‚¹ã€‚ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•æ˜¯å°†å‰åç¼€ä¸ AC è‡ªåŠ¨æœºåŒ¹é…ï¼Œä½†å¦‚æœé€ä¸ªæ”¾è¿›å»æ˜¾ç„¶å¤æ‚åº¦èµ·é£ã€‚è¿™é‡Œå°±åˆæœ‰ä¸€ä¸ªå®ç°å°æŠ€å·§ï¼Œæˆ‘ä»¬åœ¨åŸä¸²çš„ AC è‡ªåŠ¨æœºä¸ŠæŠŠåŸä¸²è¿‡ä¸€éï¼Œæ¯ä¸ªä½ç½®æ‰€åœ¨çš„çŠ¶æ€å°±æ˜¯è¿™ä¸ªä½ç½®å¯¹åº”åç¼€å¯èƒ½å¤„åœ¨çš„åç¼€ã€‚</p><p>è®°å½•æ¯ä¸ªçŠ¶æ€å¯èƒ½å¤„åœ¨çš„æ¨¡å¼ä¸²æœ«å°¾ä¸ªæ•°ï¼Œè¿™ä¸€ç‚¹ç›´æ¥åœ¨ fail æ ‘ä¸Šä»ä¸Šåˆ°ä¸‹è½¬ç§»å³å¯ã€‚åä¸²åŒç†ã€‚</p><p>äºŒè€…ç›¸ä¹˜å³ä¸ºç­”æ¡ˆã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 2e5 + 5;struct &#123;    int T[maxn][26], tot, cnt[maxn], fail[maxn], deg[maxn];    void ins(std::string &amp;t) &#123;        int p = 0;        for (auto i : t) &#123;            if (!T[p][i - &#39;a&#39;])                T[p][i - &#39;a&#39;] = ++tot;            p = T[p][i - &#39;a&#39;];        &#125;        ++cnt[p];        return;    &#125;    void bld(void) &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt; 26; ++i)            if (T[0][i])                q.push(T[0][i]);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            for (int i = 0; i &lt; 26; ++i)                if (T[u][i]) &#123;                    int v = T[u][i];                    fail[v] = T[fail[u]][i], cnt[v] += cnt[fail[v]];                    q.push(v);                &#125;                else                    T[u][i] = T[fail[u]][i];        &#125;        return;    &#125;&#125; p, q;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    std::string s;    std::cin &gt;&gt; s;    int n;    std::cin &gt;&gt; n;    for (int i = 1; i &lt;= n; ++i) &#123;        std::string t;        std::cin &gt;&gt; t;        p.ins(t);        std::reverse(t.begin(), t.end());        q.ins(t);    &#125;    p.bld(), q.bld();    int len = s.length();    std::vector&lt;std::array&lt;int, 2&gt; &gt; f(len + 1);    &#123;        int u = 0;        for (int i = 1; i &lt;= len; ++i) &#123;            u = p.T[u][s[i - 1] - &#39;a&#39;];            f[i][0] = p.cnt[u];        &#125;    &#125;    &#123;        int u = 0;        for (int i = len; i; --i) &#123;            u = q.T[u][s[i - 1] - &#39;a&#39;];            f[i][1] = q.cnt[u];        &#125;    &#125;    long long res = 0ll;    for (int i = 1; i &lt; len; ++i)        res += (long long)f[i][0] * f[i + 1][1];    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="å˜å¼ä¼˜ç§€çš„æ‹†åˆ†">å˜å¼ï¼šä¼˜ç§€çš„æ‹†åˆ†</h2><p><a href="https://www.luogu.com.cn/problem/P1117" class="uri">https://www.luogu.com.cn/problem/P1117</a></p>]]></content>
      
      
      
        <tags>
            
            <tag> å­—ç¬¦ä¸² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ ç¬”è®°ï¼šAC è‡ªåŠ¨æœº</title>
      <link href="/20250120/"/>
      <url>/20250120/</url>
      
        <content type="html"><![CDATA[<p>è€³æœºå£°éŸ³ç–‘ä¼¼æœ‰ç‚¹å°äº†ï¼Œç”¨å¿ƒæ—·ç¥æ€¡çš„è¯æ¥è¯´å¤§è‡´ä¼šæ˜¯ã€Œæ¯”æœè‡â†‘å—¡å—¡å£°è¿˜å°ã€ã€‚</p><span id="more"></span><p>ï¼Ÿå§æ§½è€³æœºä¸Šå±…ç„¶å¯ä»¥è°ƒéŸ³é‡ <img src="/em/oh.gif" /></p><hr /><h2 id="å‰ç½®çŸ¥è¯†">å‰ç½®çŸ¥è¯†</h2><p>é¦–å…ˆå¯èƒ½éœ€è¦çŸ¥é“ä¸“æœ‰åè¯ã€Œè‡ªåŠ¨æœºã€çš„å«ä¹‰ã€‚</p><p>å¤§è‡´å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œä¸€ä¸ª DAGï¼Œå…¶ä¸­ç‚¹è¡¨ç¤ºçŠ¶æ€ï¼Œè¾¹è¡¨ç¤ºè½¬ç§»ã€‚ç»™è¿›å»ä¸€ä¸ªå­—ç¬¦ä¸²ä¹‹ç±»ï¼Œå°±å¯ä»¥åœ¨ DAG ä¸Šæ¸¸èµ°ï¼Œæ ¹æ®æœ€åæ‰€å¤„ç»“ç‚¹ï¼Œå¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ç›¸å…³ç‰¹å¾ã€‚</p><p>è¿™ä¸ªå®šä¹‰è®©æˆ‘ä»¬æƒ³åˆ°äº† Trieã€‚äº‹å®ä¸Šï¼ŒTrie å°±æ˜¯ä¸€ç§ç›¸å½“åŸºç¡€çš„è‡ªåŠ¨æœºã€‚</p><hr /><p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¤ä¹  KMP ç›¸å…³æ¦‚å¿µã€‚</p><p>å‡æƒ³ä¸€ä¸ªåœºæ™¯ï¼šä½ éœ€è¦æ±‚å¾— <span class="math inline">\(T\)</span> åœ¨ <span class="math inline">\(S\)</span> ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚</p><p>æ‹¥æœ‰ä¸€å®šé¢˜ç›®ç»éªŒçš„ä½ ï¼Œä¼šä½¿ç”¨ KMP æ±‚å‡º <span class="math inline">\(T\)</span> çš„ <code>next</code> æ•°ç»„ï¼Œä»¤ <span class="math inline">\(T\)</span> åœ¨ <span class="math inline">\(S\)</span> ä¸Šè¿›è¡ŒåŒ¹é…ï¼Œå¤±é…æˆ–å®Œå…¨åŒ¹é…æ—¶å›åˆ° <span class="math inline">\(T\)</span> åœ¨è¯¥å¤„çš„ <code>next</code>ï¼Œ<span class="math inline">\(S\)</span> ä¸Šçš„æŒ‡é’ˆå§‹ç»ˆå‘å³ï¼Œ<span class="math inline">\(T\)</span> ä¸Šçš„æŒ‡é’ˆå¦‚æœå‘å³ï¼Œæ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä½ï¼›å¦‚æœå‘å·¦ï¼Œæœ€å·¦ç§»åˆ°å¼€å¤´ï¼Œå‡æ‘Šä¸‹æ¥å¤æ‚åº¦å³ä¸º <span class="math inline">\(O(|S| + |T|)\)</span>ã€‚</p><p>å‡å¦‚åœºæ™¯å˜å¾—æ›´å¤æ‚ï¼šç»™å®š <span class="math inline">\(\{T_m\}\)</span>ï¼Œä½ éœ€è¦æ±‚å‡ºæ¯ä¸ª <span class="math inline">\(T_j\)</span> åœ¨ <span class="math inline">\(S\)</span> ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚</p><p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¯¹æ¯ä¸ª <span class="math inline">\(T_j\)</span> è¿›è¡Œä¸€æ¬¡ KMPï¼Œå¤æ‚åº¦å°†ä¼šä¸Šå‡åˆ° <span class="math inline">\(O(m|S|)\)</span>ï¼Œéš¾ä»¥æ‰¿å—ã€‚æœ‰æ²¡æœ‰ä¼˜åŒ–çš„æ–¹æ³•å‘¢ï¼Ÿ</p><hr /><h2 id="ac-è‡ªåŠ¨æœºçš„å»ºç«‹">AC è‡ªåŠ¨æœºçš„å»ºç«‹</h2><p>ç»“åˆä¸Šé¢çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¸‹æ„è¯†æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½å°† <span class="math inline">\(\{T_m\}\)</span> å»ºæˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œä»¤ <span class="math inline">\(S\)</span> åœ¨å…¶ä¸Šè¿›è¡Œ KMP å‘¢ï¼Ÿ</p><p>å°† <span class="math inline">\(\{T_m\}\)</span> å…¨éƒ¨åŠ å…¥ Trieï¼Œç”±äº <code>next</code> åªä¼šç”±æ›´æ·±çš„ç‚¹æŒ‡å‘æ›´æµ…çš„ç‚¹ï¼Œä¼¼ä¹ä»ç›´è§‰ä¸Šæ˜¯æœ‰è§„åˆ™çš„ã€‚ä½†éšä¹‹è€Œæ¥çš„æ˜¯ä¸€ä¸ªé—®é¢˜ï¼šç‚¹ <span class="math inline">\(u\)</span> çš„ <code>next</code> ä¸ä¸€å®šåœ¨ <span class="math inline">\(\text{root}\to u\)</span> çš„é“¾ä¸Šï¼ˆç”±äº Trie çš„æ€§è´¨ï¼Œå¯çŸ¥æŒ‡å‘çš„ç‚¹æ˜¯å”¯ä¸€çš„ï¼‰ã€‚é‰´äºè¿™ä¸€ç‚¹ä¸åŒï¼Œæˆ‘ä»¬ç»“åˆå…¶ã€Œå¤±é…æŒ‡é’ˆã€çš„å®šä¹‰ï¼Œå°† <code>next</code> åœ¨ Trie ä¸Šçš„åŒåˆ†å¼‚æ„ä½“å”¤ä¸º <code>fail</code>ã€‚</p><p>è€ƒå¯Ÿ Trie ä¸Šè¯¥ <code>fail</code> è¾¹çš„æ€§è´¨ï¼Œå‡è®¾å…¶ä¸º <span class="math inline">\(u\to v\)</span>ï¼Œç»“åˆ KMP ä¸­ <code>next</code> çš„æ€§è´¨ï¼Œå‡è®¾ <span class="math inline">\(u\)</span> çš„çˆ¶èŠ‚ç‚¹ä¸º <span class="math inline">\(u&#39;\)</span>ï¼Œå…¶ <code>fail</code> ä¸º <span class="math inline">\(u&#39;\to v&#39;\)</span>ï¼Œé‚£ä¹ˆæœ‰ï¼š</p><ul><li><span class="math inline">\(v&#39;\)</span> ä¸Šæœ‰è¾¹æƒä¸º <span class="math inline">\(u\)</span> çš„è¾¹ï¼Œ<span class="math inline">\(v\)</span> ä¸ºè¯¥è¾¹å³ç«¯ç»“ç‚¹ã€‚</li><li>å¦åˆ™ï¼Œå‰å¾€ <span class="math inline">\(v&#39;\)</span> çš„ <code>fail</code>ï¼Œé‡å¤ä»¥ä¸Šåˆ¤å®šã€‚</li></ul><p>é‚£ä¹ˆæˆ‘ä»¬å°±å®Œæˆäº†å¤±é…çš„å¤„ç†ã€‚é‚£ä¹ˆç›¸åº”åœ°ï¼Œå®Œå…¨åŒ¹é…æ—¶çš„è·³è½¬åº”å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæˆ‘ä»¬ç›´æ¥æš´åŠ›åœ°å°† <code>fail</code> çš„å„¿å­å…¨éƒ¨æ¥åˆ° <span class="math inline">\(u\)</span> ä¸‹é¢å°±è¡Œäº†ã€‚å¦‚æœ <span class="math inline">\(u\)</span> å’Œ <code>fail</code> å…·æœ‰åŒä¸€æ¡è¾¹å‘¢ï¼Ÿæˆ‘ä»¬é€‰æ‹©ä¿ç•™ <span class="math inline">\(u\)</span> çš„è¿™æ¡è¾¹ <span class="math inline">\(u\to v\)</span>ï¼Œå› ä¸º <span class="math inline">\(v\)</span> çš„ <code>fail</code> å¿…å®šæŒ‡å‘ <span class="math inline">\(u\)</span> çš„ <code>fail</code> çš„å¯¹åº”å„¿å­ã€‚</p><p>ä¸¤ç‚¹ç»“åˆï¼Œæˆ‘ä»¬å‘ç°ä»å®ç°ä¸Šï¼Œå¯ä»¥ç›´æ¥ä»¤ <span class="math inline">\(v\)</span> çš„ <code>fail</code> æŒ‡å‘ <span class="math inline">\(u\)</span> çš„ <code>fail</code> çš„å¯¹åº”å„¿å­ï¼ˆé‚£ä¹ˆæ—¶é—´å¤æ‚åº¦æ˜¾è€Œæ˜“è§æ˜¯ <span class="math inline">\(O(26\sum |T|)\)</span> çš„ï¼‰ã€‚</p><p>åŒ¹é…æ—¶ï¼Œå¯¹äºæ¯ä¸ªç‚¹å’Œå…¶è¿”å›åˆ°æ ¹çš„ <code>fail</code> é“¾ï¼Œå…¨éƒ¨æ ‡è®°ã€‚åˆ™ä¸€ä¸ªæ¨¡å¼ä¸²åŒ¹é…çš„æ¬¡æ•°å³ä¸ºè¢«æ‰“æ ‡è®°çš„æ¬¡æ•°ã€‚</p><hr /><p>é‚£ä¹ˆæ ¹æ®ä¸Šè¿°è¦æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§æ·±åº¦é¡ºåºæ±‚å¾— <code>fail</code>ï¼Œè€ƒè™‘ BFSã€‚</p><details><p>å“¦å“¦å¥½ç¥å¥‡å¤æ´»ä¹‹åè®°å¾—å•¥æ˜¯ KMP ä½†å¿˜äº†å•¥æ˜¯ C++ äº†ã€‚ç”šè‡³èŠ±äº†ä¸€ç‚¹æ—¶é—´å­¦ä¹ æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Ÿï¼Ÿï¼Ÿ</p><p>å¤§å®¶å†™ AC è‡ªåŠ¨æœº Trie æ ¹èŠ‚ç‚¹ä¸‹æ ‡ä¸€å®šè¦è®¾æˆ 0 å•Š <img src="/em/ll.gif" /> è®¾æˆ 1 è¢«å„ç§ç»†èŠ‚å‘æƒ¨äº† <img src="/em/ll.gif" /></p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 2e5 + 5;int T[maxn][26], tot, cnt[maxn], fail[maxn];int ins(std::string &amp;t) &#123;    int p = 0;    for (auto i : t) &#123;        if (!T[p][i - &#39;a&#39;])            T[p][i - &#39;a&#39;] = ++tot;        p = T[p][i - &#39;a&#39;];    &#125;    return p;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; tail(n + 1);    std::vector&lt;std::string&gt; t(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; t[i], tail[i] = ins(t[i]);    &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt; 26; ++i)            if (T[0][i])                q.push(T[0][i]);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            for (int i = 0; i &lt; 26; ++i)                if (T[u][i]) &#123;                    int v = T[u][i];                    fail[v] = T[fail[u]][i];                    q.push(v);                &#125;                else                    T[u][i] = T[fail[u]][i];        &#125;    &#125;    std::string s;    std::cin &gt;&gt; s;    &#123;        int p = 0;        for (auto i : s) &#123;            p = T[p][i - &#39;a&#39;];            for (int fa = p; fa; fa = fail[fa])                ++cnt[fa];        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i)        std::cout &lt;&lt; cnt[tail[i]] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><p>è‚‰çœ¼å¯è§è¯¥æŸ¥è¯¢æ–¹å¼æ˜¯æå…¶ä½æ•ˆçš„ï¼Œæ•…è€ƒè™‘ä¼˜åŒ–è·³ <code>fail</code> æ‰“æ ‡è®°çš„è¿‡ç¨‹ã€‚</p><p>æ—¢ç„¶è‡ªåŠ¨æœºç»“æ„ä¸å˜ï¼Œä¸å¦‚å°†è·³ <code>fail</code> çš„æ­¥éª¤æ”¾åœ¨æœ€åç»Ÿä¸€è¿›è¡Œã€‚å®¹æ˜“åœ¨å‘ç° <code>fail</code> æ ‘ä¸Šè¿›è¡Œæ‹“æ‰‘æ’åºè½¬ç§»å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 2e5 + 5;int T[maxn][26], tot, cnt[maxn], fail[maxn], deg[maxn];int ins(std::string &amp;t) &#123;    int p = 0;    for (auto i : t) &#123;        if (!T[p][i - &#39;a&#39;])            T[p][i - &#39;a&#39;] = ++tot;        p = T[p][i - &#39;a&#39;];    &#125;    return p;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; tail(n + 1);    std::vector&lt;std::string&gt; t(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; t[i], tail[i] = ins(t[i]);    &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt; 26; ++i)            if (T[0][i])                q.push(T[0][i]);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            for (int i = 0; i &lt; 26; ++i)                if (T[u][i]) &#123;                    int v = T[u][i];                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];                    q.push(v);                &#125;                else                    T[u][i] = T[fail[u]][i];        &#125;    &#125;    std::string s;    std::cin &gt;&gt; s;    &#123;        int p = 0;        for (auto i : s)            p = T[p][i - &#39;a&#39;], ++cnt[p];    &#125;    &#123;        std::queue&lt;int&gt; q;        for (int i = 1; i &lt;= tot; ++i)            if (!deg[i])                q.push(i);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            cnt[fail[u]] += cnt[u];            if (!--deg[fail[u]])                q.push(fail[u]);        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i)        std::cout &lt;&lt; cnt[tail[i]] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="ac-è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«">AC è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«</h2><p>æˆ‘ä»¬çŸ¥é“å…¶æœ€å…¸å‹çš„ç‰¹å¾æ˜¯ <strong>å¤šæ¨¡å¼ä¸²</strong>ã€<strong>é™æ€ / ç¦»çº¿</strong>ã€‚å½“ç¢°åˆ°ç±»ä¼¼ç‰¹ç‚¹æ—¶ï¼Œå¤§æ¦‚ç‡å°±æ˜¯ AC è‡ªåŠ¨æœºã€‚</p><p>å…¶ä¸­ï¼Œå¯ä»¥è®¾ç½®çš„éš¾ç‚¹æœ‰ï¼š</p><ol type="1"><li>å­—ç¬¦ä¸²éš¾ç‚¹ï¼Œå’Œå…¶ä»–å­—ç¬¦ä¸²é¢˜å¯è®¾ç½®çš„éš¾ç‚¹ç›¸åŒã€‚</li><li>fail æ ‘ç»´æŠ¤ï¼Œå¯èƒ½ç»“åˆæ•°æ®ç»“æ„ã€æ‹“æ‰‘æ’åºã€æ ‘å½¢ DP ç­‰è€ƒå¯Ÿã€‚</li><li>DP çš„è®¾è®¡ã€‚</li></ol><hr /><h2 id="å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡">å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡</h2><h3 id="eg.-indie-album">eg. Indie Album</h3><p><a href="https://codeforces.com/problemset/problem/1207/G" class="uri">https://codeforces.com/problemset/problem/1207/G</a></p><p>é¢˜ç›®çš„ã€Œå¯æŒä¹…åŒ–ã€è¯•å›¾è¯¯å¯¼æˆ‘ä»¬ç”¨æ“ä½œä¸²å»ºç«‹è‡ªåŠ¨æœºï¼Œä½†è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æ±‚ <span class="math inline">\(t\)</span> çš„å‡ºç°æ¬¡æ•°ã€‚</p><p>ä¸ºäº†ä¿è¯ç­”æ¡ˆå¯æ±‚æˆ‘ä»¬ä»ç„¶åœ¨ <span class="math inline">\(t\)</span> ä¸Šå»ºç«‹ ACAMã€‚å®¹æ˜“å‘ç°æ“ä½œä¸²ä»¥ Trie å½¢å¼ç»™å‡ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éå† Trie æ—¶åŒæ—¶å®Œæˆæ¸¸èµ°ï¼Œé€šè¿‡å›æº¯å®Œæˆè¯¢é—®ã€‚</p><p>å‡è®¾å½“å‰ DFS ä¸­ï¼Œéå†åˆ° Trie æ ‘ä¸­çš„ <span class="math inline">\(x\)</span> ç‚¹å’Œè‡ªåŠ¨æœºä¸­çš„ <span class="math inline">\(u\)</span> çŠ¶æ€ï¼Œé‚£ä¹ˆå¯¹äº <span class="math inline">\(x\)</span> ç‚¹æ‰€å¯¹åº”çš„ä¸€ä¸ªè¯¢é—®ä¸² <span class="math inline">\(t\)</span>ï¼Œç›¸å½“äºè¯¢é—®ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€æœ‰å¤šå°‘ä¸ªåœ¨ <span class="math inline">\(t\)</span> å¼•å¯¼çš„ fail æ ‘å­æ ‘ä¸­ã€‚æˆ‘ä»¬æ±‚å‡º fail æ ‘çš„ dfnï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç®€å•ç»Ÿè®¡å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 4e5 + 5;std::vector&lt;int&gt; g[maxn], q[maxn];int fail[maxn], T[maxn][26], tot, bit[maxn], to[maxn][26], cnt[maxn];int ins(std::string s) &#123;    int p = 0;    for (auto i : s) &#123;        if (!T[p][i - &#39;a&#39;])            T[p][i - &#39;a&#39;] = ++tot;        p = T[p][i - &#39;a&#39;];    &#125;    return p;&#125;int lowbit(int x) &#123;    return x &amp; -x;&#125;void add(int x, int v) &#123;    for (; x &lt;= tot + 1; x += lowbit(x))        bit[x] += v;    return;&#125;int ask(int x) &#123;    int res = 0;    for (; x; x -= lowbit(x))        res += bit[x];    return res;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, now = 0;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; id(n + 1);    for (int i = 1, op; i &lt;= n; ++i) &#123;        char t;        std::cin &gt;&gt; op;        if (op == 1) &#123;            std::cin &gt;&gt; t;            if (!to[0][t - &#39;a&#39;])                to[0][t - &#39;a&#39;] = ++now;            ++cnt[to[0][t - &#39;a&#39;]], id[i] = to[0][t - &#39;a&#39;];        &#125;        else &#123;            int j;             std::cin &gt;&gt; j &gt;&gt; t;            if (!to[id[j]][t - &#39;a&#39;])                to[id[j]][t - &#39;a&#39;] = ++now;            ++cnt[to[id[j]][t - &#39;a&#39;]], id[i] = to[id[j]][t - &#39;a&#39;];        &#125;    &#125;    int m;    std::cin &gt;&gt; m;    std::vector&lt;int&gt; tail(m + 1), res(m + 1);    for (int i = 1, x; i &lt;= m; ++i) &#123;        std::string t;        std::cin &gt;&gt; x &gt;&gt; t, tail[i] = ins(t);        q[id[x]].push_back(i);    &#125;    &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt; 26; ++i)            if (T[0][i])                q.push(T[0][i]), g[0].push_back(T[0][i]);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            for (int i = 0; i &lt; 26; ++i)                if (T[u][i]) &#123;                    int v = T[u][i];                    fail[v] = T[fail[u]][i];                    q.push(v), g[fail[v]].push_back(v);                &#125;                else                    T[u][i] = T[fail[u]][i];        &#125;    &#125;    std::vector&lt;int&gt; dfn(tot + 1), rfn(tot + 1);    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        static int now = 0;        dfn[x] = ++now;        // printf(&quot;%d &quot;, x);        for (auto i : g[x])            DFS(i);        rfn[x] = now;        return;    &#125;;    DFS(0);    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int u) &#123;        add(dfn[u], 1);        for (auto i : q[x])            res[i] += ask(rfn[tail[i]]) - ask(dfn[tail[i]] - 1);        for (int i = 0; i &lt; 26; ++i)            if (to[x][i])                DFS1(to[x][i], T[u][i]);        add(dfn[u], -1);        return;    &#125;;    DFS1(0, 0);    for (int i = 1; i &lt;= m; ++i)        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="fail-æ ‘çš„ç»´æŠ¤">fail æ ‘çš„ç»´æŠ¤</h2><h3 id="eg1.-divljak">eg1. Divljak</h3><p><a href="https://www.luogu.com.cn/problem/P5840" class="uri">https://www.luogu.com.cn/problem/P5840</a></p><h4 id="æ³•ä¸€æŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿">æ³•ä¸€ï¼šæŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿</h4><p>é—®é¢˜ç›¸å½“äºå°†æ¨¡å¼ä¸² <span class="math inline">\(T:\{P\}\)</span> åŠ¨æ€åŒ–ï¼Œä½†æˆ‘ä»¬ä»å¯ä»¥æ— è„‘ç¦»çº¿ä¸‹æ¥è§£å†³é—®é¢˜ã€‚</p><p>è€ƒè™‘åŸæœ¬çš„ç­”æ¡ˆè®¡ç®—è¿‡ç¨‹ï¼Œå³åœ¨ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€åŠå…¶ fail é“¾ä¸Šæ‰“æ ‡è®°ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ç¦»çº¿å¹¶åŒºåˆ†æ ‡è®°çš„æ¥æºï¼ˆå¹¶ä¸”æ ‡è®°ç±»å‹ä¸ºå¸ƒå°”å€¼ï¼‰ï¼Œä¸‹æ„è¯†æƒ³åˆ°ä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚</p><p>æˆ‘ä»¬å¯¹æ¯ä¸ªçŠ¶æ€å»ºç«‹åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œæœ€åæ‹“æ‰‘æ’åºæ—¶ä½¿ç”¨çº¿æ®µæ ‘åˆå¹¶å¤„ç†ä¿¡æ¯ã€‚å®¹æ˜“è¯æ˜æ—¶é—´å¤æ‚åº¦ç›¸è¾ƒåŸæ¥å¤šäº†ä¸€ä¸ª <span class="math inline">\(\log\)</span>ã€‚</p><p><del>ç†è®ºå¯è¡Œï¼Œå¼€å§‹å®è·µ</del> å‡ºé¢˜äººä¼¼ä¹ä¸æ˜¯å¾ˆå–œæ¬¢çº¿æ®µæ ‘é€‰æ‰‹æ‰€ä»¥å†³å®šå‰¥å¤ºä½ çš„ Memory Limitã€‚æƒ³è¦ç”¨è¿™ç§åšæ³•é€šè¿‡æœ¬é¢˜å¯è§ <a href="https://www.luogu.com.cn/article/jaxk3sno" class="uri">https://www.luogu.com.cn/article/jaxk3sno</a>ã€‚</p><h4 id="æ³•äºŒè½¬è€Œå¤„ç†é™æ€é—®é¢˜">æ³•äºŒï¼šè½¬è€Œå¤„ç†é™æ€é—®é¢˜</h4><p>æ³¨æ„åˆ°é¢˜ç›®ä¸­çš„é™æ€çš„ <span class="math inline">\(S_x\)</span> æ¯”èµ· <span class="math inline">\(T:\{P\}\)</span> æ›´é€‚åˆç”¨æ¥åšæ¨¡å¼ä¸²ï¼Œæˆ‘ä»¬åœ¨ <span class="math inline">\(S_x\)</span> ä¸Šæ„å»º AC è‡ªåŠ¨æœºï¼Œè€ƒè™‘åœ¨çº¿è§£å†³é—®é¢˜ã€‚</p><p>åœ¨æ¯æ¬¡ <code>1</code> æ“ä½œæ—¶ï¼Œæ›´æ–°æ¨¡å¼ä¸²ä¿¡æ¯ã€‚å¯¹äºé€”å¾„çš„æ‰€æœ‰çŠ¶æ€ <span class="math inline">\(\{u\}\)</span>ï¼Œè€ƒè™‘æ›´æ–°å…¶æ‰€åœ¨ fail é“¾ä¸Šçš„ä¿¡æ¯ã€‚</p><p>æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦ä¿®æ”¹æ•´æ¡ fail é“¾ä¸Šçš„ä¿¡æ¯ï¼Œè¯¢é—®åˆ™æ˜¯è¯¢é—®å•ç‚¹ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨æ ‘ä¸Šå·®åˆ†ã€‚</p><p>ä½†æ˜¯ here comes a problemï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸€æ•´ä¸ªä¸²åªèƒ½åœ¨æ•´ä¸ªæ ‘ä¸Šæ¯ä¸ªç‚¹ä¸Šæ›´æ–°ä¸€æ¬¡ã€‚æ€ä¹ˆæ¶ˆå»ç›¸åŒçš„å½±å“å‘¢ï¼Ÿ</p><p>è¿™é‡Œå®ç°ä¸Šæˆ‘ä»¬å°†ç»è¿‡çš„ç‚¹æŒ‰ fail æ ‘ä¸Š dfn æ’åºï¼Œå¹¶ä¸”å¯¹äºåºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ç‚¹åœ¨å…¶ LCA ä¸Šå‡å»ä¸€æ¬¡æ ‡è®°ã€‚ä¸ºä»€ä¹ˆè¿™æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿå‚è€ƒè™šæ ‘ï¼Œæˆ‘ä»¬åªéœ€è¦è®©åºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ä¸ªç‚¹å°½é‡è¿‘å°±å¯ä»¥ä¿è¯é‡å¤çš„è¢«åˆ é™¤å®Œæ¯•ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 2e6 + 5;int tot, bit[maxn], T[maxn][26], fail[maxn];int ins(std::string &amp;t) &#123;    int p = 0;    for (auto i : t) &#123;        if (!T[p][i - &#39;a&#39;])            T[p][i - &#39;a&#39;] = ++tot;        p = T[p][i - &#39;a&#39;];    &#125;    return p;&#125;int lowbit(int x) &#123;    return x &amp; -x;&#125;void add(int x, int v) &#123;    // printf(&quot;add (%d, %d)\n&quot;, x, v);    for (; x &lt;= tot + 1; x += lowbit(x))        bit[x] += v;    return;&#125;int ask(int x) &#123;    int res = 0, to = x;    for (; x; x -= lowbit(x))        res += bit[x];    // printf(&quot;ask(%d) = %d\n&quot;, to, res);    return res;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, q;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; tail(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::string t;        std::cin &gt;&gt; t, tail[i] = ins(t);    &#125;    std::vector&lt;std::vector&lt;int&gt; &gt; g(tot + 2);    &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt; 26; ++i)            if (T[0][i])                q.push(T[0][i]);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            for (int i = 0; i &lt; 26; ++i)                if (T[u][i]) &#123;                    int v = T[u][i];                    fail[v] = T[fail[u]][i];                    q.push(v);                &#125;                else                    T[u][i] = T[fail[u]][i];        &#125;        for (int i = 1; i &lt;= tot; ++i)            g[fail[i] + 1].push_back(i + 1);    &#125;    std::vector&lt;std::array&lt;int, 22&gt; &gt; f(tot + 2);    std::vector&lt;int&gt; dep(tot + 2), dfn(tot + 2), siz(tot + 2);    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        static int now = 0;        siz[x] = 1, dfn[x] = ++now;        // printf(&quot;%d\n&quot;, x);        for (auto i : g[x]) &#123;            dep[i] = dep[x] + 1;            f[i][0] = x;            for (int j = 1; j &lt;= 21; ++j)                f[i][j] = f[f[i][j - 1]][j - 1];            DFS(i), siz[x] += siz[i];        &#125;        return;    &#125;;    dep[1] = 1, DFS(1);    auto askLCA = [&amp;](int x, int y) &#123;        if (x == y)            return x;        if (dep[x] &lt; dep[y])            std::swap(x, y);        for (int i = 21; ~i; --i)            if (dep[f[x][i]] &gt;= dep[y])                x = f[x][i];        if (x == y)            return x;        for (int i = 21; ~i; --i)            if (f[x][i] != f[y][i])                x = f[x][i], y = f[y][i];        return f[x][0];    &#125;;    std::cin &gt;&gt; q;    for (; q--; ) &#123;        int op;        std::cin &gt;&gt; op;        if (op == 1) &#123;            std::string s;            std::cin &gt;&gt; s;            int p = 0, len = (int)s.length();            std::vector&lt;int&gt; id(len + 1);            for (int i = 1; i &lt;= len; ++i)                p = T[p][s[i - 1] - &#39;a&#39;], id[i] = p + 1;            std::sort(id.begin() + 1, id.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);            // for (int i = 1; i &lt;= len; ++i)            //     printf(&quot;%d &quot;, id[i]);            // puts(&quot;&quot;);            for (int i = 1; i &lt;= len; ++i) &#123;                // printf(&quot;%d %d %d\n&quot;, i, id[i], dfn[id[i]]);                // assert(0);                add(dfn[id[i]], 1);                if (i != 1)                    add(dfn[askLCA(id[i], id[i - 1])], -1);            &#125;        &#125;        else &#123;            int x;            std::cin &gt;&gt; x;            x = tail[x] + 1;            std::cout &lt;&lt; ask(dfn[x] + siz[x] - 1) - ask(dfn[x] - 1) &lt;&lt; &#39;\n&#39;;        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="eg2.">eg2.</h3><hr /><h2 id="ac-è‡ªåŠ¨æœºä¸Šçš„-dp">AC è‡ªåŠ¨æœºä¸Šçš„ DP</h2><p>é‰´äº AC è‡ªåŠ¨æœºçš„ä¼˜ç§€ç»“æ„ä¸æ€§è´¨ï¼Œå¹¶ä¸ç»å¸¸ä½œä¸ºå­—ç¬¦ä¸²åŒ¹é…å·¥å…·å‡ºç°ï¼Œå…¶ä¸€ä¸ªåº”ç”¨æ˜¯ä½œä¸º DP çš„è½½ä½“ã€‚</p><h3 id="eg1.-l-è¯­è¨€">eg1. L è¯­è¨€</h3><p><a href="https://www.luogu.com.cn/problem/P2292" class="uri">https://www.luogu.com.cn/problem/P2292</a></p><p>æˆ‘ä»¬æƒ³åˆ°è¦åœ¨è‡ªåŠ¨æœºä¸ŠåŒ¹é…ï¼Œä½†æ­¤æ—¶ <code>fail</code> ä½œä¸ºã€Œæ–­å¥ã€çš„å”¯ä¸€æ‰‹æ®µï¼ˆæ–­å¥çš„ä½ç½®åœ¨é“¾ä¸Šå½“å‰ç‚¹æ·±åº¦ - <code>fail</code> æ·±åº¦å¤„ï¼‰ï¼Œä¸å†ä»…å½“å¤±é…æ—¶æ‰èƒ½ç»è¿‡ã€‚æˆ‘ä»¬è€ƒè™‘æœ´ç´ çš„ DPï¼šåœ¨ç»è¿‡çš„æ¯ä¸ªçŠ¶æ€è€ƒè™‘æ–­å¥ï¼Œé‚£ä¹ˆè¿™è¦æ±‚æ–­å¥å¤„æ˜¯ä¸€ä¸ªå•è¯çš„ç»“å°¾ï¼Œé‚£ä¹ˆæ­¤æ—¶ <code>fail</code> æœ€é•¿åŒ¹é…é•¿åº¦å³å¯è¢«æ›´æ–°ã€‚æœ€åéå†æ‰€æœ‰å•è¯çš„æœ«ç»“ç‚¹ï¼Œå–æœ€å¤§ç­”æ¡ˆã€‚è¿™é‡Œçš„ <code>fail</code> å…¶å®æ˜¯ <code>fail</code> é“¾ä¸Šä»»æ„ä¸€ç‚¹ã€‚</p><p>è€ƒè™‘å¤æ‚åº¦ã€‚å®¹æ˜“å‘ç°å¯¹äºæ¯ä¸€ä¸ªç‚¹æˆ‘ä»¬è·³äº†å…¶æ•´æ¡ fail é“¾ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±æ˜¯æœ€åŠ£ <span class="math inline">\(n^2\)</span> çš„ã€‚è€ƒè™‘ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹è‡³ <span class="math inline">\(O(1)\)</span>ã€‚</p><p>é¢˜ç›®é‡Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¡ä»¶è¿˜æ²¡æœ‰ç”¨åˆ°ï¼šå•ä¸ªå•è¯é•¿åº¦ <span class="math inline">\(\le 20\)</span>ï¼Œè¿™è®©æˆ‘ä»¬æƒ³åˆ°çŠ¶æ€å‹ç¼©ã€‚å¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼Œè®°å½•å…¶æ–­å‡ºæ¥å•è¯çš„å¯èƒ½é•¿åº¦ã€‚</p><p>æˆ‘ä»¬åœ¨ DAG ä¸Šæ¸¸èµ°çš„æ—¶å€™è®°å½•ç›®å‰å¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ï¼Œå¦‚æœå…¶å’Œå½“å‰å¯æ–­å‡ºæ¥çš„é•¿åº¦ä¹‹äº¤ä¸ä¸ºç©ºï¼Œå°±å¯ä»¥å°†æ­¤å¤„åŠ å…¥ã€Œå¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ã€å¹¶æ›´æ–°ç­”æ¡ˆã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 2e5 + 5;int T[maxn][26], tot, fail[maxn], len[maxn], dep[maxn], tag[maxn];int ins(std::string &amp;t) &#123;    int p = 0;    for (auto i : t) &#123;        if (!T[p][i - &#39;a&#39;])            T[p][i - &#39;a&#39;] = ++tot, dep[tot] = dep[p] + 1;        p = T[p][i - &#39;a&#39;];    &#125;    ++tag[p];    return p;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; tail(n + 1);    std::vector&lt;std::string&gt; t(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; t[i], tail[i] = ins(t[i]);    &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt; 26; ++i)            if (T[0][i])                q.push(T[0][i]);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            len[u] = len[fail[u]];            if (tag[u])                len[u] |= (1 &lt;&lt; dep[u]);            for (int i = 0; i &lt; 26; ++i)                if (T[u][i]) &#123;                    int v = T[u][i];                    fail[v] = T[fail[u]][i];                    q.push(v);                &#125;                else                    T[u][i] = T[fail[u]][i];        &#125;    &#125;    for (; m--; ) &#123;        std::string s;        std::cin &gt;&gt; s;        int p = 0, q = 1, res = 0;        for (int i = 0; i &lt; (int)s.length(); ++i) &#123;            p = T[p][s[i] - &#39;a&#39;], q &lt;&lt;= 1;            if (len[p] &amp; q)                q |= 1, res = i + 1;        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="eg2.-popcount-words">eg2. Popcount Words</h3><p><a href="https://codeforces.com/gym/103409/problem/H" class="uri">https://codeforces.com/gym/103409/problem/H</a></p><p><del>å’‹ä¸Šå¼ºåº¦äº†å•Šã€‚</del></p><p>å…ˆæŠŠæ•´ä¸ªåºåˆ—å†™å‡ºæ¥ï¼Œå³ <span class="math inline">\(w=\texttt{01101001100101}\cdots\)</span>ï¼Œå°è¯•è¿›ä¸€æ­¥æ¢ç©¶å½¢å¼åŒ–çš„è§„å¾‹ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p><ol type="1"><li><span class="math inline">\(w_{[0, 2^n), 0}=w_{[0, 2^{n-1}),0}+w_{[0, 2^n), 1}\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(w_{[l, r], 0/1}\)</span> è¡¨ç¤º <span class="math inline">\([l, r]\)</span> å†…ï¼ŒåŸä¸² / å–åçš„å€¼ã€‚</li><li>å¯¹äºä¸ä»¥ <span class="math inline">\(0\)</span> å¼€å¤´çš„æ•´æ®µï¼Œå¯ä»¥ä»ä¸Šè¿°è§„åˆ™è½¬åŒ–ä¸º <span class="math inline">\(0\)</span> å¼€å¤´çš„æ•´æ®µã€‚</li></ol><p>æ¥ç€ä¸éš¾æƒ³åˆ°ä¸€ç§ç±»ä¼¼çº¿æ®µæ ‘çš„æ–¹å¼ï¼Œå°†å¾…æ±‚çš„ <span class="math inline">\(w_{[l, r], 0}\)</span> åˆ†åˆ° <span class="math inline">\(O(\log V)\)</span> ä¸ªæ•´æ®µä¸Šï¼Œé‚£ä¹ˆ <span class="math inline">\(S\)</span> å°±å¯ä»¥è¢« <span class="math inline">\(O(n\log V)\)</span> ä¸ªæ•´æ®µï¼ˆä¹Ÿæ˜¯ <span class="math inline">\(\log V\)</span> ä¸ªæœ¬è´¨ä¸åŒæ•´æ®µï¼‰æè¿°ã€‚</p><p>æˆ‘ä»¬å¯¹ <span class="math inline">\({p_m}\)</span> å»ºç«‹ AC è‡ªåŠ¨æœºï¼Œéœ€è¦çŸ¥é“è¿™ <span class="math inline">\(\log V\)</span> ä¸ªæ•´æ®µåœ¨æ¯ä¸ªç‚¹ä¸Šçš„å‡ºç°æ¬¡æ•°ã€‚å¯¹äºè‡ªåŠ¨æœºä¸Šä»»æ„çŠ¶æ€ <span class="math inline">\(u\)</span>ï¼Œè®¾ <span class="math inline">\(to_{u, n, 0/1}\)</span> è¡¨ç¤º <span class="math inline">\(u\)</span> ç»è¿‡ <span class="math inline">\(w_{[0, 2^n), 0/1}\)</span> ååˆ°è¾¾çš„ç‚¹ï¼Œåˆ™å¯å€å¢ï¼ˆå˜¶ï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯åº”è¯¥åè¿‡æ¥å«åˆ†æ²»å•Šï¼‰ç®€å•è§£å†³ã€‚</p><p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç”¨ <span class="math inline">\(to\)</span> æ¥è¿›è¡Œå¿«é€Ÿæ¸¸èµ°äº†ã€‚é¡ºä¾¿æ‰“ä¸ª <span class="math inline">\(cnt\)</span> è®°å½•ä¸€ä¸‹æ¯ä¸ª <span class="math inline">\(u\)</span> ä½œä¸ºä¸åŒæ•´æ®µçš„å¼€å¤´è¢«ç»è¿‡çš„æ¬¡æ•°ã€‚ç„¶ååšä¸€ä¸ª DPï¼Œç±»ä¼¼äºçº¿æ®µæ ‘ä¸Š <code>pushdown</code> çš„æ“ä½œæŠŠæ‰€æœ‰æ•´æ®µä¸‹æ”¾åˆ°å•ç‚¹ä¸Šçš„å•ä¸ªå­—ç¬¦ã€‚</p><p>æœ‰ä¸€è¯´ä¸€ç”¨ DP æ¥å¤„ç†è¿™ä¸ªä¸œè¥¿è¿˜æŒºéš¾æƒ³çš„ã€‚å¯èƒ½ä¹Ÿæ˜¯åŸºäºå‰é¢çš„å€å¢å§ã€‚æœ€åæ‹“æ‰‘æ’åºå°±è¡Œäº†ã€‚</p><details><p>å¤§å®¶æ•°ç»„ä¸€å®šè¦ç”¨ C-style array å•Šï¼Œ<code>std::vector&lt;&gt;</code> è®¡ç®—çš„æ˜¯ç”³è¯·ç©ºé—´åŒ… MLE çš„ <img src="/em/ll.gif" /></p><p>å¤§å®¶å¤§æ•°ç»„ä¸€å®šè¦å†…å­˜è¿ç»­è®¿é—®ä¼˜åŒ–å•Šï¼ŒTLE <span class="math inline">\(\to\)</span> 100ms æ³ªç›®äº† <img src="/em/ll.gif" /></p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 5e5 + 5;long long sum[maxn], f[2][30][maxn];int cnt[2][30][maxn], to[2][30][maxn];int T[maxn][2], tot, fail[maxn], deg[maxn];int ins(std::string &amp;t) &#123;    int p = 0;    for (auto i : t) &#123;        if (!T[p][i - &#39;0&#39;])            T[p][i - &#39;0&#39;] = ++tot;        p = T[p][i - &#39;0&#39;];    &#125;    return p;&#125;void ask(std::vector&lt;std::pair&lt;int, int&gt; &gt; &amp;s, int ql, int qr, int l = 0, int r = (1 &lt;&lt; 30) - 1, int len = 30, int v = 0) &#123;    if (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;        s.emplace_back(len, v);        return;    &#125;    int mid = l + (r - l) / 2;    if (ql &lt;= mid)        ask(s, ql, qr, l, mid, len - 1, v);    if (qr &gt; mid)        ask(s, ql, qr, mid + 1, r, len - 1, v ^ 1);    return;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;std::pair&lt;int, int&gt; &gt; s;    for (int i = 1; i &lt;= n; ++i) &#123;        int l, r;        std::cin &gt;&gt; l &gt;&gt; r;        ask(s, l, r);    &#125;    std::vector&lt;int&gt; tail(m + 1);    for (int i = 1; i &lt;= m; ++i) &#123;        std::string t;        std::cin &gt;&gt; t;        tail[i] = ins(t);    &#125;    &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt; 2; ++i)            if (T[0][i])                q.push(T[0][i]);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            for (int i = 0; i &lt; 2; ++i)                if (T[u][i]) &#123;                    int v = T[u][i];                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];                    q.push(v);                &#125;                else                    T[u][i] = T[fail[u]][i];        &#125;    &#125;    for (int i = 0; i &lt;= tot; ++i)        to[0][0][i] = T[i][0], to[1][0][i] = T[i][1];    for (int j = 1; j &lt; 30; ++j)        for (int i = 0; i &lt;= tot; ++i) &#123;            to[0][j][i] = to[1][j - 1][to[0][j - 1][i]];            to[1][j][i] = to[0][j - 1][to[1][j - 1][i]];        &#125;    &#123;        int p = 0;        for (auto [n, i] : s) &#123;            // printf(&quot;# %d %d\n&quot;, n, i);            ++cnt[i][n][p], p = to[i][n][p];        &#125;    &#125;    for (int j = 29; ~j; --j)        for (int i = 0; i &lt;= tot; ++i) &#123;            if (j != 29) &#123;                f[0][j][i] += f[0][j + 1][i];                f[1][j][i] += f[1][j + 1][i];                f[0][j][to[1][j][i]] += f[1][j + 1][i];                f[1][j][to[0][j][i]] += f[0][j + 1][i];            &#125;            f[1][j][i] += cnt[1][j][i];            f[0][j][i] += cnt[0][j][i];        &#125;    for (int i = 0; i &lt;= tot; ++i) &#123;        sum[T[i][0]] += f[0][0][i], sum[T[i][1]] += f[1][0][i];        // printf(&quot;%d %d\n&quot;, f[i][0][0], f[i][0][1]);    &#125;    &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt;= tot; ++i)            if (!deg[i])                q.push(i);        for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            sum[fail[u]] += sum[u];            if (!--deg[fail[u]])                q.push(fail[u]);        &#125;    &#125;    for (int i = 1; i &lt;= m; ++i)        std::cout &lt;&lt; sum[tail[i]] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="eg3.-legen">eg3. Legenâ€¦</h3><p><a href="https://codeforces.com/problemset/problem/696/D" class="uri">https://codeforces.com/problemset/problem/696/D</a></p><p>å…ˆåœ¨ fail æ ‘ä¸ŠæŠŠæ¯ä¸ªçŠ¶æ€çš„å®é™…ä»·å€¼è®¡ç®—å‡ºæ¥ã€‚æˆ‘ä»¬å‘ç°åŒ¹é…ä¸²æ˜¯æœªçŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦ä¸»åŠ¨å†³å®šæ¸¸èµ°è·¯å¾„ã€‚æ³¨æ„åˆ° <span class="math inline">\(l=10^{14}\)</span>ï¼Œè€ƒè™‘çŸ©é˜µã€‚</p><p>ä»¤ <span class="math inline">\(f_{u, i}\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(u\)</span> çŠ¶æ€æ—¶å·²ç»èµ°äº† <span class="math inline">\(i\)</span> æ­¥ï¼Œå¯ä»¥å¾—åˆ°çš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ï¼š</p><p><span class="math display">\[f_{v,i+1}=f_{u,i}+s_v.\]</span></p><p>å…¶ä¸­ <span class="math inline">\(v\)</span> æ˜¯è‡ªåŠ¨æœºä¸Š <span class="math inline">\(u\)</span> çš„ä»»æ„å‡ºè¾¹ã€‚å›¾çš„å¤§å°ä¸º <span class="math inline">\(200\)</span>ï¼Œå¯ä»¥æ”¾åˆ° <span class="math inline">\(+\max\)</span> çŸ©é˜µé‡ŒåŠ é€Ÿè½¬ç§»ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 2e5 + 5;const long long inf = 1e18;int fail[maxn], T[maxn][26], tot;int ins(std::string s) &#123;    int p = 0;    for (auto i : s) &#123;        if (!T[p][i - &#39;a&#39;])            T[p][i - &#39;a&#39;] = ++tot;        p = T[p][i - &#39;a&#39;];    &#125;    return p;&#125;struct matrix &#123;    int n, m;    std::vector&lt;std::vector&lt;long long&gt; &gt; a;    matrix(int n1, int m1, long long v = -inf, bool op = 0): n(n1), m(m1), a(n + 1, std::vector&lt;long long&gt; (m + 1, v)) &#123;        if (op)            for (int i = 0; i &lt;= n; ++i)                a[i][i] = 0;        return;    &#125;    std::vector&lt;long long&gt; &amp;operator[] (int i) &#123;        return a[i];    &#125;    matrix operator* (matrix &amp;q) const &#123;        matrix res(n, q.m);        for (int k = 0; k &lt;= m; ++k)            for (int i = 0; i &lt;= n; ++i)                for (int j = 0; j &lt;= q.m; ++j)                    res[i][j] = std::max(res[i][j], a[i][k] + q[k][j]);        return res;    &#125;    matrix&amp; operator*= (matrix q) &#123;        return *this = *this * q;    &#125;    matrix operator^ (long long q) &#123;        matrix res(n, n, -inf, 1), x(*this);        for (; q; q &gt;&gt;= 1, x *= x)            if (q &amp; 1)                res *= x;        return res;    &#125;&#125;;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    long long m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;long long&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::vector&lt;int&gt; tail(n + 1);    std::vector&lt;std::string&gt; t(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; t[i];        tail[i] = ins(t[i]);    &#125;    std::vector&lt;long long&gt; s(tot + 1);    for (int i = 1; i &lt;= n; ++i)        s[tail[i]] += a[i];    &#123;        std::queue&lt;int&gt; q;        for (int i = 0; i &lt; 26; ++i)            if (T[0][i])                q.push(T[0][i]);         for (; !q.empty(); ) &#123;            int u = q.front();            q.pop();            for (int i = 0; i &lt; 26; ++i)                if (T[u][i]) &#123;                    int v = T[u][i];                    fail[v] = T[fail[u]][i], s[v] += s[fail[v]];                    q.push(v);                &#125;                else                    T[u][i] = T[fail[u]][i];        &#125;    &#125;    matrix f(0, tot), op(tot, tot);    f[0][0] = 0;    for (int i = 0; i &lt;= tot; ++i)        for (int j = 0; j &lt; 26; ++j)            op[i][T[i][j]] = s[T[i][j]];    f *= (op * m);    std::cout &lt;&lt; *std::max_element(f[0].begin(), f[0].end()) &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="eg4.-you-are-given-some-strings">eg4. You Are Given Some Stringsâ€¦</h3><p>goto <a href="/20250121/#%E4%B8%80%E4%B8%AA%E6%A8%A1%E6%9D%BFcf1202e-you-are-given-some-strings...">link</a>.</p>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> å­—ç¬¦ä¸² </tag>
            
            <tag> AC è‡ªåŠ¨æœº </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20241104/"/>
      <url>/20241104/</url>
      
        <content type="html"><![CDATA[<p>å“­ã„ãŸé–ƒå…‰ãŒç›®ã«åˆºã•ã‚‹ / ãŠåˆ¥ã‹ã‚Œã®é˜ãŒé³´ã‚‹ / ç¥ãŒæˆã—ãŸæ­´å²ã® / çµã¶ç­”ãˆã¯ç ‚ã®å‘³ãŒã™ã‚‹</p><span id="more"></span><hr /><h2 id="a.-ç¾å‘³ã—ã„ç¾å‘³ã—ã„ãƒãƒ³ãƒãƒ¼ã‚°">A. ç¾å‘³ã—ã„ç¾å‘³ã—ã„ãƒãƒ³ãƒãƒ¼ã‚°</h2><p><a href="https://vjudge.net/contest/669299#problem/A" class="uri">https://vjudge.net/contest/669299#problem/A</a></p><p>æœ‰ä¸€ä¸ªå¾ˆç¥å¥‡çš„éšæœºåŒ–åšæ³•ï¼šæˆ‘ä»¬ä»å‰å¾€åä¸²ç­¾å­ï¼Œæœ€å¼€å§‹ç­¾å­æ•°ä¸º <span class="math inline">\(0\)</span>ï¼Œå¦‚æœå½“å‰ä»»ä½•ä¸€ä¸ªç­¾å­éƒ½æ²¡åŠæ³•å†ä¸²è¿™ä¸€ä¸ªå°±æ–°å¢ç­¾å­ã€‚å¦‚æœæ²¡æœ‰ç­¾å­å¯ä»¥ç”¨äº†ï¼Œå°±è¯´æ˜è¿™å—è‚‰ä¸åˆæ³•ï¼ŒæŒªåˆ°å‰ <span class="math inline">\(k\)</span> å—ä¸­çš„éšæœºä½ç½®ä½¿å…¶ä¼˜å…ˆè¢«é€‰æ‹©ã€‚</p><p>ä½ ä¼šå‘ç°è¿™ä¸ªåšæ³•è·‘å¾—å¾ˆå¿«ï¼Œspdarkle è¯´å› ä¸º <span class="math inline">\(K\)</span> å¾ˆå°è¿˜ä¿è¯æœ‰è§£ï¼Œæ‰€ä»¥æœŸæœ›æ¬¡æ•°æ˜¯éå¸¸å¯¹çš„ã€‚æˆ‘å¤ªèœäº†ä»–ä¹Ÿæ²¡ç»†è¯´æ‰€ä»¥å¼€æ‘†ã€‚</p><p>ç”±äºç¥ç§˜åŸå› ï¼Œæˆ‘çš„ <code>std::mt19937::operator()</code> å¦‚æœå¤–è¾¹ä¸å¥—ä¸€å±‚ abs å°±ä¼šèµ·é£ <img src="/em/yun.gif" alt="æ™•" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    struct _ &#123; int l, r, u, d; &#125;;    std::vector&lt;_&gt; a(n + 1), b(k + 1);    std::mt19937 rand(time(nullptr));    auto random = [&amp;](int l, int r) &#123;        return l + std::abs((int)rand()) % (r - l + 1);    &#125;;    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i].l &gt;&gt; a[i].u &gt;&gt; a[i].r &gt;&gt; a[i].d;    for (;;) &#123;        std::copy(a.begin() + 1, a.begin() + k + 1, b.begin() + 1);        for (int i = k + 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= k; ++j) &#123;                if (std::min(b[j].r, a[i].r) &gt;= std::max(b[j].l, a[i].l) &amp;&amp; std::min(b[j].d, a[i].d) &gt;= std::max(b[j].u, a[i].u)) &#123;                    b[j].l = std::max(b[j].l, a[i].l);                    b[j].r = std::min(b[j].r, a[i].r);                    b[j].u = std::max(b[j].u, a[i].u);                    b[j].d = std::min(b[j].d, a[i].d);                    goto issol;                &#125;            &#125;            std::swap(a[i], a[random(1, i)]);            goto nosol;        issol: ;        &#125;        for (int i = 1; i &lt;= k; ++i)            std::cout &lt;&lt; b[i].l &lt;&lt; &#39; &#39; &lt;&lt; b[i].u &lt;&lt; &#39;\n&#39;;        break;    nosol: ;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="b.-shik-and-travel">B. Shik and Travel</h2><p><a href="https://vjudge.net/contest/669299#problem/B" class="uri">https://vjudge.net/contest/669299#problem/B</a></p><p>æœ€å°åŒ–æœ€å¤§ï¼Œæ˜¾ç„¶éœ€è¦äºŒåˆ†ç­”æ¡ˆï¼Œcheck æ‰“ä¸ª DPã€‚å…·ä½“æ€ä¹ˆ DP å‘¢ï¼Ÿé¦–å…ˆè€ƒè™‘æš´åŠ›ï¼Œè®¾ <span class="math inline">\(f_{u, a, b}\)</span> è¡¨ç¤ºåœ¨å½“å‰ <span class="math inline">\(mid\)</span> çš„é™åˆ¶ä¸‹ï¼Œä» <span class="math inline">\(u\)</span> å‡ºå‘åˆ°ç¬¬ä¸€ä¸ªå¶å­è·ç¦»ä¸º <span class="math inline">\(a\)</span>ï¼Œæœ€åä¸€ä¸ªè·ç¦»ä¸º <span class="math inline">\(b\)</span> çš„å¯è¡Œæ€§ã€‚é‚£ä¹ˆæœ‰ <span class="math inline">\(f_{u,a,b} = (f_{l,a,i}\land f_{r,j,b})\lor (f_{r,a,i}\land f_{l,j,b})\)</span>ã€‚</p><p>å…ˆä¸è¯´è½¬ç§»ï¼ŒçŠ¶æ€æ•°å·²ç»éš¾ä»¥æ¥å—ã€‚æ‰€ä»¥æˆ‘ä»¬ä»çŠ¶æ€æ•°å…¥æ‰‹ï¼Œæ˜¾ç„¶å¦‚æœå­˜åœ¨ä¸€ä¸ª <span class="math inline">\(a&#39;\le a\)</span> å’Œ <span class="math inline">\(b&#39;\le b\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\((a&#39;,b&#39;)\)</span> å°±æ˜¯æ— ç”¨çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰æœ‰ç”¨çš„ <span class="math inline">\((a, b)\)</span> æŒ‰ <span class="math inline">\(a\)</span> ä»å°åˆ°å¤§æ’åºï¼Œ<span class="math inline">\(b\)</span> åº”è¯¥æ˜¯å•è°ƒé€’å‡çš„ï¼›è€ƒè™‘è¿™ä¸ªæŠ½è±¡çš„è¿‡ç¨‹ï¼Œç›¸å½“äºä»å¤´åˆ°å°¾éå†ä¸€ä¸²çŠ¶æ€ï¼Œåœ¨è·¯ä¸Šç¢°åˆ°çš„æ‰€æœ‰è¾ƒå¤§çš„ <span class="math inline">\(b\)</span> éƒ½ä¼šè¢«å½“åœºä¸¢å¼ƒã€‚</p><p>æ„Ÿæ€§æ€è€ƒå¯ä»¥å‘ç°<mark>å½“æˆ‘ä»¬è¯•å›¾è®© <span class="math inline">\(b\)</span> æœ€å°çš„æ—¶å€™ï¼Œè¿™ä¸ªçŠ¶æ€æœ€æœ‰ç”¨ï¼ˆå³æœ€ä¸å¯èƒ½è¢«ä¸¢å¼ƒï¼‰</mark>ã€‚å¯¹äºä¸€ä¸ª <span class="math inline">\(f_{l,a,i}\)</span>ï¼Œæˆ‘ä»¬æ‰¾åˆ°èƒ½å¤Ÿè½¬ç§»çš„ <span class="math inline">\(f_{r,j,b_{\min}}\)</span> æ¥è½¬ç§»ã€‚æ­£ç¡®æ€§å¾ˆå¥½è¯æ˜ï¼Œæˆ‘ä»¬çš„ check åªè¦æ±‚åœ¨æ ¹èŠ‚ç‚¹ä¸Šå­˜åœ¨ä»»æ„åˆæ³•çŠ¶æ€ï¼Œé‚£åªéœ€è¦è®©æœ€ä¸å¯èƒ½è¢«ä¸¢å¼ƒçš„ä¸è¢«ä¸¢å¼ƒå³å¯ï¼Œæ›´å¯èƒ½è¢«ä¸¢å¼ƒçš„çŠ¶æ€æ˜¯å¦è¢«ä¸¢å¼ƒå°±ä¸ä¼šäº§ç”Ÿå½±å“äº†ã€‚</p><p>ä¼˜åŒ–åçš„çŠ¶æ€æ•°åœ¨ <span class="math inline">\(u\)</span> ä¸Šåªä¼šå¢åŠ  <span class="math inline">\(\min(|a_l|,|b_r|)+\min(|a_r|,|b_l|)\)</span>ï¼Œå³ä¸¤ä¸ªå„¿å­ä¸Šçš„çŠ¶æ€æ•°è¾ƒå°è€…ï¼Œå‚è€ƒ DSU on treeï¼Œæ˜¯ <span class="math inline">\(O(n\log)\)</span> çš„ã€‚åŠ ä¸Šå¯¹çŠ¶æ€æ’åºçš„æ•°æ®ç»“æ„ï¼Œå¤æ‚åº¦ <span class="math inline">\(O(n\log^2 n\log V)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long long inf = 1e18;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);    for (int i = 2, x, w; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; w;        g[x].emplace_back(i, w);    &#125;    long long res = -1;    for (long long l = 0, r = inf, mid; l &lt;= r; ) &#123;        mid = (l + r) &gt;&gt; 1;        if ([&amp;](void) -&gt; bool &#123;            std::vector&lt;std::vector&lt;std::pair&lt;long long, long&gt; &gt; &gt; f(n + 1);            std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;                if (g[x].empty()) &#123;                    f[x].emplace_back(0, 0);                    return;                &#125;                long long lim = mid;                for (auto [i, w] : g[x])                    DFS(i), lim -= w;                std::vector&lt;std::pair&lt;long long, long long&gt; &gt; t;                for (int i = 0; i &lt; 2; ++i) &#123;                    int j = 0;                    auto l = g[x][0], r = g[x][1];                    for (auto [a, b] : f[l.first]) &#123;                        for (; j + 1 &lt; (int)f[r.first].size() &amp;&amp; f[r.first][j + 1].first + b &lt;= lim; ++j);                        if (j &lt; (int)f[r.first].size() &amp;&amp; f[r.first][j].first + b &lt;= lim)                            t.emplace_back(a + l.second, f[r.first][j].second + r.second);                    &#125;                    std::swap(g[x][0], g[x][1]);                &#125;                std::sort(t.begin(), t.end());                for (auto [a, b] : t)                    if (f[x].empty() || f[x].back().second &gt; b)                        f[x].emplace_back(a, b);                return;            &#125;;            DFS(1);            return !f[1].empty();        &#125; ())            res = mid, r = mid - 1;        else             l = mid + 1;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="d.-candy-piles">D. Candy Piles</h2><p><a href="https://vjudge.net/contest/669299#problem/D" class="uri">https://vjudge.net/contest/669299#problem/D</a></p><p>ä¸éš¾å‘ç°æˆ‘ä»¬å¯ä»¥æŠŠé¢˜æ„è½¬åŒ–ä¸ºï¼ŒæŠŠæ‰€æœ‰åˆ—ä»å¤§åˆ°å°æ’åˆ—ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©åˆ æ‰æœ€å·¦è¾¹ä¸€åˆ—æˆ–æœ€ä¸‹è¾¹ä¸€è¡Œï¼Œåˆ ç©ºè€…èƒœã€‚</p><p>æŠŠè¯¥æŸ±çŠ¶å›¾è½¬åŒ–ä¸ºç½‘æ ¼å›¾ï¼Œå®šä¹‰è¾¹ç•Œä¸ºèƒœåˆ©ç‚¹ï¼Œå¯¹äºéè¾¹ç•Œä¸Šçš„ç‚¹ï¼Œå…¶ä¸€å®šå¯ä»¥å¾€å³èµ°ã€å¾€ä¸Šèµ°ã€‚è‹¥ä¸€ä¸ªç‚¹ä¸Šæ–¹ã€å³ä¾§ç‚¹å‡ä¸ºèƒœåˆ©ç‚¹ï¼Œæ­¤ç‚¹ä¸ºå¤±è´¥ç‚¹ï¼›å¦åˆ™ï¼Œæ­¤ç‚¹ä¸ºèƒœåˆ©ç‚¹ã€‚</p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>CSP-S</title>
      <link href="/20241027/"/>
      <url>/20241027/</url>
      
        <content type="html"><![CDATA[<p>å¼Ÿå¨ƒå¹´æ–¹åä¸€ã€‚æ–¹å‡ºè€ƒåœºä¹‹æ—¶ï¼Œä½™é—®å¼Ÿå¨ƒæ›°ï¼šã€ŒT1 ç”¨æ—¶å‡ ä½•ï¼Ÿã€ã€‚å¼Ÿå¨ƒå¯¹æ›°ï¼šã€ŒåŠè¿‡å¤§æ ·ä¾‹ï¼Œå·²åŠç‚·é¦™çŸ£ã€‚ã€ä½™å¤§æ¸ï¼Œä¸ºä½™ T1 å¤§æ ·ä¾‹æ—¢è¿‡ï¼Œå·²ä¸¤æŸ±é¦™æœ‰ä½™ã€‚å¤è°šæœ‰äº‘ï¼šã€Œè‹¥æœ‰ä¸€äººå¹´å°‘äºå¾äº¦å¼ºäºå¾ï¼Œå¾ä¸ºä¹‹å•è°ƒé˜Ÿåˆ—ä¹Ÿã€‚ã€å¾å¼Ÿå¨ƒå¹´å°‘äºå¾ï¼Œæ®Šéš¾æ˜“ä¹‹ï¼›ä»Šå¾å¼Ÿå¨ƒå·²å››å€è€Œå¼ºäºå¾ï¼Œå¾ç›ä¸ºå•è°ƒé˜Ÿåˆ—å“‰ï¼</p><span id="more"></span><hr /><p>å¿†å¾€æ˜”æ˜”ï¼ˆåˆäºŒï¼‰ï¼Œ1=ã€‚å¿†å¾€æ˜”æ˜”æ˜”ï¼ˆåˆä¸€ï¼‰ï¼Œ1=ã€‚å¿†å¾€æ˜”ï¼ˆåˆä¸‰ï¼‰ï¼Œ135pts å–œæ 2=ã€‚</p><p>çœ‹ä»Šæœï¼Œ300pts åº”è¯¥æœ‰ 1=ã€‚å“‡æ­å–œæ­å–œï¼Œ2= åˆ° 1=ï¼Œä¸€å¹´æ¥ä½ æœ‰å¾ˆå¤§è¿›æ­¥å‘¢ï¼</p><hr /><h2 id="a.-duel">A. duel</h2><p>éå¸¸é—æ†¾åœ°ï¼Œè¢«æ©™é¢˜<mark>ç¡¬æ§ 1h+</mark>ã€‚é—®å°±æ˜¯ä¸Šåœºä¹‹åå…ˆèŠ±äº† 59min ä¸‹è½½ <em>å¤§è„‘.tar.gz</em>ï¼Œç„¶å 1s çŸ¥é“åšæ³•ï¼Œ59s å®ç°ã€‚</p><p>å…¶å®æˆ‘ä»¬æ˜¯æ³¨æ„åˆ°äº†ä¼—æ•°çš„é‚£ä¸ªå¥‡å¦™ç»“è®ºçš„ï¼Œä½†æ˜¯å› ä¸ºå¤ªå¥‡æ€ªå¹¶ä¸”æ‹…å¿ƒæ˜¯å› ä¸ºå¤§æ ·ä¾‹å¤ªæ°´æ‰€ä»¥æ²¡æ•¢å†™ï¼Œä¸æœæ¥æˆ˜ã€‚</p><hr /><h2 id="b.-detect">B. detect</h2><p>æˆ‘ä»¬åœ¨æ±‚è§£å‡ºåŒºé—´åè¢«ç²¾åº¦é—®é¢˜<mark>ç¡¬æ§ 1h+</mark>ã€‚åœ¨æŒ‰ç…§å³ç«¯ç‚¹æ’åºåè¶…å‰å®³åœ°ä½¿ç”¨ <strong>çº¿æ®µæ ‘ä¼˜åŒ– DP</strong> è§£å†³äº†åˆä¸€ç®€å•çº¿æ€§è´ªå¿ƒé—®é¢˜ã€‚å“ˆå“ˆå“ˆã€‚</p><p>ç¬‘è¯ï¼šè¢«ç²¾åº¦é—®é¢˜æ§çš„ 1h é‡Œæœ‰ 40min æ‰‘åœ¨å› ä¸ºè°ƒç²¾åº¦è€Œæ‰“å‡ºæ¥çš„ <em>æ­»å¾ªç¯</em> ä¸Š <img src="/em/kx.gif" /></p><hr /><h2 id="c.-color">C. color</h2><p>åœ¨ 5min è§£å†³è´¹ç”¨æå‰è®¡ç®—å¼å­ååˆ é™¤äº† node_modules &gt; å¤§è„‘ï¼Œç¨åŠ æ€è€ƒå¾—å‡ºäº†ã€Œå¤§æŠµæ˜¯ä¸å­˜åœ¨ä¸å¸¦ <span class="math inline">\(\log\)</span> çš„å…¨å±€ä¿®æ”¹ã€å•ç‚¹ä¿®æ”¹ã€å•ç‚¹æŸ¥è¯¢çš„æ•°æ®ç»“æ„çš„ã€çš„ç»“è®ºï¼Œè¶…å‰å®³åœ°ä½¿ç”¨ <strong>çº¿æ®µæ ‘ä¼˜åŒ– DP</strong>ï¼Œå¹¶ä¸”è¢«å…¨å±€ä¿®æ”¹æ‡’æ ‡è®°æ²¡ä¼ ç»™æ ‘æ ¹<mark>ç¡¬æ§ 1h+</mark>ã€‚</p><p>ä¸è¿‡å› ä¸ºçŸ¥é“ 1e6 çš„æ•°æ®ç»™çº¿æ®µæ ‘ç¡®å®æŒºå¥‡æ€ªçš„ï¼Œæ‰€ä»¥å¤§åŠ›å¡å¸¸ï¼Œèµ›æ—¶ä»£ç è·‘æ°‘é—´æ•°æ®è·‘å¾—æŒºå¿«ã€‚ä¹Ÿå°±æ˜¯çº¿æ€§æ‰€æœ‰ç‚¹åŠ èµ·æ¥ 500msï¼Œæˆ‘ä¸€ä¸ªç‚¹å°±è¦è·‘ 500ms çš„æ°´å¹³ <img src="/em/kx.gif" /> è™½ç„¶è‚¯å®š T æ˜¯ä¸å¯èƒ½ T çš„ã€‚</p><hr /><h2 id="d.-arena">D. arena</h2><p>åæ¶ˆæ¯ï¼šå‰ä¸‰é¢˜å‡è¢«ç¡¬æ§ 1h+ï¼ŒT4 è¿æš´åŠ›éƒ½æ‰“ä¸å®Œäº†ï¼Œç”šè€Œè‡³äºï¼Œè¾“å…¥éƒ½æ‰“ä¸å®Œå–œæé›¶è›‹ã€‚</p><p>å¥½æ¶ˆæ¯ï¼šçœ‹å¼€ç‚¹ï¼Œè‡³å°‘ T4 ä¸ä¼šè¢«<mark>ç¡¬æ§ 1h+</mark> <img src="/em/kx.gif" /></p><p>è¿™é“é¢˜æœ‰ä¸ªå¥½å†™çš„åšæ³•ï¼Œå…ˆèƒ¡ä¸€èƒ¡ï¼Œç­‰ä¼šå„¿å¼€ä¸€ç¯‡å…·ä½“å†™ä¸€å†™ã€‚</p><p>è¿˜åŸåˆ°æ¯åœºæ¯”èµ›èƒœå‡ºè€…èƒ½åŠ›å€¼ï¼ˆçº¿æ€§ï¼‰ï¼Œè¿˜éœ€è¦æ³¨æ„åˆ°ä¸€ä¸ªå•è°ƒæ€§ï¼šè‹¥åœ¨åŠ å…¥ä¸€ä¸ªäººåæŸåœºæ¯”èµ›çš„èƒœè€…å°±ä¸å¯èƒ½æˆä¸ºå…¨å±€èƒœè€…ï¼ˆç›¸å½“äºçŸ¥é“å…¶ç¥–å…ˆä¸­æŸä¸ªå…ƒç´ çš„å…·ä½“èƒœè€…ï¼Œä¸”è¯¥èƒœè€…ä¸æ˜¯è‡ªå·±ï¼‰ï¼Œé‚£ä¹ˆåŠ å…¥æ›´å¤šçš„äººä¹Ÿä¸è¡Œã€‚æ•…è®°å½•è¿™ä¸ªäººï¼ˆå‡è®¾å¯¹äºæ¯”èµ› <span class="math inline">\(x\)</span> ä¸º <span class="math inline">\(id_x\)</span>ï¼‰ï¼Œé‚£ä¹ˆçŸ¥é“äº†æ‰€æœ‰å¶å­çš„ <span class="math inline">\(id\)</span> å°±å¯ä»¥éšä¾¿ä¹±æäº†ã€‚è‡³äºæ±‚ <span class="math inline">\(id\)</span> çš„è¿‡ç¨‹ï¼Œç›´æ¥æŠŠ <span class="math inline">\(1\sim n\)</span> çš„äººåŠ å…¥äºŒå‰æ ‘ï¼Œå¦‚æœæŸä¸ªç‚¹è¢«ç¡®å®šäº†èƒœè€…ï¼Œå°±å¾€è´¥è€…å­æ ‘æ‰“ä¸€ä¸ªæ ‡è®°ï¼Œå®Œäº†è¿‡åéå†æ•´ä¸ªæ ‘ä¸‹ä¼ æ ‡è®°å³å¯ã€‚</p><hr /><p>å°çŸ¥è¯†ï¼šåœ¨ 2024 CSP-S2 ä¸­ï¼Œ99% çš„äººæ‰“äº† 0 ä¸ª <strong>çº¿æ®µæ ‘ä¼˜åŒ– DP</strong>ï¼Œè€Œä½ æ‰“äº† 2 ä¸ª <strong>çº¿æ®µæ ‘ä¼˜åŒ– DP</strong> <img src="/em/kx.gif" /></p><hr /><p>å¯æ€œæã€‚100 + 100 + 100 + 0 = 300ã€‚ç”±äº T4 è¾“å…¥æ²¡å†™å®Œæ˜¯æ²¡æœºä¼šæµ®åŠ¨äº†ã€‚æ‹œæ‹œ WCã€‚</p><p>è‰è‰è‰ï¼Œwc éƒ½æ‹œæ‹œäº†æˆ‘ä»Šå¹´æ˜¯ä¸æ˜¯ç›´æ¥åŸåœ° afo äº†å•Šã€‚ä¸è¦å•Šä¸è¦å•Šã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> ä¸‹é¥­ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é•¿é“¾å‰–åˆ† å­¦ä¹ ç¬”è®°</title>
      <link href="/20241021-1/"/>
      <url>/20241021-1/</url>
      
        <content type="html"><![CDATA[<p><em>åŠç«¯ãªç”Ÿå‘½ã®é–¢æ•°ã‚’ / å°‘ã€…ã“ã“ã‚‰ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰</em></p><span id="more"></span><hr /><h2 id="å†…å®¹-æ€§è´¨">å†…å®¹ &amp; æ€§è´¨</h2><p>æŠŠé‡é“¾å‰–åˆ†é€‰çš„ siz æœ€å¤§çš„å„¿å­æ¢æˆé«˜åº¦æœ€å¤§çš„å„¿å­å°±æ˜¯é•¿å‰–äº†ã€‚åŒæ ·å…·æœ‰ä¸€äº›ç¾å¦™çš„æ€§è´¨ã€‚</p><ul><li><p>ä»»æ„ç‚¹åˆ°æ ¹èŠ‚ç‚¹ç»è¿‡çš„é“¾æ•°æœ€åŠ£ä¸º <span class="math inline">\(\sqrt n\)</span>ã€‚</p><p>è€ƒè™‘æ„é€ ä¸€æ¡ç»è¿‡äº† <span class="math inline">\(\sqrt n+1\)</span> æ¡é“¾çš„è·¯å¾„ï¼Œå‘ç°æ„é€ ä¸å‡ºæ¥ã€‚å¾—è¯ã€‚ï¼ˆï¼Ÿï¼‰</p>è¿™ç‚¹ä¹Ÿå†³å®šäº†é•¿å‰–å’Œé‡å‰–èµ°çš„ä¸æ˜¯ä¸€æ¡èµ›é“ï¼Œæ›´å¤šçš„æ˜¯å¤„ç†ä¸€äº›å’Œæ·±åº¦æœ‰å…³çš„åœºæ™¯ä¸‹çš„é—®é¢˜ã€‚ç”¨æ³•æœ‰ç‚¹åƒ dsu on treeã€‚</li><li><p>ä»»æ„ç‚¹ <span class="math inline">\(x\)</span> çš„ <span class="math inline">\(k\)</span> çº§ç¥–å…ˆ <span class="math inline">\(fa\)</span> æ‰€åœ¨é“¾é•¿ <span class="math inline">\(\ge k\)</span>ã€‚</p><p>è€ƒè™‘åè¯ã€‚è‹¥ <span class="math inline">\(fa\)</span> æ‰€åœ¨é“¾é•¿åº¦ <span class="math inline">\(&lt;k\)</span>ï¼Œåˆ™ <span class="math inline">\(fa\to x\)</span> æ›´ä¼˜ï¼ŒçŸ›ç›¾ã€‚æ•…åŸå‘½é¢˜æˆç«‹ã€‚</p></li></ul><hr /><h2 id="æ±‚-k-çº§ç¥–å…ˆ">æ±‚ k çº§ç¥–å…ˆ</h2><p>é•¿å‰–çš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯ <span class="math inline">\(O(n\log n)-O(1)\)</span> æ±‚ <span class="math inline">\(k\)</span> çº§ç¥–å…ˆã€‚å…ˆè€ƒè™‘ç›¸å¯¹æš´åŠ›çš„åšæ³•ï¼Œå¯ä»¥ <span class="math inline">\(O(n\sqrt n)\)</span> é¢„å¤„ç†æ¯ä¸ªç‚¹çš„ <span class="math inline">\(1\sim \sqrt n\)</span> çº§ç¥–å…ˆç„¶åå—é—´å—å†…éšä¾¿è·³ä¸€è·³å°±æ˜¯ <span class="math inline">\(O(\sqrt n)\)</span> çš„å•æ¬¡æŸ¥è¯¢äº†ã€‚</p><p>æŠŠè¿™ä¸ªæš´åŠ›ç»“åˆã€Œä»»æ„ç‚¹ <span class="math inline">\(k\)</span> çº§ç¥–å…ˆæ‰€åœ¨é“¾é•¿ <span class="math inline">\(\ge k\)</span>ã€çš„æ€§è´¨ï¼Œä»¤ <span class="math inline">\(r=\dfrac k2\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\(x\)</span> çš„ <span class="math inline">\(r\)</span> çº§ç¥–å…ˆæ‰€åœ¨é“¾é•¿ <span class="math inline">\(\ge r\)</span>ã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“ <span class="math inline">\(r\)</span> çº§ç¥–å…ˆ <span class="math inline">\(fa_r\)</span>ï¼Œé¢„å¤„ç†å‡ºé“¾å†…ç‚¹åºåˆ—ã€é“¾é¡¶å‘ä¸Šçš„é“¾é•¿ä¸ªç¥–å…ˆï¼ˆå‡æ‘Š <span class="math inline">\(O(n)\)</span>ï¼‰ï¼Œå°±å¯ä»¥ <span class="math inline">\(O(1)\)</span> è®¿é—® <span class="math inline">\(fa_k\)</span>ã€‚</p><p>æ€ä¹ˆæ‰¾åˆ° <span class="math inline">\(fa_r\)</span> å‘¢ï¼Ÿè¿™çœ‹ä¼¼æ˜¯é€’å½’çš„é—®é¢˜ï¼Œå®é™…ä¸Šå‘ç° <span class="math inline">\(r\)</span> çš„å–å€¼åªéœ€ <span class="math inline">\(\ge \dfrac k2\)</span>ï¼Œå¯¹äº <span class="math inline">\(1\sim n\)</span> çš„æ¯ä¸€ä¸ª <span class="math inline">\(k\)</span>ï¼Œæ‰¾åˆ°å…¶æœ€é«˜äºŒè¿›åˆ¶ä½ <span class="math inline">\(r\)</span>ï¼ˆæ˜¾ç„¶ <span class="math inline">\(r\)</span> çš„å¯èƒ½å–å€¼æœ‰ <span class="math inline">\(\log n\)</span> ç§ï¼‰ï¼Œå¯¹äºæ¯ä¸ªç‚¹ï¼Œé¢„å¤„ç†å‡ºå…¶ <span class="math inline">\(\log n\)</span> ä¸ªä¸åŒçš„ <span class="math inline">\(r\)</span> çº§ç¥–å…ˆã€‚è¿™ä¸ªå°±æ˜¯å€å¢äº†ã€‚</p><details><pre class="cpp"><code>for (int i = 1, mx = 0; i &lt;= n; ++i) &#123;    if (i &gt;= (1 &lt;&lt; mx) * 2)        ++mx;    to[i] = mx;&#125;std::vector&lt;std::array&lt;int, 21&gt; &gt; fa(n + 1);std::vector&lt;int&gt; h(n + 1, 1), son(n + 1), dep(n + 1);h[0] = 0;std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;    for (auto i : g[x])        if (i != fa[x][0]) &#123;            fa[i][0] = x;            for (int j = 1; j &lt;= 20; ++j)                fa[i][j] = fa[fa[i][j - 1]][j - 1];            dep[i] = dep[x] + 1;            DFS(i);            if (h[i] &gt;= h[son[x]])                son[x] = i, h[x] = h[i] + 1;        &#125;    return;&#125;;dep[1] = 1, DFS(1);std::vector&lt;int&gt; top(n + 1), id(n + 1);std::vector&lt;std::vector&lt;int&gt; &gt; anc(n + 1), des(n + 1, std::vector&lt;int&gt; (1));std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int toq) &#123;    top[x] = toq;    if (son[x])        DFS1(son[x], toq);    for (auto i : g[x])        if (i != fa[x][0] &amp;&amp; i != son[x])            DFS1(i, i);    des[toq].push_back(x);    id[x] = (int)des[toq].size() - 1;    if (x == toq) &#123;        anc[x].push_back(x);        for (int j = 1, now = x; j &lt;= id[x]; ++j, now = fa[now][0])            anc[x].push_back(fa[now][0]);    &#125;    return;&#125;;DFS1(1, 1);auto ask = [&amp;](int x, int k) &#123;    int x1 = x;    if (!k)        return x;    x = fa[x][to[k]];    if (dep[x] - dep[top[x]] &gt;= k - (1 &lt;&lt; to[k]))        return des[top[x]][id[x] + k - (1 &lt;&lt; to[k])];    return anc[top[x]][k - (1 &lt;&lt; to[k]) - (dep[x] - dep[top[x]])];&#125;;</code></pre></details><hr /><h2 id="ä¼˜åŒ–-dp">ä¼˜åŒ– DP</h2><blockquote><p>ylyï¼šç®¡å®ƒè¿™é‚£çš„ï¼Œåªè¦æ˜¯æœ‰å…³æ·±åº¦ç›´æ¥ä¸Šé•¿å‰–å°±æ˜¯äº†ã€‚</p></blockquote><p>å’Œ DSU on tree ç±»ä¼¼ï¼Œä¸»è¦åˆ©ç”¨æ¯æ¡é“¾åªä¼šè¢«ç®—ä¸€æ¬¡å®ç° <span class="math inline">\(O(n)\)</span> DPã€‚å…·ä½“åœ°ï¼Œå°½å¯èƒ½åœ°ã€ç»§æ‰¿ã€é•¿é“¾çš„ä¿¡æ¯ï¼Œã€çŸ­é“¾ã€åˆ™æš´åŠ›åˆå¹¶ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬ã€æ·±åº¦ã€è¿™ä¸€ç»´ä¿¡æ¯ä¼šä»¥ã€ä¸ <span class="math inline">\(u\)</span> çš„è·ç¦»ã€çš„å½¢å¼ï¼Œç»“åˆæŒ‡é’ˆæ¥ç»´æŠ¤ï¼ˆå› ä¸ºç›´æ¥è®°å½•æ·±åº¦ä¼šæ›´å²ï¼‰ã€‚</p><p>å…·ä½“åœ°ï¼Œç”¨ä¸€ä¸ªå…¨å±€å¤§æ•°ç»„å®¹çº³æ‰€æœ‰ä¿¡æ¯ï¼Œä¸ºæ¯ä¸ªç‚¹åˆ†é…ç›¸åº”çš„æ•°ç»„å¤´æŒ‡é’ˆã€‚æ­£å¸¸æƒ…å†µä¸‹éœ€è¦ç”¨åˆ°çš„å…ƒç´ æœ€å¤šä¸º <span class="math inline">\(2n\)</span>ï¼Œä½†å¦‚æœå­˜åœ¨ä¸€äº›è¯¡å¼‚çš„å‰ç§»åç§»æ“ä½œå°±å¦å½“åˆ«è®ºäº†ã€‚</p><hr /><h3 id="p5904-poi-2014-hot-hotels-åŠ å¼ºç‰ˆ">P5904 [POI 2014] HOT-Hotels åŠ å¼ºç‰ˆ</h3><p><a href="https://www.luogu.com.cn/problem/P5904" class="uri">https://www.luogu.com.cn/problem/P5904</a></p><p>é¦–å…ˆ <del>ä¸éš¾</del> å¾—åˆ° <span class="math inline">\(O(n^2)\)</span> åšæ³•ï¼šæ˜¾ç„¶å­˜åœ¨ä¸€ä¸ªç‚¹åˆ°ä¸‰ä¸ªç‚¹è·ç¦»ç›¸ç­‰ã€‚è¿™ä¸ªç‚¹æ—¢å¯èƒ½æ˜¯å®ƒä»¬çš„ LCAï¼Œä¹Ÿå¯èƒ½æ˜¯å…¶ä¸­ä¸€ä¸ªç‚¹çš„å­å­™ï¼Œå¦å¤–ä¸¤ä¸ªç‚¹çš„ LCAã€‚ç»¼ä¸Šï¼Œ<strong>åœ¨ LCA å¤„ç»Ÿè®¡ç­”æ¡ˆæ˜¯å¯è¡Œçš„</strong>ã€‚</p><p>ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤º <span class="math inline">\(i\)</span> å­æ ‘ä¸­è·ç¦» <span class="math inline">\(i\)</span> ä¸º <span class="math inline">\(j\)</span> çš„ç‚¹æ•°ï¼›<span class="math inline">\(g_{i,j}\)</span> è¡¨ç¤º <span class="math inline">\(i\)</span> å­æ ‘ä¸­è·ç¦» <span class="math inline">\(i\)</span> ä¸º <span class="math inline">\(j\)</span>ã€æˆ–è€…è· LCA ä¸º <span class="math inline">\(d\)</span> ä¸” LCA è·ç¦» <span class="math inline">\(i\)</span> ä¸º <span class="math inline">\(d-j\)</span> çš„ç‚¹å¯¹æ•°ï¼›éšä¾¿åšå°±å¯ä»¥äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g1[x].push_back(y), g1[y].push_back(x);    &#125;    auto res(0ll);    std::vector&lt;int&gt; h(n + 1);    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1), g(n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        h[x] = 1;        for (auto i : g1[x])            if (i != fa) &#123;                DFS(i, x);                h[x] = std::max(h[x], h[i] + 1);            &#125;        f[x].resize(h[x] + 1), g[x].resize(h[x] + 1);        f[x][0] = 1ll;        for (auto i : g1[x])            if (i != fa) &#123;                for (int j = 0; j &lt;= h[i]; ++j) &#123;                    if (j &gt;= 1)                        res += g[x][j] * f[i][j - 1];                    if (j &gt;= 1 &amp;&amp; j + 1 &lt;= h[i])                        res += f[x][j] * g[i][j + 1];                    if (j &gt;= 1) &#123;                        g[x][j] += f[x][j] * f[i][j - 1];                        f[x][j] += f[i][j - 1];                    &#125;                    if (j + 1 &lt;= h[i])                        g[x][j] += g[i][j + 1];                &#125;                std::vector&lt;long long&gt;().swap(f[i]);                std::vector&lt;long long&gt;().swap(g[i]);            &#125;        res += g[x][0];        return;    &#125;;    DFS(1, -1);    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><p>ç„¶åå¯¹äºæ¯ä¸ª <span class="math inline">\(u\)</span>ï¼Œç±»ä¼¼ DSU on treeï¼Œç»§æ‰¿å…¶é•¿å„¿å­çš„æ•°æ®ï¼ˆæ•´ä½“å‰ç§» / åç§»ä¸€ä½ï¼Œä½¿ç”¨æŒ‡é’ˆå®ç°ï¼‰ï¼Œå†æŠŠçŸ­å„¿å­æš´åŠ›åˆå¹¶ä¸Šæ¥ã€‚</p><p>æ¯æ¬¡åˆå¹¶çŸ­å„¿å­ï¼Œæ•°ç»„é•¿ä¸ºçŸ­å„¿å­é“¾é•¿ï¼›<span class="math inline">\(u\)</span> å‘ä¸Šåˆå¹¶æ—¶ï¼Œæ•°ç»„é•¿ä¸ºé•¿å„¿å­é“¾é•¿ã€‚æ•…æ‰€æœ‰é“¾è¢«åˆå¹¶æ°å¥½ä¸€æ¬¡ï¼Œå¤æ‚åº¦ <span class="math inline">\(O(n)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g1[x].push_back(y), g1[y].push_back(x);    &#125;    std::vector&lt;int&gt; h(n + 1), son(n + 1);    std::vector&lt;long long&gt; df(5 * n + 1), dg(5 * n + 1);    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;        h[x] = 1;        for (auto i : g1[x])            if (i != fa) &#123;                DFS(i, x);                h[x] = std::max(h[x], h[i] + 1);                if (h[i] &gt; h[son[x]])                    son[x] = i;            &#125;        return;    &#125;;    DFS(1, -1);    auto pos(dg.begin() + 3 * n);    std::vector&lt;decltype(df.begin())&gt; f(n + 1), g(n + 1);    auto res(0ll);    DFS = [&amp;](int x, int fa) &#123;        f[x][0] = 1ll;        if (son[x]) &#123;            f[son[x]] = std::next(f[x]), g[son[x]] = std::prev(g[x]);            DFS(son[x], x);        &#125;        for (auto i : g1[x])            if (i != fa &amp;&amp; i != son[x]) &#123;                f[i] = std::next(f[x], h[x] + 1);                std::fill(f[i], f[i] + h[i] + 2, 0ll);                g[i] = std::next(pos, h[i]), pos = std::next(g[i], h[i]);                std::fill(std::prev(g[i]), g[i] + h[i] + 2, 0ll);                DFS(i, x);                for (int j = 0; j &lt;= h[i]; ++j) &#123;                    if (j &gt;= 1)                        res += g[x][j] * f[i][j - 1];                    if (j &gt;= 1 &amp;&amp; j + 1 &lt;= h[i])                        res += f[x][j] * g[i][j + 1];                    if (j &gt;= 1) &#123;                        g[x][j] += f[x][j] * f[i][j - 1];                        f[x][j] += f[i][j - 1];                    &#125;                    if (j + 1 &lt;= h[i])                        g[x][j] += g[i][j + 1];                &#125;            &#125;        res += g[x][0];        return;    &#125;;    f[1] = df.begin(), g[1] = dg.begin() + 2 * n;    DFS(1, -1);    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="cf1585g-poachers">CF1585G Poachers</h3><p><a href="https://codeforces.com/problemset/problem/1585/G" class="uri">https://codeforces.com/problemset/problem/1585/G</a></p><p>å…¬å¹³åšå¼ˆã€‚æˆ‘ä»¬ç°åœ¨è¦ç®—æ¯ä¸ªæ ¹çš„ SG å€¼ã€‚è®¾ <span class="math inline">\(f_{u,j}\)</span> è¡¨ç¤ºåœ¨ç‚¹ <span class="math inline">\(u\)</span>ï¼Œåˆ äº†è·ç¦»å®ƒä¸º <span class="math inline">\(j\)</span> è¿™ä¸€å±‚çš„ SG å€¼ï¼Œé‚£ä¹ˆæœ‰ï¼š</p><p><span class="math display">\[f_{u,j}=\begin{cases}\text{mex}\{f_{v,0}\}&amp;j=0\\\bigoplus f_{v,j-1}&amp;\text{otherwise}\end{cases}\]</span></p><p>ç„¶åå‘ç°æœ‰æ·±åº¦ç»´ã€‚å¤§åŠ›é•¿å‰–ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n;        std::cin &gt;&gt; n;        std::vector&lt;int&gt; rt;        std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);        for (int i = 1, x; i &lt;= n; ++i) &#123;            std::cin &gt;&gt; x;            if (x)                g[x].push_back(i);            else                rt.push_back(i);        &#125;        std::vector&lt;int&gt; h(n + 1), son(n + 1), to(n + 1, inf);        std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;            h[x] = 1;            for (auto i : g[x]) &#123;                DFS(i);                h[x] = std::max(h[x], h[i] + 1);                to[x] = std::min(to[x], to[i] + 1);                if (h[i] &gt; h[son[x]])                    son[x] = i;            &#125;            to[x] = std::min(to[x], h[x]);            return;        &#125;;        for (auto i : rt)            DFS(i);        std::vector&lt;int&gt; _f(5 * n + 1), top(n + 1);        std::vector&lt;decltype(_f.begin())&gt; f(n + 1);        std::vector&lt;std::unordered_set&lt;int&gt; &gt; s(n + 1);        auto p(_f.begin());        DFS = [&amp;](int x) &#123;            if (son[x]) &#123;                f[son[x]] = std::next(f[x]);                top[son[x]] = top[x], DFS(son[x]);            &#125;            if ((int)g[x].size() == 1) &#123;                s[top[x]].insert(f[son[x]][0]);                for (int now = f[son[x]][0] + 1; ; ++now)                    if (!s[top[x]].count(now)) &#123;                        f[x][0] = now;                        break;                    &#125;                return;            &#125;            for (auto i : g[x])                if (i != son[x]) &#123;                    f[i] = p, p = std::next(p, h[i] + 1);                    top[i] = i, DFS(i);                    for (int j = 1; j &lt;= to[i] + 1; ++j)                        f[x][j] ^= f[i][j - 1];                &#125;            std::unordered_set&lt;int&gt;().swap(s[top[x]]);            for (int j = 1; j &lt;= to[x]; ++j)                s[top[x]].insert(f[x][j]);            for (int now = 0; ; ++now)                if (!s[top[x]].count(now)) &#123;                    f[x][0] = now;                    break;                &#125;            return;        &#125;;        int res = 0;        for (auto i : rt) &#123;            f[i] = p, p = std::next(p, h[i] + 1);            DFS(i), res ^= f[i][0];        &#125;        std::cout &lt;&lt; (res ? &quot;YES&quot; : &quot;NO&quot;) &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr />]]></content>
      
      
      
        <tags>
            
            <tag> æ ‘é“¾å‰–åˆ† </tag>
            
            <tag> é•¿é“¾å‰–åˆ† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­—ç¬¦ä¸²</title>
      <link href="/20241021/"/>
      <url>/20241021/</url>
      
        <content type="html"><![CDATA[<p>æ ‡é¢˜æœ¬æ¥å«ã€Œå“ˆå¸Œã€ï¼Œåæ¥å‘ç°ç¬¬äºŒå¤©çš„å¾ˆå¤šé¢˜è™½ç„¶æ‰“äº†å“ˆå¸Œçš„ tag ä½†æ˜¯åªæœ‰ KMP åšæ³•ï¼Œæ•…å¿ç—›æ”¹æˆã€Œå­—ç¬¦ä¸²ã€ã€‚</p><span id="more"></span><hr /><h2 id="a.-two-permutations">A. Two Permutations</h2><p><a href="http://222.180.160.110:61235/contest/5653/problem/1" class="uri">http://222.180.160.110:61235/contest/5653/problem/1</a></p><p>æœ‰ä¸ªå¾ˆé‡è¦çš„æ€§è´¨æ˜¯ <span class="math inline">\(a\)</span> å’Œ <span class="math inline">\(b\)</span> éƒ½æ˜¯æ’åˆ—ã€‚ç„¶åæˆ‘ä»¬å°±çŸ¥é“äº† <span class="math inline">\(x\in [0,m-n]\)</span>ï¼Œä¸”æ¯ä¸ª <span class="math inline">\(a_i+x\)</span> åœ¨ <span class="math inline">\(b\)</span> ä¸­æœ‰å…ƒç´ ä¸ä¹‹å”¯ä¸€å¯¹åº”ã€‚<mark>äºæ˜¯é—®é¢˜å¯ä»¥è½¬åŒ–æˆï¼Œ<span class="math inline">\(b\)</span> ä¸­åœ¨ <span class="math inline">\([1+x,n+x]\)</span> èŒƒå›´ä¸­çš„å…ƒç´ æŒ‰é¡ºåºå“ˆå¸Œèµ·æ¥å’Œ <span class="math inline">\(a\)</span> åºåˆ—æ˜¯å¦å®Œå…¨ä¸€è‡´</mark>ã€‚</p><p>æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªæƒ³æ³•ï¼šæšä¸¾è¿™ä¸ª <span class="math inline">\(x\)</span>ï¼Œé€šè¿‡æŸç§æ–¹æ³•å¿«é€ŸæŸ¥è¯¢è¿™ä¸ªé•¿åº¦å›ºå®šçš„å€¼åŸŸåŒºé—´æŒ‰é¡ºåºå“ˆå¸Œèµ·æ¥çš„å€¼ã€‚<mark>ç„¶åå°±æ˜¯å…¸ä¸­å…¸ä¹‹çº¿æ®µæ ‘ç»´æŠ¤å“ˆå¸Œï¼Œåªéœ€åœ¨æšä¸¾ <span class="math inline">\(x\)</span> æ—¶æ»‘åŠ¨çª—å£ï¼Œå‰”é™¤å¤´éƒ¨å…ƒç´ ï¼Œæ–°å¢å°¾éƒ¨å…ƒç´ ï¼ŒæŸ¥è¯¢å…¨å±€å“ˆå¸Œå€¼å³å¯</mark>ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚æ˜¯å…³äºå®æ—¶ç»´æŠ¤å…¨å±€åŠ  <span class="math inline">\(x\)</span> åçš„ <span class="math inline">\(a\)</span>ã€‚ç”±äºå“ˆå¸Œç”¨ä¹˜çš„è‚¯å®šæ‹†ä¸å¼€ï¼Œåªèƒ½ç”¨åŠ å“ˆå¸Œäº†ã€‚æ¯æ¬¡ <span class="math inline">\(x\)</span> åŠ ä¸€çš„æ—¶å€™å…¨å±€å“ˆå¸Œå€¼åŠ ä¸Š <span class="math inline">\(\sum p_i\)</span> å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int p = 998244353;const int mod = 1e9 + 7;const int maxn = 2e5 + 5;struct &#123;    int l, r, s;    long long u;&#125; t[maxn &lt;&lt; 2];long long base[maxn];#define lt (p &lt;&lt; 1)#define rt (lt | 1)void pushup(int p) &#123;    t[p].u = (t[lt].u * base[t[rt].s] % mod + t[rt].u) % mod;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r;    if (l == r)        return;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    return;&#125;void add(int p, int x, int v) &#123;    t[p].s += (v &gt;= 0 ? 1 : -1);    if (t[p].l == t[p].r) &#123;        t[p].u += v;        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (x &lt;= mid)        add(lt, x, v);    else        add(rt, x, v);    pushup(p);    return;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; a(n + 1), b(m + 1), pos(m + 1);    base[0] = 1;    long long s = 1;    for (int i = 1; i &lt;= m; ++i) &#123;        base[i] = base[i - 1] * p % mod;        if (i &lt; n)            (s += base[i]) %= mod;    &#125;    long long now = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        now = (now * p % mod + a[i]) % mod;    &#125;    for (int i = 1; i &lt;= m; ++i)        std::cin &gt;&gt; b[i], pos[b[i]] = i;    int res = 0;    bld(1, 1, m);    for (int x = 0; x &lt;= m - n; ++x) &#123;        for (static int l = 1; l &lt; 1 + x; add(1, pos[l], -l), ++l);            // printf(&quot;add %d: %d\n&quot;, pos[l], -l);        for (static int r = 1; r &lt;= n + x; add(1, pos[r], r), ++r);            // printf(&quot;add %d: %d\n&quot;, pos[r], r);        (res += (now == t[1].u));        // printf(&quot;x = %d, now = %lld, t[1].u = %lld\n&quot;, x, now, t[1].u);        (now += s) %= mod;    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="b.-k-substrings">B. k-substrings</h2><p><a href="http://222.180.160.110:61235/contest/5653/problem/2" class="uri">http://222.180.160.110:61235/contest/5653/problem/2</a></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°è¿™ <span class="math inline">\(\left\lceil\dfrac n2\right\rceil\)</span> ä¸ªä¸²éƒ½æœ‰å…±åŒä¸­ç‚¹ï¼Œè€Œ<mark>ä¸ç®¡å…¶ä½äºå…ƒç´ è¿˜æ˜¯å…ƒç´ é—´çš„ç©ºéš™ï¼Œä¸¤è¾¹çš„ border éƒ½åº”å…³äºå…¶å¯¹ç§°</mark>ã€‚å•¥å«å¥‡ border å‘¢ï¼Œå°±æ˜¯æ¯ä¸ª border éƒ½èƒ½å–åˆ°å…ƒç´ ä¸Šçš„ä¸­ç‚¹ï¼Œ<mark>ä¹Ÿå°±æ˜¯è¯´è¿™ä¿©ä¸­ç‚¹æ˜¯å…³äºå…¨ä¸²ä¸­ç‚¹å¯¹ç§°çš„</mark>ã€‚</p><p>æˆ‘ä»¬æšä¸¾è¿™ <span class="math inline">\(\left\lfloor\dfrac n2\right\rfloor\)</span> å¯¹å¯èƒ½çš„ border ä¸­ç‚¹ï¼Œåˆ†åˆ«äºŒåˆ† border é•¿åº¦ã€‚å‡è®¾æœ€åè¯¥å¯¹ä¸­ç‚¹æœ€é•¿åˆæ³• border ä¸º <span class="math inline">\([l_1,r_1]\)</span> ä¸ <span class="math inline">\([l_2,r_2]\)</span>ï¼Œç”¨ <span class="math inline">\(r_1-l_1+1-2\times k\)</span> æ›´æ–° <span class="math inline">\(l_1+k\)</span> å¤„çš„ç­”æ¡ˆå³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int p = 131;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;char&gt; a(n + 1);    std::vector&lt;int&gt; res(n + 1, -1);    std::vector&lt;long long&gt; h(n + 1), base(n + 1);    base[0] = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        h[i] = (h[i - 1] * p + a[i]) % mod;        base[i] = base[i - 1] * p % mod;    &#125;    auto geth = [&amp;](int l, int r) &#123;        return (h[r] + mod - h[l - 1] * base[r - l + 1] % mod) % mod;    &#125;;    for (int l = n / 2, r = (n + 1) / 2 + 1; r &lt;= n; --l, ++r)        if (a[l] == a[r]) &#123;            int t = 0;            for (int ll = 1, rr = l, mid; ll &lt;= rr; ) &#123;                mid = (ll + rr) &gt;&gt; 1;                if (geth(l - mid + 1, l + mid - 1) == geth(r - mid + 1, r + mid - 1))                    t = mid, ll = mid + 1;                else                    rr = mid - 1;            &#125;            res[l - t + 1] = std::max(res[l - t + 1], 2 * t - 1);        &#125;    for (int i = 1; i &lt;= (n + 1) / 2; ++i) &#123;        res[i] = std::max(res[i - 1] - 2, res[i]);        std::cout &lt;&lt; res[i] &lt;&lt; &#39; &#39;;    &#125;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="c.-kefa-and-watch">C. Kefa and Watch</h2><p><a href="http://222.180.160.110:61235/contest/5653/problem/3" class="uri">http://222.180.160.110:61235/contest/5653/problem/3</a></p><p>ä¸€ä¸ªæŒºå¸¸ç”¨çš„ trick æ˜¯ï¼Œ<mark><span class="math inline">\(S_{l\sim r}\)</span> å­˜åœ¨é•¿åº¦ä¸º <span class="math inline">\(d\)</span> çš„å¾ªç¯èŠ‚ <span class="math inline">\(\iff S_{l\sim (r-d)}=S_{(l+d+)\sim r}\)</span></mark>ã€‚è€Œé¢˜ç›®è¦æ±‚ä¸ºæ··å¾ªç¯èŠ‚ï¼Œåˆšå¥½ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•åˆ¤å®šã€‚çº¿æ®µæ ‘éšä¾¿ç»´æŠ¤ä¸€ä¸‹å“ˆå¸Œå°±è¡Œã€‚assign æ“ä½œå°±æ˜¯å°†é•¿åº¦ä¸º <span class="math inline">\(len\)</span> çš„åŒºé—´å“ˆå¸Œå€¼æ›´æ”¹ä¸º <span class="math inline">\(t\times \sum_{i=0}^{len-1}p^i\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int p = 131;const int mod = 1e9 + 7;const int maxn = 1e5 + 5;struct &#123;    int l, r, d;    long long u;&#125; t[maxn &lt;&lt; 2];int a[maxn];long long base[maxn], s[maxn];#define lt (p &lt;&lt; 1)#define rt (lt | 1)void pushup(int p) &#123;    t[p].u = (t[lt].u * base[t[rt].r - t[rt].l + 1] % mod + t[rt].u) % mod;    return;&#125;void pushdown(int p) &#123;    if (~t[p].d) &#123;        t[lt].d = t[rt].d = t[p].d;        t[lt].u = t[p].d * s[t[lt].r - t[lt].l] % mod;        t[rt].u = t[p].d * s[t[rt].r - t[rt].l] % mod;        t[p].d = -1;    &#125;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r, t[p].d = -1;    if (l == r) &#123;        t[p].u = a[l];        return;    &#125;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    pushup(p);    return;&#125;void ass(int p, int l, int r, int v) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        t[p].d = v;        t[p].u = v * s[t[p].r - t[p].l] % mod;        return;    &#125;    pushdown(p);    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (l &lt;= mid)        ass(lt, l, r, v);    if (r &gt; mid)        ass(rt, l, r, v);    pushup(p);    return;&#125;long long ask(int p, int l, int r) &#123;    // printf(&quot;p = %d, u = %lld, [%d, %d] of [%d, %d]\n&quot;, p, t[p].u, t[p].l, t[p].r, l, r);    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p].u;    pushdown(p);    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (r &lt;= mid)        return ask(lt, l, r);    if (l &gt; mid)        return ask(rt, l, r);    return (ask(lt, l, r) * base[std::min(r, t[p].r) - mid] % mod + ask(rt, l, r)) % mod;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, k;    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; k;    base[0] = s[0] = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        char t;        std::cin &gt;&gt; t;        a[i] = t - &#39;0&#39;;        base[i] = base[i - 1] * p % mod;        s[i] = (s[i - 1] + base[i]) % mod;    &#125;    bld(1, 1, n);    for (int q = m + k; q--; ) &#123;        int op;        std::cin &gt;&gt; op;        if (op == 1) &#123;            int l, r, t;            std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; t;            ass(1, l, r, t);        &#125;        else &#123;            int l, r, d;            std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; d;            // if (d != r - l + 1)            //     printf(&quot;%lld / %lld\n&quot;, ask(1, l, r - d), ask(1, l + d, r));            std::cout &lt;&lt; ((d == r - l + 1 || ask(1, l, r - d) == ask(1, l + d, r)) ? &quot;YES&quot; : &quot;NO&quot;) &lt;&lt; &#39;\n&#39;;        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="d.-misha-and-lcp-on-tree">D. Misha and LCP on Tree</h2><p><a href="http://222.180.160.110:61235/contest/5653/problem/4" class="uri">http://222.180.160.110:61235/contest/5653/problem/4</a></p><p>ä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„åšæ³•æ˜¯ï¼Œæˆ‘ä»¬äºŒåˆ†ä¸€ä¸ªé•¿åº¦ï¼Œç„¶ååœ¨ <span class="math inline">\(a\to fa\)</span> ä¸Šæ­£å“ˆå¸Œï¼Œ<span class="math inline">\(b\to fa\)</span> ä¸Šåå“ˆå¸Œï¼Œ<span class="math inline">\(O(1)\)</span> checkã€‚</p><p>ç¬‘è¯ï¼šæœ¬æ¥æƒ³ç”¨å€å¢æ±‚ <span class="math inline">\(a\to fa\)</span> å’Œ <span class="math inline">\(b\to fa\)</span> çš„å“ˆå¸Œï¼ˆå½“ç„¶åŒ <span class="math inline">\(\log\)</span> è‚¯å®šæ˜¯ä¼šè¢«å¡é£çš„ï¼‰ï¼Œåæ¥å‘ç°<mark>å“ˆå¸Œå…·æœ‰å¯å‡æ€§ï¼Œæˆ‘ä»¬åˆåªéœ€æ±‚ä¸€æ¡é“¾ä¸Šçš„å“ˆå¸Œå€¼ï¼Œç›´æ¥å‡æ‰å°±è¡Œ</mark>ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªç‚¹å°±æ˜¯ <span class="math inline">\(O(1)\)</span> æ±‚ <span class="math inline">\(k\)</span> çº§ç¥–å…ˆï¼Œæœ‰é•¿å‰–é¢„å¤„ç†çš„åšæ³•ã€‚<a href="/20241021-1">å…·ä½“åšæ³•</a>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int p = 131;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; to(n + 1);    std::vector&lt;char&gt; a(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);    std::vector&lt;long long&gt; base(n + 1), inv(n + 1);    auto qkp = [](long long x, int y) &#123;        long long res = 1;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    base[0] = inv[0] = 1;    for (int i = 1, mx = 0; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        base[i] = base[i - 1] * p % mod;        inv[i] = qkp(base[i], mod - 2);        if (i &gt;= (1 &lt;&lt; mx) * 2)            ++mx;        to[i] = mx;    &#125;    for (int i = 1, x, y; i &lt; n; ++i) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        g[x].push_back(y), g[y].push_back(x);    &#125;    std::vector&lt;long long&gt; h1(n + 1), h2(n + 1);    std::vector&lt;std::array&lt;int, 21&gt; &gt; fa(n + 1);    std::vector&lt;int&gt; h(n + 1, 1), son(n + 1), dep(n + 1);    h[0] = 0;    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;        h1[x] = (h1[fa[x][0]] * p % mod + a[x]) % mod;        h2[x] = (h2[fa[x][0]] + a[x] * base[dep[x] - 1]) % mod;        for (auto i : g[x])            if (i != fa[x][0]) &#123;                fa[i][0] = x;                for (int j = 1; j &lt;= 20; ++j)                    fa[i][j] = fa[fa[i][j - 1]][j - 1];                dep[i] = dep[x] + 1;                DFS(i);                if (h[i] &gt;= h[son[x]])                    son[x] = i, h[x] = h[i] + 1;            &#125;        return;    &#125;;    dep[1] = 1, DFS(1);    std::vector&lt;int&gt; top(n + 1), id(n + 1);    std::vector&lt;std::vector&lt;int&gt; &gt; anc(n + 1), des(n + 1, std::vector&lt;int&gt; (1));    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int toq) &#123;        top[x] = toq;        if (son[x])            DFS1(son[x], toq);        for (auto i : g[x])            if (i != fa[x][0] &amp;&amp; i != son[x])                DFS1(i, i);        des[toq].push_back(x);        id[x] = (int)des[toq].size() - 1;        if (x == toq) &#123;            anc[x].push_back(x);            for (int j = 1, now = x; j &lt;= id[x]; ++j, now = fa[now][0])                anc[x].push_back(fa[now][0]);        &#125;        return;    &#125;;    DFS1(1, 1);    auto getLCA = [&amp;](int x, int y) &#123;        if (dep[x] &lt; dep[y])            std::swap(x, y);        for (int i = 20; ~i; --i)            if (dep[fa[x][i]] &gt;= dep[y])                x = fa[x][i];        if (x == y)            return x;        for (int i = 20; ~i; --i)            if (fa[x][i] != fa[y][i])                x = fa[x][i], y = fa[y][i];        return fa[x][0];    &#125;;    auto ask = [&amp;](int x, int k) &#123;        assert(dep[x] - 1 &gt;= k);        int x1 = x;        if (!k)            return x;        x = fa[x][to[k]];        if (dep[x] - dep[top[x]] &gt;= k - (1 &lt;&lt; to[k]))            return des[top[x]][id[x] + k - (1 &lt;&lt; to[k])];        return anc[top[x]][k - (1 &lt;&lt; to[k]) - (dep[x] - dep[top[x]])];    &#125;;    auto dis = [&amp;](int x, int y, int fa) &#123;        return dep[x] + dep[y] - 2 * dep[fa];    &#125;;    auto gethash = [&amp;](int x, int y, int f, int k) &#123;        if (!k)            return 0ll;        if (k &lt;= dep[x] - dep[f] + 1) &#123;            f = ask(x, k - 1);            return (h2[x] + mod - h2[fa[f][0]]) % mod * inv[dep[f] - 1] % mod;        &#125;        long long h = (h2[x] + mod - h2[fa[f][0]]) % mod * inv[dep[f] - 1] % mod;        k -= (dep[x] - dep[f] + 1);        y = ask(y, (dep[y] - dep[f]) - k);        h = (h * base[dep[y] - dep[f]] % mod + (h1[y] + mod - h1[f] * base[dep[y] - dep[f]] % mod) % mod) % mod;        return h;    &#125;;    int m;    std::cin &gt;&gt; m;    for (int x, y, a, b; m--; ) &#123;        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; a &gt;&gt; b;        int fa1 = getLCA(x, y), fa2 = getLCA(a, b), res = 0;        for (int l = 0, r = std::min(dis(x, y, fa1), dis(a, b, fa2)) + 1, mid; l &lt;= r; ) &#123;            mid = (l + r) &gt;&gt; 1;            if (gethash(x, y, fa1, mid) == gethash(a, b, fa2, mid))                res = mid, l = mid + 1;            else                r = mid - 1;        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="a.-song-of-the-sirens">A. Song of the Sirens</h2><p><a href="http://222.180.160.110:61235/contest/5658/problem/1" class="uri">http://222.180.160.110:61235/contest/5658/problem/1</a></p><p>ç¬‘è¯ï¼šæ˜¯ <span class="math inline">\(s_it_is_i\)</span> è€Œä¸æ˜¯ <span class="math inline">\(s_its_i\)</span>ã€‚</p><p>æˆ‘ä»¬å‘ç° <span class="math inline">\(s_0\)</span> å¾ˆçŸ­ï¼Œæ‰€ä»¥ç›´æ¥æšä¸¾èµ·å§‹ä½ç½®æŠŠ <span class="math inline">\(s_0\)</span> å’ŒåŒ¹é…ä¸²å¤§åŠ›åŒ¹é…ï¼ŒæŠŠç©ºä½æŒ–å‡ºæ¥ç»„æˆæ–°çš„åŒ¹é…ä¸²å†è€ƒè™‘ <span class="math inline">\(t\)</span> çš„é—®é¢˜ï¼ˆå› ä¸ºæ‰€æœ‰ <span class="math inline">\(s_i\)</span> æœ€å¼€å¤´éƒ½æœ‰ä¸€ä¸ªå®Œæ•´çš„ <span class="math inline">\(s_0\)</span>ï¼Œæ‰€ä»¥å¯ä»¥éšä¾¿é€‰æ–­ç‚¹ï¼‰ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ <span class="math inline">\(t\)</span> çš„ä¸‹æ ‡æ˜¯ä¸€ä¸ªè‡ªåº•å‘ä¸Šä» <span class="math inline">\(1\)</span> åˆ° <span class="math inline">\(n\)</span> çš„æ»¡äºŒå‰æ ‘çš„ä¸­åºéå†ï¼Œå…¶ä¸­ <mark><span class="math inline">\(t_1\)</span> é—´éš”ä¸€ä½å‡ºç°ï¼›äºæ˜¯æˆ‘ä»¬ä»¿ç…§å¯¹ <span class="math inline">\(s\)</span> çš„å¤„ç†æ–¹å¼ï¼Œå†æŠŠ <span class="math inline">\(t_1\)</span> æŒ–æ‰ã€‚æ³¨æ„åˆ°æ­¤æ—¶ <span class="math inline">\(t_2\)</span> åˆæˆä¸ºäºŒå‰æ ‘æœ€åº•å±‚ï¼Œé—´éš”ä¸€ä½å‡ºç°ï¼Œè¿™å°±å˜æˆäº†ä¸€ä¸ª <span class="math inline">\(\mathcal O(n\log n)\)</span> é€’å½’çš„é—®é¢˜</mark>ã€‚</p><p>è‡³äºç­”æ¡ˆï¼Œå½“ <span class="math inline">\(t\)</span> è¢«åˆ ç©ºæ—¶ï¼Œå‡è®¾åˆ æ‰çš„æœ€åä¸€ä¸ªå…ƒç´ ä¸º <span class="math inline">\(t_p\)</span>ï¼Œ<span class="math inline">\(t\)</span> çš„å‡ºç°æ¬¡æ•°å³ä¸ºäºŒå‰æ ‘ä¸­ <span class="math inline">\(p\)</span> å±‚ç‚¹æ•°ï¼Œä¸º <span class="math inline">\(2^{k-p}\)</span>ã€‚</p><p>æœ‰ä¸€ä¸ªç»†èŠ‚ï¼Œå°±æ˜¯å¦‚æœå½“å‰åˆ åˆ° <span class="math inline">\(i\)</span> äº†ï¼Œ<span class="math inline">\(t\)</span> çš„é•¿åº¦åªå‰© <span class="math inline">\(1\)</span>ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªå¾ˆå°´å°¬çš„é—®é¢˜â€”â€”è¿™ä¸ªå…ƒç´ ä¸ä¸€å®šå°±æ˜¯ <span class="math inline">\(t_i\)</span>ï¼Œè€Œåº”è¯¥æ˜¯ <span class="math inline">\(\{j \mid j\ge i\land t_j=t_i\}\)</span>ã€‚ç»Ÿè®¡ <span class="math inline">\(t_{i\sim k}\)</span> ä¸­å€¼ä¸º <span class="math inline">\(t_i\)</span> çš„å…ƒç´ ä¸ªæ•°ï¼ˆå‰ç¼€å’Œï¼‰ï¼Œä¹˜ä¸Šå¯¹åº”çš„å±‚æ•°å³å¯ã€‚è¿™ä¸ªå¯ä»¥ç”¨ä¸€ç‚¹å°æŠ€å·§æå®šï¼Œå‰ç¼€å’Œæ—¶å¿½ç•¥ <span class="math inline">\(k\)</span> ä¹˜ä¸Š <span class="math inline">\(k=n\)</span> æ—¶çš„ç³»æ•°ï¼Œç»Ÿè®¡ç­”æ¡ˆæ—¶ä¹˜ä¸Š <span class="math inline">\(2^{n-k}\)</span> å³å¯ã€‚</p><p>ä¸æ˜¯ï¼Œé‚£æˆ‘ç¼ºçš„å“ˆå¸Œè¿™å—è°æ¥è¡¥å•Šï¼Ÿï¼Ÿï¼Ÿ</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;sirens1.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, q, m;    std::string s;    std::cin &gt;&gt; n &gt;&gt; q &gt;&gt; s;    s = &#39;\0&#39; + s, m = (int)s.length() - 1;    std::vector&lt;char&gt; t(n + 1);    std::vector&lt;long long&gt; base(n + 1), inv(n + 1);    std::vector&lt;std::array&lt;long long, 26&gt; &gt; a(n + 1);    auto qkp = [](long long x, int y) &#123;        long long res = 1ll;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    base[0] = 1ll, inv[0] = 1ll, inv[1] = qkp(2, mod - 2);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; t[i];        base[i] = base[i - 1] * 2 % mod;        if (i != 1)            inv[i] = inv[i - 1] * inv[1] % mod;    &#125;    for (int i = 1; i &lt;= n; ++i)        a[i] = a[i - 1], (a[i][t[i] - &#39;a&#39;] += base[n - i]) %= mod;    for (int k; q--; ) &#123;        std::string p;        std::cin &gt;&gt; k &gt;&gt; p;        p = &#39;\0&#39; + p;        long long res = 0;        int l = (int)p.length() - 1;        std::vector&lt;char&gt; u;        std::function&lt;void(int, std::vector&lt;char&gt; &amp;)&gt; calc = [&amp;](int x, std::vector&lt;char&gt; &amp;p) &#123;            int m = (int)p.size() - 1;            if (m == 0) &#123;                // puts(&quot;# 45&quot;);                // printf(&quot;0, += %lld\n&quot;, base[k - x + 1]);                (res += base[k - x + 1]) %= mod;                return;            &#125;            if (x &gt; k)                return;            if (m == 1) &#123;                // puts(&quot;# 50&quot;);                // printf(&quot;1, += %lld(%lld)\n&quot;, (a[k][p[1] - &#39;a&#39;] + mod - a[x - 1][p[1] - &#39;a&#39;]) % mod * inv[n - k] % mod, inv[n - k] % mod);                (res += (a[k][p[1] - &#39;a&#39;] + mod - a[x - 1][p[1] - &#39;a&#39;]) % mod * inv[n - k] % mod) %= mod;                return;            &#125;            bool flag0 = 1, flag1 = 1;            std::vector&lt;char&gt; t0(1), t1(1);            for (int i = 1; i &lt;= m; ++i)                if (!(i &amp; 1)) &#123;                    if (flag0)                        t0.push_back(p[i]);                    flag1 &amp;= (p[i] == t[x]);                &#125;                else &#123;                    if (flag1)                        t1.push_back(p[i]);                    flag0 &amp;= (p[i] == t[x]);                &#125;            if (flag0)                calc(x + 1, t0);            if (flag1)                calc(x + 1, t1);            return;        &#125;;        for (int i = 1; i &lt;= m + 1; ++i) &#123;            std::vector&lt;char&gt;(1).swap(u);            for (int j = i, now = 1; now &lt;= l; ++now) &#123;                if (j == m + 1)                    j = 1, u.push_back(p[now]);                else if (p[now] != s[j])                    goto nosol;                else                    ++j;            &#125;            // printf(&quot;u: &quot;);            // for (int i = 1; i &lt; (int)u.size(); ++i)            //     std::cout &lt;&lt; u[i];            // puts(&quot;&quot;);            calc(1, u);        nosol: ;        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="b.-prefix-of-suffixes">B. Prefix of Suffixes</h2><p><a href="http://222.180.160.110:61235/contest/5658/problem/2" class="uri">http://222.180.160.110:61235/contest/5658/problem/2</a></p><p>è¿˜æ˜¯å¤ªç§‘å¹»äº†ã€‚å“¦å“¦ border æˆ‘çš„ borderã€‚</p><h3 id="æ³•ä¸€">æ³•ä¸€</h3><p>è€ƒè™‘æ¯æ¬¡å¢é‡ï¼Œè‹¥åŠ å…¥ <span class="math inline">\(S_i\)</span> åæœ‰ <span class="math inline">\(z_j\)</span> çš„å€¼å¢åŠ  <span class="math inline">\(1\)</span>ï¼Œé‚£ä¹ˆè¿™å¯¹ <span class="math inline">\((i, j)\)</span> å°±ä¼šè´¡çŒ® <span class="math inline">\(A_j\cdot B_i\)</span> çš„å¢é‡ï¼›<mark>åä¹‹ï¼Œ<span class="math inline">\(z_j\)</span> åœ¨ä»¥åä¹Ÿä¸ä¼šå¢åŠ </mark>ã€‚</p><p>æˆ‘ä»¬ç»´æŠ¤å½“å‰æ²¡æœ‰ç¡®å®šä¸‹æ¥çš„æ‰€æœ‰ <span class="math inline">\(z_j\)</span>ï¼Œå¯¹äºæ¯ä¸ª <span class="math inline">\(i\)</span> æš´åŠ› check <span class="math inline">\(z_j\)</span> æ˜¯å¦ç¡®å®šå¹¶æ›´æ–°ç­”æ¡ˆï¼Œ<strong>å› ä¸ºæ•°æ®æ¯”è¾ƒå¼±</strong>ï¼Œåœ¨ CF ç¥æœºä¸Šè·‘å¾—é£å¿« <img src="/em/dy.gif" /> ä½†æ˜¯ QOJ ä¸Šæ­»æ´»è¿‡ä¸äº† <img src="/em/ll.gif" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    long long res = 0, s = 0;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; now;    std::vector&lt;int&gt; a(n + 1), b(n + 1), t(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; t[i] &gt;&gt; a[i] &gt;&gt; b[i];        t[i] = (res + t[i]) % n;        if (t[i] == t[1])            s += b[i], now.push_back(i);        std::vector&lt;int&gt; g(std::move(now));        for (auto j : g)            if (t[i] == t[i - j + 1])                now.push_back(j);            else                s -= b[j];        res += a[i] * s;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><h3 id="æ³•äºŒ">æ³•äºŒ</h3><p>ä¾ç„¶è€ƒè™‘å¢é‡ã€‚<mark><span class="math inline">\(z_j\)</span> å¢åŠ  <span class="math inline">\(\iff S_{j\to i}\)</span> ä¸º <span class="math inline">\(S_{1\sim i}\)</span> çš„ä¸€ä¸ª border</mark>ã€‚è€ƒè™‘å¯¹äºæ¯ä¸€ä¸ª <span class="math inline">\(S_i\)</span>ï¼Œborder çš„ç»„æˆã€‚</p><ol type="1"><li>è‹¥ <span class="math inline">\(S_1=S_i\)</span>ï¼Œé‚£ä¹ˆå°†ä¼šæ–°å¢ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(1\)</span> çš„ borderã€‚</li><li>å¯¹äºåœ¨ <span class="math inline">\(i-1\)</span> å¤„åˆæ³•çš„ border <span class="math inline">\(S_{j\sim i-1}\)</span>ï¼Œè‹¥ <span class="math inline">\(S_i=S_{i-j+1}\)</span>ï¼Œåˆ™è¯¥ border ä»åˆæ³•ï¼›å¦åˆ™éæ³•ã€‚</li></ol><p>æˆ‘ä»¬çš„æ³•ä¸€å…¶å®ç›¸å½“äºæ˜¯æš´åŠ› check äº†æ‰€æœ‰åˆæ³• border æ˜¯å¦ä»ç„¶åˆæ³•ï¼Œä½†è¿™æ˜¾ç„¶æœ€åæ˜¯ <span class="math inline">\(O(n^2)\)</span> çš„ã€‚æˆ‘ä»¬è€ƒè™‘ä» border è§’åº¦ä¼˜åŒ–ä¸€ä¸‹ã€‚</p><p>æˆ‘ä»¬å‘ç°ï¼Œæ¯”å¦‚è¯´ <span class="math inline">\(\texttt{abababa + b}\)</span>ï¼Œæˆ‘ä»¬ä¼šè¿›è¡Œå¾ˆå¤šæ¬¡ä¸å¿…è¦çš„ checkï¼Œå½“ç„¶è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¼šæœ¬èƒ½å¤§åŠ›è·³ failï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ª <a href="https://www.luogu.com/article/e08ebmz6">border çš„ç­‰å·®æ•°åˆ—æ€§è´¨</a>ï¼Œè‹¥ <span class="math inline">\(x+1\)</span> ä¸ <span class="math inline">\(i\)</span> èƒ½å¤ŸåŒ¹é…ï¼Œé‚£ä¹ˆä¸ <span class="math inline">\(x\)</span> åŒå±ä¸€ä¸ªç­‰å·®æ•°åˆ—çš„æ‰€æœ‰ <span class="math inline">\(x&#39;+1\)</span> éƒ½åº”å’Œ <span class="math inline">\(i\)</span> åŒ¹é…ã€‚</p><p>å¯¹äºæ­£åœ¨ check çš„ <span class="math inline">\(x\)</span>ï¼Œå¦‚æœ check æˆåŠŸåˆ™è·³åˆ°ä¸Šä¸€æ¡é“¾çš„é“¾å°¾ï¼›å¦åˆ™è·³åˆ°é“¾å¤´ã€‚æ€»çš„å¤æ‚åº¦æ˜¯ <span class="math inline">\(O(n\log n)\)</span> çš„ã€‚æ‰¾ä¸€ä¸‹å’Œæ¯ä¸ª <span class="math inline">\(i\)</span> åŒ¹é…ä¸äº†çš„ç¬¬ä¸€ä¸ªé“¾å¤´ï¼Œç”šè‡³å¯ä»¥å› ä¸ºæŸäº›æˆ‘å¤ªèœäº†æ‰€ä»¥ä¸çŸ¥é“çš„ä¸æ˜åŸå› æ•´åˆ°çº¿æ€§ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    long long res = 0, s = 0;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1), b(n + 1), t(n + 1), ne(n + 1), to(n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; t[i] &gt;&gt; a[i] &gt;&gt; b[i];        t[i] = (res + t[i]) % n;        if (i == 1)            s += b[i], res = (long long)a[i] * b[i];        else &#123;            int j = ne[i - 1];            for (; j &amp;&amp; t[j + 1] != t[i]; j = ne[j]);            if (t[j + 1] == t[i])                ++j;            ne[i] = j;            if (t[i] == t[1])                s += b[i];            to[i - 1] = (t[ne[i - 1] + 1] == t[i] ? to[ne[i - 1]] : ne[i - 1]);            for (int j = i - 1; j; )                if (t[j + 1] == t[i])                    j = to[j];                else                    for (int at = to[j]; j != at; s -= b[i - j], j = ne[j]);            res += a[i] * s;        &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="c.-matching">C. Matching</h2><p><a href="http://222.180.160.110:61235/contest/5658/problem/3" class="uri">http://222.180.160.110:61235/contest/5658/problem/3</a></p><p>æˆ‘ä»¬å‘ç°ï¼Œå¦‚æœæˆ‘ä»¬ç›´æ¥è¦ check ä¸€æ®µ <span class="math inline">\(a\)</span> å’Œ <span class="math inline">\(p\)</span>ï¼Œæ„Ÿè§‰ä¸å¤ªå¥½æ•´ã€‚</p><p>ç„¶åè€ƒè™‘è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼Œå‡å¦‚æˆ‘ä»¬é€šè¿‡ç¥ç§˜æ–¹æ³•è®©æˆ‘ä»¬æ¯æ¬¡ check çš„ <span class="math inline">\(a\)</span></p>]]></content>
      
      
      
        <tags>
            
            <tag> å“ˆå¸Œ </tag>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> KMP </tag>
            
            <tag> border </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ¨¡æ‹Ÿèµ›</title>
      <link href="/20241017/"/>
      <url>/20241017/</url>
      
        <content type="html"><![CDATA[<p>å¥½æ¶ˆæ¯ï¼šä¼šç®€å•æ•°å­¦é¢˜ <img src="/em/dy.gif" /></p><p>æ›´å¥½çš„æ¶ˆæ¯ï¼šå¿˜å–æ¨¡äº† <img src="/em/dy.gif" /></p><span id="more"></span><hr /><h3 id="a.-distorted">A. distorted</h3><p><a href="http://222.180.160.110:61235/contest/5611/problem/1" class="uri">http://222.180.160.110:61235/contest/5611/problem/1</a></p><p>è€ƒè™‘æœ€å¤šéœ€è¦å¤šå°‘ä¸ªå…ƒç´ ã€‚æœ€åæƒ…å†µæ˜¯é€‰å–å››ä¸ªè§’çš„å…ƒç´ ï¼Œå·²ç»å¯ä»¥è¦†ç›–æ•´ä¸ªçŸ©é˜µã€‚è¿›ä¸€æ­¥è€ƒè™‘æ„Ÿæ€§åè¯å‘ç°æ— è®ºå¦‚ä½•éƒ½é€‰ä¸å‡ºæ¥äº”ä¸ªï¼Œæ•…æœ€å¤šé€‰æ‹©å››ä¸ªã€‚</p><p>æˆ‘ä»¬å‘ç°ï¼Œé€‰å–ä¸­é—´ä¸€ä¸ªå°±å¯ä»¥è¦†ç›–æ•´ä¸ªçŸ©é˜µã€‚æ‰©å±•ä¸€ä¸‹ï¼Œé€‰æ‹©ä¸­é—´åˆ—å°±å¯ä»¥è¦†ç›–ä¸Š / ä¸‹åŠä¸ªçŸ©é˜µï¼Œé€‰æ‹©ä¸­é—´è¡Œå°±å¯ä»¥è¦†ç›–å·¦ / å³åŠä¸ªçŸ©é˜µã€‚å‰©ä¸‹çš„é€‰æ‹©è¿‡ååªèƒ½ä¿è¯ç…§é¡¾åˆ°å¯¹åº”çš„ 1/4 çŸ©é˜µä¸”ä¸€å®šä¸ä¼šå®Œå…¨è¦†ç›–å…¶ä»–çš„ 1/4 çŸ©é˜µã€‚</p><p>æˆ‘ä»¬å‘ç°ï¼Œä¸­å¿ƒå…ƒç´ åœ°ä½é«˜äºä¸­é—´è¡Œ / åˆ—å…ƒç´ é«˜äºå·¦ä¸Šã€å·¦ä¸‹ã€å³ä¸Šã€å³ä¸‹å…ƒç´ ã€‚ç”±æ­¤å‡ºå‘è®¨è®ºé€‰æ‹©å…ƒç´ çš„ä¸ªæ•°ã€‚</p><ul><li>1 ä¸ªï¼šé€‰æ‹©ä¸­å¿ƒå…ƒç´ ã€‚</li><li>2 ä¸ªï¼šåœ¨ä¸­é—´è¡Œçš„å·¦å³ä¸¤è¾¹å„é€‰ä¸€ä¸ª / åœ¨ä¸­é—´åˆ—çš„ä¸Šä¸‹ä¸¤è¾¹å„é€‰ä¸€ä¸ªã€‚</li><li>3 ä¸ªï¼šé€‰ä¸€ä¸ªä¸­é—´è¡Œ / åˆ— + ä¸¤ä¸ªå…¶ä»–å…ƒç´ ï¼Œæˆ–ä¸¤ä¸ªä¸­é—´è¡Œ / åˆ— + ä¸€ä¸ªå…¶ä»–å…ƒç´ ã€‚</li><li>4 ä¸ªï¼šå·¦ä¸Šã€å·¦ä¸‹ã€å³ä¸Šã€å³ä¸‹å„é€‰ä¸€ä¸ªã€‚</li></ul><p>ç»Ÿè®¡å„ä¸ªæ–¹å‘çš„æœ€å°å€¼ï¼Œé€‰æœ€å°ç»„åˆå³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;#define putcharconst long long inf = 0x3f3f3f3f;int main() &#123;    freopen(&quot;distorted.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;distorted.out&quot;, &quot;w&quot;, stdout);    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n;        std::cin &gt;&gt; n;        long long to = inf, u = inf, d = inf, l = inf, r = inf, q = inf, z = inf, p = inf, m = inf;        for (int i = 1; i &lt;= n; ++i)            for (int j = 1; j &lt;= n; ++j) &#123;                long long x;                std::cin &gt;&gt; x;                if (i * 2 - 1 == n &amp;&amp; j * 2 - 1 == n)                    to = x;                else if (i * 2 - 1 == n &amp;&amp; j * 2 - 1 &lt; n)                    l = std::min(l, x);                else if (i * 2 - 1 == n)                    r = std::min(r, x);                else if (i * 2 - 1 &lt; n &amp;&amp; j * 2 - 1 == n)                    u = std::min(u, x);                else if (j * 2 - 1 == n)                    d = std::min(d, x);                else if (i * 2 - 1 &lt; n &amp;&amp; j * 2 - 1 &lt; n)                    q = std::min(q, x);                else if (i * 2 - 1 &lt; n)                    p = std::min(p, x);                else if (j * 2 - 1 &lt; n)                    z = std::min(z, x);                else                    m = std::min(m, x);            &#125;        std::cout &lt;&lt; std::min(&#123; to, l + r, u + d, l + u + m, l + d + p, r + u + z, r + d + q, u + z + m, d + q + p, l + p + m, r + q + z, q + p + z + m &#125;) &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="b.-fate">B. fate</h3><p><a href="http://222.180.160.110:61235/contest/5611/problem/2" class="uri">http://222.180.160.110:61235/contest/5611/problem/2</a></p><p>è¯ˆéª—é¢˜ã€‚å¯¹äºå‰åŠæ®µï¼Œè€ƒè™‘å–å·®åˆ†æ•°ç»„ <span class="math inline">\(d\)</span>ï¼Œå®¹æ˜“å‘ç°å¦‚æœç›´æ¥åœ¨å·®åˆ†æ•°ç»„ä¸Šåšå‡æ³•ï¼Œä¸€å®šæ»¡è¶³åé¢å‡å¾—ä¸æ¯”å‰é¢å°‘ã€‚æ•…åªè¦æ»¡è¶³å·®åˆ†æ•°ç»„æ¯ä¸€é¡¹è‡³å°‘ä¸º <span class="math inline">\(0\)</span> å³å¯ï¼Œç­”æ¡ˆä¸º <span class="math inline">\(\prod {i\le p} a_i - a_{i-1} + 1\)</span>ã€‚</p><p>å¯¹äºååŠæ®µï¼Œæˆ‘ä»¬è€ƒè™‘è½¬åŒ–æˆå’Œå‰åŠæ®µç›¸ä¼¼çš„é—®é¢˜ï¼Œå°†ååŠæ®µç¿»è½¬ï¼ŒåŒæ ·å–å·®åˆ†æ•°ç»„ï¼Œåˆ™æ­¤æ—¶åœ¨è¯¥å·®åˆ†æ•°ç»„ä¸Šæ»¡è¶³åé¢å‡å¾—ä¸æ¯”å‰é¢å°‘ï¼ŒåŒæ—¶éœ€è¦æ»¡è¶³å·®åˆ†æ•°ç»„æ¯ä¸€é¡¹è‡³å¤šä¸º <span class="math inline">\(0\)</span>ï¼Œå‰é¢çš„æ‰€æœ‰é¡¹åˆå§‹ä¸ºè´Ÿï¼Œæ“ä½œä¸ºå‡ï¼Œè‡ªç„¶æ»¡è¶³ï¼›ä½†ç¬¬ <span class="math inline">\(p\)</span> é¡¹åœ¨æŠŠå‰é¢å‡å»çš„å…¨éƒ¨åŠ ä¸Šåä¸ä¸€å®šæ»¡è¶³ã€‚æ•…å‰é¢æœ€å¤šå‡å» <span class="math inline">\(d_p\)</span>ï¼Œéšä¾¿åœ¨å“ªé‡Œå‡éƒ½æ— æ‰€è°“ï¼Œç»„åˆæ„ä¹‰ä¸€ä¸‹ï¼Œå°±æ˜¯æ— æ ‡å·çƒæ”¾æœ‰æ ‡å·ç›’å­å¯ç©ºæ”¾å¯ä¸æ”¾ï¼Œæ’æ¿å¾—ç­”æ¡ˆä¸º <span class="math inline">\(\displaystyle {-d_p + n - p\choose n - p}\)</span>ã€‚</p><p>å‰åä¹˜èµ·æ¥å³ä¸ºç­”æ¡ˆã€‚æ³¨æ„ä¸è¦åœ¨æœ€åä¸€æ­¥ä¹˜èµ·æ¥çš„æ—¶å€™å¿˜è®°å–æ¨¡ï¼Œå¦åˆ™ä½ ä¼šè·å¾— 76pts çš„é«˜åˆ† <img src="/em/xk.gif" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 998244353;int main() &#123;    freopen(&quot;fate.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;fate.out&quot;, &quot;w&quot;, stdout);    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);    int n, m;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::cin &gt;&gt; m;    long long res = 1;    for (int i = 1; i &lt; m; ++i) &#123;        auto x = a[i] - a[i - 1];        (res *= x + 1) %= mod;    &#125;    auto qkp = [](long long x, int y) &#123;        long long res = 1;        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)            if (y &amp; 1)                (res *= x) %= mod;        return res;    &#125;;    auto C = [&amp;](int n, int m) &#123;        long long res = 1ll;        for (int i = n; i &gt; n - m; --i)            (res *= i) %= mod;        for (int i = m; i; --i)            (res *= qkp(i, mod - 2)) %= mod;            return res;    &#125;;    if (m != n)        (res *= C(a[m + 1] - a[m] + n - m, n - m)) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="c.-abstruse">C. abstruse</h3><p><a href="https://www.luogu.com.cn/problem/P9731" class="uri">https://www.luogu.com.cn/problem/P9731</a></p><p>æ³¨æ„åˆ°æœ‰æŒºé«˜çš„ä¸€æ¡£ <span class="math inline">\(S=2\)</span> çš„åˆ†ï¼Œè€ƒè™‘å…¶å¯ç¤ºæ„ä¹‰ã€‚</p><p>æˆ‘ä»¬å¯¹äºä¸€å¯¹ <span class="math inline">\((a_i, b_i)\)</span>ï¼Œåœ¨ <span class="math inline">\(a_i\)</span> å’Œ <span class="math inline">\(b_i\)</span> é—´è¿è¾¹ï¼Œåˆ™åŸé—®é¢˜è½¬åŒ–ä¸ºç»™æ— å‘å›¾çš„æ¯æ¡è¾¹é€‰æ‹©æ–¹å‘ï¼Œä½¿å¯¹äºæ¯ä¸ª <span class="math inline">\(x\)</span>ï¼Œ<span class="math inline">\(|in_x-out_x|\le 1\)</span>ã€‚</p><p>æˆ‘ä»¬çŸ¥é“å¯¹äºä¸€æ¡æ¬§æ‹‰å›è·¯ï¼Œæœ‰å¯¹äºä»»æ„ <span class="math inline">\(x\)</span>ï¼Œ<span class="math inline">\(in_x=out_x\)</span>ã€‚ç„¶åè¿™ä¸ªæ—¶å€™ä¸ºäº†æŠŠé—®é¢˜è½¬åŒ–æˆæ¬§æ‹‰å›è·¯é—®é¢˜æˆ‘ä»¬å»ºä¸€ä¸ªè™šç‚¹æœåº¦æ•°ä¸ºå¥‡çš„ç‚¹è¿æ¡è¾¹ç„¶åè·‘æ¬§æ‹‰å›è·¯å³å¯ã€‚</p><p>è‡³äº <span class="math inline">\(S=2^k\)</span>ï¼Œå°±æ˜¯åœ¨æ˜ç¤ºåˆ†æ²»ã€‚å³å¯¹äºä»»æ„ <span class="math inline">\(x\)</span>ï¼Œè¦æ±‚å…¶åœ¨å‰å <span class="math inline">\(2^{k-1}\)</span> æ¬¡å‡ºç°æ¬¡æ•°ç›¸å·®ä¸è¶…è¿‡ <span class="math inline">\(1\)</span>ã€‚æ³¨æ„åˆ°éå¸¸å¹¸ç¦çš„æœ‰å‰åä¸¤ä¸ªéƒ¨åˆ†å¤§å°ç›¸ç­‰ï¼Œåˆæœ‰ä¸€ä¸ªå¤©æ‰çš„å»ºå›¾ï¼Œ<mark>å³åœ¨æ¯ä¸ªç‚¹å’Œè‡ªå·±æ‰€å±çš„è¡Œè¿è¾¹ï¼Œç„¶åè·‘æ¬§æ‹‰å›è·¯ï¼Œå‡ºè¾¹è¡¨ç¤ºé€‰å‰åŠéƒ¨åˆ†ï¼Œå…¥è¾¹è¡¨ç¤ºé€‰ååŠéƒ¨åˆ†ï¼Œè¿™æ ·å°±ä¿è¯äº†ä¸€è¡Œä¸­å„æœ‰ <span class="math inline">\(2^{k-1}\)</span> ä¸ªé€‰å‰ååŠéƒ¨åˆ†ï¼Œä¹Ÿä¿è¯äº†æ¯ä¸ªç‚¹åœ¨å‰ååŠè¾¹å‡ºç°çš„æ¬¡æ•°ç›¸å·®ä¸è¶…è¿‡ <span class="math inline">\(1\)</span>ã€‚å¯¹äºåé¢ä¸€ä¸ªæ€§è´¨ï¼Œåˆ†æ²»æœ€ç»ˆå¯å¾—åˆ°ç‚¹åœ¨æ¯ä¸€åˆ—å‡ºç°æ¬¡æ•°ç›¸å·®ä¸è¶…è¿‡ <span class="math inline">\(1\)</span></mark>ã€‚</p><p>æ‰“ä¸ªå½“å‰å¼§ä¼˜åŒ–ç„¶åæ³¨æ„è®¡ç®—ç»†èŠ‚å¤æ‚åº¦ç„¶åå¤šå¡å‡ ï¼ˆåï¼‰éå°±è¿‡äº† <img src="/em/dy.gif" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;namespace fastIO &#123;const int LEN = (1 &lt;&lt; 20);#ifdef ONLINE_JUDGEint nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF;        p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifbool read(int &amp;x) &#123;    x = 0;    bool f = 0;    char ch = nec();    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;void print(int x) &#123;    if (x &lt; 0)        putchar(&#39;-&#39;), x = -x;    if (x &gt;= 10) print(x / 10);    putchar(x % 10 + &#39;0&#39;);    return;&#125;void print(int x, char ch) &#123;    print(x), putchar(ch);    return;&#125;&#125; using namespace fastIO;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);    freopen(&quot;abstruse.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;abstruse.out&quot;, &quot;w&quot;, stdout);#else    freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m, k;    read(n), read(m), read(k);    std::vector&lt;std::vector&lt;int&gt; &gt; a(n + 1, std::vector&lt;int&gt; (m + 1));    for (int i = 1; i &lt;= n; ++i)        for (int j = 1; j &lt;= m; ++j)            read(a[i][j]);    std::vector&lt;int&gt; to(k + n + 1), tag(n * m + n + k + 1);    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(k + n + 1);     std::function&lt;void(int, int)&gt; calc = [&amp;](int l, int r) &#123;        if (l + 1 == r) &#123;            for (int i = 1; i &lt;= n; ++i) &#123;                g[a[i][l]].emplace_back(a[i][r], i);                g[a[i][r]].emplace_back(a[i][l], i);            &#125;            int cnt = n;            for (int i = 1; i &lt;= n; ++i) &#123;                if ((int)g[a[i][l]].size() &amp; 1)                    g[0].emplace_back(a[i][l], ++cnt), g[a[i][l]].emplace_back(0, cnt);                if ((int)g[a[i][r]].size() &amp; 1)                    g[0].emplace_back(a[i][r], ++cnt), g[a[i][r]].emplace_back(0, cnt);            &#125;            std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;                for (int i = to[x]; i &lt; (int)g[x].size(); i = to[x]) &#123;                    to[x] = i + 1;                    auto [v, id] = g[x][i];                    if (!tag[id]) &#123;                        tag[id] = 1;                        if (x &amp;&amp; v)                            a[id][l] = x, a[id][r] = v;                        DFS(v);                    &#125;                &#125;                return;            &#125;;            DFS(0);            for (int i = 1; i &lt;= n; ++i)                DFS(a[i][l]), DFS(a[i][r]);            to[0] = 0, g[0].clear();            for (int i = 1; i &lt;= n; ++i) &#123;                to[a[i][l]] = 0, g[a[i][l]].clear();                to[a[i][r]] = 0, g[a[i][r]].clear();            &#125;            std::fill(tag.begin() + 1, tag.begin() + cnt + 1, 0);            return;        &#125;        int mid = (l + r) &gt;&gt; 1, cnt = 0;        std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(k + n + 1);        for (int i = 1; i &lt;= n; ++i)            for (int j = l; j &lt;= r; ++j) &#123;                g[a[i][j]].emplace_back(i + k, ++cnt);                g[i + k].emplace_back(a[i][j], cnt);            &#125;        for (int i = 1; i &lt;= n; ++i)            for (int j = l; j &lt;= r; ++j)                if ((int)g[a[i][j]].size() &amp; 1)                    g[0].emplace_back(a[i][j], ++cnt), g[a[i][j]].emplace_back(0, cnt);        std::vector&lt;int&gt; L(n + 1, l - 1), R(n + 1, r + 1);        std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;            for (int i = to[x]; i &lt; (int)g[x].size(); i = to[x]) &#123;                to[x] = i + 1;                auto [v, id] = g[x][i];                if (!tag[id]) &#123;                    tag[id] = 1;                    if (x &amp;&amp; v) &#123;                        if (v &lt;= k)                            a[x - k][++L[x - k]] = v;                        else                            a[v - k][--R[v - k]] = x;                    &#125;                    DFS(v);                &#125;            &#125;            return;        &#125;;        DFS(0);        for (int i = 1; i &lt;= n; ++i)            DFS(i + k);        for (int i = 1; i &lt;= n; ++i)            for (int j = l; j &lt;= r; ++j)                DFS(a[i][j]);        to[0] = 0, g[0].clear();        for (int i = 1; i &lt;= n; ++i)            to[i + k] = 0, g[i + k].clear();        for (int i = 1; i &lt;= n; ++i)            for (int j = l; j &lt;= r; ++j)                to[a[i][j]] = 0, g[a[i][j]].clear();        std::fill(tag.begin() + 1, tag.begin() + cnt + 1, 0);        calc(l, mid), calc(mid + 1, r);        return;    &#125;;    calc(1, m);    for (int i = 1; i &lt;= n; ++i, putchar(&#39;\n&#39;))        for (int j = 1; j &lt;= m; ++j)            print(a[i][j], &#39; &#39;);    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> åˆ†æ²» </tag>
            
            <tag> æ¬§æ‹‰å›è·¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åŠ¨æ€è§„åˆ’ 10 é¢˜ - I</title>
      <link href="/20240906/"/>
      <url>/20240906/</url>
      
        <content type="html"><![CDATA[<p>ç°åœ¨æ˜¯ 10 é¢˜ã€‚è™½ç„¶çœ‹ç€å¾ˆæ‰ä»·ï¼Œä½†æ˜¯å†™å¤Ÿäº† 10 å°±æ”¹æˆ 20 é¢˜ã€‚ä»¥æ­¤ç±»æ¨ï¼Œå…å¾—æˆ‘æ‘†çƒ‚ï¼ˆï¼‰</p><p>è‡ªç”¨å‘ï¼Œä¸å†™å¤ªè¯¦ç»†ï¼ŒæŠŠç ´é¢˜ç‚¹å†™å‡ºæ¥å°±å·®ä¸å¤šäº†ã€‚å“¦å“¦è¿™é‡Œçš„ç ´é¢˜æ˜¯åŠ¨è¯ä¸æ˜¯åè¯ã€‚</p><span id="more"></span><hr /><h2 id="å­—ç¬¦åˆå¹¶">1. å­—ç¬¦åˆå¹¶</h2><p><a href="https://www.luogu.com.cn/problem/P3736" class="uri">https://www.luogu.com.cn/problem/P3736</a></p><blockquote><p>ç»™å®šé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„ <span class="math inline">\(01\)</span> ä¸²å’Œ <span class="math inline">\(2^k\)</span> æ¡è§„åˆ™ï¼Œç¬¬ <span class="math inline">\(i\)</span> æ¡è§„åˆ™å½¢å¦‚ï¼š</p><ul><li>å¯¹äºåºåˆ—ä¸­çš„ <span class="math inline">\(k\)</span> ä½äºŒè¿›åˆ¶æ•° <span class="math inline">\(i\)</span>ï¼Œå¯ä»¥å°†å®ƒåˆå¹¶ä¸º <span class="math inline">\(c(c\in\{0,1\})\)</span>ï¼Œå¹¶äº§ç”Ÿ <span class="math inline">\(v\)</span> çš„ä»·å€¼ã€‚</li></ul><p>è¿›è¡Œä»»æ„æ¬¡åˆå¹¶ï¼Œæ±‚å‡ºèƒ½å–å¾—çš„æœ€å¤§æ€»ä»·å€¼ã€‚<span class="math inline">\(n\le 300,k\le 8\)</span>ã€‚</p></blockquote><p><strong>çŠ¶å‹</strong>ï¼Œ<strong>åŒºé—´ DP</strong>ã€‚</p><p>æ³¨æ„åˆ° <span class="math inline">\(k\)</span> åªæœ‰ <span class="math inline">\(8\)</span>ï¼Œç‹¬ç‰¹çš„è¾“å…¥æ–¹å¼ä¹Ÿå¼•å¯¼æˆ‘ä»¬æ³¨æ„åˆ°çŠ¶æ€æ•°ä¸º <span class="math inline">\(10^2\)</span> çº§åˆ«ã€‚åˆå¹¶çš„èƒŒæ™¯åˆè®©æˆ‘ä»¬æœ¬èƒ½æƒ³åˆ°åŒºé—´ DPï¼Œæ‰€ä»¥åˆšå¥½ç›²çŒœè¿™é¢˜æ˜¯ä¸ª <span class="math inline">\(O(2^k\times n^2)\)</span> çš„åŒºé—´çŠ¶å‹ DPã€‚</p><ul><li><p>ç„¶åæˆ‘è§‰å¾—æœ€ç¥çš„ä¸€ä¸ªåœ°æ–¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæœ€åçš„ç­”æ¡ˆä¸€å®šæ˜¯ä¸€ä¸ªé•¿åº¦å°äº <span class="math inline">\(k\)</span> çš„ä¸²ï¼Œ<mark>æ¯ä½å±•å¼€è¿˜åŸï¼Œå¯ä»¥çŸ¥é“ï¼Œæ¯ä¸ªåˆå¹¶æ“ä½œé€‰å–çš„åŒºé—´å¯èƒ½åŒ…å«ä½†ä¸ç›¸äº¤ã€‚</mark></p><p>çœ‹èµ·æ¥å¾ˆè ¢å¾ˆæ˜¾ç„¶ï¼Œä½†è¿™æ˜¯æˆ‘ä»¬ <span class="math inline">\(n^2\)</span> åŒºé—´ DP çš„åŸºç¡€å•Šï¼ˆï¼ˆï¼ˆ</p></li></ul><p>ç„¶åæˆ‘ä»¬åŒºé—´ DP å¥—è·¯ï¼Œæšä¸¾å¯¹äº <span class="math inline">\([l,r]\)</span> æœ€å·¦è¾¹ä¸€ä½ï¼Œç„¶åå°±å¯ä»¥å¼€å§‹å¤§åŠ›è½¬ç§»äº†ã€‚</p><p>ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™ä¸€ä½åŸæœ¬çš„æ ·å­æœ‰ç‚¹å¤šï¼Œå¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(1 + d\times (k-1)\)</span> çš„æ•°ï¼Œæ‰€ä»¥åªèƒ½å†æ¥ä¸€å±‚ <span class="math inline">\(\dfrac nk\)</span> çš„æšä¸¾ï¼Œæé™æƒ…å†µæ˜¯ä¸ªæœ‰ç‚¹éš¾ç»·çš„ 3e9ï¼Œä½œä¸ºæ­£è§£åªèƒ½è¯´è¿™ä¸ªæ•°æ®èŒƒå›´çš„æç¤ºæ€§æœ‰ç‚¹ä»¤äººéš¾è¯„äº†ã€‚</p><p>å®ç°ç€å®ç°ç€æŠŠè‡ªå·±æ•´æ‡µäº†ï¼š<code>00000</code> å’Œ <code>0</code> å‹å‡ºæ¥éƒ½æ˜¯ <code>0</code>ï¼Œä½†äºŒè€…ä»£è¡¨çš„å«ä¹‰æ˜¾ç„¶ä¸åŒï¼Œåˆæ— æ³•ç®€å•åŒºåˆ«ã€‚ä½†å…¶å®<mark>é•¿åº¦ä¸º <span class="math inline">\(1+d\times (k-1)\)</span> çš„åŒºé—´å’Œé•¿åº¦ä¸º <span class="math inline">\(d\)</span> çš„æœ€ç»ˆç»“æœæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬è®¾è®¡çš„åŒ…å«äº†åŒºé—´ä½œå³ç«¯ç‚¹çš„çŠ¶æ€ä¸­ï¼Œå‹å‡ºæ¥çš„å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„é‚£ä¸ªã€‚</mark></p><details><p>è¿™é‡Œçš„å®ç°æ¯”<strong>æ‰€æœ‰</strong>æˆ‘æ‰¾åˆ°çš„é¢˜è§£éƒ½æ›´åƒäººæ‰“å‡ºæ¥çš„ã€‚å¯¼è‡´æˆ‘æƒ³å¯¹æ¯”ç–—æ³•éƒ½æ‰¾ä¸åˆ°åˆé€‚çš„ä»£ç  <img src="/em/lh.gif" /></p><p>æ¢è¨€ä¹‹ï¼Œè¿™æœ€åƒæ˜¯ä¸€ä»½é€šå¸¸çš„åŒºé—´ DP ä»£ç ï¼Œä¸å­˜åœ¨å…¶ä»–é¢˜è§£ä¸­ä¹±ä¸ƒå…«ç³Ÿçš„å¡«è¡¨å•Šç›¸äº’å½±å“å•Šä¹‹ç±»çš„æ¶å¿ƒ featureã€‚</p><p>sto rybp orz</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 305;const int maxm = (1 &lt;&lt; 8) + 5;char a[maxn];int c[maxm], w[maxm];long long f[maxn][maxn][maxm];int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#else    freopen(&quot;in.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;out.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    int siz = (1 &lt;&lt; k), si = (1 &lt;&lt; (k - 1));    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    for (int i = 0; i &lt; siz; ++i)        std::cin &gt;&gt; c[i] &gt;&gt; w[i];    memset(f, -0x3f, sizeof(f));    for (int l = 1; l &lt; k; ++l)        for (int i = 1; i &lt;= n - l + 1; ++i) &#123;            int j = i + l - 1, now = 0;            for (int p = i; p &lt;= j; ++p)                now = now * 2 + a[p] - &#39;0&#39;;            f[i][j][now] = 0;        &#125;    for (int i = 1; i &lt;= n - k + 1; ++i) &#123;        int now = 0;        for (int j = i; j &lt;= i + k - 1; ++j)            now = now * 2 + a[j] - &#39;0&#39;;        f[i][i + k - 1][c[now]] = w[now];    &#125;    for (int l = k + 1; l &lt;= n; ++l)        for (int i = 1; i &lt;= n - l + 1; ++i) &#123;            int j = i + l - 1;            for (int p = i; p &lt; j; p += k - 1) &#123;                for (int q = 0; q &lt; si; ++q)                    if (!(q &gt;&gt; ((l - 1) % (k - 1) + 1)))                        f[i][j][q] = std::max(f[i][j][q], f[i][p][q &gt;&gt; ((l - 1) % (k - 1))] + f[p + 1][j][q &amp; ((1 &lt;&lt; ((l - 1) % (k - 1))) - 1)]);                if (l % (k - 1) == 1 || k == 2)                    for (int q = 0; q &lt; siz; ++q)                        f[i][j][c[q]] = std::max(f[i][j][c[q]], f[i][p][q &gt;&gt; (k - 1)] + f[p + 1][j][q &amp; ((1 &lt;&lt; (k - 1)) - 1)] + w[q]);            &#125;        &#125;    std::cout &lt;&lt; *std::max_element(f[1][n], f[1][n] + si) &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><p>å…¶å®ä¸€å¼€å§‹æŒºæ‹…å¿ƒä¼šä¸ä¼šå› ä¸ºå†™åšå®¢å½±å“åšé¢˜æ—¶é—´ä¹‹ç±»çš„ã€‚</p><p>ç›´åˆ°å‘ç°æˆ‘å¯ä»¥çœ‹çŸ¥ä¹çœ‹ä¸€ä¸ªä¸Šåˆç„¶åä»£ç åŠ¨éƒ½ä¸åŠ¨ä¸€ä¸‹ <img src="/em/lh.gif" /></p><hr /><h2 id="mod-mod-mod">2. Mod Mod Mod</h2><p><a href="https://codeforces.com/contest/889/problem/E" class="uri">https://codeforces.com/contest/889/problem/E</a></p><blockquote><p>ç»™å®š <span class="math inline">\(a_{1\sim n}\)</span>ï¼Œå¯¹äºæ‰€æœ‰éè´Ÿæ•´æ•° <span class="math inline">\(x\)</span> å®šä¹‰ <span class="math inline">\(f(x,n)=x\bmod a_n\)</span>ï¼Œ<span class="math inline">\(f(x,i)=x\bmod a_i+f(x\bmod a_i,i+1)\)</span>ã€‚</p><p>æ±‚ <span class="math inline">\(f(x,1)\)</span> æœ€å¤§å€¼ã€‚<span class="math inline">\(n\le 2\times 10^5\)</span>ã€‚</p></blockquote><p><strong>æŠ€å·§ / ç‰¹æ®Šæ€§è´¨ç±» DP</strong>ã€‚</p><p>å°ç¥é¢˜ã€‚æ³¨æ„åˆ°é¢˜æ„å¯ä»¥è½¬åŒ–ä¸ºï¼Œæ‰¾åˆ°ä¸€ä¸ª <span class="math inline">\(x\)</span>ï¼Œæœ€å¤§åŒ–ï¼š</p><p><span class="math display">\[x\bmod a_1 + x\bmod a_1\bmod a_2 + \cdots + x\bmod a_1\bmod a_2\bmod\cdots\bmod a_n.\]</span></p><p>ç®€ç§° <span class="math inline">\(x\bmod a_1\bmod a_2\bmod \cdots\bmod a_i\)</span> çš„å€¼ä¸º <span class="math inline">\(f_i\)</span>ã€‚</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¸éš¾æ³¨æ„åˆ°ï¼Œ<span class="math inline">\(f_i\)</span> è‚¯å®šæ˜¯<mark>å•è°ƒä¸å‡</mark>çš„ã€‚å½¢è±¡åŒ–åœ°ï¼Œæ•´ä¸ª <span class="math inline">\(f\)</span> åºåˆ—è‚¯å®šæ˜¯ç”±è‹¥å¹²ä¸ªå•è°ƒä¸‹é™çš„æ®µç»„æˆçš„ã€‚å¹¶ä¸”ï¼Œ<mark>å¿…å®šå­˜åœ¨è‡³å°‘ä¸€ä¸ª <span class="math inline">\(i\)</span>ï¼Œä½¿å¾— <span class="math inline">\(f_i = a_i-1\)</span>ï¼Œå¦åˆ™å¯ä»¥å°†æ‰€æœ‰ <span class="math inline">\(f_i\gets f_i+1\)</span>ï¼ŒåŒæ—¶ <span class="math inline">\(\sum f\gets (\sum f) + n\)</span></mark>ã€‚</p><p>è¿™å¯ç¤ºæˆ‘ä»¬å…³æ³¨ <span class="math inline">\(f_i\)</span> çš„å€¼åŸŸã€‚å‡è®¾å·²ç»ç¡®å®šäº† <span class="math inline">\(f\)</span> åºåˆ—çš„ä¸€ä¸ªå‰ç¼€ <span class="math inline">\(f_1\sim i\)</span>ï¼Œå¯¹äºä»»æ„ <span class="math inline">\(0\le k\le f_{\min}\)</span>ï¼ˆæ³¨æ„ç”±äºå•è°ƒä¸é™ï¼Œ<span class="math inline">\(f_{\min} = f_i\)</span>ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰ <span class="math inline">\(f_j\gets f_j-k\)</span>ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„åˆæ³•çš„ <span class="math inline">\(f&#39;_{1\sim i}\)</span>ã€‚</p><p>å½¢è±¡åŒ–åœ°ï¼Œå°† <span class="math inline">\(f_{1\sim i}\)</span> æƒ³è±¡ä¸ºä¸€ä¸ªé€æ¸é™ä½çš„æŸ±çŠ¶å›¾ï¼Œä»»æ„åˆ‡å»äº†ä¸€ä¸ªé«˜åº¦çš„åº•éƒ¨ï¼Œå¹¶ä¸”è¿™ä¸ªé«˜åº¦ä¸é«˜äºæœ€çŸ®çš„å…ƒç´ ï¼ˆå³ç¬¬ <span class="math inline">\(i\)</span> ä¸ªå…ƒç´ ï¼‰ã€‚</p><p>è¿™æ—¶å€™æœ‰ä¸€ä¸ªå¾ˆç¾å¦™çš„æ€§è´¨ï¼Œå°±æ˜¯æˆ‘ä»¬<mark>å¯¹äºåˆ‡ä¹‹å‰å’Œåˆ‡ä¹‹åçš„æŸ±çŠ¶å›¾ï¼Œå…¶ <strong>æœ€çŸ®å…ƒç´ ä»¥ä¸Šçš„éƒ¨åˆ†</strong> é•¿å¾—å®Œå…¨ç›¸åŒ</mark>ã€‚ç„¶åå°±æ˜¯ç¥ä¸­ç¥ä¹‹ DP çŠ¶æ€è®¾è®¡ã€‚å¾ˆéš¾æƒ³è±¡æ˜¯åœ¨ä»€ä¹ˆæ ·çš„ç²¾ç¥çŠ¶æ€ä¸‹å‡‘å‡ºæ¥è¿™ç§ç¥å¥‡çŠ¶æ€çš„ï¼Œå¯èƒ½æ˜¯æŸç§æˆ‘ä¸äº†è§£çš„ trickï¼Ÿ</p><p>ä»¤ <span class="math inline">\(dp_{i, j}\)</span> è¡¨ç¤ºå¯¹äºå‰ç¼€ <span class="math inline">\(f_{1, i}\)</span>ï¼Œå½“åˆ‡å»çš„é«˜åº¦ä¸º <span class="math inline">\(0\sim j\)</span> æ—¶ï¼Œ<strong>æœ€çŸ®å…ƒç´ ä»¥ä¸Šçš„éƒ¨åˆ†</strong> çš„å’Œéƒ½ä¸º <span class="math inline">\(dp_{i, j}\)</span>ã€‚é‚£ä¹ˆæ˜“å¾— <span class="math inline">\(\sum f_{1\sim i}=j\times i + dp_{i, j}\)</span>ã€‚</p><p>è€ƒè™‘è½¬ç§»ã€‚å‡è®¾å·²çŸ¥æ‰€æœ‰ <span class="math inline">\(dp_{i - 1, j}\)</span>ï¼Œéœ€è½¬ç§»åˆ° <span class="math inline">\(i\)</span>ï¼Œæˆ‘ä»¬æœ‰ä¸‰ç§è½¬ç§»è·¯å¾„ï¼š</p><ol type="1"><li><p><span class="math inline">\(j &lt; a_i\)</span>ï¼š</p>å¯¹ <span class="math inline">\(a_i\)</span> å–æ¨¡å–ä¸åŠ¨ï¼Œä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚<span class="math inline">\(dp_{i, j}\gets dp_{i - 1, j}\)</span>ã€‚</li><li><p><span class="math inline">\(j\ge a_i\)</span>ï¼š</p><ul><li><p>è®© <span class="math inline">\(i\)</span> æ‰¿æ‹… <span class="math inline">\(f_i=a_i-1\)</span> çš„è´£ä»»ã€‚æˆ‘ä»¬ä» <span class="math inline">\(0\sim j\)</span> ä¸­æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³ <span class="math inline">\(j&#39;\bmod a_i=a_i-1\)</span> çš„ <span class="math inline">\(j&#39;\)</span>ï¼Œ<span class="math inline">\(j&#39;\)</span> è‚¯å®šæ˜¯è¶Šå¤§è¶Šå¥½ï¼Œæ•… <span class="math inline">\(j&#39;=(\left\lfloor \dfrac {j}{a_i}\right\rfloor-1)\times a_i+(a_i-1)\)</span>ã€‚</p>æ­¤æ—¶ä¾¿æœ‰ <span class="math inline">\(dp_{i, a_i-1}\gets dp_{i - 1, j&#39;} + [j&#39; - (a_i-1)]\times (i-1)\)</span>ã€‚</li><li><p>ç›²çŒœ <span class="math inline">\(0\sim i - 1\)</span> æˆ– <span class="math inline">\(i+1\sim n\)</span> ä¸­ä¼šå‡ºç°æ‰¿æ‹… <span class="math inline">\(f_{i&#39;}=a_{i&#39;-1}\)</span> çš„ <span class="math inline">\(i&#39;\)</span>ï¼Œæ•…æŒ‰ç…§ <span class="math inline">\(j\)</span> å–æœ€å¤§æ¥è½¬ç§»ã€‚</p><p>æ­¤æ—¶æœ‰ <span class="math inline">\(dp_{i, j\bmod a_i}=dp_{i-1,j}+(j-j\bmod a_i)\times (i-1)\)</span>ã€‚</p></li></ul></li></ol><p>ç­”æ¡ˆå³ä¸º <span class="math inline">\(\max\{j\times n+dp_{n, j}\}\)</span>ã€‚ç”±äºä¸å­˜åœ¨ <span class="math inline">\(f_i=a_i-1\)</span> çš„ <span class="math inline">\(f\)</span> è‚¯å®šæ¯”å­˜åœ¨çš„è¦åŠ£ï¼Œæ‰€ä»¥æˆ‘ä»¬è‚¯å®šé€‰åˆ°çš„æ˜¯æ­£ç¡®çš„ç­”æ¡ˆã€‚</p><p>æ³¨æ„åˆ°æ¯ä¸ª <span class="math inline">\(i\)</span> åªä¼šæ–°å¢ <span class="math inline">\(a_i-1\)</span> ä¸€ä¸ªçŠ¶æ€ï¼Œæ•…çŠ¶æ€æ€»æ•°ä¸º <span class="math inline">\(O(n)\)</span>ã€‚æŠŠ <span class="math inline">\(dp\)</span> å¼€æˆ map å°±å¯ä»¥ <span class="math inline">\(O(n\log n)\)</span> åœ°è§£å†³é—®é¢˜ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#else    freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n;    std::cin &gt;&gt; n;    std::vector&lt;long long&gt; a(n + 1);    std::map&lt;long long, long long&gt; t;    std::cin &gt;&gt; a[1];    t[a[1] - 1] = 0;    for (int i = 2; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        for (;;) &#123;            auto p = t.lower_bound(a[i]);            if (p == t.end())                break;            long long j = p-&gt;first, f = p-&gt;second;            t[j % a[i]] = std::max(t[j % a[i]], f + (j - j % a[i]) * (i - 1));            if (j &gt;= a[i]) &#123;                j = (j / a[i] - 1) * a[i] + a[i] - 1;                t[a[i] - 1] = std::max(t[a[i] - 1], f + (j - (a[i] - 1)) * (i - 1));            &#125;            t.erase(p);        &#125;    &#125;    long long res = 0;    for (auto i : t)        res = std::max(res, i.first * n + i.second);    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="stalinsort-algorithm">3. StalinSort Algorithm</h2><p><a href="https://qoj.ac/problem/1456" class="uri">https://qoj.ac/problem/1456</a></p><blockquote><p>ç»™å®šæ’åˆ— <span class="math inline">\(A_{1\sim n}\)</span>ã€‚ä» <span class="math inline">\(i=2\)</span> å¼€å§‹å¾€å³æ‰«ï¼Œæ¯ä¸€æ­¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><ul><li>è‹¥ <span class="math inline">\(A_i&gt; A_{i-1}\)</span>ï¼Œä»€ä¹ˆä¹Ÿä¸åšã€‚</li><li>å¦åˆ™ï¼Œä½ å¯ä»¥åˆ é™¤ <span class="math inline">\(A_{i-1}\)</span> æˆ– <span class="math inline">\(A_i\)</span>ï¼Œä½†è¦æ±‚åˆ é™¤åï¼Œè¯¥å‰ç¼€å¿…é¡»å•è°ƒé€’å¢ã€‚</li></ul><p>é—®æœ€å°‘å¯ä»¥åˆ é™¤å¤šå°‘ä¸ªæ•°ã€‚<span class="math inline">\(n\le 10^5\)</span>ã€‚</p></blockquote><p>ä½ ä¼šå‘ç°<mark>åˆ æœ€å°‘ = ç•™æœ€å¤š</mark>ã€‚</p><p>è€ƒè™‘ <span class="math inline">\(i\)</span> èƒ½å¤Ÿè½¬ç§»åˆ°çš„ <span class="math inline">\(j(j&gt;i)\)</span> éœ€æ»¡è¶³çš„æ¡ä»¶ã€‚è‹¥ä»¤ <span class="math inline">\(nex_p\)</span> è¡¨ç¤º <span class="math inline">\(p\)</span> ä¹‹åç¬¬ä¸€ä¸ªå€¼æ¯” <span class="math inline">\(a_p\)</span> å¤§çš„å…ƒç´ ï¼Œåˆ™ <span class="math inline">\(j\in [nex_i, nex_{nex_i})\)</span> ä¸” <span class="math inline">\(a_j&gt;a_i\)</span>ã€‚</p><p><mark>èµ›æ—¶è¯¯è®¤ä¸ºå³ç«¯ç‚¹ä¸º <span class="math inline">\(i\)</span> ä¹‹åç¬¬äºŒä¸ªå€¼æ¯” <span class="math inline">\(a_i\)</span> å¤§çš„å…ƒç´ ï¼Œå¯¼è‡´å®Œå…¨å¯„æ‰ã€‚</mark></p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚<mark>æ³¨æ„åˆ°å¦‚æœåªæœ‰ <span class="math inline">\(j\in [nex_i, nex_{nex_i})\)</span> è¿™ä¸ªæ¡ä»¶å¾ˆå®¹æ˜“ç”¨çº¿æ®µæ ‘ç»´æŠ¤ï¼Œè€ƒè™‘æ¶ˆå» <span class="math inline">\(a_j&gt;a_i\)</span> çš„å½±å“ã€‚æ•…è€ƒè™‘æŒ‰ <span class="math inline">\(a\)</span> <strong>ä»å°åˆ°å¤§</strong> çš„é¡ºåºé€‰å– <span class="math inline">\(i\)</span>ï¼Œå› ä¸ºå½“å‰æœ€å°çš„ <span class="math inline">\(i\)</span> ä¸€å®šå·²ç»è¢«åˆ·å®Œè¡¨äº†</mark>ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\log n)\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 5e5 + 5;const int inf = 0x3f3f3f3f;struct _ &#123; int u, d; &#125; t1[maxn &lt;&lt; 2];int n, t[maxn &lt;&lt; 2];#define lt (p &lt;&lt; 1)#define rt (lt | 1)void upd(int p, int l, int r, int x, int v) &#123;    t[p] = std::min(t[p], v);    if (l == r)        return;    int mid = (l + r) &gt;&gt; 1;    if (x &lt;= mid)        upd(lt, l, mid, x, v);    else        upd(rt, mid + 1, r, x, v);    return;&#125;int ask(int p, int l, int r, int ql, int qr) &#123;    if (ql &lt;= l &amp;&amp; r &lt;= qr)        return t[p];    int mid = (l + r) &gt;&gt; 1, res = n + 1;    if (ql &lt;= mid)        res = ask(lt, l, mid, ql, qr);    if (qr &gt; mid)        res = std::min(res, ask(rt, mid + 1, r, ql, qr));    return res;&#125;void pushdown(int p) &#123;    if (t1[p].d) &#123;        t1[lt].u = std::max(t1[lt].u, t1[p].d);        t1[lt].d = std::max(t1[lt].d, t1[p].d);               t1[rt].u = std::max(t1[rt].u, t1[p].d);        t1[rt].d = std::max(t1[rt].d, t1[p].d);               t1[p].d = 0;    &#125;    return;&#125;void upd(int p, int l, int r, int ql, int qr, int v) &#123;    t1[p].u = std::max(t1[p].u, v);    if (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;        t1[p].d = std::max(t1[p].d, v);        return;    &#125;    pushdown(p);    int mid = (l + r) &gt;&gt; 1;    if (ql &lt;= mid)        upd(lt, l, mid, ql, qr, v);    if (qr &gt; mid)        upd(rt, mid + 1, r, ql, qr, v);    return;&#125;int ask(int p, int l, int r, int x) &#123;    if (l == r)        return t1[p].u;    pushdown(p);    int mid = (l + r) &gt;&gt; 1;    if (x &lt;= mid)        return ask(lt, l, mid, x);    return ask(rt, mid + 1, r, x);&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#else    freopen(&quot;sort3.in&quot;, &quot;r&quot;, stdin);    // freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int res = 0;    std::cin &gt;&gt; n;    std::vector&lt;int&gt; a(n + 1), ne(n + 1), f(n + 1);    std::fill(t + 1, t + 4 * n + 1, n + 1);    std::fill(t1 + 1, t1 + 4 * n + 1, (_)&#123; -inf, 0 &#125;);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    for (int i = n; ~i; --i) &#123;        ne[i] = ask(1, 0, n, a[i] + 1, n);        upd(1, 0, n, a[i], i);       &#125;    std::vector&lt;int&gt; id(n + 1);    std::iota(id.begin(), id.end(), 0);    std::sort(id.begin(), id.end(), [&amp;](int x, int y) &#123; return a[x] &lt; a[y]; &#125;);    f[0] = 0;    for (int i = 0; i &lt;= n; ++i) &#123;        if (i) &#123;            f[id[i]] = ask(1, 0, n, id[i]);            res = std::max(res, f[id[i]]);        &#125;        if (ne[id[i]] &lt;= n)            upd(1, 0, n, ne[id[i]], ne[ne[id[i]]] - 1, f[id[i]] + 1);    &#125;    std::cout &lt;&lt; n - res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="merge-triplets">4. Merge Triplets</h2><p><a href="https://atcoder.jp/contests/agc043/tasks/agc043_d" class="uri">https://atcoder.jp/contests/agc043/tasks/agc043_d</a></p><blockquote><p>ç»™å®š <span class="math inline">\(A_{1\sim 3N}=\{1, 2, \dots, 3N\}\)</span>ï¼Œä» <span class="math inline">\(1\)</span> å¼€å§‹æ¯ <span class="math inline">\(3\)</span> ä¸ªæ•°åˆ†ä¸ºä¸€ç»„ï¼Œæ¯ä¸€ç»„åˆå§‹æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚æ‰§è¡Œè‹¥å¹²æ¬¡ä»¥ä¸‹æ“ä½œï¼š</p><ul><li>åœ¨æ‰€æœ‰æŒ‡é’ˆæŒ‡å‘çš„æ•°ä¸­é€‰æ‹©ä¸€ä¸ªæœ€å°çš„ï¼ŒæŠŠå®ƒæ”¾åˆ°åºåˆ—æœ«ï¼ˆä¸ä¼šåŠ å…¥æœ«ç«¯çš„ç»„ï¼‰ï¼›å°†åŸæœ¬æŒ‡å‘å®ƒçš„æŒ‡é’ˆåç§»ä¸€ä½ï¼Œå¦‚æœç§»å‡ºåŸæœ¬çš„ç»„å°±åˆ é™¤è¿™ä¸ªæŒ‡é’ˆã€‚</li></ul><p>é—®ä»»æ„æ¬¡æ“ä½œåï¼Œå¯èƒ½å¾—åˆ°å¤šå°‘ç§åºåˆ—ã€‚<span class="math inline">\(n\le 2\times 10^3\)</span>ã€‚</p></blockquote><p>ç”±äºè¦å¯¹åˆæ³•çš„æœ€ç»ˆåºåˆ—è¿›è¡Œè®¡æ•°ï¼Œè€ƒè™‘æœ€ç»ˆåºåˆ—çš„æ€§è´¨ã€‚</p><p>è‹¥åºåˆ—ä¸­ <span class="math inline">\(a_{i+1}&lt;a_i\)</span>ï¼Œåˆ™è¯´æ˜åœ¨æŸä¸€ç»„ä¸­ï¼Œå€¼ä¸º <span class="math inline">\(a_i\)</span> çš„å…ƒç´ ä¸‹ä¸€ä¸ªå°±æ˜¯ <span class="math inline">\(a_{i+1}\)</span>ã€‚å¦åˆ™ï¼Œå›  <span class="math inline">\(a_{i+1}\)</span> å¯é€‰ä¸”æ¯” <span class="math inline">\(a_i\)</span> å°ï¼Œ<span class="math inline">\(a_{i+1}\)</span> åº”æ’åœ¨ <span class="math inline">\(a_i\)</span> å‰é¢ã€‚</p><p>å¦åˆ™ï¼Œ<span class="math inline">\(a_{i+1}\)</span> æ—¢å¯ä»¥ä¸ <span class="math inline">\(a_i\)</span> ä¸åœ¨åŒä¸€ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯ <span class="math inline">\(a_i\)</span> çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚</p><p>ä¸€ç»„æœ€å¤šä¸‰ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸èƒ½å‡ºç° <span class="math inline">\(a_i&gt;a_{i+1},a_{i+2},a_{i+3}\)</span> çš„æƒ…å†µã€‚è€Œ <span class="math inline">\(N=1\)</span> æ—¶åºåˆ—é•¿åº¦åªæœ‰ <span class="math inline">\(3\)</span>ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ ·ä¾‹ä¸€çš„ç­”æ¡ˆä¸º <span class="math inline">\(3!\)</span>ã€‚</p><p>ä½†è¿™ä¸ªé™åˆ¶å¹¶ä¸èƒ½æ’é™¤æ‰€æœ‰éæ³•æƒ…å†µã€‚<span class="math inline">\(N=2\)</span> æ—¶æš´æœæˆ‘ä»¬ç›®å‰é™åˆ¶ä¸‹çš„è§£ï¼Œå…±æœ‰ 276 ä¸ªï¼Œæ¯”ç­”æ¡ˆä¸­çš„ 261 ä¸ªè¦å¤šï¼Œè¯´æ˜åŒ…å«äº†å…¶ä»–éæ³•è§£ã€‚</p><p>æš´æœè¾“å‡ºå¹¶è§‚å¯Ÿï¼Œæ˜“å¾—è¿™ 15 ä¸ªéæ³•åºåˆ—å³ä¸ºæ»¡è¶³ç›®å‰é™åˆ¶ä¸”å­˜åœ¨ <span class="math inline">\(3\)</span> ä¸ª <span class="math inline">\(i\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\(a_i&gt;a_{i+1}\)</span> ä¸” <span class="math inline">\(a_i&lt;a_{i+2}\)</span> çš„æ‰€æœ‰åºåˆ—ï¼Œ<mark>ç”±å‰é¢çš„æ¨å¯¼ï¼Œå¿…é¡»åˆ†ä¸ºä¸‰ä¸ªé•¿åº¦ä¸º 2 çš„ç»„ï¼Œè€Œæˆ‘ä»¬è¦æ±‚çš„æ˜¯é•¿åº¦ä¸º 3 çš„ç»„ã€‚æ˜¾ç„¶æ— æ³•ç”¨å‰è€…ç»„åˆå¾—åˆ°åè€…</mark>ã€‚</p><p>åœ¨æˆ‘ä»¬ç¬¬ä¸€ä¸ªæ¡ä»¶çš„é™åˆ¶ä¸‹ï¼Œå¿…é¡»è¢«åˆ†åˆ°åŒä¸€ç»„çš„æ•°çš„è¿ç»­é•¿åº¦ï¼Œåªæœ‰ <span class="math inline">\(1,2,3\)</span> ä¸‰ç§ã€‚è€Œï¼š</p><ul><li>é•¿åº¦ä¸º 3 çš„å¯¹ç­”æ¡ˆåˆæ³•æ€§æ— å½±å“ï¼›</li><li>è€Œé•¿åº¦ä¸º 1 çš„æ—¢å¯ä»¥å’Œ 2 ç»„ä¸ºä¸€ç»„ï¼Œä¹Ÿå¯ä»¥å’Œå…¶ä»–ä¸¤ä¸ª 1 ç»„ä¸ºä¸€ç»„ï¼›</li><li>é•¿åº¦ä¸º 2 çš„åªèƒ½å’Œ 1 ç»„æˆä¸€ç»„ã€‚</li></ul><p><mark>è¿™æ—¶ï¼Œæˆ‘ä»¬å‘ç°æ‰€æœ‰é™åˆ¶éƒ½æŒ‡å‘é•¿åº¦ä¸º 2 çš„æ®µï¼Œå…¶æ€»ä¸ªæ•°ä¸èƒ½æ¯”é•¿åº¦ä¸º 1 çš„æ®µå¤šã€‚</mark></p><p>äºæ˜¯ä¹ï¼Œä¸Šè¿°é™åˆ¶å¯æ€»ç»“ä¸ºä¸¤ç‚¹ï¼š</p><ol type="1"><li>è‹¥ä»¤æ‰€æœ‰æ»¡è¶³ <span class="math inline">\(a_l&gt;\max\{a_{l\sim r}\}\)</span> çš„æå¤§åŒºé—´ä¸ºä¸€æ®µï¼ˆæ˜“è¯æ¯æ®µäº’ä¸é‡åˆä¸”è¦†ç›–å…¨åºåˆ—ï¼‰ï¼Œé‚£ä¹ˆå…¶é•¿åº¦ä¸èƒ½è¶…è¿‡ 3ã€‚</li><li>å…¶ä¸­ï¼Œé•¿åº¦ä¸º 2 çš„ä¸ªæ•°ä¸èƒ½æ¯”é•¿åº¦ä¸º 1 çš„ä¸ªæ•°å¤šã€‚</li></ol><p><mark>ä»¤ <span class="math inline">\(f_{i, j}\)</span> è¡¨ç¤ºè‹¥å½“å‰æšä¸¾çš„æœ€åä¸€æ®µå³ç«¯ç‚¹ä¸º <span class="math inline">\(i\)</span>ï¼Œé•¿åº¦ä¸º 1 çš„æ®µæ¯”é•¿åº¦ä¸º 2 çš„æ®µå¤š <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ã€‚</mark></p><p>æœ€åç­”æ¡ˆå³ä¸º <span class="math inline">\(\sum\limits_{j=0}^n f_{i, j}\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#else    freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, mod;    std::cin &gt;&gt; n &gt;&gt; mod;    n *= 3;    std::vector&lt;std::unordered_map&lt;int, long long&gt; &gt; f(n + 1);    f[0][0] = 1;    for (int i = 0; i &lt; n; ++i)        for (auto [j, k] : f[i]) &#123;            (f[i + 1][j + 1] += k) %= mod;            if (i + 2 &lt;= n)                (f[i + 2][j - 1] += k * (i + 1) % mod) %= mod;            if (i + 3 &lt;= n)                (f[i + 3][j] += k * (i + 1) % mod * (i + 2) % mod) %= mod;        &#125;    long long res = 0;    for (int i = 0; i &lt;= n; ++i)        (res += f[n][i]) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="runaway-quail">5. Runaway Quail</h2><p><a href="https://qoj.ac/problem/5978" class="uri">https://qoj.ac/problem/5978</a></p><blockquote><p>æ•°è½´ä¸Šæœ‰ <span class="math inline">\(n\)</span> åªé¸¡ï¼Œåˆå§‹ä½ç½®ä¸ºé <span class="math inline">\(0\)</span> æ•´æ•° <span class="math inline">\(p_i\)</span>ï¼Œå¥”è·‘é€Ÿåº¦ä¸º <span class="math inline">\(s_i\)</span>ã€‚ä½ åˆå§‹åœ¨ <span class="math inline">\(0\)</span> ä½ç½®ï¼Œå¥”è·‘é€Ÿåº¦ä¸º <span class="math inline">\(Y(Y&gt;s_i)\)</span>ã€‚ä½ è¦æŠ“åˆ°æ‰€æœ‰é¸¡ã€‚</p><p>ä½ å¯ä»¥åœ¨ä»»æ„æ—¶åˆ»è°ƒè½¬æ–¹å‘ï¼›é¸¡æ€»ä¼šæœç€è¿œç¦»ä½ çš„æ–¹å‘å¥”è·‘ï¼›å½“ä½ çš„åæ ‡å’Œé¸¡é‡åˆæ—¶ï¼Œä½ æŠ“åˆ°é¸¡ã€‚</p><p>é—®æŠ“åˆ°æ‰€æœ‰é¸¡çš„æœ€çŸ­æ—¶é—´ï¼ˆæ˜¾ç„¶æ˜¯ä¸ªå®æ•°ï¼‰ã€‚<span class="math inline">\(n\le 500\)</span>ã€‚</p></blockquote><p>å®¹æ˜“å‘ç°é¸¡çš„å¥”è·‘æ–¹å‘ä»å§‹è‡³ç»ˆä¸ä¼šå˜ï¼Œå¦‚æœæˆ‘ä»¬è¦ä»å¾€å·¦è¿½å˜æˆå¾€å³è¿½ï¼Œæ˜¾è€Œæ˜“è§åœ°æˆ‘ä»¬ä¼š<mark>åœ¨è¿½ä¸Šå³è¾¹ç¬¬ä¸€åªé¸¡å‰ç»è¿‡åŸç‚¹</mark>ï¼Œåä¹‹åŒç†ã€‚</p><p>é‚£ä¹ˆæœ‰ä¸€ä¸ªå¾ˆç¥å¥‡çš„çŠ¶æ€è®¾è®¡ï¼Œè®¾ <span class="math inline">\(f_{i,j}\)</span> ä¸ºè¿½ä¸Šäº†å·¦è¾¹é€Ÿåº¦ç¬¬ <span class="math inline">\(1\sim i - 1\)</span> å¤§çš„æ‰€æœ‰é¸¡å’Œå³è¾¹é€Ÿåº¦ç¬¬ <span class="math inline">\(1\sim j - 1\)</span> å¤§çš„æ‰€æœ‰é¸¡ï¼Œç„¶åè·‘å›åŸç‚¹çš„æœ€å°æ—¶é—´ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨è®°å½•è¿™ä¸ªéå¸¸éš¾è®°å½•çš„å½“å‰ä½ç½®ä¿¡æ¯ï¼Œå¯¹äºé€Ÿåº¦æ’å <span class="math inline">\(\ge i,j\)</span> çš„æ‰€æœ‰é¸¡ï¼Œå½“å‰æ˜¯å¦è¿½ä¸Šæˆ‘ä»¬å¹¶ä¸å…³å¿ƒâ€”â€”<mark>å¦‚æœå…¶ä½ç½®æ¯”è¾ƒè¿œï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šåœ¨åç»­è½¬ç§»ä¸­å†è€ƒè™‘ï¼›å¦‚æœå…¶ä½ç½®æ¯”è¾ƒè¿‘ï¼Œåœ¨è§£å†³é€Ÿåº¦æ’å <span class="math inline">\(&lt;i,j\)</span> çš„é¸¡æ—¶å°±å·²ç»æŠ“ä½</mark>ã€‚</p><p><mark>æˆ‘ä»¬ <span class="math inline">\(\mathcal O(n)\)</span> æšä¸¾ä¸Šä¸€æ¬¡åå‘æ˜¯åœ¨æŠ“ä½å“ªä¸€åªé¸¡æ—¶ï¼Œç„¶åè®©ä¸­é—´å…¨éƒ¨åŒå‘è·‘å³å¯</mark>ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡è®¾æˆ‘ä»¬è¦ç”¨ <span class="math inline">\(f_{i,j}\)</span> æ›´æ–° <span class="math inline">\(f_{k,j}\)</span>ï¼ˆ<span class="math inline">\(k&lt;i\)</span>ï¼‰ï¼Œé‚£ä¹ˆåªéœ€è¦æ›´æ–°æŠ“ä½é€Ÿåº¦æ’å <span class="math inline">\(i\sim k+1\)</span> ä¸­è·‘å¾—æœ€è¿œçš„ä¸€åªé¸¡æ‰€éœ€é¢å¤–æ—¶é—´ã€‚æŒ‰é€Ÿåº¦æ’åºåå¯ä»¥çº¿æ€§ç®—ä»£ä»·ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const long double eps = 1e-12;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int v, n;        std::cin &gt;&gt; v &gt;&gt; n;        std::vector&lt;std::pair&lt;int, int&gt; &gt; a(n + 1);        for (int i = 1; i &lt;= n; ++i)            std::cin &gt;&gt; a[i].first;        for (int i = 1; i &lt;= n; ++i)            std::cin &gt;&gt; a[i].second;        a.emplace_back(0, 0), ++n;        std::sort(a.begin() + 1, a.end());        int p = std::lower_bound(a.begin() + 1, a.end(), std::make_pair(0, 0)) - a.begin();        std::sort(a.begin() + 1, a.begin() + p, [](std::pair&lt;int, int&gt; x, std::pair&lt;int, int&gt; y) &#123; return x.second == y.second ? x.first &lt; y.first : x.second &gt; y.second; &#125;);        std::sort(a.begin() + p + 1, a.end(), [](std::pair&lt;int, int&gt; x, std::pair&lt;int, int&gt; y) &#123; return x.second == y.second ? x.first &lt; y.first : x.second &lt; y.second; &#125;);        std::vector&lt;std::vector&lt;long double&gt; &gt; f(n + 1, std::vector&lt;long double&gt; (n + 1, 1e18));        f[1][n] = 0.;        auto at = [&amp;](int i, long double t) &#123;            return std::fabs(a[i].first + t * a[i].second * (i &lt; p ? -1 : 1));        &#125;;        auto calc = [&amp;](int i, long double t) &#123;            return at(i, t) / (v - a[i].second);        &#125;;        // for (int i = 1; i &lt;= n; ++i)        //     printf(&quot;%d: (%d, %d)\n&quot;, i, a[i].first, a[i].second);        for (int i = 1; i &lt;= p; ++i)            for (int j = n; j &gt;= p; --j) &#123;                if (i == p &amp;&amp; j == p)                    break;                long double d = 0.;                // printf(&quot;[%d, %d]: %lf\n&quot;, i, j, f[i][j]);                for (int k = i; k &lt; p; ++k) &#123;                    if (at(k, f[i][j]) &gt;= at(i, f[i][j]) - eps)                        d = std::max(d, calc(k, f[i][j]));                    // printf(&quot;  k1 = %d, d = %lf\n&quot;, k, d);                    f[k + 1][j] = std::min(f[k + 1][j], f[i][j] + d + (k != j - 1) * d);                &#125;                d = 0.;                for (int k = j; k &gt; p; --k) &#123;                    if (at(k, f[i][j]) &gt;= at(j, f[i][j]) - eps)                        d = std::max(d, calc(k, f[i][j]));                    // printf(&quot;  k2 = %d, d = %lf\n&quot;, k, d);                    f[i][k - 1] = std::min(f[i][k - 1], f[i][j] + d + (k != i + 1) * d);                &#125;            &#125;        &#123;            static int casetot = 0;            std::cout &lt;&lt; &quot;Case #&quot; &lt;&lt; ++casetot &lt;&lt; &quot;: &quot;;        &#125;        std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(9) &lt;&lt; f[p][p] &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="the-great-marathon">6. The Great Marathon</h2><p><a href="https://codeforces.com/problemset/problem/38/H" class="uri">https://codeforces.com/problemset/problem/38/H</a></p><blockquote><p>ç»™å®šä¸€ä¸ª <span class="math inline">\(n\)</span> ä¸ªç‚¹ <span class="math inline">\(m\)</span> æ¡è¾¹çš„æ— å‘è¿é€šå›¾ï¼Œç‚¹ <span class="math inline">\(i\)</span> ä¸Šåˆå§‹æœ‰é€‰æ‰‹ <span class="math inline">\(i\)</span>ã€‚ä¸ºæ¯ä¸ªé€‰æ‰‹ä»»æ„æŒ‡å®šç»ˆç‚¹ï¼ˆå¯é‡å¤ï¼‰ï¼Œé‚£ä¹ˆæœ€åçš„æ’åæŒ‰ç…§æœ€çŸ­è·¯ä¸ºç¬¬ä¸€å…³é”®å­—ã€ç¼–å·ä¸ºç¬¬äºŒå…³é”®å­—æ’åºã€‚</p><p>ç°æŒ‰ç…§æ’ååºåˆ—åˆ†æˆå‰ä¸­åä¸‰æ®µï¼Œè®°ä¸ºé‡‘é“¶é“œç‰Œï¼›æ»¡è¶³é‡‘ç‰Œæ•°åœ¨ <span class="math inline">\([g_1,g_2]\)</span> ä¹‹é—´ï¼Œé“¶ç‰Œæ•°åœ¨ <span class="math inline">\([s_1,s_2]\)</span> ä¹‹é—´ã€‚ä»»æ„æŒ‡å®šå‘ç‰Œæ•°é‡å’Œæ¯ä¸ªäººçš„ç»ˆç‚¹ï¼Œé—®æœ€åæœ‰å¤šå°‘ç§æ–¹æ¡ˆæ•°ï¼›ä¸¤ä¸ªæ–¹æ¡ˆä¸åŒå½“ä¸”ä»…å½“æœ‰è‡³å°‘ä¸€ä¸ªäººæ‹¿çš„ç‰Œä¸ä¸€æ ·ã€‚</p><p><span class="math inline">\(n\le 50,m\le 1000\)</span>ã€‚</p></blockquote><p><mark><span class="math inline">\(n=50\)</span>ï¼šå¯èƒ½éœ€è¦è€ƒè™‘ <span class="math inline">\(n^5\)</span> åšæ³•ã€‚</mark></p><p>å‘ç°æ˜¯ <mark>éœ€è¦ç¡®å®šé¡ºåºçš„ DP</mark>ã€‚å…³é”®ä½ç½®è‡ªç„¶åœ¨äºã€é‡‘é“¶ã€é“¶é“œç•Œå¤„ã€ã€‚è€ƒè™‘é’¦å®šé‡‘ç‰Œæœ€åä¸€åã€é“œç‰Œç¬¬ä¸€åçš„äººé€‰ï¼ˆä¸è€ƒè™‘ä¸­é—´çš„é“¶ç‰Œæ˜¯å› ä¸ºä¼šå‡ºç°è¿™æ ·é‚£æ ·çš„é—®é¢˜ï¼‰ï¼Œè¿˜éœ€è¦æšä¸¾ä»–ä»¬çš„è·¯ç¨‹å—ï¼Ÿå¹¶ä¸ã€‚ç”šè€Œè‡³äºï¼Œè¿™æ ·åšä¼šç®—é‡ã€‚</p><p>è€ƒè™‘<mark>ã€æœ€å°åŒ–ã€å·¦å³ä¸¤ä¾§çš„é‡‘ç‰Œã€é“œç‰Œå¯é€‰é›†åˆ</mark>ã€‚å¼ºè¡Œè®©é‡‘ç‰Œæœ€åä¸€å <span class="math inline">\(u\)</span> çš„è·¯ç¨‹ä¸º <span class="math inline">\(\min\{dis_{u,i}\}\)</span>ï¼Œæœ€å°è·¯ç¨‹å°äºè¿™ä¸ªå€¼çš„æ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥æˆä¸ºé‡‘ç‰Œï¼›åŒæ—¶è®©é“œç‰Œç¬¬ä¸€å <span class="math inline">\(v\)</span> çš„è·¯ç¨‹ä¸º <span class="math inline">\(\max\{dis_{v,i}\}\)</span>ï¼Œæœ€å¤§è·¯ç¨‹å¤§äºè¿™ä¸ªå€¼çš„æ‰€æœ‰æ•°éƒ½å¯ä»¥æˆä¸ºé“œç‰Œã€‚</p><p>Q1: å¦‚æœå­˜åœ¨ä¸€ä¸ª <span class="math inline">\(i\)</span>ï¼Œå®ƒæœ€å°çš„è·ç¦»ä¹Ÿæ¯” <span class="math inline">\(u\)</span> çš„æœ€å°è·ç¦»å¤§ï¼Œä½†å®é™…ä¸Šå½“ <span class="math inline">\(u\)</span> æ›´å¤§ä¸€ç‚¹å„¿çš„æ—¶å€™ï¼Œ<span class="math inline">\(i\)</span> å¯ä»¥æˆä¸ºé‡‘ç‰Œå‘¢ï¼Ÿ</p><p>A1ï¼šè¿™ç§æƒ…å†µåœ¨é’¦å®š <span class="math inline">\(i\)</span> ä¸ºæœ€åä¸€åçš„æ—¶å€™è®¨è®ºè¿‡äº†ã€‚</p><p>Q2ï¼šæ˜¯å¦ä¼šç®—é‡ï¼Ÿ</p><p>A2ï¼šå¦‚ä¸Šæ‰€è¿°ï¼Œå‡å¦‚åœ¨é’¦å®š <span class="math inline">\(i\)</span> çš„æ—¶å€™ç»Ÿè®¡äº† <span class="math inline">\(u\)</span>ï¼Œé‚£ä¹ˆåœ¨é’¦å®š <span class="math inline">\(u\)</span> çš„æ—¶å€™å°±ä¸ä¼šç»Ÿè®¡ <span class="math inline">\(i\)</span>ã€‚</p><p>è€ƒè™‘è½¬ç§»ã€‚ä»¤ <span class="math inline">\(f_{i,u,v,j,k}\)</span> ä¸ºè€ƒè™‘åˆ° <span class="math inline">\(i\)</span>ï¼Œé‡‘ç‰Œå€’ä¸€ä¸º <span class="math inline">\(u\)</span>ï¼Œé“œç‰Œç¬¬ä¸€ä¸º <span class="math inline">\(v\)</span>ï¼Œé€‰äº† <span class="math inline">\(j\)</span> ä¸ªé‡‘ã€<span class="math inline">\(k\)</span> ä¸ªé“œçš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»æ˜¯ <span class="math inline">\(O(1)\)</span> çš„ã€‚</p><details><p>æ³¨æ„ <code>vector</code> è¦å¼€åœ¨å¾ªç¯å¤–é¢ï¼Œä¸ç„¶ç”³è¯·ç©ºé—´å¾ˆè€—æ—¶é—´ /ll</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1, std::vector&lt;int&gt; (n + 1, inf));    for (int x, y; m--; ) &#123;        std::cin &gt;&gt; x &gt;&gt; y;        std::cin &gt;&gt; g[x][y], g[y][x] = g[x][y];    &#125;    for (int i = 1; i &lt;= n; ++i)        g[i][i] = 0;    for (int k = 1; k &lt;= n; ++k)        for (int i = 1; i &lt;= n; ++i)            if (k != i)                for (int j = 1; j &lt;= n; ++j)                    if (i != k &amp;&amp; j != k)                        g[i][j] = std::min(g[i][j], g[i][k] + g[k][j]);    int g1, g2, s1, s2;    std::cin &gt;&gt; g1 &gt;&gt; g2 &gt;&gt; s1 &gt;&gt; s2;    for (int i = 1; i &lt;= n; ++i)        for (int j = 1; j &lt;= n; ++j)            if (g[i][j] != inf)                g[i][j] = g[i][j] * n + i;    std::vector&lt;int&gt; mx(n + 1), mn(n + 1, inf);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j)            if (j != i)                mn[i] = std::min(mn[i], g[i][j]);        mx[i] = *std::max_element(g[i].begin() + 1, g[i].end());    &#125;    auto res(0ll);    std::vector&lt;std::vector&lt;std::vector&lt;long long&gt; &gt; &gt; f(n + 1, std::vector&lt;std::vector&lt;long long&gt; &gt; (n + 1, std::vector&lt;long long&gt; (n + 1)));    for (int u = 1; u &lt;= n; ++u)        for (int v = 1; v &lt;= n; ++v)            if (v != u) &#123;                f[0][1][1] = 1ll;                for (int i = 1; i &lt;= n; ++i)                    if (i == u || i == v)                        f[i] = f[i - 1];                    else &#123;                        bool flag = 0;                        for (int j = 1; j &lt;= n; ++j)                            if (mn[u] &lt; g[i][j] &amp;&amp; g[i][j] &lt; mx[v]) &#123;                                flag = 1;                                break;                            &#125;                        for (int j = 1; j &lt;= g2; ++j)                            for (int k = 1; k &lt;= n - g1 - s1; ++k) &#123;                                f[i][j][k] = 0ll;                                if (mx[i] &lt; mn[u])                                    f[i][j][k] = f[i - 1][j - 1][k];                                else if (mn[i] &gt; mx[v])                                    f[i][j][k] = f[i - 1][j][k - 1];                                else &#123;                                    if (flag)                                        f[i][j][k] = f[i - 1][j][k];                                    if (mn[i] &lt; mn[u])                                        f[i][j][k] += f[i - 1][j - 1][k];                                    if (mx[i] &gt; mx[v])                                        f[i][j][k] += f[i - 1][j][k - 1];                                &#125;                            &#125;                    &#125;                for (int g = g1; g &lt;= g2; ++g)                    for (int s = s1; s &lt;= s2; ++s)                        res += f[n][g][n - g - s];            &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="sorting-pancakes">7. Sorting Pancakes</h2><p><a href="https://codeforces.com/contest/1675/problem/G" class="uri">https://codeforces.com/contest/1675/problem/G</a></p><blockquote><p>ç»™å®šç›’å­ <span class="math inline">\(1\sim n\)</span> å’Œæ¯ä¸ªç›’å­ <span class="math inline">\(i\)</span> é‡Œçš„åˆå§‹çƒæ•° <span class="math inline">\(a_i\)</span>ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ªçƒç§»åŠ¨åˆ°ç›¸é‚»ç›’å­ï¼Œæœ€åæ¬²ä½¿ç›’å­å†…çƒæ•°å•è°ƒä¸å‡,æ±‚æœ€å°ç§»çƒæ¬¡æ•°ã€‚</p><p><span class="math inline">\(n,\sum a_i\le 250\)</span>ã€‚</p></blockquote><p>ç®€å•é¢˜ï¼è¿™ç§ã€ç§»åŠ¨å…ƒç´ çš„é¢˜ã€ï¼Œä¼šè€ƒè™‘<mark>é’¦å®šæ¯ä¸ªå…ƒç´ æœ€ç»ˆçš„å€¼ï¼ŒæŠŠå‰é¢çš„å…ƒç´ å¯Œä½™çš„ / æ¬ ä¸‹æ¥çš„å­˜å‚¨èµ·æ¥</mark>ã€‚<em>å½“ç„¶ä¹Ÿæœ‰ä¾‹å¤–ï¼Œæ¯”å¦‚æ·»åŠ äº†ã€æ—¶é—´ã€è¿™ä¸€ç»´çš„é™åˆ¶ï¼Œgoto <a href="http://localhost:4000/20250510/#a---pass-to-next">solu to Pass to Next</a></em></p><p>åœ¨å¦‚æœåœ¨ <span class="math inline">\(i\)</span> å¤„å¯Œä½™äº† <span class="math inline">\(x\)</span>ï¼Œé‚£ä¹ˆåœ¨ç§»åŠ¨åˆ° <span class="math inline">\(i+1\)</span> çš„è¿‡ç¨‹ä¸­å°±ä¼šäº§ç”Ÿ <span class="math inline">\(|x|\)</span> çš„ä»£ä»·ã€‚</p><p>ä»¤ <span class="math inline">\(f_{i,k,j}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> ä¸ªå…ƒç´ å¤„ï¼Œé’¦å®šå®ƒæœ€ç»ˆä¸º <span class="math inline">\(j\)</span>ï¼Œå¯Œä½™ <span class="math inline">\(k\)</span>ï¼Œåˆ™ <span class="math inline">\(f_{i,k,j}\gets \min\limits_{j&#39;\ge j}\{f_{i-1, k-(j-a_i),j&#39;}\}\)</span>ã€‚æ˜¾è€Œæ˜“è§åç¼€ min ä¼˜åŒ–å°±èƒ½ <span class="math inline">\(O(n\cdot m^2)\)</span> åœ°åšäº†ã€‚</p><details><p>DP æ•°ç»„å’Œåç¼€ min æ•°ç»„è¦åˆèµ·æ¥ï¼Œä¸ç„¶ä¼š MLE /ll</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;int&gt; a(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    using arr = std::vector&lt;int&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    crr f(n + 1, brr(2 * m + 1, arr(m + 1, inf)));    std::fill(f[0][m].begin(), f[0][m].begin() + m + 1, 0);    for (int i = 1; i &lt;= n; ++i)        for (int k = 0; k &lt;= 2 * m; ++k)            for (int j = std::min(m, k + a[i]); j &gt;= std::max(0, k + a[i] - 2 * m); --j) &#123;                f[i][k][j] = f[i - 1][k - (j - a[i])][j] + std::abs(k - m);                if (j != m)                    f[i][k][j] = std::min(f[i][k][j], f[i][k][j + 1]);            &#125;    std::cout &lt;&lt; f[n][m][0] &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="complexity">8. Complexity</h2><p><a href="https://atcoder.jp/contests/agc033/tasks/agc033_d" class="uri">https://atcoder.jp/contests/agc033/tasks/agc033_d</a></p><blockquote><p>ç»™å®š <span class="math inline">\(n\times m\)</span> çš„ <span class="math inline">\(01\)</span> çŸ©é˜µã€‚å®šä¹‰å…¶å­çŸ©é˜µçš„å‡Œä¹±åº¦ï¼š</p><ul><li>è‹¥è¯¥çŸ©é˜µä¸­åªæœ‰ä¸€ç§å€¼ï¼Œå‡Œä¹±åº¦ä¸º <span class="math inline">\(0\)</span>ã€‚</li><li>å¦åˆ™ï¼Œä»»æ„ç«–ç›´ / æ°´å¹³åˆ‡ä¸€åˆ€ï¼Œå¾—åˆ°ä¸¤ä¸ªå°çŸ©é˜µï¼›è‹¥å®ƒä»¬çš„å‡Œä¹±åº¦åˆ†åˆ«ä¸º <span class="math inline">\(a,b\)</span>ï¼Œåˆ™å¤§çŸ©é˜µçš„å‡Œä¹±åº¦ä¸º <span class="math inline">\(\max(a,b)+1\)</span> çš„æœ€å°å€¼ã€‚</li></ul><p>æ±‚ç»™å®šçŸ©é˜µçš„å‡Œä¹±åº¦ã€‚<span class="math inline">\(n,m\le 185\)</span>ã€‚</p></blockquote><p>å¦‚æœæš´åŠ›æšä¸¾ DPï¼Œå¾ˆä¸å¹¸æ˜¯ <span class="math inline">\(n^5\)</span> çš„ã€‚è€ƒè™‘ä¼˜åŒ–ã€‚å‘ç°çŸ©é˜µçš„å‡Œä¹±åº¦å¤§è‡´åœ¨ <span class="math inline">\(O(\log n)\)</span> çº§åˆ«ï¼Œè€ƒè™‘ç”¨<mark>çŠ¶æ€äº¤æ¢ç­”æ¡ˆ</mark>å‡å°å¤æ‚åº¦ã€‚å…·ä½“åœ°ï¼Œè®¾ <span class="math inline">\(f_{k,u,d,l}\)</span> è¡¨ç¤ºå‡Œä¹±åº¦ <span class="math inline">\(\le k\)</span> æ—¶ï¼Œ<span class="math inline">\(r\)</span> å¯å–åˆ°çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆæœ‰è½¬ç§»ï¼š</p><ul><li>ç«–ç€åˆ‡ä¸€åˆ€ï¼Œæšä¸¾åˆ‡ç‚¹ <span class="math inline">\(i\le f_{k-1,u,d,l}\)</span>ï¼Œæœ‰ <span class="math inline">\(f_{k,u,d,l}\gets f_{k-1,u,d,i+1}\)</span>ã€‚å‘ç°æ˜¾ç„¶ <span class="math inline">\(i\)</span> å– <span class="math inline">\(f_{k-1,u,d,l}\)</span> çš„æ—¶å€™æœ€ä¼˜ï¼Œè¿™ä¸ªæ˜¯ <span class="math inline">\(O(1)\)</span> çš„ã€‚</li><li>æ¨ªç€åˆ‡ä¸€åˆ€ï¼Œæšä¸¾åˆ‡ç‚¹ <span class="math inline">\(i\in[u,d)\)</span>ï¼Œæœ‰ <span class="math inline">\(f_{k,u,d,l}\gets \min(f_{k-1,u,i,l},f_{k-1,i+1,d,l})\)</span>ã€‚å‘ç°éš <span class="math inline">\(i\)</span> å¢å¤§å·¦è¾¹å•è°ƒä¸å¢ï¼Œå³è¾¹å•è°ƒä¸é™ã€‚éšç€ <span class="math inline">\(d\)</span> çš„å¢å¤§ï¼Œå·¦è¾¹ä¸å˜ï¼Œå³è¾¹ä¸‹ç§»ï¼Œäº¤å‡ºæ¥çš„äº¤ç‚¹ä¸€ç›´å³ç§»ã€‚ç„¶åå°±å¯ä»¥ä¼˜åŒ–åˆ°å‡æ‘Š <span class="math inline">\(O(1)\)</span>ã€‚</li></ul><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int inf = 0x3f3f3f3f;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;std::vector&lt;char&gt; &gt; a(n + 1, std::vector&lt;char&gt; (m + 1));    for (int i = 1; i &lt;= n; ++i)        for (int j = 1; j &lt;= m; ++j)            std::cin &gt;&gt; a[i][j];    using arr = std::vector&lt;int&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    std::vector&lt;std::string&gt; res;    std::vector&lt;crr&gt; _f(2, crr(n + 1, brr(m + 1, arr(n + 1))));    for (int k = 0; ; ++k) &#123;        auto &amp;f = _f[k &amp; 1], &amp;f1 = _f[(k &amp; 1) ^ 1];        if (k == 0) &#123;            crr tag(m + 1, brr(n + 1, arr(n + 1, -1)));            for (int l = 1; l &lt;= m; ++l)                for (int u = 1; u &lt;= n; ++u)                    for (int d = u; d &lt;= n &amp;&amp; a[d][l] == a[u][l]; ++d)                        tag[l][u][d] = a[u][l];            for (int u = 1; u &lt;= n; ++u)                for (int d = u; d &lt;= n; ++d)                    for (int l = m; l; --l) &#123;                        f[u][l][d] = l - 1;                        if (~tag[l][u][d]) &#123;                            if (l != m &amp;&amp; tag[l][u][d] == tag[l + 1][u][d])                                f[u][l][d] = f[u][l + 1][d];                            else                                f[u][l][d] = l;                        &#125;                    &#125;        &#125;        else            for (int u = 1; u &lt;= n; ++u)                for (int l = 1; l &lt;= m; ++l)                    for (int d = u, pos = 1; d &lt;= n; ++d) &#123;                        f[u][l][d] = f1[u][l][d];                        if (f[u][l][d] != m) &#123;                            f[u][l][d] = std::max(f[u][l][d], f1[u][f1[u][l][d] + 1][d]);                            int mx = 0;                            for (int i = pos; i &lt; d; ++i) &#123;                                if (std::min(f1[u][l][i], f1[i + 1][l][d]) &gt;= mx)                                    mx = std::min(f1[u][l][i], f1[i + 1][l][d]), pos = i;                                else                                    break;                            &#125;                            f[u][l][d] = std::max(f[u][l][d], mx);                        &#125;                    &#125;        if (f[1][1][n] == m) &#123;            std::cout &lt;&lt; k &lt;&lt; &#39;\n&#39;;            return 0;        &#125;    &#125;    return 0;&#125;</code></pre></details><hr /><h2 id="boxes-and-balls">9. Boxes and Balls</h2><p><a href="https://www.luogu.com.cn/problem/CF1845E" class="uri">https://www.luogu.com.cn/problem/CF1845E</a></p><blockquote><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„ <span class="math inline">\(01\)</span> åºåˆ— <span class="math inline">\(a_{1\sim n}\)</span>ã€‚ä½ å¯ä»¥è¿›è¡Œæ°å¥½ <span class="math inline">\(k\)</span> æ¬¡å¦‚ä¸‹æ“ä½œï¼š</p><ul><li>é€‰æ‹©åºåˆ—ä¸­ä¸€å¯¹ç›¸é‚»ä¸”å€¼ä¸åŒçš„å…ƒç´ ï¼Œå°†å®ƒä»¬äº¤æ¢ã€‚</li></ul><p>é—®æœ‰å¤šå°‘ç§æœ€ç»ˆåºåˆ—ã€‚<span class="math inline">\(n,k\le 1500\)</span>ã€‚</p></blockquote><p>æ²¿ç”¨ <a href="#sorting-pancakes">7. Sorting Pancakes</a> çš„æ€è·¯ï¼Œè€ƒè™‘ä»¤ <span class="math inline">\(f_{i,j,l}\)</span> è¡¨ç¤ºæœ€ç»ˆåºåˆ—çš„å‰ <span class="math inline">\(i\)</span> ä¸ªé‡Œæœ‰ <span class="math inline">\(j\)</span> ä¸ª <span class="math inline">\(1\)</span>ï¼Œä»£ä»·å·²ç»æœ‰ <span class="math inline">\(l\)</span> çš„æ–¹æ¡ˆæ•°ï¼›é‚£ä¹ˆä»¤ <span class="math inline">\(s_i\)</span> ä¸º <span class="math inline">\(a\)</span> çš„å‰ç¼€å’Œï¼Œæ˜¾ç„¶æœ‰ï¼š</p><p><span class="math display">\[f_{i+1,j+1,k+|j-s_i|}\gets f_{i,j,k}\\f_{i+1,j,k+|j-s_i|}\gets f_{i,j,k}\]</span></p><p>æœ€ååœ¨æ¯” <span class="math inline">\(k\)</span> å°ä¸”å¥‡å¶æ€§å’Œ <span class="math inline">\(k\)</span> ç›¸åŒçš„ <span class="math inline">\(l\)</span> é‡Œæ‰¾ç­”æ¡ˆã€‚ç„¶åæƒ³æ€ä¹ˆä¼˜åŒ–ã€‚</p><p>ç­”æ¡ˆæ˜¯ä¸ç”¨ä¼˜åŒ–ã€‚è€ƒè™‘<mark>æœ‰æ•ˆçŠ¶æ€æ•°</mark>ï¼Œ<del>æ‰“ä¸ªè¡¨å‘ç°æ¯ä¸ª <span class="math inline">\(i\)</span> åœ¨ <span class="math inline">\(O(n\sqrt n)\)</span> å·¦å³</del>ï¼Œä½†æœ‰å¦ä¸€ç§æ–¹æ³•æ˜¯å‘ç°æœ‰æ•ˆçš„ <span class="math inline">\(|j-s_i|\)</span> ä¸ä¼šè¶…è¿‡ <span class="math inline">\(O(\sqrt n)\)</span>ï¼ˆåŸå› ï¼šä¸ºäº†æ¶ˆé™¤ <span class="math inline">\(|j-s_i|\)</span> çš„æ¬ è´¦ï¼Œéœ€è¦ <span class="math inline">\(|j-s_i|\)</span> ä¸ªä½ç½®ï¼›æ¯ä¸ªä½ç½®éƒ½ä¼šæœ‰å·®ä¸å¤š <span class="math inline">\(|j-s_i|\)</span> çš„ä»£ä»·ï¼‰ï¼Œæ‰€ä»¥æšä¸¾æ—¶åªç”¨æšä¸¾ <span class="math inline">\(O(\sqrt n)\)</span> ä¸ª <span class="math inline">\(j\)</span>ã€‚</p><p>æ€»ä¹‹åªç”¨å­˜æœ‰æ•ˆçŠ¶æ€ä¼šå‘ç°è·‘ä¸æ»¡ <img src="/em/bb.gif" /></p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int n, k;    std::cin &gt;&gt; n &gt;&gt; k;    std::vector&lt;int&gt; a(n + 1), s(n + 1);    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; a[i];    std::partial_sum(a.begin() + 1, a.end(), s.begin() + 1);    using arr = std::vector&lt;long long&gt;;    using brr = std::vector&lt;arr&gt;;    using crr = std::vector&lt;brr&gt;;    brr tag(n + 1, arr(n + 1));    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; stt(2);    stt[0].emplace_back(0, 0);    crr _f(2, brr(n + 1, arr(k + 1)));    _f[0][0][0] = 1;    for (int i = 0; i &lt; n; ++i) &#123;        auto &amp;f = _f[i &amp; 1], &amp;f1 = _f[(i &amp; 1) ^ 1];        std::vector&lt;std::pair&lt;int, int&gt; &gt;().swap(stt[(i &amp; 1) ^ 1]);        for (auto [j, l] : stt[i &amp; 1]) &#123;                if (j + 1 &lt;= s[n] &amp;&amp; l + std::abs(j - s[i]) &lt;= k) &#123;                    if (tag[j + 1][l + std::abs(j - s[i])] != i + 1)                        tag[j + 1][l + std::abs(j - s[i])] = i + 1, stt[(i &amp; 1) ^ 1].emplace_back(j + 1, l + std::abs(j - s[i])), f1[j + 1][l + std::abs(j - s[i])] = 0ll;                    (f1[j + 1][l + std::abs(j - s[i])] += f[j][l]) %= mod;                &#125;                if (l + std::abs(j - s[i]) &lt;= k) &#123;                    if (tag[j][l + std::abs(j - s[i])] != i + 1)                        tag[j][l + std::abs(j - s[i])] = i + 1, stt[(i &amp; 1) ^ 1].emplace_back(j, l + std::abs(j - s[i])), f1[j][l + std::abs(j - s[i])] = 0ll;                    (f1[j][l + std::abs(j - s[i])] += f[j][l]) %= mod;                &#125;            &#125;        std::cout &lt;&lt; (int)stt[i &amp; 1].size() &lt;&lt; &#39;\n&#39;;    &#125;    auto res(0ll);    for (int i = k &amp; 1; i &lt;= k; i += 2)        if (tag[s[n]][i] == n)            (res += _f[n &amp; 1][s[n]][i]) %= mod;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h2 id="legondary-grandmaster">10. LEGOndary Grandmaster</h2><p><a href="https://codeforces.com/problemset/problem/1615/F" class="uri">https://codeforces.com/problemset/problem/1615/F</a></p><blockquote><p>ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„ <span class="math inline">\(0/1/?\)</span> ä¸² <span class="math inline">\(s,t\)</span>ï¼Œä½ å¯ä»¥å¯¹ <span class="math inline">\(s\)</span> è¿›è¡Œè‹¥å¹²æ¬¡å¦‚ä¸‹æ“ä½œï¼š</p><ul><li>é€‰æ‹©åºåˆ—ä¸­ä¸€å¯¹ç›¸é‚»ä¸”å€¼ç›¸åŒçš„å…ƒç´ ï¼Œå°†å®ƒä»¬å–åã€‚</li></ul><p>ç°ä»»æ„å°† <span class="math inline">\(s\)</span> å’Œ <span class="math inline">\(t\)</span> ä¸­çš„ <code>?</code> å¡«ä¸º <span class="math inline">\(0/1\)</span>ï¼Œé—®æ‰€æœ‰æƒ…å†µä¸­ <span class="math inline">\(s\)</span> è½¬åŒ–ä¸º <span class="math inline">\(t\)</span> æ‰€éœ€æœ€å°æ“ä½œæ¬¡æ•°å’Œï¼ˆè§„å®šæ— è§£çš„æ“ä½œæ¬¡æ•°ä¸º <span class="math inline">\(0\)</span>ï¼‰ã€‚<span class="math inline">\(n\le 2000\)</span>ã€‚</p></blockquote><p>å¦‚æœæˆ‘ä»¬ä¹‹å‰åšè¿‡æŸäº›ä»¤äººå¿ƒï¼ˆå’¬ï¼‰æ—·ï¼ˆç‰™ï¼‰ç¥ï¼ˆåˆ‡ï¼‰æ€¡ï¼ˆé½¿ï¼‰çš„é¢˜ç›®ï¼Œä¼šå‘ç°è¿™ä¸ªæ“ä½œç­‰ä»·äºäº¤æ¢ä»»æ„ä¸¤ä¸ªç›¸é‚»æ•°ï¼Œå†è®©ä»–ä»¬å–åã€‚</p><p>è¿›ä¸€æ­¥åœ°ï¼Œå¯ä»¥äº¤æ¢è¿ç®—é¡ºåºï¼Œå…ˆå–åæŸä¸ªä½ç½®ï¼Œå†äº¤æ¢ï¼Œå†å–åè¿™ä¸ªä½ç½®â€”â€”æŠŠè¿™ä¸ªæ“ä½œå¹³å‡åˆ†é…åˆ° <span class="math inline">\(s\)</span> å’Œ <span class="math inline">\(t\)</span> ä¸Šï¼Œ<mark>ç»“åˆã€ç›¸é‚»ä¸¤æ•°ä½ç½®å¿…ä¸€å¥‡ä¸€å¶ã€è¿™ä¸ªç¾å¦™çš„æ€§è´¨ï¼Œæƒ³åˆ°æŠŠ <span class="math inline">\(s\)</span> å’Œ <span class="math inline">\(t\)</span> çš„å¥‡æ•°ä½éƒ½æå‰å–åï¼Œè¿™æ ·å°±å¯ä»¥è½¬åŒ–æˆç›´æ¥äº¤æ¢äº†</mark>ï¼Œ</p><p>æ¥ä¸‹æ¥å°±å’Œä¸Šä¸€é¢˜æœ‰ç‚¹ä¸ä¸€æ ·äº†ã€‚è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç®—ä¸€ä¸ªä½ç½®çš„è´¡çŒ®â€”â€”è¿™æ„å‘³ç€ä¸éœ€è¦ç»Ÿè®¡ä¸€ä¸ªåºåˆ—çš„ä»£ä»·ï¼ˆæ­¤æ—¶å¤±å»äº† <span class="math inline">\(k\)</span> çš„é™åˆ¶ï¼Œä»£ä»·æ¥åˆ° <span class="math inline">\(n^2\)</span> çº§åˆ«ï¼‰ã€‚ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºä»å‰å¾€ååˆ°äº†ç¬¬ <span class="math inline">\(i\)</span> ä¸ªä½ç½®ï¼Œæ¬ å€ºä¸º <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ï¼›åŒæ ·åœ°ï¼Œä»¤ <span class="math inline">\(g_{i,j}\)</span> è¡¨ç¤ºä»ååˆ°å‰åˆ°äº†ç¬¬ <span class="math inline">\(i\)</span> ä¸ªä½ç½®ï¼Œæ¬ å€ºä¸º <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ã€‚åˆ™è´¡çŒ®ä¸º <span class="math inline">\(\sum_i \sum_j f_{i, j}\times g_{i + 1, -j}\times j\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int mod = 1e9 + 7;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr), std::cout.tie(nullptr);#else    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);#endif    int T;    for (std::cin &gt;&gt; T; T--; ) &#123;        int n;        std::string s, t;        std::cin &gt;&gt; n &gt;&gt; s &gt;&gt; t, s = &#39;#&#39; + s, t = &#39;#&#39; + t;        for (int i = 1; i &lt;= n; ++i)            if (i &amp; 1) &#123;                if (s[i] != &#39;?&#39;)                    s[i] = &#39;0&#39; + &#39;1&#39; - s[i];                if (t[i] != &#39;?&#39;)                    t[i] = &#39;0&#39; + &#39;1&#39; - t[i];            &#125;        using arr = std::vector&lt;long long&gt;;        using brr = std::vector&lt;arr&gt;;        brr f(n + 1, arr(2 * n + 1)), g(n + 2, arr(2 * n + 1));        f[0][n] = 1ll;        for (int i = 1; i &lt;= n; ++i) &#123;            for (int S = 0; S &lt;= 1; ++S)                if ((S == 0 &amp;&amp; s[i] == &#39;1&#39;) || (S == 1 &amp;&amp; s[i] == &#39;0&#39;));                else                    for (int T = 0; T &lt;= 1; ++T) &#123;                        if ((T == 0 &amp;&amp; t[i] == &#39;1&#39;) || (T == 1 &amp;&amp; t[i] == &#39;0&#39;));                        else                            for (int j = 0; j &lt;= 2 * n; ++j)                                if (j - (T - S) &gt;= 0 &amp;&amp; j - (T - S) &lt;= 2 * n)                                    (f[i][j] += f[i - 1][j - (T - S)]) %= mod;                    &#125;        &#125;        g[n + 1][n] = 1ll;        for (int i = n; i; --i) &#123;            for (int S = 0; S &lt;= 1; ++S)                if ((S == 0 &amp;&amp; s[i] == &#39;1&#39;) || (S == 1 &amp;&amp; s[i] == &#39;0&#39;));                else                    for (int T = 0; T &lt;= 1; ++T) &#123;                        if ((T == 0 &amp;&amp; t[i] == &#39;1&#39;) || (T == 1 &amp;&amp; t[i] == &#39;0&#39;));                        else                            for (int j = 0; j &lt;= 2 * n; ++j)                                if (j - (T - S) &gt;= 0 &amp;&amp; j - (T - S) &lt;= 2 * n)                                    (g[i][j] += g[i + 1][j - (T - S)]) %= mod;                    &#125;        &#125;        auto res(0ll);        for (int i = 1; i &lt; n; ++i)            for (int j = 1; j &lt;= n; ++j) &#123;                (res += j * f[i][n + j] % mod * g[i + 1][n - j] % mod) %= mod;                (res += j * f[i][n - j] % mod * g[i + 1][n + j] % mod) %= mod;            &#125;        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åª’ä»‹ç´ å…»</title>
      <link href="/20240625/"/>
      <url>/20240625/</url>
      
        <content type="html"><![CDATA[<p>Adapted from ä¹‹å‰çš„ä¸€ç‰‡å‘ç”µæ–‡ã€‚ç°åœ¨æ›´ç™«äº†ã€‚</p><span id="more"></span><hr /><p><img src="pre.jpeg" /></p><hr /><p>åª’ä»‹ç´ å…»ä¸€èˆ¬æ˜¯æŒ‡äººä»¬æ­£ç¡®åœ°ã€å»ºè®¾æ€§åœ°ä½¿ç”¨åª’ä»‹èµ„æºçš„èƒ½åŠ›ã€‚å®ƒåŒ…æ‹¬äººä»¬é¢å¯¹å„ç§ä¿¡æ¯æ—¶çš„é€‰æ‹©ã€ç†è§£ã€è´¨ç–‘ã€è¯„ä¼°ç­‰èƒ½åŠ›ã€‚</p><ul><li>å…³äºé€‰æ‹©ï¼šå¤ªé—æ†¾äº†ï¼ä½ æ²¡æœ‰ä»»ä½•å…¶ä»–çš„é¡¹ç›®æ˜¯å¯é€‰æ‹©çš„ï¼Œå› ä¸º<em>æ­Œæ„›ãƒ¦ã‚­</em>å¾ˆå¯çˆ±ï¼</li><li>å…³äºç†è§£ï¼šæ¥ä¸‹æ¥ï¼Œä½ å°†ä¼šåº¦è¿‡ä¸€å®šé‡çš„æ—¶é—´ç†è§£<em>æ­Œæ„›ãƒ¦ã‚­</em>çš„å¯çˆ±æ€§ã€‚</li><li>å…³äºè´¨ç–‘ï¼šæ˜¯çš„ï¼Œæ­£åœ¨è´¨ç–‘ï¼é€šå¸¸æƒ…å†µä¸‹è¿™ä»£è¡¨ç€ä¸€ç§å¥½çš„çŠ¶æ€ï¼Œä½†åœ¨è¿™é‡Œæ‚¨å¯èƒ½ä¼šé‡åˆ°éšœç¢â€”â€”ä½ ä¸ä¼šæƒ³è¦è´¨ç–‘<em>æ­Œæ„›ãƒ¦ã‚­</em>ã€‚äº‹å®ä¸Šï¼Œ<em>æ­Œæ„›ãƒ¦ã‚­</em>åˆæœ‰ä»€ä¹ˆæ˜¯å¯è´¨ç–‘çš„å‘¢ï¼Ÿ</li><li><p>å…³äºè¯„ä¼°ï¼šå½“ç„¶ï¼Œåœ¨è¿™é‡Œï¼Œè¯„ä¼°æœ‰ç€ä¸å¯å¿½è§†çš„é‡è¦æ€§â€”â€”æµ·å†…å­˜çŸ¥å·±ï¼Œå¤©æ¶¯è‹¥æ¯”é‚»ã€‚å¯¹æˆ‘ä»¬çš„<em>æ­Œæ„›ãƒ¦ã‚­</em>è¿›è¡Œæ‰“åˆ†ï¼</p><p>å¯é€‰çš„è¯„ä¼°é¡¹ï¼š</p><ul><li>100 åˆ†</li><li><p>å…¶ä»–ï¼Œè¯·è¡¥é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·é”Ÿæ–¤æ‹·çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«çƒ«</p><pre><code>ç¨‹åº Assessing.exe å¼•ç”¨äº†åä¸º 0x00000000ff çš„å†…å­˜ï¼Œè¯¥åœ°å€ä¸èƒ½ä¸º &#39;read&#39;ã€‚</code></pre><p>å¾ˆé—æ†¾ï¼çœ‹èµ·æ¥ä½ çš„ Windows å‡ºç°äº†é—®é¢˜ã€‚è¯·å‹¿å…³é—­ç”µè„‘ï¼Œæˆ‘ä»¬å°†ä¼šæ”¶é›†ä½ ç”µè„‘ä¸Šçš„é”™è¯¯ä¿¡æ¯ï¼Œæˆ‘ä»¬å°†ä¼šå°†å®ƒä¸Šä¼ åˆ° Microsoft å®˜ç½‘å¹¶å°è¯•åœ¨è„±æœºçŠ¶æ€ä¸‹è§£å†³å®ƒã€‚</p><p>é”™è¯¯ä»£ç ï¼š0x00009E2EAF60</p><p>æˆ‘ä»¬æ­£åœ¨ä¸ºä½ è§£æã€‚</p></li></ul></li></ul><hr /><p>å˜¿ï¼ŒæŠ¬èµ·å¤´ï¼è¿™ç¯‡å¸–å­å¯èƒ½å¹¶æ²¡æœ‰æ‚¨æ­£åœ¨è€ƒè™‘çš„é‚£æ ·é™Œç”Ÿï¼</p><p>Hey, heads up! The post may not so strange as you are considering!</p><p>è®©æˆ‘ä»¬åˆ†æè¿™äº›ç¬‘è¯ï¼</p><p>Letâ€™s analyse the jokes!</p><ul><li><p>åŠªåŠ›ç†è§£ã€ŒèŠ±ã€æ„å‘³ç€ä»€ä¹ˆã€‚</p>Try to understand what â€œspendâ€ means.</li><li><p>æ­£åœ¨é”™è¯¯åœ°ç¿»è¯‘ã€ŒæŸ¥è¯¢ã€ã€‚</p>Wrong translating â€œqueryingâ€.</li><li><p>æµ·å†…å­˜çŸ¥å·±ï¼Œå¤©æ¶¯è‹¥æ¯”é‚»ã€‚</p>Sea inside exist know self, sky Ya like than neighbor.</li><li><p>ä¸»è¯­å¹¶æœªå˜åŒ–ï¼Œä½†ä¸»è¯­å´åœ¨ç›¸é‚»çš„ä¸¤ä¸ªçŸ­å¥ä¸­å‡ºç°äº†ã€‚ç›¸åŒçš„ç›¸é‚»ä¸»è¯­æ²¡æœ‰å¾—åˆ°çœç•¥ï¼Œè€Œè¿™å°†å¯¼è‡´è¿™äº›ç›¸åŒçš„ä¸»è¯­çœ‹èµ·æ¥å¾ˆç´¯èµ˜ï¼</p>The subject didnâ€™t changed, but it appears in two adjacent short sentences. The same adjacent subjects havnâ€™t been omitted, which will make these identical subjects appear cumbersome!</li><li><p>æ­£åœ¨é”™è¿‡æ—¶é—´çŠ¶è¯­ï¼è¿™ä½¿ã€Œä¸Šä¼ ã€å’Œã€Œè„±æœºå¤„ç†ã€ä¸¤ä¸ªåŠ¨ä½œçœ‹ä¸Šå»åƒæ˜¯åŒæ—¶å‘ç”Ÿçš„ã€‚</p>Missing time adverb! This makes the actions of â€œuploadingâ€ and â€œoffline processingâ€ appear to occur simultaneously.</li><li><p>ä½ æ‚¨ä½ æ‚¨ä½ æ‚¨ä½ æ‚¨ä½ æ‚¨</p><p>You you you you you you you you you you</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> é—²è¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŠ¶å‹æšä¸¾å­é›† + é«˜ç»´å‰ç¼€å’Œ</title>
      <link href="/20240517/"/>
      <url>/20240517/</url>
      
        <content type="html"><![CDATA[<p>å‡ºç°äº†ï¼Œä½†å‘ç°æ²¡å†™è¿‡ï¼Œæ•…è®°ä¹‹ã€‚</p><span id="more"></span><hr /><h3 id="çŠ¶å‹æšä¸¾å­é›†">çŠ¶å‹æšä¸¾å­é›†</h3><p>éœ€æ±‚ï¼šå¯¹äº <strong>æ¯ä¸€ä¸ª</strong> é•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„äºŒè¿›åˆ¶çŠ¶æ€ <span class="math inline">\(s\)</span>ï¼Œæšä¸¾å…¶å­çŠ¶æ€ <span class="math inline">\(\{ t \mid t \operatorname{bitand} s = t \}\)</span>ã€‚</p><p>ç›´æ¥æšä¸¾æ‰€æœ‰é•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„çŠ¶æ€ <span class="math inline">\(t&#39;\)</span>ï¼Œç„¶ååˆ¤å®šæ˜¯å¦æ»¡è¶³ <span class="math inline">\(t&#39; \operatorname{bitand} s = t\)</span>ï¼Œæ€»æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="math inline">\(O(2^{2n})\)</span> çš„ã€‚è€ƒè™‘ä¼˜åŒ–ã€‚</p><p>è€ƒè™‘å¯¹äºæ‰€æœ‰ <span class="math inline">\(2^n\)</span> ç§çŠ¶æ€ <span class="math inline">\(s\)</span>ï¼Œå‡å¦‚æœ‰ä¸€ç§æ–¹å¼èƒ½å¤Ÿä¸é‡ä¸æ¼åœ°æšä¸¾å‡ºå®ƒä»¬ä¸­æ¯ä¸€ä¸ªçš„æ‰€æœ‰å­çŠ¶æ€ï¼Œé‚£ä¹ˆæ€»æ—¶é—´å¤æ‚åº¦æ˜¯å¤šå°‘å‘¢ï¼Ÿ</p><p>æŠŠæ‰€æœ‰æ•°å¯¹ <span class="math inline">\((s, t)\)</span> æ’åˆ—åœ¨ä¸€èµ·ã€‚é‚£ä¹ˆå¯¹äº <span class="math inline">\(n\)</span> ä½ä¸­çš„æ¯ä¸€ä½ <span class="math inline">\(i\)</span>ï¼Œæšä¸¾æ¯ä¸€ä¸ª <span class="math inline">\((s&#39;, t&#39;)\)</span>ã€‚</p><p>é‚£ä¹ˆå­˜åœ¨ä»¥ä¸‹å‡ ç§å¯èƒ½æ€§ï¼š</p><ol type="1"><li><span class="math inline">\({s&#39;}_i=1,{t&#39;}_i=1\)</span>ï¼›</li><li><span class="math inline">\({s&#39;}_i=1, {t&#39;}_i=0\)</span>ï¼›</li><li><span class="math inline">\({s&#39;}_i=0, {t&#39;}_i = 0\)</span>ã€‚</li></ol><p>å‡å¦‚æˆ‘ä»¬ç”¨ <span class="math inline">\(o_i=0,1,2\)</span> åˆ†åˆ«ä»£è¡¨ç¬¬ä¸€ã€äºŒã€ä¸‰ç§æƒ…å†µï¼Œå®Œå…¨å¯ä»¥ç”¨é•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„ä¸‰è¿›åˆ¶çŠ¶æ€ <span class="math inline">\(o\)</span> è¿˜åŸæ•°å¯¹ <span class="math inline">\((s, t)\)</span>ã€‚</p><p>ç”±äºè¿™ä¸ª <span class="math inline">\((s, t)\)</span> åºåˆ—ä¸­è‚¯å®šæ²¡æœ‰å®Œå…¨ç›¸åŒçš„å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºæ¯ä¸€ä¸ª <span class="math inline">\((s, t)\)</span>ï¼Œå…¶ <span class="math inline">\(o\)</span> éƒ½å„ä¸ç›¸åŒã€‚</p><p>å› æ­¤ï¼Œ<span class="math inline">\((s, t)\)</span> çš„æ•°ç›®ä¸è¶…è¿‡ <span class="math inline">\(3^n\)</span>ï¼ˆæ›´å‡†ç¡®åœ°ï¼ŒäºŒè€…å€¼ç›¸ç­‰ï¼‰ã€‚</p><p>åˆå› ä¸ºå¯¹äº <span class="math inline">\(3^n\)</span> ä¸ª <span class="math inline">\(o\)</span>ï¼Œæ¯ä¸ªéƒ½å¯ä»¥è¿˜åŸå‡ºåˆæ³•çŠ¶æ€ï¼Œæ‰€ä»¥æ€»çš„ <span class="math inline">\((s, t)\)</span> æ•°ç›®åº”æ°å¥½ä¸º <span class="math inline">\(3^n\)</span>ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡å¦‚æœ‰ä¸€ç§æ–¹å¼èƒ½å¤Ÿä¸é‡ä¸æ¼åœ°æšä¸¾å‡ºæ¯ä¸€ä¸ª <span class="math inline">\(s\)</span> çš„æ‰€æœ‰å­çŠ¶æ€ <span class="math inline">\(t\)</span>ï¼Œå¯ä»¥åšåˆ°å‡æ‘Š <span class="math inline">\(O(3^n)\)</span>ã€‚</p><p>æ¥ä¸‹æ¥æ¢è®¨è¿™ç§æšä¸¾æ–¹å¼ã€‚ç›´æ¥ç»™å‡ºç»“è®ºï¼š</p><pre class="cpp"><code>for (int t = s; t; t = (t - 1) &amp; s);</code></pre><p>å…¶å®ä¸éš¾ç†è§£ã€‚ä» <span class="math inline">\(t\)</span> çš„å®šä¹‰å‡ºå‘å³ <span class="math inline">\(t \operatorname{bitand} s = t\)</span>ï¼Œé‡ç‚¹ç†è§£ <span class="math inline">\(t\gets (t - 1)\operatorname{bitand} s\)</span> è¿™ä¸€æ­¥ã€‚</p><p>åˆ†ä¸¤ç§æƒ…å†µè®¨è®ºï¼š</p><ol type="1"><li><p><span class="math inline">\(t-1\)</span> è¾ƒ <span class="math inline">\(t\)</span> å‘ç”Ÿé€€ä½ï¼š</p><p>å› ä¸ºåªå‡ <span class="math inline">\(1\)</span>ï¼Œæ‰€ä»¥æœ«ä½ä¸€å®šå‘ç”Ÿé€€ä½ã€‚</p><p>å¦‚æœå‘ç”Ÿè¿ç»­é€€ä½ï¼Œä¸€å®šæ˜¯å› ä¸ºæœ«ç«¯æœ‰è¿ç»­çš„ <span class="math inline">\(0\)</span>ã€‚å¯¹äºç¬¬ä¸€ä¸ª <span class="math inline">\(1\)</span>ï¼ˆè®°ä¸ºç¬¬ <span class="math inline">\(j\)</span> ä½ï¼‰ï¼Œå·²ç»æšä¸¾å®Œäº†åœ¨ <span class="math inline">\(j\)</span> åŠæ›´é«˜ä½å›ºå®šåœ¨å½“å‰çŠ¶æ€ä¸‹çš„æ‰€æœ‰çŠ¶æ€ã€‚</p><p>åˆ™åº”æœ‰ï¼š</p><ul><li>æ¯” <span class="math inline">\(j\)</span> æ›´é«˜çš„æ•°ä½ï¼Œæœªå—åˆ°é€€ä½å¸¦æ¥çš„è¿ç»­å½±å“çš„ä½ä¸å˜ï¼›</li><li>ç¬¬ <span class="math inline">\(j\)</span> ä½ <span class="math inline">\(1\to 0\)</span>ï¼›</li><li>ä»ç¬¬ <span class="math inline">\(j\)</span> ä½ä¸€ç›´åˆ°æœ«ä½éƒ½æœ‰ <span class="math inline">\(0\to 1\)</span>ã€‚</li></ul><p>æ­¤æ—¶ä¸ <span class="math inline">\(s\)</span> è¿›è¡Œ <span class="math inline">\(\operatorname{bitand}\)</span>ï¼Œå¾—åˆ°æ¯” <span class="math inline">\(j\)</span> æ›´é«˜çš„æ•°ä½ä¸å˜ã€<span class="math inline">\(j\)</span> ä½ <span class="math inline">\(1\to 0\)</span>ã€æ¯” <span class="math inline">\(j\)</span> æ›´ä½çš„æ•°ä½å˜ä¸ºæŠµç€ <span class="math inline">\(s\)</span> å¯¹åº”æ•°ä½çš„æœ€å¤§çŠ¶æ€ã€‚</p>ç»¼ä¸Šï¼Œè¿™æ˜¯æ¯” <span class="math inline">\(t\)</span> å°çš„ç¬¬ä¸€ä¸ªåˆæ³•çŠ¶æ€ã€‚</li><li><p><span class="math inline">\(t-1\)</span> è¾ƒ <span class="math inline">\(t\)</span> ä¸å‘ç”Ÿé€€ä½ï¼š</p><p>æ ¹æ®ä¸Šé¢çš„è®¨è®ºï¼Œå…¶å®å°±æ˜¯æœ«ä½ä¸é€€ä½ï¼Œå³æœ«ä½ <span class="math inline">\(1\to 0\)</span>ã€‚æ˜¾ç„¶æ˜¯æ¯” <span class="math inline">\(t\)</span> æ›´å°çš„ç¬¬ä¸€ä¸ªåˆæ³•çŠ¶æ€ã€‚</p></li></ol><p>ç»¼ä¸Šï¼Œå®ç°äº†ä»å¤§åˆ°å°ä¾æ¬¡æšä¸¾åˆæ³•çŠ¶æ€ï¼Œå› æ­¤ä¸é‡ä¸æ¼ã€‚</p><hr /><h3 id="æšä¸¾è¡¥é›†">æšä¸¾è¡¥é›†</h3><p>çœ‹äº†å‡ ä¸ªæ¯”è¾ƒæŠ½è±¡çš„åšå®¢ï¼Œä½†æ˜¯æˆ‘è§‰å¾—ä¸å¦‚ç›´æ¥æŠŠ <span class="math inline">\(s\)</span> å¼‚æˆ–ä¸€ä¸‹ <span class="math inline">\(2^n-1\)</span> ç„¶åæšä¸¾å­é›†ã€‚</p><hr /><h3 id="å­é›†å’Œ-é«˜ç»´å‰ç¼€å’Œ">å­é›†å’Œ / é«˜ç»´å‰ç¼€å’Œ</h3><p>é¦–å…ˆç†è§£ä¸€ä¸‹ä»€ä¹ˆæ˜¯é«˜ç»´å‰ç¼€å’Œã€‚å®é™…ä¸Šå…¨ç§°åº”ä¸ºè¾¹é•¿ä¸º <span class="math inline">\(2\)</span> çš„é«˜ç»´ç©ºé—´å‰ç¼€å’Œã€‚å…¶å®å°±æ˜¯æ±‚æ‰€æœ‰çŠ¶æ€çš„å­é›†å’Œï¼Œè¿ç”¨äº†å‰ç¼€å’Œçš„æ€æƒ³æ•…å”¤é«˜ä½å‰ç¼€å’Œ / é€ç»´å‰ç¼€å’Œã€‚</p><p>å³åœ¨ <span class="math inline">\(n=2\)</span> çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å‘ç°æˆ‘ä»¬å¯ä»¥å°† <span class="math inline">\(k\)</span> ç»´å‰ç¼€å’Œçœ‹ä½œåœ¨ <span class="math inline">\(k\)</span> ä½äºŒè¿›åˆ¶æ•°ä¸Šåšå­é›†å…ƒç´ æ±‚å’Œã€‚æ˜¾ç„¶æ ¹æ®æšä¸¾å­é›†æœ‰ <span class="math inline">\(3^k\)</span> çš„åšæ³•ï¼Œä½†è¿˜èƒ½æ›´å¿«ã€‚</p><pre class="cpp"><code>std::copy(a.begin(), a.end(), s.begin());for (int i = 0; i &lt; k; ++i)    for (int j = 0; j &lt; l; ++j)        if ((j &gt;&gt; i) &amp; 1)            s[j] += s[j ^ (1 &lt;&lt; i)];</code></pre><p>å…ˆæšä¸¾ <span class="math inline">\(i\)</span> æ˜¯å› ä¸ºä½¿ç”¨é«˜ç»´å‰ç¼€å’Œçš„é¢˜ç›®ä¸€èˆ¬æ—¶é™å¡å¾—æ¯”è¾ƒæ­»ï¼Œéœ€è¦ä½¿ç”¨å†…å­˜è¿ç»­è®¿é—®å°½é‡å‡å°å¸¸æ•°ã€‚</p><p>å¯¹äºçŠ¶æ€ <span class="math inline">\(j\)</span>ï¼Œè€ƒè™‘æšä¸¾å…¶æ¯ä¸€ç»´ä¸Šçš„å€¼ï¼Œåˆ™ <span class="math inline">\(s_j=a_j+\sum s_{j\bigoplus 2^i}\)</span>ã€‚æ˜“å‘ç°è¿™å¯ä»¥ä¸é‡ä¸æ¼åœ°è¦†ç›–æ‰€æœ‰å­é›†ã€‚</p><p>è¿™ç§æ€æƒ³åœ¨ä¸€äº›çŠ¶æ€å‹ç¼©çš„é¢˜ç›®ä¸­ä¹Ÿæœ‰åº”ç”¨ï¼Œå…·ä½“è§ <a href="/20231117#1">æ­¤</a>ã€‚</p><h3 id="é«˜ç»´åç¼€å’Œ">é«˜ç»´åç¼€å’Œ</h3><p>ä»å¤§å¾€å°æšä¸¾ <span class="math inline">\(j\)</span>ï¼Œå¯¹äº <span class="math inline">\(j\)</span> ä¸­å€¼ä¸º <code>false</code> çš„ç»´ <span class="math inline">\(i\)</span>ï¼Œä»¤ <span class="math inline">\(s_j=a_j+\sum s_{j+2^i}\)</span> å³å¯ã€‚</p><pre class="cpp"><code>std::copy(a.begin(), a.end(), s.begin());for (int i = 0; i &lt; k; ++i)    for (int j = l - 1; ~j; --j)        if (!((j &gt;&gt; i) &amp; 1))            s[j] += s[j ^ (1 &lt;&lt; i)];</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> çŠ¶å‹ </tag>
            
            <tag> é«˜ç»´å‰ç¼€å’Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº”ä¸€æ‚é¢˜</title>
      <link href="/20240501/"/>
      <url>/20240501/</url>
      
        <content type="html"><![CDATA[<p><a href="http://222.180.160.110:61235/contest/5169">SAM æ‚é¢˜</a> + <a href="http://222.180.160.110:61235/contest/5170">NOIPS8</a> + <a href="http://222.180.160.110:61235/contest/5175">å‘¨è€ƒ</a> é€‰è®²ã€‚</p><p>çœ‹çœ‹è¿™ä¸ªæ ‡ç­¾åˆ—è¡¨é•¿åº¦å°±çŸ¥é“è¿™ä¸‰å¤©åšçš„é¢˜æœ‰å¤šæ‚ã€‚</p><span id="more"></span><hr /><h3 id="d.-å­—ç¬¦ä¸²">D. å­—ç¬¦ä¸²</h3><p><a href="http://222.180.160.110:61235/contest/5169/problem/4" class="uri">http://222.180.160.110:61235/contest/5169/problem/4</a></p><p>å’Œ SA çš„åšæ³•ä¸€æ ·ï¼Œå…ˆäºŒåˆ† <span class="math inline">\(s_{c\sim d}\)</span> çš„å‰ç¼€é•¿åº¦ <span class="math inline">\(mid\)</span>ï¼Œåªéœ€ check <span class="math inline">\(s_{c \sim c + mid - 1}\)</span> æ˜¯å¦åœ¨ <span class="math inline">\(s_{a\sim b}\)</span> ä¸­å‡ºç°è¿‡ã€‚</p><p>è€ƒè™‘æ€ä¹ˆå¿«é€Ÿ checkã€‚ä» <span class="math inline">\(c\)</span> ä¸€æ­¥ä¸€æ­¥è·³åˆ° <span class="math inline">\(c+mid-1\)</span> æ˜¾ç„¶ä¼šèµ·é£ï¼Œè€ƒè™‘åˆ°æŸ¥è¯¢æ˜¯é™æ€çš„ï¼Œæˆ‘ä»¬äº‹å…ˆé¢„å¤„ç†ä¸€ä¸‹ç„¶åå€å¢åœ°è·³å³å¯ã€‚</p><p>æ­¤æ—¶åªéœ€çœ‹å½“å‰çŠ¶æ€çš„ <span class="math inline">\(\text {endpos}\)</span> æ˜¯å¦åœ¨ <span class="math inline">\([a + mid - 1, b]\)</span> å‡ºç°è¿‡ã€‚</p><p>å› ä¸ºè¿™ä¸ªä¸èƒ½ç”¨æœ€å¤§æœ€å°ç®€å•ä»£æ›¿ï¼Œæ‰€ä»¥å°±åˆ°äº†æˆ‘ä»¬å–œé—»ä¹è§çš„çº¿æ®µæ ‘åˆå¹¶ç¯èŠ‚ã€‚å°†æ’å…¥åçš„æ¯ä¸ªå•ç‚¹ <span class="math inline">\(\text {endpos}\)</span> åœ¨æƒå€¼çº¿æ®µæ ‘ä¸Šæ›´æ–°ï¼Œåœ¨ parent tree ä¸Šæš´åŠ›çº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚</p><p>ä¹‹å‰ä¸€ç›´æœ‰ä¸€ä¸ªè¯¯åŒºï¼Œå°±æ˜¯è§‰å¾—çº¿æ®µæ ‘åˆå¹¶æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œæ¯”å¦‚ç”¨ A æ ‘å’Œ B æ ‘å¹¶å‡ºæ¥äº† C æ ‘ä¹‹åï¼ŒA æ ‘å’Œ B æ ‘çš„æ•°æ®å°±æ— æ•ˆäº†ã€‚</p><p>ä½†è¿™æ˜¾ç„¶æ˜¯å¾ˆè’è°¬çš„ï¼ŒåŒæ ·å› ä¸ºæˆ‘ä»¬çš„æŸ¥è¯¢æ˜¯é™æ€çš„ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ç”¨ä¸€ç§ç±»ä¼¼äºå¯æŒä¹…åŒ–çš„æ–¹å¼ï¼Œå»ºç«‹ä¸€äº›æ–°çš„ç‚¹è¡¨ç¤ºåˆå¹¶åçš„ä¿¡æ¯çŠ¶æ€ç‚¹ï¼Œä¸€äº›å¯ä»¥ä¿ç•™çš„ç‚¹å°±ä¿ç•™ä½œå„¿å­ã€‚</p><p>åœ¨å¯¹åº”çš„çŠ¶æ€ä¸ŠæŸ¥è¯¢å³å¯ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxm = 35;const int maxn = 6e5 + 5;const int maxk = 8e7 + 5;struct _ &#123;    int l, f;    int ne[maxm];     _() &#123;&#125;    _(int l1, int f1): l(l1), f(f1) &#123;&#125;&#125;;_ t[maxn &lt;&lt; 1];int vis[maxn &lt;&lt; 1];int fa[maxn][maxm];int n, la, tot, siz;struct &#123; int l, r, u; &#125; t1[maxk];int tab[maxn &lt;&lt; 1], cnt[maxn &lt;&lt; 1];void Init(void) &#123;    la = tot = 1;    t[1] = _(0, 0);    return;&#125;void ext(int c) &#123;    int p = la, np = ++tot;    la = tot;    t[np] = _(t[p].l + 1, 0);    while (p &amp;&amp; !t[p].ne[c])        t[p].ne[c] = np, p = t[p].f;    if (!p)        t[np].f = 1;    else &#123;        int q = t[p].ne[c];        if (t[q].l == t[p].l + 1)            t[np].f = q;        else &#123;            int nq = ++tot;            t[nq] = _(t[p].l + 1, t[q].f);            std::copy(t[q].ne, t[q].ne + 26, t[nq].ne);            while (p &amp;&amp; t[p].ne[c] == q)                t[p].ne[c] = nq, p = t[p].f;            t[q].f = nq;            t[np].f = nq;        &#125;    &#125;    return;&#125;int now = 0;void ins(int &amp;p, int l, int r, int v) &#123;    if (!p)        p = ++now;    ++t1[p].u;    if (l == r)        return;    int mid = (l + r) &gt;&gt; 1;    if (v &lt;= mid)        ins(t1[p].l, l, mid, v);    else        ins(t1[p].r, mid + 1, r, v);    return;&#125;int ask(int p, int l, int r, int ql, int qr) &#123;    if (ql &lt;= l &amp;&amp; r &lt;= qr)        return t1[p].u;    int mid = (l + r) &gt;&gt; 1, res = 0;    if (ql &lt;= mid)        res = ask(t1[p].l, l, mid, ql, qr);    if (qr &gt; mid)        res += ask(t1[p].r, mid + 1, r, ql, qr);    return res;&#125;int merge(int p, int q, int l, int r) &#123;    if (!p || !q)        return p + q;    int np = ++now, mid = (l + r) &gt;&gt; 1;    t1[np].u = t1[p].u + t1[q].u;    if (l == r) return np;    t1[np].l = merge(t1[p].l, t1[q].l, l, mid);    t1[np].r = merge(t1[p].r, t1[q].r, mid + 1, r);    return np;&#125;int pos[maxn], rt[maxn &lt;&lt; 1];bool check(int x, int a, int b, int c, int d) &#123;    assert(c + x - 1 &gt;= 0);    int p = pos[c + x - 1];    for (int i = siz; ~i; --i)        if (fa[p][i] &amp;&amp; t[fa[p][i]].l &gt;= x)            p = fa[p][i];    return ask(rt[p], 0, n - 1, a + x - 1, b) &gt; 0;&#125;int solve(int a, int b, int c, int d) &#123;    int l = 1, r = std::min(d - c + 1, b - a + 1), res = 0;    while (l &lt;= r) &#123;        int mid = (l + r) &gt;&gt; 1;        if (check(mid, a, b, c, d))            l = mid + 1, res = mid;        else            r = mid - 1;    &#125;    return res;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#endif    int m;    std::string s;    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; s;    Init();    for (int i = 0; i &lt; n; ++i) &#123;        ext(s[i] - &#39;a&#39;);        pos[i] = la;        ins(rt[la], 0, n - 1, i);    &#125;    siz = log(tot) / log(2.0);    for (int i = 1; i &lt;= tot; ++i)        ++cnt[t[i].l];    std::partial_sum(cnt + 1, cnt + tot + 1, cnt + 1);    for (int i = 1; i &lt;= tot; ++i)        tab[cnt[t[i].l]--] = i;    for (int i = 1; i &lt;= tot; ++i) &#123;        int u = tab[i];        fa[u][0] = t[u].f;        for (int j = 1; j &lt;= siz; ++j)            fa[u][j] = fa[fa[u][j - 1]][j - 1];    &#125;    for (int i = tot; i; --i) &#123;        int u = tab[i];        if (t[u].f)            rt[t[u].f] = merge(rt[t[u].f], rt[u], 0, n - 1);    &#125;    while (m--) &#123;        int a, b, c, d;        std::cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;        std::cout &lt;&lt; solve(a - 1, b - 1, c - 1, d - 1) &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="f.-security">F. Security</h3><p><a href="http://222.180.160.110:61235/contest/5169/problem/6" class="uri">http://222.180.160.110:61235/contest/5169/problem/6</a></p><p>å¯¹æˆ‘ä»¬æ¥è¯´åº”è¯¥æ˜¯ä¼š D å°±ä¼š F çš„ã€‚æ‰€ä»¥åªæ‰“äº† 10minã€‚</p><p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå¤§å®¶å–œé—»ä¹è§çš„ DFS æ±‚æœ€å°å­—å…¸åºã€‚æ˜¾ç„¶åœ°ï¼Œå¦‚æœå­˜åœ¨å’Œå½“å‰ä½ç›¸ç­‰çš„å­—ç¬¦ï¼Œé‚£ä¹ˆä¼˜å…ˆè·³ç›¸ç­‰å­—ç¬¦ï¼Œè¿›å…¥ä¸‹ä¸€å±‚æ·±æœï¼›å¦åˆ™æ‰¾åˆ°æœ€å°çš„æ›´å¤§å­—ç¬¦ï¼Œç„¶åç›´æ¥ outã€‚</p><p>æ­¤æ—¶ SAM å°±æ˜¯æˆ‘ä»¬ç”¨æ¥åˆ¤æ–­ <span class="math inline">\(S_{l, r}\)</span> ä¸­æ˜¯å¦å­˜åœ¨æŸçŠ¶æ€çš„å·¥å…·äº†ã€‚ç”šè‡³æ¯”ä¸Šä¸€é¢˜ç®€å•ï¼Œå› ä¸ºä¸ç”¨å†™äºŒåˆ†å’Œå€å¢ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯å¦‚æœ <span class="math inline">\(S_{l, r}\)</span> åŒ…å« <span class="math inline">\(T\)</span> é‚£ä¹ˆè¿˜è¦åœ¨åé¢éšä¾¿åŠ ä¸€ä¸ªå­—ç¬¦ä»¥å­—å…¸åºä¿è¯ä¸¥æ ¼å¤§äº <span class="math inline">\(T\)</span>ã€‚</p><details><p>å€¼å¾—æ³¨æ„çš„æ˜¯å› ä¸ºæˆ‘å†™çš„å¤ªä¸‘äº†ä»¥è‡³äºåœ¨ CF ä¸Šä¼šå…‰è£ MLE #46ã€‚ç„¶ååˆ†å±å·¦åŠè¾¹çœ‹æˆ‘ä»£ç å³åŠè¾¹å†™çš„ zwb å´æ²¡æœ‰ã€‚å•§ã€‚ä¸ºä»€ä¹ˆå‘¢ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxm = 35;const int maxn = 6e5 + 5;const int maxk = 8e7 + 5;struct _ &#123;    int l, f;    int ne[maxm];     _() &#123;&#125;    _(int l1, int f1): l(l1), f(f1) &#123;&#125;&#125;;_ t[maxn &lt;&lt; 1];int vis[maxn &lt;&lt; 1];int fa[maxn][maxm];int n, la, tot, siz;struct &#123; int l, r, u; &#125; t1[maxk];int tab[maxn &lt;&lt; 1], cnt[maxn &lt;&lt; 1];void Init(void) &#123;    la = tot = 1;    t[1] = _(0, 0);    return;&#125;void ext(int c) &#123;    int p = la, np = ++tot;    la = tot;    t[np] = _(t[p].l + 1, 0);    while (p &amp;&amp; !t[p].ne[c])        t[p].ne[c] = np, p = t[p].f;    if (!p)        t[np].f = 1;    else &#123;        int q = t[p].ne[c];        if (t[q].l == t[p].l + 1)            t[np].f = q;        else &#123;            int nq = ++tot;            t[nq] = _(t[p].l + 1, t[q].f);            std::copy(t[q].ne, t[q].ne + 26, t[nq].ne);            while (p &amp;&amp; t[p].ne[c] == q)                t[p].ne[c] = nq, p = t[p].f;            t[q].f = nq;            t[np].f = nq;        &#125;    &#125;    return;&#125;int now = 0;void ins(int &amp;p, int l, int r, int v) &#123;    if (!p)        p = ++now;    ++t1[p].u;    if (l == r)        return;    int mid = (l + r) &gt;&gt; 1;    if (v &lt;= mid)        ins(t1[p].l, l, mid, v);    else        ins(t1[p].r, mid + 1, r, v);    return;&#125;int ask(int p, int l, int r, int ql, int qr) &#123;    if (ql &lt;= l &amp;&amp; r &lt;= qr)        return t1[p].u;    int mid = (l + r) &gt;&gt; 1, res = 0;    if (ql &lt;= mid)        res = ask(t1[p].l, l, mid, ql, qr);    if (qr &gt; mid)        res += ask(t1[p].r, mid + 1, r, ql, qr);    return res;&#125;int merge(int p, int q, int l, int r) &#123;    if (!p || !q)        return p + q;    int np = ++now, mid = (l + r) &gt;&gt; 1;    t1[np].u = t1[p].u + t1[q].u;    if (l == r) return np;    t1[np].l = merge(t1[p].l, t1[q].l, l, mid);    t1[np].r = merge(t1[p].r, t1[q].r, mid + 1, r);    return np;&#125;int pos[maxn], rt[maxn &lt;&lt; 1];bool check(int p, int ch, int l, int r) &#123;    return ask(rt[t[p].ne[ch]], 0, n - 1, l, r) &gt; 0;&#125;bool fun(std::string &amp;res, std::string now, std::string &amp;t, int x, int p, int l, int r) &#123;    // std::cout &lt;&lt; &quot;x = &quot; &lt;&lt; x &lt;&lt; &quot;, now = \&quot;&quot; &lt;&lt; now &lt;&lt; &quot;\&quot;;\n&quot;;    if (x != (int)t.length() &amp;&amp; check(p, t[x] - &#39;a&#39;, l + x, r) &amp;&amp; fun(res, now + t[x], t, x + 1, ::t[p].ne[t[x] - &#39;a&#39;], l, r))        return 1;    for (int i = (x == (int)t.length()) ? 0 : t[x] - &#39;a&#39; + 1; i &lt; 26; ++i) &#123;        if (check(p, i, l + x, r)) &#123;            now += i + &#39;a&#39;;            res = now;            return 1;        &#125;    &#125;    return 0;&#125;std::string solve(std::string &amp;t, int l, int r) &#123;    std::string res;    return fun(res, &quot;&quot;, t, 0, 1, l, r) ? res : &quot;-1&quot;;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#endif    int q;    std::string s;    std::cin &gt;&gt; s &gt;&gt; q;    n = (int)s.length();    Init();    for (int i = 0; i &lt; n; ++i) &#123;        ext(s[i] - &#39;a&#39;);        pos[i] = la;        ins(rt[la], 0, n - 1, i);    &#125;    siz = log(tot) / log(2.0);    for (int i = 1; i &lt;= tot; ++i)        ++cnt[t[i].l];    std::partial_sum(cnt + 1, cnt + tot + 1, cnt + 1);    for (int i = 1; i &lt;= tot; ++i)        tab[cnt[t[i].l]--] = i;    for (int i = 1; i &lt;= tot; ++i) &#123;        int u = tab[i];        fa[u][0] = t[u].f;        for (int j = 1; j &lt;= siz; ++j)            fa[u][j] = fa[fa[u][j - 1]][j - 1];    &#125;    for (int i = tot; i; --i) &#123;        int u = tab[i];        if (t[u].f)            rt[t[u].f] = merge(rt[t[u].f], rt[u], 0, n - 1);    &#125;    while (q--) &#123;        int l, r;        std::string t;        std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; t;        std::cout &lt;&lt; solve(t, l - 1, r - 1) &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="a.-å…­å‡ºç¥å±±">A. å…­å‡ºç¥å±±</h3><p><a href="http://222.180.160.110:61235/contest/5170/problem/1" class="uri">http://222.180.160.110:61235/contest/5170/problem/1</a></p><p>æ˜¯èƒ½ç”¨è´ªå¿ƒæ‹¿ 60pts çš„ DP é¢˜ /tuu</p><p>éœ€è¦å…ˆæŠŠæš´åŠ›çš„å¼å­å†™å‡ºæ¥ã€‚è®¾ <span class="math inline">\(f_{i, j}\)</span> ä¸ºå°† <span class="math inline">\(i\)</span> å±±ä¿®æ”¹é«˜åº¦ä¸º <span class="math inline">\(j\)</span> çš„ä»£ä»·ï¼Œåˆ™ï¼š</p><p><span class="math display">\[f_{i, j} = \min\limits_{k\in [j-d, j+d]}\left\{f_{i-1, k}\right\} + |h_i - j|\]</span></p><p>æ³¨æ„åˆ°å¯ä»¥å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚ä½†æ˜¯è¿™æ ·åšå¤æ‚åº¦è¿˜æ˜¯ <span class="math inline">\(O(nV)\)</span> çš„ï¼Œæ ¹æœ¬åŸå› åœ¨äºç¬¬äºŒç»´è¿™ä¸ª <span class="math inline">\(V\)</span> çš„çŠ¶æ€æ•°å¤ªå¤šäº†ã€‚</p><p>æ ¹æ®ç›´è§‰ï¼Œæœ€å <span class="math inline">\(j\)</span> çš„å€¼åº”ä¸º <span class="math inline">\(k+d\)</span> æˆ– <span class="math inline">\(k-d\)</span> æˆ– <span class="math inline">\(a_i\)</span>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œåˆæ³•çš„çŠ¶æ€æ•°ä¸ºæ‰€æœ‰çš„ <span class="math inline">\(a_i+x\times d, x\in[-n, n]\)</span>ã€‚</p><details><p><summary>æ­£ç¡®æ€§è¯æ˜â€¦â€¦</summary></p><p>è€ƒè™‘å…¨éƒ¨æ›´æ”¹å®Œåçš„ç»“æŸçŠ¶æ€ï¼Œå³æœ€åçš„æœ€ä¼˜çŠ¶æ€ã€‚</p><p>è€ƒè™‘æ‰€æœ‰å±±ä¸­æœ€çŸ®çš„å±± <span class="math inline">\(i\)</span>ï¼Œæ­¤å±±çš„é«˜åº¦è¦ä¹ˆä¸º <span class="math inline">\(h_i\)</span>ï¼Œè¦ä¹ˆä¸ºå‰ä¸€åº§å±±çš„é«˜åº¦ <span class="math inline">\(-d\)</span>ï¼Œè¦ä¹ˆä¸ºåä¸€åº§å±±çš„é«˜åº¦ <span class="math inline">\(-d\)</span>ã€‚</p><p>è€ƒè™‘ç¬¬äºŒçŸ®çš„å±±ï¼Œä»¥æ­¤ç±»æ¨å³å¯ã€‚</p></details><p>å°†ç¬¬äºŒç»´çš„çŠ¶æ€é›†å¤§å°å‡å°‘ä¸º <span class="math inline">\(O(n^2)\)</span>ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(n^3)\)</span>ã€‚</p><details><p>éœ€æ³¨æ„åˆ°å› ä¸º <span class="math inline">\(a_i+x\times d\)</span> ä¸­çš„ <span class="math inline">\(x\)</span> èŒƒå›´ä¸º <span class="math inline">\([-n, n]\)</span> å…± <span class="math inline">\(2\times n\)</span>ï¼Œæ‰€ä»¥ DP æ•°ç»„ç¬¬äºŒç»´å¤§å°ä¸€å®šè¦å¼€ <span class="math inline">\(2\times n^2\)</span> å‘€ï¼ï¼ï¼</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;using ll = long long;const int maxn = 305;const int maxm = 18e4 + 5;const ll inf = 0x3f3f3f3f3f3f3f3f;ll d;int n;ll h[maxn];ll f[maxn][maxm];int main() &#123;    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);    memset(f, 0x3f, sizeof (f));    std::cin &gt;&gt; n &gt;&gt; d;    std::vector&lt;ll&gt; st;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; h[i];        for (ll j = -n; j &lt;= n; ++j)            st.push_back(h[i] + j * d);    &#125;    std::sort(st.begin(), st.end());    st.erase(std::unique(st.begin(), st.end()), st.end());    auto abs = [&amp;](ll x) -&gt; ll &#123; return x &gt;= 0 ? x : -x; &#125;;    f[1][lower_bound(st.begin(), st.end(), h[1]) - st.begin()] = 0;    for (int i = 2; i &lt;= n; ++i) &#123;        int h(1), t(0), p(-1);        static int q[maxm];        for (int j = 0; j &lt; (int)st.size(); ++j) &#123;            while (p &lt; (int)st.size() &amp;&amp; st[p + 1] &lt;= st[j] + d) &#123;                ++p;                while (h &lt;= t &amp;&amp; f[i - 1][p] &lt;= f[i - 1][q[t]])                    --t;                q[++t] = p;            &#125;            while (h &lt;= t &amp;&amp; st[q[h]] &lt; st[j] - d)                ++h;            if (h &lt;= t)                f[i][j] = std::min(inf, f[i - 1][q[h]] + abs(st[j] - ::h[i]));        &#125;    &#125;    ll res = f[n][std::lower_bound(st.begin(), st.end(), h[n]) - st.begin()];    std::cout &lt;&lt; (res == inf ? -1 : res) &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="b.-æ°´æ·¹ä¸ƒå†›">B. æ°´æ·¹ä¸ƒå†›</h3><p><a href="http://222.180.160.110:61235/contest/5170/problem/2" class="uri">http://222.180.160.110:61235/contest/5170/problem/2</a></p><p>å®¹æ˜“å‘ç°æœ€åè¿å‡ºæ¥ä¸€å®šæ˜¯æ²¡æœ‰ç¯çš„ã€‚æ‰€ä»¥ä¸€å®šæ˜¯ä¸€ä¸ª DAGã€‚</p><p>æˆ‘ä»¬çŸ¥é“çŠ¶æ€å‹ç¼©æ˜¯ä¼šéå†åˆ°æ¯ä¸€ç§æƒ…å†µçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‡è®¾å½“å‰çš„ DAG å°±æ˜¯è¯¥çŠ¶æ€ä¸‹çš„æœ€ä¼˜ã€‚</p><p>è‡³äºè¿™ä¸ªã€Œæœ€ä¼˜ã€å¦‚ä½•å®šä¹‰å°±è¦äº¤ç»™æˆ‘ä»¬äº†ã€‚æˆ‘ä»¬ä¸å¦¨å¼ºåˆ¶è®¤ä¸ºè¿™ä¸ª DAG æ˜¯æŒ‰å±‚åºéå†å¾—åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿ç»­éå†åˆ°çš„ç‚¹å±äºåŒä¸€å±‚ï¼ˆè¿™é‡Œçš„å±‚æ˜¯æŒ‡æŸç‚¹åˆ°ä»»æ„æºç‚¹çš„æœ€é•¿è·¯é•¿åº¦ï¼‰ã€‚</p><p>æ˜¾ç„¶åªæœ‰ä¸€ç»„ç›¸äº’ä¹‹é—´æ²¡æœ‰ä»»ä½•è¿è¾¹çš„ç‚¹æ‰èƒ½ç»„æˆåŒä¸€å±‚ã€‚ä¸å¦¨æšä¸¾ç‚¹é›†ç„¶åæš´åŠ›è½¬ç§»ï¼Œè½¬ç§»æ—¶è®°å½•è·¯å¾„å³å¯ã€‚</p><details><p>æ³¨æ„åˆ°åœ¨å†™è¿™ç©æ„å„¿çš„æ—¶å€™æˆ‘è¿˜ä¸ä¼š <a href="/2024/05/17/20240517/">çŠ¶å‹æšä¸¾å­é›†</a>ï¼Œæ‰€ä»¥æšä¸¾å­é›†çš„éƒ¨åˆ†å¯èƒ½æ‰“å¾—æ¯”è¾ƒæŠ½è±¡ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxn = 25;const int inf = 0x3f3f3f3f;const int maxm = (1 &lt;&lt; 16) + 5;int n, res;int tag[maxn][maxn];int f[maxn], g[maxn];int solve(std::vector&lt;int&gt;&amp; a) &#123;    static int g[maxn];    static int f[maxm], p[maxm];    int n(a.size()), siz(1 &lt;&lt; n);    std::fill(g, g + n, 0);    std::fill(p, p + siz + 1, 0);    std::fill(f, f + siz + 1, inf);    std::vector&lt;int&gt; st;    for (int i = 0; i &lt; n; ++i) &#123;        for (int j = 0; j &lt; n; ++j) &#123;            if (::g[a[i]] &amp; (1 &lt;&lt; a[j]))                g[i] |= 1 &lt;&lt; j;        &#125;    &#125;    for (int i = 1; i &lt; siz; ++i) &#123;        int now = 0;        for (int j = 0; j &lt; n; ++j) &#123;            if (i &amp; (1 &lt;&lt; j))                now |= g[j];        &#125;        if (!(now &amp; i))            st.push_back(i), f[i] = 0, p[i] = i;        for (auto j : st) &#123;            if (!(i &amp; j)) &#123;                if (f[i | j] &gt; f[i] + 1)                    f[i | j] = f[i] + 1, p[i | j] = j;            &#125;        &#125;    &#125;    int now = siz - 1;    while (now) &#123;        int fa = now ^ p[now];        for (int i = 0; i &lt; n; ++i)            if (p[now] &amp; (1 &lt;&lt; i))                for (int j = 0; j &lt; n; ++j)                    if ((fa &amp; (1 &lt;&lt; j)) &amp;&amp; tag[a[j]][a[i]] == 2)                        tag[a[j]][a[i]] = 1, tag[a[i]][a[j]] = -1;        now = fa;    &#125;    return f[siz - 1];&#125;int find(int x) &#123;    return x == f[x] ? x : f[x] = find(f[x]);&#125;int main() &#123;    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);    int m;    std::cin &gt;&gt; n &gt;&gt; m;    std::vector&lt;std::pair&lt;int, int&gt; &gt; edge;    for (int i = 0; i &lt; n; ++i)        f[i] = i;    while (m--) &#123;        int x, y;        std::cin &gt;&gt; x &gt;&gt; y;        edge.emplace_back(--x, --y);        f[find(x)] = find(y);        g[x] |= 1 &lt;&lt; y;        g[y] |= 1 &lt;&lt; x;        tag[x][y] = tag[y][x] = 2;    &#125;    std::vector&lt;int&gt; ver[maxn];    for (int i = 0; i &lt; n; ++i) &#123;        ver[find(i)].push_back(i);    &#125;    for (int i = 0; i &lt; n; ++i) &#123;        if (f[i] == i)            res = std::max(res, solve(ver[i]));    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    for (auto i : edge) &#123;        if (tag[i.first][i.second] == 1)            std::cout &lt;&lt; i.first + 1 &lt;&lt; &#39; &#39; &lt;&lt; i.second + 1 &lt;&lt; &#39;\n&#39;;        else std::cout &lt;&lt; i.second + 1 &lt;&lt; &#39; &#39; &lt;&lt; i.first + 1 &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="c.-ç…®é…’è®ºè‹±é›„">C. ç…®é…’è®ºè‹±é›„</h3><p><a href="http://222.180.160.110:61235/contest/5170/problem/3" class="uri">http://222.180.160.110:61235/contest/5170/problem/3</a></p><p>æ³¨æ„åˆ°å¦‚æœå­˜åœ¨ä¸²è¢«å…¶ä»–ä¸²åŒ…å«é‚£ä¹ˆç›´æ¥å°†å…¶æ¯™æ‰å°±å¯ä»¥äº†ã€‚</p><p>å¯¹äºç›¸äº’ä¸å®Œå…¨åŒ…å«çš„ä¸²ï¼Œæˆ‘ä»¬ä»¤ <span class="math inline">\(mx_{i, j, 0/1, 0/1}\)</span> è¡¨ç¤ºå°†æ­£åº / é€†åºçš„ <span class="math inline">\(i\)</span> ä¸²æ‹¼åˆ°æ­£åº / é€†åºçš„ <span class="math inline">\(j\)</span> ä¸²ä¹‹å‰ï¼Œä¸¤è€…å…±ç”¨ç›¸æ¥å…¬å…±éƒ¨åˆ†çš„ä¸²é•¿ã€‚è¿™ä¸ªå¯ä»¥ç”¨å­—ç¬¦ä¸²å“ˆå¸Œæš´åŠ›æ±‚ã€‚</p><p>ç”¨çŠ¶å‹æšä¸¾æ‹¼æ¥é¡ºåºï¼Œæ±‚å¾—æœ€å°æ€»ä¸²é•¿å³å¯ã€‚</p><p>æ³¨æ„å¦‚æœå»æ‰è¢«åŒ…å«ä¸²å <span class="math inline">\(n=1\)</span> æ—¶éœ€ç›´æ¥è¾“å‡ºä¸²çš„ borderï¼›ä»¥åŠç­”æ¡ˆéœ€å’Œ <span class="math inline">\(2\)</span> å– <span class="math inline">\(\max\)</span>ã€‚</p><p>å®ç°èµ·æ¥åˆè‡­åˆé•¿ï¼Œä½†å®é™…ä¸Šæ€è·¯ç¡®å®éå¸¸ç®€å•ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;using ll = long long;const int p = 131;const int maxn = 25;const int lim = 2e4;const int maxl = 2e4 + 5;const int mod = 998244353;const int inf = 0x3f3f3f3f;const int maxm = (1 &lt;&lt; 16) + 5;int n;std::vector&lt;std::string&gt; s;std::vector&lt;std::vector&lt;ll&gt; &gt; h[2];int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#endif    std::cin &gt;&gt; n;    s.resize(n);    h[0].resize(n);    h[1].resize(n);    static ll base[maxl];    static bool del[maxn];    base[0] = 1;    for (int i = 1; i &lt;= lim; ++i)        base[i] = base[i - 1] * p % mod;    for (int i = 0; i &lt; n; ++i) &#123;        std::cin &gt;&gt; s[i];        h[0][i].resize((int)s[i].length());        h[1][i].resize((int)s[i].length());        ll x = 0;        for (int j = 0; j &lt; (int)s[i].length(); ++j, (x *= p) %= mod)            h[0][i][j] = ((x += s[i][j]) %= mod);        std::reverse(s[i].begin(), s[i].end());        x = 0;        for (int j = 0; j &lt; (int)s[i].length(); ++j, (x *= p) %= mod)            h[1][i][j] = ((x += s[i][j]) %= mod);        std::reverse(s[i].begin(), s[i].end());    &#125;    std::vector&lt;int&gt; tab;    auto gethash = [&amp;](int i, int l, int r, bool t) -&gt; ll &#123;        if (l &gt; r) return 0;        ll res = (h[t][i][r] - (l ? h[t][i][l - 1] : 0) * base[r - l + 1] % mod);        return (res % mod + mod) % mod;    &#125;;    // ll now = 0;    // for (int i = 0; i &lt;= 4; ++i)    //     now = (now * p + s[1][i]) % mod;    // printf(&quot;now = %lld\n&quot;, now);    // now = 0;    // for (int i = 3; i &lt;= 7; ++i)    //     now = (now * p + s[0][i]) % mod;    // printf(&quot;now = %lld\n&quot;, now);    // printf(&quot;# %lld\n&quot;, h[0][0].back());    for (int i = 0; i &lt; n; ++i) &#123;        tab.push_back(i);        for (int j = 0; j &lt; n; ++j)            if (!del[j] &amp;&amp; i != j)                for (int k = 0; k &lt;= ((int)s[j].length()) - ((int)s[i].length()); ++k) &#123;                    // printf(&quot;i = %d, j = %d, k = %d, %lld / %lld\n&quot;, i, j, k,                    //         gethash(i, 0, ((int)s[i].length()) - 1, 0), gethash(j, k, k + ((int)s[i].length()) - 1, 0));                    if (h[0][i].back() == gethash(j, k, k + ((int)s[i].length()) - 1, 0)) &#123;                        tab.pop_back();                        del[i] = 1;                        goto outo;                    &#125;                &#125;        outo: ;    &#125;    n = (int)tab.size();    if (n == 1) &#123;        int border;        for (border = ((int)s[tab[0]].length()) - 1; ~border; --border) &#123;            if (gethash(tab[0], 0, border - 1, 0) == gethash(tab[0], ((int)s[tab[0]].length()) - border, ((int)s[tab[0]].length()) - 1, 0))                break;        &#125;        std::cout &lt;&lt; std::max(2, ((int)s[tab[0]].length()) - border) &lt;&lt; &#39;\n&#39;;    &#125;    else &#123;        static int mx[maxn][maxn][2][2];        for (int i = 0; i &lt; n; ++i)            for (int j = 0; j &lt; n; ++j)                for (int a = 0; a &lt; 2; ++a)                    for (int b = 0; b &lt; 2; ++b)                        for (int k = std::min((int)s[tab[i]].length(), (int)s[tab[j]].length()); ~k; --k) &#123;                            if (gethash(tab[i], ((int)s[tab[i]].length()) - k, ((int)s[tab[i]].length()) - 1, a) ==                                                                                            gethash(tab[j], 0, k - 1, b)) &#123;                                mx[i][j][a][b] = (int)s[tab[j]].length() - k;                                // printf(&quot;%d(%d) + %d(%d) = %d, k = %d\n&quot;, i, a, j, b, mx[i][j][a][b], k);                                break;                            &#125;                        &#125;        static int f[maxm][maxn][2];        memset(f, 0x3f, sizeof (f));        int siz = 1 &lt;&lt; n, res = inf;        f[1][0][0] = (int)s[tab[0]].length();        for (int i = 1; i &lt; siz; ++i)            for (int j = 0; j &lt; n; ++j)                if (i &amp; (1 &lt;&lt; j))                    for (int a = 0; a &lt; 2; ++a) &#123;                        // printf(&quot;f[%d][%d][%d] = %d\n&quot;, i, j, a, f[i][j][a]);                        for (int k = 0; k &lt; n; ++k)                            if (!(i &amp; (1 &lt;&lt; k)))                                for (int b = 0; b &lt; 2; ++b)                                    f[i | (1 &lt;&lt; k)][k][b] = std::min(f[i | (1 &lt;&lt; k)][k][b], f[i][j][a] + mx[j][k][a][b]);                        if (i == siz - 1)                            res = std::min(res, f[i][j][a] - (int)s[tab[0]].length() + mx[j][0][a][0]);                    &#125;                std::cout &lt;&lt; std::max(2, res) &lt;&lt; &#39;\n&#39;;    &#125;    return 0;&#125;</code></pre></details><hr /><h3 id="a.-ææ–‘é©¬">A. ææ–‘é©¬</h3><p><a href="http://222.180.160.110:61235/contest/5175/problem/1" class="uri">http://222.180.160.110:61235/contest/5175/problem/1</a></p><p>æˆ‘ç”šè‡³ä¸ä¼šï¼ˆï¼‰</p><p>ç¿»è½¬ + æ‹¼æ¥æœ¬è´¨ä¸Šå°±æ˜¯é¦–å°¾ç›¸æ¥ã€‚æˆ‘ä»¬æŠŠå­—ç¬¦ä¸²æ•´ä¸ªæ‹¼åˆ°è‡ªå·±åè¾¹å„¿ï¼Œç„¶åä»»å–ä¸€æ®µé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„ä¸²å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå€’è¿‡æ¥çš„æ“ä½œåçš„å­—ç¬¦ä¸²ã€‚</p><p>æ³¨æ„åˆ°å¯ä»¥æ“ä½œå¾ˆå¤šæ¬¡ã€‚ä½†æ˜¯æ—¢ç„¶æˆ‘ä»¬æ“ä½œåçš„ä¸²ä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªæ‹¼æ¥åçš„ä¸²ä¸­æ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå…¶å®å¤šæ¬¡æ“ä½œåçš„ä¹Ÿè¡Œã€‚</p><p>æ‰€ä»¥å‘¢æˆ‘ä»¬åœ¨æ‹¼æ¥åçš„ä¸²ç§æšä¸¾æ¯ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„ä¸²è®¡ç®—ç­”æ¡ˆå³å¯ã€‚</p><p>å…·ä½“æ€ä¹ˆç®—å‘¢ï¼Ÿæ³¨æ„åˆ°åªçœ‹å¼€å¤´ï¼Œä¹Ÿå°±æ˜¯åœ¨æ–°ä¸²ä¸­åªçœ‹ç¦»æˆ‘ä»¬å½“å‰æšä¸¾çš„å³ç«¯ç‚¹æœ€è¿‘çš„é‚£ä¸€æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“ä¸€ä¸ªåŒæŒ‡é’ˆï¼Œçœ‹è¿™ä¸€æ®µæ˜¯å¦åœ¨å³ç§»åä»ç„¶åˆæ³•ï¼Œå¦‚æœéæ³•å°±æŠŠç­”æ¡ˆåŒºé—´å·¦ç«¯ç‚¹æ›´æ–°ä¸ºå³ç«¯ç‚¹è‡ªå·±ã€‚ä»¥åŠæ³¨æ„åˆ°å·¦å³ç«¯ç‚¹çš„è·ç¦»ä¸èƒ½è¶…è¿‡ <span class="math inline">\(n\)</span>ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;int res;std::string s;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#endif    std::cin &gt;&gt; s;    int l = 0, r = -1, n = (int)s.length();    char la = 0;    s += s;    while (++r &lt; (int)s.length()) &#123;        if (s[r] == la)            l = r;        while (r - l + 1 &gt; n) ++l;        la = s[r];        res = std::max(res, r - l + 1);    &#125;    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="d.-é“¾çŠ¶é—ªç”µ">D. é“¾çŠ¶é—ªç”µ</h3><p><a href="http://222.180.160.110:61235/contest/5175/problem/4" class="uri">http://222.180.160.110:61235/contest/5175/problem/4</a></p><p>è«åå…¶å¦™ä¸”åˆè‡­åˆé•¿çš„æ ¹å·åšæ³•ã€‚</p><p>å®¹æ˜“å‘ç°ä¸€ä¸ªæ€ªè¢«æ€æ‰äº†åºåˆ—å°±ä¼šè£‚å¼€æˆä¸¤æ®µè¿ç»­å­åºåˆ—ï¼Œä»¥åŠæœ€å…ˆè¢«æ€æ‰çš„æ€ªç‰©ä¸€å®šè¡€é‡æœ€å°‘ã€‚åœ¨è£‚å¼€æ¥çš„ä¸¤æ®µè¿ç»­å­åºåˆ—ä¸­ä¹Ÿæ»¡è¶³æ­¤è§„å¾‹ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p><p>è€ƒè™‘å¯¹åºåˆ—å»ºç«‹ç¬›å¡å°”æ ‘ã€‚ä»¤æ ‘æ ¹ä¸º <span class="math inline">\(rt\)</span>ï¼Œå½“å‰æ”»å‡»åŠ›ä¸º <span class="math inline">\(k\)</span>ï¼Œè®° <span class="math inline">\(t_{x, k}=\left\lceil \dfrac {h_x}k \right\rceil\)</span>ï¼Œå³ä¸è€ƒè™‘å…¶ä»–æ¡ä»¶æ—¶å‡»å€’ <span class="math inline">\(x\)</span> æ‰€éœ€æ¬¡æ•°ã€‚</p><p>é‚£ä¹ˆå¯¹äº <span class="math inline">\(rt\)</span> çš„å·¦ã€å³å„¿å­ <span class="math inline">\(l,r\)</span>ï¼Œå•è€ƒè™‘è¿™ä¸‰ä¸ªæ€ªç‰©æ‰€éœ€çš„æ€»å‡»å€’æ¬¡æ•°ï¼Œå®¹æ˜“å‘ç°ä¸º <span class="math inline">\(t_{rt,k}+(t_{l,k}-t_{rt,k})+(t_{r,k}-t_{rt,k})\)</span>ã€‚</p><p>å¯¹äº <span class="math inline">\(l\)</span> å¼•å¯¼çš„å­æ ‘ï¼Œæ­¤æ—¶çš„å®é™…å·²æ”»å‡»æ¬¡æ•°ä¸º <span class="math inline">\(t_{l,k}\)</span>ï¼›æ‰€ä»¥å¯¹äº <span class="math inline">\(l\)</span> çš„å·¦å³å„¿å­ <span class="math inline">\(l&#39;,r&#39;\)</span>ï¼Œå‡»å€’è¿™ä¸¤ä¸ªæ€ªç‰©çš„æ‰€éœ€æ¬¡æ•°ä¸º <span class="math inline">\((t_{l&#39;,k} - t_{l,k})+(t_{r&#39;,k}-t_{l,k})\)</span>ã€‚<span class="math inline">\(r\)</span> å¼•å¯¼çš„å­æ ‘åŒç†ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ï¼Œå¦‚æœå­˜åœ¨æ ‘è¾¹ <span class="math inline">\(u\to v\)</span>ï¼Œé‚£ä¹ˆå‡»å€’ <span class="math inline">\(v\)</span> çš„æ‰€éœ€æ¬¡æ•°ä¸º <span class="math inline">\(t_{v,k}-t_{u,k}\)</span>ï¼›ç‰¹åˆ«åœ°ï¼Œå‡»å€’ <span class="math inline">\(rt\)</span> çš„æ‰€éœ€æ¬¡æ•°ä¸º <span class="math inline">\(t_{rt,k}\)</span>ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€æ¬¡ <span class="math inline">\(O(n)\)</span> çš„æ ‘ä¸Š DFS å¯¹äºä¸€ä¸ª <span class="math inline">\(k\)</span> æ‰¾åˆ°ç­”æ¡ˆäº†ã€‚</p><p>é‚£ä¹ˆå¯¹äº <span class="math inline">\(2\times 10^4\)</span> èŒƒå›´å†…çš„æ‰€æœ‰ <span class="math inline">\(k\)</span>ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦åˆ©ç”¨ <span class="math inline">\(t\)</span> çš„æ€§è´¨è¿›è¡Œæ ¹å·åˆ†æ²»äº†ã€‚</p><ul><li><p>å¯¹äº <span class="math inline">\(k\le \sqrt {2\times 10^4}\)</span>ï¼Œæˆ‘ä»¬å¤§å¯ä»¥ç›´æ¥åšè¿™ä¹ˆå¤šæ¬¡ DFS å¾—åˆ°ç­”æ¡ˆï¼›</p></li><li><p>å¯¹äº <span class="math inline">\(k&gt;\sqrt {2\times 10^4}\)</span>ï¼š</p><p>æˆ‘ä»¬å®¹æ˜“å‘ç°æœ€ç»ˆçš„ç»“æœæ˜¯è‹¥å¹²ä¸ª <span class="math inline">\(t\)</span> çš„å€¼ç›¸åŠ å‡å¾—åˆ°çš„ï¼Œè€Œæ¯ä¸ª <span class="math inline">\(t\)</span> çš„æƒå€¼ <span class="math inline">\(cnt\)</span> å–å†³äºå…¶åœ¨ç¬›å¡å°”æ ‘ä¸Šçš„å„¿å­ä¸ªæ•°ï¼Œæœ‰å¤šå°‘å°±åœ¨ <span class="math inline">\(1\)</span> çš„åŸºç¡€ä¸Šå‡å»å¤šå°‘ã€‚</p><p>ç”±äº <span class="math inline">\(t\)</span> å®åœ¨è¿‡äºç‰¹æ®Šï¼Œè€ƒè™‘æ•´é™¤åˆ†å— / æ•°è®ºåˆ†å—ã€‚å¯¹äºæ¯ä¸ª <span class="math inline">\(x\)</span>ï¼Œå¯¹äºä»»æ„ <span class="math inline">\(k&#39;\in (\sqrt {2\times 10^4}, 2\times 10^4]\)</span>ï¼Œå¯èƒ½çš„ <span class="math inline">\(t\)</span> å€¼åªæœ‰ <span class="math inline">\(\sqrt {2\times 10^4 }\)</span> ç§ã€‚è®¡ç®—å‡ºå¯¹äºæ¯ä¸ª <span class="math inline">\(t&#39;\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\(\left\lceil \dfrac {h_x}{k&#39;} \right\rceil=t&#39;\)</span> çš„ <span class="math inline">\(k&#39;\)</span> èŒƒå›´ï¼Œå¯¹è¯¥èŒƒå›´ <span class="math inline">\(k&#39;\)</span> çš„ç­”æ¡ˆåŒºé—´åŠ ä¸Š <span class="math inline">\(t&#39;\times cnt\)</span> å³å¯ï¼Œå¯ä»¥ä½¿ç”¨å·®åˆ†ã€‚</p><p>è‡³æ­¤ï¼Œå°±å¯ä»¥åœ¨ä¸€æ¬¡ DFS å†…è§£å†³è¿™ç§æƒ…å†µä¸‹çš„é—®é¢˜ã€‚</p></li></ul><p>æ€»æ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(n\sqrt {2\times 10^4})\)</span>ã€‚</p><details><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘åœ¨åšè¿™é“é¢˜çš„æ—¶å€™å¹¶æ²¡æœ‰æ„è¯†åˆ°è‡ªå·±ç”¨åˆ°äº†ç¬›å¡å°”æ ‘ï¼Œ</p><p>æ‰€ä»¥ä»£ç ä¸­ç¬›å¡å°”æ ‘çš„å»ºæ ‘éƒ¨åˆ†å¯èƒ½é•¿å¾—ç‰¹åˆ«æŠ½è±¡ï¼ˆ</p><p>è¿™é‡Œæ˜¯ä½¿ç”¨äº†ä¸‹æ ‡ä¸Šçš„ ST è¡¨å¸¦ log åœ°æ±‚è§£äº†å·¦å³å„¿å­ã€‚</p><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxm = 35;const int maxn = 1e5 + 5;using ll = long long;ll res;int n, k, l;int g[maxn][2];int f[maxn][maxm];int a[maxn], t[maxn];ll dif[maxn], cnt[maxn];int ask(int l, int r) &#123;    if (l &gt; r) return 0;    int k = log(r - l + 1) / log(2.0);    return (a[f[l][k]] &lt; a[f[r - (1 &lt;&lt; k) + 1][k]]) ? f[l][k] : f[r - (1 &lt;&lt; k) + 1][k];&#125;void bld(int rt, int l, int r) &#123;    if (rt != l) &#123;        g[rt][0] = ask(l, rt - 1);        bld(g[rt][0], l, rt - 1);    &#125;    if (rt != r) &#123;        g[rt][1] = ask(rt + 1, r);        bld(g[rt][1], rt + 1, r);    &#125;    return;&#125;// k &lt;= sqrt(lim)void DFS(int x, int k, int fa) &#123;    t[x] = (a[x] + k - 1) / k;    res += t[x] - t[fa];    for (int i = 0; i &lt; 2; ++i) &#123;        if (g[x][i])            DFS(g[x][i], k, x);    &#125;    return;&#125;// k &gt; sqrt(lim)void DFS(int x, int fa) &#123;    ++cnt[x];    --cnt[fa];    for (int i = 0; i &lt; 2; ++i) &#123;        if (g[x][i])            DFS(g[x][i], x);    &#125;    int l = k + 1, r;    // æ³¨æ„è¿™é‡Œ i çš„èŒƒå›´åˆ¤å®šï¼Œå¦‚æœç›´æ¥å†™æˆ i * i &lt;= k ä¼šå°‘è®¡ç®—ä¸€äº›æƒ…å†µ    for (int i = 1; (i - 1) * (i - 1) &lt; k; ++i) &#123;        r = l - 1;        l = (a[x] + i - 1) / i;        // fprintf(stderr, &quot;%d: [%d, %d] += %d * %d\n&quot;, a[x], l, r, cnt[x], i);        dif[l] += i * cnt[x], dif[r + 1] -= i * cnt[x];    &#125;    return;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#endif    std::cin &gt;&gt; n;    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; a[i];        f[i][0] = i;        k = std::max(k, a[i]);    &#125;    for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)        for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)            f[i][j] = (a[f[i][j - 1]] &lt; a[f[i + (1 &lt;&lt; (j - 1))][j - 1]]) ? f[i][j - 1] : f[i + (1 &lt;&lt; (j - 1))][j - 1];    int rt = ask(1, n);    bld(rt, 1, n);    for (int i = 1; i * i &lt;= k; ++i) &#123;        res = 0;        DFS(rt, i, 0);        std::cout &lt;&lt; res &lt;&lt; &#39; &#39;;        l = i + 1;    &#125;    // fputs(&quot;\n&quot;, stderr);    DFS(rt, 0);    std::partial_sum(dif + 1, dif + k + 1, dif + 1);    for (int i = l; i &lt;= k; ++i)        std::cout &lt;&lt; dif[i] &lt;&lt; &#39; &#39;;    std::cout &lt;&lt; &#39;\n&#39;;    return 0;&#125;</code></pre></details><hr /><h3 id="f.-å¼¹é£ç»µç¾Š">F. å¼¹é£ç»µç¾Š</h3><p><a href="http://222.180.160.110:61235/contest/5175/problem/6" class="uri">http://222.180.160.110:61235/contest/5175/problem/6</a></p><p>å¾ˆæ£’å¯æŒä¹…åŒ–åˆ†å—ï¼Œä½¿æˆ‘ lxl æ—‹è½¬ã€‚</p><p>ç¬‘è¯ï¼šèµ›å 5s æ‰äº¤ä¸Šå»ã€‚ç„¶å A äº†ã€‚</p><p>æˆ‘ä»¬çŒœå¤§å®¶éƒ½ä¼šæ™®é€šçš„å¼¹é£ç»µç¾Šè¿™é“é¢˜ã€‚å°±æ˜¯å—é—´æš´åŠ›è·³å˜›ã€‚</p><p>è¿™é‡Œç»™ä¸€ä¸ªæˆ‘è‡ªå·±æ•´çš„ç®€å•å®ç°æ–¹æ³•ã€‚</p><p>æˆ‘ä»¬æŠŠåˆ†å‡ºæ¥çš„å—è§†ä½œè‹¥å¹²ä¸ªæ— å…³è”çš„æ•£å—å¹¶çº³å…¥å—é›†åˆï¼›å¯¹äºæ¯ä¸€ä¸ªç‰ˆæœ¬ï¼Œç”¨ä¸€ä¸ªå¤§å°ä¸º <span class="math inline">\(\sqrt n\)</span> çš„ <span class="math inline">\(id\)</span> æ•°ç»„è®°å½•æ¯ä¸€ä½ç½®çš„å—åœ¨å—é›†åˆä¸­å¯¹åº”çš„ä½ç½®ã€‚</p><p>ç„¶åè¯¥æ€ä¹ˆææ€ä¹ˆæå³å¯ã€‚</p><p>P.S. zwb åšå®šä¸ç§»ä¿¡ä»° lxl ç¥æ•™äºæ˜¯å†³å®šç”¨å¯æŒä¹…åŒ–å¹³è¡¡æ ‘å®ç°å¯æŒä¹…åŒ–åˆ†å—ï¼Œç»“æœå½“ç„¶æ˜¯å› ä¸ºå¤šäº†ä¸ª <span class="math inline">\(\log\)</span> è¢«å¡é£äº†ï¼Œæœ€åæ°”æ€¥è´¥åæ…Œä¸æ‹©è·¯æ¼ç¾æˆæ€’æŠ„èµ·äº†æˆ‘çš„ä»£ç ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;const int maxk = 320;const int maxn = 2e5 + 5;class devicer &#123;public:    int l, r;    std::vector&lt;int&gt; ne, u, a;    int &amp;nex(int x);    int &amp;val(int x);&#125;;int id[maxn][maxk];std::vector&lt;devicer&gt; b;int n, q, ty, siz, k, la;int a[maxn], tab[maxn], blk[maxn];void upd(int x, int a, devicer &amp;p) &#123;    if (x + a &gt; n)        p.nex(x) = -1, p.val(x) = 1;    else if (x + a &gt; p.r)        p.nex(x) = x + a, p.val(x) = 1;    else        p.nex(x) = p.nex(x + a), p.val(x) = p.val(x + a) + 1;    // printf(&quot;x = %d, a = %d, r = %d, upd ne[%d] to %d\n&quot;, x, a, p.r, x, p.nex(x));    return;&#125;int main() &#123;#ifdef ONLINE_JUDGE    std::ios::sync_with_stdio(false);    std::cin.tie(nullptr);    std::cout.tie(nullptr);#endif    std::cin &gt;&gt; n &gt;&gt; q &gt;&gt; ty;    siz = sqrt(n);    k = (n + siz - 1) / siz;    b.resize(k);    int la = 0, now = k - 1;    for (auto &amp;i : b)        i.l = la + 1, la = i.r = i.l + siz - 1;    b.back().r = n;    for (int i = 0; i &lt; k; ++i) &#123;        id[0][i] = i;        b[i].a.resize(b[i].r - b[i].l + 1);        b[i].u.resize(b[i].r - b[i].l + 1);        b[i].ne.resize(b[i].r - b[i].l + 1);        for (int j = b[i].l; j &lt;= b[i].r; ++j)            tab[j] = j - b[i].l, blk[j] = i;    &#125;    for (int i = 1; i &lt;= n; ++i)        std::cin &gt;&gt; b[blk[i]].a[tab[i]];    for (int i = n; i; --i)        upd(i, b[blk[i]].a[tab[i]], b[blk[i]]);    int ver = 0;    while (q--) &#123;        int op, pr, x;        static int res = 0;        std::cin &gt;&gt; op &gt;&gt; pr &gt;&gt; x;        if (!ty)            res = 0;        x ^= res;        if (op == 1) &#123;            std::copy(id[pr], id[pr] + k, id[++ver]);            b.push_back(b[id[ver][blk[x]]]);            id[ver][blk[x]] = ++now;            std::cin &gt;&gt; b.back().a[tab[x]];            b.back().a[tab[x]] ^= res;            for (int i = x; i &gt;= b.back().l; --i)                upd(i, b.back().a[tab[i]], b.back());        &#125;        else &#123;            int p = x;            res = 0;            while (~p) &#123;                // printf(&quot;p = %d\n&quot;, p);                res += b[id[pr][blk[p]]].u[tab[p]];                p = b[id[pr][blk[p]]].ne[tab[p]];            &#125;            std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;        &#125;    &#125;    return 0;&#125;int&amp; devicer::nex(int x) &#123;    return ne[tab[x]];&#125;int&amp; devicer::val(int x) &#123;    return u[tab[x]];&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> çŠ¶å‹ </tag>
            
            <tag> SAM </tag>
            
            <tag> åˆ†å— </tag>
            
            <tag> å¯æŒä¹…åŒ– </tag>
            
            <tag> ç¬›å¡å°”æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ›¼å“ˆé¡¿æœ€å°è·ç¦»ç”Ÿæˆæ ‘</title>
      <link href="/20240206/"/>
      <url>/20240206/</url>
      
        <content type="html"><![CDATA[<p>å¦‚é¢˜ã€‚</p><span id="more"></span><hr /><h3 id="e.-another-minimum-spanning-tree">E. Another Minimum Spanning Tree</h3><p>http://222.180.160.110:61235/contest/4940/problem/5</p><p>æ›¼å“ˆé¡¿æœ€å°è·ç¦»ç”Ÿæˆæ ‘ã€‚ç»™å®š <span class="math inline">\(n\)</span> ä¸ªå·²çŸ¥åæ ‡çš„ç‚¹ï¼Œä¸¤ä¸¤ä¹‹é—´å¯è¿æƒå€¼ä¸ºæ›¼å“ˆé¡¿è·ç¦»çš„è¾¹ï¼Œéœ€æ±‚æœ€å°ç”Ÿæˆæ ‘ã€‚</p><p>æœ‰ä¸€å¼•ç†ï¼šä»¥ä»»æ„ä¸€ç‚¹ä¸ºé¡¶ç‚¹çš„å¤§å°ä¸º <span class="math inline">\(\dfrac \pi8\)</span> ã€ä¸”ä¸€æ¡è¾¹ä¸åæ ‡è½´é‡åˆçš„è§’è¦†ç›–çš„èŒƒå›´ä¸­ï¼Œä¸è¯¥ç‚¹æ›¼å“ˆé¡¿è·ç¦»æœ€å°çš„ç‚¹æ‰æœ‰å¯èƒ½ä¸æ­¤ç‚¹è¿è¾¹ã€‚</p><p>æ¦‚æ‹¬è¯´æ¥ä¾¿æ˜¯ä»¥è¯¥ç‚¹ä¸ºåŸç‚¹å»ºç³»ï¼Œæ²¿åæ ‡è½´ç±³å­—åˆ’åˆ†ã€‚</p><details><p><summary>æµ…è¯</summary></p><p>é¦–å…ˆéœ€è®¤è¯†åˆ°ï¼Œè‹¥ <span class="math inline">\(w(x,y)&lt;w(x,z)\)</span> ä¸” <span class="math inline">\(w(y,z)&lt;w(x,z)\)</span>ï¼Œåˆ™è¾¹ <span class="math inline">\(E(x,z)\)</span> ä¸åœ¨æœ€å°ç”Ÿæˆæ ‘ä¸­ã€‚</p><figure><img src="1.png" alt="ç¤ºæ„å›¾" /><figcaption>ç¤ºæ„å›¾</figcaption></figure><p>è€ƒè™‘æœ‰å¦‚ä¸Š <span class="math inline">\(A,B,C\)</span> ä¸‰ç‚¹ã€‚ä¸å¦¨è®¾ <span class="math inline">\(d(A,B)\le d(A,C)\)</span>ã€‚å…¶ä¸­ <span class="math inline">\(d\)</span> ä¸ºæ›¼å“ˆé¡¿è·ç¦»ã€‚</p><p>ç”±å›¾æ˜“çŸ¥ <span class="math inline">\(x_B,y_B,x_C,y_C&gt;0\)</span> ä¸” <span class="math inline">\(y_B-x_B,y_C-x_C&gt;0\)</span>ã€‚è®¨è®º <span class="math inline">\(B\)</span> ä¸ <span class="math inline">\(C\)</span> ä½ç½®å…³ç³»ã€‚ä¸‹æ–‡çš„ <span class="math inline">\(x,y\)</span> å‡ç›¸å¯¹ <span class="math inline">\(A\)</span> è€Œè¨€ã€‚</p><ul><li><p><span class="math inline">\(x_B&gt;x_C\)</span> ä¸” <span class="math inline">\(y_B&gt;y_c\)</span>ï¼š</p>æ­¤æ—¶ <span class="math inline">\(d(A,B)&gt;d(B,C)\)</span>ï¼Œä¸é¢˜è®¾ä¸ç¬¦ï¼Œèˆå»ã€‚</li><li><p><span class="math inline">\(x_B&gt;x_C\)</span> ä¸” <span class="math inline">\(y_B&lt;y_C\)</span>ï¼š</p><p>æ­¤æ—¶ <span class="math inline">\(d(A,B)=x_B+y_B,d(B,C)=x_B-x_C+y_C-y_B,d(A,C)=x_C+y_C\)</span>ã€‚ç”±ä½œå·®æ³•å¾— <span class="math inline">\(d(B,C)-d(A,C)=x_B-y_B-2\times x_C\)</span>ï¼Œç”± <span class="math inline">\(x_B-y_B&lt;0,x_C&gt;0\)</span>ï¼Œ<span class="math inline">\(d(B,C)&lt;d(A,C)\)</span>ã€‚</p>ç”±äº <span class="math inline">\(d(A,B),d(B,C)&lt;d(A,C)\)</span>ï¼Œæ•… <span class="math inline">\(A\)</span> ä¸€å®šä¸ä¸ <span class="math inline">\(C\)</span> è¿è¾¹ã€‚</li><li><p><span class="math inline">\(x_B&lt;x_C\)</span> ä¸” <span class="math inline">\(y_B&gt;y_C\)</span>ï¼š</p>ä¸ä¸Šä¸€ç§æƒ…å†µåŒç†ã€‚</li><li><p><span class="math inline">\(x_B&lt;x_C\)</span> ä¸” <span class="math inline">\(y_B&lt;y_C\)</span>ï¼š</p>æ­¤æ—¶æœ‰ <span class="math inline">\(d(A,C)=d(A,B)+d(B,C)\)</span>ï¼Œåˆ™ <span class="math inline">\(A\)</span> ä¸€å®šä¸ä¸ <span class="math inline">\(C\)</span> è¿è¾¹ã€‚</li></ul></details><p>å¦‚æ­¤ä¸€æ¥ï¼Œè¾¹æ•°ä¾¿é™ä½åˆ°äº† <span class="math inline">\(O(n)\)</span> æ°´å¹³ã€‚</p><p>æ­¤å¤–ï¼Œå¦‚ä½•è¯†åˆ«æ¯ä¸ªç‚¹å‘¨å›´æ¯ <span class="math inline">\(\dfrac \pi8\)</span> çš„æœ€è¿‘ç‚¹ä¾¿æ˜¯é—®é¢˜æ‰€åœ¨ã€‚</p><p>ç”±äºåæ ‡å¯ä»¥å˜æ¢ï¼Œæ­¤å¤„ä»…è€ƒè™‘é¡¶ç‚¹ä¸º <span class="math inline">\(A\)</span>ï¼Œå§‹è¾¹æ²¿ <span class="math inline">\(y\)</span> è½´æ­£æ–¹å‘ï¼Œç»ˆè¾¹æ²¿ <span class="math inline">\(k=1\)</span> çš„åŒºåŸŸã€‚åˆ™å¯¹äºåŒºåŸŸå†…çš„ç‚¹ <span class="math inline">\(B\)</span>ï¼Œæ˜“çŸ¥ <span class="math inline">\(x_B\geqslant x_A,y_B-y_A\geqslant x_B-x_A\)</span>ã€‚</p><p>åä¸€æ¡è§„åˆ™åˆ†ç¦»å˜é‡åˆ™æœ‰ <span class="math inline">\(y_B-x_B\geqslant y_A-x_A\)</span>ï¼Œé‚£ä¹ˆé—®é¢˜è½¬åŒ–ä¸ºäºŒç»´ååºï¼Œå…¶ä¸­å¾…æ±‚ä¸ºæœ€å° <span class="math inline">\(x_B+y_B\)</span>ï¼Œå¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„ç¦»æ•£è§£å†³ã€‚</p><p><del>ç”±äºè¾¹æ˜¯åŒå‘çš„ï¼Œå°†é—®é¢˜åœ¨å¹³é¢ä»»æ„è¿ç»­ <span class="math inline">\(\dfrac \pi 2\)</span> èŒƒå›´å†…è¿›è¡Œå››æ¬¡åæ ‡è½¬åŒ–å³å¯ã€‚</del></p><p><del>å…¶å®å¹¶ä¸ä¸€å®šè¦è¿ç»­ï¼Œåªè¦è¯¥åŒºåŸŸä¸å…¶æ—‹è½¬ä¸€ç™¾å…«ååº¦åçš„å›¾å½¢çš„å¹¶å¯ä»¥è¦†ç›–æ•´ä¸ªå¹³é¢å³å¯ã€‚è¿™ä¹ˆçœ‹æ¥æ˜¯ä¸æ˜¯åªèƒ½è¿ç»­ã€‚</del></p><p>æˆ‘ä»¬ä¼šå‘ç°æ—‹è½¬ <span class="math inline">\(\dfrac \pi 8\)</span> è¿™ä¸ªæˆ‘ä»¬åœ¨æ•´æ•°åŸŸä¸Šåšä¸åˆ°å•Šã€‚æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘æ—‹è½¬ + ç¿»æŠ˜ï¼Œæœ€åæ•´å‡ºæ¥å·®ä¸å¤šè¿™ä¸ªå›¾å½¢ï¼š</p><figure><img src="2.png" alt="ç¤ºæ„å›¾" /><figcaption>ç¤ºæ„å›¾</figcaption></figure><p>ç„¶åç”±äºæˆ‘ä»¬å‘ç°è¿™äº›ç‚¹å…³äº <span class="math inline">\(A\)</span> çš„å…³ç³»ï¼ˆæ˜¯é€šè¿‡ <span class="math inline">\(A\)</span> ç¿»æŠ˜è¿˜æ˜¯æ—‹è½¬å¾—æ¥çš„ï¼‰å¹¶ä¸ä¸­å¿ƒå¯¹ç§°å•Šï¼Œæ‰€ä»¥å‘¢å°±è¦å§”å±ˆä¸€ä¸‹å†™æ»¡å…«ä¸ªæ–¹å‘äº†ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;struct _ &#123;    int x, y, id;    bool operator&lt; (const _ &amp;q) const &#123;        return y - x &gt; q.y - q.x;    &#125;&#125;;struct __ &#123;    int x, y, w;    __() &#123;&#125;    __(int x1, int y1, int w1) &#123;        if (y1 &lt; x1) x1 ^= y1 ^= x1 ^= y1;        x = x1, y = y1, w = w1;    &#125;    bool operator&lt; (const __ &amp;q) const &#123;        return w == q.w ? x &lt; q.x : w &lt; q.w;    &#125;&#125;;int n;int Bit[maxn]; std::vector&lt;__&gt; e;_ a[maxn], b[maxn];int ls[maxn], f[maxn];int lowbit(int x) &#123; return x &amp; -x; &#125;void upd(int &amp;i, int j) &#123;    if (!i || (j &amp;&amp; b[j].x + b[j].y &lt;= b[i].x + b[i].y)) i = j;    return;&#125;void add(int x, int i) &#123;    for (; x &lt;= n; x += lowbit(x)) upd(Bit[x], i);    return;&#125;int ask(int x) &#123;    int res = 0;    for (; x; x -= lowbit(x)) upd(res, Bit[x]);    return res;&#125; int find(int x) &#123; return x == f[x] ? x : f[x] = find(f[x]); &#125;void merge(int x, int y) &#123; f[find(x)] = find(y); return; &#125;int abs(int x) &#123; return x &gt;= 0 ? x : -x; &#125;void adde(int x, int y) &#123;    if (!x || !y) return;    e.emplace_back(x, y, abs(a[x].x - a[y].x) + abs(a[x].y - a[y].y));    return;&#125;int main() &#123;    read(n);    while (n) &#123;        e.clear();        for (int i = 1; i &lt;= n; ++i) &#123;            read(a[i].x), read(a[i].y), a[i].id = i;            ls[i] = a[i].x, b[i] = a[i], f[i] = i;        &#125;        memset(Bit, 0, sizeof (Bit));        std::sort(b + 1, b + n + 1);        std::sort(ls + 1, ls + n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            int x = std::lower_bound(ls + 1, ls + n + 1, b[i].x) - ls;            x = n + 1 - x, adde(b[i].id, b[ask(x)].id), add(x, i);        &#125;        memset(Bit, 0, sizeof (Bit));        for (int i = 1; i &lt;= n; ++i) &#123;            b[i].x = a[i].y, b[i].y = a[i].x;            ls[i] = b[i].x, b[i].id = i;        &#125;        std::sort(b + 1, b + n + 1);        std::sort(ls + 1, ls + n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            int x = std::lower_bound(ls + 1, ls + n + 1, b[i].x) - ls;            assert(x &gt;= 1 &amp;&amp; x &lt;= n);            x = n + 1 - x, adde(b[i].id, b[ask(x)].id), add(x, i);        &#125;        memset(Bit, 0, sizeof (Bit));        for (int i = 1; i &lt;= n; ++i) &#123;            b[i].x = -a[i].x, b[i].y = a[i].y;            ls[i] = b[i].x, b[i].id = i;        &#125;        std::sort(b + 1, b + n + 1);        std::sort(ls + 1, ls + n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            int x = std::lower_bound(ls + 1, ls + n + 1, b[i].x) - ls;            assert(x &gt;= 1 &amp;&amp; x &lt;= n);            x = n + 1 - x, adde(b[i].id, b[ask(x)].id), add(x, i);        &#125;        memset(Bit, 0, sizeof (Bit));        for (int i = 1; i &lt;= n; ++i) &#123;            b[i].x = -a[i].y, b[i].y = a[i].x;            ls[i] = b[i].x, b[i].id = i;        &#125;        std::sort(b + 1, b + n + 1);        std::sort(ls + 1, ls + n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            int x = std::lower_bound(ls + 1, ls + n + 1, b[i].x) - ls;            assert(x &gt;= 1 &amp;&amp; x &lt;= n);            x = n + 1 - x, adde(b[i].id, b[ask(x)].id), add(x, i);        &#125;        memset(Bit, 0, sizeof (Bit));        for (int i = 1; i &lt;= n; ++i) &#123;            b[i].x = -a[i].y, b[i].y = -a[i].x;            ls[i] = b[i].x, b[i].id = i;        &#125;        std::sort(b + 1, b + n + 1);        std::sort(ls + 1, ls + n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            int x = std::lower_bound(ls + 1, ls + n + 1, b[i].x) - ls;            assert(x &gt;= 1 &amp;&amp; x &lt;= n);            x = n + 1 - x, adde(b[i].id, b[ask(x)].id), add(x, i);        &#125;        memset(Bit, 0, sizeof (Bit));        for (int i = 1; i &lt;= n; ++i) &#123;            b[i].x = -a[i].x, b[i].y = -a[i].y;            ls[i] = b[i].x, b[i].id = i;        &#125;        std::sort(b + 1, b + n + 1);        std::sort(ls + 1, ls + n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            int x = std::lower_bound(ls + 1, ls + n + 1, b[i].x) - ls;            assert(x &gt;= 1 &amp;&amp; x &lt;= n);            x = n + 1 - x, adde(b[i].id, b[ask(x)].id), add(x, i);        &#125;        memset(Bit, 0, sizeof (Bit));        for (int i = 1; i &lt;= n; ++i) &#123;            b[i].x = a[i].x, b[i].y = -a[i].y;            ls[i] = b[i].x, b[i].id = i;        &#125;        std::sort(b + 1, b + n + 1);        std::sort(ls + 1, ls + n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            int x = std::lower_bound(ls + 1, ls + n + 1, b[i].x) - ls;            assert(x &gt;= 1 &amp;&amp; x &lt;= n);            x = n + 1 - x, adde(b[i].id, b[ask(x)].id), add(x, i);        &#125;        memset(Bit, 0, sizeof (Bit));        for (int i = 1; i &lt;= n; ++i) &#123;            b[i].x = a[i].y, b[i].y = -a[i].x;            ls[i] = b[i].x, b[i].id = i;        &#125;        std::sort(b + 1, b + n + 1);        std::sort(ls + 1, ls + n + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            int x = std::lower_bound(ls + 1, ls + n + 1, b[i].x) - ls;            assert(x &gt;= 1 &amp;&amp; x &lt;= n);            x = n + 1 - x, adde(b[i].id, b[ask(x)].id), add(x, i);        &#125;        std::sort(e.begin(), e.end());        int res = 0;        for (auto i : e) &#123;            if (find(i.x) != find(i.y))                res += i.w, merge(i.x, i.y);        &#125;        static int TimeKeeper = 0;        printf(&quot;Case %d: Total Weight = %d\n&quot;, ++TimeKeeper, res);        read(n);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æœ€å°ç”Ÿæˆæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>USACO2024JAN ä¸‰ç»„è¿æ‰“</title>
      <link href="/20240131/"/>
      <url>/20240131/</url>
      
        <content type="html"><![CDATA[<p>å‡çš„ï¼Œåªè¿æ‰“äº†ä¸¤ç»„ã€‚Ag æ²¡æ—¶é—´äº†ã€‚æ—¥åå†è¡¥å§ã€‚</p><span id="more"></span><p><img src="https://pic.imgdb.cn/item/65b7b152871b83018ac5e7b7.gif" /></p><p>æ— æ„ä¸­å­˜äº†é¢˜é¢ï¼Œä½†ä»£ç å¤§éƒ¨åˆ†å› ä¸ºç³»ç»Ÿè¿˜åŸæ¶ˆå¤±äº†ï¼Œåªæœ‰æ–‡å­—é¢˜è§£ï¼Œå°†å°±ç€çœ‹å§ã€‚</p><hr /><h3 id="cu-a.-majority-opinion">Cu A. Majority Opinion</h3><p><a href="https://www.luogu.com.cn/problem/P10131" class="uri">https://www.luogu.com.cn/problem/P10131</a></p><p><em>çœæµï¼šä»»æ„åŒºé—´å†…ï¼Œè‹¥æŸå…ƒç´ å‡ºç°ä¸ªæ•°ä¸¥æ ¼å¤§äºåŒºé—´é•¿åº¦ä¸€åŠï¼Œåˆ™å¯å°†æ•´ä¸ªåŒºé—´æ¨å¹³ä¸ºè¯¥å€¼ã€‚é—®æœ€ç»ˆå¯ä»¥ä½¿æ•´ä¸ªåºåˆ—è¢«æ¨å¹³ä¸ºå“ªäº›å€¼ã€‚</em></p><p>æ³¨æ„åˆ°å½“ä»»æ„é•¿åº¦ <span class="math inline">\(\ge 2\)</span> çš„åŒºé—´å¯ä»¥è¢«æ¨å¹³ä¸ºæŸç§å…ƒç´ æ—¶ï¼Œæ•´ä¸ªæ•°åˆ—éƒ½å¯ä»¥è¢«æ¨å¹³ä¸ºè¯¥å…ƒç´ ã€‚æ•…ç›®æ ‡è½¬åŒ–ä¸ºå¯¹äºæŸç§å…ƒç´ åˆ¤å®šæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå¯è¢«å…¶æ¨å¹³çš„åŒºé—´ã€‚</p><p>ç»Ÿè®¡å…ƒç´ ä¸ªæ•°é‡‡ç”¨å‰ç¼€å’Œã€‚ä»¤ <span class="math inline">\(s_i\)</span> è¡¨ç¤º <span class="math inline">\(h_i\)</span> åœ¨å‰ <span class="math inline">\(i\)</span> é¡¹ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå‡è®¾æœ‰ <span class="math inline">\([j,i]\)</span> æ»¡è¶³æ¡ä»¶ï¼Œè´ªå¿ƒå¯çŸ¥ <span class="math inline">\(h_i=h_j\)</span>ã€‚</p><p>é‚£ä¹ˆç”±å®šä¹‰æœ‰ <span class="math inline">\(i-j+1&lt;2\times (s_i-s_j+1)\)</span>ã€‚å…¸ä¸­å…¸ï¼Œç›´æ¥ç§»é¡¹åˆ†ç¦»å˜é‡ã€‚åˆ™æœ‰ <span class="math inline">\(i-2\times s_i-1&lt;j-2\times s_j\)</span>ã€‚ä»¤ <span class="math inline">\(t_p\gets p-2\times s_p\)</span>ï¼Œå¯¹äºæ¯ä¸ª <span class="math inline">\(h\)</span> è®°å½• <span class="math inline">\(t_j\)</span> æœ€å¤§å€¼æŸ¥çœ‹æ˜¯å¦æœ‰ <span class="math inline">\(i,j\)</span> æ»¡è¶³æ¡ä»¶å³å¯ã€‚</p><h3 id="cu-b.-cannonball">Cu B. Cannonball</h3><p><a href="https://www.luogu.com.cn/problem/P10132" class="uri">https://www.luogu.com.cn/problem/P10132</a></p><p><em>çœæµï¼šæœ‰ <span class="math inline">\(N\)</span> ä¸ªæ ¼å­ï¼Œä» <span class="math inline">\(s\)</span> æ ¼å­å¼€å§‹ä»¥ <span class="math inline">\(1\)</span> ä¸ºåˆå§‹èƒ½é‡å‘å³è·³ï¼Œè·³ä¸€æ­¥çš„è·ç¦»ä¸ºèƒ½é‡å¤§å°ã€‚æ ¼å­åˆ†ä¸¤ç§ï¼Œä¸€ç§ç»è¿‡åŠ ä¸€å®šèƒ½é‡å¹¶åå‘ï¼Œå¦ä¸€ç§è‹¥å½“å‰èƒ½é‡å¤§äºä¸€å®šå€¼åˆ™å¯æ°¸ä¹…æ‘§æ¯ï¼Œé—®è·³å‡ºèŒƒå›´æˆ–æ— é™é•¿æ—¶é—´åå¯æ‘§æ¯æ ¼å­ä¸ªæ•°ã€‚</em></p><p>ä¸éš¾å‘ç°è‹¥å¿½ç•¥å¢åŠ èƒ½é‡ä¸º <span class="math inline">\(0\)</span> çš„è·³æ¿åˆ™æ¯ç»è¿‡ä¸€ä¸ªè·³æ¿å¯è·³è·ç¦»å¢åŠ  <span class="math inline">\(1\)</span>ï¼Œæœ€å¤šå¢åŠ åˆ° <span class="math inline">\(n\)</span>ï¼Œå¦åˆ™ä¼šè·³å‡ºå»ã€‚</p><p>æ³¨æ„åˆ°è°ƒå’Œçº§æ•°ï¼Œæ•…ç›´æ¥æ¨¡æ‹Ÿè·³çš„è¿‡ç¨‹ã€‚å”¯ä¸€å¯¼è‡´æ—¶é—´æ— é™çš„æƒ…å†µæ˜¯å­˜åœ¨ç›¸é‚»çš„å¢åŠ èƒ½é‡ä¸º <span class="math inline">\(0\)</span> çš„è·³æ¿ï¼Œä½†å…¶å®å®ƒå…·ä½“æ˜¯ä»€ä¹ˆå¹¶ä¸é‡è¦ï¼Œåæ­£æˆ‘ä»¬è·³çš„æ¬¡æ•°ä¸¥æ ¼å¤§äºè°ƒå’Œçº§æ•°åå°±å¯ä»¥è®¤ä¸ºè¿›å…¥æ­»å¾ªç¯ï¼Œç›´æ¥ç»“æŸæ¨¡æ‹Ÿå³å¯ã€‚æˆ‘è¿™é‡Œå«Œéº»çƒ¦ç›´æ¥æ‹¿äº† <span class="math inline">\(2\times 10^8\)</span> ä½œé˜ˆå€¼ã€‚</p><h3 id="cu-c.-balancing-bacteria">Cu C. Balancing Bacteria</h3><p><a href="https://www.luogu.com.cn/problem/P10133" class="uri">https://www.luogu.com.cn/problem/P10133</a></p><p><em>çœæµï¼šå®šä¹‰ä¸€æ¬¡æ“ä½œä¸ºé€‰å–ä¸€ä¸ªæ•´æ•° <span class="math inline">\(\Delta\le N\)</span>ï¼Œå¹¶ä» <span class="math inline">\(N\)</span> åˆ° <span class="math inline">\(1\)</span>ï¼Œä»¤ <span class="math inline">\(a_i\gets a_i+\Delta\)</span> å¹¶ä»¤ <span class="math inline">\(\Delta\)</span> å‘ <span class="math inline">\(0\)</span> é è¿‘ <span class="math inline">\(1\)</span>ï¼Œ<span class="math inline">\(\Delta=0\)</span> æ—¶åœæ­¢ã€‚é—®ä»¤æ‰€æœ‰ <span class="math inline">\(a_i=0\)</span> æ‰€éœ€æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚</em></p><p>æŒºæœ‰æ„æ€çš„æ€ç»´é¢˜ï¼Œé¦–å…ˆéœ€è¦è¿›è¡Œä¸€ä¸ªæ€ç»´è½¬åŒ–ã€‚<span class="math inline">\(\Delta\le N\)</span> æ˜¯ä¸€ä¸ªåˆ©äºè§£é¢˜çš„é™åˆ¶ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æƒ³è®©ä»»ä½•ä¸€ä¸ª <span class="math inline">\(a_i\)</span> æ”¹å˜ <span class="math inline">\(1\)</span> è€Œä¸å½±å“åˆ°ä¹‹å‰çš„å€¼ï¼Œä»è®© <span class="math inline">\(a_1\gets 0\)</span> å…¥æ‰‹ï¼Œè¿›è¡Œä¸€æ¬¡æ“ä½œåæ¯ä¸ª <span class="math inline">\(a_i\)</span> åˆ†åˆ°çš„ <span class="math inline">\(\Delta\)</span> åº”ä¾æ¬¡åŠ  1 æˆ–ä¾æ¬¡å‡ 1ã€‚åˆ™å·®åˆ†æ•°ç»„ä¸º <span class="math inline">\(0\)</span> åè·Ÿç€ä¸€æˆª <span class="math inline">\(1\)</span> æ˜¯ç†æƒ³çŠ¶æ€ã€‚ä¸­é—´æ¯æœ‰ä¸€é¡¹ä¸æ»¡è¶³è§„å¾‹éƒ½ä¼šå¸¦æ¥é¢å¤–çš„æ“ä½œæ¬¡æ•°ã€‚</p><p>å½’çº³ä¸ºå·®åˆ†æ•°ç»„çš„å·®åˆ†æ•°ç»„ç»å¯¹å€¼ä¹‹å’Œå³ä¸ºç­”æ¡ˆã€‚</p><hr /><h3 id="ag-a.-cowmpetency">Ag A. Cowmpetency</h3><p><a href="https://www.luogu.com.cn/problem/P10134" class="uri">https://www.luogu.com.cn/problem/P10134</a></p><p><em>çœæµï¼šæœ‰è‹¥å¹²æ¡é™åˆ¶ï¼Œæ¯æ¡å½¢å¦‚ <span class="math inline">\(\max\limits_{i=1}^{a_h-1}\{A_i\}=\max\limits_{i=1}^{a_j}\{A_i\}\)</span> ä¸” <span class="math inline">\(A_{a_h}&gt;\max\limits_{i=1}^{a_h-1}\{A_i\}\)</span>ï¼Œéƒ¨åˆ†æ•°å·²çŸ¥ï¼Œæ„é€ å‡ºç¬¦åˆæ¡ä»¶ä¸”å­—å…¸åºæœ€å°çš„åºåˆ—ã€‚</em></p><p>æ˜¯æœ¬åœºæœ€éš¾é¢˜å§ï¼Œä½†ä¹Ÿæ²¡å•¥å¡çš„ã€‚ç”»ä¸ªçº¿æ®µå›¾å®¹æ˜“å‘ç°ï¼Œè‹¥å°† <span class="math inline">\([a,h)\)</span> è§†ä½œä¸€æ¡çº¿æ®µï¼Œé‚£ä¹ˆé™¤é <span class="math inline">\(h\)</span> ç›¸åŒï¼Œå¦åˆ™ä¸¤æ¡çº¿æ®µä¸èƒ½æœ‰äº¤é›†ã€‚ä¸ç„¶çš„è¯å°±æ— è§£ã€‚ä»¥åŠå¦‚æœå­˜åœ¨ä¸æ»¡è¶³æ¡ä»¶çš„å®šå€¼ä¹Ÿæ˜¾ç„¶æ— è§£ã€‚</p><p>ä»å‰å¾€åçœ‹æ¯ä¸ª <span class="math inline">\(h\)</span> å¹¶å°è¯•èµ‹å€¼ï¼Œå¯¹äºæ¯ä¸ª <span class="math inline">\(1\sim a\)</span> è®°å½•ä¸€ä¸ªéœ€è¦æ»¡è¶³çš„æœ€å¤§å€¼æ•°å€¼ï¼ŒæŒ‰ç…§æ­¤æ•°å€¼ä»åå¾€å‰å¡«ç©ºæ ¼ã€‚</p><p>å¡«å®Œè¿‡åæ‰«ä¸€éçœ‹çœ‹æ˜¯ä¸æ˜¯å…¨éƒ¨åˆæ³•ï¼Œå¯ä»¥è¯æ˜è‹¥æ­¤æ—¶ä¸åˆæ³•åˆ™æ— è§£ã€‚</p><h3 id="ag-b.-potion-farming">Ag B. Potion Farming</h3><p><a href="https://www.luogu.com.cn/problem/P10135" class="uri">https://www.luogu.com.cn/problem/P10135</a></p><p><em>çœæµï¼šä¸€æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹ä¸Šæœ‰è‹¥å¹²ä¸ªç‰©å“ï¼Œå¯¹äºæ¯æ¡ä»æ ¹åˆ°å¶å­çš„ç®€å•è·¯å¾„ï¼Œå¯ä»¥é€‰æ‹©è·¯å¾„ä¸Šçš„ä¸€ä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“åªèƒ½è¢«é€‰ä¸€æ¬¡ï¼Œé—®æœ€å¤šå¯é€‰ç‰©å“æ•°ã€‚</em></p><p>å¦‚æœä¸€ä¸ªç‚¹å¼•å¯¼çš„å­æ ‘ä¸‹æ‰€æœ‰å¶å­æœ‰æ²¡æœ‰åˆ†é…åˆ°çš„ï¼Œå°±å¯ä»¥æŠŠè¿™ä¸ªç‚¹çš„ç‰©å“åˆ†é…ç»™è¯¥å¶å­ã€‚</p><p>è·‘ä¸€ä¸ªæ ‘å½¢ DP å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;int n, x, y;int cnt[maxn];std::vector&lt;int&gt; g[maxn];int a[maxn], f[maxn], p[maxn];int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;void DFS(int x, int fa) &#123;    if ((int)g[x].size() == 1)        cnt[x] = 1;    for (auto i : g[x]) &#123;        if (i == fa) continue;        DFS(i, x);        f[x] += f[i];        cnt[x] += cnt[i];    &#125;    if (f[x] &lt; cnt[x])        f[x] = min(f[x] + a[x], cnt[x]);    return;&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;    read(n);    for (int i = 1; i &lt;= n; ++i) read(p[i]);    for (int i = 1; i &lt; n; ++i) &#123;        read(x), read(y);        add(x, y), add(y, x);    &#125;    int tot = 0;    for (int i = 2; i &lt;= n; ++i)        tot += ((int)g[i].size() == 1);    for (int i = 1; i &lt;= tot; ++i) ++a[p[i]];    DFS(1, -1);    print(f[1], &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><h3 id="ag-c.-cowlendar">Ag C. Cowlendar</h3><p><a href="https://www.luogu.com.cn/problem/P10136" class="uri">https://www.luogu.com.cn/problem/P10136</a></p><p><em>çœæµï¼šå¯¹äºç»™å®šçš„åºåˆ— <span class="math inline">\(a\)</span>ï¼Œæ‰¾å‡ºæ‰€æœ‰æ»¡è¶³ <span class="math inline">\(a_i\bmod L\)</span> çš„å€¼çš„ç§ç±»æœ€å¤šä¸º 3 çš„ <span class="math inline">\(L\)</span>ã€‚</em></p><p>ä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„æ•°å­¦é¢˜äº†ã€‚è‹¥å°† <span class="math inline">\(a_i\)</span> æŒ‰ç…§æ¨¡ <span class="math inline">\(L\)</span> çš„æƒ…å†µåˆ†ç»„ï¼Œåˆ™å¯¹äºä»»æ„ä¸€ä¸ª <span class="math inline">\(a_i\)</span>ï¼Œåœ¨ <span class="math inline">\((a_i,a_i+L)\)</span> ä¸­æœ€å¤šåŒ…å«ä¸¤ä¸ªåˆ†åˆ«æ¥è‡ªå…¶ä½™ä¸¤ç»„çš„æ•°ã€‚</p><p>å¯¹äºå»é‡å <span class="math inline">\(n&gt;3\)</span> çš„æƒ…å†µï¼Œç”±é¸½å·¢å¾—å¿…å®šæœ‰ä¸¤ä¸ªæ•°å¯åˆ†ä¸ºä¸€ç»„ã€‚æ•…æˆ‘ä»¬æšä¸¾å¯èƒ½çš„ç»„é—´é—´éš”ï¼Œè€Œå¯èƒ½çš„ <span class="math inline">\(L\)</span> å°±æ˜¯è¿™äº›é—´éš”çš„å› æ•°ã€‚</p><p>ç”±ä¸Šé¢æˆ‘ä»¬æ¨å‡ºä¸€ä¸ªåˆæ³•ç»„é—´é—´éš”ä¸­æœ€å¤šé—´éš”ä¸‰ä¸ªæ•°ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ <span class="math inline">\(a_{i+3}-a_i\)</span>ã€<span class="math inline">\(a_{i+2}-a_i\)</span> å’Œ <span class="math inline">\(a_{i+1}-a_i\)</span> çº³å…¥è€ƒè™‘èŒƒå›´å³å¯ã€‚å¯¹äºæ‰€æœ‰å¯èƒ½çš„ <span class="math inline">\(L\)</span>ï¼Œç›´æ¥ <span class="math inline">\(O(n)\)</span> è·‘ä¸€ä¸ª <code>check</code> æ£€æŸ¥æ˜¯å¦åˆæ³•ã€‚</p><p>å› å­ä¸ªæ•°ç…§ç†æ¥è¯´æ˜¯ <span class="math inline">\(\sqrt{V}\times n\)</span> çº§åˆ«çš„ï¼Œä½†æ˜¯å®æµ‹ <span class="math inline">\(n\)</span> æœ€å¤šåªæœ‰ä¸€ç™¾å¤šã€‚ä¼°è®¡æ˜¯å› ä¸º <span class="math inline">\(n\)</span> å¤ªå¤§å°±å¾ˆéš¾æ„é€ å‡ºæ›´å¤šçš„åˆæ³•è§£å§ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int maxn = 1e4 + 5;const int maxm = 3e4 + 5;std::set&lt;int&gt; u;int n, res, mn, tot;int a[maxn], b[maxm];bool check(int x) &#123;    int l1 = 0, l2 = 0, l3 = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        if (l1 == 0) l1 = a[i];        else if (x &amp;&amp; (a[i] - l1) % x == 0) l1 = a[i];        else if (l2 == 0) l2 = a[i];        else if (x &amp;&amp; (a[i] - l2) % x == 0) l2 = a[i];        else if (l3 == 0) l3 = a[i];        else if (x &amp;&amp; (a[i] - l3) % x == 0) l3 = a[i];        else return 0;    &#125;    return 1;&#125;int main() &#123;    read(n);    for (int i = 1; i &lt;= n; ++i) &#123;        read(a[i]);        if (!mn || a[i] / 4 &lt; mn) mn = a[i] / 4;    &#125;    std::sort(a + 1, a + n + 1);    n = std::unique(a + 1, a + n + 1) - a - 1;    if (check(0)) &#123;        print(mn * (mn + 1) / 2, &#39;\n&#39;);        return 0;    &#125;    for (int i = 2; i &lt;= n; ++i) &#123;        b[++tot] = a[i] - a[i - 1];        if (i &gt;= 3) b[++tot] = a[i] - a[i - 2];        if (i &gt;= 4) b[++tot] = a[i] - a[i - 3];    &#125;    std::sort(b + 1, b + tot + 1);    tot = std::unique(b + 1, b + tot + 1) - b - 1;    for (int i = 1; i &lt;= tot; ++i) &#123;        if (check(b[i])) &#123;            for (int j = 1; j * j &lt;= b[i]; ++j) &#123;                if (b[i] % j == 0)                    u.insert(j), u.insert(b[i] / j);            &#125;        &#125;    &#125;    for (auto i : u) &#123;        if (i &gt; mn) break;        res += i;    &#125;    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre><p></deteails></p>]]></content>
      
      
      
        <tags>
            
            <tag> é¸½å·¢åŸç† </tag>
            
            <tag> è°ƒå’Œçº§æ•° </tag>
            
            <tag> å·®åˆ† </tag>
            
            <tag> æ€ç»´ </tag>
            
            <tag> æ ‘å½¢ DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æˆ‘è¶…ï¼é›€ï¼</title>
      <link href="/20240125/"/>
      <url>/20240125/</url>
      
        <content type="html"><![CDATA[<p>Solution to <a href="http://222.180.160.110:61235/contest/4813/problem/1">PKUSC2022 Mahjong</a>ã€‚</p><span id="more"></span><hr /><p><a href="https://www.bilibili.com/video/BV1JB4y1R7AP/" class="uri">https://www.bilibili.com/video/BV1JB4y1R7AP/</a></p><p>è¿™é‡Œæ˜¯ PKUSC å½“æ—¶çš„è®²è§£è§†é¢‘ã€‚å¬è¯´å¯ä»¥è¯æ˜æœ¬é¢˜ä¸€å®šæœ‰ <span class="math inline">\(\le 5\)</span> çš„è§£ã€‚å¥½ç¥å¥‡ã€‚</p><hr /><p>å°±æ¯”å¦‚è¯´æˆ‘ä»¬çˆ†æœï¼Œ<span class="math inline">\(9^4\times 13^4\)</span> è¿™ä¸ªæ˜¾ç„¶å¹²ä¸åŠ¨å¯¹å§ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘åè¿‡æ¥ DPã€‚</p><p>æˆ‘ä»¬å…ˆæŠŠå­—ç¬¦ä¸²è½¬åŒ–æˆè®¡æ•°æ•°ç»„ï¼Œå°±æ˜¯æ¯ç§ç‰Œæœ‰å¤šå°‘ç‰‡ã€‚ä¸å¦¨å°† <code>1m ~ 9s</code> ç¼–å·ä¸º <span class="math inline">\(1\sim 27\)</span>ï¼Œè®° <span class="math inline">\(g_i\)</span> ä¸ºç¼–å·ä¸º <span class="math inline">\(i\)</span> çš„ç‰Œçš„æ•°é‡ã€‚</p><p>ä¸ºä»€ä¹ˆæˆ‘ä»¬è§‰å¾— DP ä¸å¥½æ‰“å‘¢ï¼Ÿå› ä¸ºæ¢ç‰Œæ“ä½œå¯ä»¥å°†ä¸¤ä¸ªæ¯«ä¸ç›¸å¹²çš„ç‰Œçš„æ•°é‡æ›´æ”¹ï¼Œä¸å¥½è®°å½•çŠ¶æ€ã€‚æˆ‘ä»¬ä¸å¦¨ç›´æ¥å°†æ¢ç‰Œæ‹†æˆ <em>ä¸¢å¼ƒä¸€å¼ ç‰Œ</em> å’Œ <em>å€Ÿå–ä»¤ä¸€å¼ ç‰Œ</em> ä¸¤ä¸ªæ“ä½œã€‚å¾ˆæ˜¾ç„¶è¿™ä¸¤ä¸ªæ“ä½œæ•°é‡æ˜¯ä¸€æ ·çš„ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç‰Œæ•°é‡è‡ªå§‹è‡³ç»ˆä¸å˜ã€‚</p><p>å¯¹äºæ¯”è¾ƒç®€å•çš„å¯¹å­ä½œä¸ºç»ˆå±€çš„æƒ…å†µï¼Œæˆ‘ä»¬åªå…³å¿ƒå¯¹æ•°æ˜¯å¦ä¸º <span class="math inline">\(7\)</span>ï¼Œæ‰€ä»¥è®¾è®¡çŠ¶æ€ï¼š<span class="math inline">\(dp_{i,j}\)</span> è¡¨ç¤ºå‰ <span class="math inline">\(i\)</span> å¼ ç‰Œä¸­å‡‘å‡º <span class="math inline">\(j\)</span> ä¸ªå¯¹å­çš„æœ€å°ä»£ä»·ã€‚</p><p>é‚£ä¹ˆå°±åˆ† <em>æŠŠå½“å‰ç‰Œä¸¢ä¸€äº› / å€Ÿä¸€äº›æ‹¿å»ç»„å¯¹å­</em> å’Œ <em>ç›´æ¥ä¸¢å¼ƒå½“å‰ç‰Œ</em> ä¸¤ç§æ–¹æ¡ˆã€‚å› ä¸ºä¸¢ / å€Ÿçš„æ•°é‡æ˜¯ä¸ç¡®å®šçš„ï¼Œç›´æ¥ <code>abs</code> ä¸€ä¸‹å°±å¥½ã€‚åˆ·è¡¨ï¼Œæœ‰ï¼š</p><p><span class="math display">\[dp_{i+1,j}=dp_{i,j}+g_{i+1}\\dp_{i+1,j+1}=dp_{i,j}+|g_{i+1}-2|\]</span></p><p>æœ€åæˆ‘ä»¬çš„ç­”æ¡ˆå°±æ¥è‡ª <span class="math inline">\(dp_{27,7}\)</span>ã€‚ç„¶åæ³¨æ„è¿™é‡Œæˆ‘ä»¬çš„ç»ˆå±€æ˜¯ 14 å¼ ç‰Œ <del>ä½ èƒ½ç§’æˆ‘</del>ï¼Œä½†èµ·æ‰‹åªæœ‰ 13 å¼ ç‰Œï¼Œæ‰€ä»¥å…¶å®ä¼šæœ‰ä¸€ä¸ªé¢å¤–çš„å€Ÿç‰Œæ“ä½œï¼Œå‡è®¾ç­”æ¡ˆä¸º <span class="math inline">\(x\)</span>ï¼Œé‚£ä¹ˆå…¶å® <span class="math inline">\(dp_{27,7}=2\times x+1\)</span>ã€‚</p><hr /><p>æœ‰äº†å¯¹å­çš„é“ºå«ï¼Œé¢å­æ‰‹å…¶å®ä¹Ÿè¿˜å¥½ã€‚æˆ‘ä»¬éœ€è¦è€ƒè™‘çš„æ˜¯å¯¹å­å’Œé¢å­çš„ä¸ªæ•°ã€‚</p><p>ä½†æ˜¯æœ‰ä¸ªé—®é¢˜ï¼Œå¯¹å­åªç”¨å€Ÿ / ä¸¢å½“å‰èŠ±è‰²ï¼Œä½†é¢å­å¯èƒ½æ˜¯ä¼šå€Ÿ / ä¸¢ä¸‹ä¸€ä¸ª / ä¸‹ä¸‹ä¸€ä¸ªèŠ±è‰²çš„ã€‚</p><p>æ‰€ä»¥å¹²è„†å…¨éƒ¨è®°å½•åˆ°çŠ¶æ€é‡Œï¼Œä»¤ <span class="math inline">\(f_{i,j,k,a,b}\)</span> è¡¨ç¤ºå½“å‰åœ¨ç¬¬ <span class="math inline">\(i\)</span> ä¸ªèŠ±è‰²ï¼Œå‡‘æˆäº† <span class="math inline">\(j\)</span> ä¸ªé¢å­ï¼Œ<span class="math inline">\(k\)</span> ä¸ªå¯¹å­ï¼Œéœ€è¦ <span class="math inline">\(a\)</span> ä¸ª <span class="math inline">\(i+1\)</span>ï¼Œ<span class="math inline">\(b\)</span> ä¸ª <span class="math inline">\(i+2\)</span>ã€‚æ³¨æ„å› ä¸ºè¡¨ç¤ºä¸¢å€Ÿæœ‰è´Ÿæ•°ä¸å¤ªå®¹æ˜“ï¼Œä¸å¦‚å°±ç›´æ¥è®¾æˆéœ€è¦çš„æ•°é‡äº†ã€‚</p><p>å› ä¸ºè¿™ä¸ªéœ€è¦æ•°é‡åªæ˜¯å‰é¢çš„èŠ±è‰²å¯¹å½“å‰èŠ±è‰²çš„éœ€è¦ <span class="math inline">\(a\)</span>ï¼Œæˆ‘ä»¬è¿˜è¦æ»¡è¶³å½“å‰èŠ±è‰² <strong>è‡ªèº«</strong> çš„éœ€è¦ <span class="math inline">\(now\)</span>ï¼ˆä¹Ÿå°±æ˜¯è¯´å½“å‰èŠ±è‰²ä¸€å…±éœ€è¦ <span class="math inline">\(a+now\)</span> å¼ ï¼‰ã€‚æ³¨æ„è¿™é‡Œ <span class="math inline">\(a\)</span> å¼ å…¨éƒ¨éƒ½æ˜¯æ‹¿å»å€Ÿç»™å‰é¢çš„èŠ±è‰²ç”¨çš„ï¼Œè‡ªå·±ä¸èƒ½ç”¨ã€‚</p><ul><li><p>å¯¹äº <span class="math inline">\(k=0\)</span> ä¸” <span class="math inline">\(now\ge 2\)</span>ï¼Œæ­¤æ—¶å¯ä»¥ä» <span class="math inline">\(now\)</span> é‡Œæ‹¿ä¸¤å¼ å‡ºæ¥å‡‘å¯¹å­ï¼Œå‰©ä¸‹çš„ <span class="math inline">\(now - 2\)</span> å› ä¸ºè‚¯å®š <span class="math inline">\(\le 2\)</span>ï¼Œæ‰€ä»¥åªèƒ½å…¨éƒ¨æ‹¿å»å‡‘é¡ºå­ã€‚æ‰€ä»¥æœ‰ï¼š</p><span class="math display">\[f_{i+1,j+now-2,1,b+now-2, now-2}=f_{i,j,0,a,b}+|g_{i+1}-(a+now)|\]</span></li><li><p>å¯¹äº <span class="math inline">\(now\ge 3\)</span>ï¼Œæ‹¿ä¸‰å¼ å‡‘ä¸€é¢ã€‚æœ‰ï¼š</p><span class="math display">\[f_{i+1,j+now-2,k,b+now-3,now-3}=f_{i,j,0,a,b}+|g_{i+1}-(a+now)|\]</span></li><li><p>å¯¹äº <span class="math inline">\(now\ne 0\)</span>ï¼Œå¯ä»¥å‡‘é¡ºå­ï¼Œæœ‰ï¼š</p><p><span class="math display">\[f_{i+1,j+now,k,b+now,now}=f_{i,j,0,a,b}+|g_{i+1}-(a+now)|\]</span></p><p>æ³¨æ„ä¸èƒ½è·¨èŠ±è‰²å€Ÿç‰Œï¼Œä¹Ÿå°±æ˜¯ä¸èƒ½è®© <span class="math inline">\(i=8/9/17/18/26/27\)</span>ã€‚</p></li></ul><p>ç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(f_{27,4,1,0,0}\)</span>ã€‚</p><hr /><p>ç„¶åè¿™ä¸¤ä¸ªæƒ…å†µå–ä¸€ä¸ª <span class="math inline">\(\min\)</span> å°±æ˜¯ç­”æ¡ˆã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;using std::cin;using std::getline;using str = std::string;int g[30];int dp[30][15];str sm, sp, ss;int f[30][7][2][7][7];int abs(int x) &#123; return x &gt;= 0 ? x : -x; &#125;int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;void upd(int &amp;x, int y) &#123; x = min(x, y); return; &#125;int main() &#123;    getline(cin, sm, &#39;m&#39;);    getline(cin, sp, &#39;p&#39;);    getline(cin, ss, &#39;s&#39;);    for (auto i : sm) ++g[i - &#39;0&#39;];    for (auto i : sp) ++g[i - &#39;0&#39; + 9];    for (auto i : ss) ++g[i - &#39;0&#39; + 18];    // æ‰“å¯¹å­    memset(dp, 0x3f, sizeof (dp));    dp[0][0] = 0;    for (int i = 0; i &lt; 27; ++i) &#123;        for (int j = 0; j &lt;= 7; ++j) &#123;            if (dp[i][j] == 0x3f3f3f3f) continue;            upd(dp[i + 1][j], dp[i][j] + g[i + 1]);            upd(dp[i + 1][j + 1], dp[i][j] + abs(g[i + 1] - 2));        &#125;    &#125;    // æ‰“é£æœº    memset(f, 0x3f, sizeof (f));    f[0][0][0][0][0] = 0;    for (int i = 0; i &lt; 27; ++i)    for (int j = 0; j &lt;= 4; ++j)    for (int k = 0; k &lt;= 1; ++k)    for (int a = 0; a &lt;= 4; ++a)    for (int b = 0; b &lt;= 4; ++b) &#123;        if (i % 9 == 8 &amp;&amp; b) continue;        if (i % 9 == 0 &amp;&amp; a + b) continue;        for (int now = 0; now &lt;= 4; ++now) &#123; // å¯¹å½“å‰çš„é¢å¤–éœ€æ±‚             if (a + now &gt; 4) continue;            int v = f[i][j][k][a][b] + abs(g[i + 1] - (a + now));            if (j + now &lt;= 4 &amp;&amp; b + now &lt;= 4) // ç›´æ¥ç¡¬é…é¡ºå­                 upd(f[i + 1][j + now][k][b + now][now], v);            if (now &gt;= 2 &amp;&amp; !k &amp;&amp; j + now - 2 &lt;= 4 &amp;&amp; b + now - 2 &lt;= 4) // å€Ÿä¸¤ä¸ªå»å‡‘å¯¹å­                 upd(f[i + 1][j + now - 2][1][b + now - 2][now - 2], v);            if (now &gt;= 3 &amp;&amp; j + now - 2 &lt;= 4 &amp;&amp; b + now - 3 &lt;= 4) // å€Ÿä¸¤ä¸ªå»å‡‘ä¸‰ä¸å¸¦                 upd(f[i + 1][j + now - 2][k][b + now - 3][now - 3], v);        &#125;    &#125;    // æ‹¿æ¥å€Ÿèµ°ä¼šç®—ä¸¤æ¬¡     print(min(dp[27][7], f[27][4][1][0][0]) / 2, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜åˆ«é€‰è°ˆäº†</title>
      <link href="/20240111/"/>
      <url>/20240111/</url>
      
        <content type="html"><![CDATA[<p>Solution to <a href="http://222.180.160.110:61235/contest/4665/problem/2">SP4060 Game with Probability Problem</a>ã€‚</p><span id="more"></span><hr /><p>è®¾ <span class="math inline">\(f_i,g_i\)</span> åˆ†åˆ«è¡¨ç¤ºè¿˜å‰© <span class="math inline">\(i\)</span> ä¸ªçš„æ—¶å€™è½®åˆ° Alice å’Œ Bob æ—¶ <strong>Alice</strong> åˆ†åˆ«çš„èƒœç‡ã€‚</p><p>æ¦‚ç‡ç»å…¸å€’æ¨ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ <span class="math inline">\(f_0=0,g_0=1\)</span>ã€‚</p><p>ç„¶åå°±æ˜¯ä¸€ä¸ªåˆ†è®¨ï¼Œè®¨è®ºè¿™ä¸ªäººæƒ³è¦æ­£é¢è¿˜æ˜¯åé¢ã€‚å¾ˆæ˜¾ç„¶ï¼Œå¯¹äºåŒæ ·çš„å‰©ä½™æ£‹å­æ•°ï¼Œä¸¤ä¸ªäººå…ˆæ‰‹çš„æƒ…å†µå¯¹äºè¿™é¢—æ£‹å­çš„å–œçˆ±ç¨‹åº¦æ˜¯ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦ä¹ˆéƒ½æƒ³è¦ï¼Œè¦ä¹ˆéƒ½ä¸æƒ³è¦ã€‚</p><p>ä»€ä¹ˆæ—¶å€™æƒ³è¦å‘¢ï¼Ÿæ‹¿æ‰è¿‡åè‡ªå·±èƒœç‡æ›´å¤§ï¼Œä¹Ÿå°±æ˜¯ <span class="math inline">\(g_{i-1}&gt;f_{i-1}\)</span>ã€‚æ­¤æ—¶æœ‰ï¼š</p><p><span class="math display">\[f_i=(1-p)\times g_i+p\times g_{i-1}\\g_i=(1-q)\times f_i+q\times f_{i-1}\]</span></p><p>å‘ç°æ˜¯äº’ç›¸å½±å“çš„ï¼Œè¿™ä¸ªæ—¶å€™å…ˆä¸è¦ç€æ€¥æ€€ç–‘è‡ªå·±æ¨é”™äº†ï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡Œæœ‰ä¸¤ä¸ªæœªçŸ¥æ•°ï¼Œåˆåˆšå¥½æœ‰ä¸¤ä¸ªæ–¹ç¨‹ï¼Œæš´è§£ä¸€ä¸‹å°±æœ‰ï¼š</p><p><span class="math display">\[f_i=\dfrac {(1-p)\times q\times f_{i-1}+p\times g_{i-1}}{1-(1-p)(1-q)}\\g_i=\dfrac {(1-q)\times p\times g_{i-1}+q\times f_{i-1}}{1-(1-p)(1-q)}\]</span></p><p>ç„¶å <span class="math inline">\(g_{i-1}&lt;f_{i-1}\)</span> çš„æƒ…å†µä¹Ÿå·®ä¸å¤šï¼ŒæŠŠæ‹¿çš„æ¦‚ç‡å’Œä¸æ‹¿çš„æ¦‚ç‡æ¢ä¸€ä¸‹ï¼š</p><p><span class="math display">\[f_i=p\times g_i+(1-p)\times g_{i-1}\\g_i=q\times f_i+(1-q)\times f_{i-1}\]</span></p><p>è§£æ–¹ç¨‹ç»„æœ‰ï¼š</p><p><span class="math display">\[f_i=\dfrac {(1-q)\times p\times f_{i-1}+(1-p)\times g_{i-1}}{1-p\times q}\\g_i=\dfrac {(1-p)\times q\times g_{i-1}+(1-q)\times f_{i-1}}{1-p\times q}\]</span></p><p>ç„¶åå°±å¯ä»¥å¼€å§‹ DP äº†ã€‚æœ€åçš„ç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(f_{\min(n,1000)}\)</span>ã€‚</p><p>è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯ <span class="math inline">\(n\)</span> ç‰¹åˆ«å¤§ç„¶åè¿™ä¸ªçœ‹èµ·æ¥ä¹Ÿä¸å¤ªèƒ½çŸ©ä¹˜ï¼Œä½†æ˜¯è¿™ä¸ª DP å¼æœ‰ä¸ªå¥½å¤„æ˜¯å®ƒçš„å¢é•¿è¶‹åŠ¿æ˜¯æŒ‡æ•°çº§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ DP åˆ° <span class="math inline">\(1000\)</span> å°±å¯ä»¥äº†ã€‚</p><details><pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;namespace XSC062 &#123;const int maxn = 1e3 + 5;using db = double;db p, q;int T, n;db f[maxn], g[maxn];int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;int main() &#123;    scanf(&quot;%d&quot;, &amp;T);    while (T--) &#123;        scanf(&quot;%d %lf %lf&quot;, &amp;n, &amp;p, &amp;q);        f[0] = .0, g[0] = 1.0;        for (int i = 1; i &lt;= n &amp;&amp; i &lt;= 1000; ++i) &#123;            if (g[i - 1] &gt; f[i - 1]) &#123;                f[i] = ((1 - p) * q * f[i - 1] + p * g[i - 1]) / (1 - (1 - p) * (1 - q));                g[i] = ((1 - q) * p * g[i - 1] + q * f[i - 1]) / (1 - (1 - p) * (1 - q));            &#125;            else &#123;                f[i] = ((1 - q) * p * f[i - 1] + (1 - p) * g[i - 1]) / (1 - p * q);                g[i] = ((1 - p) * q * g[i - 1] + (1 - q) * f[i - 1]) / (1 - p * q);            &#125;        &#125;        printf(&quot;%.6lf\n&quot;, f[min(n, 1000)]);    &#125;    return 0;&#125;&#125; // namespace XSC062int main() &#123;    XSC062::main();    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> æ¦‚ç‡æœŸæœ› </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜å…¨è°ˆ</title>
      <link href="/20240106/"/>
      <url>/20240106/</url>
      
        <content type="html"><![CDATA[<p>æƒ³ä¸åˆ°å¥½æ ‡é¢˜äº†ã€‚</p><span id="more"></span><p>æœ‰å¥è¯æ€ä¹ˆè¯´æ¥ç€ï¼Œç½—é©¬ä¸æ˜¯ä¸€å¤©å»ºæˆçš„ï¼Œæ˜¯ä¸€å¤©å¤©å»ºæˆçš„ã€‚</p><p>è¿˜æœ‰ä»€ä¹ˆï¼ŒDo in Rome as the Romansâ€™ doï¼Œè¿˜æœ‰ä¸€å¥ï¼ŒAll roads leads to Romeã€‚</p><hr /><h3 id="a.-è¿ç»­çš„é›¶-zero">A. è¿ç»­çš„é›¶ zero</h3><p><a href="http://222.180.160.110:61235/contest/4647/problem/1" class="uri">http://222.180.160.110:61235/contest/4647/problem/1</a></p><p>åšä¸ªå‰ç¼€å’Œï¼Œçœ‹çœ‹ä»»æ„ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(k\)</span> çš„åŒºé—´ä¸­æœ‰å‡ ä¸ª <span class="math inline">\(1\)</span>ã€‚å¤æ‚åº¦ <span class="math inline">\(O(n)\)</span>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 5e5 + 5;const int inf = 0x3f3f3f3f;int n, m, res = inf;int a[maxn], s[maxn];int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;int main() &#123;    scanf(&quot;%d %d&quot;, &amp;n, &amp;m);    for (int i = 1; i &lt;= n; ++i) &#123;        scanf(&quot;%1d&quot;, &amp;a[i]);        s[i] = s[i - 1] + a[i];        if (i &gt;= m)            res = min(res, s[i] - s[i - m]);    &#125;    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="b.-åå›æ–‡ä¸²-anti">B. åå›æ–‡ä¸² anti</h3><p><a href="http://222.180.160.110:61235/contest/4647/problem/2" class="uri">http://222.180.160.110:61235/contest/4647/problem/2</a></p><p>å½“ <span class="math inline">\(n\)</span> ä¸ºå¥‡æ—¶ï¼Œä¸­é—´çš„å…ƒç´ ä¸€å®šå’Œè‡ªå·±ç›¸ç­‰ï¼Œæ•…æ— è§£ã€‚</p><p>å½“æ•°é‡æœ€å¤šçš„ä¸€ä¸ªå­—ç¬¦ä¸ªæ•°è¶…è¿‡ <span class="math inline">\(\dfrac n2\)</span> æ—¶ï¼Œç”±é¸½å·¢å¾—æ— è§£ã€‚</p><p>å‰©ä¸‹çš„æƒ…å†µä¸€å®šæœ‰è§£ã€‚</p><details><p><summary>è¯æ˜</summary></p><p>å¯ä»¥æ‰¾åˆ°ä¸€ç§åˆæ³•çš„æ„é€ æ–¹å¼ã€‚æˆ‘ä»¬åˆ—å‡ºä¸€ä¸ªåˆ—æ•°ä¸º <span class="math inline">\(2\)</span>ï¼Œè¡Œæ•°ä¸º <span class="math inline">\(\dfrac n2\)</span> çš„è¡¨æ ¼ï¼Œå°†æ‰€æœ‰ç›¸åŒå­—æ¯æ’åˆ—åœ¨ä¸€èµ·ï¼ŒæŒ‰ç…§ä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹çš„æ–¹å¼å°†å­—æ¯å¡«å…¥è¡¨æ ¼ï¼Œæœ€åå°†ç¬¬ <span class="math inline">\(i\)</span> è¡Œç¬¬ä¸€åˆ—çš„å­—æ¯å¡«å…¥ <span class="math inline">\(a_i\)</span>ï¼Œç¬¬ <span class="math inline">\(i\)</span> è¡Œç¬¬äºŒåˆ—çš„å­—æ¯å¡«å…¥ <span class="math inline">\(a_{n-i+1}\)</span>ï¼Œå³å¯å®Œæˆæ„é€ ã€‚</p><p>ä¸€ç§å­—æ¯åªåœ¨ç¬¬ä¸€åˆ—æˆ–ç¬¬äºŒåˆ—å‡ºç°å½“ç„¶åˆæ³•ï¼Œå¦‚æœä»ç¬¬ä¸€åˆ—æŒç»­åˆ°ç¬¬äºŒåˆ—ï¼Œå› ä¸ºä»»æ„å­—æ¯å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ <span class="math inline">\(\dfrac n2\)</span> æ¬¡ï¼Œæ‰€ä»¥åŒä¸€è¡Œçš„ä¸¤åˆ—ä¸ä¼šå‡ºç°åŒä¸€ç§å­—æ¯ã€‚</p><p>è¿™å«ä»€ä¹ˆï¼Œæœ‰å­—è¯æ˜ã€‚</p><p><del>æ„Ÿè§‰å¯ä»¥æ‹¿å»å‡ºä¸€é“ç±»ä¼¼äºã€Œæ‰¾åˆ°å­—ç¬¦ä¸²å­—å…¸åºæœ€å°çš„åå›æ–‡ä¸²ã€ä¹‹ç±»çš„å°æ°´é¢˜</del></p></details><p>ç„¶åç°åœ¨æˆ‘ä»¬çŸ¥é“æœ‰è§£äº†ï¼Œæ€ä¹ˆæ‰¾åˆ°æœ€ä¼˜è§£å‘¢ã€‚</p><p>æ¯”å¦‚æœ‰ä¸€ç»„ <span class="math inline">\((a_i,a_{n-i+1})=(\texttt a, \texttt a)\)</span>ï¼Œè¿˜æœ‰ä¸€ç»„ <span class="math inline">\((a_j, a_{n-j+1})=(\texttt b, \texttt b)\)</span>ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æŠŠ <span class="math inline">\(a_i\)</span> å’Œ <span class="math inline">\(a_j\)</span> äº¤æ¢ï¼Œçš†å¤§æ¬¢å–œã€‚</p><p>è¿™å°±è¯´æ˜æˆ‘ä»¬éœ€è¦æŠŠå€¼ä¸ç›¸ç­‰çš„éæ³• <span class="math inline">\(a_i\)</span> ä¸ <span class="math inline">\(a_j\)</span> é…å¯¹ã€‚</p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ²¿ç”¨è¯æ˜ä¸­çš„æ„é€ æ–¹å¼ï¼Œåˆ†ç»„é…å¯¹ï¼Œä¸€å®šæœ€ä¼˜ï¼Œæ¯ç»„ä»£ä»·ä¸º <span class="math inline">\(1\)</span>ã€‚</p><p>åŒä¸€è¡Œä¸¤ä¸ªå€¼ <span class="math inline">\(v\)</span> ç›¸ç­‰ï¼Œå› ä¸ºå·²ç»æœ€ä¼˜äº†ï¼Œæ‰€ä»¥ä¸èƒ½å†åœ¨éæ³•ä¸²ä¸­å¯»æ‰¾ç­”æ¡ˆã€‚åº”è¯¥æ‰¾åˆæ³•å¯¹ä¸­æŸä¸ªå€¼äº¤æ¢ï¼Œæ¯ç»„ä»£ä»·ä¸º <span class="math inline">\(2\)</span>ã€‚å…·ä½“å’Œè°äº¤æ¢æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒï¼Œåªè¦æ‰¾åˆ°ä¸€ç»„ <span class="math inline">\((a_i,a_{n-i+1})\)</span> æ»¡è¶³ <span class="math inline">\(a_i\ne v\)</span> ä¸” <span class="math inline">\(a_{n-i+1}\ne v\)</span> å°±å¯ä»¥äº†ï¼Œç„¶åæˆ‘ä»¬åˆçŸ¥é“ <span class="math inline">\(v\)</span> çš„ä¸ªæ•° <span class="math inline">\(\ne \dfrac n2\)</span>ï¼Œå‡è®¾ <span class="math inline">\(\dfrac n2\)</span> å¯¹ä¸­æ¯é˜Ÿéƒ½æœ‰è‡³å°‘ä¸€ä¸ª <span class="math inline">\(v\)</span>ï¼Œç”±äºå½“å‰è¿™ä¸€å¯¹æœ‰ä¸¤ä¸ªç›¸åŒçš„ <span class="math inline">\(v\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\(v\)</span> çš„ä¸ªæ•°å°±ä¼šå¤§äº <span class="math inline">\(\dfrac n2\)</span>ï¼ŒçŸ›ç›¾äº†ï¼Œæ‰€ä»¥ä¸€å®šèƒ½æ‰¾åˆ°ã€‚</p><p>å¯¹äºéæ³•æ€»å¯¹æ•°æ˜¯å¥‡æ•°çš„æƒ…å†µï¼Œæˆ‘ä»¬è¦é’¦å®šä¸€ä¸ªéæ³•å¯¹å¼ºåˆ¶è®©å…¶å’Œåˆæ³•å¯¹äº¤æ¢ï¼Œè´ªå¿ƒä¸€ä¸‹å–éæ³•å¯¹æ•°é‡æœ€å¤šçš„ <span class="math inline">\(v\)</span> çš„æŸä¸€å¯¹æœ€ä¼˜ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxm = 35;const int maxn = 2e5 + 5;char s[maxn];int cnt[maxm], p[maxn];int T, n, tot, res, now;int main() &#123;    scanf(&quot;%d&quot;, &amp;T);    while (T--) &#123;        tot = 0;        scanf(&quot;%d %s&quot;, &amp;n, s + 1);        if (n &amp; 1) &#123;            puts(&quot;-1&quot;);            continue;        &#125;        memset(cnt, 0, sizeof (cnt));        for (int i = 1; i &lt;= n; ++i)            ++cnt[s[i] - &#39;a&#39; + 1];        for (int i = 1; i &lt;= 26; ++i) &#123;            if (cnt[i] * 2 &gt; n) &#123;                puts(&quot;-1&quot;);                goto noSol;            &#125;        &#125;        memset(cnt, 0, sizeof (cnt));        for (int i = 1; i * 2 &lt;= n; ++i) &#123;            if (s[i] == s[n - i + 1])                ++cnt[s[i] - &#39;a&#39; + 1], ++tot;        &#125;        std::sort(cnt + 1, cnt + 27,                    std::greater&lt;int&gt;());        res = now = 0;        if (tot &amp; 1) &#123;            res = 1, --cnt[1];            std::sort(cnt + 1, cnt + 27,                        std::greater&lt;int&gt;());        &#125;        for (int i = 1; i &lt;= 26; ++i) &#123;            while (cnt[i]--) &#123;                if (++now &gt; tot / 2) &#123;                    if (i == p[now - tot / 2])                        res += 2;                    else ++res;                &#125;                else p[now] = i;            &#125;        &#125;        print(res, &#39;\n&#39;);        noSol: ;    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="c.-é™¤ä¸å‡-divsub">C. é™¤ä¸å‡ divsub</h3><p><a href="http://222.180.160.110:61235/contest/4647/problem/3" class="uri">http://222.180.160.110:61235/contest/4647/problem/3</a></p><p>å°æ•°å­¦ï¼Œè¿˜å¥½ã€‚</p><p>å‡è®¾ <span class="math inline">\(n=d\times k^p\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(k\nmid d\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ†ä¸¤ç§æƒ…å†µè®¨è®ºã€‚</p><ol type="1"><li><p><span class="math inline">\(p=0\)</span>ï¼Œå³ <span class="math inline">\(k\nmid n\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\(n\bmod k=1\)</span>ï¼Œå³ <span class="math inline">\(k\mid (n-1)\)</span>ã€‚</p>è¿™ä¸ªæ—¶å€™é—® <span class="math inline">\(k\)</span> çš„ä¸ªæ•°å°±ç›¸å½“äºæ˜¯åœ¨é—® <span class="math inline">\(n-1\)</span> é™¤ <span class="math inline">\(1\)</span> ä»¥å¤–çš„å› å­ä¸ªæ•°ã€‚å‡è®¾ <span class="math inline">\(n-1={x_1}^{p_1}{x_2}^{p_2}\cdots {x_m}^{p_m}\)</span>ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º <span class="math inline">\((\prod p_i+1)-1\)</span>ï¼Œå‡å»çš„æ˜¯ <span class="math inline">\(1\)</span>ã€‚</li><li><p><span class="math inline">\(p\ne 0\)</span>ï¼Œ<span class="math inline">\(k\mid n\)</span>ã€‚</p><p>è¿™ä¸ªæ—¶å€™å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆå¥½çš„è½¬åŒ–ã€‚å¥½æ¶ˆæ¯æ˜¯ <span class="math inline">\(n\)</span> çš„èŒƒå›´æ˜¯ <span class="math inline">\(10^{12}\)</span>ï¼Œæ ¹å·æšä¸¾å› æ•°å¤æ‚åº¦è·‘å¾—è¿‡ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æš´åŠ›åˆ¤å®š <span class="math inline">\(n\)</span> çš„æ‰€æœ‰å› æ•°æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚</p></li></ol><p>æ—¶é—´å¤æ‚åº¦ï¼Œ<span class="math inline">\(O(\sqrt n\times \log n)\)</span>ï¼Œæšä¸¾å› æ•°æ˜¯æ ¹å·ï¼Œç®—æ¬¡æ•°ï¼ˆä¹Ÿå°±æ˜¯ç®— <span class="math inline">\(d\)</span>ï¼‰æ˜¯ <span class="math inline">\(\log\)</span>ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;int n, m, res, cnt;int main() &#123;    read(n), m = n;    for (int i = 2; i * i &lt;= n; ++i) &#123;        if (n % i == 0) &#123;            m = n;            while (m % i == 0) m /= i;            if (m % i == 1) ++res;            if (i * i != n) &#123;                m = n;                while (m % (n / i) == 0)                    m /= (n / i);                if (m % (n / i) == 1) ++res;            &#125;        &#125;    &#125;    m = n - 1, cnt = 1;    for (int i = 2; i * i &lt;= m; ++i) &#123;        if (m % i == 0) &#123;            int now = 0;            while (m % i == 0)                ++now, m /= i;            cnt *= now + 1;        &#125;    &#125;    if (m != 1) cnt *= 2;    print(res + cnt, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="d.-å›¾ä¹¦ç®¡ç†å‘˜-librarian">D. å›¾ä¹¦ç®¡ç†å‘˜ librarian</h3><p><a href="http://222.180.160.110:61235/contest/4647/problem/4" class="uri">http://222.180.160.110:61235/contest/4647/problem/4</a></p><p>[SDOI2008] éƒé—·çš„å° Jã€‚</p><p>å…³äºè¿™ä¸ªï¼Œæˆ‘ä»¬å‘ç°è‡ªå·±ä¸ä¼šè€ƒåœºç°å†²ä¸»å¸­æ ‘ã€‚å“ï¼Œæ‰“ CDQ åˆæ€•å†™æŒ‚ã€‚</p><p>æˆ‘ä»¬å‘ç°è¿™é“é¢˜çš„ä¿®æ”¹éƒ½æ˜¯å•ç‚¹çš„ï¼Œè¯¢é—®ä¹Ÿåªå…³äºæŸä¸€ç§é¢œè‰²ï¼Œä¸åŒçš„é¢œè‰²ä¹‹é—´æ²¡æœ‰å½±å“ã€‚</p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠæ“ä½œç¦»çº¿ä¸‹æ¥ï¼Œåˆå§‹è§†ä½œå°†æŸé¢œè‰²åœ¨æŸä½ç½®å¢åŠ ï¼Œä¿®æ”¹è§†ä½œå°†æŸé¢œè‰²åœ¨æŸä½ç½®åˆ é™¤ï¼Œå°†å¦ä¸€é¢œè‰²åœ¨è¯¥ä½ç½®å¢åŠ ï¼Œå°†æ‰€æœ‰æ“ä½œæŒ‰é¢œè‰²ç¦»æ•£åŒ–åˆ†ç±»ç„¶å <code>vector</code> ä¸‹æ¥ï¼Œå¯¹äºæ‰€æœ‰é¢œè‰²ä»å‰åˆ°åæ ‘çŠ¶æ•°ç»„åšä¸€éæ“ä½œå°±èƒ½ <span class="math inline">\(O(n\log n+q\log n)\)</span> è§£å†³ã€‚</p><p>æ ‘çŠ¶æ•°ç»„æ¸…ç©ºæ˜¯è‚¯å®šä¸èƒ½ <code>memset</code> çš„ï¼Œå¤æ‚åº¦ä¸å¯¹ã€‚é‚£ä¹ˆæ€ä¹ˆåŠå‘¢ï¼ŸæŠŠæ‰€æœ‰æ“ä½œæ’¤å›å»å°±å¯ä»¥äº†ã€‚</p><p>é¡ºå¸¦ä¸€ææˆ‘æ˜¯æ´›è°·ä¸Šæœ€ä¼˜è§£ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 2e5 + 5;struct __ &#123;    int ty, l, r, v;    __() &#123;&#125;    __(int t1, int l1, int r1, int v1 = 0) &#123;        if (t1 == 0)            ty = 0, l = l1, v = r1;        else ty = 1, l = l1, r = r1, v = v1;    &#125;&#125;;char ty;std::map&lt;int, int&gt; tab;std::vector&lt;__&gt; q[maxn];int n, m, tot, x, y, v, id;int Bit[maxn], a[maxn], res[maxn];int lowbit(int x) &#123; return x &amp; -x; &#125;void add(int x, int v) &#123;    for (; x &lt;= n; x += lowbit(x))        Bit[x] += v;    return;&#125;int ask(int x) &#123;    int res = 0;    for (; x; x -= lowbit(x)) res += Bit[x];    return res;&#125;int main() &#123;    read(n), read(m);    for (int i = 1; i &lt;= n; ++i) &#123;        read(a[i]);        if (!tab.count(a[i]))            tab[a[i]] = ++tot;        a[i] = tab[a[i]];        q[a[i]].emplace_back(0, i, 1);    &#125;    while (m--) &#123;        scanf(&quot;%1s&quot;, &amp;ty);        if (ty == &#39;C&#39;) &#123;            read(x), read(y);            if (!tab.count(y))                tab[y] = ++tot;            y = tab[y];            q[a[x]].emplace_back(0, x, -1);            q[a[x] = y].emplace_back(0, x, 1);        &#125;        else &#123;            ++id;            read(x), read(y), read(v);            if (!tab.count(v)) continue;            v = tab[v];            q[v].emplace_back(1, x, y, id);        &#125;    &#125;    for (int i = 1; i &lt;= tot; ++i) &#123;        for (auto &amp;j : q[i]) &#123;            if (j.ty == 0) add(j.l, j.v);            else &#123;                res[j.v] =                    ask(j.r) - ask(j.l - 1);            &#125;        &#125;        for (auto &amp;j : q[i])            if (j.ty == 0) add(j.l, -j.v);    &#125;    for (int i = 1; i &lt;= id; ++i)        print(res[i], &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><p>E ä¼šå•ç‹¬å¼€ä¸€ç¯‡ã€‚</p><hr /><h3 id="f.-æ ‘-tree">F. æ ‘ tree</h3><p><a href="http://222.180.160.110:61235/contest/4647/problem/6" class="uri">http://222.180.160.110:61235/contest/4647/problem/6</a></p><p>CF916Eã€‚</p><p>å¤§åˆ†è®¨ç»™æˆ‘æ•´ä¸ä¼šäº†ï¼Œæ›´ç»™æˆ‘æ•´ä¸ä¼šçš„æ˜¯ä¸‹æ¥è¿‡åå‘ç°è¿™åªæ˜¯ä¸ªå°åˆ†è®¨ã€‚</p><p>æ›´æ–°å­æ ‘å’Œå­æ ‘æŸ¥è¯¢æˆ‘ä»¬éƒ½ä¼šã€‚æ¢æ ¹ DP æˆ‘ä»¬ä¹Ÿéƒ½å†™è¿‡ï¼Œéƒ½çŸ¥é“æ¢æ ¹å¹¶ä¸ä¼šå¯¹å­æ ‘ç»“æ„äº§ç”Ÿå¤§çš„å½±å“ã€‚æ‰€ä»¥åº”å½“æ˜¯èƒ½æ ¹æ®å·²çŸ¥ä¿¡æ¯æ¨æµ‹å‡ºå­æ ‘åœ¨åŸæ ‘ä¸Šå¯¹åº”çš„ç‚¹é›†çš„ã€‚</p><p>è®° <span class="math inline">\(r\)</span> ä¸ºå½“å‰æ ‘æ ¹ï¼Œ<span class="math inline">\(\text {LCA}(x,y)\)</span> ä¸º <span class="math inline">\(x,y\)</span> åœ¨ <span class="math inline">\(1\)</span> ä¸ºæ ¹æ—¶çš„ LCAï¼Œ<span class="math inline">\(\text {LCA}&#39;(x,y)\)</span> è¡¨ç¤º <span class="math inline">\(x,y\)</span> åœ¨ <span class="math inline">\(r\)</span> ä¸ºæ ¹æ—¶çš„ LCAã€‚</p><p>é‚£ä¹ˆå¯¹äº <span class="math inline">\(\text {LCA}&#39;(x,y)\)</span>ï¼Œè‚¯å®šæ˜¯è¦è®¨è®º <span class="math inline">\(x,y\)</span> å’Œ <span class="math inline">\(r\)</span> çš„ä½ç½®å…³ç³»çš„ã€‚</p><ol type="1"><li><span class="math inline">\(\text {LCA}(x,y)\)</span> æ˜¯ <span class="math inline">\(r\)</span> çš„å­å­™ã€‚æ­¤æ—¶ <span class="math inline">\(\text {LCA}&#39;(x,y) = \text {LCA}(x,y)\)</span>ã€‚</li><li><span class="math inline">\(\text {LCA}(x,y)\)</span> æ˜¯ <span class="math inline">\(r\)</span> çš„ç¥–å…ˆã€‚é‚£ä¹ˆè¯´æ˜è‡³å°‘æœ‰ä¸€ä¸ªç‚¹ä¸æ˜¯ <span class="math inline">\(r\)</span> çš„å­å­™ã€‚æ­¤æ—¶ <span class="math inline">\(\text {LCA}(x,y)&#39;\)</span> çš„å€¼ä¸º <span class="math inline">\(r\)</span> ä¸ºå¦ä¸€ä¸ªç‚¹çš„ LCAã€‚</li></ol><p>æ•´ç†å¯å¾— <span class="math inline">\(\text {LCA}&#39;(x,y)\)</span> æ˜¯ <span class="math inline">\(\text {LCA}(x,y)\)</span>ã€<span class="math inline">\(\text {LCA}(x,r)\)</span> å’Œ <span class="math inline">\(\text {LCA}(y,r)\)</span> ä¸­çš„æ·±åº¦æœ€å¤§è€…ã€‚</p><p>å¯¹äºä»¥ <span class="math inline">\(r\)</span> ä¸ºæ ¹æ—¶çš„å­æ ‘ <span class="math inline">\(x\)</span>ï¼š</p><ol type="1"><li><span class="math inline">\(x=r\)</span>ï¼Œæ­¤æ—¶å­æ ‘ä¸ºæ•´æ£µæ ‘ã€‚</li><li><span class="math inline">\(\text {LCA}(x,r)\ne x\)</span>ï¼Œå³ <span class="math inline">\(r\)</span> ä¸ä¸º <span class="math inline">\(x\)</span> çš„å­å­™ï¼Œæ­¤æ—¶å­æ ‘å°±æ˜¯ä»¥ <span class="math inline">\(1\)</span> ä¸ºæ ¹æ˜¯çš„å­æ ‘ <span class="math inline">\(x\)</span>ã€‚</li><li><span class="math inline">\(\text {LCA}(x,y)=x\)</span>ï¼Œå³ <span class="math inline">\(r\)</span> ä¸º <span class="math inline">\(x\)</span> çš„å­å­™ï¼Œæ­¤æ—¶å­æ ‘æ˜¯æ•´æ£µæ ‘é™¤å¼€ <span class="math inline">\(x\)</span> åŒ…å« <span class="math inline">\(r\)</span> çš„å„¿å­åŠå…¶å­å­™ã€‚ä¿®æ”¹å’ŒæŸ¥è¯¢çš„æ—¶å€™å®¹æ–¥ä¸€ä¸‹å°±å¥½ã€‚è¿™ä¸ªæ—¶å€™çš„å­æ ‘å€å¢è·³ä¸€ä¸‹å°±èƒ½æ‰¾åˆ°ã€‚</li></ol><p>ç„¶åå°±æ˜¯å¸¸è§„çº¿æ®µæ ‘ç»´æŠ¤äº†ã€‚æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\log n)\)</span>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxm = 35;const int maxn = 1e5 + 5;#define lt (p &lt;&lt; 1)#define rt (lt | 1)struct _ &#123; int l, r, u, d; &#125;;_ t[maxn &lt;&lt; 2];int f[maxn][maxm];std::vector&lt;int&gt; g[maxn];int a[maxn], dfn[maxn], rfn[maxn];int n, q, r, ty, x, y, v, si, now;int top[maxn], dep[maxn], tab[maxn];void swap(int &amp;x, int &amp;y) &#123;    x ^= y ^= x ^= y;    return;&#125;void DFS(int x) &#123;    dep[x] = dep[f[x][0]] + 1;    dfn[x] = ++now, tab[now] = x;    for (auto i : g[x]) &#123;        if (i == f[x][0]) continue;        f[i][0] = x;        for (int j = 1; j &lt;= si; ++j)            f[i][j] = f[f[i][j - 1]][j - 1];        DFS(i);    &#125;    rfn[x] = now;    return;&#125;void pushup(int p) &#123;    t[p].u = t[lt].u + t[rt].u;    return;&#125;void pushdown(int p) &#123;    if (t[p].d) &#123;        t[lt].d += t[p].d;        t[rt].d += t[p].d;        t[lt].u += t[p].d *                (t[lt].r - t[lt].l + 1);        t[rt].u += t[p].d *                (t[rt].r - t[rt].l + 1);        t[p].d = 0;    &#125;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r;    if (l == r) &#123;        t[p].u = a[tab[l]];        return;    &#125;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    pushup(p);    return;&#125;void add(int p, int x, int v) &#123;    t[p].u += v;    if (t[p].l == t[p].r) return;    pushdown(p);    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (x &lt;= mid) add(lt, x, v);    else add(rt, x, v);    return;&#125;void add(int p, int l, int r, int v) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        t[p].d += v;        t[p].u += (t[p].r - t[p].l + 1) * v;        return;    &#125;    pushdown(p);    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (l &lt;= mid) add(lt, l, r, v);    if (r &gt; mid) add(rt, l, r, v);    pushup(p);    return;&#125;int ask(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p].u;    pushdown(p);    int res = 0,        mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (l &lt;= mid) res = ask(lt, l, r);    if (r &gt; mid) res += ask(rt, l, r);    return res;&#125;int LCA(int x, int y) &#123;    if (dep[x] &lt; dep[y]) swap(x, y);    for (int i = si; ~i; --i) &#123;        if (dep[f[x][i]] &gt;= dep[y])            x = f[x][i];    &#125;    if (x == y) return x;    for (int i = si; ~i; --i) &#123;        if (f[x][i] != f[y][i])            x = f[x][i], y = f[y][i];    &#125;    return f[x][0];&#125;void Add(int x, int v) &#123;    int rlca = LCA(r, x);    if (x == r) add(1, 1, n, v);    else if (rlca != x)        add(1, dfn[x], rfn[x], v);    else &#123;        add(1, 1, n, v);        int p = r;        for (int i = si; ~i; --i) &#123;            if (dep[f[p][i]] &gt;= dep[x] + 1)                p = f[p][i];        &#125;        add(1, dfn[p], rfn[p], -v);    &#125;    return;&#125;void tAdd(int x, int y, int v) &#123;    int llca = LCA(r, x), rlca = LCA(r, y),        ulca = LCA(x, y);    if (dep[llca] &gt;= dep[rlca] &amp;&amp;        dep[llca] &gt;= dep[ulca]) Add(llca, v);    else if (dep[rlca] &gt;= dep[llca] &amp;&amp;        dep[rlca] &gt;= dep[ulca]) Add(rlca, v);    else Add(ulca, v);    return;&#125;int tAsk(int x) &#123;    int rlca = LCA(r, x);    if (x == r) return t[1].u;    if (rlca != x)        return ask(1, dfn[x], rfn[x]);    int p = r;    for (int i = si; ~i; --i) &#123;        if (dep[f[p][i]] &gt;= dep[x] + 1)            p = f[p][i];    &#125;    return t[1].u - ask(1, dfn[p], rfn[p]);&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;    read(n), read(q), r = 1;    si = log(n) / log(2.0);    for (int i = 1; i &lt;= n; ++i) read(a[i]);    for (int i = 1; i &lt; n; ++i) &#123;        read(x), read(y);        add(x, y), add(y, x);    &#125;    dep[0] = 1, DFS(1), dep[0] = 0;    bld(1, 1, n);    while (q--) &#123;        read(ty);        if (ty == 1) read(r);        else if (ty == 2) &#123;            read(x), read(y), read(v);            tAdd(x, y, v);        &#125;        else &#123;            read(x);            print(tAsk(x), &#39;\n&#39;);        &#125;    &#125;    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
            <tag> æ ‘çŠ¶æ•°ç»„ </tag>
            
            <tag> LCA </tag>
            
            <tag> å€å¢ </tag>
            
            <tag> é¸½å·¢åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TRICKS</title>
      <link href="/20231117/"/>
      <url>/20231117/</url>
      
        <content type="html"><![CDATA[<p>æƒ³ç€å†™ç‚¹ä»€ä¹ˆä¸œè¥¿ï¼Œå°±æ˜¯è¯´ï¼Œä¸ä¼šè¢«å½’å…¥çŸ¥è¯†ç‚¹ï¼ˆupdï¼šå¹¶éä¸ä¼šï¼‰ï¼Œå´åˆæ„Ÿè§‰å¾ˆå¸¸ç”¨ï¼ˆupdï¼šå¹¶éå¸¸ç”¨ï¼‰çš„ä¸œè¥¿ã€‚</p><p>å“¦æˆ‘æ‡‚äº†ï¼Œé€šå¸¸æ¥è¯´æˆ‘ä»¬ç®¡è¿™ä¸ªå« trickã€‚</p><span id="more"></span><hr /><h2 id="ds">DS</h2><details><p><summary><strong>æœ‰ã€åˆå¹¶ã€åŠŸèƒ½çš„ DSï¼š</strong></summary></p><p>å¹¶æŸ¥é›†ï¼Œçº¿æ®µæ ‘ï¼Œ<strong>å­—å…¸æ ‘</strong>ï¼Œç¬›å¡å°”æ ‘ï¼ŒBSTã€‚</p></details><details><p><summary><strong>å¤æ‚åº¦ä¾èµ–ã€å‡æ‘Šã€çš„ DSï¼š</strong></summary></p><p>å¹¶æŸ¥é›†ï¼Œçº¿æ®µæ ‘ / å­—å…¸æ ‘åˆå¹¶ã€‚</p><p><strong>ä¸å¼ºåˆ¶åœ¨çº¿</strong> <strong>å¤æ‚åº¦ä¸ä¾èµ–å‡æ‘Š</strong> çš„å¯æŒä¹…åŒ–æ•°æ®ç»“æ„ <span class="math inline">\(\to\)</span> DAG ä¸Šç›´æ¥æ¨¡æ‹Ÿã€‚</p></details><details><p><summary><strong>éƒ¨åˆ†å¯æŒä¹…åŒ–ï¼š</strong></summary></p><p>åªè¦æ±‚ã€åœ¨æœ€æ–°ç‰ˆæœ¬ä¸Šä¿®æ”¹ã€å’Œã€æŸ¥è¯¢æ‰€æœ‰ç‰ˆæœ¬ã€çš„å¯æŒä¹…åŒ–æ•°ç»„å¯ä»¥åœ¨ <code>vector</code> ä¸ŠäºŒåˆ†ï¼Œåˆå”¤éƒ¨åˆ†å¯æŒä¹…åŒ–ã€‚</p></details><details><p><summary><strong>å­—å…¸æ ‘ç»´æŠ¤äºŒè¿›åˆ¶æ“ä½œï¼š</strong></summary></p><p>å­—å…¸æ ‘çš„èŠ‚ç‚¹ id å¯è§†ä½œå¯¹ä¿¡æ¯çš„å¼•ç”¨ï¼Œä¹Ÿå³ï¼Œå¦‚æœåœ¨åˆæ¬¡æ’å…¥æ—¶è®°å½•äº†æŸä¸ªå…ƒç´ å¯¹åº”çš„ idï¼Œç›¸å½“äºè·å–äº†å…ƒç´ çš„å¼•ç”¨ã€‚</p><ul><li>å•ç‚¹ä¿®æ”¹ï¼šæ‹¿å‡ºæ¥ï¼Œä¿®æ”¹ï¼Œå¡è¿›å»ï¼Œå•æ¬¡ä¿®æ”¹ <span class="math inline">\(O(\log V)\)</span>ã€‚</li><li>å…¨å±€ <code>xor</code>ï¼šæ‰“æ‡’æ ‡è®°ï¼Œå•æ¬¡ä¿®æ”¹ <span class="math inline">\(O(1)\)</span>ã€‚</li><li>å…¨å±€ +1 / -1ï¼šå­—å…¸æ ‘ä¸Šä¿¡æ¯å¿…é¡»ä»ä½ä½åˆ°é«˜ä½å­˜å‚¨ã€‚ç°åœºå¤„ç†ï¼Œï¼ˆå‘ç°åªä¼šé€’å½’ä¸€æ¡é“¾ï¼‰ï¼Œå•æ¬¡ä¿®æ”¹ <span class="math inline">\(O(\log V)\)</span>ã€‚</li></ul></details><details><p><summary><strong>çº¿æ®µæ ‘å¯ç»´æŠ¤çš„ç»å…¸ä¿¡æ¯ï¼š</strong></summary></p><ul><li><p>æ“ä½œï¼šæ’å…¥ / åˆ é™¤åŒºé—´ï¼Œè¯¢é—®ï¼šå€¼åŸŸå†…æœªè¢«è¦†ç›–çš„ç‚¹çš„ä¿¡æ¯ï¼š</p><p>çº¿æ®µæ ‘ç»´æŠ¤èŠ‚ç‚¹å†…è¢«è¦†ç›–æ¬¡æ•°æœ€å°å€¼å’Œæœ€å°å€¼ä¿¡æ¯ï¼›å½“æœ€å°å€¼ä¸º <span class="math inline">\(0\)</span> æ—¶ï¼Œå°†ä¿¡æ¯çº³å…¥ç»Ÿè®¡ã€‚</p>æ‰©ï¼šç»´æŠ¤å€¼åŸŸå†…æ°å¥½è¢«åŒºé—´è¦†ç›– <span class="math inline">\(k\)</span> æ¬¡çš„ç‚¹çš„ä¿¡æ¯ï¼šçº¿æ®µæ ‘ç»´æŠ¤èŠ‚ç‚¹å†…å‰ <span class="math inline">\(k+1\)</span> å°å€¼çš„ä¿¡æ¯ï¼Œåˆ™ <span class="math inline">\(k\)</span> ä¸€å®šå‡ºç°åœ¨å‰ <span class="math inline">\(k+1\)</span> å°å€¼ä¸­ã€‚</li><li><p>çº¿æ®µæ ‘ç»´æŠ¤å‡½æ•°ï¼šå¦‚æœå¯¹äºä»»æ„åŒºé—´ï¼Œéƒ½èƒ½å®šä¹‰ä¸€ä¸ªå®šä¹‰åŸŸä¸ºè¯¥åŒºé—´çš„å‡½æ•°ï¼Œå¯ä»¥çº¿æ®µæ ‘ç»´æŠ¤è¯¥å‡½æ•°ã€‚ç»´æŠ¤çš„æ€»ç‚¹æ•°æ˜¯ <span class="math inline">\(n\log n\)</span> çš„ã€‚</p></li></ul></details><hr /><h2 id="æ•°å­¦">æ•°å­¦</h2><details><p><summary><strong>å¸¸è§æ•°æ®å¯¹åº”çš„æ•°åˆ—ï¼š</strong></summary></p><ul><li><span class="math inline">\(\{1,1,2,3,5,8,\cdots\}\)</span> æ˜¯æ–æ³¢é‚£å¥‘ï¼›çŸ©é˜µå¯ä»¥ä¼˜åŒ–ï¼›ç”Ÿæˆå‡½æ•°å¯ä»¥æ‰¾é€šé¡¹ï¼›<span class="math inline">\(f_i=\sum\limits_{i=0}^nC_n-i^i\)</span>ã€‚</li><li><span class="math inline">\(\{1, 1, 2, 5, 14\cdots\}\)</span> æ˜¯ Catalanï¼Œèµ°ç½‘æ ¼ä¸èƒ½ç©¿è¿‡å¯¹è§’çº¿ / æ„é€ äºŒå‰æ ‘æ–¹æ¡ˆæ•° / ä¸€ç¾¤äººä¹°ç”µå½±ç¥¨ã€‚<a href="/20250419/#ä¸ç»è¿‡-yxc-çš„æ–¹æ¡ˆæ•°">æœ‰ç»„åˆæ±‚æ³• <span class="math inline">\({2n\choose n} - {2n \choose n - 1}\)</span></a>ï¼›ç”Ÿæˆå‡½æ•°è¿˜æ˜¯å¯ä»¥æ‰¾é€šé¡¹ï¼›</li><li><span class="math inline">\(\{3, 7, 6, 15, 25, 10, 31, 90, 65, 15, 63, 301, 350, 140, 21, 127, 966,\cdots\}\)</span>ï¼Œä¸­é—´æ’ç€ä¸€å † <span class="math inline">\(1\)</span>ï¼Œæ˜¯å±•å¼€äº†çš„ç¬¬äºŒç±»æ–¯ç‰¹æ—æ•°ä¸‰è§’å½¢ï¼ŒæŠŠ <span class="math inline">\(n\)</span> ä¸ªä¸åŒçƒï¼Œä¸ç©ºæ”¾ï¼Œæ”¾åˆ° <span class="math inline">\(k\)</span> ä¸ªç›¸åŒç›’å­çš„æ–¹æ¡ˆæ•°ï¼Œæœ‰é€’æ¨å¼ <span class="math inline">\(S(n,k)=S(n-1,k-1)+k\cdot S(n-1,k)\)</span> å’ŒäºŒé¡¹å¼åæ¼”å‡ºæ¥çš„é€šé¡¹ <span class="math inline">\(S(n,m)=\sum\limits_{i=0}^m\dfrac {(-1)^{m-i}\cdot i^n}{i!\cdot (m-i)!}\)</span>ã€‚å¤šé¡¹å¼å¯ä»¥ <span class="math inline">\(n\log\)</span> ç®—åŒä¸€è¡Œ / åˆ—ï¼Œæ–¹æ³•ä¸å¤ªä¸€æ ·ã€‚</li></ul></details><details><p><summary><strong><span class="math inline">\(n\)</span> è¢«å–æ¨¡åçš„ç»„åˆæ•°ï¼š</strong></summary></p><p>å°†åŸå¼å±•å¼€ï¼Œ<span class="math inline">\(\binom nm=\frac 1{m!} \prod\limits_{i=0}^{m-1} (n-i)\)</span>ï¼Œå®¹æ˜“å‘ç° <span class="math inline">\(n\)</span> å–æ¨¡æ˜¯æ²¡æœ‰å½±å“çš„ï¼Œå¦‚æœæ¨¡æ•°å¾ˆå°åˆ™å¯ä»¥é¢„å¤„ç†æ¨¡æ•°èŒƒå›´å†…çš„é˜¶ä¹˜ï¼Œå¦‚æœ <span class="math inline">\(m\)</span> å¾ˆå°åˆ™å¯ä»¥æ¯æ¬¡ <span class="math inline">\(O(m)\)</span> ç°ç®—ã€‚</p><p>åŒç†å¯ä»¥å‘ç° <span class="math inline">\(m\)</span> æ˜¯ä¸èƒ½ç›´æ¥å–æ¨¡çš„ï¼Œå¦‚æœéœ€è¦ç»™ <span class="math inline">\(m\)</span> å–æ¨¡å°±åªèƒ½ç”¨ Lucasã€‚</p></details><details><p><summary><strong><span class="math inline">\(O(V\log V)\)</span> æ±‚æ•°çš„å› æ•°ï¼š</strong></summary></p><p>å‡è®¾ <span class="math inline">\(n=V=5\times 10^6\)</span>ï¼Œé‚£ä¹ˆå¯¹äºæ¯ä¸ªæ•°æš´åŠ›åˆ†è§£å°±æ˜¯ <span class="math inline">\(O(n\sqrt V)\)</span> çš„ï¼Œæ— æ³•é€šè¿‡ã€‚</p><p>åŸƒç­›é¢„å¤„ç†ï¼Œå­˜å‚¨æ¯ä¸ªæ•°çš„æ‰€æœ‰å› æ•°å°±å¯ä»¥ <span class="math inline">\(O(V\log V)\)</span> æ±‚äº†ã€‚</p></details><details><p><summary><strong>æ±‚çº¿æ®µç©¿è¿‡ç›´çº¿ç³»çš„æ¬¡æ•°ï¼š</strong></summary></p><p>æ±‚çº¿æ®µ <span class="math inline">\((x_1,y_1,x_2,y_2)\)</span> ç©¿è¿‡ç›´çº¿ç³» <span class="math inline">\(x+y=k\cdots m(k\in \mathbb{N}^*)\)</span> çš„æ¬¡æ•°ç®—å‡ºçº¿æ®µä¸­ <span class="math inline">\(x+y\)</span> çš„å–å€¼èŒƒå›´ä¹Ÿå³ <span class="math inline">\([x_1+y_1,x_2+y_2]\)</span>ï¼ˆæ–œç‡ä¸ºè´Ÿå°±ä¸åŒäº†ï¼Œä½†å¯ä»¥è¯æ˜éƒ½æ˜¯å•è°ƒçš„ï¼‰ï¼Œæ±‚å‡º <span class="math inline">\(k\cdot m\)</span> åœ¨é‡Œé¢çš„å‡ºç°æ¬¡æ•°å°±å¯ä»¥äº†ã€‚<del>æœ‰çš„äººé«˜ä¸­æ•°å­¦æ¬ çš„å€ºè¦åˆ°ç«èµ›æ¥è¿˜</del></p><p>goto <a href="https://codeforces.com/contest/2098/problem/E">CF2098E</a>ã€‚</p></details><hr /><h2 id="å›¾è®º">å›¾è®º</h2><h3 id="ç»å…¸å»ºæ¨¡">ç»å…¸å»ºæ¨¡</h3><details><p><summary><strong>å·¦éƒ¨ç‚¹åº¦æ•°ä¸º <span class="math inline">\(2\)</span> çš„äºŒåˆ†å›¾åŒ¹é…ï¼š</strong></summary></p><p>ä¸€ç³»åˆ—å…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ æœ‰ä¸è¶…è¿‡ä¸¤ç§å¯é€‰å€¼ï¼Œè¦æ±‚æœ€ç»ˆæ¯ä¸ªå…ƒç´ å€¼ä¸åŒï¼Œæ±‚æ–¹æ¡ˆæ•°ã€‚</p><p>å¯¹æ‰€æœ‰å¯é€‰å€¼å»ºå›¾ã€‚å¦‚æœåªæœ‰ä¸€ä¸ªå¯é€‰å€¼ï¼Œçœ‹ä½œä¸¤ç§å¯é€‰å€¼ç›¸åŒï¼Œè¿è‡ªç¯ï¼›å¦åˆ™æŠŠä¸¤ä¸ªå¯é€‰å€¼è¿è¾¹ã€‚æ­¤æ—¶ä¸€ä¸ªå…ƒç´ å¯¹åº”ä¸€æ¡è¾¹ï¼Œå³å¯¹äºæ¯æ¡è¾¹é€‰ä¸€ä¸ªç«¯ç‚¹ï¼Œæ»¡è¶³æ¯ä¸ªç«¯ç‚¹è¢«é€‰æœ€å¤šä¸€æ¬¡ã€‚</p><p>å¯¹äºæ‰€æœ‰è¿é€šå—ï¼š</p><ul><li>è‹¥ <span class="math inline">\(n&gt;m+1\)</span>ï¼š æ²¡æœ‰è¿™ç§å¯èƒ½æ€§ï¼ˆä¸è¿é€šï¼‰ã€‚</li><li>è‹¥ <span class="math inline">\(n=m+1\)</span>ï¼Œå³è¯¥è¿é€šå—ä¸ºæ ‘ï¼Œä»»é€‰ä¸€ä¸ªç‚¹ä¸é€‰éƒ½èƒ½å”¯ä¸€æ„æˆä¸€ç»„è§£ï¼Œæ–¹æ¡ˆæ•°ä¸º <span class="math inline">\(n\)</span>ã€‚</li><li><p>è‹¥ <span class="math inline">\(n=m\)</span>ï¼Œå³å½¢æˆåŸºç¯æ ‘ï¼š</p><p>ç”±äºç¯ä¸Šç‚¹åªèƒ½ä¸”å¿…é¡»è¢«ç¯ä¸Šè¾¹é€‰ï¼Œæ ‘ä¸Šè¾¹çš„é€‰æ³•å”¯ä¸€ã€‚ä¸»è¦è®¨è®ºç¯è¾¹é€‰æ³•ã€‚</p><ul><li>è‹¥ç¯ä¸ºè‡ªç¯ï¼Œç­”æ¡ˆä¸º <span class="math inline">\(1\)</span>ï¼›</li><li>å¦åˆ™æšä¸¾ç¯ä¸Šæ‰€æœ‰è¾¹æ˜¯ç»Ÿä¸€é€‰é¡º / é€†æ—¶é’ˆæ–¹å‘çš„ç«¯ç‚¹ï¼Œç­”æ¡ˆä¸º <span class="math inline">\(2\)</span>ã€‚</li></ul></li><li><p>è‹¥ <span class="math inline">\(n&lt;m\)</span>ï¼š</p><p>ç‚¹ä¸å¤Ÿç”¨ï¼Œç­”æ¡ˆä¸º <span class="math inline">\(0\)</span>ã€‚</p></li></ul><p>æœ€åæŠŠæ‰€æœ‰è¿é€šå—çš„ç­”æ¡ˆç›¸ä¹˜å°±å¯ä»¥å¾—åˆ°æ€»ç­”æ¡ˆã€‚</p><p>goto <a href="https://vjudge.net/problem/OpenJ_POJ-C19A">Ball</a>, <a href="https://codeforces.com/contest/2097/problem/B">Baggage Claim</a>, <a href="https://atcoder.jp/contests/tkppc6-2/tasks/tkppc6_2_g">Must be Distinct!</a>ã€‚</p></details><details><p><summary><strong>å‡¸å¤šè¾¹å½¢ä¸‰è§’å‰–åˆ†è½¬åŒ–ä¸ºæ ‘ä¸Šé—®é¢˜</strong>ï¼š</summary></p><p>ç»“è®ºï¼šè‹¥æŠŠä¸‰è§’å½¢è§†ä½œ <span class="math inline">\(n-2\)</span> ä¸ªç‚¹ï¼Œåœ¨æœ‰å…¬å…±è¾¹çš„ä¸‰è§’å½¢ä¹‹é—´è¿è¾¹å¯ä»¥å¾—åˆ°æ ‘ã€‚</p><p>è¯æ˜ï¼šæœ‰ <span class="math inline">\(n-3\)</span> æ¡è¾¹ï¼Œæ˜¾ç„¶æ¯æ¡è¾¹éƒ½è¢«ä¸¤ä¸ªä¸‰è§’å½¢å…±ç”¨ï¼›è‡³äºä¸ºä»€ä¹ˆæ˜¯ <span class="math inline">\(n-2\)</span> ä¸ªä¸‰è§’å½¢è¯·ç§»æ­¥è®¡å‡ ã€‚</p><p>ç”Ÿæˆæ–¹æ³•ï¼šæ˜“å‘ç°è‚¯å®šå­˜åœ¨ <span class="math inline">\(\ge 2\)</span> ä¸ªé¡¶ç‚¹ä¸è¢«ä»»ä½•å¯¹è§’çº¿ç»è¿‡ï¼ˆå…¶å±äºä¸€ä¸ªå¶å­ä¸‰è§’å½¢ï¼‰ï¼Œå…¶åº¦æ•°ä¸º <span class="math inline">\(2\)</span>ï¼›ç”¨ç±»ä¼¼æ‹“æ‰‘æ’åºçš„æ–¹å¼ï¼Œä¸æ–­åˆ‡ä¸‹å¶å­ä¸‰è§’å½¢å¹¶å¯»æ‰¾æ–°çš„å¶å­ä¸‰è§’å½¢ï¼Œå°±å¯ä»¥æ‰¾åˆ°æ‰€æœ‰ç‚¹ã€‚æ³¨æ„åˆ°å¯¹è§’çº¿å°±æ˜¯æ ‘è¾¹ï¼Œè®°å½•æ¯æ¡å¯¹è§’çº¿ä¸¤ä¾§çš„ä¸‰è§’å½¢ï¼Œè¿è¾¹å³å¯ã€‚</p><p>goto <a href="/20250612/#b---distance-on-triangulation">solu to <em>Distance on Triangulation</em></a>ã€‚</p></details><h3 id="ä¼˜åŒ–å»ºå›¾">ä¼˜åŒ–å»ºå›¾</h3><details><p><summary><strong>å‰ç¼€å’Œä¼˜åŒ–å»ºå›¾ï¼š</strong></summary></p><p>è¦æ±‚æ¯æ¡è¾¹éƒ½æŒ‡å‘æŸä¸ªå‰ç¼€åŒºé—´ï¼›ä¸çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ç›¸æ¯”çš„ä¼˜åŠ¿æ˜¯è™šç‚¹ã€è¾¹æ•°å‡ä¸º <span class="math inline">\(O(n)\)</span>ã€‚</p><p>Goto <a href="/20250505/">solu to <em>å–é†‰çš„å…”å­</em></a>ã€‚</p></details><h3 id="å›¾ä¸Š-dp">å›¾ä¸Š DP</h3><details><p><summary><strong>æœ‰ç¯å›¾çš„ DP é¡ºåºï¼š</strong></summary></p><p>æœ‰ç¯å›¾ä¸Šçš„ DPï¼Œé€šå¸¸æ¥è¯´å¯ä»¥æ ¹æ®çŠ¶æ€è½¬ç§»æ–¹ç¨‹çš„å½¢å¼æ‰¾åˆ°ç¯ä¸Šçš„ã€Œæ ¹æºã€ï¼Œå³ä¸ç”±ä»»ä½•ç¯ä¸ŠèŠ‚ç‚¹è½¬ç§»å¾—åˆ°ã€‚</p><p>æ— è§†æ ¹æºåœ¨ç¯ä¸Šçš„å‰é©±è¾¹å°±å¯ä»¥ç”¨ç±»æ‹“æ‰‘çš„æ–¹å¼è½¬ç§»ã€‚</p><p>Goto <a href="/20231113/#b.-å•†äºº">solu to å•†äºº</a>ã€‚</p></details><h3 id="æ ‘çš„ç›´å¾„å›¾çš„ç›´å¾„">æ ‘çš„ç›´å¾„ï¼Œå›¾çš„ç›´å¾„</h3><details><p><summary><strong>åŠå¾„ä¸ä¸­ç‚¹çš„å®šä¹‰ï¼š</strong></summary></p><ul><li><strong>åŠå¾„</strong>ï¼šå›¾ / æ ‘çš„åŠå¾„ï¼ˆ<strong>æ•°å€¼ä¸Šä¸º <span class="math inline">\(\min\limits_x\{\max\limits_y dis(x, y)\}\)</span></strong>ï¼‰çš„ä¸€ç«¯ä¸€å®šåœ¨ç›´å¾„ä¸Šï¼Œä¸”åœ¨ç›´å¾„ä¸­é—´ã€‚å¦‚æœä¸å¸¦æƒçš„è¯å°±æ˜¯ç›´å¾„é•¿åº¦çš„ä¸€åŠ <del>ä¸ç„¶ä¸ºå•¥å«åŠå¾„</del>ã€‚</li><li><strong>ä¸­ç‚¹</strong>ï¼šåŠå¾„åœ¨ç›´å¾„ä¸Šçš„ç«¯ç‚¹ï¼Œæœ‰ä¸€ä¸ªï¼ˆç›´å¾„ä¸ºå¥‡ï¼‰æˆ–ä¸¤ä¸ªï¼ˆç›´å¾„ä¸ºå¶ï¼‰ï¼Œå‡æ»¡è¶³åˆ°æ‰€æœ‰ç‚¹çš„è·ç¦»ä¸è¶…è¿‡åŠå¾„ã€‚</li></ul></details><details><p><summary><strong>ç›´å¾„çš„æ€§è´¨ï¼š</strong></summary></p><ul><li><p><strong>å›¾çš„ç›´å¾„çš„æ€§è´¨</strong>ï¼š</p><ol type="1"><li>ä¸èƒ½ç”¨ä¸¤æ¬¡ BFS æ±‚ï¼ŒåŸå› ï¼šå›¾ä¸æ»¡è¶³ã€è·ç¦»ä»»æ„ç‚¹æœ€è¿œçš„ç‚¹éƒ½æ˜¯ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹ã€è¿™æ¡è´ªå¿ƒæ€§è´¨ã€‚</li><li><p>è®¾å›¾çš„ç›´å¾„ä¸º <span class="math inline">\(d\)</span>ï¼Œå¯¹äºä»»æ„ç‚¹ <span class="math inline">\(x\)</span>ï¼Œå…¶å’Œå…¶ä»–ç‚¹æœ€çŸ­è·¯çš„æœ€å¤§å€¼ <span class="math inline">\(s\)</span> æ»¡è¶³ï¼š</p><p><span class="math display">\[\left\lceil \dfrac d2\right\rceil \le s\le d\]</span></p><p>ç­‰ä»·å½¢å¼ï¼š<span class="math inline">\(d\in[s, 2s]\)</span>ã€‚</p>è¯æ˜ï¼šä¸Šç•Œæ˜¾ç„¶ï¼›å¯¹äºä¸‹ç•Œï¼Œå–å›¾ä¸­å¿ƒ <span class="math inline">\(m\)</span>ï¼Œå¯¹ä»»æ„ <span class="math inline">\(x\)</span> æ‰¾åˆ°è·å…¶æœ€è¿œçš„ç‚¹ <span class="math inline">\(y\)</span>ã€‚ç”±æ¾å¼›ï¼Œæ˜¾ç„¶æœ‰ <span class="math inline">\(d(x,y)\le d(x,m)+d(y,m)\)</span>ã€‚åˆ <span class="math inline">\(d(x,m),d(y,m)\le r\)</span>ï¼Œæ•… <span class="math inline">\(d(x,y)\le 2r\)</span>ï¼Œä¹Ÿå³ <span class="math inline">\(d\ge d(x,y)\)</span>ã€‚</li></ol></li><li><p><strong>æ ‘çš„ç›´å¾„çš„æ€§è´¨</strong>ï¼š</p><ol type="1"><li>æ ‘çš„æ‰€æœ‰ç›´å¾„äº¤äºæ ‘çš„æ‰€æœ‰ä¸­ç‚¹ï¼ˆå‚è€ƒåŠå¾„ï¼Œå¦‚æœé•¿åº¦ä¸ºå¶æ•°å°±æ˜¯ä¸¤ä¸ªç‚¹ï¼‰ï¼›</li><li>å‘æ ‘ä¸­åŠ ä¸€ä¸ªå¶å­ï¼Œæœ€å¤šæ”¹å˜ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹ã€‚</li><li>è·ç¦»ä»»æ„ç‚¹æœ€è¿œçš„ç‚¹éƒ½æ˜¯ç›´å¾„çš„ä¸€ä¸ªç«¯ç‚¹ã€‚</li></ol></li></ul></details><details><p><summary><strong>åŠå¾„çš„æ€§è´¨ / ç¦»æ ‘ä¸ŠæŸç‚¹æœ€è¿œçš„ç‚¹ï¼š</strong></summary></p><p>å°†ä¸­å¿ƒè¾¹ï¼ˆè‹¥æœ‰ä¸¤æ¡ä»»é€‰ä¸€æ¡ï¼‰æå‡ºæ¥ï¼Œè®©ä¸¤ä¾§çš„ç‚¹ä½œä¸ºæ ¹ï¼›</p><p><img src="image.png" /></p><p>å¯¹äºä¸€ä¸ªç‚¹ <span class="math inline">\(u\)</span>ï¼Œç¦»å®ƒæœ€è¿œçš„ç‚¹ä¸€å®šåœ¨å¦ä¸€æ£µæ ‘ä¸­æœ€æ·±çš„ä½ç½®ã€‚</p></details><details><p><summary><strong>åŠ¨æ€ç»´æŠ¤æ ‘çš„ç›´å¾„ï¼š</strong></summary></p><p>å¦‚æœçŸ¥é“ä¸€ä¸ªè¿é€šå—å†…çš„ç›´å¾„æ˜¯ <span class="math inline">\(x\to y\)</span>ï¼Œå¦ä¸€ä¸ªæ˜¯ <span class="math inline">\(a\to b\)</span>ï¼Œé‚£ä¹ˆä¸¤ä¸ªåˆå¹¶èµ·æ¥çš„ç›´å¾„ä¸€å®šæ˜¯ <span class="math inline">\(\{x,y,a,b\}\)</span> é‡Œçš„ <span class="math inline">\(C_4^2\)</span>ã€‚</p><p>çº¿æ®µæ ‘ç»´æŠ¤ä¸€æ®µè¿ç»­<strong>æ¬§æ‹‰åº</strong>å†…ï¼ˆä¸ç”¨ DFS åºæ˜¯ä¸ºäº†ä¿è¯è”é€šï¼‰çš„ç›´å¾„å’Œä¸¤ä¸ªç«¯ç‚¹ï¼Œå°±èƒ½è§£å†³åŠ¨æ€åŠ ç‚¹ä¸€ç±»é—®é¢˜ã€‚</p></details><h3 id="æ ‘ä¸Šé—®é¢˜">æ ‘ä¸Šé—®é¢˜</h3><details><p><summary><strong>æ ‘ä¸Šè·¯å¾„é—®é¢˜çš„è§£å†³æ€è·¯ï¼š</strong></summary></p><ol type="1"><li><p>é™æ€é—®é¢˜ï¼š</p><ul><li><p>ä¸è¦æ±‚æ–¹å‘ä¸”èƒ½é¢„å¤„ç†ï¼šæ ‘ä¸Šå·®åˆ†ã€‚</p></li><li><p>è¦æ±‚æ–¹å‘ä¸”èƒ½é¢„å¤„ç†ï¼šå€å¢ã€æ ‘å‰–ï¼ˆå¤šä¸€ä¸ª log ä½†è·‘ä¸æ»¡ï¼›ç»¼åˆæ¥çœ‹æ…¢ä¸€äº›ï¼‰ã€‚</p></li><li><p>ç¦»çº¿ã€è¦æ±‚æ–¹å‘ä¸”ä¸èƒ½é¢„å¤„ç†ï¼š</p><p>æŠŠè¯¢é—®æŒ‚åœ¨ <span class="math inline">\(u\)</span> å’Œ LCA ä¸Šï¼Œç¬¬ä¸€é DFS æŠŠ <span class="math inline">\(u\to\)</span> LCA çš„ç­”æ¡ˆè®¡ç®—å‡ºæ¥ï¼ˆéœ€è¦å¯åˆå¹¶ä¿¡æ¯ï¼‰ï¼Œç¬¬äºŒé DFS åˆ©ç”¨å›æº¯æŠŠ LCA <span class="math inline">\(\to v\)</span> çš„ç­”æ¡ˆè®¡ç®—å‡ºæ¥ã€‚</p>goto <a href="/20250809/#a---è®°å¿†">solu to <em>è®°å¿†</em></a>ã€‚</li></ul></li><li><p>åŠ¨æ€é—®é¢˜ï¼šæ ‘å‰–ã€‚</p></li></ol></details><hr /><h2 id="dp">DP</h2><details><p><summary><strong>è½®å»“çº¿ DP / é€æ ¼çŠ¶å‹ DPï¼š</strong></summary></p><p>å¯¹äºæ£‹ç›˜ä¸Šçš„çŠ¶å‹ DPï¼Œå¦‚æœæŸæ ¼å†…å®¹çš„é™åˆ¶åªæ¥è‡ªç›¸é‚»çš„æ ¼å­ï¼ˆè¿™æ˜¯å¤§éƒ¨åˆ†æ£‹ç›˜é—®é¢˜èƒ½å¤Ÿæ»¡è¶³çš„ï¼‰ï¼Œå¯ä»¥è€ƒè™‘è½®å»“çº¿ DPã€‚</p><p>å…·ä½“æ¥è¯´ï¼ŒæŒ‰ç…§é€šå¸¸çš„ä»ä¸Šåˆ°ä¸‹ã€ä»å·¦åˆ°å³ DP çš„æ€è·¯ï¼Œå¯¹äºæŸä¸€æ ¼ï¼Œå‘ç°å½±å“åˆ°å®ƒçš„åªæœ‰å·¦ä¾§å’Œä¸Šæ–¹çš„çŠ¶æ€ï¼›è¿™æ—¶æˆ‘ä»¬é€šå¸¸ä¼šä¿å­˜ä¸Šä¸€è¡Œæ‰€æœ‰çŠ¶æ€ï¼Œä½†å‘ç°å·¦ä¸Šä¾§æ ¼å­åŠä»¥å‰çš„çŠ¶æ€æ˜¯æ— ç”¨çš„ï¼Œåè€Œå·¦è¾¹çš„çŠ¶æ€æ˜¯æœ‰ç”¨çš„ã€‚æ•…è®°å½•æ¯ä¸€åˆ—æœ€é ä¸‹çš„å·²ç¡®å®šçŠ¶æ€ï¼Œå°±å¯ä»¥å®Œæˆ DPã€‚</p><p>goto <a href="/20250805/#d---count-grid-3-coloring">solu to <em>Count Grid 3-coloring</em></a>ï¼Œ<a href="/20250805/#f---123-set">solu to <em>123 Set</em></a>ã€‚</p><p>å¯¹äº <span class="math inline">\(2\times 1\)</span> éª¨ç‰Œæ”¾ç½®é—®é¢˜ï¼Œå¯ä»¥è®¾ã€ä¸ŠåŠç‰‡ã€ä¸º <code>1</code>ï¼Œå…¶ä½™ä¸º <code>0</code>ï¼Œå¯¹äºæ¨ªå‘éª¨ç‰Œé€äºŒæ ¼ç¡®å®šã€‚è¿™æ ·å°±èƒ½å‘ç°ï¼Œè½®å»“çº¿ DP å¹¶ä¸ä¸€å®šåªæœ‰åœ¨å·¦ä¾§æœ‰é™åˆ¶çš„æ—¶å€™æ‰èƒ½ç”¨ï¼Œå› ä¸º<strong>è®°å½•å·¦ä¾§çŠ¶æ€ä¹Ÿæ˜¯åœ¨å®ŒæˆçŠ¶æ€çš„è½¬ç§»</strong>ã€‚</p></details><details><p><summary><strong>ã€è´¡çŒ®ã€çš„æ€æƒ³ï¼š</strong></summary></p><p>ç”¨ä¹˜æ³•åˆ†é…ç‡å°†å¼å­æ‹†å¼€ï¼Œå³ã€åˆ†ç±»ã€ï¼Œè¿™æ—¶å¯èƒ½ä¼šå‘ç°ã€åˆ†æ­¥ã€è¿™ä¸€æ­¥æ¯”åŸæ¥æ›´å¥½åšã€‚</p><p>æ›´å…·è±¡åœ°ï¼Œå¯¹äºã€åˆ†æ­¥ã€ä¸­çš„æŸä¸€æ­¥ï¼Œå°†ã€ç±»åˆ«ã€çš„å…¨é›†åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå­é›†ï¼Œå‘ç°é™¤æ­¤ä¹‹å¤–çš„éƒ¨åˆ†å¯èƒ½å¯ä»¥æ›´æ–¹ä¾¿åœ°è®¡ç®—ã€‚å¦‚æœèƒ½æ‰¾åˆ°è¿™æ ·ä¸€ç§ç®€å•çš„å‡è£‚æˆ–å¼‚è£‚çš„æ–¹å¼ï¼Œä½¿å¾—æ¯ä¸€ã€ç±»ã€çš„ã€å•æ­¥ã€ä»·å€¼èƒ½å¤Ÿç¡®å®šï¼Œå°±èƒ½è€ƒè™‘ç”¨ã€è´¡çŒ®ã€è®¡ç®—ã€‚</p><p>ç‰¹åˆ«åœ°ï¼Œå¯¹äºä¸€ä¸ªå­é›†ï¼Œå¦‚æœå…¶ä»–æ­¥éª¤å¯¹å®ƒçš„ä»·å€¼æ²¡æœ‰å½±å“ï¼Œå…¶è´¡çŒ®å¾€å¾€ä¼šè¡¨ç°ä¸ºå¹‚æ¬¡å½¢å¼ã€‚</p><p>Goto <a href="/20250803/#b---one-to-one">solu to <em>One to One</em></a>ï¼Œ<a href="/20250407/#e---kdoi-11å½©ç¯æ™šä¼š">solu to <em>å½©ç¯æ™šä¼š</em></a></p></details><details><p><summary><strong>æƒ³è¦ç­›é€‰å‡ºç‰¹å®šä¸€ã€ç±»ã€çš„çŠ¶æ€ / ä¸åŒã€åˆ†ç±»ã€å¯¹åº”ä¸åŒã€åˆ†æ­¥ã€æ—¶çš„å¤„ç†æ–¹æ³•ï¼š</strong></summary></p><p>å¦‚æœç±»åˆ«æ¯”è¾ƒå°‘ï¼Œå°†ç±»åˆ«æ”¾åˆ°ç»´åº¦é‡Œï¼ˆä¾‹ï¼šå¦‚æœå­˜åœ¨äºŒè¿›åˆ¶è¿ç®—åˆ™å¯ä»¥æ‹†ä½ï¼Œåˆ™ç±»åˆ«ä¸º 0/1 ä¸¤ç±»ï¼‰ï¼Œåˆ†åˆ«å¤„ç†ã€‚</p><p>çœ‹èµ·æ¥å¾ˆæ˜¾ç„¶ï¼Œä½†ç¡®å®æ˜¯å¾ˆå¤šçŠ¶æ€è®¾è®¡çš„éš¾ç‚¹ã€‚</p></details><details><p><summary><strong>å¤šé‡é›†çš„ç»„åˆæ•°</strong></summary></p><p>ä¸»è¦è¦æ±‚èƒ½å¤Ÿè®¤è¯†åˆ°æ­£åœ¨åº”ç”¨è¯¥æ¨¡å‹ã€‚</p><p>å½“ <span class="math inline">\(n,m\)</span> å¾ˆå°è€Œ <span class="math inline">\(c_i\)</span> å¾ˆå¤§æ—¶ï¼š</p><ul><li><p>æœ´ç´ åœ°ï¼Œè®¾ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(i\)</span> å¤„å¡«äº† <span class="math inline">\(\le j\)</span> çš„æ•°ï¼ˆå¯ä»¥æ„è¯†åˆ°éœ€è¦å‰ç¼€å’Œï¼‰ï¼Œå¦‚æœåªå…³æ³¨å½“å‰ä½æ˜¯ä¸èƒ½åšçš„ï¼Œè€ƒè™‘æšä¸¾å¡«äº†å¤šå°‘ä¸ª <span class="math inline">\(j\)</span>ï¼Œå¯ä»¥å¾—åˆ° <span class="math inline">\(f_{i,j}=\sum_k f_{i-k,j-1}\)</span>ã€‚æ³¨æ„ <span class="math inline">\(k\)</span> å¯ä»¥å–åˆ° <span class="math inline">\(0\)</span>ï¼Œä»æ•°å€¼ä¸Šæ¥çœ‹æ°å¥½æ˜¯å¯¹çš„ã€‚</p>å¦‚æœè®¤ä¸ºä¸€ä¸ªå¤šé‡é›†ä¸­çš„å…ƒç´ æ˜¯æœ‰å·®å¼‚çš„ï¼Œè¿˜å¯ä»¥ä¹˜ä¸Š <span class="math inline">\(\binom {c_j}k\)</span>ã€‚</li><li>å¦‚æœä¿è¯ <span class="math inline">\(n\le c_i\)</span>ï¼Œä¸”é¢˜ç›®æ²¡æœ‰å…¶ä»–é™åˆ¶æ—¶ï¼Œå‘ç°åŸé—®é¢˜ç­‰ä»·äº <span class="math inline">\(x_1+x_2+\cdots +x_m=n\)</span> çš„éè´Ÿæ•´æ•°è§£æ•°ç›®ï¼Œæ’æ¿æ³•è§£å†³ã€‚</li><li><p>åœ¨ä¸Šä¸€ç§æ–¹å¼çš„åŸºç¡€ä¸Šï¼Œå¦‚æœæ²¡æœ‰äº† <span class="math inline">\(n\le c_i\)</span> çš„é™åˆ¶ï¼Œæ˜“å‘ç°å®¹æ–¥ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚</p></li></ul></details><details><p><summary><strong>ä¸å­—å…¸åºæœ‰å…³çš„çŠ¶æ€è®¾è®¡ï¼š</strong></summary></p><p>è¦æ±‚å­—å…¸åºå¤§äº / å°äºç»™å®šå€¼çš„æ–¹æ¡ˆæ•°ï¼Œè€ƒè™‘ä½¿ç”¨ <span class="math inline">\(f_i\)</span> è¡¨ç¤º <span class="math inline">\(1\sim i\)</span> å…¨éƒ¨å’Œç»™å®šå€¼ç›¸åŒï¼Œ<span class="math inline">\(i+1\)</span> å¤§äº / å°äºç»™å®šå€¼ï¼Œåé¢æ— é™åˆ¶çš„æƒ…å†µæ€»æ•°ã€‚</p><p>Goto <a href="http://222.180.160.110:61235/contest/5423/problem/2">å†’æ³¡æ’åº</a>ã€‚</p></details><ul><li>è®¡æ•° DP å’Œå®¹æ–¥çš„é€‰æ‹©ã€‚</li><li><p>ï¼ˆå®¹æ–¥ï¼‰ç¢°åˆ°äº†ã€Œèµ·ç‚¹çŠ¶æ€åˆ°ç»ˆç‚¹çŠ¶æ€ï¼Œä¸­é—´ä¸èƒ½ç»è¿‡ä¸€äº›éæ³•çŠ¶æ€çš„æ–¹æ¡ˆæ•°ã€ï¼Œå¯ä»¥ç”¨ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºä»èµ·ç‚¹ï¼Œä¸ç»è¿‡ <span class="math inline">\(1\sim i-1\)</span> çš„éæ³•çŠ¶æ€ï¼Œåˆ°è¾¾éæ³•çŠ¶æ€ <span class="math inline">\(i\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œæœ€åå°†ç»ˆç‚¹çŠ¶æ€ä¹Ÿè§†ä¸ºä¸€ä¸ªéæ³•çŠ¶æ€å¹¶ DP å³å¯ã€‚</p>Goto <a href="/20231113/#a---gerald-and-giant-chess">solu to <em>Gerald and Giant Chess</em></a>ï¼Œ<a href="https://www.cnblogs.com/XSC062/p/17330225.html">solu to <em>ä¸¤åŒæ‰‹</em></a>ã€‚</li><li><p>æ±‚æ–¹æ¡ˆæ•°ï¼Œå¦‚æœç”¨é€šå¸¸çš„ã€Œè€ƒè™‘æ»¡è¶³æ¡ä»¶çš„æƒ…å†µå¹¶è½¬ç§»ã€ï¼Œå°±å¿…é¡»èƒ½å¤Ÿç®€å•åœ°å¯¹æ¡ä»¶è¿›è¡Œåˆ¤å®šã€‚</p><p>å¦‚æœè¿™ä¸€ç‚¹åšä¸åˆ°ï¼Œå¯ä»¥è€ƒè™‘ä»æœ€ç®€å•æˆ–æœ€æé™æƒ…å†µå‡ºå‘å……è¦ä¸”ä¸é‡åœ° <strong>æ„é€ </strong> å‡ºä¸€èˆ¬æƒ…å†µï¼Œå¹¶è®¡ç®—ç›¸åº”çš„æ–¹æ¡ˆæ•°ã€‚</p>goto <a href="/20230716/">solu to <em>æŸ“è‰²</em></a>ã€‚</li><li><p>å¦‚æœæœ‰è½¬ç§»ä¼šæœ‰åæ•ˆæ€§ä¸å¦¨è€ƒè™‘æ˜¯å¦æœ‰å‰æ•ˆæ€§ç„¶åé€†åº DPã€‚</p><p>ä¾‹å¦‚æ±‚å­—å…¸åºæœ€å°çš„ç­”æ¡ˆï¼šåªçŸ¥é“æœ€åä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ¨æ–­å‡ºè°çš„å­—å…¸åºæœ€å°ã€‚ä½†å¦‚æœçŸ¥é“æœ€å¼€å¤´ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶ä¿è¯ä»åå¾€å‰å¡«è¡¨çš„æ¯ä¸€æ­¥éƒ½èµ°çš„æœ€å°å°±èƒ½å¤Ÿç¡®å®šã€‚</p>goto <a href="/20230716-1/">solu to <em>åŒ¹é…æ•°</em></a></li><li><p id="1">çŠ¶æ€æ‹†åˆ†æŠ€å·§ã€‚æ¯”å¦‚çŠ¶æ€ ABC ä¸ä¸€å®šè¦ä»çŠ¶æ€ Aã€çŠ¶æ€ Bã€çŠ¶æ€ C åˆ†åˆ« <span class="math inline">\(O(m)\)</span> çš„è½¬ç§»ï¼Œè€Œå¯ä»¥ä» A å’Œ BC ä»¥ <span class="math inline">\(O(1)\)</span> å®Œæˆè½¬ç§»ã€‚</p><p>Goto <a href="/20231003/#f.-å•è¯">solu to <em>å•è¯</em></a>ã€‚</p></li></ul><h3 id="å…³äºèƒŒåŒ…">å…³äºèƒŒåŒ…</h3><details><p><summary><strong>å­åºåˆ—é—®é¢˜è½¬åŒ–ä¸ºèƒŒåŒ…é—®é¢˜ï¼š</strong></summary></p><p>å­åºåˆ—é—®é¢˜ï¼ˆä¸ä»…æ˜¯ + &amp; minï¼Œä¹Ÿå¯ä»¥æ˜¯ xorã€åŠ  &amp; æ¨¡ç­‰ï¼‰å¯ä»¥è½¬åŒ–ä¸ºèƒŒåŒ…é—®é¢˜ï¼›å¯¹ä¸€ä¸ªåŒºé—´åšèƒŒåŒ…ï¼Œå¯ä»¥æŠŠåŒºé—´åˆ’åˆ†æˆè‹¥å¹²æ®µï¼Œæ¯æ®µåšèƒŒåŒ…ï¼Œå†ä¾æ¬¡ <span class="math inline">\(O(v^2)\)</span> åœ°åˆå¹¶ã€‚</p><p>ã€åˆ’åˆ†ã€çš„ä¸€ä¸ªå…¸å‹åœºæ™¯æ˜¯æ‰¾ã€åˆ†å‰²çº¿ã€ï¼Œç„¶åå‘å·¦å‘å³åˆ†åˆ«åšèƒŒåŒ…â€”â€”è¿™ä¹ˆåšçš„ä¼˜ç‚¹æ˜¯ï¼Œå¯¹äºä»»æ„ç©¿è¿™æ¡åˆ†å‰²çº¿çš„åŒºé—´ï¼Œä½ éƒ½èƒ½ <span class="math inline">\(O(v^2)\)</span> å¾—åˆ°æ‰€æœ‰çš„èƒŒåŒ…ä¿¡æ¯ã€‚ç”šè‡³ï¼Œå¦‚æœä½ åªéœ€è¦æ±‚æŸä¸ªç‰¹å®šä½“ç§¯ä¸‹çš„ç­”æ¡ˆï¼Œåªéœ€è¦ <span class="math inline">\(O(v)\)</span> æšä¸¾ã€‚</p><p>goto <a href="https://loj.ac/p/6515">è´ªç©è“æœˆ</a>ã€‚</p></details><details><p><summary><strong>ç¦»çº¿èƒŒåŒ…ç»“åˆåˆ†æ²»ï¼š</strong></summary></p><p>èƒŒåŒ…å¯ä»¥çœ‹ä½œä¸€ç§ +/min å·ç§¯ï¼šåœ¨ä½“ç§¯ç»´ä¸ŠåšåŠ æ³•ã€åœ¨ä»£ä»·ç»´ä¸Šåš minã€‚å½“ç„¶å…¶ä»–æ“ä½œå¦‚ä½“ç§¯ç»´ä¸Šçš„ xorã€åŠ æ¨¡ï¼›ä»£ä»·ç»´ä¸Šçš„æ–¹æ¡ˆæ•°éƒ½å·®ä¸å¤šã€‚</p><p>å› æ­¤ï¼Œå¤šæ¬¡åŒºé—´è¯¢é—®ï¼ˆç¦»çº¿ï¼‰çš„èƒŒåŒ…å¯ä»¥ç»“åˆåˆ†æ²»â€”â€”åŸå› æ˜¯ä»æ¯ä¸ª <span class="math inline">\(l\)</span> å¼€å§‹åšä¸€æ¬¡èƒŒåŒ…æ˜¯ä¸ç°å®çš„ï¼Œè€Œæˆ‘ä»¬å‘ç°åˆ†å‰²çº¿æ˜¯å¯ä»¥å…±ç”¨çš„â€”â€”åˆ†å‰²çº¿ä»£è¡¨çš„èƒŒåŒ…ä¿¡æ¯ä¹Ÿæ˜¯å¯ä»¥å…±ç”¨çš„ã€‚</p><p>æ‰€ä»¥éœ€è¦æ‰¾åˆ°ä¸€ç§ã€æ‰¾åˆ†å‰²çº¿ã€å’Œã€ä¸€æ¡åˆ†å‰²çº¿æ±‚è§£çš„èŒƒå›´ã€çš„æ–¹æ³•ï¼Œä½¿å¾—è§„å®šå¤æ‚åº¦å†…èƒ½å¤Ÿæœ€å¤§åŒ–åˆ©ç”¨ã€å…¬å…±ä¿¡æ¯ã€ã€‚åˆ†æ²»çš„ï¼ˆç±»çº¿æ®µæ ‘çš„ï¼‰ç»“æ„å°±æ˜¯ä¸€ç§æå¥½çš„æ–¹å¼ï¼Œåœ¨ä¸€å±‚åˆ†æ²»å†…è§£å†³æ‰€æœ‰åœ¨ <span class="math inline">\([l,r]\)</span> èŒƒå›´å†…ï¼Œä¸”è·¨è¶Š <span class="math inline">\(mid\)</span> çš„è¯¢é—®ï¼Œè¿™æ ·å°±èƒ½ä» <span class="math inline">\(mid\)</span> å‡ºå‘ï¼Œå‘å·¦åˆ° <span class="math inline">\(l\)</span>ï¼Œå‘å³åˆ° <span class="math inline">\(r\)</span> æ±‚è§£èƒŒåŒ…ã€‚</p><p>goto <a href="/20250520/#cf2043f-nim">solu to CF2043F</a>ã€‚</p></details><details><p><summary><strong>æ ‘ä¸ŠèƒŒåŒ…åºåˆ—åŒ–ï¼š</strong></summary></p><p>æ³¨æ„åˆ°å¯¹äºä»»ä½•ç±»å‹çš„èƒŒåŒ…ï¼Œæ ‘ç»“æ„å¤æ‚åº¦ä¸ä¼˜äºåºåˆ—ç»“æ„ã€‚ä»…æœ‰ç‰©å“ä½“ç§¯ä¸º <span class="math inline">\(1\)</span> çš„ 01 èƒŒåŒ…å¯ä»¥ç”¨æŠ€å·§ä¼˜åŒ–åˆ°ç›¸åŒå¤æ‚åº¦ã€‚</p><p>åˆ©ç”¨ DFS åºè¿›è¡Œå¡«è¡¨ï¼Œè‹¥ä¸é€‰æŸä¸ªç‚¹ï¼Œç›¸å½“äºä¸é€‰å…¶å¼•å¯¼çš„ä¸€æ•´ä¸ªå­æ ‘ DFS åºåŒºé—´ã€‚å…¶ä½™å’Œåºåˆ—èƒŒåŒ…ä¸€è‡´ã€‚</p><p>Goto <a href="/20250612/#c---shopping">solu to <em>Shopping</em></a>ã€‚</p></details><details><p><summary><strong>éšæœºåºåˆ—çš„èƒŒåŒ…ï¼š</strong></summary></p><p>æœ‰ç»“è®ºï¼šä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„ <span class="math inline">\(1/-1\)</span> éšæœºåºåˆ—çš„å‰ç¼€å’Œç¦» <span class="math inline">\(0\)</span> çš„è·ç¦»æœŸæœ›ä¸è¶…è¿‡ <span class="math inline">\(\sqrt n\)</span>ã€‚</p><p>æ‹“å±•ä¸€ä¸‹ï¼Œåœ¨ä¿è¯å€¼åŸŸå†…åˆ†å¸ƒå‡åŒ€çš„æ•´æ•°åŸŸå†…èƒŒåŒ…ï¼Œåœ¨ <code>random_shuffle</code> åå®é™…æœ€å¤§çŠ¶æ€ä¸å¤ªä¼šè¶…è¿‡ <span class="math inline">\(\sqrt V\)</span>ã€‚</p><p>å› ä¸ºç»“è®ºå¾ˆæ¾ï¼Œæ‰€ä»¥è¿æ°”æ¯”è¾ƒå¥½çš„æ—¶å€™ç”šè‡³ä¸ä¼šè¶…è¿‡ <span class="math inline">\(\log V\)</span>ã€‚</p></details><hr /><h2 id="å“ˆå¸Œ">å“ˆå¸Œ</h2><details><p><summary><strong>å“ˆå¸Œä¸­å…¨ç­‰æ¡ä»¶çš„åº”ç”¨ / å“ˆå¸Œä¸å‰ç¼€ä¿¡æ¯çš„å…³è”ï¼š</strong></summary></p><p>æœ‰çš„åŒºé—´é—®é¢˜çš„åˆ¤å®šæ¡ä»¶å¯ä»¥è½¬åŒ–ä¸ºéƒ¨åˆ†å‰ç¼€ä¿¡æ¯çš„å…¨ç­‰ã€‚</p><p>ä¾‹ï¼šè¦æ±‚åŒºé—´å†…æ¯ä¸ªæ•°å‡ºç°æ¬¡æ•°ä¸º <span class="math inline">\(3\)</span> çš„å€æ•°ï¼Œè½¬åŒ–ä¸ºï¼šä»¤ <span class="math inline">\(cnt_{i,j}\)</span> è¡¨ç¤ºå‰ <span class="math inline">\(i\)</span> ä¸ªæ•°ä¸­ <span class="math inline">\(j\)</span> å‡ºç°æ¬¡æ•° <span class="math inline">\(\bmod3\)</span> çš„å€¼ï¼Œåˆ™è¦æ±‚å·¦å³ç«¯ç‚¹è¯¥å€¼å…¨ç­‰ã€‚</p><p>Goto <a href="https://www.luogu.com.cn/article/5reynyzi">Three Occurrences</a>ã€‚</p></details><details><p><summary><strong>xor hashï¼š</strong></summary></p><p>ä½¿ç”¨äºå¼‚æˆ–åˆ¤æ–­æ¬¡æ•°å¥‡å¶æ€§ / å…ƒç´ å­˜åœ¨æ€§çš„å“ˆå¸Œã€‚</p><p>åŒºé—´é‡Œæ¯ä¸ªå€¼å‡ºç°æ¬¡æ•°éƒ½æ˜¯å¶æ•°çš„å¿…è¦æ¡ä»¶æ˜¯åŒºé—´å¼‚æˆ–èµ·æ¥ä¸º <span class="math inline">\(0\)</span>ã€‚è¯¥ç»“è®ºä¸å……åˆ†ï¼š<span class="math inline">\(1\oplus 2\oplus 3=0\)</span>ã€‚</p><p>æŠŠæ¯ä¸ªæ•°éƒ½å“ˆå¸Œæˆä¸€ä¸ªéšæœºå¤§æ•°ï¼ˆæ¯”å¦‚ ullï¼‰ï¼Œå†²çªçš„æ¦‚ç‡å°±ä¼šå˜æˆ <span class="math inline">\(2^{-64}\)</span>ã€‚</p><p>Goto <a href="https://www.luogu.com.cn/article/ugg047a7">NOI2024 D1T1</a>ï¼Œ<a href="/20221010/">solu to <em>åšå¼ˆ</em></a>ã€‚</p></details><hr /><h2 id="äºŒåˆ†">äºŒåˆ†</h2><hr /><h2 id="å…³äºæœ€å€¼">å…³äºæœ€å€¼</h2><h3 id="å…³äºå†’æ³¡æ’åº">å…³äºå†’æ³¡æ’åº</h3><p><em>ã€å†’æ³¡æ’åºæœ‰ä¸€ç§è¢«å‡ºçƒ‚ä½†æ˜¯æ¯æ¬¡ç¢°åˆ°æˆ‘éƒ½ä¸ä¼šçš„ç¾æ„Ÿã€‚ã€â€”â€”wosile</em></p><p><em>è¿™ä¸ªäººæˆ‘ä¸è®¤è¯†ï¼Œä½†æ˜¯æˆ‘è§‰å¾—è¿™å¥è¯è¯´å¾—å¤ªå¥½äº†ï¼</em></p><ul><li><p>ä¸€è½®å†’æ³¡æ’åºåšçš„äº‹æƒ…ï¼šå°†åºåˆ—æŒ‰å‰ç¼€æœ€å¤§å€¼ä¸ºæ®µé¦–åˆ’åˆ†ä¸ºè‹¥å¹²æ®µï¼Œå¹¶æŠŠå…¶ç§»åˆ°æ®µæœ«ã€‚</p>goto <a href="/20250510/#c---1-loop-bubble-sort">1 Loop Bubble Sort</a>ã€‚</li><li><p>å‰ç¼€æœ€å¤§å€¼åœ¨ä¸€è½®å†’æ³¡æ’åºåä»æ˜¯å‰ç¼€æœ€å¤§å€¼ã€‚</p></li></ul><details><p><summary>æ±‚æŸä¸‹æ ‡åœ¨åºåˆ—æ‰€æœ‰çš„ LIS ä¸­å‡ºç°æ¬¡æ•°ï¼š</summary></p><p>åˆ†åˆ«ç»Ÿè®¡ä»¥å…¶ç»“å°¾å’Œå¼€å¤´çš„ LIS é•¿åº¦ä¸æ¬¡æ•°ï¼Œå¦‚æœåŠ èµ·æ¥æ˜¯åºåˆ— LIS çš„é•¿åº¦ï¼Œé‚£ä¹ˆæ¬¡æ•°ç›¸ä¹˜å°±æ˜¯ç­”æ¡ˆã€‚</p></details><h2 id="æ‚é¡¹">æ‚é¡¹</h2><details><p><summary><strong>å¸¸ç”¨ä½å¤æ‚åº¦åº“å‡½æ•° / æ¯”æ‰‹å†™å¤æ‚åº¦æ›´ä½çš„åº“å‡½æ•°ï¼š</strong></summary></p><ul><li><code>__builtin_clz</code> / <code>__builtin_ctz</code>ï¼šç»Ÿè®¡äºŒè¿›åˆ¶å¼€å¤´ / æœ«å°¾ <span class="math inline">\(0\)</span> çš„ä¸ªæ•°ï¼Œé€šå¸¸æ˜¯ç¡¬ä»¶æŒ‡ä»¤ï¼Œç¡¬ä»¶ä¸æ”¯æŒåˆ™ä¼šé‡‡ç”¨æ©ç  <span class="math inline">\(O(1)\)</span> å¾—åˆ°ç»“æœã€‚</li><li><code>__builtin_popcount</code>ï¼šåŒä¸Šã€‚</li><li><p><code>sqrt</code>ï¼šäº‰è®®å¾ˆå¤§ï¼Œä½†äº‹å®æ˜¯å¯¹äºæ‰€æœ‰æ•°æ®æœ€å¤šè¿­ä»£ <span class="math inline">\(6\)</span> æ¬¡ï¼Œå®é™…è¡¨ç°æ¥è¿‘å•æ¬¡æµ®ç‚¹ä¹˜æ³•æ“ä½œï¼Œæ•…ä¸º <span class="math inline">\(O(1)\)</span>ã€‚</p><p>æ­¤å¤„å€¼å¾—è¯´æ˜çš„æ˜¯ï¼Œ<code>&lt;cmath&gt;</code> ä¸­çš„å¯¹æ•°å‡½æ•°åŒæ ·ä¸ºå¸¸æ•°å¤æ‚åº¦ï¼Œä½†è¢«è§‚æµ‹åˆ°å®é™…è¡¨ç°æ—¶å¸¸æ•°è¾ƒå¤§ï¼Œè·‘ 1e6 æ¬¡å°±å·²ç»å¾ˆå±é™©äº†ã€‚</p>å¦‚æœéœ€è¦å¯¹ <span class="math inline">\(2\)</span> å–å¯¹æ•°ï¼Œä½¿ç”¨ <code>std::__lg</code> ä»£æ›¿ï¼ˆå…¶å®ç°ä¸º <code>31 - __builtin_clz(x)</code>ï¼‰ã€‚</li><li><p><code>std::nth_element</code>ï¼šå¯ä»¥ <span class="math inline">\(O(n)\)</span> æ‰¾åˆ°ç¬¬ <span class="math inline">\(k\)</span> å¤§å…ƒç´ ï¼ˆæ”¾åœ¨ç¬¬ <span class="math inline">\(k\)</span> ä½ï¼‰ï¼Œå¹¶å°†åŸæ•°ç»„éƒ¨åˆ†é‡æ’ï¼Œä½¿å¾—å‰ <span class="math inline">\(k-1\)</span> ä¸ºå‡æ¯”ç¬¬ <span class="math inline">\(k\)</span> ä½å°ï¼Œå <span class="math inline">\(n-k\)</span> ä½å‡æ¯”ç¬¬ <span class="math inline">\(k\)</span> ä½å¤§ã€‚</p><p>æ‰€ä»¥å®é™…åŠŸèƒ½å…¶å®æ˜¯ <span class="math inline">\(O(n)\)</span> æ‰¾åˆ°å‰ <span class="math inline">\(k\)</span> å¤§å…ƒç´ ã€‚å› ä¸ºå¹³å¸¸æåˆ° rank éƒ½å–œæ¬¢ç”¨ <span class="math inline">\(k\)</span> æ¥å™è¿°ï¼Œæ‰€ä»¥å‡½æ•°åç»å¸¸è¢«è¯¯è®°ä¸º <code>kth</code>ã€‚</p></li></ul></details><details><p><summary><strong>éšæœºåºåˆ—è·³æ‚¬çº¿ / æ‚¬çº¿ç»“åˆåˆ†å—ï¼š</strong></summary></p><p>éšæœºåºåˆ—çš„ç¬›å¡å°”æ ‘æ·±åº¦ä¸º <span class="math inline">\(\log\)</span>ï¼›ä»¤å—é•¿ä¸º <span class="math inline">\(B=\sqrt {\log n}\)</span>ï¼Œç»´æŠ¤æ¯ä¸ªç‚¹è·³ <span class="math inline">\(B\)</span> æ­¥çš„ç­”æ¡ˆï¼›é‚£ä¹ˆå°±èƒ½ <span class="math inline">\(O(\sqrt {\log n})\)</span> è·³æ‚¬çº¿ã€‚</p></details><details><p><summary><strong>å¤šç»„å…ƒç´ ä¸¤ä¸¤é…å¯¹ï¼Œè¦æ±‚åŒä¸€ç»„é—´ä¸æˆå¯¹ï¼š</strong></summary></p><p>è®¾å…ƒç´ æ€»æ•°ä¸º <span class="math inline">\(2n\)</span>ï¼Œåˆ™æœ‰è§£å½“ä¸”ä»…å½“æœ€å¤§çš„ä¸€ç»„å…ƒç´ æ•°ä¸è¶…è¿‡ <span class="math inline">\(n\)</span>ã€‚</p><p>è‹¥éœ€è¦è¾“å‡ºä¸€ç§æ–¹æ¡ˆï¼Œå¯ä»¥çœ‹ä½œæœ‰ä¸¤ä¸ªé•¿ä¸º <span class="math inline">\(n\)</span>ã€ä¸Šä¸‹å¹¶è¡Œæ”¾ç½®çš„ç›’å­ï¼Œç°æ¬²ç”¨è‹¥å¹²å…ƒç´ å……æ»¡ç›’å­ï¼Œä½¿å¾—ä¸Šä¸‹å¯¹åº”ä½ç½®å…ƒç´ ä¸åŒç»„ã€‚ä¸€ç§ç®€å•çš„æ„é€ æ–¹å¼æ˜¯ï¼ŒæŠŠä¸Šä¸‹ä¸¤ä¸ªç›’å­æ‹¼åœ¨ä¸€èµ·ï¼ŒæŒ‰ä»»æ„é¡ºåºæŠŠæ‰€æœ‰ç»„è¿ç»­æ”¾å…¥ï¼Œç„¶åä»æ‹¼æ¥å¤„æ–­å¼€ï¼Œä¸Šä¸‹å¯¹åº”å³ä¸ºä¸€å¯¹ï¼Œå®¹æ˜“å‘ç°ä¸Šä¸‹å…ƒç´ ä¸€å®šä¸åŒç»„ã€‚</p></details><details><p><summary><strong>æ’¤é”€æ€æƒ³ï¼š</strong></summary></p><p>å½“é¢˜ç›®ç»™å‡ºã€æŒ‰ä¸€å®šçš„æ“ä½œåºåˆ—ï¼Œå°†æ•´å—é€æ­¥åˆ†è§£ä¸ºå°æ®µï¼Œé—®è‡³æ™šå“ªä¸€æ­¥åæ»¡è¶³æ¡ä»¶ï¼ˆéœ€è¦å•è°ƒæ€§ï¼‰ã€ï¼Œå¯ä»¥è€ƒè™‘ä»æœ€åçš„å±€é¢å¼€å§‹è€ƒè™‘ï¼Œé€æ­¥ã€åˆå¹¶ã€ï¼Œå¹¶ check æœ€æ—©åˆå¹¶åˆ°å“ªä¸€æ­¥æ—¶æ»¡è¶³æ¡ä»¶ã€‚</p><p>Goto <a href="/20220808/">solu to <em>CF567D</em></a></p></details><details><p><summary><strong>åŒæ ˆæ¨¡æ‹ŸåŒç«¯é˜Ÿåˆ—ï¼š</strong></summary></p><blockquote><p>ç”¨ä¸¤ä¸ªæ ˆæ¨¡æ‹Ÿé˜Ÿåˆ—æˆ–åŒç«¯é˜Ÿåˆ—ã€‚æ”¯æŒä¸¤å¤´åˆ é™¤ã€æ’å…¥ã€‚</p></blockquote><p>ä¸€ä¸ªç»´æŠ¤å‰é¢çš„æ’å…¥ã€åˆ é™¤ï¼›ä¸€ä¸ªç»´æŠ¤åé¢çš„æ’å…¥ã€åˆ é™¤ã€‚æ’å…¥æ˜¯ç®€å•çš„ï¼›åˆ é™¤åœ¨å¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯ç®€å•çš„ï¼›å¦‚æœæŸä¸ªæ ˆåˆ ç©ºäº†ï¼Œå°†å¦ä¸€ä¸ªæ ˆçš„ä¸€åŠæŒªè¿‡æ¥æš´åŠ›é‡æ„å³å¯ã€‚å‡æ‘Šå¤æ‚åº¦çº¿æ€§ã€‚</p><p>å¤æ‚åº¦è¯æ˜ï¼šè®¾ä¸¤æ ˆé•¿åº¦åˆ†åˆ«ä¸º <span class="math inline">\(L_1,L_2\)</span>ï¼Œå®šä¹‰åŠ¿èƒ½ <span class="math inline">\(E=|L_1-L_2|\)</span>ã€‚æ¯æ¬¡æ’å…¥ / ç®€å•åˆ é™¤å¸¦æ¥ <span class="math inline">\(\pm 1\)</span> çš„åŠ¿èƒ½å˜åŒ–ï¼›ä¸€æ¬¡é‡æ„æ¶ˆè€— <span class="math inline">\(E\)</span> çš„åŠ¿èƒ½ï¼Œå°†åŠ¿èƒ½é‡ç½®ä¸º <span class="math inline">\(E\le 1\)</span>ã€‚æ˜¾ç„¶å°±æœ‰å‡æ‘Šçº¿æ€§å¤æ‚åº¦äº†ã€‚</p><p>é€‚ç”¨åœºæ™¯ï¼šç±»é˜Ÿåˆ— / åŒç«¯é˜Ÿåˆ—åœºæ™¯ï¼Œä½†è‹¥å›ºå®šä¸€ä¸ªç«¯ç‚¹å°±å¯ä»¥å‘å·¦å‘å³åˆ†åˆ«ç®€å•ç»´æŠ¤çš„ï¼›å¦‚èƒŒåŒ…ç­‰ã€‚</p><p>goto <a href="/20250520/#è´ªç©è“æœˆ">solu to <em>è´ªç©è“æœˆ</em></a>ã€‚</p></details><details><p><summary><strong>çº¿æ®µæ ‘ç»´æŠ¤æ‹¬å·åºåˆ—ï¼š</strong></summary></p><p>æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤å·¦è¾¹</p></details><details><p><summary><strong>è´ªå¿ƒé€‰å–æ‹¬å·åºåˆ—ï¼š</strong></summary></p><blockquote><p>ç»™å®š <span class="math inline">\(a_1\sim a_{2N}\)</span>ï¼Œé€‰å–ä¸€ä¸ªåˆæ³•çš„é•¿åº¦ä¸º <span class="math inline">\(2N\)</span> çš„æ‹¬å·åºåˆ—ï¼Œè®°æƒå€¼ä¸ºæ‰€æœ‰ <span class="math inline">\((\)</span> æ‰€åœ¨ä½ç½®çš„ <span class="math inline">\(a\)</span> å€¼ä¹‹å’Œï¼Œæœ€å¤§åŒ–æƒå€¼ã€‚</p></blockquote><p><span class="math inline">\(a_1\)</span> æ˜¾ç„¶ä¸º <code>(</code>ï¼Œ<span class="math inline">\(a_{2N}\)</span> æ˜¾ç„¶ä¸º <code>)</code>ï¼›</p><p>å¯¹äº <span class="math inline">\(a_2\sim a_{2N-1}\)</span>ï¼Œä»å‰å¾€åæ‰«ï¼Œæ¯æ¬¡æŠŠä¸¤ä¸ªè¿ç»­å…ƒç´ æ”¾åœ¨ä¸€èµ·è€ƒè™‘ï¼Œè¿›è¡Œå¦‚ä¸‹æ“ä½œï¼š</p><ul><li>æŠŠè¿™ä¸¤ä¸ªè¿ç»­å…ƒç´ æ”¾åˆ°ã€å¯ç”¨æ¥ä½œ <code>(</code>ã€çš„é˜Ÿåˆ—é‡Œã€‚</li><li>è´ªå¿ƒåœ°ä»é˜Ÿåˆ—é‡ŒæŒ‘é€‰ <span class="math inline">\(a\)</span> æœ€å¤§çš„å…ƒç´ ï¼Œä»¤å…¶ä¸º <code>(</code>ã€‚</li></ul><blockquote><p><strong>æ­£ç¡®æ€§è¯æ˜</strong></p><p>å³è¯ï¼šå¯æ„é€ å‡ºæ¥çš„åºåˆ— <span class="math inline">\(\iff\)</span> åˆæ³•çš„åºåˆ—ï¼›æ„é€ å‡ºæ¥çš„åºåˆ—æœ€ä¼˜ã€‚</p><ul><li><p>å¿…è¦æ€§ï¼š</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œæ‹¬å·åºåˆ—åˆæ³• <span class="math inline">\(\iff\)</span> å¯¹äºä»»æ„ <span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\(1\sim i\)</span> ä¸­çš„ <code>)</code> çš„æ•°é‡ä¸è¶…è¿‡ <code>(</code>ã€‚</p>å¯¹äºä»»æ„ <span class="math inline">\(i=2k+1\)</span>ï¼Œå‰ <span class="math inline">\(i\)</span> ä¸ªå…ƒç´ ä¸­å­˜åœ¨è‡³å°‘ <span class="math inline">\(k+1\)</span> ä¸ª <code>(</code>ã€‚<strong>ä¸”å¦‚æœä»»æ„ä¸€æ­¥å°‘é€‰ï¼Œåºåˆ—ä¸åˆæ³•</strong>ã€‚</li><li><p>å……åˆ†æ€§ï¼š</p><p>ä¹Ÿå³åœ¨æˆ‘ä»¬å¯ä»¥ä»»æ„é€‰æ‹©ä»é˜Ÿåˆ—ä¸­æŒ‘é€‰å“ªä¸ªå…ƒç´ çš„æƒ…å†µä¸‹ï¼Œè¯æ˜ä»»æ„ç›®æ ‡åºåˆ—éƒ½å¯ä»¥è¢«è¿™ä¹ˆæ„é€ ã€‚</p>æ¯æ¬¡é€‰æ‹©ç›®æ ‡åºåˆ—æœ€é å‰çš„æœªè¢«é€‰çš„ <code>(</code> å¹¶å°†å…¶é€‰ä¸­ã€‚å¦‚æœæœ‰ä¸€æ­¥ä¸å­˜åœ¨è¿™æ ·çš„ä½ç½®æ€ä¹ˆåŠï¼Ÿç”±ã€å¿…è¦æ€§ã€ä¸­ç²—ä½“å­—å¾—ä¸åˆæ³•ã€‚</li><li><p>æœ€ä¼˜æ€§ï¼š</p><p>é¦–å…ˆéœ€è¦çŸ¥é“æ¯ä¸ªå…ƒç´ æ˜¯å¦è¢«é€‰æ‹©æ˜¯ç›¸å¯¹ç‹¬ç«‹çš„ã€‚å¦‚æœä¸¤ä¸ªæ•°éƒ½å¯è¢«é€‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„é€‰ä¸­çŠ¶æ€æ˜¯äº’ä¸å½±å“çš„ï¼ˆé™¤éè¿™æ˜¯æœ€åä¸€ä¸ªä½ç½®äº†ï¼Œä½†æ˜¾ç„¶è¿™ä¸æ˜¯æˆ‘ä»¬å…³æ³¨çš„é‡ç‚¹ï¼‰ã€‚</p><p>å‡è®¾ä¸€ä¸ª <span class="math inline">\(a_i\)</span> ä½äºæœ€ä¼˜è§£åºåˆ—ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰é€‰æ‹©å®ƒï¼šè¯´æ˜é€‰ä¸­äº†ä¸€ä¸ªæ¯” <span class="math inline">\(a_i\)</span> æ›´å¤§çš„å…ƒç´ ï¼Œå¯ä»¥æ„é€ å‡ºæ›´ä¼˜çš„åºåˆ—ã€‚ç”±æ­¤åè¯ã€‚</p></li></ul></blockquote><p>goto <a href="/20250520/#abc407e-most-valuable-parentheses">solu to <em>abc407E</em></a>ã€‚</p></details><ul><li><span class="math inline">\(k\)</span> ä¸ªã€ŒäºŒè€…è‡³å°‘é€‰å…¶ä¸€ã€å½¢å¼çš„é™åˆ¶ï¼Œè¦æ±‚é€‰çš„å°½å¯èƒ½å°‘ï¼Œä½¿ç”¨ <span class="math inline">\(2^k\)</span> æšä¸¾åå–å¹¶é›†ä»£æ›¿ <span class="math inline">\(3^k\)</span> æšä¸¾ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> ä¸‹é¥­ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20231113/"/>
      <url>/20231113/</url>
      
        <content type="html"><![CDATA[<p><a href="http://222.180.160.110:61235/contest/4434">NOIP S</a> &amp; <a href="https://vjudge.net/contest/594162">è®¡æ•°æ‚é¢˜</a>ã€‚</p><span id="more"></span><hr /><h3 id="a.-å¡é—¨">A. å¡é—¨</h3><p><a href="https://www.luogu.com.cn/problem/P6370" class="uri">https://www.luogu.com.cn/problem/P6370</a></p><p><a href="http://222.180.160.110:61235/contest/4434/problem/1" class="uri">http://222.180.160.110:61235/contest/4434/problem/1</a></p><p>æˆ‘ä»¬æƒŠè®¶åœ°å‘ç°å…¨åœºæ²¡å¤šå°‘äººä¼šåšç»¿é¢˜ã€‚</p><hr /><p>å°±æ˜¯è¯´å‘¢ï¼Œæˆ‘ä»¬æŠŠå®ƒã€Œæ»šåŠ¨åˆ°ç›¸é‚»è¡Œç„¶åè½ä¸‹ã€çš„è¿‡ç¨‹ç›´æ¥å˜æˆã€Œå¾€å·¦ä¸‹ / å³ä¸‹æ»šã€ã€‚é‚£ä¹ˆçƒæ‰ä¸‹å»çš„è¿‡ç¨‹å‘¢ï¼Œå°±å¯ä»¥ç†è§£ä¸ºå®ƒæ˜¯ä¸€ç›´ä¸€æ¬¡å¾€ä¸‹æ‰ä¸€æ ¼çš„ï¼Œç„¶åæ¯ä¸€æ¬¡æ‰è½å‘¢ï¼Œä¼šæ ¹æ®å®é™…æƒ…å†µå¾€å·¦ / å¾€å³ / ç›´ç€æ‰ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ <span class="math inline">\(m\)</span> ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„åºåˆ—ï¼Œè®°å½•ä»æ¯ <span class="math inline">\(1\sim m\)</span> åˆ—æ‰”ä¸‹å»çš„æƒ…å†µã€‚ç„¶åæˆ‘ä»¬å¾ˆå®¹æ˜“å¯ä»¥çŸ¥é“ï¼Œå¦‚æœä»»æ„ä¸¤ä¸ªåºåˆ—å‘ç”Ÿäº†äº¤æ±‡ï¼Œé‚£ä¹ˆä»äº¤æ±‡ç‚¹å¼€å§‹è‡³åºåˆ—ç»“æŸå‘¢ï¼Œè¿™ä¸¤ä¸ªåºåˆ—çš„å†…å®¹éƒ½æ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚å› ä¸ºä¹‹å‰åºåˆ—é•¿ä»€ä¹ˆæ ·å­ï¼Œå®Œå…¨ä¸ä¼šå¯¹ä¹‹åäº§ç”Ÿå½±å“ã€‚æ‰€ä»¥ä¸€æ—¦æœ‰ä»»æ„ä¸€ä¸ªçŠ¶æ€æ˜¯ä¸€æ ·çš„ï¼Œåé¢éƒ½ä¼šæ˜¯ä¸€æ ·çš„ã€‚</p><p>æ‰€ä»¥å‘¢ï¼Œä¸€æ—¦æˆ‘ä»¬è·Ÿç€è®¡åˆ’å¥½çš„è·¯çº¿èµ°ï¼Œå´å‘ç°èµ°ä¸åŠ¨äº†ï¼Œé‚£å°±è¯´æ˜ä»èµ°ä¸åŠ¨çš„ä½ç½®å¼€å§‹ï¼Œåˆ°åŸå®šè·¯çº¿ç»“æŸï¼Œè¿™äº›ä½ç½®éƒ½ä¼šè¢«å°æ‰ã€‚æ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ç›´æ¥é‡æ–°è®¡ç®—è·¯çº¿å°±å¥½äº†ã€‚</p><p>å¯¹äºè¿™ <span class="math inline">\(m\)</span> åˆ—ï¼Œå°±ç®—æ¯ä¸€åˆ—é¢„å®šè·¯çº¿ä¸Šçš„æ¯ä¸ªä½ç½®éƒ½è¢«å äº†ä¸€æ¬¡ï¼Œä¹Ÿåªä¼šè¢«æ›´æ”¹ <span class="math inline">\(n\times m\)</span> æ¬¡ï¼›æ€»ä½“æ—¶é—´å¤æ‚åº¦åªæœ‰ <span class="math inline">\(O(nm^2)\)</span>ã€‚ç„¶ååˆç”±äºä¸å¯èƒ½è·‘æ»¡ï¼Œå…¶å®æ˜¯å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œç”šè‡³è·‘å¾—å‡ºæºœå¿«çš„ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxm = 35;const int maxn = 3e4 + 5;char a[maxn][maxm];int n, m, q, u, x, y;std::vector&lt;int&gt; p[maxm]; int main() &#123;#ifdef ONLINE_JUDGE    freopen(&quot;kamen.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;kamen.out&quot;, &quot;w&quot;, stdout);#endif    scanf(&quot;%d %d&quot;, &amp;n, &amp;m);    for (int i = 1; i &lt;= n; ++i)        scanf(&quot;%s&quot;, a[i] + 1);    for (int i = 1; i &lt;= m; ++i) &#123;        x = 1, y = i;        for (;;) &#123;            p[i].push_back(y);             if (a[x + 1][y] == &#39;.&#39;) ++x;            else &#123;                if (a[x + 1][y] == &#39;X&#39;) break;                if (a[x][y - 1] == &#39;.&#39; &amp;&amp; a[x + 1][y - 1] == &#39;.&#39;)                    ++x, --y;                else if (a[x][y + 1] == &#39;.&#39; &amp;&amp; a[x + 1][y + 1] == &#39;.&#39;)                    ++x, ++y;                else break;            &#125;        &#125;    &#125;    scanf(&quot;%d&quot;, &amp;q);    while (q--) &#123;        scanf(&quot;%d&quot;, &amp;u);        while (a[p[u].size()][p[u].back()] != &#39;.&#39;)            p[u].pop_back();        x = p[u].size(), y = p[u].back();        for (;;) &#123;            p[u].push_back(y);             if (a[x + 1][y] == &#39;.&#39;) ++x;            else &#123;                if (a[x + 1][y] == &#39;X&#39;) break;                if (a[x][y - 1] == &#39;.&#39; &amp;&amp; a[x + 1][y - 1] == &#39;.&#39;)                    ++x, --y;                else if (a[x][y + 1] == &#39;.&#39; &amp;&amp; a[x + 1][y + 1] == &#39;.&#39;)                    ++x, ++y;                else break;            &#125;        &#125;        a[x][y] = &#39;O&#39;;    &#125;    for (int i = 1; i &lt;= n; ++i) puts(a[i] + 1);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="b.-å•†äºº">B. å•†äºº</h3><p><a href="http://222.180.160.110:61235/contest/4434/problem/2" class="uri">http://222.180.160.110:61235/contest/4434/problem/2</a></p><p>é¦–å…ˆå¿½ç•¥å›¾ä¸­çš„ç¯å¸¦æ¥çš„é—®é¢˜ï¼Œå‡è®¾ <span class="math inline">\(f_u\)</span> è¡¨ç¤ºä» <span class="math inline">\(u\)</span> ç‚¹å‡ºå‘çš„ç­”æ¡ˆï¼Œä¸éš¾æƒ³åˆ° DP å¼ <span class="math inline">\(f_u = \min\{\max(f_v-p_{(u,v)}, r_{(u,v)})\}\)</span>ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå›¾ä¸­æ˜¯ä¼šæœ‰ç¯çš„ï¼Œä¸èƒ½ç®€å•åœ°å»æ›´æ–° DP å€¼ã€‚æˆ‘ä»¬é¦–å…ˆè€ƒè™‘ã€Œæ ¹æºã€ï¼Œæ¯ä¸€ä¸ª <span class="math inline">\(f_u\)</span> ä¸€å®šéƒ½æ˜¯ç”±å¦ä¸€ä¸ª <span class="math inline">\(f_v\)</span> è½¬ç§»å¾—åˆ°çš„ï¼Œé‚£ä¹ˆä¸€å®šä¼šå­˜åœ¨ä¸€ä¸ªå·²çŸ¥çš„ <span class="math inline">\(f_u\)</span>ï¼Œä¸ç”±å…¶ä»–ä»»ä½• <span class="math inline">\(f_v\)</span> å¾—åˆ°ã€‚</p><p>è€ƒè™‘ä¸€ä¸ªç¯ä¸­ <span class="math inline">\(r\)</span> æœ€å¤§çš„ä¸€æ¡è¾¹ <span class="math inline">\((u,v)\)</span>ã€‚å‡è®¾å›¾ä¸­åªæœ‰è¿™ä¸€ä¸ªç¯ï¼Œé‚£ä¹ˆ <span class="math inline">\(f_u\)</span> çš„å€¼ä¸€å®šä¸º <span class="math inline">\(r\)</span>ï¼Œå› ä¸º <span class="math inline">\(p\)</span> åªèƒ½ä¸ºéè´Ÿã€‚è¿™æ ·ã€Œæ ¹æºã€å°±è¢«æˆ‘ä»¬æ‰¾åˆ°äº†ã€‚æ¥ä¸‹æ¥è¿›ä¸€æ­¥è€ƒè™‘è½¬ç§»æ–¹æ³•ã€‚</p><p>ä¸€ä¸ªç‚¹ <span class="math inline">\(u\)</span> åªèƒ½è¢«å…¶ç›¸è¿çš„ç‚¹ <span class="math inline">\(v\)</span> æ›´æ–°ï¼Œé‚£ä¹ˆå½“ä¸”ä»…å½“æ‰€æœ‰ <span class="math inline">\(f_v\)</span> éƒ½æ˜¯ç¡®å®šçš„ï¼Œ<span class="math inline">\(f_u\)</span> æ‰èƒ½è¢«ç¡®å®šï¼Œè¿›è€Œå»æ›´æ–° <span class="math inline">\(u\)</span> çš„å‰é©±ã€‚è¿™è®©æˆ‘ä»¬æƒ³åˆ°äº†æ‹“æ‰‘æ’åºã€‚å¦‚æœæˆ‘ä»¬å°†æ‰€æœ‰è¾¹åå‘ï¼Œé‚£ä¹ˆä¸Šé¢çš„è¿‡ç¨‹å‡ ä¹å°±æ˜¯æ‹“æ‰‘æ’åºã€‚</p><p>ä¸ºäº†ä¿è¯ä»»æ„ä¸€ä¸ªç¯ä¸Šçš„ã€Œæ ¹æºã€éƒ½èƒ½æœ€å…ˆè¢«ç¡®å®šï¼Œæˆ‘ä»¬æŒ‰ç…§æŒ‰ <span class="math inline">\(r\)</span> ä»å¤§åˆ°å°éå†æ¯ä¸€æ¡è¾¹çš„æ–¹å¼å¤„ç†é—®é¢˜ã€‚å¯¹äºæ¯ä¸€æ¡è¾¹ <span class="math inline">\((u,v)\)</span>ï¼Œæˆ‘ä»¬éƒ½å‡è®¾å®ƒæ˜¯ã€Œæ ¹æºã€å¹¶ç”¨ <span class="math inline">\(r_{(u,v)}\)</span> æ›´æ–° <span class="math inline">\(f_u\)</span>ã€‚æˆ‘ä»¬å…¶å®å¹¶ä¸å…³å¿ƒ <span class="math inline">\(u\)</span> æ˜¯å¦æ˜¯æˆ‘ä»¬åˆšåˆšå®šä¹‰çš„å½¢å¼ä¸Šçš„ã€Œæ ¹æºã€ï¼Œæ¯•ç«Ÿï¼Œåªè¦ <span class="math inline">\(f_u\)</span> èƒ½è¢« <span class="math inline">\(r_{(u,v)}\)</span> æ›´æ–°ï¼Œå®ƒå°±èƒ½ç®—ä½œå¹¿ä¹‰ä¸Šçš„ï¼Œ<strong>å½“å‰æ—¶åˆ»çš„</strong>ã€Œæ ¹æºã€ã€‚</p><p>æˆ‘ä»¬åœ¨ä¸€å¼€å§‹å°†å‡ºåº¦ä¸º <span class="math inline">\(0\)</span>ï¼ˆåå›¾ä¸Šå°±æ˜¯å…¥åº¦ä¸º <span class="math inline">\(0\)</span>ï¼‰çš„ç‚¹å…¨éƒ¨åŠ å…¥é˜Ÿåˆ—ï¼Œåœ¨æ¯æ¬¡åŠ è¾¹çš„æ—¶å€™è¿›è¡Œæ‹“æ‰‘æ’åºã€‚æ¯æ¬¡ä¸€æ¡è¾¹ä»¥ä»»æ„å½¢å¼è¢«ã€Œä½¿ç”¨ã€åï¼Œéƒ½è¦æ‰“æ ‡è®°åˆ é™¤å¹¶ä¸èƒ½å†è®¿é—®ï¼Œä»¥ä¿è¯è½¬ç§»çš„æ­£ç¡®æ€§å’Œé«˜æ•ˆã€‚å¦‚æœä¸€æ¡è¾¹è¢«ã€Œä½¿ç”¨ã€ï¼Œåˆ†ä¸¤ç§æƒ…å†µï¼š</p><ol type="1"><li><p>æ›´æ–°ã€Œæ ¹æºã€ï¼š</p>è¿™ä¸ªæ—¶å€™è¿™æ¡è¾¹å·²ç»å‘æŒ¥äº†å®ƒçš„æ‰€æœ‰ä½œç”¨äº†ï¼Œä½œä¸º <strong>å½“å‰æ—¶åˆ»çš„</strong>ã€Œæ ¹æºã€ï¼Œè¿™æ¡è¾¹çš„æºç‚¹åœ¨æœªæ¥è‡³å°‘ä¸ä¼šå†ç»ç”±è¿™ä¸€æ¡è¾¹è¢«æ›´æ–°ã€‚æ•…å¯ä»¥åˆ é™¤ã€‚</li><li><p>æ‹“æ‰‘æ’åºä¸­è½¬ç§»ï¼š</p><p>ä¸€ä¸ªç‚¹è¢«åŠ å…¥é˜Ÿåˆ—ï¼Œè¯´æ˜å®ƒçš„ DP å€¼æ˜¯ç¡®å®šçš„ï¼Œé‚£ä¹ˆå°±ä¸ç”¨æ‹¿ä¸€ä¸ªå·²ç»ç¡®å®šçš„å€¼å¤šæ¬¡æ›´æ–°å¦ä¸€ä¸ª DP å€¼ã€‚æ•…å¯ä»¥åˆ é™¤ã€‚</p></li></ol><p>æ‰€ä»¥æ­£ç¡®æ€§æ˜¯å¯ä»¥ä¿è¯çš„ã€‚ç±»æ‹“æ‰‘æ’åºçš„ç»“æ„ä¹Ÿä¿è¯äº†ç®—æ³•å¤æ‚åº¦ <span class="math inline">\(O(n+m)\)</span>ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 2e5 + 5;const int maxm = 2e5 + 5;struct _ &#123;    int v, r, p, i;    _() &#123;&#125;    _(int v1, int r1, int p1, int i1) &#123;        v = v1, r = r1, p = p1, i = i1;    &#125;&#125;;struct __ &#123;    int x, y, r, p;    bool operator&lt; (const __ &amp;q) const &#123;        return r &gt; q.r;    &#125;&#125;;__ a[maxm];bool del[maxn];std::queue&lt;int&gt; q;int n, m, x, y, r, p;std::vector&lt;_&gt; g[maxn];int f[maxn], deg[maxn];int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;void add(int x, int y, int r, int p, int i) &#123;    g[x].emplace_back(y, r, p, i);    return;&#125;int main() &#123;#ifdef ONLINE_JUDGE    freopen(&quot;merchant.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;merchant.out&quot;, &quot;w&quot;, stdout);#endif    read(n), read(m);    std::fill(f + 1, f + n + 1, inf);    for (int i = 1; i &lt;= m; ++i) &#123;        read(a[i].x), read(a[i].y);        read(a[i].r), read(a[i].p);        ++deg[a[i].x];    &#125;    std::sort(a + 1, a + m + 1);    for (int i = 1; i &lt;= n; ++i)        if (!deg[i]) q.push(i);    for (int i = 1; i &lt;= m; ++i)        add(a[i].y, a[i].x, a[i].r, a[i].p, i);    for (int i = 1; i &lt;= m; ++i) &#123;        while (!q.empty()) &#123;            int t = q.front(); q.pop();            for (auto j : g[t]) &#123;                if (del[j.i]) continue;                del[j.i] = 1;                if (f[t] != inf)                    f[j.v] = min(f[j.v], max(f[t] - j.p, j.r));                if (!--deg[j.v]) q.push(j.v);            &#125;        &#125;        if (!del[i]) &#123;            del[i] = 1, f[a[i].x] = min(f[a[i].x], a[i].r);            if (!--deg[a[i].x]) q.push(a[i].x);        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i)        print(f[i] == inf ? -1 : f[i], &#39; &#39;);    putchar(&#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="a---gerald-and-giant-chess">A - Gerald and Giant Chess</h3><p><a href="https://vjudge.net/contest/594162#problem/A" class="uri">https://vjudge.net/contest/594162#problem/A</a></p><p>è¿™ä¸ªå‘¢ï¼Œä¸€é“ç®€å•çš„æ•°æ•°é¢˜ï¼Œä½†æ˜¯å› ä¸ºæˆ‘å¿˜äº† DP å®¹æ–¥æ€ä¹ˆæ‰“äº†æ‰€ä»¥è‡ªè¡Œæ€è€ƒäº†å¾ˆä¹…å¾ˆä¹…å¾ˆä¹…ï¼Œè¿˜å·®æœ€åä¸€ç‚¹ç‚¹æƒ³å‡ºæ¥çš„æ—¶å€™æ”¾å¼ƒäº†å»æŠ„é¢˜è§£ /cf</p><p>å°±æ˜¯ï¼Œè¿™ç§ã€Œé™åˆ¶é€šè¡Œã€çš„ DP å®¹æ–¥ï¼ˆåå­—æ˜¯æˆ‘ç°åœºèµ·çš„ï¼‰ç±»å‹çš„æ•°æ•°é¢˜æœ‰ä¸€ç§é€šæ³•ï¼Œå°±æ˜¯é¦–å…ˆæˆ‘ä»¬åªè®¡ç®—éæ³•æ–¹æ¡ˆç„¶åå‡æ‰ã€‚</p><p>é‚£ä¹ˆéæ³•æ–¹æ¡ˆæ€ä¹ˆç®—å‘¢ï¼Ÿä»¤ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºä¸€ä¸ªéæ³•ç‚¹éƒ½ä¸ç»è¿‡ï¼Œåˆ°è¾¾ <span class="math inline">\(i\)</span> è¿™ä¸ªéæ³•ç‚¹çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(f_i=calc(s,i)-\sum f_j\times calc(j,i)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(s\)</span> æ˜¯èµ·ç‚¹ï¼Œ<span class="math inline">\(calc(j,i)\)</span> æ˜¯ä» <span class="math inline">\(j\to i\)</span> çš„æ–¹æ¡ˆæ•°ã€‚è¿™æ ·å°±èƒ½ä¸é‡ä¸æ¼åœ°æšä¸¾å®Œæ‰€æœ‰æƒ…å†µäº†ã€‚</p><p>æˆ‘ä»¬æŠŠ <span class="math inline">\((n,m)\)</span> ä¹Ÿè§†ä½œä¸€ä¸ªéæ³•ç‚¹ç„¶åä»£å…¥ DP å³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int lim = 3e5;const int mod = 1e9 + 7;const int maxk = 2e3 + 5;const int maxn = 3e5 + 5;struct _ &#123;    int x, y;    bool operator&lt; (const _ &amp;q) const &#123;        return x == q.x ? y &lt; q.y : x &lt; q.x;    &#125;&#125;;_ a[maxk];int n, m, k, res; int f[maxk], fac[maxn];int qkp(int x, int y) &#123;    int res = 1;    while (y) &#123;        if (y &amp; 1) (res *= x) %= mod;        (x *= x) %= mod, y &gt;&gt;= 1;    &#125;    return res;&#125;int inv(int x) &#123; return qkp(x, mod - 2); &#125;int A(int n, int m) &#123;    return fac[n] * inv(fac[n - m]) % mod;&#125;int C(int n, int m) &#123;    return A(n, m) * inv(fac[m]) % mod;&#125;int calc(int i, int j) &#123;    int x = a[j].x - a[i].x + 1,        y = a[j].y - a[i].y + 1;    return C(x + y - 2, y - 1);&#125;int main() &#123;    fac[0] = 1;    for (int i = 1; i &lt;= lim; ++i)        fac[i] = fac[i - 1] * i % mod;    bool flag = 0;    read(n), read(m), read(k);    for (int i = 1; i &lt;= k; ++i) &#123;        read(a[i].x), read(a[i].y);        flag |= (a[i].x == 1 &amp;&amp; a[i].y == 1);        flag |= (a[i].x == n &amp;&amp; a[i].y == m);    &#125;    a[0].x = a[0].y = 1;    if (flag) &#123; print(0, &#39;\n&#39;); return 0; &#125;    ++k, a[k].x = n, a[k].y = m;    std::sort(a + 1, a + k + 1);    for (int i = 1; i &lt;= k; ++i) &#123;        f[i] = calc(0, i);        for (int j = 1; j &lt; i; ++j) &#123;            if (a[j].x &gt; a[i].x || a[j].y &gt; a[i].y) continue;            (f[i] -= f[j] * calc(j, i) % mod) %= mod;        &#125;    &#125;    f[k] = (f[k] % mod + mod) % mod;    print(f[k], &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> Tarjan </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20231112/"/>
      <url>/20231112/</url>
      
        <content type="html"><![CDATA[<p><a href="http://222.180.160.110:61235/contest/4424">NOIP S</a> &amp; <a href="http://222.180.160.110:61235/contest/4423">å‘¨è€ƒ 16</a> &amp; æ‚é¢˜ã€‚</p><span id="more"></span><hr /><h3 id="a.-æ•°å­—æ¸¸æˆ">A. æ•°å­—æ¸¸æˆ</h3><p><a href="http://222.180.160.110:61235/contest/4424/problem/1" class="uri">http://222.180.160.110:61235/contest/4424/problem/1</a></p><details><p><summary>é—²è¯</summary></p><p>ä¸€å¼€å§‹å¿˜äº†æ€ä¹ˆåšçš„ç„¶åä» Cindy çš„åšæ³•å¼€å§‹å›å¿†ï¼Œä¸€è¾¹å›å¿†ä¸€è¾¹å†™ä¸‹æ–‡ï¼Œç»“æœå‘ç°å†™ç€å†™ç€å˜æˆ wjf çš„åšæ³•äº† /cf</p><p>updï¼šå˜æˆèŒçš„åšæ³•äº† /cf /cf /cf</p><p>updï¼šå˜æˆ zmq çš„åšæ³•äº†ï¼Œæˆ‘å·²ç»æ‡’å¾— /cf äº†ã€‚</p></details><p>é¢˜æ„è½¬åŒ–ä¸€ä¸‹ï¼Œå¤§è‡´å°±æ˜¯ä¸€ä¸ªæ¯æ¬¡å¾€å³æ‹“å±•ä¸€ä½çš„è¯¢é—®åŒºé—´ï¼Œæ¯æ¬¡æŸ¥è¯¢è¯¥è¯¢é—®åŒºé—´å†…æœ€å¤§å€¼å¹¶æ‹¿èµ°ä¹‹ã€‚</p><p>æˆ‘ä»¬å…ˆæ„Ÿæ€§åœ°æƒ³ï¼Œå¯¹äºä¸€ä¸ª <strong>å¾ˆå¤§çš„å€¼</strong>ï¼Œå®ƒä¸€è¿›å…¥è¯¢é—®èŒƒå›´å°±ä¼šè¢«å½“åœºæ‹¿èµ°ã€‚</p><p>é‚£å¦‚æœæ²¡æœ‰è¢«æ‹¿èµ°æ˜¯å› ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºåœ¨å‰é¢ç§¯å­˜ä¸‹æ¥çš„å…ƒç´ ä¸­è¿˜æœ‰æ¯”å®ƒå¤§çš„ã€‚</p><p>é‚£ä¸ºä»€ä¹ˆå‰é¢çš„æ¯”å®ƒå¤§çš„å…ƒç´ æ²¡æœ‰è¢«å½“åœºæ‹¿èµ°å‘¢ï¼Ÿå› ä¸ºåœ¨æ›´å‰é¢ç§¯å­˜ä¸‹æ¥çš„æœ‰æ¯”è¿™ä¸ªå…ƒç´ å¤§çš„â€¦â€¦ é‚£ä¹ˆæœ€å¼€å§‹çš„ç§¯å­˜æ˜¯æ€ä¹ˆæ¥çš„å‘¢ï¼Ÿæ˜¯æœ€åˆè¯¢é—®åŒºé—´ä¸º <span class="math inline">\([1,p_i]\)</span> è€Œé <span class="math inline">\([1,1]\)</span> å¯¼è‡´çš„ã€‚</p><p>è¢«ç§¯å­˜ä¸‹çš„æ•°è¢«æ‹¿å‡ºæ¥ç”¨æ‰çš„æ—¶åˆ»ï¼Œå°±æ˜¯å¾€åç¢°åˆ°äº†ä¸€ä¸ªæ¯”å®ƒå°çš„å€¼ï¼Œç„¶åé¡¶æ›¿æ‰è¿™ä¸ªå€¼è¢«ç”¨æ‰ã€‚è¢«é¡¶æ›¿çš„å°±è¿›å…¥ç§¯å­˜åŒºã€‚</p><p>æ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ç›´æ¥ <strong>æ¨¡æ‹Ÿ</strong> ç§¯å­˜æ•°è¢«ç”¨æ‰çš„è¿‡ç¨‹ã€‚</p><p>å¯¹äºå…¨åºåˆ—ä¸­çš„æœ€å¤§å€¼ï¼Œå½“åœºç”¨æ‰ã€‚æ¬¡å¤§å€¼å‘¢ï¼Œè‹¥å®ƒæ¯”æœ€å¤§å€¼å…ˆè¿›å…¥è¯¢é—®åŒºé—´ï¼Œçš†å¤§æ¬¢å–œï¼Œå½“åœºç”¨æ‰ï¼›åˆå› ä¸ºæœ€å¤§å€¼ä¸å¯èƒ½è¢«ç§¯å­˜ï¼Œå°±ç®—å®ƒåœ¨æœ€å¤§å€¼ä¹‹åï¼Œä¹Ÿå¯ä»¥å½“åœºç”¨æ‰ã€‚</p><p>ç¬¬ä¸‰å¤§çš„ï¼Œå°±å¯èƒ½è¿›ç§¯å­˜åŒºã€‚å‡è®¾å®ƒè¦å‡ºæ¥ï¼Œé¦–å…ˆè¦æ»¡è¶³å‡ºæ¥çš„æ—¶é—´ï¼ˆåœ¨è¿›å…¥ç§¯å­˜åŒºä¹‹åï¼Œæœ‰ç‚¹åºŸè¯ï¼‰ï¼Œç„¶åå¦‚æœå®ƒä¸€å‡ºæ¥å°±ç¢°åˆ°äº†æ¯”å®ƒæ›´å¤§çš„ï¼Œå¾ˆä¸å¹¸ï¼Œå‡ºä¸æ¥äº†ã€‚ä½†æ˜¯å› ä¸ºé™¤äº†æœ€å¤§å’Œæ¬¡å¤§ä¹‹å¤–æ²¡æœ‰å…ƒç´ æ¯”å®ƒå¤§äº†ï¼Œå®ƒå°±å¯ä»¥åœ¨å‰©ä¸‹çš„ä½ç½®é‡Œé¢éšä¾¿æŒ‘â€”â€”å½“ç„¶æ˜¯æŒ‘æœ€é å‰çš„ã€‚åé¢çš„å’Œç¬¬ä¸‰å¤§é“ç†å°±å·®ä¸å¤šäº†ã€‚</p><p>æ‰€ä»¥è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå¤§è‡´çš„åšæ³•äº†ï¼Œæˆ‘ä»¬æŠŠå…ƒç´ ä»å¤§åˆ°å°æ’åºï¼Œé¡ºä¾¿è®°å½•ä¸€ä¸‹å®ƒè¿›å…¥è¯¢é—®èŒƒå›´çš„æ—¶é—´ <span class="math inline">\(t\)</span>ã€‚ç„¶åæˆ‘ä»¬ä¼˜å…ˆè®©è¿™ä¸ªå€¼åœ¨ <span class="math inline">\(t\)</span> æ—¶åˆ»ç›´æ¥è¢«æ‹¿èµ°ã€‚é‚£å‡å¦‚ <span class="math inline">\(t\)</span> è¿™ä¸ªä½ç½®å·²ç»è¢«æ›´å¤§çš„å…ƒç´ å é¢†äº†ï¼Œå°±æ‰¾è¿™ä¹‹åç¬¬ä¸€ä¸ªç©ºä½ã€‚</p><p>é‚£ä¹ˆè¿™ä¸ªã€Œç¬¬ä¸€ä¸ªç©ºä½ã€æ€ä¹ˆæ‰¾å‘¢ï¼Ÿæˆ‘ä»¬ç”¨ä¸€ä¸ªåˆå€¼ä¸º <span class="math inline">\(1\)</span> çš„ <span class="math inline">\(pos\)</span>ï¼Œå¯¹äºå½“åœºæ‹¿èµ°çš„æƒ…å†µï¼Œè‚¯å®šæ˜¯ä¸ä¼šæœ‰å†²çªçš„ï¼Œæ‰€ä»¥å†²çªéƒ½å‘ç”Ÿåœ¨ç§¯å­˜åŒºã€‚ç§¯å­˜åŒºåˆéƒ½æ˜¯ä» <span class="math inline">\(1\)</span> å¼€å§‹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å¯¹äºä¸æ˜¯å½“åœºæ‹¿èµ°çš„æƒ…å†µï¼ŒæŠŠ <span class="math inline">\(pos\)</span> ç§»åˆ°è·ç¦» <strong>å½“å‰å€¼</strong> æœ€è¿‘çš„ç©ºä½ç„¶åæ”¾è¿›å»å°±å¯ä»¥äº†ã€‚å› ä¸º <span class="math inline">\(pos\)</span> å…¨ç¨‹åªä¼šå³ç§»ï¼Œæ‘Šå‡ºæ¥æ˜¯ <span class="math inline">\(O(n)\)</span> çš„ã€‚</p><p>å› ä¸ºæˆ‘ä»¬åªè¦åœ¨æœ€å¼€å§‹æ’ä¸ªåºï¼Œæ€»æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\log n + nq)\)</span>ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;struct _ &#123;    int x, i;    bool operator&lt; (const _ &amp;q) const &#123;        return x &gt; q.x;    &#125;&#125;;_ a[maxn];int flag[maxn];int n, m, p, res, pos;int main() &#123;#ifdef ONLINE_JUDGE    freopen(&quot;game.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;game.out&quot;, &quot;w&quot;, stdout);#endif    read(n), read(m);    for (int i = 1; i &lt;= n; ++i)        read(a[i].x), a[i].i = i;    std::sort(a + 1, a + n + 1);    while (m--) &#123;        read(p), res = 0, pos = 1;        for (int i = 1; i &lt;= n; ++i)            flag[i] = 0;        for (int i = 1; i &lt;= n; ++i) &#123;            int id =            (a[i].i &lt; p ? 1 : a[i].i - p + 1);            if (flag[id]) &#123;                while (flag[pos]) ++pos;                flag[pos] = i;            &#125;            else flag[id] = i;        &#125;        for (int i = 1, j = 1; i &lt;= n; ++i, j = -j)             res += j * a[flag[i]].x;        print(res, &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="b.-è¿‡æ²³å’ii">B. è¿‡æ²³å’II</h3><p><a href="http://222.180.160.110:61235/contest/4424/problem/2" class="uri">http://222.180.160.110:61235/contest/4424/problem/2</a></p><p>ä»¥åŠ <a href="https://www.luogu.com.cn/problem/P6234">è¿™</a> æ˜¯åŸé¢˜ã€‚</p><p>è¯»é”™é¢˜äº†æ•´æ•´ 3.5h /youl</p><p>æˆ‘ä»¬æ¥ä¸‹æ¥æŠŠã€Œç‰¹æ®Šæ ¼å­ã€è®°ä¸º <code>-</code>ï¼Œã€Œç‰¹æ®Šæ ¼å­ã€å››ä¸ªæ–¹å‘ç›¸é‚»çš„ç‚¹è®°ä½œ <code>O</code>ï¼Œé™¤æ­¤ä¹‹å¤–çš„ç‚¹å› ä¸ºæ²¡æœ‰å¯èƒ½è¢«é€‰åˆ°ï¼Œæˆ‘ä»¬ä¸åšè®¨è®ºã€‚</p><pre class="plain"><code>  -- O -  -</code></pre><p>å¯¹äºä¸€ä¸ªå…³é”®ç‚¹ï¼Œæˆ‘ä»¬å‘ç°æ‰¾ T å­—æœ¬èº«ä¸å¤ªæ–¹ä¾¿ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªè½¬åŒ–æˆåœ¨åå­—é‡Œé¢æŠ æ‰ä¸€ä¸ªæœ€å°å€¼ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å‡è®¾æœ‰å¦ä¸€ä¸ªå…³é”®ç‚¹çš„åå­—å’Œè¿™ä¸€ä¸ªçš„åå­—æœ‰é‡åˆå¹¶ä¸ç›¸é‚»ï¼Œé‚£ä¹ˆå¤§æŠµæ˜¯å½¢å¦‚è¿™ä¸ªæ ·å­çš„ï¼š</p><pre class="plain"><code>  -   -- O - O -  -   -</code></pre><p>è¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬å‘ç°ä¸€å…±æœ‰ 7 ä¸ª <code>-</code>ï¼Œä¸€å…±éœ€è¦ 6 ä¸ª <code>-</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬è¯•ç€éšä¾¿æŠ æ‰ä¸€ä¸ªã€‚</p><pre class="plain"><code>  X   | -- O - | O -  -   | -</code></pre><p>æˆ‘ä»¬å‘ç°è¿™ä¸ªæ—¶å€™ä¸€å®šæ˜¯èƒ½æ‰¾åˆ°ä¸€ä¸ª <strong>ç¡®å®šçš„</strong> æ–¹æ¡ˆå»åˆ’åˆ† T å­—çš„ã€‚</p><p>æ‰€ä»¥å¯¹äºä¸¤ä¸ª <code>O</code> çš„æƒ…å†µï¼Œæˆ‘ä»¬æŠ æ‰ä¸ƒä¸ª <code>-</code> å½“ä¸­çš„æœ€å°å€¼å³å¯ã€‚</p><p>æ¥ä¸‹æ¥å‡è®¾æœ‰ä¸‰ä¸ª <code>O</code>ï¼Œé‚£ä¹ˆä¼šæœ‰ 10 ä¸ª <code>-</code>ï¼Œä½†æˆ‘ä»¬éœ€è¦ 9 ä¸ªï¼Œäºæ˜¯æŠ æ‰æœ€å°å€¼ï¼Œä¾ç„¶å­˜åœ¨ä¸€ç§ <strong>ç¡®å®šçš„</strong> æ–¹æ¡ˆå»åˆ’åˆ† T å­—ã€‚</p><p>ä¸éš¾å‘ç°ï¼Œ<span class="math inline">\(n\)</span> å½¼æ­¤å½±å“è¿˜ä¸ç›¸é‚»çš„ <code>O</code> ä¼šå¸¦æ¥ <span class="math inline">\(3\times n-1\)</span> ä¸ª <code>-</code>ï¼ˆå°å­¦æ•°å­¦è®¡ç®—å³å¯ï¼‰ï¼Œæˆ‘ä»¬å°†æœ€å°è€…åˆ é™¤å³å¯å¾—åˆ°æœ€å¤§ç­”æ¡ˆã€‚</p><p>æ¨å¹¿ä¸€ä¸‹ç»“è®ºï¼Œå…¶å®æ˜¯æˆ‘ä»¬å¯¹äº <span class="math inline">\(x\)</span> ä¸ªç›¸äº’å½±å“çš„ <code>O</code>ï¼ˆæ³¨æ„è¿™é‡Œ <strong>æ²¡æœ‰å¼ºè°ƒ</strong> ä¸ç›¸é‚»ï¼‰ï¼Œåˆ æ‰ä¸€äº›ä½¿å¾— <code>-</code> çš„æ•°é‡ä¸º <span class="math inline">\(3x\)</span>ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åˆçŸ¥é“å¯¹äºæœ€ç†æƒ³çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è®²åˆ°çš„ç›¸äº’å½±å“åˆä¸ç›¸é‚»ï¼Œ<code>-</code> çš„ä¸ªæ•°æ˜¯ <span class="math inline">\(3\times x+1\)</span>ï¼Œæˆ‘ä»¬åˆåªèƒ½è¿›è¡ŒæŠ æ‰ <code>-</code> è¿™ä¸€ä¸ªæ“ä½œã€‚</p><p>æ‰€ä»¥å¯¹äºä¸€ä¸ª <code>O/-</code> è¿é€šå—ï¼Œè¦æ±‚å…¶ <code>-</code> çš„ä¸ªæ•°è¦ä¹ˆæ˜¯ <span class="math inline">\(3x\)</span>ï¼ˆä¸ç„¶ <code>-</code> å°±ä¸å¤Ÿç”¨äº†ï¼Œä»¥åŠ <code>-</code> çš„ç¼ºå¤±æ˜¯ç›¸é‚»çš„ <code>O</code> å’Œè¾¹ç•Œå¯¼è‡´çš„ï¼›è¾¹ç•Œå¤–çš„ <code>-</code> è‚¯å®šæ˜¯ä¸èƒ½ç®—çš„ï¼‰ï¼Œè¦ä¹ˆä¸º <span class="math inline">\(3x+1\)</span>ï¼ˆåªç”¨åˆ ä¸€ä¸ªä¹Ÿä¿è¯äº†æ­£ç¡®æ€§ï¼‰ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è·‘ä¸€ä¸ªç±» Flood-fillï¼Œä¸€è¾¹æœä¸€è¾¹æ‰¾æœ€å°çš„ <code>-</code>ï¼Œè¿˜è¦ç»Ÿè®¡ <code>-</code> å’Œ <code>O</code> çš„æ€»ä¸ªæ•°ï¼Œè¿˜è¦è®¡ç®— <span class="math inline">\(sum\)</span>ã€‚ç„¶åå°±å®Œäº†ã€‚</p><p>è™½ç„¶è¯´è¿™ä¸ª Flood-fill æ²¡ä»€ä¹ˆæŠ€æœ¯å«é‡ï¼Œä½†æ˜¯æˆ‘ä»¬è¦æ³¨æ„åªèƒ½ä» <code>-</code> å‡ºå‘åªèƒ½é€šå¾€ <code>O</code> è€Œéå¦ä¸€ä¸ª <code>-</code>ï¼Œå› ä¸ºç›¸é‚»çš„ä¸¤ä¸ª <code>-</code> å…¶å®æ˜¯ä¸ä¼šäº’ç›¸äº¤å‰çš„ç›¸äº’å½±å“çš„ã€‚</p><p>Flood-fill å¸¦æ¥çš„æ€»æ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(nm)\)</span>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxk = 1e6 + 5;const int inf = 0x3f3f3f3f;const int fx[] = &#123; 0, 0, 1, -1 &#125;;const int fy[] = &#123; 1, -1, 0, 0 &#125;;int n, m, k, x, y, res;int mn, sum, cnt1, cnt2;std::vector&lt;std::vector&lt;int&gt; &gt; a, b, c;int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;void DFS(int x, int y) &#123;    sum += a[x][y];    if (b[x][y] == 1) ++cnt1;    else ++cnt2, mn = min(mn, a[x][y]);    c[x][y] = 1;    for (int i = 0; i &lt; 4; ++i) &#123;        int nx = x + fx[i],            ny = y + fy[i];        if (!nx || !ny || nx &gt; n || ny &gt; m)            continue;        if (c[nx][ny]) continue;        if ((b[x][y] == 1 &amp;&amp; b[nx][ny] == 1)         || (b[x][y] == 1 &amp;&amp; b[nx][ny] == 2)          || (b[x][y] == 2 &amp;&amp; b[nx][ny] == 1))            DFS(nx, ny);    &#125;    return;&#125;int main() &#123;#ifdef ONLINE_JUDGE    freopen(&quot;pawn.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;pawn.out&quot;, &quot;w&quot;, stdout);#endif    read(n), read(m);    a.push_back(std::vector&lt;int&gt;(m + 1));    b.push_back(std::vector&lt;int&gt;(m + 1));    for (int i = 1; i &lt;= n; ++i) &#123;        a.push_back(std::vector&lt;int&gt;(m + 1));        b.push_back(std::vector&lt;int&gt;(m + 1));        for (int j = 1; j &lt;= m; ++j)            read(a[i][j]);    &#125;    c = b, read(k);    for (int i = 1; i &lt;= k; ++i) &#123;        read(x), read(y), ++x, ++y;        b[x][y] = 1;        if (x + 1 &lt;= n &amp;&amp; !b[x + 1][y]) b[x + 1][y] = 2;        if (y + 1 &lt;= m &amp;&amp; !b[x][y + 1]) b[x][y + 1] = 2;        if (x - 1 &gt;= 1 &amp;&amp; !b[x - 1][y]) b[x - 1][y] = 2;        if (y - 1 &gt;= 1 &amp;&amp; !b[x][y - 1]) b[x][y - 1] = 2;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j) &#123;            if (b[i][j] &amp;&amp; !c[i][j]) &#123;                mn = inf;                cnt1 = cnt2 = sum = 0;                DFS(i, j);                if (cnt2 == cnt1 * 3) res += sum;                else if (cnt2 == cnt1 * 3 + 1) res += sum - mn;                else &#123; puts(&quot;No&quot;); return 0; &#125;            &#125;        &#125;    &#125;    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="c.-æ ‘å›¾">C. æ ‘å›¾</h3><p><a href="http://222.180.160.110:61235/contest/4424/problem/3" class="uri">http://222.180.160.110:61235/contest/4424/problem/3</a></p><blockquote><p>DJï¼šä½ ä»¬å»æ‰“ä¸€ä¸‹åŠ¨æ€æ ‘ DP çš„æ¿å­å°±å¯ä»¥äº†ã€‚</p></blockquote><p>æ­¤æ—¶æ— å£°èƒœæœ‰å£°ã€‚</p><p>è¿™é‡Œä»…ä»…ä»‹ç»ä¸€ä¸‹ 40pts çš„åšæ³•ã€‚æˆ‘ä»¬ç†æ‰€å½“ç„¶åœ°æƒ³åˆ° DP ä¸€ä¸ªç‚¹æŸ“æˆæŸç§é¢œè‰²æ‰€éœ€çš„æœ€å°ä»£ä»·ã€‚</p><p>è¿™é‡Œè¯´çš„æŸ“æˆæŸç§é¢œè‰²å…¶å®ä¸å¤ªå‡†ç¡®ï¼Œåº”è¯¥æ˜¯ã€Œä»£è¡¨ç€ã€å“ªç§é¢œè‰²ã€‚åƒ 0 å¯ä»¥ä»£è¡¨ 1 ä¹Ÿå¯ä»¥ä»£è¡¨ 2ï¼Œ1 å°±åªèƒ½ä»£è¡¨ 1ï¼Œ2 ä¹Ÿåªèƒ½ä»£è¡¨ 2ã€‚</p><p>ä»¤ <span class="math inline">\(f_{u,1}\)</span> è¡¨ç¤ºä»¥ <span class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­ä¸ä¿ç•™é¢œè‰² 2 çš„æœ€å°ä»£ä»·ï¼ˆä»£è¡¨ 1ï¼‰ï¼Œ<span class="math inline">\(f_{u, 2}\)</span> è¡¨ç¤ºä»¥ <span class="math inline">\(u\)</span> ä¸ºæ ¹çš„å­æ ‘ä¸­ä¸ä¿ç•™é¢œè‰² 1 çš„æœ€å°ä»£ä»·ï¼ˆä»£è¡¨ 2ï¼‰ã€‚</p><p>é‚£ä¹ˆå¯¹äºé¢œè‰²å·²ç»ç¡®å®šä¸º <span class="math inline">\(1\)</span> çš„ç‚¹ <span class="math inline">\(u_1\)</span>ï¼Œ<span class="math inline">\(f_{u_1,2}=\inf\)</span>ï¼›å¯¹äºé¢œè‰²å·²ç»ç¡®å®šä¸º <span class="math inline">\(2\)</span> çš„ç‚¹ <span class="math inline">\(u_2\)</span>ï¼Œ<span class="math inline">\(f_{u_2,1}=\inf\)</span>ï¼›é¢œè‰²ä¸º 0 çš„ <span class="math inline">\(u_0\)</span> å°±ä¸ç”¨ç®¡ã€‚</p><p>ç„¶åå¦‚æœ <span class="math inline">\(u_1\)</span> æœ‰ä¸€ä¸ª 2 é¢œè‰²çš„å„¿å­ <span class="math inline">\(v_2\)</span>ï¼Œå°±è¦åˆ‡æ–­è¿™æ¡è¾¹ï¼›åä¹‹ï¼Œå¦‚æœè¿™ä¸ªå„¿å­çš„é¢œè‰²ä¸º 1ï¼Œå°±ä¸ç”¨åˆ‡æ–­ã€‚</p><p>æ‰€ä»¥æœ‰ï¼š</p><p><span class="math display">\[f_{u,c}=\sum_{v\in son_u} \min(f_{v,c},f_{v,3-c}+1)\]</span></p><p>é‚£ä¹ˆå°±å®Œäº†ã€‚æ¯æ¬¡è¯¢é—®çš„æ—¶å€™è·‘ä¸€ä¸ªå®Œæ•´çš„æ ‘ DPï¼Œæˆ–è€…æˆ‘ä»¬ä¹Ÿå¯ä»¥å‘ç°åªç”¨æ›´æ–° <span class="math inline">\(u\)</span> åˆ°ç›®æ ‡ç‚¹è¿™ä¸€æ¡é“¾ä¸Šçš„ DP å€¼ï¼Œç„¶åå°±å¯ä»¥æ ¹æ®è¿™ä¸ªåšä¸€ä¸ªå¹¶ä¸ä¼šå®é™…æ”¹è¿›å¤æ‚åº¦çš„ä¼˜åŒ–ã€‚</p><p>æ€»ä½“æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(nq)\)</span>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;const int inf = 0x3f3f3f3f;int col[maxn];int f[maxn][3];int n, x, y, q;std::vector&lt;int&gt; g[maxn];int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;void DFS(int x, int fa, int to) &#123;    f[x][1] = f[x][2] = 0;    if (col[x] == 1) f[x][2] = inf;    else if (col[x] == 2) f[x][1] = inf;    for (auto i : g[x]) &#123;        if (i == fa) continue;        if (x != to) DFS(i, x, to);        f[x][1] += min(f[i][1], f[i][2] + 1);        f[x][2] += min(f[i][2], f[i][1] + 1);    &#125;    return;&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;#ifdef ONLINE_JUDGE     freopen(&quot;diagrams.in&quot;, &quot;r&quot;, stdin);    freopen(&quot;diagrams.out&quot;, &quot;w&quot;, stdout);#endif    read(n);    for (int i = 1; i &lt; n; ++i) &#123;        read(x), read(y);        add(x, y), add(y, x);    &#125;    read(q);    while (q--) &#123;        read(x), read(y);        col[y] = (x &lt;= 2) ? x : 0;        DFS(1, -1, y);        print(min(f[1][1], f[1][2]), &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="e.-å­—ç¬¦ä¸²-string">E. å­—ç¬¦ä¸² string</h3><p><a href="http://222.180.160.110:61235/contest/4423/problem/5" class="uri">http://222.180.160.110:61235/contest/4423/problem/5</a></p><p>åŸé¢˜ï¼š<a href="https://codeforces.com/problemset/problem/756/D">CF756D - Bacterial Melee</a>ã€‚</p><details><p><summary>æ€ªè¯</summary></p><p>å…”å­ï¼šæˆ‘è°´è´£ä½ ã€‚</p><p>æˆ‘ï¼šï¼Ÿ</p><p>å…”å­ï¼šä¸ºä»€ä¹ˆä½ çš„ last è¦ç¼©å†™æˆ <code>la</code>ã€‚æˆ‘æ²¡çœ‹ä½ é¢˜è§£ç›´æ¥çœ‹çš„ä»£ç çœ‹äº†åŠå¤©æ²¡çœ‹æ‡‚ã€‚</p><p>æˆ‘ï¼šä¸ç¼©å†™æˆ <code>la</code> éš¾é“è¦å†™æˆ <code>lst</code> å—ï¼Ÿ</p><p>å…”å­ï¼šä¸ç„¶å‘¢ï¼Ÿ</p><p>å¥½å§ï¼Œå¤§å®¶éƒ½æ˜¯å¼‚æ•™å¾’ã€‚</p></details><p>å¯ä»¥å¾ˆç®€å•çš„æƒ³åˆ°ï¼Œæœ€ç»ˆå­—ç¬¦ä¸²ä¸€å®šç”±åŸä¸²ä¸­çš„éƒ¨åˆ†å­—ç¬¦ï¼ŒæŒ‰ç…§å…¶åœ¨åŸä¸²ä¸­çš„é¡ºåºï¼Œç»è¿‡è‹¥å¹²æ¬¡é‡å¤å¾—åˆ°ã€‚é‚£ä¹ˆæˆ‘ä»¬æŠŠä¸€æ®µè¿ç»­çš„ç›¸åŒå­—ç¬¦è§†ä¸ºä¸€ä¸ªå­—ç¬¦ï¼Œå¾—åˆ°çš„è¿™ä¸ªä¸²å°±æ˜¯åŸä¸²çš„ä¸€ä¸ªå­åºåˆ—ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ±‚å‡ºåŸä¸²çš„ä¸åŒå­åºåˆ—ä¸ªæ•°ï¼Œå†ç»è¿‡ä¸€å®šçš„æ’åˆ—ç»„åˆå°±å¯ä»¥æ±‚å‡ºæ–¹æ¡ˆæ•°ã€‚</p><p>æ¯”å¦‚ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(n\)</span> çš„ä¸²ä¸­æœ‰ <span class="math inline">\(k\)</span> ä¸ªé•¿åº¦ä¸º <span class="math inline">\(m\)</span> çš„å­åºåˆ—ï¼Œé‚£ä¹ˆç”±æ’æ¿æ³•å¯å¾—è¿™ <span class="math inline">\(k\)</span> ä¸ªå­åºåˆ—ä¼šè´¡çŒ® <span class="math inline">\(C_{n-1}^{m-1}\times k\)</span> çš„æ–¹æ¡ˆæ•°ã€‚</p><p>é‚£ä¹ˆä¸åŒå­åºåˆ—ä¸ªæ•°æ€ä¹ˆæ±‚å‘¢ï¼Ÿæ˜¾è€Œæ˜“è§éœ€è¦ DPï¼Œè§„å®š <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºä¸€ä¸ªé•¿åº¦ä¸º <span class="math inline">\(i\)</span> çš„å­åºåˆ—æœ€åä¸€ä½ä¸º <span class="math inline">\(s_j\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç›´æ¥ <span class="math inline">\(f_{i,j}=\sum f_{i-1,k}\)</span>ã€‚</p><p>ä½†è¿™æ ·åšæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¼šé‡å¤è®¡ç®—ã€‚å‡å¦‚åŸä¸²ä¸­åœ¨ <span class="math inline">\(i\)</span> ä½ç½®æœ‰ä¸€ä¸ª <code>'o'</code>ï¼Œ<span class="math inline">\(i+1\)</span> ä½ç½®åˆæœ‰ä¸€ä¸ª <code>'o'</code>ï¼Œä¸¤ä¸ªéƒ½å¯ä»¥ä»å‰é¢æŸä¸ªä½ç½®ï¼ˆå‡è®¾ä¸º <span class="math inline">\(j\)</span>ï¼›å‡è®¾ <span class="math inline">\(j\)</span> ä¸Šå…¶ä¸­ä¸€ä¸ªè¢«è®¡å…¥æ–¹æ¡ˆæ•°çš„åˆæ³•å­åºåˆ—ä¸º <code>"hyac"</code>ï¼‰ï¼Œé‚£ä¹ˆè½¬ç§»åˆ° <span class="math inline">\(i\)</span> æ—¶ï¼Œè®¡ç®—äº† <code>"hyaco"</code>ï¼Œåˆ°äº† <span class="math inline">\(i+1\)</span>ï¼Œä¾ç„¶å¯ä»¥ä» <span class="math inline">\(j\)</span> å¤„å¾—åˆ° <code>"hyaco"</code>ï¼Œå°±ä¼šé‡å¤è®¡ç®—ã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆé¿å…è¿™ä¸€ç‚¹å‘¢ï¼Ÿå¯¹äºä¸€ä¸ªä½ç½® <span class="math inline">\(i\)</span>ï¼Œå‡è®¾å…¶ä¸Šä¸€ä¸ªç›¸åŒå­—æ¯çš„ä½ç½®ä¸º <span class="math inline">\(last_i\)</span>ï¼Œæˆ‘ä»¬è§„å®šå…¶ä»…å¯ä» <span class="math inline">\((last_i,i)\)</span> è¿›è¡Œè½¬ç§»å³å¯ï¼ˆæ³¨æ„ä¸¤è¾¹éƒ½æ˜¯å¼€åŒºé—´ï¼‰ã€‚</p><p>åˆå§‹åŒ–æ˜¯å¯¹äºæ¯ä¸€ä¸ªæ²¡æœ‰å‰é©±çš„ <span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\(f_{1,i}=1\)</span>ã€‚</p><p>å®ç°ä¸Šï¼Œå› ä¸º <span class="math inline">\(n\)</span> çš„å¤§å°æ˜¯ <span class="math inline">\(5\times 10^3\)</span>ï¼Œè½¬ç§»åŒºé—´åˆæ˜¯è¿ç»­çš„ï¼Œæˆ‘ä»¬ç”¨ä¸€ä¸ªå‰ç¼€å’Œè¿›è¡Œä¼˜åŒ–å³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ï¼Œåº”è¯¥æ¯”å®˜æ–¹é¢˜è§£è®²çš„æ–¹æ³•å…·è±¡ä¸€äº›ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int mod = 1e9 + 7;const int maxn = 5e3 + 5;int n, res;char s[maxn];int fac[maxn];int la[maxn], p[maxn];int f[maxn][maxn], u[maxn][maxn];int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;int qkp(int x, int y) &#123;    int res = 1;    while (y) &#123;        if (y &amp; 1) (res *= x) %= mod;        (x *= x) %= mod, y &gt;&gt;= 1;    &#125;    return res;&#125;int inv(int x) &#123; return qkp(x, mod - 2); &#125;int A(int n, int m) &#123;    return fac[n] * inv(fac[n - m]) % mod;&#125;int C(int n, int m) &#123;    return A(n, m) * inv(fac[m]) % mod;&#125;int main() &#123;    scanf(&quot;%lld %s&quot;, &amp;n, s + 1);    fac[0] = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        la[i] = p[s[i] - &#39;a&#39; + 1];        if (!la[i]) f[1][i] = 1, ++res;        u[1][i] = u[1][i - 1] + f[1][i];        p[s[i] - &#39;a&#39; + 1] = i;        fac[i] = (fac[i - 1] * i) % mod;    &#125;    for (int i = 2; i &lt;= n; ++i) &#123;        int sum = 0;        for (int j = i; j &lt;= n; ++j) &#123;            int k = max(i - 1, la[j] + 1);            if (k &lt;= j - 1)                f[i][j] = (u[i - 1][j - 1] - u[i - 1][k - 1]) % mod;            u[i][j] = (u[i][j - 1] + f[i][j]) % mod;            (sum += f[i][j]) %= mod;        &#125;        res += C(n - 1, i - 1) * sum % mod;        res %= mod;    &#125;    res = (res + mod) % mod;    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="abc328f---good-set-query">ABC328F - Good Set Query</h3><p><a href="https://atcoder.jp/contests/abc328/tasks/abc328_f" class="uri">https://atcoder.jp/contests/abc328/tasks/abc328_f</a></p><p>ä¸€ä¸ªåŠ æƒå¹¶æŸ¥é›†ã€‚</p><p>æˆ‘ä»¬ç”¨å¹¶æŸ¥é›†ç»´æŠ¤å…³ç³»ï¼Œåœ¨åˆå¹¶ä¸¤ä¸ªé›†åˆçš„æ—¶å€™ç»™è¢«åˆå¹¶è€…çš„åŸæœ¬æ ¹æ‰“ä¸€ä¸ªæ‡’æ ‡è®°ï¼Œæ„ä¸ºè¯¥å¹¶æŸ¥é›†éœ€è¦æ•´ä½“æ›´æ–°çš„ deltaã€‚</p><p>åœ¨æ¯æ¬¡ <code>find</code> æ—¶ï¼Œè·¯å¾„ä¸Šçš„ç‚¹å‡ä» <strong>ç›´ç³»çˆ¶äº²</strong> å¤„ç»§æ‰¿æ‡’æ ‡è®°ã€‚ç„¶åå› ä¸ºæœ‰äº†è·¯å¾„å‹ç¼©ï¼Œæ‰€ä»¥æ¯ä¸ªç‚¹åœ¨æŸ¥è¯¢æ—¶å‡èƒ½å¾—åˆ°ä¸é‡å¤çš„æ‡’æ ‡è®°ï¼ˆå› ä¸ºè‡ªå·±çš„ç¥–å…ˆå·²ç»è¢«ç›´ç³»çˆ¶äº²ç»§æ‰¿è¿‡äº†ï¼‰ã€‚</p><p>åŒæ ·ä¹Ÿæ˜¯å› ä¸ºå¼±åŠ¿ä¸€æ–¹æ‰è¢«æ‰“æ ‡è®°ï¼Œä¿è¯äº†æ ¹èŠ‚ç‚¹ä¸Šä¸ä¼šæœ‰æ ‡è®°ï¼Œè·¯å¾„å‹ç¼©åå°±å°†çˆ¶äº²æ›´æ–°ä¸ºæ ¹ï¼Œä¿è¯ä¸ä¼šå› ä¸ºå¤šæ¬¡ <code>find</code> å¯¼è‡´æ ‡è®°é‡å¤è®¡ç®—ã€‚</p><p>æ¯æ¬¡å°è¯•åˆå¹¶çš„æ—¶å€™ï¼Œå› ä¸ºé¦–å…ˆéœ€è¦è¿›è¡Œ <code>find</code>ï¼Œä¿è¯ <span class="math inline">\(x\)</span> å’Œ <span class="math inline">\(y\)</span> å‡æ˜¯æœ€æ–°çŠ¶æ€ã€‚è‹¥ <span class="math inline">\(x\)</span> å’Œ <span class="math inline">\(y\)</span> å·²ç»åœ¨åŒä¸€ä¸ªé›†åˆäº†ï¼Œç›´æ¥åˆ¤æ–­ä¸¤ä¸ªå·®å€¼æ˜¯å¦ä¸º <span class="math inline">\(d\)</span>ï¼›å¦åˆ™ï¼Œåˆå¹¶ä¸¤ä¸ªé›†åˆå¹¶ç»™å¼±åŠ¿æ–¹æ‰“ä¸Šæ ‡è®°ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int maxn = 2e5 + 5;int n, q, x, y, d;int f[maxn], u[maxn];int find(int x) &#123;    if (f[x] == x) return x;    int fa = find(f[x]);    u[x] += u[f[x]];    return f[x] = fa;&#125;bool merge(int x, int y, int d) &#123;    int fx = find(x), fy = find(y);    if (fx == fy) return u[x] - u[y] == d;    f[fx] = fy, u[fx] = d - (u[x] - u[y]);    return 1;&#125;int main() &#123;    read(n), read(q);    for (int i = 1; i &lt;= n; ++i)        f[i] = i;    for (int i = 1; i &lt;= q; ++i) &#123;        read(x), read(y), read(d);        if (merge(x, y, d)) print(i, &#39; &#39;);    &#125;    putchar(&#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="cf1701f---points">CF1701F - Points</h3><p><a href="http://codeforces.com/problemset/problem/1701/F" class="uri">http://codeforces.com/problemset/problem/1701/F</a></p><p>æˆ‘ä»¬å…ˆè€ƒè™‘å¯¹äºä¸€ä¸ªå•ç‚¹ <span class="math inline">\(p\)</span>ï¼Œå‡è®¾ <span class="math inline">\([p-d, p)\)</span> ä¸­å…±æœ‰ <span class="math inline">\(k\)</span> ä¸ªç‚¹ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(C_k^2=\dfrac {k(k-1)}2\)</span>ã€‚</p><p>å‡å¦‚èŒƒå›´å†…æ–°åŠ å…¥äº†ä¸€ä¸ªç‚¹ï¼Œ<span class="math inline">\(k\gets k+1\)</span>ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(C_{k+1}^2=\dfrac {k(k+1)}{2}\)</span>ï¼Œè¾ƒåŸæ¥å¢åŠ äº† <span class="math inline">\(k\)</span>ã€‚ç›¸åº”åœ°ï¼Œè‹¥èŒƒå›´å†…å‡å°‘äº†ä¸€ä¸ªç‚¹ï¼Œ<span class="math inline">\(k\gets k-1\)</span>ï¼Œç­”æ¡ˆè¾ƒåŸæ¥å°±ä¼šå‡å°‘ <span class="math inline">\(k-1\)</span>ã€‚</p><p>å½“æˆ‘ä»¬åŠ å…¥ä¸€ä¸ªç‚¹ <span class="math inline">\(p\)</span>ï¼ŒåŒºé—´ <span class="math inline">\((p,p+d]\)</span> éƒ½ä¼šæ”¶åˆ°å½±å“ã€‚å‡è®¾è¯¥åŒºé—´å†…åŸæœ¬çš„æ¯ä¸ªç‚¹ä¹‹ <span class="math inline">\(k\)</span> çš„å’Œæ˜¯ <span class="math inline">\(s_k\)</span>ï¼Œé‚£ä¹ˆæ€»ä½“çš„ç­”æ¡ˆå°±ä¼šå‡å°‘ <span class="math inline">\(s_k\)</span>ã€‚</p><p>é‚£ä¹ˆ <span class="math inline">\(s_k\)</span> æ€ä¹ˆå»ç»´æŠ¤å‘¢ï¼Ÿæ’å…¥ç‚¹ <span class="math inline">\(p\)</span> æ—¶ï¼Œç­”æ¡ˆå…ˆåŠ ä¸Šå½“å‰ <span class="math inline">\(s_k\)</span> å’Œæ–°ç‚¹çš„ <span class="math inline">\(k\)</span>ï¼Œå†å°† <span class="math inline">\((p, p+d]\)</span> å†…çš„ <span class="math inline">\(s_k\)</span> å…¨éƒ¨ +1ï¼›åˆ é™¤ç‚¹ <span class="math inline">\(p\)</span> æ—¶ï¼Œç­”æ¡ˆå‡å» <span class="math inline">\(s_k-c\)</span> å’Œå¾…åˆ ç‚¹çš„ç­”æ¡ˆï¼ˆå…¶ä¸­ <span class="math inline">\(c\)</span> æ˜¯ <span class="math inline">\((p,p+d]\)</span> ä¸­çš„ç‚¹æ•°ï¼‰ï¼Œå†å°† <span class="math inline">\((p, p+d]\)</span> å†…çš„ <span class="math inline">\(s_k\)</span> å…¨éƒ¨ -1ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int lim = 2e5;const int maxn = 2e5 + 5;#define lt (p &lt;&lt; 1)#define rt (lt | 1)struct _ &#123; int u, p, d, l, r; &#125;;_ t[maxn &lt;&lt; 2];int q, d, x, res;int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;void pushdown(int p) &#123;    if (t[p].d) &#123;        t[lt].u += t[lt].p * t[p].d;        t[rt].u += t[rt].p * t[p].d;        t[lt].d += t[p].d;        t[rt].d += t[p].d;        t[p].d = 0;    &#125;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r;    if (l == r) return;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    return;&#125;int ask(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p].p;    int res = 0, mid = (t[p].l + t[p].r) &gt;&gt; 1;    if (l &lt;= mid) res = ask(lt, l, r);    if (r &gt; mid) res += ask(rt, l, r);    return res;&#125;int qry(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p].u;    int res = 0, mid = (t[p].l + t[p].r) &gt;&gt; 1;    pushdown(p);    if (l &lt;= mid) res = qry(lt, l, r);    if (r &gt; mid) res += qry(rt, l, r);    return res;&#125;void upd(int p, int l, int r, int x) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        t[p].d += x;        t[p].u += t[p].p * x;        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    pushdown(p);    if (l &lt;= mid) upd(lt, l, r, x);    if (r &gt; mid) upd(rt, l, r, x);    t[p].u = t[lt].u + t[rt].u;    return;&#125;void clr(int p, int x) &#123;    --t[p].p;    if (t[p].l == t[p].r) &#123;        res -= t[p].u * (t[p].u - 1) / 2;        t[p].u = t[p].d = t[p].p = 0;        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    pushdown(p);    if (x &lt;= mid) clr(lt, x);    else clr(rt, x);    t[p].u = t[lt].u + t[rt].u;    return;&#125;void add(int p, int x, int v) &#123;    ++t[p].p;    if (t[p].l == t[p].r) &#123;        res += v * (v - 1) / 2;        t[p].u = v, t[p].p = 1;        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    pushdown(p);    if (x &lt;= mid) add(lt, x, v);    else add(rt, x, v);    t[p].u = t[lt].u + t[rt].u;    return;&#125;void upd(int l, int r, int x) &#123;    upd(1, min(l, lim), min(r, lim), x);    return;&#125;int qry(int l, int r) &#123;    return qry(1, min(l, lim), min(r, lim));&#125;int ask(int l, int r) &#123;    return ask(1, max(1, min(l, lim)), max(1, min(r, lim)));&#125;int main() &#123;    read(q), read(d);    bld(1, 1, lim);    while (q--) &#123;        read(x);        if (ask(x, x)) &#123;            int u = qry(x + 1, x + d) - ask(x + 1, x + d);            res -= u, upd(x + 1, x + d, -1), clr(1, x);        &#125;        else &#123;            int u = qry(x + 1, x + d);            res += u, upd(x + 1, x + d, 1);            add(1, x, ask(x - d, x - 1));        &#125;        print(res, &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ„é€ </title>
      <link href="/20231005/"/>
      <url>/20231005/</url>
      
        <content type="html"><![CDATA[<p><a href="https://vjudge.net/contest/585791">æ„é€ æ‚é¢˜</a>ã€‚</p><span id="more"></span><hr /><h3 id="a---errich-tac-toe-hard-version">A - Errich-Tac-Toe (Hard Version)</h3><p><a href="https://vjudge.net/contest/585791#problem/A" class="uri">https://vjudge.net/contest/585791#problem/A</a></p><p>å¦‚æœæˆ‘ä»¬å°†åœ°å›¾æŒ‰å›½é™…è±¡æ£‹å¼æ–œå‘é»‘ç™½æŸ“è‰²åˆ†ç»„ï¼Œè§„å®šé»‘ç»„è¦ä¹ˆé»‘è‰²è¦ä¹ˆæ— è‰²ï¼Œç™½ç»„è¦ä¹ˆç™½è‰²è¦ä¹ˆæ— è‰²ï¼Œé‚£ä¹ˆè¿™æ ·æ˜¯ä¸€å®šä¸ä¼šä¸‰è¿å‡»çš„ã€‚</p><p><img src="https://pic.imgdb.cn/item/651e6652c458853aef280846.jpg" /></p><p>å®¹æ˜“å‘ç°æ— è‰²æ ¼å­æ°¸è¿œä¸ä¼šè¢«æ›´æ”¹ï¼Œè€Œåœ¨æ–¹å¼ A ä¸­è¢«æ›´æ”¹çš„æ ¼å­åœ¨æ–¹å¼ B ä¸­ä¸€å®šä¸ä¼šè¢«æ›´æ”¹ï¼›ç›¸åº”åœ°ï¼Œåœ¨æ–¹å¼ A ä¸­ä¸è¢«æ›´æ”¹çš„æ ¼å­åœ¨æ–¹å¼ B ä¸­ä¸€å®šä¼šè¢«æ›´æ”¹ï¼Œæ•…ä¸¤ç§æŸ“è‰²æ–¹å¼æ›´æ”¹çš„æ ¼å­æ•°æ€»å’Œå°±æ˜¯ä¸€å¼€å§‹éæ— è‰²çš„æ ¼å­æ•°ã€‚æ‰€ä»¥æ ¹æ®æŠ½å±‰åŸç†ï¼Œä¸€å®šèƒ½æ‰¾åˆ°ä¸€ç§æŸ“è‰²æ–¹å¼ï¼Œä»£ä»· <span class="math inline">\(\le \dfrac k2\)</span>ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬è¦æ‰¾åˆ°çš„ï¼Œæ˜¯ä»£ä»· <span class="math inline">\(\le \dfrac k3\)</span> çš„æ–¹æ¡ˆå‘€ï¼Ÿæˆ‘ä»¬è§‚å¯Ÿåˆ°æˆ‘ä»¬ä¸Šé¢çš„åˆ†ç»„æ–¹å¼ï¼Œç›´æ¥è®©ç›¸é‚»ä¸¤ä¸ªä¸ä¸€æ ·äº†ï¼Œè¿äºŒè¿å‡»éƒ½åšä¸åˆ°ï¼›æ‰€ä»¥æˆ‘ä»¬è¦ä½¿æˆ‘ä»¬çš„æŸ“è‰²æ–¹å¼æ›´å»‰ä»·ã€‚</p><p>æˆ‘ä»¬ä»ç„¶æ–œå‘æŸ“è‰²ï¼Œä½†æ˜¯åˆ†ä¸ºä¸‰ç»„ï¼š</p><p><img src="https://pic.imgdb.cn/item/651e691fc458853aef28c528.jpg" /></p><p>è¿™æ ·ï¼Œå› ä¸ºåˆšæ‰å™è¿°è¿‡çš„åŸå› ï¼Œä¸€å®šèƒ½æ‰¾åˆ°ä¸€ç§æŸ“è‰²æ–¹æ³•ï¼Œä»£ä»· <span class="math inline">\(\le \dfrac k3\)</span>ã€‚</p><p>æšä¸¾ä¸‰ç§æ–¹å¼ï¼Œå–ä»£ä»·æœ€å°çš„ä¸€ç§å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 305;char a[maxn][maxn];int col[maxn][maxn];int T, n, res, id, typ;int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int func(int x, int y) &#123;    int res = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j) &#123;            if (col[i][j] == y)                res += (a[i][j] == &#39;X&#39;);            else if (col[i][j] != x)                res += (a[i][j] == &#39;O&#39;);        &#125;    &#125;    return res;&#125;int main() &#123;    scanf(&quot;%d&quot;, &amp;T);    while (T--) &#123;        scanf(&quot;%d&quot;, &amp;n);        int cnt = 0;        for (int i = 1; i &lt;= n; ++i)            scanf(&quot;%s&quot;, a[i] + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= n; ++j)                cnt += (a[i][j] != &#39;.&#39;);            for (int j = 1; j &lt;= i; ++j)                col[j][i - j + 1] = (i - 1) % 3 + 1;        &#125;        for (int i = 2; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= n - i + 1; ++j)                col[j + i - 1][n - j + 1] = (n + i - 2) % 3 + 1;        &#125;        res = func(1, 2), id = 1, typ = 2;        if (func(1, 3) &lt; res)            res = func(1, 3), id = 1, typ = 3;        if (func(2, 1) &lt; res)            res = func(2, 1), id = 2, typ = 1;        if (func(2, 3) &lt; res)            res = func(2, 3), id = 2, typ = 3;        if (func(3, 1) &lt; res)            res = func(3, 1), id = 3, typ = 1;        if (func(3, 2) &lt; res)            res = func(3, 2), id = 3, typ = 2;        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= n; ++j) &#123;                if (col[i][j] == typ) &#123;                    if (a[i][j] == &#39;X&#39;)                        a[i][j] = &#39;O&#39;;                &#125;                else if (col[i][j] != id) &#123;                    if (a[i][j] == &#39;O&#39;)                        a[i][j] = &#39;X&#39;;                &#125;            &#125;        &#125;        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= n; ++j)                putchar(a[i][j]);            putchar(&#39;\n&#39;);        &#125;    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><p>æŠ½å±‰åŸç†æ˜¯æ„é€ ä¸­ç»å¸¸ç”¨åˆ°çš„æ‰‹æ®µï¼Œåé¢æˆ‘ä»¬ä¹Ÿä¼šé‡åˆ°è¿ç”¨äº†æŠ½å±‰åŸç†çš„æ›´å¤šé¢˜ç›®ã€‚</p><hr /><h3 id="b---mine-sweeper-ii">B - Mine Sweeper II</h3><p><a href="https://vjudge.net/contest/585791#problem/B" class="uri">https://vjudge.net/contest/585791#problem/B</a></p><p>è§‚å¯Ÿåˆ°ç­”æ¡ˆå¿…é¡» <span class="math inline">\(\le \dfrac {n\times m}2\)</span>ï¼Œæ ¹æ®åœ¨ä¸Šä¸€é“é¢˜ç›®å¾—åˆ°çš„ç»éªŒï¼Œè€ƒè™‘æ‰¾åˆ°ä¸¤ç§åœ°ä½ç›¸ç­‰ã€å¹¶å®Œå…¨ç›¸åçš„æ–¹æ¡ˆã€‚</p><p>æˆ‘ä»¬çŸ¥é“ï¼ŒæŠŠ B å˜æˆ A ä¸€å®šå¯ä»¥æ»¡è¶³æ¡ä»¶ï¼›ä»ã€Œå®Œå…¨ç›¸åã€å‡ºå‘ï¼Œè€ƒè™‘æŠŠæ‰€æœ‰é›·å˜æˆç©ºåœ°ã€æ‰€æœ‰ç©ºåœ°å˜æˆé›·ã€‚</p><p>å°†ç©ºåœ°ä¸Šçš„æ•°å­—è§†ä¸ºç”±ç©ºåœ°å‘å‘¨å›´å…«æ ¼çš„é›·è¿è¾¹ï¼Œå¯ä»¥è¿åˆ°çš„è¾¹çš„æ•°é‡ã€‚å°†åœ°å›¾å®Œå…¨ç¿»è½¬åï¼Œè¾¹é™¤äº†èµ·ç‚¹å’Œç»ˆç‚¹ç¿»è½¬ä¹‹å¤–ï¼Œ<strong>æ²¡æœ‰ä»»ä½•å˜åŒ–</strong>ã€‚æ‰€ä»¥ï¼Œæ•°å­—ä¹‹å’Œä¸å˜ã€‚</p><p>ç”±æ­¤æˆ‘ä»¬å°±å¾—åˆ°äº†åˆ†ä¸¤ç»„çš„æ–¹æ¡ˆï¼Œç”±æŠ½å±‰åŸç†ï¼Œå¿…æœ‰ä¸€ç»„æ–¹æ¡ˆçš„ä»£ä»· <span class="math inline">\(\le \dfrac {n\times m}2\)</span>ï¼Œå–è¾ƒå°è€…å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e3 + 5;int n, m, res1, res2;char a[maxn][maxn], b[maxn][maxn];int main() &#123;    scanf(&quot;%d %d&quot;, &amp;n, &amp;m);    for (int i = 1; i &lt;= n; ++i)        scanf(&quot;%s&quot;, a[i] + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        scanf(&quot;%s&quot;, b[i] + 1);        for (int j = 1; j &lt;= m; ++j) &#123;            res1 += (a[i][j] != b[i][j]);            res2 += (a[i][j] == b[i][j]);        &#125;    &#125;    if (res1 &lt; res2) &#123;        for (int i = 1; i &lt;= n; ++i)            puts(a[i] + 1);    &#125;    else &#123;        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= m; ++j) &#123;                if (a[i][j] == &#39;.&#39;)                    putchar(&#39;X&#39;);                else putchar(&#39;.&#39;);            &#125;            putchar(&#39;\n&#39;);        &#125;    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="c---ehabs-last-corollary">C - Ehabâ€™s Last Corollary</h3><p><a href="https://vjudge.net/contest/585791#problem/C" class="uri">https://vjudge.net/contest/585791#problem/C</a></p><p>æˆ‘ä»¬å°è¯•è¯æ˜å‡ºé¢˜äººçš„çŒœæƒ³â€¦â€¦</p><ul><li><p>å¦‚æœæ•´ä¸ªå›¾ä¸Šæ²¡æœ‰ç¯ï¼Œå°±æ•´ä¸ªä¸€æ£µæ ‘</p>æ ‘å‘¢ï¼Œæ˜¯ä¸€ä¸ªäºŒåˆ†å›¾å¯¹ä¸å¯¹ï¼Œç„¶åæŠ½å±‰åŸç†ï¼Œæˆ‘ä»¬çœ‹ä¸¤éƒ¨èŠ‚ç‚¹ä¸­æ¯”è¾ƒå¤§çš„é‚£ä¸€å¨ï¼Œå®ƒçš„å¤§å°ä¸€å®šæ˜¯ <span class="math inline">\(\ge \dfrac n2\)</span> åˆ <span class="math inline">\(\ge \dfrac k2\)</span> çš„ï¼Œç›´æ¥è¾“å‡ºå°±å¥½äº†ã€‚</li><li>å¦åˆ™ï¼Œå¯¹äºä¸€ä¸ªç¯ï¼Œå¦‚æœå®ƒçš„ç‚¹æ•°å°äºç­‰äº <span class="math inline">\(k\)</span>ï¼Œé‚£æˆ‘ä»¬ç›´æ¥å°†å®ƒä½œä¸ºç¬¬äºŒä¸ªé—®é¢˜çš„ç­”æ¡ˆè¾“å‡ºã€‚</li><li><p>å¦åˆ™ï¼Œæˆ‘ä»¬åœ¨å›¾çš„æœ€å°ç¯ä¸Šéš”ä¸€ä¸ªç‚¹é€‰ä¸€ä¸ªç‚¹ï¼Œä¸€å®šèƒ½é€‰å‡º <span class="math inline">\(\left\lfloor\dfrac k2\right\rfloor\)</span> ä¸ªç›¸äº’ç‹¬ç«‹çš„ç‚¹ã€‚ä½ è¯´ä¸ºä»€ä¹ˆå®ƒä»¬ä¹‹é—´æ²¡æœ‰ç›´æ¥è¿è¾¹å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬æ˜¯åœ¨ä¸€ä¸ªæ¯” <span class="math inline">\(k\)</span> å¤§çš„æœ€å°ç¯ä¸Šé€‰çš„ï¼Œè¦æ˜¯å®ƒä»¬ä¹‹é—´æœ‰ç›´æ¥è¿è¾¹ï¼Œé‚£å°±ä¼šåˆæ„æˆä¸€ä¸ªæ›´å°çš„ç¯äº†ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„ç¯ç„¶åæŒ‰ä¸Šè¿°æ“ä½œå¾—åˆ°ç­”æ¡ˆâ€¦â€¦ ç„¶è€Œæ‰¾æœ€å°ç¯è¿™ä¸€ç‚¹æœ¬èº«ä¸å¤ªç°å®â€¦â€¦</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬ç”¨ä¸€ç‚¹ç¥å¥‡ç§‘æŠ€ã€‚è€ƒè™‘å›¾çš„ DFS æ ‘ã€‚</p><ul><li>å¦‚æœæœ‰è¿”ç¥–è¾¹ <span class="math inline">\((v, u)\)</span>ï¼Œä¸”æ·±åº¦ <span class="math inline">\(d_v-d_u&lt; k\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\(u\to v\)</span> åœ¨æ ‘ä¸Šçš„ç®€å•è·¯å¾„å’Œè¿”ç¥–è¾¹ <span class="math inline">\((v, u)\)</span> å…±åŒæ„æˆä¸€ä¸ªé•¿åº¦ä¸è¶…è¿‡ <span class="math inline">\(k\)</span> çš„ç¯ï¼Œç›´æ¥è¾“å‡ºã€‚</li><li><p>å¦åˆ™ï¼Œå› ä¸º <span class="math inline">\(d_v-d_u\ge k\)</span>ï¼Œæœ‰ <span class="math inline">\(d_v\ge k\)</span>ï¼Œä¸”å¯¹äºä»»æ„ <span class="math inline">\(d_y-d_x&lt;k\)</span>ï¼Œè¿”ç¥–è¾¹ <span class="math inline">\((y,x)\)</span> ä¸å­˜åœ¨ã€‚</p><p>æˆ‘ä»¬ä»ç„¶è€ƒè™‘ä¸Šé¢æåˆ°çš„éš”ä¸€ä¸ªå–ä¸€ä¸ªçš„æ–¹æ³•ã€‚ä»ä»»æ„ <span class="math inline">\(d_v\ge k\)</span> å¼€å§‹å–ç‚¹ï¼Œåˆ†åˆ«å– <span class="math inline">\(v\)</span> çš„ <span class="math inline">\(0\)</span> ä»£çˆ¶è¾ˆï¼ˆå³è‡ªèº«ï¼‰ï¼Œ<span class="math inline">\(2\)</span> ä»£çˆ¶è¾ˆï¼ˆå³çˆ·çˆ·ï¼‰ï¼Œ<span class="math inline">\(4\)</span> ä»£çˆ¶è¾ˆâ€¦â€¦</p><p>ä¸ºä»€ä¹ˆè¿™ä¹ˆå–å°±ä¸ä¼šå‡º bug å‘¢ï¼Ÿå› ä¸ºæˆ‘ä»¬ä¸Šé¢æåˆ°çš„ã€Œå¯¹äºä»»æ„ <span class="math inline">\(d_y-d_x&lt;k\)</span>ï¼Œè¿”ç¥–è¾¹ <span class="math inline">\((y,x)\)</span> ä¸å­˜åœ¨ã€ï¼Œæ‰€ä»¥ä¸ä¼šæœ‰æ‚è¾¹å¹²æ‰°ã€‚</p></li></ul></li></ul><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n + m)\)</span>ã€‚åªèƒ½è¯´çœŸæ˜¯å¦™å•Šã€‚jly èµ›é«˜ï¼</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;bool vis[maxn];int n, m, k, x, y;int f[maxn], dep[maxn];std::vector&lt;int&gt; g[maxn];int col[maxn], cnt[5];void color(int x, int fa, int now) &#123;    col[x] = now, ++cnt[now];    for (auto i : g[x]) &#123;        if (i == fa) continue;        color(i, x, 3 - now);    &#125;    return;&#125;void DFS(int x, int fa) &#123;    vis[x] = 1;    for (auto i : g[x]) &#123;        if (i == fa) continue;        if (vis[i]) &#123;            if (dep[i] &lt; dep[x] &amp;&amp;                dep[x] - dep[i] &lt; k) &#123;                print(2, &#39;\n&#39;);                int p = x, cnt = 1;                while (p != i) ++cnt, p = f[p];                print(cnt, &#39;\n&#39;), p = x;                while (p != i) print(p, &#39; &#39;), p = f[p];                print(i, &#39;\n&#39;), exit(0);            &#125;            continue;        &#125;        f[i] = x;        dep[i] = dep[x] + 1;        DFS(i, x);    &#125;    return;&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;    read(n), read(m), read(k);    for (int i = 1; i &lt;= m; ++i) &#123;        read(x), read(y);        add(x, y), add(y, x);    &#125;    if (m == n - 1) &#123;        print(1, &#39;\n&#39;);        color(1, -1, 1);        k = (k + 1) / 2;        x = cnt[1] &gt; cnt[2] ? 1 : 2;        for (int i = 1; i &lt;= n &amp;&amp; k; ++i) &#123;            if (col[i] == x)                print(i, &#39; &#39;), --k;        &#125;        putchar(&#39;\n&#39;);        return 0;    &#125;    dep[1] = 1, DFS(1, -1);    for (int i = 1; i &lt;= n; ++i) &#123;        if (dep[i] &gt;= k) &#123;            print(1, &#39;\n&#39;);            x = i, k = (k + 1) / 2;            while (k--)                print(x, &#39; &#39;), x = f[f[x]];            putchar(&#39;\n&#39;);            break;        &#125;    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="d---æ™¯ç‚¹åˆ’åˆ†">D - æ™¯ç‚¹åˆ’åˆ†</h3><p><a href="https://vjudge.net/contest/585791#problem/D" class="uri">https://vjudge.net/contest/585791#problem/D</a></p><details><p><summary>ğŸ¤¡ å‰è¨€</summary></p><p>ä½ æ‰“å¼€äº†é¢˜ç›®ã€‚ä½ æƒ³ï¼Œä¸å°±æ˜¯ä»å›¾é‡ŒæŠ ä¸¤ä¸ªè¿é€šå—å‡ºæ¥å—ï¼Œè¿™ä¹Ÿèƒ½è¿› IOIï¼Ÿ</p><p>ä½ å¼€å§‹æ‰“ä»£ç ã€‚ä½ çªç„¶å‘ç°ä¸å¯¹åŠ²ã€‚ä½ æŠ æ‰äº†ä¸€ä¸ªå¤§å°ä¸º <span class="math inline">\(a\)</span> çš„è¿é€šå—ï¼Œç„¶åå‘ç°å‰©ä¸‹çš„éƒ¨åˆ†è£‚æˆäº†å¾ˆå¤šä¸ªå—ï¼Œå…¶ä¸­æ ¹æœ¬æ‰¾ä¸åˆ°ä¸€ä¸ªå¤§å° <span class="math inline">\(\ge b\)</span> çš„å—ã€‚</p><p>ä½ å‘ç°ï¼Œäº‹æƒ…æ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚</p><p>è¿™æ˜¯ä½ å—ï¼Ÿä¸ï¼Œè¿™ä¸æ˜¯ä½ ï¼Œè¿™æ˜¯æˆ‘ï¼Œå°ä¸‘ lym ğŸ¤¡</p></details><p>ä¸å¦¨è®¾ <span class="math inline">\(a\le b\le c\)</span>ï¼Œåˆ™ç”±æŠ½å±‰åŸç†ï¼Œ<span class="math inline">\(a\le \dfrac n3\)</span>ã€‚</p><p>æˆ‘ä»¬ä»æœ€ç‰¹æ®Šçš„æƒ…å†µå¼€å§‹æ€è€ƒã€‚å‡å¦‚å›¾æ˜¯æ ‘ï¼Œé‚£ä¹ˆç­”æ¡ˆæ€ä¹ˆæ±‚å‘¢ï¼Ÿ</p><p>å¯¹äºä»»æ„ä¸€æ¡è¾¹ï¼Œåœ¨å…¶å·¦å³ä¸¤è¾¹çš„è¿é€šå—ä¸­ï¼Œæ ¹æ®æŠ½å±‰åŸç†ï¼Œè¾ƒå¤§è€…çš„å¤§å°å¿…å®š <span class="math inline">\(\ge \dfrac{n}{2}\)</span>ï¼Œæ ¹æ®é‡å¿ƒçš„å®šä¹‰ï¼Œé‡å¿ƒå¿…ç„¶å±äºè¾ƒå¤§è¿é€šå—ã€‚</p><p>åé¢é¸½äº†ã€‚æ€»ä¹‹å…ˆæ”¾ä¸ªä»£ç åœ¨è¿™é‡Œã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;int org[5];bool book[maxn];int solFlag, sumFa, faP;int siz[maxn], col[maxn];int n, m, a, b, c, x, y, P;bool vis[maxn], legSon[maxn];std::vector&lt;int&gt; w[maxn], g[maxn];void DFS(int x, int fa) &#123;    bool flag = 1;    vis[x] = 1, siz[x] = 1;    for (auto i : w[x]) &#123;        if (vis[i]) continue;        DFS(i, x);        if (siz[i] &gt; n / 2) flag = 0;        siz[x] += siz[i];        g[x].push_back(i);    &#125;    if (n - siz[x] &gt; n / 2) flag = 0;    if (flag &amp;&amp; !P) &#123;        P = x, faP = fa;        if (n - siz[x] &gt;= a)            solFlag = fa;        else &#123;            for (auto i : g[x]) &#123;                if (siz[i] &gt;= a) &#123;                    solFlag = i;                    break;                &#125;            &#125;        &#125;    &#125;    return;&#125;void fillA(int x) &#123;    if (a == 0) return;    col[x] = 1, --a;    for (auto i : g[x]) fillA(i);    return;&#125;void fillB(int x) &#123;    if (b == 0) return;    col[x] = 2, --b;    for (auto i : g[x]) &#123;        if (x == P &amp;&amp; i == solFlag)            continue;        fillB(i);    &#125;    return;&#125;void fillC(void) &#123;    for (int i = 1; i &lt;= n; ++i)        if (!col[i]) col[i] = 3;    return;&#125;void DFS1(int x) &#123;    if (!a || x == P) return;    col[x] = 1, --a;    for (auto i : g[x]) DFS1(i);    return;&#125;void DFS2(int x) &#123;    if (b == 0) return;    if (!col[x]) col[x] = 2, --b;    for (auto i : g[x]) DFS2(i);    return;&#125;void func(void) &#123;    int pos[5] = &#123;&#125;;    if (a &gt;= b &amp;&amp; b &gt;= c) // cba        org[1] = 3, org[2] = 2, org[3] = 1;    else if (a &gt;= b &amp;&amp; a &gt;= c) // bca        org[1] = 2, org[2] = 3, org[3] = 1;    else if (a &gt;= b) // bac        org[1] = 2, org[2] = 1, org[3] = 3;    else if (c &gt;= b) // abc        org[1] = 1, org[2] = 2, org[3] = 3;    else if (c &gt;= a) // acb        org[1] = 1, org[2] = 3, org[3] = 2;    else // cab        org[1] = 3, org[2] = 1, org[3] = 2;    pos[1] = a, pos[2] = b, pos[3] = c;    std::sort(pos + 1, pos + 4);    a = pos[1], b = pos[2], c = pos[3];    return;&#125;void ADD(int x) &#123; // åˆ¤æ–­å„¿å­æ˜¯å¦åˆæ³•     if (x == P)        return;    book[x] = 1;    for (auto i : w[x]) &#123;        if (i == P &amp;&amp; x != faP) legSon[x] = 1;        if (!book[i]) ADD(i);    &#125;    return;&#125;void DFS3(int x) &#123; // Sub2 æŸ“å¤´ä¸Š     if (!a || x == P) return;    col[x] = 1, --a;    for (auto i : g[x]) DFS3(i);    return;&#125;void DFS4(int x) &#123; // Sub2 æŸ“å„¿å­    if (a == 0) return;    col[x] = 1, --a;    for (auto i : g[x]) DFS4(i);    return;&#125;void DFS5(int x) &#123; // Sub2 æŸ“ B è‰²    if (b == 0) return;    col[x] = 2, --b;    for (auto i : g[x]) &#123;        // å¦‚æœå­æ ‘åŠ å…¥äº† A        // é‚£ä¹ˆèµ·ç å­æ ‘çš„æ ¹æ˜¯ä¼šè¢«æŸ“çš„ã€‚         if (col[i]) continue;        DFS5(i);    &#125;    return;&#125;int main() &#123;    read(n), read(m);    read(a), read(b), read(c), func();    while (m--) &#123;        read(x), read(y), ++x, ++y;        w[x].push_back(y), w[y].push_back(x);    &#125;    DFS(1, -1);    if (solFlag) &#123;        if (solFlag == faP) DFS1(1), DFS2(P);        else fillA(solFlag), fillB(1);        fillC();    &#125;    else &#123;        ADD(1), sumFa = n - siz[P];        auto now = g[P].begin(), ex = now;        while (sumFa &lt; a) &#123;            while (now != g[P].end() &amp;&amp; !legSon[*now]) ++now;            if (now == g[P].end()) goto noSol;            sumFa += siz[*(ex = now++)];        &#125;        auto pos = g[P].begin();        DFS3(1);        for (;; ++pos) &#123;            if (!legSon[*pos]) continue;            DFS4(*pos);            if (pos == ex) break;        &#125;        DFS5(P), fillC();    &#125;    noSol: ;    for (int i = 1; i &lt;= n; ++i) &#123;    #ifdef ONLINE_JUDGE        print(org[col[i]], &#39; &#39;);    #else        print(col[i], &#39; &#39;);    #endif    &#125;    putchar(&#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062int main() &#123;    XSC062::main();    return 0;&#125;</code></pre></details><hr /><h3 id="f---strange-housing">F - Strange Housing</h3><p><a href="https://vjudge.net/contest/585791#problem/F" class="uri">https://vjudge.net/contest/585791#problem/F</a></p><p>æ˜¯éš¾å¾—ä¸€è§çš„å°æ¸…æ–°é¢˜ç›®ï¼ˆç»å†è¿‡å‰ä¸¤é¢˜çš„æ´—ç¤¼ä¹‹åï¼‰ã€‚</p><p>æˆ‘ä»¬ä»åŸå›¾ä¸­æŠ½ä¸€ä¸ªç”Ÿæˆæ ‘å‡ºæ¥ï¼Œæ¯”å¦‚ DFS æ ‘ã€‚</p><p>ç„¶åæˆ‘ä»¬åˆçŸ¥é“æ ‘æ˜¯è¿é€šäºŒåˆ†å›¾ï¼Œæ‰€ä»¥æˆ‘ä»¬æŒ‰ç…§äºŒåˆ†å›¾æ¥æŸ“è‰²å°±å¯ä»¥äº†ã€‚</p><p>ä½†è¿™ä¹ˆåšæœ‰ä¸ª bugï¼Œå°±æ˜¯æ ‘é‡Œæœ‰è¿”ç¥–è¾¹ï¼Œè¿™å°±å¯èƒ½ä¼šå¯¼è‡´äºŒåˆ†å›¾çš„ä¸€ä¸ªéƒ¨åˆ†é‡Œå‡ºç°åœ¨åŸå›¾ä¸­ç›¸è¿çš„ç‚¹ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ¢ä¸€ç§æ€è€ƒæ–¹å¼ï¼ŒæŠŠäºŒåˆ†å›¾çš„æŸ“è‰²æ–¹æ³•å¸¦åˆ°åŸå›¾é‡Œã€‚</p><p>ä¸€ä¸ªç‚¹å½“ä¸”ä»…å½“å‘¨å›´æœ‰æŸ“è‰²ç‚¹æˆ–è‡ªèº«ä¸ºæŸ“è‰²ç‚¹æ—¶æ˜¯å¯è¾¾çš„ã€‚</p><p>å¯¹äºä¸€ä¸ªç‚¹ï¼Œæˆ‘ä»¬å…ˆæ£€æŸ¥å…¶å‘¨å›´ä¸€åœˆæœ‰æ²¡æœ‰æŸ“è‰²ç‚¹ï¼›å¦‚æœæœ‰å°±ä¸èƒ½æŸ“è‰²ã€‚åœ¨ DFS éå†çš„æ—¶å€™ç›´æ¥æŸ“è‰²å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 3e5 + 5;int col[maxn];bool vis[maxn];int T, n, m, x, y, cnt;std::vector&lt;int&gt; g[maxn];void DFS(int x) &#123;    vis[x] = 1;    for (auto i : g[x]) &#123;        if (col[i] == 1) &#123;            col[x] = 0;            break;        &#125;    &#125;    if (col[x] == -1)        ++cnt, col[x] = 1;    for (auto i : g[x]) &#123;        if (vis[i]) continue;        if (col[x] == 1) col[i] = 0;        DFS(i);    &#125;    return;&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;    read(T);    while (T--) &#123;        read(n), read(m);        for (int i = 1; i &lt;= n; ++i) &#123;            g[i].clear();            g[i].shrink_to_fit();            vis[i] = 0, col[i] = -1;        &#125;        while (m--) &#123;            read(x), read(y);            add(x, y), add(y, x);        &#125;        cnt = 0, DFS(1);        for (int i = 2; i &lt;= n; ++i) &#123;            if (!vis[i]) &#123;                puts(&quot;NO&quot;);                goto noSol;            &#125;        &#125;        puts(&quot;YES&quot;), print(cnt, &#39;\n&#39;);        for (int i = 1; i &lt;= n; ++i) &#123;            if (col[i] == 1)                print(i, &#39; &#39;);        &#125;        putchar(&#39;\n&#39;);        noSol: ;    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ„é€  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æƒ…æ™¯å‰§</title>
      <link href="/20231004/"/>
      <url>/20231004/</url>
      
        <content type="html"><![CDATA[<p>Solution to <a href="http://222.180.160.110:61235/contest/4273/problem/1">æƒ…æ™¯å‰§</a>ã€‚</p><span id="more"></span><hr /><h3 id="a.-æƒ…æ™¯å‰§">A. æƒ…æ™¯å‰§</h3><p><a href="http://222.180.160.110:61235/contest/4273/problem/1" class="uri">http://222.180.160.110:61235/contest/4273/problem/1</a></p><blockquote><p>ç»™å®šåºåˆ—ï¼Œæ±‚ä»»å–ä¸€æ®µåŒºé—´ï¼ŒåŒºé—´æœ€å¤§å€¼ã€åŒºé—´æœ€å°å€¼ã€åŒºé—´é•¿åº¦ä¹‹ç§¯çš„æœ€å¤§å€¼ã€‚</p><p><span class="math inline">\(N\le 2\times 10^6\)</span>ï¼Œå€¼åŸŸä¸º <span class="math inline">\(10^9\)</span>ã€‚</p></blockquote><p>å¯¹äº <span class="math inline">\(a_i\)</span>ï¼Œå‡è®¾å®ƒæ˜¯ <span class="math inline">\([X_i, Y_i]\)</span> å†…çš„æœ€å¤§å€¼ï¼Œä¸” <span class="math inline">\([X_i, Y_i]\)</span> æ˜¯è¯¥æ¡ä»¶ä¸‹çš„æå¤§åŒºé—´ï¼›</p><p>ç›¸ä¼¼åœ°ï¼Œå¯¹äº <span class="math inline">\(a_j\)</span>ï¼Œå‡è®¾å®ƒæ˜¯ <span class="math inline">\([P_j, Q_j]\)</span> å†…çš„æœ€å°å€¼ï¼Œä¸” <span class="math inline">\([P_j, Q_j]\)</span> æ˜¯è¯¥æ¡ä»¶ä¸‹çš„æå¤§åŒºé—´ï¼›</p><p>åˆ™å¯¹äº <span class="math inline">\(a_i\)</span> ä½œä¸ºåŒºé—´å†…æœ€å¤§å€¼ï¼Œ<span class="math inline">\(a_j\)</span> ä½œä¸ºåŒºé—´å†…æœ€å°å€¼çš„æƒ…å†µï¼Œæ»¡è¶³è¯¥æ¡ä»¶çš„åŒºé—´ä¸º <span class="math inline">\([\max(X_i, P_j), \min(Y_i, Q_j)]\)</span>ï¼Œç­”æ¡ˆä¸º <span class="math inline">\(k=a_i \times a_j \times [\min(Y_i, Q_j) - \max(X_i, P_j) + 1]\)</span>ã€‚æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯æœ€å¤§åŒ– <span class="math inline">\(k\)</span>ã€‚</p><p>ä¸¤ä¸ªä¸å›ºå®šçš„å€¼ï¼Œå¹¶ä¸”ä¸èƒ½æ‹†ç»™æ–œä¼˜åšï¼Œæ‰€ä»¥è€ƒè™‘å°†å…¶ä¸­ä¸€ä¸ªå˜å¾—ã€Œå›ºå®šã€ã€‚</p><p>è§‚å¯Ÿæ•°ç»„ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå¯¹äºæ•°ç»„ä¸­çš„æœ€å¤§å€¼ <span class="math inline">\(a_m\)</span>ï¼Œæœ‰ <span class="math inline">\(X_m = 1,Y_m=n\)</span>ã€‚é‚£ä¹ˆæ­¤æ—¶é€‰å– <span class="math inline">\(a_m\)</span> ä½œä¸ºåŒºé—´æœ€å¤§å€¼ï¼Œé€‰å–ä»»æ„æ•° <span class="math inline">\(a_j\)</span> ä½œä¸ºæœ€å°å€¼ã€‚è¿™æ ·åšå¯ä»¥ä¿è¯ç”± <span class="math inline">\(i\)</span> å¸¦æ¥çš„å½±å“éƒ½æ˜¯æœ€ä¼˜çš„ï¼Œåªç”¨æšä¸¾ <span class="math inline">\(j\)</span> å¹¶æ±‚è§£å³å¯ã€‚æ­¤æ—¶çš„ç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(a_m\times a_j\times (Q_j-P_j + 1)\)</span>ã€‚</p><p>æˆ‘ä»¬ä¸Šè¿°æ¡ä»¶æˆç«‹çš„å‰ææ˜¯ <span class="math inline">\(i\)</span> åœ¨ <span class="math inline">\([P_j, Q_j]\)</span> å†…ä¸” <span class="math inline">\(j\)</span> åœ¨ <span class="math inline">\([X_i, Y_i]\)</span> å†…ã€‚å½“ <span class="math inline">\(i\)</span> å– <span class="math inline">\(m\)</span> æ—¶åè€…æ˜¾ç„¶æˆç«‹ï¼Œä½†å¾ˆå®¹æ˜“æ„é€ å‡ºæ¥æƒ…å†µè®©å‰è€…ä¸æˆç«‹ã€‚æ¯”å¦‚è¯´ <code>15 1 5</code>ï¼Œå½“ <span class="math inline">\(j=3\)</span> æ—¶å°±ä¼šå¾—åˆ°é”™è¯¯çš„ç­”æ¡ˆã€‚</p><p>å—åˆšæ‰çš„æ€è€ƒå¯å‘ï¼Œå– <span class="math inline">\([P_j, Q_j]\)</span> å†…çš„æœ€å¤§å€¼ä½œä¸º <span class="math inline">\(i\)</span>ã€‚æ­¤æ—¶æœ‰ <span class="math inline">\(X_i\le P_j\le Q_j \le Y_j\)</span>ï¼Œç­”æ¡ˆä¸ºåŒºé—´å†…æœ€ä¼˜ã€‚</p><p>æ¥ä¸‹æ¥éœ€è¦æ±‚è§£ <span class="math inline">\(P_j\)</span> å’Œ <span class="math inline">\(Q_j\)</span>ã€‚è§‚å¯Ÿæ•°æ®èŒƒå›´ï¼Œåº”è¯¥æ˜¯ <span class="math inline">\(O(n)\)</span> åšæ³•ã€‚ä¸éš¾æƒ³åˆ°å•è°ƒæ ˆï¼Œå¯æƒœæˆ‘ä¸ä¼šï¼Œæ‰€ä»¥é‡‡ç”¨åŒæ ·æ˜¯ <span class="math inline">\(O(n)\)</span> çš„æ‚¬çº¿æ³•ï¼ˆ<a href="/20220927">æˆ‘çš„åšå®¢ï¼šæœ‰å…³æ‚¬çº¿æ³•çš„ä»‹ç»</a>ï¼‰ã€‚</p><p>é‚£ä¹ˆæ€ä¹ˆæ±‚ <span class="math inline">\([P_j,Q_j]\)</span> å†…çš„æœ€å¤§å€¼å‘¢ï¼Ÿå½“é‡åˆ°è¿™ç§æ±‚è§£åŒºé—´ä¸å·¦å³ç«¯ç‚¹ä¸€è‡´ï¼Œå¹¶ä¸”å¾…æ±‚æ»¡è¶³å¯åŠ æ€§çš„æƒ…å†µæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æ‚¬çº¿çš„æ—¶å€™ä¸€èµ·æ±‚è§£ã€‚å½“æ‚¬çº¿è·¨è¶Šä¸€ä¸ªåŒºé—´æ—¶ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨è¿™ä¸ªå·²æ±‚è§£åŒºé—´çš„æœ€å¤§å€¼æ›´æ–°å½“å‰æ±‚çš„æœ€å¤§å€¼ã€‚</p><p>å·¦å³åˆ†åˆ«æ±‚æœ€å¤§å€¼ï¼ˆæ³¨æ„è¦ç”¨ä¸¤ä¸ªæ•°ç»„åˆ†åˆ«è®°å½•ï¼Œé˜²æ­¢é”™è¯¯æ›´æ–°ï¼‰ï¼Œæœ€åå–ä¸¤è€…è¾ƒå¤§ä½œä¸ºæœ€ç»ˆåŒºé—´å†…æœ€å¤§å€¼å³å¯ã€‚</p><p>æœ€ç»ˆæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n)\)</span>ã€‚</p><details><p><summary>ğŸŒ¼ é²œèŠ±</summary></p><p>ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¬åˆ«äººè¯´å¾ˆå¡ï¼Œä¸å¡å•Šï¼Œæˆ‘ä¸€ä¸ªç‚¹ 250msã€‚</p><p>å•Šä»€ä¹ˆä½ ä»¬æ‰“çš„ <span class="math inline">\(O(n\log n)\)</span>ï¼Ÿå› ä¸ºå•è°ƒæ ˆä¿¡æ¯æ–­å±‚ä¸èƒ½ç»´æŠ¤åŒºé—´å†…æœ€å¤§å€¼ï¼Ÿèœã€‚é‚£æˆ‘å¿…é¡»æŠŠè¿™ç¯‡å‘å‡ºæ¥å˜²è®½ä½ ä»¬äº†ã€‚å…”å­è¯´è¦æ˜¯ä¸æ‰“ <code>fread</code> Lemon ä¸Šå°±ä¼šèµ·é£ï¼Œæˆ‘è¯´æˆ‘æ‰“äº†ï¼Œæˆ‘è¿˜ç–‘æƒ‘ <span class="math inline">\(O(n)\)</span> è·‘ <code>2e6</code> æ™®é€šå¿«è¯»æ€ä¹ˆä¼šå¯„å‘¢ã€‚ä¸€é—®ï¼Œå•Šï¼Œå¸¦ <span class="math inline">\(\log\)</span>ï¼Œèœã€‚</p><p>å•Šä»€ä¹ˆè°­å§”å‘˜å¸¦ <span class="math inline">\(\log\)</span> ä¸€ä¸ªç‚¹åªè¦ 500msï¼Ÿé‚£ä¹Ÿæ¯”æˆ‘æ…¢ï¼Œèœã€‚</p></details><p>è¯´èµ·æ¥è¿™æ˜¯æˆ‘å¤´ä¸€æ¬¡ç”¨æ‚¬çº¿è§£å†³ä¸åœ¨çŸ©é˜µä¸Šï¼Œè¿˜è¦ç»´æŠ¤ä¿¡æ¯çš„é¢˜ï¼Œä¹‹å‰å¹¶æ²¡æœ‰ç»†æƒ³è¿‡å•è°ƒæ ˆå’Œæ‚¬çº¿å¯ç»´æŠ¤çš„ä¿¡æ¯å·®å¼‚ï¼Œè¿™æ¬¡ç®—æ˜¯è¯¯æ‰“è¯¯æ’åšå¯¹äº†ã€‚</p><p>æ³¨æ„åˆ°æ•°æ®èŒƒå›´ï¼Œåº”è¯¥è¦å¼€ <code>__int128</code> å§ã€‚</p><details><pre class="cpp"><code>#define int __int128namespace XSC062 &#123;using namespace fastIO;const int maxn = 2e6 + 5;int a[maxn];int n, mx, res;int l[maxn], r[maxn];int mxl[maxn], mxr[maxn];int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;int main() &#123;    read(n), l[0] = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(a[i]), l[i] = i;        mxl[i] = mxr[i] = a[i];        while (l[i] &gt; 1 &amp;&amp; a[l[i] - 1] &gt;= a[i]) &#123;            mxl[i] = max(mxl[i], mxl[l[i] - 1]);            l[i] = l[l[i] - 1];        &#125;    &#125;    r[n + 1] = n;    for (int i = n; i; --i) &#123;        r[i] = i;        while (r[i] &lt; n &amp;&amp; a[r[i] + 1] &gt;= a[i]) &#123;            mxr[i] = max(mxr[i], mxr[r[i] + 1]);            r[i] = r[r[i] + 1];        &#125;        res = max(res, max(mxl[i], mxr[i]) * a[i] * (r[i] - l[i] + 1));    &#125;    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><p><em>upd on 240704</em></p><p>æˆ‘ä»¬åœ¨ <a href="/20220927">è¿™ç¯‡åšå®¢</a> ä¸­æåˆ°äº†æ‚¬çº¿çš„æœ¬è´¨æ˜¯ç¬›å¡å°”æ ‘ï¼Œè€Œæœ¬é¢˜å°±æ˜¯å…¶é“¾ä¸Šçˆ¬å±±ç»´æŠ¤æ•°æ®çš„ä¸€ä¸ªä¼˜ç§€ä½“ç°ï¼Œä¹Ÿæ˜¯å› ä¸ºè¿™ä¸€ç‚¹ï¼Œåº”è¯¥æ›´åŠ æ·±åˆ‡åœ°è®¤è¯†åˆ°æ‚¬çº¿åŒ…å«å¼çš„è®¿é—®é¡ºåºä½¿ä¹‹ç»´æŠ¤çš„æ•°æ®ç±»å‹åº”å’Œå€å¢ / æ ‘çŠ¶æ•°ç»„ç­‰ç±»ä¼¼ã€‚</p><p>æ‰€ä»¥è¯´åˆ°å¯ç»´æŠ¤æ•°æ®çš„å¤æ‚ç¨‹åº¦ï¼Œç¬›å¡å°”æ ‘ä¸¥æ ¼å¤§äºæ‚¬çº¿ä¸¥æ ¼å¤§äºå•è°ƒæ ˆå¥½å§ <img src="/em/dy.gif" /></p><p>è™½ç„¶ç°åœ¨å…¨ä¸–ç•Œéƒ½çŸ¥é“æˆ‘æ˜¯æ‚¬çº¿é­”æ€”äººäº† <img src="/em/dy.gif" /></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚¬çº¿æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20231004-1/"/>
      <url>/20231004-1/</url>
      
        <content type="html"><![CDATA[<p><a href="http://222.180.160.110:61235/contest/4272">ç‰›å®¢æ™®åŠ</a>ã€‚</p><span id="more"></span><hr /><h3 id="a.-å­¦ä¹ æ±‚ä½™">A. å­¦ä¹ æ±‚ä½™</h3><p><a href="http://222.180.160.110:61235/contest/4272/problem/1" class="uri">http://222.180.160.110:61235/contest/4272/problem/1</a></p><p>ä»Šå¤©æˆ‘ä»¬æ¥å­¦ä¹ æ±‚ä½™ï¼è¿™ç§é¢˜æ”¾æ™®åŠ T1 ä¸åˆé€‚å§ï¼</p><p>ä»¤ <span class="math inline">\(k=\left\lfloor \dfrac n2 \right\rfloor + 1\)</span>ï¼Œç›´æ¥è¾“å‡º <span class="math inline">\(k\times (n - k)\)</span> å³å¯ã€‚</p><details><p><summary>æˆ‘æ˜¯ä¸æ˜¯è¯å¤æ‚äº†â€¦</summary></p><p>æˆ‘ä»¬å¯ä»¥ç®€å•åœ°å‘ç°ä¸€ä¸ªé“ç†ï¼Œå¯¹äºä»»æ„ <span class="math inline">\(\dfrac n2&lt;x\le n\)</span>ï¼Œ<span class="math inline">\(n\bmod x\)</span> çš„å€¼æ˜¯ <span class="math inline">\(n - x\)</span>ï¼›</p><p>æ ¹æ®åŸºæœ¬ä¸ç­‰å¼ï¼ˆ<del>wjs ç›´æ¥æ„ŸåŠ¨å¾—å“­å‡ºå£°æ¥</del>ï¼‰æˆ–å°å­¦çŸ¥è¯†ã€Œå’Œä¸å˜ï¼Œå·®å°ç§¯å¤§ã€ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“å½“ <span class="math inline">\(x=\left\lfloor \dfrac n2 \right\rfloor + 1\)</span> æ—¶ï¼Œ<span class="math inline">\(x\times (n-x)\)</span> å–æœ€å¤§å€¼ã€‚</p><p>æ•…æœ‰ï¼šå½“ <span class="math inline">\(x=\left\lfloor \dfrac n2 \right\rfloor + 1\)</span> æ—¶ï¼Œ<span class="math inline">\(x\times (n\bmod x)\)</span> å–æœ€å¤§å€¼ã€‚</p><p>è€Œå¯¹äº <span class="math inline">\(y\le \dfrac n2\)</span>ï¼Œç”±ä½™æ•°å°äºé™¤æ•°å¾—ï¼Œ<span class="math inline">\(n\bmod y&lt;y\le \dfrac n2\)</span>ã€‚ç”±äº <span class="math inline">\(0&lt;y&lt;x=\left\lfloor \dfrac n2 \right\rfloor + 1\)</span> ä¸” <span class="math inline">\(0\le n\bmod y\le \left\lfloor \dfrac n2 \right\rfloor - 1\le n - \left\lfloor \dfrac n2 \right\rfloor - 1=n\bmod x\)</span>ï¼Œç”±ä¸ç­‰å¼çš„åŸºæœ¬æ€§è´¨å¾— <span class="math inline">\(x\times(n\bmod x)&gt;y\times (n\bmod y)\)</span>ã€‚</p><p>ç»¼ä¸Šï¼Œå¯¹äº <span class="math inline">\(1\le x\le n\)</span>ï¼Œå½“ <span class="math inline">\(x=\left\lfloor \dfrac n2 \right\rfloor + 1\)</span> æ—¶ï¼Œ<span class="math inline">\(x\times (n\bmod x)\)</span> æœ‰æœ€å¤§å€¼ã€‚</p></details><p>ç„¶åå¦‚æœä½ è¦é—®æˆ‘æ€ä¹ˆå‘ç°è¿™ä¸€ç‚¹çš„å‘¢ï¼Œæˆ‘å½“æ—¶æ²¡æœ‰æ€è·¯ï¼Œç„¶åéšæ‰‹è¾“å‡ºäº† <span class="math inline">\(n=100\)</span> æ—¶ <span class="math inline">\(n\bmod i\)</span> çš„æ‰€æœ‰å€¼ã€‚ç„¶åå‘ç° <span class="math inline">\(k=51\)</span> æ—¶ä½™æ•°æ˜¯ <span class="math inline">\(49\)</span>â€¦â€¦ ç„¶åå°±ä¼šäº†ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;int n, k;int main() &#123;    read(n), k = n / 2 + 1;    print(k * (n % k));    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre><p><del>å¤´ä¸€æ¬¡åœ¨é¢˜è§£é‡Œè´´è¿™ä¹ˆçŸ­çš„ä»£ç </del></p></details><hr /><h3 id="b.-æå–æ•°å­—">B. æå–æ•°å­—</h3><p><a href="http://222.180.160.110:61235/contest/4272/problem/2" class="uri">http://222.180.160.110:61235/contest/4272/problem/2</a></p><p>æˆ‘è¢«è¿™é“é¢˜ï¼ˆç–‘ä¼¼ T1ï¼‰å‘åˆ°äº†ï¼äº¤äº†ä¸‰éæ‰è¿‡ï¼è¿™åˆç†å—ï¼Ÿ</p><p>é¦–å…ˆè¦å¼€ <code>long long</code>ï¼ç„¶åæ³¨æ„ï¼Œä½ çš„åˆ¤å®šæ¡ä»¶åº”ä¸ºã€Œå½“å‰æ˜¯å¦å·²å­˜å‚¨æ•°ã€è€Œéã€Œå½“å‰å­˜æ•°å˜é‡æ˜¯å¦ä¸º 0ã€ï¼å› ä¸ºæ•°æ®ä¸­ä¼šæœ‰å•ä¸ª 0 çš„æƒ…å†µå‡ºç°ï¼</p><p>ç„¶åå°±æ²¡æœ‰äº†ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;bool flag;char s[maxn]; int n, ans, cnt;int main() &#123;    scanf(&quot;%*s %s&quot;, s + 1);    n = strlen(s + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        if (s[i] &gt;= &#39;0&#39; &amp;&amp; s[i] &lt;= &#39;9&#39;)            cnt = cnt * 10 + s[i] - &#39;0&#39;, flag = 1;        else if (flag)            ans += (cnt + 5), cnt = 0, flag = 0;    &#125;    if (flag) ans += (cnt + 5);    print(ans, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="c.-æ­¦å™¨é€‰æ‹©">C. æ­¦å™¨é€‰æ‹©</h3><p><a href="http://222.180.160.110:61235/contest/4272/problem/3" class="uri">http://222.180.160.110:61235/contest/4272/problem/3</a></p><details><p><summary>é¦–å…ˆæ˜¯æˆ‘æƒ³äº†åŠä¸ªå°æ—¶çš„ç‹‚æ‹½é…·ç‚«åŠç‚¸å¤©çš„æ³•ä¸€ï¼šç¦»çº¿</summary></p><p>æˆ‘å½“æ—¶ä¸€è¾¹æ‰“ä¸€è¾¹æ€€ç–‘ç°åœ¨çš„æ™®åŠç»„æ˜¯ä»€ä¹ˆç¥ä»™ï¼ŒT3 è€ƒè¿™ä¹ˆç¥å¥‡çš„ç¦»çº¿ï¼Œéš¾é“æ˜¯æˆ‘è½åäºæ—¶ä»£äº†ï¼Ÿ</p><p>ï¼ˆä¹‹æ‰€ä»¥è®¤ä¸ºè¿™æ˜¯ T3 æ˜¯å› ä¸ºæ‹¬å·é‚£é“é¢˜ç¡®å®æ˜¯æ­£å¸¸ T4 é£æ ¼ï¼‰</p><p>æˆ‘ä»¬é¢„å¤„ç†å‡ºå¯¹äºæ¯ä¸€ä¸ªå¯èƒ½è·å¾—æ­¦å™¨ <span class="math inline">\(i\)</span> çš„ä½ç½®ï¼Œåº”è¯¥ä»å“ªä¸ªä½ç½®ç¬¬ä¸€æ¬¡æ¡åˆ°æ­¦å™¨ <span class="math inline">\(i\)</span>ï¼Œç”±äºè¿™ä¸€æ®µå†…çš„æ‰€æœ‰æ­¦å™¨ <span class="math inline">\(i\)</span> éƒ½éœ€è¦è¢«æ‹¾å–ï¼Œæˆ‘ä»¬å°†å…¶ä½œä¸ºåŒºé—´ <span class="math inline">\([L_i, R_i]\)</span> æ¥è®°å½•ã€‚</p><p>é‚£ä¹ˆè¯¢é—®å¯ä»¥è½¬åŒ–ä¸ºï¼Œåœ¨ <span class="math inline">\([l, r]\)</span> å†… <strong>ä¸åŒé¢œè‰²</strong> <span class="math inline">\([L_i, R_i]\)</span> çš„æ•°é‡ã€‚</p><p>è€ƒè™‘å°†è¯¢é—®ç¦»çº¿ã€‚å°†è¯¢é—®æŒ‰å·¦ç«¯ç‚¹ä»å¤§åˆ°å°æ’åºï¼Œä¿¡æ¯åŒºé—´ <span class="math inline">\([L_i, R_i]\)</span> ä¹ŸæŒ‰å·¦ç«¯ç‚¹ä»å¤§åˆ°å°æ’åºã€‚</p><p>å¯¹äºæ¯æ¬¡è¯¢é—® <span class="math inline">\(l, r\)</span>ï¼Œåœ¨æ ‘çŠ¶æ•°ç»„ä¸­å°†è¢« <span class="math inline">\([l, n]\)</span> å®Œå…¨åŒ…å«çš„æ‰€æœ‰ <span class="math inline">\([L_i, R_i]\)</span>ï¼ˆå…¶å®å°±æ˜¯ <span class="math inline">\(l\le L_i\)</span> çš„æ‰€æœ‰ <span class="math inline">\(L_i\)</span>ï¼‰åœ¨å³ç«¯ç‚¹ <span class="math inline">\(R_i\)</span> å¤„åŠ ä¸€ï¼Œæˆ‘ä»¬å°±ç»Ÿè®¡åˆ°äº†å¯ä»¥æ¡åˆ°æ­¦å™¨çš„æ‰€æœ‰ä½ç½®ã€‚</p><p>æ€ä¹ˆåŒºåˆ†é¢œè‰²å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬è®©æ¯ä¸ªé¢œè‰²åªè¢«ç®—ä¸€æ¬¡ã€‚ç®—å“ªä¸€æ¬¡å‘¢ï¼Ÿå°±ç®—å½“å‰å·²åŠ å…¥çš„ <span class="math inline">\([L_i, R_i]\)</span> å†…ï¼Œæ¯”é€‰ä¸­æ¦‚ç‡æœ€å¤§çš„ä¸€æ¬¡ã€‚</p><p>æˆ‘ä»¬æ ‘çŠ¶æ•°ç»„ç»Ÿè®¡çš„æ˜¯ <span class="math inline">\([1, r]\)</span> å†…çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è®©æ¦‚ç‡æœ€å¤§çš„è¯ï¼Œå°±è¦è®© <span class="math inline">\(R_i\)</span> å°½é‡çš„å°ã€‚</p><p>æˆ‘ä»¬è®°å½•æ¯ä¸ªé¢œè‰²å½“å‰åˆæ³• <span class="math inline">\([L_i, R_i]\)</span> çš„æœ€å°å³ç«¯ç‚¹ <span class="math inline">\(\min_R\)</span>ã€‚åŠ å…¥ä¸€ä¸ªæ–°çš„ <span class="math inline">\([L_i, R_i]\)</span> æ—¶ï¼Œå¦‚æœ <span class="math inline">\(R_i\ge \min_R\)</span>ï¼Œé‚£ä¹ˆä¸ä¼šäº§ç”Ÿå½±å“ï¼Œè·³è¿‡ï¼›å¦åˆ™ï¼Œå½“ <span class="math inline">\(R_i&lt;\min_R\)</span> æ—¶ï¼Œæˆ‘ä»¬å°±è¦å…ˆæ¶ˆé™¤å½“å‰ <span class="math inline">\(\min_R\)</span> çš„å½±å“ï¼ˆå³åœ¨æ ‘çŠ¶æ•°ç»„ä¸­å°†è¯¥ä½ç½®åŠ ä¸Šçš„ 1 å‡å»ï¼‰ï¼Œå†åŠ ä¸Š <span class="math inline">\(R_i\)</span> çš„å½±å“ï¼ˆå³åœ¨æ ‘çŠ¶æ•°ç»„ä¸­åŠ ä¸Šè¯¥ä½ç½®çš„ 1ï¼‰ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬å¯¹ <span class="math inline">\([1, r]\)</span> çš„è¯¢é—®å°±æ˜¯ç­”æ¡ˆã€‚</p><p>å¤æ‚åº¦ <span class="math inline">\(O(n\log n + m\log m + m\log n)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(n\log n\)</span> æ¥è‡ªäºå¯¹ <span class="math inline">\([L_i, R_i]\)</span> çš„æ’åºï¼Œ<span class="math inline">\(m\log m\)</span> æ¥è‡ªäºå¯¹è¯¢é—®çš„æ’åºï¼Œ<span class="math inline">\(m\log n\)</span> æ¥è‡ªäºç¦»çº¿æ ‘çŠ¶æ•°ç»„ã€‚</p></details><p>æ¥ä¸‹æ¥è®²é¢˜è§£ç»™çš„æ­£è§£â€¦â€¦ è¿™ä¸ªæ˜¯çœŸçš„å¦™ã€‚</p><p>è€ƒè™‘æ‰€æœ‰ç§ç±»æ•°ï¼Œåœ¨ <span class="math inline">\(n\)</span> ä¸ªæ•°å†…æ»¡è¶³æ¡ä»¶çš„ç§ç±» <span class="math inline">\(x\)</span> æœ€ä¼˜æ¡ä»¶ä¸‹ä¹Ÿä¸è¿‡ <span class="math inline">\(\dfrac {x\times (x+1)}2=n\)</span>ï¼Œæ‰€ä»¥æ»¡è¶³æ¡ä»¶æ­¦å™¨çš„æ•°é‡æœ€å¤šåªæœ‰ <span class="math inline">\(\sqrt n\)</span> çº§åˆ«ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å¯¹æ‰€æœ‰åˆæ³•ç§ç±»åšå‰ç¼€å’Œï¼Œæ¯æ¬¡è¯¢é—®æ£€æŸ¥æ‰€æœ‰åˆæ³•ç§ç±»æ˜¯å¦åœ¨è¯¥åŒºé—´å†…å‡ºç°å¯¹åº”æ¬¡æ•°ï¼Œç„¶åç»Ÿè®¡ç­”æ¡ˆã€‚å¤æ‚åº¦ <span class="math inline">\(O(m\sqrt n + n\sqrt n)\)</span>ã€‚<span class="math inline">\(n\sqrt n\)</span> æ˜¯å‰é¢å‰ç¼€å’Œæ¥çš„ï¼Œ<span class="math inline">\(m\sqrt n\)</span> æ˜¯æš´åŠ›ç»Ÿè®¡æ¥çš„ã€‚</p><p>ä½†æ˜¯æ ¹å·å¯è€»ï¼Œæ‰€ä»¥æˆ‘çš„æ³•ä¸€æ›´ NBï¼ï¼ï¼ğŸ¤¡ğŸ¤¡ğŸ¤¡</p><details><p><summary>ç‹‚æ‹½é…·ç‚«åŠç‚¸å¤©çš„æ³•ä¸€ä»£ç </summary></p><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;struct _ &#123;    int l, r, k, i;    bool operator&lt; (const _ &amp;q) const &#123;        return l &lt; q.l;    &#125;&#125;;struct __ &#123;    int l, r, nxt, x;    bool operator&lt; (const __ &amp;q) const &#123;        return l &lt; q.l;    &#125;&#125;;_ q[maxn];__ a[maxn];std::map&lt;int, int&gt; t;std::vector&lt;int&gt; u[maxn];int ans[maxn], now[maxn];int mnr[maxn], Bit[maxn];int n, m, tot, x, cnt, pos;int lowbit(int x) &#123; return x &amp; -x; &#125;void add(int x, int v) &#123;    for (int i = x; i &lt;= n; i += lowbit(i))        Bit[i] += v;    return;&#125;int ask(int x) &#123;    int res = 0;    for (int i = x; i; i -= lowbit(i))        res += Bit[i];    return res;&#125;int calc(int x, int k) &#123;    int res = 1;    for (int i = 1; i &lt;= k; ++i)        res *= x--;    for (int i = 1; i &lt;= k; ++i)        res /= i;    return res;&#125;int main() &#123;    read(n);    for (int i = 1; i &lt;= n; ++i) &#123;        read(x);        if (!t.count(x)) t[x] = ++tot;        int id = t[x];        u[id].push_back(i);        if ((int)u[id].size() &gt;= x) &#123;            a[++cnt].l = u[id][(int)u[id].size() - x];            a[cnt].r = i, a[now[id]].nxt = cnt;            a[cnt].x = x, mnr[x] = n + 1;            now[id] = cnt;        &#125;    &#125;    read(m);    for (int i = 1; i &lt;= m; ++i) &#123;        read(q[i].l), read(q[i].r);        read(q[i].k), q[i].i = i;    &#125;    std::sort(q + 1, q + m + 1);    std::sort(a + 1, a + cnt + 1);    pos = cnt;    for (int i = m; i; --i) &#123;        while (a[pos].l &gt;= q[i].l) &#123;            if (a[pos].r &lt; mnr[a[pos].x]) &#123;                if (mnr[a[pos].x] &lt;= n)                    add(mnr[a[pos].x], -1);                add(a[pos].r, 1);                mnr[a[pos].x] = a[pos].r;            &#125;            --pos;        &#125;        ans[q[i].i] = calc(ask(q[i].r), q[i].k);    &#125;    for (int i = 1; i &lt;= m; ++i)        print(ans[i], &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre><p>æˆ‘ç”šè‡³æ‰“å®Œäº†å°±è¿‡äº†æ ·ä¾‹ç„¶åç›´æ¥å°± A äº†ï¼Œå¥½ä¹…æ²¡æœ‰è¿™ä¹ˆçˆ½åœ°è¿‡è¿‡è¿™ç§å¤§ç é‡ <del>æ­£ç¡®æ€§è¿˜æœªçŸ¥</del> çš„é¢˜äº†ã€‚</p></details><p>è€Œä¸”æˆ‘ç›¸ä¿¡å…¨åœºåªæœ‰æˆ‘ä¸€ä¸ª <del>å°ä¸‘</del> å¸…å“¥æ‰“ç¦»çº¿ï¼Œæ‰€ä»¥æˆ‘æ˜¯æœ€å¼ºçš„ï¼ï¼ï¼ğŸ¤¡ğŸ¤¡ğŸ¤¡</p><details><p><summary>ç»å¯¹ä¸å¦‚æ³•ä¸€çš„æ³•äºŒä»£ç </summary></p><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int maxm = 505;const int maxn = 1e5 + 5;int a[maxn];int cnt[maxn];int sum[maxm][maxn];int n, tot, m, l, r, k, res;int calc(int x, int k) &#123;    int res = 1;    for (int i = 1; i &lt;= k; ++i)        res *= x--;    for (int i = 1; i &lt;= k; ++i)        res /= i;    return res;&#125;int main() &#123;    read(n);    for (int i = 1; i &lt;= n; ++i) &#123;        read(a[i]);        if (a[i] &lt;= n) ++cnt[a[i]];    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        if (cnt[i] &gt;= i) &#123;            sum[++tot][n + 1] = i;            for (int j = 1; j &lt;= n; ++j)                sum[tot][j] = sum[tot][j - 1] + (a[j] == i);        &#125;    &#125;    read(m);    while (m--) &#123;        read(l), read(r), read(k);        res = 0;        for (int i = 1; i &lt;= tot; ++i)            res += (sum[i][r] - sum[i][l - 1] &gt;= sum[i][n + 1]);        print(calc(res, k), &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="d.-æ‹¬å·åºåˆ—">D. æ‹¬å·åºåˆ—</h3><p>http://222.180.160.110:61235/contest/4272/problem/4</p><p>å‘ƒå‘ƒå‘ƒï¼Œè¿™ï¼Œæœ‰ä»€ä¹ˆå¥½è®²çš„å—ï¼Ÿåšè¿‡åŸé¢˜çš„åº”è¯¥éƒ½ä¼šå§â€¦â€¦</p><p>åæ­£å°±æ˜¯ä¸ªæ¯”è¾ƒè£¸çš„åŒºé—´ DPï¼Œè½¬ç§»çš„æ—¶å€™æ³¨æ„ä¸€ä¸‹ç©¶ç«Ÿå“ªäº›æ˜¯åŒä¸€å¯¹æ‹¬å·ï¼Œå“ªäº›æ˜¯ç›¸é‚»æ‹¬å·å°±å¥½ã€‚</p><p>å¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e3 + 5;int n, res;char s[maxn];std::stack&lt;int&gt; t;int mat[maxn], c[5];int f[maxn][maxn][3][3];int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;void upd(int &amp;x, int y) &#123; x = max(x, y); return; &#125;int main() &#123;    memset(f, -0x3f, sizeof (f));    scanf(&quot;%d %d %d&quot;, &amp;n, &amp;c[1], &amp;c[2]);    scanf(&quot;%s&quot;, s + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        if (s[i] == &#39;(&#39;) t.push(i);        else mat[t.top()] = i, t.pop();    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        if (mat[i] == i + 1) &#123;            for (int k = 0; k &lt;= 2; ++k)                f[i][i + 1][k][k] = c[k];        &#125;    &#125;    for (int l = 4; l &lt;= n; l += 2) &#123;        for (int i = 1; i &lt;= n - l + 1; ++i) &#123;            int j = i + l - 1;            if (mat[i] == j) &#123;                // ((...))                // xy...zx                for (int x = 0; x &lt;= 2; ++x) &#123;                    for (int y = 0; y &lt;= 2; ++y) &#123;                        if (y == x) continue;                        for (int z = 0; z &lt;= 2; ++z) &#123;                            if (z == x) continue;                            upd(f[i][j][x][x], f[i + 1][j - 1][y][z] + c[x]);                        &#125;                    &#125;                &#125;            &#125;            else &#123;                // ()(...)                // xxy...z                for (int x = 0; x &lt;= 2; ++x) &#123;                    for (int y = 0; y &lt;= 2; ++y) &#123;                        if (y == x) continue;                        for (int z = 0; z &lt;= 2; ++z)                            upd(f[i][j][x][z], f[i][mat[i]][x][x] + f[mat[i] + 1][j][y][z]);                    &#125;                &#125;            &#125;        &#125;    &#125;    for (int i = 0; i &lt;= 2; ++i) &#123;        for (int j = 0; j &lt;= 2; ++j)            res = max(res, f[1][n][i][j]);    &#125;    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ ‘çŠ¶æ•°ç»„ </tag>
            
            <tag> åŒºé—´ DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚é¢˜</title>
      <link href="/20231003/"/>
      <url>/20231003/</url>
      
        <content type="html"><![CDATA[<p><a href="http://222.180.160.110:61235/contest/4268">å‘¨è€ƒ 14</a>ã€‚</p><span id="more"></span><hr /><p>åŒ»ç”Ÿé—®æˆ‘å¯¹è¯æœ‰ä»€ä¹ˆè¦æ±‚å—ï¼Œæˆ‘è¯´æˆ‘å®æ­»ä¸å–å†²å‰‚ã€‚</p><p>ç„¶ååŒ»ç”Ÿç»™æˆ‘å¼€äº†äº”ç›’èƒ¶å›Šï¼Œå‘Šè¯‰æˆ‘è¯´ä¸€å¤©ä¸‰æ¬¡ï¼Œä¸€æ¬¡å…­ä¸ªã€‚</p><p>å“ˆå“ˆå“ˆï¼Œæˆ‘è‡ªæ‰¾çš„ã€‚ä»¥æ­¤ä¸ºè¯ï¼ŒA ä¸€é“é¢˜ç£•ä¸€ç‰‡ï¼ï¼ï¼</p><hr /><h3 id="a.-ä¿®æ”¹åºåˆ—">A. ä¿®æ”¹åºåˆ—</h3><p><a href="http://222.180.160.110:61235/contest/4268/problem/1" class="uri">http://222.180.160.110:61235/contest/4268/problem/1</a></p><p>æ³¨æ„åˆ°ä¸€å¢ä¸€å‡ï¼Œå…¨æ•°åˆ—çš„å’Œ <span class="math inline">\(s\)</span> ä¸å˜ï¼Œè€ƒè™‘è¿™ä¸€ç‚¹å¸¦æ¥çš„æç¤ºã€‚</p><p>å‡è®¾æœ€åè¦æ±‚ä¸€éƒ¨åˆ†æ•°ä¸º <span class="math inline">\(p\)</span>ï¼Œå¦ä¸€éƒ¨åˆ†ä¸º <span class="math inline">\(p+1\)</span>ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(p = \lfloor \dfrac sn \rfloor\)</span>ï¼Œ<span class="math inline">\(p+1\)</span> çš„æ•°é‡ <span class="math inline">\(c_r=s\bmod n\)</span>ï¼Œ<span class="math inline">\(p\)</span> çš„æ•°é‡ <span class="math inline">\(c_l=n-c_r\)</span>ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬è®© <span class="math inline">\(\le p\)</span> çš„å˜æˆ <span class="math inline">\(p\)</span>ï¼Œ<span class="math inline">\(\ge p + 1\)</span> çš„å˜æˆ <span class="math inline">\(p + 1\)</span>ã€‚ç›´æ¥æ±‚ä¸¤æ•°è·ç¦»ï¼Œæœ€åå°†æ€»å’Œé™¤ä»¥äºŒå³ä¸ºç­”æ¡ˆã€</p><details><p><summary>æ­£ç¡®æ€§è¯æ˜â€¦</summary></p><p>è¿™æ ·åšçš„æœ€ä¼˜æ€§æ¯«æ— ç–‘é—®ï¼Œé—®é¢˜æ— éå°±åœ¨äºè¿™ä¹ˆåšçš„æ­£ç¡®æ€§ï¼Œæ¢è¨€ä¹‹ï¼Œä¸ºä»€ä¹ˆä¸€å®šèƒ½æ‰¾åˆ°åˆæ³•çš„æ“ä½œåºåˆ—è¿˜åŸæˆ‘ä»¬çš„æ±‚è§£è¿‡ç¨‹ã€‚</p><p>å°†åŸæ•°åˆ—åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œæ•°å€¼ <span class="math inline">\(\le p\)</span> çš„ï¼ˆè®°ä¸º <span class="math inline">\(X\)</span>ï¼‰å’Œæ•°å€¼ <span class="math inline">\(\ge p + 1\)</span> çš„ï¼ˆè®°ä¸º <span class="math inline">\(Y\)</span>ï¼‰ã€‚</p><p>å†æŠŠæˆ‘ä»¬çš„ç›®æ ‡çŠ¶æ€åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œæ•°å€¼ <span class="math inline">\(= p\)</span> çš„ï¼ˆè®°ä¸º <span class="math inline">\(A\)</span>ï¼‰å’Œ æ•°å€¼ <span class="math inline">\(=p + 1\)</span> çš„ï¼ˆè®°ä¸º <span class="math inline">\(B\)</span>ï¼‰ã€‚</p><p>é‚£ä¹ˆæœ‰ <span class="math inline">\(\begin{cases}X+Y=s\\A+B=s\end{cases}\)</span>ï¼Œç”±ç­‰å¼çš„åŸºæœ¬æ€§è´¨å¾— <span class="math inline">\(X-A+Y-B = 0\)</span>ï¼Œç§»é¡¹å¾— <span class="math inline">\(Y-B=A-X\)</span>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class="math inline">\(Y\)</span> éƒ¨åˆ†ä¸ <span class="math inline">\(p+1\)</span> çš„å·®çš„æ€»å’Œæ­£å¥½ç­‰äº <span class="math inline">\(X\)</span> éƒ¨åˆ†ä¸ <span class="math inline">\(p\)</span> çš„å·®çš„æ€»å’Œã€‚</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬çš„æ­£ç¡®æ€§å°±æœ‰äº†ä¿è¯ã€‚</p><p>è¿™ä¸ªæ—¶å€™ä½ å¯èƒ½å°±æœ‰ç–‘é—®äº†ï¼Œ<span class="math inline">\(X,Y\)</span> ä¸­çš„å…ƒç´ ä¸ªæ•°å’Œ <span class="math inline">\(A,B\)</span> ä¸­çš„å…ƒç´ ä¸ªæ•°å¹¶ä¸å¯¹åº”ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å‘ç°ä¸Šé¢çš„åŸç†å¼å¹¶ä¸ä¼šéšå…ƒç´ ä¸ªæ•°çš„å˜åŒ–è€Œå˜åŒ–ï¼Œæ‰€ä»¥ä¾ç„¶å¯ä»¥ç”¨å®ƒæ¥è§£ç­”è¿™ä¸ªé—®é¢˜ã€‚æ²¡æœ‰äººè§„å®š <span class="math inline">\(Y-B\)</span> å’Œ <span class="math inline">\(A-X\)</span> ä¸èƒ½ä¸ºè´Ÿï¼Œä¸ºè´Ÿæ—¶æˆ‘ä»¬æŠŠ <span class="math inline">\(A\)</span> ä¸­å¡ä¸ä¸‹çš„ <span class="math inline">\(X\)</span> æ‹¿åˆ° <span class="math inline">\(B\)</span> é‡Œé¢å»å³å¯ï¼Œåä¹‹åŒç†ã€‚</p></details><p>é‚£ä¹ˆä»£ç è¿˜æ˜¯å¾ˆå¥½å†™çš„ã€‚æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n)\)</span>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 2e5 + 5;int a[maxn];int n, s, p, cl, cg, res;int main() &#123;    read(n);    for (int i = 1; i &lt;= n; ++i)        read(a[i]), s += a[i];    p = s / n, cg = s - p * n, cl = n - cg;    for (int i = 1; i &lt;= n; ++i) &#123;        if (a[i] &lt;= p) &#123;            if (cl) res += p - a[i], --cl;            else res += p - a[i] + 1, --cg;        &#125;        else &#123;            if (cg) res += a[i] - p - 1, --cg;            else res += a[i] - p, --cl;        &#125;    &#125;    print(res / 2, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="b.-knuth-è¡¨ç¤ºæ³•">B. Knuth è¡¨ç¤ºæ³•</h3><p><a href="http://222.180.160.110:61235/contest/4268/problem/2" class="uri">http://222.180.160.110:61235/contest/4268/problem/2</a></p><p>æ¨¡æ‹Ÿã€‚è¾“å…¥çš„æ•°ç”¨ <code>map</code> è½¬åŒ–ä¸º <span class="math inline">\(10\)</span> çš„æ¬¡å¹‚å½¢å¼ï¼Œç„¶åå¹‚æ¬¡ç›´æ¥ç›¸åŠ å³è¡¨ç¤ºæŒ‡æ•°ç›¸ä¹˜ã€‚</p><p>æœ€åæŒ‰ä½æ•°ä»å¤§åˆ°å°å°†æ¬¡å¹‚å½¢å¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€å†æŒ‰ä½æ•°ä»å°åˆ°å¤§è¾“å‡ºã€‚</p><p>æ³¨æ„åˆ°å¼€å¤´çš„å­—ç¬¦ä¸²ä¸æ˜¯ <code>one</code> å°±æ˜¯ <code>ten</code>ï¼Œéœ€è¦åœ¨æ²¡æœ‰æŠ½å‡ºæ¥ <code>ten</code> çš„æ—¶å€™è¡¥ <code>one</code>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;using str = std::string;const str u[] = &#123; &quot;one&quot;, &quot;ten&quot;, &quot;hundred&quot;, &quot;myriad&quot;, &quot;myllion&quot;, &quot;byllion&quot;, &quot;tryllion&quot;,                  &quot;quadryllion&quot;, &quot;quintyllion&quot;, &quot;sextyllion&quot;, &quot;septyllion&quot;, &quot;octyllion&quot;,                  &quot;nonyllion&quot;, &quot;decyllion&quot; &#125;;str x;int res = 0;std::stack&lt;str&gt; s;std::map&lt;str, int&gt; t;void get(str &amp;x) &#123;    str y;    std::stringstream p(x);    while (p &gt;&gt; y) &#123;        if (y == &quot;one&quot;) continue;        res += 1 &lt;&lt; (t[y] - 1);    &#125;    return;&#125;int main() &#123;    for (int i = 0; i &lt;= 13; ++i) t[u[i]] = i;    std::getline(std::cin, x), get(x);    std::getline(std::cin, x), get(x);    for (int i = 13; i; --i) &#123;        if (res &amp; (1 &lt;&lt; (i - 1)))            s.push(u[i]), res ^= (1 &lt;&lt; (i - 1));    &#125;    if (s.top() != &quot;ten&quot;) s.push(&quot;one&quot;);    while (!s.empty())        std::cout &lt;&lt; s.top() &lt;&lt; &#39; &#39;, s.pop();    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="c.-é­”åŠ›å¡”">C. é­”åŠ›å¡”</h3><p><a href="http://222.180.160.110:61235/contest/4268/problem/3" class="uri">http://222.180.160.110:61235/contest/4268/problem/3</a></p><p>ç¥å¥‡çš„çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ã€‚è¿™æ‹¿æ¥æ”¾ T3ï¼Ÿä¸åˆé€‚å§ã€‚</p><p>å¾ˆå¥½æƒ³åˆ°å¯¹äº <span class="math inline">\(a_i\ne -1\)</span>ï¼Œè¿è¾¹ <span class="math inline">\(i\to a_i\)</span>ï¼›å¦åˆ™ï¼Œè¿è¾¹ <span class="math inline">\(i\to x(x\in [i+1,\min(i + k,n+1)])\)</span>ã€‚BFS éå†ï¼Œå¤æ‚åº¦ <span class="math inline">\(O(n\times k)\)</span>ã€‚</p><p>é—®é¢˜åœ¨äºæ— ç”¨è¾¹å¤ªå¤šï¼Œä¾‹å¦‚ <span class="math inline">\(i\)</span> å’Œ <span class="math inline">\(i+1\)</span> å…±åŒå¯è¾¾çš„ç‚¹æœ‰æ•´æ•´ <span class="math inline">\(k-1\)</span> ä¸ªï¼Œé€ æˆå¤§é‡æµªè´¹ã€‚</p><p>è€ƒè™‘åˆ°å®é™…è¿›å…¥ BFS çš„ç‚¹åªæœ‰ <span class="math inline">\(n\)</span> ä¸ªï¼ŒåŠç”±ä¼ é€é—¨æ„æˆçš„è¿é€šå—å‡å‘ˆæ£’æ£’ç³–çŠ¶ï¼ˆå³é“¾å¥—ç¯ï¼‰ï¼Œæˆ‘ä»¬ç›´æ¥ä¼˜åŒ–æ‰ <span class="math inline">\(a_i=-1\)</span> æ—¶çš„è¿è¾¹ã€‚ä½¿ç”¨çº¿æ®µæ ‘æŸ¥è¯¢ <span class="math inline">\([i+1,\min(i + k,n+1)]\)</span> å†…çš„æ‰€æœ‰å‰©ä½™ç‚¹ï¼Œè¿è¾¹å…¥é˜Ÿå¹¶ä»çº¿æ®µæ ‘ä¸­åˆ é™¤ã€‚</p><p>è¿™æ ·ï¼Œæ¯ä¸ªç‚¹åªä¼šå…¥é˜Ÿä¸€æ¬¡ï¼ˆå¿½è§†æ— ç”¨ç¯ï¼‰ï¼Œæ—¶é—´å¤æ‚åº¦æ§åˆ¶åœ¨ <span class="math inline">\(O(n\log n)\)</span>ï¼Œ<span class="math inline">\(\log\)</span> æ¥æºäºçº¿æ®µæ ‘ï¼Œå†™å¾—ä¸å¥½å°±æ˜¯ <span class="math inline">\(\log^2\)</span>ï¼Œå†™å¾—å¥½ä¸€ç‚¹å°±åªæœ‰ä¸€ä¸ªã€‚</p><details><p><summary>ç„¶è€Œâ€¦</summary></p><p>ä¼š Tï¼Œå› ä¸ºå¸¸æ•°å¤ªå¤§äº†ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¦ä¸€ç§ <span class="math inline">\(\log\)</span> çš„åšæ³•ï¼Œå¹¶ä¸”çŸ­å°ç²¾æ‚ã€‚</p><p>ç”¨ <code>set</code> å­˜å‚¨æ‰€æœ‰æœªå…¥é˜Ÿçš„ç‚¹ï¼Œæ¯æ¬¡ <code>lower_bound</code> å¹¶ä¾æ¬¡å¼¹å‡ºã€å…¥é˜Ÿã€‚</p></details><p>ç”¨è¿­ä»£å™¨çš„è¯ä»£ç å¾ˆçŸ­ï¼Œç¾æ±æ±ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\log n)\)</span>ï¼Œä½†ç­‰æˆ‘å…ˆç£•ç‰‡è¯å…ˆã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 5e5 + 5;int a[maxn];int n, k, res;bool vis[maxn];std::set&lt;int&gt; t;std::vector&lt;int&gt; g[maxn]; int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;void DFS(int x) &#123;    res = max(res, x);    if (a[x] == -1) &#123;        auto p = t.lower_bound(x + 1);        while (p != t.end() &amp;&amp; *p &lt;= x + k) &#123;            g[x].push_back(*p);            t.erase(*p++);        &#125;    &#125;    for (auto i : g[x]) &#123;        if (vis[i]) continue;        vis[i] = 1, DFS(i);    &#125;    return;&#125;int main() &#123;    read(n), read(k);    for (int i = 1; i &lt;= n; ++i) &#123;        read(a[i]), t.insert(i + 1);        if (~a[i]) g[i].push_back(a[i]);    &#125;    DFS(1), print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="d.-å¡ç‰Œæ¸¸æˆ">D. å¡ç‰Œæ¸¸æˆ</h3><p><a href="http://222.180.160.110:61235/contest/4268/problem/4" class="uri">http://222.180.160.110:61235/contest/4268/problem/4</a></p><p>æ€ä¹ˆè¯´å‘¢ï¼Œçˆ†æœå¯ä»¥æ‹¿ 80ptsï¼ï¼ï¼ç„¶è€Œæ­£è§£æ˜¯åŒºé—´ DPï¼Œå“­å”§å”§ã€‚ä»–è¿™ä¸ªæ•°æ®èŒƒå›´ç»™å¾—å¾ˆç¥å¥‡ï¼Œè®©äººåªä¼šå¾€æœç´¢ä¸Šé¢æƒ³ã€‚</p><p>æ‘§æ¯æ“ä½œæ˜¯ä¸€æ¢ä¸€ï¼Œä¸ä¼šæ›´æ”¹ä¸²é•¿ï¼Œè€Œå…¥æ ˆæ“ä½œä¼šå¢åŠ åˆå§‹ä¸²çš„é•¿åº¦ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è€ƒè™‘ <strong>é€†åº DP</strong>ï¼Œä»æœ€ç»ˆçŠ¶æ€å…¥æ‰‹ï¼Œç”¨ <span class="math inline">\(f_{x, i, j}\)</span> è¡¨ç¤ºæ˜¯å¦å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ <span class="math inline">\(x\)</span> ç»è¿‡ä¸€ç³»åˆ—æ“ä½œæ¶ˆæ‰ <span class="math inline">\(w_{i\sim j}\)</span>ã€‚</p><p>é‚£ä¹ˆæ˜æ˜¾è‹¥ä¸€æ¡æ‘§æ¯æ“ä½œä¸ºå¯ç”¨å­—ç¬¦ <span class="math inline">\(a\)</span> æ‘§æ¯ <span class="math inline">\(w_i\)</span>ï¼Œæœ‰ <span class="math inline">\(f_{a, i, i} = 1\)</span>ã€‚</p><p>è‹¥ä¸€æ¡å…¥æ ˆæ“ä½œä¸ºç”¨å­—ç¬¦ <span class="math inline">\(a\)</span> æ¢å­—ç¬¦ <span class="math inline">\(b,c\)</span>ï¼Œæšä¸¾åŒºé—´æ–­ç‚¹ <span class="math inline">\(k\)</span>ï¼Œæœ‰ <span class="math inline">\(f_{a, i, j} = f_{b, i, k} \times f_{c, k + 1, j}\)</span>ã€‚</p><p>æœ€åç­”æ¡ˆä¸º <span class="math inline">\(f_{\texttt S,i,|w_i|}\)</span>ã€‚</p><p>æ³¨æ„å¾ªç¯é¡ºåºï¼ŒåŒºé—´çš„æšä¸¾åº”åœ¨å­—ç¬¦çš„æšä¸¾ä¹‹å¤–ã€‚æœ€ç»ˆæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(T\times |w_i|^3\times N_2)\)</span>ï¼Œæ³¨æ„åˆ°å­—æ¯çš„æšä¸¾å±äºå¸¸æ•°ã€‚èƒ¶å›Šå¥½åƒæ»´æã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 25;const int maxm = 1e3 + 5;int n, m, l;char w[maxn];bool r1[maxm][maxm];bool f[maxm][maxn][maxn];struct &#123; int u, a, b; &#125; r2[maxn];int main() &#123;    scanf(&quot;%d %d&quot;, &amp;n, &amp;m);    for (int i = 1; i &lt;= n; ++i) &#123;        scanf(&quot;%s&quot;, w + 1);        r1[(int)w[1]][(int)w[4]] = 1;    &#125;    for (int i = 1; i &lt;= m; ++i) &#123;        scanf(&quot;%s&quot;, w + 1);        r2[i].u = w[1];        r2[i].a = w[4], r2[i].b = w[5];    &#125;    while (~scanf(&quot;%s&quot;, w + 1)) &#123;        memset(f, 0, sizeof (f));        l = strlen(w + 1);        for (int i = &#39;A&#39;; i &lt;= &#39;Z&#39;; ++i) &#123;            for (int j = 1; j &lt;= l; ++j) &#123;                if (r1[i][(int)w[j]])                    f[i][j][j] = 1;            &#125;        &#125;        for (int len = 1; len &lt;= l; ++len) &#123;            for (int i = 1; i &lt;= l - len + 1; ++i) &#123;                int j = i + len - 1;                for (int t = &#39;A&#39;; t &lt;= &#39;Z&#39;; ++t) &#123;                    for (int k = i; k &lt; j; ++k) &#123;                        for (int p = 1; p &lt;= m; ++p) &#123;                            if (r2[p].u != t) continue;                            f[t][i][j] |= f[r2[p].a][i][k] &amp;&amp; f[r2[p].b][k + 1][j];                        &#125;                    &#125;                &#125;            &#125;        &#125;        puts(f[&#39;S&#39;][1][l] ? &quot;YES&quot; : &quot;NO&quot;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="e.-ç”Ÿé•¿æ ‘">E. ç”Ÿé•¿æ ‘</h3><p><a href="http://222.180.160.110:61235/contest/4268/problem/5" class="uri">http://222.180.160.110:61235/contest/4268/problem/5</a></p><p>ä¸€é“å¾ˆèœçš„é¢˜ã€‚æˆ‘ä»¬å‘ç°æœ‰å­æ ‘æ“ä½œï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°æ ‘å‰–ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥è¦è€ƒè™‘çš„å†…å®¹å°±æ˜¯çº¿æ®µæ ‘å¦‚ä½•ç»´æŠ¤ã€‚</p><p>é¢˜æ„æ¢å¥è¯è¯´å°±æ˜¯å¾€ä¸‹æ•° 0 ä»£æ˜¯åŠ ï¼Œæ•° 1 ä»£æ˜¯å‡ï¼Œæ•° 2 ä»£æ˜¯åŠ ï¼Œä»¥æ­¤ç±»æ¨ã€‚é‚£ä¹ˆä¸éš¾æƒ³åˆ°å¥‡å¶æ€§ã€‚</p><p>å¦‚æœèµ·ç‚¹çš„æ·±åº¦æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆå­æ ‘ä¸­æ‰€æœ‰å¥‡æ•°æ·±åº¦æƒå€¼å¢åŠ ï¼Œå¶æ•°æ·±åº¦æƒå€¼å‡å°‘ï¼Œåä¹‹åŒç†ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬æ“ä½œçº¿æ®µæ ‘çš„æ—¶å€™æ€ä¹ˆçŸ¥é“ç‚¹åœ¨æ ‘ä¸­çš„æ·±åº¦å¥‡å¶æ€§å‘¢ï¼Ÿæˆ‘ä»¬åªèƒ½åœ¨çº¿æ®µæ ‘å¤–æ‰çŸ¥é“å‘€ã€‚</p><p>æ‰€ä»¥è§‚å¯Ÿè¯¢é—®ï¼Œè¯¢é—®æ˜¯å•ç‚¹çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“äº†ï¼Œå¯ä»¥åªåœ¨çº¿æ®µæ ‘å¤–å¯¹å¥‡å¶æ€§è¿›è¡Œå¤„ç†ã€‚ç®€å•æ¥è¯´ï¼Œå‡è®¾æ›´æ”¹èµ·ç‚¹æ·±åº¦ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆå¢åŠ æ•´ä¸ªå­æ ‘çš„ã€Œå¥‡åŠ å¶å‡è®¡æ•°å™¨ã€ï¼›åä¹‹ï¼Œå¢åŠ æ•´ä¸ªå­æ ‘çš„ã€Œå¥‡å‡å¶åŠ è®¡æ•°å™¨ã€ã€‚</p><p>æœ€åæŸ¥è¯¢çš„æ—¶å€™ï¼Œå¦‚æœè¯¥ç‚¹æ·±åº¦ä¸ºå¥‡ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸ºå¯¹åº”çš„ã€Œå¥‡åŠ å¶å‡è®¡æ•°å™¨ã€å‡å»ã€Œå¥‡å‡å¶åŠ è®¡æ•°å™¨ã€çš„å€¼ï¼Œåä¹‹åŒç†ã€‚</p><p>åšåˆ°æœ€åå‘ç°æ ¹æœ¬ä¸ç”¨æ ‘å‰–ï¼Œå°±æ˜¯ä¸€ä¸ª DFN ä¸Šçº¿æ®µæ ‘ã€‚æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(m\log n)\)</span>ã€‚</p><p>èƒ¶å›ŠçœŸå¥½åƒï¼ï¼ï¼</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;#define lt (p &lt;&lt; 1)#define rt (lt | 1)const int maxn = 2e5 + 5;struct _ &#123;    int l, r;    int u1, u2, d1, d2;&#125;; _ t[maxn &lt;&lt; 2];int a[maxn], dep[maxn];std::vector&lt;int&gt; g[maxn];int n, m, x, y, tot, typ;int end[maxn], dfn[maxn], tab[maxn];// u åªç”¨ç»´æŠ¤æœ€åº•å±‚ä¿¡æ¯// æ‰€ä»¥ä¸ç”¨æ‰“ pushup // ä½†ç»´æŠ¤èµ·æ¥å¥½çœ‹ä¸€äº› æ‰€ä»¥è¿˜æ˜¯æ‰“äº†void pushup(int p) &#123;    t[p].u1 = t[lt].u1 + t[rt].u1;    t[p].u2 = t[lt].u2 + t[rt].u2;    return;&#125;void pushdown(int p) &#123;    if (t[p].d1) &#123;        t[lt].d1 += t[p].d1;        t[rt].d1 += t[p].d1;        t[lt].u1 += t[p].d1 * (t[lt].r - t[lt].l + 1);        t[rt].u1 += t[p].d1 * (t[rt].r - t[rt].l + 1);        t[p].d1 = 0;    &#125;    if (t[p].d2) &#123;        t[lt].d2 += t[p].d2;        t[rt].d2 += t[p].d2;        t[lt].u2 += t[p].d2 * (t[lt].r - t[lt].l + 1);        t[rt].u2 += t[p].d2 * (t[rt].r - t[rt].l + 1);        t[p].d2 = 0;    &#125;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].l = l, t[p].r = r;    if (l == r) &#123;        if (dep[tab[l]] &amp; 1)            t[p].u1 = a[tab[l]];        else t[p].u2 = a[tab[l]];        return;    &#125;    int mid = (l + r) &gt;&gt; 1;    bld(lt, l, mid), bld(rt, mid + 1, r);    pushup(p);    return;&#125;void add1(int p, int l, int r, int x) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        t[p].d1 += x;        t[p].u1 += (t[p].r - t[p].l + 1) * x;        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    pushdown(p);    if (l &lt;= mid) add1(lt, l, r, x);    if (r &gt; mid) add1(rt, l, r, x);    pushup(p);    return;&#125;void add2(int p, int l, int r, int x) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        t[p].d2 += x;        t[p].u2 += (t[p].r - t[p].l + 1) * x;        return;    &#125;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    pushdown(p);    if (l &lt;= mid) add2(lt, l, r, x);    if (r &gt; mid) add2(rt, l, r, x);    pushup(p);    return;&#125;int ask(int p, int x) &#123;    if (t[p].l == t[p].r)        return t[p].u1 - t[p].u2;    int mid = (t[p].l + t[p].r) &gt;&gt; 1;    pushdown(p);    if (x &lt;= mid) return ask(lt, x);    return ask(rt, x);&#125;void DFS(int x, int fa) &#123;    dfn[x] = ++tot, tab[tot] = x;    for (auto i : g[x]) &#123;        if (i == fa) continue;        dep[i] = dep[x] + 1;        DFS(i, x);    &#125;    end[x] = tot;    return;&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;    read(n), read(m);    for (int i = 1; i &lt;= n; ++i)        read(a[i]);    for (int i = 1; i &lt; n; ++i) &#123;        read(x), read(y);        add(x, y), add(y, x);    &#125;    dep[1] = 1, DFS(1, -1);    bld(1, 1, n);    while (m--) &#123;        read(typ), read(x);        if (typ == 1) &#123;            read(y);            if (dep[x] &amp; 1)                add1(1, dfn[x], end[x], y);            else add2(1, dfn[x], end[x], y);        &#125;        else &#123;            int res = ask(1, dfn[x]);            if (dep[x] &amp; 1)                print(res, &#39;\n&#39;);            else print(-res, &#39;\n&#39;);        &#125;    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="f.-å•è¯">F. å•è¯</h3><p><a href="http://222.180.160.110:61235/contest/4268/problem/6" class="uri">http://222.180.160.110:61235/contest/4268/problem/6</a></p><p><span class="math inline">\(n \le 20\)</span>ï¼Œè€ƒè™‘çŠ¶å‹ã€‚ç”¨ <span class="math inline">\(f_x\)</span> è¡¨ç¤ºçŠ¶æ€ä¸º <span class="math inline">\(x\)</span> æ—¶çš„æœ€å°ä»£ä»·ï¼Œå…¶ä¸­ <span class="math inline">\(x\)</span> æ˜¯å­—ç¬¦ä¸²åˆæ³•æƒ…å†µçš„çŠ¶æ€å‹ç¼©ã€‚</p><p>å¯¹äºæ¯ä¸€ä¸ªå¾…æ»¡è¶³çš„ä¸²ï¼Œæšä¸¾å»æ»¡è¶³å®ƒçš„å“ªä¸€ä½ï¼Œé‚£ä¹ˆæ»¡è¶³æ–¹å¼åˆ†ä¸¤ç§æƒ…å†µï¼š</p><ul><li>æŠŠå®ƒå˜æˆä¸€ä¸ªæ–°çš„å€¼</li><li><p>æŠŠå’Œå®ƒé‡åˆçš„å˜æˆæ–°çš„å€¼</p><p>æˆ‘ä»¬æ³¨æ„åˆ° <span class="math inline">\(n \le 20 \le 26\)</span>ï¼Œæ‰€ä»¥ä¸€å®šèƒ½æ‰¾åˆ°ä¸€ç§æ–¹æ³•è®©æ¯ä¸ªä¸²çš„è¿™ä¸€ä½éƒ½ä¸ä¸€æ ·ã€‚</p><p>æ¥ç€ï¼Œåæ­£æˆ‘ä»¬éƒ½è¦æ”¹è¿™ä¸€ä½äº†ï¼Œé‚£å°±è´ªå¿ƒåœ°æŠŠè¦æ”¹çš„å…¨éƒ¨æ”¹æˆå®Œå…¨ä¸ä¸€æ ·çš„ã€‚é‚£ä¹ˆè¿™äº›è¦æ”¹çš„ä¸²ä¹Ÿåœ¨è¿™ä¸€ä½ä¸Šæ»¡è¶³äº†æ¡ä»¶ã€‚</p></li></ul><p>æ‰€ä»¥ï¼Œå‡è®¾å¯¹äºçŠ¶æ€ <span class="math inline">\(i\)</span>ï¼Œæœ‰ä¸² <span class="math inline">\(j\)</span> æœªæ»¡è¶³ï¼Œæšä¸¾ä½ç½® <span class="math inline">\(k\)</span>ï¼Œæœ‰ï¼š</p><pre class="cpp"><code>f[i | (1 &lt;&lt; (j - 1))] = min(f[i | (1 &lt;&lt; (j - 1))], f[i] + a[j][k]); f[i | lac[j][k]] = min(f[i | lac[j][k]], f[i] + mx[j][k]);</code></pre><p>å…¶ä¸­ <code>lac[j][k]</code> å’Œ <code>mx[j][k]</code> éƒ½æ˜¯é¢„å¤„ç†å‡ºæ¥çš„å€¼ã€‚<code>lac[j][k]</code> è¡¨ç¤ºä¸ç¬¬ <span class="math inline">\(j\)</span> ä¸ªä¸²çš„ç¬¬ <span class="math inline">\(k\)</span> ä½ç›¸åŒä¸²çš„çŠ¶æ€å‹ç¼©ï¼›<code>mx[j][k]</code> è¡¨ç¤ºé€šè¿‡ç¬¬äºŒç§æ–¹å¼å°† <span class="math inline">\(j\)</span> ä¸²çš„ç¬¬ <span class="math inline">\(k\)</span> ä½å˜å¾—åˆæ³•çš„æœ€å°è´¹ç”¨ã€‚</p><p><code>lac[j][k]</code> çš„æ±‚æ³•æ²¡æœ‰ä»»ä½•ç–‘é—®ï¼Œä¸»è¦æ˜¯åœ¨ <code>mx[j][k]</code> ä¸Šã€‚æ³¨æ„åˆ°å‡è®¾è¿™ä¸€ä½ä¸Šæœ‰ <span class="math inline">\(x\)</span> ä¸ªä¸²ä¸ <span class="math inline">\(j\)</span> ä¸²çš„ç¬¬ <span class="math inline">\(k\)</span> ä½ç›¸åŒï¼ˆåŒ…æ‹¬å…¶æœ¬èº«ï¼‰ï¼Œè€Œæˆ‘ä»¬åªéœ€è¦å°†è¿™å½“ä¸­çš„ <span class="math inline">\(x-1\)</span> ä¸ªå˜æˆä¸¤ä¸¤ä¸åŒçš„å…¨æ–°å­—ç¬¦å°±å¯ä»¥åŒæ—¶æ»¡è¶³è¿™ <span class="math inline">\(x\)</span> ä¸²çš„æ¡ä»¶ï¼Œé‚£æˆ‘ä»¬ä¸ºä»€ä¹ˆä¸æŠŠä¸åŠ¨çš„è¿™ä¸€ä¸ªä¸²è®¾ç½®ä¸º <span class="math inline">\(x\)</span> ä¸ªä¸²ä¸­æ”¹è¿™ä¸€ä½ä»£ä»·æœ€å¤§çš„é‚£ä¸ªå‘¢ï¼Ÿ</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ã€‚æˆ‘ä»¬æšä¸¾çŠ¶æ€ã€æšä¸¾çŠ¶æ€ä¸­çš„æ¯ä¸€ä¸ª <code>0</code>ï¼Œæšä¸¾æ¯ä¸€ä¸ªä¸²çš„æ¯ä¸€ä½ï¼Œå®é™…ä¸Šæ˜¯ <span class="math inline">\(O(n\times m\times 2^n)\)</span> çš„ã€‚è™½ç„¶è·‘ä¸æ»¡ï¼Œä½†è¿™ä¸ªæ—¶é—´å¤æ‚åº¦ä»ç„¶æ˜¯æœ‰é—®é¢˜çš„ã€‚æˆ‘ä»¬éœ€è¦ä¼˜åŒ–ã€‚</p><p>æˆ‘ä»¬æšä¸¾çš„æ˜¯çŠ¶æ€ä¸­çš„æ¯ä¸€ä¸ª <code>0</code>ï¼Œå‡è®¾æˆ‘ä»¬çš„çŠ¶æ€æ˜¯ <code>000</code>ï¼Œæˆ‘ä»¬çš„è§£å†³æ–¹æ¡ˆæ˜¯å°†ä¸‰ä¸ª <code>0</code> ä½ç½®çš„æ–¹æ¡ˆå…±åŒå¤„ç†ï¼Œè¡¨ç¤ºä¸º <code>'0--'</code> + <code>'-0-'</code> + <code>'--0'</code>ã€‚ä½†å®é™…ä¸Šï¼Œæˆ‘ä»¬åªç”¨å®é™…æ±‚è§£ä¸€ä¸ª <code>0</code> ä½ç½®çš„ç­”æ¡ˆï¼Œè¡¨ç¤ºä¸º <code>'0--'</code> + <code>'-00'</code> ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åŸæœ¬éœ€è¦æšä¸¾æ¯ä¸€ä¸ªçŠ¶æ€ä¸º <code>0</code> çš„ <span class="math inline">\(j\)</span> å¹¶ç”¨ <span class="math inline">\(O(m)\)</span> çš„æ—¶é—´è¿›è¡Œè®¡ç®—ï¼Œç°åœ¨æˆ‘ä»¬ç¢°åˆ°ä¸€ä¸ªçŠ¶æ€ä¸º <code>0</code> çš„ <span class="math inline">\(j\)</span> å°±å¼€å§‹è®¡ç®—ï¼Œå¾—åˆ°å®Œå…¨ç›¸åŒçš„ç­”æ¡ˆã€‚</p><p>å¾ˆ NB å¹¶ä¸”å¾ˆå®ç”¨çš„ä¼˜åŒ–ï¼Œå·²åŠ å…¥ <a href="/20231117/">ä¸‹é¥­æ“ä½œåˆé›†</a>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 205;const int maxm = (1 &lt;&lt; 25) + 5;int f[maxm];int n, m, siz;char s[maxn][maxn];int lac[maxn][maxn];int a[maxn][maxn], mx[maxn][maxn];int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;int main() &#123;    while(~scanf(&quot;%d %d&quot;, &amp;n, &amp;m)) &#123;        memset(f, 0x3f, sizeof (f));        f[0] = 0, siz = 1 &lt;&lt; n;        for (int i = 1; i &lt;= n; ++i)            scanf(&quot;%s&quot;, s[i] + 1);        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= m; ++j)                scanf(&quot;%d&quot;, &amp;a[i][j]);        &#125;        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= m; ++j) &#123;                int sum = 0;                lac[i][j] = mx[i][j] = 0;                for (int k = 1; k &lt;= n; ++k) &#123;                    if (s[k][j] == s[i][j]) &#123;                        lac[i][j] |= 1 &lt;&lt; (k - 1);                        sum += a[k][j];                        mx[i][j] = max(mx[i][j], a[k][j]);                    &#125;                &#125;                mx[i][j] = sum - mx[i][j];            &#125;        &#125;        for (int i = 0, j; i &lt; siz - 1; ++i) &#123;            for (j = 1; j &lt;= n; ++j) &#123;                if (!(i &amp; (1 &lt;&lt; (j - 1))))                    break;            &#125;            for (int k = 1; k &lt;= m; ++k) &#123;                f[i | (1 &lt;&lt; (j - 1))] =                    min(f[i | (1 &lt;&lt; (j - 1))], f[i] + a[j][k]);                 f[i | lac[j][k]] =                    min(f[i | lac[j][k]], f[i] + mx[j][k]);            &#125;        &#125;        print(f[siz - 1], &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><p>è¿™æ¬¡æš´éœ²å‡ºçš„é—®é¢˜ï¼š</p><ul><li>æ·±åº¦ä¹±æ±‚ï¼Œæ‰“ä»£ç çš„æ—¶å€™è€ƒè™‘è¿‡è¦æ”¾åœ¨é€’å½’ä¹‹å‰ï¼Œä½†æ˜¯ç”±äºç²¾åŠ›ä¸é›†ä¸­æœ€åè¿˜æ˜¯æ”¾åœ¨äº†é€’å½’åé¢ã€‚</li></ul><p>æ²¡äº†ã€‚è¿™æ¬¡ä¸»è¦é—®é¢˜å‡ºåœ¨ T5ã€‚T3 ä¼°è®¡çœŸçš„æƒ³ä¸åˆ°ï¼Œå…ˆä¸å¼ºæ±‚è‡ªå·±ã€‚</p><p>è¿™æ¬¡å­¦åˆ°çš„æ–°çŸ¥è¯†ï¼š</p><ul><li>å¯¹äºå­é›†åˆå¹¶æœ€ä¼˜æ€§çš„é—®é¢˜ï¼Œå¯ä»¥ç”¨å•ç‚¹ + é›†åˆä»£æ›¿é›†åˆ + é›†åˆæšä¸¾ã€‚</li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>é¢œè‰²</title>
      <link href="/20230928/"/>
      <url>/20230928/</url>
      
        <content type="html"><![CDATA[<p>Solution to <a href="https://vjudge.net/contest/583230#problem/B">é¢œè‰²</a>ã€‚</p><span id="more"></span><hr /><h3 id="b---é¢œè‰²">B - é¢œè‰²</h3><p><a href="https://vjudge.net/contest/583230#problem/B" class="uri">https://vjudge.net/contest/583230#problem/B</a></p><p>é¢œè‰²åˆ å®Œè¿‡åå‰©ä¸‹çš„è‚¯å®šæ˜¯ä¸€æ®µåŒºé—´ã€‚</p><p>é‚£ä¹ˆåŒºé—´å¤–çš„æ‰€æœ‰é¢œè‰²éƒ½ä¼šè¢«åˆ æ‰ï¼Œå¦‚æœè¦æ»¡è¶³é¢˜ç›®æ¡ä»¶çš„è¯ï¼Œåˆ æ‰çš„é¢œè‰²ä¸èƒ½å‡ºç°åœ¨åŒºé—´å†…ã€‚</p><p>é‚£ä¹ˆå°±å¯ä»¥æœ‰è¿™ä¹ˆä¸€ä¸ªé¢˜æ„çš„è½¬åŒ–ï¼šå¯»æ‰¾åŒºé—´çš„ä¸ªæ•°ï¼Œæ»¡è¶³åŒºé—´å†…çš„é¢œè‰²åªå‡ºç°åœ¨åŒºé—´å†…ã€‚</p><p>ç„¶åä½ å¯èƒ½å°±è¦é—®äº†ï¼Œä¸æ˜¯è¿˜è¦æ»¡è¶³åŒºé—´å¤–çš„æ‰€æœ‰é¢œè‰²éƒ½ä¸å‡ºç°åœ¨åŒºé—´å†…å—ã€‚ä½†æ˜¯ä½ æƒ³æƒ³ï¼Œè¦æ˜¯å®ƒå‡ºç°åœ¨åŒºé—´å†…äº†ï¼Œå®ƒä½œä¸ºåŒºé—´å†…çš„é¢œè‰²ï¼Œä¸å°±ä¸æ»¡è¶³æˆ‘ä»¬ä¸Šé¢è¯´çš„é‚£æ¡è§„åˆ™äº†å—ã€‚</p><p>è¿™ä¸ªè½¬åŒ–æ˜¯éå¸¸å‰å®³çš„ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™æœ‰ä¸€ä¸ªæ˜¾è€Œæ˜“è§æš´åŠ›åšæ³•ï¼Œæˆ‘ä»¬è®°å½•ä¸€ä¸ªé¢œè‰²åœ¨æ•´ä¸ªåºåˆ—ä¸­å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½®ï¼ˆè®°ä¸º <span class="math inline">\(L_x\)</span>ï¼‰å’Œæœ€åä¸€ä¸ªä½ç½®ï¼ˆè®°ä½œ <span class="math inline">\(R_x\)</span>ï¼‰ï¼Œç„¶åæšä¸¾æ¯ä¸€ä¸ªåŒºé—´ <span class="math inline">\([i, j]\)</span>ï¼Œå†æšä¸¾å…¶ä¸­çš„æ¯ä¸€ä¸ªé¢œè‰²ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰è¶…å‡ºå»å°±å¥½ï¼Œå¤æ‚åº¦ <span class="math inline">\(O(n^3)\)</span>ã€‚</p><details><summary>å¯¹çº¯æš´åŠ›çš„ä¸€ç‚¹å°ä¼˜åŒ–</summary> ä¸Šè¿°åŒºé—´å†…æšä¸¾è¿‡ç¨‹è½¬åŒ–ä¸ºåˆ¤å®šåŒºé—´æ˜¯å¦æ»¡è¶³ <span class="math inline">\({L_x}_{\min} \ge i\)</span> ä¸” <span class="math inline">\({R_x}_{\max} \le j\)</span>ï¼Œé‡‡ç”¨æ•°æ®ç»“æ„ç»´æŠ¤ï¼Œå°±å¯ä»¥ä¼˜åŒ–åˆ° <span class="math inline">\(O(n^2\log)\)</span>ã€‚ä¸ºä»€ä¹ˆè¦ä¸“é—¨æä¸€å˜´è¿™ä¸ªå‘¢ï¼Œå› ä¸ºè¿™ä¸ªæ¨¡å‹æˆ‘æ²¡æƒ³åˆ°ã€‚æˆ‘çœŸ NBã€‚</details><p>æ¥ä¸‹æ¥åˆæ˜¯ä¸€ä¸ªæˆ‘æƒ³ä¸åˆ°çš„æ¨¡å‹ã€‚æˆ‘ä»¬å‘ç°å¤æ‚åº¦ç“¶é¢ˆå‡ºåœ¨æšä¸¾åŒºé—´ä¸Šï¼Œæ‰€ä»¥è€ƒè™‘é€šè¿‡å›ºå®šåŒºé—´å³ç«¯ç‚¹ï¼Œç”¨è¾ƒå°çš„å¤æ‚åº¦ç›´æ¥æ±‚è§£æ»¡è¶³æ¡ä»¶çš„å·¦ç«¯ç‚¹æ•°é‡æ¥è§£å†³é—®é¢˜ã€‚ä¸ºä»€ä¹ˆä¸æ˜¯å›ºå®šå·¦ç«¯ç‚¹å‘¢ï¼Ÿ</p><p>ã€Œå› ä¸ºé¢˜è§£éƒ½æ˜¯å†™çš„å›ºå®šå³ç«¯ç‚¹ã€‚ã€ 0# å¦‚æ˜¯è¯´ã€‚</p><p>å¯¹äºæ­£åœ¨æšä¸¾çš„å³ç«¯ç‚¹ <span class="math inline">\(j\)</span> å³è¾¹çš„é¢œè‰² <span class="math inline">\(x\)</span>ï¼Œæˆ‘ä»¬è®°å½•å®ƒä»¬ä¸Šä¸€æ¬¡å‡ºç°çš„ä½ç½® <span class="math inline">\(p_x\)</span>ï¼Œå¹¶ç”¨çº¿æ®µæ ‘æ‰¾åˆ°èŒƒå›´å†…æœ€å³å€¼ <span class="math inline">\((p_x)_{\max}\)</span>ï¼Œé‚£ä¹ˆå·¦ç«¯ç‚¹ <span class="math inline">\(i&gt;(p_x)_{\max}\)</span>ã€‚å– <span class="math inline">\(i&#39;=(p_x)_{\max}+1\)</span>ï¼Œè¿™æ ·æˆ‘ä»¬å°±åˆæ­¥å¾—åˆ°äº†ä¸€ä¸ª <span class="math inline">\([i&#39;, j]\)</span>ã€‚ç›¸å¯¹äºçº¯æš´åŠ›çš„åšæ³•ï¼Œ<span class="math inline">\(R_x\le j\)</span> çš„ç­‰ä»·æ¡ä»¶å·²ç»æ»¡è¶³ï¼Œä½†è¿˜æœ‰ä¸€ä¸ªæ¡ä»¶ï¼Œå°±æ˜¯ <span class="math inline">\(L_x\)</span> ä¸èƒ½å°äº <span class="math inline">\(i\)</span>ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿æ•°æ®ç»“æ„ç»´æŠ¤ <span class="math inline">\(p_x\)</span>ï¼Œæˆ‘ä»¬é€†åºæšä¸¾ <span class="math inline">\(j\)</span>ï¼Œè¿™æ ·åˆå¯ä»¥å¾—åˆ°ä¸€ä¸ªæ€§è´¨ï¼š<span class="math inline">\(i&#39;\)</span> å•è°ƒä¸é™ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬é€†å‘æ€ç»´ï¼Œå¤„ç†å‡ºå¯¹äºæ¯ä¸ª <span class="math inline">\(i\ge i&#39;\)</span>ï¼Œå…¶èƒ½å¤Ÿåˆ°çš„æœ€è¿œçš„ <span class="math inline">\(j\)</span>ï¼Œè®°ä¸º <span class="math inline">\(f_i\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯¹äº <span class="math inline">\(f_i\)</span> å»ºä¸€ä¸ªæƒå€¼çº¿æ®µæ ‘ï¼Œç„¶ååœ¨æšä¸¾è¿‡ç¨‹ä¸­æŸ¥è¯¢æƒå€¼åœ¨ <span class="math inline">\([j, +\infty)\)</span> çš„ <span class="math inline">\(i\)</span> çš„ä¸ªæ•°å°±æ˜¯ç­”æ¡ˆã€‚ç”±äºæ±‚çš„æ˜¯ä¸ªæ•°ï¼Œæ‰€ä»¥å¯ä»¥å¯¹è¶…å‡ºèŒƒå›´çš„ <span class="math inline">\(i\)</span> å¯¹åº”çš„ <span class="math inline">\(f_i\)</span> è¿›è¡Œåˆ é™¤æ“ä½œã€‚</p><p>é‚£ä¹ˆ <span class="math inline">\(f_i\)</span> åˆè¯¥æ€ä¹ˆæ±‚å‘¢ï¼Ÿæš´åŠ›åœ°å†å»ºä¸€ä¸ªæƒå€¼çº¿æ®µæ ‘ç»´æŠ¤ <span class="math inline">\(L_x\)</span>ï¼Œåœ¨ <span class="math inline">\((-\infty, i)\)</span> æƒå€¼èŒƒå›´å†…æŸ¥è¯¢ä¸‹æ ‡ <span class="math inline">\(k\)</span> çš„æœ€å°å€¼ï¼Œæ­¤æ—¶çš„ <span class="math inline">\(k\)</span> å°±æ˜¯ <span class="math inline">\(f_i\)</span>ã€‚</p><p>å› ä¸º 0# è®²è¯¾çš„æ—¶å€™æˆ‘åœ¨å¼€é£æœºï¼Œæ‰€ä»¥æˆ‘ä¹Ÿä¸çŸ¥é“ 0# æ˜¯ä¸æ˜¯è¿™ä¹ˆè®²çš„ï¼Œæ€»ä¹‹æˆ‘è¿™ä¹ˆåšåº”è¯¥èƒ½åšå‡ºæ¥ï¼Œå°±æ˜¯è¦ç»´æŠ¤çš„ä¸œè¥¿å®åœ¨æœ‰äº¿ç‚¹ç‚¹å¤šã€‚</p><p>ä½†æ˜¯æ³¨æ„åˆ°ä¸€ä¸ªçº¿æ®µæ ‘å’Œä¸¤ä¸ªæƒå€¼çº¿æ®µæ ‘ç»´æŠ¤çš„å¤§åŒºé—´å…¶å®æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬åªç”¨ä¸€ä¸ªçº¿æ®µæ ‘åŒæ—¶ç»´æŠ¤ä¸‰ä¸ªä¿¡æ¯å°±å¥½ã€‚æœ€åæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\log n)\)</span>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;#define lt (p &lt;&lt; 1)#define rt (lt | 1)#define mid (t[p].l + t[p].r) / 2const int maxn = 3e5 + 5;// shaber monotonicity// destroy my youth struct _ &#123; int l, r, u, d; &#125;;struct __ &#123;    int u, i;    __() &#123;&#125;    __(int u1, int i1) &#123;        u = u1, i = i1;    &#125;&#125;;int T, n, res;_ t[maxn &lt;&lt; 2];int a[maxn], L[maxn], R[maxn];int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;void pushup(int p) &#123;    t[p].u = t[lt].u + t[rt].u;    return;&#125;void pushdown(int p) &#123;    if (t[p].d) &#123;        t[lt].d = t[rt].d = 1;        t[lt].u = t[lt].r - t[lt].l + 1;        t[rt].u = t[rt].r - t[rt].l + 1;        t[p].d = 0;    &#125;    return;&#125;void bld(int p, int l, int r) &#123;    t[p].u = t[p].d = 0;    t[p].l = l, t[p].r = r;    if (l == r) return;    bld(lt, l, mid), bld(rt, mid + 1, r);    return;&#125;void add(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;        t[p].u = t[p].r - t[p].l + 1;        t[p].d = 1;        return;    &#125;    pushdown(p);    if (l &lt;= mid) add(lt, l, r);    if (r &gt; mid) add(rt, l, r);    pushup(p);    return;&#125;int ask(int p, int l, int r) &#123;    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)        return t[p].u;    int res = 0; pushdown(p);    if (l &lt;= mid) res = ask(lt, l, r);    if (r &gt; mid) res += ask(rt, l, r);    return res;&#125;int main() &#123;    read(T);    while (T--) &#123;        read(n), res = 0;        std::stack&lt;__&gt; p;        std::fill(L + 1, L + n + 1, n + 5);        std::fill(R + 1, R + n + 1, 0);        for (int i = 1; i &lt;= n; ++i) &#123;            read(a[i]), R[a[i]] = i;            if (L[a[i]] == n + 5) L[a[i]] = i;        &#125;        bld(1, 1, n);        for (int i = 1, j; i &lt;= n; ++i) &#123;            if (i == R[a[i]] &amp;&amp; i != L[a[i]])                add(1, L[a[i]] + 1, R[a[i]]);            else p.push(__(a[i], i));            while (!p.empty() &amp;&amp; R[p.top().u] &lt;= i) p.pop();            j = p.size() ? p.top().i : 0;            if (i != j) res += i - j - ask(1, j + 1, i);        &#125;        print(res, &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> çº¿æ®µæ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pnã€pm å’Œ plmm</title>
      <link href="/20230813/"/>
      <url>/20230813/</url>
      
        <content type="html"><![CDATA[<p>Sotution to <a href="https://codeforces.com/problemset/problem/258/C">CF258C Little Elephant and LCM</a>ã€‚</p><span id="more"></span><hr /><p>0#ï¼šé‚£ä¹ˆè¿™ä¸ª pn å¯ä»¥ç­‰äºä»€ä¹ˆï¼Ÿå®ƒåªèƒ½ç­‰äº pmã€‚ï¼ˆéœ²å‡ºçœ‹åˆ° plmm ä¸€èˆ¬çš„çŒ¥çåç¬‘ï¼‰</p><hr /><p>æ–¹ä¾¿èµ·è§ï¼Œä¸‹é¢ <span class="math inline">\(b_{\text{lcm}}\)</span> çš„æ„æ€å°±æ˜¯ <span class="math inline">\(\text{lcm}\{b_1,b_2,\cdots,b_n\}\)</span>ï¼Œ<span class="math inline">\(\max\)</span> ä»€ä¹ˆçš„ä¹ŸåŒç†ã€‚</p><p>é¦–å…ˆæˆ‘ä»¬éƒ½èƒ½ååº”è¿‡æ¥ï¼Œå¦‚æœ <span class="math inline">\(b_{\text{lcm}}=b_{\max}\)</span>ï¼Œé‚£ä¹ˆ <span class="math inline">\(b\)</span> ä¸­çš„æœ€å¤§å€¼å°±å¾—æ˜¯ <span class="math inline">\(b_{\text {lcm}}\)</span>ï¼Œè€Œå…¶ä»–å…ƒç´ éƒ½å¾—æ˜¯ <span class="math inline">\(b_{\max}\)</span> çš„å› æ•°ã€‚</p><p>æ—¢ç„¶æ¶‰åŠåˆ°æ±‚ <span class="math inline">\(b_{\max}\)</span> çš„å› æ•°ï¼Œé‚£æˆ‘ä»¬åŠ¿å¿…é¿å…ä¸äº†æšä¸¾ <span class="math inline">\(b_{\max}\)</span>ã€‚æˆ‘ä¸€å¼€å§‹é™·å…¥äº†ä¸€ä¸ª trickï¼šæˆ‘å¹¶ä¸çŸ¥é“ <span class="math inline">\(b_{\max}\)</span> åº”è¯¥å¤„äºå“ªä¸€ä¸ªä½ç½®ã€‚ä½†å…¶å®è¿™ä¸é‡è¦ï¼Œå®ƒå¯¹æˆ‘ä»¬æœ€åçš„æ–¹æ¡ˆæ²¡æœ‰å½±å“ï¼Œæœ‰å½±å“çš„æ˜¯ã€Œæœ‰å¤šå°‘ä¸ªä½ç½®å¯ä»¥å–åˆ°å½“å‰æšä¸¾çš„ <span class="math inline">\(b_{\max}\)</span>ã€ã€‚</p><p>å¯¹äºå½“å‰æšä¸¾çš„ <span class="math inline">\(b_{\max}\)</span>ï¼ˆå‡è®¾ä¸º <span class="math inline">\(k\)</span>ï¼‰ï¼Œæˆ‘ä»¬æ‰¾åˆ°å®ƒçš„æ‰€æœ‰å› æ•° <span class="math inline">\(p_1\sim p_m\)</span>ï¼ŒæŒ‰ä»å°åˆ°å¤§çš„é¡ºåºæ’åˆ—ã€‚å¯¹äºä¸€ä¸ª <span class="math inline">\(a_i\)</span>ï¼Œå½“ä¸”ä»…å½“ <span class="math inline">\(a_i\ge p_j\)</span> æ—¶ï¼Œ<span class="math inline">\(a_i\)</span> å¯ä»¥é€‰æ‹© <span class="math inline">\(p_j\)</span>ã€‚é‚£ä¹ˆæˆ‘ä»¬æ‰¾åˆ° <span class="math inline">\(a_i\)</span> å¯ä»¥é€‰åˆ°çš„æœ€å¤§çš„ <span class="math inline">\(p_j\)</span>ï¼Œæ­¤æ—¶ <span class="math inline">\(a_i\)</span> çš„é€‰æ‹©å°±æ˜¯ <span class="math inline">\(p_1\sim p_j\)</span>ï¼Œå…± <span class="math inline">\(j\)</span> ç§ã€‚</p><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨å¤–é¢å·²ç»æœ‰ä¸€å±‚æšä¸¾ <span class="math inline">\(k\)</span> çš„å¾ªç¯çš„å‰æä¸‹ï¼Œå†éå† <span class="math inline">\(a\)</span> æ•°ç»„æ— ç–‘æ˜¯ä¼šèµ·é£çš„ï¼Œæˆ‘ä»¬è€ƒè™‘å€’è¿‡æ¥ï¼Œéå† <span class="math inline">\(p\)</span>ï¼Œå¯¹äºæ¯ä¸ª <span class="math inline">\(p_j\)</span>ï¼Œæ‰¾åˆ°å®ƒæ˜¯å¤šå°‘ä¸ª <span class="math inline">\(a_i\)</span> çš„æœ€å¤§é€‰æ‹©ï¼ˆå‡è®¾ä¸º <span class="math inline">\(x_j\)</span>ï¼‰ï¼Œé‚£ä¹ˆå¯¹äº <span class="math inline">\(p_j\)</span>ï¼Œå®ƒè´¡çŒ®çš„ç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(j^{x_j}\)</span>ã€‚</p><p><span class="math inline">\(x_j\)</span> çš„è®¡ç®—ä¹Ÿä¸éš¾ï¼Œæˆ‘ä»¬ç”¨ä¸¤ä¸ªäºŒåˆ†æ‰¾åˆ°æ»¡è¶³ <span class="math inline">\(p_j\le a_i &lt; p_j + 1\)</span> çš„ <span class="math inline">\(a_i\)</span> æ•°é‡å°±å¯ä»¥äº†ã€‚é‚£ä¹ˆæ€»æ–¹æ¡ˆæ•°å°±æ˜¯ <span class="math inline">\(\prod j^{x_j}\)</span>ã€‚</p><p>ä½†æ˜¯åˆ«å¿˜äº†è¿˜æœ‰ <span class="math inline">\(k\)</span> ä¸º <span class="math inline">\(b_{\max}\)</span> çš„é™åˆ¶ã€‚æ‰¾åˆ° <span class="math inline">\(x_m\)</span>ï¼Œæ€ä¹ˆå»æ»¡è¶³è‡³å°‘æœ‰ä¸€ä¸ª <span class="math inline">\(a_i=k\)</span> å‘¢ï¼Ÿä¸€ä¸ªå¾®å‹å®¹æ–¥ï¼Œç”¨æ€»æ–¹æ¡ˆæ•°å‡å»ä¸€ä¸ª <span class="math inline">\(k\)</span> éƒ½æ²¡æœ‰çš„æ–¹æ¡ˆæ•°ã€‚é‚£ä¹ˆå°±è§„å®šäº†æ¯ä¸ªå¯ä»¥å–åˆ° <span class="math inline">\(k\)</span> çš„æ•°éƒ½å¿…é¡»ä¸å– <span class="math inline">\(k\)</span>ï¼Œæœ¬æ¥æœ‰ <span class="math inline">\(m\)</span> ç§é€‰æ‹©ï¼Œç°åœ¨åªå‰©ä¸‹ <span class="math inline">\(mâˆ’1\)</span> ç§ï¼Œæ‰€ä»¥ç­”æ¡ˆå°±æ˜¯ <span class="math inline">\((mâˆ’1)^{x_m}\)</span>ï¼Œå®¹æ–¥åä¸º <span class="math inline">\(m^{x_m}âˆ’(mâˆ’1)^{x_m}\)</span>ã€‚</p><p>å¯¹äº <span class="math inline">\(b_{\max}=k\)</span>ï¼Œæœ€ç»ˆç»“æœä¸º <span class="math inline">\((\prod\limits_{j=1}^{mâˆ’1}j^{x_j})\times (m^{x_m}âˆ’(mâˆ’1)^{x_m})\)</span>ã€‚åŠ æ³•åŸç†æŠŠæ‰€æœ‰ <span class="math inline">\(k\)</span> çš„æƒ…å†µåŠ èµ·æ¥å³å¯ã€‚</p><p>å¯¹äºæ—¶é—´å¤æ‚åº¦ï¼Œæšä¸¾ <span class="math inline">\(k\)</span> æ˜¯ <span class="math inline">\(O(V)\)</span> çš„ï¼Œæ‰¾å› æ•°æ˜¯ <span class="math inline">\(O(\sqrt V)\)</span> çš„ï¼Œæšä¸¾ <span class="math inline">\(p_j\)</span> æ˜¯ <span class="math inline">\(\log V\)</span> çš„ï¼ŒäºŒåˆ†æ˜¯ <span class="math inline">\(\log n\)</span> çš„ã€‚æ‰€ä»¥æœ€ç»ˆæ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(V\times \max\{\sqrt V,\log V\times \log n\})\)</span>ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int mod = 1e9 + 7;const int maxn = 1e5 + 5;int a[maxn];int n, mx, ans, res;int qkp(int x, int y) &#123;    int res = 1;    while (y) &#123;        if (y &amp; 1) (res *= x) %= mod;        (x *= x) %= mod, y &gt;&gt;= 1;    &#125;    return res;&#125;int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;int main() &#123;    read(n);    for (int i = 1; i &lt;= n; ++i)         read(a[i]), mx = max(mx, a[i]);    std::sort(a + 1, a + n + 1);    for (int k = 1; k &lt;= mx; ++k) &#123;        res = 1;        std::vector&lt;int&gt; p;        p.push_back(-1); // å ä½ç¬¦ï¼Œæ–¹ä¾¿ä¸‹æ ‡å¯¹é½         for (int i = 1; i * i &lt;= k; ++i) &#123;            if (k % i == 0) &#123;                p.push_back(i);                if (i * i != k) p.push_back(k / i);            &#125;        &#125;        std::sort(p.begin() + 1, p.end());        // å…ˆç®—å‰ m - 1 ä¸ª         int m = p.size() - 1;        for (int j = 1; j &lt;= m - 1; ++j) &#123;            int l, r, x;            l = std::lower_bound(a + 1, a + n + 1, p[j]) - a;            r = std::lower_bound(a + 1, a + n + 1, p[j + 1]) - a - 1;            x = r - l + 1, (res *= qkp(j, x)) %= mod;        &#125;        int l, r, x;        l = std::lower_bound(a + 1, a + n + 1, p[m]) - a;        r = n, x = r - l + 1;        (res *= (qkp(m, x) - qkp(m - 1, x))) %= mod;        (ans += res) %= mod;    &#125;    print((ans + mod) % mod, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> äºŒåˆ† </tag>
            
            <tag> å®¹æ–¥åŸç† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>çŸ©é˜µ</title>
      <link href="/20230729/"/>
      <url>/20230729/</url>
      
        <content type="html"><![CDATA[<p>Solution to <a href="http://222.180.160.110:61235/contest/3825/problem/7">BZOJ2406 çŸ©é˜µ</a>ã€‚</p><span id="more"></span><hr /><blockquote><p>èµ›æ—¶å…¬å‘Š</p><p>ç°åœ¨å‘¢ï¼Ÿï¼šç°åœ¨æœ‰å¼¹çª—äº†å— ã€Œ2023-07-19 16:45:07ã€</p></blockquote><p>æ­¤æ—¶æ— å£°èƒœæœ‰å£°ã€‚</p><hr /><h3 id="f.bzoj2406çŸ©é˜µ">F.ã€ŒBZOJ2406ã€çŸ©é˜µ</h3><p><a href="http://222.180.160.110:61235/contest/3825/problem/7" class="uri">http://222.180.160.110:61235/contest/3825/problem/7</a></p><p>è¿™æ˜¯å¤´ä¸€æ¬¡è§è¯†åˆ°æŠŠçŸ©é˜µå’Œç½‘ç»œæµç»“åˆåœ¨ä¸€èµ·çš„é¢˜ç›®ã€‚ä¸è¿‡è¿™ç§å¤„ç†æ–¹å¼ä¹Ÿæ˜¯æˆ‘ä»¬åœ¨å­¦ä¹ äºŒåˆ†å›¾æ—¶çš„å¸¸å®¢äº†ï¼šæŠŠè¡Œå’Œåˆ—è¿è¾¹è¡¨ç¤ºæŸä¸€å…ƒç´ ã€‚</p><p>æˆ‘ä»¬å‘ç° <span class="math inline">\(B_{i, j}\)</span> æœ‰ç»™å®šçš„ä¸Šä¸‹ç•Œï¼Œæ•…æˆ‘ä»¬è€ƒè™‘ <strong>ä¸Šä¸‹ç•Œç½‘ç»œæµ</strong>ã€‚é‚£æ€ä¹ˆå»è¡¨ç¤º <span class="math inline">\(B_{i, j}\)</span> å‘¢ï¼Ÿè¿™å°±è¦è”ç³»åˆ°æˆ‘ä»¬åˆšåˆšè¯´è¿‡çš„è¿è¾¹æ–¹å¼ï¼šç”¨è¾¹ <span class="math inline">\(i\to j\)</span> çš„æµé‡æ¥è¡¨ç¤º <span class="math inline">\(B_{i, j}\)</span>ï¼Œæœ‰ <span class="math inline">\([L, R]\)</span> çš„ä¸Šä¸‹ç•Œã€‚</p><p>å¯æ˜¯æˆ‘ä»¬é™¤äº† <span class="math inline">\([L,R]\)</span> çš„é™åˆ¶ï¼Œè¿˜æœ‰æœ€å¤§å€¼è¿™ä¸ªæ¡ä»¶å‘€ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ</p><p>æ³¨æ„åˆ°é¢˜ç›®è¦æ±‚æœ€å¤§çš„æœ€å°ï¼Œè‡ªç„¶æƒ³åˆ°äºŒåˆ†ç­”æ¡ˆã€‚è®¾ç­”æ¡ˆä¸º <span class="math inline">\(x\)</span>ï¼Œåˆ™æˆ‘ä»¬éœ€è¦ä¿è¯æ¯è¡Œæ¯åˆ—çš„ç­”æ¡ˆéƒ½ <span class="math inline">\(\le x\)</span>ã€‚æ¯è¡Œæ¯åˆ—ï¼Œè¿™åˆšå¥½æ˜¯æˆ‘ä»¬çš„å»ºç‚¹æ–¹å¼ã€‚è¿™å¯¹ç‚¹æœ¬èº«ä½œå‡ºäº†è¦æ±‚ï¼Œè¿™å¥—è·¯æˆ‘ä»¬ç†Ÿï¼Œè®©å¤§æºç‚¹å‘è¡Œè¿è¾¹ã€åˆ—å‘å¤§æ±‡ç‚¹è¿è¾¹å°±å¥½ã€‚</p><p>é‚£ä¹ˆè¿™äº›è¾¹çš„ä¸Šä¸‹ç•Œæ€ä¹ˆåŠå‘¢ï¼Ÿæˆ‘ä»¬å·²çŸ¥ <span class="math inline">\(|S_A-S_B|\le x\)</span>ï¼Œé‚£ä¹ˆå˜å½¢å¾—ï¼š</p><p><span class="math display">\[\begin{cases}S_B\ge S_A-x &amp;(S_B \le S_A) \\S_B\le S_A+x &amp;(S_B \ge S_A)\end{cases}\]</span></p><p>ç…§ç†æ¥è¯´ï¼Œä¸¤è¡Œçš„ç¬¦å·ç›¸åï¼Œæˆ‘ä»¬ç°åœ¨å·²ç»å¾—åˆ°äº†ä¸€ä¸ªå…·æœ‰å¯¹ç§°ç¾çš„ä¸Šä¸‹ç•Œï¼š<span class="math inline">\(S_A-x\le S_B\le S_A+x\)</span>ï¼Œå°±åº”è¯¥é€Ÿé€Ÿè¿è¾¹äº†ï¼Œå¯æ˜¯æˆ‘æ€ä¹ˆçœ‹éƒ½è§‰å¾—ä¸èˆ’å¦ï¼šè¿™ä¸ªä¸ç­‰å¼å¯æ˜¯å¸¦æ¡ä»¶çš„ï¼Œå°±è¿™ä¹ˆç›´æ¥æ‹¿æ¥åšä¸Šä¸‹ç•ŒçœŸçš„æ²¡é—®é¢˜å—ï¼Ÿ</p><p><del>ç­”æ¡ˆæ˜¯æ²¡é—®é¢˜ï¼Œå› ä¸ºæˆ‘çœ‹çš„é¢˜è§£æ˜¯è¿™ä¹ˆå†™çš„</del> æœ¬ç€æ¢ç´¢æ±‚çœŸç²¾ç¥ï¼Œæˆ‘ä»¬è€ƒè™‘å°Šé‡åŸä¸ç­‰å¼ï¼ˆå› ä¸ºåŸä¸ç­‰å¼çš„æ¯ä¸€è¡Œåˆšå¥½ä¹Ÿæœ‰ä¸¤ä¸ªç›¸åçš„ç¬¦å·ï¼‰ï¼Œå°†è¿™äº›è¾¹æ‹†æˆä¸¤æ¡ï¼Œä¸€æ¡çš„ä¸Šä¸‹ç•Œæ˜¯ <span class="math inline">\([S_A-x, S_A]\)</span>ï¼Œå¦ä¸€æ¡æ˜¯ <span class="math inline">\([S_A,S_A+x]\)</span>ã€‚6ã€‚æˆ‘æ˜ç™½é¢˜è§£ä¸ºä»€ä¹ˆè¿™ä¹ˆå†™äº†ï¼Œä¸€ä¸ªçš„ä¸‹ç•Œå°±æ˜¯å¦ä¸€ä¸ªçš„ä¸Šç•Œï¼Œé‚£ç›´æ¥åˆå¹¶ä¸å°±è¡Œäº†ï¼Œè¿™ä¸ª naive trick é¢˜è§£éƒ½ä¸å±‘äºå†™å‡ºæ¥ã€‚</p><p>ç„¶åè·‘ä¸ªå¯è¡Œæµå°±å¯ä»¥äº†ã€‚æ³¨æ„è¦ä¿è¯è¾¹çš„ä¸‹ç•Œä¸ºéè´Ÿã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int lim = 2e5;const int maxn = 405;const int inf = 1e18;const int maxm = 3e5 + 5;struct _ &#123;    int v, w, n;    _() &#123;&#125;    _(int v1, int w1, int n1) &#123;        v = v1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];int gs, gt, tot;int a[maxn][maxn];int l, mid, r, res;int h[maxn], dif[maxn];int n, m, cnt, s, t, L, R;int vis[maxn], now[maxn], dep[maxn];int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;bool BFS(int n) &#123;    std::fill(vis + 1, vis + n + 1, 0);    std::fill(dep + 1, dep + n + 1, 0);     std::queue&lt;int&gt; q;    dep[gs] = 1, vis[gs] = 1;    q.push(gs), now[gs] = h[gs];    while (!q.empty()) &#123;        int f = q.front(); q.pop();        for (int i = h[f]; i; i = u[i].n) &#123;            int v = u[i].v, w = u[i].w;            if (vis[v] == 1 || w == 0) continue;            vis[v] = 1, now[v] = h[v];            dep[v] = dep[f] + 1, q.push(v);            if (v == gt) return 1;        &#125;    &#125;    return 0;&#125;int findP(int x, int flow = inf) &#123;    if (x == gt) return flow;    int rest = flow, i;    for (i = now[x]; rest &amp;&amp; i; i = u[i].n) &#123;        now[x] = i;        int v = u[i].v, w = u[i].w;        if (dep[v] != dep[x] + 1 || w == 0) continue;        int t = findP(v, min(rest, w));        if (t == 0) dep[v] = 0;        rest -= t, u[i].w -= t, u[i ^ 1].w += t;    &#125;    return flow - rest;&#125;int Dinic(int n) &#123;    int res = 0;    while (BFS(n)) &#123;        int t = findP(gs);        while (t) res += t, t = findP(gs);    &#125;    return res;&#125;void add(int x, int y, int w) &#123;    u[++tot] = _(y, w, h[x]), h[x] = tot;    return;&#125;void add(int x, int y, int d, int u) &#123;    add(x, y, u - d), add(y, x, 0);    dif[x] -= d, dif[y] += d;    return;&#125;void Init(void) &#123;    tot = 1, cnt = 0;    memset(h, 0, sizeof (h));    memset(dif, 0, sizeof (dif));    return;&#125;bool check(int x) &#123;    Init();    s = n + m + 1, t = s + 1;    add(t, s, inf), add(s, t, 0);    gs = t + 1, gt = t + 2;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j)            add(i, j + n, L, R);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        int sum = 0;        for (int j = 1; j &lt;= m; ++j)            sum += a[i][j];        add(s, i, max(0, sum - x), sum + x);    &#125;    for (int j = 1; j &lt;= m; ++j) &#123;        int sum = 0;        for (int i = 1; i &lt;= n; ++i)            sum += a[i][j];        add(j + n, t, max(sum - x, 0), sum + x);    &#125;    for (int i = 1; i &lt;= t; ++i) &#123;        if (dif[i] &lt; 0)            add(i, gt, -dif[i]), add(gt, i, 0);        else if (dif[i] &gt; 0) &#123;            add(gs, i, dif[i]);            add(i, gs, 0), cnt += dif[i];        &#125;    &#125;    return (Dinic(gt) == cnt);&#125;int main() &#123;    read(n), read(m);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j)            read(a[i][j]);    &#125;    read(L), read(R);    l = 0, r = lim, res = -1;    while (l &lt;= r) &#123;        mid = (l + r) &gt;&gt; 1;        if (check(mid))            res = mid, r = mid - 1;        else l = mid + 1;    &#125;    print(res);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><p>ä½ æœ€å¥½æœ‰è¦äº‹ç›¸æ±‚.jpg</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œæµ </tag>
            
            <tag> äºŒåˆ† </tag>
            
            <tag> ä¸Šä¸‹ç•Œç½‘ç»œæµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œæµ 24 é¢˜</title>
      <link href="/20230722/"/>
      <url>/20230722/</url>
      
        <content type="html"><![CDATA[<p>Solution to <a href="http://222.180.160.110:61235/contest/3952/problem/1">ç½‘ç»œæµ 24 é¢˜</a>ã€‚</p><span id="more"></span><hr /><h2 id="day-11st---6th">Day 1ï¼š1st - 6th</h2><h3 id="a.-æ˜Ÿé™…è½¬ç§»é—®é¢˜">A. æ˜Ÿé™…è½¬ç§»é—®é¢˜</h3><p><a href="http://222.180.160.110:61235/contest/3952/problem/1" class="uri">http://222.180.160.110:61235/contest/3952/problem/1</a></p><p>å¦‚æœå°±æŒ‰ç…§é¢˜ç›®ç»™çš„è·¯çº¿å›¾ï¼Œæˆ‘ä»¬æ˜¾ç„¶æ— æ³•è€ƒè™‘åˆ°é£èˆ¹åˆ°è¾¾çš„æ—¶åˆ»ã€‚åŒæ—¶ <span class="math inline">\(n\)</span> å’Œ <span class="math inline">\(m\)</span> åˆå¾ˆå°ï¼Œæˆ‘ä»¬å°±çŸ¥é“äº†ï¼Œã€Œäººä¸èƒ½ä¸¤æ¬¡è¸è¿›åŒä¸€æ¡æ²³æµã€ï¼Œ<span class="math inline">\(1\)</span> æ—¶åˆ»çš„ç«™ <span class="math inline">\(p\)</span> å’Œ <span class="math inline">\(2\)</span> æ—¶åˆ»çš„ç«™ <span class="math inline">\(p\)</span> ä¹Ÿä¸èƒ½æ˜¯åŒä¸€ä¸ªç«™ <span class="math inline">\(p\)</span>ã€‚</p><p>è€ƒè™‘ç”¨ <span class="math inline">\((p, t)\)</span> è¡¨ç¤º <span class="math inline">\(t\)</span> æ—¶åˆ»çš„ç«™ <span class="math inline">\(p\)</span>ï¼Œç„¶åå¯¹äºæ¯æ¡è·¯çº¿è·‘ä¸ªæš´åŠ›è¿è¾¹ï¼Œå®¹é‡å…¨éƒ¨ä¸º <span class="math inline">\(H_i\)</span>ã€‚</p><p>æ€ä¹ˆæ§åˆ¶æ—¶é—´æœ€å°å‘¢ï¼ŸäºŒåˆ†ä¸€ä¸‹å°±å¯ä»¥äº†â€¦â€¦ ç„¶åæœ€å¤§æµåˆ¤å®šæ˜¯ä¸æ˜¯æ»¡æµçš„å³å¯ã€‚</p><p>ä»¥åŠæ³¨æ„åˆ°å¯¹äºåŒä¸€ç«™ç‚¹ï¼Œå‰é¢çš„æ—¶åˆ»å¯ä»¥ç•™ä¸‹æ¥ç­‰åé¢çš„æ—¶åˆ»ï¼Œæˆ‘ä»¬å°†åŒä¸€ç«™çš„å‰ä¸€æ—¶åˆ»å’Œåä¸€æ—¶åˆ»å…¨éƒ¨è¿è¾¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(k\)</span>ã€‚ä»¥åŠä¿ç•™èŠ‚ç›®å¯¹æºç‚¹æ‹†ç‚¹ä»¥æ§åˆ¶æµé‡ä¸º <span class="math inline">\(k\)</span>ã€‚</p><p><del>ç»å®éªŒç­”æ¡ˆæœ€å¤§ä¸º 29ï¼Œæ‰€ä»¥æŠŠäºŒåˆ†ä¸Šç•Œè®¾ä¸º 30 å³å¯</del> ç†è®ºä¸Šæ¥è¯´ç­”æ¡ˆå¯èƒ½å¾ˆå¤§ï¼Œæ¯”å¦‚ä½ è°·æœ€åä¸€ç»„æ•°æ®çš„ç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(900\)</span> å¤šï¼Œæ‰€ä»¥æˆ‘ææŒ‡ä¸€ç®—ç”¨å¤©æ‰èˆ¬çš„ç®—æœ¯æŠ€å·§å¼€äº† <span class="math inline">\(10^4\)</span>ã€‚çœŸçš„ï¼Œæ•°æ•°ä½å¤©æ‰å°±æ˜¯æˆ‘ã€‚</p><details><p>wocï¼Œè¿™é¢˜å±…ç„¶æ²¡äººåšï¼Œæœç„¶æˆ‘è¿˜æ˜¯å¤ªå¼ºäº†ã€‚</p><p>ä¸ºä»€ä¹ˆéƒ½è·‘å»åš T4 äº†ï¼Œè¿™ä¸ªä¸æ˜¯æŒ‰éš¾åº¦é¡ºåºæ’åˆ—çš„å—ï¼Ÿ</p><p>å“¦å“¦ï¼Œå¥½åƒä¸æ˜¯ï¼Œé‚£ï¼ˆNaï¼‰æ²¡ï¼ˆMeiï¼‰äº‹ï¼ˆShiï¼‰äº†ï¼ˆLeï¼‰ã€‚</p><p><img src="https://pic.imgdb.cn/item/64be2f6e1ddac507cc0e0955.png" /></p><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int lim = 1e4;const int inf = 1e18;const int maxm = 4e5 + 5;const int maxn = 5e4 + 15;struct _ &#123;    int v, w, n;    _() &#123;&#125;    _(int v1, int w1, int n1) &#123;        v = v1, w = w1, n = n1;    &#125;&#125;;struct __ &#123;    int c;    std::vector&lt;int&gt; p;&#125;;_ u[maxm];__ w[maxn];int h[maxn];int l, mid, r;int gs, gt, tot = 1;int n, m, k, s, mt, x, res, y;int vis[maxn], now[maxn], dep[maxn];int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int fun(int p, int t) &#123; return (p - 1) * mt + t; &#125;bool BFS(int n) &#123;    std::fill(vis + 1, vis + n + 1, 0);    std::fill(dep + 1, dep + n + 1, 0);     std::queue&lt;int&gt; q;    dep[gs] = 1, vis[gs] = 1;    q.push(gs), now[gs] = h[gs];    while (!q.empty()) &#123;        int f = q.front(); q.pop();        for (int i = h[f]; i; i = u[i].n) &#123;            int v = u[i].v, w = u[i].w;            if (vis[v] == 1 || w == 0) continue;            vis[v] = 1, now[v] = h[v];            dep[v] = dep[f] + 1, q.push(v);            if (v == gt) return 1;        &#125;    &#125;    return 0;&#125;int findP(int x, int flow = inf) &#123;    if (x == gt) return flow;    int rest = flow, i;    for (i = now[x]; rest &amp;&amp; i; i = u[i].n) &#123;        int v = u[i].v, w = u[i].w;        now[x] = i;        if (dep[v] != dep[x] + 1 || w == 0)            continue;        int t = findP(v, min(rest, w));        if (t == 0) dep[v] = 0;        rest -= t, u[i].w -= t, u[i ^ 1].w += t;    &#125;    return flow - rest;&#125;int Dinic(int n) &#123;    int res = 0;    while (BFS(n)) &#123;        int t = findP(gs);        while (t) res += t, t = findP(gs);    &#125;    return res;&#125;void add(int x, int y, int w) &#123;    u[++tot] = _(y, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int w) &#123;    add(x, y, w), add(y, x, 0);    return;&#125;void Init(void) &#123;    tot = 1;    memset(h, 0, sizeof (h));    return;&#125;bool check(int x) &#123;    Init();    mt = x, s = fun(n, mt) + 1;    gs = s + 1, gt = s + 2;    addf(gs, s, k);    for (int i = 1; i &lt;= mt; ++i) &#123;        addf(s, fun(n - 1, i), k);        addf(fun(n, i), gt, k);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt; mt; ++j)            addf(fun(i, j), fun(i, j + 1), k);    &#125;    for (int i = 1; i &lt;= m; ++i) &#123;        int p = 0, x = 0, la = 0;        while (++p &lt;= mt) &#123;            if (la != 0)                addf(fun(la, p - 1), fun(w[i].p[x], p), w[i].c);            la = w[i].p[x];            if (++x &gt;= w[i].p.size()) x = 0;        &#125;    &#125;    return (Dinic(gt) == k);&#125;int main() &#123;    read(n), read(m), read(k);    for (int i = 1; i &lt;= m; ++i) &#123;        read(w[i].c), read(y);        while (y--) &#123;            read(x);            if (x == 0) x = n + 1;            else if (x == -1) x = n + 2;            w[i].p.push_back(x);        &#125;    &#125;    n += 2;    l = 1, r = lim;    while (l &lt;= r) &#123;        mid = (l + r) &gt;&gt; 1;        if (check(mid))            res = mid, r = mid - 1;        else l = mid + 1;    &#125;    print(res ? res - 1 : 0, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="b.-æœ€é•¿é€’å¢å­åºåˆ—">B. æœ€é•¿é€’å¢å­åºåˆ—</h3><p><a href="http://222.180.160.110:61235/contest/3952/problem/2" class="uri">http://222.180.160.110:61235/contest/3952/problem/2</a></p><p>å°±ç®—çŸ¥é“ä¸æ˜¯æŒ‰éš¾åº¦é¡ºåºæ’åˆ—æˆ‘ä¹Ÿè¦é¡ºåºå¼€é¢˜ã€‚æ¬¸å˜¿ï¼Œå°±æ˜¯ç©ã€‚</p><p>ç¬¬ä¸€é—®å¾ˆæ°´ï¼Œè·‘ä¸ª DP å°±è¡Œã€‚</p><p>ç¬¬äºŒé—®æœ‰ç‚¹æ„æ€ï¼Œå–å‡ºå°±ä»£è¡¨åªèƒ½é€‰ä¸€æ¬¡ï¼Œæ€»ä¹‹å…¸ä¸­å…¸ï¼ŒæŠŠæ¯ä¸ªæ•°æ‹†æˆå…¥ç‚¹å’Œå‡ºç‚¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(1\)</span>ï¼Œè¿™æ ·å°±å¯ä»¥åªé€‰ä¸€æ¬¡äº†ã€‚</p><p>é‚£æ€ä¹ˆä¿è¯æ¯æ¬¡æ‰¾åˆ°çš„æµä¸€å®šæ˜¯ LIS å‘¢ï¼Ÿå…¶å®è¿™å’Œæˆ‘ä»¬ Dinic çš„æ·±åº¦åˆ†å±‚æ•°ç»„æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ï¼Œæˆ‘ä»¬æŠŠ <span class="math inline">\(f_i = f_j + 1(i&gt;j,A_i\ge A_j)\)</span> çš„ <span class="math inline">\((j, i)\)</span> è¿è¾¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(1\)</span> å³å¯ã€‚</p><p>ç„¶åæºç‚¹åªå’Œæ»¡è¶³ <span class="math inline">\(f_x = 1\)</span> çš„ <span class="math inline">\(x\)</span> è¿è¾¹ï¼Œç›¸åº”åœ°ï¼Œæ±‡ç‚¹ä¹‹å’Œæ»¡è¶³ <span class="math inline">\(f_x = \text{LIS}\)</span> çš„ <span class="math inline">\(x\)</span> è¿è¾¹ã€‚</p><p>ç¬¬ä¸‰é—®å¾ˆå¥½æƒ³å•Šï¼Œæˆ‘ä»¬æŠŠ <span class="math inline">\(1\)</span> åˆ°æºç‚¹å’Œ <span class="math inline">\(n\)</span> åˆ°æ±‡ç‚¹çš„å®¹é‡è®¾æˆæ— ç©·å¤§å°±å¥½ã€‚</p><p>ç„¶åè¸©äº†åŠå¤©çš„å‘ï¼Œè¿™é“é¢˜çš„æ‹†ç‚¹éƒ¨åˆ†ä¸çŸ¥é“ä¸ºä»€ä¹ˆå¿…é¡»è¦è¿åŒå‘è¾¹ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxm = 4e5 + 5;const int maxn = 5e5 + 15;struct _ &#123;    int v, w, n;    _() &#123;&#125;    _(int v1, int w1, int n1) &#123;        v = v1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];int n, res;int gs, gt, tot = 1;int a[maxn], h[maxn], f[maxn];int vis[maxn], now[maxn], dep[maxn];int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;bool BFS(int n) &#123;    std::fill(vis + 1, vis + n + 1, 0);    std::fill(dep + 1, dep + n + 1, 0);     std::queue&lt;int&gt; q;    dep[gs] = 1, vis[gs] = 1;    q.push(gs), now[gs] = h[gs];    while (!q.empty()) &#123;        int f = q.front(); q.pop();        for (int i = h[f]; i; i = u[i].n) &#123;            int v = u[i].v, w = u[i].w;            if (vis[v] == 1 || w == 0) continue;            vis[v] = 1, now[v] = h[v];            dep[v] = dep[f] + 1, q.push(v);            if (v == gt) return 1;        &#125;    &#125;    return 0;&#125;int findP(int x, int flow = inf) &#123;    if (x == gt) return flow;    int rest = flow, i;    for (i = now[x]; rest &amp;&amp; i; i = u[i].n) &#123;        int v = u[i].v, w = u[i].w;        now[x] = i;        if (dep[v] != dep[x] + 1 || w == 0) continue;        int t = findP(v, min(rest, w));        if (t == 0) dep[v] = 0;        rest -= t, u[i].w -= t, u[i ^ 1].w += t;    &#125;    return flow - rest;&#125;int Dinic(int n) &#123;    int res = 0;    while (BFS(n)) &#123;        int t = findP(gs);        while (t) res += t, t = findP(gs);    &#125;    return res;&#125;void add(int x, int y, int w) &#123;    u[++tot] = _(y, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int w) &#123;    add(x, y, w), add(y, x, 0);    return;&#125;int main() &#123;    read(n);    gs = 2 * n + 1, gt = gs + 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(a[i]), f[i] = 1;        addf(i, i + n, 1);        addf(i + n, i, 1);        for (int j = 1; j &lt; i; ++j) &#123;            if (a[j] &lt;= a[i])                f[i] = max(f[i], f[j] + 1);        &#125;        res = max(res, f[i]);        for (int j = 1; j &lt; i; ++j) &#123;            if (a[j] &lt;= a[i] &amp;&amp; f[i] == f[j] + 1)                addf(j, i + n, 1);        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        if (f[i] == 1) addf(gs, i, 1);        if (f[i] == res) addf(i + n, gt, 1);    &#125;    print(res, &#39;\n&#39;);    print(Dinic(gt), &#39;\n&#39;);    tot = 1;    memset(h, 0, sizeof (h));    for (int i = 1; i &lt;= n; ++i) &#123;        addf(i, i + n, 1);        addf(i + n, i, 1);        for (int j = 1; j &lt; i; ++j) &#123;            if (a[j] &lt;= a[i] &amp;&amp; f[i] == f[j] + 1)                addf(j, i + n, 1);        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        if (f[i] == 1) &#123;            if (i == 1) addf(gs, i, inf);            else addf(gs, i, 1);        &#125;        if (f[i] == res) &#123;            if (i == n) addf(i + n, gt, inf);            else addf(i + n, gt, 1);        &#125;    &#125;    print(Dinic(gt), &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="c.-é¤å·¾è®¡åˆ’é—®é¢˜">C. é¤å·¾è®¡åˆ’é—®é¢˜</h3><p><a href="http://222.180.160.110:61235/contest/3952/problem/3" class="uri">http://222.180.160.110:61235/contest/3952/problem/3</a></p><p>è¿™ä¸ªæœ‰ç‚¹ç®€å•å•Šã€‚å°±å·®æŠŠè´¹ç”¨æµä¸‰ä¸ªå¤§å­—æ‹ä½ è„¸ä¸Šäº†ã€‚</p><p>ç”¨è¿‡å’Œæ²¡ç”¨è¿‡çš„é¤å·¾æ˜¯ä¸èƒ½æ··åˆå¤„ç†çš„ï¼Œæ•…è€ƒè™‘æ‹†ç‚¹ï¼ŒæŠŠæ¯ä¸€å¤©æ‹†å‡ºæ¥ä¸€ä¸ªç‚¹è¡¨ç¤ºå½“å¤©æ‰€æœ‰ç”¨è¿‡çš„é¤å·¾é‡ï¼ˆæ³¨æ„ä¸æ­¢æ˜¯å½“å¤©ç”¨è¿‡çš„ï¼Œè¿˜å¯ä»¥æ˜¯å‰å‡ å¤©ä¼ ä¸‹æ¥çš„ï¼‰ã€‚</p><p>é¦–å…ˆä¸éš¾æƒ³åˆ°å¤§æºç‚¹å’Œæ¯å¤©çš„æ²¡ç”¨è¿‡è¿è¾¹ï¼Œå®¹é‡ä¸ºæ— ç©·å¤§ï¼Œè´¹ç”¨ä¸ºè´­ä¹°è´¹ç”¨ï¼Œè¡¨ç¤ºè´­ä¹°é¤å·¾ï¼›ç”¨è¿‡çš„å’Œä¸‹ä¸€å¤©ç”¨è¿‡çš„è¿è¾¹ï¼Œå®¹é‡ä¸ºæ— ç©·å¤§ï¼Œè´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ï¼Œè¡¨ç¤ºç”¨è¿‡çš„é¤å·¾çš„ç»§æ‰¿ï¼›ç”¨è¿‡çš„å’Œå¿«æ´— / æ…¢æ´—æ‰€éœ€æ—¶é—´åçš„æ²¡ç”¨è¿‡çš„è¿è¾¹ï¼Œå®¹é‡ä¸ºæ— ç©·å¤§ï¼Œè´¹ç”¨ä¸ºå¿«æ´— / æ…¢æ´—è´¹ç”¨ï¼Œè¡¨ç¤ºæŠŠç”¨è¿‡çš„æ´—æˆæ²¡ç”¨è¿‡çš„ï¼ˆå¥‡å¥‡æ€ªæ€ªï¼‰ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆè¡¨ç¤ºä½¿ç”¨é¤å·¾å‘¢ï¼Ÿè¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå¦™çš„å¤„ç†æ–¹å¼ï¼ŒæŠŠæ²¡ç”¨è¿‡çš„æœå¤§æ±‡ç‚¹è¿è¾¹ï¼Œå®¹é‡ä¸ºå½“å¤©ä½¿ç”¨é‡ï¼Œè´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ï¼Œè¡¨ç¤ºæŠŠè¿™ä¹ˆå¤šæ²¡ç”¨è¿‡çš„é¤å·¾é”€æ¯ï¼›å†æŠŠå¤§æºç‚¹æœç”¨è¿‡çš„è¿è¾¹ï¼Œå®¹é‡ä¹Ÿä¸ºå½“å¤©ä½¿ç”¨é‡ï¼Œè´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ï¼Œè¡¨ç¤ºå‡­ç©ºå˜å‡ºæ¥è¿™ä¹ˆå¤šæ¡ç”¨è¿‡çš„é¤å·¾ã€‚</p><p>ç„¶åè·‘ä¸ªè´¹ç”¨æµå°±å¯ä»¥äº†ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 4e3 + 5;const int maxm = 6e5 + 5;struct _ &#123;    int v, c, w, n;    _() &#123;&#125;    _(int v1, int c1, int w1, int n1) &#123;        v = v1, c = c1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];bool inq[maxn];int gs, gt, tot = 1;int h[maxn], dis[maxn];int fl[maxn], pre[maxn];int n, m, t1, c1, t2, c2, res, x;int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;bool SPFA(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(dis + 1, dis + n + 1, inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0) continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &gt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v]) inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;void SSP(int s, int n) &#123;    int p, mn, d;    while (SPFA(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d;    &#125;    return;&#125;void add(int x, int y, int c, int w) &#123;    u[++tot] = _(y, c, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int c, int w) &#123;    add(x, y, c, w), add(y, x, 0, -w);    return;&#125;int main() &#123;    read(n);    gs = 2 * n + 1, gt = gs + 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(x);        addf(i, gt, x, 0);        addf(gs, i + n, x, 0);        if (i != n)            addf(i + n, i + 1 + n, inf, 0);    &#125;    read(m), read(t1);    read(c1), read(t2), read(c2);    for (int i = 1; i &lt;= n; ++i) &#123;        addf(gs, i, inf, m);        if (i + t1 &lt;= n)            addf(i + n, i + t1, inf, c1);        if (i + t2 &lt;= n)            addf(i + n, i + t2, inf, c2);    &#125;    SSP(gs, gt);    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="d.-è¿è¾“é—®é¢˜">D. è¿è¾“é—®é¢˜</h3><p><a href="http://222.180.160.110:61235/contest/3952/problem/4" class="uri">http://222.180.160.110:61235/contest/3952/problem/4</a></p><p>ä¸æ˜¯å¾ˆç†è§£å•Šï¼Œè¿™é¢˜å°±ä¸€ä¸ªæ™®æ™®é€šé€šçš„äºŒåˆ†å›¾å»ºæ¨¡ï¼Œæœ‰ä»€ä¹ˆéš¾ç‚¹å—ï¼Œï¼Œï¼Œ</p><p>å“¦ï¼Œè“çš„ï¼Œé‚£æ²¡äº‹äº†ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 4e3 + 5;const int maxm = 6e5 + 5;struct _ &#123;    int v, c, w, n;    _() &#123;&#125;    _(int v1, int c1, int w1, int n1) &#123;        v = v1, c = c1, w = w1, n = n1;    &#125;&#125;;bool inq[maxn];int gs, gt, tot = 1;_ u[maxm], u1[maxm];int fl[maxn], pre[maxn];int h[maxn], dis[maxn], h1[maxn];int n, m, t1, c1, t2, c2, res, x;int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool SPFA(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(dis + 1, dis + n + 1, inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0)                continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &gt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v]) inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;bool SPFA1(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(pre + 1, pre + n + 1, 0);    std::fill(dis + 1, dis + n + 1, -inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0) continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &lt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v])                    inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;void SSP(int s, int n) &#123;    int p, mn, d;    while (SPFA(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d;    &#125;    return;&#125;void SSP1(int s, int n) &#123;    int p, mn, d;    while (SPFA1(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d;    &#125;    return;&#125;void add(int x, int y, int c, int w) &#123;    u[++tot] = _(y, c, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int c, int w) &#123;    add(x, y, c, w), add(y, x, 0, -w);    return;&#125;int main() &#123;    read(n), read(m);    gs = n + m + 1, gt = gs + 1;    for (int i = 1; i &lt;= n; ++i)        read(x), addf(gs, i, x, 0);    for (int i = 1; i &lt;= m; ++i)        read(x), addf(i + n, gt, x, 0);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j)            read(x), addf(i, j + n, inf, x);    &#125;    memcpy(h1, h, sizeof (h1));    memcpy(u1, u, sizeof (u1));    SSP(gs, gt);    print(res, &#39;\n&#39;), res = 0;    memcpy(h, h1, sizeof (h));    memcpy(u, u1, sizeof (u));    SSP1(gs, gt);    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="e.-æœ€å°è·¯å¾„è¦†ç›–">E. æœ€å°è·¯å¾„è¦†ç›–</h3><p><a href="http://222.180.160.110:61235/contest/3952/problem/5" class="uri">http://222.180.160.110:61235/contest/3952/problem/5</a></p><p>å½“æˆ‘ä»¬æŠŠæ‰€æœ‰ç‚¹è§†ä½œé•¿åº¦ä¸º <span class="math inline">\(0\)</span> çš„è·¯å¾„æ—¶ï¼Œç­”æ¡ˆä¸º <span class="math inline">\(n\)</span>ã€‚æ€ä¹ˆè®©è¿™ä¸ªç­”æ¡ˆå‡å°å‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦ <strong>åˆå¹¶è·¯å¾„</strong>ã€‚</p><p>å‡è®¾æœ‰è·¯å¾„ <span class="math inline">\(u \to x\)</span> å’Œ <span class="math inline">\(x \to v\)</span>ï¼Œé‚£ä¹ˆå°†å®ƒä»¬åˆå¹¶ä¸º <span class="math inline">\(u\to v\)</span> æ˜¾ç„¶å¯ä»¥å¾—åˆ°æ›´ä¼˜çš„ç­”æ¡ˆã€‚</p><p>é‚£ä¹ˆè¿™ä¸ªæ—¶å€™å°±æœ‰åŒå­¦è¦é—®äº†ï¼Œæˆ‘é€‰æ‹©åˆå¹¶è·¯å¾„çš„æ–¹å¼ä¼šä¸ä¼šå¯¹ç­”æ¡ˆäº§ç”Ÿå½±å“å‘¢ï¼Ÿè¿™ä¸ªä¸æ€¥ï¼Œæˆ‘ä»¬è®²å®Œäº†å†è¯æ˜ã€‚</p><p>é¦–å…ˆå¼€ä¸€ä¸ªæ–°å›¾ï¼ŒæŠŠæ‰€æœ‰ç‚¹æ•´ä¸€ä¸ªä¿ç•™èŠ‚ç›®ï¼Œ<span class="math inline">\(S\to x\)</span> å»ºä¸€æ¡å®¹é‡ä¸º <span class="math inline">\(1\)</span> çš„è¾¹ï¼›<span class="math inline">\(x&#39; \to T\)</span> å»ºä¸€æ¡å®¹é‡ä¸º <span class="math inline">\(1\)</span> çš„è¾¹ï¼›å¯¹äºè¾¹ <span class="math inline">\(u\to v\)</span>ï¼Œåœ¨ <span class="math inline">\(u\to v&#39;\)</span> å»ºä¸€æ¡å®¹é‡ä¸º <span class="math inline">\(1\)</span> çš„è¾¹ã€‚</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±æœ‰äº†ä¸€ä¸ªç±»äºŒåˆ†å›¾çš„æ¨¡å‹ã€‚æƒ³æƒ³çœ‹ï¼Œæˆ‘ä»¬åœ¨é‡Œé¢è·‘å‡ºæ¥çš„æœ€å¤§æµæ˜¯ä»€ä¹ˆï¼Ÿ</p><p>åœ¨è¿™ç§å®¹é‡å‡ä¸º <span class="math inline">\(1\)</span> çš„ç±»äºŒåˆ†å›¾æ¨¡å‹ä¸­ï¼Œç½‘ç»œæµä¸­æ‰¾åˆ°çš„è·¯å¾„å…¶å®å°±æ˜¯äºŒåˆ†å›¾ä¸­çš„å¢å¹¿è·¯ï¼Œå› ä¸ºåå‘çš„å®¹é‡ä¸º <span class="math inline">\(0\)</span> çš„è¾¹å°±ç›¸å½“äºå·²åŒ¹é…è¾¹ï¼Œä¼šé™åˆ¶æœç´¢è¿›ä¸€æ­¥æœä¸‹å»ã€‚</p><p>åœ¨äºŒåˆ†å›¾ä¸­ï¼Œæ¯æ‰¾åˆ°ä¸€æ¡å¢å¹¿è·¯ï¼Œæœ€å¤§åŒ¹é…çš„å¤§å°ä¾¿æ‰©å¤§ <span class="math inline">\(1\)</span>ï¼›åœ¨è¿™é‡Œçš„ç½‘ç»œæµä¸­ä¹Ÿä¸€æ ·ï¼Œæ¯æ‰¾åˆ°ä¸€æ¡è·¯å¾„ï¼Œæœ€å¤§æµçš„å¤§å°ä¾¿æ‰©å¤§ <span class="math inline">\(1\)</span>ã€‚</p><p>é‚£ä¹ˆï¼Œè¿™é‡Œçš„ã€Œè·¯å¾„ã€ç©¶ç«Ÿæœ‰ä»€ä¹ˆå«ä¹‰ï¼Ÿ</p><p>ä¸€æ¡ä» <span class="math inline">\(S\)</span> åˆ° <span class="math inline">\(T\)</span> çš„è¾¹ï¼Œè‹¥å…¶æµé‡ä¸º <span class="math inline">\(1\)</span>ï¼Œæˆ‘ä»¬å°†å®ƒè§†ä½œåŸå›¾ä¸­è¢«é€‰ä¸­ã€åŠ å…¥è·¯å¾„é›†åˆçš„è¾¹ï¼Œä½ ä¼šå‘ç°ï¼Œæ‰¾æœ€å¤§æµï¼ˆä¸æ–­å»¶é•¿è·¯å¾„ï¼‰çš„è¿‡ç¨‹å°±ç›¸å½“äºåœ¨åˆå¹¶è·¯å¾„ï¼Œè€Œä¸”æœ€åè¿™ä¸ªæ–°å›¾æ»¡è¶³ï¼šç‚¹å’Œè¾¹éƒ½ä¸ä¼šè¢«é‡å¤é€‰ä¸­ï¼Œä¸”å› ä¸ºæˆ‘ä»¬æ‰¾çš„æ˜¯æœ€å¤§æµï¼Œæ‰€æœ‰ç‚¹éƒ½ä¼šè¢«é€‰ä¸­ã€‚</p><p>å¥½å¥½å¥½ï¼Œæ­£ç¡®æ€§å°±å¾ˆæ˜¾è€Œæ˜“è§äº†ï¼Œæ¥è‡ªäºäºŒåˆ†å›¾å¢å¹¿è·¯æ‰¾æœ€å¤§åŒ¹é…çš„æ­£ç¡®æ€§ï¼ˆè¢«æ‰“ï¼‰ã€‚</p><p>é‚£ä¹ˆæ±‚å‡ºæœ€å¤§æµ <span class="math inline">\(f\)</span>ï¼Œå› ä¸ºæ¯åˆå¹¶ä¸€æ¬¡è·¯å¾„ï¼Œè·¯å¾„çš„æ¡æ•°å°±ä¼šå‡å°‘ <span class="math inline">\(1\)</span>ï¼Œæ‰€ä»¥æœ€åçš„ç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(N - f\)</span>ã€‚æ–¹æ¡ˆå‘¢ï¼Ÿ</p><p>å› ä¸ºç½‘ç»œæµç‰¹æ€§ï¼Œä½ ä¼šå‘ç°è·¯å¾„çš„èµ·ç‚¹ä¸€å®šæ˜¯ <span class="math inline">\(S\to x\)</span>ï¼ˆåºŸè¯ï¼‰ï¼Œæ‰€ä»¥æ‰¾å‡ºæ‰€æœ‰ <span class="math inline">\(S\to x\)</span> æµé‡ä¸º <span class="math inline">\(1\)</span> çš„ <span class="math inline">\(x\)</span>ï¼Œå®ƒä»¬å°±æ˜¯æ¯æ¡è·¯å¾„çš„èµ·ç‚¹ã€‚</p><p>å› ä¸ºè·¯å¾„æ²¡æœ‰äº¤å‰ä¸”è‚¯å®šè”é€šï¼Œæ‰€ä»¥ä½ æ²¿ç€è¿™ä¸ªèµ·ç‚¹ä¸€ç›´æ‰¾æµé‡ä¸º <span class="math inline">\(1\)</span> çš„è¾¹å°±èƒ½æ‰¾åˆ°å¤´ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 4e3 + 5;const int maxm = 6e5 + 5;struct _ &#123;    int v, w, n;    _() &#123;&#125;    _(int v1, int w1, int n1) &#123;        v = v1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];bool vis1[maxn];int n, m, x, y, res;int gs, gt, tot = 1;int a[maxn], h[maxn], f[maxn];int vis[maxn], now[maxn], dep[maxn];int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;bool BFS(int n) &#123;    std::fill(vis + 1, vis + n + 1, 0);    std::fill(dep + 1, dep + n + 1, 0);     std::queue&lt;int&gt; q;    dep[gs] = 1, vis[gs] = 1;    q.push(gs), now[gs] = h[gs];    while (!q.empty()) &#123;        int f = q.front(); q.pop();        for (int i = h[f]; i; i = u[i].n) &#123;            int v = u[i].v, w = u[i].w;            if (vis[v] == 1 || w == 0) continue;            vis[v] = 1, now[v] = h[v];            dep[v] = dep[f] + 1, q.push(v);            if (v == gt) return 1;        &#125;    &#125;    return 0;&#125;int findP(int x, int flow = inf) &#123;    if (x == gt) return flow;    int rest = flow, i;    for (i = now[x]; rest &amp;&amp; i; i = u[i].n) &#123;        int v = u[i].v, w = u[i].w;        now[x] = i;        if (dep[v] != dep[x] + 1 || w == 0) continue;        int t = findP(v, min(rest, w));        if (t == 0) dep[v] = 0;        rest -= t, u[i].w -= t, u[i ^ 1].w += t;    &#125;    return flow - rest;&#125;int Dinic(int n) &#123;    int res = 0;    while (BFS(n)) &#123;        int t = findP(gs);        while (t) res += t, t = findP(gs);    &#125;    return res;&#125;void add(int x, int y, int w) &#123;    u[++tot] = _(y, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int w) &#123;    add(x, y, w), add(y, x, 0);    return;&#125;void output(int x) &#123;    if (x == gs) return;    print(x, &#39; &#39;), vis1[x] = 1;    for (int i = h[x]; i; i = u[i].n) &#123;        int v = u[i].v;        if (v &lt;= n || v &gt; 2 * n || vis1[v - n])            continue;        if (u[i].w == 0) &#123;            output(u[i].v - n);            return;        &#125;    &#125;    return;&#125;int main() &#123;    read(n), read(m);    gs = 2 * n + 1, gt = gs + 1;    for (int i = 1; i &lt;= n; ++i) &#123;        addf(gs, i, 1);        addf(i + n, gt, 1);    &#125;    while (m--) &#123;        read(x), read(y);        addf(x, y + n, 1);    &#125;    res = n - Dinic(gt);    for (int i = h[gt]; i; i = u[i].n) &#123;        if (u[i ^ 1].w == 1) &#123;            output(u[i].v - n);            putchar(&#39;\n&#39;);        &#125;    &#125;    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="f.-æ•°å­—æ¢¯å½¢">F. æ•°å­—æ¢¯å½¢</h3><p><a href="http://222.180.160.110:61235/contest/3952/problem/6" class="uri">http://222.180.160.110:61235/contest/3952/problem/6</a></p><p>åœ¨ GM çš„å¼ºåˆ¶è¦æ±‚ä¸‹åªèƒ½è·³äº†ï¼Œå‘œå‘œå‘œ</p><hr /><h2 id="day-27th---14th">Day 2ï¼š7th - 14th</h2><h3 id="a.-å¤ªç©ºé£è¡Œè®¡åˆ’">A. å¤ªç©ºé£è¡Œè®¡åˆ’</h3><p><a href="http://222.180.160.110:61235/contest/3976/problem/1" class="uri">http://222.180.160.110:61235/contest/3976/problem/1</a></p><p>ä¸éš¾æƒ³åˆ°æŠŠå¤§æºç‚¹å’Œå®éªŒè¿å®¹é‡ä¸ºæŠ¥é…¬çš„è¾¹ï¼›æŠŠä»ªå™¨å’Œå¤§æ±‡ç‚¹è¿å®¹é‡ä¸ºæ¶ˆè´¹çš„è¾¹ï¼›å®éªŒå’Œä»ªå™¨ä¹‹é—´è¿å®¹é‡ä¸ºæ— ç©·å¤§çš„è¾¹ã€‚</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬è¦é€‰æ‹©ä¸€äº›å®éªŒä¸å»åšï¼Œé€‰æ‹©ä¸€äº›ä»ªå™¨ä¸è¦ï¼Œå¹¶ä¸”è¦æ±‚è¦å’Œä¸è¦çš„å®éªŒå’Œä»ªå™¨ä¹‹é—´ä¸èƒ½æœ‰è¾¹å…³è”ï¼Œè¿˜è¦æ±‚ç•™ä¸‹çš„åˆ©æ¶¦æœ€å¤§ã€‚</p><p>å‡å¦‚æˆ‘ä»¬æŠŠåˆ å»ä¸€æ¡ä»ªå™¨è¾¹è§†ä½œä¿ç•™ä»ªå™¨ï¼Œåˆ å»ä¸€æ¡å®éªŒè¾¹è§†ä½œè·³è¿‡å®éªŒï¼Œè¿™æ˜¯ä»€ä¹ˆï¼Ÿæœ€å°å‰²ï¼å› ä¸ºå¿…é¡»ä¿è¯æ²¡æœ‰å…³è”ï¼Œè¿™å’Œæœ€å°å‰²è¦æ±‚è¢«åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†æ˜¯ç¬¦åˆçš„ã€‚å› ä¸ºä¸­é—´çš„è¾¹å®¹é‡æ— ç©·å¤§ï¼Œæ•…ç»å¯¹ä¸ä¼šé€‰ä¸­é—´çš„è¾¹ã€‚åŒæ—¶ï¼Œå®ƒåˆ é™¤äº†æœ€ä¸èµšé’±çš„å®éªŒï¼Œä¿ç•™äº†æœ€ä¾¿å®œçš„ä»ªå™¨ã€‚</p><p>æ®è¯´è¿™ä¹Ÿæ˜¯ä¸ªç»å…¸æœ€å°å‰²æ¨¡å‹ï¼Œå»ºè®®æŒæ¡ã€‚</p><p>ç„¶åç­”æ¡ˆå‘¢ï¼Ÿå…ˆæš‚æ—¶å°†å™¨æè§†ä¸ºè´Ÿæƒå€¼ï¼Œåˆ™ï¼š</p><ol type="1"><li>æ€»æ”¶å…¥ ä¸º è¢«é€‰ä¸­çš„å®éªŒæƒå€¼ åŠ ä¸Š è¢«é€‰ä¸­çš„å™¨ææƒå€¼</li><li>è¢«é€‰ä¸­çš„å®éªŒæƒå€¼ ä¸º æ‰€æœ‰å®éªŒæƒå€¼å’Œ å‡å» æœªè¢«é€‰æ‹©çš„å®éªŒæƒå€¼å’Œ</li><li>æ€»æ”¶å…¥ ä¸º æ‰€æœ‰å®éªŒæƒå€¼å’Œ å‡å» æœªè¢«é€‰æ‹©çš„å®éªŒæƒå€¼å’Œ åŠ ä¸Š è¢«é€‰ä¸­çš„å™¨ææƒå€¼</li><li>æ€»æ”¶å…¥ ä¸º æ‰€æœ‰å®éªŒæƒå€¼å’Œ å‡å» æœªè¢«é€‰æ‹©çš„å®éªŒæƒå€¼å’Œ å‡å» è¢«é€‰ä¸­çš„å™¨ææƒå€¼çš„ç›¸åæ•°</li><li>æœ€å°å‰² ä¸º æœªè¢«é€‰æ‹©çš„å®éªŒæƒå€¼å’Œ åŠ ä¸Š è¢«é€‰ä¸­çš„å™¨ææƒå€¼çš„ç›¸åæ•°</li><li>æ€»æ”¶å…¥ ä¸º è¢«é€‰ä¸­çš„å®éªŒæƒå€¼ å‡å» æœ€å°å‰²</li></ol><p>é‚£ä¹ˆæ€ä¹ˆè¾“å‡ºæ–¹æ¡ˆå‘¢ï¼Ÿ</p><p><a href="https://www.luogu.com.cn/blog/35891/solution-p2762" class="uri">https://www.luogu.com.cn/blog/35891/solution-p2762</a></p><p>woc è¿™ç¯‡è®²å¾—å¤ªå¥½äº†ã€‚æœ€åä¸€æ¬¡ Dinic å¤±è´¥äº†ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸º BFS æ‰¾ä¸åˆ°æ±‡ç‚¹äº†ï¼Œè¯´æ˜è‹¥å¹²æ¡æ®‹é‡ä¸º 0 çš„è¾¹å·²ç»å µæ­»äº†ä»æºç‚¹åˆ°æ±‡ç‚¹çš„è·¯ã€‚è¿™ä¸ªæ—¶å€™è¿™äº›æ®‹é‡ä¸º 0 çš„è¾¹å…¶å®å°±æ˜¯æœ€å°å‰²ã€‚</p><p>é‚£é€‰å–çš„å®éªŒå’Œä»ªå™¨ï¼Œå°±æ˜¯ä»æºç‚¹å‡ºå‘å¯ä»¥åˆ°è¾¾çš„ï¼ˆå·²åœ¨ BFS ä¸­ä¸ºå…¶åˆ†å±‚ä½œä¸ºè®°å·ï¼‰ï¼Œæ‰€ä»¥åªéœ€ç»Ÿè®¡æœ‰å±‚æ•°çš„ç‚¹å³å¯ã€‚å¤ªå¦™äº†ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 4e3 + 5;const int maxm = 6e5 + 5;struct _ &#123;    int v, w, n;    _() &#123;&#125;    _(int v1, int w1, int n1) &#123;        v = v1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];bool vis1[maxn];int n, m, x, y, res;int gs, gt, tot = 1;int a[maxn], h[maxn], f[maxn];int vis[maxn], now[maxn], dep[maxn];int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int max(int x, int y) &#123; return x &gt; y ? x : y; &#125;bool BFS(int n) &#123;    std::fill(vis + 1, vis + n + 1, 0);    std::fill(dep + 1, dep + n + 1, 0);     std::queue&lt;int&gt; q;    dep[gs] = 1, vis[gs] = 1;    q.push(gs), now[gs] = h[gs];    while (!q.empty()) &#123;        int f = q.front(); q.pop();        for (int i = h[f]; i; i = u[i].n) &#123;            int v = u[i].v, w = u[i].w;            if (vis[v] == 1 || w == 0) continue;            vis[v] = 1, now[v] = h[v];            dep[v] = dep[f] + 1, q.push(v);            if (v == gt) return 1;        &#125;    &#125;    return 0;&#125;int findP(int x, int flow = inf) &#123;    if (x == gt) return flow;    int rest = flow, i;    for (i = now[x]; rest &amp;&amp; i; i = u[i].n) &#123;        int v = u[i].v, w = u[i].w;        now[x] = i;        if (dep[v] != dep[x] + 1 || w == 0) continue;        int t = findP(v, min(rest, w));        if (t == 0) dep[v] = 0;        rest -= t, u[i].w -= t, u[i ^ 1].w += t;    &#125;    return flow - rest;&#125;int Dinic(int n) &#123;    int res = 0;    while (BFS(n)) &#123;        int t = findP(gs);        while (t) res += t, t = findP(gs);    &#125;    return res;&#125;void add(int x, int y, int w) &#123;    u[++tot] = _(y, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int w) &#123;    add(x, y, w), add(y, x, 0);    return;&#125;int main() &#123;    scanf(&quot;%lld %lld&quot;, &amp;n, &amp;m);    gs = n + m + 1, gt = gs + 1;    for (int i = 1; i &lt;= n; ++i) &#123;        scanf(&quot;%lld&quot;, &amp;x);        addf(gs, i, x);        res += x;        std::string tmp;        std::getline(std::cin, tmp);        std::stringstream t(tmp);        while (t &gt;&gt; y)            addf(i, y + n, inf);    &#125;    for (int i = 1; i &lt;= m; ++i)        read(x), addf(n + i, gt, x);    res -= Dinic(gt);    for (int i = 1; i &lt;= n; ++i)        if (dep[i] != 0) print(i, &#39; &#39;);    putchar(&#39;\n&#39;);    for (int i = n + 1; i &lt;= n + m; ++i)        if (dep[i] != 0) print(i - n, &#39; &#39;);    putchar(&#39;\n&#39;), print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œæµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è´¹ç”¨æµç»ƒä¹ </title>
      <link href="/20230720/"/>
      <url>/20230720/</url>
      
        <content type="html"><![CDATA[<p><a href="http://222.180.160.110:61235/contest/3820">è´¹ç”¨æµå…¥é—¨ç»ƒä¹ </a>ã€‚</p><span id="more"></span><hr /><h3 id="a.-è®¢è´§">A. è®¢è´§</h3><p><a href="http://222.180.160.110:61235/contest/3820/problem/1" class="uri">http://222.180.160.110:61235/contest/3820/problem/1</a></p><p>è¿™ä¸ªå¸¦ç»§æ‰¿å…³ç³»çš„æ¨¡å‹å¾ˆç†Ÿæ‚‰ï¼Œæƒ³åˆ°äº† <a href="https://www.cnblogs.com/XSC062/p/17548925.html">çŒª</a> é‚£ä¸€é¢˜ã€‚æ‰€ä»¥æˆ‘ä»¬è¯•ç€ä»¿ç…§è¿™ä¸ªæ–¹å¼æ¥å»ºå›¾ã€‚</p><p>é¢˜ç›®æåˆ°äº†å•ä½è´¹ç”¨ï¼Œè¿™ç®€ç›´å°±æ˜¯ç›´æ¥æŠŠè¾¹çš„è´¹ç”¨æ‹ä½ è„¸ä¸Šå˜²è®½ã€‚</p><p>æˆ‘ä»¬æ‹‰ä¸€ä¸ªå¤§æºç‚¹ï¼Œæœæ¯ä¸ªæœˆè¿ä¸€æ¡å®¹é‡ä¸ºæ— ç©·å¤§ã€è´¹ç”¨ä¸ºå½“æœˆè´­ä¹°å•ä½è´¹ç”¨çš„è¾¹ï¼Œè¡¨ç¤ºæ¯ä¸ªæœˆçš„è´­ä¹°ã€‚</p><p>æ‹‰ä¸€ä¸ªå¤§æ±‡ç‚¹ï¼Œæ¯ä¸ªæœˆæœå®ƒè¿ä¸€æ¡å®¹é‡ä¸ºå½“æœˆéœ€æ±‚é‡ã€è´¹ç”¨ä¸º <span class="math inline">\(0\)</span> çš„è¾¹ï¼Œè¡¨ç¤ºæ¯ä¸ªæœˆçš„éœ€æ±‚ã€‚</p><p>å†è®©æ¯ä¸ªæœˆæœä¸‹ä¸€ä¸ªæœˆè¿ä¸€æ¡å®¹é‡ä¸ºä»“åº“å®¹é‡ã€è´¹ç”¨ä¸ºè´®å­˜è´¹ç”¨çš„è¾¹ï¼Œè¡¨ç¤ºç»§æ‰¿ã€‚è·‘ä¸€ä¸ªæœ€å°è´¹ç”¨æœ€å¤§æµå³å¯ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int maxn = 405;const int inf = 1e18;const int maxm = 5e5 + 5;struct _ &#123;    int v, c, w, n;    _() &#123;&#125;    _(int v1, int c1, int w1, int n1) &#123;        v = v1, c = c1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];bool inq[maxn];int n, m, S, x, res;int gs, gt, tot = 1;int h[maxn], dis[maxn];int fl[maxn], pre[maxn];int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool SPFA(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(dis + 1, dis + n + 1, inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0)                continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &gt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v])                    inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;void SSP(int s, int n) &#123;    int p, mn, d;    while (SPFA(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d;    &#125;    return;&#125;void add(int x, int y, int c, int w) &#123;    u[++tot] = _(y, c, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int c, int w) &#123;    add(x, y, c, w), add(y, x, 0, -w);    return;&#125;int main() &#123;    read(n), read(m), read(S);    gs = n + 1, gt = gs + 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(x);        addf(i, gt, x, 0);        if (i != n)            addf(i, i + 1, S, m);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        read(x);        addf(gs, i, inf, x);    &#125;        SSP(gs, gt);    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int  </code></pre></details><hr /><h3 id="b.-ç½‘ç»œæ‰©å®¹">B. ç½‘ç»œæ‰©å®¹</h3><p><a href="http://222.180.160.110:61235/contest/3820/problem/2" class="uri">http://222.180.160.110:61235/contest/3820/problem/2</a></p><p>é‰´äºä¸€é“è´¹ç”¨æµä¸ä¼šæ— ç¼˜æ— æ•…å…ˆè®©ä½ æ±‚ä¸€éæœ€å¤§æµï¼Œæˆ‘ä»¬å…ˆæŒè§‚æœ›æ€åº¦ï¼Œæš‚ä¸”è®¤ä¸ºæœ€å¤§æµå¯¹é¢˜ç›®æœ‰æç¤ºä½œç”¨ <del>è€Œä¸æ˜¯è¯´è¿™é“é¢˜å°±æ˜¯ä¸ªç¼åˆæ€ª</del></p><p>å…¶å®çœ‹å®Œé¢˜æˆ‘ä»¬å°±æ‚Ÿäº†ï¼Œè¿™æ€ä¹ˆè¿™ä¹ˆåƒä¸Šä¸‹ç•Œç½‘ç»œæµé‚£ä¸ªå·®é‡ç½‘ç»œå‘€ï¼Œè¦ä¸æˆ‘ä»¬è¯•è¯•è¿™ä¹ˆå¹²ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆæ±‚å¾—æ™®é€šç½‘ç»œä¸­çš„æœ€å¤§æµï¼Œç„¶åæ¯æ¡è¾¹å‡å»æµé‡ï¼Œå°±æˆä¸ºäº†ä¸€ä¸ªã€Œå·®é‡ç½‘ç»œ Proã€ã€‚é‚£ä¹ˆæˆ‘ä»¬ç°åœ¨å°±è¦é€šè¿‡æ‰©å®¹è®©è¯¥ç½‘ç»œä¸­çš„æœ€å¤§æµå˜ä¸º <span class="math inline">\(K\)</span>ã€‚å¯¹äºæ‰©å®¹çš„æ“ä½œï¼Œä¸éš¾æƒ³åˆ°æŠŠæ¯æ¡è¾¹çš„è¾¹æƒè®¾ä¸ºæ­£æ— ç©·ï¼Œç„¶åè´¹ç”¨è®¾ä¸ºæ‰©å®¹è´¹ç”¨ã€‚</p><p>ç°åœ¨æœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼šåŸå›¾ä¸­æœªç•™æ»¡çš„è¾¹ï¼Œåœ¨ç°åœ¨çš„æ–°ç½‘ç»œä¸­çš„æ®‹ä½™å®¹é‡åº”è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œæˆ‘ä»¬å°±æŠŠå®ƒå½“ä½œå·²ç»æ‰©è¿‡äº†è¿™ä¹ˆå¤šå®¹ï¼Œé€šè¿‡æ‹†è¾¹æ“ä½œæ‹†å‡ºæ¥ä¸€æ¡å®¹é‡ä¸ºåŸå›¾ä¸­æ®‹ä½™å®¹é‡ã€è´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ã€Œä¼šå‘˜é€šé“ã€ï¼Œé‚£ä¹ˆç®—æ³•å°±ä¼šä¼˜å…ˆé€‰æ‹©è¿™æ¡è¾¹ã€‚</p><p>æ€ä¹ˆå»æ§åˆ¶æµé‡ä¸º <span class="math inline">\(K\)</span>ï¼Ÿè”æƒ³åˆ°ä¹‹å‰çš„æ‹†è¾¹æ“ä½œï¼Œæˆ‘ä»¬è€ƒè™‘æ‹†ç‚¹ã€‚åœ¨ <span class="math inline">\(1\)</span> å’Œ <span class="math inline">\(N\)</span> ä¸­ä»»é€‰ä¸€ä¸ªæ‹†å¼€ä½œä¸ºæ–°çš„æºç‚¹ / æ±‡ç‚¹ï¼Œæ–°ç‚¹å’Œæ—§ç‚¹ä¹‹é—´çš„å®¹é‡ä¸º <span class="math inline">\(K\)</span>ã€è´¹ç”¨ä¸º <span class="math inline">\(0\)</span> å³å¯ã€‚</p><p>ç„¶åè·‘ä¸€ä¸ªæœ€å°è´¹ç”¨æœ€å¤§æµå°±è¡Œã€‚<del>è¯¥è¯´ä¸è¯´é¢˜ç›®çš„æ­£è§£æ€è·¯å¼•å¯¼åšå¾—è¿˜æŒºå¥½çš„</del></p><p>å…¶å®æ³¨æ„åˆ°åœ¨è·‘å®Œæœ€å¤§æµä¹‹åï¼Œæ‰€æœ‰æ­£å‘è¾¹çš„æ®‹ä½™å®¹é‡å·²ç»æ±‚å¾—ï¼Œåªè¦åœ¨è·‘æœ€å¤§æµæ—¶ä»¤æ‰€æœ‰è¾¹çš„è´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ï¼ˆæ¯•ç«Ÿæœ€å¤§æµä¸å…³å¿ƒè´¹ç”¨ï¼‰ï¼Œå°±å¯ä»¥æ²¿ç”¨åŸå›¾ï¼ŒåªåŠ æ–°è¾¹å†è·‘è´¹ç”¨æµã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 1e3 + 5;const int maxm = 5e5 + 5;struct _ &#123;    int v, c, w, n;    _() &#123;&#125;    _(int v1, int c1, int w1, int n1) &#123;        v = v1, c = c1, w = w1, n = n1;    &#125;&#125;;struct __ &#123; int x, y, c, w; &#125;;_ u[maxm];__ w[maxm];bool inq[maxn];int n, m, k, res;int gs, gt, tot = 1;int h[maxn], dis[maxn];int fl[maxn], pre[maxn];int vis[maxn], now[maxn], dep[maxn];int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool BFS(int n) &#123;    std::fill(vis + 1, vis + n + 1, 0);    std::fill(dep + 1, dep + n + 1, 0);     std::queue&lt;int&gt; q;    dep[gs] = 1, vis[gs] = 1;    q.push(gs), now[gs] = h[gs];    while (!q.empty()) &#123;        int f = q.front();        q.pop();        for (int i = h[f]; i; i = u[i].n) &#123;            int v = u[i].v, w = u[i].c;            if (vis[v] == 1 || w == 0)                continue;            vis[v] = 1, now[v] = h[v];            dep[v] = dep[f] + 1, q.push(v);            if (v == gt)                return 1;        &#125;    &#125;    return 0;&#125;int findP(int x, int flow = inf) &#123;    if (x == gt)        return flow;    int rest = flow, i;    for (i = now[x]; rest &amp;&amp; i; i = u[i].n) &#123;        int v = u[i].v, w = u[i].c;        now[x] = i;        if (dep[v] != dep[x] + 1 || w == 0)            continue;        int t = findP(v, min(rest, w));        if (t == 0)            dep[v] = 0;        rest -= t;        u[i].c -= t, u[i ^ 1].c += t;    &#125;    return flow - rest;&#125;int Dinic(int n) &#123;    int res = 0;    while (BFS(n)) &#123;        int t = findP(gs);        while (t) &#123;            res += t;            t = findP(gs);        &#125;    &#125;    return res;&#125;bool SPFA(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(dis + 1, dis + n + 1, inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0)                continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &gt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v])                    inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;void SSP(int s, int n) &#123;    int p, mn, d;    while (SPFA(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d;    &#125;    return;&#125;void add(int x, int y, int c, int w) &#123;    u[++tot] = _(y, c, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int c, int w = 0) &#123;    add(x, y, c, w), add(y, x, 0, -w);    return;&#125;int main() &#123;    read(n), read(m), read(k);    gs = 1, gt = n;    for (int i = 1; i &lt;= m; ++i) &#123;        read(w[i].x), read(w[i].y);        read(w[i].c), read(w[i].w);        addf(w[i].x, w[i].y, w[i].c);    &#125;    print(Dinic(n), &#39; &#39;);    gs = n + 1, addf(gs, 1, k, 0);    for (int i = 1; i &lt;= m; ++i)        addf(w[i].x, w[i].y, inf, w[i].w);    SSP(gs, gt);    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="c.-èˆªç­å®‰æ’">C. èˆªç­å®‰æ’</h3><p><a href="http://222.180.160.110:61235/contest/3820/problem/3" class="uri">http://222.180.160.110:61235/contest/3820/problem/3</a></p><p>å¾ˆç®€å•ä¸€ä¸ªé“ç†ï¼Œæ—¶é—´çš„å…·ä½“å€¼å¯¹æˆ‘ä»¬æ¥è¯´å¹¶ä¸é‡è¦ã€‚èƒ½åˆ°å°±æ˜¯èƒ½åˆ°ï¼Œä¸èƒ½åˆ°å°±æ˜¯ä¸èƒ½åˆ°ã€‚</p><p>è¾¹æƒçŸ©é˜µä¹Ÿå¹¶ä¸æ˜¯å…¨éƒ¨æœ‰ç”¨ï¼Œè¿™æ¡è¾¹å’Œä»»åŠ¡æœ‰å…³ç³»å—ï¼Ÿæ²¡æœ‰ï¼Œé‚£å°±å½“å®ƒæ˜¯ç©ºæ°”ã€‚</p><p>é‚£ä»€ä¹ˆä¼šå¯¹æˆ‘ä»¬äº§ç”Ÿé™åˆ¶ï¼Ÿé£æœºæ•°é‡ã€‚æ•…å®¹é‡ç”±é£æœºæ•°é‡å†³å®šã€‚ä»€ä¹ˆæ˜¯æˆ‘ä»¬è¦æœ€å¤§åŒ–çš„å€¼ï¼Ÿæ”¶ç›Šï¼Œæ•…æˆ‘ä»¬çš„è´¹ç”¨æ˜¯æ”¯å‡ºã€‚</p><p>å¦‚æœé£æœºèƒ½åœ¨ä¸€ä¸ªä»»åŠ¡ç»“æŸä¹‹åï¼Œåœ¨å¦ä¸€ä¸ªä»»åŠ¡å¼€å§‹ä¹‹å‰é£è¿‡å»ï¼Œé‚£å°±å°†ä¸¤ä¸ªä»»åŠ¡è¿è¾¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(1\)</span>ï¼Œè´¹ç”¨ä¸ºä¸¤ç‚¹é—´èŠ±è´¹ã€‚ç‰¹åˆ«åœ°ï¼Œåº”å°†æœºåœºæ‹†ä¸ºå¤§æºç‚¹å’Œå¤§æ±‡ç‚¹ï¼Œå¹¶åœ¨äºŒè€…ä¸­ä»»é€‰å…¶ä¸€æ‹†ç‚¹ï¼ˆå’Œ T2 ç±»ä¼¼ï¼‰ï¼Œå¥½ä½œå‡º <span class="math inline">\(K\)</span> çš„æµé‡é™åˆ¶ã€‚</p><p>è¿˜æœ‰ä¸€ä¸ªå°ç»†èŠ‚ï¼Œå¯¹äºä¸€ä¸ªä»»åŠ¡çš„æµé‡æˆ‘ä»¬ä¹Ÿè¦åŠ ä»¥çº¦æŸï¼Œä¸ç„¶ç¢°åˆ°æµå…¥ <span class="math inline">\(2\)</span> æµå‡º <span class="math inline">\(2\)</span> è¿™ç§å¹³è¡¡ä½†ä¸åˆæ³•çš„æƒ…å†µå°±ä¸è¡Œäº†ï¼Œæ‰€ä»¥å¯¹äºä»»åŠ¡æˆ‘ä»¬ä¹Ÿè¦æŒ‰è€å¥—è·¯æ‹†ç‚¹ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 405;const int maxm = 4e5 + 5;struct _ &#123;    int v, c, w, n;    _() &#123;&#125;    _(int v1, int c1, int w1, int n1) &#123;        v = v1, c = c1, w = w1, n = n1;    &#125;&#125;;struct __ &#123;    int x, y, l, r, c;    bool operator&lt; (const __ &amp;q) const &#123;        return l &lt; q.l;    &#125;&#125;;_ u[maxm];__ w[maxn];bool inq[maxn];int gs, gt, tot = 1;int h[maxn], dis[maxn];int fl[maxn], pre[maxn];int n, m, k, T, res, fs, ft;int t[maxn][maxn], f[maxn][maxn];int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool SPFA(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(dis + 1, dis + n + 1, inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0)                continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &gt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v])                    inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;void SSP(int s, int n) &#123;    int p, mn, d;    while (SPFA(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d;    &#125;    return;&#125;void add(int x, int y, int c, int w) &#123;    u[++tot] = _(y, c, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int c, int w) &#123;    add(x, y, c, w), add(y, x, 0, -w);    return;&#125;int main() &#123;    read(n), read(m), read(k), read(T);    fs = 2 * m + 1, ft = 2 * m + 2;    gs = 2 * m + 3, gt = 2 * m + 4;    addf(gs, fs, k, 0), addf(ft, gt, k, 0);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j)            read(t[i][j]);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j)            read(f[i][j]);    &#125;    for (int i = 1; i &lt;= m; ++i) &#123;        read(w[i].x), read(w[i].y);        read(w[i].l), read(w[i].r);        read(w[i].c), ++w[i].x, ++w[i].y;    &#125;    for (int i = 1; i &lt;= m; ++i) &#123;        addf(i + m, i, 1, 0);        if (t[1][w[i].x] &lt;= w[i].l) &#123;            addf(fs, i + m, 1,                f[1][w[i].x] - w[i].c);        &#125;        if (w[i].r + t[w[i].y][1] &lt;= T)            addf(i, ft, 1, f[w[i].y][1]);        for (int j = 1; j &lt;= m; ++j) &#123;            if (i != j &amp;&amp; w[i].r +                t[w[i].y][w[j].x] &lt;= w[j].l) &#123;                addf(i, j + m, 1,                    f[w[i].y][w[j].x] - w[j].c);            &#125;        &#125;    &#125;    SSP(gs, gt);    print(-res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="d.-ä¿®è½¦">D. ä¿®è½¦</h3><p><a href="http://222.180.160.110:61235/contest/3820/problem/4" class="uri">http://222.180.160.110:61235/contest/3820/problem/4</a></p><p>é¡¾å®¢æ•°ä¸€å®šï¼Œæ‰€è°“å¹³å‡ç­‰å¾…æ—¶é—´ä¸è¿‡æ˜¯ä¸ªå¹Œå­ï¼Œåªéœ€è¦æ±‚å¾—æœ€å°ç­‰å¾…æ€»æ—¶é—´ã€‚</p><p>æŠ€æœ¯äººå‘˜ä¸èƒ½åŒæ—¶ä¿®ä¸¤è¾†è½¦ï¼Œ<span class="math inline">\(M\)</span> çš„èŒƒå›´åˆè¿™ä¹ˆå°ï¼Œä¸å¾€æ‹†ç‚¹æƒ³éƒ½éš¾ã€‚å¯é—®é¢˜æ¥äº†ï¼Œæ€ä¹ˆæ‹†å‘¢ï¼Ÿ</p><p>æˆ‘ä¸€å¼€å§‹çš„æƒ³æ³•æ˜¯ï¼Œç”¨ç‚¹ <span class="math inline">\((i, j)\)</span> è¡¨ç¤ºäºº <span class="math inline">\(i\)</span> ä¿®è½¦ <span class="math inline">\(j\)</span>ï¼Œä½†æ˜¯è¿™æ ·å»ºå›¾æ€æ ·ä¹Ÿæ— æ³•è¾¾åˆ°ç›®çš„ã€‚</p><p>äºæ˜¯æˆ‘æ·»åŠ äº†ä¸€ä¸ªç»´åº¦ <span class="math inline">\(k\)</span>ï¼Œç”¨ç‚¹ <span class="math inline">\((i, j, k)\)</span> è¡¨ç¤ºäºº <span class="math inline">\(i\)</span> ä¿®è½¦ <span class="math inline">\(j\)</span>ï¼Œå¹¶ä¸”è¿™æ˜¯ä»–ä¿®çš„å€’æ•°ç¬¬ <span class="math inline">\(k\)</span> è¾†è½¦ï¼Œè¿™æ ·å»ºå›¾å°±è½»è€Œæ˜“ä¸¾äº†ã€‚ä½†æ¥ä¸‹æ¥å°±é¢ä¸´äº†ä¸€ä¸ªé—®é¢˜ï¼šè¿™æ•°æ®èŒƒå›´è·‘ä¸è¿‡ã€‚äºæ˜¯ä¹å®¡è§†æˆ‘ä»¬çš„ç‚¹ï¼Œå…¶å® <span class="math inline">\(j\)</span> è¿™ä¸ªç»´åº¦æ˜¯å¯ä»¥è¢«åˆå¹¶çš„ï¼Œåªä¿ç•™ <span class="math inline">\((i, k)\)</span>ï¼Œå› ä¸ºä¸å¯èƒ½å­˜åœ¨ä¸¤è¾†è½¦åŒæ—¶ä¸ºäºº <span class="math inline">\(i\)</span> çš„å€’æ•°ç¬¬ <span class="math inline">\(k\)</span> è¾†è½¦ã€‚</p><p>æ•…å°†å¤§æºç‚¹å’Œæ¯è¾†è½¦è¿è¾¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(1\)</span>ï¼Œè´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ï¼›å°†æ¯è¾†è½¦ <span class="math inline">\(j\)</span> å’Œæ¯ä¸ª <span class="math inline">\((i, k)\)</span> è¿è¾¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(1\)</span>ï¼Œè´¹ç”¨ä¸º <span class="math inline">\(T_{i, j}\times k\)</span>ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ç‚¹ç‚¹è´¹ç”¨æå‰è®¡ç®—çš„æ„æ€ï¼Œæ‰€ä»¥å°±ç›´æ¥å°†æ¯ä¸ª <span class="math inline">\((i, j)\)</span> å’Œå¤§æ±‡ç‚¹è¿è¾¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(1\)</span>ï¼Œè´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 1e4 + 5;const int maxm = 1e6 + 5;struct _ &#123;    int v, c, w, n;    _() &#123;&#125;    _(int v1, int c1, int w1, int n1) &#123;        v = v1, c = c1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];bool inq[maxn];int n, m, x, res;int gs, gt, tot = 1;int h[maxn], dis[maxn];int fl[maxn], pre[maxn];int fun(int i, int j) &#123;    return n + (i - 1) * n + j;&#125;int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool SPFA(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(dis + 1, dis + n + 1, inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0)                continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &gt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v])                    inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;void SSP(int s, int n) &#123;    int p, mn, d;    while (SPFA(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d;    &#125;    return;&#125;void add(int x, int y, int c, int w) &#123;    u[++tot] = _(y, c, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int c, int w) &#123;    add(x, y, c, w), add(y, x, 0, -w);    return;&#125;int main() &#123;    read(m), read(n);    gs = n * m + n + 1, gt = gs + 1;    for (int i = 1; i &lt;= n; ++i)        addf(gs, i, 1, 0);    for (int i = 1; i &lt;= n * m; ++i)        addf(i + n, gt, 1, 0);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j) &#123;            read(x);            for (int k = 1; k &lt;= n; ++k) &#123;                addf(i, fun(j, k),                            1, x * k);            &#125;        &#125;    &#125;    SSP(gs, gt);    printf(&quot;%.2lf&quot;, res * 1.0 / n);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><h3 id="e.-è¿è¿çœ‹">E. è¿è¿çœ‹</h3><p><a href="http://222.180.160.110:61235/contest/3820/problem/5" class="uri">http://222.180.160.110:61235/contest/3820/problem/5</a></p><p>æ ·ä¾‹å·²ç»å‘Šè¯‰äº†æˆ‘ä»¬äº‹å®ï¼šå°å¿ƒåˆ æ•°ï¼Œå› ä¸ºä¼šæœ‰æ•°åŒæ—¶å‡ºç°åœ¨å¤šç»„å‹¾è‚¡æ•°ä¸­ã€‚</p><p>è¿˜æ˜¯ç†Ÿæ‚‰çš„å•ç‚¹ <span class="math inline">\(1\)</span> æµé‡é™åˆ¶ï¼Œæ•…æ‹†ç‚¹ä¸ºå…¥ç‚¹å’Œå‡ºç‚¹ï¼Œå…¥ç‚¹è¿å¤§æºç‚¹å®¹é‡ä¸º <span class="math inline">\(1\)</span> è´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ï¼Œå‡ºç‚¹è¿å¤§æ±‡ç‚¹å®¹é‡ä¸º <span class="math inline">\(1\)</span> è´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ï¼Œæ»¡è¶³æ¡ä»¶çš„ <span class="math inline">\(x\)</span> å’Œ <span class="math inline">\(y\)</span> æˆ‘ä»¬ä¸ºäº†ä¸æ•´ç»†èŠ‚å°±æš´åŠ›åœ°è¿åŒå‘è¾¹ç„¶åè·‘æœ€å¤§è´¹ç”¨æœ€å¤§æµã€‚</p><p>ç”±äºåŒå‘è¾¹è¿™ä¸ªç¥å¿…æ“ä½œï¼Œæœ€åçš„æœ€å¤§æµå’Œæœ€å¤§è´¹ç”¨éƒ½ä¼šç¿»å€ï¼Œè¾“å‡ºçš„æ—¶å€™è¦å‡åŠã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int inf = 1e18;const int maxn = 2e3 + 5;const int maxm = 4e5 + 5;struct _ &#123;    int v, c, w, n;    _() &#123;&#125;    _(int v1, int c1, int w1, int n1) &#123;        v = v1, c = c1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];bool inq[maxn];int l, r, res, cnt;bool f[maxn][maxn];int gs, gt, tot = 1;int h[maxn], dis[maxn];int fl[maxn], pre[maxn];int gcd(int x, int y) &#123;    return y ? gcd(y, x % y) : x;&#125;int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool SPFA(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(dis + 1, dis + n + 1, -inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0)                continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &lt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v])                    inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;void SSP(int s, int n) &#123;    int p, mn, d;    while (SPFA(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d, cnt += mn;    &#125;    return;&#125;void add(int x, int y, int c, int w) &#123;    u[++tot] = _(y, c, w, h[x]);    h[x] = tot;    return;&#125;void addf(int x, int y, int c, int w) &#123;    if (f[x][y])        return;    f[x][y] = f[y][x] = 1;    add(x, y, c, w), add(y, x, 0, -w);    return;&#125;bool check(int x, int y) &#123;    int z = sqrt(x * x - y * y);    if (z * z + y * y == x * x)        return (gcd(z, y) == 1);    return 0;&#125;int main() &#123;    read(l), read(r);    gs = 2 * r + 1, gt = 2 * r + 2;    for (int i = l; i &lt;= r; ++i) &#123;        addf(gs, i, 1, 0);        addf(i + r, gt, 1, 0);        for (int j = l; j &lt; i; ++j) &#123;            if (check(i, j)) &#123;                addf(j, i + r, 1, i + j);                addf(i, j + r, 1, i + j);            &#125;        &#125;    &#125;    SSP(gs, gt);    print(cnt / 2, &#39; &#39;), print(res / 2, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details><hr /><p>ä¾æˆ‘çœ‹ï¼Œé˜Ÿåå°±å«ã€Œæ›¾æ€»è¯´çš„éƒ½é˜Ÿã€å§ ğŸµ</p>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œæµ </tag>
            
            <tag> è´¹ç”¨æµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å­¦ä¹ å°ç»„</title>
      <link href="/20230717/"/>
      <url>/20230717/</url>
      
        <content type="html"><![CDATA[<p>Solution to <a href="https://codeforces.com/problemset/problem/756/D">CF756D Bacterial Melee</a>ã€‚</p><span id="more"></span><hr /><p>ç»™æˆ‘æ•´ä¸ä¼šäº†ã€‚æ€ä¹ˆå¤„ç†å¹³æ–¹ï¼Ÿæ€ä¹ˆæ§åˆ¶å‚ä¸æ€»å­¦ç”Ÿæœ€å¤šï¼Ÿå…¶ä¸­ä¸€å®šåˆæœ‰ä»€ä¹ˆæˆ‘ä¸çŸ¥é“çš„å¥‡æŠ€æ·«å·§ã€‚</p><p>ä¸€åˆ‡å°½åœ¨è¿è¾¹ã€‚</p><ul><li><p>å¤„ç†å­¦ç”Ÿä¸ç¤¾å›¢é—´çš„é€‰æ‹©å…³ç³»</p><p>æŠŠå­¦ç”Ÿå‘ç¤¾å›¢è¿è¾¹ã€‚å­¦ç”Ÿåªèƒ½é€‰å–æŸç¤¾å›¢ä¸€æ¬¡ï¼Œæ•…å®¹é‡ä¸º <span class="math inline">\(1\)</span>ã€‚</p><p>ä¸€ä¸ªå­¦ç”Ÿé€‰å–æŸä¸ªç¤¾å›¢å¹¶ä¸ä¼šç«‹å³å¯¹æœ€ç»ˆèŠ±è´¹å¸¦æ¥å¯è®¡ç®—çš„å½±å“ï¼Œå› ä¸ºæœ€ç»ˆèŠ±è´¹ç”±è¯¥ç¤¾å›¢å‚ä¸çš„ <strong>æ‰€æœ‰å­¦ç”Ÿå¹³æ–¹æ•°</strong> å†³å®šã€‚</p>æ•…è¿™ä¸€æ­¥æˆ‘ä»¬å…ˆä¸æ…Œè®¡ç®—ç¤¾å›¢çš„ä»£ä»·ï¼Œåªç®—å‚ä¸ç¤¾å›¢æœ¬èº«éœ€è¦çš„æ‰‹ç»­è´¹ <span class="math inline">\(F_i\)</span>ã€‚ä½†æ˜¯éœ€è¦æ³¨æ„åˆ°æ‰‹ç»­è´¹æ˜¯è´¢åŠ¡éƒ¨çš„æ”¶å…¥è€Œéæ”¯å‡ºï¼Œæ•…å®é™…è¾¹æƒä¸º <span class="math inline">\(-F_i\)</span>ï¼Œè®¡ç®—ç­”æ¡ˆæ—¶è§†ä½œè´Ÿæ”¯å‡ºï¼ˆæ˜æ˜¾ä¸ä¼šå› æ­¤è€Œäº§ç”Ÿè´Ÿç¯ï¼Œå› æ­¤å¯ä»¥æ”¾å¿ƒåŠ è¾¹ï¼‰ã€‚</li><li><p>å¤„ç†å­¦ç”Ÿçš„é€‰æ‹©æ•°é‡ä¸Šé™</p><p>å­¦ç”Ÿæœ€å¤šåªèƒ½é€‰æ‹© <span class="math inline">\(K\)</span> ä¸ªç¤¾å›¢ï¼Œä¸ºä¿è¯è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å°†æºç‚¹å‘å­¦ç”Ÿè¿è¾¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(K\)</span>ã€‚</p>å¾ˆæ˜æ˜¾ï¼Œä»£ä»·ä¹Ÿä¸åœ¨æ­¤å¤„è®¡ç®—ï¼Œæ•…ä»¤è´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ã€‚</li><li><p>ä¿è¯ä»£ä»·æœ€å°</p><p>ä¸€å¼€å§‹ï¼Œæˆ‘è®¤ä¸ºæœ€å°è´¹ç”¨æœ€å¤§æµä¸€å®šä¼šæ‰¾åˆ°æœ€å°è´¹ç”¨ï¼Œè¿™ä¸ªå¤„ç†æ˜¯æ— æ„ä¹‰çš„ï¼Œåæ¥è¢«æ‰“è„¸äº†ã€‚</p><p>æˆ‘ä»¬è‹¥æ¬²åœ¨æ­¤å›¾ä¸­å¯»å¾—æœ€å°è´¹ç”¨æœ€å¤§æµï¼Œåˆ™ <strong>æµä¸€å®šæœ€å¤§</strong>ã€‚</p><p>è€Œå­¦ç”Ÿçš„æµå…¥å®¹é‡ä¸º <span class="math inline">\(K\)</span>ï¼Œä¸ºäº†æ»¡æµï¼Œå­¦ç”Ÿä¸€å®šä¼šå°½å¯èƒ½å¤šåœ°é€‰æ‹©ç¤¾å›¢ï¼Œé‚£ä¹ˆè´¹ç”¨å°±ä¼šå™Œå™Œä¸Šæ¶¨ã€‚å›åˆ°ç›®æ ‡ï¼Œå³ä¿è¯å­¦ç”Ÿéƒ½é€‰å–è‡³å°‘ä¸€ä¸ªç¤¾å›¢æ—¶ï¼Œæ”¯å‡ºæœ€å°ã€‚</p><p>é‚£æˆ‘ä»¬åªè¦ç»™æœºä¼šè®©å­¦ç”Ÿå¯ä»¥åªé€‰å–ä¸€ä¸ªç¤¾å›¢å°±å¥½äº†ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥æ˜¯ä¸¤ä¸ªã€ä¸‰ä¸ªâ€¦â€¦ï¼‰ã€‚</p><p>æ•…è®©å­¦ç”Ÿå‘ç»ˆç‚¹è¿è¾¹ï¼Œå®¹é‡ä¸º <span class="math inline">\(K-1\)</span>ï¼Œé‚£ä¹ˆå­¦ç”Ÿå¯ä»¥åœ¨é€‰å–äº†æ‰€æœ‰æ¯”è¾ƒèµšçš„ç¤¾å›¢åå°±ä¸å†é€‰äº†ï¼Œé€‰è¿™æ¡è¾¹è¾¾åˆ°æ»¡æµã€‚åŒæ ·å› ä¸ºè¯¥è¾¹æµé‡åªæœ‰ <span class="math inline">\(K-1\)</span>ï¼Œå­¦ç”Ÿä¸ºäº†æ»¡æµå°±åªèƒ½å†é€‰è‡³å°‘ä¸€ä¸ªç¤¾å›¢ï¼Œæ»¡è¶³é¢˜æ„ã€‚</p>ä¸é€‰ç¤¾å›¢æ˜æ˜¾æ˜¯æ²¡æœ‰æ‰‹ç»­è´¹å’Œç¤¾å›¢æ”¯å‡ºçš„ï¼Œæ•…è´¹ç”¨ä¸º <span class="math inline">\(0\)</span>ã€‚</li><li><p>å¤„ç†ç¤¾å›¢æœ¬èº«æ”¯å‡º</p><p>é—®é¢˜åœ¨äºå¦‚ä½•å¤„ç† <span class="math inline">\(a\)</span> è¿™ä¸ªå¹³æ–¹é¡¹ã€‚</p><p>å¯¹äºå¹³æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°è®¸å¤šæ•°å­¦çŸ¥è¯†ï¼Œè­¬å¦‚å®Œå…¨å¹³æ–¹ã€å¹³æ–¹å·®ç­‰ï¼Œè¿™é‡Œç”¨åˆ°äº†å¹³æ–¹å·®ã€‚</p><p>å‡å¦‚åŸæ¥çš„ä»£ä»·æ˜¯ <span class="math inline">\(C_i\times x^2\)</span>ï¼ŒåˆåŠ å…¥äº†ä¸€ä¸ªäººï¼Œé‚£ä¹ˆè´¹ç”¨ä¼šå˜æˆ <span class="math inline">\(C_i\times (x + 1)^2\)</span>ã€‚ç”±å¹³æ–¹å·®å¾—ä¸¤è€…ä¹‹å·®ä¸º <span class="math inline">\(C_i\times (2\times x + 1)\)</span>ã€‚å½“ <span class="math inline">\(x - 1\)</span> å–ä¸ºä»»æ„æ­£æ•´æ•°æ—¶ï¼Œ<span class="math inline">\(2\times x + 1\)</span> å³ä¸ºæ‰€æœ‰å¥‡æ•°ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬å°†ç¤¾å›¢å‘æ±‡ç‚¹è¿è¾¹ï¼Œè¿å¾ˆå¤šæ¡è¾¹ï¼Œæ¯æ¡è¾¹è¡¨ç¤º <strong>æ–°å¢ä¸€ä¸ªå›¢å‘˜çš„ä»£ä»·</strong>ï¼Œå®¹é‡ä¸º <span class="math inline">\(1\)</span> è¡¨ç¤ºä¸€ä¸ªæ–°å¢å›¢å‘˜ï¼Œè´¹ç”¨ä¸ºä» <span class="math inline">\(1\)</span> å¼€å§‹ï¼Œä¸€ç›´åˆ° <span class="math inline">\(2\times (N - 1) + 1\)</span> çš„æ‰€æœ‰å¥‡æ•°ã€‚</p></li></ul><p>é‚£ä¹ˆé—®é¢˜åˆ°è¿™é‡Œå°±ç®—å¤„ç†å®Œäº†ã€‚ç›´æ¥ä¸Šè´¹ç”¨æµå³å¯ã€‚</p><p>ä¸çŸ¥é“æˆ‘çš„ä»£ç é­é‡äº†å“ªå®¶å®‡å®™å°„çº¿çš„ä¾µèš€ï¼ŒDinic æ­»æ´»è¿‡ä¸å»ï¼Œæ¢æˆ EK å°±è¿‡äº†ã€‚åŒå­¦ä»¬å¦‚æœå‘ç°è‡ªå·±çš„ Dinic è¿‡ä¸äº†ä¹Ÿå¯ä»¥è¯•è¯•æ¢ EKã€‚</p><details><pre class="cpp"><code>#define int long longnamespace XSC062 &#123;using namespace fastIO;const int maxn = 405;const int inf = 1e18;const int maxm = 5e5 + 5;struct _ &#123;    int v, c, w, n;    _() &#123;&#125;    _(int v1, int c1, int w1, int n1) &#123;        v = v1, c = c1, w = w1, n = n1;    &#125;&#125;;_ u[maxm];bool inq[maxn];int n, m, k, x, res;int gs, gt, tot = 1;int c[maxn], f[maxn];int h[maxn], dis[maxn];int fl[maxn], pre[maxn];int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool SPFA(int s, int n) &#123;    std::queue&lt;int&gt; q;    std::fill(dis + 1, dis + n + 1, inf);    q.push(s), dis[s] = 0, inq[s] = 1;    pre[s] = inf, pre[gt] = 0, fl[s] = inf;    while (!q.empty()) &#123;        int f = q.front();        q.pop(), inq[f] = 0;        for (int i = h[f]; i; i = u[i].n) &#123;            if (u[i].c == 0)                continue;            int v = u[i].v, w = u[i].w;            if (dis[v] &gt; dis[f] + w) &#123;                pre[v] = i ^ 1;                dis[v] = dis[f] + w;                fl[v] = min(fl[f], u[i].c);                if (!inq[v])                    inq[v] = 1, q.push(v);            &#125;        &#125;    &#125;    return pre[gt];&#125;void SSP(int s, int n) &#123;    int p, mn, d;    while (SPFA(s, n)) &#123;        mn = fl[gt], d = 0;        for (p = gt; p != s; p = u[pre[p]].v) &#123;            u[pre[p]].c += mn;            u[pre[p] ^ 1].c -= mn;            d += u[pre[p] ^ 1].w;        &#125;        res += mn * d;    &#125;    return;&#125;void add(int x, int y, int c, int w) &#123;    u[++tot] = _(y, c, w, h[x]);    h[x] = tot;    return;&#125;void readx(int &amp;x) &#123;    char ch = nec();    while (ch != &#39;0&#39; &amp;&amp; ch != &#39;1&#39;)        ch = nec();    x = ch - &#39;0&#39;;    return;&#125;int main() &#123;    read(n), read(m), read(k);    gs = n + m + 1, gt = gs + 1;    for (int i = 1; i &lt;= m; ++i) &#123;        read(c[i]);        for (int j = 0; j &lt; n; ++j) &#123;            add(i + n, gt, 1,                    (2 * j + 1) * c[i]);            add(gt, i + n, 0,                    -(2 * j + 1) * c[i]);        &#125;    &#125;    for (int i = 1; i &lt;= m; ++i)        read(f[i]);    for (int i = 1; i &lt;= n; ++i) &#123;        add(gs, i, k, 0);        add(i, gs, 0, 0);        add(i, gt, k - 1, 0);        add(gt, i, 0, 0);        for (int j = 1; j &lt;= m; ++j) &#123;            readx(x);            if (x == 1) &#123;                add(i, j + n, 1, -f[j]); // è´Ÿä»£ä»·                add(j + n, i, 0, f[j]);            &#125;        &#125;    &#125;    SSP(gs, gt);    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> ç½‘ç»œæµ </tag>
            
            <tag> è´¹ç”¨æµ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£é¢˜æŠ¥å‘Š åŒ¹é…æ•°</title>
      <link href="/20230716-1/"/>
      <url>/20230716-1/</url>
      
        <content type="html"><![CDATA[<p>è€é¢˜è§£æ‰¹é‡è¡¥æ¡£ã€‚</p><span id="more"></span><hr /><p><a href="http://222.180.160.110:61235/contest/3887/problem/2" class="uri">http://222.180.160.110:61235/contest/3887/problem/2</a></p><blockquote><p>æ±‚å‡ºæœ€å°çš„ã€ä¸å«å‰å¯¼é›¶çš„ <span class="math inline">\(n\)</span> ä½æ•° <span class="math inline">\(x\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\(n-1\)</span> æ¡é™åˆ¶ï¼Œç¬¬ <span class="math inline">\(i\)</span> æ¡é™åˆ¶è§„å®š <span class="math inline">\(x\)</span> çš„ç¬¬ <span class="math inline">\(i\)</span> ä½å’Œ <span class="math inline">\(i + 1\)</span> ä½çš„å…³ç³»ï¼ˆå°äºã€å¤§äºã€ç­‰äºã€ä¸ç­‰äºï¼‰ã€‚</p></blockquote><p>å¦‚æœæ­£ç€ DPï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆç¡®å®šå‰é¢çš„æ•°ä½å†å‘å DPï¼Œåé¢çš„æ•°ä½å°±æ²¡åŠæ³•å†³å®šé€‰æ‹©å“ªä¸ªå·²æœ‰çŠ¶æ€è¿›è¡Œè½¬ç§»ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰åŠæ³•ä»…å‡­ä¸Šä¸€ä½å°±å¾—åˆ°å“ªä¸ªçŠ¶æ€æ‹¥æœ‰æœ€å°çš„å­—å…¸åºã€‚</p><p>ä½†æ˜¯é¢˜è§£å¾ˆé£è½»äº‘æ·¡åœ°ç»™å‡ºäº†ä¸€ä¸ªæˆ‘ä¸€è¾ˆå­æƒ³ä¸å‡ºæ¥çš„ fixï¼šå€’ç€ DPã€‚æˆ‘ä»¬åªè¦ä¿è¯æ¯æ¬¡é€‰å–æœ€å°çš„å¯è¡Œçš„ä¸‹ä¸€ä½å³å¯ï¼Œè¿™æ°å¥½ç¬¦åˆå­—å…¸åºçš„å®šä¹‰ã€‚</p><p>è®°å½•å‰é©±ï¼ˆor åç»§ï¼Ÿï¼‰åè¾“å‡ºå³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxm = 15;const int maxn = 2e3 + 5;int n;char s[maxn];int f[maxn][maxm];void output(int i, int j) &#123;    print(j);    if (i != n)        output(i + 1, f[i][j]);    return;&#125;int main() &#123;    scanf(&quot;%s&quot;, s + 1);    n = strlen(s + 1) + 1;    memset(f, -1, sizeof (f));    for (int i = 0; i &lt;= 9; ++i)        f[n][i] = 0x3f3f3f3f;    for (int i = n - 1; i; --i) &#123;        for (int j = 0; j &lt;= 9; ++j) &#123;            if (s[i] == &#39;&gt;&#39;) &#123;                for (int k = j - 1; k &gt;= 0; --k) &#123;                    if (~f[i + 1][k])                        f[i][j] = k;                &#125;            &#125;            else if (s[i] == &#39;&lt;&#39;) &#123;                for (int k = 9; k &gt; j; --k) &#123;                    if (~f[i + 1][k])                        f[i][j] = k;                &#125;            &#125;            else if (s[i] == &#39;=&#39;) &#123;                if (~f[i + 1][j])                    f[i][j] = j;            &#125;            else &#123;                for (int k = 9; ~k; --k) &#123;                    if (k == j)                        continue;                    if (~f[i + 1][k])                        f[i][j] = k;                &#125;            &#125;        &#125;    &#125;    for (int i = 1; i &lt;= 9; ++i)        if (~f[1][i]) &#123;            output(1, i);            break;        &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£é¢˜æŠ¥å‘Š æŸ“è‰²</title>
      <link href="/20230716/"/>
      <url>/20230716/</url>
      
        <content type="html"><![CDATA[<p>è€é¢˜è§£æ‰¹é‡è¡¥æ¡£ã€‚</p><span id="more"></span><hr /><p><a href="http://222.180.160.110:61235/contest/3887/problem/3" class="uri">http://222.180.160.110:61235/contest/3887/problem/3</a></p><blockquote><p>æœ‰ <span class="math inline">\(N\)</span> ä¸ªæ ¼å­æ’æˆä¸€æ’ï¼Œä½ éœ€è¦ç”¨è‡³å¤š <span class="math inline">\(M\)</span> ç§é¢œè‰²ç»™è¿™äº›æ ¼å­æŸ“è‰²ï¼Œæ¯ä¸ªæ ¼å­æ°å¥½æŸ“æˆæŸä¸€ç§é¢œè‰²ï¼Œä¸éœ€è¦æ¯ç§é¢œè‰²éƒ½ç”¨ä¸Šã€‚æ±‚æœ‰å¤šå°‘ç§æŸ“è‰²æ–¹æ¡ˆæ»¡è¶³ç›¸é‚»çš„åŒè‰²æ ¼å­ä¸è¶…è¿‡ <span class="math inline">\(K\)</span> å¯¹ã€‚</p></blockquote><p>ä¸å¦¨å°†ä¸€å¯¹ç›¸é‚»åŒè‰²æ ¼å­ç§°ä¸ºåŒè‰²å¯¹ï¼Œå°†ä¸€ä¸²è¿ç»­çš„ç›¸åŒé¢œè‰²ç§°ä½œä¸€æ®µï¼Œé‚£ä¹ˆæœ€æç«¯çš„æƒ…å†µä¸‹ä¼šæœ‰ <span class="math inline">\(N\)</span> æ®µï¼ˆå³ä¸å­˜åœ¨åŒè‰²å¯¹ï¼‰ã€‚</p><p>æ„é€ ä¸€æ®µé•¿åº¦ä¸º <span class="math inline">\(L\)</span> çš„ <span class="math inline">\(L\)</span> æ®µåºåˆ—ï¼ˆå³ä¸å­˜åœ¨åŒè‰²å¯¹ï¼‰ã€‚æ­¤æ—¶å°†ä»»æ„ä¸€æ®µé•¿åº¦å¢åŠ  1ï¼Œåˆ™å‡ºç°ä¸€å¯¹åŒè‰²å¯¹ã€‚æ¥ä¸‹æ¥ï¼Œä¸è®ºæ˜¯é€‰å–é•¿åº¦ä¸º 2 çš„é‚£ä¸€æ®µï¼Œè¿˜æ˜¯é€‰å–å‰©ä¸‹çš„é•¿åº¦ä¸º 1 çš„æ®µï¼Œå°†å…¶é•¿åº¦å¢åŠ  1ï¼Œéƒ½ä¼šä¸”ä»…ä¼šå¢åŠ  1 å¯¹åŒè‰²å¯¹ã€‚</p><p>ä»¥æ­¤ç±»æ¨ï¼Œè¿›è¡Œ <span class="math inline">\(K\)</span> æ¬¡ã€Œé€‰å–ä¸€æ®µå¹¶å°†å…¶é•¿åº¦å¢åŠ  1ã€çš„æ“ä½œï¼Œå¯å¾—åˆ°åˆšå¥½ <span class="math inline">\(K\)</span> ä¸ªåŒè‰²å¯¹ï¼Œæ­¤æ—¶åºåˆ—é•¿åº¦ä¸º <span class="math inline">\(L + K\)</span>ï¼Œè€Œ <strong>æ®µæ•°æ²¡æœ‰å˜åŒ–</strong>ï¼Œä»æ˜¯ä¸€å¼€å§‹çš„ <span class="math inline">\(L\)</span>ã€‚ æ‰€ä»¥åè¿‡æ¥ï¼Œå¦‚æœåœ¨é•¿åº¦ä¸º <span class="math inline">\(N\)</span> çš„åºåˆ—ä¸­å­˜åœ¨ <span class="math inline">\(K\)</span> ä¸ªåŒè‰²å¯¹ï¼Œé‚£ä¹ˆæ®µæ•°ä¸º <span class="math inline">\(N-K\)</span>ã€‚<del>å¾ˆéš¾æƒ³è±¡é¢˜è§£ç”¨ã€Œæ‰€ä»¥ã€ä¸¤ä¸ªå­—ç›´æ¥ç•¥è¿‡äº†ä¸Šè¿°æ¨å¯¼è¿‡ç¨‹</del></p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬åªè¦è€ƒè™‘åˆ†åˆ«å°†åºåˆ—ä»»æ„åˆ†ä¸ºéç©ºçš„ <span class="math inline">\(N-K\sim N\)</span> æ®µï¼Œå°±å¯ä»¥è§£å†³é—®é¢˜ï¼Œéš”æ¿æ³•å¯å¾—å°† <span class="math inline">\(N\)</span> åˆ†ä¸º <span class="math inline">\(T\)</span> æ®µçš„æ–¹æ¡ˆæ•°ä¸º <span class="math inline">\(C_{N-1}^{T-1}\)</span>ã€‚åœ¨æ­¤åŸºç¡€ä¸Šè€ƒè™‘æŸ“è‰²ï¼Œç”±ä¹˜æ³•åŸç†ï¼Œå°† <span class="math inline">\(T\)</span> æ®µæŸ“è‰²çš„æ–¹æ¡ˆä¸º <span class="math inline">\((m - 1)^{T - 1}\times M\)</span>ã€‚</p><p>å– <span class="math inline">\(T=N-K\sim N\)</span> å¹¶æ±‚å’Œé—®é¢˜å³è§£å†³ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 2e5 + 15;const int mod = 998244353;int fac[maxn];int n, m, k, res;inline int qkp(int x, int y) &#123;    int res = 1;    while (y) &#123;        if (y &amp; 1)            (res *= x) %= mod;        (x *= x) %= mod;        y &gt;&gt;= 1;    &#125;    return res;&#125;inline int inv(int x) &#123;    return qkp(x, mod - 2);&#125;inline int A(int n, int m) &#123;    return (fac[n] * inv(fac[n - m])) % mod;&#125;inline int C(int n, int m) &#123;    return (A(n, m) * inv(A(m, m))) % mod;&#125;int main() &#123;    read(n), read(m), read(k);    fac[0] = 1;    for (int i = 1; i &lt;= n + 5; ++i)        fac[i] = (fac[i - 1] * i) % mod;    for (int i = n - k; i &lt;= n; ++i) &#123;        (res += ((C(n - 1, i - 1) *                qkp(m - 1, i - 1)) % mod                * m) % mod) %= mod;    &#125;    print(res, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> æ’åˆ—ç»„åˆ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä¸­å›½å‰©ä½™å®šç†</title>
      <link href="/20230527/"/>
      <url>/20230527/</url>
      
        <content type="html"><![CDATA[<p>upd on 04/27/25ï¼šå‘ç°è¯¥æ–‡æ²¡å†™å®Œ <img src="/em/qd.gif" /></p><span id="more"></span><hr /><h2 id="ä¸­å›½å‰©ä½™å®šç†">ä¸­å›½å‰©ä½™å®šç†</h2><p>ç»™å®šä¸‹åˆ—å…³äº <span class="math inline">\(x\)</span> çš„ä¸€å…ƒåŒä½™æ–¹ç¨‹ç»„ï¼š</p><p><span class="math display">\[\begin {cases}x \equiv a_1 \pmod {m_1}  \\x \equiv a_2 \pmod {m_2}  \\\quad \quad \vdots \\x \equiv a_k \pmod {m_k}\end {cases}\]</span> å…¶ä¸­å¯¹äº <span class="math inline">\(\forall \, 1\le i, j\le k\, (i\ne j)\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\(m_i \, \bot\, m_j\)</span>ã€‚ä¸‹é¢æ˜¯æ±‚è§£è¯¥æ–¹ç¨‹ç»„çš„å…·ä½“æ–¹æ³•ï¼š</p><p>ä»¤ <span class="math inline">\(M = \prod \limits _{i = 1} ^ k m_i, \, M_i=\dfrac M {m_i}\)</span>ï¼Œåˆ™ <span class="math inline">\(x = \sum \limits _{i = 1} ^k a_i\times M_i\times M_i ^{-1} \pmod M\)</span>ã€‚</p><p>å…¶ä¸­ï¼Œ<span class="math inline">\(M_i^{-1}\)</span> æ˜¯ <span class="math inline">\(M_i\)</span> åœ¨æ¨¡ <span class="math inline">\(m_i\)</span> æ„ä¹‰ä¸‹çš„é€†å…ƒï¼ˆæ‰€ä»¥ <span class="math inline">\(M_i\times M_i^{-1}\)</span> çš„å€¼å¹¶ä¸æ˜¯è§†è§‰ä¸Šçš„ <span class="math inline">\(1\)</span>ï¼‰ã€‚</p><p>æ­£ç¡®æ€§è¯æ˜ï¼šå¯¹äº <span class="math inline">\(\forall \, i\in \{1, 2, \cdots, k\}\)</span>ï¼Œæœ‰ <span class="math inline">\(M_i\mid M\)</span>ï¼›å¯¹äº <span class="math inline">\(\forall \, j\in \{1, 2, \cdots, k\}\)</span> ä¸” <span class="math inline">\(j\ne i\)</span>ï¼Œæœ‰ <span class="math inline">\(m_i\mid \dfrac M{m_j}\)</span> å³ <span class="math inline">\(m_i\mid M_j\)</span>ï¼Œå³ <span class="math inline">\(M_j\equiv 0\pmod {m_i}\)</span>ã€‚</p><p>åˆ <span class="math inline">\(m_i\mid M\)</span> é‚£ä¹ˆå°±æœ‰ <span class="math inline">\(x\equiv a_i\cdot M_i\cdot {M_i}^{-1}\equiv a_i\pmod {n_i}\)</span>ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(\mathcal O(n\log n)\)</span>ã€‚æ³¨æ„æ±‚è§£é€†å…ƒæ—¶è¦ç”¨åˆ° exgcdã€‚</p><details><pre class="cpp"><code>int CRT(int k, int *a, int *m) &#123;    int M = 1, x = 0;    static int M1[maxn], Mi[maxn];     for (int i = 1; i &lt;= k; ++i)        M *= m[i];    for (int i = 1; i &lt;= k; ++i) &#123;        M1[i] = M / m[i];        Mi[i] = getinv(M1[i], m[i]);        (x += a[i] * M1[i] * Mi[i]) %= M;    &#125;    return x;&#125;</code></pre></details><hr /><h2 id="æ‰©å±•ä¸­å›½å‰©ä½™å®šç†">æ‰©å±•ä¸­å›½å‰©ä½™å®šç†</h2><p>è®¾æœ‰å¦‚ä¸‹åŒä½™æ–¹ç¨‹ç»„ï¼š</p><p><span class="math display">\[\begin {cases}x \equiv a_1 \pmod {m_1} \\x \equiv a_2 \pmod {m_2}\end {cases}\]</span></p><p>ä¸ä¿è¯ <span class="math inline">\(m_1 \, \bot \, m_2\)</span>ã€‚</p><p>è®¾ <span class="math inline">\(x = m_1 \times p_1 + a_1 = m_2 \times p_2 + a_2\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(p_i \in \mathbb Z\)</span>ï¼Œåˆ™æœ‰ <span class="math inline">\(p_1 \times m_1 - p_2 \times m_2 = a_2 - a_1\)</span>ã€‚</p><p><span class="math inline">\(p_1\)</span> çš„å€¼å¯ä»¥ç”¨ exgcd æ±‚è§£ï¼Œåˆ™åŸæ–¹ç¨‹çš„è§£æ»¡è¶³ <span class="math inline">\(x \equiv m_1\times p_1 + a_1 \pmod {M}\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(M=\operatorname{lcm}(m_1, m_2)\)</span>ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„åŒä½™æ–¹ç¨‹ã€‚å¯¹äº <span class="math inline">\(k&gt;2\)</span> çš„æƒ…å†µï¼Œæˆ‘ä»¬ä¸æ–­åˆå¹¶ä¸¤ä¸ªåŒä½™æ–¹ç¨‹å³å¯å¾—åˆ°æœ€ç»ˆåŒä½™æ–¹ç¨‹ã€‚</p><p>æ­¤æ—¶æ ¹æ®é¢˜ç›®è¦æ±‚ï¼ˆä¸€èˆ¬æ±‚æœ€å°å€¼å³ <span class="math inline">\(m_k\times p_k + a_k\)</span>ï¼‰æ±‚è§£ç­”æ¡ˆå³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(\mathcal O(n\log n)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(\log\)</span> æ¥è‡ª exgcdã€‚</p><details><pre class="cpp"><code>int calc(int m1, int a1, int m2, int a2) &#123;    int p1, p2;    if (a2 - a1 &lt; 0)        swap(a1, a2), swap(m1, m2);    int g = exgcd(m1, p1, m2, p2);    if ((a2 - a1) % g)        return -1;    p1 *= (a2 - a1) / g, m2 /= g;    p1 = (p1 % m2 + m2) % m2;    return p1 * m1 + a1;&#125;int exCRT(int k, int *a, int *m) &#123;    for (int i = 2; i &lt;= k; ++i) &#123;        a[i] = calc(m[i - 1],                a[i - 1], m[i], a[i]);        if (a[i] == -1)            return -1;        m[i] = lcm(m[i - 1], m[i]);    &#125;    return a[k] % m[k];&#125;</code></pre></details><hr /><h3 id="d.-strange-way-to-express-integers">D. Strange Way to Express Integers</h3><p><a href="http://222.180.160.110:1024/contest/3642/problem/4" class="uri">http://222.180.160.110:1024/contest/3642/problem/4</a></p><p>æ¿ã€‚ä½†æ˜¯è¦å¼€ <code>__int128</code>ã€‚ä¸çŸ¥é“ä¸ºä»€ä¹ˆæ™ºåŠ›åªç”¨å¼€ <code>long long</code> å°±èƒ½è·‘è¿‡ï¼Œæˆ‘å’Œæ­å“¥å°±ä¸è¡Œã€‚</p><details><pre class="cpp"><code>#define int __int128namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;int n;int a[maxn], m[maxn];int gcd(int x, int y) &#123;    return y ? gcd(y, x % y) : x;&#125;inline int lcm(int x, int y) &#123;    return x / gcd(x, y) * y;&#125;inline void swap(int &amp;x, int &amp;y) &#123;    x ^= y ^= x ^= y;    return;&#125;int exgcd(int a, int &amp;x, int b, int &amp;y) &#123;    if (b == 0) &#123;        x = 1, y = 0;        return a;    &#125;    int u = exgcd(b, x, a % b, y);    int t = x;    x = y, y = t - (a / b) * y;    return u;&#125;inline int calc(int m1, int a1,                    int m2, int a2) &#123;    int p1, p2;    if (a2 - a1 &lt; 0)        swap(a1, a2), swap(m1, m2);    int g = exgcd(m1, p1, m2, p2);    if ((a2 - a1) % g)        return -1;    p1 *= (a2 - a1) / g, m2 /= g;    p1 = (p1 % m2 + m2) % m2;    return p1 * m1 + a1;&#125;inline int exCRT(int k, int *a, int *m) &#123;    for (int i = 2; i &lt;= k; ++i) &#123;        a[i] = calc(m[i - 1],                a[i - 1], m[i], a[i]);        if (a[i] == -1)            return -1;        m[i] = lcm(m[i - 1], m[i]);    &#125;    return a[k] % m[k];&#125;int main() &#123;    while (read(n)) &#123;        for (int i = 1; i &lt;= n; ++i)            read(m[i]), read(a[i]);        print(exCRT(n, a, m), &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062#undef int</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> CRT / exCRT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äºŒåˆ†å›¾</title>
      <link href="/20230509/"/>
      <url>/20230509/</url>
      
        <content type="html"><![CDATA[<p>ä½ è¯´å¾—å¯¹ï¼Œæ‰€ä»¥æˆ‘æ‰“ç½‘ç»œæµã€‚</p><span id="more"></span><hr /><h2 id="äºŒåˆ†å›¾">äºŒåˆ†å›¾</h2><p><del>äºŒåˆ†å›¾æ€»ä½“æ¦‚å¿µä¸éš¾</del>ã€‚ä¸»è¦æ˜¯å…¶åº”ç”¨å¹¿æ³›ï¼Œéœ€è¦æ³¨æ„ä»€ä¹ˆæ ·çš„é¢˜ç›®å¯ä»¥è”ç³»åˆ°äºŒåˆ†å›¾ä¸Šæ¥ã€‚</p><h3 id="æ¦‚å¿µ">æ¦‚å¿µ</h3><p>è‹¥å›¾ <span class="math inline">\(G\)</span> å¯å°†ç‚¹é›† <span class="math inline">\(V\)</span> åˆ†æˆä¸¤ä¸ªäº’ä¸ç›¸äº¤çš„å­é›† <span class="math inline">\(X\)</span> å’Œ <span class="math inline">\(Y\)</span>ï¼Œä¸”æ¯æ¡è¾¹è¿æ¥çš„ä¸¤ä¸ªç‚¹éƒ½æ»¡è¶³ä¸€ä¸ªåœ¨ <span class="math inline">\(X\)</span> ä¸­ï¼Œä¸€ä¸ªåœ¨ <span class="math inline">\(Y\)</span> ä¸­ï¼Œåˆ™ç§° <span class="math inline">\(G\)</span> ä¸ºäºŒåˆ†å›¾ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸€ä¸ªå›¾æœ‰ä»»ä½•ä¸€ç§åˆ†ç»„æ–¹å¼æ»¡è¶³ï¼šæŠŠå›¾ä¸­çš„ç‚¹åˆ†æˆä¸¤ç»„ï¼Œæ¯ä¸€ç»„çš„ç‚¹ä¸¤ä¸¤ä¹‹é—´æ²¡æœ‰è¿è¾¹ï¼Œé‚£ä¹ˆè¿™ä¸ªå›¾å°±æ˜¯äºŒåˆ†å›¾ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼š</p><figure><img src="https://pic.imgdb.cn/item/62c8cd2cf54cd3f9371c4818.jpg" alt="æ¯ä¸€ç»„ä¸­çš„ç‚¹ä¸¤ä¸¤ä¹‹é—´æ²¡æœ‰è¿è¾¹ï¼Œæ‰€ä»¥è¯¥å›¾æ˜¯äºŒåˆ†å›¾ã€‚" /><figcaption>æ¯ä¸€ç»„ä¸­çš„ç‚¹ä¸¤ä¸¤ä¹‹é—´æ²¡æœ‰è¿è¾¹ï¼Œæ‰€ä»¥è¯¥å›¾æ˜¯äºŒåˆ†å›¾ã€‚</figcaption></figure><h3 id="æ€§è´¨">æ€§è´¨</h3><ul><li><p>äºŒåˆ†å›¾çš„æ¯æ¡è¾¹è¿æ¥çš„ç‚¹å±äºä¸åŒçš„é›†åˆã€‚</p><p>æ˜¾ç„¶ã€‚</p></li><li><p>äºŒåˆ†å›¾ä¸­å¯èƒ½å­˜åœ¨ç¯ï¼Œä¸”é•¿åº¦ä¸€å®šä¸ºå¶æ•°ã€‚</p><p>æˆ‘ä»¬æŒ‡å®šç¯ä¸­ä»»æ„ä¸€ä¸ªç‚¹ï¼Œä»è¯¥ç‚¹å‡ºå‘ï¼Œæ˜“å¾—ï¼Œç»è¿‡å¥‡æ•°æ¡è¾¹æ—¶åˆ°è¾¾å¦ä¸€ä¸ªé›†åˆï¼Œåä¹‹å›åˆ°è¯¥é›†åˆã€‚å› ä¸ºè·¯å¾„æ˜¯ä¸€ä¸ªç¯ï¼Œæ‰€ä»¥æˆ‘ä»¬æœ€åä¸€å®šä¼šå›åˆ°èµ·ç‚¹æ‰€åœ¨é›†åˆï¼Œå³ç»è¿‡å¶æ•°æ¡è¾¹ã€‚</p></li></ul><h3 id="åˆ¤å®š">åˆ¤å®š</h3><p>é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨å›¾çš„æ·±åº¦ä¼˜å…ˆéå†æ¯ä¸€ä¸ªç‚¹ <span class="math inline">\(u\)</span>ã€‚</p><p>æ˜¾ç„¶ï¼Œè‹¥å·²çŸ¥ç‚¹ <span class="math inline">\(u\)</span> åœ¨ <span class="math inline">\(X\)</span> é›†ï¼Œé‚£ä¹ˆæ‰€æœ‰ä¸ <span class="math inline">\(u\)</span> æœ‰è¿è¾¹çš„ç‚¹ <span class="math inline">\(v\)</span> ä¸€å®šåœ¨ <span class="math inline">\(Y\)</span> é›†ï¼ˆåä¹‹åŒç†ï¼‰ã€‚</p><p>å½“ç„¶ï¼Œå¾ˆå¤šå›¾æ˜¯æœ‰ç¯çš„ï¼Œä¸å…ä¼šäº§ç”Ÿ <span class="math inline">\(v\)</span> å·²ç»è¢«åˆ†ç»„çš„æƒ…å†µã€‚è‹¥æ­¤æ—¶ <span class="math inline">\(v\)</span> æ°å¥½åœ¨ <span class="math inline">\(Y\)</span> é›†ï¼Œçš†å¤§æ¬¢å–œï¼›è‹¥ <span class="math inline">\(v\)</span> ä¹Ÿåœ¨ <span class="math inline">\(X\)</span> é›†ï¼Œé‚£ä¹ˆè¯¥å›¾ä¸€å®šä¸ä¸ºäºŒåˆ†å›¾ã€‚</p><p>ç”±äºæ¯ä¸ªç‚¹æœ€å¤šæœç´¢ä¸€æ¬¡ï¼Œæ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n)\)</span>ã€‚</p><pre class="cpp"><code>int col[maxn];bool DFS(int x, int c) &#123;    col[x] = c;    for (auto i : g[x]) &#123;        if (col[i]) &#123;            if (col[i] == c)                return 0;        &#125;        else if (!DFS(i, 3 - c))            return 0;    &#125;    return 1;&#125;int main() &#123; DFS(1, 1); &#125;</code></pre><p>åšé¢œæ— è€»åœ°æ¨é”€ä¸€ä¸‹ <a href="https://www.luogu.com.cn/problem/U283873">é¢˜ç›®</a>ï¼ˆï¼ˆï¼ˆ</p><h3 id="åŒ¹é…">åŒ¹é…</h3><p>å®šä¹‰ï¼šå¯¹äºä¸€ä¸ªäºŒåˆ†å›¾ä¸­çš„è‹¥å¹²æ¡è¾¹ï¼Œè‹¥è¿™äº›è¾¹æ²¡æœ‰ä»»ä½•å…¬å…±ç‚¹ï¼Œåˆ™ç§°è¿™äº›è¾¹ç»„æˆçš„é›†åˆ <span class="math inline">\(M\)</span> æ˜¯æ•°é‡ä¸º <span class="math inline">\(|M|\)</span> çš„ <strong>åŒ¹é…</strong>ã€‚</p><figure><img src="https://pic.imgdb.cn/item/62c8cd75f54cd3f9371c866f.jpg" alt="å›¾ä¸­çº¢è‰²è¾¹å±•ç¤ºäº†ä¸€ä¸ªæ•°é‡ä¸º 4 çš„åŒ¹é…" /><figcaption>å›¾ä¸­çº¢è‰²è¾¹å±•ç¤ºäº†ä¸€ä¸ªæ•°é‡ä¸º 4 çš„åŒ¹é…</figcaption></figure><p>å®¹æ˜“çœ‹å‡ºï¼Œå¯¹äºç‚¹ <span class="math inline">\(u\)</span>ï¼Œåªä¼šå­˜åœ¨ ã€Œæœ‰ä¸€æ¡ <span class="math inline">\(M\)</span> é›†åˆå†…çš„è¾¹ä¸ <span class="math inline">\(u\)</span> ç›¸è¿æ¥ã€ å’Œ ã€Œ<span class="math inline">\(u\)</span> è¿æ¥çš„è¾¹å‡ä¸åœ¨ <span class="math inline">\(M\)</span> é›†åˆå†…ã€ ä¸¤ç§æƒ…å†µã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä» <span class="math inline">\(u\)</span> å‡ºå‘çš„ <span class="math inline">\(M\)</span> é›†åˆå†…çš„è¾¹ï¼Œæœ€å¤šæœ‰ <span class="math inline">\(1\)</span> æ¡ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç§° ã€Œæœ‰ä»»ä½•ä¸€æ¡ä¸ä¹‹ç›¸è¿çš„è¾¹åœ¨åŒ¹é…é›†åˆå†…ã€ çš„ç‚¹ä¸ºåŒ¹é…ç‚¹ï¼Œã€Œåœ¨åŒ¹é…é›†åˆå†…çš„è¾¹ã€ ä¸ºåŒ¹é…è¾¹ã€‚</p><h3 id="å®Œå¤‡åŒ¹é…">å®Œå¤‡åŒ¹é…</h3><p>å¦‚æœ <span class="math inline">\(|M|=\dfrac n2\)</span>ï¼Œå³ <span class="math inline">\(M\)</span> æ°å¥½è¿æ¥äº† <span class="math inline">\(1\sim n\)</span> æ‰€æœ‰ç‚¹ï¼Œæˆ‘ä»¬å°±ç§°åŒ¹é… <span class="math inline">\(M\)</span> ä¸º <strong>å®Œå¤‡åŒ¹é…</strong>ã€‚</p><figure><img src="https://pic.imgdb.cn/item/62c902d9f54cd3f93755faf9.jpg" alt="ä¸€ä¸ªå®Œå¤‡åŒ¹é…çš„ä¾‹å­" /><figcaption>ä¸€ä¸ªå®Œå¤‡åŒ¹é…çš„ä¾‹å­</figcaption></figure><p>æ¯”æ–¹è¯´ï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“ä¸€äº›ç”·å­©å’Œå¥³å­©ï¼Œä»–ä»¬ä¹‹é—´æœ‰è‹¥å¹²æ¡äº’ç›¸å–œæ¬¢çš„å…³ç³»ï¼Œæˆ‘ä»¬æŠŠæ­¤å…³ç³»æŠ½è±¡æˆä¸€ä¸ªäºŒåˆ†å›¾ï¼Œå¦‚æœæ¯ä¸ªäººéƒ½èƒ½ä¸è‡ªå·±å–œæ¬¢çš„å¼‚æ€§é…å¯¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªå…³ç³»ç½‘å­˜åœ¨å®Œå¤‡åŒ¹é…ã€‚</p><p>æ˜¾ç„¶ï¼Œå®Œå¤‡åŒ¹é…å­˜åœ¨ï¼Œä»…å½“ä¸¤é›†åˆå¤§å°ç›¸ç­‰ã€‚</p><hr /><h2 id="åŒˆç‰™åˆ©ç®—æ³•">åŒˆç‰™åˆ©ç®—æ³•</h2><p>åŒˆç‰™åˆ©ç®—æ³•ä¸€èˆ¬ç”¨äºæ±‚è§£ <span class="math inline">\(\max\{|M|\}\)</span>ã€‚</p><p>æˆ‘ä»¬å°†å›¾ä¸Šæ»¡è¶³ä¸‹åˆ—æ¡ä»¶çš„è·¯å¾„ <span class="math inline">\(P\)</span> ç§°ä¸º<strong>å¢å¹¿è·¯</strong>ï¼š</p><ul><li><span class="math inline">\(P\)</span> çš„èµ·ç‚¹å’Œç»ˆç‚¹å‡æ˜¯éåŒ¹é…ç‚¹</li><li><span class="math inline">\(P\)</span> çš„èµ·ç‚¹å’Œç»ˆç‚¹ä¸åœ¨äºŒåˆ†å›¾çš„åŒä¸€ç»„å†…</li><li>è·¯å¾„ <span class="math inline">\(P\)</span> ç»è¿‡çš„è¾¹æŒ‰ <strong>é</strong> åŒ¹é…è¾¹ï¼ŒåŒ¹é…è¾¹ï¼Œ<span class="math inline">\(\cdots\)</span>ï¼Œ<strong>é</strong> åŒ¹é…è¾¹çš„è§„å¾‹äº¤æ›¿ã€‚</li></ul><p>æœ€ç»ˆï¼Œ<span class="math inline">\(P\)</span> ä¼šå‘ˆç±» ã€Œ<span class="math inline">\(\text Z\)</span>ã€ å½¢ï¼ˆå€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¢å¹¿è·¯ä¸èƒ½ç»è¿‡ä¸€æ•´ä¸ªç¯ï¼Œå¦åˆ™å…¶é•¿åº¦å°†ä¼šå› ä¸ºäºŒåˆ†å›¾ä¸­åªå­˜åœ¨å¶ç¯è€Œå˜ä¸ºæ— ç©·å¤§ï¼‰ã€‚</p><p>æ˜¾ç„¶ï¼ŒéåŒ¹é…è¾¹æ¯”åŒ¹é…è¾¹çš„æ•°é‡å§‹ç»ˆå¤š <span class="math inline">\(1\)</span>ã€‚</p><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯¹ <span class="math inline">\(P\)</span> ä¸ŠåŒ¹é…çš„çŠ¶æ€å–åã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸæ¥çš„éåŒ¹é…è¾¹å˜æˆåŒ¹é…è¾¹ï¼ŒåŒ¹é…è¾¹å˜æˆéåŒ¹é…è¾¹ã€‚è¿™æ ·åšç›¸å½“äºæ˜¯åœ¨åŒ¹é…è¾¹é›†ä»ç„¶åˆæ³•çš„æƒ…å†µä¸‹å°†åŒ¹é…è¾¹é›†çš„å¤§å°æ‰©å¤§äº† <span class="math inline">\(1\)</span>ã€‚</p><p>é‚£ä¹ˆå¢å¹¿è·¯ç»è¿‡çš„è¾¹æŒ‰éåŒ¹é…è¾¹ï¼ŒåŒ¹é…è¾¹ï¼Œ<span class="math inline">\(\cdots\)</span>ï¼ŒéåŒ¹é…è¾¹é¡ºåºäº¤æ›¿çš„åŸå› å°±å¾ˆæ˜¾è€Œæ˜“è§äº†ã€‚å–åå‰ï¼ŒåŒ¹é…è¾¹ä¸å¯èƒ½è¿ç»­å‡ºç°ï¼›å–ååï¼ŒåŒ¹é…è¾¹ï¼ˆå³å–åå‰çš„éåŒ¹é…è¾¹ï¼‰ä¹Ÿä¸å¯èƒ½è¿ç»­å‡ºç°ã€‚</p><p>è€ŒåŒˆç‰™åˆ©ç®—æ³•çš„ä¸»è¦æ€è·¯ï¼Œå°±æ˜¯åå¤å¯»æ‰¾å¢å¹¿è·¯ï¼Œç›´åˆ°æ— æ³•æ‰¾åˆ°ä¸ºæ­¢ã€‚</p><p>è¿™é‡Œå°±å¿…é¡»å†æåˆ°ä¸€ä¸ªæ€§è´¨ï¼š<span class="math inline">\(M\)</span> ä¸ºå›¾ <span class="math inline">\(G\)</span> çš„æœ€å¤§åŒ¹é…ï¼Œå½“ä¸”ä»…å½“æ— æ³•åœ¨ <span class="math inline">\(M\)</span> çš„åŸºç¡€ä¸Šæ‰¾åˆ°å¢å¹¿è·¯ã€‚</p><p>è¯æ˜å¦‚ä¸‹ï¼š</p><ul><li><p>æœ‰å¼•ç†ï¼šå¯¹äºå›¾ <span class="math inline">\(G\)</span> çš„ä»»æ„ä¸¤ä¸ªåŒ¹é… <span class="math inline">\(M\)</span> å’Œ <span class="math inline">\(M&#39;\)</span>ï¼Œå®ƒä»¬çš„ <a href="https://baike.baidu.com/item/%E5%AF%B9%E7%A7%B0%E5%B7%AE">å¯¹ç§°å·®</a> <span class="math inline">\(M\Delta M&#39;\)</span> ä¸­çš„æ¯ä¸€ä¸ªè¿é€šå—éƒ½æ˜¯ä¸€æ¡é“¾æˆ–ä¸€ä¸ªåŒ…å«è¾¹æ•°ä¸ºå¶æ•°çš„ç¯ã€‚</p><p>è¯æ˜ï¼š</p><p>æ ¹æ®å¯¹ç§°å·®çš„å®šä¹‰ï¼Œå¯¹äºä»»æ„è¾¹ <span class="math inline">\(e\in M\Delta M&#39;\)</span>ï¼Œ<span class="math inline">\(e\)</span> è¦ä¹ˆæ˜¯ <span class="math inline">\(M\)</span> ä¸­çš„ä¸€æ¡åŒ¹é…è¾¹ï¼Œè¦ä¹ˆæ˜¯ <span class="math inline">\(M&#39;\)</span> ä¸­çš„ä¸€æ¡åŒ¹é…è¾¹ï¼Œä½†ä¸åŒæ—¶è¢« <span class="math inline">\(M\)</span> å’Œ <span class="math inline">\(M&#39;\)</span> åŒ…å«ã€‚</p><p>å› ä¸ºåœ¨åŒä¸€ä¸ªåŒ¹é…ä¸­ï¼Œä»»æ„ä¸¤æ¡åŒ¹é…è¾¹ä¸å­˜åœ¨å…¬å…±é¡¶ç‚¹ï¼Œæ‰€ä»¥å¯¹äºä»»æ„ä¸ <span class="math inline">\(e\)</span> æœ‰å…¬å…±é¡¶ç‚¹çš„åŒ¹é…è¾¹ <span class="math inline">\(e&#39;\)</span>ï¼Œ<span class="math inline">\(e\)</span> å’Œ <span class="math inline">\(e&#39;\)</span> å¿…ç„¶æ¥è‡ªä¸¤ä¸ªä¸åŒçš„åŒ¹é…ã€‚</p><p>ç”±æ­¤å¯å¾—ï¼Œå¯¹äºä»»æ„åŒ¹é…ç‚¹ <span class="math inline">\(u\)</span>ï¼Œ<span class="math inline">\(u\)</span> çš„åº¦æ•°ä¸º <span class="math inline">\(1\)</span> æˆ– <span class="math inline">\(2\)</span>ã€‚</p><p>æ‰€ä»¥ï¼Œå¯¹ç§°å·®ä¸­çš„æ¯ä¸€ä¸ªè¿é€šå—éƒ½æ˜¯é“¾æˆ–ç¯ã€‚</p><p>å¯¹äºå…¶ä¸­çš„ç¯ï¼Œæ‰€æœ‰ç›¸é‚»çš„è¾¹å¿…å®šæ¥è‡ªä¸åŒçš„åŒ¹é…ï¼Œæ‰€ä»¥ç¯åŒ…å«çš„è¾¹æ•°ä¸ºå¶æ•°ã€‚</p></li><li><p>å¿…è¦æ€§ï¼šå½“ <span class="math inline">\(M\)</span> ä¸ºæœ€å¤§åŒ¹é…æ—¶ï¼Œæ— æ³•æ‰¾åˆ° <span class="math inline">\(M\)</span> çš„å¢å¹¿è·¯ã€‚</p><p>æˆ‘ä»¬å·²ç»çŸ¥é“äº†ï¼Œæ‰¾åˆ°æŸåŒ¹é…çš„å¢å¹¿è·¯ <span class="math inline">\(P\)</span> å¹¶å°†å…¶åŒ¹é…çŠ¶æ€å–åï¼Œå¯ä»¥ä½¿åŒ¹é…å¤§å°åŠ ä¸€ã€‚</p><p>å¦‚æœ <span class="math inline">\(M\)</span> å­˜åœ¨å¢å¹¿è·¯ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å°†å…¶å–åï¼Œå¾—åˆ°ä¸€ä¸ªæ¯” <span class="math inline">\(M\)</span> å¤§å°æ›´å¤§çš„åŒ¹é…ã€‚ä¸ <span class="math inline">\(M\)</span> æ˜¯æœ€å¤§åŒ¹é…çŸ›ç›¾ã€‚</p><p>æ‰€ä»¥ä¸€å®šä¸å­˜åœ¨ <span class="math inline">\(M\)</span> çš„å¢å¹¿è·¯ã€‚</p></li><li><p>å……åˆ†æ€§ï¼šå¦‚æœä¸å­˜åœ¨ <span class="math inline">\(M\)</span> çš„å¢å¹¿è·¯ï¼Œ<span class="math inline">\(M\)</span> ä¸º <span class="math inline">\(G\)</span> çš„æœ€å¤§åŒ¹é…ã€‚</p><p>è®¾ <span class="math inline">\(M&#39;\)</span> æ˜¯ä¸€ä¸ªæ¯” <span class="math inline">\(M\)</span> æ›´å¤§çš„åŒ¹é…ã€‚</p><p>ç”±å¼•ç†å¾—ï¼š</p><p>åœ¨å®ƒä»¬çš„å¯¹ç§°å·® <span class="math inline">\(M\Delta M&#39;\)</span> ä¸­ï¼Œè¿é€šå—ä¸ºé“¾æˆ–ç¯ã€‚</p><p>å…¶ä¸­ï¼Œç¯åŒ…å«è¾¹çš„æ•°é‡ä¸ºå¶æ•°ï¼Œæ‰€ä»¥å¿…ç„¶æœ‰åŒæ ·å¤šçš„è¾¹æ¥è‡ª <span class="math inline">\(M\)</span> å’Œ <span class="math inline">\(M&#39;\)</span>ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¿½è§†è¿™äº›ç¯ã€‚</p><p>ç”±äº <span class="math inline">\(|M|&lt;|M&#39;|\)</span>ï¼Œå­˜åœ¨è‡³å°‘ä¸€æ¡é“¾ <span class="math inline">\(L\)</span>ï¼Œä¸” <span class="math inline">\(|L|=k-1\)</span>ï¼ŒåŒ…å« <span class="math inline">\(k\)</span> æ¡ <span class="math inline">\(M\)</span> ä¸­çš„è¾¹ï¼Œ<span class="math inline">\(k+1\)</span> æ¡æ¥è‡ªäº <span class="math inline">\(M&#39;\)</span> çš„è¾¹ã€‚</p><p>æ˜¾ç„¶ï¼Œ<span class="math inline">\(L\)</span> å°±æ˜¯ä¸€æ¡ <span class="math inline">\(M\)</span> çš„å¢å¹¿è·¯ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…ç„¶å¯ä»¥æ‰¾åˆ°ä¸€æ¡ <span class="math inline">\(M\)</span> çš„å¢å¹¿è·¯ï¼Œå‘½é¢˜æˆç«‹ã€‚</p></li></ul><p>å¯¹äº ã€Œå¯»æ‰¾å¢å¹¿è·¯ã€ è¿™ä¸ªè¿‡ç¨‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ DFS ç®—æ³•å®ç°ã€‚</p><p>å¯¹äºç‚¹ <span class="math inline">\(x\)</span>ï¼Œè‹¥ä¸ <span class="math inline">\(x\)</span> æœ‰è¿è¾¹çš„ç‚¹ <span class="math inline">\(y\)</span> å¯åŒ¹é…ä¸Š <span class="math inline">\(x\)</span>ï¼Œéœ€è¦æ»¡è¶³ä¸‹åˆ—ä¸¤ä¸ªæ¡ä»¶ä¹‹ä¸€ï¼š</p><ul><li><span class="math inline">\(y\)</span> æ˜¯éåŒ¹é…ç‚¹ï¼Œæ­¤æ—¶ <span class="math inline">\(x\to y\)</span> æ„æˆä¸€æ¡å¢å¹¿è·¯ï¼ŒéåŒ¹é…è¾¹çš„æ•°é‡å·²ç»æ¯”åŒ¹é…è¾¹æ•°é‡å¤š <span class="math inline">\(1\)</span>ã€‚</li><li><span class="math inline">\((u,y)\)</span> æ˜¯å·²åŒ¹é…è¾¹ï¼Œä¸” <span class="math inline">\((u,v)\)</span> æ˜¯æœªåŒ¹é…ä½†åˆæ³•çš„è¾¹ï¼Œæ­¤æ—¶ <span class="math inline">\(x\to y\to u\to v\)</span> æ„æˆä¸€æ¡å¢å¹¿è·¯ã€‚</li></ul><p>åœ¨å®ç°ä¸­ï¼Œæˆ‘ä»¬ä¾æ¬¡ä»¤ <span class="math inline">\(1\sim n\)</span> å†… <strong>æ‰€æœ‰çš„éåŒ¹é…ç‚¹</strong> ä½œä¸ºèµ·å§‹ç‚¹ <span class="math inline">\(x\)</span> å°è¯•æ‰¾åˆ°ä»»ä½•ä¸€æ¡å¢å¹¿è·¯ã€‚å½“ç¢°åˆ°ä»»æ„éåŒ¹é…ç‚¹æ—¶ç»“æŸï¼ˆå¢å¹¿è·¯åˆ¤å®šï¼šèµ·ç‚¹ä¸ç»ˆç‚¹å‡ä¸ºéåŒ¹é…ç‚¹ï¼‰ï¼Œå¦åˆ™å‘ <strong>è¯¥åŒ¹é…ç‚¹åŒ¹é…çš„ç‚¹</strong> ç»§ç»­æœç´¢ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€å±‚ DFS ä¼šå¯»æ‰¾ä¸€æ¡éåŒ¹é…è¾¹å¹¶ä½œä¸ºèµ·ç‚¹ï¼Œäº§ç”Ÿä»¥ä¸‹ä¸¤ç§è¡Œä¸ºï¼š</p><ol type="1"><li>è¯¥éåŒ¹é…è¾¹ç»ˆç‚¹ä¸ºéåŒ¹é…ç‚¹ï¼Œä»¥è¯¥åŒ¹é…è¾¹ç»“æŸå¢å¹¿è·¯ã€‚</li><li>ç»è¿‡è¯¥éåŒ¹é…è¾¹åè¿˜èƒ½å†æ‰¾åˆ°ä¸€æ¡åŒ¹é…è¾¹ï¼ˆè‹¥æƒ…å†µ 1 ä¸æ»¡è¶³ï¼Œæ˜¾ç„¶ä¸€å®šèƒ½æ‰¾åˆ°è¿™æ ·ä¸€æ¡è¾¹ï¼‰ï¼Œåˆ™åœ¨ç»ˆç‚¹è¿›è¡Œä¸‹ä¸€å±‚ DFSï¼Œå¯»æ‰¾ä¸‹ä¸€æ¡éåŒ¹é…è¾¹ã€‚</li></ol><p>æ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(n^2+nm)\)</span>ï¼Œä½†ä¸€èˆ¬äºŒåˆ†å›¾é¢˜ç›®çš„ <span class="math inline">\(X\)</span> ä¸ <span class="math inline">\(Y\)</span> éƒ¨é—´çš„è¿è¾¹åç¨ å¯†ï¼Œæ‰€ä»¥ç®€åŒ–ä¸º <span class="math inline">\(O(nm)\)</span>ã€‚</p><pre class="cpp"><code>bool Find(int x) &#123;    vis[x] = now; // æ—¶é—´æˆ³æ ‡è®°    for (auto i : g[x]) &#123;        if (vis[i] == now) // ä¸ç»è¿‡è®¿é—®è¿‡çš„ i            continue;        if (!mat[i] /* éåŒ¹é…ç‚¹ï¼Œå³ç»ˆç‚¹ */ ||            (vis[mat[i]] != now /* mat[i] æœªè®¿é—®è¿‡ï¼Œå¯ä»¥ç»è¿‡ */            &amp;&amp; Find(mat[i]) /* å¯æ‰¾åˆ°å¢å¹¿è·¯ */)) &#123;            mat[i] = x; // åŒ¹é…            return 1;        &#125;    &#125;    return 0;&#125;int Hungary(int n) &#123;    int res = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        ++now;        res += Find(i);    &#125;    return res;&#125;</code></pre><p>ä¸€èˆ¬æ¥è¯´ï¼ŒäºŒåˆ†å›¾é¢˜ç›®å¯¹ç‚¹ã€è¾¹ã€åˆ†ç»„æ–¹æ³•å’ŒåŒ¹é…èŒƒå›´çš„è¯†åˆ«è¾ƒä¸ºæ¨¡ç³Šã€‚ä½†ä¸€èˆ¬çš„äºŒåˆ†å›¾é¢˜ç›®éƒ½ä¼šæœ‰ä¸€äº›ç‰¹ç‚¹ï¼š</p><ul><li>ç»“ç‚¹èƒ½åˆ†ä¸ºä¸¤ç»„ï¼Œä¸”å„ç»„å†…ç»“ç‚¹é—´æ²¡æœ‰è¿è¾¹</li><li>æ¯ä¸ªç»“ç‚¹åªèƒ½ä¸ä¸€æ¡è¾¹åŒ¹é…</li></ul><p>æœ‰æ—¶å€™ï¼Œé¢˜ç›®è¦æ±‚åˆ¤å®šæ˜¯å¦å­˜åœ¨ ã€Œå®Œå¤‡åŒ¹é…ã€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class="math inline">\(ans=n\)</span>ã€‚å³ä»»æ„ä¸€æ¬¡ <code>find(i)</code> è¿”å› <code>false</code> æ—¶ï¼Œå®Œå¤‡åŒ¹é…ä¸å­˜åœ¨ã€‚</p><p>æœ€åç»™å‡ºä¸åŒˆç‰™åˆ©ç®—æ³•æœ‰å…³çš„ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol type="1"><li><p>æœ€å°ç‚¹è¦†ç›–ï¼šç»™å®šä¸€ä¸ªäºŒåˆ†å›¾ï¼Œæ±‚å‡ºä¸€ä¸ªæœ€å°çš„ç‚¹é›†ï¼Œä½¿å¾—è¿™ä¸ªç‚¹é›†å‘å‡ºçš„æ‰€æœ‰è¾¹å¯ä»¥è¦†ç›–æ•´ä¸ªäºŒåˆ†å›¾ã€‚</p><p>å®šç†ï¼šè¯¥ç‚¹é›†çš„å¤§å°æ˜¯äºŒåˆ†å›¾çš„æœ€å¤§åŒ¹é…åŒ…å«çš„è¾¹æ•°ã€‚</p></li><li><p>æœ€å¤§ç‹¬ç«‹é›†ï¼šç»™å®šä¸€ä¸ªæ— å‘å›¾ï¼Œæ±‚å‡ºä¸€ä¸ªæœ€å¤§çš„ç‚¹é›†ï¼Œä½¿å¾—è¯¥ç‚¹é›†ä¸­çš„æ‰€æœ‰ç‚¹ä¸¤ä¸¤ä¹‹é—´æ²¡æœ‰è¾¹ç›¸è¿ã€‚</p><p>å®šç†ï¼šå½“è¯¥æ— å‘å›¾æ˜¯äºŒåˆ†å›¾æ—¶ï¼Œæœ€å¤§ç‹¬ç«‹é›†çš„å¤§å°ç­‰äº <span class="math inline">\(n\)</span> å‡å»æœ€å¤§åŒ¹é…æ•°ã€‚</p><p>è¯æ˜ï¼šç”±äºæœ€å°ç‚¹è¦†ç›–å¯ä»¥è¦†ç›–æ‰€æœ‰è¾¹ï¼Œæ•…ä¸å­˜åœ¨ä¸¤ä¸ªç‚¹ï¼Œä½¿å¾—å®ƒä»¬ä¸å±äºæœ€å°ç‚¹è¦†ç›–ä¸”æœ‰è¿è¾¹ã€‚</p><p>æ‰€ä»¥ï¼Œå½“å»æ‰æœ€å°ç‚¹è¦†ç›–åï¼Œå‰©ä½™ç‚¹ä¸¤ä¸¤ä¹‹é—´æ²¡æœ‰è¿è¾¹ã€‚å› ä¸ºæœ€å°ç‚¹è¦†ç›–å¤§å°å°±æ˜¯æœ€å¤§åŒ¹é…å¤§å°ï¼Œæ•…åŸå‘½é¢˜æˆç«‹ã€‚</p></li></ol><hr /><p>æ³¨æ„äºŒåˆ†å›¾çš„ç‚¹å’Œè¾¹æ˜¯å¯ä»¥äº’ç›¸è½¬åŒ–çš„ï¼Œå³ï¼Œè‹¥å‘ç°ä¿¡æ¯é›†ä¸­åœ¨ç‚¹ä¸Šï¼Œä¹Ÿå¯ä»¥ç”¨äºŒåˆ†å›¾è§£å†³ã€‚åŒ¹é…è¾¹çš„æ•°é‡å³æœ€ç»ˆå‚ä¸åŒ¹é…çš„ç‚¹æ•°è¾ƒå¤šçš„ä¸€æ–¹çš„åŒ¹é…ç‚¹æ•°é‡ã€‚</p><p>å¯¹äºäºŒåˆ†å›¾å»ºå›¾çš„ä¸€ä¸ªåˆ¤æ–­æ–¹å¼æ˜¯ï¼Œæ‰¾å†²çªã€‚æ‰¾åˆ°å½¼æ­¤ä¹‹é—´æœ‰å†²çªçš„ä¸¤æ–¹ï¼Œè¿è¾¹ã€‚è¿™æ ·å°±èƒ½å»ºå‡ºäºŒåˆ†å›¾ã€‚å½“ç„¶è¦ä¿è¯ä¸¤æ–¹ä¹‹é—´æ²¡æœ‰äº¤é›†ã€‚</p><p>æ‰€è°“å†²çªï¼Œå°±æ˜¯æˆ‘ä»¬é€šå¸¸ç†è§£ä¸­çš„é€‰äº†ä¸€ä¸ªå°±ä¸èƒ½é€‰å¦ä¸€ä¸ªã€‚å› æ­¤ä¹Ÿå¯ä»¥é€šè¿‡å†²çªå­˜åœ¨çš„å½¢å¼æ€è€ƒå»ºå›¾æ–¹å¼ã€‚</p><hr /><h3 id="a.-æ£‹ç›˜ä¸Šçš„éª‘å£«">A. æ£‹ç›˜ä¸Šçš„éª‘å£«</h3><p><a href="http://222.180.160.110:61235/contest/3699/problem/1" class="uri">http://222.180.160.110:61235/contest/3699/problem/1</a></p><p>è¿™é“é¢˜å°±æ˜¯æˆ‘ä»¬æåˆ°çš„è¾¹è½¬åŒ–ä¸ºç‚¹çš„æƒ…å†µã€‚</p><p>ä¸ºæ£‹ç›˜ä¸Šçš„æ¯ä¸ªæ ¼å­ç¼–å·ã€‚éª‘å£«èµ°çš„æ˜¯æ—¥å­—ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠå‘¨å›´æ¯ä¸ªæ ¼å­æ—¥å­—æ–¹å‘å…«ä¸ªæ ¼å­éƒ½è¿ä¸Šè¾¹ã€‚</p><p>é‚£è¦æ€ä¹ˆå°†æ‰€æœ‰ <span class="math inline">\(n\times n\)</span> ä¸ªæ ¼å­åˆ†ä¸ºæœ‰å†²çªçš„ä¸¤æ–¹å‘¢ï¼Ÿæ³¨æ„åˆ°æ—¥å­—è¿æ¥çš„ä¸¤ä¸ªæ ¼å­ä¸€å®šå¥‡å¶æ€§ç›¸å¼‚ï¼Œæ•…æˆ‘ä»¬ä»¥å¥‡å¶æ€§åˆ†ç±»ã€‚</p><p>è¢«æŒ–æ‰çš„æ ¼å­æ— è§†å³å¯ï¼Œä¸èƒ½è¿ä»»ä½•è¾¹ï¼Œå¦åˆ™è¯¥è¾¹éƒ½æœ‰å¯èƒ½è¢«é€‰ã€‚ç„¶åè·‘ä¸€ä¸ªæœ€å¤§åŒ¹é…å°±è¡Œã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 205;const int maxm = 1e5 + 5;const int fx[] = &#123; 1, 1, -1, -1, 2, 2, -2, -2 &#125;;const int fy[] = &#123; 2, -2, 2, -2, 1, -1, 1, -1 &#125;;int a[maxn][maxn];int mat[maxm], vis[maxm];std::vector&lt;int&gt; g[maxm];int n, m, x, y, now, cnt, tot;bool Find(int x) &#123;    vis[x] = now;    for (auto i : g[x]) &#123;        if (vis[i] == now)            continue;        if (!mat[i] || (vis[mat[i]] != now                            &amp;&amp; Find(mat[i]))) &#123;            mat[i] = x;            return 1;        &#125;    &#125;    return 0;&#125;int Hungary(int n) &#123;    int res = 0;    for (int i = 1; i &lt;= n; ++i)        ++now, res += Find(i);    return res;&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;    read(n), read(m);    while (m--) &#123;        read(x), read(y);        a[x][y] = -1;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j) &#123;            if (a[i][j] != -1 &amp;&amp; !((i + j) &amp; 1))                a[i][j] = ++cnt;        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j) &#123;            if (a[i][j] == -1 || !((i + j) &amp; 1))                continue;            a[i][j] = ++tot;            for (int k = 0; k &lt; 8; ++k) &#123;                int nx = i + fx[k];                int ny = j + fy[k];                if (nx &lt; 1 || ny &lt; 1 || nx &gt; n ||                    ny &gt; n || a[nx][ny] == -1)                    continue;                add(a[i][j], a[nx][ny] + n * n);            &#125;        &#125;    &#125;    print(cnt + tot - Hungary(tot), &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="b.-ç«åŠ›ç½‘">B. ç«åŠ›ç½‘</h3><p><a href="http://222.180.160.110:61235/contest/3699/problem/2" class="uri">http://222.180.160.110:61235/contest/3699/problem/2</a></p><p>è¿™é‡Œç”¨åˆ°äº†äºŒåˆ†å›¾åœ¨åœ°å›¾ä¸Šä¸€ä¸ªè¾ƒä¸ºå¸¸ç”¨çš„åˆ†ç»„æ–¹æ³•ã€‚</p><p>æ‰¾åˆ°æ¯è¡Œæ¯åˆ—çš„ã€Œè¿é€šå—ã€ï¼Œæ»¡è¶³åœ¨è¡Œä¸Šçš„è¿é€šå—ä»»æ„æ”¾ä¸€ä¸ªç‚®å°ï¼Œç‚®å°è¦†ç›–è¿é€šå—å†…æ‰€æœ‰ç‚¹ï¼Œæ‰€æœ‰ç‚¹å‡è¢«è¿é€šå—è¦†ç›–ï¼Œåˆ—èŒƒå›´å†…åŒç†ã€‚ä¸ºè¿é€šå—åˆ†åˆ«ç¼–å·ï¼Œåˆ™æ ·ä¾‹çš„æƒ…å†µå¯è½¬åŒ–å¦‚ä¸‹ï¼š</p><pre class="plain"><code>/* å¯¹äºè¡Œ */        /* å¯¹äºåˆ— */  1 - 2 2            1 - 5 6  3 3 3 3            1 3 5 6  - - 4 4            - - 5 6  5 5 5 5            2 4 5 6</code></pre><p>è‹¥ä¸€ä¸ªæ ¼å­ä¸ºç©ºåœ°ï¼Œåˆ™å°†å…¶åœ¨è¡Œ / åˆ—èŒƒå›´å†…æ‰€å±çš„è¿é€šå—è¿è¾¹ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬åœ¨é€‰å–è¯¥æ ¼åï¼Œå°±ç›¸å½“äºé€‰å–äº†è¿™æ¡è¾¹ï¼Œç”±äºåŒ¹é…è¾¹ä¸å…±ç‚¹ï¼Œæ‰€ä»¥åˆæ³•ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 25;const int maxm = 1e5 + 5;char a[maxn][maxn];int mat[maxm], vis[maxm];std::vector&lt;int&gt; g[maxm];int n, x, y, now, cnt1, cnt2;int t[maxn][maxn], p[maxn][maxn];bool Find(int x) &#123;    vis[x] = now;    for (auto i : g[x]) &#123;        if (vis[i] == now)            continue;        if (!mat[i] || (vis[mat[i]] != now                            &amp;&amp; Find(mat[i]))) &#123;            mat[i] = x;            return 1;        &#125;    &#125;    return 0;&#125;int Hungary(int n) &#123;    int res = 0;    for (int i = 1; i &lt;= n; ++i)        ++now, res += Find(i);    return res;&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;    scanf(&quot;%d&quot;, &amp;n);    for (int i = 1; i &lt;= n; ++i)        scanf(&quot;%s&quot;, a[i] + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j) &#123;            if (a[i][j] == &#39;X&#39;)                continue;            if (a[i][j - 1] != &#39;.&#39;)                t[i][j] = ++cnt1;            else t[i][j] = t[i][j - 1];        &#125;    &#125;    for (int j = 1; j &lt;= n; ++j) &#123;        for (int i = 1; i &lt;= n; ++i) &#123;            if (a[i][j] == &#39;X&#39;)                continue;            if (a[i - 1][j] != &#39;.&#39;)                p[i][j] = ++cnt2;            else p[i][j] = p[i - 1][j];        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j) &#123;            if (a[i][j] == &#39;.&#39;)                add(t[i][j], p[i][j] + cnt1);        &#125;    &#125;    print(Hungary(cnt1), &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="c.-è¶…çº§è‹±é›„-hero">C. è¶…çº§è‹±é›„ Hero</h3><p><a href="http://222.180.160.110:61235/contest/3699/problem/3" class="uri">http://222.180.160.110:61235/contest/3699/problem/3</a></p><p>åˆ†æå†²çªã€‚æ¯ä¸ªé”¦å›Šåªèƒ½è¢«ä¸€é“é¢˜ä½¿ç”¨ï¼Œä¸€é“é¢˜åªèƒ½ä½¿ç”¨ä¸€ä¸ªé”¦å›Šï¼Œæ•…è€ƒè™‘å°†é”¦å›Šå’Œé¢˜è¿è¾¹ã€‚é¢˜ç›®è¦æ±‚è¿ç»­è§£é¢˜æœ€å¤šï¼Œæ•…ä»¥é¢˜ç›®è¿›è¡ŒåŒˆç‰™åˆ©ã€‚</p><p>æœ€åè¾“å‡ºåŒ¹é…æ•°ç»„å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 2e4 + 5;int n, m, x, y, now, t;int mat[maxn], vis[maxn];std::vector&lt;int&gt; g[maxn];bool Find(int x) &#123;    vis[x] = now;    for (auto i : g[x]) &#123;        if (vis[i] == now)            continue;        if (!mat[i] || (vis[mat[i]] != now                            &amp;&amp; Find(mat[i]))) &#123;            mat[i] = x, mat[x] = i;            return 1;        &#125;    &#125;    return 0;&#125;int Hungary(int n) &#123;    int res = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        ++now;        if (Find(i))            ++res;        else break;    &#125;    return res;&#125;void add(int x, int y) &#123;    g[x].push_back(y);    return;&#125;int main() &#123;    read(n), read(m);    for (int i = 1; i &lt;= m; ++i) &#123;        read(x), read(y);        add(i, x + m + 1);        add(i, y + m + 1);    &#125;    print(t = Hungary(m), &#39;\n&#39;);    for (int i = 1; i &lt;= t; ++i)        print(mat[i] - m - 1, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h2 id="km-ç®—æ³•">KM ç®—æ³•</h2><p>è¿˜æ²¡å†™â€¦â€¦ å’•å’•å’•</p><hr /><h3 id="a.-ants">A. Ants</h3><p><a href="https://vjudge.net/contest/554888#problem/A" class="uri">https://vjudge.net/contest/554888#problem/A</a></p><p>æ¿æ¿é¢˜ã€‚æŠŠé»‘èš‚èšå’Œç™½èš‚èšæŒ‰æ¬§å‡ é‡Œå¾—è·ç¦»è¿è¾¹å KM å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;typedef double db;const db inf = 1e18;const db eps = 1e-5;const int maxn = 205;int n, now;db g[maxn][maxn];db u[maxn], up[maxn];int vis[maxn], mat[maxn];int a[maxn][2], b[maxn][2];db max(db x, db y) &#123;    return x &gt; y ? x : y;&#125;db min(db x, db y) &#123;    return x &lt; y ? x : y;&#125;bool eq(db x, db y) &#123;    return fabs(x - y) &lt;= eps;&#125;bool Find(int x) &#123;    vis[x] = now;    for (int i = n + 1; i &lt;= 2 * n; ++i) &#123;        if (vis[i] == now)            continue;        if (eq(u[x] + u[i], g[x][i])) &#123;            vis[i] = now;            if (!mat[i] || (vis[mat[i]] != now                            &amp;&amp; Find(mat[i]))) &#123;                mat[i] = x;                return 1;            &#125;        &#125;        else &#123;            up[i] = min(up[i],                u[x] + u[i] - g[x][i]);        &#125;    &#125;    return 0;&#125;void Solve(void) &#123;    for (int i = 1; i &lt;= n; ++i) &#123;        u[i] = -inf;        for (int j = n + 1; j &lt;= 2 * n; ++j)            u[i] = max(u[i], g[i][j]);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (;;) &#123;            ++now;            for (int j = n + 1; j &lt;= 2 * n; ++j)                up[j] = inf;            if (Find(i))                break;            db Delta = inf;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] != now)                    Delta = min(Delta, up[j]);            &#125;            for (int j = 1; j &lt;= n; ++j) &#123;                if (vis[j] == now)                    u[j] -= Delta;            &#125;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] == now)                    u[j] += Delta;            &#125;        &#125;    &#125;    return;&#125;db dist(int x1, int y1, int x2, int y2) &#123;    return sqrt((db)(x1 - x2) * (x1 - x2) +                    (y1 - y2) * (y1 - y2));&#125;int main() &#123;    read(n);    for (int i = 1; i &lt;= n; ++i)        read(a[i][0]), read(a[i][1]);    for (int i = 1; i &lt;= n; ++i)        read(b[i][0]), read(b[i][1]);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j) &#123;            g[j][i + n] = -dist(a[i][0], a[i][1],                            b[j][0], b[j][1]);        &#125;    &#125;    Solve();    for (int i = n + 1; i &lt;= 2 * n; ++i)        print(mat[i], &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><h3 id="b.-å¥”å°åº·èµšå¤§é’±">B. å¥”å°åº·èµšå¤§é’±</h3><p><a href="https://vjudge.net/contest/554888#problem/B" class="uri">https://vjudge.net/contest/554888#problem/B</a></p><p>æ¿æ¿é¢˜ã€‚æŠŠå±…æ°‘å’Œæˆ¿å­è¿è¾¹å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 605;const int inf = 0x3f3f3f3f;int n, now, res;int g[maxn][maxn];int u[maxn], up[maxn];int vis[maxn], mat[maxn];int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool Find(int x) &#123;    vis[x] = now;    for (int i = n + 1; i &lt;= 2 * n; ++i) &#123;        if (vis[i] == now)            continue;        if (u[x] + u[i] == g[x][i]) &#123;            vis[i] = now;            if (!mat[i] || (vis[mat[i]] != now                            &amp;&amp; Find(mat[i]))) &#123;                mat[i] = x;                return 1;            &#125;        &#125;        else &#123;            up[i] = min(up[i],                u[x] + u[i] - g[x][i]);        &#125;    &#125;    return 0;&#125;void Solve(void) &#123;    for (int i = 1; i &lt;= 2 * n; ++i)        mat[i] = u[i] = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        u[i] = -inf;        for (int j = n + 1; j &lt;= 2 * n; ++j)            u[i] = max(u[i], g[i][j]);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (;;) &#123;            ++now;            for (int j = n + 1; j &lt;= 2 * n; ++j)                up[j] = inf;            if (Find(i))                break;            int Delta = inf;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] != now)                    Delta = min(Delta, up[j]);            &#125;            for (int j = 1; j &lt;= n; ++j) &#123;                if (vis[j] == now)                    u[j] -= Delta;            &#125;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] == now)                    u[j] += Delta;            &#125;        &#125;    &#125;    return;&#125;int main() &#123;    while(read(n)) &#123;        res = 0;        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= n; ++j)                read(g[i][j + n]);        &#125;        Solve();        for (int i = n + 1; i &lt;= 2 * n; ++i)            res += g[mat[i]][i];        print(res, &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="c.-going-home">C. Going Home</h3><p><a href="https://vjudge.net/contest/554888#problem/C" class="uri">https://vjudge.net/contest/554888#problem/C</a></p><p>æ¿æ¿é¢˜ã€‚æŠŠäººå’Œæˆ¿å­æŒ‰æ›¼å“ˆé¡¿è·ç¦»è¿è¾¹å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 205;const int inf = 0x3f3f3f3f;int g[maxn][maxn];char s[maxn][maxn];int u[maxn], up[maxn];int h, w, n, m, now, res;int vis[maxn], mat[maxn];int a[maxn][2], b[maxn][2];int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool Find(int x) &#123;    vis[x] = now;    for (int i = n + 1; i &lt;= 2 * n; ++i) &#123;        if (vis[i] == now)            continue;        if (u[x] + u[i] == g[x][i]) &#123;            vis[i] = now;            if (!mat[i] || (vis[mat[i]] != now                            &amp;&amp; Find(mat[i]))) &#123;                mat[i] = x;                return 1;            &#125;        &#125;        else &#123;            up[i] = min(up[i],                u[x] + u[i] - g[x][i]);        &#125;    &#125;    return 0;&#125;void Solve(void) &#123;    for (int i = 1; i &lt;= 2 * n; ++i)        mat[i] = u[i] = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        u[i] = -inf;        for (int j = n + 1; j &lt;= 2 * n; ++j)            u[i] = max(u[i], g[i][j]);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (;;) &#123;            ++now;            for (int j = n + 1; j &lt;= 2 * n; ++j)                up[j] = inf;            if (Find(i))                break;            int Delta = inf;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] != now)                    Delta = min(Delta, up[j]);            &#125;            for (int j = 1; j &lt;= n; ++j) &#123;                if (vis[j] == now)                    u[j] -= Delta;            &#125;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] == now)                    u[j] += Delta;            &#125;        &#125;    &#125;    return;&#125;int abs(int x) &#123;    return x &gt;= 0 ? x : -x;&#125;int dist(int x1, int y1, int x2, int y2) &#123;    return abs(x1 - x2) + abs(y1- y2);&#125;void Init(void) &#123;    res = n = m = 0;    memset(g, 0, sizeof (g));    return;&#125;int main() &#123;    scanf(&quot;%d %d&quot;, &amp;h, &amp;w);    while (h || w) &#123;        Init();        for (int i = 1; i &lt;= h; ++i) &#123;            scanf(&quot;%s&quot;, s[i] + 1);            for (int j = 1; j &lt;= w; ++j) &#123;                if (s[i][j] == &#39;H&#39;)                    a[++n][0] = i, a[n][1] = j;                else if (s[i][j] == &#39;m&#39;)                    b[++m][0] = i, b[m][1] = j;            &#125;        &#125;        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= n; ++j) &#123;                g[i][j + n] = -dist(a[i][0],                    a[i][1], b[j][0], b[j][1]);            &#125;        &#125;        Solve();        for (int i = n + 1; i &lt;= 2 * n; ++i)            res += g[mat[i]][i];        print(-res, &#39;\n&#39;);        scanf(&quot;%d %d&quot;, &amp;h, &amp;w);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="d.-cyclic-tour">D. Cyclic Tour</h3><p><a href="https://vjudge.net/contest/554888#problem/D" class="uri">https://vjudge.net/contest/554888#problem/D</a></p><p>é¢˜æ„åœ¨è®²ä»€ä¹ˆå•Šï¼Œçœ‹äº†åŠå¤©çœ‹ä¸æ‡‚ã€‚</p><p>ç»™å®šä¸€ä¸ªæœ‰å‘å›¾ï¼Œæ‰¾åˆ°è‹¥å¹²ä¸ªäº’ä¸ç›¸äº¤çš„ç¯è¦†ç›–æ•´ä¸ªå›¾ï¼Œä½¿å¾—æ‰€æœ‰ç¯ä¸Šè¾¹æƒå’Œæœ€å°ï¼Œè‹¥æ‰¾ä¸åˆ°æ–¹æ¡ˆè¾“å‡º -1ã€‚</p><p>æˆ‘ä»¬çŸ¥é“ä¸è¿™é“é¢˜ç›¸ç±»ä¼¼çš„æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜å¯ä»¥ç”¨äºŒåˆ†å›¾ + æ‹†ç‚¹æ¥è§£å†³ã€‚é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°å°åœ°æ‹†ä¸€æ‹†ç‚¹ã€‚æŠŠä¸€ä¸ªç‚¹æ‹†æˆä¸¤ä¸ªï¼Œä¸€ä¸ªä½œä¸ºèµ·ç‚¹ï¼Œä¸€ä¸ªä½œä¸ºç»ˆç‚¹ï¼Œä¸¤ä¸ªç‚¹ä¹‹é—´è¿åŒå‘è¾¹ï¼Œè¿™æ ·è¯¥å›¾å°±å’ŒåŸå›¾ç­‰ä»·ã€‚</p><p>æ‹†å‡ºæ¥èµ·ç‚¹ä¹‹é—´æ²¡æœ‰è¾¹ï¼Œæ‹†å‡ºæ¥çš„ç»ˆç‚¹ä¹‹é—´ä¹Ÿæ²¡æœ‰è¾¹ï¼Œæ‰€ä»¥åŸå›¾æ˜¯äºŒåˆ†å›¾ã€‚</p><p>ä¸éš¾å‘ç°ï¼Œå‡è®¾åŸå›¾ä¸­çš„ç¯ä¸Šå…±æœ‰ <span class="math inline">\(x\)</span> ä¸ªç‚¹ã€<span class="math inline">\(x\)</span> æ¡è¾¹ï¼Œé‚£ä¹ˆæ‹†ç‚¹åå°±ä¼šæœ‰ <span class="math inline">\(2\times x\)</span> ä¸ªç‚¹å’Œ <span class="math inline">\(2\times x\)</span> æ¡è¾¹ï¼Œå…¶ä¸­ <span class="math inline">\(x\)</span> æ¡è¾¹æ˜¯ç‚¹ <span class="math inline">\(i\)</span> è¿å‘ç‚¹ <span class="math inline">\(i&#39;\)</span>ï¼ˆæˆ–åä¹‹ï¼‰çš„è¾¹ã€‚</p><p>éœ€è¦åŒ¹é…åˆ°å‰©ä½™çš„å®è¾¹ï¼ˆè€Œéè‡ªå·±è¿å‘è‡ªå·±çš„è™šè¾¹ï¼‰å…±æœ‰ <span class="math inline">\(x\)</span> æ¡ï¼Œå·¦å³éƒ¨èŠ‚ç‚¹éƒ½æœ‰ <span class="math inline">\(x\)</span> ä¸ªï¼Œè€ƒè™‘è®¾è™šè¾¹è¾¹æƒä¸ºæ­£æ— ç©·ï¼Œè¿›è¡Œæœ€å°æƒå®Œç¾åŒ¹é…ï¼ˆç‚¹å’Œè‡ªå·±è¿è¾¹çš„æ“ä½œä¿è¯äº†ä¸€å®šèƒ½æ‰¾åˆ°è§£ï¼Œä¸ä¼šè¿›å…¥æ­»å¾ªç¯ï¼‰ã€‚</p><p>é‚£ä¹ˆä»€ä¹ˆæ—¶å€™æ— è§£å‘¢ï¼Ÿå½“ç®—æ³•ä¸å¾—ä¸é€‰ä¸­è™šè¾¹æ—¶ï¼Œå°±è¯´æ˜æ‰¾ä¸åˆ°ç¯äº†ã€‚æ‰€ä»¥æˆ‘ä»¬åˆ¤ä¸€ä¸‹åŒ¹é…æœ‰æ²¡æœ‰åŒ…å«æ­£æ— ç©·è¾¹å³å¯ã€‚</p><p>è®°å¾—åˆ¤é‡è¾¹ï¼</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 205;const int inf = 0x3f3f3f3f;int g[maxn][maxn];int u[maxn], up[maxn];int vis[maxn], mat[maxn];int n, m, x, y, now, res, w;int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool Find(int x) &#123;    vis[x] = now;    for (int i = n + 1; i &lt;= 2 * n; ++i) &#123;        if (vis[i] == now)            continue;        if (u[x] + u[i] == g[x][i]) &#123;            vis[i] = now;            if (!mat[i] || (vis[mat[i]] != now                            &amp;&amp; Find(mat[i]))) &#123;                mat[i] = x;                return 1;            &#125;        &#125;        else &#123;            up[i] = min(up[i],                u[x] + u[i] - g[x][i]);        &#125;    &#125;    return 0;&#125;void Solve(void) &#123;    for (int i = 1; i &lt;= 2 * n; ++i)        mat[i] = u[i] = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        u[i] = -inf;        for (int j = n + 1; j &lt;= 2 * n; ++j)            u[i] = max(u[i], g[i][j]);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (;;) &#123;            ++now;            for (int j = n + 1; j &lt;= 2 * n; ++j)                up[j] = inf;            if (Find(i))                break;            int Delta = inf;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] != now)                    Delta = min(Delta, up[j]);            &#125;            for (int j = 1; j &lt;= n; ++j) &#123;                if (vis[j] == now)                    u[j] -= Delta;            &#125;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] == now)                    u[j] += Delta;            &#125;        &#125;    &#125;    return;&#125;int main() &#123;    while (read(n)) &#123;        read(m);        res = 0;        for (int i = 1; i &lt;= 2 * n; ++i) &#123;            for (int j = 1; j &lt;= 2 * n; ++j)                 g[i][j] = -inf;        &#125;        while (m--) &#123;            read(x), read(y), read(w);            g[x][y + n] = max(g[x][y + n], -w);        &#125;        Solve();        for (int i = n + 1; i &lt;= 2 * n; ++i) &#123;            if (g[mat[i]][i] &lt;= -inf) &#123;                puts(&quot;-1&quot;);                goto NoSol;            &#125;            res += -g[mat[i]][i];        &#125;        print(res, &#39;\n&#39;);        NoSol: ;    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="e.-tour">E. Tour</h3><p><a href="https://vjudge.net/contest/554888#problem/E" class="uri">https://vjudge.net/contest/554888#problem/E</a></p><p>æŠŠä¸Šä¸€é¢˜è¾“å…¥æ–¹å¼å’Œæ•°æ®èŒƒå›´æ”¹ä¸€æ”¹å°±å¥½äº†ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 405;const int inf = 0x3f3f3f3f;int g[maxn][maxn];int u[maxn], up[maxn];int vis[maxn], mat[maxn];int T, n, m, x, y, now, res, w;int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;int min(int x, int y) &#123;    return x &lt; y ? x : y;&#125;bool Find(int x) &#123;    vis[x] = now;    for (int i = n + 1; i &lt;= 2 * n; ++i) &#123;        if (vis[i] == now)            continue;        if (u[x] + u[i] == g[x][i]) &#123;            vis[i] = now;            if (!mat[i] || (vis[mat[i]] != now                            &amp;&amp; Find(mat[i]))) &#123;                mat[i] = x;                return 1;            &#125;        &#125;        else &#123;            up[i] = min(up[i],                u[x] + u[i] - g[x][i]);        &#125;    &#125;    return 0;&#125;void Solve(void) &#123;    for (int i = 1; i &lt;= 2 * n; ++i)        mat[i] = u[i] = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        u[i] = -inf;        for (int j = n + 1; j &lt;= 2 * n; ++j)            u[i] = max(u[i], g[i][j]);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (;;) &#123;            ++now;            for (int j = n + 1; j &lt;= 2 * n; ++j)                up[j] = inf;            if (Find(i))                break;            int Delta = inf;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] != now)                    Delta = min(Delta, up[j]);            &#125;            for (int j = 1; j &lt;= n; ++j) &#123;                if (vis[j] == now)                    u[j] -= Delta;            &#125;            for (int j = n + 1;                            j &lt;= 2 * n; ++j) &#123;                if (vis[j] == now)                    u[j] += Delta;            &#125;        &#125;    &#125;    return;&#125;int main() &#123;    read(T);    while(T--) &#123;        read(n), read(m);        res = 0;        for (int i = 1; i &lt;= 2 * n; ++i) &#123;            for (int j = 1; j &lt;= 2 * n; ++j)                 g[i][j] = -inf;        &#125;        while (m--) &#123;            read(x), read(y), read(w);            g[x][y + n] = max(g[x][y + n], -w);        &#125;        Solve();        for (int i = n + 1; i &lt;= 2 * n; ++i) &#123;            if (g[mat[i]][i] &lt;= -inf) &#123;                puts(&quot;-1&quot;);                goto NoSol;            &#125;            res += -g[mat[i]][i];        &#125;        print(res, &#39;\n&#39;);        NoSol: ;    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="d.-å¯¼å¼¹é˜²å¾¡å¡”">D. å¯¼å¼¹é˜²å¾¡å¡”</h3><p><a href="http://222.180.160.110:61235/contest/3699/problem/4" class="uri">http://222.180.160.110:61235/contest/3699/problem/4</a></p><p>GM è¯´çš„å¥½å“‡ï¼ˆæŒ‡ <em>æ¯›ç—…å¤šï¼Œä¸€ä¼šå„¿åˆ†é’Ÿä¸€ä¼šå„¿ç§’</em>ï¼‰ã€‚</p><p>å¯»æ‰¾å†²çªã€‚ä¸€ä¸ªæ•Œäººåªèƒ½è¢«ä¸€ç‚®æ‰“æ­»ï¼Œæ•…è€ƒè™‘</p><p>ä½†ä¸€ä¸ªå¡”å¯ä»¥æ‰“å¾ˆå¤šç‚®ï¼Œè€ƒè™‘æ‹†ç‚¹ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> äºŒåˆ†å›¾ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†æ²»</title>
      <link href="/20230314/"/>
      <url>/20230314/</url>
      
        <content type="html"><![CDATA[<p>å¬è¯´æ˜¯ <a href="http://222.180.160.110:61235/contest/3416">åˆ†æ²»åœº</a>ï¼Œæƒ³èµ·äº†è‡ªå·±æ ¹æœ¬æ²¡å­¦è¿‡åˆ†æ²»ï¼ˆç”šè‡³ä»æ¥ä¸çŸ¥é“å½’å¹¶æ’åºçš„åŸç† orzï¼‰å°±å»å¬ CDQ ç„¶åä¸€å¤´é›¾æ°´çš„æƒ¨ç—›ç»å†ï¼Œä¸ç¦ PTSD äº†ã€‚</p><span id="more"></span><hr /><h3 id="a.-è€æ¿çš„åˆä¸€é“é¢˜">A. è€æ¿çš„åˆä¸€é“é¢˜</h3><p><a href="http://222.180.160.110:61235/contest/3416/problem/1" class="uri">http://222.180.160.110:61235/contest/3416/problem/1</a></p><p>è¿™æ˜¯ä»€ä¹ˆï¼Œæœ‰åºè¡¨çš„æœ€å°å’Œï¼Œåˆ‡ä¸€ä¸‹ï¼ˆæ‰€ä»¥å’Œåˆ†æ²»æœ‰ä»€ä¹ˆå…³ç³»å•Šï¼‰ã€‚</p><p>é¦–å…ˆå¯¹æ•°ç»„è¿›è¡Œæ’åºï¼ˆæˆ‘å¿˜äº† orzï¼‰ï¼Œç„¶ååœ¨ä¼˜å…ˆé˜Ÿåˆ—ä¸­å¡«å…¥ <span class="math inline">\(A_{1\sim n} + B_1\)</span>ã€‚å‡è®¾å½“å‰æœ€å°å€¼ä¸º <span class="math inline">\(A_i + B_j\)</span>ï¼Œåˆ™è¾“å‡ºï¼Œå¼¹å‡ºå¹¶å¡«å…¥ <span class="math inline">\(A_i + B_{j + 1}\)</span>ã€‚å› ä¸º <span class="math inline">\(B\)</span> æ˜¯å•è°ƒçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¡«å…¥çš„æ•°ï¼ˆèµ·ç åœ¨è¾“å‡ºæ—¶ï¼‰æ˜¯å•è°ƒçš„ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e5 + 5;struct _ &#123;    int u, i;    _() &#123;&#125;    _(int u1, int i1) &#123;        u = u1, i = i1;    &#125;    bool operator&lt; (const _ q) const &#123;        return u &gt; q.u;    &#125;&#125;;int n, cnt;int a[maxn], b[maxn];std::priority_queue&lt;_&gt; q;int main() &#123;    read(n);    for (int i = 1; i &lt;= n; ++i)        read(a[i]);    for (int i = 1; i &lt;= n; ++i)        read(b[i]);    std::sort(a + 1, a + n + 1);    std::sort(b + 1, b + n + 1);    for (int i = 1; i &lt;= n; ++i)        q.push(_(a[i] + b[1], 1));    while (!q.empty()) &#123;        _ f = q.top();        q.pop();        print(f.u, &#39; &#39;);        if (++cnt == n)            break;        _ t = f;        t.u -= b[f.i];        t.u += b[++t.i];        q.push(t);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="b.-é­”æ³•çŸ³çš„è¯±æƒ‘">B. é­”æ³•çŸ³çš„è¯±æƒ‘</h3><p><a href="http://222.180.160.110:61235/contest/3416/problem/2" class="uri">http://222.180.160.110:61235/contest/3416/problem/2</a></p><p>è¿™ï¼Œè¿™ä¸æ˜¯äºŒåˆ†ç­”æ¡ˆï¼Ÿåˆ°åº•å’Œåˆ†æ²»æœ‰ä»€ä¹ˆå…³ç³»å•Šã€‚</p><p>å˜¶ï¼Œ<span class="math inline">\(Q\)</span> æ˜¯ <span class="math inline">\(10^8\)</span>ï¼Œç®—ä¸€ç®— <span class="math inline">\(n\)</span> çš„èŒƒå›´ã€‚ä¸éš¾å‘ç° <span class="math inline">\(Q=\sum\limits_{i&gt;1} \lfloor \dfrac n{5^i} \rfloor\)</span>ï¼Œå½“ <span class="math inline">\(n=5\times 10^8\)</span> æ—¶ï¼Œ<span class="math inline">\(\dfrac n5\)</span> å°±å·²ç»æ˜¯ <span class="math inline">\(10^8\)</span> äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬äºŒåˆ†çš„å·¦å³è¾¹ç•Œåº”ä¸º <span class="math inline">\([0,5\times 10^8]\)</span>ã€‚</p><p>ç„¶å <code>check</code> çš„è¯æˆ‘ä»¬å°±æš´åŠ›é™¤ <span class="math inline">\(5\)</span> è®¡ç®—ç­”æ¡ˆï¼ˆå°±åƒå°å¥¥ä¸€æ ·ï¼‰ï¼Œä¸€æ¬¡ <code>check</code> çš„æ—¶é—´å¤æ‚åº¦æ˜¯ <span class="math inline">\(\log_5\)</span> çš„ï¼Œä¸ä¼šæœ‰é—®é¢˜ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;int q, l, mid, r = 5e18, res;int check(int x) &#123;    int res = 0;    while (x / 5)        res += (x /= 5);    return res;&#125;int main() &#123;    read(q);    while (l &lt;= r) &#123;        int mid = (l + r) &gt;&gt; 1;        if (check(mid) &gt;= q) &#123;            res = mid;            r = mid - 1;        &#125;        else l = mid + 1;    &#125;    if (check(res) == q)        print(res);    else puts(&quot;No solution&quot;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="c.-ç¥æ—æ–‡å­—">C. ç¥æ—æ–‡å­—</h3><p><a href="http://222.180.160.110:61235/contest/3416/problem/3" class="uri">http://222.180.160.110:61235/contest/3416/problem/3</a></p><p>æˆ‘ä¸ç†è§£ï¼Ÿè¿™åˆ°åº•å’Œåˆ†æ²»æœ‰ä»€ä¹ˆå…³ç³»ï¼ŸGM ä¸ä¼šæ˜¯çº¯çœ‹æ ‡ç­¾æ‹‰é¢˜å§ï¼Ÿæ ‡ç­¾åˆæ˜¯å“ªä¸ªèªæ˜æ‰“çš„ï¼Ÿ</p><p>æ€»è€Œè¨€ä¹‹ï¼Œè¨€è€Œæ€»ä¹‹ï¼Œæˆ‘ä»¬æ‰“ä¸€ä¸ª <code>map</code>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;using str = std::string;str s1, s2, sl;std::map&lt;str, str&gt; t;int main() &#123;    for (;;) &#123;        std::getline(std::cin, sl);        std::stringstream s(sl);        if (s &gt;&gt; s1) &#123;            s &gt;&gt; s2;            t[s2] = s1;        &#125;        else break;    &#125;    while (std::cin &gt;&gt; s1) &#123;        if (t.count(s1))            std::cout &lt;&lt; t[s1] &lt;&lt; &#39;\n&#39;;        else puts(&quot;eh&quot;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="d.-é€ƒäº¡">D. é€ƒäº¡</h3><p><a href="http://222.180.160.110:61235/contest/3416/problem/4" class="uri">http://222.180.160.110:61235/contest/3416/problem/4</a></p><p>é¦–å…ˆæ³¨æ„åˆ°è½¦è½¦æ˜¯è‡ªåŠ¨é©¾é©¶çš„ï¼Œå°±æ˜¯è¯´ä¸€ä¸ªäººä¸‹è½¦è¿‡åè½¦ä¼šè‡ªåŠ¨å¾€å¦ä¸€ä¸ªäººçš„æ–¹å‘è·‘ã€‚</p><p>æ˜æ˜¾åå¤äº¤æ¥çš„è¯è½¦ä¼šå¤šè·‘å¾ˆå¤šè·¯ç¨‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªäº¤æ¥ä¸€æ¬¡ã€‚</p><p>æ‰€ä»¥éš¾ç‚¹åªæ˜¯ç”¨æœªçŸ¥æ•°æŠŠæœ€ç»ˆé€Ÿåº¦è¡¨ç¤ºå‡ºæ¥ï¼ˆæƒ³èµ·äº†ç‰©ç†å®éªŒé¢˜ï¼‰ã€‚</p><p>å‡è®¾è·ç¦»ä¸º <span class="math inline">\(S\)</span>ï¼Œè½¦é€Ÿä¸º <span class="math inline">\(v_1\)</span>ï¼Œäººé€Ÿä¸º <span class="math inline">\(v_2\)</span>ï¼Œç¬¬ä¸€ä¸ªäººä¸€ç›´åè½¦ååˆ° <span class="math inline">\(x\)</span> è·¯ç¨‹ï¼Œåˆ™æœ€ç»ˆæ—¶é—´ä¸º <span class="math inline">\(\max\left\{ \dfrac x{v_1} + \dfrac {S - x}{v_2}, \dfrac x{v_1}+\dfrac {x - \dfrac x{v_1}\times v_2}{v_1 + v_2} + \dfrac {S-\dfrac x{v_1}\times v_2 - \dfrac {x - \dfrac x{v_1}\times v_2}{v_1 + v_2} \times v_2}{v_1}\right\}\)</span>ã€‚</p><p>æœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„ç‚¹ï¼Œå°±æ˜¯ <span class="math inline">\(x\)</span> è¶Šå¤§ï¼Œç¬¬ä¸€ä¸ªäººç”¨æ—¶å°±è¶ŠçŸ­ï¼Œç¬¬äºŒä¸ªäººç”¨æ—¶å°±è¶Šå¤šã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥äºŒåˆ† <span class="math inline">\(x\)</span>ï¼Œå°½é‡ä½¿ç¬¬ä¸€ä¸ªäººå’Œç¬¬äºŒä¸ªäººç”¨æ—¶æ¥è¿‘ï¼ˆç”¨æ—¶æ˜¯ä¸€ä¸ªå…³äº <span class="math inline">\(x\)</span> çš„åˆ†æ®µå‡½æ•°ï¼Œæˆ‘ä»¬å¯»æ‰¾å…¶æ‹ç‚¹ï¼‰ï¼Œæœ€ç»ˆç›¸åŒç”¨æ—¶å³ä¸ºç­”æ¡ˆã€‚</p><details><p>å› ä¸ºä»æ¥ä¸æ˜¯å¾ˆå–œæ¬¢æµ®ç‚¹æ•°äºŒåˆ†ï¼Œé‡‡ç”¨äº†å…ˆæ•´æ•°äºŒåˆ†å†æ¡†èŒƒå›´å–ç²¾ç¡®ç­”æ¡ˆçš„æ–¹æ³•ã€‚</p><p>æ‰€ä»¥æ€ä¹ˆåˆæ˜¯äºŒåˆ†ï¼Ÿè¯´å¥½çš„åˆ†æ²»åœºå‘¢ï¼Ÿ</p><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;using db = double;const db eps = 1e-2;db res, ans = 1e18;int s, v1, v2, l, mid, r;db min(db x, db y) &#123;    return x &lt; y ? x : y; &#125;db max(db x, db y) &#123;    return x &gt; y ? x : y;&#125;bool check(int x) &#123;    db t1 = x * 1.0 / v1;    db r1 = t1 + (s - x) * 1.0 / v2;    db t2 = (x - t1 * v2) / (v1 + v2);    db r2 = t1 + t2 + (s - t1 * v2 - t2 * v2) / v1;    return r1 &lt;= r2;&#125;int main() &#123;    read(s), read(v2), read(v1);    l = 0, r = s;    while (l &lt;= r) &#123;        mid = (l + r) &gt;&gt; 1;        if (check(mid)) &#123;            res = (db)mid;            r = mid - 1;        &#125;        else l = mid + 1;    &#125;    for (db i = res - 2; i &lt;= res + 2; i += eps) &#123;        db t1 = i * 1.0 / v1;        db r1 = t1 + (s - i) * 1.0 / v2;        db t2 = (i - t1 * v2) / (v1 + v2);        db r2 = t1 + t2 +                (s - t1 * v2 - t2 * v2) / v1;        ans = min(ans, max(r1, r2));    &#125;    printf(&quot;%.2lf&quot;, ans);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="e.-å‰”é™¤å¤šä½™æ‹¬å·">E. å‰”é™¤å¤šä½™æ‹¬å·</h3><p><a href="http://222.180.160.110:61235/contest/3416/problem/5" class="uri">http://222.180.160.110:61235/contest/3416/problem/5</a></p><p><em>ä¸ºäº†å¥—å–æ•°æ®ç†è§£é¢˜æ„ï¼Œæˆ‘ç”¨ python äº¤äº†ä¸€ä¸ª <code>print(input())</code>ï¼Œç»“æœæ€»å¸ä»¤åœ¨ä¸Šï¼Œå¾—åˆ°äº† 33pts çš„é«˜åˆ†â€¦</em></p><p>ä»€ä¹ˆå«å¤šä½™æ‹¬å·å‘¢ï¼Ÿæ‹¬å·å‰åçš„ç¬¦å·ä¼˜å…ˆçº§å°äºç­‰äºæ‹¬å·ä¸­çš„ç¬¦å·ï¼Œå¹¶ä¸”è‹¥æ‹¬å·å†…å­˜åœ¨æ‹¬å·ä¸æ‹¬å·å‰åŒçº§ï¼Œåˆ™æ‹¬å·å‰ä¸ä¸º <code>-</code> æˆ– <code>/</code>ã€‚</p><p>è¿™æ ·å°±å¯ä»¥äº†ã€‚æˆ‘ä»¬å°†é—®é¢˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå­é—®é¢˜ï¼Œå¯¹æ¯ä¸ªæ‹¬å·å†…çš„å†…å®¹è¿›è¡Œç›¸åŒæ–¹å¼çš„å¤„ç†ï¼šå¯¹æ¯”æ‹¬å·å†…ä¼˜å…ˆçº§æœ€é«˜çš„ç¬¦å·å’Œæ‹¬å·å‰åç¬¦å·çš„ä¼˜å…ˆçº§ï¼Œå¤„ç†æ‹¬å·å†…çš„å†…å®¹æ—¶è‹¥é‡åˆ°æ‹¬å·ï¼Œåˆ™é€’å½’åœ°è¿›è¡Œç›¸ä¼¼çš„å¤„ç†ã€‚</p><details><p>å…¶å®è¿™ä¸ªå……å…¶é‡åªèƒ½ç®—æ˜¯æ¨¡æ‹Ÿâ€¦â€¦ è·Ÿåˆ†æ²»å¹¶ä¸æ˜¯å¾ˆæœ‰å…³ç³»ï¼Œå’Œ CSP-J 2022 T3 æœ‰ç‚¹åƒã€‚</p><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 260;int n;char s[maxn];bool vis[maxn];int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;int Deal(int l, int r) &#123;    int res = 1;    for (int i = l; i &lt;= r; ++i) &#123;        if (s[i] == &#39;+&#39; || s[i] == &#39;-&#39;)            res = max(res, 1);        else if (s[i] == &#39;*&#39; || s[i] == &#39;/&#39;)            res = 2;        else if (s[i] == &#39;(&#39;) &#123;            int cnt = 1, j;            for (j = i + 1; j &lt;= r; ++j) &#123;                if (s[j] == &#39;(&#39;)                    ++cnt;                else if (s[j] == &#39;)&#39;)                    --cnt;                if (cnt == 0)                    break;            &#125;            cnt = Deal(i + 1, j - 1);            int t = 1;            int p1 = i - 1, p2 = j + 1;            while (s[p1] == &#39;(&#39; || s[p1] == &#39;)&#39;)                --p1;            while (s[p2] == &#39;(&#39; || s[p2] == &#39;)&#39;)                ++p2;            if (s[p1] == &#39;+&#39; || s[p1] == &#39;-&#39;)                t = max(t, 1);            else t = max(t, 2);            if (s[p2] == &#39;+&#39; || s[p2] == &#39;-&#39;)                t = max(t, 1);            else t = max(t, 2);            if (t &lt; cnt)                vis[i] = vis[j] = 1;            else if (t == cnt) &#123;                if (s[p1] != &#39;-&#39; &amp;&amp; s[p1] != &#39;/&#39;)                    vis[i] = vis[j] = 1;            &#125;            i = j;        &#125;    &#125;    return res;&#125;int main() &#123;    s[1] = &#39;+&#39;;    scanf(&quot;%s&quot;, s + 2);    n = strlen(s + 1) + 1;    s[n] = &#39;+&#39;;    Deal(1, n);    for (int i = 2; i &lt; n; ++i) &#123;        if (!vis[i])            putchar(s[i]);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="f.-æœ€æ¥è¿‘ç‚¹å¯¹é—®é¢˜">F. æœ€æ¥è¿‘ç‚¹å¯¹é—®é¢˜</h3><p><a href="http://222.180.160.110:61235/contest/3416/problem/6" class="uri">http://222.180.160.110:61235/contest/3416/problem/6</a></p><p>åˆ†æ²»å…¸ä¸­å…¸ã€‚</p><p>æˆ‘ä»¬å°†ç‚¹æŒ‰ç…§æ¨ªåæ ‡æ’åºï¼Œå¯¹ç‚¹ <span class="math inline">\(1\sim n\)</span> è¿›è¡Œåˆ†æ²»ã€‚</p><p>å°†æ±‚è§£åŒºé—´åŒ…å«çš„ç‚¹åˆ†ä¸ºä¸¤éƒ¨åˆ†ï¼Œå‡è®¾å·¦è¾¹éƒ¨åˆ†å’Œå³è¾¹éƒ¨åˆ†å·²ç»åˆ†åˆ«æ±‚è§£å‡ºäº†æœ€è¿‘ç‚¹å¯¹ï¼ˆå‡ºå£å³ä¸ºæ±‚è§£åŒºé—´ä»…åŒ…å«ä¸¤ç‚¹ï¼Œç›´æ¥æ±‚å‡ºè·ç¦»ï¼‰ï¼Œè€ƒè™‘åˆå¹¶çŠ¶æ€ã€‚åˆ™æƒ…å†µæ— éæœ‰ä¸‰ç§ï¼š</p><ol type="1"><li>ç­”æ¡ˆä¸ºå·¦è¾¹éƒ¨åˆ†çš„ç­”æ¡ˆ</li><li>ç­”æ¡ˆä¸ºå³è¾¹éƒ¨åˆ†çš„ç­”æ¡ˆ</li><li>ç­”æ¡ˆä¸ºå·¦ã€å³å„é€‰å–ä¸€ç‚¹</li></ol><p>å‰ä¸¤è€…æ˜¯å·²çŸ¥é‡ï¼Œåˆ™æˆ‘ä»¬æ±‚è§£å‡ºç¬¬ä¸‰ç§æƒ…å†µï¼Œé€‰æ‹©æœ€å°å€¼å³å¯ã€‚</p><p>ç¬¬ä¸‰ç§æƒ…å†µæœ‰ä¸ªå¾ˆå¦™çš„å¤„ç†æ–¹å¼ï¼šæˆ‘ä»¬è®¾å‰ä¸¤ç§æƒ…å†µçš„ç­”æ¡ˆè¾ƒå°è€…ä¸º <span class="math inline">\(d\)</span>ï¼Œè®¾æ±‚è§£åŒºé—´æœ€é ä¸­é—´çš„ç‚¹ä¸º <span class="math inline">\(m\)</span>ã€‚</p><ul><li><p>è‹¥ <span class="math inline">\(m\)</span> ä¸ºå·¦è¾¹éƒ¨åˆ†çš„ç‚¹</p><p>åˆ™ç”±äºæˆ‘ä»¬å¯¹åŠäºŒåˆ†ï¼Œ<span class="math inline">\(m\)</span> ä¸€å®šæ˜¯å·¦è¾¹éƒ¨åˆ†æœ€é å³çš„ç‚¹ã€‚</p><ul><li><p>å¯¹äºå…¶ä½™å·¦è¾¹éƒ¨åˆ†çš„èŠ‚ç‚¹ï¼š</p>è‹¥å®ƒä»¬ä¸ <span class="math inline">\(m\)</span> çš„æ¨ªå‘è·ç¦»å·²ç»å¤§äºç­‰äº <span class="math inline">\(d\)</span>ï¼Œåˆ™å®ƒä»¬ä¸å³è¾¹éƒ¨åˆ†çš„ç‚¹çš„æ¨ªå‘è·ç¦»ä¼šæ›´å¤§ã€‚è¿æ¨ªå‘è·ç¦»éƒ½å·²ç»å¤§äºç­‰äºå½“å‰æœ€ä¼˜è§£äº†ï¼Œæ— éœ€è€ƒè™‘çºµå‘è·ç¦»ï¼Œç­›é™¤è¿™éƒ¨åˆ†ç‚¹ã€‚</li><li><p>å¯¹äºå³è¾¹éƒ¨åˆ†çš„èŠ‚ç‚¹ï¼š</p><p>è‹¥å®ƒä»¬ä¸ <span class="math inline">\(m\)</span> çš„æ¨ªå‘è·ç¦»å·²ç»å¤§äºç­‰äº <span class="math inline">\(d\)</span>ï¼Œåˆ™å®ƒä»¬ä¸æ›´å·¦è¾¹çš„å…¶ä»–å·¦è¾¹éƒ¨åˆ†èŠ‚ç‚¹çš„æ¨ªå‘è·ç¦»ä¼šæ›´å¤§ï¼Œæ•…ç­›é™¤è¿™éƒ¨åˆ†ç‚¹ã€‚</p></li></ul></li><li><p>è‹¥ <span class="math inline">\(m\)</span> ä¸ºå³è¾¹éƒ¨åˆ†çš„ç‚¹</p><p>åŒç†ã€‚</p></li></ul><p>ç»¼ä¸Šï¼Œæˆ‘ä»¬åªç”¨è€ƒè™‘æ±‚è§£åŒºé—´å†…ä¸ <span class="math inline">\(m\)</span> çš„æ¨ªå‘è·ç¦»å°äº <span class="math inline">\(d\)</span> çš„ç‚¹ã€‚</p><p>åœ¨ç­›é€‰å‡ºè¿™äº›ç‚¹åï¼Œæˆ‘ä»¬å¦‚ä½•è¿›è¡Œè¿›ä¸€æ­¥çš„å¤„ç†å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ï¼Œ<strong>æšä¸¾</strong>ã€‚</p><p>æˆ‘ä»¬æšä¸¾æ¯ä¸€å¯¹ç‚¹ï¼Œè®¡ç®—å®ƒä»¬é—´çš„è·ç¦»ã€‚è‹¥æ¯”ç­”æ¡ˆå°ï¼Œåˆ™æ›´æ–°ç­”æ¡ˆã€‚</p><p>é‚£è¿™å¤æ‚åº¦ä¹Ÿå¤ªç¥å¥‡äº†ã€‚æ‰€ä»¥æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªåŒæ ·ç¥å¥‡çš„ä¼˜åŒ–ï¼šæŒ‰çºµåæ ‡é€’å¢å¯¹ç­›é€‰å‡ºçš„ç‚¹æ’åºã€‚å½“äºŒé‡å¾ªç¯ç­›é€‰æ—¶ï¼Œè‹¥å½“å‰ç¬¬ä¸€å±‚å¾ªç¯ <span class="math inline">\(i\)</span> ä¸ç¬¬äºŒå±‚å¾ªç¯ <span class="math inline">\(j\)</span> çš„çºµå‘è·ç¦»å¤§äºç­‰äºäº†å½“å‰æœ€å°ç­”æ¡ˆï¼Œå°±å¯ä»¥å°†ç¬¬äºŒå±‚å¾ªç¯ <code>break</code> äº†ã€‚å› ä¸ºçºµåæ ‡å•è°ƒï¼Œç»§ç»­æšä¸¾è·ç¦»ä¼šç»§ç»­å¢åŠ ï¼Œç¦»ç­”æ¡ˆæ›´è¿œã€‚</p><p>é‚£çœ‹èµ·æ¥å¤æ‚åº¦è¿˜æ˜¯å¾ˆç¥å¥‡ï¼Œç†è®ºä¸Šæ¥è¯´åº”è¯¥æ˜¯ <span class="math inline">\(O(n^2\log n)\)</span> çš„å‘€ï¼Ÿ</p><p>è€ƒè™‘ç¬¬ä¸€å±‚å¾ªç¯ <span class="math inline">\(i\)</span>ã€‚å¯¹äºç‚¹ <span class="math inline">\(i\)</span>ï¼Œæœ‰å“ªäº› <span class="math inline">\(j\)</span> å¯ä»¥æ»¡è¶³å®ƒçš„è¦æ±‚ï¼Œä»è€Œè¢«æšä¸¾åˆ°å‘¢ï¼Ÿ</p><ul><li>ç”±äºç‚¹å¯¹æ— åºï¼Œæ‰€ä»¥ <span class="math inline">\(j\)</span> ä» <span class="math inline">\(i+1\)</span> å¼€å§‹æšä¸¾ï¼Œæ‰€ä»¥ <span class="math inline">\(y_j&gt;y_i\)</span>ã€‚</li><li>ç”±äºç­›é€‰æ¡ä»¶ï¼Œ<span class="math inline">\(|x_i-x_m|&lt; d\)</span> ä¸” <span class="math inline">\(|x_j-x_m|&lt; d\)</span>ã€‚</li><li>ç”±äº <code>break</code> æ¡ä»¶ï¼Œ<span class="math inline">\(y_j-y_i&lt; d\)</span>ã€‚</li></ul><p>åˆå¹¶ä¸€ä¸‹å°±æ˜¯ï¼Œ<span class="math inline">\(|x_i-x_j|\le 2\times d\)</span>ï¼Œä¸” <span class="math inline">\(0\le y_j - y_i \le d\)</span>ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”»å‡ºä¸€ä¸ªåº•ä¸º <span class="math inline">\(2\times d\)</span>ï¼Œé«˜ä¸º <span class="math inline">\(d\)</span> çš„çŸ©å½¢ï¼Œä¸”å®ƒçš„ä¸­è½´çº¿ä¸º <span class="math inline">\(x=x_m\)</span>ï¼Œä¸­è½´çº¿å·¦å³ä¸¤è¾¹å‡ä¸º <span class="math inline">\(d\times d\)</span> çš„æ­£æ–¹å½¢ã€‚</p><p>è‹¥ä»»æ„ä¸¤ä¸ªç‚¹åŒåœ¨å·¦è¾¹éƒ¨åˆ†æˆ–åŒåœ¨å³è¾¹éƒ¨åˆ†ï¼Œé‚£ä¹ˆè¿™ä¸€å¯¹ç‚¹çš„è´¡çŒ®å·²ç»åœ¨åˆ†æ²»æ—¶è®¡ç®—å®Œæˆäº†ï¼Œæ‰€ä»¥ä¸€å®šä¸ä¼šæ¯” <span class="math inline">\(d\)</span> å°ã€‚</p><p>æœ‰ä¸€ä¸ªå¾ˆå¦™çš„ç»“è®ºï¼šæ»¡è¶³æ¡ä»¶çš„ <span class="math inline">\(j\)</span> åœ¨çŸ©å½¢çš„å·¦åŠè¾¹å’Œå³åŠè¾¹æœ€å¤šåªæœ‰ä¸‰ä¸ªã€‚</p><p>ä¸ºä»€ä¹ˆï¼ŸåŒä¸€éƒ¨åˆ†ä¸­ï¼Œä»»æ„ä¸¤ä¸ª <span class="math inline">\(j\)</span> çš„è·ç¦»è‡³å°‘ä¸º <span class="math inline">\(d\)</span>ã€‚é‚£ä¹ˆå››ä¸ª <span class="math inline">\(j\)</span>ï¼Œè·ç¦»éƒ½ä¸º <span class="math inline">\(d\)</span>ï¼Œé‚£ä¹ˆæ­£å¥½å°±æ˜¯æ•´ä¸ªå·¦åŠè¾¹çš„æ­£æ–¹å½¢ã€‚åˆ«å¿˜äº†ä¸€ç‚¹ï¼Œ<span class="math inline">\(j\)</span> éœ€æ»¡è¶³çš„ä¸‰ä¸ªæ¡ä»¶éƒ½æ˜¯ä¸¥æ ¼å°äºï¼Œæ‰€ä»¥ä¸èƒ½ç¢°åˆ°æ•´ä¸ªçŸ©å½¢çš„è¾¹ç•Œï¼Œæ‰€ä»¥ä¸€ä¸ªéƒ¨åˆ†ä¸­æœ€å¤šåªèƒ½å­˜åœ¨ä¸‰ä¸ª <span class="math inline">\(j\)</span>ã€‚</p><p>é‚£ä¹ˆå®é™…ä¸Šçœ‹ä¼¼ <span class="math inline">\(n^2\)</span> çš„æšä¸¾ï¼Œåœ¨å¤šä¸ªä¼˜åŒ–ä¸‹å°±å˜æˆäº† <span class="math inline">\(O(n)\)</span>ã€‚å†åŠ ä¸Šå¯¹ç­›é€‰å‡ºçš„ç‚¹çºµåæ ‡æ’åºçš„æ—¶é—´ï¼Œæ€»ä½“æ—¶é—´å¤æ‚åº¦ä¸º <span class="math inline">\(O(n\log^2 n)\)</span>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using db = double;const db inf = 1e18;const int maxn = 6e4 + 5;struct _ &#123; db x, y; &#125;;int n;_ a[maxn];db dis(db x1, db y1, db x2, db y2) &#123;    return sqrt((x1 - x2) * (x1 - x2) +                (y1 - y2) * (y1 - y2));&#125;db min(db x, db y) &#123;    return x &lt; y ? x : y;&#125;db abs(db x) &#123;    return x &gt;= 0 ? x : -x;&#125;db Solu(int l, int r) &#123;    if (l == r)        return inf;    if (l + 1 == r)        return dis(a[l].x, a[l].y, a[r].x, a[r].y);    int mid = (l + r) &gt;&gt; 1;    db d = min(Solu(l, mid), Solu(mid + 1, r));    std::vector&lt;_&gt; t;    for (int i = l; i &lt;= r; ++i) &#123;        if (abs(a[i].x - a[mid].x) &lt; d)            t.push_back(a[i]);    &#125;    std::sort(t.begin(), t.end(),        [&amp;](_ x, _ y) &#123; return x.y &lt; y.y; &#125;);    for (int i = 0; i &lt; (int)t.size(); ++i) &#123;        for (int j = i + 1; j &lt; (int)t.size(); ++j) &#123;            if (t[j].y - t[i].y &gt;= d)                break;            d = min(d, dis(t[i].x, t[i].y,                                t[j].x, t[j].y));        &#125;    &#125;    return d;&#125;int main() &#123;    scanf(&quot;%d&quot;, &amp;n);    for (int i = 1; i &lt;= n; ++i)        scanf(&quot;%lf %lf&quot;, &amp;a[i].x, &amp;a[i].y);    std::sort(a + 1, a + n + 1,        [&amp;](_ x, _ y) &#123; return x.x &lt; y.x; &#125;);    printf(&quot;%.2lf\n&quot;, Solu(1, n) / 2);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><p>è€ƒè™‘ä¸€ä¸ªé—®é¢˜ã€‚ä»£ç çš„æ—¶é—´å¤æ‚åº¦æœ‰ä¸¤ä¸ª <span class="math inline">\(\log\)</span>ï¼Œè¿™æ˜¯æä¸å¥½çš„ï¼ˆwill be fixedï¼‰ã€‚</p><hr /><h3 id="g.-æ®‹ç¼ºæ£‹ç›˜é—®é¢˜">G. æ®‹ç¼ºæ£‹ç›˜é—®é¢˜</h3><p><a href="http://222.180.160.110:61235/contest/3416/problem/7" class="uri">http://222.180.160.110:61235/contest/3416/problem/7</a></p><p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼š<span class="math inline">\(4^n-1\)</span> ä¸€å®šè¢« <span class="math inline">\(3\)</span> æ•´é™¤å—ï¼Ÿ</p><p>ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨æ•°å­¦å½’çº³æ³•è¿›è¡Œè¯æ˜ï¼Œå…¶æ€æƒ³ä¹Ÿä¼šåœ¨è¿™é“é¢˜ä¸­ä½“ç°ã€‚</p><p>ä¸è¿‡è¿˜æœ‰å¦ä¸€ä¸ªæ–¹æ³•ï¼š<span class="math inline">\(4^n-1=(3+1)^n-1\)</span>ï¼Œä½¿ç”¨äºŒé¡¹å¼å®šç†åˆ™æœ‰ï¼š</p><p><span class="math display">\[(3+1)^n-1=\sum_{i=0}^n {n\choose i} \times 3^{n-i}\times 1^i - 1\]</span></p><p>ä¸éš¾å‘ç°é™¤ <span class="math inline">\(i=n\)</span> æ—¶ï¼Œå‰é¢æ¯ä¸€é¡¹éƒ½æœ‰å› å­ <span class="math inline">\(3\)</span>ï¼Œè€Œå½“ <span class="math inline">\(i=n\)</span> æ—¶ï¼Œ<span class="math inline">\({n\choose n}\times 3^0\times 1^n=1\)</span>ï¼Œä¸åé¢çš„ <span class="math inline">\(-1\)</span> æŠµæ¶ˆï¼Œæ•…å¾—è¯ã€‚</p><hr /><p>è€ƒè™‘å°†æ£‹ç›˜åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ª <span class="math inline">\(2\times 2\)</span> çš„ 1 çº§åŒºåŸŸã€‚å¯¹äºç¼ºå£æ‰€åœ¨çš„ 1 çº§åŒºåŸŸï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªåˆšå¥½è´´åˆçš„ä¸‰æ ¼æ¿å°†å…¶è¡¥é½æˆä¸ºä¸€ä¸ªå®Œæ•´çš„ 1 çº§åŒºåŸŸã€‚</p><p>æˆ‘ä»¬ç§°åŒ…å«å››ä¸ªå®Œæ•´çš„ <span class="math inline">\(2\times 2\)</span> çš„ 1 çº§åŒºåŸŸçš„ <span class="math inline">\(4\times 4\)</span> çš„åŒºåŸŸä¸º 2 çº§åŒºåŸŸï¼Œå¯¹äºåŒ…å«äº†æˆ‘ä»¬åˆšåˆšè¡¥é½çš„ 1 çº§åŒºåŸŸçš„ 2 çº§åŒºåŸŸï¼Œæˆ‘ä»¬å°†æœ€ä¸­é—´çš„å››ä¸ªæ ¼å­è§†ä¸ºä¸€ä¸ª 1 çº§åŒºåŸŸå¹¶å¡«å……ï¼Œæ¥ä¸‹æ¥å‰©ä½™çš„ 3 ä¸ªå®Œæ•´ 1 çº§åŒºåŸŸä¸ºå„è‡ªå¤±å»ä¸€ä¸ªèƒ½å¡«å……çš„æ ¼å­ï¼Œæˆ‘ä»¬é€‰å–å¯¹åº”çš„ä¸‰æ ¼æ¿å¡«å……å³å¯ã€‚</p><p>å¯¹äºä¸€ä¸ª <span class="math inline">\(8\times 8\)</span> çš„ 3 çº§åŒºåŸŸï¼Œè‹¥å…¶åŒ…å«æˆ‘ä»¬å¡«å……å®Œæ¯•çš„ 2 çº§åŒºåŸŸï¼Œæˆ‘ä»¬å°†æœ€ä¸­é—´ <span class="math inline">\(2\times 2\)</span> çš„æ ¼å­è§†ä¸ºä¸€ä¸ª 1 çº§åŒºåŸŸå¹¶å¡«å……ã€‚æ¥ä¸‹æ¥ï¼Œå‰©ä½™çš„ 3 ä¸ªå®Œæ•´çš„ 2 çº§åŒºåŸŸæˆä¸ºç¼ºå¤± 1 ä¸ªæ ¼å­çš„ 2 çº§åŒºåŸŸï¼ŒæŒ‰ä¹‹å‰çš„æ–¹æ³•å¡«å……å³å¯ã€‚</p><p>ä»¥æ­¤ç±»æ¨å³å¯é€’å½’åœ°å¡«å……å®Œæˆæ•´ä¸ªæ£‹ç›˜ã€‚ä½†ç°åœ¨åˆæ¥äº†ä¸€ä¸ªé—®é¢˜ï¼šè¿™é“é¢˜æ²¡æœ‰ SPJã€‚æ ¹æ®æ ·ä¾‹å¯çŸ¥ï¼Œå¡«å……è§„åˆ™æ˜¯ç”±å¤–åˆ°å†…ï¼Œä¸­ã€å·¦ä¸Šã€å·¦ä¸‹ã€å³ä¸Šã€å³ä¸‹ï¼Œæˆ‘ä»¬æŒ‰ç…§æ­¤é¡ºåºè¿›è¡Œåˆ†æ²»é€’å½’å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 105;int n, x, y, cnt;int t[maxn][maxn];void getColor(int c, int r, int l, int x, int y) &#123;    if (l == 2) &#123;        ++cnt;        for (int i = c; i &lt;= c + 1; ++i) &#123;            for (int j = r; j &lt;= r + 1; ++j) &#123;                if (i != x || j != y)                    t[i][j] = cnt;            &#125;        &#125;        return;    &#125;    l /= 2;    if (x - c &lt; l) &#123;        if (y - r &lt; l) &#123;            getColor(c + l - 1, r + l - 1,                        2, c + l - 1, r + l - 1);            getColor(c, r, l, x, y);            getColor(c + l, r, l, c + l, r + l - 1);            getColor(c, r + l, l, c + l - 1, r + l);            getColor(c + l, r + l, l, c + l, r + l);        &#125;        else &#123;            getColor(c + l - 1, r + l - 1,                        2, c + l - 1, r + l);            getColor(c, r, l, c + l - 1, r + l - 1);            getColor(c + l, r, l, c + l, r + l - 1);            getColor(c, r + l, l, x, y);            getColor(c + l, r + l, l, c + l, r + l);        &#125;    &#125;    else &#123;        if (y - r &lt; l) &#123;            getColor(c + l - 1, r + l - 1,                            2, c + l, r + l - 1);            getColor(c, r, l, c + l - 1, r + l - 1);            getColor(c + l, r, l, x, y);            getColor(c, r + l, l, c + l - 1, r + l);            getColor(c + l, r + l, l, c + l, r + l);        &#125;        else &#123;            getColor(c + l - 1, r + l - 1,                            2, c + l, r + l);            getColor(c, r, l, c + l - 1, r + l - 1);            getColor(c + l, r, l, c + l, r + l - 1);            getColor(c, r + l, l, c + l - 1, r + l);            getColor(c + l, r + l, l, x, y);        &#125;    &#125;    return;&#125;int main() &#123;    read(n), read(x), read(y);    getColor(1, 1, n, x, y);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= n; ++j)            print(t[i][j], &#39; &#39;);        putchar(&#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h3 id="h.-tricky-function">H. Tricky Function</h3><p><a href="http://222.180.160.110:61235/contest/3416/problem/8" class="uri">http://222.180.160.110:61235/contest/3416/problem/8</a></p><p>GM æç¤ºäº†è¿™é“é¢˜å°±æ˜¯å¹³é¢æœ€è¿‘ç‚¹å¯¹ã€‚è±ç„¶å¼€æœ—ã€‚</p><p>ä¸å¦¨å°† <span class="math inline">\(i\)</span> è§†ä½œ <span class="math inline">\(x_i\)</span>ï¼Œå°† <span class="math inline">\(\sum_{k=1}^i a_k\)</span> è§†ä½œ <span class="math inline">\(y_i\)</span>ï¼Œåˆ™ç›´æ¥æ±‚è§£å¹³é¢æœ€è¿‘ç‚¹å¯¹å³å¯ã€‚</p>]]></content>
      
      
      
        <tags>
            
            <tag> åˆ†æ²» </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¾ä¸½çš„æŸ æª¬èŠ±ï¼</title>
      <link href="/20230203/"/>
      <url>/20230203/</url>
      
        <content type="html"><![CDATA[<p>Solution to <a href="https://codeforces.com/problemset/problem/1733/D2">CF1733D2 Zero-One (Hard Version)</a>ã€‚</p><span id="more"></span><hr /><p>æ²¡åšè¿‡ç®€å•ç‰ˆæœ¬ï¼Œæ¨¡æ‹Ÿèµ›ä¸Šé‡åˆ°ï¼Œä¹ä¸€çœ‹æ˜¯ä¸ªè´ªå¿ƒï¼Œä½†è´ªå¿ƒæ€ç»´å¤ªå¼±æƒ³ä¸åˆ°æ€ä¹ˆè´ªã€‚æ‰€ä»¥æ€è€ƒå…¶ä»–æ–¹æ³•ã€‚</p><p>ä¸‹æ–‡ç§°åŒæ—¶å–å <span class="math inline">\(a_i\)</span> å’Œ <span class="math inline">\(a_j\)</span> çš„ä¸€æ¬¡æ“ä½œä¸ºã€Œå–å <span class="math inline">\((a_i, a_j)\)</span>ã€ï¼Œç§° <span class="math inline">\(a_i=b_i\)</span> çš„çŠ¶æ€ä¸ºã€ŒåŒ¹é…ã€ã€‚</p><hr /><h3 id="æ€ç»´å…³é”®ç‚¹">æ€ç»´å…³é”®ç‚¹</h3><p>è‹¥æˆ‘ä»¬æƒ³è¦å°† <span class="math inline">\((a_i,a_j)\)</span> å–åï¼Œæˆ‘ä»¬å¯ä»¥æ€ä¹ˆåšï¼Ÿ</p><p>ä¸éš¾å‘ç°ï¼Œåˆ† <span class="math inline">\(a_i\)</span> ä¸ <span class="math inline">\(a_j\)</span> ç›¸é‚»å’Œä¸ç›¸é‚»ä¸¤ç§æƒ…å†µï¼š</p><ol type="1"><li><p><span class="math inline">\(a_i\)</span> ä¸ <span class="math inline">\(a_j\)</span> ç›¸é‚»ï¼š</p><ol type="1"><li>ç›´æ¥å–åï¼Œä»£ä»·ä¸º <span class="math inline">\(x\)</span>ã€‚</li><li>å¯»æ‰¾åˆ°ä¸€ä¸ªä¸ <span class="math inline">\(a_i\)</span> å’Œ <span class="math inline">\(a_j\)</span> éƒ½ä¸ç›¸é‚»çš„ <span class="math inline">\(a_k\)</span>ï¼Œå…ˆå°† <span class="math inline">\((a_i,a_k)\)</span> å–åï¼Œå†å°† <span class="math inline">\((a_j,a_k)\)</span> å–åï¼Œä»£ä»·ä¸º <span class="math inline">\(2\times y\)</span>ã€‚</li></ol></li><li><p><span class="math inline">\(a_i\)</span> ä¸ <span class="math inline">\(a_j\)</span> ä¸ç›¸é‚»ï¼š</p><ol type="1"><li>ç›´æ¥å–åï¼Œä»£ä»·ä¸º <span class="math inline">\(y\)</span>ã€‚</li><li>å°† <span class="math inline">\((a_i,a_{i + 1}),(a_{i + 1}, a_{i + 2}),\cdots,(a_{j - 1}, a_{j})\)</span> å–åï¼Œä»£ä»·ä¸º <span class="math inline">\((j - i)\times x\)</span>ã€‚</li></ol></li></ol><p>æ¥ä¸‹æ¥è€ƒè™‘å¦ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬è¦å–åå“ªäº› <span class="math inline">\((a_i,a_j)\)</span> å‘¢ï¼Ÿ</p><p>å‡è®¾ç°åœ¨æœ‰ <span class="math inline">\(a_p\)</span> ä¸ <span class="math inline">\(b_p\)</span> ä¸åŒ¹é…ï¼Œ<span class="math inline">\(a_q\)</span> ä¸ <span class="math inline">\(b_q\)</span> ä¸åŒ¹é…ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‚¯å®šé€‰æ‹©å°† <span class="math inline">\((a_p,a_q)\)</span> å–åã€‚</p><p>åŸå› å¾ˆç®€å•ï¼Œå‡è®¾æœ‰ <span class="math inline">\(a_k=b_k\)</span>ï¼Œå¦‚æœæˆ‘ä»¬å°† <span class="math inline">\((a_p,a_k)\)</span> å–åï¼Œé‚£ä¹ˆ <span class="math inline">\(a_k\ne b_k\)</span>ï¼Œæˆ‘ä»¬éœ€è¦é¢å¤–çš„ä¸€æ¬¡ä¸ <span class="math inline">\(a_k\)</span> æœ‰å…³çš„æ“ä½œå°†å…¶å¤åŸã€‚å¦‚æœæˆ‘ä»¬æŒ‘é€‰ä¸€ä¸ª <span class="math inline">\(a_l=b_l\)</span>ï¼Œå¹¶å°† <span class="math inline">\((a_k,a_l)\)</span> å–åï¼Œé‚£ä¹ˆ <span class="math inline">\(a_l\)</span> ä¸ <span class="math inline">\(b_l\)</span> åˆä¼šä¸åŒ¹é…ï¼Œåˆéœ€è¦ä¸€æ¬¡æ“ä½œï¼›å¦‚æœæŒ‘é€‰ä¸€ä¸ª <span class="math inline">\(a_l\ne b_l\)</span>ï¼Œå¹¶å°† <span class="math inline">\((a_k,a_l)\)</span> å–åï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸èƒ½åœ¨ä¸€å¼€å§‹å°±å°† <span class="math inline">\((a_p,a_l)\)</span> å–åå‘¢ï¼Ÿæ­¤æ—¶çš„ <span class="math inline">\(a_k\)</span> ç›¸å½“äºä¸€ä¸ªä¸­ç»§ï¼Œè€Œè¿™ç§æƒ…å†µæˆ‘ä»¬å·²ç»åœ¨å–å <span class="math inline">\((a_p,a_l)\)</span> æ—¶è€ƒè™‘åˆ°äº†ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ¯æ¬¡å–å <strong>åª</strong> é€‰æ‹©ä¸¤ä¸ªæ— æ³•ä¸ <span class="math inline">\(b\)</span> åŒ¹é…çš„ <span class="math inline">\(a\)</span>ã€‚</p><p>é‚£ä¹ˆï¼Œæœ‰æ²¡æœ‰ä¸€ç§æƒ…å†µï¼Œè®©æˆ‘ä»¬æ— æ³•é€‰æ‹©ä¸¤ä¸ªæ— æ³•åŒ¹é…çš„å€¼å‘¢ï¼Ÿ</p><p>é‚£å°±æ˜¯ä¸åŒ¹é…çš„å€¼çš„æ•°é‡æœ‰å¥‡æ•°ä¸ªï¼Œæ‰ä¼šè®©æˆ‘ä»¬ä¸¤ä¸ªä¸¤ä¸ªé€‰çš„æ—¶å€™æœ‰å…ƒç´ è½å•ã€‚</p><p>ä¸å¦¨æ€è€ƒä¸€æ¬¡å–åæ“ä½œæ‰€æœ‰å¯èƒ½çš„æƒ…å†µï¼ˆå‡è®¾ä¸å—ä¸Šé¢çš„ç»“è®ºé™åˆ¶ï¼‰ï¼š</p><ol type="1"><li><p>å–åä¸€ä¸ªåŒ¹é…å€¼å’Œä¸€ä¸ªä¸åŒ¹é…å€¼</p>æ­¤æ—¶åŒ¹é…å€¼å˜ä¸ºéåŒ¹é…ï¼Œä¸åŒ¹é…å€¼å˜ä¸ºåŒ¹é…ï¼Œä¸åŒ¹é…çš„å…ƒç´ æ€»æ•°ä¸å˜ã€‚</li><li><p>å–åä¸¤ä¸ªä¸åŒ¹é…å€¼</p>ä¸¤ä¸ªä¸åŒ¹é…å€¼éƒ½å˜ä¸ºåŒ¹é…ï¼Œä¸åŒ¹é…å…ƒç´ çš„æ€»æ•°é‡å¢åŠ  <span class="math inline">\(-2\)</span>ã€‚</li><li><p>å–åä¸¤ä¸ªåŒ¹é…å€¼</p><p>ä¸¤ä¸ªåŒ¹é…å€¼éƒ½å˜ä¸ºéåŒ¹é…ï¼Œä¸åŒ¹é…å…ƒç´ çš„æ€»æ•°é‡å¢åŠ  <span class="math inline">\(2\)</span>ã€‚</p></li></ol><p>ç»¼ä¸Šï¼Œä¸€æ¬¡æ“ä½œå¯¹ä¸åŒ¹é…å…ƒç´ æ€»æ•°å¸¦æ¥çš„æ›´æ”¹åªå¯èƒ½ä¸º <span class="math inline">\(0,2,-2\)</span>ï¼Œå‡ä¸ºå¶æ•°ã€‚å½“ä¸åŒ¹é…å…ƒç´ ä¸ºå¥‡æ•°æ—¶ï¼Œå¿…å®šæ— æ³•å°†å…¶æ›´æ”¹è‡³åˆšå¥½ä¸º <span class="math inline">\(0\)</span>ã€‚æ­¤æ—¶è¾“å‡º <span class="math inline">\(-1\)</span>ã€‚</p><p>æˆ‘ä»¬ä¸Šé¢ç»“è®ºçš„å¯å®ç°æ€§ä¹Ÿå¾—åˆ°äº†ä¿éšœï¼šåªå–åä¸¤ä¸ªä¸åŒ¹é…çš„ <span class="math inline">\(a\)</span>ï¼Œä¸ä¼šæœ‰å…ƒç´ è½å•ã€‚</p><p>ä¸‹æ–‡è®°ä»å‰å¾€åç¬¬ <span class="math inline">\(i\)</span> ä¸ªä¸ <span class="math inline">\(b\)</span> ä¸åŒ¹é…çš„ <span class="math inline">\(a\)</span> çš„ä¸‹æ ‡ä¸º <span class="math inline">\(d_i\)</span>ã€‚</p><hr /><h3 id="ç¡®å®šå®ç°æ–¹æ³•">ç¡®å®šå®ç°æ–¹æ³•</h3><p>å‘ç° <span class="math inline">\(\sum n\le 5\times 10^3\)</span>ï¼Œç¡®å®šç®—æ³•å¤æ‚åº¦ä¸º <span class="math inline">\(O(n^2)\)</span>ã€‚</p><p>é¦–å…ˆä¸éš¾æƒ³åˆ°æš´åŠ›æœç´¢ï¼Œæ¯æ¬¡æšä¸¾å°†å“ªä¸€å¯¹ <span class="math inline">\((d_i, d_j)\)</span> å–åã€‚</p><p>äº¦æˆ–æ˜¯ä½¿ç”¨ <code>bitset</code> è®°å½•å“ªäº›éåŒ¹é…å€¼å·²è¢«å–åï¼ˆè¢«å–åä¸º <span class="math inline">\(1\)</span>ï¼Œå¦åˆ™ä¸º <span class="math inline">\(0\)</span>ï¼‰ï¼Œæšä¸¾æ•°å¯¹æš´åŠ› DP æ›´æ–°æœ€å°å€¼ã€‚</p><p>ä½†ä»¥ä¸Šä¸¤ç§æ–¹æ³•é“å®šè¶…æ—¶ã€‚</p><p>å—åˆ°ä¸Šé¢ä¸¤ç§æ–¹æ³•çš„å¯å‘ï¼Œæ‰©å±•æ€ç»´ï¼Œæˆ‘ä»¬å‘ç°ï¼š</p><ul><li><p>å–åæ“ä½œçš„é¡ºåºä¸ä¼šå½±å“æœ€ç»ˆç­”æ¡ˆã€‚</p>å› ä¸ºæ¯ä¸ªæ•°è¢«å–åçš„æ¬¡æ•°ä¸€å®šï¼Œæœ€ç»ˆç»“æœä¹Ÿå°±ä¸€å®šã€‚</li><li><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ DP çš„æ–¹å¼å¯»æ‰¾æœ€å°å€¼ã€‚</p></li></ul><p>è®¾è®¡çŠ¶æ€ã€‚</p><p>ä¸å¦¨è€ƒè™‘è®©é—®é¢˜éº»çƒ¦èµ·æ¥çš„æ˜¯ä»€ä¹ˆï¼Œå¯¹äº <span class="math inline">\(d_i\)</span> ä¸ <span class="math inline">\(d_j\)</span> ä¸ç›¸é‚»æ—¶çš„å–åï¼Œæˆ‘ä»¬æ— æ³•å¾—çŸ¥ <span class="math inline">\(d_i\)</span> éœ€è¦å“ªä¸€ä¸ª <span class="math inline">\(d_j\)</span>ï¼ˆè€Œå¯¹äº <span class="math inline">\(d_i\)</span> ä¸ <span class="math inline">\(d_j\)</span> ç›¸é‚»çš„æƒ…å†µï¼Œ<span class="math inline">\(d_j\)</span> å°±æ˜¯ <span class="math inline">\(d_{i + 1}\)</span>ï¼Œä½ç½®æ˜¯ç¡®å®šçš„ï¼‰ã€‚</p><p>ä½†æˆ‘ä»¬åŒæ—¶ä¹Ÿå‘ç°ï¼Œä¸ç›¸é‚»æ—¶çš„ä»£ä»·ä¸åŒï¼Œä¸ç›¸é‚»æ—¶çš„æ“ä½œä»£ä»·ä¸ <span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\(j\)</span> çš„å…·ä½“å€¼æ— å…³ã€‚</p><p>æ‰€ä»¥ä¸å¦¨ç”¨ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºï¼Œå·²æšä¸¾åˆ° <span class="math inline">\(d_i\)</span>ï¼Œå‰é¢æœ‰ <span class="math inline">\(j\)</span> ä¸ªæ•°éœ€è¦åé¢ <strong>ä¸å®ƒä»¬ä¸ç›¸é‚»çš„æ•°</strong> ç”¨ä»¥å’Œå®ƒä»¬é…å¯¹å–åã€‚</p><p>å‡è®¾å·²æšä¸¾åˆ° <span class="math inline">\(d_i\)</span>ï¼Œå½“å‰é¢æœ‰ <span class="math inline">\(s\)</span> ä¸ªæ•°éœ€è¦é…å¯¹æ—¶ï¼Œæœ‰ä»¥ä¸‹çš„æƒ…å†µï¼š</p><ul><li><p>å½“ <span class="math inline">\(s = 1\)</span>ï¼Œå³åªæœ‰ä¸€ä¸ªæ•°éœ€è¦é…å¯¹æ—¶ï¼š</p><ul><li><p>å¦‚æœè¿™ä¸ªæ•°æ˜¯ <span class="math inline">\(d_{i - 1}\)</span>ï¼Œé‚£ä¹ˆä»£ä»·ä¸º <span class="math inline">\(2\times y\)</span>ã€‚</p>æ³¨æ„ï¼Œè¿™é‡Œåªæšä¸¾äº†éœ€è¦ä¸ç›¸é‚»çš„æ•°æ¥é…å¯¹çš„æƒ…å†µï¼Œç›¸é‚»çš„æƒ…å†µå°†ä¼šå¦å¤–è®¡ç®—ï¼Œæ‰€ä»¥ä»£ä»·ä¸èƒ½ä¸º <span class="math inline">\(x\)</span>ã€‚</li><li>å¦åˆ™ï¼Œä»£ä»·ä¸º <span class="math inline">\(y\)</span>ã€‚</li></ul></li><li><p>å½“ <span class="math inline">\(s&gt;1\)</span> æ—¶ï¼Œå³æœ‰å¤šä¸ªæ•°éœ€è¦é…å¯¹æ—¶ï¼š</p><p>ä¸ç®¡ <span class="math inline">\(d_{i-1}\)</span> æ˜¯å¦éœ€è¦é…å¯¹ï¼Œæˆ‘ä»¬éƒ½ä¸é€‰å®ƒã€‚å› ä¸ºé€‰å®ƒçš„ä»£ä»·æ˜¯ <span class="math inline">\(2\times y\)</span>ï¼Œè€Œéšä¾¿é€‰å¦ä¸€ä¸ªå¾…é…å¯¹æ•°çš„ä»£ä»·éƒ½åªæœ‰ <span class="math inline">\(y\)</span>ã€‚</p></li></ul><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œæˆ‘å’‹çŸ¥é“å®ƒä»¬ç›¸ä¸ç›¸é‚»ï¼Ÿ</p><p>å†å¤šå¼€ä¸€ç»´ <span class="math inline">\(0/1\)</span> çŠ¶æ€ï¼Œè®°å½•æœ€åä¸€ä¸ªéœ€è¦ä¸å…¶ä»–åé¢çš„å…ƒç´ é…å¯¹å€¼æ˜¯å¦æ˜¯ <span class="math inline">\(a_{i-1}\)</span> å³å¯ã€‚</p><p>å‡è®¾ç°åœ¨å·²ç»æšä¸¾åˆ° <span class="math inline">\(f_{i,j,0/1}\)</span>ï¼Œå³å·²æšä¸¾å®Œ <span class="math inline">\(d_i\)</span>ï¼Œæœ‰ <span class="math inline">\(j\)</span> ä¸ªå…ƒç´ éœ€è¦é…å¯¹ã€‚</p><p>åˆ™æ›´æ–° <span class="math inline">\(d_{i+1}\)</span> çš„çŠ¶æ€ï¼š</p><ul><li><p>è‹¥æˆ‘ä»¬æƒ³è¦è®© <span class="math inline">\(d_{i+1}\)</span> ä¸åé¢çš„å…ƒç´ é…å¯¹ï¼Œåˆ™ä»£ä»·è‡³å°‘ä¸º <span class="math inline">\(y\)</span>ã€‚è‡³äºæ˜¯å¦ä¼šå› ä¸ºå¾…é…å¯¹å…ƒç´ ç›¸é‚»è€Œé¢å¤–å¢åŠ  <span class="math inline">\(y\)</span> çš„ä»£ä»·ï¼Œæˆ‘ä»¬åœ¨å¾…é…å¯¹å…ƒç´ å¤„è®¡ç®—ã€‚</p><span class="math display">\[ f_{i+1,j+1,1}\gets\min(f_{i,j,0},f_{i,j,1}) + y \]</span></li><li><p>è‹¥æˆ‘ä»¬æƒ³è¦è®© <span class="math inline">\(d_{i+1}\)</span> ä¸å…¶ç›¸é‚»çš„ <span class="math inline">\(a_{i+2}\)</span> åŒ¹é…ï¼Œé‚£ä¹ˆ <span class="math inline">\(d_{i+2}\)</span> å°±ä¸éœ€è¦å†ä¸åé¢çš„å…ƒç´ é…å¯¹äº†ï¼Œæ•…æœ€åä¸€ç»´ä¸º <span class="math inline">\(0\)</span>ã€‚</p><span class="math display">\[ f_{i+2,j,0}\gets\min(f_{i,j,0},f_{i,j,1})+(d_{i+2}-d_{i+1})\times x \]</span></li><li><p>å¦‚æœæˆ‘ä»¬æƒ³è®© <span class="math inline">\(d_{i+1}\)</span> ä¸å‰é¢çš„å¾…é…å¯¹å…ƒç´ é…å¯¹ï¼š</p><p>åœ¨æ­¤ç§å¤§å‰æä¸‹ï¼Œ<span class="math inline">\(d_{i+1}\)</span> ä¸€å®šä¸éœ€è¦ä¸åé¢çš„å…ƒç´ é…å¯¹ï¼Œæ•…æœ€åä¸€ç»´ä¸º <span class="math inline">\(0\)</span>ã€‚</p><ul><li><p>å½“ <span class="math inline">\(j=1\)</span> ä¸” <span class="math inline">\(d_i+1=d_{i+1}\)</span> æ—¶ï¼Œå³å­˜åœ¨å…¶ç›¸é‚»å…ƒç´ ï¼Œä¸”åªæœ‰ä¸€ä¸ªé…å¯¹å¯é€‰é¡¹æ—¶ï¼š</p><ul><li>å¦‚æœè¿™ä¸ªæ•°æ˜¯ <span class="math inline">\(d_{i}\)</span>ï¼Œåˆ™ <span class="math inline">\(d_{i+1}\)</span> å¿…é¡»ä¸ç›¸é‚»å…ƒç´ é…å¯¹ã€‚</li></ul><p><span class="math display">\[ f_{i+1,j-1,0}\gets f_{i,j,1}+y \]</span></p>å› ä¸ºåœ¨è®¡ç®— <span class="math inline">\(f_{i,j,1}\)</span> æ—¶å·²è®¡ç®—äº†ä¸€ä¸ª <span class="math inline">\(y\)</span>ï¼Œæ‰€ä»¥æ­¤å¤„åªç”¨åŠ ä¸€ä¸ª <span class="math inline">\(y\)</span>ã€‚<ul><li><p>å¦åˆ™ï¼Œè¯¥å…ƒç´ å®Œæˆé…å¯¹ï¼Œä¸äº§ç”Ÿä»»ä½•ä»£ä»·ã€‚</p><span class="math display">\[ f_{i+1,j-1,0}\gets f_{i,j,0} \]</span></li></ul></li><li><p>å¦åˆ™ï¼Œéšæ„é€‰æ‹©å‰é¢çš„ä¸€ä¸ªæ•°ã€‚</p><p>å› ä¸ºæ­¤æ—¶ï¼Œè¦ä¹ˆå‰é¢æœ‰é™¤äº†ç›¸é‚»å…ƒç´ çš„å…¶ä»–æ•°å¯é€‰ï¼Œè¦ä¹ˆæ ¹æœ¬æ²¡æœ‰ç›¸é‚»å…ƒç´ ï¼Œæ‰€ä»¥è¯¥æ•°å®Œæˆé…å¯¹ä¸ä¼šäº§ç”Ÿä»»ä½•ä»£ä»·ï¼ˆå› ä¸º <span class="math inline">\(y\)</span> å·²ç»åŠ è¿‡äº†ï¼‰ã€‚</p><p><span class="math display">\[ f_{i+1,j-1,0}\gets \min(f_{i,j,0},f_{i,j,1}) \]</span></p></li></ul></li></ul><p>è‡³æ­¤ï¼Œå…¨éƒ¨æƒ…å†µè®¨è®ºå®Œæ¯•ã€‚å› ä¸ºä¸èƒ½è®©æœ€åä¸€ä¸ªå…ƒç´ å†å»ä¸åé¢çš„å…ƒç´ é…å¯¹ï¼Œæœ€ç»ˆç­”æ¡ˆä¸º <span class="math inline">\(f_{tot,0,0}\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(tot\)</span> ä¸º <span class="math inline">\(d\)</span> æ•°ç»„é•¿åº¦ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ï¼Œç©ºé—´å¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ã€‚</p><p>å› ä¸º <span class="math inline">\(x,y\le 10^9\)</span>ï¼Œæœ€åæƒ…å†µä¸‹éœ€è¦åŠ  <span class="math inline">\(\dfrac n2\)</span> æ¬¡ï¼Œæ•…éœ€è¦ä¸º DP æ•°ç»„å¼€ <code>long long</code>ã€‚å°½ç®¡çƒ­å¿ƒäººå£« @<a href="/user/428358">cqbztzl</a> å¸®åŠ©æˆ‘è®¡ç®—å¾—å‡ºä½¿ç”¨ç©ºé—´çº¦ä¸º 300 å…†ï¼Œä½†ä»ç„¶ä¼š MLEã€‚</p><p>ä¸éš¾å‘ç°ï¼Œç¬¬ä¸€ç»´æšä¸¾åˆ° <span class="math inline">\(i\)</span> æ—¶ï¼Œåªéœ€è¦æ›´æ–°ç¬¬ä¸€ç»´ä¸º <span class="math inline">\(i+1\)</span> å’Œ <span class="math inline">\(i+2\)</span> çŠ¶æ€çš„å€¼ï¼Œè€Œä¸éœ€è¦å…¶ä»–ä»»ä½• DP å€¼ï¼Œæ•…å°†ç¬¬ä¸€ç»´æ¨¡ <span class="math inline">\(3\)</span>ï¼Œæ»šåŠ¨ä¸º <span class="math inline">\(0\sim 2\)</span>ã€‚</p><hr /><pre class="cpp"><code>// ä»£ç é‡Œå¯èƒ½æœ‰ä¸€äº›èµ›æ—¶çš„ç¥ç§˜æ³¨é‡Š hhhnamespace XSC062 &#123;using namespace fastIO;const ll inf = 1e18;const int maxn = 5e3 + 5;ll x, y;int T, n, tot;ll f[3][maxn][2];int diff[maxn], a[maxn], b[maxn];ll min(ll x, ll y) &#123;    return x &lt; y ? x : y;&#125;void upd(int i, int j, int k, ll y) &#123;    f[i % 3][j][k] = min(f[i % 3][j][k], y);    return;&#125;int main() &#123;    read(T);    while (T--) &#123;        read(n), read(x), read(y);        tot = 0;        for (int i = 1; i &lt;= n; ++i)            getnum(a[i]);        for (int i = 1; i &lt;= n; ++i) &#123;            getnum(b[i]);            if (a[i] != b[i])                diff[++tot] = i;        &#125;        if (tot &amp; 1) &#123;            puts(&quot;-1&quot;);            continue;        &#125;        memset(f, 0x3f, sizeof (f));        f[0][0][0] = 0;        for (int i = 0; i &lt;= tot; ++i) &#123;            for (int j = 0; j &lt;= i; ++j) &#123;                // æ–°å¢èµ·ç‚¹                if (i + 1 &lt;= tot) &#123;                    upd(i + 1, j + 1, 1,                        min(f[i % 3][j][0],                            f[i % 3][j][1]) + y);                &#125;                // ç¢¾è¿‡å»                 if (i + 2 &lt;= tot) &#123;                    upd(i + 2, j, 0,                        min(f[i % 3][j][0],                            f[i % 3][j][1]) +                            (diff[i + 2] -                            diff[i + 1]) * x);                &#125;                // ä½¿ç”¨èµ·ç‚¹                if (j &gt; 0 &amp;&amp; i + 1 &lt;= tot) &#123;                    if (j == 1 &amp;&amp; diff[i] + 1 ==                                        diff[i + 1]) &#123;                        upd(i + 1, j - 1, 0,                                f[i % 3][j][1] + y);                        upd(i + 1, j - 1, 0,                                f[i % 3][j][0]);                    &#125;                    else &#123;                        upd(i + 1, j - 1, 0,                            min(f[i % 3][j][0],                                f[i % 3][j][1]));                    &#125;                &#125;                if (i != tot) &#123;                    f[i % 3][j][0] =                        f[i % 3][j][1] = inf;                &#125;            &#125;        &#125;        print(f[tot % 3][0][0], &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç‘°ä¸½åå°”å…¹</title>
      <link href="/20230111/"/>
      <url>/20230111/</url>
      
        <content type="html"><![CDATA[<p>Solution to<a href="http://222.180.160.110:61235/problem/8965">ã€ŒNOI2005ã€ç‘°ä¸½åå°”å…¹</a>ã€‚</p><span id="more"></span><hr /><p>å•è°ƒé˜Ÿåˆ—ä¼˜åŒ– DPã€‚</p><p>ä¸éš¾å‘ç°ï¼Œé¢˜æ„å¯è½¬åŒ–ä¸ºï¼š</p><p>ä» <span class="math inline">\((x,y)\)</span> å‡ºå‘ï¼ŒæŒ‰é¡ºåºå‘ <span class="math inline">\(d_i\)</span> æ–¹å‘ç§»åŠ¨ <span class="math inline">\([0,t_iâˆ’s_i+1]\)</span> è·ç¦»ï¼Œé—®æœ€å¤§ç§»åŠ¨è·ç¦»ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œæˆ‘ä»¬æŠŠä¸€æ¬¡ã€Œå‘ <span class="math inline">\(d_i\)</span> æ–¹å‘ç§»åŠ¨ <span class="math inline">\([0,t_iâˆ’s_i+1]\)</span> è·ç¦»ã€çš„æ“ä½œç§°ä¸ºã€Œä¸€æ­¥ã€ã€‚</p><p>è®¾è®¡çŠ¶æ€ã€‚ä¸éš¾å‘ç°ä½ç½®ä¿¡æ¯å¿…é¡»å‡ºç°åœ¨ DP çš„ç»´åº¦ä¸­ï¼ˆå› ä¸ºå½“å‰ä½ç½®ä¼šå½±å“ä¸‹ä¸€æ­¥æ»‘åŠ¨çš„è·ç¦»ï¼‰ï¼Œè€Œå…¶ä»–ä¿¡æ¯å‡ä¸ä¼šå¯¹ä¸‹ä¸€æ­¥æ»‘åŠ¨äº§ç”Ÿå½±å“ã€‚</p><p>æ•…å¯ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºå®Œæˆå½“å‰æ¬¡æ»‘åŠ¨åï¼Œä»èµ·ç‚¹æ»‘åŠ¨åˆ° <span class="math inline">\((i,j)\)</span> å¯å¾—åˆ°çš„æœ€å¤§æ»‘åŠ¨è·ç¦»ã€‚</p><p>ä»¥æ–¹å‘ä¸Šä¸ºä¾‹ï¼Œå¯åˆ— DP å¼ï¼š</p><p><span class="math display">\[f_{i,j}=\max_{i&lt;kâ‰¤i+(tiâˆ’si+1)}\{f_{k,j}+kâˆ’i\}\]</span></p><p>æ­¤æ—¶å¯æšä¸¾æ¯ä¸€åˆ—çš„æ‰€æœ‰çŠ¶æ€ï¼Œä½¿ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚</p><p>ä½†å®é™…æ“ä½œä¸­ä¼šå‡ºç°é—®é¢˜ã€‚å› ä¸ºå•è°ƒé˜Ÿåˆ—ä»ä¸‹å‘ä¸Šæ›´æ–°çŠ¶æ€æ—¶ï¼Œ<span class="math inline">\(f_{k,j}\)</span> ä¼šæ¯” <span class="math inline">\(f_{i,j}\)</span> å…ˆæ›´æ–°ï¼ˆå‚è€ƒ 01 èƒŒåŒ…å€’åºæšä¸¾å®¹é‡ï¼‰ï¼Œå¯¼è‡´æ¯ä¸€ã€Œæ­¥ã€ä¼šé‡å¤è¢«èµ°å¾ˆå¤šæ¬¡ã€‚ä½†å•è°ƒé˜Ÿåˆ—çš„ç‰¹æ€§é™åˆ¶äº†æˆ‘ä»¬åªèƒ½ä»ä¸‹å‘ä¸Šæšä¸¾ï¼Œæ­¤æ—¶å¯æ–°å¼€ä¸€ä¸ªæ•°ç»„è®°å½• <span class="math inline">\(f\)</span> å½“æ¬¡è¢«æ›´æ–°ä¹‹å‰çš„å€¼ã€‚</p><p>éšœç¢ç‰©å¦‚ä½•å¤„ç†å‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœ <span class="math inline">\((i,j)\)</span> ä¸‹é¢æŸä¸€ä½ç½®æœ‰éšœç¢ç‰©ï¼Œé‚£ä¹ˆéšœç¢ç‰©ä¸‹é¢æ‰€æœ‰çš„ <span class="math inline">\((k,j)\)</span> éƒ½ä¸èƒ½ç”¨äºæ›´æ–° <span class="math inline">\(f_{i,j}\)</span>ï¼ˆå› ä¸ºè¢«æŒ¡ä½äº†æ»‘ä¸ä¸Šæ¥ï¼‰ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨ä»ä¸‹å¾€ä¸Šæšä¸¾æ—¶ï¼Œé‡åˆ°éšœç¢ç‰©å°±æ¸…ç©ºå•è°ƒé˜Ÿåˆ—å³å¯ã€‚</p><p>ä¸‹ã€å·¦ã€å³æ–¹å‘çš„å¤„ç†æ–¹å¼ç±»ä¼¼ã€‚</p><p>åªéœ€é¡ºåºæ‰§è¡Œæ“ä½œï¼Œæ ¹æ®å½“å‰æ“ä½œæ–¹å‘å¯¹åº”å¤„ç†å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 205;const int inf = 1e18;int q[maxn];char a[maxn][maxn];int f[maxn][maxn], d[maxn][maxn];int n, m, x, y, k, u, h, t, res;int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;int main() &#123;    memset(f, -0x3f, sizeof (f));    read(n), read(m);    read(x), read(y), read(k);    f[x][y] = 0;    for (int i = 1; i &lt;= n; ++i)        scanf(&quot;%s&quot;, a[i] + 1);    while (k--) &#123;        read(x), read(y), read(u);        y = y - x + 1;        if (u == 1) &#123;            for (int j = 1; j &lt;= m; ++j) &#123;                h = 1, t = 0;                for (int i = n; i; --i) &#123;                    if (a[i][j] == &#39;x&#39;) &#123;                        h = 1, t = 0;                        continue;                    &#125;                    while (h &lt;= t &amp;&amp; q[h] - i &gt; y)                        ++h;                    d[i][j] = f[i][j];                    if (h &lt;= t) &#123;                        f[i][j] = max(f[i][j],                                    d[q[h]][j] + q[h] - i);                    &#125;                    while (h &lt;= t &amp;&amp; d[i][j] + i                                    &gt;= d[q[t]][j] + q[t])                        --t;                    q[++t] = i;                &#125;            &#125;        &#125;        else if (u == 2) &#123;            for (int j = 1; j &lt;= m; ++j) &#123;                h = 1, t = 0;                for (int i = 1; i &lt;= n; ++i) &#123;                    if (a[i][j] == &#39;x&#39;) &#123;                        h = 1, t = 0;                        continue;                    &#125;                    while (h &lt;= t &amp;&amp; i - q[h] &gt; y)                        ++h;                    d[i][j] = f[i][j];                    if (h &lt;= t) &#123;                        f[i][j] = max(f[i][j],                                    d[q[h]][j] + i - q[h]);                    &#125;                    while (h &lt;= t &amp;&amp; d[i][j] - i                                &gt;= d[q[t]][j] - q[t])                        --t;                    q[++t] = i;                &#125;            &#125;        &#125;        else if (u == 3) &#123;            for (int i = 1; i &lt;= n; ++i) &#123;                h = 1, t = 0;                for (int j = m; j; --j) &#123;                    if (a[i][j] == &#39;x&#39;) &#123;                        h = 1, t = 0;                        continue;                    &#125;                    while (h &lt;= t &amp;&amp; q[h] - j &gt; y)                        ++h;                    d[i][j] = f[i][j];                    if (h &lt;= t) &#123;                        f[i][j] = max(f[i][j],                                    d[i][q[h]] + q[h] - j);                    &#125;                    while (h &lt;= t &amp;&amp; d[i][j] + j                                &gt;= d[i][q[t]] + q[t])                        --t;                    q[++t] = j;                &#125;            &#125;        &#125;        else &#123;            for (int i = 1; i &lt;= n; ++i) &#123;                h = 1, t = 0;                for (int j = 1; j &lt;= m; ++j) &#123;                    if (a[i][j] == &#39;x&#39;) &#123;                        h = 1, t = 0;                        continue;                    &#125;                    while (h &lt;= t &amp;&amp; j - q[h] &gt; y)                        ++h;                    d[i][j] = f[i][j];                    if (h &lt;= t) &#123;                        f[i][j] = max(f[i][j],                                    d[i][q[h]] + j - q[h]);                    &#125;                    while (h &lt;= t &amp;&amp; d[i][j] - j                                &gt;= d[i][q[t]] - q[t])                        --t;                    q[++t] = j;                &#125;            &#125;        &#125;        for (int i = 1; i &lt;= n; ++i) &#123;            for (int j = 1; j &lt;= m; ++j)                res = max(res, f[i][j]);        &#125;    &#125;    print(res);    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> DP </tag>
            
            <tag> å•è°ƒé˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>èƒŒå•è¯</title>
      <link href="/20230110/"/>
      <url>/20230110/</url>
      
        <content type="html"><![CDATA[<p>Solution to<a href="http://222.180.160.110:61235/problem/59">ã€ŒSCOI2016ã€èƒŒå•è¯</a>ã€‚</p><span id="more"></span><hr /><p>é¢˜è§£ P3294ã€‚</p><p>æˆ‘ä»¬çœ‹åˆ°å­—å…¸æ ‘è¿™ä¸ªæ ‡ç­¾ï¼Œä¸‹æ„è¯†æƒ³åˆ°äº†å‰ç¼€ã€‚</p><p>ä½†æ˜¯é¢˜ç›®è®©æˆ‘ä»¬æ±‚åç¼€ï¼Œæ‰€ä»¥æˆ‘ä»¬æŠŠæ‰€æœ‰å­—ç¬¦ä¸²å…ˆ <code>reverse</code> ä¸€ä¸‹ï¼Œå°†é—®é¢˜è½¬åŒ–ä¸ºå‰ç¼€ï¼Œæ–¹ä¾¿æè¿°ã€‚</p><hr /><p>æˆ‘ä»¬å‘ç°ï¼Œå› ä¸º <span class="math inline">\(y &lt; x \le n\)</span>ï¼Œæ‰€ä»¥ä¸‰ç§æƒ…å†µçš„èŠ±è´¹æ’åºä¸º <span class="math inline">\(x-y&lt;x&lt;n\times n\)</span>ã€‚</p><p>ä¸éš¾å‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆç®€å•åœ°é€šè¿‡ã€ŒæŠŠæŸå•è¯çš„æ‰€æœ‰å‰ç¼€å•è¯æ”¾åˆ°å®ƒä¹‹å‰ã€æ¶ˆé™¤å¼€é”€ä¸º <span class="math inline">\(n\times n\)</span> çš„æƒ…å†µã€‚æ­¤æ—¶å¼€é”€æœ€åŠ£æƒ…å†µä¸‹ä¸º <span class="math inline">\(\sum\limits_{i=1}^ni &lt; n\times n\)</span>ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œé—®é¢˜åœ¨äºæ€æ ·åœ¨æ»¡è¶³ã€ŒæŠŠæŸå•è¯çš„æ‰€æœ‰å‰ç¼€å•è¯æ”¾åˆ°å®ƒä¹‹å‰ã€çš„æ¡ä»¶ä¸‹ï¼Œæœ€å°åŒ–å¼€é”€ã€‚ä¸éš¾å‘ç°ï¼Œå½“æˆ‘ä»¬å»é™¤ç¬¬ä¸€ç§æƒ…å†µåï¼Œå‰©ä¸‹çš„ <span class="math inline">\(x\)</span> å’Œ <span class="math inline">\(x-y\)</span> éƒ½åŒ…å« <span class="math inline">\(x\)</span> é¡¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åªéœ€è¦æœ€å°åŒ– <span class="math inline">\(\sum -y\)</span> çš„å€¼ï¼Œä¹Ÿå°±æ˜¯æœ€å¤§åŒ– <span class="math inline">\(\sum y\)</span> çš„å€¼ã€‚è€Œ <span class="math inline">\(\sum x\)</span> ä¸ºå®šå€¼ <span class="math inline">\(\sum\limits_{i=1}^ni\)</span>ã€‚</p><p><strong>å…³äºå¤„ç†æ–¹å¼ï¼šä¸éš¾å‘ç°ä¸€ä¸ªå•è¯çš„æœ€é•¿å‰ç¼€å•è¯æœ€å¤šåªæœ‰ä¸€ä¸ªï¼Œä½†ä»¥è¯¥å•è¯ä¸ºæœ€é•¿å‰ç¼€å•è¯çš„å•è¯å¯èƒ½æœ‰å¤šä¸ªï¼Œè”æƒ³åˆ°æ ‘ã€‚</strong></p><p><strong>æˆ‘ä»¬å°†æ¯ä¸ªå•è¯çš„æœ€é•¿å‰ç¼€å’Œè¯¥å•è¯è¿è¾¹ï¼Œä¼šå¾—åˆ°ä¸€ä¸ªæ£®æ—ã€‚</strong></p><p>ä¸å¦¨å…ˆè€ƒè™‘é—®é¢˜çš„ç®€åŒ–ï¼Œå‡è®¾æœ‰ä¸¤æ¡é“¾ï¼ˆå³ï¼Œä¸ä¼šåŒæ—¶å­˜åœ¨å¤šä¸ªå•è¯ï¼Œä½¿å¾—å®ƒä»¬çš„æœ€é•¿å‰ç¼€å•è¯ç›¸åŒï¼‰ï¼Œåº”è¯¥å¦‚ä½•å®‰æ’å…¶é¡ºåºã€‚</p><p>å¦‚å›¾æ‰€ç¤ºï¼Œè€ƒè™‘ã€ŒåŒä¸€æ¡é“¾å‡åŒ€åˆ†æ•£åˆ°åºåˆ—ä¸­ã€å’Œã€ŒåŒä¸€æ¡é“¾é›†ä¸­åœ¨ä¸€èµ·ã€ä¸¤ç§æœ‰è§„å¾‹çš„å®‰æ’æ–¹å¼ï¼Œå¾—åˆ°ï¼š</p><p><img src="1.jpg" /></p><p>å¯ä»¥å‘ç°ï¼Œç¬¬äºŒç§æƒ…å†µæ˜æ˜¾æ›´ä¼˜ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬æ‰©å±•çŒœæƒ³ï¼šå¯¹äºæŸä¸€å•è¯ï¼Œä»¥å®ƒä¸ºå‰ç¼€çš„æ‰€æœ‰å•è¯å¿…é¡»ç´§éšå…¶åã€‚è¯¥ç»“è®ºæ˜¯å¯é€’å½’çš„ã€‚</p><p>ç»§ç»­å¤„ç†ç»†èŠ‚éƒ¨åˆ†ã€‚è€ƒè™‘ä¸¤æ¡é“¾é•¿åº¦ä¸åŒï¼Œåº”å¦‚ä½•æ’åˆ—å®ƒä»¬çš„ä½ç½®ï¼Ÿ</p><p>ä¸‹å›¾å±•ç¤ºäº†ã€Œå‰çŸ­åé•¿ã€å’Œã€Œå‰é•¿åçŸ­ã€ä¸¤ç§æ–¹æ¡ˆï¼š</p><p><img src="2.jpg" /></p><p>å¯ä»¥å‘ç°ï¼Œå‰çŸ­åé•¿çš„æ–¹æ¡ˆæ›´ä¼˜ã€‚</p><p>æ‰©å±•å¾—åˆ°çŒœæƒ³ï¼ŒåŒä¸€å•è¯çš„æ‰€æœ‰å­æ ‘ä¸­ï¼Œå¤§å°æ›´å°çš„åº”åœ¨æ›´å‰é¢ã€‚è¯¥ç»“è®ºæ˜¯å¯é€’å½’çš„ã€‚</p><hr /><p>æ¥ä¸‹æ¥å¯¹çŒœæƒ³è¿›è¡Œè¯æ˜ã€‚</p><p>å‡è®¾ç°åœ¨å·²æœ‰ä¸€æ¡é“¾ã€‚æˆ‘ä»¬åªæœ‰æŠŠæ•´æ¡é“¾è¿åœ¨ä¸€èµ·ï¼ŒçŸ­å•è¯æ”¾åˆ°é•¿å•è¯å‰é¢è¿™ä¸€ç§æ–¹æ³•ã€‚</p><p>ç„¶åæ–°æ¥äº†ä¸€ä¸ªä¸å±äºè¿™æ¡é“¾çš„èŠ‚ç‚¹ï¼Œæ˜æ˜¾ï¼Œå› ä¸ºèŠ‚ç‚¹ä¸ç®¡æ”¾åˆ°å“ªé‡Œï¼Œå…¶ <span class="math inline">\(y\)</span> å€¼ä¸å˜ï¼Œä½†ä¼šæ”¹å˜å·²æœ‰é“¾çš„ <span class="math inline">\(y\)</span> å€¼ï¼Œæ‰€ä»¥æ”¾åˆ°æœ€å‰é¢æœ€ä¼˜ã€‚</p><p>åˆæ¥äº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå’Œåˆšæ‰æ–°å¢çš„èŠ‚ç‚¹å±äºåŒä¸€æ¡é“¾ï¼Œä¸€æ ·ï¼Œä¸ç®¡è¿™ä¸ªèŠ‚ç‚¹ä½•å»ä½•ä»ï¼Œå…¶ <span class="math inline">\(y\)</span> ä¸å˜ï¼Œä½†æ”¾åœ¨è¶Šå‰é¢ï¼Œåé¢çš„èŠ‚ç‚¹çš„ <span class="math inline">\(y\)</span> å€¼å¢åŠ å¾—è¶Šå¤šã€‚</p><p>ä»¥æ­¤ç±»æ¨å¯å¾—åˆ°ç»“è®ºï¼ŒåŒä¸€æ¡é“¾æ”¾åˆ°ä¸€èµ·ã€‚çŸ­é“¾æ”¾åˆ°é•¿é“¾å‰é¢ä¹Ÿæ˜¯æ¯”è¾ƒå¥½æƒ³çš„ã€‚å‡è®¾æœ‰ä¸¤æ¡é“¾ï¼ŒçŸ­é“¾é•¿åº¦ä¸º <span class="math inline">\(a\)</span>ï¼Œé•¿é“¾é•¿åº¦ä¸º <span class="math inline">\(b\)</span>ï¼Œæ”¾ç½®èµ·ç‚¹ä¸º <span class="math inline">\(l\)</span>ï¼Œåˆ™å‰çŸ­åé•¿å’Œé’±é•¿åçŸ­çš„ y ä¹‹å’Œåˆ†åˆ«ä¸º <span class="math inline">\(\dfrac{(l + l + a - 2) \times (a - 1) + (l + a + l + a + b - 2) \times (b - 1)} 2\)</span> å’Œ <span class="math inline">\(\dfrac{(l + l + b - 2) \times (b - 1) + (l + b + l + b + a - 2) \times (b - 1)} 2\)</span>ï¼ˆè¿ç”¨ç­‰å·®æ•°åˆ—æ±‚å’Œå…¬å¼ï¼‰ï¼Œè§£ä¸ç­‰å¼å¯å¾—å‰çŸ­åé•¿ä¸€å®šæ›´ä¼˜ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯ä»é“¾æ‰©å±•åˆ°æ ‘ã€‚é‚£ä¹ˆæˆ‘ä»¬æƒ³åˆ°äº†ä»€ä¹ˆï¼Ÿæ ‘é“¾å‰–åˆ†ã€‚</p><p>æˆ‘ä»¬åŒ–ç”¨æ ‘å‰–æ€æƒ³ï¼Œä»¥æœ€è½»è¾¹ä¸ºå‰–åˆ†æ¡ä»¶ï¼Œå°†æ ‘åˆ’åˆ†ä¸ºæœ‰é¡ºåºçš„é“¾ï¼ŒæŒ‰ç…§ä¸Šè¿°æ–¹å¼æ’åˆ—å…¶é¡ºåºå³å¯ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬è®°å½•ä¸‹æ¯ä¸ªå•è¯çš„ç›´ç³»çˆ¶äº²ï¼ˆå³å…¶æœ€é•¿å‰ç¼€å•è¯ï¼‰ï¼Œåœ¨å”¯ä¸€åºåˆ—ä¸­æ¨¡æ‹Ÿè®¡åˆ†æ“ä½œï¼Œå³å¯å¾—åˆ°ç­”æ¡ˆã€‚</p><hr /><p>ä¸ºäº†æ–¹ä¾¿ï¼Œå¯å°†æ‰€æœ‰å…¥åº¦ä¸º <span class="math inline">\(0\)</span> çš„ç‚¹ä¸ä¸€ä¸ªè™šç‚¹ç›¸è¿ï¼Œå°†æ£®æ—è½¬åŒ–ä¸ºæ ‘ã€‚</p><p>æ³¨æ„ <code>long long</code>ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;using str = std::string;const int maxn = 1e6 + 5;const int maxm = 1e6 + 5;str s[maxn];int T[maxm][26];int kaz[maxn], siz[maxn]; // kaz è¡¨ç¤ºå•è¯åœ¨æœ€ç»ˆåºåˆ—ä¸­æ‰€å¤„çš„ä½ç½®std::vector&lt;int&gt; g[maxn];int n, l, res, cnt = 1, ti;int tot[maxm], fa[maxn], deg[maxn];void Insert(int k) &#123;     int f = 1, len = s[k].length();    for(int i = 0; i &lt; len; ++i) &#123;        if (!T[f][s[k][i] - &#39;a&#39;])             T[f][s[k][i] - &#39;a&#39;] = ++cnt;        f = T[f][s[k][i]-&#39;a&#39;];    &#125;    tot[f] = k;    return;&#125;void Search(int k) &#123;    int f = 1;    int len = s[k].length();    for (int i = 0; i &lt; len; ++i) &#123;        f = T[f][s[k][i] - &#39;a&#39;];        if (tot[f]) &#123;            if (tot[f] != k)                fa[k] = tot[f]; // è®°å½•å½“å‰æœ€é•¿å‰ç¼€        &#125;    &#125;    return;&#125;void add(int x, int y) &#123;    ++deg[y];    g[x].push_back(y);    return;&#125;void DFS1(int x) &#123; // æå‰è®¡ç®—æ¯ä¸ªå­æ ‘çš„ size    siz[x] = 1;    for (auto i : g[x]) &#123;        DFS1(i);        siz[x] += siz[i];    &#125;    return;&#125;void DFS2(int x) &#123;    kaz[x] = ti++;  // æ—¶é—´æˆ³å³ä¸ºå•è¯ä½ç½®    std::sort(g[x].begin(), g[x].end(),        [&amp;](int x, int y) &#123; return siz[x] &lt; siz[y]; &#125;); // æŒ‰å­æ ‘ size æ’åº    for (auto i : g[x])        DFS2(i);    return;&#125;int main() &#123;    scanf(&quot;%lld&quot;, &amp;n);    for (int i = 1; i &lt;= n; ++i) &#123;        std::cin &gt;&gt; s[i];        std::reverse(s[i].begin(), s[i].end());  // åç¼€è½¬å‰ç¼€        Insert(i);        res += i;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        Search(i);        if (fa[i])            add(fa[i], i); // å»ºå›¾    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        if (!deg[i]) // å»ºè™šç‚¹æ–¹ä¾¿æ“ä½œ            add(n + 1, i), fa[i] = n + 1;    &#125;    DFS1(n + 1), DFS2(n + 1);    for (int i = 1; i &lt;= n; ++i)        res -= kaz[fa[i]]; // å¤„ç† y å€¼    print(res);    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> å­—å…¸æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£é¢˜æŠ¥å‘Š åšå¼ˆ</title>
      <link href="/20221010/"/>
      <url>/20221010/</url>
      
        <content type="html"><![CDATA[<p>è€é¢˜è§£æ‰¹é‡è¡¥æ¡£ã€‚</p><span id="more"></span><hr /><blockquote><p>ç»™å®šä¸€æ£µå¸¦æƒæ ‘ï¼Œå°† <span class="math inline">\((u,v)\)</span> é—´ç®€å•è·¯å¾„ä¸Šçš„è¾¹æƒç”Ÿæˆæ•°ç»„ï¼Œä¸¤ä¸ªäººåœ¨æ•°ç»„ä¸­è½®æµé€‰æ•°ï¼Œæ¯æ¬¡é€‰èµ°çš„æ•°å¿…é¡» <span class="math inline">\(\le\)</span> ä¸Šä¸€ä¸ªäººé€‰èµ°çš„æ•°ï¼Œä¸èƒ½é€‰çš„äººè¾“ï¼Œé—®æœ‰å¤šå°‘ä¸ª <span class="math inline">\((u,v)\)</span> æ»¡è¶³å…ˆæ‰‹å¿…èƒœã€‚</p></blockquote><p>å¦‚æœåœ¨ <span class="math inline">\((u, v)\)</span> çš„è·¯å¾„ä¸Šæœ‰ä»»ä½•ä¸€ç§è¾¹æƒçš„æ•°é‡æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆå°±è¦ç»Ÿè®¡ <span class="math inline">\((u,v)\)</span>ã€‚</p><p>å¯¹äºæœ€å°çš„ã€å‡ºç°æ¬¡æ•°ä¸ºå¥‡æ•°çš„è¾¹æƒ <span class="math inline">\(w\)</span>ï¼Œå…ˆæ‰‹é€‰æ‹© <span class="math inline">\(w\)</span>ï¼Œæ­¤æ—¶å‰©ä¸‹å¶æ•°ä¸ªå¯é€‰é¡¹ã€‚åæ‰‹é€‰æ‹© <span class="math inline">\(w&#39;\)</span>ï¼Œè¿™ä¼šåˆ é™¤ <span class="math inline">\(&gt;w&#39;\)</span> ä¸” <span class="math inline">\(\le w\)</span> çš„æ‰€æœ‰å¯é€‰é¡¹ã€‚å‘ç°è¢«åˆ æ‰å¶æ•°ä¸ªé€‰é¡¹ï¼›å‰©ä¸‹å¥‡æ•°ä¸ªé€‰é¡¹ã€‚æ˜“çŸ¥å…ˆæ‰‹å¿…èƒœã€‚</p><p>è‹¥ä¸å­˜åœ¨å‡ºç°æ¬¡æ•°ä¸ºå¥‡æ•°çš„è¾¹æƒï¼Œä»åˆšåˆšåæ‰‹çš„å¤„å¢ƒå¯ä»¥çœ‹å‡ºå…ˆæ‰‹å¿…è´¥ã€‚æ‰€ä»¥ï¼Œé—®é¢˜å°±è½¬åŒ–ä¸ºäº†ï¼šç»Ÿè®¡ç‚¹å¯¹ <span class="math inline">\((u, v)\)</span> çš„æ•°é‡ï¼Œæ»¡è¶³ <span class="math inline">\(u\)</span> åˆ° <span class="math inline">\(v\)</span> çš„ç®€å•è·¯å¾„ä¸­å­˜åœ¨å‡ºç°æ¬¡æ•°ä¸ºå¥‡æ•°çš„è¾¹æƒã€‚</p><p>ç»™æ¯ä¸ªè¾¹æƒæ˜ å°„ä¸€ä¸ªå€¼ï¼Œä¸º <code>base</code> çš„ <code>rand()</code> æ¬¡æ–¹ï¼Œè‡ªç„¶æº¢å‡ºå³å¯ã€‚ç„¶åç›´æ¥æŒ‰ç…§ä¹‹å‰çš„æ“ä½œå¤„ç†å°±å¥½äº†ã€‚</p><p>å¦‚æœä¸€ä¸ªä½ æƒ³æ‰¾åˆ°ç±»ä¼¼äº <code>1 ^ 2 ^ 3 = 0</code> çš„æƒ…å†µï¼Œå…¶å‡ºç°æ¦‚ç‡ä¸æ•°å­—çš„äºŒè¿›åˆ¶ä½æ•°æœ‰å…³ã€‚å› ä¸º <code>xor</code> åªé’ˆå¯¹äºåŒä¸€ä½ï¼Œç»“æœä¸ä¼šè¢«ä¸Šä¸€ä½æˆ–ä¸‹ä¸€ä½å¹²æ‰°ï¼Œæ‰€ä»¥æ¯ä¸€ä½å‡ºç°å¼‚æˆ–èµ·æ¥ä¸º <span class="math inline">\(0\)</span> çš„æ¦‚ç‡æ˜¯ <span class="math inline">\(\dfrac 12\)</span>ã€‚åªè¦æˆ‘ä»¬æ•´ç‚¹æ¯”è¾ƒå¼ºåŠ›çš„ <span class="math inline">\(k\)</span> ä½äºŒè¿›åˆ¶æ•°ï¼Œé‚£ä¹ˆå‡ºç°ä»¥ä¸Šæƒ…å†µçš„æ¦‚ç‡å°±æ˜¯ <span class="math inline">\(2^{-k}\)</span>ã€‚</p><p>é‚£ä¹ˆè¿™ä¸ªæ¯”è¾ƒå¼ºåŠ›çš„ <span class="math inline">\(k\)</span> ä½äºŒè¿›åˆ¶æ•°ï¼Œç”¨æ¯”è¾ƒå¼ºåŠ›çš„ç±»å­—ç¬¦ä¸²å“ˆå¸Œç”Ÿæˆæ–¹å¼ï¼Œå†ä½¿ç”¨ä¸€ä¸ªå¾ˆå¤§å¾ˆå¤§çš„éšæœºæ•°æ›¿ä»£å­—ç¬¦ä¸²å“ˆå¸Œä¸­è¡¨ç¤ºä¸‹æ ‡çš„ <span class="math inline">\(i\)</span>ï¼Œç”¨è‡ªç„¶æº¢å‡ºè®©å®ƒæ˜¾å¾—æ›´åŠ ç¨³å¦¥å°±å¥½ã€‚æ‰€ä»¥ç°åœ¨æˆ‘ä»¬ç¨‹åºå¯„æ‰çš„æ¦‚ç‡å°±æ˜¯ <span class="math inline">\(\dfrac 1{2^{64}}\)</span>ï¼Œå¥½äº‹æƒ…å•Šå¥½äº‹æƒ…ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(\mathcal O(n\log n)\)</span>ï¼Œ<span class="math inline">\(\log n\)</span> æ¥æºäºæ˜ å°„ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int _p = 13331;const int maxn = 5e5 + 5;struct _ &#123;    int v;    ull w;    _ () &#123;&#125;    _ (int v1, ull w1) &#123;        v = v1, w = w1;    &#125;&#125;;ull w;ull f[maxn];int T, n, x, y, ans;std::map&lt;ull, int&gt; t;std::map&lt;ull, ull&gt; q;std::vector&lt;_&gt; g[maxn];inline void Init(int n) &#123;    t.clear();    q.clear();    for (int i = 1; i &lt;= n; ++i) &#123;        f[i] = 0;        g[i].clear();        g[i].shrink_to_fit();    &#125;    return;&#125;void DFS(int x, int fa) &#123;    ++t[f[x]];    for (auto i : g[x]) &#123;        if (i.v == fa)            continue;        f[i.v] = f[x] ^ i.w;        DFS(i.v, x);    &#125;    return;&#125;inline void add(int x, int y, ull w) &#123;    g[x].push_back(_(y, w));    return;&#125;inline ull randint(void) &#123;    ull res = rand();    res *= rand();    res *= rand();    return res;&#125;inline ull qkp(ull x, ull y) &#123;    ull res = 1;    while (y) &#123;        if (y &amp; 1)            res *= x;        x *= x;        y &gt;&gt;= 1;    &#125;     return res;&#125;int main() &#123;    read(T);    srand(time(NULL));    while (T--) &#123;        read(n);        Init(n);        ans = n * (n - 1) / 2;        for (int i = 1; i &lt; n; ++i) &#123;            read(x), read(y), read(w);            if (!q.count(w))                q[w] = qkp(_p, randint());            w = q[w];            add(x, y, w), add(y, x, w);        &#125;        DFS(1, -1);        for (auto i : t)            ans -= i.second * (i.second - 1) / 2;        print(ans, &#39;\n&#39;);    &#125;    return 0;&#125;&#125; // namespace XSC062</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> å“ˆå¸Œ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ‚¬çº¿æ³•</title>
      <link href="/20220927/"/>
      <url>/20220927/</url>
      
        <content type="html"><![CDATA[<p>æœ‰ä¸€æ®µæ—¶é—´çœ‹è§å•è°ƒæ ˆå°±æŠ‘éƒï¼Œæ‰€ä»¥åšé¢˜çš„æ—¶å€™å°±ä¸œè´ºè´ºï¼Œè¥¿è´ºè´ºï¼Œæœ€ç»ˆäº†è§£åˆ°äº†ä¸–ç•Œä¸Šè¿˜æœ‰ä¸€ç§å¾ˆç¥å¥‡çš„æ–¹æ³•å«æ‚¬çº¿æ³•ã€‚</p><span id="more"></span><p>æœ¬æ–‡ä¸­çš„ã€Œå•è°ƒæ ˆã€å‡æŒ‡ä¾èµ–äºé¡ºåºç»´æŠ¤ä¿¡æ¯çš„å·¥å…·ï¼Œå•çº¯åˆ©ç”¨å•è°ƒæ€§è´¨ä½œä¸ºæ•°æ®ç»“æ„ç‹¬ç«‹å­˜åœ¨çš„å•è°ƒæ ˆä¸åœ¨æœ¬ç¯‡æ–‡ç«  <strong>æ‰¹åˆ¤</strong> èŒƒå›´ä¹‹å†…ã€‚</p><hr /><h2 id="å¼•å…¥åœŸè±ªèªè¦è¯·å®¢">å¼•å…¥ï¼šåœŸè±ªèªè¦è¯·å®¢</h2><p><a href="http://222.180.160.110:61235/contest/2870/problem/4" class="uri">http://222.180.160.110:61235/contest/2870/problem/4</a></p><p>é¢˜æ„ç®€è¿°ï¼šç»™å®šä¸€ä¸ª <span class="math inline">\(n\times m\)</span> çš„çŸ©é˜µï¼Œå…¶ä¸­æœ‰ä¸€éƒ¨åˆ†åœ°æ–¹æœ‰éšœç¢ã€‚åœ¨æ•´ä¸ªåœ°å›¾ä¸Šæ‰¾åˆ°å‘¨é•¿æœ€å¤§çš„ã€ä¸åŒ…å«éšœç¢çš„çŸ©å½¢ã€‚</p><p>è¾“å…¥ä¸€ä¸ªç”± <code>.</code>ï¼ˆç©ºåœ°ï¼‰å’Œ <code>X</code>ï¼ˆéšœç¢ï¼‰ç»„æˆçš„çŸ©é˜µï¼Œè¾“å‡ºæœ€å¤§çŸ©å½¢å‘¨é•¿å‡ <span class="math inline">\(1\)</span>ã€‚</p><details><p><summary>ä¸€äº›é²œèŠ±</summary></p><p>çœ‹åˆ°é¢˜åå³å¯æƒ³åˆ°æ‚¬çº¿æ³•ï¼Œä½†æ˜¯ä¸­åˆå¤ªå›°äº†å¤„äºæ¸¸ç¦»çŠ¶æ€ä¸€ç›´æ‰çº¿ï¼Œæ‰€ä»¥å¹²çªç€ç”µè„‘å±å¹•æ‰“çŒç¡ã€‚</p><p><del>äºæ˜¯è¿™ç¯‡æ–‡ç« ä» 220927 è¢«æ‹–åˆ°äº† 230916ï¼Œå“ˆå“ˆçœŸç¥å¥‡</del> ç°åœ¨æ˜¯ 231004 äº†ï¼Œæˆ‘æ‰åŠ¨ç¬”ã€‚</p></details><hr /><p>é¦–å…ˆé¢„å¤„ç†å‡º <span class="math inline">\(s_{i, j}\)</span>ï¼Œè¡¨ç¤ºä» <span class="math inline">\((i,\,j)\)</span> å‘ä¸Šï¼Œå…±æœ‰å¤šå°‘ä¸ªè¿ç»­çš„ <code>.</code>ã€‚</p><pre class="cpp"><code>for (int i = 1; i &lt;= n; ++i) &#123;    for (int j = 1; j &lt;= m; ++j)        s[i][j] = (a[i][j] == &#39;.&#39; ? s[i - 1][j] + 1 : 0);&#125;</code></pre><p>æ‚¬çº¿æ³•çš„åå­—å¾ˆå½¢è±¡ï¼Œæ‹ç€ä¸€æ ¹ç»†çº¿çš„å¤´ï¼Œè®©å®ƒè‡ªç„¶ä¸‹å‚ã€‚</p><p>ä¸ºäº†æ–¹ä¾¿æ€è€ƒå’Œå®ç°ï¼Œæˆ‘ä»¬è¿™æ ·æƒ³è±¡ï¼šä¸€ä¸ªåœ°å›¾ï¼Œæˆ‘ä»¬æ‰‹é‡Œæ‹¿ç€ä¸€æ ¹ç¡¬æ£’æœä¸Šä¸¾ï¼Œç„¶åå›ºå®šæˆ‘ä»¬æ‰‹åªèƒ½åœ¨ä¸€è¡Œä¸Šè¿åŠ¨ï¼Œç”¨å®ƒå·¦å³ã€Œåˆ·ã€æ²¿é€”çš„çŸ©å½¢ã€‚</p><p>å…·è±¡åœ°è¯´ï¼Œé€‰å®šä¸€è¡Œ <span class="math inline">\(i\)</span>ï¼Œæšä¸¾æ¯ä¸€ä¸ª <span class="math inline">\(j\)</span>ï¼Œå¯»æ‰¾ä»¥ç¬¬ <span class="math inline">\(i\)</span> è¡Œä¸ºåº•ï¼ŒåŒ…å« <span class="math inline">\((i,\,j)\)</span>ï¼Œé«˜ä¸º <span class="math inline">\(s_{i,\,j}\)</span> çš„æœ€å®½çŸ©å½¢ã€‚</p><p>ä¹Ÿå°±æ˜¯ä» <span class="math inline">\((i, j)\)</span> å‡ºå‘ï¼Œå¾€å·¦å³åˆ†åˆ«æ‰¾åˆ°æœ€è¿œçš„ä¸€ä¸ªä½ç½® <span class="math inline">\(L_j, R_j\)</span>ï¼Œæ»¡è¶³ <span class="math inline">\(s_{i, L_j \sim R_j} \ge s_{i, j}\)</span>ã€‚é‚£ä¹ˆæ‚¬çº¿æ³•æœ€æŠ½è±¡çš„éƒ¨åˆ†å°±è®²å®Œäº†ï¼Œæ¥ä¸‹æ¥æ˜¯æœ€ç¥å¥‡çš„éƒ¨åˆ†ã€‚</p><p>åœ¨ç¬¬ <span class="math inline">\(i\)</span> è¡Œå†…ï¼Œä»æ¯ä¸ª <span class="math inline">\((i, j)\)</span> å¼€å§‹æ‰¾åˆ° <span class="math inline">\(L_j, R_j\)</span>ï¼Œå¦‚æœæš´åŠ›é‚£ä¹ˆæ˜æ˜¾æ˜¯ä¸ª <span class="math inline">\(O(m^2)\)</span> çš„æ—¶é—´ã€‚</p><p>ä½†æ˜¯æˆ‘ä»¬è€ƒè™‘è¿™ä¹ˆä¸€ä»¶äº‹æƒ…ã€‚å‡è®¾ <span class="math inline">\(L_{i-1}\)</span> å·²ç»æ±‚å‡ºã€‚</p><p>ä»¤ <span class="math inline">\(k = j-1\)</span>ï¼Œ<span class="math inline">\(L_j\)</span> åˆå€¼èµ‹ä¸º <span class="math inline">\(j\)</span>ï¼ˆå·¦ç«¯ç‚¹è‡³å°‘æ˜¯è‡ªå·±ï¼‰ã€‚</p><ol type="1"><li>å½“ <span class="math inline">\(L_j=1\)</span> æ—¶ å³åˆ»åœæ­¢ç®—æ³•ï¼Œå› ä¸º <span class="math inline">\(1\)</span> æ˜¯å¯è¾¾çš„æœ€å·¦ä½ç½®ï¼Œä¸èƒ½å†å¾€å·¦äº†ã€‚</li><li>å½“ <span class="math inline">\(a_k &gt; a_j\)</span> æ—¶ <span class="math inline">\(a_k\)</span> å°±åƒä¸€å µå¢™ï¼Œå µä½äº†æˆ‘ä»¬è¦ç»§ç»­å¾€å·¦åˆ·çš„ç¡¬æ£’ï¼Œæ•…ä¸æ”¹å˜ <span class="math inline">\(L_j\)</span> å¹¶åœæ­¢ç®—æ³•ã€‚</li><li>å¦åˆ™ï¼Œç”±äº <span class="math inline">\(a_{L_k\sim k}\ge a_k\ge a_j\)</span>ï¼Œä» <span class="math inline">\(j\)</span> å¼€å§‹å¾€å·¦åˆ·è‡³å°‘éƒ½èƒ½å¤Ÿåˆ° <span class="math inline">\(L_k\)</span>ã€‚æ­¤æ—¶æˆ‘ä»¬ä»¤ <span class="math inline">\(k=L_k-1\)</span>ï¼Œå›åˆ°ç¬¬ä¸€æ­¥ã€‚</li></ol><p>æˆ‘ä»¬å°±å¯ä»¥æ±‚è§£åˆ°æ­£ç¡®çš„ <span class="math inline">\(L_j\)</span> çš„ã€‚æ±‚è§£ <span class="math inline">\(R_j\)</span> çš„æµç¨‹å’Œä¸Šè¿°å¤§è‡´ç›¸åŒï¼Œä¸å†èµ˜è¿°ã€‚</p><hr /><p>é‚£ä¹ˆæ˜¯ä¸€ä¸ªéå¸¸ç¥å¥‡çš„äº‹æƒ…ã€‚æ‚¬çº¿æ³•çš„æ—¶é—´å¤æ‚åº¦æ€ä¹ˆè¯æ˜å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬æ€è€ƒã€‚å‡è®¾ <span class="math inline">\(a_{j-1}&gt;a_j\)</span>ï¼Œç®—æ³•ä¼šå³åˆ»åœæ­¢ï¼›å¦åˆ™ï¼Œå½“å‰å®šä½ç›´æ¥è·³åˆ° <span class="math inline">\(L_{j-1}\)</span> ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ºäº†æ±‚è§£ <span class="math inline">\(L_{j-1}\)</span> è€Œéå†è¿‡çš„ä½ç½®ï¼Œæ±‚è§£ <span class="math inline">\(L_j\)</span> æ—¶éƒ½ä¸ä¼šå†éå†ç¬¬äºŒéã€‚</p><p>æ²¡æœ‰å€¼ä¼šè¢«éå†ç¬¬äºŒéï¼Œæ‰€ä»¥æ˜¯ <span class="math inline">\(O(m)\)</span> çš„ã€‚</p><hr /><p>æŒ‰ç…§ä¸Šè¿°æµç¨‹ï¼Œç®—æ³•æ€»ä½“æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(O(n\times m)\)</span>ï¼Œå’Œå•è°ƒæ ˆå®Œå…¨ä¸€è‡´ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 2e3 + 5;int n, m, ans;char a[maxn][maxn];int s[maxn][maxn], l[maxn][maxn], r[maxn][maxn];int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;int main() &#123;    read(n);    read(m);    for (int i = 1; i &lt;= n; ++i)        scanf(&quot;%s&quot;, a[i] + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j)            s[i][j] = (a[i][j] == &#39;.&#39; ? s[i - 1][j] + 1 : 0);    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j) &#123;            l[i][j] = j;            while (l[i][j] &gt; 1 &amp;&amp; s[i][j] &lt;= s[i][l[i][j] - 1])                l[i][j] = l[i][l[i][j] - 1];        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = m; j; --j) &#123;            r[i][j] = j;            while (r[i][j] &lt; m &amp;&amp; s[i][j] &lt;= s[i][r[i][j] + 1])                r[i][j] = r[i][r[i][j] + 1];        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j) &#123;            if (!s[i][j])                continue;            ans = max(ans, (s[i][j] +                      (r[i][j] - l[i][j] + 1)) * 2);        &#125;    &#125;    printf(&quot;%d&quot;, ans - 1);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><p>ä¸Šè¿°å¤„ç† <span class="math inline">\(s\)</span> æ•°ç»„çš„ã€Œç«–å‘å‹ç¼©ã€æŠ€å·§æ˜¯å¤„ç†çŸ©é˜µç±»æ‚¬çº¿æ³•é¢˜ç›®çš„å¸¸ç”¨æŠ€å·§ï¼Œè¿™é‡Œä½¿ç”¨å¦ä¸€é“é¢˜æ¥ä¸¾ä¾‹å­ã€‚</p><h3 id="ä¾‹ç‰èŸ¾å®«-city-game-åŸå¸‚æ¸¸æˆ">ä¾‹ï¼šç‰èŸ¾å®« / City Game / åŸå¸‚æ¸¸æˆ</h3><p><a href="http://222.180.160.110:61235/contest/1655/problem/2" class="uri">http://222.180.160.110:61235/contest/1655/problem/2</a></p><p>è¿™é“é¢˜å’Œä¸Šä¸€é“éå¸¸ç›¸ä¼¼ï¼Œåªéœ€æ”¹å˜æ±‚ç­”æ¡ˆçš„å¼å­å³å¯ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 1e3 + 5; char t;int n, m, ans;int s[maxn][maxn];int l[maxn][maxn], r[maxn][maxn];int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;int main() &#123;    scanf(&quot;%d %d&quot;, &amp;n, &amp;m);    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 1; j &lt;= m; ++j) &#123;            scanf(&quot;%1s&quot;, &amp;t);            if (t == &#39;F&#39;)                s[i][j] = s[i - 1][j] + 1;            l[i][j] = j;            while (l[i][j] &gt; 1 &amp;&amp; s[i][j]                        &lt;= s[i][l[i][j] - 1])                l[i][j] = l[i][l[i][j] - 1];        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        r[i][m + 1] = m + 1;        for (int j = m; j; --j) &#123;            r[i][j] = j;            while (r[i][j] &lt; m &amp;&amp; s[i][j]                         &lt;= s[i][r[i][j] + 1])                r[i][j] = r[i][r[i][j] + 1];            ans = max(ans, s[i][j] *                        (r[i][j] - l[i][j] + 1));        &#125;    &#125;    print(ans * 3, &#39;\n&#39;);    return 0;&#125;&#125; // namespace XSC062</code></pre></details><hr /><h2 id="æ‚¬çº¿æ³•èƒ½ç»´æŠ¤çš„æ•°æ®ç‰¹ç‚¹">æ‚¬çº¿æ³•èƒ½ç»´æŠ¤çš„æ•°æ®ç‰¹ç‚¹</h2><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ‚¬çº¿æ³•ä»…æŒ‡æ±‚è§£æœ€è¿œå·¦å³ç«¯ç‚¹çš„æŠ€å·§ã€‚</p><p>åŒæ—¶å¯ä»¥ç»´æŠ¤è¿‡ç¨‹ä¸­çš„å…¶å®ƒä¿¡æ¯ï¼Œä¾‹å¦‚ <a href="/20231004">æƒ…æ™¯å‰§</a> ä¸€é¢˜ã€‚é“¾æ¥ä¸­æœ‰è¯¦ç»†å™è¿°ï¼Œæ­¤å¤„ç•¥ã€‚</p><p>æ ¹æ®æœ¬é¢˜å¸¦æ¥çš„å¯å‘ï¼Œæˆ‘ä»¬è®¤è¯†åˆ°æ‚¬çº¿å¯åœ¨æ±‚è§£è¿‡ç¨‹ä¸­ç»´æŠ¤çš„å†…å®¹æ›´å¤šã€‚</p><p><del>ä¸åƒä½ å•è°ƒæ ˆéšéšä¾¿ä¾¿åˆ è¿™åˆ é‚£ä¿¡æ¯å…¨éƒ¨æ–­å±‚ä»€ä¹ˆéƒ½ç»´æŠ¤ä¸äº†</del></p><hr /><h2 id="è¿›ä¸€æ­¥åœ°æ‚¬çº¿æ³•ä¸å•è°ƒæ ˆ">è¿›ä¸€æ­¥åœ°ï¼Œæ‚¬çº¿æ³•ä¸å•è°ƒæ ˆï¼Ÿ</h2><p>å’Œ <span class="citation" data-cites="Rosmist">@Rosmist</span> è¾©ç»çš„æ—¶å€™ï¼ŒRosmist æ¿€æƒ…çˆ†å…¸ï¼šã€Œæ‚¬çº¿ä¸å°±æ˜¯å¯æŒä¹…åŒ–å•è°ƒæ ˆå—ï¼Ÿã€</p><p>å¾ˆæœ‰é“ç†ã€‚å®¹æ˜“å‘ç°å•è°ƒæ ˆåœ¨æ¯ä¸€ä¸ª <span class="math inline">\(i\)</span> æ—¶åˆ»çš„æ ˆå†…å…ƒç´ å°±æ˜¯ä» <span class="math inline">\(i\)</span> å¼€å§‹å¾€èµ·å§‹æ–¹å‘è·³ï¼Œç»è¿‡çš„æ‰€æœ‰å…ƒç´ ã€‚ç”±äºæ‚¬çº¿å­˜å‚¨çš„æ•°æ®æ˜¯ä¸ä¼šæ›´æ”¹çš„ï¼Œå€’æ¨å›å»æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œæ‚¬çº¿å­˜å‚¨äº†æ¯ä¸ªæ—¶åˆ»çš„å•è°ƒæ ˆä¿¡æ¯å¹¶æœ‰å¤šä¸ªç‚¹å…±äº«å‰é©± / åç»§ï¼Œå…¶å®å°±æ˜¯ä¸€ç§å¦ç±»çš„å¯æŒä¹…åŒ–å•è°ƒæ ˆï¼Œå¹¶ä¸”å¤æ‚åº¦ä¸å•è°ƒæ ˆæœ¬ä½“ç›¸åŒã€‚</p><hr /><h2 id="ä¸ç¬›å¡å°”æ ‘çš„å…³è”">ä¸ç¬›å¡å°”æ ‘çš„å…³è”</h2><p><em>upd on 240704</em>ï¼Œå­¦ä¹ äº†ç¬›å¡å°”æ ‘ã€‚ç°åœ¨ä»‹ç»æ‚¬çº¿ä¸ç¬›å¡å°”æ ‘çš„å…³ç³»ã€‚</p><p>å®¹æ˜“å‘ç°å…ƒç´  <span class="math inline">\(i\)</span> çš„ <span class="math inline">\(l_i,r_i\)</span> äºŒå€¼å°±æ˜¯å…¶åœ¨ç¬›å¡å°”æ ‘ä¸Šå¯¹åº”çš„åŒºé—´ã€‚</p><p>æ›´æŠ½è±¡çš„ä¸€ç‚¹æ˜¯æ‚¬çº¿æ³•ä¸­è·³ä¸€è·³çš„æ“ä½œåœ¨ç¬›å¡å°”æ ‘ä¸­çš„å¯¹åº”å†…æ¶µã€‚ä»¥å°æ ¹å †ä¸ºèƒŒæ™¯ã€åœ¨ <span class="math inline">\(l\)</span> ä¸Šå‘å·¦è·³ä¸ºä¾‹ï¼Œæ³¨æ„åˆ°è¯¥æ“ä½œç›¸å½“äºä»å·¦åˆ°å³å‘ç¬›å¡å°”æ ‘ä¸­æ–°å¢èŠ‚ç‚¹ã€‚</p><p>è¿™ä¹Ÿè¿›ä¸€æ­¥éªŒè¯äº†æ‚¬çº¿æ³•å¤æ‚åº¦çš„æ­£ç¡®æ€§ï¼šæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨æ–°åŠ å…¥èŠ‚ç‚¹æ—¶ï¼Œè‹¥ä»æ ‘ä¸­æå–å‡ºç”±æ ¹èŠ‚ç‚¹å’Œå…¶ä¸€ç›´å‘å³èµ°ç›´åˆ°èŠ‚ç‚¹ä¸å­˜åœ¨å³å„¿å­æ„æˆçš„é“¾ï¼Œåˆ™è¯¥ç‚¹è¢«æ·»åŠ åˆ°é“¾ä¸­æŸä¸€ç‚¹çš„å³å„¿å­ï¼Œè¯¥ç‚¹åŸæœ¬çš„å³å­æ ‘ï¼ˆå®Œæ•´åŒ…å«äº†é“¾çš„å‰©ä½™éƒ¨åˆ†ï¼‰æˆä¸ºæ–°å»ºèŠ‚ç‚¹çš„å·¦å­æ ‘ã€‚</p><p>è€Œæ‚¬çº¿å®ç°çš„å°±æ˜¯ä»é“¾çš„æœ€ä½ç‚¹æš´åŠ›çˆ¬å±±ï¼Œç›´åˆ°æ‰¾åˆ°åˆæ³•ç‚¹ï¼›è€Œæ ¹æ®ä¸Šé¢çš„ç»“è®ºï¼Œè¢«æšä¸¾è¿‡çš„é“¾ä¸Šè¾ƒä½ç‚¹ä¸ä¼šä½œä¸ºæ–°èŠ‚ç‚¹çš„å³è¾¹çš„å­å­™ï¼Œè‡ªç„¶ä¹Ÿä¸ä¼šå†æ¬¡è¢«æšä¸¾åˆ°ã€‚</p><p>æ•…è€Œæ¯ä¸ªç‚¹æœ€å¤šè¢«æšä¸¾åˆ°ä¸€æ¬¡ï¼Œå¾—è¯ã€‚</p><p>è¿›ä¸€æ­¥çš„ï¼Œå¯ä»¥å¼€å‘å‡ºæ‚¬çº¿æ³• <span class="math inline">\(O(n)\)</span> å»ºç¬›å¡å°”æ ‘çš„æ–¹æ³•ï¼š</p><p>æ¯æ¬¡æ±‚è§£å®Œ <span class="math inline">\(l_i\)</span> åï¼Œä»¤ <span class="math inline">\(rc_{l_i-1}=i\)</span> å³å¯ï¼ˆå½“ç„¶ <span class="math inline">\(rc_{l_i-1}\)</span> æ˜¯ä¼šè¢«å¤šæ¬¡æ›´æ–°çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ç›´æ¥ç”¨é‚»æ¥è¡¨ / å‰å‘æ˜Ÿè¿è¾¹çš„åŸå› ï¼‰ï¼Œ<span class="math inline">\(r_i\)</span> ä¸ <span class="math inline">\(lc\)</span> åŒç†ã€‚</p><pre class="cpp"><code>for (int i = 1; i &lt;= n; ++i) &#123;    l[i] = i;    while (l[i] != 1 &amp;&amp; a[l[i] - 1] &gt; a[i])        l[i] = l[l[i] - 1];    rc[l[i] - 1] = i;&#125;for (int i = n; i; --i) &#123;    r[i] = i;    while (r[i] != n &amp;&amp; a[r[i] + 1] &gt; a[i])        r[i] = r[r[i] + 1];    lc[r[i] + 1] = i;&#125;</code></pre><p>å…¶ä¸­ï¼Œæ ¹èŠ‚ç‚¹å³ä¸º <code>rc[0]</code> æˆ– <code>lc[n + 1]</code>ã€‚</p><hr /><p>è¿›ä¸€æ­¥ä»ç¬›å¡å°”æ ‘å‡ºå‘ï¼Œæ¢ç©¶æ‚¬çº¿æ³•èƒ½å¤Ÿå¾ªç¯å†…ç»´æŠ¤çš„æ•°æ®ç‰¹ç‚¹ã€‚</p><p>ä¸ºä½•æ˜¯å¾ªç¯å†…ç»´æŠ¤ï¼Ÿå› ä¸ºå¾ªç¯å¤–ç»´æŠ¤å°±åªèƒ½ä»å·¦å³çš„ç›´æ¥å„¿å­è¿›è¡Œæ›´æ–°ï¼Œé‚£å’Œç¬›å¡å°”æ ‘å°±æ²¡æœ‰åŒºåˆ«äº†ã€‚</p><p>ä½†å…¶å®ç»“æœæ˜¯æ²¡ä»€ä¹ˆå¯æ¢ç©¶çš„ï¼Œå› ä¸ºå…¶ç»è¿‡çš„èŠ‚ç‚¹â€”â€”è‡ªå·±å·¦å­æ ‘ä¸‹æœ€å³ç«¯é“¾â€”â€”å®åœ¨ä¸å…·æœ‰ä»€ä¹ˆç‰¹æ®Šæ€§ï¼Œå®ƒä»¬æ‰€å¯¹åº”çš„åŒºé—´â€”â€”ä» <span class="math inline">\([l_i, i - 1]\)</span> åˆ° <span class="math inline">\([i - 1, i - 1]\)</span> ä¹Ÿçœ‹ä¸å‡ºä»€ä¹ˆå€¼å¾—ç ”ç©¶çš„ï¼Œæ›´ä½•å†µå¯ä»¥è¢«ç¬›å¡å°”æ ‘æ›´å…·è±¡åœ°ä»£æ›¿ï¼›å¦‚æœä½ è¦ä»å‰ç¼€æœ€å€¼çš„è§’åº¦å‡ºå‘ï¼Œé‚£å°±æ²¡æ„æ€äº†ï¼Œå®Œå…¨ç­‰ä»·äºå•è°ƒæ ˆã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºè¿™æ¬¡æ‚¬çº¿æ³•çš„å¼€å‘æœ€ç»ˆä»¥å¤±è´¥å‘Šç»ˆï¼Œ<del>ä¸ç„¶å®ƒæ—©è¢«åˆ«äººå¼€å‘äº†</del>ï¼Œæˆ‘åœ¨æ­¤èƒ½ç»™å‡ºçš„æ„è§æ˜¯ï¼Œå¯ä»¥ç”¨æ‚¬çº¿æ³•å®ŒæˆçŸ©å½¢é¢˜ç›®ç­‰ä¸éœ€è¦ç¬›å¡å°”æ ‘æ ‘å½¢ç»“æ„çš„é—®é¢˜ï¼Œè‡³äºå…¶ä»–ï¼Œç”šè‡³åŒ…æ‹¬ä¸Šé¢æåˆ°çš„ <a href="/20231004">æƒ…æ™¯å‰§</a> ä¸€é¢˜ï¼Œéƒ½å¯ä»¥ç›´æ¥ä¸Šç¬›å¡å°”æ ‘ã€‚</p><p>ä½†ç¬›å¡å°”æ ‘çš„å»ºæ ‘æˆ‘è¿˜æ˜¯è‚¯å®šä¼šç”¨æ‚¬çº¿çš„ï¼æ¯•ç«Ÿç…§åº”å¼€å¤´ï¼Œæˆ‘ä¸ä¼šå•è°ƒæ ˆ <img src="/em/dy.gif" alt="å¾—æ„" /></p>]]></content>
      
      
      
        <tags>
            
            <tag> æ‚¬çº¿æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è§£é¢˜æŠ¥å‘Š One-Dimensional Battle Ships</title>
      <link href="/20220808/"/>
      <url>/20220808/</url>
      
        <content type="html"><![CDATA[<p>è€é¢˜è§£æ‰¹é‡è¡¥æ¡£ã€‚</p><span id="more"></span><hr /><p><a href="https://www.luogu.com.cn/problem/CF567D" class="uri">https://www.luogu.com.cn/problem/CF567D</a></p><p>å› ä¸ºã€ŒæŸä¸€æ—¶åˆ»æ˜¯å¦ä¸€å®šè¢«å‡»ä¸­è¿‡ã€å…·æœ‰å•è°ƒæ€§ï¼Œè€ƒè™‘å…ˆæå‰å‘å°„æ‰€æœ‰ç‚®å¼¹ï¼Œå€’åºæšä¸¾ç‚®å¼¹ï¼Œä¸æ–­ã€Œæ’¤é”€ã€å½“å‰æœ€åä¸€å‘ç‚®å¼¹çš„å‘å°„ï¼Œå¦‚æœåœ¨ã€Œæ’¤é”€ã€è¿™å‘ç‚®å¼¹åï¼Œå­˜åœ¨ä»»æ„ä¸€ç§æ”¾ä¸‹ <span class="math inline">\(k\)</span> è‰˜å®Œæ•´çš„æˆ˜èˆ°çš„æ–¹æ¡ˆï¼Œè¯´æ˜åœ¨å‘å°„è¿™ä¸€å‘ç‚®å¼¹ä¹‹åç»å¯¹èƒ½å¤Ÿå‡»ä¸­ã€‚</p><p>å¦‚æœå‘å°„æ‰€æœ‰ç‚®å¼¹åï¼Œä¾ç„¶å­˜åœ¨ä¸€ç§æ”¾ä¸‹ <span class="math inline">\(k\)</span> è‰˜å®Œæ•´çš„æˆ˜èˆ°çš„æ–¹æ¡ˆï¼Œåˆ™æ— è§£ã€‚</p><p>å…·ä½“å®ç°å¯ä»¥ä½¿ç”¨å¹¶æŸ¥é›†ç»´æŠ¤è¿é€šå—å¤§å°ï¼Œæ¯ã€Œæ’¤é”€ã€ä¸€å‘ç‚®å¼¹çš„å‘å°„ç›¸å½“äºåˆå¹¶ä¸‰ä¸ªè¿é€šå—ï¼šç‚®å¼¹çš„è½ç‚¹ã€è½ç‚¹çš„å‰ä¸€ä¸ªå…ƒç´ ï¼ˆè‹¥ä¸å­˜åœ¨æˆ–å·²è¢«ç‚®å¼¹æ‘§æ¯åˆ™å¿½ç•¥ï¼‰ã€è½ç‚¹çš„åä¸€ä¸ªå…ƒç´ ï¼ˆè‹¥ä¸å­˜åœ¨æˆ–å·²è¢«ç‚®å¼¹æ‘§æ¯åˆ™å¿½ç•¥ï¼‰ã€‚</p><p>è®¾æŸè¿é€šå—å¤§å°ä¸º <span class="math inline">\(x\)</span>ï¼Œå¯å®¹çº³æˆ˜èˆ°æ•°ä¸º <span class="math inline">\(res\)</span>ï¼Œæ˜¾ç„¶æœ‰ <span class="math inline">\(res = \lfloor (x + 1) \div (p + 1) \rfloor\)</span>ã€‚</p><p>è®°ç»Ÿè®¡å½“å‰å¯å®¹çº³æˆ˜èˆ°çš„æ•°é‡ä¸º <span class="math inline">\(ans\)</span>ï¼Œåœ¨å¹¶æŸ¥é›†åˆå¹¶æ—¶ï¼Œ<span class="math inline">\(ans\)</span> åˆ†åˆ«å‡å»ä¸¤ä¸ªå¾…åˆå¹¶è¿é€šå—çš„å¯å®¹çº³æˆ˜èˆ°çš„æ•°é‡ï¼Œå†åŠ ä¸Šæ–°è¿é€šå—å¯å®¹çº³æˆ˜èˆ°çš„æ•°é‡ã€‚æœ€é åçš„ <span class="math inline">\(ans\ge k\)</span> çš„æ—¶åˆ»å³ä¸ºæ‰€æ±‚ã€‚</p><p>åŒæ—¶ä½¿ç”¨è·¯å¾„å‹ç¼©å’ŒæŒ‰ç§©åˆå¹¶ï¼Œæ—¶ç©ºå¤æ‚åº¦å‡ä¸º <span class="math inline">\(\mathcal O(n)\)</span>ã€‚ä¼˜äº multiset è§£æ³•ã€‚</p><details><pre class="cpp"><code>namespace XSC062 &#123;using namespace fastIO;const int maxn = 2e5 + 15;bool vis[maxn];int n, k, p, m, x, ans;int a[maxn], f[maxn], siz[maxn];inline void swap(int &amp;x, int &amp;y)&#123;    x ^= y ^= x ^= y;    return 0;&#125;inline int calc(int x) &#123;    return (x + 1) / (p + 1);&#125;inline void Init(int n) &#123;    for (int i = 1; i &lt;= n; ++i) &#123;        f[i] = i;        siz[i] = 1;    &#125;    return;&#125;int find(int x) &#123;    return x == f[x] ? x : f[x] = find(f[x]);&#125;inline void merge(int x, int y) &#123;    int fx = find(x);    int fy = find(y);    if (fx == fy)        return;    ans -= calc(siz[fx]);    ans -= calc(siz[fy]);    if (siz[fy] &gt; siz[fx])        swap(fx, fy);    ans += calc(siz[fy]);    f[fx] = fy;    return;&#125;int main() &#123;    read(n);    read(k);    read(p);    read(m);    Init(n + 5);    ans = (n - m) * (2 / (p + 1));    for (int i = 1; i &lt;= m; ++i) &#123;        read(a[i]);        vis[a[i]] = 1;    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        if (vis[i] || vis[i - 1])            continue;        merge(i, i - 1);    &#125;     if (ans &gt;= k) &#123;        puts(&quot;-1&quot;);        return 0;    &#125;    for (int i = m; i; --i) &#123;        vis[a[i]] = 0;        ans += 2 / (p + 1);        if (a[i] - 1 &amp;&amp; !vis[a[i] - 1])            merge(a[i], a[i] - 1);        if (a[i] + 1 &lt;= n &amp;&amp; !vis[a[i] + 1])            merge(a[i], a[i] + 1);        if (ans &gt;= k) &#123;            printf(&quot;%d&quot;, i);            return 0;        &#125;    &#125;    puts(&quot;-1&quot;);    return 0;&#125;&#125; // namespace XSC062int main() &#123;    XSC062::main();    return 0;&#125;</code></pre></details>]]></content>
      
      
      
        <tags>
            
            <tag> å¹¶æŸ¥é›† </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€æ€»ç»“ã€‘æ–œç‡ä¼˜åŒ– DP</title>
      <link href="/20210214/"/>
      <url>/20210214/</url>
      
        <content type="html"><![CDATA[<p>äºæ˜¯ï¼ŒXSC062 å¼€å§‹å†™æ€»ç»“ã€‚</p><h2 id="æ–œç‡ä¼˜åŒ–-dp">æ–œç‡ä¼˜åŒ– DP</h2><p><strong>å‰ç½®èŠå£«</strong></p><p><a href="https://www.cnblogs.com/XSC062/p/14383610.html">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ– DP</a></p><p><strong>æ­£æ–‡</strong></p><p>æˆ‘ä»¬ä»¥ä¸€é“é¢˜ä¸ºä¾‹ã€‚</p><h3 id="æ‰“å°æ–‡ç« "><a href="http://acm.hdu.edu.cn/showproblem.php?pid=3507">æ‰“å°æ–‡ç« </a></h3><p><a href="https://loj.ac/p/10191">åŒå€ç»éªŒ</a> | <a href="https://www.acwing.com/problem/content/1096/">ä¸‰å€ç»éªŒ</a></p><h4 id="solution">Solution</h4><p>æ˜æ˜¾ DPã€‚</p><p>é‚£ä¹ˆ DP å¼å°±æ˜¯ï¼š <span class="math display">\[\begin{aligned}f_i&amp;=\min\{f_j+(s_i-s_j)^2+M\}\\&amp;=\min\{f_j+{s_i}^2-2\times s_i\times s_j+{s_j}^2+M\}\\&amp;=\min\{f_j-2\times s_i\times s_j+{s_j}^2\}+{s_i}^2+M\end{aligned}\]</span> å…¶ä¸­ <span class="math inline">\(s\)</span> ä¸º <span class="math inline">\(c\)</span> çš„å‰ç¼€å’Œã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(\mathcal O(n^2)\)</span>ï¼Œæ˜æ˜¾çˆ†ç‚¸ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¼˜åŒ–ã€‚</p><p>åœ¨ä¸Šä¸€ç¯‡çš„ <a href="https://www.cnblogs.com/XSC062/p/14383610.html">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–DP</a> ä¸­ï¼Œæˆ‘ä»¬æåˆ°è¿‡ï¼Œåªæœ‰ DP å¼ä¸­çš„ä¸ <span class="math inline">\(i\)</span> æœ‰å…³çš„é¡¹èƒ½ç›´æ¥æå‡ºæ¥æ—¶ï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ï¼Œè€Œè¿™é‡Œçš„ <span class="math inline">\(s_i\)</span> ä¸ <span class="math inline">\(s_j\)</span> ç›¸ä¹˜ï¼Œæ— æ³•ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚</p><p>æˆ‘ä»¬æ€è€ƒï¼Œå¯¹äº <span class="math inline">\(f_i\)</span> æ¥è¯´ï¼Œæ— éå°±æ˜¯é€‰å‡ºæœ€ä¼˜çš„ <span class="math inline">\(j\)</span> æ¥æ„é€ å®ƒã€‚</p><p>å‡è®¾æœ‰ <span class="math inline">\(j\)</span> ä¸ <span class="math inline">\(k\)</span>ï¼Œå¦‚ä½•åˆ¤æ–­ <span class="math inline">\(j\)</span> ä¸ <span class="math inline">\(k\)</span> è°æ›´ä¼˜å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬å…ˆé’¦å®š <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ï¼Œä¸” <span class="math inline">\(j&lt;k\)</span>ã€‚</p><p>é‚£ä¹ˆå¯ä»¥å¾—åˆ°ï¼š <span class="math display">\[f_j-2\times s_i\times s_j+{s_j}^2+{s_i}^2+M&lt;f_k-2\times s_i\times s_k+{s_k}^2+{s_i}^2+M\]</span> åŒ–ç®€å¾—ï¼š <span class="math display">\[f_j-2\times s_i\times s_j+{s_j}^2&lt;f_k-2\times s_i\times s_k+{s_k}^2\]</span> å†å°†<strong>åª</strong>ä¸ <span class="math inline">\(j,k\)</span> æœ‰å…³çš„é¡¹æ”¾åˆ°å·¦è¾¹ï¼Œä¸ <span class="math inline">\(i\)</span> æœ‰å…³çš„é¡¹æ”¾åˆ°å³è¾¹ï¼š <span class="math display">\[f_j-f_k+{s_j}^2-{s_k}^2&lt;2\times s_i\times s_j-2\times s_i\times s_k\\f_j-f_k+{s_j}^2-{s_k}^2&lt;2\times s_i\times(s_j-s_k)\]</span> å·¦å³ä¸¤è¾¹åŒæ—¶ <span class="math inline">\(\div\)</span> ä¸ <span class="math inline">\(i\)</span> æ— å…³çš„é¡¹ <span class="math inline">\(2\times(s_j-s_k)\)</span> ï¼š <span class="math display">\[\dfrac{(f_j+{s_j}^2)-(f_k+{s_k}^2)}{(2\times s_j)-(2\times s_k)}&lt;s_i\]</span> å¦‚æœæ»¡è¶³ä¸Šå¼ ï¼Œåˆ™ <span class="math inline">\(j&lt;k\)</span> ä¸” <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ã€‚</p><p>æ¥ä¸‹æ¥æ˜¯æ–œç‡ä¼˜åŒ–çš„é‡ç‚¹éƒ¨åˆ†ã€‚</p><blockquote><p>åœ¨ä¹‰åŠ¡æ•™è‚²é˜¶æ®µï¼Œå­¦ç”Ÿå­¦ä¹ äº† <a href="https://baike.baidu.com/item/ä¸€æ¬¡å‡½æ•°">ä¸€æ¬¡å‡½æ•°</a>ï¼Œå®ƒçš„å‡ ä½•æ„ä¹‰è¡¨ç¤ºä¸ºä¸€æ¡ç›´çº¿ï¼Œä¸€æ¬¡é¡¹çš„ç³»æ•°å°±æ˜¯ç›´çº¿çš„æ–œç‡ï¼Œåªä¸è¿‡å½“ç›´çº¿ä¸ <span class="math inline">\(x\)</span> è½´å‚ç›´çš„æ—¶å€™æ— æ³•è¡¨ç¤ºã€‚è™½ç„¶æ²¡æœ‰æ˜ç¡®ç»™å‡ºæ–œç‡è¿™ä¸ªåè¯ï¼Œä½†å®é™…ä¸Šæ€æƒ³å·²ç»æ¸—é€åˆ°å…¶ä¸­ã€‚</p><p>ç›´çº¿å¯¹ <span class="math inline">\(x\)</span> è½´çš„å€¾æ–œè§’ <span class="math inline">\(\alpha\)</span> çš„æ­£åˆ‡å€¼ <span class="math inline">\(\tan\alpha\)</span> ç§°ä¸ºè¯¥ç›´çº¿çš„â€œæ–œç‡â€ï¼Œå¹¶è®°ä½œ <span class="math inline">\(k\)</span> ï¼Œå…¬å¼ä¸º <span class="math inline">\(k=\tan\alpha\)</span>ã€‚</p><p>å³ <span class="math inline">\(k=\tan\alpha=\dfrac{\Delta y}{\Delta x}=\dfrac{y_2-y_1}{x_2-x_1}\)</span> æˆ– <span class="math inline">\(\dfrac{y_1-y_2}{x_1-x_2}\)</span> ã€‚</p><p align="right">â€”â€”é€‰è‡ª <a href="https://baike.baidu.com/item/%E6%96%9C%E7%8E%87/4914111?fr=aladdin">æ–œç‡_ç™¾åº¦ç™¾ç§‘</a></p></blockquote><p>XSC062 çœ‹å®Œäº†ç™¾åº¦ç™¾ç§‘è¡¨ç¤º <del>ä½  TM åœ¨è¯´äº›å•¥æ˜¯ä¸æ˜¯æ¬ºè´Ÿæˆ‘å…­å¹´ä¹‰åŠ¡æ•™è‚²çš„å°å­¦ç”Ÿ</del> æç„¶å¤§æ‚Ÿ</p><p>ä¸Šé¢æ¨å‡ºæ¥çš„é‚£ä¸ªå…³äº <span class="math inline">\(j\)</span> å’Œ <span class="math inline">\(k\)</span> çš„DPå¼ï¼Œä¸å°±æ˜¯æ±‚ä¸¤ä¸ªç‚¹ <span class="math inline">\((2\times s_j,f_j+{s_j}^2)\)</span> å’Œ <span class="math inline">\((2\times s_k,f_j+{s_k}^2)\)</span> è¿æˆä¸€æ¡çº¿ä¹‹åçš„å¡åº¦å—ï¼Ÿ</p><p>æœ¬æ–‡åé¢çš„éƒ¨åˆ†ï¼Œ<span class="math inline">\(x\)</span> çš„å«ä¹‰ä¼šåœ¨ã€Œç‚¹<span class="math inline">\((2\times s_x,f_x+{s_x}^2)\)</span> ã€å’Œã€Œä¸‹æ ‡ <span class="math inline">\(x\)</span> ã€ä¹‹é—´æ¼‚æµ®ï¼Œè¯·æ ¹æ®è¯­å¢ƒè¯†åˆ«ã€‚</p><p>éšå XSC062 è¾¹æ‰“çŒç¡è¾¹å¬ GM è®²è¯¾ï¼ˆç‰¹å¼‚åŠŸèƒ½ï¼‰ï¼Œå‹‰å¼ºç®—æ˜¯æ˜ç™½äº†ä¸­å¿ƒæ„æ€ï¼š</p><p>å¦‚å›¾ï¼Œå‡è®¾æœ‰ä¸‰ä¸ªç‚¹ <span class="math inline">\(A,B,C\)</span>ï¼Œä»¥åŠ <span class="math inline">\(l_{AB}\)</span> çš„æ–œç‡ <span class="math inline">\(k_1\)</span>ï¼Œ<span class="math inline">\(l_{BC}\)</span> çš„æ–œç‡ <span class="math inline">\(k_2\)</span>ã€‚</p><figure><img src="https://img-blog.csdnimg.cn/img_convert/3bc5fea553ad6b06229ef9e9fa4c9664.png" alt="ä¸Šå‡¸" /><figcaption>ä¸Šå‡¸</figcaption></figure><p>æˆ‘ä»¬æš‚ä¸”æŠŠè¿™ä¸ªå‘å¤–å‡¸èµ·çš„å¥‡æ€ªç©æ„å„¿ç§°ä¸ºä¸€ä¸ªã€Œä¸Šå‡¸ã€ã€‚</p><p>å›åˆ°å‰é¢çš„æˆ‘ä»¬å¾—åˆ°çš„é‚£ä¸ªç»“è®ºï¼š</p><blockquote><p><span class="math display">\[\dfrac{(f_j+{s_j}^2)-(f_k+{s_k}^2)}{(2\times s_j)-(2\times s_k)}&lt;s_i\]</span></p><p>å¦‚æœæ»¡è¶³ä¸Šå¼ ï¼Œåˆ™ <span class="math inline">\(j&lt;k\)</span> ä¸” <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ã€‚</p></blockquote><p>ç®€å•è®°å¿†ä¸ºï¼š</p><ul><li>è‹¥ <span class="math inline">\(l_{NM}\)</span> çš„æ–œç‡æ¯” <span class="math inline">\(s_i\)</span> å°ï¼Œåˆ™ <span class="math inline">\(N&lt;M\)</span> ä¸” <span class="math inline">\(N\)</span> ä¼˜äº <span class="math inline">\(M\)</span> ã€‚</li><li>åä¹‹ï¼Œè‹¥ç‚¹ <span class="math inline">\(l_{NM}\)</span> çš„æ–œç‡æ¯” <span class="math inline">\(s_i\)</span> å¤§ï¼Œåˆ™ <span class="math inline">\(M&lt;N\)</span> ä¸” <span class="math inline">\(M\)</span> ä¼˜äº <span class="math inline">\(N\)</span>ã€‚</li></ul><p>å°† <span class="math inline">\(A,B\)</span> ä»£å…¥ï¼Œæˆ‘ä»¬å¾—çŸ¥ï¼š</p><ol type="1"><li>è‹¥ <span class="math inline">\(k_1\leqslant s_i\)</span>ï¼Œåˆ™ <span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(A\)</span>ã€‚</li><li>è‹¥ <span class="math inline">\(k_1&gt;s_i\)</span>ï¼Œåˆ™ <span class="math inline">\(A\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ã€‚</li><li>è‹¥ <span class="math inline">\(k_2\leqslant s_i\)</span>ï¼Œåˆ™ <span class="math inline">\(C\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ã€‚</li><li>è‹¥ <span class="math inline">\(k_2&gt;s_i\)</span>ï¼Œåˆ™ <span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(C\)</span>ã€‚</li></ol><p>å› ä¸ºæ–œç‡ = å€¾æ–œåº¦ = ç«–å¾—æœ‰å¤šé«˜ï¼Œæ˜æ˜¾ <span class="math inline">\(k_1&gt;k_2\)</span>ã€‚æ‰€ä»¥é’ˆå¯¹ä¸€ä¸ªå¤§å°å…³ç³»ï¼Œ<span class="math inline">\(k_1\)</span> å’Œ <span class="math inline">\(k_2\)</span> ä¹‹é—´åªæœ‰å¯èƒ½æœ‰ï¼š</p><ol type="1"><li><span class="math inline">\(s_i&lt;k_2&lt;k_1\)</span>ï¼Œæ­¤æ—¶ <span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(C\)</span>ï¼Œ<span class="math inline">\(A\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ï¼Œ<span class="math inline">\(A\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li><li><span class="math inline">\(k_2&lt;s_i&lt;k_1\)</span>ï¼Œæ­¤æ—¶ <span class="math inline">\(C\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ï¼Œ<span class="math inline">\(A\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ï¼Œ<span class="math inline">\(A,C\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li><li><span class="math inline">\(k_2&lt;k_1&lt;s_i\)</span>ï¼Œæ­¤æ—¶ <span class="math inline">\(C\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ï¼Œ<span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(A\)</span>ï¼Œ<span class="math inline">\(C\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li></ol><p>å‘ç°äº†å—ï¼Ÿ<span class="math inline">\(B\)</span> æ°¸è¿œéƒ½ä¸å¯èƒ½æ˜¯æœ€ä¼˜è§£ã€‚</p><p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦ç»´æŠ¤ä¸€ä¸ªæœ€ä¼˜è§£çš„åºåˆ—ï¼Œå°±å¯ä»¥ä¸è¦ <span class="math inline">\(B\)</span> äº†ã€‚</p><figure><img src="0.png" alt="ä¸Šå‡¸" /><figcaption>ä¸Šå‡¸</figcaption></figure><p>é‚£ä¹ˆï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»åˆ æ‰äº†æ‰€æœ‰ã€Œä¸Šå‡¸ã€çš„çªèµ·éƒ¨åˆ†ï¼Œæ‰€ä»¥è¿™ä¸ªæœ€ä¼˜è§£åºåˆ—é‡Œè‚¯å®šä¸ä¼šå†å­˜åœ¨ã€Œä¸Šå‡¸ã€äº†ã€‚</p><p>å¦‚æœæ˜¯è¿™æ ·çš„ã€Œä¸‹å‡¸ã€å‘¢ï¼Ÿ</p><figure><img src="1.png" alt="ä¸‹å‡¸" /><figcaption>ä¸‹å‡¸</figcaption></figure><p><span class="math inline">\(k_1\)</span> ä¸º <span class="math inline">\(l_{AB}\)</span> çš„æ–œç‡ï¼Œ<span class="math inline">\(k_2\)</span> ä¸º <span class="math inline">\(l_{BC}\)</span> çš„æ–œç‡ã€‚</p><p>å°† <span class="math inline">\(A,B\)</span> ä»£å…¥ï¼Œæˆ‘ä»¬å¾—çŸ¥ï¼š</p><ol type="1"><li>è‹¥ <span class="math inline">\(k_1\leqslant s_i\)</span>ï¼Œåˆ™ <span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(A\)</span>ã€‚</li><li>è‹¥ <span class="math inline">\(k_1&gt;s_i\)</span>ï¼Œåˆ™ <span class="math inline">\(A\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ã€‚</li><li>è‹¥ <span class="math inline">\(k_2\leqslant s_i\)</span>ï¼Œåˆ™ <span class="math inline">\(C\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ã€‚</li><li>è‹¥ <span class="math inline">\(k_2&gt;s_i\)</span>ï¼Œåˆ™ <span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(C\)</span>ã€‚</li></ol><p>æ˜æ˜¾ <span class="math inline">\(k_1&lt;k_2\)</span>ã€‚æ‰€ä»¥ <span class="math inline">\(k_1\)</span> å’Œ <span class="math inline">\(k_2\)</span> ä¹‹é—´åªæœ‰å¯èƒ½æœ‰ï¼š</p><ol type="1"><li><span class="math inline">\(s_i&lt;k_1&lt;k_2\)</span>ï¼Œæ­¤æ—¶ <span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(C\)</span>ï¼Œ<span class="math inline">\(A\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ï¼Œ<span class="math inline">\(A\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li><li><span class="math inline">\(k_1&lt;s_i&lt;k_2\)</span>ï¼Œæ­¤æ—¶ <span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(C\)</span>ï¼Œ<span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(A\)</span>ï¼Œ<span class="math inline">\(B\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li><li><span class="math inline">\(k_1&lt;k_2&lt;s_i\)</span>ï¼Œæ­¤æ—¶ <span class="math inline">\(C\)</span> ä¼˜äº <span class="math inline">\(B\)</span>ï¼Œ<span class="math inline">\(B\)</span> ä¼˜äº <span class="math inline">\(A\)</span>ï¼Œ<span class="math inline">\(C\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li></ol><p>æ‰€ä»¥ï¼Œåœ¨ä¸‹å‡¸çš„æƒ…å†µä¸­ï¼Œä¸‰ä¸ªç‚¹éƒ½æœ‰å¯èƒ½æ˜¯æœ€ä¼˜è§£ï¼Œéƒ½éœ€è¦ä¿ç•™ã€‚</p><p>ç°åœ¨å‘¢ï¼Œæ‰€æœ‰ä¸Šå‡¸éƒ½è¢«å»æ‰äº†ï¼Œåªå‰©ä¸‹å‡¸ï¼Œæ‰€ä»¥å¤§æ¦‚æœ€åçš„æœ€ä¼˜è§£åºåˆ—å°±é•¿è¿™ä¸ªæ ·å­ï¼š</p><figure><img src="2.png" alt="ä¸‹å‡¸åŒ…" /><figcaption>ä¸‹å‡¸åŒ…</figcaption></figure><p><del>ä¸‹ ç§ƒ åŒ…</del></p><p><del>åè¿‡æ¥çœ‹å°±æ˜¯ lifan çš„è„‘è¢‹äº†</del></p><p>è§‚å¯Ÿå‘ç°ï¼Œæ–œç‡æ˜¯ä»å·¦å¾€å³é€’å¢çš„ã€‚</p><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è€ƒè™‘ç”¨å•è°ƒé˜Ÿåˆ—æ¥å½“è¿™ä¸ªã€Œæœ€ä¼˜è§£åºåˆ—ã€ã€‚</p><h5 id="ç»´æŠ¤é˜Ÿå¤´">ç»´æŠ¤é˜Ÿå¤´</h5><p>å³ä¿è¯é˜Ÿå¤´å…ƒç´ ä¸ºæœ€ä¼˜è§£ã€‚</p><p>è®¾é˜Ÿå¤´ä¸º <span class="math inline">\(q_l\)</span>ã€‚</p><p>å¦‚æœ <span class="math inline">\(q_{l+1}\)</span> ä¸ <span class="math inline">\(q_l\)</span> å½¢æˆçš„æ–œç‡ <span class="math inline">\(\leqslant s_i\)</span>ï¼Œæ ¹æ®ä¸Šé¢æ¨å‡ºæ¥çš„ç©æ„å„¿ï¼Œå¾—åˆ° <span class="math inline">\(q_{l+1}\)</span> ä¼˜äº <span class="math inline">\(q_l\)</span>ã€‚</p><p>é‚£è¿˜è¦ <span class="math inline">\(q_l\)</span> å¹²å•¥ï¼Œç›´æ¥ <code>l++</code>ã€‚</p><h5 id="æ›´æ–°-dp-å€¼">æ›´æ–° DP å€¼</h5><p><span class="math inline">\(f_i=f_{q_l}-2\times s_i\times s_{q_l}+{s_{q_l}}^2+{s_i}^2+M\)</span></p><h5 id="ç»´æŠ¤é˜Ÿå°¾">ç»´æŠ¤é˜Ÿå°¾</h5><p>å³ä¿è¯é‡Œé¢å¡çš„ç‚¹ç›¸é‚»ä¸¤ä¸ªçš„æ–œç‡é€’å¢ã€‚</p><p>è®¾é˜Ÿå°¾ä¸º <span class="math inline">\(q_r\)</span>ï¼Œæˆ‘ä»¬è¦å¾€æœ€ä¼˜è§£é˜Ÿåˆ—é‡Œ <code>push</code> ä¸€ä¸ª <span class="math inline">\(i\)</span> ã€‚</p><p>è‹¥é˜Ÿå°¾ä¸¤ä¸ªç‚¹ <span class="math inline">\(q_r,q_{r-1}\)</span> å½¢æˆçš„æ–œç‡æ¯” <span class="math inline">\(i,q_r\)</span> å½¢æˆçš„æ–œç‡å¤§ï¼Œé‚£ä¹ˆ<code>push(i)</code>åï¼Œæ•´ä¸ªé˜Ÿåˆ—çš„æ–œç‡å°±ä¸å†å•è°ƒé€’å¢ï¼Œæ‰€ä»¥æ­¤æ—¶è¦å°†<code>r--</code>ã€‚ï¼ˆå› ä¸º <a href="https://www.cnblogs.com/XSC062/p/14383610.html">ä¸Šä¸€ç¯‡å…³äºå•è°ƒé˜Ÿåˆ—çš„åšå®¢</a> ä¸­è®²åˆ°çš„ <span class="math inline">\(i\)</span> å¿…é¡»å…¥é˜Ÿï¼Œåªèƒ½å§”å±ˆä¸€ä¸‹ <span class="math inline">\(q_r\)</span> äº†ï¼‰</p><p><strong>æ³¨æ„äº‹é¡¹</strong></p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæ–œç‡æ˜¯ä¸ªæµ®ç‚¹æ•°ã€‚ä¸ºäº†é¿å…æŸå¤±ç²¾åº¦é€ æˆçš„ä¸€äº›æƒ¨æ¡ˆï¼Œæˆ‘ä»¬äº¤å‰ç›¸ä¹˜ï¼Œå°†åˆ†å­ã€åˆ†æ¯åˆ†å¼€å¤„ç†ã€‚</p><p>ä»¥åŠæ—¶åˆ»éƒ½è¦ä¿è¯é˜Ÿåˆ—ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªç‚¹ï¼Œå› ä¸ºè¦è®¿é—® <span class="math inline">\(q_l,q_{l+1}\)</span> å’Œ <span class="math inline">\(q_r,q_{r-1}\)</span>ã€‚</p><h4 id="code">Code</h4><pre class="cpp"><code>#include &lt;cstdio&gt;const int maxn = 5e5 + 5;int n, m, l, r;int f[maxn], c[maxn], q[maxn];inline int getDP(int i, int j) &#123;    return f[j] + m + (c[i] - c[j]) * (c[i] - c[j]);&#125;inline int getup(int j, int k)&#123;    return f[j] + c[j] * c[j] - f[k] - c[k] * c[k]; // è®¡ç®—åˆ†å­çš„å€¼&#125;inline int getdown(int j, int k) &#123;    return (c[j] - c[k]) * 2; // è®¡ç®—åˆ†æ¯çš„å€¼&#125;int main()&#123;    while (~scanf(&quot;%d %d&quot;, &amp;n, &amp;m)) &#123;        l = r = 1; // å‡¡æ˜¯æ¶‰åŠåˆ°å‰ç¼€å’Œçš„å•è°ƒé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­å¿…é¡»å­˜åœ¨åˆå§‹ 0        for (int i = 1; i &lt;= n; ++i) &#123;            scanf(&quot;%d&quot;, &amp;c[i]); // c è‡ªç»™è‡ªè¶³            c[i] += c[i - 1];            // # ç»´æŠ¤é˜Ÿå¤´            // æ³¨æ„æ­¤å¤„çš„æ¡ä»¶ä¸º l &lt; rï¼Œå› ä¸ºé˜Ÿåˆ—ä¸­è‡³å°‘éœ€è¦å­˜åœ¨ä¸¤ä¸ªç‚¹            while (l &lt; r &amp;&amp; getup(q[l+1], q[l]) &lt;= c[i] * getdown(q[l + 1],q[l]))                l++;            // # è½¬ç§»çŠ¶æ€            f[i] = getDP(i, q[l]);            // # ç»´æŠ¤é˜Ÿå°¾            while(l &lt; r&amp;&amp; getup(i, q[r]) * getdown(q[r], q[r-1]) &lt;= getup(q[r] ,q[r - 1]) * getdown(i, q[r]))                r--;            q[++r] = i;        &#125;        printf(&quot;%d\n&quot;,f[n]);    &#125;    return 0;&#125;</code></pre><p>åœ¨å¯¹ DP å¼å˜å½¢æ—¶ï¼Œæˆ‘ä»¬æœ€å¥½å°†å…¶åŒ–ä¸º <span class="math inline">\(\dfrac{(j)-(k)}{(j)-(k)}&lt;x\)</span> æˆ– <span class="math inline">\(\dfrac{(j)-(k)}{(j)-(k)}&gt;x\)</span> çš„å½¢å¼ã€‚</p><p>è¿™ä¸ªæ¿å­åªé€‚ç”¨äºç»´æŠ¤ä¸‹å‡¸åŒ…çš„æƒ…å†µã€‚å½“ä¸­é—´çš„ç¬¦å·ä¸º <span class="math inline">\(&gt;\)</span> æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä»½ä»£ç ä¸Šç¨ä½œæ”¹åŠ¨ï¼Œç»´æŠ¤ä¸€ä¸ªä¸Šå‡¸åŒ…ï¼Œåæ–‡ä¼šæåˆ°æœ‰å…³å†…å®¹ã€‚</p><hr /><h3 id="ç©å…·è£…ç®±"><a href="https://www.luogu.com.cn/problem/P3195">ç©å…·è£…ç®±</a></h3><p><a href="https://loj.ac/p/10188">åŒå€ç»éªŒ</a> | <a href="https://www.acwing.com/problem/content/1094/">ä¸‰å€ç»éªŒ</a></p><p>ä»ä»Šå¾€åæˆ‘ä»¬å°±åªè®²æ€ä¹ˆæ¨å¼å­ï¼Œä¸å†è¯æ˜ä¸‹å‡¸ç­‰æ€§è´¨äº†ã€‚</p><p>è®¾ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> ä¸ªç©å…·æ”¾å®Œåçš„æœ€å°è´¹ç”¨ã€‚ <span class="math display">\[f_i=\min\{f_j+(i-j-1+\sum\limits_{k=i}^jC_k-L)^2\}\]</span> ä¸ºäº†è®©è¿™ä¸ªå¼å­å¥½æ‹†ï¼Œæˆ‘ä»¬åœ¨ä¸€å¼€å§‹è®© <code>l++</code>ï¼Œå¹¶ä¸” <span class="math inline">\(C\)</span> å†æ¬¡è‡ªç»™è‡ªè¶³ï¼Œä¸ºè¾“å…¥çš„ <span class="math inline">\(C\)</span> çš„å‰ç¼€å’Œæ•°ç»„ã€‚</p><p>äºæ˜¯å¼å­å°±å˜æˆï¼š <span class="math display">\[f_i=\min\{f_j+(i-j-L+C_i-C_j)^2\}\]</span> æ˜æ˜¾ç¡¬æ‹†ä¼šæ­»äººã€‚ï¼ˆåæ­£æˆ‘è¯•è¿‡ï¼Œæ¯”è¾ƒé€‚åˆç”¨æ¥å‘æ³„</p><p>æ‰€ä»¥æˆ‘ä»¬æŠŠå¼å­å˜æˆè¿™æ ·ï¼š <span class="math display">\[f_i=\min\{f_j+((C_i+i)-(C_j+j)-L)^2\}\]</span> æ—¢ç„¶ <span class="math inline">\(C_i\)</span> ä¸ <span class="math inline">\(i\)</span>ï¼Œ<span class="math inline">\(C_j\)</span> ä¸ <span class="math inline">\(j\)</span> æ˜¯å¯¹åº”çš„ï¼Œé‚£ä¹ˆç›´æ¥é¢„å¤„ç†ï¼Œç»™ <span class="math inline">\(C_i\)</span> åŠ ä¸Š <span class="math inline">\(i\)</span> ä¸å°±è¡Œäº†ï¼Ÿ</p><p>ç°åœ¨è¿™ä¸ª <span class="math inline">\(C_i\)</span> çš„å«ä¹‰å’Œå®ç°å°±å˜å¾—æœ‰ç‚¹æ›²æŠ˜éš¾æ‡‚äº†ã€‚</p><p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p><pre class="cpp"><code>for (int i = 1; i &lt;= n; ++i) &#123;    scanf(&quot;%lld&quot;, &amp;c[i]);    c[i] += c[i - 1];&#125;for (int i = 1; i &lt;= n; ++i)    c[i] += i;</code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class="math inline">\(C_i\)</span> æ˜¯åœ¨å‰ç¼€å’Œçš„åŸºç¡€ä¸ŠåŠ äº†ä¸€ä¸ª <span class="math inline">\(i\)</span>ï¼Œæ³¨æ„ä¸èƒ½æŠŠ <span class="math inline">\(i\)</span> ä¹Ÿä¸€èµ·å‰ç¼€å’Œäº†ã€‚</p><p>ç„¶åå¼å­å°±å˜æˆäº†è¿™æ ·ï¼š <span class="math display">\[\begin{aligned}f_i&amp;=\min\{f_j+(C_i-C_j-L)^2\}\\&amp;=\min\{f_j+{C_i}^2+{C_j}^2+L^2-2\times C_i\times C_j-2\times C_i\times L+2\times C_j\times L\}\\&amp;=\min\{f_j+{C_j}^2-2\times C_i\times C_j+2\times C_j\times L\}+{C_i}^2+L^2-2\times C_i\times L\end{aligned}\]</span></p><p>ä»¤ <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span> ä¸” <span class="math inline">\(j&lt;k\)</span>ã€‚</p><p>å¾—ï¼š <span class="math display">\[f_j+{C_j}^2-2\times C_i\times C_j+2\times C_j\times L&lt;f_k+{C_k}^2-2\times C_i\times C_k+2\times C_k\times L\\f_j-f_k+{C_j}^2-{C_k}^2+2\times C_j\times L-2\times C_k\times L&lt;2\times C_i\times C_j-2\times C_i\times C_k\\f_j-f_k+{C_j}^2-{C_k}^2+2\times C_j\times L-2\times C_k\times L&lt;2\times(C_j-C_k)\times C_i\\\dfrac{f_j-f_k+{C_j}^2-{C_k}^2}{2\times(C_j-C_k)}&lt;C_i\\\dfrac{(f_j+{C_j}^2)-(f_k+{C_k}^2)}{(2\times C_j)-(2\times C_k)}&lt;C_i\]</span></p><pre class="cpp"><code>#include &lt;cstdio&gt;#define int long longconst int maxn = 5e5 + 5;const int LEN = (1 &lt;&lt; 20);int n, m, h, t;int c[maxn], q[maxn], f[maxn];#define nec getcharinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1; ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;inline int getup(int j, int k) &#123;    return (f[j] + c[j] * c[j] + 2 * c[j] * m)           - (f[k] + c[k] * c[k] + 2 * c[k] * m);&#125;inline int getdown(int j, int k) &#123;    return (2 * c[j]) - (2 * c[k]);&#125;inline int getDP(int i, int j) &#123;    return f[j] + (c[i] - c[j] - m) * (c[i] - c[j] - m);&#125;signed main() &#123;    read(n); read(m); h = t = 1; ++m;    for (int i = 1; i &lt;= n; ++i)        read(c[i]), c[i] += c[i - 1];    for (int i = 1; i &lt;= n; ++i) &#123;        c[i] += i;        while (h &lt; t &amp;&amp; getup(q[h + 1], q[h]) &lt;               c[i] * getdown(q[h + 1], q[h])) ++h;        f[i] = getDP(i, q[h]);        while (h &lt; t               &amp;&amp; getup(i, q[t]) * getdown(q[t], q[t - 1]) &lt;=               getdown(i, q[t]) * getup(q[t], q[t - 1])) --t;        q[++t] = i;    &#125;    printf(&quot;%lld&quot;, f[n]);    return 0;&#125;</code></pre><hr /><h3 id="ä»»åŠ¡å®‰æ’-1"><a href="https://loj.ac/p/10184">ä»»åŠ¡å®‰æ’ 1</a></h3><p><a href="https://www.acwing.com/problem/content/302/">åŒå€ç»éªŒ</a> | <a href="https://www.luogu.com.cn/problem/P2365">ä¸‰å€ç»éªŒ</a></p><p>æ„Ÿè°¢è“ä¹¦ã€‚è¿™é‡ŒæŒ‰ç€è“ä¹¦ä¸Šçš„æ€ç»´èµ°ã€‚</p><h4 id="è§£æ³•ä¸€">è§£æ³•ä¸€</h4><p>æš´åŠ›ã€‚</p><p>æ­¤å¤„çš„ <span class="math inline">\(t,c\)</span> ä¸ºè¾“å…¥çš„ <span class="math inline">\(t,c\)</span> çš„å‰ç¼€å’Œæ•°ç»„ã€‚</p><p>è®¾ <span class="math inline">\(f_{i,j}\)</span> ä¸ºå‰ <span class="math inline">\(i\)</span> ä¸ªä»»åŠ¡åˆ†æˆ <span class="math inline">\(j\)</span> æ‰¹çš„æœ€å°è´¹ç”¨ã€‚</p><p>æ•… <span class="math inline">\(S\times j+t_i\)</span> ä¸ºç¬¬ <span class="math inline">\(i\)</span> ä¸ªä»»åŠ¡çš„å®Œæˆæ—¶é—´ã€‚</p><p>å¾—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼ˆ<span class="math inline">\(k\)</span> æšä¸¾ä¸Šä¸€æ‰¹ä»»åŠ¡ç»“æŸä½ç½®ï¼‰ï¼š <span class="math display">\[f_{i,j}=\min\limits_{0\leqslant k&lt;i}\{f_{k,j-1}+(S\times j+t_i)\times(c_i-c_k)\}\]</span> æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(\mathcal O(n^3)\)</span>ã€‚</p><pre class="cpp"><code>#include &lt;cstdio&gt;#include &lt;cstring&gt;#define int long longconst int inf = 1e18;const int maxn = 5005;const int LEN = (1 &lt;&lt; 20);int f[maxn][maxn];int n, s, ans = inf;int t[maxn], c[maxn];inline int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;#ifdef ONLINE_JUDGEinline int nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF; p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;signed main() &#123;    read(n); read(s);    memset(f, 0x3f, sizeof (f));    for (int i = 1; i &lt;= n; ++i) &#123;        read(t[i]); read(c[i]);        t[i] += t[i - 1];        c[i] += c[i - 1];        f[i][1] = (s + t[i]) * c[i]; // åˆå§‹åŒ–    &#125;    for (int i = 2; i &lt;= n; ++i) &#123;        for (int j = 2; j &lt;= i; ++j) &#123;            for (int k = 1; k &lt; i; ++k)                f[i][j] = min(f[i][j], f[k][j - 1] + (t[i] + s * j) * (c[i] - c[k]));        &#125;    &#125;    for (int i = 1; i &lt;= n; ++i)        ans = min(ans, f[n][i]);    printf(&quot;%lld&quot;, ans);    return 0;&#125;</code></pre><p><del>äº²æµ‹ TLE 70</del></p><h4 id="è§£æ³•äºŒ">è§£æ³•äºŒ</h4><p>è„‘å­ç‚¸äº†ï¼Œæƒ³äº†å¥½ä¹…æ‰æƒ³æ˜ç™½è¿™ä¸ªä¼˜åŒ–çš„æ­£ç¡®æ€§ã€‚</p><p>æ€è€ƒï¼Œä»¥ä¸Šä»£ç éœ€è¦ <span class="math inline">\(j\)</span> è¿™ä¸€ç»´çš„æ ¹æœ¬åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</p><p>å› ä¸ºæˆ‘ä»¬æ— æ³•ç¡®å®šä¹‹å‰å·²ç»åˆ’åˆ†äº†å¤šå°‘æ‰¹ï¼Œä¹Ÿå°±æ˜¯æ— æ³•ç¡®å®š <span class="math inline">\(S\)</span> çš„ä¸ªæ•°ã€‚</p><p>æ¢ä¸ªè§’åº¦æ€è€ƒï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šä¹‹å‰ï¼Œå´å¯ä»¥ç¡®å®šä¹‹åã€‚</p><p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬åœ¨ä»»åŠ¡ <span class="math inline">\(i\)</span> å¤„åˆ’åˆ†ï¼Œé‚£ä¹ˆä»»åŠ¡ <span class="math inline">\(i\)</span> ä»¥åŠä»»åŠ¡ <span class="math inline">\(i\)</span> ä»¥åçš„æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´éƒ½ä¼šå»¶å <span class="math inline">\(S\)</span>ã€‚</p><p>å› ä¸º <span class="math inline">\(i\)</span> ä»¥åçš„çŠ¶æ€ä¹Ÿä¼šä½¿ç”¨ <span class="math inline">\(f_i\)</span> çš„å€¼ï¼Œæˆ‘ä»¬åœ¨è®¡ç®— <span class="math inline">\(f_i\)</span> æ—¶å°±å°† <span class="math inline">\(S\)</span> æå‡ºæ¥ï¼Œæå‰æŠŠåé¢çš„ <span class="math inline">\(c\)</span> ä¹˜ä¸Šä¸å°±è¡Œäº†ï¼Ÿ</p><p>ä¸­é—´çš„ç»“æœä¸å¯¹åŠ²ä¹Ÿæ— æ‰€è°“ï¼Œåªè¦æœ€åçš„ç­”æ¡ˆæ˜¯å¯¹çš„å°±è¡Œäº†ã€‚</p><blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥æ±‚å‡ºæ¯æ‰¹ä»»åŠ¡çš„å®Œæˆæ—¶åˆ»ï¼Œè€Œæ˜¯åœ¨ä¸€æ‰¹ä»»åŠ¡<strong>ã€Œå¼€å§‹ã€</strong>å¯¹åç»­ä»»åŠ¡äº§ç”Ÿå½±å“æ—¶ï¼Œå°±å…ˆæŠŠè´¹ç”¨ç´¯åŠ åˆ°ç­”æ¡ˆä¸­ã€‚è¿™æ˜¯ä¸€ç§åä¸º<strong>ã€Œè´¹ç”¨æå‰è®¡ç®—ã€</strong>çš„ç»å…¸æ€æƒ³ã€‚</p><p align="right">â€”â€”æç…œä¸œã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹</p></blockquote><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š <span class="math display">\[f_i=\min\limits_{0\leqslant j&lt;i}\{f_j+(c_i-c_j)\times t_i+s\times(c_n-c_j)\}\]</span> æ­¤å¤„ï¼Œ<span class="math inline">\(f_i\)</span> æ²¡æœ‰å…·ä½“å«ä¹‰ã€‚</p><pre class="cpp"><code>#include &lt;cstdio&gt;#include &lt;cstring&gt;#define int long longconst int maxn = 1e4 + 5;const int LEN = (1 &lt;&lt; 20);int n, s;int f[maxn], t[maxn], c[maxn];inline int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;#ifdef ONLINE_JUDGEinline int nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF; p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;signed main() &#123;    read(n); read(s);    memset(f, 0x3f, sizeof (f));    for (int i = 1; i &lt;= n; ++i) &#123;        read(t[i]); read(c[i]);        t[i] += t[i - 1];        c[i] += c[i - 1];    &#125;    f[0] = 0;    for (int i = 1; i &lt;= n; ++i) &#123;        for (int j = 0; j &lt; i; ++j)            f[i] = min(f[i], f[j] + t[i]* (c[i] - c[j]) + s * (c[n] - c[j]));    &#125;    printf(&quot;%lld&quot;, f[n]);    return 0;&#125;</code></pre><hr /><h3 id="ä»»åŠ¡å®‰æ’-2"><a href="https://loj.ac/p/10185">ä»»åŠ¡å®‰æ’ 2</a></h3><p><a href="https://www.acwing.com/problem/content/303/">åŒå€ç»éªŒ</a></p><p><span class="math inline">\(n\)</span> çš„èŒƒå›´å˜å¤§äº†ï¼Œ<span class="math inline">\(n^2\)</span> è¿‡ä¸äº†ã€‚</p><p>è¿™ä¸éšæ‰‹åŠ ä¸ªæ–œç‡ä¼˜åŒ–çš„äº‹å„¿å—ã€‚</p><p>æˆ‘ä»¬ç»§ç»­çæè¿™ä¸ªå¼å­ã€‚ <span class="math display">\[\begin{aligned}f_i&amp;=\min\{f_j+(c_i-c_j)\times t_i+s\times(c_n-c_j)\}\\&amp;=\min\{f_j+c_i\times t_i-c_j\times t_i+s\times c_n-s\times c_j\}\\&amp;=\min\{f_j-c_j\times t_i-s\times c_j\}+c_i\times t_i+s\times c_n\end{aligned}\]</span> ä»¤ <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span> ä¸” <span class="math inline">\(j&lt;k\)</span> ã€‚</p><p>åˆ™æœ‰ï¼š <span class="math display">\[f_j-c_j\times t_i-s\times c_j&lt;f_k-c_k\times t_i-s\times c_k\\f_j-f_k-s\times c_j+s\times c_k&lt;c_j\times t_i-c_k\times t_i\\f_j-f_k-s\times c_j+s\times c_k&lt;t_i\times(c_j-c_k)\\\dfrac{(f_j-s\times c_j)-(f_k-s\times c_k)}{(c_j)-(c_k)}&lt;t_i\]</span> ç„¶åå°±æ˜¯è€å¥—è·¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(\mathcal O(n)\)</span>ã€‚</p><pre class="cpp"><code>#include &lt;cstdio&gt;#define int long longconst int maxn = 5e5 + 5;const int LEN = (1 &lt;&lt; 20);int n, s, L, R;int f[maxn], t[maxn], c[maxn], q[maxn];#define nec getcharinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1; ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;inline int getup(int j, int k) &#123; return (f[j] - s * c[j]) - (f[k] - s * c[k]); &#125;inline int getdown(int j, int k) &#123; return (c[j]) - (c[k]); &#125;inline int getDP(int i, int j) &#123; return f[j] + (c[i] - c[j]) * t[i] + s * (c[n] - c[j]); &#125;signed main() &#123;    read(n); read(s);    L = R = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(t[i]); read(c[i]);        t[i] += t[i - 1];        c[i] += c[i - 1];    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        while (L &lt; R &amp;&amp; getup(q[L + 1], q[L]) &lt;= t[i] * getdown(q[L + 1], q[L]))            ++L;        f[i] = getDP(i, q[L]);        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &lt;= getdown(i, q[R]) * getup(q[R], q[R - 1]))            --R;        q[++R] = i;    &#125;    printf(&quot;%lld&quot;, f[n]);    return 0;&#125;</code></pre><hr /><h3 id="ä»»åŠ¡å®‰æ’-3"><a href="https://www.luogu.com.cn/problem/P5785">ä»»åŠ¡å®‰æ’ 3</a></h3><p><a href="https://loj.ac/p/10186">åŒå€ç»éªŒ</a> | <a href="https://www.acwing.com/problem/content/304/">ä¸‰å€ç»éªŒ</a></p><p>æ³¨æ„ <span class="math inline">\(t\)</span> æœ‰å¯èƒ½æ˜¯è´Ÿæ•°ã€‚</p><p><span class="math inline">\(t\)</span> ï¼ˆè¾“å…¥ï¼‰æœ‰å¯èƒ½ä¸ºè´Ÿï¼Œä»£è¡¨ç€ <span class="math inline">\(t\)</span>ï¼ˆå‰ç¼€å’Œï¼‰ä¸å†å•è°ƒé€’å¢ï¼Œç”¨ä¸å•è°ƒçš„å¯¹è±¡ä½œä¸ºå•è°ƒé˜Ÿåˆ—çš„æ¡ä»¶ä¸€çœ‹å°±ååˆ†ä¸è®²æ­¦å¾·ï¼Œè¿™æ ·ç»´æŠ¤å‡ºæ¥çš„é˜Ÿå¤´æ˜¾ç„¶ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚</p><p>åé¢çš„ <span class="math inline">\(t,c\)</span> é»˜è®¤ä¸ºå‰ç¼€å’Œã€‚</p><p>æˆ‘ä»¬æ„Ÿæ€§è¯æ˜ä¸€ä¸‹ã€‚</p><p>ä¸€ä¸ªæœ€æ™®é€šçš„ä¾‹å­ï¼Œå‡è®¾è¾“å…¥äº†ä¸€ä¸ªè´Ÿæ•°ï¼Œå¯¼è‡´ <span class="math inline">\(t_i&lt;t_{i-1}\)</span>ï¼Œä¸”æœ‰ä¸€æ–œç‡ <span class="math inline">\(&gt;t_i\)</span> ä¸” <span class="math inline">\(&lt;t_{i-1}\)</span>ã€‚</p><p>é‚£ä¹ˆåœ¨ <span class="math inline">\(i-1\)</span> æ—¶ï¼Œå®ƒå°±è¢«ç»´æŠ¤é˜Ÿå¤´çš„æ“ä½œå‰”æ‰äº†ï¼Œä½†ä¹Ÿè®¸å®ƒå‡‘å·§å°±æ˜¯ <span class="math inline">\(i\)</span> çš„æœ€ä¼˜è§£ï¼Œå‘œå‘¼å“€å“‰ã€‚</p><p>äºæ˜¯æˆ‘ä»¬ä¸èƒ½åˆ é˜Ÿå¤´å…ƒç´ äº†ã€‚é‚£æ€ä¹ˆæŸ¥è¯¢æœ€ä¼˜è§£å‘¢ï¼Ÿ</p><p>å•è°ƒé˜Ÿåˆ—é‡Œè£…çš„å§‹ç»ˆè¿˜æ˜¯ä¸ªå…·æœ‰å•è°ƒæ€§çš„ä¸‹å‡¸åŒ…ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨é˜Ÿåˆ—ä¸­äºŒåˆ†ä¸€ä¸ª <span class="math inline">\(pos\)</span>ï¼Œ<span class="math inline">\(pos\)</span> ä¸ <span class="math inline">\(pos-1\)</span> å½¢æˆçš„æ–œç‡æ¯” <span class="math inline">\(t_i\)</span> å°ï¼Œ<span class="math inline">\(pos+1\)</span> ä¸ <span class="math inline">\(pos\)</span> å½¢æˆçš„æ–œç‡æ¯” <span class="math inline">\(t_i\)</span> å¤§ã€‚</p><p>ç„¶åæŠŠ <span class="math inline">\(pos\)</span> å½“æˆ <span class="math inline">\(q_l\)</span> æ¥å¤„ç†å°±å¥½äº†ã€‚</p><p>é˜Ÿå°¾è¿˜æ˜¯ç»´æŠ¤ä¸€ä¸ªä¸‹å‡¸ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ <span class="math inline">\(\mathcal O(n\log_2n)\)</span>ã€‚</p><p><em>å¼ºçƒˆå»ºè®®ä¸è¦å»åŠ¨ AcWing ç‰ˆæœ¬çš„é‚£é“ã€‚</em></p><p><em>æœ€åä¸¤ç»„æ•°æ®å ªç§°æ¯’ç˜¤ã€‚</em></p><p><em>å¡ <code>long long</code> ä¹˜æ³•ï¼Œå¡ <code>__int128</code> æ—¶é™ï¼Œå¡ <code>double</code>ç²¾åº¦ï¼Œé T å³ WAã€‚</em></p><p><em>åæ­£æˆ‘æäº†åŠä¸ªå°æ—¶ç¡¬æ˜¯æ²¡æœ‰æå‡ºæ¥ã€‚</em></p><pre class="cpp"><code>#include &lt;cstdio&gt;#define int long longconst int maxn = 3e5 + 5;const int LEN = (1 &lt;&lt; 20);int n, s, L, R;int f[maxn], t[maxn], c[maxn], q[maxn];#define nec getcharinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1; ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;inline int getup(int j, int k) &#123; return (f[j] - s * c[j]) - (f[k] - s * c[k]); &#125;inline int getdown(int j, int k) &#123; return (c[j]) - (c[k]); &#125;inline int getDP(int i, int j) &#123; return f[j] + t[i] * (c[i] - c[j]) + s * (c[n] - c[j]); &#125;inline int Func(int u) &#123;    if (L == R) return q[L];    int l = L, r = R;    while (l &lt; r) &#123;        int mid = l + r &gt;&gt; 1;        if (getup(q[mid + 1], q[mid]) &lt;= u * getdown(q[mid + 1], q[mid]))            l = mid + 1;        else r = mid;    &#125;    return l;&#125;signed main() &#123;    read(n); read(s);    L = R = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(t[i]); read(c[i]);        t[i] += t[i - 1];        c[i] += c[i - 1];    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        int Best = Func(t[i]);        f[i] = getDP(i, q[Best]);        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &lt;= getdown(i, q[R]) * getup(q[R], q[R - 1]))            --R;        q[++R] = i;    &#125;    printf(&quot;%lld&quot;, f[n]);    return 0;&#125;</code></pre><hr /><h3 id="åœŸåœ°è´­ä¹°"><a href="https://www.luogu.com.cn/problem/P2900">åœŸåœ°è´­ä¹°</a></h3><p>é¦–å…ˆæˆ‘ä»¬æƒ³æ˜ç™½ä¸€ä»¶äº‹æƒ…ï¼šå¦‚æœä¸€å—åœŸåœ°ï¼Œæœ‰å¦ä¸€å—åœŸåœ°çš„é•¿å’Œå®½éƒ½æ¯”å®ƒå¤§ï¼Œé‚£å°±ä¸ç”¨å†ç†å®ƒäº†ï¼Œç›´æ¥ä»æ€»åºåˆ—é‡Œå‰”é™¤ã€‚</p><pre class="cpp"><code>struct _ &#123;    int w, l;    bool operator&lt; (const _ q) const &#123;        return w == q.w ? l &gt; q.l : w &gt; q.w;    &#125;&#125; a[maxn];...std::sort(a + 1, a + n + 1);for (int i = 1; i &lt;= n; ++i) &#123;    if (a[i].l &gt; a[cnt].l)        a[++cnt] = a[i];&#125;</code></pre><p>ç„¶åå°±æ¨å¼å­ã€‚</p><p>è´ªå¿ƒåœ°æƒ³ï¼Œåœ¨å‰é¢çš„æ“ä½œåï¼Œ<span class="math inline">\(a\)</span> æ˜¯ä¸€ä¸ª <span class="math inline">\(w\)</span> é€’å‡ï¼Œ<span class="math inline">\(l\)</span> é€’å¢çš„åœŸåœ°åºåˆ—ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬é€‰æ‹©å°†è¿ç»­çš„ä¸€æ®µåŒºé—´åˆ†ä¸ºä¸€ç»„ï¼Œè¿™æ ·çš„è¯ï¼Œä¸€ä¸ªç»„é‡Œçš„ä¸€æ®µè¿ç»­çš„åœŸåœ° <span class="math inline">\([x,y]\)</span> å°±åªæœ‰ <span class="math inline">\(w_x\)</span> å’Œ <span class="math inline">\(l_y\)</span> èµ·äº†ä½œç”¨ï¼Œåˆæ²¡æœ‰ä¸­é—´é‚£ä¸€æ®µçš„äº‹äº†ã€‚</p><p>è®¾ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºåˆ†é…å®Œç¬¬ <span class="math inline">\(i\)</span> å—åœŸåœ°åçš„æœ€å°èŠ±è´¹ã€‚</p><p>åˆ™æœ‰ï¼š <span class="math display">\[f_i=\min\{f_j+w_{j+1}\times l_i\}\]</span> ä»¤ <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ã€‚</p><p>åˆ™æœ‰ï¼š <span class="math display">\[f_j+w_{j+1}\times l_i&lt;f_k+w_{k+1}\times l_i\\f_j-f_k&lt;(-w_{j+1}+w_{k+1})\times l_i\\\dfrac{(f_j)-(f_k)}{(-w_{j+1})+(w_{k+1})}&lt;l_i\]</span></p><pre class="cpp"><code>#include &lt;cstdio&gt;#include &lt;algorithm&gt;#define int long longconst int maxn = 5e4 + 5;struct _ &#123;    int w, l;    bool operator&lt; (const _ q) const&#123;        return w == q.w ? l &gt; q.l : w &gt; q.w;    &#125;&#125;;_ a[maxn];int n, cnt, l, r;int q[maxn], f[maxn];int getup(int j, int k) &#123; return f[j] - f[k]; &#125;int getdown(int j,int k) &#123; return a[k + 1].w - a[j + 1].w; &#125;int getDP(int i,int j) &#123; return f[j] + a[j + 1].w * a[i].l; &#125;signed main() &#123;    scanf(&quot;%lld&quot;, &amp;n);    for(int i = 1; i &lt;= n; ++i)        scanf(&quot;%lld %lld&quot;, &amp;a[i].w, &amp;a[i].l);    std::sort(a + 1, a + n + 1);    for (int i = 1; i &lt;= n; ++i) &#123;        if (a[i].l &gt; a[cnt].l)            a[++cnt] = a[i];    &#125;    n = cnt; l = r = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        while (l &lt; r &amp;&amp; getup(q[l + 1], q[l]) &lt;= a[i].l * getdown(q[l + 1], q[l]))            l++;        f[i] = getDP(i, q[l]);        while (l &lt; r &amp;&amp; getup(i, q[r]) * getdown(q[r], q[r - 1]) &lt;= getup(q[r],q[r - 1]) * getdown(i, q[r]))            r--;        q[++r] = i;    &#125;    printf(&quot;%lld&quot;, f[n]);    return 0;&#125;</code></pre><hr /><h3 id="ä»“åº“å»ºè®¾"><a href="https://www.luogu.com.cn/problem/P2120">ä»“åº“å»ºè®¾</a></h3><p><a href="https://loj.ac/p/10189">åŒå€ç»éªŒ</a> | <a href="https://www.acwing.com/problem/content/description/1095/">ä¸‰å€ç»éªŒ</a></p><p>è®¾ <span class="math inline">\(f_i\)</span> è¡¨ç¤ºåœ¨ <span class="math inline">\(i\)</span> å·¥å‚å»ºç«‹ä»“åº“çš„æœ€å°èŠ±è´¹ã€‚</p><p>åˆ™æœ‰ï¼š <span class="math display">\[\begin{aligned}f_i&amp;=\min\{f_j+\sum\limits_{k=j+1}^{i-1}[(x_i-x_k)\times p_k]+c_i\}\\&amp;=\min\{f_j+\sum\limits_{k=j+1}^{i-1}(x_i\times p_k)-\sum\limits_{k=j+1}^{i-1}(x_k\times p_k)\}+c_i\\&amp;=\min\{f_j+x_i\times\sum\limits_{k=j+1}^{i-1}p_k-\sum\limits_{k=j+1}^{i-1}(x_k\times p_k)\}+c_i\end{aligned}\]</span> åˆ©ç”¨å‰ç¼€å’Œä¼˜åŒ–ï¼šè®¾ <span class="math inline">\(a\)</span> ä¸º <span class="math inline">\(p\)</span> çš„å‰ç¼€å’Œæ•°ç»„ï¼Œ<span class="math inline">\(b\)</span> ä¸º <span class="math inline">\(x_i\times p_i\)</span> çš„å‰ç¼€å’Œæ•°ç»„ã€‚</p><p>åˆ™åŸå¼å¯åŒ–ä¸ºï¼š <span class="math display">\[\begin{aligned}f_i&amp;=\min\{f_j+x_i\times(a_{i-1}-a_j)-(b_{i-1}-b_j)\}+c_i\\&amp;=\min\{f_j+x_i\times a_{i-1}-x_i\times a_j-b_{i-1}+b_j\}+c_i\\&amp;=\min\{f_j-x_i\times a_j+b_j\}+x_i\times a_{i-1}-b_{i-1}+c_i\end{aligned}\]</span> ä»¤ <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span> ã€‚</p><p>åˆ™æœ‰ï¼š <span class="math display">\[f_j-x_i\times a_j+b_j&lt;f_k-x_i\times a_k+b_k\\f_j-f_k+b_j-b_k&lt;x_i\times a_j-x_i\times a_k\\\dfrac{(f_j+b_j)-(f_k+b_k)}{a_j-a_k}&lt;x_i\]</span></p><p><em>æƒ³æ„Ÿå—äººç”Ÿçš„åŒå­¦ä»¬å¯ä»¥å°è¯•åšä¸€ä¸‹ AcWing é‚£ä¸ªç‰ˆæœ¬ï¼Œé MLE å³ WAï¼Œçˆ½åˆ°ç‚¸ã€‚</em></p><pre class="cpp"><code>#include &lt;cstdio&gt;#define int long longconst int maxn = 1e6 + 5;const int LEN = (1 &lt;&lt; 20);int n, L, R;int f[maxn], x[maxn], p[maxn];int a[maxn], b[maxn], c[maxn], q[maxn];#ifdef ONLINE_JUDGEinline int nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF; p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;inline int getup(int j, int k) &#123; return (f[j] + b[j]) - (f[k] + b[k]); &#125;inline int getdown(int j, int k) &#123; return (a[j]) - (a[k]); &#125;inline int getDP(int i, int j) &#123; return f[j] - x[i] * a[j] + b[j] + x[i] * a[i - 1] - b[i - 1] + c[i]; &#125;signed main() &#123;    read(n); L = R = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(x[i]); read(p[i]); read(c[i]);        a[i] = a[i - 1] + p[i];        b[i] = b[i - 1] + x[i] * p[i];    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        while (L &lt; R &amp;&amp; getup(q[L + 1], q[L]) &lt;= x[i] * getdown(q[L + 1], q[L]))            ++L;        f[i] = getDP(i, q[L]);        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &lt;= getdown(i, q[R]) * getup(q[R], q[R - 1]))            --R;        q[++R] = i;    &#125;    printf(&quot;%lld&quot;, f[n]);    return 0;&#125;</code></pre><hr /><h3 id="é”¯æœ¨å‚é€‰å€"><a href="https://www.luogu.com.cn/problem/P4360">é”¯æœ¨å‚é€‰å€</a></h3><p><a href="https://loj.ac/p/10192">åŒå€ç»éªŒ</a> | <a href="https://www.acwing.com/problem/content/1097/">ä¸‰å€ç»éªŒ</a></p><p>å’Œä»“åº“å»ºè®¾å¾ˆåƒã€‚</p><p>è®¾ <span class="math inline">\(A_i=\sum\limits_{j=i}^nd_j\)</span>ï¼Œè¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> æ£µæ ‘ä¸å±±è„šçš„è·ç¦»ï¼›<span class="math inline">\(B_i=\sum\limits_{j=1}^iw_j\)</span>ï¼Œè¡¨ç¤º <span class="math inline">\(w\)</span> çš„å‰ç¼€å’Œï¼›<span class="math inline">\(S=\sum\limits_{i=1}^nA_i\times w_i\)</span>ï¼Œè¡¨ç¤ºå°†æ‰€æœ‰æ ‘å…¨éƒ¨è¿åˆ°å±±è„šçš„èŠ±è´¹æ€»å’Œã€‚</p><p>å‡è®¾åœ¨ <span class="math inline">\(j\)</span> å¤„å»ºç«‹ç¬¬ <span class="math inline">\(1\)</span> åº§é”¯æœ¨å‚ï¼Œåœ¨ <span class="math inline">\(i\)</span> å¤„å»ºç«‹ç¬¬ <span class="math inline">\(2\)</span> åº§é”¯æœ¨å‚ï¼Œæ­¤æ—¶ï¼š</p><ul><li>å¯¹äºç¬¬ <span class="math inline">\(1\sim j\)</span> æ£µæ ‘æ¥è¯´ï¼Œ<span class="math inline">\(S\)</span> æ¯”å®é™…æƒ…å†µå¤šè¿äº† <span class="math inline">\(A_j\)</span> çš„è·¯ç¨‹ï¼›</li><li>å¯¹äºç¬¬ <span class="math inline">\(j+1\sim i\)</span> æ£µæ ‘æ¥è¯´ï¼Œ<span class="math inline">\(S\)</span> æ¯”å®é™…æƒ…å†µå¤šè¿äº† <span class="math inline">\(A_i\)</span> çš„è·¯ç¨‹ã€‚</li></ul><p>å°†å¯¹åº”çš„å¤šè¿çš„è·ç¦»ä¸èŠ±è´¹ç›¸ä¹˜çš„ç»“æœï¼Œè®© <span class="math inline">\(S\)</span> å°†å…¶å‡å»å³å¯ã€‚ <span class="math display">\[\begin{aligned}ans&amp;=\min\{S-A_j\times B_j-(B_i-B_j)\times A_i\}\\   &amp;=\min\{A_i\times B_j-A_j\times B_j\}+S-A_i\times B_i\end{aligned}\]</span> ä»¤ <span class="math inline">\(j&lt;k\)</span> ä¸” <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ï¼Œåˆ™æœ‰ï¼š <span class="math display">\[\begin{aligned}A_i\times B_j-A_j\times B_j&amp;&lt;A_i\times B_k-A_k\times B_k\\-A_j\times B_j+A_k\times B_k&amp;&lt;-A_i\times B_j+A_i\times B_k\\\dfrac{-A_j\times B_j+A_k\times B_k}{-B_j+B_k}&amp;&lt;A_i\\\dfrac{A_j\times B_j-A_k\times B_k}{B_j-B_k}&amp;&lt;A_i\\\end{aligned}\]</span> å…¶ä¸­ï¼Œ<span class="math inline">\(A_i\)</span> å…·æœ‰å•è°ƒæ€§ï¼Œå¯ä»¥ç›´æ¥å¥—æ¿å­ã€‚</p><pre class="cpp"><code>#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;algorithm&gt;#define int long longconst int inf = 1e18;const int maxn = 1e6 + 5;const int LEN = (1 &lt;&lt; 20);int w[maxn], d[maxn];int n, L, R, s, ans = inf;int q[maxn], a[maxn], b[maxn];inline int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;inline int getDP(int i, int j) &#123;    return s - a[j] * b[j] - (b[i] - b[j]) * a[i];&#125;inline int getup(int j, int k) &#123;    return a[j] * b[j] - a[k] * b[k];&#125;inline int getdown(int j, int k) &#123;    return b[j] - b[k];&#125;#ifdef ONLINE_JUDGEinline int nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF; p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;signed main() &#123;    read(n);    L = R = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(w[i]), read(d[i]);        b[i] = b[i - 1] + w[i];    &#125;    for (int i = n; i; --i) &#123;        a[i] = a[i + 1] + d[i];        s += a[i] * w[i];    &#125;    for (int i = 1; i &lt;= n; ++i) &#123;        while (L &lt; R &amp;&amp; getup(q[L + 1], q[L]) &gt;= a[i] * getdown(q[L + 1], q[L]))            ++L;        ans = min(ans, getDP(i, q[L]));        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &gt;= getup(q[R], q[R - 1]) * getdown(i, q[R]))            --R;        q[++R] = i;    &#125;    printf(&quot;%lld&quot;, ans);    return 0;&#125;</code></pre><hr /><h3 id="cats-transport"><a href="https://www.luogu.com.cn/problem/CF311B">Cats Transport</a></h3><p><a href="https://www.acwing.com/problem/content/305/">åŒå€ç»éªŒ</a> | <a href="http://codeforces.com/problemset/problem/311/B">ä¸‰å€ç»éªŒ</a></p><p>ç»éªŒï¼šæ´›è°·çš„é¢˜é¢æ¯”è“ä¹¦å’Œ AcWing ä¸Šçš„æ ‡å‡†å¤šäº†ï¼Œè“ä¹¦çš„é¢˜æ„ä¸æ¸…ã€‚</p><p>ç ”ç©¶è¡¨æ˜ï¼Œè¾¹çŒ›çŒå…»ä¹å¤šè¾¹çœ‹è“ä¹¦æœ‰åŠ©äºç†è§£ã€‚</p><p>è¿™é“é¢˜éš¾åœ¨æ¨å¼å­ã€‚<del>ä¸ç„¶è¿˜èƒ½éš¾åœ¨å“ªé‡Œ</del></p><p>è®¾ <span class="math inline">\(A_i\)</span> è¡¨ç¤ºè¦æ¥åˆ°ç¬¬ <span class="math inline">\(i\)</span> åªçŒ«çš„æœ€æ—©å‡ºå‘æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ­¤æ—¶å‡ºå‘ï¼ŒçŒ« <span class="math inline">\(i\)</span> çš„ç­‰å¾…æ—¶é—´ä¸º <span class="math inline">\(0\)</span>ã€‚</p><p>å³ <span class="math inline">\(A_i=T_i-\sum\limits_{j=1}^{H_i}D_j\)</span>ï¼Œä¹Ÿå°±æ˜¯å‡ºå‘æ—¶é—´=åˆ°è¾¾æ—¶é—´-ç»è¿‡æ—¶é—´ã€‚</p><p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æŠŠå…¶ä»–æ‰€æœ‰å› ç´ å»æ‰ï¼Œé¢˜æ„è½¬æ¢ä¸ºï¼š</p><blockquote><p>å·²çŸ¥åœ¨ <span class="math inline">\(\geqslant A_i\)</span> çš„æ—¶åˆ»å‡ºå‘å¯ä»¥æ¥åˆ°çŒ« <span class="math inline">\(i\)</span> ï¼Œåœ¨ <span class="math inline">\(P\)</span> æ¬¡å‡ºå‘æ¬¡æ•°çš„é™åˆ¶å†…æ¥åˆ°æ‰€æœ‰çŒ«ï¼ŒçŒ«çš„ç­‰å¾…æ—¶é—´ä¹‹å’Œæœ€å°æ˜¯å¤šå°‘ï¼Ÿ</p></blockquote><p>å‡è®¾é¥²å…»å‘˜åœ¨ <span class="math inline">\(t\)</span> æ—¶åˆ»å‡ºå‘ï¼ŒçŒ« <span class="math inline">\(i\)</span> çš„ç­‰å¾…æ—¶é—´å°±æ˜¯ <span class="math inline">\(t-A_i\)</span>ã€‚</p><p>å¯¹ <span class="math inline">\(A_i\)</span> ä»å°åˆ°å¤§æ’åºã€‚</p><p>æ˜¾ç„¶ï¼Œä¸€æ¬¡æ¥ä¸€æ®µè¿ç»­çš„çŒ«ï¼ŒèŠ±è´¹è‡ªç„¶æ˜¯æœ€å°çš„ã€‚</p><p>è‹¥æˆ‘ä»¬è¦æ¥ <span class="math inline">\([k+1,j]\)</span> èŒƒå›´å†…çš„çŒ«ï¼Œå®ƒä»¬çš„ç­‰å¾…æ—¶é—´ä¹‹å’Œå°±æ˜¯ï¼š <span class="math display">\[\begin{aligned}\sum\limits_{p=k+1}^{j}(A_j-A_p)&amp;=[j-(k+1)+1]A_j-\sum\limits_{p=k+1}^{j}A_p\\&amp;=(j-k)\times A_j-(S_j-S_k)\\&amp;=j\times A_j-k\times A_j-S_j+S_k\end{aligned}\]</span> å…¶ä¸­ <span class="math inline">\(S\)</span> ä¸º <span class="math inline">\(A\)</span> çš„å‰ç¼€å’Œã€‚</p><p>è®¾ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºå‰ <span class="math inline">\(i\)</span> ä¸ªé¥²å…»å‘˜å¸¦èµ°å‰ <span class="math inline">\(j\)</span> åªçŒ«çš„æœ€å°èŠ±è´¹ã€‚</p><p>åˆ™æœ‰ï¼š <span class="math display">\[\begin{aligned}f_{i,j}&amp;=\min\{f_{i-1,k}+j\times A_j-k\times A_j-S_j+S_k\}\\&amp;=\min\{f_{i-1,k}-A_j\times k+S_k\}+A_j\times j-S_j\end{aligned}\]</span></p><p>æˆ‘ä»¬å°†å¾ªç¯åœ°æšä¸¾æ¯ä¸ªé¥²å…»å‘˜çš„å¾ªç¯å˜é‡ <span class="math inline">\(i\)</span> çœ‹åšå¸¸é‡ã€‚</p><p>ä»¤ <span class="math inline">\(x\)</span> ä¼˜äº <span class="math inline">\(y\)</span>ï¼Œåˆ™æœ‰ï¼š <span class="math display">\[f_{i-1,x}-A_j\times x+S_x&lt;f_{i-1,y}-A_j\times y+S_y\\\dfrac{(f_{i-1,x}+S_x)-(f_{i-1,y+S_y})}{x-y}&lt;A_j\]</span> <strong>æ³¨æ„äº‹é¡¹</strong></p><p><span class="math inline">\(f\)</span> åˆå§‹åŒ–ä¸ºæå¤§å€¼ã€‚</p><pre class="cpp"><code>#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;algorithm&gt;#define int long longconst int maxp = 105;const int maxn = 1e5 + 5;const int LEN = (1 &lt;&lt; 20);int f[maxp][maxn];int n, m, p, L, R, t, h;int q[maxn], a[maxn], d[maxn], s[maxn];inline int getDP(int i, int j, int k) &#123;    return f[i - 1][k] + (j - k) * a[j] - (s[j] - s[k]);&#125;inline int getup(int i, int j, int k) &#123;    return (f[i - 1][j] + s[j]) - (f[i - 1][k] + s[k]);&#125;inline int getdown(int j, int k) &#123;    return (j) - (k);&#125;#ifdef ONLINE_JUDGEinline int nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF; p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;signed main() &#123;    read(n); read(m); read(p);    memset(f, 0x3f, sizeof (f));    for (int i = 2; i &lt;= n; ++i)        read(d[i]), d[i] += d[i - 1];    for (int i = 1; i &lt;= m; ++i) &#123;        read(h); read(t);        a[i] = t - d[h];    &#125;    std::sort(a + 1, a + m + 1);    for (int i = 1; i &lt;= m; ++i)        s[i] = s[i - 1] + a[i];    f[0][0] = 0;    for (int i = 1; i &lt;= p; ++i) &#123;        L = R = 1;        for (int j = 1; j &lt;= m; ++j) &#123;            while (L &lt; R &amp;&amp; getup(i, q[L + 1], q[L]) &lt;= a[j] * getdown(q[L + 1], q[L]))                ++L;            f[i][j] = getDP(i, j, q[L]);            while (L &lt; R &amp;&amp; getup(i, j, q[R]) * getdown(q[R], q[R - 1]) &lt;= getup(i, q[R], q[R - 1]) * getdown(j, q[R]))                --R;            q[++R] = j;        &#125;    &#125;    printf(&quot;%lld&quot;, f[p][m]);    return 0;&#125;</code></pre><hr /><h3 id="ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ"><a href="https://www.luogu.com.cn/problem/P3628">ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ</a></h3><p><a href="https://www.acwing.com/problem/content/337/">åŒå€ç»éªŒ</a> | <a href="https://loj.ac/p/10190">ä¸‰å€ç»éªŒ</a></p><p>ç›´æ¥æ¨å¼å­ã€‚ <span class="math display">\[\begin{aligned}f_i&amp;=\max\{f_j+a\times(s_i-s_j)^2+b\times(s_i-s_j)+c\ \}\\&amp;=\max\{f_j+a\times({s_i}^2-2\times s_i\times s_j+{s_j}^2)+b\times s_i-b\times s_j\ \}+c\\&amp;=\max\{f_j+a\times{s_i}^2-2\times a\times s_i\times s_j+a\times{s_j}^2-b\times s_j\ \}+b\times s_i+c\\&amp;=\max\{f_j-2\times a\times s_i\times s_j+a\times{s_j}^2-b\times s_j\ \}+a\times{s_i}^2+b\times s_i+c\\\end{aligned}\]</span> ä»¤ <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ï¼Œåˆ™æœ‰ï¼š <span class="math display">\[\begin{aligned}f_j-2\times a\times s_i\times s_j+a\times{s_j}^2-b\times s_j&amp;&gt;f_k-2\times a\times s_i\times s_k+a\times{s_k}^2-b\times s_k\\(f_j+a\times{s_j}^2-b\times s_j)-(f_k+a\times{s_k}^2-b\times s_k)&amp;&gt;(2\times a\times s_i\times s_j)-(2\times a\times s_i\times s_k)\\\dfrac{(f_j+a\times{s_j}^2-b\times s_j)-(f_k+a\times{s_k}^2-b\times s_k)}{(2\times a\times s_j) - (2\times a\times s_k)}&amp;&gt;s_i\\\end{aligned}\]</span> æˆ‘ä»¬å‘ç°ä¸­é—´çš„ç¬¦å·æ˜¯ <span class="math inline">\(&gt;\)</span>ã€‚</p><p>æ‰€ä»¥æˆ‘ä»¬åœ¨å¼¹é˜Ÿå¤´çš„æ—¶å€™ï¼Œè¦æŠŠåˆ¤æ–­æ¡ä»¶ä¸­çš„ç¬¦å·åè¿‡æ¥ã€‚</p><pre class="cpp"><code>#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;algorithm&gt;#define int long longconst int maxn = 1e6 + 5;const int LEN = (1 &lt;&lt; 20);int n, L, R, a, b ,c;int q[maxn], s[maxn], f[maxn];inline int getDP(int i, int j) &#123;    return f[j] + a * (s[i] - s[j]) * (s[i] - s[j]) + b * (s[i] - s[j]) + c;&#125;inline int getup(int j, int k) &#123;    return (f[j] + a * s[j] * s[j] - b * s[j]) - (f[k] + a * s[k] * s[k] - b * s[k]);&#125;inline int getdown(int j, int k) &#123;    return (2 * a * s[j]) - (2 * a * s[k]);&#125;#ifdef ONLINE_JUDGEinline int nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF; p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;signed main() &#123;    read(n); read(a); read(b); read(c);    L = R = 1;    for (int i = 1; i &lt;= n; ++i) &#123;        read(s[i]), s[i] += s[i - 1];        while (L &lt; R &amp;&amp; getup(q[L + 1], q[L]) &gt;= s[i] * getdown(q[L + 1], q[L]))            ++L;        f[i] = getDP(i, q[L]);        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &lt;= getup(q[R], q[R - 1]) * getdown(i, q[R]))            --R;        q[++R] = i;    &#125;    printf(&quot;%lld&quot;, f[n]);    return 0;&#125;</code></pre><hr /><h3 id="å¾é€”"><a href="https://www.luogu.com.cn/problem/P4072">å¾é€”</a></h3><p><a href="https://loj.ac/p/2035">åŒå€ç»éªŒ</a> | <a href="https://www.acwing.com/problem/content/2575/">ä¸‰å€ç»éªŒ</a></p><p>æ˜æ˜¾ï¼Œä¸åŒ–æ‰ <span class="math inline">\(v\times m^2\)</span> å°±æ— æ³•è¿›è¡Œä¼˜åŒ–ã€‚</p><p>è®¾ <span class="math inline">\(x\)</span> ä¸ºå½“å‰ä¼‘æ¯ç«™ç‚¹ä¸ä¸Šä¸€ä¼‘æ¯ç«™ç‚¹çš„è·ç¦»ï¼Œ <span class="math inline">\(x_0\)</span> ä¸º <span class="math inline">\(x_1\sim x_n\)</span> çš„å¹³å‡æ•°ï¼Œ<span class="math inline">\(S\)</span> ä¸º <span class="math inline">\(x\)</span> çš„å‰ç¼€å’Œã€‚ <span class="math display">\[\begin{aligned}V\times m^2&amp;=[(x_1-x_0)^2+(x_2-x_0)^2+\cdots+(x_m-x_0)^2]\times m\\&amp;=m\times \sum\limits_{i=1}^{m}{x_i}^2+(m\times {x_0})^2-2\times (x_0\times m)\times \sum\limits_{i=1}^{m}x_i\\&amp;=m\times \sum\limits_{i=1}^{m}{x_i}^2+{S_m}^2-2\times{S_m}^2\\&amp;=m\times \sum\limits_{i=1}^{m}{x_i}^2-{S_m}^2\end{aligned}\]</span></p><p>å…¶ä¸­ <span class="math inline">\(S_m\)</span> æ˜¯ä¸€ä¸ªå®šå€¼ï¼ˆå³è¾“å…¥æ‰€æœ‰è·¯çš„é•¿åº¦å’Œï¼‰ã€‚</p><p>å”¯ä¸€éœ€è¦è®¡ç®—çš„ï¼Œå°±æ˜¯ <span class="math inline">\(\sum\limits_{i=1}^{m}{x_i}^{2}\)</span>ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ¥ DP å®ƒã€‚</p><p>è®¾ <span class="math inline">\(a\)</span> ä¸ºè¾“å…¥é“è·¯é•¿åº¦çš„å‰ç¼€å’Œæ•°ç»„ï¼Œ<span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> æ¬¡ä¼‘æ¯åœ¨ <span class="math inline">\(j\)</span> å¤„æ—¶ <span class="math inline">\(\min\{\sum\limits_{k=1}^{i}{x_k}^2\}\)</span> çš„å€¼ï¼Œåˆ™æœ‰ï¼š <span class="math display">\[\begin{aligned}f_{i,j}&amp;=\min\{f_{i-1,j}+(a_i-a_j)^2\}\\&amp;=\min\{f_{i-1,j}+{a_i}^2-2\times a_i\times a_j+{a_j}^2\}\end{aligned}\]</span> ä»¤ <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ï¼Œåˆ™æœ‰ï¼š <span class="math display">\[f_{i-1,j}-2\times a_i\times a_j+{a_j}^2&lt;f_{i-1,k}-2\times a_i\times a_k+{a_k}^2\\f_{i-1,j}-f_{i-1,k}+{a_j}^2-{a_k}^2&lt;2\times a_i\times(a_j-a_k)\\\dfrac{f_{i-1,j}-f_{i-1,k}+{a_j}^2-{a_k}^2}{2\times(a_j-a_k)}&lt;a_i\]</span></p><p>åˆå§‹åŒ–ã€‚</p><p>å°† <span class="math inline">\(f\)</span> åˆå§‹åŒ–ä¸ºæå¤§å€¼ã€‚</p><p>åœ¨ AcWing ä¸Šå°† <code>memset</code> æ”¹ä¸ºåˆå§‹åŒ– <code>f[0][i] = a[i] * a[i]</code> å°±å¯ä»¥è¿‡äº†ï¼Œä¸ç„¶ä¼š MLEï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºæ²¡å¼€æ»šåŠ¨ã€‚ï¼ˆæœ¬æ¥ä¹Ÿç”¨ä¸ç€æ»š</p><pre class="cpp"><code>#include &lt;cstdio&gt;#define int long longconst int inf = 1e18;const int maxn = 3005;const int LEN = (1 &lt;&lt; 20);int f[maxn][maxn];int a[maxn], q[maxn];int n, m, L, R, ans = inf;#ifdef ONLINE_JUDGEinline int nec(void) &#123;    static char buf[LEN], *p = buf, *e = buf;    if (p == e) &#123;        e = buf + fread(buf, 1, LEN, stdin);        if (e == buf) return EOF; p = buf;    &#125;    return *p++;&#125;#else#define nec getchar#endifinline bool read(int &amp;x) &#123;    char ch = nec();    bool f = 0; x = 0;    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;        if (ch == EOF) return 0;        if (ch == &#39;-&#39;) f = 1;        ch = nec();    &#125;    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;        x = x * 10 + ch - &#39;0&#39;;        ch = nec();    &#125;    if (f) x = -x;    return 1;&#125;inline int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;int getDP(int i, int j, int k) &#123;    return f[k - 1][j] + (a[i] - a[j]) * (a[i] - a[j]);&#125;int getup(int j, int k, int i) &#123;    return f[i - 1][j] - f[i - 1][k] + a[j] * a[j] - a[k] * a[k];&#125;int getdown(int j, int k) &#123;    return (a[j] - a[k]) &lt;&lt; 1;&#125;signed main()&#123;    read(n); read(m);    for (int i = 1; i &lt;= n; ++i) &#123;        read(a[i]);        a[i] += a[i - 1];        f[0][i] = a[i] * a[i];    &#125;    for (int i = 1; i &lt; m; ++i) &#123;        L = R = 1; q[L] = i;        for (int j = i; j &lt;= n; ++j) &#123;            while (L &lt; R &amp;&amp; getup(q[L + 1], q[L], i) &lt;= a[j] * getdown(q[L + 1], q[L]))                ++L;            f[i][j] = getDP(j, q[L], i);            while (L &lt; R &amp;&amp; getup(i, q[R], i) * getdown(q[R], q[R - 1]) &lt;= getup(q[R], q[R - 1], i) * getdown(i, q[R]))                --R;            q[++R] = j;        &#125;    &#125;    printf(&quot;%lld&quot;,m * f[m - 1][n] - a[n] * a[n]);    return 0;&#125;</code></pre><hr /><h3 id="æŸ æª¬"><a href="https://www.luogu.com.cn/problem/P5504">æŸ æª¬</a></h3><p><a href="https://www.acwing.com/problem/content/2396/">åŒå€ç»éªŒ</a></p><p>æ˜¯è¾¹å†™è¿™ç¯‡é¢˜è§£è¾¹åšçš„ï¼ˆ</p><p>é¢˜æ„ï¼š</p><p>æœ‰ä¸€ä¸ªå«æœ‰ <span class="math inline">\(n\)</span> ä¸ªå…ƒç´ çš„åºåˆ— <span class="math inline">\(s\)</span>ã€‚å°†è¿™ä¸ªåºåˆ—åˆ†æˆè¿ç»­çš„è‹¥å¹²æ®µï¼Œå®šä¹‰æ¯ä¸€æ®µçš„ä»·å€¼ä¸ºã€Œåœ¨è¿™ä¸€æ®µå½“ä¸­ä»»é€‰æŸä¸ªå…ƒç´ çš„ä¸ªæ•°çš„å¹³æ–¹å†ä¹˜ä¸Šè¿™ä¸ªå…ƒç´ ã€çš„æœ€å¤§å€¼ã€‚æ±‚å°† <span class="math inline">\(s\)</span> åˆ’åˆ†åçš„æœ€å¤§ä»·å€¼ã€‚</p><p>ä¸éš¾æƒ³åˆ°åˆ†æˆçš„æ¯ä¸€æ®µé¦–å°¾å…ƒç´ å¿…é¡»ç›¸ç­‰ã€‚</p><p>æ¯”å¦‚æœ‰è¿™æ ·ä¸€ä¸ªåºåˆ— <span class="math inline">\(x,a_1,a_2,a_3,\cdots,a_k,x,y\)</span> ã€‚å‡è®¾æˆ‘ä»¬æ±‚çš„æ˜¯è¿™ä¸€æ®µåŒ…å« <span class="math inline">\(x\)</span> çš„ä¸ªæ•°çš„å¹³æ–¹ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥å°† <span class="math inline">\(y\)</span> ä»è¿™ä¸€æ®µä¸­åˆ†ç¦»ï¼Œå•ç‹¬ä¸ºä¸€æ®µï¼Œæ˜æ˜¾æ›´ä¼˜ã€‚</p><p>è€Œå…¶ä»–æ‰€æœ‰æƒ…å†µéƒ½æ˜¯è¿™ç§æƒ…å†µçš„æ‹“å±•ã€‚</p><p>äºæ˜¯å¾—åˆ°å¼å­ï¼š <span class="math display">\[f_i=\max\{f_{j-1}+s_i\times(cnt_i-cnt_j+1)^2\}\]</span> å…¶ä¸­ <span class="math inline">\(cnt_i\)</span> ä¸º <span class="math inline">\(s_i\)</span> å·²ç»å‡ºç°äº†å¤šå°‘æ¬¡ã€‚</p><p>ç„¶åå°±æ˜¯å¥—è·¯ã€‚ <span class="math display">\[\begin{aligned}f_i&amp;=\max\{f_{j-1}+s_i\times({cnt_i}^2+{cnt_j}^2-2\times cnt_i\times cnt_j+2\times cnt_i-2\times cnt_j+1)\}\\&amp;=\max\{f_{j-1}+s_i\times{cnt_i}^2+s_i\times{cnt_j}^2-2\times s_i\times cnt_i\times cnt_j+2\times s_i\times cnt_i-2\times s_i\times cnt_j+s_i\}\\&amp;=\max\{f_{j-1}+s_i\times {cnt_j}^2-2\times s_i\times cnt_i\times cnt_j-2\times s_i\times cnt_j\}+s_i\times {cnt_i}^2+2\times s_i\times cnt_i+s_i\end{aligned}\]</span> è¿™æ¬¡ä¸æ˜¯ <span class="math inline">\(\min\)</span>ï¼Œè€Œæ˜¯ <span class="math inline">\(\max\)</span>ï¼Œæˆ‘ä»¬è¿˜èƒ½åƒä»¥å‰é‚£æ ·æ¨å—ï¼Ÿ</p><p>ä¸æ€¥ï¼Œæˆ‘ä»¬å…ˆæŒ‰ä»¥å‰çš„æ–¹æ³•è¯•è¯•ï¼Œè§æœºè¡Œäº‹ã€‚</p><p>ä»¤ <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ï¼Œåˆ™æœ‰ï¼š <span class="math display">\[f_{j-1}+s_i\times {cnt_j}^2-2\times s_i\times cnt_i\times cnt_j-2\times s_i\times cnt_j&gt;f_{k-1}+s_i\times {cnt_k}^2-2\times s_i\times cnt_i\times cnt_k-2\times s_i\times cnt_k\]</span> æš´åŠ›æä¸å‡ºæ¥ï¼Œå› ä¸ºé‚£ä¸ª <span class="math inline">\(s_i\)</span> ä¹˜ä¸Šçš„å¹³æ–¹é¡¹ã€‚</p><p>é‚£æˆ‘ä»¬æƒ³ä¸€ä¸ªåŠæ³•ï¼ŒæŠŠ <span class="math inline">\(s_i\)</span> ç»™ç­æ‰å°±è¡Œäº†ã€‚</p><p>æ—¢ç„¶æˆ‘ä»¬å·²çŸ¥ä¸€æ®µçš„é¦–å°¾å…ƒç´ å¿…é¡»ç›¸ç­‰ï¼Œé‚£ä¸å°±è¯´æ˜ <span class="math inline">\(s_i,s_j,s_k\)</span> å¯ä»¥ç›¸äº’æ›¿æ¢å—ï¼Ÿ</p><p>ç»§ç»­æã€‚ <span class="math display">\[f_{j-1}+s_j\times {cnt_j}^2-2\times s_i\times cnt_i\times cnt_j-2\times s_j\times cnt_j&gt;f_{k-1}+s_k\times {cnt_k}^2-2\times s_i\times cnt_i\times cnt_k-2\times s_k\times cnt_k\\f_{j-1}-f_{k-1}+s_j\times {cnt_j}^2-s_k\times {cnt_k}^2-2\times s_j\times cnt_j+2\times s_k\times cnt_k&gt;2\times s_i\times cnt_i\times cnt_j-2\times s_i\times cnt_i\times cnt_k\\\dfrac{f_{j-1}-f_{k-1}+s_j\times {cnt_j}^2-s_k\times {cnt_k}^2-2\times s_j\times cnt_j+2\times s_k\times cnt_k}{cnt_j-cnt_k}&gt;2\times s_i\times cnt_i\]</span></p><p>è¿™é‡Œçš„ç¬¦å·å˜æˆ <span class="math inline">\(&gt;\)</span> äº†ã€‚</p><p>æ˜“å¾—ï¼Œè¿™é‡Œè¦ç»´æŠ¤çš„æ˜¯ä¸€ä¸ªæ–œç‡å•è°ƒé€’å‡çš„ä¸Šå‡¸åŒ…æœ€ä¼˜è§£åºåˆ—ã€‚</p><p>å› ä¸º <span class="math inline">\(s_i\)</span> å¿…é¡»ä¸ <span class="math inline">\(s_j,s_k\)</span> ç›¸åŒï¼Œæ˜æ˜¾è¦é’ˆå¯¹æ¯ä¸ª <span class="math inline">\(s_i\)</span> ç»´æŠ¤ä¸åŒçš„æœ€ä¼˜è§£åºåˆ—ï¼Œåœ¨æ¯æ¬¡å¯¹åº”çš„åºåˆ—ä¸­è®¡ç®—ã€‚</p><p>ç»´æŠ¤çš„æ–œç‡å•è°ƒé€’å‡ï¼Œè€Œå¯¹äºæ¯ä¸€ä¸ªç›¸ç­‰çš„ <span class="math inline">\(s_i\)</span>ï¼Œ <span class="math inline">\(2\times s_i\times cnt_i\)</span> ä¸€å®šæ˜¯å•è°ƒé€’å¢çš„ï¼Œå¯¼è‡´äº†è¿™ä¸ªåºåˆ—å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼šæ–œç‡å•è°ƒé€’å‡ï¼Œä½†æœ«å°¾çš„æœ€å°çš„æ–œç‡ä»å¤§äº <span class="math inline">\(2\times s_i\times cnt_i\)</span>ã€‚</p><p>å•è°ƒæ ˆå¯ä»¥è‡ªè¡Œç ”ç©¶ï¼Œå› ä¸ºä½œè€…ç„äº†ä¸€çœ¼æ—¶é—´å‘ç°å·²ç»æ˜¯æ˜å¤©äº†ã€‚ï¼ˆä»€</p><pre class="cpp"><code>#include&lt;cstdio&gt;#include&lt;vector&gt;using namespace std;#define int long long#define top q[x].size() - 1const int maxn = 1e5 + 5;const int maxm = 1e4 + 5;int n;vector&lt;int&gt; q[maxm]; // ä¸ç”¨ vector ä¼š MLEint f[maxn], s[maxn];int cnt[maxn], tot[maxm];int getDP(int i,int j)&#123;    return f[j-1]+(cnt[i]-cnt[j]+1)*(cnt[i]-cnt[j]+1)*s[i];&#125;int getup(int j,int k)&#123;    return f[j-1]-f[k-1]+s[j]*cnt[j]*cnt[j]-s[k]*cnt[k]*cnt[k]-2*s[j]*cnt[j]+2*s[k]*cnt[k];&#125;int getdown(int j,int k)&#123;    return cnt[j]-cnt[k];&#125;signed main()&#123;    scanf(&quot;%lld&quot;,&amp;n);    for(int i=1;i&lt;=n;++i)&#123;        scanf(&quot;%lld&quot;,&amp;s[i]);        cnt[i]=++tot[s[i]];    &#125;    for(int i=1;i&lt;=n;++i)&#123;        int x=s[i];        while(q[x].size()&gt;=2&amp;&amp;getup(q[x][top-1],i)*getdown(q[x][top-1],q[x][top])&gt;=getup(q[x][top-1],q[x][top])*getdown(q[x][top-1],i))            q[x].pop_back();        q[x].push_back(i);        while(q[x].size()&gt;=2&amp;&amp;getDP(i,q[x][top])&lt;=getDP(i,q[x][top-1]))            q[x].pop_back();        f[i]=getDP(i,q[x][top]);    &#125;    printf(&quot;%lld&quot;,f[n]);    return 0;&#125;</code></pre><hr /><h3 id="æ€»ç»“">æ€»ç»“</h3><p>æ€»ç»“æ–œä¼˜çš„æ­¥éª¤ï¼š</p><ol type="1"><li>æ¨ DP å¼å­</li><li>å¯¹å¼å­è¿›è¡Œå·§å¦™çš„ä¼˜åŒ–ï¼Œä½¿å…¶æ˜“äºåŒ–ç®€</li><li>å‡è®¾ <span class="math inline">\(j\)</span> ä¼˜äº <span class="math inline">\(k\)</span>ï¼Œå°†å¼å­åŒ–æˆ <span class="math inline">\(\dfrac{(j)-(k)}{(j)-(k)}&gt; \text{or} &lt;x\)</span> çš„å½¢å¼</li><li>å•è°ƒé˜Ÿåˆ—æˆ–å•è°ƒæ ˆä¼˜åŒ–</li></ol>]]></content>
      
      
      
        <tags>
            
            <tag> æ–œç‡ä¼˜åŒ– </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
