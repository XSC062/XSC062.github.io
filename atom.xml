<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xsc062.netlify.app</id>
    <title></title>
    <link href="https://xsc062.netlify.app" />
    <updated>2025-09-29T08:55:28.000Z</updated>
    <category term="å¹¶æŸ¥é›†" />
    <category term="æ–œç‡ä¼˜åŒ–" />
    <category term="æ‚¬çº¿æ³•" />
    <category term="å“ˆå¸Œ" />
    <category term="å­—å…¸æ ‘" />
    <category term="DP" />
    <category term="å•è°ƒé˜Ÿåˆ—" />
    <category term="åˆ†æ²»" />
    <category term="äºŒåˆ†å›¾" />
    <category term="CRT / exCRT" />
    <category term="æ’åˆ—ç»„åˆ" />
    <category term="ç½‘ç»œæµ" />
    <category term="è´¹ç”¨æµ" />
    <category term="äºŒåˆ†" />
    <category term="ä¸Šä¸‹ç•Œç½‘ç»œæµ" />
    <category term="å®¹æ–¥åŸç†" />
    <category term="çº¿æ®µæ ‘" />
    <category term="æ ‘çŠ¶æ•°ç»„" />
    <category term="åŒºé—´ DP" />
    <category term="æ„é€ " />
    <category term="æ•°æ®ç»“æ„" />
    <category term="Tarjan" />
    <category term="ä¸‹é¥­" />
    <category term="LCA" />
    <category term="å€å¢" />
    <category term="é¸½å·¢åŸç†" />
    <category term="æ¦‚ç‡æœŸæœ›" />
    <category term="è°ƒå’Œçº§æ•°" />
    <category term="å·®åˆ†" />
    <category term="æ€ç»´" />
    <category term="æ ‘å½¢ DP" />
    <category term="æœ€å°ç”Ÿæˆæ ‘" />
    <category term="SAM" />
    <category term="çŠ¶å‹" />
    <category term="åˆ†å—" />
    <category term="å¯æŒä¹…åŒ–" />
    <category term="ç¬›å¡å°”æ ‘" />
    <category term="é«˜ç»´å‰ç¼€å’Œ" />
    <category term="é—²è¯" />
    <category term="æ¬§æ‹‰å›è·¯" />
    <category term="æ ‘é“¾å‰–åˆ†" />
    <category term="é•¿é“¾å‰–åˆ†" />
    <category term="KMP" />
    <category term="border" />
    <category term="å­—ç¬¦ä¸²" />
    <category term="AC è‡ªåŠ¨æœº" />
    <category term="SA" />
    <category term="æ•°å­¦" />
    <category term="æ ‘ä¸Šå·®åˆ†" />
    <category term="FWT" />
    <category term="å †" />
    <category term="æ ‘çš„é‡å¿ƒ" />
    <category term="äºŒé¡¹å¼å®šç†" />
    <category term="äºŒé¡¹å¼åæ¼”" />
    <category term="è´ªå¿ƒ" />
    <category term="å‡æ‘Š" />
    <category term="è®¡æ•°" />
    <category term="ä¼˜åŒ–å»ºå›¾" />
    <category term="åæ‚”è´ªå¿ƒ" />
    <category term="è°ƒæ•´æ³•" />
    <category term="èƒŒåŒ…" />
    <category term="åšå¼ˆè®º" />
    <category term="DP ä¼˜åŒ–" />
    <category term="è™šæ ‘" />
    <category term="ç‚¹åˆ†æ²»" />
    <category term="WQS äºŒåˆ†" />
    <category term="é—µå¯å¤«æ–¯åŸºå’Œ" />
    <category term="slope trick" />
    <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
    <category term="çŠ¶å‹ DP" />
    <category term="ç»„åˆæ•°å­¦" />
    <category term="æ”¯é…å¯¹" />
    <category term="DDP" />
    <category term="å®¹æ–¥" />
    <category term="Kruskal é‡æ„æ ‘" />
    <category term="é«˜ç²¾åº¦" />
    <category term="æœ€çŸ­è·¯" />
    <category term="æè¶…çº¿æ®µæ ‘" />
    <entry>
        <id>https://xsc062.netlify.app/20250929/</id>
        <title>ç”Ÿæˆæ ‘ç»ƒä¹ </title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250929/"/>
        <content type="html">
</content>
        <updated>2025-09-29T08:55:28.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250924/</id>
        <title>æœ€çŸ­è·¯ç»ƒä¹ </title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250924/"/>
        <content type="html">&lt;p&gt;æœ€çŸ­è·¯ä¸ºèƒŒæ™¯çš„é¢˜ + åšæ³•æ˜¯æœ€çŸ­è·¯çš„é¢˜&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---minimum-path&#34;&gt;A - Minimum Path&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1473E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1473E&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»å…¸å¥—è·¯ï¼Œå‘ç°å¯ä»¥æŠŠ max å’Œ min æ¢æˆä»»æ„è·¯å¾„ä¸­çš„è¾¹ï¼Œç„¶å max å’Œ min å°±ä¼šæœ€å°åŒ–è¿™ä¸ªå¼å­&lt;/li&gt;
&lt;li&gt;æ•…å†™ä¸€ä¸ª Dijkstra + DPï¼Œæ±‚è¿™ä¸ªå¼å­çš„æœ€å°å€¼å³å¯&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    std::vector&amp;lt;brr&amp;gt; dis(2, brr(2, arr(n + 1, 1e18))), vis(2, brr(2, arr(n + 1)));
    for (int x, y, w; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w;
        g[x].emplace_back(y, w);
        g[y].emplace_back(x, w);
    &amp;#125;
    dis[0][0][1] = 0;
    std::array&amp;lt;std::array&amp;lt;std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt;, 2&amp;gt;, 2&amp;gt; q;
    q[0][0].emplace(0, 1);
    for (int i = 0; i &amp;lt; 2; ++i) &amp;#123;
        for (int j = 0; j &amp;lt; 2; ++j) &amp;#123;
            for (; !q[i][j].empty(); ) &amp;#123;
                int f = q[i][j].top().second;
                q[i][j].pop();
                if (vis[i][j][f])
                    continue;
                vis[i][j][f] = 1;
                for (auto k : g[f]) &amp;#123;
                    if (dis[i][j][k.first] &amp;gt; dis[i][j][f] + k.second) &amp;#123;
                        dis[i][j][k.first] = dis[i][j][f] + k.second;
                        q[i][j].emplace(-dis[i][j][k.first], k.first);
                    &amp;#125;
                    if (!i &amp;amp;&amp;amp; dis[1][j][k.first] &amp;gt; dis[i][j][f]) &amp;#123;
                        dis[1][j][k.first] = dis[i][j][f];
                        q[1][j].emplace(-dis[1][j][k.first], k.first);
                    &amp;#125;
                    if (!j &amp;amp;&amp;amp; dis[i][1][k.first] &amp;gt; dis[i][j][f] + 2 * k.second) &amp;#123;
                        dis[i][1][k.first] = dis[i][j][f] + 2 * k.second;
                        q[i][1].emplace(-dis[i][1][k.first], k.first);
                    &amp;#125;
                &amp;#125;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    for (int i = 2; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; std::min(&amp;#123; dis[0][0][i], dis[1][1][i] &amp;#125;) &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---train-delay&#34;&gt;B - Train Delay&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://vjudge.net/contest/750645#problem/B&#34; class=&#34;uri&#34;&gt;https://vjudge.net/contest/750645#problem/B&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€åŒ–é¢˜ç›®å¾ˆé‡è¦çš„ä¸€ä¸ªè½¬åŒ–æ˜¯&lt;strong&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(S\le T\)&lt;/span&gt; å¸¦æ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ°ä½å¹³ç­‰ï¼Œè€ƒè™‘æŠŠå‡ºå‘å’Œåˆ°è¾¾åˆ†åˆ«çœ‹ä½œä¸€æ¬¡äº‹ä»¶å¤„ç†ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŒ‰ç…§æ‰€æœ‰äº‹ä»¶çš„å‘ç”Ÿæ—¶åˆ»æ’åºï¼Œæœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºä¸€æ¬¡å‡ºå‘äº‹ä»¶ï¼Œå¯ä»¥å¾—åˆ°åœ¨å…¶ä¹‹å‰è¯¥ç«™ç‚¹æ‰€æœ‰åˆ°è¾¾äº‹ä»¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(\max\{T&amp;#39;\}\)&lt;/span&gt;ï¼Œç”¨ä¹‹æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºä¸€æ¬¡åˆ°è¾¾äº‹ä»¶ï¼Œç”±äºå¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; å·²ç»ç¡®å®šï¼Œæ›´æ–°è¯¥ç«™ç‚¹å½“å‰æœ€å¤§å€¼å³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; d(m + 1);
    std::cin &amp;gt;&amp;gt; d[1];
    struct event &amp;#123;
        int t, op, id, x;
    &amp;#125;;
    std::vector&amp;lt;event&amp;gt; a;
    std::vector&amp;lt;int&amp;gt; mx(n + 1);
    for (int i = 1, x, y, s, t; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t;
        a.push_back(&amp;#123; s, 0, i, x &amp;#125;);
        a.push_back(&amp;#123; t, 1, i, y &amp;#125;);
    &amp;#125;
    std::sort(a.begin(), a.end(), [&amp;amp;](event &amp;amp;x, event &amp;amp;y) &amp;#123; return x.t == y.t ? x.op &amp;gt; y.op : x.t &amp;lt; y.t; &amp;#125;);
    for (auto [t, op, id, x] : a)
        if (op == 1)
            mx[x] = std::max(mx[x], t + d[id]);
        else if (id != 1)
            d[id] = std::max(mx[x] - t, 0);
    for (int i = 2; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; d[i] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---complete-the-graph&#34;&gt;C - Complete The Graph&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF715B&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF715B&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç¥ä»™äºŒåˆ†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœåˆå§‹æŠŠæ‰€æœ‰ç™½è¾¹ç½®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¼šæƒ³åˆ°è°ƒæ•´æ³•æ„é€ &lt;/li&gt;
&lt;li&gt;ä½†æ˜¯ä¸çŸ¥é“åº”è¯¥åœ¨å“ªäº›è¾¹ä¸Šè°ƒæ•´ï¼Œç¡®å®šè°ƒæ•´å¤šå°‘ä¼¼ä¹ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç®€å•çš„åšæ³•&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…&lt;strong&gt;å¹³å‡ç”¨åŠ›&lt;/strong&gt;ï¼Œæ„é€ ä¸€ä¸ª è¾¹1 += 1ï¼Œè¾¹2 += 1ï¼Œè¾¹3 += 1, â€¦, è¾¹cnt0 += 1, è¾¹1 += 1, è¾¹2 += 1, â€¦ çš„æ“ä½œåºåˆ—&lt;/p&gt;
å®¹æ˜“&lt;strong&gt;å‘ç°æ¯æ¬¡æ“ä½œæœ€å¤šè®©å½“å‰æœ€çŸ­è·¯é•¿åº¦å¢åŠ  1&lt;/strong&gt;ï¼Œè€Œä¸”æœ‰å•è°ƒæ€§&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…äºŒåˆ†ç­”æ¡ˆå³å¯&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const __int128 inf = 1e18;
const __int128 inff = 1e23;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, s, t, l, cnt = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; l &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t, ++s, ++t;
    std::vector&amp;lt;std::tuple&amp;lt;int, int, long long&amp;gt; &amp;gt; u(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, long long&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt;= m; ++i) &amp;#123;
        long long w;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w, ++x, ++y;
        if (w == 0)
            w = -(++cnt);
        g[x].emplace_back(y, w), g[y].emplace_back(x, w);
        u[i] = &amp;#123; x, y, w &amp;#125;;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; vis(n + 1);
    std::vector&amp;lt;__int128&amp;gt; dis(n + 1);
    std::vector&amp;lt;long long&amp;gt; k(cnt + 1);
    __int128 res = -1;
    auto check = [&amp;amp;](__int128 x) &amp;#123;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            k[i] = x / cnt + (i &amp;lt;= x % cnt);
        std::fill(vis.begin() + 1, vis.end(), 0);
        std::fill(dis.begin() + 1, dis.end(), inf);
        std::priority_queue&amp;lt;std::pair&amp;lt;__int128, int&amp;gt; &amp;gt; q;
        dis[s] = 0, q.emplace(0, s);
        for (; !q.empty(); ) &amp;#123;
            int f = q.top().second;
            q.pop();
            if (vis[f])
                continue;
            vis[f] = 1;
            for (auto [v, w] : g[f]) &amp;#123;
                if (w &amp;lt; 0)
                    w = k[-w];
                if (dis[v] &amp;gt; dis[f] + w) &amp;#123;
                    dis[v] = dis[f] + w;
                    q.emplace(-dis[v], v);
                &amp;#125;
            &amp;#125;
        &amp;#125;
        return dis[t] &amp;lt;= l;
    &amp;#125;;
    for (__int128 l = cnt, r = cnt * inf, mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        if (check(mid))
            res = mid, l = mid + 1;
        else
            r = mid - 1;
    &amp;#125;
    if (res == -1)
        std::cout &amp;lt;&amp;lt; &amp;quot;NO\n&amp;quot;;
    else &amp;#123;
        check(res);
        if (dis[t] != l)
            std::cout &amp;lt;&amp;lt; &amp;quot;NO\n&amp;quot;;
        else &amp;#123;
            std::cout &amp;lt;&amp;lt; &amp;quot;YES\n&amp;quot;;
            for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
                auto [x, y, w] = u[i];
                if (w &amp;lt; 0)
                    w = k[-w];
                std::cout &amp;lt;&amp;lt; x - 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; y - 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; w &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            &amp;#125;
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---é‡åŠ›çƒ&#34;&gt;A - é‡åŠ›çƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7473&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7473&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ç›¸å¯¹å¾ˆå°ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆåŸºäº &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„åšæ³•&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡çƒåœä¸‹çš„ä½ç½®ä¸€å®šæ˜¯æŸä¸ªéšœç¢ç‰©ï¼ˆæˆ–è¾¹ç•Œï¼‰ä¸Š / ä¸‹ / å·¦ / å³çš„æ ¼å­ï¼Œæ•…å¯ä»¥åœ¨è¿™ &lt;span class=&#34;math inline&#34;&gt;\(O(n + m)\)&lt;/span&gt; ä¸ªç‚¹ä¸Šå»ºå›¾&lt;/li&gt;
&lt;li&gt;æ€ä¹ˆåŒæ—¶ç»´æŠ¤ä¸¤ä¸ªçƒçš„ä¿¡æ¯å‘¢ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; è¿˜æ˜¯å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥æŠŠä¸¤ä¸ªçƒå¡ä¸€èµ·ä½œä¸ºä¸€ä¸ªçŠ¶æ€&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(m^2\)&lt;/span&gt; æ¬¡ Dij è¿˜æ˜¯å¤ªæ¿€è¿›äº† è¿›ä¸€æ­¥æ€è€ƒå‘ç°å¯èƒ½çš„ç»ˆç‚¹å…± &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ª å¹¶ä¸”å½¼æ­¤ä¸åŒºåˆ†&lt;/p&gt;
&lt;p&gt;æ•…ä»¥è¿™ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªç»ˆç‚¹è·‘å¤šæºæœ€çŸ­è·¯å³å¯&lt;/p&gt;
&lt;p&gt;ä½† 5e6 è·‘ Dij è¿˜æ˜¯å¤ªå‹‰å¼ºäº†ã€‚&lt;strong&gt;å‘ç°è¾¹æƒä¸º 1ï¼Œä¸ºä»€ä¹ˆä¸ BFS å‘¢ ğŸ˜…&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°èµ·ç‚¹å¯èƒ½ä¸åœ¨æˆ‘ä»¬é™å®šçš„ç‚¹ä¸Šï¼Œä½†å¯ä»¥äººä¸ºé€‰æ‹©ä¸€æ¬¡é‡åŠ›æ–¹å‘ï¼Œç„¶åå°±å›åˆ°åˆšåˆšçš„é—®é¢˜äº†&lt;/p&gt;
&lt;p&gt;æˆ–è€…ç¦»çº¿ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç–‘ä¼¼å¸¸æ•°å¤ªå¤§ï¼Œæ‹¼å°½å…¨åŠ›å‹‰å¼ºå¡è¿‡&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#ifdef ONLINE_JUDGE
inline int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf)
            return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
#else
#define nec getchar
#endif
inline bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF)
            return 0;
        if (ch == &amp;#39;-&amp;#39;)
            f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f)
        x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0) &amp;#123;
        putchar(&amp;#39;-&amp;#39;);
        x = -x;
    &amp;#125;
    if (x &amp;gt;= 10)
        print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x);
    putchar(ch);
    return;
&amp;#125;
const int inf = 0x3f3f3f3f;
const int dir[][2] = &amp;#123;&amp;#123; -1, 0 &amp;#125;, &amp;#123; 1, 0 &amp;#125;, &amp;#123; 0, -1 &amp;#125;, &amp;#123; 0, 1 &amp;#125;&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, q;
    read(n), read(m), read(q);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; pos(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; a(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 1, x, y; i &amp;lt;= m; ++i) &amp;#123;
        read(x), read(y);
        pos[i] = &amp;#123; x, y &amp;#125;, a[x][y] = -1;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(0, i), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(i, n + 1), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(n + 1, i), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(i, 0), ++m;
    int cnt = 0;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; u(1);
    for (int i = 1; i &amp;lt;= m; ++i)
        for (auto [fx, fy] : dir) &amp;#123;
            int nx = pos[i].first + fx, ny = pos[i].second + fy;
            if (nx &amp;gt;= 1 &amp;amp;&amp;amp; nx &amp;lt;= n &amp;amp;&amp;amp; ny &amp;gt;= 1 &amp;amp;&amp;amp; ny &amp;lt;= n &amp;amp;&amp;amp; !a[nx][ny])
                a[nx][ny] = ++cnt, u.emplace_back(nx, ny);
        &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; &amp;gt; top(n + 1, std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; (n + 1));
    for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (a[i][j] != -1) &amp;#123;
                if (i == 1 || a[i - 1][j] == -1)
                    top[i][j][0] = a[i][j];
                else
                    top[i][j][0] = top[i - 1][j][0];
            &amp;#125;
        for (int i = n; i; --i)
            if (a[i][j] != -1) &amp;#123;
                if (i == n || a[i + 1][j] == -1)
                    top[i][j][1] = a[i][j];
                else
                    top[i][j][1] = top[i + 1][j][1];
            &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (int j = 1; j &amp;lt;= n; ++j)
            if (a[i][j] != -1) &amp;#123;
                if (j == 1 || a[i][j - 1] == -1)
                    top[i][j][2] = a[i][j];
                else
                    top[i][j][2] = top[i][j - 1][2];
            &amp;#125;
        for (int j = n; j; --j)
            if (a[i][j] != -1) &amp;#123;
                if (j == n || a[i][j + 1] == -1)
                    top[i][j][3] = a[i][j];
                else
                    top[i][j][3] = top[i][j + 1][3];
            &amp;#125;
    &amp;#125;
    const int N = cnt * cnt;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(N + 1);
    auto encode = [&amp;amp;](int x, int y) &amp;#123;
        return (x - 1) * cnt + y;
    &amp;#125;;
    auto decode = [&amp;amp;](int id) &amp;#123;
        return std::make_pair((id - 1) / cnt + 1, (id - 1) % cnt + 1);
    &amp;#125;;
    for (int i = 1; i &amp;lt;= N; ++i)
        for (int j = 0; j &amp;lt; 4; ++j) &amp;#123;
            auto [a, b] = decode(i);
            g[encode(top[u[a].first][u[a].second][j], top[u[b].first][u[b].second][j])].emplace_back(i);
        &amp;#125;
    std::vector&amp;lt;int&amp;gt; dis(N + 1, inf), vis(N + 1);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            dis[encode(i, i)] = 0, q.push(encode(i, i)), vis[encode(i, i)] = 1;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop();
            for (auto i : g[x])
                if (!vis[i])
                    dis[i] = dis[x] + 1, vis[i] = 1, q.push(i);
        &amp;#125;
    &amp;#125;
    for (int a, b, c, d; q--; ) &amp;#123;
        read(a), read(b), read(c), read(d);
        if (a == c &amp;amp;&amp;amp; b == d)
            print(0, &amp;#39;\n&amp;#39;);
        else &amp;#123;
            int res = inf;
            for (int j = 0; j &amp;lt; 4; ++j)
                res = std::min(res, dis[encode(top[a][b][j], top[c][d][j])] + 1);
            if (res == inf)
                print(-1, &amp;#39;\n&amp;#39;);
            else
                print(res, &amp;#39;\n&amp;#39;);
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---çŸ©é˜µæ¸¸æˆ&#34;&gt;B - çŸ©é˜µæ¸¸æˆ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7515&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7515&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æŠŠé—®é¢˜å½¢å¼åŒ–ä¸€ä¸‹ï¼Œç°åœ¨æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; ä¸ªæœªçŸ¥æ•°å’Œ &lt;span class=&#34;math inline&#34;&gt;\((n-1)\times (m-1)\)&lt;/span&gt; ä¸ªæ–¹ç¨‹&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥å¯¹è¾¹ä¸Šä¸€åœˆä»»æ„èµ‹å€¼ï¼Œé™åˆ¶æ˜¯å·¦ä¸Šè§’è¿™ &lt;span class=&#34;math inline&#34;&gt;\((n-1)\times (m-1)\)&lt;/span&gt; ä¸ªæœªçŸ¥æ•°å¿…é¡»è½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([0,10^6]\)&lt;/span&gt; ä¸Š&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€ä¸ªå¾ˆå®¹æ˜“è§‚å¯Ÿåˆ°çš„æ€§è´¨ï¼Œå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œé€‰å–ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼Œå¹¶æŠŠæ£‹ç›˜é»‘ç™½æŸ“è‰²ï¼Œé‚£ä¹ˆæŠŠæ‰€æœ‰é»‘æ ¼ &lt;span class=&#34;math inline&#34;&gt;\(+=v\)&lt;/span&gt;ï¼Œç™½æ ¼ &lt;span class=&#34;math inline&#34;&gt;\(-=v\)&lt;/span&gt;ï¼Œå¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; æ˜¯ä¸ä¼šå˜çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;è¿™ä¸ªæ“ä½œæ˜¯æ¶‰åŠå…¨å±€çš„ï¼Œå¤ªè‹›åˆ»äº†&lt;/strong&gt;ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´ mild çš„æ„é€ ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å‘ç°åªå¯¹ä¸€è¡Œ / åˆ—é»‘ç™½æŸ“è‰²å¹¶æ“ä½œä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚èƒ½æ„Ÿå—åˆ°&lt;strong&gt;æ“ä½œæ— æ³•å†ç®€åŒ–äº†&lt;/strong&gt;ã€‚è€ƒè™‘ç”¨è¿™ä¸ªç‰ˆæœ¬çš„æ“ä½œ&lt;strong&gt;è°ƒæ•´&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æ•…å¤§åŠ›ä»¤å‘¨å›´ä¸€åœˆçš„ä¸´æ—¶è§£ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä»¤æ¯è¡Œã€åˆ—çš„è°ƒæ•´ delta ä¸º &lt;span class=&#34;math inline&#34;&gt;\(r_i,c_i\)&lt;/span&gt;ï¼Œå¯ä»¥å¾—åˆ°è‹¥å¹²ä¸ªå…³äº &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(10^6\)&lt;/span&gt; çš„çº¦æŸã€‚æœ€åå»ºå‡ºæ¥ä¸€ä¸ªå®Œå…¨äºŒåˆ†å›¾çŠ¶ç‰©ï¼Œè·‘å·®åˆ†çº¦æŸå³å¯ï¼Œå®¹æ˜“å‘ç°å¤æ‚åº¦æ­£ç¡®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®ç°æŠ€å·§ï¼šè§„åˆ’ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„æŸ“è‰²æ–¹å¼ï¼Œä½¿å¾—å®ƒä»¬é”™å¼€ï¼Œå¯ä»¥æŠŠæ‰€æœ‰ä½ç½®éƒ½å†™ä½œ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;_{i,j}+c-r\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;_{i,j}+r-c\)&lt;/span&gt; çš„å½¢å¼ï¼Œä¾¿äºå·®åˆ†çº¦æŸ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---tax&#34;&gt;C - Tax&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6822&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6822&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®¹æ˜“æƒ³åˆ°åˆ†ç±»è®¨è®ºï¼Œå¦‚æœé’¦å®šæ˜¯å…¥è¾¹è´¡çŒ®è¾¹æƒï¼Œé‚£ä¹ˆå‡ºè¾¹è¾¹æƒä¸èƒ½å¤§äºå…¥è¾¹è¾¹æƒï¼›å¦åˆ™ï¼Œå‡ºè¾¹è´¡çŒ®è¾¹æƒã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘æŠŠæ¯ä¸ªç‚¹ä¸Šçš„å‡ºè¾¹æŒ‰è¾¹æƒä»å°åˆ°å¤§æ’åºï¼Œæ˜¾ç„¶éœ€è¦å…¥è¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µå‰ç¼€ï¼Œéœ€è¦å‡ºè¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µåç¼€ï¼Œå°±å¯ä»¥åšä¸€ä¸ªå‰åç¼€ä¼˜åŒ–å»ºå›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    struct edge &amp;#123; int v, w, id, pi, si; &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;edge&amp;gt; &amp;gt; g1(n + 2);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(1);
    int cnt = 0;
    for (int x, y, w; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w;
        g1[x].push_back(&amp;#123; y, w, ++cnt, 0, 0 &amp;#125;);
        g1[y].push_back(&amp;#123; x, w, ++cnt, 0, 0 &amp;#125;);
        g.emplace_back(), g.emplace_back();
    &amp;#125;
    int s = ++cnt, t = ++cnt;
    g1[0].push_back(&amp;#123; 1, 0, s, 0, 0 &amp;#125;), g1[n].push_back(&amp;#123; n + 1, 0, t, 0, 0 &amp;#125;);
    g.emplace_back(), g.emplace_back();
    for (int i = 0; i &amp;lt;= n + 1; ++i)
        if (!g1[i].empty()) &amp;#123;
            std::sort(g1[i].begin(), g1[i].end(), [&amp;amp;](edge &amp;amp;x, edge &amp;amp;y) &amp;#123; return x.w &amp;lt; y.w; &amp;#125;);
            for (int j = 0; j &amp;lt; (int)g1[i].size(); ++j) &amp;#123;
                g1[i][j].pi = ++cnt, g.emplace_back();
                if (j != 0)
                    g[cnt].emplace_back(cnt - 1, 0);
                g[cnt].emplace_back(g1[i][j].id, 0);
            &amp;#125;
            for (int j = (int)g1[i].size() - 1; ~j; --j) &amp;#123;
                g1[i][j].si = ++cnt, g.emplace_back();
                if (j != (int)g1[i].size() - 1)
                    g[cnt].emplace_back(cnt - 1, 0);
                g[cnt].emplace_back(g1[i][j].id, g1[i][j].w);
            &amp;#125;
        &amp;#125;
    for (int i = 0; i &amp;lt;= n + 1; ++i)
        for (auto &amp;amp;[v, w, id, pi, si] : g1[i]) &amp;#123;
            auto to = std::upper_bound(g1[v].begin(), g1[v].end(), w, [&amp;amp;](int x, edge &amp;amp;y) &amp;#123; return x &amp;lt; y.w; &amp;#125;);
            if (to != g1[v].end())
                g[id].emplace_back(to-&amp;gt;si, 0);
            if (to != g1[v].begin())
                g[id].emplace_back((--to)-&amp;gt;pi, w);
        &amp;#125;
    std::vector&amp;lt;int&amp;gt; vis(cnt + 1, 0);
    std::vector&amp;lt;long long&amp;gt; dis(cnt + 1, inf);
    std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; q;
    dis[s] = 0, q.emplace(0, s);
    for (; !q.empty(); ) &amp;#123;
        int f = q.top().second;
        q.pop();
        if (vis[f])
            continue;
        vis[f] = 1;
        for (auto [v, w] : g[f])
            if (dis[v] &amp;gt; dis[f] + w) &amp;#123;
                dis[v] = dis[f] + w;
                q.emplace(-dis[v], v);
            &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; dis[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---travelling-through-the-snow-queens-kingdom&#34;&gt;D - Travelling Through the Snow Queenâ€™s Kingdom&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF685E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF685E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç›®å‰è§è¿‡çš„æ•°æ®èŒƒå›´æç¤ºæ€§æå¼±ï¼ˆè¯¯å¯¼æ€§æå¼ºï¼‰çš„å¾ªç¯ç»“æ„é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;[BZOJ3620] ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/20240906/#å­—ç¬¦åˆå¹¶&#34;&gt;å­—ç¬¦åˆå¹¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/20250907/#e---subset-product-problem&#34;&gt;[ARC205E] Subset Product Problem&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ­£èµ›å› ä¸ºæœ‰éƒ¨åˆ†åˆ†ï¼Œåº”è¯¥ä¸ä¼šå‡ºç°ä¸æ•¢å†™çš„é—®é¢˜&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘ç¦»çº¿è¯¢é—®ï¼Œé€†åºåŠ è¾¹ï¼›åŸæ–‡æ— è¾¹æƒï¼›è¾¹çš„é€šè¡Œæ—¶åˆ»åªå†³å®šåˆ°è¾¾ç‚¹çš„æ—¶åˆ»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å€Ÿé‰´ &lt;a href=&#34;/20231113/#b.-å•†äºº&#34;&gt;merchant&lt;/a&gt; ä¸­çš„æ€è·¯ï¼Œåªéœ€è¦æ›´æ–°å½“å‰è¾¹ä¸¤ä¾§ç‚¹ä¸ºèµ·ç‚¹çš„ DP æ•°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„è¾¹ä»æŸç§æ„ä¹‰ä¸Šè¯´æ˜¯ã€æœ‰å‘ã€çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, q;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; q;
    struct query &amp;#123; int r, s, t, id; &amp;#125;;
    std::vector&amp;lt;int&amp;gt; res(q + 1);
    std::vector&amp;lt;std::vector&amp;lt;query&amp;gt; &amp;gt; u(m + 1);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; e(m + 1);
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cin &amp;gt;&amp;gt; e[i].first &amp;gt;&amp;gt; e[i].second;
    for (int i = 1, l, r, s, t; i &amp;lt;= q; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t;
        u[l].push_back(&amp;#123; r, s, t, i &amp;#125;);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1, inf));
    for (int i = m; i; --i) &amp;#123;
        auto [x, y] = e[i];
        g[x][y] = g[y][x] = i;
        for (int j = 1; j &amp;lt;= n; ++j)
            g[x][j] = g[y][j] = std::min(g[x][j], g[y][j]);
        for (auto [r, s, t, id] : u[i])
            if (g[s][t] &amp;lt;= r)
                res[id] = 1;
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        std::cout &amp;lt;&amp;lt; (res[i] ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---culture-code&#34;&gt;E - Culture Code&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1197E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1197E&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆæŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(out\)&lt;/span&gt; æ’åºï¼Œåšä¸€ä¸ªå‰ç¼€ä¼˜åŒ–å»ºå›¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®¹æ˜“å‘ç°é™¤äº†æœ€å¤–å±‚ï¼Œæ¯ä¸€ä¸ªå¥—å¨ƒéƒ½ä¼šæä¾› &lt;span class=&#34;math inline&#34;&gt;\(in_i-out_i\)&lt;/span&gt; çš„ä»£ä»·ï¼Œè€Œæœ€å¤–å±‚ä¼šæä¾› &lt;span class=&#34;math inline&#34;&gt;\(in_x\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/p&gt;
&lt;del&gt;å¥½åœ¨è¦æ±‚çš„æ˜¯æœ€é•¿è·¯ï¼Œè¿™æ ·å°±å¯ä»¥ Dij äº†&lt;/del&gt;ï¼Œå¹¶ä¸éœ€è¦çœŸæ­£æŠŠå›¾å»ºå‡ºæ¥ï¼Œå‘ç°è¿™ä¸ªå½¢å¼æ›´åºåˆ—ï¼Œç›´æ¥åœ¨åºåˆ—ä¸ŠäºŒåˆ†å‰ç¼€ + DP å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ±‚æ–¹æ¡ˆæ˜¯å®¹æ˜“çš„ã€‚æœ€åç»Ÿè®¡ DP å€¼æœ€å¤§ï¼Œ&lt;strong&gt;ä¸”ä¸èƒ½è¢«å…¶ä»–å¥—å¨ƒåŒ…å«çš„å…ƒç´ &lt;/strong&gt;å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;Tipï¼šåœ¨æ±‚è§£è¿‡ç¨‹ä¸­å¹¶ä¸ç”¨è€ƒè™‘å½“å‰å…ƒç´ å’Œå‰ç¼€ min å…ƒç´ é—´èƒ½å¦åŠ å…¥å…¶ä»–å¥—å¨ƒï¼Œå› ä¸ºä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(out&amp;gt;in\)&lt;/span&gt;ï¼Œå¦‚æœå­˜åœ¨è¿™æ ·çš„å¥—å¨ƒï¼Œå…¶ DP å€¼ä¼šæ¯”å‰ç¼€ min æ›´å°ï¼ŒçŸ›ç›¾ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; a(n + 1);
    int mxi = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i].first &amp;gt;&amp;gt; a[i].second;
        mxi = std::max(mxi, a[i].second);
    &amp;#125;
    std::sort(a.begin() + 1, a.end());
    std::vector&amp;lt;long long&amp;gt; g(n + 1), mxg(n + 1), f(n + 1), mx(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int j = std::upper_bound(a.begin() + 1, a.begin() + i, std::make_pair(a[i].second, 0x3f3f3f3f)) - a.begin() - 1;
        if (j == 0)
            f[i] = a[i].second, g[i] = 1ll;
        else
            f[i] = mx[j] + a[i].second, g[i] = mxg[j];
        long long now = f[i] - a[i].first;
        if (now &amp;lt; mx[i - 1])
            mx[i] = now, mxg[i] = g[i];
        else if (now == mx[i - 1])
            mx[i] = now, mxg[i] = (mxg[i - 1] + g[i]) % mod;
        else
            mx[i] = mx[i - 1], mxg[i] = mxg[i - 1];
    &amp;#125;
    auto now = 0x3f3f3f3fll, res = 0ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (a[i].first &amp;lt;= mxi)
            continue;
        if (f[i] &amp;lt; now)
            now = f[i], res = g[i];
        else if (f[i] == now)
            (res += g[i]) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---awesome-arrowland-adventure&#34;&gt;A - Awesome Arrowland Adventure&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6233&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6233&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ²¡ä»€ä¹ˆå¥½è¯´çš„å»ºå›¾ï¼Œæ³¨æ„åªèƒ½é¡ºæ—¶é’ˆè½¬&lt;/li&gt;
&lt;li&gt;ä»£ç ç•¥&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---åœ°é“çº¿è·¯&#34;&gt;B - åœ°é“çº¿è·¯&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6096&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6096&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘åšä¸€ä¸ªç¥ç§˜æ‹†ç‚¹ï¼ŒæŠŠæ¯ä¸ªç‚¹é™„ä¸Šçº¿è·¯å’Œè¿è¡Œæ–¹å‘çš„ä¿¡æ¯ï¼ˆæ‰€ä»¥æ˜¯å•å‘çš„ï¼‰&lt;/li&gt;
&lt;li&gt;è®¤ä¸ºè·¯å¾„ä»£ä»·æ˜¯äºŒå…ƒç»„ï¼Œé‚£ä¹ˆåŒæ¡çº¿è·¯ä¸­çš„ç‚¹é€šè¡Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\((0,-1)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;æ¢ä¹˜éœ€è¦ä¼˜åŒ–å»ºå›¾ï¼Œæ¯ä¸ªç‚¹å¯ä»¥èŠ± &lt;span class=&#34;math inline&#34;&gt;\((0,0)\)&lt;/span&gt; çš„ä»£ä»·èµ°åˆ°è¿™ä¸ªç‚¹çš„ã€æ¢ä¹˜ç‚¹ã€ï¼Œå†èŠ± &lt;span class=&#34;math inline&#34;&gt;\((1,0)\)&lt;/span&gt; çš„ä»£ä»·èµ°åˆ°å¦ä¸€ä¸ªåˆ†ç‚¹&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½† &lt;strong&gt;15 å¹´çš„æ—¶å€™ SPFA å·²ç»æ­»äº†&lt;/strong&gt;ï¼Œæ‰€ä»¥éœ€è¦å¥½å¥½è€ƒè™‘æ€ä¹ˆå®ç°æœ€çŸ­è·¯ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†ä¸¤é—®æ˜¯æœ‰æç¤ºæ€§åœ¨çš„ï¼Œå¯ä»¥æƒ³åˆ° 01 BFS è§£å†³ç¬¬ä¸€ä¸ªå…³é”®å­—ï¼Œæ¯”è¾ƒå¯¹çš„æƒ³æ³•æ˜¯&lt;strong&gt;æŠŠæ‰€æœ‰æœ€çŸ­è·¯æ‹¿å‡ºæ¥å½¢æˆ DAGï¼Œåœ¨ DAG ä¸Šå¯¹ç¬¬äºŒå…³é”®å­— DP&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; m &amp;gt;&amp;gt; n;
    std::unordered_map&amp;lt;std::string, int&amp;gt; tab;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; l(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::tuple&amp;lt;int, int, int&amp;gt; &amp;gt; &amp;gt; g0(n + 1), g1(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s, tab[s] = i;
    &amp;#125;
    int tot = n;
    for (int i = 1, k; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; k;
        int lp = 0, lq = 0;
        for (std::string s; k--; ) &amp;#123;
            std::cin &amp;gt;&amp;gt; s;
            int p = ++tot, q = ++tot, id = tab[s];
            g0.emplace_back(), g0.emplace_back();
            g1.emplace_back(), g1.emplace_back();
            if (lp) &amp;#123;
                g0[p].emplace_back(lp, 0, 1), g0[lq].emplace_back(q, 0, 1);
                g1[lp].emplace_back(p, 0, 1), g1[q].emplace_back(lq, 0, 1);
            &amp;#125;
            g0[p].emplace_back(id, 0, 0), g0[id].emplace_back(p, 1, 0);
            g1[id].emplace_back(p, 0, 0), g1[p].emplace_back(id, 1, 0);
            g0[q].emplace_back(id, 0, 0), g0[id].emplace_back(q, 1, 0);
            g1[id].emplace_back(q, 0, 0), g1[q].emplace_back(id, 1, 0);
            l[id].push_back(p), l[id].push_back(q);
            lp = p, lq = q;
        &amp;#125;
    &amp;#125;
    int s, t;
    &amp;#123;
        std::string s1, s2;
        std::cin &amp;gt;&amp;gt; s1 &amp;gt;&amp;gt; s2;
        s = ++tot, t = tab[s2];
        g0.emplace_back(), g1.emplace_back();
        int p = tab[s1];
        for (auto i : l[p])
            g0[s].emplace_back(i, 1, 0), g1[i].emplace_back(s, 1, 0);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; dis0(tot + 1, 0x3f3f3f3f), dis1(tot + 1, 0x3f3f3f3f);
    auto BFS = [&amp;amp;](decltype(g0) &amp;amp;g, decltype(dis0) &amp;amp;dis, int s) &amp;#123;
        std::deque&amp;lt;int&amp;gt; q;
        std::vector&amp;lt;int&amp;gt; vis(tot + 1);
        q.push_back(s), dis[s] = 0;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop_front();
            if (vis[x])
                continue;
            vis[x] = 1;
            for (auto [v, w1, w2] : g[x])
                if (dis[x] + w1 &amp;lt; dis[v]) &amp;#123;
                    dis[v] = dis[x] + w1;
                    if (w1 == 0)
                        q.push_front(v);
                    else
                        q.push_back(v);
                &amp;#125;
        &amp;#125;
        return;
    &amp;#125;;
    BFS(g0, dis0, s), BFS(g1, dis1, t);
    std::cout &amp;lt;&amp;lt; dis0[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::vector&amp;lt;int&amp;gt; deg(tot + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(tot + 1);
    for (int i = 1; i &amp;lt;= tot; ++i)
        for (auto [j, w1, w2] : g0[i])
            if (dis0[i] + dis1[j] + w1 == dis0[t])
                g[i].emplace_back(j, w2), ++deg[j];
    std::queue&amp;lt;int&amp;gt; q;
    for (int i = 1; i &amp;lt;= tot; ++i)
        if (!deg[i])
            q.push(i);
    std::vector&amp;lt;int&amp;gt; f(tot + 1);
    for (; !q.empty(); ) &amp;#123;
        int x = q.front();
        q.pop();
        for (auto [v, w] : g[x]) &amp;#123;
            f[v] = std::max(f[v], f[x] + w);
            if (!--deg[v])
                q.push(v);
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---droga-do-domu&#34;&gt;C - Droga do domu&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9402&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9402&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿˜æ˜¯åšä¸€ä¸ªå’Œä¸Šä¸€é¢˜ç±»ä¼¼çš„ä¼˜åŒ–å»ºå›¾&lt;/li&gt;
&lt;li&gt;æ­¤å¤–å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ Dij ä¸Š DP äº†ã€‚&lt;strong&gt;å›¾æ²¡æœ‰ç¯&lt;/strong&gt;ï¼Œç›´æ¥æ‹“æ‰‘å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥æ»šåŠ¨ä¼˜åŒ–ç©ºé—´ï¼Œä½†ä¼¼ä¹å¹¶æ— å¿…è¦ã€‚ä»£ç ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---tickets-p&#34;&gt;D - Tickets P&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7984&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7984&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ²¡ä»€ä¹ˆå¥½è¯´çš„çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œéš¾ç‚¹åœ¨äºå¦‚ä½•åŒæ—¶è·å– &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°ä»æŸä¸ªç‚¹èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼Œæœ‰ä¸€ç§ä¸åŠ£çš„èµ°æ³•ï¼š&lt;/p&gt;
&lt;img src=&#34;image.png&#34; /&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç»´æŠ¤ä¸€ä¸‹æ¯ä¸ªç‚¹å•ç‹¬èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æœ€å°ä»£ä»·å’ŒåŒæ—¶èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1,N\)&lt;/span&gt; çš„æœ€å°ä»£ä»·&lt;/p&gt;
çœ‹åˆ°ä¸€ç§æ›´åŠ å¯¹çš„å†™æ³•æ˜¯&lt;strong&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_v+w(u,v)\)&lt;/span&gt; æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é‚£ä¹ˆå¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(1,N\)&lt;/span&gt; å‡ºå‘åšä¸€ä¸ª Dijã€‚ä»£ç ç•¥ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---ç›‘ç‹±&#34;&gt;E - ç›‘ç‹±&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9520&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9520&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æ³¨æ„è¦èµ°ç®€å•è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨ç»•è·¯è®©é“çš„å¯èƒ½æ€§ã€‚å®¹æ˜“æ¨å‡ºï¼šè‹¥è¾“å…¥åˆæ³•ï¼Œæ€»èƒ½æ‰¾åˆ°ä¸€ç§æ–¹å¼ä½¿å¾—æ¯ä¸ªäººå—åˆ°çš„æŒ‡ä»¤æ˜¯è¿ç»­ç»™å‡ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;P.S. è¿™ä¸ªç»“è®ºæŒªåˆ°å›¾ä¸Šå°±ä¸æˆç«‹äº†ï¼Œå¾ˆå®¹æ˜“ä¸¾å‡ºåä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-1.png&#34; /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;è‹¥ä¸€ä¸ªäººçš„èµ·ç‚¹ / ç»ˆç‚¹åœ¨å¦ä¸€ä¸ªäººçš„è·¯å¾„ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªäººä¹‹é—´å­˜åœ¨å…ˆåå…³ç³»ã€‚å»ºå›¾åæ£€æŸ¥æ˜¯å¦ä¸º DAG å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½†å»ºå›¾æ˜¾ç„¶æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œå®¹æ˜“æ„é€ å‡ºæ•°æ®ä½¿å¾—è¾¹æ•°æ¥åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; çº§åˆ«ã€‚è€ƒè™‘ä¼˜åŒ–å»ºå›¾ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å¯ä»¥ç”¨ä¸€ä¸ªæ ‘å‰– / å€å¢çš„ç»“æ„æ¥å»ºå›¾ã€‚&lt;/p&gt;
Tipsï¼šè¿™ä¸€ç‚¹åŒæ ·æ˜¯ä¸€ä¸ªæ ‘ä¸Šè·¯å¾„é—®é¢˜ã€‚å‚è§ &lt;a href=&#34;/20231117/#æ ‘ä¸Šé—®é¢˜&#34;&gt;æ ‘ä¸Šé—®é¢˜ï¼Œå€å¢å’Œæ ‘å‰–çš„é€‰æ‹©ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿™é‡Œçš„è·¯å¾„è¦æ±‚ä¸¤ç«¯éƒ½æ˜¯å¼€çš„ï¼Œè¿™å°±å¯¼è‡´å€å¢å†™ç€å¾ˆå›°éš¾ï¼ˆè™½ç„¶æ ‘å‰–å¯èƒ½ä¹Ÿæ˜¯ï¼‰ï¼Œä¸æ’é™¤æˆ‘å†™ä¸‘äº†&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int K = 19;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;01-02.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, m;
        std::cin &amp;gt;&amp;gt; n;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
        std::vector&amp;lt;int&amp;gt; s(n + 1), t(n + 1);
        for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
            g1[x].push_back(y), g1[y].push_back(x);
        &amp;#125;
        std::cin &amp;gt;&amp;gt; m;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(m + 1);
        std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; a(m + 1);
        for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; a[i].first &amp;gt;&amp;gt; a[i].second;
            s[a[i].first] = i;
            t[a[i].second] = i;
        &amp;#125;
        int cnt = m;
        struct node &amp;#123; int fa, i0, i1; &amp;#125;;
        std::vector&amp;lt;std::array&amp;lt;node, K + 1&amp;gt; &amp;gt; p(n + 1);
        std::vector&amp;lt;int&amp;gt; i0(n + 1), i1(n + 1), dep(n + 1), deg(m + 1);
        auto init = [&amp;amp;](void) &amp;#123;
            g.emplace_back(), deg.emplace_back();
            return ++cnt;
        &amp;#125;;
        auto add = [&amp;amp;](int x, int y) &amp;#123;
            g[x].push_back(y), ++deg[y];
            return;
        &amp;#125;;
        for (int i = 1; i &amp;lt;= n; ++i)
            i0[i] = init(), i1[i] = init();
        std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
            if (s[x])
                add(s[x], i1[x]);
            if (t[x])
                add(i0[x], t[x]);
            for (auto i : g1[x])
                if (i != fa) &amp;#123;
                    dep[i] = dep[x] + 1;
                    p[i][0].fa = x;
                    p[i][0].i0 = init(), p[i][0].i1 = init();
                    add(p[i][0].i0, i0[i]), add(i1[i], p[i][0].i1);
                    for (int j = 1; j &amp;lt;= K; ++j) &amp;#123;
                        p[i][j].fa = p[p[i][j - 1].fa][j - 1].fa;
                        if (!p[i][j].fa)
                            break;
                        p[i][j].i0 = init(), p[i][j].i1 = init();
                        add(p[i][j].i0, p[i][j - 1].i0);
                        add(p[i][j].i0, p[p[i][j - 1].fa][j - 1].i0);
                        add(p[i][j - 1].i1, p[i][j].i1);
                        add(p[p[i][j - 1].fa][j - 1].i1, p[i][j].i1);
                    &amp;#125;
                    DFS(i, x);
                &amp;#125;
            return;
        &amp;#125;;
        dep[1] = 1, DFS(1, -1);
        for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
            auto [x, y] = a[i];
            if (x == y)
                continue;
            if (t[x])
                add(i, t[x]);
            if (s[y])
                add(s[y], i);
            if (dep[x] &amp;lt; dep[y])
                std::swap(x, y);
            x = p[x][0].fa;
            if (dep[x] &amp;gt;= dep[y]) &amp;#123;
                for (int j = K; ~j; --j)
                    if (dep[p[x][j].fa] &amp;gt;= dep[y]) &amp;#123;
                        add(i, p[x][j].i0), add(p[x][j].i1, i);
                        x = p[x][j].fa;
                    &amp;#125;
                if (x == y)
                    continue;
                add(i, p[x][0].i0), add(p[x][0].i1, i);
                x = p[x][0].fa;
            &amp;#125;
            y = p[y][0].fa;
            if (x != y) &amp;#123;
                for (int j = K; ~j; --j)
                    if (p[x][j].fa != p[y][j].fa) &amp;#123;
                        add(i, p[x][j].i0), add(i, p[y][j].i0);
                        add(p[x][j].i1, i), add(p[y][j].i1, i);
                        x = p[x][j].fa, y = p[y][j].fa;
                    &amp;#125;
                add(i, p[x][0].i0), add(i, p[y][0].i0);
                add(p[x][0].i1, i), add(p[y][0].i1, i);
                x = p[x][0].fa;
            &amp;#125;
            add(i, i0[x]), add(i1[x], i);
        &amp;#125;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            if (!deg[i])
                q.push(i);
        int tot = 0;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop(), ++tot;
            for (auto i : g[x])
                if (!--deg[i])
                    q.push(i);
        &amp;#125;
        std::cout &amp;lt;&amp;lt; (tot == cnt ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="äºŒåˆ†" />
        <category term="å€å¢" />
        <category term="è°ƒæ•´æ³•" />
        <category term="æœ€çŸ­è·¯" />
        <updated>2025-09-24T06:27:15.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250922/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250922/"/>
        <content type="html">&lt;p&gt;æœ€è¿‘çš„å‡ åœº abc, arc, cf, æ¨¡æ‹Ÿèµ›é¢˜&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;g---set-list&#34;&gt;G - Set list&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc424/tasks/abc424_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc424/tasks/abc424_g&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---slime-swap&#34;&gt;B - Slime Swap&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc206/tasks/arc206_b&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc206/tasks/arc206_b&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---lis-lds&#34;&gt;D - LIS âˆ© LDS&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc206/tasks/arc206_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc206/tasks/arc206_d&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;bubble-sort&#34;&gt;#3761. Bubble Sort&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://poj.org/problem?id=3761&#34; class=&#34;uri&#34;&gt;http://poj.org/problem?id=3761&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f.-bubble-sort&#34;&gt;F. Bubble Sort&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/2146/problem/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/2146/problem/F&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-limited-edition-shop&#34;&gt;E. Limited Edition Shop&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/2151/problem/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/2151/problem/E&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„é€ å‡ ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n=2,3\)&lt;/span&gt; çš„ä¾‹å­æ‰‹ç©ä¸€ä¸‹ï¼Œä¼šå‘ç°å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; ä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœåœ¨ A é‡Œçš„ç›¸å¯¹é¡ºåºæ˜¯ abï¼Œåœ¨ B é‡Œçš„ç›¸å¯¹é¡ºåºæ˜¯ baï¼Œé‚£ä¹ˆè¦é€‰ b å°±å¿…é¡»é€‰ aã€‚&lt;/li&gt;
&lt;li&gt;é‚£ä¹ˆä¼šæƒ³åˆ°æŠŠ A å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå¯¹äº B ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœå…¶åæ–¹æœ‰æ›´å°çš„å…ƒç´ ï¼Œé‚£ä¹ˆå¿…é¡»é€‰äº†å®ƒæ‰èƒ½é€‰è¿™ä¸ªæ•°ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘åœ¨ B ä¸­ DP æœ€åé€‰å‡ºæ¥çš„é›†åˆï¼Œé‚£ä¹ˆå¯¹äºå½“å‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œ&lt;strong&gt;è‹¥ä¸é€‰ï¼Œåˆ™ä¸å…è®¸ã€å·²é€‰é›†åˆã€ä¸­å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;x\)&lt;/span&gt; çš„æ•°ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤º DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå½“å‰å·²é€‰é›†åˆæœ€å¤§å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æœ€å¤§é›†åˆå¤§å°ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,B_i}\gets f_{i-1,j}+v, j&amp;lt;B_i\\
f_{i,j}\gets f_{i-1, j}+v, j &amp;gt; B_i\\
f_{i,j}\gets f_{i-1,j}, j &amp;lt; B_i
\]&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ˜¾ç„¶å¯ä»¥çº¿æ®µæ ‘ä¼˜åŒ–è½¬ç§»&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
const long long inf = 1e18;
struct &amp;#123;
    int l, r;
    long long u, d;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void pushval(int p, long long v) &amp;#123;
    t[p].d += v, t[p].u += v;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d), pushval(rt, t[p].d);
    t[p].d = 0ll;
    return;
&amp;#125;
void pushup(int p) &amp;#123;
    t[p].u = std::max(t[lt].u, t[rt].u);
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    t[p].u = -inf, t[p].d = 0ll;
    if (l == r)
        return;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void upd(int p, int x, long long v) &amp;#123;
    t[p].u = std::max(t[p].u, v);
    if (t[p].l == t[p].r)
        return;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, x, v);
    else
        upd(rt, x, v);
    return;
&amp;#125;
void add(int p, int l, int r, long long v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
long long ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u;
    pushdown(p);
    long long res = -inf;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        res = ask(lt, l, r);
    if (r &amp;gt; mid)
        res = std::max(res, ask(rt, l, r));
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n;
        std::cin &amp;gt;&amp;gt; n;
        std::vector&amp;lt;int&amp;gt; w(n + 1), k(n + 1), a(n + 1), b(n + 1), tab(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; w[i];
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; a[i], tab[a[i]] = i;
        for (int i = 1; i &amp;lt;= n; ++i)
            k[i] = w[a[i]];
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; b[i], b[i] = tab[b[i]];
        bld(1, 0, n), upd(1, 0, 0);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            if (b[i] != n)
                add(1, b[i] + 1, n, k[b[i]]);
            upd(1, b[i], ask(1, 0, b[i] - 1) + k[b[i]]);
        &amp;#125;
        std::cout &amp;lt;&amp;lt; t[1].u &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-å°çŒªç›–æˆ¿å­&#34;&gt;A. å°çŒªç›–æˆ¿å­&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/problem/51898&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/problem/51898&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; çš„ 01 çŸ©é˜µï¼Œæ¯ä¸€è¡Œæœ‰ 2 ä¸ª 1 æˆ–æ²¡æœ‰ 1ã€‚ç°éœ€é€‰æ‹©ä¸¤ä¸ª&lt;strong&gt;ç›¸é‚»çš„&lt;/strong&gt;è¡ŒåŒºé—´ï¼Œå¹¶ä¸º&lt;strong&gt;èŒƒå›´å†…çš„ç©ºè¡Œ&lt;/strong&gt;é€‰æ‹©ä¸¤ä¸ªä½ç½®æ”¹ä¸º 1ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªåŒºé—´æ˜¯å…¨ç­‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ±‚å¯èƒ½çš„æ–¹æ¡ˆã€‚å½“ç©ºè¡Œçš„æ¶‚è‰²æ–¹å¼ä¸åŒæˆ–é€‰æ‹©èŒƒå›´ä¸åŒçœ‹ä½œä¸åŒçš„æ–¹æ¡ˆã€‚å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,m\le 5000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ååº”æ˜¯æšä¸¾åˆ†ç•Œçº¿ + ä¸Šç«¯ç‚¹ï¼Œå‘ç°æ²¡æœ‰åŠæ³•åšï¼šå½“ä¸Šç«¯ç‚¹ç§»åŠ¨çš„æ—¶å€™ï¼Œä¸‹éƒ¨çŸ©å½¢ä¼šæ•´ä½“å¹³ç§»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿›ä¸€æ­¥è€ƒè™‘å¯¼è‡´è¿™ä¸ªé—®é¢˜çš„åŸå› &lt;/strong&gt;ï¼Œæ„Ÿå—åˆ°ä¸€ä¸ªå› ç´ æ˜¯é•¿åº¦åœ¨å˜ã€‚&lt;/li&gt;
&lt;li&gt;æ•…å›ºå®šé•¿åº¦æšä¸¾ï¼Œå‰ç¼€å’Œç»Ÿè®¡ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {m(m-1)}2\)&lt;/span&gt; çš„å¹‚æ¬¡å³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
    std::freopen(&amp;quot;piggy.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;piggy.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    const auto stime = std::chrono::steady_clock::now();
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::array&amp;lt;int, 2&amp;gt; &amp;gt; a(n + 1);
    std::vector&amp;lt;long long&amp;gt; ps(n + 1);
    const int s = m * (m - 1) / 2;
    ps[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i][0] &amp;gt;&amp;gt; a[i][1];
        ps[i] = ps[i - 1] * s % mod;
    &amp;#125;
    auto res = 0ll;
    for (int i = 1; i &amp;lt;= n / 2; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; cnt0(n + 1), cnts(n + 1);
        for (int u = 1; u &amp;lt;= n - i; ++u) &amp;#123;
            int d = u + i;
            if (!a[u][0] &amp;amp;&amp;amp; !a[d][0])
                cnts[u] = 1;
            else if (a[u][0] &amp;amp;&amp;amp; a[d][0] &amp;amp;&amp;amp; (a[u][0] != a[d][0] || a[u][1] != a[d][1]))
                cnt0[u] = 1;
            cnts[u] += cnts[u - 1], cnt0[u] += cnt0[u - 1];
        &amp;#125;
        for (int u = 1; u &amp;lt;= n - 2 * i + 1; ++u) &amp;#123;
            int ss = cnts[u + i - 1] - cnts[u - 1], s0 = cnt0[u + i - 1] - cnt0[u - 1];
            if (!s0)
                (res += ps[ss] % mod) %= mod;
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-æ¢ä¹˜æ—…è¡Œ&#34;&gt;B. æ¢ä¹˜æ—…è¡Œ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/problem/51900&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/problem/51900&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰‹ç©å¯ä»¥å‘ç°ã€ç¯ã€åœ¨é¢˜ç›®ä¸­æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿&lt;/li&gt;
&lt;li&gt;é‡è¦æ€§è´¨ï¼šè€ƒè™‘ä¸€ä¸ªç¯ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„ç‚¹ï¼Œä¸€å®šä¼šä»è¿™ä¸ªç‚¹å‡ºå‘æŠŠè¿™ä¸ªç¯è®¿é—®ä¸€éï¼Œåè¯æ³•æ˜“è¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…å¯ä»¥æŠŠæ¯ä¸ªç¯ç»™ã€åˆ é™¤ã€ã€‚å¯ä»¥ç”¨ä¸‹å›¾æ¦‚æ‹¬æ‰€æœ‰æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾å½“å‰ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; ä¸ºèµ·ç‚¹ï¼Œç»ˆç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œä¸”ä¹‹å‰å·²ç»åœ¨ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(s&amp;#39;\)&lt;/span&gt; ä¸ºèµ·ç‚¹æ—¶è®¿é—®è¿‡äº†ä¸€éƒ¨åˆ†è·¯å¾„ä¸Šçš„ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(m\to t\)&lt;/span&gt; æ˜¯æœ‰ç­”æ¡ˆçš„ï¼Œè€Œ &lt;span class=&#34;math inline&#34;&gt;\(s\to m\)&lt;/span&gt; éƒ½å¯ä»¥ç»§æ‰¿ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::freopen(&amp;quot;travel.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;travel.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt;::iterator&amp;gt; it(n + 1);
    for (int i = 1, k; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; k;
        for (int x; k--; )
            std::cin &amp;gt;&amp;gt; x, g[i].push_back(x);
        it[i] = g[i].begin();
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; res(n + 1), inq(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        if (!res[i]) &amp;#123;
            std::stack&amp;lt;int&amp;gt; st;
            for (int x = i; ; ) &amp;#123;
                if (it[x] == g[x].end() || res[x]) &amp;#123;
                    if (!res[x])
                        res[x] = x;
                    res[i] = res[x];
                    for (; !st.empty(); st.pop())
                        res[st.top()] = res[x], inq[st.top()] = 0;
                    break;
                &amp;#125;
                st.push(x), inq[x] = 1, x = *it[x];
                if (inq[x])
                    for (int p = -1; p != x; ) &amp;#123;
                        p = st.top(), st.pop();
                        inq[p] = 0, ++it[p];
                    &amp;#125;
            &amp;#125;
        &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <updated>2025-09-22T10:37:38.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250921/</id>
        <title>çº¿æ®µæ ‘æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250921/"/>
        <content type="html">&lt;p&gt;ä¿¡æ¯è½¬åŒ–ä¸ºä¸»&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---into-blocks-hard-version&#34;&gt;B - Into Blocks (hard version)&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1209G2&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1209G2&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;trickï¼šè€ƒå¯Ÿæ¯ä¸ªé¢œè‰²å‡ºç°çš„åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([s_{col},t_{col}]\)&lt;/span&gt;ï¼Œå¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\([s_{col},t_{col})\)&lt;/span&gt; æ‰“æ ‡è®°ï¼Œåˆ™æ²¡æœ‰è¢«æ‰“è¿‡æ ‡è®°çš„ç‚¹åèƒ½å¤Ÿè¿›è¡Œä¸€æ¬¡åˆ†æ®µã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äºæ¯ä¸€æ®µï¼Œå…¶ä»£ä»·ä¸ºæ®µé•¿åº¦ - ä¼—æ•°å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
è¿™ä¸ªä¼—æ•°ä¹ä¸€çœ‹æœ‰ç‚¹å“äººï¼Œå®é™…ä¸Šå‘ç°ç”±äºæ¯ä¸ªå…ƒç´ å‡ºç°çš„æ‰€æœ‰ä½ç½®éƒ½åœ¨è¿™ä¸ªæ®µé‡Œï¼Œæ‰€ä»¥å¯ä»¥è®°å½•æ¯ä¸ªå…ƒç´ çš„ä¸ªæ•°ï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ åªé’¦å®šå…¶ä¸­ä¸€ä¸ªä½ç½®æ¥è®°å½•å³å¯å¿«é€Ÿç»´æŠ¤ã€‚&lt;/li&gt;
&lt;li&gt;å‘ç°çº¿æ®µæ ‘èƒ½å¤Ÿæ¯”è¾ƒå®¹æ˜“åœ°ç»´æŠ¤å…¨å±€æŸ¥è¯¢ï¼šç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä½ç½®æ˜¯ç»å…¸ trickï¼›ä¸”å®¹æ˜“å‘ç°ã€æ®µé•¿ã€ä¹‹å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œæ•…åªéœ€ç»´æŠ¤ä¼—æ•°ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®ç°æŠ€å·§ï¼šå•ç‚¹æœ¬èº«å°±æ˜¯è‡ªå·±çš„æœ€å°å€¼ï¼Œä»è¿™ä¸€ç‚¹å‡ºå‘å¯ä»¥è§„é¿å¾ˆå¤šè¾¹ç•Œæƒ…å†µã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int lim = 2e5;
const int maxn = 2e5 + 5;
struct node &amp;#123;
    int l, r, u, d;
    int lu, ru, mn, mx;
    node operator+ (const node &amp;amp;q) const &amp;#123;
        node res;
        res.d = 0;
        res.l = l, res.r = q.r;
        res.mx = std::max(mx, q.mx);
        res.mn = std::min(mn, q.mn);
        if (mn &amp;lt; q.mn) &amp;#123;
            res.mn = mn, res.u = u;
            res.lu = lu, res.ru = std::max(q.mx, ru);
        &amp;#125;
        else if (q.mn &amp;lt; mn) &amp;#123;
            res.mn = q.mn, res.u = q.u;
            res.lu = std::max(mx, q.lu), res.ru = q.ru;
        &amp;#125;
        else &amp;#123;
            res.lu = lu, res.ru = q.ru;
            res.u = u + q.u + std::max(ru, q.lu);
        &amp;#125;
        return res;
    &amp;#125;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void pushval(int p, int d) &amp;#123;
    t[p].mn += d, t[p].d += d;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d), pushval(rt, t[p].d);
    t[p].d = 0;
    return;
&amp;#125;
void upd(int p, int x, int v) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        t[p].u = t[p].mx = v;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, x, v);
    else
        upd(rt, x, v);
    t[p] = t[lt] + t[rt];
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    t[p] = t[lt] + t[rt];
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, q;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    std::vector&amp;lt;std::set&amp;lt;int&amp;gt; &amp;gt; st(lim + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        st[a[i]].emplace(i);
    &amp;#125;
    bld(1, 1, n);
    for (int i = 1; i &amp;lt;= lim; ++i)
        if (!st[i].empty()) &amp;#123;
            int s = *st[i].begin(), t = *--st[i].end();
            if (s &amp;lt;= t - 1)
                add(1, s, t - 1, 1);
            upd(1, s, (int)st[i].size());
        &amp;#125;
    std::cout &amp;lt;&amp;lt; n - ::t[1].u - ::t[1].lu - ::t[1].ru  &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    auto work = [&amp;amp;](int v, int k) &amp;#123;
        if (st[v].empty())
            return;
        int s = *st[v].begin(), t = *--st[v].end();
        if (s &amp;lt;= t - 1)
            add(1, s, t - 1, k);
        upd(1, s, k == 1 ? (int)st[v].size() : 0);
        return;
    &amp;#125;;
    for (int i, x; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; i &amp;gt;&amp;gt; x;
        work(a[i], -1), st[a[i]].erase(i), work(a[i], 1);
        a[i] = x;
        work(a[i], -1), st[a[i]].insert(i), work(a[i], 1);
        std::cout &amp;lt;&amp;lt; n - ::t[1].u - ::t[1].lu - ::t[1].ru  &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---seats-æ’åº§ä½&#34;&gt;C - seats æ’åº§ä½&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4898&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4898&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆæœ‰ä»·å€¼çš„ä¸€ä¸ªé¢˜&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å¯¹äºä¸€ä¸ªå›ºå®šçš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œè€ƒè™‘æ€ä¹ˆåˆ»ç”»åˆæ³•çŸ©å½¢&lt;/p&gt;
&lt;p&gt;å‘ç°ã€å‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå…ƒç´ æ„æˆçŸ©å½¢ã€æ¯”ã€å¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„çŸ©å½¢åŒ…å«å‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå…ƒç´ ã€æ›´åˆç†&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è€ƒè™‘å‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå…ƒç´ åœ¨æ»¡è¶³ä»€ä¹ˆæ¡ä»¶æ—¶æ„æˆçŸ©å½¢&lt;/p&gt;
&lt;p&gt;æˆ‘æœ€å¼€å§‹çš„æƒ³æ³•æ˜¯ã€è®°å½•è¿™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå…ƒç´ å æ®çš„æœ€å¤§ã€æœ€å°ã€æœ€å·¦ã€æœ€å³ï¼Œå¦‚æœä¹˜èµ·æ¥ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåˆæ³•ã€&lt;/p&gt;
&lt;p&gt;ä½†ä¼šå‘ç°è¿™ä¸ªè½¬åŒ–æ˜¯ä¸å¥½åšçš„ï¼Œæˆ–è€…è¯´å°±åˆå¾€ä¸Šé¢é‚£ä¸ªé”™è¯¯çš„åˆ¤å®šè½¬åŒ–ï¼ˆå¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„çŸ©å½¢åŒ…å«å‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªå…ƒç´ ï¼‰é äº†ã€‚ä¸¤ä¸ªéƒ½æœ‰ä¸€ä¸ªå…±åŒçš„é—®é¢˜ï¼Œå°±æ˜¯è¿‡äºä¾èµ–è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé™åˆ¶å¤ªå…·ä½“äº†ï¼Œå¯¼è‡´ä¸èƒ½å¾ˆå¥½åœ°åº”ç”¨åˆ°æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç°åœ¨è¿™ä¸ªåˆ¤å®šçš„è½¬åŒ–æ¯”è¾ƒåˆç†çš„åœ°æ–¹å°±åœ¨äºï¼Œå¯¹çŸ©å½¢æœ¬èº«ä¸å­˜åœ¨çº¦æŸï¼Œåªæ˜¯è¦æ±‚æ„æˆçŸ©å½¢ã€‚è¿™æ ·å°±å…è®¸ç›´æ¥ä»å›¾å½¢å‡ºå‘ï¼Œ&lt;strong&gt;æ›´å¤šåœ°è€ƒè™‘æ€æ ·ç”¨å•ç‚¹ä¿¡æ¯åˆå¹¶å‡ºçŸ©å½¢ä¸å¦&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŠŠ &lt;span class=&#34;math inline&#34;&gt;\([0,k)\)&lt;/span&gt; æŸ“æˆé»‘è‰²ï¼Œå…¶ä»–ä¸ºç™½è‰²ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªç²—æš´ä½†ç®€å•çš„æ–¹æ³•æ¥åˆ»ç”»ã€çŸ©å½¢ã€è¿™ä¸ªè¦æ±‚ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å›¾å½¢å­˜åœ¨å››ä¸ªã€è§’ã€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å†åˆ»ç”»ä¸€ä¸‹ã€è§’ã€ï¼šé»‘ç‚¹å·¦ä¸Š / å·¦ä¸‹ / å³ä¸Š / å³ä¸‹ä¸¤ä¸ªç‚¹éƒ½ä¸ºç™½ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å½“ç„¶è¿™æ ·æ˜¯å¾ˆè’è°¬çš„ï¼Œå› ä¸ºä¸‹å›¾æ˜¾ç„¶ä¸åªæœ‰å››ä¸ªè§’ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-1.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸æŠŠä¸€ä¸ªå‡¹è§’ä¹Ÿç®—ä½œè§’ï¼Œä¸éš¾å‘ç°æŠŠä¸Šæ–¹å‡¸è§’çš„å®šä¹‰ä¸­çš„ä¸»ä½“æ¢æˆç™½ç‚¹å³å¯å®šä¹‰å‡¹è§’ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¼˜åŒ–ï¼šç®—è´¡çŒ®&lt;/p&gt;
&lt;p&gt;ç»´æŠ¤å½“å‰æ—¶åˆ»ï¼Œæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(4nm\)&lt;/span&gt; ä¸ªè§’åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å¤„æ˜¯å¦å­˜åœ¨&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶è¦ç”¨ä¸€ä¸ªç±»ä¼¼ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸ªæ•°çš„æ–¹æ³•æ¥ç»´æŠ¤æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; ä¸ªè§’ä¸ªæ•°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªæ•°ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è€ƒè™‘è¿™ä¹ˆä¸€ä¸ªå¯èƒ½çš„è§’ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å…¶å­˜åœ¨å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸ºé»‘ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B,C\)&lt;/span&gt; ä¸ºç™½ï¼ˆå‡¸è§’ï¼‰ï¼Œæˆ– &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; ä¸ºç™½ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(B,C\)&lt;/span&gt; ä¸ºé»‘ï¼ˆå‡¹è§’ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒå¯Ÿ &lt;span class=&#34;math inline&#34;&gt;\(A,B,C\)&lt;/span&gt; ç¬¬ä¸€æ¬¡å˜é»‘çš„æ—¶é—´ &lt;span class=&#34;math inline&#34;&gt;\(k_A,k_B,k_C\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; èƒ½å¤Ÿå¯¹æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\in[k_A,\min\{k_B,k_C\})\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k\in[\max\{k_B,k_C\},k_A)\)&lt;/span&gt; é€ æˆè´¡çŒ®ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡ä¿®æ”¹åªä¼šåš &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ¬¡åŒºé—´åŠ ï¼Œæ˜¯å¯ç»´æŠ¤çš„ã€‚æ³¨æ„ä¸¤ä¸ªè¢«äº¤æ¢çš„ç‚¹å¯èƒ½ä¼šæœ‰å…¬å…±çš„ç›¸é‚»ç‚¹ï¼Œéœ€è¦ç‰¹åˆ«å¤„ç†ä¸€ä¸‹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿™ä¸ªä¸œè¥¿æœ¬è´¨ä¸Šå¯ä»¥çœ‹ä½œä¸€ä¸ª 2â¨‰2 çš„&lt;a href=&#34;https://blog.csdn.net/asplh/article/details/136652197&#34;&gt;Soble ç®—å­&lt;/a&gt;ï¼Œæ‰€ä»¥å¯ä»¥æŠ å‡ºæ¥ä¸€èˆ¬å®šä¹‰ä¸Šçš„è§’&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;p&gt;non-interactive version:&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int dir[][2] = &amp;#123; &amp;#123; 0, -1 &amp;#125;, &amp;#123; 0, 1 &amp;#125;, &amp;#123; -1, 0 &amp;#125;, &amp;#123; 1, 0 &amp;#125; &amp;#125;;
const int maxn = 1e6 + 5;
struct node &amp;#123;
    int l, r, u, d, mn;
    node operator+ (const node &amp;amp;q) const &amp;#123;
        node res;
        res.l = l, res.r = q.r, res.d = 0;
        res.mn = std::min(mn, q.mn), res.u = 0;
        if (mn == res.mn)
            res.u = u;
        if (q.mn == res.mn)
            res.u += q.u;
        return res;
    &amp;#125;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r, t[p].u = r - l + 1;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void pushval(int p, int v) &amp;#123;
    t[p].mn += v, t[p].d += v;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d), pushval(rt, t[p].d);
    t[p].d = 0;
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    t[p] = t[lt] + t[rt];
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, q;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; q;
    const int N = n * m;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; pos(N + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; id(n + 2, std::vector&amp;lt;int&amp;gt; (m + 2, N + 1));
    for (int i = 1, x, y; i &amp;lt;= N; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y, ++x, ++y;
        id[x][y] = i, pos[i] = &amp;#123; x, y &amp;#125;;
    &amp;#125;
    bld(1, 1, N);
    auto work = [&amp;amp;](int x, int y, int k) &amp;#123;
        for (int i = 0; i &amp;lt; 2; ++i)
            for (int j = 2; j &amp;lt; 4; ++j) &amp;#123;
                int x1 = x + dir[j][0], y1 = y + dir[i][1];
                if (id[x][y] &amp;lt; std::min(id[x1][y], id[x][y1]))
                    add(1, id[x][y], std::min(id[x1][y], id[x][y1]) - 1, k);
                if (std::max(id[x1][y], id[x][y1]) &amp;lt; id[x][y])
                    add(1, std::max(id[x1][y], id[x][y1]), id[x][y] - 1, k);
            &amp;#125;
        return;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 1; j &amp;lt;= m; ++j)
            work(i, j, 1);
    for (int i1, i2; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; i1 &amp;gt;&amp;gt; i2, ++i1, ++i2;
        auto [x1, y1] = pos[i1];
        auto [x2, y2] = pos[i2];
        std::set&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; st;
        st.emplace(x1, y1);
        for (auto [fx, fy] : dir) &amp;#123;
            int x = x1 + fx, y = y1 + fy;
            if (x &amp;gt;= 1 &amp;amp;&amp;amp; x &amp;lt;= n &amp;amp;&amp;amp; y &amp;gt;= 1 &amp;amp;&amp;amp; y &amp;lt;= m)
                st.emplace(x, y);
        &amp;#125;
        st.emplace(x2, y2);
        for (auto [fx, fy] : dir) &amp;#123;
            int x = x2 + fx, y = y2 + fy;
            if (x &amp;gt;= 1 &amp;amp;&amp;amp; x &amp;lt;= n &amp;amp;&amp;amp; y &amp;gt;= 1 &amp;amp;&amp;amp; y &amp;lt;= m)
                st.emplace(x, y);
        &amp;#125;
        for (auto [x, y] : st)
            work(x, y, -1);
        std::swap(id[x1][y1], id[x2][y2]), std::swap(pos[i1], pos[i2]);
        for (auto [x, y] : st)
            work(x, y, 1);
        std::cout &amp;lt;&amp;lt; t[1].u &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;interactive version:&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
#ifdef ONLINE_JUDGE
#include &amp;quot;seats.h&amp;quot;
#endif
const int dir[][2] = &amp;#123; &amp;#123; 0, -1 &amp;#125;, &amp;#123; 0, 1 &amp;#125;, &amp;#123; -1, 0 &amp;#125;, &amp;#123; 1, 0 &amp;#125; &amp;#125;;
const int maxn = 1e6 + 5;
struct node &amp;#123;
    int l, r, u, d, mn;
    node operator+ (const node &amp;amp;q) const &amp;#123;
        node res;
        res.l = l, res.r = q.r, res.d = 0;
        res.mn = std::min(mn, q.mn), res.u = 0;
        if (mn == res.mn)
            res.u = u;
        if (q.mn == res.mn)
            res.u += q.u;
        return res;
    &amp;#125;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r, t[p].u = r - l + 1;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void pushval(int p, int v) &amp;#123;
    t[p].mn += v, t[p].d += v;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d), pushval(rt, t[p].d);
    t[p].d = 0;
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    t[p] = t[lt] + t[rt];
    return;
&amp;#125;
int n, m, N;
std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; pos;
std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; id(n + 2, std::vector&amp;lt;int&amp;gt; (m + 2, N + 1));
void work(int x, int y, int k) &amp;#123;
    for (int i = 0; i &amp;lt; 2; ++i)
        for (int j = 2; j &amp;lt; 4; ++j) &amp;#123;
            int x1 = x + dir[j][0], y1 = y + dir[i][1];
            if (id[x][y] &amp;lt; std::min(id[x1][y], id[x][y1]))
                add(1, id[x][y], std::min(id[x1][y], id[x][y1]) - 1, k);
            if (std::max(id[x1][y], id[x][y1]) &amp;lt; id[x][y])
                add(1, std::max(id[x1][y], id[x][y1]), id[x][y] - 1, k);
        &amp;#125;
    return;
&amp;#125;;
void give_initial_chart(int n, int m, std::vector&amp;lt;int&amp;gt; R, std::vector&amp;lt;int&amp;gt; C) &amp;#123;
    ::n = n, ::m = m, N = n * m;
    pos.resize(N + 1);
    id.assign(n + 2, std::vector&amp;lt;int&amp;gt; (m + 2, N + 1));
    for (int i = 0; i &amp;lt; N; ++i) &amp;#123;
        int x = R[i] + 1, y = C[i] + 1;
        id[x][y] = i + 1, pos[i + 1] = &amp;#123; x, y &amp;#125;;
    &amp;#125;
    bld(1, 1, N);
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 1; j &amp;lt;= m; ++j)
            work(i, j, 1);
    return;
&amp;#125;
int swap_seats(int i1, int i2) &amp;#123;
    ++i1, ++i2;
    auto [x1, y1] = pos[i1];
    auto [x2, y2] = pos[i2];
    std::set&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; st;
    st.emplace(x1, y1);
    for (auto [fx, fy] : dir) &amp;#123;
        int x = x1 + fx, y = y1 + fy;
        if (x &amp;gt;= 1 &amp;amp;&amp;amp; x &amp;lt;= n &amp;amp;&amp;amp; y &amp;gt;= 1 &amp;amp;&amp;amp; y &amp;lt;= m)
            st.emplace(x, y);
    &amp;#125;
    st.emplace(x2, y2);
    for (auto [fx, fy] : dir) &amp;#123;
        int x = x2 + fx, y = y2 + fy;
        if (x &amp;gt;= 1 &amp;amp;&amp;amp; x &amp;lt;= n &amp;amp;&amp;amp; y &amp;gt;= 1 &amp;amp;&amp;amp; y &amp;lt;= m)
            st.emplace(x, y);
    &amp;#125;
    for (auto [x, y] : st)
        work(x, y, -1);
    std::swap(id[x1][y1], id[x2][y2]), std::swap(pos[i1], pos[i2]);
    for (auto [x, y] : st)
        work(x, y, 1);
    return t[1].u;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---å•æ—‹&#34;&gt;D - å•æ—‹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3721&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3721&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘ç°ä»»æ„æ—¶åˆ»å‚ä¸æ—‹è½¬çš„éƒ½æ˜¯æœ€å€¼ï¼Œç®€å•åˆ†æå¯ä»¥å‘ç°åšçš„è¿™ä»¶äº‹æƒ…æ˜¯æŠŠæœ€å€¼ç§»åˆ°æ ¹ï¼Œå…¶ä»–ç‚¹ç›¸å¯¹å…³ç³»ä¸å˜ï¼Œè½¬åŒ–ä¸ºç»´æŠ¤æ·±åº¦&lt;/li&gt;
&lt;li&gt;è€ƒè™‘æ–°åŠ å…¥ç‚¹ï¼Œå¯ä»¥åˆ©ç”¨ BST çš„æ€§è´¨ï¼Œç›´æ¥æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å‰é©±ã€åç»§ï¼Œåˆ™äºŒè€…å­˜åœ¨ç¥–å­™å…³ç³»ï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ¥åœ¨çŸ®çš„ä¸‹é¢å³å¯&lt;/li&gt;
&lt;li&gt;è€ƒè™‘åšä¸€ä¸ªå…ˆåˆ å†åŠ çš„è¿‡ç¨‹ï¼Œåˆ ä¼šå½±å“å„¿å­çš„æ·±åº¦ï¼ˆæ˜¾ç„¶åªæœ‰ä¸€ä¾§å„¿å­ï¼‰ï¼ŒåŠ ä¼šå½±å“å…¨æ ‘æ·±åº¦&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---nekameleoni&#34;&gt;E - NEKAMELEONI&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7230&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7230&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <updated>2025-09-21T08:44:54.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250911/</id>
        <title>å‰å¸æœº + å†å²å’Œç»ƒä¹ </title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250911/"/>
        <content type="html">&lt;p&gt;å¹¶éæ‰€æœ‰å†å²å’Œéƒ½æ˜¯å‰å¸æœº&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---just-another-game-of-stones&#34;&gt;A - Just Another Game of Stones&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9631&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9631&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘ç°å¦‚æœé€‰å®šäº†è¿™ä¸€æ­¥å–çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œé‚£ä¹ˆè¦æ‹¿çš„çŸ³å­æ˜¯å®šå€¼ &lt;span class=&#34;math inline&#34;&gt;\(a_i-a_i\oplus s\)&lt;/span&gt;ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(a_i\le a_i\oplus s\)&lt;/span&gt; æ—¶ä¸åˆæ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯ä»¥ç”¨å‰å¸æœºç»´æŠ¤ä¿®æ”¹å’ŒåŒºé—´å¼‚æˆ–å’Œï¼Œé‚£ä¹ˆè¯¢é—®éœ€è¦è½¬åŒ–ã€‚&lt;/p&gt;
ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;gt;a_i\oplus s\)&lt;/span&gt; çš„æ¬¡æ•°ï¼Œç»“åˆ&lt;strong&gt;å¼‚æˆ–æ˜¯ä¸å¸¦è¿›ä½çš„åŒºé—´åŠ &lt;/strong&gt;çš„è§‚ç‚¹ï¼Œè€ƒå¯Ÿã€åŠ æ•°ã€&lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„æœ€é«˜ä½ï¼Œå½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åœ¨è¿™ä¸€ä½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ—¶æœ‰è´¡çŒ®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…å†ç»´æŠ¤ä¸€ä¸‹æ¯ä¸€ä½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°å³å¯ã€‚å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(q\log n\log V)\)&lt;/span&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 1 &amp;lt;&amp;lt; 30;
const int maxn = 2e5 + 5;
struct &amp;#123;
    std::array&amp;lt;int, 30&amp;gt; u;
    int l, r, cnt, mn, se, d, s;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
int a[maxn];
void pushup(int p) &amp;#123;
    if (t[lt].mn == t[rt].mn) &amp;#123;
        t[p].mn = t[lt].mn, t[p].cnt = t[lt].cnt + t[rt].cnt;
        t[p].se = std::min(t[lt].se, t[rt].se);
    &amp;#125;
    else if (t[lt].mn &amp;lt; t[rt].mn) &amp;#123;
        t[p].mn = t[lt].mn, t[p].cnt = t[lt].cnt;
        t[p].se = std::min(t[lt].se, t[rt].mn);
    &amp;#125;
    else &amp;#123;
        t[p].mn = t[rt].mn, t[p].cnt = t[rt].cnt;
        t[p].se = std::min(t[lt].mn, t[rt].se);
    &amp;#125;
    t[p].s = t[lt].s ^ t[rt].s;
    for (int i = 0; i &amp;lt; 30; ++i)
        t[p].u[i] = t[lt].u[i] + t[rt].u[i];
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].d = -inf;
    t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        for (int i = 0; i &amp;lt; 30; ++i)
            t[p].u[i] = (a[l] &amp;gt;&amp;gt; i) &amp;amp; 1;
        t[p].s = t[p].mn = a[l], t[p].cnt = 1, t[p].se = inf;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    pushup(p);
    return;
&amp;#125;
void pushval(int p, int v) &amp;#123;
    if (v &amp;gt; t[p].mn) &amp;#123;
        for (int i = 0; i &amp;lt; 30; ++i) &amp;#123;
            if ((t[p].mn &amp;gt;&amp;gt; i) &amp;amp; 1)
                t[p].u[i] -= t[p].cnt;
            if ((v &amp;gt;&amp;gt; i) &amp;amp; 1)
                t[p].u[i] += t[p].cnt;
        &amp;#125;
        if (t[p].cnt &amp;amp; 1)
            t[p].s ^= t[p].mn ^ v;
        t[p].mn = t[p].d = v;
    &amp;#125;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d != -inf) &amp;#123;
        pushval(lt, t[p].d), pushval(rt, t[p].d);
        t[p].d = -inf;
    &amp;#125;
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (t[p].mn &amp;gt;= v)
        return;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r &amp;amp;&amp;amp; v &amp;lt; t[p].se) &amp;#123;
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
int askt(int p, int l, int r, int i) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u[i];
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1, res = 0;
    if (l &amp;lt;= mid)
        res = askt(lt, l, r, i);
    if (r &amp;gt; mid)
        res += askt(rt, l, r, i);
    return res;
&amp;#125;
int asks(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].s;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1, res = 0;
    if (l &amp;lt;= mid)
        res = asks(lt, l, r);
    if (r &amp;gt; mid)
        res ^= asks(rt, l, r);
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    bld(1, 1, n);
    for (int op, l, r, v; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; op &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r &amp;gt;&amp;gt; v;
        if (op == 1)
            add(1, l, r, v);
        else &amp;#123;
            int s = asks(1, l, r) ^ v;
            if (s == 0) &amp;#123;
                std::cout &amp;lt;&amp;lt; 0 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
                continue;
            &amp;#125;
            int t = std::__lg(s);
            std::cout &amp;lt;&amp;lt; askt(1, l, r, t) + ((v &amp;gt;&amp;gt; t) &amp;amp; 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---prof.-pangs-sequence-c---test_90&#34;&gt;B - Prof.Â Pangâ€™s sequence / C - TEST_90&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P10822&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P10822&lt;/a&gt; / &lt;a href=&#34;https://www.luogu.com.cn/problem/P9990&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9990&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†å²å’Œç»´æŠ¤å­åŒºé—´é—®é¢˜æ˜¯ä¸€ä¸ªå›ºå®šçš„ trickï¼Œåªéœ€è¦å¯¹äºæ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œç»™åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; åŠ ä¸€ã€‚&lt;/li&gt;
&lt;li&gt;ç¦»çº¿æ‰«æçº¿ï¼Œå¯¹äºå½“å‰å³ç«¯ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œè®°å½•æ¯ç§æ•°æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(pos\)&lt;/span&gt;ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„é¢œè‰²ä¸º &lt;code&gt;1&lt;/code&gt;ï¼Œä»å³åˆ°å·¦ï¼Œæ¯ç¢°åˆ°ä¸€ä¸ªæ–°çš„ &lt;span class=&#34;math inline&#34;&gt;\(pos\)&lt;/span&gt; å°±åˆ‡æ¢é¢œè‰²&lt;/li&gt;
&lt;li&gt;æ˜¾ç„¶å¯¹äºå½“å‰ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œåº”è¯¥è¢«åŠ ä¸€çš„ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å°±æ˜¯é¢œè‰²ä¸º &lt;code&gt;1&lt;/code&gt; çš„è¿™äº›ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘æ›´å¿«åœ°ç»´æŠ¤è¿™ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„é¢œè‰²å’Œ &lt;span class=&#34;math inline&#34;&gt;\(r-1\)&lt;/span&gt; ä¸åŒæ—¶å°±å¯ä»¥å¯¹ &lt;span class=&#34;math inline&#34;&gt;\([1,r)\)&lt;/span&gt; åšä¸€æ¬¡ flipï¼Œæ˜¯å¯è¡Œçš„&lt;/li&gt;
&lt;li&gt;åœ¨æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¤„æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; çš„åŒºé—´å’Œå³å¯ã€‚&lt;/li&gt;
&lt;li&gt;åæ§½ï¼šå¹¶éæ‰€æœ‰å†å²å’Œéƒ½æ˜¯å‰å¸æœº&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e5 + 5;
struct &amp;#123;
    long long s;
    int l, r, d0, d1, df, ds, u0, u1;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void pushup(int p) &amp;#123;
    t[p].u0 = t[lt].u0 + t[rt].u0;
    t[p].u1 = t[lt].u1 + t[rt].u1;
    return;
&amp;#125;
void pushval(int p, long long v0, long long v1, bool f) &amp;#123;
    if (f) &amp;#123;
        t[p].df ^= 1;
        std::swap(t[p].u0, t[p].u1);
        std::swap(t[p].d0, t[p].d1);
    &amp;#125;
    t[p].d0 += v0, t[p].d1 += v1;
    t[p].s += t[p].u0 * v0 + t[p].u1 * v1;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d0, t[p].d1, t[p].df);
    pushval(rt, t[p].d0, t[p].d1, t[p].df);
    t[p].d0 = t[p].d1 = t[p].df = 0;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    t[p].u0 = r - l + 1;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void flip(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, 0, 0, 1);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        flip(lt, l, r);
    if (r &amp;gt; mid)
        flip(rt, l, r);
    pushup(p);
    return;
&amp;#125;
long long ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].s;
    pushdown(p);
    auto res(0ll);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        res = ask(lt, l, r);
    if (r &amp;gt; mid)
        res += ask(rt, l, r);
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), la(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    int m;
    std::cin &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; res(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; u(n + 1);
    for (int i = 1, l, r; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        u[r].emplace_back(l, i);
    &amp;#125;
    bld(1, 1, n);
    for (int r = 1; r &amp;lt;= n; ++r) &amp;#123;
        flip(1, la[a[r]] + 1, r);
        pushval(1, 0, 1, 0);
        for (auto [l, id] : u[r])
            res[id] = ask(1, l, r);
        la[a[r]] = r;
    &amp;#125;
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---stations&#34;&gt;D - Stations&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1572F&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1572F&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¤ªèƒ½ç›´æ¥ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œä½†å‘ç°å¦‚æœç»´æŠ¤æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœ€è¿œèƒ½åˆ°è¾¾çš„ç‚¹ï¼Œå‘ç°æ¯æ¬¡æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¼šæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å·¦è¾¹çš„æ‰€æœ‰ç‚¹å€¼å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j-1\)&lt;/span&gt; å– minã€‚&lt;/li&gt;
&lt;li&gt;å‘ç°å‰å¸æœºèƒ½å¤Ÿåœ¨å– min çš„åŒæ—¶åœ¨å¦ä¸€ä¸ªæ ‘çŠ¶æ ‘ç»„é‡Œç»´æŠ¤å·®åˆ†&lt;/li&gt;
&lt;li&gt;éœ€è¦æ³¨æ„æ›´æ–°çš„æ—¶æœºï¼Œåº”è¯¥æ˜¯æ¯æ¬¡çº¿æ®µæ ‘æ›´æ–°å‡½æ•°è®¿é—®åˆ°å®Œæ•´èŠ‚ç‚¹æ—¶ã€‚&lt;/li&gt;
&lt;li&gt;å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(q\log^2n)\)&lt;/span&gt;ã€‚ä½†çœŸçš„å—ï¼Ÿå•ç‚¹ä¿®æ”¹ä¼¼ä¹å¯¹åŠ¿èƒ½æœ‰å½±å“ï¼Ÿç„¶è€Œå¹¶ä¸ä¼šç›¸å…³åˆ†æã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;çœ‹èµ·æ¥æœ‰ç‚¹æ¿€è¿›äº†ï¼Œæ²¡æƒ³åˆ°ç¡®å®æ˜¯æ­£è§£ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å¯ä»¥å‘ç°æ ‘çŠ¶æ•°ç»„åœ¨æ—¶é—´ä¸Šç¡®å®æ˜¯æœ‰ä¼˜åŠ¿çš„&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
const int inf = 0x3f3f3f3f;
struct &amp;#123;
    int l, r, mx, se, d, cnt;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
int n;
long long bit[maxn][2];
int lowbit(int x) &amp;#123; return x &amp;amp; -x; &amp;#125;
void add(int x, long long v) &amp;#123;
    for (int i = x; i &amp;lt;= n; i += lowbit(i))
        bit[i][0] += v, bit[i][1] += v * (x - 1);
    return;
&amp;#125;
long long ask(int x) &amp;#123;
    auto res = 0ll;
    for (int i = x; i; i -= lowbit(i))
        res += bit[i][0] * x - bit[i][1];
    return res;
&amp;#125;
void pushup(int p) &amp;#123;
    if (t[lt].mx == t[rt].mx) &amp;#123;
        t[p].mx = t[lt].mx, t[p].cnt = t[lt].cnt + t[rt].cnt;
        t[p].se = std::max(t[lt].se, t[rt].se);
    &amp;#125;
    else if (t[lt].mx &amp;gt; t[rt].mx) &amp;#123;
        t[p].mx = t[lt].mx, t[p].cnt = t[lt].cnt;
        t[p].se = std::max(t[lt].se, t[rt].mx);
    &amp;#125;
    else &amp;#123;
        t[p].mx = t[rt].mx, t[p].cnt = t[rt].cnt;
        t[p].se = std::max(t[lt].mx, t[rt].se);
    &amp;#125;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].d = inf;
    t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        add(l, 1), add(l + 1, -1);
        t[p].mx = l, t[p].se = -1, t[p].cnt = 1;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    pushup(p);
    return;
&amp;#125;
void pushval(int p, int v) &amp;#123;
    if (v &amp;lt;= t[p].mx)
        t[p].mx = t[p].d = v;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d != inf) &amp;#123;
        pushval(lt, t[p].d), pushval(rt, t[p].d);
        t[p].d = inf;
    &amp;#125;
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (t[p].mx &amp;lt;= v)
        return;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r &amp;amp;&amp;amp; v &amp;gt; t[p].se) &amp;#123;
        add(t[p].mx + 1, t[p].cnt);
        add(v + 1, -t[p].cnt);
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
void upd(int p, int x, int v) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        add(t[p].mx + 1, 1), add(v + 1, -1);
        t[p].mx = v;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, x, v);
    else
        upd(rt, x, v);
    pushup(p);
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    bld(1, 1, n);
    for (int op; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            int x, v;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; v;
            if (x != 1)
                add(1, 1, x - 1, x - 1);
            upd(1, x, v);
            // for (int i = 1; i &amp;lt;= n; ++i)
            //     std::cout &amp;lt;&amp;lt; ask(i) - ask(i - 1) &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
            // std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
        else &amp;#123;
            int l, r;
            std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
            std::cout &amp;lt;&amp;lt; ask(r) - ask(l - 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---luotianyi-and-the-function&#34;&gt;E - LuoTianyi and the Function&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1824/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1824/D&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å’Œå‡½æ•°å…³è”æ›´å¼ºï¼Œè€ƒè™‘æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; è¿™ä¸€ç»´æ‰«æçº¿ + å·®åˆ†æ‰&lt;/li&gt;
&lt;li&gt;ç»å…¸å¥—è·¯ï¼Œç»´æŠ¤æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä»å³å‘å·¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(pos_x\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ç§»åŠ¨ä¸€ä¸‹ï¼Œä¼šæ›´æ–°ä¸€æ®µåŒºé—´ï¼ˆå¯èƒ½ä¸å­˜åœ¨ï¼‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; å€¼ï¼Œå®ƒä»¬åŸæœ¬ä¸º &lt;span class=&#34;math inline&#34;&gt;\(pos_{a_j}\)&lt;/span&gt;ï¼Œéœ€è¦è¢«æ›´æ–°ä¸ºä¸‹ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(pos\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;è®°å½•å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(pos_x\)&lt;/span&gt; çš„åŒºé—´ï¼ŒåšåŒºé—´èµ‹å€¼å†å²å’Œå³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
struct &amp;#123;
    int l, r;
    long long d1, d2, d3, u, s;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void pushup(int p) &amp;#123;
    t[p].u = t[lt].u + t[rt].u;
    t[p].s = t[lt].s + t[rt].s;
    return;
&amp;#125;
void pushval(int p, long long d1, long long d2, long long d3) &amp;#123;
    t[p].s += t[p].u * d2 + d3 * (t[p].r - t[p].l + 1);
    t[p].d3 += d3;
    if (t[p].d1)
        t[p].d3 += t[p].d1 * d2;
    else
        t[p].d2 += d2;
    if (d1) &amp;#123;
        t[p].u = d1 * (t[p].r - t[p].l + 1);
        t[p].d1 = d1;
    &amp;#125;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d1, t[p].d2, t[p].d3);
    pushval(rt, t[p].d1, t[p].d2, t[p].d3);
    t[p].d1 = t[p].d2 = t[p].d3 = 0ll;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    if (l == r)
        return;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void upd(int p, int l, int r, long long v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, v, 0ll, 0ll);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        upd(lt, l, r, v);
    if (r &amp;gt; mid)
        upd(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
long long ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].s;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    auto res = 0ll;
    if (l &amp;lt;= mid)
        res = ask(lt, l, r);
    if (r &amp;gt; mid)
        res += ask(rt, l, r);
    return res;
&amp;#125;
signed main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, q;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q;
    std::vector&amp;lt;int&amp;gt; a(n + 1), la(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    struct query &amp;#123; int l, r, id, k; &amp;#125;;
    std::vector&amp;lt;long long&amp;gt; res(q + 1);
    std::vector&amp;lt;std::vector&amp;lt;query&amp;gt; &amp;gt; u(n + 1);
    for (int i = 1, l, r, x, y; i &amp;lt;= q; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        if (x != 1)
            u[x - 1].push_back(&amp;#123; l, r, i, -1 &amp;#125;);
        u[y].push_back(&amp;#123; l, r, i, 1 &amp;#125;);
    &amp;#125;
    bld(1, 1, n);
    std::vector&amp;lt;int&amp;gt; pre(n + 2), nex(n + 2), l(n + 2);
    pre[n + 1] = 0, nex[0] = n + 1;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int p = la[a[i]];
        nex[pre[n + 1]] = i, pre[i] = pre[n + 1], pre[n + 1] = i, nex[i] = n + 1;
        l[i] = i;
        if (p != 0) &amp;#123;
            upd(1, l[p], p, nex[p]);
            l[nex[p]] = l[p];
            pre[nex[p]] = pre[p], nex[pre[p]] = nex[p];
        &amp;#125;
        upd(1, i, i, i);
        pushval(1, 0, 1, 0);
        for (auto [l, r, id, k] : u[i])
            res[id] += k * ask(1, l, r);
        la[a[i]] = i;
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---yunlis-subarray-queries-extreme-version&#34;&gt;F - Yunliâ€™s Subarray Queries (extreme version)&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/2009/G3&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/2009/G3&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(\forall i\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a_i\gets a_i-i\)&lt;/span&gt;ï¼Œé‚£ä¹ˆèƒ½å¤Ÿå‚ä¸åŒä¸€ä¸ªè¿ç»­å­æ®µçš„å…ƒç´ å€¼åº”ç›¸åŒ&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ˜¾ç„¶å¯¹äºä»»æ„ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å­æ®µï¼Œå…¶ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å‡å»ä¼—æ•°å‡ºç°æ¬¡æ•°ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; å¤„ç­”æ¡ˆè®°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(g_r\)&lt;/span&gt;ï¼‰&lt;/p&gt;
è¿™ä¸€ç‚¹å¯ä»¥ç”¨ç±»ä¼¼è«é˜Ÿçš„æ–¹æ³•æ¥åš&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é‚£ä¹ˆå¯¹äºæ›´é•¿çš„å­æ®µ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt;ï¼Œå…¶ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\min\limits_{l+k-1\le i\le r}\{g_i\}\)&lt;/span&gt;&lt;/p&gt;
åŸé—®é¢˜ä¸­çš„ä¸€æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; çš„è¯¢é—®å°±å¯ä»¥è½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=l+k-1}^r\sum\limits_{j=i}^r\min\{ g_{i\sim j}\}\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿™é‡Œæœ‰ä¸€ä¸ª trickï¼šæ‰«æçº¿æ—¶å¯ä»¥ç”¨å•è°ƒæ ˆçš„æƒ³æ³•æ¥ç»´æŠ¤æœ€å°å€¼æ“ä½œï¼Œé‚£ä¹ˆå°±æŠŠæœ€å€¼æ“ä½œè½¬åŒ–ä¸ºä¸€èˆ¬çš„åŒºé—´åŠ å†å²å’Œäº†ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
struct &amp;#123;
    int l, r;
    long long d1, d2, d3, u, s;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void pushup(int p) &amp;#123;
    t[p].u = t[lt].u + t[rt].u;
    t[p].s = t[lt].s + t[rt].s;
    return;
&amp;#125;
void pushval(int p, long long d1, long long d2, long long d3) &amp;#123;
    t[p].s += t[p].u * d2 + d3 * (t[p].r - t[p].l + 1);
    t[p].d3 += d3 + t[p].d1 * d2;
    t[p].d2 += d2;
    t[p].u += d1 * (t[p].r - t[p].l + 1);
    t[p].d1 += d1;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d1, t[p].d2, t[p].d3);
    pushval(rt, t[p].d1, t[p].d2, t[p].d3);
    t[p].d1 = t[p].d2 = t[p].d3 = 0ll;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    t[p].u = t[p].s = 0ll;
    t[p].d1 = t[p].d2 = t[p].d3 = 0;
    if (l == r)
        return;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void add(int p, int l, int r, long long v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, v, 0ll, 0ll);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
long long ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].s;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    auto res = 0ll;
    if (l &amp;lt;= mid)
        res = ask(lt, l, r);
    if (r &amp;gt; mid)
        res += ask(rt, l, r);
    return res;
&amp;#125;
signed main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, k, q;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k &amp;gt;&amp;gt; q;
        std::vector&amp;lt;int&amp;gt; a(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; a[i], a[i] -= i;
        bld(1, 1, n);
        std::vector&amp;lt;int&amp;gt; g(n + 1);
        std::unordered_map&amp;lt;int, int&amp;gt; cnt;
        std::multiset&amp;lt;int&amp;gt; t;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            if (i &amp;gt; k) &amp;#123;
                t.erase(t.find(cnt[a[i - k]]));
                if (--cnt[a[i - k]])
                    t.insert(cnt[a[i - k]]);
            &amp;#125;
            if (cnt[a[i]])
                t.erase(t.find(cnt[a[i]]));
            t.insert(++cnt[a[i]]);
            if (i &amp;gt;= k)
                g[i] = k - *--t.end();
        &amp;#125;
        std::vector&amp;lt;long long&amp;gt; res(q + 1);
        std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; u(n + 1);
        for (int i = 1, l, r; i &amp;lt;= q; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
            u[r].emplace_back(l + k - 1, i);
        &amp;#125;
        std::stack&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; st;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            std::pair&amp;lt;int, int&amp;gt; now(g[i], i);
            add(1, i, i, g[i]);
            for (; !st.empty() &amp;amp;&amp;amp; st.top() &amp;gt; now; st.pop()) &amp;#123;
                auto [v, p] = st.top();
                add(1, p, now.second - 1, g[i] - v);
                now.second = p;
            &amp;#125;
            st.push(now);
            pushval(1, 0ll, 1ll, 0ll);
            for (auto [l, id] : u[i])
                res[id] = ask(1, l, i);
        &amp;#125;
        for (int i = 1; i &amp;lt;= q; ++i)
            std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <updated>2025-09-11T09:27:05.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250909/</id>
        <title>å‰å¸æœºçº¿æ®µæ ‘</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250909/"/>
        <content type="html">&lt;p&gt;åŠ¿èƒ½ï¼Œä½†ä»…é™äºåŠ¿èƒ½å—ï¼Ÿ&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;p&gt;éœ€è¦çŸ¥é“çº¿æ®µæ ‘å¹¶éä¸‡èƒ½ï¼Œå¾ˆå¤šçœ‹èµ·æ¥å…¼å®¹çš„æ“ä½œå…¶å®æ˜¯ä¸å…¼å®¹çš„ã€‚ä¸¾ä¾‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;åŒºé—´å– min, maxã€åŒºé—´æŸ¥è¯¢ min, max&lt;/p&gt;
&lt;p&gt;å‘ç°åœ¨æ¶‰åŠæœ€å€¼æ“ä½œçš„æ—¶å€™ï¼ŒæŠŠåŒºé—´å…ƒç´ å€¼çœ‹ä½œåˆ†æ®µå‡½æ•°å’Œå–æœ€å€¼çš„æ€§è´¨æ˜¯æ¯”è¾ƒè´´çš„ã€‚&lt;/p&gt;
é‚£ä¹ˆç›¸å½“äºæŠŠæ‰€æœ‰å¤§äº / å°äº &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„éƒ¨åˆ†æ¨å¹³ã€‚æŸ¥è¯¢æ˜¯å¥½åšçš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åŒºé—´åŠ ã€åŒºé—´æŸ¥è¯¢ min, max&lt;/p&gt;
ç›¸å½“äºç«–ç›´æ–¹å‘å¹³ç§»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åŒºé—´åŠ ç­‰å·®æ•°åˆ—ã€åŒºé—´æŸ¥è¯¢ min, max&lt;/p&gt;
å‘ç°æ˜¯å’Œå¦ä¸€ä¸ªå›ºå®šçš„ä¸€æ¬¡å‡½æ•°åšçº¿æ€§åŠ ï¼›å‘ç°æ˜¯ä¸å¯åšçš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åŒºé—´å– minã€åŒºé—´æ±‚å’Œ&lt;/p&gt;
&lt;p&gt;ä¹Ÿå³æŠŠæ‰€æœ‰å¤§äº / å°äº &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„éƒ¨åˆ†æ¨å¹³ï¼Œè¿˜è¦æ±‚ç‚¹å€¼ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;çœ‹èµ·æ¥ä¸å¯åšï¼Œå› ä¸ºæ±‚å’Œæ²¡åŠæ³•ç”¨è¿™æ ·çš„è¯­è¨€ä½“ç³»ç®€å•é˜é‡Šï¼Œåªèƒ½è€ƒè™‘è„±ç¦»è¿™ä¸ªè¯­è¨€ä½“ç³»ï¼ŒçœŸçš„å»æ‰¾åˆ°è¿™æ ·çš„å‡¸èµ·ã€‚è¿™æ ·çœ‹èµ·æ¥æ˜¯ç‰¹åˆ«æ…¢çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä½†å®é™…ä¸Šæœ€åä¸€æ¡æ˜¯å¯åšçš„ï¼Œå‰å¦‚ä¸€å‘æ˜äº†ä¸€ç§ç‰¹å®šçš„æ–¹æ³•ï¼Œå¹¶è¯æ˜äº†åœ¨ä»…æœ‰åŒºé—´å– min / max + åŒºé—´æ±‚å’Œæ“ä½œæ—¶ï¼Œå¤æ‚åº¦æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(q\log n)\)&lt;/span&gt; çš„ï¼›å¦‚æœå†å¢åŠ å…¶ä»–ä»»ä½•åŒºé—´æ“ä½œï¼Œå¤æ‚åº¦æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(q\log^2 n)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;åŒºé—´å–-min-åŒºé—´æ±‚å’Œ&#34;&gt;åŒºé—´å– min / åŒºé—´æ±‚å’Œ&lt;/h2&gt;
&lt;p&gt;ä¾‹ï¼š&lt;a href=&#34;https://acm.hdu.edu.cn/showproblem.php?pid=5306&#34;&gt;Gorgeous Sequence&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®°å½•æœ€å¤§å€¼ &lt;span class=&#34;math inline&#34;&gt;\(mx\)&lt;/span&gt;ã€æ¬¡å¤§å€¼ &lt;span class=&#34;math inline&#34;&gt;\(se\)&lt;/span&gt;ã€æœ€å¤§å€¼å‡ºç°æ¬¡æ•° &lt;span class=&#34;math inline&#34;&gt;\(cnt\)&lt;/span&gt;ã€‚å½“ &lt;span class=&#34;math inline&#34;&gt;\(v\in(se,mx)\)&lt;/span&gt; æ—¶ï¼Œå‘ç°åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(mx\)&lt;/span&gt; éœ€è¦è¢«æ›´æ–°ã€‚æ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(s\gets s-(mx-v)\cdot cnt\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(se\)&lt;/span&gt; ä¹Ÿéœ€è¦è¢«æ›´æ–°ï¼Œæš´åŠ›é€’å½’ç›´åˆ°æ»¡è¶³ä¸Šä¸€æ¡ååœæ­¢ã€‚å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(q\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
const int inf = 0x3f3f3f3f;
struct &amp;#123;
    long long s;
    int l, r, mx, se, d, cnt;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
int a[maxn];
void pushup(int p) &amp;#123;
    if (t[lt].mx == t[rt].mx) &amp;#123;
        t[p].mx = t[lt].mx, t[p].cnt = t[lt].cnt + t[rt].cnt;
        t[p].se = std::max(t[lt].se, t[rt].se);
    &amp;#125;
    else if (t[lt].mx &amp;gt; t[rt].mx) &amp;#123;
        t[p].mx = t[lt].mx, t[p].cnt = t[lt].cnt;
        t[p].se = std::max(t[lt].se, t[rt].mx);
    &amp;#125;
    else &amp;#123;
        t[p].mx = t[rt].mx, t[p].cnt = t[rt].cnt;
        t[p].se = std::max(t[lt].mx, t[rt].se);
    &amp;#125;
    t[p].s = t[lt].s + t[rt].s;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].d = inf;
    t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        t[p].s = t[p].mx = a[l], t[p].cnt = 1, t[p].se = 0;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    pushup(p);
    return;
&amp;#125;
void pushval(int p, int v) &amp;#123;
    if (v &amp;lt;= t[p].mx) &amp;#123;
        t[p].s -= (long long)(t[p].mx - v) * t[p].cnt;
        t[p].mx = t[p].d = v;
    &amp;#125;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d != inf) &amp;#123;
        pushval(lt, t[p].d), pushval(rt, t[p].d);
        t[p].d = inf;
    &amp;#125;
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (t[p].mx &amp;lt;= v)
        return;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r &amp;amp;&amp;amp; v &amp;gt; t[p].se) &amp;#123;
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
int askmx(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].mx;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1, res = 0;
    if (l &amp;lt;= mid)
        res = askmx(lt, l, r);
    if (r &amp;gt; mid)
        res = std::max(res, askmx(rt, l, r));
    return res;
&amp;#125;
long long asks(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].s;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    auto res = 0ll;
    if (l &amp;lt;= mid)
        res = asks(lt, l, r);
    if (r &amp;gt; mid)
        res += asks(rt, l, r);
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, m;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; a[i];
        bld(1, 1, n);
        for (int op, l, r; m--; ) &amp;#123;
            std::cin &amp;gt;&amp;gt; op &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
            if (op == 0) &amp;#123;
                int v;
                std::cin &amp;gt;&amp;gt; v;
                add(1, l, r, v);
            &amp;#125;
            else if (op == 1)
                std::cout &amp;lt;&amp;lt; askmx(1, l, r) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            else
                std::cout &amp;lt;&amp;lt; asks(1, l, r) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;åŒºé—´å–-minåŒºé—´æ“ä½œåŒºé—´æ±‚å’Œ&#34;&gt;åŒºé—´å– minã€åŒºé—´æ“ä½œã€åŒºé—´æ±‚å’Œ&lt;/h2&gt;
&lt;p&gt;ä¾‹ï¼š&lt;a href=&#34;https://loj.ac/p/6565&#34;&gt;æœ€å‡å¥³é€‰æ‰‹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥ç”¨ç›¸ä¼¼çš„æ–¹æ³•æ¥ç»´æŠ¤ï¼›&lt;/p&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <updated>2025-09-09T14:24:31.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250907/</id>
        <title>è¿‘æœŸæ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250907/"/>
        <content type="html">&lt;p&gt;çªå›´&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---colinear&#34;&gt;E - Colinear&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc422/tasks/abc422_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc422/tasks/abc422_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;çœ‹åˆ°é¢˜ç›®ä¼šæœ‰ä¸€ä¸ªä¹±æçš„æƒ³æ³•ï¼šéšæœºå–ä¸€å¯¹ç‚¹ï¼Œé‚£ä¹ˆæ˜¯æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac 14\)&lt;/span&gt; çš„æ¦‚ç‡éƒ½åœ¨ç›´çº¿ä¸Šçš„ã€‚å¸¦è¿›å»æš´åŠ› check ä¸€ä¸‹ï¼Œå¤šæ¥å‡ æ¬¡æ­£ç¡®ç‡å°±æ¯”è¾ƒé«˜ã€‚&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆï¼Œè¿™æ˜¯æ­£è§£ï¼Ÿabc çš„é£æ ¼çœŸæ˜¯è¶Šæ¥è¶Šå¥‡æ€ªäº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---eat-and-ride&#34;&gt;F - Eat and Ride&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc422/tasks/abc422_f&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc422/tasks/abc422_f&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€ä¸ªè´¹ç”¨æå‰è®¡ç®—çš„åˆ†å±‚å›¾ï¼Œå°±å¯ä»¥è·‘ Dij äº†ã€‚&lt;/p&gt;
&lt;p&gt;å®˜è§£ç»™å‡ºäº†ä¸€ä¸ªä¼˜åŒ–ï¼š&lt;strong&gt;æœç´¢å®é™…ä¸Šæ˜¯åœ¨ç»™è¾¹å®šå‘ï¼›è¿™æ ·å›¾å°±è½¬åŒ–ä¸º DAG&lt;/strong&gt;ï¼ˆå®é™…ä¸Šåå‘è¾¹å¹¶ä¸ä¼šäº§ç”Ÿæœ‰æ•ˆæ›´æ–°ï¼Œæ•…ç›´æ¥æœ´ç´ è½¬ç§»å³å¯ï¼‰ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---triangle-toggle&#34;&gt;B - Triangle Toggle&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc205/tasks/arc205_b&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc205/tasks/arc205_b&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç°åœºæ˜¯æ‰“è¡¨æ‰¾è§„å¾‹åšå‡ºæ¥çš„ ğŸ˜…&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™æ ·ä¸€æ¬¡æ“ä½œä¹‹åæ¯ä¸ªç‚¹ä¸Šé»‘è¾¹çš„å¥‡å¶æ€§æ˜¯ä¸ä¼šå˜çš„ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€ä¸ªä¸Šç•Œï¼Œéš¾ç‚¹åœ¨äºæ˜¯å¦å¯ä»¥è¾¾åˆ°è¿™ä¸ªä¸Šç•Œã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°åªè¦å­˜åœ¨ä¸€ä¸ªç‚¹ä¸Šè¿æœ‰ä¸¤æ¡ç™½è¾¹ï¼Œå°±å¯ä»¥æŠŠ 001 åè½¬ä¸º 110ï¼Œä¸€æ¬¡æ“ä½œè‡³å°‘å¯ä»¥æ–°å¢ä¸€æ¡é»‘è¾¹ã€‚æ•…æ˜¯å¯ä»¥è¾¾åˆ°çš„ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---non-ancestor-matching&#34;&gt;D - Non-Ancestor Matching&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc205/tasks/arc205_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc205/tasks/arc205_d&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ²¡å•¥å¥½è¯´çš„æ‘©å°”æŠ•ç¥¨ï¼Œæœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„ä¼˜å…ˆé˜Ÿåˆ—åšæ³•&lt;/p&gt;
&lt;p&gt;ä½† Rosmist æ‰“äº†å¦ä¸€ä¸ªçœ‹èµ·æ¥æœ‰ç‚¹ç„å­¦çš„ä¸œè¥¿ï¼šå¯ä»¥æ„Ÿå—åˆ°æ¯æ¬¡åªå‘æœ€å¤§çš„å­æ ‘é€’å½’æ˜¯åˆç†çš„ï¼Œå°è¯•è¯æ˜ä¸€ä¸‹å‘ç°ç¡®å®æ¯”è¾ƒæ˜¾ç„¶&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---subset-product-problem&#34;&gt;E - Subset Product Problem&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/AT_arc205_e&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/AT_arc205_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¥‡æ€ªé¢˜ç›®&lt;/p&gt;
&lt;p&gt;é«˜ç»´å‰ç¼€å’Œ + åˆ†å—å…¶å®ä¸ç®—ç‰¹åˆ«ç½•è§çš„ trick&lt;/p&gt;
&lt;p&gt;ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºå‰ &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; ä½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå &lt;span class=&#34;math inline&#34;&gt;\(10\)&lt;/span&gt; ä½çš„é«˜ç»´å‰ç¼€å’Œ&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡æŸ¥è¯¢ / æ›´æ–°éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(2^{10})\)&lt;/span&gt; çš„ï¼Œå¯ä»¥æ¥å—ï¼ˆå—ï¼‰&lt;/p&gt;
&lt;p&gt;ç„¶åè¿˜æœ‰ä¸€ä¸ªç§‘ç ”æ€§çš„åšæ³• è§ &lt;a href=&#34;https://www.luogu.com.cn/article/1uyz0hn2&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/article/1uyz0hn2&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-by-the-assignment&#34;&gt;C. By the Assignment&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/2135/problem/C&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/2135/problem/C&lt;/a&gt;&lt;/p&gt;
</content>
        <updated>2025-09-07T08:13:09.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250906/</id>
        <title>å­¦ä¹ ç¬”è®°ï¼šå‹ä½é«˜ç²¾</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250906/"/>
        <content type="html">&lt;p&gt;æŠŠ ddxrS å“åˆ°äº†ï¼Œå‘å‡ºæƒŠä¸–ç–‘é—®ï¼šã€ä¸ºä»€ä¹ˆé«˜äºŒæœºæˆ¿æ­£åœ¨æ¿€çƒˆåœ°è®¨è®ºæ€ä¹ˆå†™é«˜ç²¾åº¦ï¼Ÿã€&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;p&gt;è€ƒè™‘ 10-base é«˜ç²¾åº¦ï¼Œå•æ¬¡è¿ç®—å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(\log_{10}V)\)&lt;/span&gt;ã€‚ä½¿ç”¨ 10-base çš„ä¸»è¦åŸå› æ˜¯ &lt;code&gt;std::to_string&lt;/code&gt; å¾ˆæ–¹ä¾¿ã€è¾“å‡ºä¹Ÿå¾ˆç®€å•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ•ˆç‡å¤ªä½ã€‚å®é™…ä¸Šï¼Œä¸€èˆ¬æ‰“é«˜ç²¾åº¦éƒ½æ˜¯ 1e4-baseï¼Œæˆ–æ›´æ¿€è¿›åœ°ï¼Œ1e9-baseã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„é«˜ç²¾ä¹˜ä½ç²¾æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(len)\)&lt;/span&gt; è€Œé &lt;span class=&#34;math inline&#34;&gt;\(O(len^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦è€ƒè™‘è¾“å‡ºã€‚ç”±äºç”¨çš„æ˜¯ 10-power ä½œä¸º baseï¼Œæ‰€ä»¥åªéœ€è¦æŠŠæ¯å››ä½ç›´æ¥è¾“å‡ºå³å¯ã€‚æ³¨æ„é™¤é¦–ä½å¤–éœ€è¦è¡¥å‰å¯¼ 0 ç›´åˆ°å››ä½ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;struct BI &amp;#123;
    std::vector&amp;lt;int&amp;gt; s;
    BI() &amp;#123;&amp;#125;
    BI(int x) &amp;#123;
        for (; x; s.push_back(x % 10000), x /= 10000);
        return;
    &amp;#125;
    BI&amp;amp; operator= (int q) &amp;#123;
        return *this = (BI)q;
    &amp;#125;
    bool operator&amp;gt; (const BI &amp;amp;q) &amp;#123;
        if (s.size() != q.s.size())
            return s.size() &amp;gt; q.s.size();
        for (int i = (int)s.size() - 1; ~i; --i)
            if (s[i] != q.s[i])
                return s[i] &amp;gt; q.s[i];
        return 0;
    &amp;#125;
    BI operator* (int q) const &amp;#123;
        int lx = s.size();
        std::vector&amp;lt;long long&amp;gt; res(lx + 3);
        for (int i = 0; i &amp;lt; lx; ++i)
            res[i] = (long long)s[i] * q;
        BI p;
        for (int j = 0; j &amp;lt; lx + 2; ++j)
            res[j + 1] += res[j] / 10000, res[j] %= 10000;
        int len = lx + 2;
        for (; ~len &amp;amp;&amp;amp; !res[len]; --len);
        for (int j = 0; j &amp;lt;= len; ++j)
            p.s.push_back(res[j]);
        return p;
    &amp;#125;
    void out(void) &amp;#123;
        for (int i = (int)s.size() - 1; ~i; --i) &amp;#123;
            auto p = std::to_string(s[i]);
            if (i != (int)s.size() - 1)
                for (; (int)p.size() &amp;lt; 4; p = &amp;quot;0&amp;quot; + p);
            std::cout &amp;lt;&amp;lt; p;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return;
    &amp;#125;
&amp;#125;;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="é«˜ç²¾åº¦" />
        <updated>2025-09-06T07:02:56.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250824/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250824/"/>
        <content type="html">&lt;p&gt;ä¸ä¼šçš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šäº†&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-k-set-tree&#34;&gt;B. K-Set Tree&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1691F&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1691F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(F_i\)&lt;/span&gt; è¡¨ç¤ºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºæ ¹æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å­æ ‘å†…çš„ç­”æ¡ˆã€‚åˆ™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
F_u=\left(C_{siz_u}^k-\sum C_{siz_v}^k\right)\cdot siz_u+\sum F_v\\
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç›´æ¥æ¢æ ¹æ˜¯å¾ˆå¤æ‚çš„ï¼›æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\sum C_{siz_v}^k\)&lt;/span&gt; è®°ä½œ &lt;span class=&#34;math inline&#34;&gt;\(dp_u\)&lt;/span&gt;ï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\sum F_v\)&lt;/span&gt; è®°ä½œ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt;ï¼Œé‚£ä¹ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
res=\sum(C_n^k-dp_u)\cdot n+f_u\\
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™æ ·åšæ˜¯ä¸ºäº†æŠŠä¸¤ä¸ªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æœ‰å…³çš„ä¹˜é¡¹æ‹†å¼€æ¥æ¢æ ¹&lt;/strong&gt;ï¼Œå®é™…æ¢æ ¹çš„æ—¶å€™å°±åªç”¨åˆ†åˆ«æ¢ &lt;span class=&#34;math inline&#34;&gt;\(f,dp\)&lt;/span&gt; ä¸¤ä¸ªå€¼ï¼Œä¸ç”¨è€ƒè™‘äºŒæ¬¡é¡¹ç­‰é—®é¢˜ï¼Œè®¡ç®—é‡ä¼šå°‘å¾ˆå¤š&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        if (m &amp;gt; n)
            return 0ll;
        return fac[n] * inv[m] % mod * inv[n - m] % mod;
    &amp;#125;;
    auto res(0ll);
    std::vector&amp;lt;int&amp;gt; siz(n + 1), ss(n + 1);
    std::vector&amp;lt;long long&amp;gt; f(n + 1), dp(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        siz[x] = 1;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                (f[x] += (C(siz[i], k) - dp[i]) * siz[i] + f[i]) %= mod;
                (dp[x] += C(siz[i], k)) %= mod;
                siz[x] += siz[i];
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        (res += (C(n, k) - dp[x]) * n + f[x]) %= mod;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                (f[i] += (C(n - siz[i], k) - (dp[x] - C(siz[i], k))) * (n - siz[i]) + f[x] - f[i] - (C(siz[i], k) - dp[i]) * siz[i]) %= mod;
                (dp[i] += C(n - siz[i], k)) %= mod;
                DFS(i, x);
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; (res + mod) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-li-hua-and-path&#34;&gt;C. Li Hua and Path&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1797F&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1797F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘&lt;strong&gt;å®¹æ–¥&lt;/strong&gt;ï¼Œåˆ†åˆ«æ±‚è§£æ»¡è¶³ 1ã€æ»¡è¶³ 2ã€æ»¡è¶³ 12ï¼ˆæ³¨æ„è¦å‡ä¸¤å€ï¼‰å°±èƒ½è®¡ç®—ç­”æ¡ˆ&lt;/p&gt;
&lt;p&gt;å‘ç°é¢˜ç›®æ‰€æ±‚ç‚¹å¯¹å½¢å¼å¾ˆç¬¦åˆ Kruskal é‡æ„æ ‘çš„è¦æ±‚ï¼Œè€ƒè™‘ä»¥å¯¹åº”ç‚¹æƒä¸ºè¾¹æƒï¼Œåˆ†åˆ«å»ºç«‹ minï¼Œmax Kruskal ç‚¹æƒå¤šå‰é‡æ„æ ‘ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;ç‚¹æƒå¤šå‰é‡æ„æ ‘ï¼Ÿ&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ç‚¹æƒä¸Šåš Kruskal é‡æ„æ ‘æ—¶ï¼Œå‘ç°è¾¹çš„è™šç‚¹æ˜¯ä¸å¿…è¦çš„ï¼Œå¯ä»¥ç›´æ¥å°†æ›´ä¼˜ç‚¹ä½œä¸ºçˆ¶äº²ã€‚&lt;/p&gt;
&lt;p&gt;å†™çš„æ—¶å€™æœ‰ç‚¹éš¾æƒ³æ¸…æ¥šâ€¦â€¦ å¯ä»¥ç”»ç”»å›¾ï¼Œä»”ç»†ç¡®å®šä¸€ä¸‹ Kruskal é‡æ„æ ‘çš„å…·ä½“æ€§è´¨&lt;/p&gt;
&lt;p&gt;è¿™æ ·åšçš„ä¼˜åŠ¿æ˜¯æ²¡æœ‰è™šç‚¹ï¼Œä¸€äº›é—®é¢˜ä¼šæ–¹ä¾¿ä¸€äº›ï¼›ä½†åŒæ—¶æ”¾å¼ƒäº†äºŒå‰æ ‘çš„ç»“æ„ï¼Œä¸€äº›é¢˜å¯èƒ½æ²¡é‚£ä¹ˆå¥½åšã€‚&lt;/p&gt;
&lt;p&gt;è¿™é“é¢˜åªç”¨ç»å…¸ Kruskal é‡æ„æ ‘ä¹Ÿå¯ä»¥è§£å†³ã€‚&lt;/p&gt;
&lt;/details&gt;
&lt;p&gt;å‘ç° 1 2 å‡å¯ä»¥è½¬åŒ–æˆä¸¤æ£µæ ‘åœ¨ä¸¤æ£µæ ‘ä¸Šçš„ç¥–å­™å…³ç³»è¦æ±‚ï¼Œå¯ä»¥è½»æ¾åœ°åˆ†åˆ«ç»Ÿè®¡æ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„ç‚¹å¯¹æ•°é‡&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ€ä¹ˆå¤„ç†åŒæ—¶æ»¡è¶³ 12 çš„ï¼Œå‘ç°è¦æ±‚åœ¨ä¸¤æ£µæ ‘ä¸ŠäºŒè€…åº”è¯¥éƒ½å…·æœ‰ç¥–å­™å…³ç³»ï¼Œä¸”æ˜¯ç›¸åçš„ã€‚&lt;del&gt;å¯ä»¥è€ƒè™‘åœ¨ä¸€æ£µæ ‘ä¸Š DFS çš„åŒæ—¶ç”¨ä¸»å¸­æ ‘å­˜å‚¨ç¥–å…ˆï¼Œåœ¨å¦ä¸€é¢—æ ‘ä¸Š ask&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä»æ›´å®¹æ˜“ç”¨ dfn è¡¨ç¤ºçš„å­æ ‘é—®é¢˜æ€è€ƒï¼Œåœ¨ min æ ‘ä¸Šåˆ†é… dfn åï¼Œåœ¨ max æ ‘ä¸Šç”¨ DFS + å›æº¯å¾—åˆ°æ¯ä¸ªç‚¹å®æ—¶ç¥–å…ˆåºåˆ—ï¼Œå­˜åœ¨æ ‘çŠ¶æ•°ç»„é‡Œï¼›ask è¯¥ç‚¹è¢«åˆ†é…çš„ dfn å­æ ‘åŒºé—´å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘è¯¢é—®ï¼Œç”±äºæ¯æ¬¡åŠ å…¥çš„éƒ½æ˜¯ç¼–å·æœ€å¤§çš„ç‚¹ï¼Œå¯¹äºæ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„è´¡çŒ®æ˜¯æ˜¾ç„¶çš„ï¼Œè€ŒåŒæ—¶æ»¡è¶³ 12 çš„ç‚¹å°±æ˜¯åœ¨ min æ ‘ä¸Šçš„ç¥–å…ˆï¼Œéƒ½æ˜¯å¥½åšçš„ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°çš„æ—¶å€™ä¸€å®šè¦æŠŠ min / max æ ‘å¯¹åº”çš„æ€§è´¨æ€è€ƒæ¸…æ¥šï¼Œä¸ç„¶ä¼šå¾ˆéº»çƒ¦&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; f1(n + 1), f2(n + 1);
    std::iota(f1.begin() + 1, f1.end(), 1);
    std::iota(f2.begin() + 1, f2.end(), 1);
    std::function&amp;lt;int(int)&amp;gt; find1 = [&amp;amp;](int x) &amp;#123;
        return x == f1[x] ? x : f1[x] = find1(f1[x]);
    &amp;#125;;
    std::function&amp;lt;int(int)&amp;gt; find2 = [&amp;amp;](int x) &amp;#123;
        return x == f2[x] ? x : f2[x] = find2(f2[x]);
    &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1), g2(n + 1), adj1(n + 1), adj2(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        if (x &amp;gt; y)
            std::swap(x, y);
        adj1[y].push_back(x);
        adj2[x].push_back(y);
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (auto j : adj1[i]) &amp;#123;
            int fi = find1(i), fj = find1(j);
            g1[fi].push_back(fj), f1[fj] = fi;
        &amp;#125;
    for (int i = n; i; --i)
        for (auto j : adj2[i]) &amp;#123;
            int fi = find2(i), fj = find2(j);
            g2[fi].push_back(fj), f2[fj] = fi;
        &amp;#125;
    std::vector&amp;lt;int&amp;gt; bit(n + 1), dfn(n + 1), rfn(n + 1);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            bit[x] += v;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        int res = 0;
        for (; x; x -= lowbit(x))
            res += bit[x];
        return res;
    &amp;#125;;
    int rt1 = 0, rt2 = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (f1[i] == i)
            rt1 = i;
        if (f2[i] == i)
            rt2 = i;
    &amp;#125;
    int q;
    std::cin &amp;gt;&amp;gt; q;
    std::vector&amp;lt;int&amp;gt; dep1(n + 1), dep2(n + q + 1);
    long long res = 0ll;
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now;
        res += dep1[x];
        for (auto i : g1[x]) &amp;#123;
            dep1[i] = dep1[x] + 1;
            DFS(i);
        &amp;#125;
        rfn[x] = now;
        return;
    &amp;#125;;
    DFS(rt1);
    DFS = [&amp;amp;](int x) &amp;#123;
        res += dep2[x];
        res -= 2 * (ask(rfn[x]) - ask(dfn[x] - 1));
        add(dfn[x], 1);
        for (auto i : g2[x]) &amp;#123;
            dep2[i] = dep2[x] + 1;
            DFS(i);
        &amp;#125;
        add(dfn[x], -1);
        return;
    &amp;#125;;
    DFS(rt2);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    for (int fa; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; fa;
        dep2[++n] = dep2[fa] + 1;
        res += (n - 1) - dep2[n];
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-å›¢é˜Ÿé€‰æ‹”&#34;&gt;D. å›¢é˜Ÿé€‰æ‹”&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6534/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6534/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œä»ä¸­ä»»é€‰ä¸€äº›äº’ä¸ç›¸äº¤çš„åŒºé—´ï¼Œæ»¡è¶³æ¯ä¸ªåŒºé—´å†…å…ƒç´ çš„ gcd ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^5,V\le 10^7\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ³¨æ„åˆ°å›ºå®šä¸€ä¸ªå·¦ç«¯ç‚¹åï¼Œç§»åŠ¨å³ç«¯ç‚¹ï¼Œgcd æ¯æ¬¡è‡³å¤šå‡å°åˆ°åŸæ¥çš„ä¸€åŠï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ç§ç±»æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\log V\)&lt;/span&gt; ç§ã€‚æ•…å…¨åºåˆ—çš„ gcd æ€»æ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log V)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå®¹æ˜“æƒ³åˆ°ä¸æ­¤åŸç†ç±»ä¼¼çš„å…¨å±€ç­”æ¡ˆæ±‚æ³•ï¼šå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå‘å·¦å¤„ç†å‡ºæ¯ä¸€æ®µ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a_{l\cdots i})=\gcd(a_r\cdots i)\)&lt;/span&gt;ï¼Œå¹¶è®°å½•è¯¥ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt;ã€‚è¿™æ ·æ±‚å‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\((i,l,r)\)&lt;/span&gt; å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log V)\)&lt;/span&gt; æ®µã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ª gcd æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i}=f_{i-1}+\sum\limits_{j=l_i}^{r_i} f_{j - 1}\)&lt;/span&gt;ï¼Œå¯ä»¥åšä¸€ä¸ªæ‰«æçº¿ï¼Œå¾—åˆ°å…¨å±€ç­”æ¡ˆï¼›å‘å‰å‘ååˆ†åˆ«åšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(i-1,i+1\)&lt;/span&gt;ï¼Œç›¸ä¹˜å°±èƒ½å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœªè¢«é€‰å–æ—¶çš„ç­”æ¡ˆ&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ€ä¹ˆå®Œæˆã€ç›¸ä¹˜ã€è¿™ä¸ªåŠ¨ä½œï¼šæœ€åçš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; åœ¨æ¯ä¸ªå³ç«¯ç‚¹å¤„å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥è½¬åŒ–æˆè‹¥å¹²æ®µ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt;ï¼›åè¿‡æ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;\)&lt;/span&gt; äº¦å¯ä»¥è¿™æ ·è½¬åŒ–ã€‚å°† &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ•´ä½“åç§»ä¸€ä½ã€&lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;\)&lt;/span&gt; æ•´ä½“å‰ç§»ä¸€ä½ï¼Œå°±å¯ä»¥å¯¹é½ã€‚äºŒè€…çš„ç«¯ç‚¹æ€»æ•°æ˜¯å‡æ‘Šå• log çš„ï¼ŒåŒºé—´æ€»æ•°ä¹Ÿå°±æ˜¯å‡æ‘Šå• log çš„ï¼ˆå½’å¹¶å°±èƒ½å¿«é€Ÿå¯»æ‰¾åˆ°åŒºé—´ï¼‰ï¼Œç”¨å·®åˆ†åšä¸€ä¸ªåŒºé—´åŠ å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨äºŒåˆ†å‹‰å¼ºå• log è§£å†³äº†è½¬ç§»ï¼›è¿˜çœ‹åˆ° &lt;span class=&#34;citation&#34; data-cites=&#34;spdarkle&#34;&gt;@spdarkle&lt;/span&gt; ç–‘ä¼¼åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; ä¸Šç›´æ¥åšçš„&lt;a href=&#34;http://222.180.160.110:61235/submission/3108272&#34;&gt;åšæ³•&lt;/a&gt;ï¼Œå’Œ &lt;span class=&#34;citation&#34; data-cites=&#34;Rosmist&#34;&gt;@Rosmist&lt;/span&gt; ç–‘ä¼¼ç›´æ¥åœ¨æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸Šåšçš„&lt;a href=&#34;http://222.180.160.110:61235/submission/3108581&#34;&gt;åšæ³•&lt;/a&gt;ã€‚å®˜è§£æ˜¯ä¸ªçœ‹ä¸æ‡‚çš„åšæ³•&lt;/p&gt;
&lt;p&gt;å‘ƒï¼Œå¥½åƒä¸€ä¸å°å¿ƒæ‹¿äº†æœ€ä¼˜è§£ã€‚è€Œä¸”ä¼˜åŠ¿å¾ˆæ˜æ˜¾ï¼ˆæ€ä¹ˆæ€»ç”¨æ—¶æ¯”åˆ«äººä¸€ä¸ªç‚¹è¿˜å°‘ï¼Ÿï¼‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯èƒ½å› ä¸ºå¤§å®¶éƒ½çœ‹ä¸æ‡‚å®˜è§£ï¼Œåšæ³•æ¯”è¾ƒå¤šæ ·ï¼Ÿé™¤äº†æˆ‘ä¹‹å¤–æ¯”è¾ƒå¿«çš„ lwz å’Œ &lt;span class=&#34;citation&#34; data-cites=&#34;GoldSpade&#34;&gt;@GoldSpade&lt;/span&gt; éƒ½ç”¨å½’å¹¶å®Œæˆæœ€åä¸€æ­¥ï¼›æˆ‘è¾ƒä»–ä»¬çš„é¢å¤–ä¼˜åŠ¿å¤§æ¦‚æ˜¯ç”¨äºŒåˆ†æ¢æ‰äº†æ ‘çŠ¶æ•°ç»„ï¼Ÿè¿·æƒ‘&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;selection.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;selection.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;ex_selection2.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; st(20, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], st[0][i] = a[i];
    for (int j = 1; (1 &amp;lt;&amp;lt; j) &amp;lt;= n; ++j)
        for (int i = 1; i + (1 &amp;lt;&amp;lt; j) - 1 &amp;lt;= n; ++i)
            st[j][i] = std::__gcd(st[j - 1][i], st[j - 1][i + (1 &amp;lt;&amp;lt; (j - 1))]);
    auto askgcd = [&amp;amp;](int l, int r) &amp;#123;
        int k = std::__lg(r - l + 1);
        return std::__gcd(st[k][l], st[k][r - (1 &amp;lt;&amp;lt; k) + 1]);
    &amp;#125;;
    std::unordered_map&amp;lt;int, int&amp;gt; tab;
    struct node &amp;#123;
        int i, l, r;
        bool operator&amp;lt; (const int q) const &amp;#123;
            return i &amp;lt; q;
        &amp;#125;
        bool operator&amp;lt;= (const int q) const &amp;#123;
            return i &amp;lt;= q;
        &amp;#125;
    &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;node&amp;gt; &amp;gt; p1, p2;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (int to = i; to &amp;gt;= 1; ) &amp;#123;
            int at = i, g = askgcd(to, i);
            for (int l = 1, r = to, mid; l &amp;lt;= r; ) &amp;#123;
                mid = (l + r) &amp;gt;&amp;gt; 1;
                if (askgcd(mid, i) == g)
                    at = mid, r = mid - 1;
                else
                    l = mid + 1;
            &amp;#125;
            if (!tab.count(g)) &amp;#123;
                tab[g] = (int)p1.size();
                p1.emplace_back(), p2.emplace_back();
            &amp;#125;
            p1[tab[g]].push_back(&amp;#123; i, at, to &amp;#125;);
            to = at - 1;
        &amp;#125;
        for (int to = i; to &amp;lt;= n; ) &amp;#123;
            int at = i, g = askgcd(i, to);
            for (int l = to, r = n, mid; l &amp;lt;= r; ) &amp;#123;
                mid = (l + r) &amp;gt;&amp;gt; 1;
                if (askgcd(i, mid) == g)
                    at = mid, l = mid + 1;
                else
                    r = mid - 1;
            &amp;#125;
            if (!tab.count(g)) &amp;#123;
                tab[g] = (int)p2.size();
                p1.emplace_back(), p2.emplace_back();
            &amp;#125;
            p2[tab[g]].push_back(&amp;#123; i, to, at &amp;#125;);
            to = at + 1;
        &amp;#125;
    &amp;#125;
    auto s(0ll);
    std::vector&amp;lt;int&amp;gt; x1(n + 1), x2(n + 2), pos(2 * n + 3);
    std::vector&amp;lt;long long&amp;gt; f1(n + 1), f2(n + 2), s1(n + 1), s2(n + 2), diff(n + 1);
    for (auto [g, id] : tab) &amp;#123;
        // printf(&amp;quot;g = %d: \n&amp;quot;, g);
        int n1 = (int)p1[id].size();
        x1[0] = 0, f1[0] = s1[0] = 1ll;
        for (int i = 1; i &amp;lt;= n1; ++i) &amp;#123;
            auto [x, L, R] = p1[id][i - 1];
            --L, --R;
            x1[i] = x, f1[i] = f1[i - 1];
            int l = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, L) - x1.begin() - 1,
                r = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, R) - x1.begin() - 1;
            if (l == r)
                (f1[i] += f1[l] * (R - L + 1)) %= mod;
            else &amp;#123;
                f1[i] += s1[r - 1] + mod - s1[l];
                f1[i] += f1[r] * (R - x1[r] + 1);
                f1[i] += f1[l] * (x1[l + 1] - L);
                f1[i] %= mod;
            &amp;#125;
            // printf(&amp;quot;  r = %d, l = [%d, %d]: %lld\n&amp;quot;, x, L, R, f1[i]);
            if (i != n1)
                s1[i] = (s1[i - 1] + f1[i] * (p1[id][i].i - x)) % mod;
        &amp;#125;
        (s += f1[n1] - 1) %= mod;
        int n2 = (int)p2[id].size();
        x2[n2 + 1] = n + 1, f2[n2 + 1] = s2[n2 + 1] = 1ll;
        for (int i = n2; i; --i) &amp;#123;
            auto [x, L, R] = p2[id][i - 1];
            ++L, ++R;
            x2[i] = x, f2[i] = f2[i + 1];
            int l = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, L) - x2.begin(),
                r = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, R) - x2.begin();
            if (l == r)
                (f2[i] += f2[l] * (R - L + 1)) %= mod;
            else&amp;#123;
                f2[i] += s2[l + 1] + mod - s2[r];
                f2[i] += f2[r] * (R - x2[r - 1]);
                f2[i] += f2[l] * (x2[l] - L + 1);
                f2[i] %= mod;
            &amp;#125;
            // printf(&amp;quot;  l = %d, r = [%d, %d]: %lld\n&amp;quot;, x, L, R, f2[i]);
            if (i != 1)
                s2[i] = (s2[i + 1] + f2[i] * (x - p2[id][i - 2].i)) % mod;
        &amp;#125;
        for (int i = 0; i &amp;lt; n1; ++i)
            x1[i] = x1[i + 1];
        x1[n1] = n;
        int t = (x2[1] == 1) + 1;
        for (int i = 1; i &amp;lt;= n2 + 1; ++i)
            --x2[i];
        std::merge(x1.begin(), x1.begin() + n1 + 1, x2.begin() + t, x2.begin() + n2 + 2, pos.begin() + 1);
        int m = std::unique(pos.begin() + 1, pos.begin() + n1 + n2 + 4 - t) - pos.begin() - 1;
        for (int i = 1, p1 = 0, p2 = t, la = 0; i &amp;lt;= m; ++i) &amp;#123;
            for (; p1 + 1 &amp;lt;= n1 &amp;amp;&amp;amp; x1[p1] &amp;lt; pos[i]; ++p1);
            for (; p2 + 1 &amp;lt;= n2 + 1 &amp;amp;&amp;amp; x2[p2] &amp;lt; pos[i]; ++p2);
            (diff[la + 1] += f1[p1] * f2[p2] + mod - 1) %= mod;
            // printf(&amp;quot;  [%d, %d]: %lld, %lld\n&amp;quot;, la + 1, pos[i], f1[p1], f2[p2]);
            if (pos[i] + 1 &amp;lt;= n)
                (diff[pos[i] + 1] += mod - f1[p1] * f2[p2] + 1) %= mod;
            la = pos[i];
        &amp;#125;
    &amp;#125;
    // std::cout &amp;lt;&amp;lt; s &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        (diff[i] += diff[i - 1]) %= mod;
        std::cout &amp;lt;&amp;lt; (s + mod - diff[i]) % mod &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;æˆ‘ä¸€å¼€å§‹å°† &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å®šä¹‰ä¸ºå•ç‚¹ç­”æ¡ˆè€Œéå‰ç¼€å’Œï¼Œä¼šå¯¼è‡´éœ€è¦çº¿æ®µæ ‘ç»´æŠ¤ç­‰å·®åºåˆ—ï¼Œè¿˜ä¸¢å¤±äº†ç­”æ¡ˆæ®µæ•°ä¸å¤šè¿™ä¸ªæ€§è´¨ï¼Œéå¸¸éº»çƒ¦ã€‚å°† &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; çš„æ„ä¹‰æ›¿æ¢ä¸ºå‰ç¼€å’Œåï¼Œå°±å¯ä»¥å¾ˆè½»æ¾åœ°åšäº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-å®‡å®™&#34;&gt;A. å®‡å®™&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6535/problem/1&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6535/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k=1,2,\cdots,n-1\)&lt;/span&gt;ï¼Œå›ç­”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¼€å§‹è‡ªå¢ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œéƒ½å¯ä»¥é€‰å– &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªäº’ä¸ç›¸åŒçš„ä¸‹æ ‡ï¼Œå¹¶ä½¿å®ƒä»¬å¯¹åº”çš„å…ƒç´ å¢åŠ  1ã€‚æ­¤æ—¶ï¼Œè‹¥å­˜åœ¨å…ƒç´ ä¸å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œåœæ­¢ã€‚è¾“å‡ºåœæ­¢æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯èƒ½çš„æœ€å¤§å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6,V\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‘ç°ä¸å¤§äºè¿™ä¸ª condition æœ‰äº›åäººç±»ï¼Œå…ˆå°† &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å…¨éƒ¨å‡ 1ï¼Œè½¬åŒ–æˆå°äºæ¥è€ƒè™‘&lt;/p&gt;
&lt;p&gt;è€ƒè™‘èƒ½åšæŒåˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{a_j&amp;lt;i} i-a_j\le k\cdot i\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°è¯¥æ¡ä»¶åŒæ—¶æ˜¯å……åˆ†çš„ï¼Œå¯ä»¥æœæ‘©å°”æŠ•ç¥¨æ€è€ƒ&lt;/p&gt;
&lt;p&gt;å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æ’åºï¼Œåœæ­¢æ—¶å‚ä¸è¿ç®—çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; æ˜¯è¶Šæ¥è¶Šå¤šçš„ï¼Œæ•…è®°å½•æœ€åä¸€ä¸ªå‚ä¸è¿ç®—çš„ä¸‹æ ‡ï¼Œé€æ­¥æŒªåŠ¨ï¼ˆå½“å‘ç°è§£å‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¯”ä¸‹ä¸€ä¸ªæ›´å¤§æ—¶å°±éœ€è¦æŒªåŠ¨ï¼‰ï¼ŒåŒæ—¶è§£ä¸ç­‰å¼å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;citation&#34; data-cites=&#34;Quack&#34;&gt;@Quack&lt;/span&gt; äº‘æˆ‘åœ¨åœºä¸Šèƒ½æƒ³å‡ºå®˜è§£å¯¹æˆ‘æ¥è¯´æ˜¯éå¸¸äº†ä¸èµ·çš„ï¼ˆå…¶å®åœºä¸Šå†™æ­£è§£çš„äººå°‘å¾—å‡ºå¥‡ï¼‰ï¼Œæˆ‘ä¹Ÿä¸å¾—ä¸æ‰¿è®¤æˆ‘èƒ½åšå‡ºæ¥ç¡®å®æœ‰ä¸€å®šè¿æ°”æˆåˆ†ï¼Œä¹Ÿèƒ½ä»ä¸­ä¸€çª¥æˆ‘ä»¤äººçœ¼å‰ä¸€é»‘çš„æ•°å­¦ç´ å…»ï¼&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
    std::freopen(&amp;quot;universe.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;universe.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    int n;
    std::cin &amp;gt;&amp;gt; n, std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], --a[i];
    std::sort(a.begin() + 1, a.end());
    int id = 1;
    long long s = a[1];
    for (int i = 1; i &amp;lt; n; ++i) &amp;#123;
        if (id &amp;lt; i + 1)
            s += a[++id];
        long long x = s / (id - i);
        for (; id != n &amp;amp;&amp;amp; x &amp;gt; a[id + 1]; s += a[++id], x = s / (id - i));
        std::cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-è·³è·ƒ&#34;&gt;B. è·³è·ƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6535/problem/2&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6535/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ 01 åºåˆ—å’Œè·³è·ƒä¸Šé™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; ä¸ªè¯¢é—®ï¼Œå›ç­”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä» &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; è·³åˆ° &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; çš„é¢œè‰²å‡ä¸º 1ï¼Œæ¯æ¬¡ä¸èƒ½è·³è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ ¼æˆ–è·³å‡ºå»ï¼Œåœ¨æœ€å°åŒ–è¸©åˆ° 0 æ•°é‡çš„å‰æä¸‹ï¼Œæœ€å°åŒ–è·³è·ƒæ¬¡æ•°ï¼Œè¾“å‡ºè¿™ä¸¤ä¸ªå€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,q\le5\times10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®¹æ˜“å‘ç°åªèƒ½å¾€ä¸€ä¸ªæ–¹å‘è·³ï¼Œé‚£ä¹ˆä¸å¦¨ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;lt;b\)&lt;/span&gt;ã€‚æœ‰ä¸€ä¸ªè´ªå¿ƒçš„æƒ³æ³•æ˜¯èƒ½å¾€å³å°±å¾€å³ï¼Œæ‰‹ç©å‘ç°&lt;strong&gt;æ˜¯å¯¹çš„&lt;/strong&gt;ï¼ˆæˆ‘åœºä¸Šæ‰‹ç©è¿‡ååšå®šåœ°è®¤ä¸ºæ˜¯é”™çš„ï¼›å¯èƒ½å’Œæ²¡æ—¶é—´äº†å…µè’é©¬ä¹±æœ‰å…³ï¼‰ã€‚è¿™æ ·å°±å¾ˆå¥½æƒ³åˆ°ç¬¬äºŒé—®éœ€è¦å€å¢ï¼›ä½†æŠŠä¸¤ä¸ªé—®ç»“åˆèµ·æ¥è€ƒè™‘æ˜¯æœ‰ç‚¹å›°éš¾çš„ï¼Œèµ›æ—¶å°±æ„è¯†åˆ°è¿™ä¸¤é—®çš„è”ç³»æ²¡æœ‰çœ‹èµ·æ¥é‚£ä¹ˆå¤§ï¼Œç”šè‡³å¾ˆå¯èƒ½æ˜¯å‰²è£‚çš„ã€‚&lt;/p&gt;
&lt;p&gt;å•ç‹¬è€ƒè™‘ç¬¬ä¸€é—®ï¼Œå‘ç°å¯¹äºä¸€æ®µé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; çš„ 0ï¼Œéœ€è¦è¸©åˆ°æ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(\left\lfloor\dfrac {len}k\right\rfloor\)&lt;/span&gt; ä¸ª 0ã€‚ç­”æ¡ˆå®¹æ˜“è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;å•ç‹¬è€ƒè™‘ç¬¬äºŒé—®ï¼Œè€ƒè™‘ä¸€ä¸ªç¬¬ä¸€é—®ç­”æ¡ˆå›ºå®šä¸º 0 çš„æƒ…å†µï¼Œä¹Ÿå³æ¯ä¸ª len éƒ½æ¯” &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å°ã€‚åˆ™é—®é¢˜è½¬åŒ–æˆåœ¨ä¸è¸© 0 çš„æƒ…å†µä¸‹æœ€å°çš„æ­¥æ•°ã€‚å®¹æ˜“ç”¨å€å¢è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬é¢˜æœ€ä»¤äººå°è±¡æ·±åˆ»çš„ç‚¹åœ¨äºäºŒè€…çš„ç»“åˆï¼Œå‘ç°è¿™ &lt;span class=&#34;math inline&#34;&gt;\(\left\lfloor\dfrac {len}k\right\rfloor\cdot k\)&lt;/span&gt; ä¸ª 0 æ˜¯æ— è®ºå¦‚ä½•éƒ½ä¼šè¢«ç»è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨åŸå§‹æ•°ç»„é‡Œåˆ æ‰å®ƒä»¬ï¼Œè½¬åŒ–æˆåªè€ƒè™‘ç¬¬äºŒé—®çš„æƒ…å†µ&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;ï¼Ÿï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘å¯¹äºè‡ªå·±è«åå…¶å¦™è·‘å¾—æ¯”åˆ«äººå¿«ä¸€å¤§æˆªè¿™ä»¶äº‹æƒ…å·²ç»å¿«è¦è§æ€ªä¸æ€ªäº†ï¼Œè¿™æ¬¡åˆæ˜¯ä»€ä¹ˆåŸç†ï¼Œæˆ‘é¢„å¤„ç†å†™å¾—æ¯”è¾ƒæ¼‚äº®å—ï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;jump.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;jump.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, k, q, op;
    std::cin &amp;gt;&amp;gt; n, std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q &amp;gt;&amp;gt; k &amp;gt;&amp;gt; op;
    std::vector&amp;lt;int&amp;gt; tmp(n + 1), a(1), s(1), to(n + 2);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t;
        tmp[i] = t - &amp;#39;0&amp;#39;;
    &amp;#125;
    tmp.push_back(1), ++n;
    int cnt = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (tmp[i] == 1) &amp;#123;
            a.push_back(1), to[i] = (int)a.size() - 1;
            s.push_back(s.back() + cnt), cnt = 0;
        &amp;#125;
        else &amp;#123;
            ++cnt;
            if (i == n || tmp[i + 1] == 1) &amp;#123;
                for (int j = 1; j &amp;lt;= cnt % k; ++j)
                    a.push_back(0), s.push_back(s.back());
                cnt /= k;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    n = (int)a.size() - 1;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; f(20, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 0; i &amp;lt; 20; ++i)
        f[i][n] = n;
    for (int i = n - 1; i; --i) &amp;#123;
        f[0][i] = std::min(&amp;#123; n, i + k, f[0][i + 1] &amp;#125;);
        for (; !a[f[0][i]]; --f[0][i]);
        if (a[i] == 1) &amp;#123;
            for (int j = 1; j &amp;lt; 20; ++j)
                f[j][i] = f[j - 1][f[j - 1][i]];
        &amp;#125;
    &amp;#125;
    for (int a, b; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; a &amp;gt;&amp;gt; b;
        if (a &amp;gt; b)
            std::swap(a, b);
        a = to[a], b = to[b];
        std::cout &amp;lt;&amp;lt; s[b] - s[a];
        if (op == 1) &amp;#123;
            int res = s[b] - s[a];
            for (int i = 19; ~i; --i)
                if (f[i][a] &amp;lt; b)
                    a = f[i][a], res += (1 &amp;lt;&amp;lt; i);
            std::cout &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; res + 1;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-jongmah&#34;&gt;D. Jongmah&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/1110/problem/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/1110/problem/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°å½“è¿ç»­å‡ºç°ä¸‰æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\((i-1,i,i+1)\)&lt;/span&gt; æ—¶ï¼Œå¯ä»¥è¢«ä¸‰æ¬¡ç›¸åŒä»£æ›¿ï¼›&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°éœ€è¦ä½¿ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,a,b}\)&lt;/span&gt; æ¥ä»£è¡¨ DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶ï¼Œç”¨äº† &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ç»„ &lt;span class=&#34;math inline&#34;&gt;\((i-1,i,i+1)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ç»„ &lt;span class=&#34;math inline&#34;&gt;\((i,i+1,i+2)\)&lt;/span&gt; æ—¶çš„æœ€å¤§ç»„æ•°ï¼›&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¹¶æ²¡æœ‰æƒ³åˆ°è¦å°†äºŒè€…ç»“åˆèµ·æ¥ï¼æ„Ÿè§‰åº”è¯¥æ˜¯èƒ½æ¯”è¾ƒå¿«åšå‡ºæ¥çš„æ°´å¹³ã€‚èƒ½å¯Ÿè§‰åˆ°ä¸å¤ªè®¤çœŸã€‚æ‚”è¿‡ï¼&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; cnt(m + 1);
    for (int i = 1, x; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; x, ++cnt[x];
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; &amp;gt; f(m + 1, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (3, std::vector&amp;lt;int&amp;gt; (3, -inf)));
    f[0][0][0] = 0ll;
    for (int i = 1; i &amp;lt;= m; ++i)
        for (int a = 0; a &amp;lt;= 2; ++a) // i - 1, i, i + 1
            for (int b = 0; b &amp;lt;= 2; ++b) // i, i + 1, i + 2
                for (int c = 0; c &amp;lt;= 2; ++c) &amp;#123; // i - 2, i - 1, i
                    if (a + b + c &amp;gt; cnt[i]) continue;
                    f[i][a][b] = std::max(f[i][a][b], f[i - 1][c][a] + b + (cnt[i] - a - b - c) / 3);
                &amp;#125;
    std::cout &amp;lt;&amp;lt; f[m][0][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-magic-stones&#34;&gt;E. Magic Stones&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/1110/problem/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/1110/problem/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“æƒ³åˆ°è€ƒå¯Ÿå·®åˆ†æ•°ç»„ï¼Œå‘ç°è¿™ä¸ªæ“ä½œå°±æ˜¯äº¤æ¢äº†å·®åˆ†æ•°ç»„çš„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ã€‚æ•…å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„å·®åˆ†æ•°ç»„åˆ†åˆ«æ’åºï¼Œç„¶å check æ˜¯å¦ç›¸ç­‰å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), b(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; b[i];
    if (a[1] != b[1] || a[n] != b[n]) &amp;#123;
        std::cout &amp;lt;&amp;lt; &amp;quot;No&amp;quot; &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; da(n), db(n);
    std::adjacent_difference(a.begin() + 1, a.end(), da.begin());
    std::adjacent_difference(b.begin() + 1, b.end(), db.begin());
    std::sort(da.begin(), da.end());
    std::sort(db.begin(), db.end());
    std::cout &amp;lt;&amp;lt; (da == db ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="å€å¢" />
        <category term="æ ‘å½¢ DP" />
        <category term="Kruskal é‡æ„æ ‘" />
        <updated>2025-08-24T07:37:55.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250820/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250820/"/>
        <content type="html">&lt;p&gt;å›°éš¾&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;b.-beautyæ‹†è´¡çŒ®&#34;&gt;B. beautyï¼ˆæ‹†è´¡çŒ®ï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6513/problem/2&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6513/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n,V\)&lt;/span&gt;ï¼Œæ±‚å‡ºå¯¹äºæ‰€æœ‰é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œå€¼åŸŸä¸º &lt;span class=&#34;math inline&#34;&gt;\([1,V]\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\sum_{i=1}^n |a_i-a_{n-i+1}|\)&lt;/span&gt; çš„å’Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,V\le 5000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å®¹æ˜“æƒ³åˆ°ç®—è´¡çŒ®ï¼Œä¼šæœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(O(n^2V)\)&lt;/span&gt; çš„åšæ³•ã€‚ä½†æ˜¯æƒ³ &lt;span class=&#34;math inline&#34;&gt;\(O(nV)\)&lt;/span&gt; åšæ˜¯å¾ˆæŠ½è±¡çš„ï¼Œå’Œ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2V)\)&lt;/span&gt; çš„æ€è·¯å·²ç»å¾ˆä¸ä¸€æ ·äº†&lt;/li&gt;
&lt;li&gt;ç»å…¸ trickï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_{i+n/2}-a_i=\sum\limits_{x=0}^{+\infty} [a_i\le x&amp;lt;a_{i+n/2}]\)&lt;/span&gt; æ‹†è´¡çŒ® ã€‚æ•…è¦ç®— &lt;span class=&#34;math inline&#34;&gt;\(a_{i}-a_{i+n/2}\)&lt;/span&gt;ï¼Œåªéœ€è¦å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\in[a_i,a_{i+n/2})\)&lt;/span&gt; è®¡ç®—è´¡çŒ®ã€‚&lt;/li&gt;
&lt;li&gt;æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(x\in [1,V)\)&lt;/span&gt;ï¼Œå†æšä¸¾æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_t\ge x\)&lt;/span&gt;ã€‚é‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i\le x\)&lt;/span&gt;ï¼ŒåŒæ—¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n-t\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;gt;x\)&lt;/span&gt;ï¼›æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(i\le n/2\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_{i},a_{i+n/2}\)&lt;/span&gt; å¯¹æ•°åº”è¯¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\min(t,n-t)\)&lt;/span&gt;ã€‚æ•…å¯¹äºä¸€ä¸ªç¡®å®šçš„åºåˆ—ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\min(t,n-t)\)&lt;/span&gt; çš„è´¡çŒ®ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘è®¡æ•°æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_t\le x\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œè¿™è¦æ±‚ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; å¤§çš„æ•° &lt;span class=&#34;math inline&#34;&gt;\(\le x\)&lt;/span&gt; è€Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(t+1\)&lt;/span&gt; å¤§çš„æ•° &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;x\)&lt;/span&gt;ï¼Œä¹Ÿå³åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([1,x]\)&lt;/span&gt; é‡Œæ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸ªæ•°å†åœ¨ &lt;span class=&#34;math inline&#34;&gt;\((x,V]\)&lt;/span&gt; é‡Œæ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(n-t\)&lt;/span&gt; ä¸ªæ•°ï¼Œæ³¨æ„è¿˜è¦å†ä¹˜ä¸Šè¿™ä¸¤ç§æ•°æ‹¼èµ·æ¥çš„æ–¹æ¡ˆæ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;beauty.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;beauty.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    std::vector&amp;lt;long long&amp;gt; fac(5001), inv(5001);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; pw(5001, std::vector&amp;lt;long long&amp;gt; (5001));
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= 5000; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
        pw[i][0] = 1ll;
        for (int j = 1; j &amp;lt;= 5000; ++j)
            pw[i][j] = pw[i][j - 1] * i % mod;
    &amp;#125;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[5000] = qkp(fac[5000], mod - 2);
    for (int i = 4999; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[m] % mod * inv[n - m] % mod;
    &amp;#125;;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, V;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; V;
        auto res(0ll);
        for (int x = 1; x &amp;lt; V; ++x)
            for (int t = 1; t &amp;lt; n; ++t) &amp;#123;
                int k = std::min(t, n - t);
                (res += k * pw[x][t] % mod * pw[V - x][n - t] % mod * C(n, t) % mod) %= mod;
            &amp;#125;
        std::cout &amp;lt;&amp;lt; res * 2 % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;c.-drink-barå®¹æ–¥-ååº&#34;&gt;C. Drink Barï¼ˆå®¹æ–¥ + ååºï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/AT_snuke21_j&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/AT_snuke21_j&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸‰ä¸ªå±æ€§éƒ½æ˜¯æ’åˆ—ï¼Œå¯ä»¥æ¨ç†å‡ºåªè¦ä¸¤ä¸ªä¸‰å…ƒç»„ä¸­ï¼Œä½œå‡ºè´¡çŒ®çš„å…ƒç´ ä¸å®Œå…¨ç›¸åŒï¼Œä¸¤ä¸ªä¸‰å…ƒç»„å°±ä¸åŒã€‚è®¨è®ºä½œå‡ºè´¡çŒ®çš„å…ƒç´ æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;åªæœ‰ä¸€ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰ä¸¤ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œä»»é€‰çš„è¯ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(C_n^2\)&lt;/span&gt;ï¼Œè¦å‡å»ä¸€ä¸ªå…ƒç´ ä¸¥æ ¼ä¼˜äºå¦ä¸€ä¸ªå…ƒç´ çš„æƒ…å†µï¼Œä¸‰ç»´ååºå³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æœ‰ä¸‰ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œæ˜¯ä¸ªæœ‰ç‚¹å¤æ‚çš„å®¹æ–¥ï¼Œä¸å¦¨è®¾ä¸‰å…ƒç»„ä¸º &lt;span class=&#34;math inline&#34;&gt;\((i,j,k)\)&lt;/span&gt;ï¼Œå…¶ä¸­è´¡çŒ®æ¬¡æ•°æœ€å¤šçš„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è´¡çŒ®äº† &lt;span class=&#34;math inline&#34;&gt;\(\ge 1\)&lt;/span&gt; æ¬¡ï¼Œæ–¹æ¡ˆæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(C_n^3\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è´¡çŒ®äº† &lt;span class=&#34;math inline&#34;&gt;\(\ge 2\)&lt;/span&gt; æ¬¡ï¼Œæšä¸¾ä½œå‡ºä¸¤æ¬¡è´¡çŒ®çš„å±æ€§ï¼Œä»¥ &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; ä¸ºä¾‹ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a_j,a_k&amp;lt;a_i\)&lt;/span&gt;ï¼Œä»¥åŠ &lt;span class=&#34;math inline&#34;&gt;\(b_j,b_k&amp;lt;b_i\)&lt;/span&gt;ï¼ŒäºŒç»´ååºå³å¯&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è´¡çŒ®äº† &lt;span class=&#34;math inline&#34;&gt;\(\ge 3\)&lt;/span&gt; æ¬¡ï¼Œä¾ç„¶æ˜¯ä¸‰ç»´ååºï¼Œå¯ä»¥ç”¨ã€ä¸¤ä¸ªå…ƒç´ åšå‡ºè´¡çŒ®ã€ä¸­ cdq å¾—åˆ°çš„å€¼ç®—å‡ºç­”æ¡ˆã€‚è®°å¾—ä¹˜ 2ï¼Œå› ä¸ºè¢«å¤šå‡äº† 2 æ¬¡ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    struct node &amp;#123; int a, b, c, res; &amp;#125;;
    std::vector&amp;lt;node&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i].a &amp;gt;&amp;gt; a[i].b &amp;gt;&amp;gt; a[i].c;
        a[i].res = 0;
    &amp;#125;
    long long res = n;
    res += (long long)n * (n - 1) / 2;
    std::vector&amp;lt;int&amp;gt; bit(n + 1);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            bit[x] += v;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        int res = 0;
        for (; x; x -= lowbit(x))
            res += bit[x];
        return res;
    &amp;#125;;
    std::function&amp;lt;void(int, int)&amp;gt; calc = [&amp;amp;](int l, int r) &amp;#123;
        if (l == r)
            return;
        int mid = (l + r) &amp;gt;&amp;gt; 1;
        calc(l, mid), calc(mid + 1, r);
        int j = l;
        for (int i = mid + 1; i &amp;lt;= r; ++i) &amp;#123;
            for (; j &amp;lt;= mid &amp;amp;&amp;amp; a[j].b &amp;lt; a[i].b; ++j)
                add(a[j].c, 1);
            a[i].res += ask(a[i].c);
        &amp;#125;
        for (int i = l; i &amp;lt; j; ++i)
            add(a[i].c, -1);
        std::inplace_merge(a.begin() + l, a.begin() + mid + 1, a.begin() + r + 1, [&amp;amp;](node x, node y) &amp;#123; return x.b &amp;lt; y.b; &amp;#125;);
        return;
    &amp;#125;;
    std::sort(a.begin() + 1, a.end(), [&amp;amp;](node x, node y) &amp;#123; return x.a &amp;lt; y.a; &amp;#125;);
    calc(1, n);
    for (int i = 1; i &amp;lt;= n; ++i)
        res -= a[i].res;
    res += (long long)n * (n - 1) * (n - 2) / 6;
    for (int k = 0; k &amp;lt; 3; ++k) &amp;#123;
        std::sort(a.begin() + 1, a.end(), [&amp;amp;](node x, node y) &amp;#123; return x.a &amp;lt; y.a; &amp;#125;);
        std::fill(bit.begin() + 1, bit.end(), 0);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            int t = ask(a[i].b);
            res -= (long long)t * (t - 1) / 2;
            add(a[i].b, 1);
            std::tie(a[i].a, a[i].b, a[i].c) = std::make_tuple(a[i].b, a[i].c, a[i].a);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        res += (long long)a[i].res * (a[i].res - 1);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;c.-æ˜Ÿç™½-by-ttpandasç¬›å¡å°”æ ‘-dsu-on-tree&#34;&gt;C. æ˜Ÿç™½ by TTpandaSï¼ˆç¬›å¡å°”æ ‘ + dsu on treeï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;/20250819/#æ˜Ÿç™½-by-ttpandasç¬›å¡å°”æ ‘-dsu-on-tree&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;c.-isn&#34;&gt;C. isn&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://hydro.ac/p/bzoj-P4361&#34; class=&#34;uri&#34;&gt;https://hydro.ac/p/bzoj-P4361&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æœ€åä¸€ä¸ªåˆ å»çš„ä¸€å®šæ˜¯è¿æ¥ &lt;code&gt;&amp;gt;&lt;/code&gt; çš„æ•°ï¼Œå¯ä»¥ DP è¿˜å‰©ä¸€ä¸ªæ•°æ²¡åˆ æ—¶å¯èƒ½çš„åºåˆ—ã€‚&lt;/p&gt;
ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,0/1}\)&lt;/span&gt; è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œåºåˆ—é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œæœ€åä¸€ä¸ªè¢«åˆ å»çš„æ•°ï¼ˆæœªï¼‰è¢«ç¡®å®šçš„æ–¹æ¡ˆæ•°ã€‚&lt;strong&gt;æ³¨æ„ç¡®å®šæœ€åä¸€ä¸ªè¢«åˆ å»çš„æ•°è¦åœ¨è½¬ç§»è¿‡ç¨‹ä¸­è¿›è¡Œï¼Œè€Œä¸æ˜¯ä½œä¸ºä¸€ä¸ª DP èŠ‚ç‚¹&lt;/strong&gt;ï¼Œå¾ˆå®¹æ˜“å‘ç°åè€…æ˜¯é”™çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¼˜åŒ–çš„æ€è·¯å°±ä¸ä¸€æ ·äº†ã€‚å› ä¸ºè¦ä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\((n-j)!\)&lt;/span&gt;ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„è¿™ä¸€ç»´æ˜¯çœä¸æ‰çš„&lt;/p&gt;
è€ƒè™‘ä¸ç®¡æœ€åä¸€ä¸ªè¢«åˆ æ‰çš„æ•°ï¼Œç›´æ¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œåºåˆ—é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\sum\limits_{a_k\le a_i}f_{k,j - 1}\)&lt;/span&gt;ï¼Œå¯ä»¥ DS ä¼˜åŒ–ã€‚ä½†è¿™æ ·ä¼šäº§ç”Ÿä¸åˆæ³•çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è€ƒå¯Ÿä»€ä¹ˆæ ·çš„åºåˆ—åˆæ³•ï¼Œå‘ç°&lt;strong&gt;åˆ å»çš„æœ€åä¸€ä¸ªæ•°ä¸€å®šæ˜¯éæ³•çš„ï¼Œä¹Ÿå°±æ˜¯åŒ…å«ä¹‹çš„åºåˆ—éƒ½æ˜¯éæ³•çš„ï¼›åä¹‹æ˜“å¾—è¢«åˆæ³•åºåˆ—åŒ…å«çš„åºåˆ—éƒ½éæ³•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ˜ç™½äº†è¿™ä¸€ç‚¹è¿‡åå°±ä¼šçŸ¥é“é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„åˆæ³•åºåˆ—ç³»æ•°éƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\((n-j)!\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ•…å®¹æ–¥ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g_i\)&lt;/span&gt; è¡¨ç¤ºåºåˆ—é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(h_i\)&lt;/span&gt; è¡¨ç¤ºåºåˆ—é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„åˆæ³•æ–¹æ¡ˆæ•°ã€‚ä»å¼‚æˆ–è§’åº¦è€ƒè™‘ï¼Œæ˜“å¾— &lt;span class=&#34;math inline&#34;&gt;\(h_i=g_i-\sum\limits_{j=i+1}h_j\times (j-i)!\times C_j^i\)&lt;/span&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;isn.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;isn.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), l(1);
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i], l.push_back(a[i]);
        fac[i] = fac[i - 1] * i % mod;
    &amp;#125;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[m] % mod * inv[n - m] % mod;
    &amp;#125;;
    std::sort(l.begin(), l.end());
    l.erase(std::unique(l.begin(), l.end()), l.end());
    for (int i = 0; i &amp;lt;= n; ++i)
        a[i] = std::lower_bound(l.begin(), l.end(), a[i]) - l.begin() + 1;
    int m = (int)l.size();
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; bit(n + 1, std::vector&amp;lt;long long&amp;gt; (m + 1));
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int id, int x, long long v) &amp;#123;
        for (; x &amp;lt;= m; x += lowbit(x))
            (bit[id][x] += v) %= mod;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int id, int x) &amp;#123;
        auto res(0ll);
        for (; x; x -= lowbit(x))
            (res += bit[id][x]) %= mod;
        return res;
    &amp;#125;;
    std::vector&amp;lt;long long&amp;gt; g(n + 1), h(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long long&amp;gt; (n + 1));
    add(0, a[0], 1ll), f[0][0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = n; j; --j) &amp;#123;
            f[i][j] = ask(j - 1, a[i]);
            add(j, a[i], f[i][j]);
            (g[j] += f[i][j] * fac[n - j]) %= mod;
        &amp;#125;
    auto res(0ll);
    for (int i = n; i; --i) &amp;#123;
        h[i] = g[i];
        for (int j = i + 1; j &amp;lt;= n; ++j)
            (h[i] += mod - h[j] * fac[j - i] % mod * C(j, i) % mod) %= mod;
        (res += h[i]) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;d.-thepowers&#34;&gt;D. ThePowers&lt;/h3&gt;
&lt;p&gt;TopCoder - 12185ï¼ŒåŸé¢˜äº¤ä¸äº†æ•…ä¸æ”¾é“¾æ¥äº†&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6522/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6522/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(A,B\)&lt;/span&gt;ï¼Œå¯¹äºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(X\le A,Y\le B\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(X^Y\)&lt;/span&gt; çš„å¯èƒ½å–å€¼æ•°é‡ã€‚&lt;span class=&#34;math inline&#34;&gt;\(A,B\le10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘ä»€ä¹ˆæ—¶å€™ç®—é‡ã€‚å‘ç°å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(x^a=y^b\)&lt;/span&gt;ï¼Œæ­¤æ—¶è®° &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;=a\div\gcd(a,b),b&amp;#39;=b\div \gcd(a,b)\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(t=\sqrt[a&amp;#39;]x=\sqrt[b&amp;#39;]y\)&lt;/span&gt; ä¸ºæ•´ï¼ˆå†™æˆè´¨å› æ•°ä¹˜ç§¯æ˜¯æ˜“è¯çš„ï¼‰ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(x=t^b,y=t^a\)&lt;/span&gt;ï¼Œæ˜¯åŒä¸€ä¸ªæ•°çš„ä¸åŒæ¬¡å¹‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å†…æ‰€æœ‰æ•°åˆ†ç»„ï¼Œè®° &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt; è¡¨ç¤ºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„æ¬¡å¹‚ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸æ˜¯å…¶ä»–æ•°çš„æ¬¡å¹‚&lt;/p&gt;
å‘ç°ä¸€ä¸ªå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;\sqrt A\)&lt;/span&gt; çš„æ•° &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼Œåªæœ‰å¯èƒ½å±äº &lt;span class=&#34;math inline&#34;&gt;\(S_y\)&lt;/span&gt;ï¼Œæˆ–ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\le \sqrt A\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt;ã€‚æ¯ç»„æœ€å¤šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(30\)&lt;/span&gt; ä¸ªï¼Œæ•…æ‰«ä¸€é &lt;span class=&#34;math inline&#34;&gt;\(\le\sqrt A\)&lt;/span&gt; çš„æ•°å³å¯å®Œæˆåˆ†ç»„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿™æ ·å°±åªç”¨è€ƒè™‘åŒç»„å†…çš„è®¡æ•°ã€‚å³å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(p\le |S_x|,y\le B\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x^{py}\)&lt;/span&gt; æœ‰å¤šå°‘ç§å–å€¼ï¼Œä¹Ÿå³ &lt;span class=&#34;math inline&#34;&gt;\(py\)&lt;/span&gt; æœ‰å¤šå°‘ç§å–å€¼&lt;/p&gt;
å‘ç°å› ä¸ºå€¼åŸŸæ˜¯è¿ç»­çš„ï¼Œå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼Œåªè¦ &lt;span class=&#34;math inline&#34;&gt;\(pB\)&lt;/span&gt; èŒƒå›´å†…æŸä¸ªæ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; çš„å€æ•°å°±å¯ä»¥å–åˆ°ï¼Œæšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\([(p-1)B+1,pB]\)&lt;/span&gt;ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å®¹æ–¥ï¼Œå°±éœ€è¦è®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(p\sim |S_x|\)&lt;/span&gt; çš„æ¯ä¸ªå­é›†ï¼Œå¤æ‚åº¦ä¼šçˆ†ç‚¸ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x,y\in[p,|S_x|]\)&lt;/span&gt;ï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å€æ•°ï¼Œå°±å¯ä»¥ skipï¼Œåªåœ¨å‰©ä¸‹çš„å…ƒç´ é‡Œæšä¸¾å­é›†ï¼Œå¯ä»¥ä»£ç éªŒè¯ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(30\)&lt;/span&gt; ä»¥å†…æœ€å¤šå‰©ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(15\)&lt;/span&gt; ä¸ªæ•°ï¼Œå¯ä»¥æ¥å—ï¼Œæ³¨æ„å­é›†ä¿¡æ¯ç±»ä¼¼é«˜ç»´å‰ç¼€å’Œåœ° &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ±‚å°±è¡Œäº†&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;power.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;power.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    long long A, B, mx = 1ll;
    std::cin &amp;gt;&amp;gt; A &amp;gt;&amp;gt; B;
    if (A == 1) &amp;#123;
        std::cout &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    int cnt = 1;
    long long res = 1ll;
    for (; (mx + 1) * (mx + 1) &amp;lt;= A; ++mx);
    std::vector&amp;lt;int&amp;gt; tag(mx + 1);
    for (int i = 2; i &amp;lt;= mx; ++i)
        if (!tag[i]) &amp;#123;
            int siz = 1;
            for (long long j = i; j &amp;lt;= A; j *= i, ++siz)
                if (j &amp;lt;= mx)
                    tag[j] = 1;
            cnt += --siz;
            for (int j = 1; j &amp;lt;= siz; ++j) &amp;#123;
                std::vector&amp;lt;int&amp;gt; p(&amp;#123; j &amp;#125;);
                for (int k = j + 1; k &amp;lt;= siz; ++k) &amp;#123;
                    bool flag = 1;
                    for (auto l : p)
                        if (k % l == 0) &amp;#123;
                            flag = 0;
                            break;
                        &amp;#125;
                    if (flag)
                        p.push_back(k);
                &amp;#125;
                int m = (int)p.size(), s = 1 &amp;lt;&amp;lt; m;
                std::vector&amp;lt;long long&amp;gt; mul(s);
                mul[0] = 1ll;
                auto lcm = [&amp;amp;](long long x, long long y) &amp;#123;
                    return x / std::__gcd(x, y) * y;
                &amp;#125;;
                for (int k = 1; k &amp;lt; s; ++k) &amp;#123;
                    mul[k] = lcm(p[std::__lg(k ^ ((k - 1) &amp;amp; k))], mul[(k - 1) &amp;amp; k]);
                    if (__builtin_popcount(k) &amp;amp; 1)
                        res += j * B / mul[k] - (j - 1) * B / mul[k];
                    else
                        res -= j * B / mul[k] - (j - 1) * B / mul[k];
                &amp;#125;
            &amp;#125;
        &amp;#125;
    res += (A - cnt) * B;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;æœç´¢åšæ³•æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå°±ä¸èµ˜è¿°äº†&lt;/p&gt;
</content>
        <category term="DP" />
        <category term="å®¹æ–¥" />
        <updated>2025-08-20T12:26:44.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250819/</id>
        <title>log æ•°æ®ç»“æ„çš„ä¸€äº›é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250819/"/>
        <content type="html">&lt;p&gt;çº¿æ®µæ ‘ã€æ ‘çŠ¶æ•°ç»„ã€å€å¢ã€åˆ†æ²»ï¼ˆæœ´ç´ åˆ†æ²» / CDQ / æ•´ä½“äºŒåˆ†ï¼‰ã€å¹³è¡¡æ ‘ã€å­—å…¸æ ‘ã€ç¬›å¡å°”æ ‘&lt;/p&gt;
&lt;p&gt;å¤šä¹å“‰ï¼Ÿä¸å¤šä¹Ÿã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;p&gt;é¢˜ç›®æ¥æºï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;llswâ€™s pdf&lt;/li&gt;
&lt;li&gt;æ´›è°·æ–‡ç« å¹¿åœºé¢˜è§£åŒºæœç´¢å¯¹åº”ç®—æ³•&lt;/li&gt;
&lt;li&gt;è‡ªå·±ä»¥å‰çš„ä¸€äº›é›¶æ•£é¢˜è§£&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰¾äº†ä¸€äº›æœ‰æ•°æ®ç»“æ„æ–¹é¢æ€ç»´éš¾ç‚¹çš„é¢˜ï¼Œå®ç°éš¾åº¦é€šå¸¸ä¸ä¼šå¾ˆå¤§ï¼Œä¹Ÿæœ‰å°‘è®¸ç²‘ç²‘å¤¹æ‚å…¶ä¸­&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;code&gt;#&lt;/code&gt; æ˜¯ç¼ºé¢˜è§£ï¼Œ&lt;code&gt;*&lt;/code&gt; æ˜¯ç¼ºä»£ç &lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;çº¿æ®µæ ‘&#34;&gt;çº¿æ®µæ ‘&lt;/h2&gt;
&lt;h3 id=&#34;ç»´æŠ¤ç‰¹æ®Šä¿¡æ¯&#34;&gt;ç»´æŠ¤ç‰¹æ®Šä¿¡æ¯&lt;/h3&gt;
&lt;h4 id=&#34;é‡‘é±¼è‰-curtainsåŒºé—´è¦†ç›–ä¿¡æ¯&#34;&gt;é‡‘é±¼è‰ / Curtainsï¼ˆåŒºé—´è¦†ç›–ä¿¡æ¯ï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11536&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11536&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œç»™å‡º &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\([L,R]\)&lt;/span&gt; æ˜¯å¦èƒ½è¢«è¡¨ç¤ºä¸ºè‹¥å¹² &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; çš„å¹¶é›†ã€‚æ³¨æ„ä¸èƒ½è¦†ç›–åˆ° &lt;span class=&#34;math inline&#34;&gt;\([L,R]\)&lt;/span&gt; ä¹‹å¤–çš„ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,q\le 5\times 10^5,|V|\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;é¢˜ç›®æ‰€æ±‚ç­‰ä»·äº check æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(l\ge L\land r\le R\)&lt;/span&gt; çš„æ‰€æœ‰åŒºé—´æ˜¯å¦èƒ½å¤Ÿè¦†ç›– &lt;span class=&#34;math inline&#34;&gt;\([L,R]\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;è¿™ä¸ªå¾ˆç®€å•ï¼Œéœ€è¦åŒºé—´ä¿®æ”¹çš„åšæ³•å°±ä¸æäº†ã€‚å¯ä»¥æƒ³ä¸€ä¸‹æœ‰æ²¡æœ‰åªéœ€è¦å•ç‚¹ä¿®æ”¹çš„åšæ³•&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°æƒå€¼çº¿æ®µæ ‘å¯ä»¥ç»´æŠ¤ã€Œä¸€æ®µè¿ç»­å·¦ç«¯ç‚¹å¯¹åº”åŒºé—´çš„å¹¶ã€æ˜¯å¦æ˜¯è¿ç»­çš„ï¼š&lt;/p&gt;
ç»´æŠ¤ä½äºåŒºé—´å†…çš„å·¦ç«¯ç‚¹æœ€åä¸€ä¸ªè¦†ç›–åˆ°çš„ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(rv\)&lt;/span&gt;ï¼ˆå¯ä»¥åœ¨åŒºé—´å¤–ï¼›å‘ç°ä»åŒºé—´å·¦ç«¯ç‚¹åˆ° &lt;span class=&#34;math inline&#34;&gt;\(rv\)&lt;/span&gt; ä¼šè¢«è¿ç»­è¦†ç›–ï¼‰ï¼Œ&lt;strong&gt;åŒºé—´å†…&lt;/strong&gt;æœ€åä¸€ä¸ªæ²¡æœ‰è¢«è¦†ç›–åˆ°çš„ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼Œå’Œè¡¨ç¤ºåŒºé—´æ˜¯å¦èƒ½è¢«å®Œæ•´è¦†ç›–çš„æ ‡è®° flagã€‚pushup æ˜¯å®¹æ˜“çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®¹æ˜“å‘ç°å¦‚æœæˆ‘ä»¬åœ¨æ ‘ä¸Šè¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\([L,R]\)&lt;/span&gt; ä¸­æ‰€æœ‰å·¦ç«¯ç‚¹çš„ flagï¼Œæ— æ³•ä¿è¯å‚ä¸è¦†ç›–çš„ &lt;span class=&#34;math inline&#34;&gt;\(r\le R\)&lt;/span&gt;ã€‚æ•…ç¦»çº¿ä¸‹æ¥æ‰«æçº¿å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šç”±äºæœªçŸ¥åŸå› è·‘å¾—å¾ˆå¯èƒ½ä¸å¦‚åŒºé—´ä¿®æ”¹çš„æ–¹æ³•å¿« TAT&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e5 + 5;
struct _ &amp;#123;
    bool flag;
    int l, r, rv, p;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void pushup(int p) &amp;#123;
    t[p].rv = std::max(t[lt].rv, t[rt].rv);
    if (!t[lt].flag) &amp;#123;
        t[p].flag = 0;
        if (!t[rt].flag &amp;amp;&amp;amp; t[lt].rv &amp;lt; t[rt].p)
            t[p].p = t[rt].p;
        else
            t[p].p = t[lt].p;
    &amp;#125;
    else if (!t[rt].flag &amp;amp;&amp;amp; t[lt].rv &amp;lt; t[rt].p)
        t[p].flag = 0, t[p].p = t[rt].p;
    else
        t[p].flag = 1, t[p].p = 0;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = t[p].p = r;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void add(int p, int x, int v) &amp;#123;
    if(t[p].l == t[p].r) &amp;#123;
        t[p].flag = 1, t[p].p = 0;
        t[p].rv = std::max(t[p].rv, v);
        return;
    &amp;#125;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, x, v);
    else
        add(rt, x, v);
    pushup(p);
    return;
&amp;#125;
_ ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p];
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;lt;= mid)
        return ask(lt, l, r);
    if (l &amp;gt; mid)
        return ask(rt, l, r);
    auto ls(ask(lt, l, r)), rs(ask(rt, l, r));
    if (!ls.flag) &amp;#123;
        if (!rs.flag &amp;amp;&amp;amp; ls.rv &amp;lt; rs.p)
            ls.p = rs.p;
    &amp;#125;
    else if (!rs.flag &amp;amp;&amp;amp; ls.rv &amp;lt; rs.p)
        ls.flag = 0, ls.p = rs.p;
    ls.rv = std::max(ls.rv, rs.rv);
    return ls;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m, q;
    std::cin &amp;gt;&amp;gt; m &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q;
    bld(1, 1, m);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; t(m + 1);
    for (int i = 1, l, r; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        t[r].push_back(l);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; res(q + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; tq(m + 1);
    for (int i = 1, l, r; i &amp;lt;= q; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        tq[r].emplace_back(l, i);
    &amp;#125;
    for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
        for (auto l : t[i])
            add(1, l, i);
        for (auto [l, id] : tq[i])
            res[id] = ask(1, l, i).flag;
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        std::cout &amp;lt;&amp;lt; (res[i] ? &amp;quot;YES&amp;quot; : &amp;quot;NO&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;h4 id=&#34;é¢˜æ—¥-zapatakå“ˆå¸Œ&#34;&gt;# é¢˜æ—¥ Zapatakï¼ˆå“ˆå¸Œï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11262&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11262&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;ç®€å•æ•°æ®ç»“æ„å¸¦ä¸€ç‚¹é€’æ¨æ€§è´¨&#34;&gt;ç®€å•æ•°æ®ç»“æ„ï¼ˆå¸¦ä¸€ç‚¹é€’æ¨æ€§è´¨ï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://pjudge.ac/problem/21636&#34; class=&#34;uri&#34;&gt;https://pjudge.ac/problem/21636&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šåˆå§‹ä¸ºç©ºçš„å¤šé‡é›† &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;, &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt;ï¼Œè¿™ä¸¤ä¸ªå¤šé‡é›†ä¸­çš„å…ƒç´ éƒ½æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; ä¸¤ç§å±æ€§ã€‚éœ€è¦éœ€è¦ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; çš„åŠ ç‚¹å’Œåˆ ç‚¹æ“ä½œï¼Œè¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\(\forall \,i\in p,j\in q\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\max(i_x + j_x, i_y + j_y)\)&lt;/span&gt; çš„æœ€å°å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(m\le 10^6,V\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘&lt;strong&gt;å¯¹ä¸ç­‰å¼æ’ç­‰å˜å½¢ï¼Œè½¬åŒ–ä¸ºååºé—®é¢˜&lt;/strong&gt;ã€‚è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(a_{i,0}+b_{j,0}\ge a_{i,1}+b_{j,1}\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(a_{i,0}-a_{i,1}\ge b_{j,1}-b_{j,0}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(a_{i,0}-a_{i,1}\)&lt;/span&gt; æ’åºã€æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(b_{j,1}-b_{j,0}\)&lt;/span&gt; æ’åºã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚æŸä¸ªæ—¶åˆ»çš„ç­”æ¡ˆï¼Œéœ€è¦å¯¹äºæ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰¾åˆ°æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(b_{j,0}\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(b_{j,1}-b_{j,0}\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([-\infty, a_{i,0}-a_{i,1}]\)&lt;/span&gt; ä¸­ï¼ŒåŒæ—¶æ‰¾åˆ°æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(b_{j,1}\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(b_{j,1}-b_{j,0}\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([a_{i, 0}-a_{i,1},+\infty]\)&lt;/span&gt; ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå¸¦æœ‰ä¸€ç‚¹é€’æ¨çš„æ€§è´¨ï¼Œåœ¨çº¿æ®µæ ‘ pushup çš„æ—¶å€™ï¼Œç”¨å·¦è¾¹çš„ &lt;span class=&#34;math inline&#34;&gt;\(b_{j,0}\)&lt;/span&gt; ç»“åˆå³è¾¹çš„ç­”æ¡ˆå¾—åˆ°çˆ¶äº²çš„ç­”æ¡ˆã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;em&gt;å¬è¯´æˆ‘ä¹‹å‰èµ›æ—¶åˆ‡äº†è¿™é¢˜ï¼Ÿæ€ä¹ˆæ²¡å°è±¡ã€‚llsw è®²é¢˜çš„æ—¶å€™è¯´è¦ç¦»çº¿ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°ç¦»çº¿åšæ³• orz&lt;/em&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 2e9 + 1;
struct _ &amp;#123; long long aa, ab, ba, bb, u; int l, r, id; &amp;#125;;
std::vector&amp;lt;_&amp;gt; t(1);
std::vector&amp;lt;std::multiset&amp;lt;long long&amp;gt; &amp;gt; aa(1), ab(1), ba(1), bb(1);
int tot, cnt;
#define lt t[p].l
#define rt t[p].r
void pushup(int p) &amp;#123;
    t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;
    if (lt) &amp;#123;
        t[p].u = t[lt].u;
        t[p].aa = t[lt].aa, t[p].ab = t[lt].ab, t[p].ba = t[lt].ba, t[p].bb = t[lt].bb;
    &amp;#125;
    if (rt) &amp;#123;
        t[p].u = std::min(t[p].u, t[rt].u);
        t[p].aa = std::min(t[p].aa, t[rt].aa);
        t[p].ab = std::min(t[p].ab, t[rt].ab);
        t[p].ba = std::min(t[p].ba, t[rt].ba);
        t[p].bb = std::min(t[p].bb, t[rt].bb);
    &amp;#125;
    if (lt &amp;amp;&amp;amp; rt)
        t[p].u = std::min(&amp;#123; t[p].u, t[lt].ba + t[rt].aa, t[lt].ab + t[rt].bb &amp;#125;);
    return;
&amp;#125;
int adda(int p, long long l, long long r, int x, int a, int b) &amp;#123;
    if (!p)
        p = ++tot, t.emplace_back(), t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;
    if (l == r) &amp;#123;
        if (!t[p].id)
            t[p].id = ++cnt, aa.emplace_back(), ab.emplace_back(), ba.emplace_back(), bb.emplace_back();
        int id = t[p].id;
        aa[id].insert(a), ab[id].insert(b);
        t[p].aa = *aa[id].begin(), t[p].ab = *ab[id].begin();
        if (!aa[id].empty() &amp;amp;&amp;amp; !ba[id].empty())
            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());
        else
            t[p].u = inf;
        return p;
    &amp;#125;
    long long mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid) &amp;#123;
        auto s(adda(lt, l, mid, x, a, b));
        lt = s;
    &amp;#125;
    else &amp;#123;
        auto s(adda(rt, mid + 1, r, x, a, b));
        rt = s;
    &amp;#125;
    pushup(p);
    return p;
&amp;#125;
int addb(int p, long long l, long long r, int x, int a, int b) &amp;#123;
    if (!p)
        p = ++tot, t.emplace_back(), t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;
    if (l == r) &amp;#123;
        if (!t[p].id)
            t[p].id = ++cnt, aa.emplace_back(), ab.emplace_back(), ba.emplace_back(), bb.emplace_back();
        int id = t[p].id;
        ba[id].insert(a), bb[id].insert(b);
        t[p].ba = *ba[id].begin(), t[p].bb = *bb[id].begin();
        if (!aa[id].empty() &amp;amp;&amp;amp; !ba[id].empty())
            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());
        else
            t[p].u = inf;
        return p;
    &amp;#125;
    long long mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid) &amp;#123;
        auto s(addb(lt, l, mid, x, a, b));
        lt = s;
    &amp;#125;
    else &amp;#123;
        auto s(addb(rt, mid + 1, r, x, a, b));
        rt = s;
    &amp;#125;
    pushup(p);
    return p;
&amp;#125;
void dela(int p, long long l, long long r, int x, int a, int b) &amp;#123;
    if (l == r) &amp;#123;
        int id = t[p].id;
        aa[id].erase(aa[id].find(a)), ab[id].erase(ab[id].find(b));
        t[p].aa = (aa[id].empty() ? inf : *aa[id].begin());
        t[p].ab = (ab[id].empty() ? inf : *ab[id].begin());
        if (!aa[id].empty() &amp;amp;&amp;amp; !ba[id].empty())
            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());
        else
            t[p].u = inf;
        return;
    &amp;#125;
    long long mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        dela(lt, l, mid, x, a, b);
    else
        dela(rt, mid + 1, r, x, a, b);
    pushup(p);
    return;
&amp;#125;
void delb(int p, long long l, long long r, int x, int a, int b) &amp;#123;
    if (l == r) &amp;#123;
        int id = t[p].id;
        ba[id].erase(ba[id].find(a)), bb[id].erase(bb[id].find(b));
        t[p].ba = (ba[id].empty() ? inf : *ba[id].begin());
        t[p].bb = (bb[id].empty() ? inf : *bb[id].begin());
        if (!aa[id].empty() &amp;amp;&amp;amp; !ba[id].empty())
            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());
        else
            t[p].u = inf;
        return;
    &amp;#125;
    long long mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        delb(lt, l, mid, x, a, b);
    else
        delb(rt, mid + 1, r, x, a, b);
    pushup(p);
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;set.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;set.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int q, rt = 0;
    std::cin &amp;gt;&amp;gt; q;
    for (int i = 1; i &amp;lt;= q; ++i) &amp;#123;
        int op, d, a, b;
        std::cin &amp;gt;&amp;gt; op &amp;gt;&amp;gt; d &amp;gt;&amp;gt; a &amp;gt;&amp;gt; b;
        if (op == 0 &amp;amp;&amp;amp; d == 0)
            dela(rt, -inf, inf, a - b, a, b);
        else if (op == 0)
            delb(rt, -inf, inf, b - a, a, b);
        else if (d == 0)
            rt = adda(rt, -inf, inf, a - b, a, b);
        else
            rt = addb(rt, -inf, inf, b - a, a, b);
        std::cout &amp;lt;&amp;lt; (t[1].u == inf ? -1 : t[1].u) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;å‘½è¿åˆ©ç”¨çº¿æ®µæ ‘çš„åˆ†æ²»ç»“æ„é€’æ¨&#34;&gt;# å‘½è¿ï¼ˆåˆ©ç”¨çº¿æ®µæ ‘çš„åˆ†æ²»ç»“æ„é€’æ¨ï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6773&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6773&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;å¯¹æ•°æ®ç»“æ„çš„çˆ±ç»´æŠ¤å‡½æ•°&#34;&gt;* å¯¹æ•°æ®ç»“æ„çš„çˆ±ï¼ˆç»´æŠ¤å‡½æ•°ï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5609&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5609&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å’Œæ¨¡æ•° &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åˆå§‹å¯èƒ½æ¯” &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å¤§å¾ˆå¤šï¼Œè¿˜æœ‰å¯èƒ½ä¸ºè´Ÿï¼‰ï¼Œç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡é—®åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œè¿›è¡Œè¿™æ ·çš„æ“ä½œï¼š&lt;/p&gt;
&lt;p&gt;åˆå§‹ &lt;span class=&#34;math inline&#34;&gt;\(sum=0\)&lt;/span&gt;ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œä¾æ¬¡ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(sum\gets sum+a_i\)&lt;/span&gt;ï¼Œå½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(sum\ge p\)&lt;/span&gt; æ—¶ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(sum\gets sum-p\)&lt;/span&gt;ï¼ˆæ³¨æ„è¿™ä¸æ˜¯å–æ¨¡ï¼Œå‡å®Œä¹‹åè¿˜æ˜¯å¯èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(\ge p\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é—®æœ€ç»ˆ &lt;span class=&#34;math inline&#34;&gt;\(sum\)&lt;/span&gt; çš„å€¼ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6,m\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è€ƒè™‘çº¿æ®µæ ‘ç»´æŠ¤å‡½æ•°ã€‚å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; è¡¨ç¤ºåŒºé—´ä¸Šæƒ³è¦å‡å» &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; éœ€è¦çš„æœ€å°åˆå§‹å€¼ï¼ˆè¿™æ ·æ‰èƒ½è®©å®šä¹‰åŸŸå’ŒåŒºé—´é•¿æœ‰å…³ï¼‰ï¼ŒæŸ¥è¯¢æ—¶ç›´æ¥äºŒåˆ†å³å¯ï¼›è€ƒè™‘åˆå§‹åŒ–æ—¶å¦‚ä½•åˆå¹¶ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ€è€ƒè¾ƒä¸ºæš´åŠ›çš„åšæ³•ï¼Œå¯¹äºå·¦ä¾§ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å’Œå³ä¾§ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(f(a+1)-1+s_l-a\cdot p\ge f(b)\)&lt;/span&gt;ï¼Œä¹Ÿå³å¯ä»¥å‡å» &lt;span class=&#34;math inline&#34;&gt;\(a+b\)&lt;/span&gt; æ¬¡ï¼Œå°±å¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(\max(f(a),f(b)-s_l+a\cdot p)\)&lt;/span&gt; æ¥æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(f(a+b)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç° &lt;span class=&#34;math inline&#34;&gt;\((a,b)\)&lt;/span&gt; çš„è´¡çŒ®ä¸€å®šå°äº &lt;span class=&#34;math inline&#34;&gt;\((a+1,b-1)\)&lt;/span&gt; çš„è´¡çŒ®ï¼›å…·ä½“åœ°ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f(x+1)-f(x)\ge p\)&lt;/span&gt; åå°±å¾ˆæ˜¾ç„¶äº†ã€‚é‡‡ç”¨åŒæŒ‡é’ˆï¼Œä¼˜å…ˆç§»åŠ¨ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œå°±èƒ½æŠŠæœ€çŸ­åŒºé—´æ‰«ä¸€éã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;å…³äºçº¿æ®µæ ‘ç»´æŠ¤å‡½æ•°&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;ç»´æŠ¤ä¸€ä¸ªå‡½æ•°ï¼Œå½¢å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(f_{[l,r]}(x)\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; åŒºé—´ä¸Šï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„ä¸€ä¸ªæ˜ å°„&lt;/p&gt;
&lt;p&gt;å¦‚æœç›¸é‚»åŒºé—´çš„å‡½æ•°å¯ä»¥ç”¨æŸç§æ–¹å¼åˆå¹¶ï¼Œå°±å¯ä»¥ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤&lt;/p&gt;
&lt;p&gt;æŠŠæ ‘å»ºåœ¨å€¼åŸŸä¸Šï¼Œå°±å¯ä»¥åœ¨èŠ‚ç‚¹å†…æŠŠè¿™æ®µåŒºé—´æ¯ä¸ªç‚¹å¯¹åº”çš„å‡½æ•°å€¼å­˜ä¸‹æ¥ã€‚ä¸€èˆ¬æ¥è¯´æ˜¯é™æ€çš„ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªç±»å‰ç¼€å’Œçš„å½¢å¼ï¼Œæ²¡åŠæ³•ä¿®æ”¹&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªç‚¹çš„ç‚¹å€¼æ•°ç»„ä¼šåœ¨å½“å‰å±‚è¢«æ‰«ä¸€éï¼Œä¸Šä¸€å±‚è¢«æ‰«ä¸€éï¼Œå¦‚æœåˆå¹¶èƒ½å¤Ÿåšåˆ°çº¿æ€§ï¼Œæ€»å¤æ‚åº¦å°±æ˜¯å• &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…æƒ…å½¢ä¸‹å‡½æ•°æœ¬èº«å¯èƒ½å¾ˆéšç§˜ã€å¾ˆæŠ½è±¡ï¼Œæ€ä¹ˆä¼˜åŒ–åˆ°çº¿æ€§åˆå¹¶ä¹Ÿä¸å¤ªå¥½æƒ³&lt;/p&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;compoundsæ¨¡æ„ä¹‰ä¸‹é—®é¢˜&#34;&gt;* COmPoUNdSï¼ˆæ¨¡æ„ä¹‰ä¸‹é—®é¢˜ï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P12389&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P12389&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šå¸¸æ•°æ¨¡æ•°ï¼Œç»´æŠ¤æ¨¡æ„ä¹‰ä¸‹çš„åŒºé—´åŠ ã€åŒºé—´å“ˆå¸Œã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;çº¿æ®µæ ‘å“ˆå¸Œæ˜¯å¯ä»¥ç»´æŠ¤åŒºé—´åŠ çš„&lt;/strong&gt;ï¼Œä½†æ˜¯æ²¡åŠæ³•ç»´æŠ¤åŒºé—´å–æ¨¡&lt;/p&gt;
&lt;p&gt;ç±»ä¼¼ &lt;a href=&#34;/20250816/#e---subarray-sum-divisibility&#34;&gt;ABC419E&lt;/a&gt; é‡Œé¢ç”¨åˆ°çš„ï¼Œæ¨¡æ„ä¹‰ä¸‹åºåˆ—å…¨ç­‰å¯ä»¥è½¬åŒ–æˆå·®åˆ†å…¨ç­‰ï¼ŒåŒºé—´ä¿®æ”¹å°±å¯ä»¥ç®€åŒ–æˆå•ç‚¹ä¿®æ”¹äº†&lt;/p&gt;
&lt;p&gt;é¢å¤–åˆ¤ä¸€ä¸‹å¼€å¤´çš„å…ƒç´ ï¼ˆç»´æŠ¤åŸæ•°ç»„æˆ–è€…æ˜¯å·®åˆ†æ•°ç»„ä¹‹å’Œï¼‰æ˜¯å¦ç›¸ç­‰å°±å¯ä»¥äº†&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;æ”¹è¿›ä»£ç æ¨¡æ„ä¹‰ä¸‹é—®é¢˜&#34;&gt;* æ”¹è¿›ä»£ç ï¼ˆæ¨¡æ„ä¹‰ä¸‹é—®é¢˜ï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4635&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4635&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šåºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt; å’Œå¸¸æ•° &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼Œç»´æŠ¤:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¿®æ”¹ï¼šæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; æ„ä¹‰ä¸‹åŒºé—´åŠ ï¼›&lt;/li&gt;
&lt;li&gt;è¯¢é—®ï¼šåŒºé—´ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=l}^{r-1}[a_i&amp;gt;a_{i+1}]\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^5,p\le 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¯¢é—®ä¹Ÿå’Œæ¨¡æ„ä¹‰å·®åˆ†æœ‰å…³ç³»ï¼Œå‡å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; ä¸ºå½“å‰å·®åˆ†æ•°ç»„å‰ç¼€å’Œæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯åŸæ•°ï¼‰ï¼Œå‘ç°&lt;strong&gt;å‰ä¸€ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;\)&lt;/span&gt; åä¸€ä¸ªæ•°å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; åŠ çˆ†äº†&lt;/strong&gt;ã€‚ç»´æŠ¤åŸæ•°ç»„ç”¨æ¥ç¡®å®š &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„åˆå€¼ã€‚å†ç»´æŠ¤åŒºé—´å†…å·®åˆ†æ•°ç»„ä¹‹å’Œï¼ˆä¸å–æ¨¡ï¼‰ï¼Œ&lt;strong&gt;åœ¨è¿™ä¸ªå’Œé‡Œæœ‰å¤šå°‘ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å°±ä¼šçˆ†å¤šå°‘æ¬¡&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;é»‘ç™½æ ‘å¾ˆæ–°çš„ä¸œè¥¿&#34;&gt;é»‘ç™½æ ‘ï¼ˆå¾ˆæ–°çš„ä¸œè¥¿ï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/problem/46907&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/problem/46907&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä»¥æ¥¼æˆ¿é‡å»ºä¸ºä»£è¡¨çš„-log2-ä¸€ç±»å‰ç¼€ä¿¡æ¯ç»´æŠ¤&#34;&gt;ä»¥æ¥¼æˆ¿é‡å»ºä¸ºä»£è¡¨çš„ &lt;span class=&#34;math inline&#34;&gt;\(\log^2\)&lt;/span&gt; ä¸€ç±»å‰ç¼€ä¿¡æ¯ç»´æŠ¤&lt;/h3&gt;
&lt;p&gt;ç‰¹ç‚¹ï¼špushup æ—¶éœ€è¦å…ˆè·å¾—ä¸€è¾¹çš„ä¿¡æ¯ï¼Œåœ¨å¦ä¸€è¾¹è¿›è¡Œçº¿æ®µæ ‘ä¸ŠäºŒåˆ†ï¼Œå•æ¬¡æ“ä½œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(\log^2)\)&lt;/span&gt; çš„&lt;/p&gt;
&lt;p&gt;æœ¬è´¨æ˜¯ä¸€ç±»å…·æœ‰&lt;strong&gt;å•è°ƒæ€§&lt;/strong&gt;çš„å‰ / åç¼€ä¿¡æ¯ï¼Œ&lt;strong&gt;åŒºé—´å¯¹å…¨å±€çš„è´¡çŒ®&lt;/strong&gt;å’Œ&lt;strong&gt;åŒºé—´å¤–çš„ä¿¡æ¯&lt;/strong&gt;æœ‰å…³ï¼Œæ•…ä¸èƒ½ç›´æ¥ç»´æŠ¤å¯¹å…¨å±€çš„è´¡çŒ®ï¼Œåªèƒ½ç»´æŠ¤åŒºé—´å†…çš„ç­”æ¡ˆã€‚ä½†ç”±äºä¸¤ä¸ªå­åŒºé—´ç­”æ¡ˆå¯ä»¥åˆå¹¶å‡ºå¤§åŒºé—´ç­”æ¡ˆï¼ˆé€šè¿‡çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å¾—åˆ°éœ€è¦çš„ä¿¡æ¯ï¼‰ï¼Œæ‰€ä»¥åªéœ€è¦é€å±‚å‘ä¸Šåˆå¹¶å°±å¯ä»¥å¾—åˆ°å…¨å±€ç­”æ¡ˆ&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªåå­—æ˜¯ã€çº¿æ®µæ ‘ç»´æŠ¤å‰ç¼€ä¿¡æ¯ã€ï¼Œæ„Ÿè§‰ä¸å¾ˆç²¾ç¡®ã€‚log æ–¹çº¿æ®µæ ‘åˆæ˜¯ä»€ä¹ˆé¬¼åå­—ï¼Ÿå…”é˜Ÿçº¿æ®µæ ‘åˆæ˜¯è°èµ·çš„ï¼ˆupdï¼šç–‘ä¼¼çšæœˆåŠæ´’èŠ±ï¼‰ï¼Ÿæ›´å¤šè¿˜æ˜¯å«çš„æ¥¼æˆ¿é‡å»ºçº¿æ®µæ ‘å§&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;æ¥¼æˆ¿é‡å»º&#34;&gt;æ¥¼æˆ¿é‡å»º&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4198&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4198&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å•ç‚¹ä¿®æ”¹ï¼›&lt;/li&gt;
&lt;li&gt;æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{a_i}i\)&lt;/span&gt; çš„å‰ç¼€æœ€å¤§å€¼åºåˆ—é•¿åº¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,q\le 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Fractures è¯´å½“å¹´ï¼ˆåˆä¸€ï¼‰æ˜¯ä»–åŠ›è gm ç»™æˆ‘ä»¬æ‹‰è¿™ä¸ªé¢˜çš„ã€‚dashenaï¼&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¿æ®µæ ‘ç»´æŠ¤å•è°ƒæ ˆï¼Œæˆ–è€…è¯´å‰ç¼€æœ€å€¼ï¼Œç»´æŠ¤æ–¹å¼è¿‡äºç»å…¸ï¼Œä½¿å¾—ã€æ¥¼æˆ¿é‡å»ºã€æˆä¸ºè¯¥ trick ç§°å‘¼ä¹‹ä¸€&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è€ƒè™‘ pushupã€‚ä¿ç•™å·¦è¾¹æ•´æ®µåŒºé—´ï¼Œå¯¹äºå·¦åŒºé—´åºåˆ—æœ«çš„å…ƒç´  &lt;code&gt;l.rv&lt;/code&gt;ï¼Œæˆ‘ä»¬åœ¨å³åŒºé—´å†…æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºä¹‹çš„å…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œä»å®ƒå¼€å§‹çš„åºåˆ—å°±æ˜¯ç­”æ¡ˆã€‚&lt;/p&gt;
åè¯æ³•æ˜“å¾— &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸€å®šåœ¨å³åŒºé—´ç­”æ¡ˆåºåˆ—å†…ï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸åœ¨ç­”æ¡ˆåºåˆ—å†…ï¼Œåˆ™å³åŒºé—´å†…å­˜åœ¨ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;x\)&lt;/span&gt; ä¸”ä½äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¹‹å‰çš„å…ƒç´ ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å°±ä¸æ˜¯ç¬¬ä¸€ä¸ª &lt;code&gt;&amp;gt; l.rv&lt;/code&gt; çš„å…ƒç´ ï¼ŒçŸ›ç›¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…åœ¨å³åŒºé—´ä¸­äºŒåˆ†èƒ½å¤Ÿæ¥ä¸Šå»çš„åŒºé—´é•¿åº¦ï¼ŒåŠ èµ·æ¥å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;é¢˜ç›®åªè¦æ±‚æ€»åŒºé—´ç­”æ¡ˆï¼Œæ•…ä¸éœ€è¦æŸ¥è¯¢ã€‚åŠ¨æ€å¼€ç‚¹å¯èƒ½éœ€è¦å°å¿ƒå¤„ç†ä¸€ä¸‹ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e5 + 5;
struct &amp;#123;
    int l, r, u;
    double lv, rv, mv;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
int tot;
#define lt t[p].l
#define rt t[p].r
int askt(int p, int l, int r, double v) &amp;#123;
    if (l == r)
        return t[p].u;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (lt &amp;amp;&amp;amp; t[p].mv &amp;gt; v)
        return t[p].u - t[lt].u + askt(lt, l, mid, v);
    return askt(rt, mid + 1, r, v);
&amp;#125;
void pushup(int p, int l, int r) &amp;#123;
    t[p].mv = t[lt].rv;
    if (lt &amp;amp;&amp;amp; rt) &amp;#123;
        t[p].lv = t[lt].lv;
        t[p].rv = std::max(t[lt].rv, t[rt].rv);
        if (t[lt].rv &amp;lt; t[rt].lv)
            t[p].u = t[lt].u + t[rt].u;
        else if (t[lt].rv &amp;gt;= t[rt].rv)
            t[p].u = t[lt].u;
        else &amp;#123;
            int mid = (l + r) &amp;gt;&amp;gt; 1;
            t[p].u = t[lt].u + askt(rt, mid + 1, r, t[lt].rv);
        &amp;#125;
    &amp;#125;
    else &amp;#123;
        t[p].u = t[lt + rt].u;
        t[p].lv = t[lt + rt].lv, t[p].rv = t[lt + rt].rv;
    &amp;#125;
    return;
&amp;#125;
void upd(int &amp;amp;p, int l, int r, int x, double v) &amp;#123;
    if (!p)
        p = ++tot;
    if (l == r) &amp;#123;
        t[p].lv = t[p].rv = v, t[p].u = 1;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, l, mid, x, v);
    else
        upd(rt, mid + 1, r, x, v);
    pushup(p, l, r);
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;P4198_2.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m, rt = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;double&amp;gt; a(n + 1);
    for (int x; m--; ) &amp;#123;
        double y;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        a[x] = y / x;
        upd(rt, 1, n, x, y / x);
        std::cout &amp;lt;&amp;lt; t[1].u &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;äºŒå‰æœç´¢æ ‘&#34;&gt;äºŒå‰æœç´¢æ ‘&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://pjudge.ac/problem/21889&#34; class=&#34;uri&#34;&gt;https://pjudge.ac/problem/21889&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªå¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ ‘ï¼Œæ ‘ä¸Šæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª BSTï¼Œä½ éœ€è¦ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡æ“ä½œï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;å¯¹äºæ ‘ä¸Šçš„ä¸€æ¡è·¯å¾„ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt;ï¼Œåœ¨ç»è¿‡çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„ BST æ’å…¥ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œä¿è¯ä»»æ„æ—¶åˆ» BST ä¸­æ— ç›¸åŒå€¼&lt;/li&gt;
&lt;li&gt;åœ¨ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æŸ¥æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å­˜åœ¨åˆ™è¿”å›å…¶åˆ° BST æ ¹çš„å…ƒç´ å’Œï¼Œå¦åˆ™è¿”å›æŸ¥æ‰¾æ—¶æœ€è¿œèµ°åˆ°çš„é‚£ä¸ªç‚¹ï¼Œåˆ° BST æ ¹çš„å…ƒç´ å’Œã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,q\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘é“¾ä¸Šé—®é¢˜ã€‚å·®åˆ†ï¼ŒæŠŠæ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; çœ‹ä½œåœ¨å·®åˆ†æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å¤„æ’å…¥ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(r+1\)&lt;/span&gt; å¤„åˆ é™¤ï¼Œç¦»çº¿ä¸‹æ¥å†ä»å·¦åˆ°å³æ‰«ä¸€éæ“ä½œå°±èƒ½æ›´æ–°ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘æŸ¥è¯¢ã€‚&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ ‘ä¸Šå­˜åœ¨è¿‡çš„æ‰€æœ‰å…ƒç´ æ˜¯å·²çŸ¥çš„ï¼Œè€ƒè™‘å¦‚ä½•åŸºäºæ­¤è·å– &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ ‘ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(t_0\)&lt;/span&gt; æ—¶åˆ»ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„æ‰€æœ‰ç¥–å…ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äºæ¯” &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å¤§çš„å…ƒç´ ï¼Œè€ƒè™‘ç¥–å…ˆ &lt;span class=&#34;math inline&#34;&gt;\(p_a\)&lt;/span&gt; å’Œéç¥–å…ˆ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; çš„åŒºåˆ«ï¼š&lt;/p&gt;
&lt;p&gt;æ ¹æ® BST çš„æ€§è´¨æ˜“å¾—ï¼Œå¯¹äºæœ€ä½çš„å³ä¾§ç¥–å…ˆ &lt;span class=&#34;math inline&#34;&gt;\({p_a}_0\)&lt;/span&gt;ï¼Œå…¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\ge x\)&lt;/span&gt; çš„æœ€å°çš„å…ƒç´ ï¼ˆåŠ å…¥æ—¶åˆ» &lt;span class=&#34;math inline&#34;&gt;\(t_a&amp;lt;t_0\)&lt;/span&gt;ï¼‰ï¼›&lt;/p&gt;
åŒç†å¯ä»¥æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\({p_a}_0\)&lt;/span&gt; å³ä¾§æœ€ä½çš„ç¥–å…ˆï¼ˆå…¶å·¦ä¾§çš„ç¥–å…ˆæ˜¾ç„¶ä¹Ÿåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å·¦ä¾§ï¼‰ï¼Œè¯¥ç¥–å…ˆæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(t&amp;lt;t_a\)&lt;/span&gt;ã€‚ä»å·¦å³ä¸¤è¾¹åˆ†åˆ«å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„æ‰€æœ‰ç¥–å…ˆã€‚å®¹æ˜“è¯æ˜è¯¥è¿‡ç¨‹å¯¹äºä¸åœ¨æ ‘ä¸Šçš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚&lt;/li&gt;
&lt;li&gt;å…·ä½“åœ°ï¼Œéœ€è¦èƒ½å¤Ÿæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(\ge x\)&lt;/span&gt; çš„å…ƒç´ ä¸­ï¼Œä»¥ &lt;span class=&#34;math inline&#34;&gt;\(t_0\)&lt;/span&gt; ä¸ºèµ·ç‚¹çš„å‰ç¼€æœ€å°å€¼åºåˆ—çš„åŒºé—´å’Œã€‚çº¿æ®µæ ‘ç»´æŠ¤å•è°ƒæ ˆå®¹æ˜“è§£å†³ä¸å¸¦ &lt;span class=&#34;math inline&#34;&gt;\(t_0\)&lt;/span&gt; é™åˆ¶çš„ç­”æ¡ˆï¼›å†æ¬¡åˆ©ç”¨æ€§è´¨å°±èƒ½æ»¡è¶³é™åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äºæ ‘çš„æƒ…å†µï¼ŒæŠŠå·®åˆ†æ”¾åˆ°æ ‘ä¸Šï¼Œçº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int lim = 2e5;
const int maxn = 2e7 + 5;
const int inf = 0x3f3f3f3f;
struct &amp;#123;
    int l, r, rv;
    long long u;
&amp;#125; t[maxn];
std::vector&amp;lt;int&amp;gt; tr;
#define lt t[p].l
#define rt t[p].r
int newnode(void) &amp;#123;
    static int tot = 0;
    if (tr.empty())
        return ++tot;
    auto p(tr.back());
    t[p].l = t[p].r = 0;
    tr.pop_back();
    return p;
&amp;#125;
long long askv(int p, int l, int r, int v) &amp;#123;
    if (l == r)
        return t[p].rv &amp;lt; v ? t[p].u : 0;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (v &amp;gt; t[lt].rv)
        return t[p].u - t[lt].u + askv(lt, l, mid, v);
    return askv(rt, mid + 1, r, v);
&amp;#125;
void pushup(int p, int l, int r) &amp;#123;
    t[p].rv = std::min(t[lt].rv, t[rt].rv);
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    t[p].u = t[lt].u + askv(rt, mid + 1, r, t[lt].rv);
    return;
&amp;#125;
void upd(int &amp;amp;p, int l, int r, int x, int v, int u) &amp;#123;
    if (!p)
        p = newnode();
    if (l == r) &amp;#123;
        t[p].rv = v, t[p].u = u;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, l, mid, x, v, u);
    else
        upd(rt, mid + 1, r, x, v, u);
    pushup(p, l, r);
    return;
&amp;#125;
void merge(int &amp;amp;p, int q, int l, int r) &amp;#123;
    if (!p || !q) &amp;#123;
        p += q;
        return;
    &amp;#125;
    if (l == r) &amp;#123;
        t[p].rv = std::min(t[p].rv, t[q].rv);
        t[p].u = std::max(t[p].u, t[q].u);
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    merge(t[p].l, t[q].l, l, mid), merge(t[p].r, t[q].r, mid + 1, r);
    pushup(p, l, r), tr.push_back(q);
    return;
&amp;#125;
int qv = inf;
long long ask(int p, int l, int r, int ql, int qr) &amp;#123;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr) &amp;#123;
        auto s(askv(p, l, r, qv));
        qv = std::min(qv, t[p].rv);
        return s;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    long long res = 0ll;
    if (ql &amp;lt;= mid)
        res = ask(lt, l, mid, ql, qr);
    if (qr &amp;gt; mid)
        res += ask(rt, mid + 1, r, ql, qr);
    return res;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;ex_problem4.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; top(n + 1), fa(n + 1), siz(n + 1), son(n + 1), dep(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int faa) &amp;#123;
        siz[x] = 1;
        for (auto i : g[x])
            if (i != faa) &amp;#123;
                fa[i] = x, dep[i] = dep[x] + 1;
                DFS(i, x), siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    DFS = [&amp;amp;](int x, int topp) &amp;#123;
        top[x] = topp;
        if (son[x])
            DFS(son[x], topp);
        for (auto i : g[x])
            if (i != fa[x] &amp;amp;&amp;amp; i != son[x])
                DFS(i, i);
        return;
    &amp;#125;;
    DFS(1, 1);
    auto getLCA = [&amp;amp;](int x, int y) &amp;#123;
        for (; top[x] != top[y]; x = fa[top[x]])
            if (dep[top[y]] &amp;gt; dep[top[x]])
                std::swap(x, y);
        return (dep[x] &amp;lt; dep[y] ? x : y);
    &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; d(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; u(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::tuple&amp;lt;int, int, int&amp;gt; &amp;gt; &amp;gt; q(n + 1);
    int cnt = 0;
    for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
        int op;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 0) &amp;#123;
            int x, v;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; v;
            q[x].emplace_back(++cnt, i, v);
        &amp;#125; else &amp;#123;
            int x, y, v;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; v;
            int faa = getLCA(x, y);
            u[x].emplace_back(i, v), u[y].emplace_back(i, v);
            if (fa[faa])
                d[fa[faa]].emplace_back(v);
        &amp;#125;
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; res(cnt + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; rt(2, std::vector&amp;lt;int&amp;gt; (n + 1));
    t[0].rv = inf;
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                merge(rt[0][x], rt[0][i], 1, lim);
                merge(rt[1][x], rt[1][i], 1, lim);
            &amp;#125;
        for (auto [t, v] : u[x]) &amp;#123;
            upd(rt[0][x], 1, lim, v, t, v);
            upd(rt[1][x], 1, lim, lim - v + 1, t, v);
        &amp;#125;
        for (auto v : d[x]) &amp;#123;
            upd(rt[0][x], 1, lim, v, inf, 0);
            upd(rt[1][x], 1, lim, lim - v + 1, inf, 0);
        &amp;#125;
        for (auto [id, t, v] : q[x]) &amp;#123;
            qv = t, res[id] = ask(rt[0][x], 1, lim, v, lim);
            qv = t, res[id] += ask(rt[1][x], 1, lim, lim - v + 1, lim);
            qv = t, res[id] -= ask(rt[0][x], 1, lim, v, v);
        &amp;#125;
    &amp;#125;;
    DFS(1, -1);
    for (int i = 1; i &amp;lt;= cnt; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;nastya-and-cbs&#34;&gt;Nastya and CBS&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1340F&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1340F&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ‹¬å·åºåˆ—ï¼Œç”± &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ç§æ‹¬å·å¯¹ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(-i,i\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç§å·¦ã€å³æ‹¬å·ï¼‰ç»„æˆï¼Œä½ éœ€è¦ç»´æŠ¤å•ç‚¹ä¿®æ”¹å…ƒç´ ã€åŒºé—´æŸ¥è¯¢æ˜¯å¦ä¸ºåˆæ³•æ‹¬å·åºåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(1\le k\le n\le 10^5,q\le 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘ä¸å¸¦ä¿®ä¸”å…è®¸ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; è¯¢é—®çš„æƒ…æ™¯ï¼Œç»å…¸é¢˜ï¼Œæ‰«ä¸€éï¼Œç”¨æ ˆç»´æŠ¤å³å¯ï¼›&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(k=1\)&lt;/span&gt; æ—¶æ˜¯çº¿æ®µæ ‘ç»å…¸é¢˜ï¼Œå¯ä»¥ç±»æ¯”è¿™ä¸ªç»å…¸é¢˜ï¼Œä»åˆ»ç”»åˆæ³•çš„æ¡ä»¶å…¥æ‰‹ã€‚&lt;/p&gt;
å¦‚æœå­˜åœ¨ç›¸é‚»ä¸”å¯ä»¥åŒ¹é…çš„å¯ä»¥ç›´æ¥æ¶ˆæ‰ï¼Œä¸€ç›´é‡å¤è¿™æ ·çš„æ“ä½œï¼Œæ­¤æ—¶è¦ä¹ˆåŒ…å«ä¸èƒ½åŒ¹é…çš„å­ä¸²ï¼Œå¦‚ &lt;code&gt;&amp;#123;[)&amp;#125;&lt;/code&gt;ï¼Œè¦ä¹ˆæ˜¯ &lt;code&gt;)]&amp;#125; (&amp;#123;[&amp;#123;&amp;#123;&lt;/code&gt; çš„å½¢å¼ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘æ€ä¹ˆ pushupï¼Œå‘ç°ä¸­é—´ç”Ÿæˆçš„ä¸€æ®µ &lt;code&gt;([()])&lt;/code&gt; å¿…é¡»å®Œå…¨åŒ¹é…ï¼Œæ¶ˆæ‰å®ƒä»¬ä¹‹åï¼Œå¤§åŒºé—´åˆå˜æˆ &lt;code&gt;)]&amp;#125; (&amp;#123;[&amp;#123;&amp;#123;&lt;/code&gt; çš„å½¢å¼ã€‚&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡ pushup è¦åˆå¹¶çš„åŒºé—´å¾ˆé•¿ï¼Œè€ƒè™‘æ€ä¹ˆå¿«é€Ÿåœ°åšã€æ¶ˆé™¤ç›¸é‚»åŒ¹é…æ‹¬å·ã€è¿™ä¸€æ­¥ã€‚å®¹æ˜“æƒ³åˆ°è®°å½•ä¸€æ®µæ‹¬å·ï¼ˆä¾‹ï¼š&lt;code&gt;([&amp;#123;&lt;/code&gt;ï¼‰åŠå…¶å¯¹åº”åæ‹¬å·ï¼ˆä¾‹ï¼š&lt;code&gt;&amp;#125;])&lt;/code&gt;ï¼‰çš„å“ˆå¸Œå€¼ï¼Œcheck æ˜¯å¦ç›¸ç­‰ï¼Œç„¶åå°±å¯ä»¥ä¸ç®¡å®ƒä»¬äº†ï¼Œå¹¶ä¸æ˜¯çœŸçš„è¦åˆ å»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;çº¿æ®µæ ‘ä¸èƒ½ç»´æŠ¤æ¯ä¸ªå‰åç¼€çš„å“ˆå¸Œå€¼ï¼Œä½†éœ€è¦çš„åªæ˜¯åœ¨&lt;strong&gt;åˆ é™¤è¿ç»­åŒ¹é…æ‹¬å·å&lt;/strong&gt;é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; çš„å“ˆå¸Œå€¼ï¼Œå¯ä»¥çº¿æ®µæ ‘ä¸ŠäºŒåˆ†ã€‚&lt;/p&gt;
è¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹å›°éš¾ï¼Œéœ€è¦åœ¨è¯¢é—®çš„åŒæ—¶åŒ¹é…ã€æ¶ˆé™¤ï¼›ä½†å‘ç°æ‰€è°“æ¶ˆé™¤å°±æ˜¯å¯¹ä½ç›¸å‡ï¼Œæ³¨æ„ä¸€ä¸‹ä»€ä¹ˆæ—¶å€™ç§»ä½ï¼Œè¿˜æ˜¯å¥½å†™çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¯¢é—®çœ‹ä¼¼ä¸å¤ªå¯åšï¼Œå› ä¸ºä¸­é€”çš„ç­”æ¡ˆä¸æ˜¯çº¿æ®µæ ‘çš„èŠ‚ç‚¹ï¼›å¦‚æœæŠŠè¯¢é—®çœ‹æˆä¸€æ¬¡ä¿®æ”¹ï¼Œå°±å¯ä»¥ç”¨ç±»ä¼¼å¯æŒä¹…åŒ–çš„æ–¹å¼å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºå¹¶ä¸æ˜¯çœŸçš„è¦å¯æŒä¹…åŒ–ï¼Œè¯¢é—®æ–°å»ºçš„ç‚¹å¯ä»¥é‡å¤åˆ©ç”¨ã€‚å¦‚æœä¸é‡å¤åˆ©ç”¨ï¼Œæ¯æ¬¡è¯¢é—®æœ€å¤šæ–°å»º &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt; ä¸ªç‚¹ï¼Œç©ºé—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(q\log n)\)&lt;/span&gt;ï¼Œåœ¨ CF ä¸Šæœ‰ç‚¹å¡ï¼Œä¹Ÿæ˜¯èƒ½è¿‡çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;p&gt;Hintï¼šæœ‰å¡ 998244353 çš„ Hackï¼Œæ•…å¯ä»¥ç”¨ 1e9 + 7 å½“æ¨¡æ•°ï¼›WA on 7 æ˜¯æ­£ç¡®æ€§æœ‰å·¨å¤§é—®é¢˜ï¼ŒWA on 8 å¯èƒ½æ˜¯ long long æ²¡å¼€å®Œ / æ•°ç»„å¼€å°äº† / å“ˆå¸Œæ–¹å‘æœ‰é—®é¢˜ / çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å†™æŒ‚äº†ï¼ˆé€šå¸¸æ˜¯æ¶ˆæ‹¬å·æ¶ˆé”™äº†ï¼‰ã€‚å‰äººè¸©å‘åäººå˜²ç¬‘ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
const int base = 1e5 + 3;
const int maxn = 7e5 + 5;
struct Node &amp;#123;
    bool flag;
    long long hr0, hl1;
    int l, r, lc, rc, ll, rl;
    Node&amp;amp; operator= (const Node &amp;amp;q) &amp;#123;
        flag = q.flag, hr0 = q.hr0, hl1 = q.hl1;
        l = q.l, r = q.r, ll = q.ll, rl = q.rl;
        return *this;
    &amp;#125;
    Node operator+ (const Node &amp;amp;q) const;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
int tot;
int a[maxn];
long long bpow[maxn], inv[maxn];
long long askhl1(const Node &amp;amp;p, int k) &amp;#123;
    if (k == 0)
        return 0ll;
    if (k &amp;gt; p.ll)
        return -1ll;
    if (p.ll == k)
        return p.hl1;
    int ll = t[p.lc].ll, rl = t[p.lc].rl;
    if (ll &amp;gt;= k)
        return askhl1(t[p.lc], k);
    k -= ll, k += rl;
    auto hl1 = askhl1(t[p.rc], k);
    hl1 = ((hl1 + mod - t[p.lc].hr0) * inv[rl] % mod * bpow[ll] % mod + t[p.lc].hl1) % mod;
    return hl1;
&amp;#125;
long long askhr0(const Node &amp;amp;p, int k) &amp;#123;
    if (k == 0)
        return 0ll;
    if (k &amp;gt; p.rl)
        return -1ll;
    if (p.rl == k)
        return p.hr0;
    int rl = t[p.rc].rl, ll = t[p.rc].ll;
    if (rl &amp;gt;= k)
        return askhr0(t[p.rc], k);
    k -= rl, k += ll;
    auto hr0 = askhr0(t[p.lc], k);
    hr0 = ((hr0 + mod - t[p.rc].hl1) * inv[ll] % mod * bpow[rl] % mod + t[p.rc].hr0) % mod;
    return hr0;
&amp;#125;
Node Node::operator+ (const Node &amp;amp;q) const  &amp;#123;
    Node res;
    res.l = l, res.r = q.r;
    if (flag || q.flag)
        res.flag = 1;
    else &amp;#123;
        if (rl == q.ll) &amp;#123;
            if (hr0 == q.hl1) &amp;#123;
                res.flag = 0;
                res.ll = ll, res.rl = q.rl;
                res.hl1 = hl1, res.hr0 = q.hr0;
            &amp;#125;
            else
                res.flag = 1;
        &amp;#125;
        else if (rl &amp;lt; q.ll) &amp;#123;
            auto qhl1 = askhl1(q, rl);
            if (hr0 == qhl1) &amp;#123;
                res.flag = 0;
                res.ll = ll + q.ll - rl, res.rl = q.rl;
                res.hl1 = ((q.hl1 + mod - qhl1) % mod * inv[rl] % mod * bpow[ll] % mod + hl1) % mod;
                res.hr0 = q.hr0;
            &amp;#125;
            else
                res.flag = 1;
        &amp;#125;
        else &amp;#123;
            auto phr0 = askhr0(*this, q.ll);
            if (phr0 == q.hl1) &amp;#123;
                res.flag = 0;
                res.ll = ll, res.rl = rl - q.ll + q.rl;
                res.hl1 = hl1;
                res.hr0 = ((hr0 + mod - phr0) % mod * inv[q.ll] % mod * bpow[q.rl] % mod + q.hr0) % mod;
            &amp;#125;
            else
                res.flag = 1;
        &amp;#125;
    &amp;#125;
    return res;
&amp;#125;
void bld(int &amp;amp;p, int l, int r) &amp;#123;
    p = ++tot;
    if (l == r) &amp;#123;
        t[p].l = t[p].r = l;
        if (a[l] &amp;lt; 0)
            t[p].ll = 1, t[p].hl1 = -a[l];
        else
            t[p].rl = 1, t[p].hr0 = a[l];
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(t[p].lc, l, mid), bld(t[p].rc, mid + 1, r);
    t[p] = t[t[p].lc] + t[t[p].rc];
    return;
&amp;#125;
void add(int p, int x, int v) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        if (v &amp;lt; 0) &amp;#123;
            t[p].rl = 0, t[p].hr0 = 0ll;
            t[p].ll = 1, t[p].hl1 = -v;
        &amp;#125;
        else &amp;#123;
            t[p].ll = 0, t[p].hl1 = 0ll;
            t[p].rl = 1, t[p].hr0 = v;
        &amp;#125;
        return;
    &amp;#125;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(t[p].lc, x, v);
    else
        add(t[p].rc, x, v);
    t[p] = t[t[p].lc] + t[t[p].rc];
    return;
&amp;#125;
int ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return p;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;lt;= mid)
        return ask(t[p].lc, l, r);
    if (l &amp;gt; mid)
        return ask(t[p].rc, l, r);
    int q = ++tot;
    t[q].lc = ask(t[p].lc, l, r);
    t[q].rc = ask(t[p].rc, l, r);
    t[q] = t[t[q].lc] + t[t[q].rc];
    return q;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, k, rt = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    bpow[0] = inv[0] = 1ll;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[1] = qkp(base, mod - 2);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        bpow[i] = bpow[i - 1] * base % mod;
        if (i &amp;gt;= 2)
            inv[i] = inv[i - 1] * inv[1] % mod;
    &amp;#125;
    bld(rt, 1, n);
    int q;
    std::cin &amp;gt;&amp;gt; q;
    for (int op; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            int x, v;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; v;
            add(1, x, v);
        &amp;#125;
        else &amp;#123;
            int l, r;
            std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
            if ((r - l + 1) &amp;amp; 1)
                std::cout &amp;lt;&amp;lt; &amp;quot;No&amp;quot; &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            else &amp;#123;
                auto s(ask(1, l, r));
                std::cout &amp;lt;&amp;lt; ((!t[s].flag &amp;amp;&amp;amp; !t[s].ll &amp;amp;&amp;amp; !t[s].rl) ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            &amp;#125;
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;hungry-cow-p&#34;&gt;# Hungry Cow P&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9130&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9130&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;ç‰›åŠä»™çš„å¦¹å­åºåˆ—&#34;&gt;# ç‰›åŠä»™çš„å¦¹å­åºåˆ—&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/problem/29550&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/problem/29550&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;organizing-a-race&#34;&gt;# Organizing a Race&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF671E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF671E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªé¢˜ä¸å¤ªåº”è¯¥æ”¾åœ¨è¿™é‡Œçš„ï¼Œå› ä¸ºå­˜åœ¨åªç”¨ä¸€åª log çš„çº¯çº¿æ®µæ ‘ä¸ŠäºŒåˆ†åšæ³•ï¼Œç”¨æ¥¼æˆ¿é‡å»ºæ˜¾å¾—æœ‰ç‚¹å”äº†&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;è½¬ç›˜&#34;&gt;# è½¬ç›˜&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4425&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4425&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;å‰è¿›å››æ¥¼æˆ¿é‡å»º-ver&#34;&gt;# å‰è¿›å››ï¼ˆæ¥¼æˆ¿é‡å»º verï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://uoj.ac/problem/515&#34; class=&#34;uri&#34;&gt;https://uoj.ac/problem/515&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦è§ &lt;a href=&#34;#-å‰è¿›å››segment-tree-beats-ver&#34;&gt;segment tree beats ver&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;å¯æŒä¹…åŒ–çº¿æ®µæ ‘&#34;&gt;å¯æŒä¹…åŒ–çº¿æ®µæ ‘&lt;/h3&gt;
&lt;h4 id=&#34;card-game&#34;&gt;# Card Game&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://qoj.ac/problem/8240&#34; class=&#34;uri&#34;&gt;https://qoj.ac/problem/8240&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;å†å²ä¿¡æ¯&#34;&gt;å†å²ä¿¡æ¯&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ç±»å½¢å¦‚ã€è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; å†…åˆæ³•å­åŒºé—´æ•°é‡ã€çš„é¢˜ç›®æ˜¯å¯ä»¥è€ƒè™‘å†å²ä¿¡æ¯çš„&lt;/li&gt;
&lt;li&gt;å…·ä½“åœ°ï¼Œæ‰«æçº¿ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼ŒæŠŠåˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; ç­”æ¡ˆåŠ ä¸€&lt;/li&gt;
&lt;li&gt;åœ¨æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¤„æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; çš„åŒºé—´å’Œå°±å¯ä»¥å¾—å‡ºç­”æ¡ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;é“ƒåŸéœ²éœ²&#34;&gt;é“ƒåŸéœ²éœ²&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P8528&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P8528&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¢˜ç›®å½¢å¼æ»¡è¶³æ ‘ä¸Šæ”¯é…å¯¹ï¼Œè€ƒè™‘å¯»æ‰¾æ”¯é…å…³ç³»&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å›ºå®šä¸€ä¸ª LCA &lt;span class=&#34;math inline&#34;&gt;\(z\)&lt;/span&gt;ï¼Œè®¨è®º &lt;span class=&#34;math inline&#34;&gt;\(a_z\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(a_x,a_y\)&lt;/span&gt; çš„å¤§å°å…³ç³»ç»™ &lt;span class=&#34;math inline&#34;&gt;\([1,a_x]\)&lt;/span&gt; é—´çš„ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å¸¦æ¥çš„é™åˆ¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_z\in[a_x,a_y]\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((x,y)\)&lt;/span&gt; æ€»æ˜¯åˆæ³•ï¼Œæ— é™åˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_z&amp;lt;a_x\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(r\ge a_y\)&lt;/span&gt;ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(l\in(a_z,a_x]\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((x,y)\)&lt;/span&gt; éæ³•ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_z&amp;gt;a_y\)&lt;/span&gt;ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(r\in[a_y,a_z)\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((x,y)\)&lt;/span&gt; æ€»æ˜¯éæ³•ã€‚æ­¤æ—¶æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(l\in[1,a_x]\)&lt;/span&gt; ä¸å¯é€‰ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;å‘ç°å›ºå®š &lt;span class=&#34;math inline&#34;&gt;\(a_z,a_x\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå½“ &lt;span class=&#34;math inline&#34;&gt;\(a_y\)&lt;/span&gt; è¶Šé è¿‘ &lt;span class=&#34;math inline&#34;&gt;\(a_x\)&lt;/span&gt; æ—¶ç»™å‡ºçš„é™åˆ¶è¶Šç´§ï¼Œåä¹‹äº¦ç„¶ï¼Œå°±å¯ä»¥å¾—åˆ°è¿™æ ·çš„æ”¯é…å…³ç³»&lt;/li&gt;
&lt;li&gt;å®¹æ˜“å‘ç°å½“ &lt;span class=&#34;math inline&#34;&gt;\(a_z\notin [a_x,a_y]\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((x,y)\)&lt;/span&gt; ä¸åˆæ³•ï¼›æ•…åªéœ€è¦åœ¨ dsu on tree ä¸Šæ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(a_x\)&lt;/span&gt; çš„å‰é©±ã€åç»§å¹¶ç»Ÿè®¡æ”¯é…å¯¹å³å¯&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è€ƒè™‘è¯¢é—®ï¼Œå‘ç°éœ€è¦ç»´æŠ¤åŒºé—´åŠ ã€åŒºé—´å†å² 0 ä¸ªæ•°ï¼Œæ˜¯å¥½åšçš„ï¼ˆè¿™é‡Œçš„åŒºé—´åŠ å¹¶ä¸å¯¹åº” summary ä¸­æåˆ°çš„åŒºé—´åŠ ï¼›å¯¹ 0 çš„æ›´æ–°æ‰æ˜¯ï¼‰ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å†å²æ ‡è®°çš„ä¸‹ä¼ éœ€è¦æ ¼å¤–æ³¨æ„ä¸€ä¸‹ï¼Œåº”è¯¥åªä¿è¯æ ‡è®°æœŸé—´å­˜åœ¨ 0 çš„åŒºé—´æ‹¥æœ‰æ‡’æ ‡è®°ï¼›å…·ä½“åœ°ï¼Œ&lt;strong&gt;åªåº”å°†å…¶ä¸‹ä¼ åˆ°å’Œå½“å‰åŒºé—´æœ€å°å€¼ç›¸åŒçš„å­åŒºé—´&lt;/strong&gt;ï¼ˆå…·ä½“å¯ä»¥çœ‹ä»£ç ï¼‰ï¼Œå®¹æ˜“è¯æ˜æ˜¯å¯¹çš„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
struct node &amp;#123;
    long long s;
    int l, r, u, c, d, d1;
    node operator+ (const node q) const &amp;#123;
        node res;
        res.s = s + q.s;
        res.l = l, res.r = q.r;
        res.u = std::min(u, q.u);
        res.d = res.d1 = res.c = 0;
        if (u == res.u)
            res.c = c;
        if (q.u == res.u)
            res.c += q.c;
        return res;
    &amp;#125;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].c = r - l + 1;
    t[p].l = l, t[p].r = r;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d += t[p].d, t[lt].u += t[p].d;
        t[rt].d += t[p].d, t[rt].u += t[p].d;
        t[p].d = 0;
    &amp;#125;
    if (t[p].d1) &amp;#123;
        if (t[lt].u == t[p].u) &amp;#123;
            t[lt].s += (long long)t[lt].c * t[p].d1;
            t[lt].d1 += t[p].d1;
        &amp;#125;
        if (t[rt].u == t[p].u) &amp;#123;
            t[rt].s += (long long)t[rt].c * t[p].d1;
            t[rt].d1 += t[p].d1;
        &amp;#125;
        t[p].d1 = 0;
    &amp;#125;
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        t[p].d += v, t[p].u += v;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    t[p] = t[lt] + t[rt];
    return;
&amp;#125;
void upd(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        if (!t[p].u)
            t[p].s += t[p].c, ++t[p].d1;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        upd(lt, l, r);
    if (r &amp;gt; mid)
        upd(rt, l, r);
    t[p] = t[lt] + t[rt];
    return;
&amp;#125;
long long ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].s;
    pushdown(p);
    auto res(0ll);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        res = ask(lt, l, r);
    if (r &amp;gt; mid)
        res += ask(rt, l, r);
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1); 
    for (int i = 2, x; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; x, g[x].push_back(i);
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g[x]) &amp;#123;
            DFS(i);
            siz[x] += siz[i];
            if (siz[i] &amp;gt; siz[son[x]])
                son[x] = i;
        &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; u1(n + 1), u2(n + 1);
    std::function&amp;lt;void(int, int, std::set&amp;lt;int&amp;gt; &amp;amp;)&amp;gt; DFS2 = [&amp;amp;](int col, int x, std::set&amp;lt;int&amp;gt; &amp;amp;t) &amp;#123;
        auto p = t.lower_bound(a[x]);
        if (col == -1)
            t.insert(a[x]);
        else &amp;#123;
            if (p != t.begin()) &amp;#123;
                int y = *std::prev(p);
                if (col &amp;lt; y)
                    u1[a[x]].emplace_back(col + 1, y);
                else if (col &amp;gt; a[x]) &amp;#123;
                    u1[a[x]].emplace_back(1, y);
                    u2[col].emplace_back(1, y);
                &amp;#125;
            &amp;#125;
            if (p != t.end()) &amp;#123;
                int y = *p;
                if (col &amp;lt; a[x])
                    u1[y].emplace_back(col + 1, a[x]);
                else if (col &amp;gt; y) &amp;#123;
                    u1[y].emplace_back(1, a[x]);
                    u2[col].emplace_back(1, a[x]);
                &amp;#125;
            &amp;#125;
        &amp;#125;
        for (auto i : g[x])
            DFS2(col, i, t);
        return;
    &amp;#125;;
    std::function&amp;lt;void(int, std::set&amp;lt;int&amp;gt; &amp;amp;)&amp;gt; DFS1 = [&amp;amp;](int x, std::set&amp;lt;int&amp;gt; &amp;amp;t) &amp;#123;
        if (son[x])
            DFS1(son[x], t);
        for (auto i : g[x])
            if (i != son[x]) &amp;#123;
                std::set&amp;lt;int&amp;gt; nt;
                DFS1(i, nt);
            &amp;#125;
        t.insert(a[x]);
        for (auto i : g[x])
            if (i != son[x])
                DFS2(a[x], i, t), DFS2(-1, i, t);
        return;
    &amp;#125;;
    &amp;#123;
        std::set&amp;lt;int&amp;gt; t;
        DFS1(1, t);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; res(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; t(n + 1);
    for (int i = 1, l, r; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        t[r].emplace_back(l, i);
    &amp;#125;
    bld(1, 1, n);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (auto [l, r] : u1[i])
            add(1, l, r, 1);
        for (auto [l, r] : u2[i])
            add(1, l, r, -1);
        upd(1, 1, i);
        for (auto [l, id] : t[i])
            res[id] = ask(1, l, i);
    &amp;#125;
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;prof.-pangs-sequence-test_90&#34;&gt;Prof.Â Pangâ€™s sequence / TEST_90&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P10822&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P10822&lt;/a&gt; / &lt;a href=&#34;https://www.luogu.com.cn/problem/P9990&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9990&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¦»çº¿æ‰«æçº¿ï¼Œå¯¹äºå½“å‰å³ç«¯ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œè®°å½•æ¯ç§æ•°æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(pos\)&lt;/span&gt;ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„é¢œè‰²ä¸º &lt;code&gt;1&lt;/code&gt;ï¼Œä»å³åˆ°å·¦ï¼Œæ¯ç¢°åˆ°ä¸€ä¸ªæ–°çš„ &lt;span class=&#34;math inline&#34;&gt;\(pos\)&lt;/span&gt; å°±åˆ‡æ¢é¢œè‰²ã€‚&lt;/li&gt;
&lt;li&gt;æ˜¾ç„¶å¯¹äºå½“å‰ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œåº”è¯¥è¢«åŠ ä¸€çš„ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å°±æ˜¯é¢œè‰²ä¸º &lt;code&gt;1&lt;/code&gt; çš„è¿™äº›ä½ç½®ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘æ›´å¿«åœ°ç»´æŠ¤è¿™ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„é¢œè‰²å’Œ &lt;span class=&#34;math inline&#34;&gt;\(r-1\)&lt;/span&gt; ä¸åŒæ—¶å°±å¯ä»¥å¯¹ &lt;span class=&#34;math inline&#34;&gt;\([1,r)\)&lt;/span&gt; åšä¸€æ¬¡ flipï¼Œæ˜¯å¯è¡Œçš„&lt;/li&gt;
&lt;li&gt;åœ¨æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¤„æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; çš„åŒºé—´å’Œå³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e5 + 5;
struct &amp;#123;
    long long s;
    int l, r, d0, d1, df, ds, u0, u1;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void pushup(int p) &amp;#123;
    t[p].u0 = t[lt].u0 + t[rt].u0;
    t[p].u1 = t[lt].u1 + t[rt].u1;
    return;
&amp;#125;
void pushval(int p, long long v0, long long v1, bool f) &amp;#123;
    if (f) &amp;#123;
        t[p].df ^= 1;
        std::swap(t[p].u0, t[p].u1);
        std::swap(t[p].d0, t[p].d1);
    &amp;#125;
    t[p].d0 += v0, t[p].d1 += v1;
    t[p].s += t[p].u0 * v0 + t[p].u1 * v1;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d0, t[p].d1, t[p].df);
    pushval(rt, t[p].d0, t[p].d1, t[p].df);
    t[p].d0 = t[p].d1 = t[p].df = 0;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    t[p].u0 = r - l + 1;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void flip(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, 0, 0, 1);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        flip(lt, l, r);
    if (r &amp;gt; mid)
        flip(rt, l, r);
    pushup(p);
    return;
&amp;#125;
long long ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].s;
    pushdown(p);
    auto res(0ll);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        res = ask(lt, l, r);
    if (r &amp;gt; mid)
        res += ask(rt, l, r);
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), la(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    int m;
    std::cin &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; res(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; u(n + 1);
    for (int i = 1, l, r; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        u[r].emplace_back(l, i);
    &amp;#125;
    bld(1, 1, n);
    for (int r = 1; r &amp;lt;= n; ++r) &amp;#123;
        flip(1, la[a[r]] + 1, r);
        pushval(1, 0, 1, 0);
        for (auto [l, id] : u[r])
            res[id] = ask(1, l, r);
        la[a[r]] = r;
    &amp;#125;
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;æ¯”èµ›&#34;&gt;# æ¯”èµ›&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P8868&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P8868&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;v&#34;&gt;# V&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://uoj.ac/problem/164&#34; class=&#34;uri&#34;&gt;https://uoj.ac/problem/164&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;cartesian-tree&#34;&gt;# Cartesian Tree&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1290E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1290E&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;rprmq1&#34;&gt;# rprmq1&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6109&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6109&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;rpfrdtzls&#34;&gt;# rpfrdtzls&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9057&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9057&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;çº¿æ®µæ ‘åˆå¹¶&#34;&gt;çº¿æ®µæ ‘åˆå¹¶&lt;/h3&gt;
&lt;p&gt;æ ‘ä¸Šçš„çº¿æ®µæ ‘åˆå¹¶éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œåˆ©ç”¨äº†çº¿æ®µæ ‘åˆå¹¶æ˜¯çº¿æ€§çš„ï¼Œä»¥åŠ dsu on tree&lt;/p&gt;
&lt;p&gt;ä¸å¦‚è¯´ç»å¤§å¤šæ•°çº¿æ®µæ ‘åˆå¹¶éƒ½æœ‰æ ‘ä¸ŠèƒŒæ™¯ï¼Œå› ä¸ºè‡ªå¸¦åˆå¹¶é¡ºåºå’Œå¤æ‚åº¦ä¿è¯&lt;/p&gt;
&lt;p&gt;Tipï¼šæ ‘ä¸Šåˆå¹¶çš„èƒŒæ™¯ä¸‹ï¼Œçº¿æ®µæ ‘åˆå¹¶çš„è¡¨ç°ä¼šæ¯”ä¸»å¸­æ ‘ä¼˜ç§€å¾ˆå¤šï¼Œå› ä¸ºå‰è€…è·‘ä¸æ»¡&lt;/p&gt;
&lt;p&gt;ä¸åœ¨æ ‘ä¸Šçš„é—®é¢˜ï¼Œé¢˜ç›®å¯èƒ½ä¼šé€šè¿‡å„ç§æ–¹å¼ä¿è¯å¤æ‚åº¦ï¼Œæ¯”å¦‚ä¿è¯æ¯ä¸ªç‚¹åªä¼šè¢«åˆå¹¶ä¸€æ¬¡ä¹‹ç±»&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;è¿ç§»è®¡åˆ’-migration-plan&#34;&gt;# è¿ç§»è®¡åˆ’ / Migration Plan&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11993&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11993&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;æ°¸æ— ä¹¡&#34;&gt;# æ°¸æ— ä¹¡&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3224&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3224&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;è¯­è¨€&#34;&gt;# è¯­è¨€&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5327&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5327&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;æ¢¦å¹»å¸ƒä¸&#34;&gt;# æ¢¦å¹»å¸ƒä¸&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3201&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3201&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;è¿˜æœ‰ä¸¤ä¸ªæ¯”è¾ƒå±çš„ P7563 å’Œ P7963&lt;/p&gt;
&lt;h3 id=&#34;æ‰«æçº¿&#34;&gt;æ‰«æçº¿&lt;/h3&gt;
&lt;p&gt;ç¦»çº¿ï¼ŒæŒ‰ç…§ä¸‹æ ‡æ’åºï¼Œæ‰«ä¸€éå¤„ç†è¯¢é—®ï¼Œå°±å¯ä»¥åˆ©ç”¨ã€æ‰€æœ‰æ›´é å‰çš„ä¸‹æ ‡éƒ½ä»¥è¢«è®¡ç®—è¿‡ã€æ¥å¤„ç†é—®é¢˜&lt;/p&gt;
&lt;p&gt;ä¸åªå±€é™äºåŒºé—´è¯¢é—®ï¼Œå•ç‚¹çš„å¯èƒ½åè€Œæ›´éš¾ä¸€ç‚¹ï¼Œéœ€è¦å‘ç°å’Œä¸‹æ ‡å¤§å°æœ‰å…³çš„æ€§è´¨&lt;/p&gt;
&lt;h4 id=&#34;ç­‰å·®å­åºåˆ—&#34;&gt;ç­‰å·®å­åºåˆ—&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P2757&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P2757&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ’åˆ—ï¼Œé—®æ˜¯å¦èƒ½æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(len\ge 3\)&lt;/span&gt; çš„å­åºåˆ—ï¼Œä½¿å¾—å…¶æ˜¯ç­‰å·®çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 5\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ ¹æ®å•è°ƒæ€§ï¼Œå¯ä»¥ç®€åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(len=3\)&lt;/span&gt; æ—¶çš„ç­”æ¡ˆ&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯å¯¹äºä¸­é¡¹ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œèƒ½ä¸èƒ½æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i&amp;lt;j&amp;lt;k\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(a_j-a_i=a_k-a_j\)&lt;/span&gt;ã€‚ä»ä¸‹æ ‡å‡ºå‘ï¼Œå·®å€¼æ˜¯ä¸å¥½ç»´æŠ¤çš„ï¼›æ³¨æ„åˆ°æ˜¯æ’åˆ—ï¼Œå¯ä»¥ä»å€¼å‡ºå‘ï¼Œè½¬åŒ–æˆæ˜¯å¦å­˜åœ¨ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(a_j-d\)&lt;/span&gt; åœ¨ä¹‹å‰å‡ºç°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_j+d\)&lt;/span&gt; åœ¨ä¹‹åå‡ºç°ã€‚&lt;/p&gt;
&lt;p&gt;åˆ©ç”¨ä¸‹æ ‡ã€ä¹‹å‰ã€å’Œã€ä¹‹åã€çš„é™åˆ¶ï¼Œåšæ‰«æçº¿ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; ä½¿ &lt;span class=&#34;math inline&#34;&gt;\(a_j-d\)&lt;/span&gt; å‡ºç°è¿‡ä½†æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_j+d\)&lt;/span&gt; æ²¡æœ‰å‡ºç°è¿‡ï¼›è¿˜æ˜¯å› ä¸ºæ˜¯æ’åˆ—ï¼Œæ•°é‡åªä¼šä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå¦‚æœéæ³•è¯´æ˜ &lt;span class=&#34;math inline&#34;&gt;\(a_j-d\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_j+d\)&lt;/span&gt; éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æˆ–è€…éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå‘ç°æ˜¯å…³äº &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; çš„å›æ–‡ï¼Œæ•…æƒå€¼çº¿æ®µæ ‘ç»´æŠ¤å“ˆå¸Œï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; ä¸¤ä¾§å…¨éƒ¨å›æ–‡ï¼Œè¯´æ˜ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸æ˜¯åˆæ³•ä¸­é¡¹ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
namespace fastIO &amp;#123;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#ifdef ONLINE_JUDGE
inline int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf)
            return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
#else
#define nec getchar
#endif
inline bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF)
            return 0;
        if (ch == &amp;#39;-&amp;#39;)
            f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f)
        x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0) &amp;#123;
        putchar(&amp;#39;-&amp;#39;);
        x = -x;
    &amp;#125;
    if (x &amp;gt;= 10)
        print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x);
    putchar(ch);
    return;
&amp;#125;
&amp;#125; // namespace fastIO
namespace XSC062 &amp;#123;
using namespace fastIO;
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
using sc = unsigned long long;
const int p = 13331; // 0103 Â¿Ã‰Â°Â®ÂµÃÃ„Ã³ 
const int lim = 5e5;
const int maxn = 5e5 + 5;
struct _ &amp;#123;
    int l, r;
    sc lh, rh;
&amp;#125;;
int T, n;
int a[maxn];
sc base[maxn];
_ t[maxn &amp;lt;&amp;lt; 2];
int min(int x, int y) &amp;#123;
    return x &amp;lt; y ? x : y;
&amp;#125;
int max(int x, int y) &amp;#123;
    return x &amp;gt; y ? x : y;
&amp;#125;
void pushup(int p) &amp;#123;
    int ll = t[lt].r - t[lt].l + 1;
    int rl = t[rt].r - t[rt].l + 1;
    t[p].lh = t[lt].lh * base[rl] + t[rt].lh;
    t[p].rh = t[rt].rh * base[ll] + t[lt].rh;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].lh = t[p].rh = 0;
    t[p].l = l, t[p].r = r;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid);
    bld(rt, mid + 1, r);
    return;
&amp;#125;
void upd(int p, int x, int v) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        t[p].lh = t[p].rh = v;
        return;
    &amp;#125;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, x, v);
    else upd(rt, x, v);
    pushup(p);
    return;
&amp;#125;
sc qryl(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].lh;
    sc ans = 0;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        ans = qryl(lt, l, r);
    if (r &amp;gt; mid) &amp;#123;
        ans *= base[min(r, t[p].r) - mid];
        ans += qryl(rt, l, r);
    &amp;#125;
    return ans;
&amp;#125;
sc qryr(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].rh;
    sc ans = 0;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;gt; mid)
        ans = qryr(rt, l, r);
    if (l &amp;lt;= mid) &amp;#123;
        ans *= base[mid - max(l, t[p].l) + 1];
        ans += qryr(lt, l, r);
    &amp;#125;
    return ans;
&amp;#125;
int main() &amp;#123;
    read(T);
    base[0] = 1;
    for (int i = 1; i &amp;lt;= lim; ++i)
        base[i] = base[i - 1] * p;
    while (T--) &amp;#123;
        read(n);
        bld(1, 1, n);
        for (int i = 1; i &amp;lt;= n; ++i)
            read(a[i]);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            int len = min(n - a[i], a[i] - 1);
            if (i &amp;gt; 1) &amp;#123;
                upd(1, a[i - 1], 1);
            &amp;#125;
            if (len == 0)
                continue;
            int l = a[i] - len;
            int r = a[i] + len;
            if (qryl(1, l, a[i] - 1) !=
                qryr(1, a[i] + 1, r)) &amp;#123;
                puts(&amp;quot;Y&amp;quot;);
                goto isSol;
            &amp;#125;
        &amp;#125;
        puts(&amp;quot;N&amp;quot;);
        isSol: ;
    &amp;#125;
    return 0;
&amp;#125;
&amp;#125; // namespace XSC062
int main() &amp;#123;
    XSC062::main();
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;h4 id=&#34;å°å¥‡çš„ç³–æœ&#34;&gt;å°å¥‡çš„ç³–æœ&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://hydro.ac/p/bzoj-P4548&#34; class=&#34;uri&#34;&gt;https://hydro.ac/p/bzoj-P4548&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; ä¸ªæœ‰é¢œè‰²ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; ç§ï¼‰çš„ç‚¹åœ¨å¹³é¢ä¸Šï¼Œåœ¨å¹³é¢ä¸Šå–ä¸€æ¡æ°´å¹³çš„çº¿æ®µï¼Œå¯ä»¥é€‰æ‹©çº¿æ®µä¸Šæ–¹çš„æ‰€æœ‰ç‚¹ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸‹æ–¹çš„æ‰€æœ‰ç‚¹ã€‚æ‰¾å‡ºä¸€æ¡çº¿æ®µå’Œé€‰å–çš„æ–¹å‘ï¼Œä½¿å¾—åœ¨é€‰å–çš„ç‚¹ä¸åŒ…å«æ‰€æœ‰é¢œè‰²çš„å‰æä¸‹ï¼Œæœ€å¤§åŒ–é€‰åˆ°ç‚¹çš„æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(N,M\le 10^6,|x|,|y|\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…ˆç¦»æ•£åŒ– + æŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; æ’åºé™ä¸€ç»´ï¼Œè´ªå¿ƒåœ°æšä¸¾æŸç§é¢œè‰² &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸é€‰ã€‚è€ƒè™‘çº¿æ®µåœ¨å¹³é¢æœ€åº•éƒ¨æ—¶çš„ç­”æ¡ˆï¼Œå–å‡ºæ‰€æœ‰é¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„ç‚¹çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åæ ‡ï¼Œåªèƒ½é€‰æ‹©ç›¸é‚»çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¹‹é—´çš„æ‰€æœ‰ç‚¹ã€‚æšä¸¾æ¯ä¸€å¯¹ç›¸é‚»çš„ç‚¹è®¡ç®—ç­”æ¡ˆã€‚æŠŠçº¿æ®µä¸Šç§»ï¼Œå¦‚æœç¢°åˆ°äº†ä¸€ä¸ªé¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„ç‚¹ï¼Œå°±è¯´æ˜è¿™ä¸ªç‚¹ä¸å†å‚ä¸é™åˆ¶ï¼Œåˆ å»å³å¯ï¼Œè¯¥ç‚¹åŸå‰é©±å’Œåç»§å›´å‡ºæ¥çš„åŒºé—´å°±èƒ½å¤Ÿæ›´æ–°ç­”æ¡ˆã€‚ç”¨é“¾è¡¨ / å•è°ƒæ ˆå°±èƒ½å¾ˆå¿«åœ°ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæšä¸¾é¢œè‰²å†è·‘æ‰«æçº¿æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2\log n)\)&lt;/span&gt; çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚æ³¨æ„åˆ°æ•°æ®ç»“æ„é‡Œå­˜åœ¨å½“å‰é¢œè‰²æ²¡æœ‰å½±å“ï¼Œå› ä¸ºä¸€å®šä¸åœ¨è¯¢é—®åŒºé—´å†…ã€‚æ•´ä½“åšæ‰«æçº¿ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;namespace XSC062 &amp;#123;
using namespace fastIO;
const int maxn = 2e5 + 5;
struct _ &amp;#123;
    int x, y, c;
    bool operator&amp;lt; (const _ &amp;amp;q) const &amp;#123;
        return y &amp;lt; q.y;
    &amp;#125;
&amp;#125;;
_ a[maxn];
int s[maxn], t[maxn];
int ls[maxn], rs[maxn];
int cp[maxn], cn[maxn];
int pre[maxn], nex[maxn];
std::vector&amp;lt;int&amp;gt; g[maxn];
int div[maxn], Bit[maxn];
int T, n, k, tot, cnt, now, res;
int max(int x, int y) &amp;#123; return x &amp;gt; y ? x : y; &amp;#125;
int lowbit(int x) &amp;#123; return x &amp;amp; -x; &amp;#125;
void add(int x, int v) &amp;#123;
    for (; x &amp;lt;= n; x += lowbit(x)) Bit[x] += v;
    return;
&amp;#125;
int ask(int x) &amp;#123;
    int res = 0;
    for (; x; x -= lowbit(x)) res += Bit[x];
    return res;
&amp;#125;
int ask(int l, int r) &amp;#123;
    if (l &amp;gt; r) return 0;
    return ask(r) - ask(l - 1);
&amp;#125;
int main() &amp;#123;
//  freopen(&amp;quot;1.in&amp;quot;, &amp;quot;r&amp;quot;, stdin); 
    read(T);
    while (T--) &amp;#123;
        read(n), read(k), now = res = 0;
        for (int i = 1; i &amp;lt;= k; ++i) &amp;#123;
            s[i] = ++now, t[i] = ++now;
            div[s[i]] = 0, div[t[i]] = n + 1;
            nex[s[i]] = t[i], pre[t[i]] = s[i];
            pre[s[i]] = nex[t[i]] = 0;
        &amp;#125;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            read(a[i].x), read(a[i].y), read(a[i].c);
            ls[i] = a[i].x, rs[i] = a[i].y;
        &amp;#125;
        std::sort(a + 1, a + n + 1, [&amp;amp;](_ x, _ y) &amp;#123; return x.x &amp;lt; y.x; &amp;#125;);
        std::sort(ls + 1, ls + n + 1);
        std::sort(rs + 1, rs + n + 1);
        tot = std::unique(ls + 1, ls + n + 1) - ls - 1;
        cnt = std::unique(rs + 1, rs + n + 1) - rs - 1;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            a[i].x = std::lower_bound(ls + 1, ls + tot + 1, a[i].x) - ls;
            a[i].y = std::lower_bound(rs + 1, rs + cnt + 1, a[i].y) - rs;
        &amp;#125;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            div[++now] = a[i].x;
            add(a[i].x, 1), g[a[i].y].push_back(now);
            pre[now] = pre[t[a[i].c]], nex[pre[t[a[i].c]]] = now;
            pre[t[a[i].c]] = now, nex[now] = t[a[i].c];
        &amp;#125;
        memcpy(cp, pre, sizeof (cp));
        memcpy(cn, nex, sizeof (cn));
        for (int i = 1; i &amp;lt;= k; ++i) &amp;#123;
            for (int j = s[i]; j != t[i]; j = nex[j])
                res = max(res, ask(div[j] + 1, div[nex[j]] - 1));
        &amp;#125;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            for (auto j : g[i]) add(div[j], -1);
            for (auto j : g[i]) &amp;#123;
                res = max(res, ask(div[pre[j]] + 1, div[nex[j]] - 1));
                nex[pre[j]] = nex[j], pre[nex[j]] = pre[j];
            &amp;#125;
        &amp;#125;
        for (int i = 1; i &amp;lt;= n; ++i) add(a[i].x, 1);
        for (int i = n; i; --i) &amp;#123;
            for (auto j : g[i]) add(div[j], -1);
            for (auto j : g[i]) &amp;#123;
                res = max(res, ask(div[cp[j]] + 1, div[cn[j]] - 1));
                cn[cp[j]] = cn[j], cp[cn[j]] = cp[j];
            &amp;#125;
        &amp;#125;
        print(res, &amp;#39;\n&amp;#39;);
        for (int i = 1; i &amp;lt;= n; ++i)
            g[i].clear(), g[i].shrink_to_fit();
    &amp;#125;
    return 0;
&amp;#125;
&amp;#125; // namespace XSC062&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;rmscne&#34;&gt;rmscne&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7907&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7907&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ—ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡è¯¢é—® &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; ä¸­çš„æœ€çŸ­å­åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\([l&amp;#39;,r&amp;#39;]\)&lt;/span&gt;ï¼Œä½¿å¾—å…¶åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; ä¸­å‡ºç°çš„å…¨éƒ¨å€¼ã€‚è¾“å‡ºé•¿åº¦å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,q,V\le 2\times 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŒºé—´é‡Œé¢æ‰¾å­åŒºé—´ä¹Ÿæ˜¯æ‰«æçº¿ç»å…¸é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;åŒºé—´ç§ç±»æ•°ä¼šæœ‰å‡ ç§æ€è·¯ï¼šé›†åˆå“ˆå¸Œã€å‰é©±åç»§ã€è«é˜Ÿä¹‹ç±»ã€‚PSï¼šè¿™ä¸ªé¢˜ç”¨ ODT å¯ä»¥æ‹¿åˆ°æœ€ä¼˜è§£&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(i=1\sim n\)&lt;/span&gt;ï¼Œä¾æ¬¡è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½œä¸ºå³ç«¯ç‚¹çš„æƒ…å†µã€‚çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½œä¸ºå·¦ç«¯ç‚¹æ—¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(i-r_j\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\([j, r_j]\)&lt;/span&gt; æ˜¯ä¸ &lt;span class=&#34;math inline&#34;&gt;\([j,i]\)&lt;/span&gt; ç§ç±»ç›¸åŒçš„æœ€å°åŒºé—´ã€‚&lt;/p&gt;
&lt;p&gt;è¯¢é—®çš„æ—¶å€™ï¼Œåªéœ€è¦æ‰¾åˆ°æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\([j, r]\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; ç§ç±»ç›¸åŒï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\([l, j&amp;#39;]\)&lt;/span&gt; çš„åŒºé—´å’Œå³å¯ã€‚æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\)&lt;/span&gt; å¯ä»¥è®°å½•å‰é©±åç»§ï¼Œåˆå§‹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\)&lt;/span&gt; å°±æ˜¯è‡ªå·±ã€‚è‹¥åŠ å…¥äº†ä¸€ä¸ªä¸ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; ç›¸åŒçš„æ–°å…ƒç´ ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å°±ä¸å†æœ‰è´¡çŒ®ï¼Œæ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\)&lt;/span&gt; å°±ä¼šç»§æ‰¿ &lt;span class=&#34;math inline&#34;&gt;\(l+1\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\)&lt;/span&gt;ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”¨å¹¶æŸ¥é›†å³å¯ç®€å•ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int lim = 2e6;
const int maxn = 2e6 + 5;
const int maxm = 5e7 + 5;
const int inf = 0x3f3f3f3f;
struct &amp;#123; int l, r, u, d; &amp;#125; t[maxn &amp;lt;&amp;lt; 2];
int tot;
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void pushdown(int p) &amp;#123;
    if (~t[p].d) &amp;#123;
        t[lt].d = t[rt].d = t[p].d;
        t[lt].u = t[p].d - t[lt].r + 1;
        t[rt].u = t[p].d - t[rt].r + 1;
        t[p].d = -1;
    &amp;#125;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r, t[p].d = -1;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void upd(int p, int l, int r, int v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        t[p].d = v, t[p].u = v - t[p].r + 1;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        upd(lt, l, r, v);
    if (r &amp;gt; mid)
        upd(rt, l, r, v);
    t[p].u = std::min(t[lt].u, t[rt].u);
    return;
&amp;#125;
int ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1, res = inf;
    if (l &amp;lt;= mid)
        res = ask(lt, l, r);
    if (r &amp;gt; mid)
        res = std::min(res, ask(rt, l, r));
    return res;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, q;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), la(lim + 1), pre(n + 1), f(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        pre[i] = la[a[i]], la[a[i]] = i, f[i] = i;
    &amp;#125;
    std::cin &amp;gt;&amp;gt; q;
    std::vector&amp;lt;int&amp;gt; res(q + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; t(n + 1);
    for (int i = 1, l, r; i &amp;lt;= q; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        t[r].emplace_back(l, i);
    &amp;#125;
    bld(1, 1, n);
    std::function&amp;lt;int(int)&amp;gt; find = [&amp;amp;](int x) &amp;#123;
        return x == f[x] ? x : f[x] = find(f[x]);
    &amp;#125;;
    auto merge = [&amp;amp;](int x, int y) &amp;#123;
        x = find(x), y = find(y);
        f[std::min(x, y)] = std::max(x, y);
        return;
    &amp;#125;;
    for (int r = 1; r &amp;lt;= n; ++r) &amp;#123;
        if (pre[r])
            merge(pre[r], pre[r] + 1);
        upd(1, pre[r] + 1, r, r);
        for (auto [l, i] : t[r])
            res[i] = ask(1, l, find(l));
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;é¢œè‰²&#34;&gt;# é¢œè‰²&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4065&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4065&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ æœ‰ä¸€ä¸ªé¢œè‰²ã€‚é€‰æ‹©è‹¥å¹²é¢œè‰²ï¼ˆä¸èƒ½å…¨é€‰æˆ–å…¨ä¸é€‰ï¼‰ï¼Œé—®æœ‰å¤šå°‘ç§é€‰å–æ–¹æ¡ˆä½¿å¾—æ‹¥æœ‰è¿™äº›é¢œè‰²çš„ç‚¹æ˜¯ä¸€æ®µè¿ç»­çš„åŒºé—´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 3\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;åŠ¿èƒ½çº¿æ®µæ ‘&#34;&gt;åŠ¿èƒ½çº¿æ®µæ ‘&lt;/h3&gt;
&lt;h4 id=&#34;å¸‚åœº&#34;&gt;# å¸‚åœº&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://loj.ac/p/6029&#34; class=&#34;uri&#34;&gt;https://loj.ac/p/6029&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;segment-tree-beats&#34;&gt;# Segment Tree Beats!&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»´æŠ¤åŒºé—´å– minï¼ŒåŒºé—´æ±‚å’Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;pdf P57&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;segment-tree-beats-plus&#34;&gt;# Segment Tree Beats! Plus&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»´æŠ¤åŒºé—´åŠ ï¼ŒåŒºé—´å– minï¼ŒåŒºé—´æ±‚å’Œã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;pdf P60&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;æœ€å‡å¥³é€‰æ‰‹&#34;&gt;# æœ€å‡å¥³é€‰æ‰‹&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://loj.ac/p/6565&#34; class=&#34;uri&#34;&gt;https://loj.ac/p/6565&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;mzl-loves-segment-tree&#34;&gt;# Mzl loves segment tree&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/problem/10203&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/problem/10203&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;pdf P66&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;ctsn-loves-segment-tree&#34;&gt;# CTSN loves segment tree&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/U180387&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/U180387&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;å‰è¿›å››segment-tree-beats-ver&#34;&gt;# å‰è¿›å››ï¼ˆsegment tree beats verï¼‰&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://uoj.ac/problem/515&#34; class=&#34;uri&#34;&gt;https://uoj.ac/problem/515&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦è§ &lt;a href=&#34;#-å‰è¿›å››æ¥¼æˆ¿é‡å»º-ver&#34;&gt;æ¥¼æˆ¿é‡å»º ver&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;åŸºç¡€æ•°æ®ç»“æ„ç»ƒä¹ é¢˜&#34;&gt;# åŸºç¡€æ•°æ®ç»“æ„ç»ƒä¹ é¢˜&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://uoj.ac/problem/228&#34; class=&#34;uri&#34;&gt;https://uoj.ac/problem/228&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;çº¿æ®µæ ‘-3&#34;&gt;# çº¿æ®µæ ‘ 3&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6242&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6242&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;èµ›æ ¼è’™ç‰¹å½¼èŒ¨&#34;&gt;# èµ›æ ¼è’™ç‰¹å½¼èŒ¨&lt;/h4&gt;
&lt;p&gt;pdf P70&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;å •å¤©ä½œæˆ˜-test_98&#34;&gt;# å •å¤©ä½œæˆ˜ TEST_98&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9069&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9069&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;çº¿æ®µæ ‘åˆ†æ²»&#34;&gt;çº¿æ®µæ ‘åˆ†æ²»&lt;/h3&gt;
&lt;h4 id=&#34;meetings-ä¼šè®®&#34;&gt;# meetings ä¼šè®®&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5044&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5044&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;å…«çºµå…«æ¨ª&#34;&gt;# å…«çºµå…«æ¨ª&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3733&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3733&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ç¬›å¡å°”æ ‘&#34;&gt;ç¬›å¡å°”æ ‘&lt;/h2&gt;
&lt;p&gt;ä¸€äº›æ€è€ƒæ–¹å¼å’Œ trick å§&lt;/p&gt;
&lt;h3 id=&#34;ç”±ä¹ƒæ•‘çˆ·çˆ·&#34;&gt;* ç”±ä¹ƒæ•‘çˆ·çˆ·&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3793&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3793&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å°½å¯èƒ½å¿«åœ°ç»´æŠ¤éšæœºåºåˆ—åŒºé—´æœ€å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;éšæœºåºåˆ—ç¬›å¡å°”æ ‘æœŸæœ›æ·±åº¦æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚å°±å¯ä»¥åšäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ¥è‡ª &lt;a href=&#34;https://www.luogu.com/article/hj9ci08q&#34;&gt;UnyieldingTrilobite çš„æ–‡ç« &lt;/a&gt;ï¼šåŒæ ·å¯ä»¥ç”¨æ‚¬çº¿ï¼&lt;a href=&#34;/20231117/#éšæœºåºåˆ—æ‚¬çº¿ç»“åˆåˆ†å—&#34;&gt;æ‚¬çº¿ + åˆ†å—&lt;/a&gt; å°±å¯ä»¥åšäº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æƒ…æ™¯å‰§æœ€å€¼çš„æ€§è´¨ç»´æŠ¤æ–¹å¼çš„å–èˆ&#34;&gt;* æƒ…æ™¯å‰§ï¼ˆæœ€å€¼çš„æ€§è´¨ï¼Œç»´æŠ¤æ–¹å¼çš„å–èˆï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/4273/problem/1&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/4273/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œæ‰¾åˆ°ä¸€ä¸ªåŒºé—´ï¼Œä½¿å¾— åŒºé—´é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\times\)&lt;/span&gt; åŒºé—´æœ€å¤§å€¼ &lt;span class=&#34;math inline&#34;&gt;\(\times\)&lt;/span&gt; åŒºé—´æœ€å°å€¼ æœ€å¤§ã€‚è¾“å‡ºæœ€å¤§å€¼ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6,V\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å®¹æ˜“æƒ³åˆ°å»ºç¬›å¡å°”æ ‘ã€‚è¿™é‡Œçš„ æœ€å¤§å€¼ å’Œ æœ€å°å€¼ åœ°ä½ç›¸ç­‰å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ&lt;/li&gt;
&lt;li&gt;å¦‚æœæˆ‘ä»¬æ˜¯é’¦å®šæœ€å¤§å€¼ï¼Œå†å»æœ€å¤§åŒ–ã€æœ€å°å€¼ &lt;span class=&#34;math inline&#34;&gt;\(\times\)&lt;/span&gt; åŒºé—´é•¿ã€ï¼Œå¥½åƒæ²¡åŠæ³•åšï¼Œå› ä¸ºè¿™ä¸ªæœ€å¤§è´¡çŒ®æ²¡ä»€ä¹ˆæ€§è´¨&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½†å¦‚æœé’¦å®šæœ€å°å€¼ï¼Œèƒ½å–åˆ°çš„æœ€é•¿åŒºé—´å°±æ˜¯åœ¨å°æ ¹ç¬›å¡å°”æ ‘ä¸Šçš„ç®¡è¾–åŒºé—´ï¼Œæ˜¾ç„¶åŒºé—´è¶Šé•¿å–åˆ°çš„æœ€å¤§å€¼ä¹Ÿè¶Šå¤§ï¼Œç›´æ¥å–è¿™é‡Œçš„æœ€å¤§å€¼å³å¯&lt;/p&gt;
æ‰€ä»¥æœ€å¤§å€¼å’Œæœ€å°å€¼åœ°ä½ä¸ç­‰æ˜¯å› ä¸ºï¼ŒåŒºé—´é•¿å’Œæœ€å¤§å€¼å¤§å°æ˜¯æ­£ç›¸å…³çš„ï¼Œæ‰€ä»¥åªéœ€è¦æœ€å¤§åŒ–åŒºé—´é•¿ï¼Œæœ€å¤§å€¼ä¹Ÿå°±æœ€å¤§åŒ–äº†&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ‰€ä»¥åœ¨å°æ ¹ç¬›å¡å°”æ ‘ä¸Šç»´æŠ¤åŒºé—´æœ€å¤§å€¼å³å¯&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;å°è“çš„å¥½å‹&#34;&gt;# å°è“çš„å¥½å‹&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P2611&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P2611&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æ˜Ÿç™½-by-ttpandasç¬›å¡å°”æ ‘-dsu-on-tree&#34;&gt;æ˜Ÿç™½ by TTpandaSï¼ˆç¬›å¡å°”æ ‘ + dsu on treeï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6517/problem/3&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6517/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œå›ç­” &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; ä¸ªè¯¢é—®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œæ˜¯å¦å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(l\le x&amp;lt;y\le r\)&lt;/span&gt;ï¼Œä½¿å¾—ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_x&amp;lt;a_y\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(a_x\)&lt;/span&gt; ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\([x,y]\)&lt;/span&gt; ä¸­æœ€å°å€¼ï¼›&lt;/li&gt;
&lt;li&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\([x, y]\)&lt;/span&gt; ä¸­æœ€å°å€¼ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(a_i\mid (a_x\cdot a_y)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 3\times 10^5,q\le10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å®¹æ˜“æƒ³åˆ°å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åè¿‡æ¥æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\([x,y]\)&lt;/span&gt;ã€‚å¦‚æœå»ºç«‹å°æ ¹ç¬›å¡å°”æ ‘ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å·¦è¾¹æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€å³è¾¹æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•æ˜¯å¯¹äºå·¦ä¾§çš„æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œç»´æŠ¤æœ€è¿‘çš„åˆæ³• &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼›æˆ–æ˜¯å¯¹äºå³ä¾§çš„æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼Œç»´æŠ¤æœ€è¿‘çš„åˆæ³• &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚&lt;/p&gt;
åšä¸€ä¸ª DSU on Treeï¼Œå“ªè¾¹åŒºé—´çŸ­å°±ç»´æŠ¤å“ªè¾¹ï¼Œæ˜¯å• &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;éœ€è¦è§£å†³ç‚¹å†…é¢„å¤„ç†ï¼Œä»¥ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ºä¾‹ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å’Œå½“å‰ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\((p,l,r)\)&lt;/span&gt;ï¼Œéœ€è¦æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\((p, r]\)&lt;/span&gt; ä¸­æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(a_y\)&lt;/span&gt; æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {a_p}{\gcd(a_x,a_p)}\)&lt;/span&gt; çš„å€æ•°ã€‚ç¦»çº¿ä¸‹æ¥æ‰«æçº¿ï¼Œ&lt;del&gt;å¼€ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ£µçº¿æ®µæ ‘&lt;/del&gt;ï¼Œè·‘ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡æ ‘çŠ¶æ•°ç»„ï¼Œç”¨ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; æ›´æ–°æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a_y\)&lt;/span&gt; å› æ•°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_y\)&lt;/span&gt; å¤„çš„ min / maxï¼Œå¯ä»¥åœ¨ä¸¤ä¸ª log å†…è·å¾—æ”¯é…å¯¹ç±»ä¼¼ç‰©ã€‚&lt;/p&gt;
ä¸æ˜¯å¾ˆç†è§£ä¸ºä»€ä¹ˆé¢˜ç›®è¦å†åŠ ä¸€ä¸ªååºé™åˆ¶ï¼Œé™¤äº†å¢åŠ ä»£ç é‡å’Œç”¨æ—¶å¤–ä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŸ¥è¯¢æ—¶ç›´æ¥ rmqï¼ˆè¿™é‡Œå”äº†å†™äº† st è¡¨ï¼Œå®é™…ä¸Šåªéœ€è¦å‰åç¼€ï¼‰å³å¯ã€‚æ•´ä½“å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2 n)\)&lt;/span&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#ifdef ONLINE_JUDGE
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
#else
#define nec getchar
#endif
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    read(n);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; mul(n + 1);
    std::vector&amp;lt;int&amp;gt; a(n + 1), l(n + 1), r(n + 1), pos(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        read(a[i]), pos[a[i]] = i;
        for (l[i] = i; l[i] != 1 &amp;amp;&amp;amp; a[i] &amp;lt; a[l[i] - 1]; l[i] = l[l[i] - 1]);
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (int j = i; j &amp;lt;= n; j += i)
            mul[i].push_back(pos[j]);
        std::sort(mul[i].begin(), mul[i].end());
    &amp;#125;
    for (int i = n; i; --i)
        for (r[i] = i; r[i] != n &amp;amp;&amp;amp; a[i] &amp;lt; a[r[i] + 1]; r[i] = r[r[i] + 1]);
    struct query &amp;#123; int id, l, r; &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;query&amp;gt; &amp;gt; ql(n + 1), qr(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        if (i - l[i] &amp;lt; r[i] - i)
            for (int j = l[i]; j &amp;lt; i; ++j)
                qr[a[i] / std::__gcd(a[i], a[j])].push_back(&amp;#123; j, i + 1, r[i] &amp;#125;);
        else
            for (int j = i + 1; j &amp;lt;= r[i]; ++j)
                ql[a[i] / std::__gcd(a[i], a[j])].push_back(&amp;#123; j, l[i], i - 1 &amp;#125;);
    std::vector&amp;lt;int&amp;gt; u(n + 1), rt(n + 1), bit(n + 1);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            bit[x] = v;
        return;
    &amp;#125;;
    std::function&amp;lt;int(int)&amp;gt; ask = [&amp;amp;](int x) &amp;#123;
        int res = 0;
        for (; x; x -= lowbit(x))
            res = std::max(res, bit[x]);
        return res;
    &amp;#125;;
    for (int fac = 1; fac &amp;lt;= n; ++fac) &amp;#123;
        std::sort(ql[fac].begin(), ql[fac].end(), [&amp;amp;](query x, query y) &amp;#123; return x.r &amp;lt; y.r; &amp;#125;);
        auto i = mul[fac].begin();
        for (auto [id, l, r] : ql[fac]) &amp;#123;
            for (; i != mul[fac].end() &amp;amp;&amp;amp; *i &amp;lt;= r; ++i)
                add(a[*i], *i);
            auto mx(ask(a[id]));
            if (mx &amp;gt;= l)
                u[id] = std::max(u[id], mx);
        &amp;#125;
        for (auto i : mul[fac])
            add(a[i], 0);
    &amp;#125;
    bit.assign(n + 1, 0x3f3f3f3f);
    ask = [&amp;amp;](int x) &amp;#123;
        int res = 0x3f3f3f3f;
        for (; x; x -= lowbit(x))
            res = std::min(res, bit[x]);
        return res;
    &amp;#125;;
    for (int fac = 1; fac &amp;lt;= n; ++fac) &amp;#123;
        std::sort(qr[fac].begin(), qr[fac].end(), [&amp;amp;](query x, query y) &amp;#123; return x.l &amp;gt; y.l; &amp;#125;);
        std::reverse(mul[fac].begin(), mul[fac].end());
        auto i = mul[fac].begin();
        for (auto [id, l, r] : qr[fac]) &amp;#123;
            for (; i != mul[fac].end() &amp;amp;&amp;amp; *i &amp;gt;= l; ++i)
                add(n - a[*i] + 1, *i);
            auto mn(ask(n - a[id] + 1));
            if (mn &amp;lt;= r)
                u[mn] = std::max(u[mn], id);
        &amp;#125;
        for (auto i : mul[fac])
            add(n - a[i] + 1, 0x3f3f3f3f);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; st(20, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        // if (u[i] != 0)
        //     printf(&amp;quot;%d %d\n&amp;quot;, u[i], i);
        st[0][i] = u[i];
    &amp;#125;
    for (int j = 1; (1 &amp;lt;&amp;lt; j) &amp;lt;= n; ++j)
        for (int i = 1; i + (1 &amp;lt;&amp;lt; j) - 1 &amp;lt;= n; ++i)
            st[j][i] = std::max(st[j - 1][i], st[j - 1][i + (1 &amp;lt;&amp;lt; (j - 1))]);
    auto askmx = [&amp;amp;](int l, int r) &amp;#123;
        int k = std::__lg(r - l + 1);
        return std::max(st[k][l], st[k][r - (1 &amp;lt;&amp;lt; k) + 1]);
    &amp;#125;;
    int q;
    read(q);
    for (int l, r; q--; ) &amp;#123;
        read(l), read(r);
        std::cout &amp;lt;&amp;lt; (askmx(l, r) &amp;gt;= l ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;periodni&#34;&gt;# PERIODNI&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6453&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6453&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;cdq-åˆ†æ²»&#34;&gt;CDQ åˆ†æ²»&lt;/h2&gt;
&lt;h3 id=&#34;coloring-nodesååºå¾ˆéšç§˜&#34;&gt;# Coloring Nodesï¼ˆååºå¾ˆéšç§˜ï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P12423&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P12423&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å­—å…¸æ ‘&#34;&gt;å­—å…¸æ ‘&lt;/h2&gt;
&lt;p&gt;å­—å…¸æ ‘ä½œä¸º log æ•°æ®ç»“æ„çš„æ—¶å€™ï¼Œç­‰ä»·æƒå€¼çº¿æ®µæ ‘ï¼Œè€Œä¸”æ”¯æŒåˆå¹¶ã€åˆ†è£‚ï¼ˆæƒå€¼çº¿æ®µæ ‘ also OKï¼Œå¼ºè°ƒä¸€ä¸‹è€Œå·²ï¼‰&lt;/p&gt;
&lt;p&gt;æœ‰äº›æƒ…æ™¯ Trie å†™èµ·æ¥ä¼šæ¯”æƒå€¼çº¿æ®µæ ‘èˆ’æœä¸€äº›ï¼Œæ¯”å¦‚å€¼åŸŸæ“ä½œã€äºŒè¿›åˆ¶æ“ä½œä¹‹ç±»&lt;/p&gt;
&lt;h3 id=&#34;å¼‚æˆ–ç²½å­&#34;&gt;# å¼‚æˆ–ç²½å­&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5283&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5283&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;friends&#34;&gt;# Friends&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF241B&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF241B&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <updated>2025-08-19T01:44:25.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250816/</id>
        <title>è¿‘æœŸæ‚é¢˜ II</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250816/"/>
        <content type="html">&lt;p&gt;å’Œ Aug 9th çš„æ‚é¢˜ä¸å¤ªèƒ½åˆå¹¶ï¼Œæ‰€ä»¥åˆ†å¼€äº†&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-gas-fire-extinguishers&#34;&gt;B. GAS-Fire Extinguishers&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3479&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3479&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶å¯ä»¥è´ªå¿ƒï¼Œä¸å¦¨ä»ä¸‹åˆ°ä¸Šï¼Œè®°å½•å½“å‰éå†è¿‡çš„ã€ç©ºä½™å‡ºæ¥çš„ç­ç«å™¨ï¼ˆå…¶å®ç®—çš„æ˜¯å¯ä»¥ä¾›ç»™çš„æˆ¿é—´æ•°ï¼‰å’Œè¿˜æœªåˆ†é…ç­ç«å™¨çš„æˆ¿é—´ï¼ŒæŒ‰è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\sim k\)&lt;/span&gt; åˆ†ç»„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°å¦‚æœåœ¨æŸä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„å­˜åœ¨è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ç©ºé—²ç­ç«å™¨ï¼Œå¯ä»¥è´ªå¿ƒåœ°åˆ†é…ç»™ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼›å¦‚æœå­˜åœ¨è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„æœªåˆ†é…æˆ¿é—´ï¼Œä¹Ÿå¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„æ”¾ç½®ç­ç«å™¨å¹¶åˆ†é…ç»™è¿™äº›æˆ¿é—´ã€‚ç±»ä¼¼åœ°ï¼Œè¿›è¡Œä¸¤ä¸¤é…å¯¹ä¸€å®šæ˜¯ä¸åŠ£çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°åŒå­æ ‘å†…è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„ç‚¹å¯¹ç•™åˆ° &lt;span class=&#34;math inline&#34;&gt;\(fa\)&lt;/span&gt; å†åŒ¹é…æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºè¿™æ—¶è·ç¦»ä¼šå˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(k+1\)&lt;/span&gt;ï¼Œä¸èƒ½åŒ¹é…ä¸Šï¼›å¯ä»¥æ„Ÿå—åˆ°è¿™æ ·æ˜¯æ›´åŠ£çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥åšäº†ï¼Œæ ¹èŠ‚ç‚¹ç‰¹æ®Šä¹±è´ªå¿ƒä¸€ä¸‹å°±è¡Œäº†ã€‚è®°å¾—å¼€ long longã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
#define int long long
signed main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, s, k, res = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; s &amp;gt;&amp;gt; k;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1), p(n + 1, std::vector&amp;lt;int&amp;gt; (k + 1)), q(n + 1, std::vector&amp;lt;int&amp;gt; (k + 1));
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        for (auto i : g[x])
            if (i != fa)  &amp;#123;
                DFS(i, x);
                for (int j = 0; j &amp;lt; k; ++j)
                    p[x][j + 1] += p[i][j], q[x][j + 1] += q[i][j];
            &amp;#125;
        ++q[x][0];
        if (x != 1) &amp;#123;
            int v = (q[x][k] + s - 1) / s;
            p[x][0] = v * s, res += v;
            for (int i = 0; i &amp;lt;= k; ++i) &amp;#123;
                int v = std::min(p[x][i], q[x][k - i]);
                p[x][i] -= v, q[x][k - i] -= v;
            &amp;#125;
            for (int i = 0; i &amp;lt; k; ++i) &amp;#123;
                int v = std::min(p[x][i], q[x][k - 1 - i]);
                p[x][i] -= v, q[x][k - 1 - i] -= v;
            &amp;#125;
        &amp;#125;
        else &amp;#123;
            // std::cerr &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            int sum = 0ll, r = 0;
            for (int i = k; ~i; --i) &amp;#123;
                sum += p[x][k - i];
                // std::cerr &amp;lt;&amp;lt; sum &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
                int v = std::min(sum, q[x][i]);
                sum -= v, q[x][i] -= v;
                r += q[x][i];
            &amp;#125;
            res += (r + s - 1) / s;
        &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-æ‰«åœ°æœºå™¨äºº&#34;&gt;C. æ‰«åœ°æœºå™¨äºº&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6502/problem/3&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6502/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å †è´§ç‰©ï¼Œæ¯å †è´§ç‰©æœ‰é‡é‡ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; å’Œä¸€ä¸ªå‚æ•° &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ã€‚æœ‰ä¸€ä¸ªåˆå§‹è´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€è´Ÿè½½ä¸Šé™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„æœºå™¨äººï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; éå†è¿™äº›è´§ç‰©ï¼Œå¯¹æ¯ä¸€å¤„è´§ç‰©æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ°æ¸…ç©ºè¿™å †è´§ç‰©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“å‰è´Ÿè½½æœªæ»¡ï¼šå¯ä»¥é€‰æ‹©è¿›è¡Œè£…è½½ç›´åˆ°è¾¾åˆ°è´Ÿè½½ä¸Šé™ï¼Œæˆ–è´§ç‰©æ¸…ç©ºã€‚èŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ç®¡å½“å‰è´Ÿè½½æ»¡æ²¡æ»¡ï¼šå¯ä»¥é€‰æ‹©æ¸…ç©ºå½“å‰è´Ÿè½½ï¼ŒèŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯ä¸€å¤„å¯ä»¥ä»»æ„æ“ä½œï¼Œè¦æ±‚éå†å®Œä¹‹åæœºå™¨äººè´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œé—®æœ€å°ä»£ä»·ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5,c\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;é¢˜é¢æ˜¯é‡æ„è¿‡çš„ï¼ŒåŸæ¥çš„é¢˜é¢å¤ªæœ‰æ­§ä¹‰äº†ã€‚ç»å¤§å¤šæ•°äººæ²¡åšå‡ºæ¥å°±æ˜¯å› ä¸ºæ²¡çœ‹æ‡‚é¢˜å§ï¼&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æš´åŠ›ï¼Œå¯ä»¥æƒ³åˆ°ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºå¤„ç†å®Œ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¿‡åè´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æœ€å°ä»£ä»·ï¼ˆæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,c}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,0}\)&lt;/span&gt; æ˜¯ç­‰æ•ˆçš„ï¼Œæ•…èˆå¼ƒå‰è€…ï¼‰ã€‚è®° &lt;span class=&#34;math inline&#34;&gt;\(k=\left\lceil\dfrac {v_i}c\right\rceil,w=(v_i\bmod c - 1)\bmod c+1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,(j+v_i)\bmod c}\gets f_{i-1,j}+k\cdot a_i+(k-1)\cdot b +
\begin{cases}
b&amp;amp;j+w=c\\
a_i+b&amp;amp;j+w&amp;gt; c\\
0&amp;amp;\text{otherwise}
\end{cases}\\
f_{i,0}\gets f_{i,j}+b
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¹‹é—´æ˜¯å­˜åœ¨å¯¹åº”å…³ç³»çš„ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥ç»§æ‰¿ï¼ˆçœŸå®çš„ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åº”è¯¥ä½äº &lt;span class=&#34;math inline&#34;&gt;\(-s_i\)&lt;/span&gt; çš„ä½ç½®ï¼‰ï¼Œå†åšå…¨å±€åŠ ã€åŒºé—´åŠ ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{i,0}\)&lt;/span&gt; çš„è½¬ç§»æ˜¯å…¨å±€ minï¼Œçº¿æ®µæ ‘ç»´æŠ¤å³å¯ï¼›æ¯æ¬¡åªä¼šæ–°å¢ä¸€ä¸ªçŠ¶æ€ï¼ŒåŠ¨æ€å¼€ç‚¹å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e6 + 5;
const __int128 inf = 1e18;
struct &amp;#123;
    int l, r;
    __int128 u, d;
&amp;#125; t[maxn];
#define lt t[p].l
#define rt t[p].r
int tot;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d += t[p].d, t[lt].u += t[p].d;
        t[rt].d += t[p].d, t[rt].u += t[p].d;
        t[p].d = 0ll;
    &amp;#125;
    return;
&amp;#125;
void upd(int &amp;amp;p, int l, int r, int x, __int128 v) &amp;#123;
    if (!p)
        p = ++tot, t[p].u = v;
    else
        t[p].u = std::min(t[p].u, v);
    if (l == r)
        return;
    pushdown(p);
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, l, mid, x, v);
    else
        upd(rt, mid + 1, r, x, v);
    return;
&amp;#125;
void add(int p, int l, int r, int ql, int qr, __int128 v) &amp;#123;
    if (!p)
        return;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr) &amp;#123;
        t[p].d += v, t[p].u += v;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    pushdown(p);
    if (ql &amp;lt;= mid)
        add(lt, l, mid, ql, qr, v);
    if (qr &amp;gt; mid)
        add(rt, mid + 1, r, ql, qr, v);
    t[p].u = std::min(t[lt].u, t[rt].u);
    return;
&amp;#125;
__int128 ask(int p, int l, int r, int x) &amp;#123;
    if (l == r)
        return t[p].u;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    pushdown(p);
    if (x &amp;lt;= mid)
        return ask(lt, l, mid, x);
    return ask(rt, mid + 1, r, x);
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;robot.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;robot.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;ex_robot4.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    t[0].u = inf;
    int n, b, c, p0 = 0, rt = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; c &amp;gt;&amp;gt; b;
    std::vector&amp;lt;int&amp;gt; a(n + 1), v(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; v[i];
    upd(rt, 0, c - 1, 0, 0ll);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        __int128 k = (v[i] + c - 1) / c, w = (v[i] % c == 0 ? c : v[i] % c);
        t[rt].d += k * a[i] + (k - 1) * b;
        t[rt].u += k * a[i] + (k - 1) * b;
        if (w &amp;lt;= c)
            add(rt, 0, c - 1, (c - w + p0) % c, (c - w + p0) % c, b);
        if (w != 1) &amp;#123;
            int l = (c - w + p0 + 1) % c, r = (p0 + c - 1) % c;
            if (l &amp;lt;= r)
                add(rt, 0, c - 1, l, r, a[i] + b);
            else &amp;#123;
                add(rt, 0, c - 1, 0, r, a[i] + b);
                add(rt, 0, c - 1, l, c - 1, a[i] + b);
            &amp;#125;
        &amp;#125;
        p0 = (p0 + c - v[i] % c) % c;
        upd(rt, 0, c - 1, p0, t[rt].u + b);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; (long long)ask(rt, 0, c - 1, p0) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-å¥—å¨ƒ&#34;&gt;D. å¥—å¨ƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6502/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6502/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šåˆå§‹ä¸ºå…¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n + 1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡å•ç‚¹ +1 æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåï¼Œæ±‚è§£ï¼š&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å‰ç¼€å’Œæ•°ç»„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œä½¿å¾—å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå‡æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\cdot i\ge s_i\)&lt;/span&gt; æˆç«‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6\)&lt;/span&gt;ï¼Œæ—¶é™ 0.5sã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;è¶£äº‹ä¸€åˆ™&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;è€ƒåœºä¸Šæœ€å 10min æ‹¿åˆ°é¢˜ï¼Œæ†‹äº†ä¸€ä¸ªèƒ½æ‹¿åˆ° 96pts çš„å‡åšæ³•ï¼šæ³¨æ„åˆ°å‰ç¼€å’Œæ˜¯å•å¢çš„ï¼Œéœ€è¦ç»´æŠ¤æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {s_i}i\)&lt;/span&gt;ï¼Œç”±äºåç¼€ +1 å¸¦æ¥çš„å½±å“å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥çŒœæµ‹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åªä¼šåœ¨åŸæ¥çš„å’Œä¿®æ”¹çš„ç‚¹ä¹‹é—´å˜åŒ–ã€‚åªç”¨ 10 è¡Œçš„æ ¸å¿ƒä»£ç å°±èƒ½æ‹¿åˆ°å¾ˆå¤šåˆ†ã€‚ä½†æ˜¯å±…ç„¶æœ‰è¿™ä¹ˆå¤šï¼Œå¯èƒ½å‡ºé¢˜äººéƒ½æ²¡æœ‰æƒ³åˆ°çœŸæœ‰äººæ•¢äº¤è¿™ç§åšæ³•å§ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
    std::freopen(&amp;quot;doll.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;doll.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    auto stime = std::chrono::steady_clock::now();
    int n, res = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; bit(n + 2);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x) &amp;#123;
        for (; x &amp;lt;= n + 1; x += lowbit(x))
            ++bit[x];
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        int res = 0;
        for (; x; x -= lowbit(x))
            res += bit[x];
        return res;
    &amp;#125;;
    int p = 1;
    for (int i = 1, x; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x, add(++x);
        long long s = ask(x), t = ask(p);
        if (s * p == t * x ? x &amp;gt; p : s * p &amp;gt; t * x)
            p = x;
        else
            s = t;
        if (s &amp;gt; p * res)
            ++res;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::cerr &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt;(std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;å¾ˆå®¹æ˜“å†™å‡ºæš´åŠ›ï¼Œè§‚å¯Ÿæ ·ä¾‹å°±èƒ½å‘ç°æ¯æ¬¡ä¿®æ”¹åç­”æ¡ˆæœ€å¤šå¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚è®°å½“å‰ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(res\)&lt;/span&gt;ï¼Œçº¿æ®µæ ‘ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(s_i-res\cdot i\)&lt;/span&gt; çš„æœ€å°å€¼ï¼Œè‹¥å…¶ä¸ºè´Ÿåˆ™ res++ï¼Œç„¶åé‡æ„çº¿æ®µæ ‘ï¼ˆç­‰å·®æ•°åˆ—å’Œ min ä¸å…¼å®¹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆåˆæœ‰ä¸ç­‰å¼ ğŸ˜±&lt;/p&gt;
&lt;p&gt;ç›®çš„æ˜¯åœ¨æœ¬æ¥åˆæ³•çš„èŒƒå›´é‡Œæ‰¾åˆ°æ–°çš„ä¸åˆæ³•å€¼ã€‚è€ƒè™‘åˆæ³•èŒƒå›´ï¼š&lt;span class=&#34;math inline&#34;&gt;\(s_i-res\cdot i\ge 0\)&lt;/span&gt;ï¼Œè§£ä¸€ä¸‹å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\le \dfrac {s_i}{res}\)&lt;/span&gt;ï¼Œæ”¾ç¼©å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\le\dfrac {n}{res}\)&lt;/span&gt;ï¼Œæ¯æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(res\)&lt;/span&gt; å˜åŒ–æ—¶åªé‡æ„ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {n}{res}\)&lt;/span&gt; ä»¥å‰çš„ä½ç½®ï¼Œé‡æ„çš„æ€»é•¿æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\ln n)\)&lt;/span&gt; çš„ã€‚ï¼ˆçº¿æ®µæ ‘å»ºæ ‘æ˜¯çº¿æ€§çš„ï¼‰&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
const int inf = 0x3f3f3f3f;
struct &amp;#123;
    int l, r, u, d;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].u = t[p].l = l, t[p].r = r;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d += t[p].d, t[rt].d += t[p].d;
        t[lt].u -= t[p].d, t[rt].u -= t[p].d;
        t[p].d = 0;
    &amp;#125;
    return;
&amp;#125;
void add(int p, int x) &amp;#123;
    if (x &amp;lt;= t[p].l) &amp;#123;
        ++t[p].d, --t[p].u;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, x);
    add(rt, x);
    t[p].u = std::min(t[lt].u, t[rt].u);
    // printf(&amp;quot;[%d, %d]: %d, [%d, %d]: %d\n&amp;quot;, t[p].l, mid, t[lt].u, mid + 1, t[p].r, t[rt].u);
    return;
&amp;#125;
void rem(int p, int r) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        t[p].u += t[p].l;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;lt;= mid)
        rem(lt, r), t[rt].u = inf;
    else
        rem(lt, r), rem(rt, r);
    t[p].u = std::min(t[lt].u, t[rt].u);
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;doll.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;doll.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    bld(1, 1, n + 1);
    for (int i = 1, x, res = 1, now = n; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x;
        if (x &amp;lt;= now)
            add(1, ++x);
        if (t[1].u &amp;lt; 0) &amp;#123;
            std::cout &amp;lt;&amp;lt; ++res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
            rem(1, now = n / res);
        &amp;#125;
        else
            std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
        // puts(&amp;quot;&amp;quot;);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---subarray-sum-divisibility&#34;&gt;E - Subarray Sum Divisibility&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¨¡æ„ä¹‰ä¸‹çš„æ•°åˆ—å…¨ç­‰ï¼Œå¯ä»¥å¯¹åº”åŸæ•°ç»„å…¨ç­‰ã€å·®åˆ†å…¨ç­‰ã€å‰ç¼€å’Œå…¨ç­‰ï¼ˆéƒ½æ˜¯æ¨¡æ„ä¹‰ä¸‹çš„ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¸€äº›çº¿æ€§å’Œéçº¿æ€§çš„å˜æ¢ä¹Ÿå¯ä»¥ï¼‰&lt;/p&gt;
&lt;p&gt;æœ¬ç€ä¿®æ”¹çš„ç‚¹å°½é‡å°‘çš„æƒ³æ³•ï¼Œå¦‚æœé¢˜ç›®ç»™å®šå•ç‚¹ä¿®æ”¹å°±å¯ä»¥åœ¨åŸæ•°ç»„ä¸Šåšæ–‡ç« ï¼Œç»™å®šåŒºé—´ä¿®æ”¹å¯ä»¥è€ƒè™‘å·®åˆ†æ•°ç»„ï¼Œå‰ç¼€å’Œå¯¹äºä¸€äº›åŒºé—´æŸ¥è¯¢æœ‰ä¼˜åŠ¿&lt;/p&gt;
&lt;p&gt;å…¶ä»–ä¸¤ç§ç”¨å¾—ä¹Ÿå¾ˆå¤šï¼Œåƒè¿™é¢˜åªéœ€è¦ç”¨åŸæ•°ç»„å…¨ç­‰å°±å¯ä»¥åšäº†&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, l;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; l;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; u(l + 1, std::vector&amp;lt;int&amp;gt; (m));
    for (int i = 1; i &amp;lt;= l; ++i)
        for (int j = 0; j &amp;lt; m; ++j)
            for (int k = i; k &amp;lt;= n; k += l)
                u[i][j] += (j + m - a[k]) % m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; f(l + 1, std::vector&amp;lt;int&amp;gt; (m, inf));
    f[0][0] = 0;
    for (int i = 1; i &amp;lt;= l; ++i)
        for (int j = 0; j &amp;lt; m; ++j)
            for (int k = 0; k &amp;lt; m; ++k)
                f[i][(j + k) % m] = std::min(f[i][(j + k) % m], f[i - 1][j] + u[i][k]);
    std::cout &amp;lt;&amp;lt; f[l][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---all-included&#34;&gt;F - All Included&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_f&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_f&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åŸé¢˜æ„è½¬åŒ–ä¸ºåœ¨ AC è‡ªåŠ¨æœºä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; æ­¥ï¼Œè¦æ±‚ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå¶å­çš„æ–¹æ¡ˆæ•°ã€‚ä¸å¤ªå¯åšï¼Œè½¬åŒ–æˆå®¹æ–¥ï¼ˆä»¤å­—ç¬¦ä¸²ç»ˆç‚¹ä¸å¯è¾¾ï¼‰ã€‚åœ¨å¤–å±‚æšä¸¾æ­¥æ•°æš´åŠ›æ¸¸èµ°ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚æ°å¥½èµ° &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; æ­¥ï¼Œä¹Ÿå¯ä»¥ç”¨çŸ©é˜µï¼›ä½†åŸå›¾å¾ˆç¨€ç–ï¼Œæ‰€ä»¥çŸ©é˜µå¹¶æ²¡æœ‰ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int tot = 1, T[805][26], fail[805];
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, l;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; l;
    std::vector&amp;lt;std::string&amp;gt; a;
    &amp;#123;
        std::vector&amp;lt;std::string&amp;gt; s(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; s[i];
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            bool flag = 1;
            for (int j = 1; j &amp;lt;= n; ++j)
                if (j != i)
                    if (s[j].find(s[i]) != std::string::npos) &amp;#123;
                        flag = 0;
                        break;
                    &amp;#125;
            if (flag)
                a.push_back(s[i]);
        &amp;#125;
        n = (int)a.size();
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; pos(n);
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        int &amp;amp;p = pos[i];
        for (auto j : a[i]) &amp;#123;
            if (!T[p][j - &amp;#39;a&amp;#39;])
                T[p][j - &amp;#39;a&amp;#39;] = tot++;
            p = T[p][j - &amp;#39;a&amp;#39;];
        &amp;#125;
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    auto res = 0ll;
    int siz = 1 &amp;lt;&amp;lt; n;
    for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; tag(tot);
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1)
                tag[pos[j]] = 1;
        std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(l + 1, std::vector&amp;lt;long long&amp;gt; (tot));
        f[0][0] = 1ll;
        for (int j = 0; j &amp;lt; l; ++j)
            for (int k = 0; k &amp;lt; tot; ++k)
                for (int a = 0; a &amp;lt; 26; ++a) &amp;#123;
                    if (!tag[T[k][a]])
                        (f[j + 1][T[k][a]] += f[j][k]) %= mod;
                &amp;#125;
        int k = (__builtin_popcount(i) &amp;amp; 1 ? mod - 1 : 1);
        auto s = 0ll;
        for (int j = 0; j &amp;lt; tot; ++j)
            if (!tag[j])
                (s += f[l][j]) %= mod;
        (res += k * s) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;g---count-simple-paths-2&#34;&gt;G - Count Simple Paths 2&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆæ–°çš„æ€§è´¨ã€‚è€ƒè™‘ã€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºèµ·ç‚¹çš„ç®€å•è·¯å¾„æ•°ã€å’Œåç¥–è¾¹æ•°é‡çš„å…³ç³»ï¼šé€‰å®šä¸€æ¡åç¥–è¾¹å¿…é¡»è¢«ç»è¿‡æ—¶ï¼ˆæ˜¾ç„¶åªæœ‰ä¸€ç§å¯èƒ½çš„ç»è¿‡æ–¹å‘ï¼‰ï¼Œæ ‘çš„å½¢æ€å‘ç”Ÿå˜åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ç§åç¥–è¾¹çš„é€‰å–æ–¹æ¡ˆå¯¹åº”ä¸€ç§æ ‘ï¼Œéå†å…¶ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¼€å§‹çš„ç®€å•è·¯å¾„å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚è®¾åç¥–è¾¹æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåˆæ³•çš„æ–¹æ¡ˆæ•°ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(2^k\)&lt;/span&gt;ï¼Œæš´åŠ› DFS çš„æ•´ä¸ªå›¾å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(2^k\cdot n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å¾ˆå¤šè·Ÿåç¥–è¾¹æ— å…³çš„éå†æ˜¯ä¸å¿…è¦çš„ï¼ˆåªæœ‰ä¸€ç§èµ°æ³•ï¼Œå¯ä»¥è®¾æˆè¾¹æƒï¼‰ï¼Œè€ƒè™‘å¯¹æ‰€æœ‰è¿æ¥åç¥–è¾¹çš„ç‚¹å»ºç«‹è™šæ ‘ï¼Œå¹¶æŠŠåŸæ ‘ä¸Šçš„åç¥–è¾¹ä¹Ÿç§»åˆ°è™šæ ‘ä¸Šï¼Œå°±èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(2^k\cdot k)\)&lt;/span&gt; è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1), g1(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g2(n + 1);
    for (int x, y; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1), vis(n + 1);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; be;
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        static int now = 0;
        tag[x] = 1, vis[x] = ++now;
        for (auto i : g[x])
            if (!tag[i]) &amp;#123;
                // fprintf(stderr, &amp;quot;%d -&amp;gt; %d\n&amp;quot;, x, i);
                g1[x].push_back(i), DFS(i, x);
            &amp;#125;
            else if (i != fa &amp;amp;&amp;amp; vis[i] &amp;lt; vis[x])
                be.emplace_back(i, x);
        return;
    &amp;#125;;
    DFS(1, -1);
    &amp;#123; // æ±‚è™šæ ‘
        std::vector&amp;lt;int&amp;gt; dep(n + 1), fa(n + 1), top(n + 1), siz(n + 1), son(n + 1), dfn(n + 1), rfn(n + 1);
        std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
            siz[x] = 1;
            for (auto i : g1[x]) &amp;#123;
                dep[i] = dep[x] + 1;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
            return;
        &amp;#125;;
        DFS(1);
        DFS = [&amp;amp;](int x) &amp;#123;
            static int now = 0;
            dfn[x] = ++now;
            if (son[x])
                top[son[x]] = top[x], DFS(son[x]);
            for (auto i : g1[x])
                if (i != son[x])
                    top[i] = i, DFS(i);
            rfn[x] = now;
            // printf(&amp;quot;%d: [%d, %d]\n&amp;quot;, x, dfn[x], rfn[x]);
            return;
        &amp;#125;;
        top[1] = 1, DFS(1);
        auto getLCA = [&amp;amp;](int x, int y) &amp;#123;
            for (; top[x] != top[y]; x = fa[top[x]])
                if (dep[top[x]] &amp;lt; dep[top[y]])
                    std::swap(x, y);
            return dep[x] &amp;lt; dep[y] ? x : y;
        &amp;#125;;
        tag.assign(n + 1, 0);
        tag[1] = tag[n] = 1;
        for (auto [u, v] : be)
            tag[u] = 1, tag[v] = 1;
        std::vector&amp;lt;int&amp;gt; p;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (tag[i])
                p.push_back(i);
        std::sort(p.begin(), p.end(), [&amp;amp;](int i, int j) &amp;#123; return dfn[i] &amp;lt; dfn[j]; &amp;#125;);
        for (int i = 1; i &amp;lt; (int)p.size(); ++i) &amp;#123;
            int fa = getLCA(p[i], p[i - 1]);
            if (!tag[fa])
                tag[fa] = 1;
        &amp;#125;
        p.clear();
        for (int i = 1; i &amp;lt;= n; ++i)
            if (tag[i])
                p.push_back(i);
        std::sort(p.begin(), p.end(), [&amp;amp;](int i, int j) &amp;#123; return dfn[i] &amp;lt; dfn[j]; &amp;#125;);
        std::vector&amp;lt;int&amp;gt; st;
        for (auto i : p) &amp;#123;
            if (st.empty())
                st.push_back(i);
            else &amp;#123;
                for (; rfn[st.back()] &amp;lt; dfn[i]; st.pop_back());
                g2[st.back()].emplace_back(i, dep[i] - dep[st.back()]);
                g2[i].emplace_back(st.back(), dep[i] - dep[st.back()]);
                // printf(&amp;quot;add (%d, %d): %d\n&amp;quot;, st.back(), i, dep[i] - dep[st.back()]);
                st.push_back(i);
            &amp;#125;
        &amp;#125;
        for (auto [u, v] : be) &amp;#123;
            g2[u].emplace_back(v, 1), g2[v].emplace_back(u, 1);
            // printf(&amp;quot;# add(%d, %d): 1\n&amp;quot;, u, v);
        &amp;#125;
    &amp;#125;
    tag.assign(n + 1, 0);
    std::vector&amp;lt;int&amp;gt; res(n + 1);
    DFS = [&amp;amp;](int x, int s) &amp;#123;
        if (x == n)
            ++res[s];
        tag[x] = 1;
        for (auto [i, w] : g2[x])
            if (!tag[i])
                DFS(i, s + w);
        tag[x] = 0;
        return;
    &amp;#125;;
    DFS(1, 0);
    for (int i = 1; i &amp;lt; n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <category term="AC è‡ªåŠ¨æœº" />
        <category term="è´ªå¿ƒ" />
        <category term="DP ä¼˜åŒ–" />
        <category term="è™šæ ‘" />
        <updated>2025-08-16T08:14:12.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250814/</id>
        <title>DDP ä¸ GBT ç»ƒä¹ </title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250814/"/>
        <content type="html">&lt;p&gt;çº¿æ®µæ ‘æ˜¯å¯¹çš„ï¼ˆå­˜ç–‘ï¼‰&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---æ•°æ®ä¼ è¾“&#34;&gt;A - æ•°æ®ä¼ è¾“&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P8820&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P8820&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°äº† &lt;a href=&#34;/20250812/#æ ‘ä¸Šè·¯å¾„æŸ¥è¯¢&#34;&gt;DDP &amp;amp; è·¯å¾„æŸ¥è¯¢é—®é¢˜&lt;/a&gt;ï¼Œåœ¨è¿™ä¸ªé¢˜ä¸­å°±æœ‰ä½“ç°ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,0/1/2}\)&lt;/span&gt; è¡¨ç¤ºæ•°æ®ä¿å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¾€ä¸‹æ•° &lt;span class=&#34;math inline&#34;&gt;\(0/1/2\)&lt;/span&gt; ä¸ªç‚¹å¤„çš„æœ€å°ä»£ä»·ï¼Œæ‰‹ç©å®¹æ˜“å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(k=3\)&lt;/span&gt; æ—¶&lt;strong&gt;æœ€ä¼˜è·¯å¾„å¯èƒ½ä¼šå¾€æŸä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(fa\)&lt;/span&gt; å¤„çš„æœ€å°ä»£ä»·å„¿å­å¤„ç»•ä¸€åœˆæ¥é¿å…è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(fa\)&lt;/span&gt; çš„ä»£ä»·&lt;/strong&gt;ã€‚ä½†è¯¥å€¼æ˜¯å®šå€¼ï¼Œé—®é¢˜è¿˜æ˜¯çº¯è·¯å¾„é—®é¢˜ï¼Œå°±å¯ä»¥ DDP äº†ã€‚&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;image.png&#34; alt=&#34;å…±ä¸¤ç§å¯èƒ½æ€§ï¼ˆä»»æ„ä¸€ä¸ªç®­å¤´é•¿åº¦ä¸ä¸º 3 æ—¶ç»•ä¸€åœˆä¸€å®šä¸æ¯”ç›´æ¥èµ°æ›´ä¼˜ï¼‰&#34; /&gt;&lt;figcaption&gt;å…±ä¸¤ç§å¯èƒ½æ€§ï¼ˆä»»æ„ä¸€ä¸ªç®­å¤´é•¿åº¦ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; æ—¶ç»•ä¸€åœˆä¸€å®šä¸æ¯”ç›´æ¥èµ°æ›´ä¼˜ï¼‰&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
struct mat &amp;#123;
    long long a[3][3];
    long long* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    mat() &amp;#123;
        memset(a, 0x3f, sizeof (a));
        return;
    &amp;#125;
    mat(int flag) &amp;#123;
        memset(a, 0x3f, sizeof (a));
        a[0][0] = a[1][1] = a[2][2] = 0ll;
        return;
    &amp;#125;
    mat operator* (mat &amp;amp;q) const &amp;#123;
        mat res;
        for (int i = 0; i &amp;lt; 3; ++i)
            for (int k = 0; k &amp;lt; 3; ++k)
                for (int j = 0; j &amp;lt; 3; ++j)
                    res[i][k] = std::min(res[i][k], a[i][j] + q[j][k]);
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, q, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;int&amp;gt; mx(n + 1, 0x3f3f3f3f);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        mx[x] = std::min(mx[x], a[y]);
        mx[y] = std::min(mx[y], a[x]);
        g1[x].push_back(y), g1[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; dep(n + 1);
    std::vector&amp;lt;std::array&amp;lt;int, 18&amp;gt; &amp;gt; f(n + 1);
    std::vector&amp;lt;std::array&amp;lt;mat, 18&amp;gt; &amp;gt; u(n + 1), d(n + 1);
    u[0][0] = d[0][0] = mat(1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        for (auto i : g1[x])
            if (i != f[x][0]) &amp;#123;
                f[i][0] = x;
                &amp;#123;
                    mat s;
                    s[0][0] = a[x];
                    if (k &amp;gt;= 2) &amp;#123;
                        s[0][1] = 0;
                        s[1][0] = a[x];
                    &amp;#125;
                    if (k &amp;gt;= 3) &amp;#123;
                        s[1][2] = 0;
                        s[2][0] = a[x];
                        s[1][1] = mx[x];
                        s[2][2] = mx[i];
                    &amp;#125;
                    u[i][0] = s; 
                    s[0][0] = a[i];
                    if (k &amp;gt;= 2)
                        s[1][0] = a[i];
                    if (k &amp;gt;= 3) &amp;#123;
                        s[2][0] = a[i];
                        s[1][1] = mx[i];
                        s[2][2] = mx[x];
                    &amp;#125;
                    d[i][0] = s; 
                &amp;#125;
                for (int j = 1; j &amp;lt; 18; ++j) &amp;#123;
                    f[i][j] = f[f[i][j - 1]][j - 1];
                    u[i][j] = u[i][j - 1] * u[f[i][j - 1]][j - 1];
                    d[i][j] = d[f[i][j - 1]][j - 1] * d[i][j - 1];
                &amp;#125;
                dep[i] = dep[x] + 1;
                DFS(i);
            &amp;#125;
        return;
    &amp;#125;;
    dep[1] = 1, DFS(1);
    for (int x, y; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        long long res = a[x];
        mat r1(1), r2(1);
        if (dep[x] &amp;gt; dep[y]) &amp;#123;
            for (int i = 17; ~i; --i)
                if (dep[f[x][i]] &amp;gt;= dep[y]) &amp;#123;
                    r1 = r1 * u[x][i];
                    x = f[x][i];
                &amp;#125;
        &amp;#125;
        else if (dep[y] &amp;gt; dep[x]) &amp;#123;
            for (int i = 17; ~i; --i)
                if (dep[f[y][i]] &amp;gt;= dep[x]) &amp;#123;
                    r2 = d[y][i] * r2;
                    y = f[y][i];
                &amp;#125;
        &amp;#125;
        if (x != y) &amp;#123;
            for (int i = 17; ~i; --i)
                if (f[x][i] != f[y][i]) &amp;#123;
                    r1 = r1 * u[x][i];
                    r2 = d[y][i] * r2;
                    x = f[x][i], y = f[y][i];
                &amp;#125;
            r1 = r1 * u[x][0], r2 = d[y][0] * r2;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; res + (r1 * r2)[0][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---the-silk-road-with-robots&#34;&gt;B - The Silk Road â€¦ with Robots!&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://qoj.ac/problem/10410&#34; class=&#34;uri&#34;&gt;https://qoj.ac/problem/10410&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢˜æ„ï¼šåˆå§‹æœ‰ä¸€ä¸ªé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(10^8\)&lt;/span&gt; çš„ç©ºæ•°è½´ï¼Œç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåœ¨æ•°è½´ä¸Šçš„ä¸€ä¸ªç©ºä½æ”¾ä¸€ä¸ª A ç±»ç‚¹æˆ– B ç±»ç‚¹ã€‚æ¯ä¸ª A ç±»ç‚¹æœ‰å…¶&lt;strong&gt;ä»·å€¼&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»»æ„åœ¨æ•°è½´ä¸Šç§»åŠ¨è¿™äº› B ç±»ç‚¹ï¼Œ&lt;strong&gt;æ€»ä»·å€¼&lt;/strong&gt;ä¸ºæ‰€æœ‰è¢«ç»è¿‡çš„ A ç±»ç‚¹çš„&lt;strong&gt;ä»·å€¼&lt;/strong&gt; - B ç±»ç‚¹ç§»åŠ¨æ€»è·¯ç¨‹ã€‚æ¯æ¬¡æ“ä½œåè¾“å‡ºæœ€å¤§&lt;strong&gt;æ€»ä»·å€¼&lt;/strong&gt;ï¼Œé‡å¤ç»è¿‡çš„ A ç±»ç‚¹åªè®¡ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ä¸ªé¢˜ç¡®å®å¯ä»¥å¸¦æ¥å¾ˆå¤šå¯å‘ï¼Œæˆ‘ä¸€å¼€å§‹ç›´æ¥è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_j\)&lt;/span&gt; ä¸ºçŠ¶æ€ï¼Œè¿™æ ·å¯¹äºæš´åŠ›æ˜¯å¯åšçš„ï¼Œä½†æ˜¯ä¼šå‡ºç°ä¸€äº›éœ€è¦è¢«åŒºé—´ä¿®æ”¹çš„ç³»æ•°ï¼Œæ¯”å¦‚&lt;strong&gt;å‰ç¼€å’Œ&lt;/strong&gt;ã€‚æœ€å¥½è®¾è®¡çŠ¶æ€ï¼Œè®©è½¬ç§»çš„æ—¶å€™åªéœ€è¦ç”¨åˆ°å¸¸æ•°ã€å·®åˆ†å€¼ç­‰ä¿®æ”¹æ¬¡æ•°å¾ˆå°‘çš„ç³»æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,0/1/2/3}\)&lt;/span&gt; åˆ†åˆ«è¡¨ç¤ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-1.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥å†™å‡ºè½¬ç§»å¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,0}=\max(mx+a_i+x_i,f_{i-1,0}+a_i)\\
f_{i,1}=\max(mx+a_i+2x_i,f_{i-1,1}+a_i)\\
f_{i,2}=f_{i-1,2}-(x_i-x_{i-1}) + a_i\\
f_{i,3}=f_{i-1,3}-2(x_i-x_{i-1})+a_i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(mx\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{i,2/3}\)&lt;/span&gt; çš„å‰ç¼€æœ€å¤§å€¼ã€‚åœ¨ B ç±»ç‚¹å¤„å¯ä»¥è®© &lt;span class=&#34;math inline&#34;&gt;\(f_{2/3}\)&lt;/span&gt; ç»§æ‰¿å¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(f_{0/1}\)&lt;/span&gt;ï¼Œæ–°å¼€ä¸€ç»´è®°å½• &lt;span class=&#34;math inline&#34;&gt;\(mx\)&lt;/span&gt; å°±å¯ä»¥ç»´æŠ¤çŸ©ä¹˜äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int lim = 1e8;
const int maxn = 5e6 + 5;
const long long inf = 1e12;
struct mat &amp;#123;
    long long a[5][5];
    mat() &amp;#123;&amp;#125;
    long long* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    mat operator* (mat &amp;amp;q) const &amp;#123;
        mat res;
        for (int i = 0; i &amp;lt; 5; ++i)
            for (int k = 0; k &amp;lt; 5; ++k) &amp;#123;
                auto u(-inf);
                for (int j = 0; j &amp;lt; 5; ++j)
                    u = std::max(u, a[i][j] + q[j][k]);
                res[i][k] = u;
            &amp;#125;
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int l, r; mat u; &amp;#125; t[maxn];
#define lt t[p].l
#define rt t[p].r
void add(int &amp;amp;p, int l, int r, int x, mat &amp;amp;v) &amp;#123;
    static int tot = 0;
    if (!p)
        p = ++tot;
    if (l == r) &amp;#123;
        t[p].u = v;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, l, mid, x, v);
    else
        add(rt, mid + 1, r, x, v);
    t[p].u = t[lt].u * t[rt].u;
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    &amp;#123;
        mat &amp;amp;u = t[0].u;
        for (int i = 0; i &amp;lt; 5; ++i)
            for (int j = 0; j &amp;lt; 5; ++j)
                u[i][j] = -inf;
        u[0][0] = u[1][1] = u[2][2] = u[3][3] = u[4][4] = 0ll;
    &amp;#125;
    int m, rt = 0;
    std::cin &amp;gt;&amp;gt; m;
    std::vector&amp;lt;mat&amp;gt; a(m + 1);
    std::vector&amp;lt;int&amp;gt; ty(m + 1);
    std::set&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; s;
    s.emplace(-inf, 0);
    for (int op, x, i = 1; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; op &amp;gt;&amp;gt; x;
        auto &amp;amp;u = a[i];
        for (int i = 0; i &amp;lt; 5; ++i)
            for (int j = 0; j &amp;lt; 5; ++j)
                u[i][j] = -inf;
        auto p = --s.lower_bound(std::make_pair(x, 0)), q = s.upper_bound(std::make_pair(x, 0));
        int v = 0;
        if (op == 2)
            std::cin &amp;gt;&amp;gt; v;
        u[0][0] = v, u[1][1] = v, u[4][0] = v + x, u[4][1] = v + 2 * x;
        if (op == 1) &amp;#123;
            ty[i] = 0;
            u[4][2] = u[4][1] - 2 * x;
            u[1][2] = u[1][1] - 2 * x;
            u[4][3] = u[4][0] - x;
            u[0][3] = u[0][0] - x;
        &amp;#125;
        else &amp;#123;
            ty[i] = 1;
            u[2][2] = v - (x - p-&amp;gt;first);
            u[3][3] = v - 2 * (x - p-&amp;gt;first);
        &amp;#125;
        u[4][4] = std::max(&amp;#123; 0ll, u[4][2], u[4][3] &amp;#125;);
        u[1][4] = u[1][2], u[0][4] = u[0][3], u[2][4] = u[2][2], u[3][4] = u[3][3];
        add(rt, 0, lim, x, u);
        if (q != s.end() &amp;amp;&amp;amp; ty[q-&amp;gt;second] == 1) &amp;#123;
            auto &amp;amp;u = a[q-&amp;gt;second];
            u[2][2] -= p-&amp;gt;first, u[2][2] += x;
            u[3][3] -= 2 * p-&amp;gt;first, u[3][3] += 2 * x;
            u[2][4] = u[2][2], u[3][4] = u[3][3];
            add(rt, 0, lim, q-&amp;gt;first, a[q-&amp;gt;second]);
        &amp;#125;
        s.emplace(x, i);
        std::cout &amp;lt;&amp;lt; t[1].u[4][4] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        // for (int i = 0; i &amp;lt; 5; ++i, puts(&amp;quot;&amp;quot;))
        //     for (int j = 0; j &amp;lt; 5; ++j)
        //         if (t[1].u[i][j] &amp;lt; -200)
        //             printf(&amp;quot;  x &amp;quot;);
        //         else
        //             printf(&amp;quot;%3lld &amp;quot;, t[1].u[i][j]);
        // puts(&amp;quot;=============&amp;quot;);
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---å¯†ç ç®±&#34;&gt;C - å¯†ç ç®±&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;/20250818/#c---%E5%AF%86%E7%A0%81%E7%AE%B1&#34;&gt;link&lt;/a&gt;;&lt;/p&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <category term="DDP" />
        <updated>2025-08-14T09:08:21.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250812/</id>
        <title>DDP ä¸å…¨å±€å¹³è¡¡äºŒå‰æ ‘</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250812/"/>
        <content type="html">&lt;p&gt;å…¶å®åŠ¨æ€ DP ä¸æ˜¯åŠ¨æ€æ ‘ DP çš„åŒä¹‰è¯&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;åŠ¨æ€-dp&#34;&gt;åŠ¨æ€ DP&lt;/h2&gt;
&lt;p&gt;å¯¹äºè½¬ç§»åªä¾èµ–å‰å‡ é¡¹çš„ DPï¼Œå¯ä»¥æ”¾è¿›çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;é»˜è®¤è½¬ç§»èŒƒå›´æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\([1,n]\)&lt;/span&gt;ï¼›å¦‚æœæˆ‘ä»¬éœ€è¦æ”¹å˜æ±‚è§£èŒƒå›´ï¼Œå‘ç°å¦‚æœèƒ½è·å–è½¬ç§»çŸ©é˜µçš„ä¹˜ç§¯å°±å¾ˆå¿«äº†ã€‚è€ƒè™‘å­˜ä¸‹æ¥ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœéœ€è¦å•ç‚¹ä¿®æ”¹ï¼Œç­‰ä»·äºä¿®æ”¹å…¶æ‰€åœ¨çŸ©é˜µï¼Œåˆ™æƒ³è¦å°½å¯èƒ½å°‘åœ°ä¿®æ”¹å­˜å‚¨çš„ç­”æ¡ˆï¼Œè€ƒè™‘ä½¿ç”¨çº¿æ®µæ ‘ä¼˜åŒ–è¯¥è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¾‹æµ·æŠ¥&#34;&gt;ä¾‹ï¼šæµ·æŠ¥&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9790&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9790&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“åˆ—å‡ºæš´åŠ› DP å¼ï¼šä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºæšä¸¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶ï¼ŒåŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åœ¨å†…å·²ç»æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªè¿ç»­çš„äººä¸¾èµ·æµ·æŠ¥ï¼Œæ˜“å¾—ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,0}=\max(f_{i-1,0},f_{i-1,1},f_{i-1,2},f_{i-1,3})\\
f_{i,j}=f_{i-1,j-1}+a_i \forall 1\le j\le 3
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°æ»¡è¶³ + / max &lt;strong&gt;çŸ©é˜µä¹˜æ³•&lt;/strong&gt; çš„å½¢å¼ï¼›æƒ³åˆ°ç”¨çº¿æ®µæ ‘ä¿å­˜æ¯æ®µåŒºé—´å¯¹åº”çŸ©é˜µï¼ˆå¯¹åº”æ€§è´¨ï¼šç»“åˆå¾‹ï¼‰ï¼Œæ¯æ¬¡ä¿®æ”¹ / æŸ¥è¯¢å°±èƒ½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt; ä¹‹å†…å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;åŸé—®é¢˜æ˜¯ç¯å½¢çš„ï¼Œå¯ä»¥å†åŠ ä¸€ç»´ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¡¨ç¤ºé’¦å®šé€‰äº†å‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªä¸”ä¸é€‰ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k+1\)&lt;/span&gt; ä¸ªæ—¶çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 4e4 + 5;
const long long inf = 1e18;
struct mat &amp;#123;
    int n, m;
    long long a[4][4];
    mat() &amp;#123;&amp;#125;
    mat(int n1, int m1): n(n1), m(m1) &amp;#123;
        for (int i = 0; i &amp;lt; n; ++i)
            for (int j = 0; j &amp;lt; m; ++j)
                a[i][j] = -inf;
        return;
    &amp;#125;
    long long* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    mat operator* (mat &amp;amp;q) const &amp;#123;
        mat res(n, q.m);
        for (int i = 0; i &amp;lt; n; ++i)
            for (int k = 0; k &amp;lt; q.m; ++k)
                for (int j = 0; j &amp;lt; m; ++j)
                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int l, r; mat u[4]; &amp;#125; t[maxn &amp;lt;&amp;lt; 2];
int a[maxn];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
#define c t[p].u[i]
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        for (int i = 0; i &amp;lt;= 3; ++i) &amp;#123;
            c = mat(4, 4);
            if (l &amp;gt; i + 1) &amp;#123;
                c[0][0] = c[1][0] = c[2][0] = c[3][0] = 0;
                c[0][1] = c[1][2] = c[2][3] = a[l];
            &amp;#125;
            else if (l == i + 1)
                c[0][0] = c[1][0] = c[2][0] = c[3][0] = 0;
            else
                c[0][1] = c[1][2] = c[2][3] = a[l];
        &amp;#125;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    for (int i = 0; i &amp;lt;= 3; ++i)
        t[p].u[i] = t[lt].u[i] * t[rt].u[i];
    return;
&amp;#125;
void add(int p, int x, int v) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        for (int i = 0; i &amp;lt;= 3; ++i)
            if (t[p].l != i + 1) 
                c[0][1] = c[1][2] = c[2][3] = v;
        return;
    &amp;#125;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, x, v);
    else
        add(rt, x, v);
    for (int i = 0; i &amp;lt;= 3; ++i)
        t[p].u[i] = t[lt].u[i] * t[rt].u[i];
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    bld(1, 1, n);
    auto calc = [&amp;amp;](void) &amp;#123;
        mat f(1, 4);
        f[0][0] = 0;
        auto res = -inf;
        for (int i = 0; i &amp;lt;= 3; ++i) &amp;#123;
            auto r = (f * t[1].u[i]);
            for (int j = 0; j &amp;lt;= 3; ++j)
                if (i + j &amp;lt;= 3) &amp;#123;
                    res = std::max(res, r[0][j]);
                    // printf(&amp;quot;f[%d][%d] = %lld\n&amp;quot;, i, j, f[i][j]);
                &amp;#125;
        &amp;#125;
        return res;
    &amp;#125;;
    std::cout &amp;lt;&amp;lt; calc() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    int q;
    std::cin &amp;gt;&amp;gt; q;
    for (int x, v; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; v;
        add(1, x, v);
        std::cout &amp;lt;&amp;lt; calc() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;å‘ç°çŸ©é˜µæœ¬èº«å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ— å…³ï¼Œè¿˜å¯ä»¥å¯ä»¥å…±ç”¨ä¸€ä¸ªçº¿æ®µæ ‘ä¸Šçš„ä¿¡æ¯ï¼Œå°±å¯ä»¥åªå¼€ä¸€ä¸ªçº¿æ®µæ ‘äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;æˆ‘å†™è¿™ä¸€ç‰ˆæœ¬çš„åŸå› æ˜¯ &lt;code&gt;maxn&lt;/code&gt; å¼€å¤§äº†å¯¼è‡´ MLEï¼Œå®é™…ä¸Šå››ä¸ªçº¿æ®µæ ‘æ˜¯æ²¡æœ‰ä»»ä½•ç©ºé—´å‹åŠ›çš„ ğŸ˜…&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 4e5 + 5;
const long long inf = 1e18;
struct mat &amp;#123;
    int n, m;
    long long a[4][4];
    mat() &amp;#123;&amp;#125;
    mat(int n1, int m1): n(n1), m(m1) &amp;#123;
        for (int i = 0; i &amp;lt; n; ++i)
            for (int j = 0; j &amp;lt; m; ++j)
                a[i][j] = -inf;
        return;
    &amp;#125;
    long long* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    mat operator* (mat q) const &amp;#123;
        mat res(n, q.m);
        for (int i = 0; i &amp;lt; n; ++i)
            for (int k = 0; k &amp;lt; q.m; ++k)
                for (int j = 0; j &amp;lt; m; ++j)
                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int l, r; mat u; &amp;#125; t[maxn &amp;lt;&amp;lt; 2];
int a[maxn];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        t[p].u = mat(4, 4);
        t[p].u[0][0] = t[p].u[1][0] = t[p].u[2][0] = t[p].u[3][0] = 0;
        t[p].u[0][1] = t[p].u[1][2] = t[p].u[2][3] = a[l];
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    t[p].u = t[lt].u * t[rt].u;
    return;
&amp;#125;
void add(int p, int x, int v) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        t[p].u[0][1] = t[p].u[1][2] = t[p].u[2][3] = v;
        return;
    &amp;#125;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, x, v);
    else
        add(rt, x, v);
    t[p].u = t[lt].u * t[rt].u;
    return;
&amp;#125;
mat ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;lt;= mid)
        return ask(lt, l, r);
    if (l &amp;gt; mid)
        return ask(rt, l, r);
    return ask(lt, l, r) * ask(rt, l, r);
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    bld(1, 1, n);
    auto calc = [&amp;amp;](void) &amp;#123;
        mat f(1, 4);
        f[0][0] = 0, f[0][1] = f[0][2] = f[0][3] = -inf;
        auto r(f * ask(1, 2, n));
        auto res(*std::max_element(r[0], r[0] + 4));
        mat z(4, 4);
        z[0][0] = z[1][0] = z[2][0] = z[3][0] = 0ll;
        for (int i = 1; i &amp;lt;= 3; ++i) &amp;#123;
            mat op(4, 4);
            op[0][1] = op[1][2] = op[2][3] = a[i];
            f *= op;
            if (i + 2 &amp;lt;= n)
                r = f * z * ask(1, i + 2, n);
            else
                r = f * z;
            res = std::max(res, *std::max_element(r[0], r[0] + 4 - i));
        &amp;#125;
        return res;
    &amp;#125;;
    std::cout &amp;lt;&amp;lt; calc() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    int q;
    std::cin &amp;gt;&amp;gt; q;
    for (int x, v; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; v, a[x] = v;
        add(1, x, v);
        std::cout &amp;lt;&amp;lt; calc() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ç»å…¸é¢˜gss3&#34;&gt;ç»å…¸é¢˜ï¼šGSS3&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/SP1716&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/SP1716&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆæ˜¯å­æ®µå’Œ ğŸ˜“&lt;/p&gt;
&lt;p&gt;åŒæ ·åˆ—å‡ºèƒ½å¤ŸçŸ©é˜µä¹˜æ³•çš„ DP å¼ï¼Œå‘ç°é™åˆ¶åœ¨äºè‡³å°‘è¦é€‰ä¸€ä¸ªæ•°ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i}\)&lt;/span&gt; è¡¨ç¤ºé€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æœ€å¤§å€¼ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(g_i\)&lt;/span&gt; è¡¨ç¤ºå†å²æœ€å¤§å€¼ï¼Œåˆ™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_i=\max(f_{i-1}+a_i,0+a_i)\\
g_i=\max(g_{i-1}+0,f_{i-1}+a_i,0+a_i)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°æ˜¯ä¸€ä¸ª + / max çŸ©ä¹˜ï¼Œçº¿æ®µæ ‘ç»´æŠ¤å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 4e5 + 5;
const long long inf = 1e18;
struct mat &amp;#123;
    int n, m;
    long long a[3][3];
    mat() &amp;#123;&amp;#125;
    mat(int n1, int m1): n(n1), m(m1) &amp;#123;
        for (int i = 0; i &amp;lt; n; ++i)
            for (int j = 0; j &amp;lt; m; ++j)
                a[i][j] = -inf;
        return;
    &amp;#125;
    long long* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    mat operator* (mat q) const &amp;#123;
        mat res(n, q.m);
        for (int i = 0; i &amp;lt; n; ++i)
            for (int k = 0; k &amp;lt; q.m; ++k)
                for (int j = 0; j &amp;lt; m; ++j)
                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int l, r; mat u; &amp;#125; t[maxn &amp;lt;&amp;lt; 2]; 
int a[maxn];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        t[p].u = mat(3, 3);
        t[p].u[0][0] = t[p].u[2][0] = a[l];
        t[p].u[0][1] = a[l], t[p].u[1][1] = 0ll, t[p].u[2][1] = a[l];
        t[p].u[2][2] = 0ll;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    t[p].u = t[lt].u * t[rt].u;
    return;
&amp;#125;
void add(int p, int x, int v) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        t[p].u[0][0] = t[p].u[2][0] = t[p].u[0][1] = t[p].u[2][1] = v;
        return;
    &amp;#125;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, x, v);
    else
        add(rt, x, v);
    t[p].u = t[lt].u * t[rt].u;
    return;
&amp;#125;
mat ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;lt;= mid)
        return ask(lt, l, r);
    if (l &amp;gt; mid)
        return ask(rt, l, r);
    return ask(lt, l, r) * ask(rt, l, r);
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    bld(1, 1, n);
    auto calc = [&amp;amp;](int l, int r) &amp;#123;
        mat f(1, 3);
        f[0][2] = 0ll;
        auto res(f * ask(1, l, r));
        return res[0][1];
    &amp;#125;;
    int q;
    std::cin &amp;gt;&amp;gt; q;
    for (int op; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            int l, r;
            std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
            std::cout &amp;lt;&amp;lt; calc(l, r) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
        else &amp;#123;
            int x, v;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; v;
            a[x] = v, add(1, x, v);
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;åŠ¨æ€æ ‘-dp&#34;&gt;åŠ¨æ€æ ‘ DP&lt;/h2&gt;
&lt;p&gt;æŠŠä¸Šè¿°è¿‡ç¨‹æ”¾åˆ°æ ‘ä¸Šï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°æ ‘å‰– + çº¿æ®µæ ‘ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºè®¤ä¸ºçº¿æ®µæ ‘ä¸Šçš„çŸ©ä¹˜åªèƒ½è¿›è¡Œä»é‡å„¿å­åˆ°çˆ¶äº²çš„è½¬ç§»ï¼Œè½»å„¿å­çš„è½¬ç§»ä¼šè¢«åˆå¹¶ä¸ºä¸€ä¸ªæ–°å‡½æ•°ï¼ˆåŒæ—¶æ˜¯çŸ©é˜µçš„ç³»æ•°ï¼‰ï¼Œåœ¨è·³é‡é“¾çš„æ—¶å€™è¢«å•ç‹¬æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºä¸¤ä¸ªå‡½æ•°ç›¸äº’ä¾èµ–ï¼Œéœ€è¦æ€è€ƒæ¸…æ¥šæ›´æ–°çš„å…ˆåé¡ºåºã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ¨¡æ¿åŠ¨æ€-dp&#34;&gt;ã€æ¨¡æ¿ã€‘åŠ¨æ€ DP&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4719&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4719&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,0/1}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸Šï¼Œé€‰ / ä¸é€‰ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„æœ€å¤§ä»·å€¼ã€‚å®¹æ˜“å¾—å‡ºè½¬ç§»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{u,0}=\sum\max(f_{v,0},f_{v,1})\\
f_{u,1}=a_i+\sum f_{v,0}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æŠŠè½¬ç§»çŸ©é˜µæ”¾åˆ°æ ‘å‰–ä¸Šåï¼Œè€ƒè™‘æ›´æ–°ï¼Œå‘ç°æ±‚å’Œè¿™ä¸€æ­¥å¾ˆå›°éš¾ã€‚è§£å†³æ–¹æ¡ˆæ˜¯&lt;strong&gt;ç›´æ¥å°†æ±‚å’Œç”¨å¦ä¸€ä¸ªå‡½æ•°ä»£æ›¿&lt;/strong&gt;ã€‚å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(g_{u,0}\)&lt;/span&gt; è¡¨ç¤ºå– &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ã€ä¸å– &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„æ‰€æœ‰è½»å„¿å­çš„ç­”æ¡ˆï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(g_{u,1}\)&lt;/span&gt; ä¸å– &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œè½»å„¿å­å¯é€‰å¯ä¸é€‰çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; æ˜¯å¯æ±‚çš„ï¼Œä¸”åªéœ€è¦åœ¨è·³é‡é“¾çš„æ—¶å€™æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt;ã€‚å…·ä½“æ›´æ–°èµ·æ¥éå¸¸ç»ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ˜¯ç›¸äº’ä¾èµ–çš„ï¼Œéœ€è¦åˆ†æ¸…æ¥šå…ˆåå…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆ &lt;span class=&#34;math inline&#34;&gt;\(g_u\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; éƒ½ä¼šè¢«æ›´æ–°ï¼›æ¥ç€ï¼Œé‡é“¾ä¸Šå…¶å®ƒçš„ &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; ä¸ä¼šè¢«å½±å“ï¼Œè€Œé“¾é¡¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; éœ€è¦è¢«æ–°çš„ &lt;span class=&#34;math inline&#34;&gt;\(g_u\)&lt;/span&gt; æ›´æ–°ï¼›ç”±æ­¤é“¾é¡¶çˆ¶äº²çš„ &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; è¢«æ›´æ–°ï¼›ä¾æ¬¡ç±»æ¨ã€‚æ³¨æ„åˆ°å¯¹äºä¸€ä¸ªé“¾é¡¶ï¼Œå…¶ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å€¼æ˜¯æ•´æ¡é‡é“¾çš„ä¹˜ç§¯ï¼Œæ•…éœ€è¦è®°å½•é“¾åº•ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(q\log ^2n)\)&lt;/span&gt;ã€‚æ³¨æ„å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯çº¿æ®µæ ‘å†…ä¹˜æ³•åº”ä»å³å¾€å·¦ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e5 + 5;
const int inf = 0x3f3f3f3f;
struct mat &amp;#123;
    int n, m, a[2][2];
    mat() &amp;#123;&amp;#125;
    mat(int n1, int m1): n(n1), m(m1) &amp;#123;
        for (int i = 0; i &amp;lt; n; ++i)
            for (int j = 0; j &amp;lt; m; ++j)
                a[i][j] = -inf;
        return;
    &amp;#125;
    int* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    mat operator* (mat q) const &amp;#123;
        mat res(n, q.m);
        for (int i = 0; i &amp;lt; n; ++i)
            for (int k = 0; k &amp;lt; q.m; ++k)
                for (int j = 0; j &amp;lt; m; ++j)
                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int l, r; mat u; &amp;#125; t[maxn &amp;lt;&amp;lt; 2]; 
int g[maxn][2], tab[maxn];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        int u = tab[l];
        t[p].u = mat(2, 2);
        t[p].u[0][0] = t[p].u[1][0] = g[u][1];
        t[p].u[0][1] = g[u][0];
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
void add(int p, int x) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        int u = tab[x];
        t[p].u[0][0] = t[p].u[1][0] = g[u][1];
        t[p].u[0][1] = g[u][0];
        return;
    &amp;#125;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, x);
    else
        add(rt, x);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
mat ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;lt;= mid)
        return ask(lt, l, r);
    if (l &amp;gt; mid)
        return ask(rt, l, r);
    return ask(rt, l, r) * ask(lt, l, r);
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, q;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g1[x].push_back(y), g1[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1), fa(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g1[x])
            if (i != fa[x]) &amp;#123;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    std::vector&amp;lt;std::array&amp;lt;int, 2&amp;gt; &amp;gt; f(n + 1);
    std::vector&amp;lt;int&amp;gt; top(n + 1), bot(n + 1), dfn(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now, tab[now] = x;
        if (son[x]) &amp;#123;
            top[son[x]] = top[x], DFS(son[x]);
            bot[x] = bot[son[x]];
            g[x][0] = a[x];
            for (auto i : g1[x])
                if (i != son[x] &amp;amp;&amp;amp; i != fa[x]) &amp;#123;
                    top[i] = i, DFS(i);
                    g[x][0] += f[i][0];
                    g[x][1] += std::max(f[i][1], f[i][0]);
                &amp;#125;
            f[x][0] = g[x][1] + std::max(f[son[x]][0], f[son[x]][1]);
            f[x][1] = g[x][0] + f[son[x]][0];
        &amp;#125;
        else
            f[x][1] = g[x][0] = a[x], bot[x] = x;
        return;
    &amp;#125;;
    top[1] = 1, DFS(1);
    bld(1, 1, n);
    for (int x, v; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; v;
        g[x][0] -= a[x], g[x][0] += v, a[x] = v;
        for (; top[x] != 1; ) &amp;#123;
            auto r = ask(1, dfn[top[x]], dfn[bot[x]]);
            f[top[x]][0] = r[0][0], f[top[x]][1] = r[0][1];
            g[fa[top[x]]][0] -= f[top[x]][0];
            g[fa[top[x]]][1] -= std::max(f[top[x]][0], f[top[x]][1]);
            add(1, dfn[x]);
            r = ask(1, dfn[top[x]], dfn[bot[x]]);
            f[top[x]][0] = r[0][0], f[top[x]][1] = r[0][1];
            g[fa[top[x]]][0] += f[top[x]][0];
            g[fa[top[x]]][1] += std::max(f[top[x]][0], f[top[x]][1]);
            x = fa[top[x]];
        &amp;#125;
        add(1, dfn[x]);
        auto r = ask(1, dfn[1], dfn[bot[1]]);
        f[1][0] = r[0][0], f[1][1] = r[0][1];
        std::cout &amp;lt;&amp;lt; std::max(f[1][0], f[1][1]) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å…¨å±€å¹³è¡¡äºŒå‰æ ‘&#34;&gt;å…¨å±€å¹³è¡¡äºŒå‰æ ‘&lt;/h2&gt;
&lt;p&gt;å›é¡¾æ ‘å‰–ï¼ˆé‡å‰–ï¼‰ï¼ŒåŠŸèƒ½åœ¨äºè§£å†³è·¯å¾„é—®é¢˜ï¼Œå•æ¬¡æ“ä½œèƒ½å¤Ÿåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(\log^2 n)\)&lt;/span&gt; çš„æ—¶é—´å†…å®Œæˆã€‚è¿™ä¸ªåŠŸèƒ½å¯ä»¥è¢«&lt;strong&gt;å…¨å±€å¹³è¡¡äºŒå‰æ ‘ï¼ˆGBTï¼‰&lt;/strong&gt;ä¸Šä½æ›¿ä»£ã€‚GBT èƒ½å¤Ÿåœ¨å•æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt; çš„å¤æ‚åº¦å†…å®Œæˆé“¾æ“ä½œã€å­æ ‘æ“ä½œã€‚&lt;em&gt;&lt;a href=&#34;QTREEè§£æ³•çš„ä¸€äº›ç ”ç©¶.pdf&#34;&gt;Yang Zhe - SPOJ375 QTREE è§£æ³•çš„ä¸€äº›ç ”ç©¶&lt;/a&gt; ä¸­æ›´ä¸ºè¯¦ç»†ä¸¥è°¨åœ°å¯¹ GBT è¿›è¡Œäº†è¯´æ˜ï¼Œæˆ‘ä¼ äº†ä»½æ–‡ä»¶ä¸Šæ¥ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ ‘å‰–èƒ½è¢«å¡çš„åŸå› ï¼šæ¯æ¬¡çº¿æ®µæ ‘è¯¢é—®éƒ½ä¼šå¡æ»¡ &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt;ï¼Œæ‰¾ä¸€æ¡å¡å¾—æ»¡ &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt; æ¬¡è·³é‡é“¾æ¬¡æ•°çš„è·¯å¾„ä¸€ç›´è–…ï¼Œå°±å¯ä»¥å¡åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(\log^2 n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®ç°çº¿æ®µæ ‘æ—¶å‘ç°ï¼Œå¯¹äº&lt;strong&gt;è·¯å¾„æ“ä½œ&lt;/strong&gt;å’Œ&lt;strong&gt;å•ç‚¹æ“ä½œ&lt;/strong&gt;ï¼Œæ ‘å‰–åªéœ€è¦ç»´æŠ¤åŒä¸€æ¡é‡é“¾çš„ä¿¡æ¯ï¼Œå»ºä¸€ä¸ªå¤§çº¿æ®µæ ‘ä¼šäº§ç”Ÿè®¸å¤šé‡é“¾é—´çš„æ— æ•ˆç»´æŠ¤ã€‚æ•…ä¸€ç§ç»å…¸çš„æ ‘å‰–å¡å¸¸æŠ€å·§æ˜¯å¯¹äºæ¯ä¸€æ¡é‡é“¾å»ºå‡ºçº¿æ®µæ ‘ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸­å®šä¹‰&lt;strong&gt;å…¨å±€äºŒå‰æ ‘&lt;/strong&gt;ï¼šå°†å•ä¸ªçº¿æ®µæ ‘æŒ‰ç…§åœ¨åŸæ ‘ä¸Šé‡é“¾é¡¶çš„ç›¸å¯¹ç¥–å­™å…³ç³»è¿è¾¹å¾—åˆ°çš„æ¨¡å‹ã€‚è¿™é‡Œä¸ºäº†å’Œ&lt;strong&gt;å…¨å±€å¹³è¡¡äºŒå‰æ ‘&lt;/strong&gt;å½¢æˆç…§åº”è€Œå‘½åï¼Œå®é™…ä¸Šæ¨¡å‹å¹¶ä¸æ˜¯äºŒå‰æ ‘ã€‚å®¹æ˜“å‘ç°&lt;strong&gt;ä¿®æ”¹æŸä¸ªç‚¹èŠ±è´¹çš„æ“ä½œæ¬¡æ•°å’Œå…¶åœ¨å…¨å±€äºŒå‰æ ‘ä¸­çš„æ·±åº¦ç›¸åŒ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æœ¬æ–¹æ³•ç†è®ºä¸Šä»å¯å¡åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(\log^2 n)\)&lt;/span&gt; å•æ¬¡æ“ä½œçš„åŸå› ï¼Œè™½ç„¶å•ä¸ªçº¿æ®µæ ‘å¹³è¡¡ï¼Œä½†&lt;strong&gt;å…¨å±€äºŒå‰æ ‘&lt;/strong&gt;å¹¶ä¸å¹³è¡¡ï¼›èƒ½å¤Ÿæ„é€ æ•°æ®ä½¿å¾—æ ‘é«˜è¾¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\log^2 n\)&lt;/span&gt;ã€‚è€ƒè™‘ä½¿å¾—å…¨å±€äºŒå‰æ ‘å¹³è¡¡ï¼Œå³è°ƒæ•´çº¿æ®µæ ‘ç»“æ„ä½¿å¾—ä»»ä½•ä¸€ä¸ªç‚¹åœ¨å…¨å±€äºŒå‰æ ‘ä¸Šçš„å·¦å³å„¿å­å¤§å°æœ€æ¥è¿‘ã€‚å‘ç°æ˜¯æ˜“åšçš„ï¼Œåªéœ€åœ¨å»ºçº¿æ®µæ ‘æ—¶ç§»åŠ¨å·¦å³å„¿å­åˆ†å‰²ç‚¹ä½¿å¾—ä¸¤è¾¹å­æ ‘å¤§å°å‡ä¸ºå…¨æ ‘çš„ä¸€åŠå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ³•ä¸€ï¼šæ±‚å‡ºæ¯ä¸ªç‚¹çš„è½»å­æ ‘å¤§å° &lt;span class=&#34;math inline&#34;&gt;\(ls_u=1+\sum siz_v\)&lt;/span&gt;ï¼Œä½œä¸ºåŠ æƒåœ¨çº¿æ®µæ ‘ä¸Šæ‰¾ mid å°±èƒ½æ»¡è¶³å…¨å±€å¹³è¡¡ï¼›è¯æ˜å¯ä»¥è§ä¸Šé¢çš„è®ºæ–‡ã€‚è¿™é‡Œç”¨çº¿æ®µæ ‘ä»£æ›¿äº† BSTï¼Œå¸¸æ•°å¾ˆå¤§ã€‚&lt;/p&gt;
&lt;p&gt;æ³•äºŒï¼šç”¨ä¸€ä¸ª BST å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œéœ€è¦æ»¡è¶³ï¼šä»»æ„å­æ ‘çš„æ ¹ä¸ºå­æ ‘çš„å¸¦æƒ midï¼›BST çš„ä¸­åºéå†ä¸ºåŸé‡é“¾ã€‚æ˜¾ç„¶æœ‰ï¼šæ ‘é«˜ä¸º log çº§åˆ«ã€‚è¿™å°±å†³å®šäº†æ‰€æœ‰é—®é¢˜éƒ½å¯ä»¥é€šè¿‡æš´åŠ›çˆ¬å±±è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;GBT èƒ½å¤Ÿå¿«é€Ÿç»´æŠ¤&lt;strong&gt;æ™®é€šæ ‘å‰–æ“ä½œ&lt;/strong&gt;å’Œ &lt;strong&gt;DDP ä¿¡æ¯&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ç»´æŠ¤-ddpæ¨¡æ¿åŠ¨æ€-dpåŠ å¼ºç‰ˆ&#34;&gt;ç»´æŠ¤ DDPï¼šã€æ¨¡æ¿ã€‘åŠ¨æ€ DPï¼ˆåŠ å¼ºç‰ˆï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4751&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4751&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’ŒæœªåŠ å¼ºç‰ˆç±»ä¼¼ï¼ŒæŠŠæ‰€æœ‰çº¿æ®µæ ‘æ“ä½œæ›¿æ¢ä¸º BST å³å¯ã€‚å¦‚æœå†™å¾—ä¸‘å¯èƒ½éœ€è¦ä¸€äº›é¢å¤–çš„å¡å¸¸æŠ€å·§ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
const int inf = 0x3f3f3f3f;
const int LEN = (1 &amp;lt;&amp;lt; 20);
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
struct mat &amp;#123;
    int a[2][2];
    int* operator[] (const int q) &amp;#123; 
        return a[q];
    &amp;#125;
    mat operator* (mat &amp;amp;q) const &amp;#123;
        mat res;
        res[0][0] = res[0][1] = res[1][0] = res[1][1] = -inf;
        for (int i = 0; i &amp;lt; 2; ++i)
            for (int k = 0; k &amp;lt; 2; ++k)
                for (int j = 0; j &amp;lt; 2; ++j)
                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int lc, rc, fa; mat u; &amp;#125; t[maxn]; 
int g[maxn][2], tab[maxn], ls[maxn];
mat p[maxn];
void pushup(int x) &amp;#123;
    t[x].u = t[t[x].rc].u * p[x] * t[t[x].lc].u;
    return;
&amp;#125;
void bld(int &amp;amp;x, int l, int r) &amp;#123;
    if (l &amp;gt; r)
        return;
    int s = 0, k = 0;
    for (int i = l; i &amp;lt;= r; ++i)
        s += ls[tab[i]];
    for (int i = l; i &amp;lt;= r; ++i, k += ls[tab[i]])
        if ((k + ls[tab[i]]) * 2 &amp;gt; s) &amp;#123;
            x = tab[i];
            bld(t[x].lc, l, i - 1), t[t[x].lc].fa = x;
            bld(t[x].rc, i + 1, r), t[t[x].rc].fa = x;
            pushup(x);
            break;
        &amp;#125;
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    t[0].u[0][0] = t[0].u[1][1] = 0, t[0].u[0][1] = t[0].u[1][0] = -inf;
    int n, q;
    read(n), read(q);
    std::vector&amp;lt;int&amp;gt; a(n + 1), rt(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        read(a[i]);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        read(x), read(y);
        g1[x].push_back(y), g1[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; son(n + 1), fa(n + 1), siz(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g1[x])
            if (i != fa[x]) &amp;#123;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    std::vector&amp;lt;std::array&amp;lt;int, 2&amp;gt; &amp;gt; f(n + 1);
    std::vector&amp;lt;int&amp;gt; top(n + 1), bot(n + 1), dfn(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now, tab[now] = x, ls[x] = 1;
        if (son[x]) &amp;#123;
            top[son[x]] = top[x], DFS(son[x]);
            bot[x] = bot[son[x]];
            g[x][0] = a[x];
            for (auto i : g1[x])
                if (i != son[x] &amp;amp;&amp;amp; i != fa[x]) &amp;#123;
                    top[i] = i, DFS(i), t[rt[i]].fa = x;
                    ls[x] += siz[i];
                    g[x][0] += f[i][0];
                    g[x][1] += std::max(f[i][1], f[i][0]);
                &amp;#125;
            f[x][0] = g[x][1] + std::max(f[son[x]][0], f[son[x]][1]);
            f[x][1] = g[x][0] + f[son[x]][0];
        &amp;#125;
        else
            f[x][1] = g[x][0] = a[x], bot[x] = x;
        p[x][0][0] = p[x][1][0] = g[x][1];
        p[x][0][1] = g[x][0], p[x][1][1] = -inf;
        if (x == top[x])
            bld(rt[x], dfn[x], dfn[bot[x]]);
        return;
    &amp;#125;;
    top[1] = 1, DFS(1);
    for (int x, v, la = 0; q--; ) &amp;#123;
        read(x), read(v), x ^= la;
        p[x][0][1] += v - a[x], a[x] = v;
        for (; x; ) &amp;#123;
            int fa = t[x].fa;
            if (fa &amp;amp;&amp;amp; x != t[fa].lc &amp;amp;&amp;amp; x != t[fa].rc) &amp;#123;
                int f0 = t[x].u[0][0], f1 = std::max(f0, t[x].u[0][1]);
                pushup(x);
                int F0 = t[x].u[0][0], F1 = std::max(F0, t[x].u[0][1]);
                p[fa][0][0] += F1 - f1, p[fa][1][0] += F1 - f1;
                p[fa][0][1] += F0 - f0;
            &amp;#125;
            else
                pushup(x);
            x = fa;
        &amp;#125;
        print(la = std::max(t[rt[1]].u[0][0], t[rt[1]].u[0][1]), &amp;#39;\n&amp;#39;);
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;ä¹Ÿç»™å‡ºä¸€ä¸ªçº¿æ®µæ ‘ç‰ˆæœ¬çš„&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
const int inf = 0x3f3f3f3f;
const int LEN = (1 &amp;lt;&amp;lt; 20);
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
struct mat &amp;#123;
    int a[2][2];
    int* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    mat operator* (mat q) const &amp;#123;
        mat res;
        res[0][0] = res[0][1] = res[1][0] = res[1][1] = -inf;
        for (int i = 0; i &amp;lt; 2; ++i)
            for (int k = 0; k &amp;lt; 2; ++k)
                for (int j = 0; j &amp;lt; 2; ++j)
                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int lc, rc, l, r, mid; mat u; &amp;#125; t[maxn &amp;lt;&amp;lt; 2]; 
int g[maxn][2], tab[maxn], ls[maxn];
#define lt t[p].lc
#define rt t[p].rc
void bld(int &amp;amp;p, int l, int r) &amp;#123;
    static int tot = 0;
    p = ++tot, t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        int u = tab[l];
        t[p].u[0][0] = t[p].u[1][0] = g[u][1];
        t[p].u[0][1] = g[u][0], t[p].u[1][1] = -inf;
        return;
    &amp;#125;
    int s = 0, u = ls[tab[l]];
    for (int i = l; i &amp;lt;= r; ++i)
        s += ls[tab[i]];
    s &amp;gt;&amp;gt;= 1;
    t[p].mid = r - 1;
    for (int i = l + 1; i &amp;lt; r; ++i) &amp;#123;
        u += ls[tab[i]];
        if (u + ls[tab[i + 1]] &amp;gt; s) &amp;#123;
            t[p].mid = i;
            break;
        &amp;#125;
    &amp;#125;
    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
void add(int p, int x) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        int u = tab[x];
        t[p].u[0][0] = t[p].u[1][0] = g[u][1];
        t[p].u[0][1] = g[u][0];
        return;
    &amp;#125;
    if (x &amp;lt;= t[p].mid)
        add(lt, x);
    else
        add(rt, x);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
mat ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u;
    if (r &amp;lt;= t[p].mid)
        return ask(lt, l, r);
    if (l &amp;gt; t[p].mid)
        return ask(rt, l, r);
    return ask(rt, l, r) * ask(lt, l, r);
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, q;
    read(n), read(q);
    std::vector&amp;lt;int&amp;gt; a(n + 1), rt(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        read(a[i]);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        read(x), read(y);
        g1[x].push_back(y), g1[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1), fa(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g1[x])
            if (i != fa[x]) &amp;#123;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    std::vector&amp;lt;std::array&amp;lt;int, 2&amp;gt; &amp;gt; f(n + 1);
    std::vector&amp;lt;int&amp;gt; top(n + 1), bot(n + 1), dfn(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now, tab[now] = x;
        ls[x] = 1;
        if (son[x]) &amp;#123;
            top[son[x]] = top[x], DFS(son[x]);
            bot[x] = bot[son[x]];
            g[x][0] = a[x];
            for (auto i : g1[x])
                if (i != son[x] &amp;amp;&amp;amp; i != fa[x]) &amp;#123;
                    top[i] = i, DFS(i);
                    ls[x] += siz[i];
                    g[x][0] += f[i][0];
                    g[x][1] += std::max(f[i][1], f[i][0]);
                &amp;#125;
            f[x][0] = g[x][1] + std::max(f[son[x]][0], f[son[x]][1]);
            f[x][1] = g[x][0] + f[son[x]][0];
        &amp;#125;
        else
            f[x][1] = g[x][0] = a[x], bot[x] = x;
        if (x == top[x])
            bld(rt[x], dfn[x], dfn[bot[x]]);
        return;
    &amp;#125;;
    top[1] = 1, DFS(1);
    for (int x, v, la = 0; q--; ) &amp;#123;
        read(x), read(v), x ^= la;
        g[x][0] -= a[x], g[x][0] += v, a[x] = v;
        for (; top[x] != 1; ) &amp;#123;
            auto r = t[rt[top[x]]].u;
            f[top[x]][0] = r[0][0], f[top[x]][1] = r[0][1];
            g[fa[top[x]]][0] -= f[top[x]][0];
            g[fa[top[x]]][1] -= std::max(f[top[x]][0], f[top[x]][1]);
            add(rt[top[x]], dfn[x]);
            r = t[rt[top[x]]].u;
            f[top[x]][0] = r[0][0], f[top[x]][1] = r[0][1];
            g[fa[top[x]]][0] += f[top[x]][0];
            g[fa[top[x]]][1] += std::max(f[top[x]][0], f[top[x]][1]);
            x = fa[top[x]];
        &amp;#125;
        add(rt[1], dfn[x]);
        auto r =  t[rt[1]].u;
        f[1][0] = r[0][0], f[1][1] = r[0][1];
        std::cout &amp;lt;&amp;lt; (la = std::max(f[1][0], f[1][1])) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æ ‘ä¸Šè·¯å¾„é—®é¢˜æŸ“è‰²&#34;&gt;æ ‘ä¸Šè·¯å¾„é—®é¢˜ï¼šæŸ“è‰²&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P2486&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P2486&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;GBT ä¸Šçš„&lt;strong&gt;è·¯å¾„é—®é¢˜&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;BSTï¼šé¦–å…ˆæš´åŠ›çˆ¬å±±åˆ° LCAï¼Œç»Ÿè®¡ä¸€è·¯ä¸Šçš„ç­”æ¡ˆï¼›ç„¶åè·³åˆ°å½“å‰ BST çš„æ ¹ã€‚ç”±äºæœ¬é¢˜æœ‰æ ‡è®°ï¼Œæ‰€ä»¥éœ€è¦åœ¨è·³çš„åŒæ—¶æƒ³åŠæ³•æŠŠæ ‡è®°é—®é¢˜è§£å†³ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;çº¿æ®µæ ‘ï¼šæŠŠæ ‘å‰–çš„çº¿æ®µæ ‘ç•¥æ”¹ä¸€ä¸‹å°±è¿‡äº†ã€‚ä»ä¸Šä¸€è¡Œæ¨¡æ£±ä¸¤å¯çš„æè¿°å°±å¯ä»¥çœ‹å‡ºæ¥ BST å®ç°èµ·æ¥ä¸å¤ªè½»æ¾ï¼›è¿˜æ˜¯çº¿æ®µæ ‘æ›´è½®æ¤…å•Šï¼&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;è·‘å¾—æ²¡çº¯æ ‘å‰–å¿«ï¼Œå› ä¸ºæ•°æ®æ²¡æœ‰åˆ»æ„æ„é€ å¯¼è‡´æ ‘é«˜å¾ˆä½ï¼Œå†åŠ ä¸Šå¸¸æ•°çš„å½±å“å§ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e5 + 5;
const int LEN = (1 &amp;lt;&amp;lt; 20);
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void read(char &amp;amp;x) &amp;#123;
    for (x = nec(); x != &amp;#39;C&amp;#39; &amp;amp;&amp;amp; x != &amp;#39;Q&amp;#39;; x = nec());
    return;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
class node &amp;#123;
private:
    int lt, rt;
public:
    int l, r, mid, lc, rc, u, d;
    node(): u(-1) &amp;#123;&amp;#125;
    inline int&amp;amp; ls(void) &amp;#123; return lt; &amp;#125;
    inline int&amp;amp; rs(void) &amp;#123; return rt; &amp;#125;
    node&amp;amp; operator= (const node &amp;amp;q) &amp;#123;
        lc = q.lc, rc = q.rc, u = q.u;
        return *this;
    &amp;#125;
    node operator+ (const node &amp;amp;q) const &amp;#123;
        if (u == -1)
            return q;
        if (q.u == -1)
            return *this;
        node res;
        res.lc = lc, res.rc = q.rc, res.u = u + q.u - (rc == q.lc);
        return res;
    &amp;#125;
    inline void swap(void) &amp;#123;
        if (~u)
            lc ^= rc ^= lc ^= rc;
        return;
    &amp;#125;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2]; 
int tab[maxn], ls[maxn], a[maxn];
#define lt t[p].ls()
#define rt t[p].rs()
void bld(int &amp;amp;p, int l, int r) &amp;#123;
    static int tot = 0;
    p = ++tot, t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        t[p].u = 1;
        t[p].lc = t[p].rc = a[tab[l]];
        return;
    &amp;#125;
    int s = 0, u = ls[tab[l]];
    for (int i = l; i &amp;lt;= r; ++i)
        s += ls[tab[i]];
    s &amp;gt;&amp;gt;= 1;
    t[p].mid = r - 1;
    for (int i = l + 1; i &amp;lt; r; ++i) &amp;#123;
        u += ls[tab[i]];
        if (u + ls[tab[i + 1]] &amp;gt; s) &amp;#123;
            t[p].mid = i;
            break;
        &amp;#125;
    &amp;#125;
    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);
    t[p] = t[lt] + t[rt];
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d = t[lt].lc = t[lt].rc = t[rt].d = t[rt].lc = t[rt].rc = t[p].d;
        t[lt].u = t[rt].u = 1;
        t[p].d = 0;
    &amp;#125;
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        t[p].u = 1;
        t[p].lc = t[p].rc = t[p].d = v;
        return;
    &amp;#125;
    pushdown(p);
    if (l &amp;lt;= t[p].mid)
        add(lt, l, r, v);
    if (r &amp;gt; t[p].mid)
        add(rt, l, r, v);
    t[p] = t[lt] + t[rt];
    return;
&amp;#125;
node ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p];
    pushdown(p);
    if (r &amp;lt;= t[p].mid)
        return ask(lt, l, r);
    if (l &amp;gt; t[p].mid)
        return ask(rt, l, r);
    return ask(lt, l, r) + ask(rt, l, r);
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
#else
    std::freopen(&amp;quot;paint17.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, q;
    read(n), read(q);
    std::vector&amp;lt;int&amp;gt; rt(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        read(a[i]);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        read(x), read(y);
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1), fa(n + 1), dep(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g[x])
            if (i != fa[x]) &amp;#123;
                dep[i] = dep[x] + 1;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    std::vector&amp;lt;std::array&amp;lt;int, 2&amp;gt; &amp;gt; f(n + 1);
    std::vector&amp;lt;int&amp;gt; top(n + 1), bot(n + 1), dfn(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now, tab[now] = x, ls[x] = 1;
        if (son[x]) &amp;#123;
            top[son[x]] = top[x], DFS(son[x]);
            bot[x] = bot[son[x]];
        &amp;#125;
        else
            bot[x] = x;
        for (auto i : g[x])
            if (i != son[x] &amp;amp;&amp;amp; i != fa[x]) &amp;#123;
                top[i] = i;
                DFS(i);
                ls[x] += siz[i];
            &amp;#125;
        if (x == top[x])
            bld(rt[x], dfn[x], dfn[bot[x]]);
        return;
    &amp;#125;;
    top[1] = 1, DFS(1);
    for (char op; q--; ) &amp;#123;
        read(op);
        if (op == &amp;#39;C&amp;#39;) &amp;#123;
            int x, y, c;
            read(x), read(y), read(c);
            for (; top[x] != top[y]; x = fa[top[x]]) &amp;#123;
                if (dep[top[x]] &amp;lt; dep[top[y]])
                    std::swap(x, y);
                add(rt[top[x]], dfn[top[x]], dfn[x], c);
            &amp;#125;
            if (dep[x] &amp;gt; dep[y])
                std::swap(x, y);
            add(rt[top[x]], dfn[x], dfn[y], c);
        &amp;#125;
        else &amp;#123;
            int x, y;
            read(x), read(y);
            node res1, res2;
            for (; top[x] != top[y]; )
                if (dep[top[x]] &amp;lt; dep[top[y]]) &amp;#123;
                    res2 = ask(rt[top[y]], dfn[top[y]], dfn[y]) + res2;
                    y = fa[top[y]];
                &amp;#125;
                else &amp;#123;
                    res1 = ask(rt[top[x]], dfn[top[x]], dfn[x]) + res1;
                    x = fa[top[x]];
                &amp;#125;
            if (dep[x] &amp;gt; dep[y])
                res1 = ask(rt[top[y]], dfn[y], dfn[x]) + res1;
            else
                res2 = ask(rt[top[x]], dfn[x], dfn[y]) + res2;
            res1.swap();
            print((res1 + res2).u, &amp;#39;\n&amp;#39;);
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æ ‘ä¸Šè·¯å¾„æŸ¥è¯¢&#34;&gt;æ ‘ä¸Šè·¯å¾„æŸ¥è¯¢ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;åšé¢˜çš„æ—¶å€™å¯ä»¥æ„Ÿå—åˆ°ï¼Œè·¯å¾„è¯¢é—®çš„å­˜åœ¨å¾ˆè¯¡å¼‚ï¼Œå› ä¸ºåªéœ€è¦ä¸€æ¡é“¾çš„æ“ä½œï¼Œæ›´åå‘é“¾ä¸Š DDP è€Œéæ ‘ä¸Šçš„ï¼›&lt;strong&gt;è½»å„¿å­çš„ä¿¡æ¯æ˜¯ä¸ç”¨ç»´æŠ¤çš„&lt;/strong&gt;ï¼Œå½¢å¼ä¸Šæ›´åƒæ ‘å‰–ï¼ˆDSï¼‰ï¼›å½“æˆé“¾ä¸Šçš„ DDP å°±å¯ä»¥è§£å†³äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥ç”¨å€å¢ç»´æŠ¤ DDPï¼ˆä¸ç”¨è€ƒè™‘è½»é‡å„¿å­ï¼Œåªç”¨ç»´æŠ¤çˆ¶å­å…³ç³»ï¼Œè¿›ä¸€æ­¥å‘åºåˆ— DDP é è¿‘ï¼‰ï¼Œå°±ä¸ç”¨æ‰“ GBT äº†ï¼Œå¸¸æ•°ä¹Ÿä¼šå°ä¸€äº›ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ä¹ é¢˜&#34;&gt;ä¹ é¢˜&lt;/h2&gt;
&lt;p&gt;GBT å°±ç»Ÿä¸€ç”¨çº¿æ®µæ ‘äº†ã€‚DDP ä¹Ÿå°±å¯ä»¥é¡ºå¸¦ç”¨ GBT ä¼˜åŒ–äº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;e---çŒ«æˆ–ç‹—-cats-or-dogs&#34;&gt;E - çŒ«æˆ–ç‹— / Cats or Dogs&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9597&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9597&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,0/1}\)&lt;/span&gt; è¡¨ç¤ºä»æ ¹ä¸Šé¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt; æ—¶çš„æœ€å°æ–­è¾¹æ•°ï¼Œæ˜¾ç„¶æ— è‰²å¯ä»¥è§†ä½œä»»é€‰ä¸€ä¸ªé¢œè‰²ã€‚é‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{u,a}=\sum\limits_v\min\limits_{b\in\{0,1\}}\{f_{v,b}+[a\ne b]\}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç›´æ¥æŠŠè½»å„¿å­çš„é¡¹æå‡ºæ¥ï¼Œè®° &lt;span class=&#34;math inline&#34;&gt;\(g_{u,0/1}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(f_{u,0/1}\)&lt;/span&gt; å¯¹åº”çš„è½»å„¿å­è´¡çŒ®å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e5 + 5;
const int inf = 0x3f3f3f3f;
struct mat &amp;#123;
    int a[2][2];
    int* operator[] (const int q) &amp;#123; 
        return a[q];
    &amp;#125;
    mat operator* (mat &amp;amp;q) const &amp;#123;
        mat res;
        res[0][0] = res[0][1] = res[1][0] = res[1][1] = inf;
        for (int i = 0; i &amp;lt; 2; ++i)
            for (int k = 0; k &amp;lt; 2; ++k)
                for (int j = 0; j &amp;lt; 2; ++j)
                    res[i][k] = std::min(res[i][k], a[i][j] + q[j][k]);
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125; p[maxn];
struct &amp;#123; int lc, rc, l, r, mid; mat u; &amp;#125; t[maxn &amp;lt;&amp;lt; 2]; 
int ls[maxn], tab[maxn], g[maxn][2], rt[maxn], top[maxn], dfn[maxn], fa[maxn];
std::vector&amp;lt;int&amp;gt; a;
#define lt t[p].lc
#define rt t[p].rc
void bld(int &amp;amp;p, int l, int r) &amp;#123;
    static int tot = 0;
    p = ++tot, t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        t[p].u[0][1] = t[p].u[1][0] = 1;
        return;
    &amp;#125;
    int s = 0, u = ls[tab[l]];
    for (int i = l; i &amp;lt;= r; ++i)
        s += ls[tab[i]];
    s &amp;gt;&amp;gt;= 1;
    t[p].mid = r - 1;
    for (int i = l + 1; i &amp;lt; r; ++i) &amp;#123;
        u += ls[tab[i]];
        if (u + ls[tab[i + 1]] &amp;gt; s) &amp;#123;
            t[p].mid = i;
            break;
        &amp;#125;
    &amp;#125;
    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
void add(int p, int x) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        int u = tab[x], g0 = (a[u] == 1 ? inf : g[u][0]), g1 = (a[u] == 0 ? inf : g[u][1]);
        t[p].u[0][0] = g0, t[p].u[0][1] = g1 + 1;
        t[p].u[1][0] = g0 + 1, t[p].u[1][1] = g1;
        return;
    &amp;#125;
    if (x &amp;lt;= t[p].mid)
        add(lt, x);
    else
        add(rt, x);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
#undef lt
#undef rt
void initialize(int n, std::vector&amp;lt;int&amp;gt; A, std::vector&amp;lt;int&amp;gt; B) &amp;#123;
    a.assign(n + 1, -1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
    for (int i = 0; i &amp;lt; n - 1; ++i)
        g1[A[i]].push_back(B[i]), g1[B[i]].push_back(A[i]);
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g1[x])
            if (i != fa[x]) &amp;#123;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    std::vector&amp;lt;int&amp;gt; bot(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now, tab[now] = x, ls[x] = 1;
        if (son[x]) &amp;#123;
            top[son[x]] = top[x], DFS(son[x]);
            bot[x] = bot[son[x]];
            for (auto i : g1[x])
                if (i != son[x] &amp;amp;&amp;amp; i != fa[x]) &amp;#123;
                    top[i] = i, DFS(i);
                    ls[x] += siz[i];
                &amp;#125;
        &amp;#125;
        else
            bot[x] = x;
        if (x == top[x])
            bld(rt[x], dfn[x], dfn[bot[x]]);
        return;
    &amp;#125;;
    top[1] = 1, DFS(1);
    return;
&amp;#125;
int upd(int x) &amp;#123;
    for (; top[x] != 1; ) &amp;#123;
        int faa = fa[top[x]];
        auto &amp;amp;id = t[rt[top[x]]].u;
        int f0 = std::min(id[0][0], id[1][0]), f1 = std::min(id[0][1], id[1][1]);
        g[faa][0] -= std::min(f0, f1 + 1);
        g[faa][1] -= std::min(f0 + 1, f1);
        add(rt[top[x]], dfn[x]);
        f0 = std::min(id[0][0], id[1][0]), f1 = std::min(id[0][1], id[1][1]);
        // printf(&amp;quot;%d: f0 = %d, f1 = %d\n&amp;quot;, top[x], f0, f1);
        g[faa][0] += std::min(f0, f1 + 1);
        g[faa][1] += std::min(f0 + 1, f1);
        x = faa;
    &amp;#125;
    add(rt[1], dfn[x]);
    auto &amp;amp;id = t[rt[1]].u;
    int f0 = std::min(id[0][0], id[1][0]), f1 = std::min(id[0][1], id[1][1]);
    // printf(&amp;quot;%d: f0 = %d, f1 = %d\n&amp;quot;, 1, f0, f1);
    return std::min(f0, f1);
&amp;#125;
int cat(int x) &amp;#123;
    a[x] = 0;
    return upd(x);
&amp;#125;
int dog(int x) &amp;#123;
    a[x] = 1;
    return upd(x);
&amp;#125;
int neighbor(int x) &amp;#123;
    a[x] = -1;
    return upd(x);
&amp;#125;
#ifndef ONLINE_JUDGE
int main() &amp;#123;
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; A(n - 1), B(n - 1);
    for (int i = 0; i &amp;lt; n - 1; ++i)
        std::cin &amp;gt;&amp;gt; A[i] &amp;gt;&amp;gt; B[i];
    initialize(n, A, B);
    int q;
    std::cin &amp;gt;&amp;gt; q;
    for (int op, x; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; op &amp;gt;&amp;gt; x;
        std::cout &amp;lt;&amp;lt; (op == 1 ? cat(x) : (op == 2 ? dog(x) : neighbor(x))) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
    return 0;
&amp;#125;
#endif&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;f---hash-on-tree&#34;&gt;F - Hash on Tree&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/AT_abc351_g&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/AT_abc351_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®° &lt;span class=&#34;math inline&#34;&gt;\(g_x\)&lt;/span&gt; ä¸ºè½»å„¿å­çš„å“ˆå¸Œå€¼ä¹‹ç§¯ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_u=A_u+f_{son}\cdot g_u\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå¼€ä¸€ä¸ªå¸¸æ•°ç»´å³å¯ã€‚å¿«é€Ÿå¹‚çš„ log çœä¸æ‰ï¼Œæ‰€ä»¥æ˜¯åŒ log çš„ã€‚&lt;/p&gt;
&lt;p&gt;åˆå€¼å’Œä¿®æ”¹éƒ½æœ‰å¯èƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œéœ€è¦ç»´æŠ¤å®é™…å“ˆå¸Œå€¼å’Œå»æ‰ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„å“ˆå¸Œå€¼ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
const int LEN = (1 &amp;lt;&amp;lt; 20);
const int mod = 998244353;
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
struct mat &amp;#123;
    int n, m;
    long long a[2][2];
    long long* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    mat operator* (mat &amp;amp;q) const &amp;#123;
        mat res;
        res.n = n, res.m = q.m;
        res[0][0] = res[0][1] = res[1][0] = res[1][1] = 0ll;
        for (int i = 0; i &amp;lt; n; ++i)
            for (int k = 0; k &amp;lt; q.m; ++k) &amp;#123;
                for (int j = 0; j &amp;lt; m; ++j)
                    res[i][k] += a[i][j] * q[j][k];
                res[i][k] %= mod;
            &amp;#125;
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int lc, rc, l, r, mid; mat u; &amp;#125; t[maxn &amp;lt;&amp;lt; 2]; 
long long g[maxn];
int tab[maxn], ls[maxn], a[maxn];
#define lt t[p].lc
#define rt t[p].rc
void bld(int &amp;amp;p, int l, int r) &amp;#123;
    static int tot = 0;
    p = ++tot, t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        int u = tab[l];
        t[p].u.n = t[p].u.m = 2;
        t[p].u[0][0] = g[u];
        t[p].u[0][1] = 0ll;
        t[p].u[1][0] = a[u];
        t[p].u[1][1] = 1ll;
        return;
    &amp;#125;
    int s = 0, u = ls[tab[l]];
    for (int i = l; i &amp;lt;= r; ++i)
        s += ls[tab[i]];
    s &amp;gt;&amp;gt;= 1;
    t[p].mid = r - 1;
    for (int i = l + 1; i &amp;lt; r; ++i) &amp;#123;
        u += ls[tab[i]];
        if (u + ls[tab[i + 1]] &amp;gt; s) &amp;#123;
            t[p].mid = i;
            break;
        &amp;#125;
    &amp;#125;
    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
void add(int p, int x) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        int u = tab[x];
        t[p].u[0][0] = g[u];
        t[p].u[1][0] = a[u];
        return;
    &amp;#125;
    if (x &amp;lt;= t[p].mid)
        add(lt, x);
    else
        add(rt, x);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, q;
    read(n), read(q);
    std::vector&amp;lt;int&amp;gt; rt(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
    for (int i = 2, x; i &amp;lt;= n; ++i) &amp;#123;
        read(x);
        g1[i].push_back(x), g1[x].push_back(i);
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        read(a[i]);
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1), fa(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g1[x])
            if (i != fa[x]) &amp;#123;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    std::vector&amp;lt;long long&amp;gt; f(n + 1);
    std::vector&amp;lt;int&amp;gt; top(n + 1), bot(n + 1), dfn(n + 1), la(n + 1), cnt(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now, tab[now] = x, ls[x] = 1;
        if (son[x]) &amp;#123;
            top[son[x]] = top[x], DFS(son[x]);
            bot[x] = bot[son[x]];
            g[x] = 1ll;
            for (auto i : g1[x])
                if (i != son[x] &amp;amp;&amp;amp; i != fa[x]) &amp;#123;
                    top[i] = i, DFS(i);
                    ls[x] += siz[i];
                    if (f[i] == 0ll)
                        ++cnt[x];
                    else
                        (la[x] *= f[i]) %= mod;
                    (g[x] *= f[i]) %= mod;
                &amp;#125;
            f[x] = (a[x] + g[x] * f[son[x]]) % mod;
        &amp;#125;
        else
            f[x] = a[x], bot[x] = x;
        // printf(&amp;quot;f[%d] = %lld\n&amp;quot;, x, f[x]);
        if (x == top[x])
            bld(rt[x], dfn[x], dfn[bot[x]]);
        return;
    &amp;#125;;
    top[1] = 1, DFS(1);
    mat init;
    init.n = 1, init.m = 2;
    init[0][0] = 0ll, init[0][1] = 1ll;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    auto inv = [&amp;amp;](int x) &amp;#123;
        return qkp(x, mod - 2);
    &amp;#125;;
    for (int x, v; q--; ) &amp;#123;
        read(x), read(v);
        a[x] = v;
        for (; top[x] != 1; ) &amp;#123;
            int faa = fa[top[x]];
            auto &amp;amp;id = t[rt[top[x]]].u;
            int f = (init * id)[0][0];
            if (f == 0) &amp;#123;
                if (--cnt[faa] == 0)
                    g[faa] = la[faa];
            &amp;#125;
            else &amp;#123;
                f = inv(f);
                (g[faa] *= f) %= mod;
                (la[faa] *= f) %= mod;
            &amp;#125;
            add(rt[top[x]], dfn[x]);
            f = (init * id)[0][0];
            if (f == 0) &amp;#123;
                if (cnt[faa]++ == 0)
                    la[faa] = g[faa];
                g[faa] = 0ll;
            &amp;#125;
            else &amp;#123;
                (g[faa] *= f) %= mod;
                (la[faa] *= f) %= mod;
            &amp;#125;
            x = faa;
        &amp;#125;
        add(rt[1], dfn[x]);
        auto &amp;amp;id = t[rt[1]].u;
        int f = (init * id)[0][0];
        std::cout &amp;lt;&amp;lt; f &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;g---è€ƒè¯•-2&#34;&gt;G - è€ƒè¯• 2&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P10626&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P10626&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿ç®—å‡æ˜¯çº¿æ€§çš„ï¼Œå®¹æ˜“æƒ³åˆ°ã€æŒ‰ä½ã€ç»´æŠ¤ï¼Œå³åªç»´æŠ¤æŸä¸ªç‰¹å®šç‚¹å€¼ã€‚å¦‚æœå°†è¯¢é—®ç¦»çº¿ä¸‹æ¥æ’åºï¼Œæ¯ä¸ªå‡½æ•°çš„ç‚¹å€¼åªä¼šå˜åŒ– &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;å»ºå‡ºç¬¦å·äºŒå‰æ ‘ï¼Œè¿›è¡Œ DDP å³å¯ã€‚å…·ä½“åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; è¡¨ç¤ºåœ¨è¿ç®— &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„çš„ç­”æ¡ˆï¼Œè®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(g_u\)&lt;/span&gt; ä¸ºè½»å„¿å­çš„ç­”æ¡ˆï¼ŒæŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„çš„ç¬¦å·å†™çŸ©é˜µå³å¯ã€‚å¶å­ä¸æ˜¯ä¸€æ¬¡è¿ç®—ï¼Œåº”è¯¥ç›´æ¥å¡«å…¥ç‚¹å€¼ï¼ˆæ³¨æ„çº¿æ®µæ ‘ä¸Šçš„å¶å­ä¸ä¸€å®šæ˜¯åŸæ ‘ä¸Šçš„å¶å­ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å»ºæ ‘å’ŒçŸ©é˜µæ›´æ–°æœ‰ç‚¹å²ï¼Œé€‚å½“å°è£…ä¸€ä¸‹æ„Ÿè§‰ä¼šå¥½ä¸€ç‚¹&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
const char mp[] = &amp;quot;x!&amp;amp;|^&amp;quot;;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#define nec getchar
inline bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
struct mat &amp;#123;
    int n, m;
    int a[2][2];
    int* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    inline mat operator* (mat &amp;amp;q) const &amp;#123;
        mat res;
        res.n = n, res.m = q.m;
        res[0][0] = res[0][1] = res[1][0] = res[1][1] = 0ll;
        for (int i = 0; i &amp;lt; n; ++i)
            for (int k = 0; k &amp;lt; q.m; ++k)
                for (int j = 0; j &amp;lt; m; ++j)
                    res[i][k] += a[i][j] * q[j][k];
        return res;
    &amp;#125;
    mat&amp;amp; operator*= (mat &amp;amp;q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
&amp;#125;;
struct &amp;#123; int lc, rc, l, r, mid; mat u; &amp;#125; t[maxn &amp;lt;&amp;lt; 2]; 
int g1[maxn][2];
int g[maxn], ty[maxn];
int tab[maxn], ls[maxn], lim[maxn];
#define lt t[p].lc
#define rt t[p].rc
void fillmat(mat &amp;amp;a, int op, int g) &amp;#123;
    if (op == 0) &amp;#123;
        a.n = 1, a.m = 2;
        a[0][!g] = 0, a[0][g] = 1;
        return;
    &amp;#125;
    a.n = 2, a.m = 2;
    switch (op) &amp;#123;
    case 1: // !
        a[0][0] = 0, a[0][1] = 1;
        a[1][0] = 1, a[1][1] = 0;
        break;
    case 2: // &amp;amp;
        a[0][0] = 1, a[0][1] = 0;
        a[1][0] = !g, a[1][1] = g;
        break;
    case 3: // |
        a[0][0] = !g, a[0][1] = g;
        a[1][0] = 0, a[1][1] = 1;
        break;
    case 4: // ^
        a[0][0] = !g, a[0][1] = g;
        a[1][0] = g, a[1][1] = !g;
        break;
    default:
        assert(0);
    &amp;#125;
    return;
&amp;#125;
void bld(int &amp;amp;p, int l, int r) &amp;#123;
    static int tot = 0;
    p = ++tot, t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        fillmat(t[p].u, ty[tab[l]], g[tab[l]]);
        return;
    &amp;#125;
    int s = 0, u = ls[tab[l]];
    for (int i = l; i &amp;lt;= r; ++i)
        s += ls[tab[i]];
    s &amp;gt;&amp;gt;= 1;
    t[p].mid = r - 1;
    for (int i = l + 1; i &amp;lt; r; ++i) &amp;#123;
        u += ls[tab[i]];
        if (u + ls[tab[i + 1]] &amp;gt; s) &amp;#123;
            t[p].mid = i;
            break;
        &amp;#125;
    &amp;#125;
    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
void add(int p, int x) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        fillmat(t[p].u, ty[tab[t[p].l]], g[tab[t[p].l]]);
        return;
    &amp;#125;
    if (x &amp;lt;= t[p].mid)
        add(lt, x);
    else
        add(rt, x);
    t[p].u = t[rt].u * t[lt].u;
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifndef ONLINE_JUDGE
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n = 0, q, p;
    read(q), read(q);
    &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s;
        std::stringstream in(s);
        std::stack&amp;lt;char&amp;gt; op;
        std::stack&amp;lt;int&amp;gt; id;
        auto trans = [&amp;amp;](char t) &amp;#123;
            switch (t) &amp;#123;
            case &amp;#39;!&amp;#39;:
                return 1;
            case &amp;#39;&amp;amp;&amp;#39;:
                return 2;
            case &amp;#39;|&amp;#39;:
                return 3;
            case &amp;#39;^&amp;#39;:
                return 4;
            &amp;#125;
            assert(0);
            return -1;
        &amp;#125;;
        auto calcNot = [&amp;amp;](void) &amp;#123;
            for (; !op.empty() &amp;amp;&amp;amp; op.top() == &amp;#39;!&amp;#39;; ) &amp;#123;
                ty[++n] = trans(op.top());
                g1[n][0] = id.top(), id.pop(), id.push(n);
                op.pop();
            &amp;#125;
            return;
        &amp;#125;;
        auto opt = [&amp;amp;](void) &amp;#123;
            ty[++n] = trans(op.top());
            g1[n][0] = id.top(), id.pop();
            g1[n][1] = id.top(), id.pop();
            id.push(n), op.pop();
            return;
        &amp;#125;;
        for (char t; in &amp;gt;&amp;gt; t; )
            if (t == &amp;#39;[&amp;#39;) &amp;#123;
                int x;
                in &amp;gt;&amp;gt; x, in &amp;gt;&amp;gt; t;
                lim[++n] = x - 1;
                id.push(n), calcNot();
            &amp;#125;
            else if (t == &amp;#39;(&amp;#39;)
                op.push(t);
            else if (t == &amp;#39;)&amp;#39;) &amp;#123;
                for (; op.top() != &amp;#39;(&amp;#39;; opt());
                op.pop(), calcNot();
            &amp;#125;
            else if (t == &amp;#39;&amp;amp;&amp;#39;)
                op.push(t);
            else if (t == &amp;#39;^&amp;#39;) &amp;#123;
                for (; !op.empty() &amp;amp;&amp;amp; op.top() == &amp;#39;&amp;amp;&amp;#39;; opt());
                op.push(t);
            &amp;#125;
            else if (t == &amp;#39;|&amp;#39;) &amp;#123;
                for (; !op.empty() &amp;amp;&amp;amp; (op.top() == &amp;#39;&amp;amp;&amp;#39; || op.top() == &amp;#39;^&amp;#39;); opt());
                op.push(t);
            &amp;#125;
            else &amp;#123;
                assert(t == &amp;#39;!&amp;#39;);
                op.push(t);
            &amp;#125;
        for (; !op.empty(); opt());
        p = id.top();
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; rt(n + 1);
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1), fa(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g1[x])
            if (i != 0) &amp;#123;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(p);
    std::vector&amp;lt;long long&amp;gt; f(n + 1);
    std::vector&amp;lt;int&amp;gt; top(n + 1), bot(n + 1), dfn(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now, tab[now] = x, ls[x] = 1;
        if (son[x]) &amp;#123;
            top[son[x]] = top[x], DFS(son[x]);
            bot[x] = bot[son[x]];
            for (auto i : g1[x])
                if (i != son[x] &amp;amp;&amp;amp; i != 0) &amp;#123;
                    top[i] = i, DFS(i);
                    ls[x] += siz[i], g[x] = f[i];
                &amp;#125;
            switch (ty[x]) &amp;#123;
            case 1:
                f[x] = !f[son[x]];
                break;
            case 2:
                f[x] = g[x] &amp;amp; f[son[x]];
                break;
            case 3:
                f[x] = g[x] | f[son[x]];
                break;
            case 4:
                f[x] = g[x] ^ f[son[x]];
                break;
            default:
                assert(0);
                break;
            &amp;#125;
        &amp;#125;
        else
            assert(!ty[x]), f[x] = g[x] = 0, bot[x] = x;
        if (x == top[x])
            bld(rt[x], dfn[x], dfn[bot[x]]);
        return;
    &amp;#125;;
    top[p] = p, DFS(p);
    std::vector&amp;lt;int&amp;gt; a(q + 1), res(q + 1);
    for (int i = 1; i &amp;lt;= q; ++i)
        read(a[i]);
    std::vector&amp;lt;int&amp;gt; qid(q), nid;
    for (int i = 1; i &amp;lt;= n; ++i)
        if (ty[i] == 0)
            nid.push_back(i);
    std::iota(qid.begin(), qid.end(), 1);
    std::sort(qid.begin(), qid.end(), [&amp;amp;](int x, int y) &amp;#123; return a[x] &amp;lt; a[y]; &amp;#125;);
    std::sort(nid.begin(), nid.end(), [&amp;amp;](int x, int y) &amp;#123; return lim[x] &amp;gt; lim[y]; &amp;#125;);
    for (auto i : qid) &amp;#123;
        for (; !nid.empty() &amp;amp;&amp;amp; lim[nid.back()] &amp;lt; a[i]; ) &amp;#123;
            int x = nid.back();
            nid.pop_back();
            g[x] = 1;
            for (; top[x] != p; ) &amp;#123;
                add(rt[top[x]], dfn[x]);
                g[fa[top[x]]] = t[rt[top[x]]].u[0][1];
                x = fa[top[x]];
            &amp;#125;
            add(rt[p], dfn[x]);
        &amp;#125;
        res[i] = t[rt[p]].u[0][1];
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        if (res[i])
            std::cout &amp;lt;&amp;lt; &amp;quot;True\n&amp;quot;;
        else
            std::cout &amp;lt;&amp;lt; &amp;quot;False\n&amp;quot;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <category term="DDP" />
        <updated>2025-08-12T00:16:52.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250809/</id>
        <title>è¿‘æœŸæ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250809/"/>
        <content type="html">&lt;p&gt;è¿™æ®µæ—¶é—´æ¯”èµ›çš„ä¸€äº›é¢˜ å’Œ nKessiã€duanyu è®²çš„é¢˜ç›®ã€‚å¤ªåè®¡æ•°ã€æ•°å­¦çš„åŸºæœ¬ä¸Šæ²¡åŠæ³•åšäº†ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-å‡ºå…³&#34;&gt;A. å‡ºå…³&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6462/problem/1&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6462/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œå¯¹äºä¸€ä¸ªç©ºä¸²ï¼Œä»»æ„åˆ©ç”¨ä¸‹åˆ—ä¸‰ç§æ“ä½œï¼Œä½¿å…¶å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œæ±‚æœ€å°ä»£ä»·ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;åœ¨æœ«å°¾æ·»åŠ å­—ç¬¦ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_{0,c}\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;å¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²å¹¶ç²˜è´´åœ¨æœ«å°¾ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_1\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;åˆ é™¤æœ«å°¾å­—ç¬¦ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_2\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(|s|\le 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯ä»¥é¢„å¤„ç†å‡ºå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾ï¼Œæœ€å¤šå¯ä»¥å¤åˆ¶åˆ°å“ªä¸ªåœ°æ–¹ï¼Œå‘ç°è¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(z_i=lcp(s_{1\dots n},s_{i+1\dots n})\)&lt;/span&gt;ã€‚é‚£ä¹ˆä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æœ€è¿œè½¬ç§»ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(r_i=i+z_{i+1}\)&lt;/span&gt;ï¼Œç”¨å•è°ƒé˜Ÿåˆ—å°±èƒ½ç»´æŠ¤ï¼Œä¼š exkmp å°±èƒ½çº¿æ€§ï¼›&lt;/p&gt;
&lt;p&gt;å¦åˆ™å¯ä»¥äºŒåˆ† + å“ˆå¸Œå¤šä¸ª logï¼Œåé¢ä¹Ÿæœ‰ç†ç”±å·æ‡’ç”¨ä¼˜å…ˆé˜Ÿåˆ—äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int p = 31;
const int mod = 998244353;
int main() &amp;#123;
    std::freopen(&amp;quot;laozi.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;laozi.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    int n = (int)s.length(), t1, t2;
    std::vector&amp;lt;long long&amp;gt; h(n + 1), base(n + 1);
    std::vector&amp;lt;int&amp;gt; a(n + 1), t0(27), z(n + 1), r(n + 1);
    base[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        a[i] = s[i - 1] - &amp;#39;a&amp;#39; + 1;
        h[i] = (h[i - 1] * p + a[i]) % mod;
        base[i] = base[i - 1] * p % mod;
    &amp;#125;
    auto gethash = [&amp;amp;](int l, int r) &amp;#123;
        return (h[r] - h[l - 1] * base[r - l + 1] % mod + mod) % mod;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int l = 1, r = std::min(i - 1, n - i + 1), mid; l &amp;lt;= r; ) &amp;#123;
            mid = (l + r) &amp;gt;&amp;gt; 1;
            if (gethash(1, mid) == gethash(i, i + mid - 1))
                z[i] = mid, l = mid + 1;
            else
                r = mid - 1;
        &amp;#125;
    for (int i = 1; i &amp;lt; n; ++i)
        r[i] = i + std::min(i, z[i + 1]);
    for (int i = 1; i &amp;lt;= 26; ++i)
        std::cin &amp;gt;&amp;gt; t0[i];
    std::cin &amp;gt;&amp;gt; t1 &amp;gt;&amp;gt; t2;
    std::vector&amp;lt;long long&amp;gt; f(n + 1);
    std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; q;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        f[i] = f[i - 1] + t0[a[i]];
        for (; !q.empty() &amp;amp;&amp;amp; r[q.top().second] &amp;lt; i; q.pop());
        if (!q.empty())
            f[i] = std::min(f[i], t1 - q.top().first - (long long)t2 * i);
        if (i != n)
            q.emplace(-(f[i] + 2ll * t2 * i), i);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-éæ”»&#34;&gt;D. éæ”»&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6462/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6462/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; çš„æ’åˆ—ï¼Œä½¿ç”¨æœ€å°çš„äº¤æ¢æ¬¡æ•°ä½¿å¾—å…¶å•å¢ã€‚åœ¨è¯¥å‰æä¸‹ï¼Œå®šä¹‰ä»£ä»·ä¸ºæ¯æ¬¡äº¤æ¢çš„ä¸¤ä¸ªæ•°ä¹‹ç§¯ã€‚å¯¹äºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n!\)&lt;/span&gt; ä¸ªæ’åˆ—ï¼Œè®¡ç®—æœ€å°ä»£ä»·ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^7\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è½¬åŒ–æˆï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; åˆ†æˆæ— æ ‡å·çš„è‹¥å¹²ç»„ï¼Œæ¯ç»„çš„ä»£ä»·æ˜¯ æœ€å°å€¼ &lt;span class=&#34;math inline&#34;&gt;\(\times\)&lt;/span&gt; å…¶ä»–å…ƒç´ çš„å’Œï¼Œè¿˜æœ‰ä¸€ä¸ªé¡¹é“¾é—®é¢˜çš„ç³»æ•°ï¼Œå‘ç°ç»„é—´çš„ç¬¦å·æ˜¯æ±‚å’Œï¼Œè€ƒè™‘è®¡ç®—è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; å¹¶é’¦å®šä¸¤ä¸ªåŒå±ä¸€ä¸ªç¯ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ºæœ€å°å€¼ï¼Œæšä¸¾ç¯å¤§å° &lt;span class=&#34;math inline&#34;&gt;\(s+2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
res&amp;amp;=\sum_{i=1}^{n-1}\sum_{j=i+1}^n i\cdot j \cdot \sum_{s=0}^{n-i-1}\binom{n-i-1}s \cdot (s+1)!\cdot (n-s-2)!\\
&amp;amp;=\sum_{i=1}^{n-1}i\cdot \dfrac {(i+n+1)(n-i)}2 \cdot \sum_{s=0}^{n-i-1}\binom{n-i-1}s\cdot (s+1)!\cdot (n-s-2)!\\
&amp;amp;=\frac 12\times\sum_{i=1}^{n-1}i\cdot (i+n+1)\cdot (n-i)!\cdot\sum_{s=0}^{n-i-1}\dfrac {(s + 1)\cdot (n-s-2)!}{(n-i-1-s)!}\\
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(T=n-i-1\)&lt;/span&gt;ï¼Œå‘ç°æˆ‘ä»¬éœ€è¦å¿«é€Ÿè®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(f_T=\sum\limits_{i=0}^T \dfrac{(i+1)\cdot (n-i-2)!}{(T-i)!}\)&lt;/span&gt;ã€‚è®° &lt;span class=&#34;math inline&#34;&gt;\(m=n-2\)&lt;/span&gt;ï¼Œå˜å½¢å¾— &lt;span class=&#34;math inline&#34;&gt;\(f_T=(m-T)!\cdot \sum\limits_{i=0}^{T} (i+1) \binom{m-i}{m-T}\)&lt;/span&gt;ï¼Œå‘ç°ä¼¼ä¹å¯ä»¥ç®€åŒ–ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(k=m-T,t=T+1\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_T=\sum\limits_{i=1}^T i\cdot \binom {k+t-i}k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ˜¯ç»å…¸çš„ç»„åˆæ„ä¹‰ä¿å¹³å®‰ç¯èŠ‚ï¼Œå³ä» &lt;span class=&#34;math inline&#34;&gt;\(k+t\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·å°çƒä¸­é€‰æ‹©ä¸€æ¡åˆ†ç•Œçº¿ï¼Œåˆ†ç•Œçº¿å·¦è¾¹é€‰ä¸€ä¸ªçƒã€å³è¾¹é€‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªçƒçš„æ–¹æ¡ˆæ•°ã€‚å‘ç°åˆ†ç•Œçº¿çš„å­˜åœ¨å¾ˆè¯¡å¼‚ï¼Œæ•…ç”¨åˆ†ç•Œçº¿åæ–¹çš„ç¬¬ä¸€ä¸ªçƒä»£æ›¿ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t+1\)&lt;/span&gt; å¤„æ–°å»ºä¸€ä¸ªè™šçƒï¼Œè§„å®šåœ¨å‰ &lt;span class=&#34;math inline&#34;&gt;\(t+1\)&lt;/span&gt; ä¸ªçƒä¸­é€‰ä¸¤ä¸ªçƒï¼Œå¹¶ä»¤åä¸€ä¸ªä¸ºåˆ†ç•Œçº¿ï¼Œä¸”ä»¤å‰ &lt;span class=&#34;math inline&#34;&gt;\(t+1\)&lt;/span&gt; ä¸ªä¸­çš„å…¶ä»–çƒä¸ºå®çƒï¼Œå°±èƒ½å»ºç«‹åŒå°„ã€‚åœ¨åˆ†ç•Œçº¿åå†é€‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªçƒï¼Œå®¹æ˜“å‘ç°ç›´æ¥åœ¨èŒƒå›´å†…é€‰ &lt;span class=&#34;math inline&#34;&gt;\(k+2\)&lt;/span&gt; ä¸ªçƒå°±èƒ½æ»¡è¶³æ¡ä»¶ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(f_T=(n-T-2)!\cdot \binom{t+k+1}{k+2}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;mozi.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;mozi.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1), f(n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    int m = n - 2;
    for (int T = 0; T &amp;lt;= n - 2; ++T) &amp;#123;
        int k = m - T, t = T + 1;
        f[T] = C(t + k + 1, k + 2) * fac[m - T] % mod;
    &amp;#125;
    auto res = 0ll;
    for (int i = 1; i &amp;lt;= n - 1; ++i)
        (res += (long long)i * (i + n + 1) % mod * fac[n - i] % mod * f[n - i - 1] % mod) %= mod;
    std::cout &amp;lt;&amp;lt; res * inv[2] % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---destruction-of-walls&#34;&gt;C - Destruction of Walls&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc203/tasks/arc203_c&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc203/tasks/arc203_c&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---insert-xor&#34;&gt;D - Insert XOR&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc203/tasks/arc203_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc203/tasks/arc203_d&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---è®°å¿†&#34;&gt;A - è®°å¿†&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://ac.nowcoder.com/acm/problem/274793&#34; class=&#34;uri&#34;&gt;https://ac.nowcoder.com/acm/problem/274793&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦æ„è¯†åˆ°é—®é¢˜æ˜¯é™æ€çš„ï¼Œå¹¶ä¸”ä¸èƒ½ç”¨çº¿æ®µæ ‘ä¹‹ç±»ç»´æŠ¤ï¼›æ•…è€ƒè™‘ç¦»çº¿ä¸‹æ¥ï¼Œæƒ³åŠæ³•åœ¨ LCA å¤„ç»Ÿè®¡ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™å‘ç°éœ€è¦åˆå¹¶å­æ ‘çŠ¶æ€ã€æ•´ä½“å¼‚æˆ–ã€æ•´ä½“ +1ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° Trieã€‚æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(u\to\)&lt;/span&gt; LCA çš„ç­”æ¡ˆä¿å­˜åœ¨ LCA å¤„ï¼Œç„¶åå†ç”¨ DFS + å›æº¯ç»Ÿè®¡ LCA &lt;span class=&#34;math inline&#34;&gt;\(\to v\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚æƒ³äº†åŠå¤©æ²¡æƒ³åˆ°æŠŠä¸Šä¸‹æ‹†å¼€æ¥åšä¹Ÿæ˜¯ç¥äº† ğŸ˜…&lt;/p&gt;
&lt;p&gt;å¯èƒ½æ¯”è¾ƒè€ƒéªŒå¯¹å­—å…¸æ ‘çš„ç†è§£ï¼Ÿåšä¸ªæ¯”å–»ï¼Œå­—å…¸æ ‘çš„ id å°±ç›¸å½“äºå¯¹è¿™ä¸ªç‚¹ä¸Šä¿¡æ¯çš„ã€å¼•ç”¨ã€ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å­—å…¸æ ‘åˆå¹¶çš„æ—¶å€™å¯ä»¥è€ƒè™‘å›æ”¶åºŸå¼ƒç‚¹ï¼Œä¸ç„¶å¯èƒ½æœ‰ç‚¹å¡ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int X = 50;
const int maxn = 2e7 + 5;
long long d[maxn];
int tot, T[maxn][2], f[maxn], fa[maxn];
#define lc(p) T[p][0]
#define rc(p) T[p][1]
int find(int x) &amp;#123; return x == f[x] ? x : f[x] = find(f[x]); &amp;#125;
int newnode(void) &amp;#123;
    int p = ++tot;
    assert(p &amp;lt; maxn);
    d[p] = lc(p) = rc(p) = 0, f[p] = p;
    return p;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (d[p]) &amp;#123;
        if (d[p] &amp;amp; 1)
            std::swap(lc(p), rc(p));
        d[p] &amp;gt;&amp;gt;= 1;
        if (lc(p))
            d[lc(p)] ^= d[p];
        if (rc(p))
            d[rc(p)] ^= d[p];
        d[p] = 0;
    &amp;#125;
    return;
&amp;#125;
int ins(int p, long long x) &amp;#123;
    for (int i = 0; i &amp;lt; X; ++i) &amp;#123;
        pushdown(p);
        if (!T[p][(x &amp;gt;&amp;gt; i) &amp;amp; 1]) &amp;#123;
            T[p][(x &amp;gt;&amp;gt; i) &amp;amp; 1] = newnode();
            fa[T[p][(x &amp;gt;&amp;gt; i) &amp;amp; 1]] = p;
        &amp;#125;
        p = T[p][(x &amp;gt;&amp;gt; i) &amp;amp; 1];
    &amp;#125;
    return p;
&amp;#125;
void merge(int &amp;amp;p, int q) &amp;#123;
    if (!q)
        return;
    if (!p) &amp;#123;
        p = q;
        return;
    &amp;#125;
    pushdown(p), pushdown(q);
    fa[lc(q)] = p, fa[rc(q)] = p;
    merge(lc(p), lc(q)), merge(rc(p), rc(q));
    assert(f[p] == p), assert(f[q] == q), f[q] = p;
    return;
&amp;#125;
long long ask(int p) &amp;#123;
    std::vector&amp;lt;int&amp;gt; st;
    for (int i = 0, j = p; i &amp;lt; X; ++i)
        st.push_back(fa[j]), j = fa[j];
    for (int i = 0; i &amp;lt; X; ++i)
        pushdown(st.back()), st.pop_back();
    long long x = 0;
    for (int i = 0; i &amp;lt; X; ++i) &amp;#123;
        x = x * 2 + (p == rc(fa[p]));
        p = fa[p];
    &amp;#125;
    return x;
&amp;#125;
void add(int p) &amp;#123;
    for (int i = 0; p &amp;amp;&amp;amp; i &amp;lt; X; ++i) &amp;#123;
        pushdown(p);
        std::swap(lc(p), rc(p));
        p = lc(p);
    &amp;#125;
    return;
&amp;#125;
void del(int p) &amp;#123;
    for (int i = 0; p &amp;amp;&amp;amp; i &amp;lt; X; ++i) &amp;#123;
        pushdown(p);
        std::swap(lc(p), rc(p));
        p = rc(p);
    &amp;#125;
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1), top(n + 1), fa(n + 1), dep(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g[x])
            if (i != fa[x]) &amp;#123;
                dep[i] = dep[x] + 1;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    DFS = [&amp;amp;](int x) &amp;#123;
        if (son[x])
            top[son[x]] = top[x], DFS(son[x]);
        for (auto i : g[x])
            if (i != son[x] &amp;amp;&amp;amp; i != fa[x])
                top[i] = i, DFS(i);
        return;
    &amp;#125;;
    top[1] = 1, DFS(1);
    auto askLCA = [&amp;amp;](int x, int y) &amp;#123;
        for (; top[x] != top[y]; x = fa[top[x]])
            if (dep[top[x]] &amp;lt; dep[top[y]])
                std::swap(x, y);
        return dep[x] &amp;lt; dep[y] ? x : y;
    &amp;#125;;
    struct node &amp;#123; long long x; int u, v; &amp;#125;;
    std::vector&amp;lt;node&amp;gt; q(m + 1);
    std::vector&amp;lt;int&amp;gt; id(m + 1);
    std::vector&amp;lt;long long&amp;gt; res(m + 1), ans(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; up(n + 1), dn(n + 1), ed(n + 1);
    for (int i = 1, x, u, v; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; u &amp;gt;&amp;gt; v;
        q[i] = &amp;#123; x, u, v &amp;#125;;
        up[u].push_back(i), dn[askLCA(u, v)].push_back(i), ed[v].push_back(i);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; rt(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        rt[x] = newnode();
        for (auto i : g[x])
            if (i != fa[x]) &amp;#123;
                DFS(i);
                merge(rt[x], rt[i]);
            &amp;#125;
        add(rt[x]);
        for (auto i : up[x])
            id[i] = ins(rt[x], q[i].x);
        d[rt[x]] ^= a[x];
        for (auto i : dn[x])
            res[i] = ask(find(id[i]));
        return;
    &amp;#125;;
    DFS(1);
    tot = 0, rt[0] = newnode();
    std::fill(id.begin() + 1, id.end(), 0);
    DFS = [&amp;amp;](int x) &amp;#123;
        d[rt[0]] ^= a[x];
        for (auto i : dn[x])
            id[i] = ins(rt[0], res[i]);
        for (auto i : ed[x])
            ans[i] = ask(id[i]);
        add(rt[0]);
        for (auto i : g[x])
            if (i != fa[x])
                DFS(i);
        del(rt[0]);
        d[rt[0]] ^= a[x];
        return;
    &amp;#125;;
    DFS(1);
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; ans[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ-2-meetings-2&#34;&gt;B - ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ 2 (Meetings 2)&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/AT_joisc2021_j&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/AT_joisc2021_j&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®šä¹‰æ‰€æ±‚ç‚¹ä¸ºã€å±€éƒ¨é‡å¿ƒã€ï¼›ç±»ä¼¼æ ‘çš„é‡å¿ƒï¼Œå®¹æ˜“å‘ç°å½“å…³é”®ç‚¹æ•°é‡ä¸ºå¥‡æ—¶ï¼Œåªå­˜åœ¨ä¸€ä¸ªå±€éƒ¨é‡å¿ƒï¼›å¦åˆ™ï¼Œå±€éƒ¨é‡å¿ƒç»„æˆä¸€æ¡é“¾ã€‚&lt;/p&gt;
&lt;p&gt;å³å¯¹äºæ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œéœ€è¦æ‰¾åˆ°ä¸€æ¡æœ€é•¿é“¾ï¼Œä½¿å¾—å…¶ä¸¤ç«¯å­˜åœ¨å¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å­æ ‘ï¼ˆå®¹æ˜“å‘ç°å–åç¼€ max å³å¯å¾—åˆ°çœŸå®ç­”æ¡ˆï¼‰ã€‚ä½¿ç”¨ç‚¹åˆ†æ²»ï¼Œç²¾ç»†å®ç°å®¹æ˜“åšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; mx(n + 1), siz(n + 1), p, tag(n + 1), res(n + 1, 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS1 = [&amp;amp;](int x, int fa) &amp;#123;
        p.push_back(x);
        siz[x] = 1, mx[x] = 0;
        for (auto i : g[x])
            if (!tag[i] &amp;amp;&amp;amp; i != fa) &amp;#123;
                DFS1(i, x);
                siz[x] += siz[i];
                mx[x] = std::max(mx[x], siz[i]);
            &amp;#125;
        return;
    &amp;#125;;
    auto findrt = [&amp;amp;](int x) &amp;#123;
        p.clear(), DFS1(x, -1);
        int n = (int)p.size();
        for (auto i : p)
            if (mx[i] &amp;lt;= n / 2 &amp;amp;&amp;amp; n - siz[i] &amp;lt;= n / 2)
                return i;
        assert(0);
        return -1;
    &amp;#125;;
    struct node &amp;#123;
        int u1, u2, id1, id2;
        node(): u1(0), u2(0), id1(0), id2(0) &amp;#123;&amp;#125;
        void upd(int u, int id) &amp;#123;
            if (id1 == id)
                u1 = std::max(u1, u);
            else if (u &amp;gt;= u1)
                u2 = u1, id2 = id1, u1 = u, id1 = id;
            else if (u &amp;gt;= u2)
                u2 = u, id2 = id;
            return;
        &amp;#125;
    &amp;#125;;
    std::vector&amp;lt;node&amp;gt; s(n + 1);
    std::function&amp;lt;void(int, int, int, int)&amp;gt; DFS2 = [&amp;amp;](int x, int fa, int dep, int anc) &amp;#123;
        s[siz[x]].upd(dep, anc);
        for (auto i : g[x])
            if (!tag[i] &amp;amp;&amp;amp; i != fa)
                DFS2(i, x, dep + 1, anc);
        return;
    &amp;#125;;
    std::function&amp;lt;void(int, int, int, int)&amp;gt; DFS3 = [&amp;amp;](int x, int fa, int dep, int anc) &amp;#123;
        int v = ((s[siz[x]].id1 == anc) ? s[siz[x]].u2 : s[siz[x]].u1);
        res[2 * siz[x]] = std::max(res[2 * siz[x]], dep + 1 + v);
        for (auto i : g[x])
            if (!tag[i] &amp;amp;&amp;amp; i != fa)
                DFS3(i, x, dep + 1, anc);
        return;
    &amp;#125;;
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        x = findrt(x), p.clear(), DFS1(x, -1);
        // printf(&amp;quot;rt = %d\n&amp;quot;, x);
        for (auto i : g[x])
            if (!tag[i])
                DFS2(i, x, 1, i);
        for (int i = siz[x] - 1; i; --i) &amp;#123;
            s[i].upd(s[i + 1].u1, s[i + 1].id1);
            s[i].upd(s[i + 1].u2, s[i + 1].id2);
        &amp;#125;
        for (auto i : g[x])
            if (!tag[i])
                DFS3(i, x, 1, i);
        tag[x] = 1;
        for (int i = 1; i &amp;lt; siz[x]; ++i)
            s[i] = node();
        for (auto i : g[x])
            if (!tag[i])
                DFS(i);
        return;
    &amp;#125;;
    DFS(1);
    for (int i = (n &amp;gt;&amp;gt; 1) * 2; i; --i)
        if (i + 2 &amp;lt;= n)
            res[i] = std::max(res[i], res[i + 2]);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---the-closest-pair&#34;&gt;C - The Closest Pair&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://ac.nowcoder.com/acm/problem/262593&#34; class=&#34;uri&#34;&gt;https://ac.nowcoder.com/acm/problem/262593&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¸¸è§„æ–¹æ³•&lt;/strong&gt;ï¼šè€ƒè™‘&lt;strong&gt;æ”¯é…å¯¹&lt;/strong&gt;ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œæ‰¾åˆ°æ‰€æœ‰åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt;ã€‚å®¹æ˜“æƒ³åˆ°æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(a_i\div a_j\)&lt;/span&gt; æ¥åšï¼›å‡è®¾å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_k\div a_i=a_j\div a_i\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(k&amp;gt;j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨è®¾ &lt;span class=&#34;math inline&#34;&gt;\(a_j=K\cdot a_i+p,a_k=K\cdot a_i+q\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((a_i,a_j),(a_i,a_k)\)&lt;/span&gt; å‡åˆæ³•å½“ä¸”ä»…å½“ä¸‹åˆ—æ¡ä»¶å…¨éƒ¨æˆç«‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_j\bmod a_i&amp;gt;a_k\bmod a_i\)&lt;/span&gt;ï¼› åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(a_j&amp;gt;a_k\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_j\bmod a_k&amp;gt;a_k\bmod a_i\)&lt;/span&gt;ï¼›åˆ &lt;span class=&#34;math inline&#34;&gt;\(p-q\ge a_j\bmod a_k\)&lt;/span&gt;ï¼ˆ&lt;strong&gt;å¤ªç‰›äº†è¿™ä¸€æ­¥&lt;/strong&gt;ï¼‰ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(p-q&amp;gt;q\iff p&amp;gt;2q\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯å¾—åªå…³å¿ƒåŒä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_j\div a_i\)&lt;/span&gt; æ—¶çš„æ”¯é…å¯¹æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\log n\)&lt;/span&gt; çº§åˆ«ï¼›æ€»å¯¹æ•° &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n\ln n)\)&lt;/span&gt;ã€‚ç¦»çº¿ä¸‹æ¥æ‰«æçº¿å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å¯¹ç€ å•ç‚¹ä¿®æ”¹ åŒºé—´æœ€å€¼ æƒ³äº† 1h çš„å• log åšæ³• ğŸ˜° æœç„¶å°è„‘æ‰çº¿å¤ªå¯æ€•äº†ï¼Œç¬¬äºŒå¤©æ—©ä¸Šé‡ç½®å¤§è„‘ 1s å‘ç°è‡ªå·±æ˜¯æ–¯æ³¢ ğŸ˜“&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
const int maxn = 4e6 + 5;
struct &amp;#123; int l, r, u[2]; &amp;#125; t[maxn];
#define lt (t[p].l)
#define rt (t[p].r)
int tot[2];
void add(int &amp;amp;p, int l, int r, int x, int v, int i) &amp;#123;
    if (!p)
        p = ++tot[i], t[p].u[0] = -1, t[p].u[1] = 0x3f3f3f3f;
    if (i == 0)
        t[p].u[0] = std::max(t[p].u[0], v);
    else
        t[p].u[1] = std::min(t[p].u[1], v);
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, l, mid, x, v, i);
    else
        add(rt, mid + 1, r, x, v, i);
    return;
&amp;#125;
int ask(int p, int l, int r, int ql, int qr, int i) &amp;#123;
    if (!p || (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr))
        return t[p].u[i];
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (qr &amp;lt;= mid)
        return ask(lt, l, mid, ql, qr, i);
    if (ql &amp;gt; mid)
        return ask(rt, mid + 1, r, ql, qr, i);
    if (i == 0)
        return std::max(ask(lt, l, mid, ql, qr, 0), ask(rt, mid + 1, r, ql, qr, 0));
    return std::min(ask(lt, l, mid, ql, qr, 1), ask(rt, mid + 1, r, ql, qr, 1));
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifndef ONLINE_JUDGE
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    const int m = 1e6;
    int rt[2] = &amp;#123; 0 &amp;#125;, n;
    t[0].u[0] = -1, t[0].u[1] = 0x3f3f3f3f;
    read(n);
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        read(a[i]);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (i != 1) &amp;#123;
            for (int K = a[i]; K &amp;lt;= m; K += a[i]) &amp;#123;
                for (int mx = std::min(a[i] - 1, m - K); ; ) &amp;#123;
                    int k = ask(rt[0], 1, m, K, K + mx, 0);
                    if (k == -1)
                        break;
                    t[i].emplace_back(k, a[k] - K);
                    if (k == 1 || !(a[k] - K))
                        break;
                    mx = (a[k] - K - 1) / 2;
                &amp;#125;
            &amp;#125;
        &amp;#125;
        add(rt[0], 1, m, a[i], i, 0);
    &amp;#125;
    for (int i = n; i; --i) &amp;#123;
        if (i != n)
            for (int K = a[i]; K &amp;lt;= m; K += a[i])
                for (int mx = std::min(a[i] - 1, m - K); ; ) &amp;#123;
                    int k = ask(rt[1], 1, m, K, K + mx, 1);
                    if (k == 0x3f3f3f3f)
                        break;
                    t[k].emplace_back(i, a[k] - K);
                    if (k == n || !(a[k] - K))
                        break;
                    mx = (a[k] - K - 1) / 2;
                &amp;#125;
        add(rt[1], 1, m, a[i], i, 1);
    &amp;#125;
    int q;
    read(q);
    std::vector&amp;lt;int&amp;gt; res(q + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; u(n + 1);
    for (int i = 1, l, r; i &amp;lt;= q; ++i) &amp;#123;
        read(l), read(r);
        if (l &amp;gt; r)
            std::swap(l, r);
        u[r].emplace_back(l, i);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; bit(n + 1, 0x3f3f3f3f);
    auto lowbit = [&amp;amp;](int x) &amp;#123; return x &amp;amp; -x; &amp;#125;;
    auto add = [&amp;amp;](int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            bit[x] = std::min(bit[x], v);
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        auto res = 0x3f3f3f3f;
        for (; x; x -= lowbit(x))
            res = std::min(res, bit[x]);
        return res;
    &amp;#125;;
    for (int r = 1; r &amp;lt;= n; ++r) &amp;#123;
        for (auto [l, v] : t[r])
            add(n - l + 1, v);
        for (auto [l, i] : u[r])
            res[i] = ask(n - l + 1);
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        print(res[i], &amp;#39;\n&amp;#39;);
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;æ±‚æ”¯é…å¯¹çš„è¿‡ç¨‹ä¹Ÿè¦å¸¦ logï¼ˆçº¿æ®µæ ‘ï¼‰ï¼Œå†åŠ ä¸Šæ‰«æçº¿çš„ 3logï¼Œæ€»å…±æ˜¯å¸¸æ•°æ¯”è¾ƒå¤§çš„ 3logï¼ˆå¡äº†ä¸€ä¸ªä¸Šåˆçš„å¸¸ä¹Ÿæ˜¯æœ‰äº†ï¼‰ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è®²è§£å¦ä¸€ç§å¥‡æŠ€æ·«å·§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æš´åŠ›åˆ†æ²»&lt;/strong&gt;ï¼šæ³¨æ„åˆ°å¯¹äºæ¯”è¾ƒé•¿ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(len&amp;gt; B\)&lt;/span&gt;ï¼‰çš„åŒºé—´ï¼Œç­”æ¡ˆæ¯”è¾ƒå°ï¼›æ•…è€ƒè™‘åˆ†æ²»ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºé•¿è¯¢é—®ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(len&amp;gt;B\)&lt;/span&gt;ï¼‰ï¼Œä»å°åˆ°å¤§æšä¸¾ç­”æ¡ˆå¹¶ checkï¼›é¢„å¤„ç†æŸä¸ªèŒƒå›´ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt;ï¼‰å†…çš„ &lt;span class=&#34;math inline&#34;&gt;\(res\)&lt;/span&gt; å‡ºç°çš„æ‰€æœ‰ä½ç½®ï¼Œå¹³è¡¡çš„æ—¶å€™è¿˜è¦ç®—ä¸Šè°ƒå’Œçº§æ•°å’Œ bitã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºçŸ­è¯¢é—®ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(len\le B\)&lt;/span&gt;ï¼‰ï¼Œå‘ç°æ¯æ¬¡åŒºé—´å†…æš´åŠ›æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(B^2q)\)&lt;/span&gt; çš„ï¼›æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥ï¼Œç²¾ç»†å®ç°ï¼Œåˆ©ç”¨è¯¢é—®çš„å…¬å…±éƒ¨åˆ†ä½¿å¾—&lt;strong&gt;æ¯ä¸€å¯¹æ•°åªè¢«æšä¸¾ä¸€æ¬¡&lt;/strong&gt;å°±èƒ½è¾¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(B^2 + Bq)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€ä¼˜è§£å– &lt;span class=&#34;math inline&#34;&gt;\(B=333,V=483\)&lt;/span&gt;ï¼Œä¸è‡ªå·±å®ç°ä¸€éäº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---ä»™äººæŒ&#34;&gt;D - ä»™äººæŒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3687&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3687&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æŠŠè¾¹åŒä»å›¾ä¸­åˆ é™¤ã€é—®é¢˜è½¬åŒ–ä¸ºæ ‘ä¸Š&lt;strong&gt;è¾¹&lt;/strong&gt;ä¸äº¤çš„é“¾è¦†ç›–ï¼Œä½¿å¾—&lt;strong&gt;æ‰€æœ‰é“¾é•¿ &lt;span class=&#34;math inline&#34;&gt;\(\ge 2\)&lt;/span&gt;&lt;/strong&gt; çš„æ–¹æ¡ˆæ•°ã€‚å‘ç°ç”±äº&lt;strong&gt;è¾¹å¯ä»¥ä¸è¢«è¦†ç›–&lt;/strong&gt;ï¼Œå¸¸è§„ DP ä¼šä½¿å¾—åœ¨çˆ¶èŠ‚ç‚¹å¤„åˆå¹¶æ—¶éœ€è¦é¢å¤–çš„æ•°é‡ç»´ï¼Œå‚è€ƒæ ‘ä¸ŠèƒŒåŒ…ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€è€ƒæ—¶ä¼šæ³¨æ„åˆ°ä¸¤ä¸ªé™åˆ¶å¯ä»¥æŠµæ¶ˆâ€”â€”å¦‚æœè®¤ä¸ºé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„é“¾å°±æ˜¯ä¸è¢«è¦†ç›–çš„è¾¹ï¼Œè¦†ç›–æ‰€æœ‰æ ‘è¾¹ï¼Œæ˜¾ç„¶å¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚æ­¤æ—¶åˆå¹¶æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œæ³¨æ„åˆ°æ¯ä¸ªå„¿å­çš„ç³»æ•°ä¸€å®šéƒ½å‚ä¸ã€åˆ†æ­¥ã€ï¼Œåªéœ€è¦æ±‚å‡ºã€åˆ†ç±»ã€çš„ç³»æ•°ã€‚è¿™ä¸ªå¯ä»¥é¢„å¤„ç†ï¼ˆå’Œ &lt;a href=&#34;/20250407/#a.-äºŒåˆ†å›¾æŸ“è‰²&#34;&gt;äºŒåˆ†å›¾æŸ“è‰²&lt;/a&gt; è¿™ä¸ªé¢˜æœ‰ç‚¹åƒï¼‰ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤ºä¸€ä¸ªç‚¹åº¦æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶çš„ç­”æ¡ˆï¼Œå‚è€ƒé”™æ’çš„æ€è·¯ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯ä»¥ä¸å‚ä¸é…å¯¹ï¼Œä¹Ÿå¯ä»¥ä¹±é€‰ä¸€ä¸ªç‚¹é…å¯¹ï¼Œå¦‚æœé€‰ä¸­äº†å·²é…å¯¹çš„ç‚¹å°±ä»¤å…¶å’Œ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; äº¤æ¢ï¼Œå¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_i=f_{i-1}+(n-1)f_{i-2}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦ check åŸå›¾æ˜¯å¦ä¸ºä»™äººæŒï¼Œé¡ºå¸¦å›å¿†ä¸€ä¸‹è¿é€šæ€§çš„çŸ¥è¯†â€”â€”åœ¨ DFS æ ‘ä¸Šå·®åˆ†ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰è¾¹è¢«è¦†ç›–ä¸¤æ¬¡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, m;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
        for (int x, y; m--; ) &amp;#123;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
            g1[x].push_back(y), g1[y].push_back(x);
        &amp;#125;
        bool flag = 1;
        int now = 0, cnt = 0;
        std::vector&amp;lt;int&amp;gt; st, dfn(n + 1), low(n + 1), col(n + 1), diff(n + 1);
        std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
            st.push_back(x);
            dfn[x] = low[x] = ++now;
            for (auto i : g1[x])
                if (!dfn[i]) &amp;#123;
                    // printf(&amp;quot;x = %d, %d -&amp;gt; %d\n&amp;quot;, x, x, i);
                    DFS(i, x);
                    diff[x] += diff[i];
                    // printf(&amp;quot;x = %d, diff[%d] += diff[%d]\n&amp;quot;, x, x, i);
                    low[x] = std::min(low[x], low[i]);
                &amp;#125;
                else if (i != fa &amp;amp;&amp;amp; dfn[i] &amp;lt; dfn[x]) &amp;#123;
                    low[x] = std::min(low[x], dfn[i]);
                    ++diff[x], --diff[i];
                    // printf(&amp;quot;x = %d, ++diff[%d], --diff[%d]\n&amp;quot;, x, x, i);
                &amp;#125;
            if (diff[x] &amp;gt;= 2)
                flag = 0;
            // printf(&amp;quot;x = %d, diff[%d] = %d\n&amp;quot;, x, x, diff[x]);
            if (low[x] == dfn[x]) &amp;#123;
                ++cnt;
                for (int p = -1; p != x; ) &amp;#123;
                    p = st.back(), st.pop_back();
                    col[p] = cnt;
                &amp;#125;
            &amp;#125;
            return;
        &amp;#125;;
        DFS(1, -1);
        if (!flag) &amp;#123;
            std::cout &amp;lt;&amp;lt; 0 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            continue;
        &amp;#125;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            for (auto j : g1[i])
                if (col[i] != col[j])
                    g[i].push_back(j);
        std::vector&amp;lt;long long&amp;gt; f(n + 1), dp(n + 1);
        dp[0] = 1ll, dp[1] = 1ll;
        for (int i = 2; i &amp;lt;= n; ++i)
            dp[i] = (dp[i - 1] + (i - 1) * dp[i - 2]) % mod;
        std::vector&amp;lt;int&amp;gt; tag(n + 1);
        DFS = [&amp;amp;](int x, int fa) &amp;#123;
            f[x] = 1ll, tag[x] = 1;
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    DFS(i, x);
                    (f[x] *= f[i]) %= mod;
                &amp;#125;
            (f[x] *= dp[(int)g[x].size()]) %= mod;
            return;
        &amp;#125;;
        auto res(1ll);
        for (int i = 1; i &amp;lt;= n; ++i)
            if (!tag[i])
                DFS(i, -1), (res *= f[i]) %= mod;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;p&gt;E. Many Minimizations æ˜¯æ•°å­¦é¢˜ï¼Œè·³äº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;æ— åé¢˜&#34;&gt;æ— åé¢˜&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;èƒŒæ™¯ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n,k\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\forall\, 1\le i\le n\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a_i=i\bmod k\)&lt;/span&gt;ï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ä¸ªæœ¬è´¨ä¸åŒçš„å­åºåˆ—ï¼Ÿå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k=1,2,\cdots,n\)&lt;/span&gt; åˆ†åˆ«æ±‚å‡ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;maimai&#34;&gt;maimai&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://ac.nowcoder.com/acm/contest/66112/F&#34; class=&#34;uri&#34;&gt;https://ac.nowcoder.com/acm/contest/66112/F&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="å­—å…¸æ ‘" />
        <category term="å­—ç¬¦ä¸²" />
        <category term="ç»„åˆæ•°å­¦" />
        <category term="æ”¯é…å¯¹" />
        <updated>2025-08-09T04:33:17.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250807/</id>
        <title>å­¦ä¹ ç¬”è®°ï¼šåˆ†æ‹†æ•°ä¸ Ferrers å›¾</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250807/"/>
        <content type="html">&lt;p&gt;éœ€è¦çŸ¥é“æ¦‚å¿µå’Œæ±‚æ³•ï¼Œæœ‰ä¸€å®šçš„ç”¨å¤„&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;åˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°&#34;&gt;åˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°&lt;/h2&gt;
&lt;p&gt;è¦æ±‚ï¼šç»™å®šä¸€ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œè¦æ±‚å°†å…¶åˆ’åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªå¯é‡ / ä¸å¯é‡çš„æ­£æ•´æ•°ï¼Œé—®æœ¬è´¨ä¸åŒçš„æ–¹æ¡ˆæ•°ã€‚ï¼ˆæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(\sqrt n\)&lt;/span&gt; åŒé˜¶ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;ä¸å¦¨ä»¤åˆ’åˆ†ç»“æœå•è°ƒä¸é™ï¼Œåˆ™æœ‰ä¸¤ç§ DP è·¯å¾„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æ³•ä¸€ï¼šä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ†æˆ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæ­£æ•´æ•°çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯é‡ï¼šè€ƒè™‘å°†è¿™ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæ•°å‡å» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚æœ€å¤šä¸€ä¸ªå…ƒç´ ç”± &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œç»„æ•°å‡å°‘ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼›å…¶ä»–æ—¶å€™è¿˜æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ç»„ã€‚æ•…äº‘ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=f_{i-j,j-1}+f_{i-j,j}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯é‡ï¼šå¦‚æœå­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå¯ä»¥åˆ é™¤ä¹‹ç„¶åè½¬ç§»ï¼›å¦åˆ™ä»æ•´ä½“å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; è½¬ç§»ã€‚æ•…æ›° &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=f_{i-1,j-1}+f_{i-j,j}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
è¯¥è½¬ç§»æ–¹æ³•å”¯ä¸€æ€§å¾ˆæ˜¾ç„¶ã€‚&lt;strong&gt;æ³¨æ„åˆ°ç¬¬äºŒç»´åªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(j,j-1\)&lt;/span&gt; æœ‰å…³ï¼›å¯ä»¥äº¤æ¢å‰åä¸¤ç»´é¡ºåºç„¶åæ»šåŠ¨ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ³•äºŒï¼šä»¤ &lt;span class=&#34;math inline&#34;&gt;\(n=\sum a_i\)&lt;/span&gt;ï¼Œå»ºç«‹ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å·®åˆ†æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ï¼Œåˆ™æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n=\sum\limits_{i=1}^m \sum\limits_{j=1}^i c_j=\sum\limits_{i=1}^m (n-i+1)\times a_i\)&lt;/span&gt;ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æ¯å¢å¤§ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œç­”æ¡ˆä¼šå¢å¤§ &lt;span class=&#34;math inline&#34;&gt;\(n-i+1\)&lt;/span&gt;ã€‚æ•…è½¬åŒ–ä¸ºã€ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‰©å“é‡é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n-i+1\)&lt;/span&gt;ã€çš„å®Œå…¨èƒŒåŒ…ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯é‡ï¼šè¦æ±‚æ¯ä¸ªç‰©å“è‡³å°‘é€‰ä¸€æ¬¡ã€‚&lt;/li&gt;
&lt;li&gt;å¯é‡ï¼šæ— é™åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯¥æ–¹æ³•å”¯ä¸€æ€§æ›´æ˜¾ç„¶ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¤æ‚åº¦å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(O(V\sqrt V)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¾‹sets-of-complementary-sums&#34;&gt;ä¾‹ï¼šSets of Complementary Sums&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;/20250723/#e.-sets-of-complementary-sums&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ferrers-å›¾&#34;&gt;Ferrers å›¾&lt;/h2&gt;
&lt;p&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªåˆ†æ‹†å‡ºæ¥çš„æ•°ç”¨æ¨ªå‘æŸ±çŠ¶å›¾è¡¨ç¤ºå¹¶å•è°ƒä¸å¢æ’åˆ—ï¼Œå¾—åˆ° Ferrers å›¾ã€‚&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;image-1.png&#34; alt=&#34;ä¾‹ï¼š12=5+4+2+1 çš„ Ferrers å›¾ï¼ˆå›¾æº OI Wikiï¼‰&#34; /&gt;&lt;figcaption&gt;ä¾‹ï¼š&lt;span class=&#34;math inline&#34;&gt;\(12=5+4+2+1\)&lt;/span&gt; çš„ Ferrers å›¾ï¼ˆå›¾æº OI Wikiï¼‰&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;å°†å›¾åƒæ–œå‘ç¿»æŠ˜å¾—åˆ°ä¸€ç»„å…±è½­è§£ï¼ŒåŸå›¾ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å³ä¸ºå…±è½­è§£ä¸­çš„å…ƒç´ æœ€å€¼ã€‚æ•…äº¦å¯é™å®šåˆ†æ‹†ç»“æœçš„æœ€å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œåˆ™ç»“æœä»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{n,k}\)&lt;/span&gt;ã€‚åŒæ—¶é€‚ç”¨äºåˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é¡ºå¸¦æä¸€å˜´æ¨è¡¨ï¼šæŠŠç‚¹æ›¿æ¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt;ï¼Œå¹¶ä½¿å¾—ä¸€ä¸ªç‚¹åŒæ—¶å¤§äºå·¦ä¾§å’Œä¸Šæ–¹çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¼¼ä¹å°±ä¸æ˜¯å¾ˆæœ‰ç”¨äº†ã€‚è®¡æ•°é¢˜å¯èƒ½ä¼šè€ƒã€‚&lt;/p&gt;
</content>
        <category term="DP" />
        <updated>2025-08-07T08:20:45.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250805/</id>
        <title>çŠ¶å‹ DP</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250805/"/>
        <content type="html">&lt;p&gt;æ²¡è¡¥å®Œï¼ˆ1/3ï¼‰ï¼ŒåŠ¨ä½œè¿˜æ˜¯å¤ªæ…¢äº†&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---åªä¸è¿‡æ˜¯é•¿çš„é¢†å¸¦-2-just-long-neckties-2&#34;&gt;A - åªä¸è¿‡æ˜¯é•¿çš„é¢†å¸¦ 2 / Just Long Neckties 2&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11665&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11665&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦è§‚å¯Ÿåˆ°ï¼Œä»»æ„æ—¶åˆ» &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; ä¸­ä¸å­˜åœ¨é‡å¤å…ƒç´ ã€‚æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; å‹å‡ºæ¥ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,S}\)&lt;/span&gt; è¡¨ç¤ºé€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå½“å‰ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; æ˜¯å¦å¯è¡Œï¼Œèƒ½å¤Ÿ &lt;span class=&#34;math inline&#34;&gt;\(O(n\cdot 2^V)\)&lt;/span&gt;ã€‚å¯¹äºæŸä¸ª &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œåªå…³å¿ƒå®ƒæœ€è¿œèƒ½åˆ°è¾¾å“ªä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; è®°å½•ä¹‹ã€‚å¯¹äºæ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œéƒ½å¯ä»¥æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; åç¬¬ä¸€å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i,a_{i+1}\notin S\)&lt;/span&gt;ï¼Œç”¨å…¶åˆ·è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°ã€æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; åç¬¬ä¸€å¯¹éæ³•å…ƒç´ ã€æ˜¯å¾ˆæ…¢çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ï¼›å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; åœ¨å…¶åç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_x=p\)&lt;/span&gt; ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åæ–¹ &lt;span class=&#34;math inline&#34;&gt;\(a_y=p,a_{y+1}=q\)&lt;/span&gt; ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œç›¸å½“äº&lt;strong&gt;å…ˆæ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å†æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\((p,q)\)&lt;/span&gt;&lt;/strong&gt;ï¼Œå°±å¯ä»¥åšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(V^2\cdot 2^V+n\cdot V)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    int V = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        V = std::max(V, a[i]--);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; tx(n + 1, std::vector&amp;lt;int&amp;gt; (V)), ty(n + 1, std::vector&amp;lt;int&amp;gt; (V));
    std::vector&amp;lt;int&amp;gt; lp(V);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; lpq(V, std::vector&amp;lt;int&amp;gt; (V));
    for (int i = n; ~i; --i) &amp;#123;
        if (i &amp;amp;&amp;amp; i != n)
            lpq[a[i]][a[i + 1]] = i;
        for (int j = 0; j &amp;lt; V; ++j) &amp;#123;
            tx[i][j] = lp[j];
            if (i != n)
                ty[i][j] = lpq[a[i]][j];
        &amp;#125;
        if (i != 0)
            lp[a[i]] = i;
    &amp;#125;
    int siz = 1 &amp;lt;&amp;lt; V, res = 21;
    std::vector&amp;lt;int&amp;gt; f(siz);
    for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; p0, p1;
        for (int j = 0; j &amp;lt; V; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1)
                p1.push_back(j);
            else
                p0.push_back(j);
        int j = n;
        for (auto p : p0)
            if (tx[f[i]][p])
                for (auto q : p0)
                    if (ty[tx[f[i]][p]][q])
                        j = std::min(j, ty[tx[f[i]][p]][q]);
        if (j != n) &amp;#123;
            f[i ^ (1 &amp;lt;&amp;lt; a[j])] = std::max(f[i ^ (1 &amp;lt;&amp;lt; a[j])], j);
            f[i ^ (1 &amp;lt;&amp;lt; a[j + 1])] = std::max(f[i ^ (1 &amp;lt;&amp;lt; a[j + 1])], j + 1);
            for (auto k : p1) &amp;#123;
                f[i ^ (1 &amp;lt;&amp;lt; k) ^ (1 &amp;lt;&amp;lt; a[j])] = std::max(f[i ^ (1 &amp;lt;&amp;lt; k) ^ (1 &amp;lt;&amp;lt; a[j])], j);
                f[i ^ (1 &amp;lt;&amp;lt; k) ^ (1 &amp;lt;&amp;lt; a[j + 1])] = std::max(f[i ^ (1 &amp;lt;&amp;lt; k) ^ (1 &amp;lt;&amp;lt; a[j + 1])], j + 1);
            &amp;#125;
        &amp;#125;
        else
            res = std::min(res, __builtin_popcount(i));
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---cut-and-reorder&#34;&gt;B - Cut and Reorder&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc328/tasks/abc328_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc328/tasks/abc328_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸å¦¨å…ˆé‡æ’å†ä¿®æ”¹ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,S}\)&lt;/span&gt; è¡¨ç¤ºå·²ç»é‡æ’å¥½æ–°åºåˆ—çš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå…ƒç´ ï¼Œå¯¹åº”åŸåºåˆ—çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æœ€å°ä»£ä»·ã€‚æšä¸¾æ–°åŒºé—´å®¹æ˜“è½¬ç§»ã€‚å¯ä»¥å‘ç°æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(i,S\)&lt;/span&gt; çš„å®é™…å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(2^n)\)&lt;/span&gt;ï¼ˆç©ºé—´ä¹Ÿå¯ä»¥è¿™ä¹ˆä¼˜åŒ–ï¼‰ï¼Œé¢„å¤„ç†ä¹‹åæ€»æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2\cdot 2^n)\)&lt;/span&gt;ï¼Œè·‘ä¸æ»¡ï¼Œå¯ä»¥é€šè¿‡ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    long long c;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; c;
    std::vector&amp;lt;long long&amp;gt; a(n), b(n);
    for (int i = 0; i &amp;lt; n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 0; i &amp;lt; n; ++i)
        std::cin &amp;gt;&amp;gt; b[i];
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    brr p(n, arr(n));
    crr g(n, brr(n, arr(n)));
    for (int l = 0; l &amp;lt; n; ++l)
        for (int r = l; r &amp;lt; n; ++r) &amp;#123;
            for (int k = l; k &amp;lt;= r; ++k)
                p[l][r] ^= (1 &amp;lt;&amp;lt; k);
            for (int R = r - l; R &amp;lt; n; ++R)
                for (int L = R, j = r; j &amp;gt;= l; --L, --j)
                    g[l][r][R] += std::abs(b[L] - a[j]);
        &amp;#125;
    int siz = 1 &amp;lt;&amp;lt; n;
    std::vector&amp;lt;long long&amp;gt; f(siz, inf);
    f[0] = 0ll;
    for (int j = 1; j &amp;lt; siz; ++j) &amp;#123;
        int i = __builtin_popcount(j) - 1;
        for (int r = 0; r &amp;lt; n; ++r)
            for (int l = r; ~l &amp;amp;&amp;amp; ((j &amp;gt;&amp;gt; l) &amp;amp; 1); --l)
                f[j] = std::min(f[j], f[j ^ p[l][r]] + g[l][r][i] + c);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[siz - 1] - c &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---electric-circuit&#34;&gt;C - Electric Circuit&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc321/tasks/abc321_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc321/tasks/abc321_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆåƒ&lt;a href=&#34;/20250430/#æœ‰æ ‡å·æ— å‘å›¾è®¡æ•°&#34;&gt;æ— å‘å›¾å®¹æ–¥&lt;/a&gt;ï¼Ÿä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; è¡¨ç¤ºè®© &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…éƒ¨å®Œæˆé…å¯¹ï¼Œå¯ä»¥ä¸è¿é€šçš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…éƒ¨ç‚¹å‡ºã€å…¥åº¦ä¹‹å’Œç›¸ç­‰ï¼ˆè®°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(cnt\)&lt;/span&gt;ï¼‰æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; æœ‰å€¼ &lt;span class=&#34;math inline&#34;&gt;\(cnt!\)&lt;/span&gt;ã€‚ç›¸ä¼¼åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(g_S\)&lt;/span&gt; è¡¨ç¤ºè®© &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å®Œæˆé…å¯¹ï¼Œæˆä¸ºä¸€ä¸ªè¿é€šå—çš„æ–¹æ¡ˆæ•°ï¼Œå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(g_S=f_S-\sum\limits_{v\in S} f_{S\oplus v}\cdot g_v\)&lt;/span&gt;ã€‚è®© &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å¿…é¡»åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­ç¼–å·æœ€å°çš„ç‚¹å°±å¯ä»¥å»é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä»è´¡çŒ®çš„è§’åº¦å‡ºå‘ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å¸¦æ¥çš„è´¡çŒ®å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(g_S\cdot f_{U\oplus S}\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt; æ˜¯å…¨é›†ã€‚æœ€åé™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(M!\)&lt;/span&gt; æ±‚å‡ºæœŸæœ›ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(3^n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; ci(n), co(n);
    for (int i = 1, x; i &amp;lt;= m; ++i)
        std::cin &amp;gt;&amp;gt; x, ++ci[x - 1];
    for (int i = 1, x; i &amp;lt;= m; ++i)
        std::cin &amp;gt;&amp;gt; x, ++co[x - 1];
    std::vector&amp;lt;long long&amp;gt; fac(m + 1);
    fac[0] = 1ll;
    for (int i = 1; i &amp;lt;= m; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    int siz = 1 &amp;lt;&amp;lt; n;
    std::vector&amp;lt;long long&amp;gt; f(siz), g(siz);
    for (int i = 1; i &amp;lt; siz; ++i) &amp;#123;
        int si = 0, so = 0;
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1)
                si += ci[j], so += co[j];
        if (si == so)
            f[i] = fac[si];
    &amp;#125;
    auto res(0ll);
    for (int i = 1; i &amp;lt; siz; ++i) &amp;#123;
        g[i] = f[i];
        int mn = 0;
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1) &amp;#123;
                mn = j;
                break;
            &amp;#125;
        int s = i ^ (1 &amp;lt;&amp;lt; mn);
        (g[i] += mod - g[1 &amp;lt;&amp;lt; mn] * f[s] % mod) %= mod;
        for (int j = (s - 1) &amp;amp; s; j; j = (j - 1) &amp;amp; s)
            (g[i] += mod - g[j ^ (1 &amp;lt;&amp;lt; mn)] * f[s ^ j] % mod) %= mod;
        if (i != siz - 1)
            (res += g[i] * f[(siz - 1) ^ i]) %= mod;
        else
            (res += g[i]) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res * qkp(fac[m], mod - 2) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---count-grid-3-coloring&#34;&gt;D - Count Grid 3-coloring&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc379/tasks/abc379_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc379/tasks/abc379_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è½®å»“çº¿ DPã€‚æŠŠæ¯ä¸€åˆ—å·²ç»ç¡®å®šçš„æœ€é ä¸‹çš„å…ƒç´ å‹èµ·æ¥ï¼Œæ¯è¡Œé€ä¸ªç¡®å®šå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æœ‰æ•ˆçŠ¶æ€ä¸­åªèƒ½å®¹è®¸æœ€å¤šä¸€å¯¹ç›¸é‚»ç›¸åŒå…ƒç´ ï¼Œè¿™æ ·å¤æ‚åº¦å°±èƒ½é™ä¸‹æ¥äº†ã€‚æ³¨æ„ç‰¹åˆ¤ &lt;span class=&#34;math inline&#34;&gt;\(1\times 1\)&lt;/span&gt; çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::array&amp;lt;int, 15&amp;gt; p;
    p[0] = 1;
    for (int i = 1; i &amp;lt; 15; ++i)
        p[i] = p[i - 1] * 3;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; a;
    if (n &amp;gt;= m) &amp;#123;
        a.assign(n + 1, std::vector&amp;lt;int&amp;gt; (m + 1));
        for (int i = 1; i &amp;lt;= n; ++i) 
            for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
                char t;
                std::cin &amp;gt;&amp;gt; t, a[i][j] = (t == &amp;#39;?&amp;#39; ? -1 : t - &amp;#39;1&amp;#39;);
            &amp;#125;
    &amp;#125;
    else &amp;#123;
        std::swap(n, m);
        a.assign(n + 1, std::vector&amp;lt;int&amp;gt; (m + 1));
        for (int i = 1; i &amp;lt;= m; ++i)
            for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
                char t;
                std::cin &amp;gt;&amp;gt; t, a[j][i] = (t == &amp;#39;?&amp;#39; ? -1 : t - &amp;#39;1&amp;#39;);
            &amp;#125;
    &amp;#125;
    int siz = p[m];
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    std::vector&amp;lt;int&amp;gt; s, tab(siz, -1);
    auto getv_1 = [&amp;amp;](int j, int i) &amp;#123;
        return (j / p[i - 1]) % 3;
    &amp;#125;;
    auto getv = [&amp;amp;](int j, int i) &amp;#123;
        return (s[j] / p[i - 1]) % 3;
    &amp;#125;;
    auto chg = [&amp;amp;](int j, int i, int v) &amp;#123;
        return tab[s[j] - p[i - 1] * getv(j, i) + p[i - 1] * v];
    &amp;#125;;
    auto out = [&amp;amp;](int i) &amp;#123;
        std::string s;
        for (int j = 1; j &amp;lt;= m; ++j)
            s += &amp;#39;1&amp;#39; + getv_1(i, j);
        return s.c_str();
    &amp;#125;;
    for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
        s.push_back(i);
        int cnt = 0;
        for (int j = 2; j &amp;lt;= m; ++j)
            if (getv_1(i, j - 1) == getv_1(i, j) &amp;amp;&amp;amp; ++cnt &amp;gt;= 2) &amp;#123;
                s.pop_back();
                break;
            &amp;#125;
    &amp;#125;
    for (int i = 0; i &amp;lt; (int)s.size(); ++i)
        tab[s[i]] = i;
    siz = (int)s.size();
    if (n == 1) &amp;#123;
        std::cout &amp;lt;&amp;lt; (a[1][1] == -1 ? 3 : 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    crr f(n + 1, brr(m + 1, arr(siz)));
    for (int i = 0; i &amp;lt; siz; ++i)
        if ([&amp;amp;](int i, int s) &amp;#123;
            for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
                if (a[i][j] != -1 &amp;amp;&amp;amp; a[i][j] != getv(s, j))
                    return false;
                if (j != 1 &amp;amp;&amp;amp; getv(s, j) == getv(s, j - 1))
                    return false;
            &amp;#125;
            return true;
        &amp;#125; (1, i)) &amp;#123;
            for (int p = 0; p &amp;lt; 3; ++p)
                if ((a[2][1] == -1 || a[2][1] == p) &amp;amp;&amp;amp; getv(i, 1) != p &amp;amp;&amp;amp; ~chg(i, 1, p))
                    (++f[2][1][chg(i, 1, p)]) %= mod;
        &amp;#125;
    for (int i = 2; i &amp;lt;= n; ++i) &amp;#123;
        for (int k = 1; k &amp;lt; m; ++k)
            for (int j = 0; j &amp;lt; siz; ++j)
                if (f[i][k][j]) &amp;#123;
                    // printf(&amp;quot;f[%d][%d][%s] = %lld\n&amp;quot;, i, k, out(s[j]), f[i][k][j]);
                    for (int p = 0; p &amp;lt; 3; ++p)
                        if ((a[i][k + 1] == -1 || a[i][k + 1] == p) &amp;amp;&amp;amp; getv(j, k) != p &amp;amp;&amp;amp; getv(j, k + 1) != p &amp;amp;&amp;amp; ~chg(j, k + 1, p))
                            (f[i][k + 1][chg(j, k + 1, p)] += f[i][k][j]) %= mod;
                &amp;#125;
        for (int j = 0; j &amp;lt; siz; ++j)
            if (i != n &amp;amp;&amp;amp; f[i][m][j])
                for (int p = 0; p &amp;lt; 3; ++p)
                    if ((a[i + 1][1] == -1 || a[i + 1][1] == p) &amp;amp;&amp;amp; getv(j, 1) != p &amp;amp;&amp;amp; ~chg(j, 1, p))
                        (f[i + 1][1][chg(j, 1, p)] += f[i][m][j]) %= mod;
    &amp;#125;
    auto res = 0ll;
    for (int i = 0; i &amp;lt; siz; ++i)
        (res += f[n][m][i]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---pure-straight&#34;&gt;E - Pure Straight&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc126/tasks/arc126_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc126/tasks/arc126_d&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰‹ç©å‘ç°åªè¦æœ€ç»ˆåºåˆ—ç¡®å®šï¼Œé‚£ä¹ˆç§»åŠ¨çš„é¡ºåºä¸å½±å“ç­”æ¡ˆã€‚æ•…è€ƒè™‘ç¡®å®šç›®æ ‡ä½ç½®å’Œç§»åŠ¨åºåˆ—ã€‚è€ƒè™‘ç»å¯¹å€¼çš„å‡ ä½•æ„ä¹‰ï¼Œä¸å¦¨ä»¤ç›®æ ‡å­åºåˆ—ä¸­å…ƒç´ é›†ä¸­åˆ°è¢«é€‰ä¸­ä½ç½®çš„ä¸­é—´å…ƒç´ ï¼Œæ­¤æ—¶çš„ä»£ä»·å¯ä»¥è®¡ç®—ã€‚ç”¨ç‚¹äºŒè¿›åˆ¶æŠ€å·§å’Œåº“å‡½æ•°å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; ç®—ä»£ä»·ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    int siz = 1 &amp;lt;&amp;lt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1), f(siz, 0x3f3f3f3f);
    auto out = [&amp;amp;](int j) &amp;#123;
        std::string s;
        for (int i = 0; i &amp;lt; k; ++i)
            s += (&amp;#39;0&amp;#39; + ((j &amp;gt;&amp;gt; i) &amp;amp; 1));
        return s.c_str();
    &amp;#125;;
    f[0] = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i], --a[i];
        for (int j = siz - 1; j &amp;gt;= 0; --j) &amp;#123;
            if (!((j &amp;gt;&amp;gt; a[i]) &amp;amp; 1))
                f[j | (1 &amp;lt;&amp;lt; a[i])] = std::min(f[j | (1 &amp;lt;&amp;lt; a[i])], f[j] + __builtin_popcount(j &amp;amp; (~((1 &amp;lt;&amp;lt; a[i]) - 1))));
            f[j] += std::min(__builtin_popcount(j), k - __builtin_popcount(j));
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[siz - 1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---123-set&#34;&gt;F - 123 Set&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc184/tasks/arc184_b&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc184/tasks/arc184_b&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åšè¿‡ &lt;a href=&#34;https://www.luogu.com.cn/problem/P3226&#34;&gt;é›†åˆé€‰æ•°&lt;/a&gt;ï¼ˆè¿™ä¸ª trick è§è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œåº”è¯¥ä¸åªè¿™ä¸€é“ï¼Œä½†æˆ‘æƒ³ä¸èµ·æ¥äº†ï¼‰å¾ˆå®¹æ˜“æƒ³åˆ°ç”»ä¸€ä¸ªè¡¨æ ¼æˆ–è€… DAG å‡ºæ¥ï¼Œå…¶å®éƒ½èƒ½åš&lt;/p&gt;
&lt;p&gt;å¯¹äºè¡¨æ ¼å·¦ä¸Šè§’å’Œ DAG çš„æºç‚¹ï¼Œè‚¯å®šæ˜¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå…¶ä¸æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; çš„å€æ•°ã€‚å¦‚æœç”»è¡¨ï¼Œæ¨ªä¹˜ 3 ç«–ä¹˜ 2ï¼Œè§‚å¯Ÿä¸€ä¸‹æ˜¯åŒ…å«äº† &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; æ°å¥½ä¸€æ¬¡çš„å¾ˆå¤šä¸ªæ¨è¡¨ï¼ˆæ²¡ä»€ä¹ˆç”¨ï¼Œæä¸€å˜´è€Œå·²ï¼‰ï¼Œè€ƒè™‘è½¬åŒ–ç›®æ ‡ï¼Œå‘ç°æ˜¯ç”¨ä¸€ä¸ªä¸å¯æ—‹è½¬çš„å€’ L å½¢éª¨ç‰Œå¯å æ”¾åœ°é“ºæ»¡å¼‚å½¢è¡¨æ ¼ï¼Œå¯ä»¥è€ƒè™‘è½®å»“çº¿ DP&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œç”¨ 1 æ¥è¡¨ç¤ºæ‹è§’å¤„ï¼Œ0 è¡¨ç¤ºå…¶ä»–ï¼Œå æ”¾çš„æ—¶å€™ 1 çš„ä¼˜å…ˆçº§æ¯” 0 é«˜ï¼Œç„¶åå°±å¯ä»¥åšäº†ã€‚ä»¥ 3 ä¸ºè¡Œï¼Œæ‚²è§‚ä¼°è®¡å•ä¸ªè¡¨æ ¼å¤§æ¦‚æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(31\times 2^{19}\)&lt;/span&gt; ä¸ªçŠ¶æ€ï¼Œè¿ç®—æ¬¡æ•°å·®ä¸å¤š &lt;span class=&#34;math inline&#34;&gt;\(31\times 19\times 2^{19}\)&lt;/span&gt;ï¼›å†å‘ç°é•¿å¾—ä¸€æ¨¡ä¸€æ ·çš„è¡¨æ ¼è‚¯å®šæ–¹æ¡ˆæ•°æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœæŠŠä»»æ„ä¸€ä¸ªè¡¨æ ¼å…¨éƒ¨é™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå°±ä¼šå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n=10^9\div x\)&lt;/span&gt; æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºå·¦ä¸Šè§’çš„æ¨è¡¨ï¼Œå°±æ˜¯è¯´é•¿ç›¸åªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(10^9\div x\)&lt;/span&gt; çš„å€¼æœ‰å…³ï¼Œå¯ä»¥æ•´é™¤åˆ†å— ğŸ˜± å¯é¢„è®¡çš„è·‘å¾—éå¸¸ä¸æ»¡ï¼Œå®è·µä¸‹æ¥æ˜¯å¯ä»¥è¿‡çš„ï¼ˆä½†æ˜¯å¾ˆæ…¢ï¼‰&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    auto calc = [&amp;amp;](int r) &amp;#123;
        return r - r / 2 - r / 3 + r / 6;
    &amp;#125;;
    auto dp = [&amp;amp;](int lim) &amp;#123;
        if (lim == 1) &amp;#123;
            // printf(&amp;quot;lim = 1, ret 1&amp;quot;);
            return 1;
        &amp;#125;
        int n = 1, m = 1;
        for (int k = 1; k * 2 &amp;lt;= lim; ++n, k *= 2);
        for (int k = 1; k * 3 &amp;lt;= lim; ++m, k *= 3);
        int siz = 1 &amp;lt;&amp;lt; m;
        std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; &amp;gt; f(2, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (2, std::vector&amp;lt;int&amp;gt; (siz))), p(n + 1, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (m));
        std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; &amp;gt; t(2, std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; (2, std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; (siz))); // sb
        auto upd = [&amp;amp;](int i, int k, int j, int v) &amp;#123;
            if (t[i &amp;amp; 1][k &amp;amp; 1][j] != std::make_pair(i, k)) &amp;#123;
                p[i][k].push_back(j);
                t[i &amp;amp; 1][k &amp;amp; 1][j] = &amp;#123; i, k &amp;#125;, f[i &amp;amp; 1][k &amp;amp; 1][j] = v;
            &amp;#125;
            else
                f[i &amp;amp; 1][k &amp;amp; 1][j] = std::min(f[i &amp;amp; 1][k &amp;amp; 1][j], v);
            return;
        &amp;#125;;
        auto chg = [&amp;amp;](int i, int j, int v) &amp;#123;
            return i ^ (((i &amp;gt;&amp;gt; j) &amp;amp; 1) &amp;lt;&amp;lt; j) ^ (v &amp;lt;&amp;lt; j);
        &amp;#125;;
        for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
            bool flag = 0;
            for (int j = 0; j &amp;lt; m; ++j)
                if (((i &amp;gt;&amp;gt; j) &amp;amp; 1) || (j &amp;amp;&amp;amp; ((i &amp;gt;&amp;gt; (j - 1)) &amp;amp; 1)));
                else &amp;#123;
                    flag = 1;
                    break;
                &amp;#125;
            if (!flag)
                upd(1, m - 1, i, __builtin_popcount(i));
        &amp;#125;
        for (int i = 2; i &amp;lt;= n; i++) &amp;#123;
            int m1 = 1;
            for (int x = (1 &amp;lt;&amp;lt; (i - 1)); x * 3ll &amp;lt;= lim; ++m1, x *= 3);
            int siz1 = 1 &amp;lt;&amp;lt; m1;
            for (auto j : p[i - 1][m - 1]) &amp;#123;
                if (j &amp;amp; 1)
                    upd(i, 0, chg(j &amp;amp; (siz1 - 1), 0, 0), f[(i - 1) &amp;amp; 1][(m - 1) &amp;amp; 1][j]);
                upd(i, 0, chg(j &amp;amp; (siz1 - 1), 0, 1), f[(i - 1) &amp;amp; 1][(m - 1) &amp;amp; 1][j] + 1);
            &amp;#125;
            m = m1, siz = siz1;
            for (int k = 0; k &amp;lt; m - 1; ++k)
                for (auto j : p[i][k]) &amp;#123;
                    if (((j &amp;gt;&amp;gt; k) &amp;amp; 1) || ((j &amp;gt;&amp;gt; (k + 1)) &amp;amp; 1))
                        upd(i, k + 1, chg(j, k + 1, 0), f[i &amp;amp; 1][k &amp;amp; 1][j]);
                    upd(i, k + 1, chg(j, k + 1, 1), f[i &amp;amp; 1][k &amp;amp; 1][j] + 1);
                &amp;#125;
        &amp;#125;
        int res = 0x3f3f3f3f;
        for (auto i : p[n][m - 1])
            res = std::min(res, f[n &amp;amp; 1][(m - 1) &amp;amp; 1][i]);
        return res;
    &amp;#125;;
    int res = 0;
    for (int l = 1, r; l &amp;lt;= n; l = r + 1) &amp;#123;
        r = n / (n / l);
        if (calc(r) - calc(l - 1))
            res += (calc(r) - calc(l - 1)) * dp(n / l);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="çŠ¶å‹ DP" />
        <updated>2025-08-05T06:33:55.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250803/</id>
        <title>æ ‘ DP</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250803/"/>
        <content type="html">&lt;p&gt;æ ‘ä¸Šçš„ DP ä»¥åŠ å’Œæ ‘æœ‰å…³çš„ DP&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---svjetlo&#34;&gt;A - Svjetlo&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7163&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7163&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œå³ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,0/1/2}\)&lt;/span&gt; åˆ†åˆ«è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/2\)&lt;/span&gt; ä¸ªç«¯ç‚¹åœ¨å­æ ‘å†…éƒ¨çš„æƒ…å†µï¼›ç„¶åå°±å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ»¡è¶³å¯¹äºå¼€å…³çŠ¶æ€çš„è¦æ±‚ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯æƒ³å°‘äº†ã€‚å¦‚æœå†åŠ ä¸€ç»´ï¼Œä»ã€çŠ¶æ€ä¸ºå¼€æˆ–å…³ã€æ€è€ƒå°±ä¼šè½»æ¾å¾ˆå¤šï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,0/1/2,0/1}\)&lt;/span&gt; è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/2\)&lt;/span&gt; ä¸ªç«¯ç‚¹å†å­æ ‘å¤–éƒ¨ï¼Œä¸”å­æ ‘å†…æ“ä½œå®Œå &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ºå…³ / å¼€çš„æœ€å°‘æ­¥æ•°ã€‚ç„¶ååˆ†ç±»è®¨è®ºè½¬ç§»æ–¹å¼å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„è®¨è®ºæ–¹å¼æ˜¯ï¼Œå…ˆç¡®å®šæŸç§æƒ…å†µä¸‹ï¼Œè®¿é—® &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æ¬¡æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°å®ƒä»¬åŸæœ¬çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, rt = -1;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t;
        a[i] = t - &amp;#39;0&amp;#39;;
        if (!a[i])
            rt = i;
    &amp;#125;
    if (rt == -1) &amp;#123;
        std::cout &amp;lt;&amp;lt; 0 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        tag[x] = a[x];
        for (auto i : g[x])
            if (i != fa)
                DFS(i, x), tag[x] &amp;amp;= tag[i];
        return;
    &amp;#125;;
    DFS(rt, -1);
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (3, std::vector&amp;lt;int&amp;gt; (2, 0x3f3f3f3f)));
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        f[x][0][a[x]] = 0;
        for (auto i : g[x])
            if (i != fa &amp;amp;&amp;amp; !tag[i]) &amp;#123;
                DFS(i, x);
                auto g = f[x];
                f[x][0][0] = std::min(g[0][0] + f[i][0][1] + 4, g[0][1] + f[i][0][0] + 2);
                f[x][0][1] = std::min(g[0][1] + f[i][0][1] + 4, g[0][0] + f[i][0][0] + 2);
                f[x][1][0] = std::min(&amp;#123; g[1][0] + f[i][0][1] + 4, g[1][1] + f[i][0][0] + 2, g[0][0] + f[i][1][0] + 3, g[0][1] + f[i][1][1] + 1 &amp;#125;);
                f[x][1][1] = std::min(&amp;#123; g[1][1] + f[i][0][1] + 4, g[1][0] + f[i][0][0] + 2, g[0][1] + f[i][1][0] + 3, g[0][0] + f[i][1][1] + 1 &amp;#125;);
                f[x][2][0] = std::min(&amp;#123; g[2][0] + f[i][0][1] + 4, g[2][1] + f[i][0][0] + 2, g[1][0] + f[i][1][1], g[1][1] + f[i][1][0] + 2, g[0][0] + f[i][2][1] + 4, g[0][1] + f[i][2][0] + 2 &amp;#125;);
                f[x][2][1] = std::min(&amp;#123; g[2][1] + f[i][0][1] + 4, g[2][0] + f[i][0][0] + 2, g[1][1] + f[i][1][1], g[1][0] + f[i][1][0] + 2, g[0][1] + f[i][2][1] + 4, g[0][0] + f[i][2][0] + 2 &amp;#125;);
            &amp;#125;
        f[x][1][0] = std::min(f[x][1][0], f[x][0][1] + 1);
        f[x][1][1] = std::min(f[x][1][1], f[x][0][0] + 1);
        f[x][2][0] = std::min(f[x][2][0], f[x][1][0]);
        f[x][2][1] = std::min(f[x][2][1], f[x][1][1]);
        // for (int i = 0; i &amp;lt; 3; ++i)
        //     for (int j = 0; j &amp;lt; 2; ++j)
        //         printf(&amp;quot;f[%d][%d][%d] = %d\n&amp;quot;, x, i, j, f[x][i][j]);
        return;
    &amp;#125;;
    DFS(rt, -1);
    std::cout &amp;lt;&amp;lt; f[rt][2][1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---one-to-one&#34;&gt;B - One to One&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc140/tasks/arc140_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc140/tasks/arc140_d&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è§‚å¯ŸåŸå›¾ä¸Šè¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯æ²¡æœ‰æœªç¡®å®šè¾¹çš„åŸºç¯æ ‘ï¼Œè¦ä¹ˆæ˜¯æœ‰æ°å¥½ä¸€æ¡æœªç¡®å®šè¾¹çš„æ ‘ã€‚ç¼©ç‚¹ï¼Œä»»æ„ä¸ºæœªç¡®å®šè¾¹èµ‹å€¼ï¼Œè€ƒå¯Ÿæœ€åå¾—åˆ°çš„è¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯ä»¥ã€åŸºç¯æ ‘ç‚¹ã€ä¸ºæ ¹çš„æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸åŒ…å«ã€åŸºç¯æ ‘ç‚¹ã€çš„ï¼ˆå†…å‘ï¼‰åŸºç¯æ ‘ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè¦ç”¨åˆ°è´¡çŒ®çš„æ€æƒ³ã€‚è€ƒè™‘å°†å…¨å±€åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œä¿è¯æ¯éƒ¨åˆ†çš„å•æ­¥ä»·å€¼æ˜¯å¯ç¡®å®šçš„ã€‚å°†ç¬¬ä¸€æ­¥ï¼Œå³å¯¹æ ‘å’ŒåŸºç¯æ ‘çš„è®¨è®ºæ‹†å¼€ï¼Œå¯¹äºæ ‘ï¼Œå…¶æ•°é‡ç¡®å®šï¼›å¯¹äºåŸºç¯æ ‘ï¼Œå‘ç°ç¯çš„æ•°é‡å³ä¸ºåŸºç¯æ ‘çš„æ•°é‡ï¼Œè¿›ä¸€æ­¥å°†æ‰€æœ‰æ­¥ä¸­çš„ã€ç¯ã€è¿™ä¸€ç±»åˆ†å¼€ï¼Œç»Ÿè®¡æˆç¯çš„æ–¹æ¡ˆæ•°å°±å¯ä»¥å¾—åˆ°åŸºç¯æ ‘çš„è´¡çŒ®ã€‚å…·ä½“åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; ä¸ºåœ¨å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‚¹ä¸­é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæˆä¸€ä¸ªç¯çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,j}=f_{i-1,j}+f_{i-1,j-1}\times siz_i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æœ€åè®¡ç®—æ¯ä¸ªç¯çš„è´¡çŒ®å³å¯ã€‚æ³¨æ„è¿˜è¦ç®—ä¸Šç¯å†…éƒ¨çš„æ’åˆ—ï¼ˆæ³¨æ„å¾ªç¯ä½ç§»ï¼‰ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), tag(n + 1), s(n + 1, 1), fa(n + 1), siz(n + 1);
    std::iota(fa.begin() + 1, fa.end(), 1);
    std::function&amp;lt;int(int)&amp;gt; find = [&amp;amp;](int x) &amp;#123;
        return x == fa[x] ? x : fa[x] = find(fa[x]);
    &amp;#125;;
    auto merge = [&amp;amp;](int x, int y) &amp;#123;
        x = find(x), y = find(y);
        if (x != y) &amp;#123;
            tag[y] += tag[x];
            s[y] += s[x];
            fa[x] = y;
        &amp;#125;
        return;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)  &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i], fa[i] = i;
        if (a[i] == -1)
            tag[i] = 1;
        else
            merge(i, a[i]);
    &amp;#125;
    int cnt1 = 0, cnt2 = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        cnt1 += (fa[i] == i &amp;amp;&amp;amp; !tag[i]);
        if (fa[i] == i &amp;amp;&amp;amp; tag[i])
            siz[++cnt2] = s[i];
    &amp;#125;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    auto res(cnt1 * qkp(n, cnt2) % mod);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(cnt2 + 1, std::vector&amp;lt;long long&amp;gt; (cnt2 + 1));
    f[0][0] = 1ll;
    for (int i = 1; i &amp;lt;= cnt2; ++i) &amp;#123;
        // printf(&amp;quot;i = %d, siz = %d: \n&amp;quot;, i, siz[i]);
        for (int j = 0; j &amp;lt;= i; ++j) &amp;#123;
            f[i][j] = f[i - 1][j];
            if (j != 0)
                (f[i][j] += f[i - 1][j - 1] * siz[i]) %= mod;
            // printf(&amp;quot;  f[%d][%d] = %lld\n&amp;quot;, i, j, f[i][j]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= cnt2; ++i) &amp;#123;
        static auto fac(1ll);
        (res += f[cnt2][i] * fac % mod * qkp(n, cnt2 - i) % mod) %= mod;
        (fac *= i) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---diameter-cuts&#34;&gt;C - Diameter Cuts&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1499/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1499/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,i}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸Šçš„æœ€é•¿é“¾é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªç±»ä¼¼èƒŒåŒ…çš„è¿‡ç¨‹æ±‚ç­”æ¡ˆäº†ã€‚å‘ç°è¿™ä¸ªèƒŒåŒ…æ»¡è¶³å¯ä»¥è¢«ä¼˜åŒ–çš„å½¢å¼ï¼Œæ•…èƒ½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(nk)\)&lt;/span&gt; å†…è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k, ++k;
    if (k == 0) &amp;#123;
        std::cout &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; h(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long long&amp;gt; (k + 1));
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        f[x][1] = 1ll, h[x] = 1;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                std::vector&amp;lt;long long&amp;gt; g(k + 1);
                g.swap(f[x]);
                for (int j = std::min(h[x], k); j; --j)
                    for (int l = std::min(h[i], k - j); ~l; --l)
                        (f[x][std::max(j, l + 1)] += g[j] * f[i][l] % mod) %= mod;
                h[x] = std::max(h[x], h[i] + 1);
            &amp;#125;
        for (int i = 1; i &amp;lt;= h[x] &amp;amp;&amp;amp; i &amp;lt;= k; ++i)
            (f[x][0] += f[x][i]) %= mod;
        // for (int i = 0; i &amp;lt;= h[x] &amp;amp;&amp;amp; i &amp;lt;= k; ++i)
        //     printf(&amp;quot;f[%d][%d] = %lld\n&amp;quot;, x, i, f[x][i]);
        return;
    &amp;#125;;
    DFS(1, -1);
    auto res(0ll);
    for (int i = 1; i &amp;lt;= k; ++i)
        (res += f[1][i]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---leaf-partition&#34;&gt;D - Leaf Partition&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1146/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1146/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾å·²ç»å®Œæˆåˆ†ç»„ï¼Œæ¬²åˆ¤å®šè¿™ç§æ–¹å¼æ˜¯å¦åˆæ³•ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ¯ä¸€ç»„å¶å­å»ºç«‹è™šæ ‘ï¼Œåˆ™è¯¥åˆ†ç»„æ–¹å¼åˆæ³•ï¼Œå½“ä¸”ä»…å½“æ²¡æœ‰ä¸€ä¸ªç‚¹è¢«å¤šä¸ªè™šæ ‘å ç”¨ã€‚ä¹Ÿå³ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ€»çš„è™šæ ‘ä¸Šé€‰å‡ºä¸€äº›ç‚¹ï¼Œè®©å®ƒä»¬å¯ä»¥è¦†ç›–æ‰€æœ‰å¶å­ã€‚&lt;/p&gt;
&lt;p&gt;è™šæ ‘ä¸Š DPï¼Œå®¹æ˜“å‘ç°å½“ä¸”ä»…å½“å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\ge 2\)&lt;/span&gt; ä¸ªå„¿å­æƒ³è¦åˆ†è¿›åŒä¸€ä¸ªè™šæ ‘æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¼šè¢«é€‰åˆ°ã€‚æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, 0/1/2}\)&lt;/span&gt; è¡¨ç¤ºå½“å‰æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/\ge 2\)&lt;/span&gt; ä¸ªå„¿å­æƒ³è¦é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶çš„æ–¹æ¡ˆæ•°ï¼ŒDP å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç°æ ¹æœ¬ä¸éœ€è¦æ±‚è™šæ ‘ï¼ŒåŸæ ‘ä¸Š DP å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; fa(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 2; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; fa[i], g[fa[i]].push_back(i);
    std::vector&amp;lt;std::array&amp;lt;long long, 3&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        if (g[x].empty())
            f[x][2] = 1ll;
        else
            f[x][0] = 1ll;
        for (auto i : g[x]) &amp;#123;
            DFS(i);
            auto F0 = (f[i][0] + f[i][2]) % mod, F1 = (f[i][1] + f[i][2]) % mod;
            f[x][2] = (f[x][2] * F0 % mod + f[x][2] * F1 % mod + f[x][1] * F1 % mod) % mod;
            f[x][1] = (f[x][1] * F0 % mod + f[x][0] * F1 % mod) % mod;
            (f[x][0] *= F0) %= mod;
        &amp;#125;
        // printf(&amp;quot;%d: %lld / %lld / %lld\n&amp;quot;, x, f[x][0], f[x][1], f[x][2]);
        return;
    &amp;#125;;
    DFS(1);
    std::cout &amp;lt;&amp;lt; (f[1][0] + f[1][2]) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---uniformly-branched-trees&#34;&gt;E - Uniformly Branched Trees&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/724/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/724/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰æ˜¯å¾ˆå¸¸è§çš„å¥—è·¯ï¼Œä½†æ˜¯æˆ‘ä¸ä¼š ğŸ˜±&lt;/p&gt;
&lt;p&gt;åœ¨æ‰‹ç©æ ·ä¾‹çš„æ—¶å€™å¯ä»¥æ„Ÿæ€§è®¤çŸ¥åˆ°ï¼Œæ¯ä¸ªæ ‘ä¼šè¢«æ¯ç§ç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µç»Ÿè®¡ä¸€æ¬¡ã€‚ä¸”å¦‚æœå›ºå®šä»¥æŸç§ï¼ˆåŒ–å­¦ç¯å¢ƒï¼‰çš„ç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥é€šè¿‡æŒ‰ siz ä»å°åˆ°å¤§æ’åˆ—å”¯ä¸€æ±‚è§£å‡ºè¯¥æ ‘ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°ä»¥é‡å¿ƒä¸ºæ ¹ï¼ˆå³é’¦å®šæ ¹ä¸ºé‡å¿ƒï¼‰å¯ä»¥å¸¦æ¥å¾ˆå¤šä¼˜ç¾çš„æ€§è´¨ã€‚å› ä¸º siz æ˜¯å¥½ç¡®å®šçš„ï¼Œä¸”æ˜¯å„¿å­çš„æ’åºä¾æ®ï¼Œæ‰€ä»¥é€‰é‡å¿ƒä¾¿äºç»Ÿè®¡ï¼ŒåŒæ—¶æ»¡è¶³æ¯ç§æ ‘æœ€å¤šè¢«ç»Ÿè®¡ä¸¤æ¬¡ï¼ˆå½“ä¸”ä»…å½“æœ‰ä¸¤ä¸ªé‡å¿ƒï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™å°±å˜æˆäº†å¤šé‡é›†çš„ç»„åˆæ•°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,k}\)&lt;/span&gt; è¡¨ç¤ºå·²ç»èŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‚¹ç»„æˆä¸€ä¸ªå­æ ‘ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹å½“å‰å·²ç»ç¡®è®¤äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªå„¿å­ï¼Œæœ€é å³çš„ä¸€ä¸ª siz &lt;span class=&#34;math inline&#34;&gt;\(\le k\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,k}=\sum_{x=0} f_{i-x\cdot k,j-x,k-1}\cdot \binom{f_{k,d-1,k}+x-1}{x}\)&lt;/span&gt;ï¼ˆç›¸å½“äºå°† &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªæ— æ ‡å·çš„ä½ç½® / çƒåˆ†é…ç»™ &lt;span class=&#34;math inline&#34;&gt;\(f_{k,d-1,k}\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·çš„é€‰é¡¹ / ç›’å­ï¼Œæ’æ¿å³å¯ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ç›´æ¥è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_{n,d,\lfloor\frac n2\rfloor}\)&lt;/span&gt;ï¼›è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¶æ•°ï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸¤ä¸ªé‡å¿ƒï¼Œå³éœ€è¦ç»Ÿè®¡æ‹¥æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸”ä»¥ä¸¤ä¸ªé‡å¿ƒåˆ†åˆ«ä¸ºæ ¹æ—¶é•¿ç›¸ä¸åŒçš„æ ‘ç§ç±»ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¾ç„¶å­˜åœ¨ä¸€æ¡è¾¹ï¼Œå·¦å³ä¸¤è¾¹ siz ç›¸åŒä¸”é•¿ç›¸ä¸åŒã€‚æ•…æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\binom{f_{\lfloor \frac n2\rfloor, d-1,\lfloor \frac n2\rfloor}}{2}\)&lt;/span&gt;ï¼Œå®¹æ–¥æ‰å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦ç‰¹åˆ¤ &lt;span class=&#34;math inline&#34;&gt;\(n\le2\)&lt;/span&gt; çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, d, mod;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; d &amp;gt;&amp;gt; mod;
    if (n &amp;lt;= 2) &amp;#123;
        std::cout &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    arr inv(d + 1);
    inv[0] = inv[1] = 1ll;
    auto fac = 1ll;
    for (int i = 2; i &amp;lt;= d; ++i) &amp;#123;
        (fac *= i) %= mod;
        inv[i] = qkp(fac, mod - 2);
    &amp;#125;
    auto C = [&amp;amp;](long long n, int m) &amp;#123;
        if (m == 0)
            return 1ll;
        if (m &amp;gt; n)
            return 0ll;
        auto res(1ll);
        for (auto i = 0; i &amp;lt; m; ++i)
            (res *= n - i) %= mod;
        return res * inv[m] % mod;
    &amp;#125;;
    crr f(n + 1, brr(d + 1, arr(n / 2 + 1)));
    f[1][0][0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 0; j &amp;lt;= d &amp;amp;&amp;amp; 1 + j &amp;lt;= i; ++j) &amp;#123;
            for (int x = 0; x &amp;lt;= j &amp;amp;&amp;amp; x &amp;lt;= i; ++x)
                f[i][j][1] += f[i - x][j - x][0];
            f[i][j][1] %= mod;
            for (int k = 2; k &amp;lt;= n / 2; ++k) &amp;#123;
                // bool flag = (i == 10 &amp;amp;&amp;amp; j == 3 &amp;amp;&amp;amp; k == 3);
                for (int x = 0; x &amp;lt;= j &amp;amp;&amp;amp; x * k &amp;lt;= i; ++x) &amp;#123;
                    f[i][j][k] += f[i - x * k][j - x][k - 1] * C(f[k][d - 1][k - 1] + x - 1, x);
                    // if (flag)
                    //     printf(&amp;quot;x = %d, f[%d][%d][%d](%lld) * C(%lld, %d)(%lld)\n&amp;quot;, x, i - x * k, j - x, k - 1, f[i - x * k][j - x][k - 1], f[k][d - 1][k - 1] + x - 1, x, C(f[k][d - 1][k - 1] + x - 1, x));
                &amp;#125;
                f[i][j][k] %= mod;
            &amp;#125;
        &amp;#125;
    // for (int i = 1; i &amp;lt;= n; ++i)
    //     for (int j = 0; j &amp;lt;= d &amp;amp;&amp;amp; j &amp;lt;= i - 1; ++j, puts(&amp;quot;&amp;quot;))
    //         for (int k = 0; k &amp;lt;= n / 2; ++k) &amp;#123;
    //             printf(&amp;quot;f[%d][%d][%d] = %lld\n&amp;quot;, i, j, k, f[i][j][k]);
    //         &amp;#125;
    if (n &amp;amp; 1)
        std::cout &amp;lt;&amp;lt; f[n][d][n / 2] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    else &amp;#123;
        auto res(f[n][d][n / 2]);
        res = (res + mod - C(f[n / 2][d - 1][n / 2 - 1], 2)) % mod;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---dominant-indices&#34;&gt;A - Dominant Indices&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1009/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1009/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é•¿å‰–æ¿å­ï¼›éš¾ç‚¹åœ¨äºå¯èƒ½è¦å¤ä¹ ä¸€ä¸‹é•¿å‰–æ€ä¹ˆå†™ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; h(n + 1), son(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        h[x] = 1;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                h[x] = std::max(h[x], h[i] + 1);
                if (h[i] &amp;gt; h[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::vector&amp;lt;int&amp;gt; _f(2 * n + 1), res(n + 1);
    auto pos(_f.begin());
    std::vector&amp;lt;decltype(pos)&amp;gt; f(n + 1);
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        ++f[x][0];
        if (!son[x]) &amp;#123;
            res[x] = 0;
            return;
        &amp;#125;
        f[son[x]] = std::next(f[x]);
        DFS(son[x], x);
        int mx = -std::max(std::make_pair(f[x][res[son[x]] + 1], -(res[son[x]] + 1)), std::make_pair(1, 0)).second;
        for (auto i : g[x])
            if (i != fa &amp;amp;&amp;amp; i != son[x]) &amp;#123;
                f[i] = pos, pos = std::next(pos, h[i] + 1);
                DFS(i, x);
                for (int j = 0; j &amp;lt;= h[i]; ++j) &amp;#123;
                    f[x][j + 1] += f[i][j];
                    if (j + 1 != mx &amp;amp;&amp;amp; std::make_pair(f[x][j + 1], -(j + 1)) &amp;gt; std::make_pair(f[x][mx], -mx))
                        mx = j + 1;
                &amp;#125;
            &amp;#125;
        // printf(&amp;quot;%d: &amp;quot;, x);
        // for (int i = 0; i &amp;lt;= h[x]; ++i)
        //     printf(&amp;quot;%d &amp;quot;, f[x][i]);
        // puts(&amp;quot;&amp;quot;);
        res[x] = mx;
        return;
    &amp;#125;;
    f[1] = pos, pos = std::next(pos, h[1]);
    DFS(1, -1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---æ ‘ä¸Šå¼‚æˆ–&#34;&gt;B - æ ‘ä¸Šå¼‚æˆ–&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9745&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9745&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’Œ &lt;a href=&#34;#a---svjetlo&#34;&gt;Svjetlo&lt;/a&gt; å¾ˆåƒï¼ŒæŠŠè¿é€šå—çš„å¼‚æˆ–å’Œæ”¾åˆ°çŠ¶æ€é‡Œï¼Œæ‹†ä½åä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,0/1}\)&lt;/span&gt; è¡¨ç¤ºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰€åœ¨çš„è¿é€šå—åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt; çš„æƒå€¼ï¼ˆ&lt;strong&gt;ä¸è®¡ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰€åœ¨è¿é€šå—&lt;/strong&gt;ï¼‰ï¼Œè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 2, x; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x;
        g[x].push_back(i), g[i].push_back(x);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; dp(n + 1);
    std::vector&amp;lt;std::array&amp;lt;std::array&amp;lt;long long, 2&amp;gt;, 60&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        for (int i = 0; i &amp;lt; 60; ++i)
            f[x][i][(a[x] &amp;gt;&amp;gt; i) &amp;amp; 1] = 1ll;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                for (int j = 0; j &amp;lt; 60; ++j) &amp;#123;
                    auto f1 = f[x][j];
                    f[x][j][0] = (f1[0] * dp[i] % mod + f1[0] * f[i][j][0] % mod + f1[1] * f[i][j][1] % mod) % mod;
                    f[x][j][1] = (f1[1] * dp[i] % mod + f1[0] * f[i][j][1] % mod + f1[1] * f[i][j][0] % mod) % mod;
                &amp;#125;
            &amp;#125;
        for (int i = 0; i &amp;lt; 60; ++i)
            dp[x] += (1ll &amp;lt;&amp;lt; i) % mod * f[x][i][1] % mod;
        dp[x] %= mod;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; dp[1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---ä¸€ä¸ªç½‘çš„è·¯&#34;&gt;C - ä¸€ä¸ªç½‘çš„è·¯&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P8595&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P8595&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦æ„è¯†åˆ°ï¼Œæ ‘å’Œé“¾çš„è¾¹æ•°æ˜¯ä¸€æ ·çš„ï¼Œç‚¸æ‰äº†å¤šå°‘æ¡è¾¹ï¼Œåœ¨ä¹‹åå°±ä¼šèŠ±å¤šå°‘ä»£ä»·è¡¥å›æ¥ã€‚æ•…ç‚¸ä¸€ä¸ªç‚¹çš„ä»£ä»·ä¸ºåº¦æ•° +1ã€‚å¯¹äºä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œåˆ†ä¸ºå››ç§å¯èƒ½æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¢«ç‚¸äº†ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿é€šå—ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œå„¿å­å…¨éƒ¨è¢«ç‚¸äº†ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œæœ‰ 1 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œæœ‰ 2 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆ†åˆ«ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,0/1/2/3}\)&lt;/span&gt; ä»£è¡¨ä¸Šé¢å››ç§å¯èƒ½æ€§ï¼Œè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è´ºäº†ä¸ª freadï¼Œæ“¦è¾¹è·‘è¿‡äº†ã€‚è¿™ä¸ªä¸æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„å—ï¼Ÿ&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#ifdef ONLINE_JUDGE
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
#else
#define nec getchar

#endif
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
int main() &amp;#123;
    int n, m;
    read(n), read(m);
    int res = (n - 1) - m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int x, y; m--; ) &amp;#123;
        read(x), read(y);
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1);
    std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        tag[x] = 1;
        f[x][0] = (fa != -1) + 1;
        f[x][2] = f[x][3] = 0x3f3f3f3f;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                f[x][3] = std::min(f[x][3] + f[i][0], f[x][2] + std::min(f[i][1], f[i][2]));
                f[x][2] = std::min(f[x][2] + f[i][0], f[x][1] + std::min(f[i][1], f[i][2]));
                f[x][1] += f[i][0];
                f[x][0] += std::min(&amp;#123; f[i][0] - 1, f[i][1], f[i][2], f[i][3] &amp;#125;) + 1;
            &amp;#125;
        return;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        if (!tag[i]) &amp;#123;
            DFS(i, -1);
            res += *std::min_element(f[i].begin(), f[i].end());
        &amp;#125;
    print(res, &amp;#39;\n&amp;#39;);
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---éšæœºæ ‘&#34;&gt;D - éšæœºæ ‘&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3830&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3830&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºç¬¬ä¸€é—®ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_x\)&lt;/span&gt; è¡¨ç¤ºå…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªå¶å­æ—¶çš„æœŸæœ›æ·±åº¦ï¼Œä¸¤ä¸ªæ–°å¶å­çš„æœŸæœ›æ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{x-1}+1\)&lt;/span&gt;ï¼Œdelta ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{x-1}+2\)&lt;/span&gt;ï¼Œæ•…æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_x=\dfrac {(x-1)f_{x-1}+f_{x-1}+2}x\)&lt;/span&gt;ï¼Œé€’æ¨å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºç¬¬äºŒé—®ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,k}\)&lt;/span&gt; è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªå¶å­ï¼Œæ·±åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt; çš„æ¦‚ç‡ï¼ˆä¸€ç§ç†è§£æ˜¯ä»æ•´æ•°æ¦‚ç‡å…¬å¼çš„è§’åº¦å‡ºå‘ï¼‰ã€‚åˆ™è€ƒè™‘æšä¸¾å·¦ã€å³å¶å­æ•°ï¼Œå¯¹äºå·¦ä¾§å¶å­æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æƒ…å†µï¼Œ&lt;strong&gt;ä¸ºäº†å»é‡ï¼Œåªé€‰æ‹©æ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„å¶å­å±•å¼€&lt;/strong&gt;ã€‚åªè€ƒè™‘æŸç§ç»„åˆçš„å‡ºç°æ¦‚ç‡ï¼Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{i,k-1}+f_{x-i,k-1}-f_{i,k-1}\cdot f_{x-i,k-1}\)&lt;/span&gt;ã€‚æ•°å½’å¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„å¶å­è¢«é€‰ä¸­çš„æ¦‚ç‡å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac 1{x-1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int q, n;
    std::cin &amp;gt;&amp;gt; q &amp;gt;&amp;gt; n;
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6);
    if (q == 1) &amp;#123;
        std::vector&amp;lt;double&amp;gt; f(n + 1);
        for (int i = 2; i &amp;lt;= n; ++i)
            f[i] = (f[i - 1] * (i - 1) + f[i - 1] + 2.) / i;
        std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    else &amp;#123;
        std::vector&amp;lt;std::vector&amp;lt;double&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;double&amp;gt; (n + 1));
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            f[i][0] = 1.;
            for (int j = 1; j &amp;lt; i; ++j) &amp;#123;
                auto s(0.);
                for (int k = 1; k &amp;lt; i; ++k)
                    s += f[k][j - 1] + f[i - k][j - 1] - f[k][j - 1] * f[i - k][j - 1];
                f[i][j] = s / (i - 1);
            &amp;#125;
        &amp;#125;
        auto res(0.);
        for (int i = 1; i &amp;lt; n; ++i)
            res += f[n][i];
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---complete-compress&#34;&gt;E - Complete Compress&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/agc034/tasks/agc034_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/agc034/tasks/agc034_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºé“¾ï¼Œå‘ç°å¯ä»¥æšä¸¾æœ€åèšé›†çš„ç‚¹ï¼Œç­”æ¡ˆä¸é…å¯¹æ–¹å¼æ— å…³ï¼Œcheck æ˜¯å¦èƒ½é…å¯¹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸æ˜¯é“¾ï¼Œåˆ™ç›¸æ¯”é“¾ï¼Œè¿˜å¯ä»¥é€‰æ‹©åŒä¸€å­æ ‘ä¸­ä¸å­˜åœ¨ç¥–å­™å…³ç³»çš„ä¸¤ä¸ªç‚¹ï¼Œå°†å®ƒä»¬éƒ½å‘ LCA ç§»ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;æ•…è€Œï¼Œå¯ä»¥åœ¨é“¾çš„åšæ³•ä¸Šæ‰“ä¸€ä¸ªè¡¥ä¸ï¼Œè§‚å¯Ÿåˆ°å…ˆã€å†…éƒ¨æ¶ˆåŒ–ã€ï¼Œå†åœ¨å­æ ‘é—´é…å¯¹ä¸€å®šä¸åŠ£ï¼Œä¸”ç­”æ¡ˆä»ç„¶å’Œé…å¯¹æ–¹å¼æ— å…³ã€‚æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_x\)&lt;/span&gt; è¡¨ç¤ºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å†…æœ€å¤šæ¶ˆæ‰å¤šå°‘å¯¹ï¼Œå°±å¯ä»¥ check äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;line_02.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t;
        a[i] = t - &amp;#39;0&amp;#39;;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    auto res(inf);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; s(n + 1);
        std::vector&amp;lt;long long&amp;gt; f(n + 1), cnt(n + 1);
        std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
            s[x] = a[x];
            int son = 0;
            auto sum(0ll);
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    DFS(i, x), s[x] += s[i];
                    sum += cnt[i];
                    if (cnt[i] &amp;gt; cnt[son])
                        son = i;
                &amp;#125;
            if (son) &amp;#123;
                if (cnt[son] * 2 &amp;lt;= sum)
                    f[x] = sum / 2;
                else
                    f[x] = sum - cnt[son] + std::min(f[son], (cnt[son] - (sum - cnt[son])) / 2);
            &amp;#125;
            cnt[x] = sum;
            if (x != i)
                cnt[x] += s[x];
            return;
        &amp;#125;;
        DFS(i, -1);
        if (cnt[i] % 2 == 0 &amp;amp;&amp;amp; f[i] == cnt[i] / 2)
            res = std::min(res, cnt[i] / 2);
    &amp;#125;
    if (res == inf)
        std::cout &amp;lt;&amp;lt; -1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    else
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="æ ‘å½¢ DP" />
        <category term="é•¿é“¾å‰–åˆ†" />
        <updated>2025-08-03T03:44:54.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250723/</id>
        <title>vp è®°å½• edu 181</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250723/"/>
        <content type="html">&lt;p&gt;tzl å¤ªå¼ºäº†ï¼çœŸæŒšçš„è†œæ‹œ&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;lhy å¤ªå¼ºäº†ï¼çœŸæŒšçš„è†œæ‹œ&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-sets-of-complementary-sums&#34;&gt;E. Sets of Complementary Sums&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/2125/problem/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/2125/problem/E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åˆ†æ‹†æ•°ã€å…¶å®æ˜¯ä¸ªä¸ç‰›çš„ä¸œè¥¿ï¼Œä½†æ˜¯å†™å‡äº† ğŸ˜…&lt;/p&gt;
&lt;p&gt;ä»¤é›†åˆå…ƒç´ å‡åºæ’åˆ—ä¸º &lt;span class=&#34;math inline&#34;&gt;\(b_{1\sim n}\)&lt;/span&gt;ã€‚æ˜¾ç„¶æœ‰ç»“è®º &lt;span class=&#34;math inline&#34;&gt;\(\sum b\geqslant (n-1)(b_n+1)\)&lt;/span&gt;ï¼ŒåŒ–ä¸€ä¸‹å°±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(b_n\geqslant \left(\sum\limits_{i=1}^{n-1} b_n-b_i\right)+(n-1)\)&lt;/span&gt;ã€‚å‘ç° RSH å–å€¼å¯¹ LSH æ— å½±å“ï¼ˆä»å–ç­‰å¼€å§‹ï¼ŒRSH ä¸å˜ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(b_n\gets b_n+1\)&lt;/span&gt;ï¼Œåªéœ€å°†æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(b_i\gets b_i+1\)&lt;/span&gt; å³å¯æ„é€ å‡ºä¸€ç»„è§£ï¼‰ï¼Œæ•…åªç”¨è€ƒè™‘ RSH çš„æ¯ç§å–å€¼ä¸‹çš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥åš &lt;a href=&#34;/20250807/&#34;&gt;åˆ†æ‹†æ•°&lt;/a&gt; äº†ã€‚å‘ç°ä¼š MLEï¼Œæ»šåŠ¨å³å¯ã€‚æ¯æ¬¡æš´åŠ› assign ä¼šå¾ˆæ…¢ï¼Œå¯ä»¥ç”¨ä¸€ç‚¹å·§æ€æ¸…ç©ºæ»šåŠ¨æ•°ç»„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        long long n, m;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
        if (n * (n - 1) / 2 &amp;gt; m) &amp;#123;
            std::cout &amp;lt;&amp;lt; 0 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            continue;
        &amp;#125;
        if (n == 1) &amp;#123;
            std::cout &amp;lt;&amp;lt; m &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            continue;
        &amp;#125;
        --n;
        std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(2, std::vector &amp;lt;long long&amp;gt; (m + 1));
        f[0][0] = 1ll;
        for (int j = 1, at = 1; j &amp;lt;= n; ++j, at ^= 1)
            for (int i = 0; i &amp;lt;= m; ++i) &amp;#123;
                if (i &amp;lt; j)
                    f[at][i] = 0;
                else
                    f[at][i] = (f[at ^ 1][i - j] + f[at][i - j]) % mod;
            &amp;#125;
        auto res(0ll);
        for (int i = 1; i &amp;lt;= m - n; ++i)
            (res += f[n &amp;amp; 1][i] * (m - (i + n) + 1)) %= mod;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;vp-è®°å½•&#34;&gt;vp è®°å½•&lt;/h2&gt;
&lt;h3 id=&#34;a&#34;&gt;A&lt;/h3&gt;
&lt;p&gt;1:43 åˆ‡ã€‚æ‰“ &lt;code&gt;std::&lt;/code&gt; è¿˜æ˜¯å¤ªè´¹æ—¶é—´äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;b&#34;&gt;B&lt;/h3&gt;
&lt;p&gt;5:46 åˆ‡ï¼Œçœ‹å®Œé¢˜æ²¡æƒ³åˆ° gcdï¼Œè¾“å‡ºçš„æ—¶å€™æƒ³åˆ°äº†ã€‚è¼èœã€‚&lt;/p&gt;
&lt;h3 id=&#34;c&#34;&gt;C&lt;/h3&gt;
&lt;p&gt;11:23 åˆ‡ï¼ŒåŸå› æ˜¯å®¹æ–¥ç¬¦å·ä¹±å†™ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d&#34;&gt;D&lt;/h3&gt;
&lt;p&gt;24:21 åˆ‡ï¼Œä¸­é—´é‡æ„äº†ä¸€æ¬¡å¹¶ä¸”å‰ç¼€å’Œçš„éƒ¨åˆ†è€ƒè™‘å¾—æœ‰ç‚¹é—®é¢˜ã€‚ç»…å£«ï¼ˆ38:35ï¼‰é—®æˆ‘ä¸ºå•¥åšè¿™ä¹ˆå¿«ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e.0&#34;&gt;E.0&lt;/h3&gt;
&lt;p&gt;çœ‹äº†ä¸€çœ¼æ„Ÿè§‰ä¸å¤ªå¯åšã€‚quack è¯´ F æ¿æ¿ï¼Œæ•…è·³ã€‚&lt;/p&gt;
&lt;h3 id=&#34;f&#34;&gt;F&lt;/h3&gt;
&lt;p&gt;01:13:41 è‰å®Œã€‚å¥‡æ€ªçš„ WQS äºŒåˆ†æ¿æ¿ã€‚åƒäº†ä¸€å‘ç½šæ—¶ï¼ŒåŸå› æ˜¯æ²¡äººåˆæ³•çš„æ—¶å€™è¦è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚ä½†å’Œ maimai çš„ 30 å‘æ¯”èµ·æ¥è¿˜æ˜¯ç›¸å½¢è§ç»Œã€‚ç»…å£«è€ƒè™‘äº†è¿™ä¸ªï¼Œä½†æ˜¯æ²¡åˆ¤ç›®æ ‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;\)&lt;/span&gt; å½“å‰çš„æƒ…å†µé—æ†¾ 4 é¢˜ç¦»åœºã€‚&lt;/p&gt;
&lt;p&gt;åœºä¸‹çœ‹äº† Diagnosticsï¼Œå‘ç°å…¶å®ç¬¬äºŒå‘æœ‰ä¸ªåœ°æ–¹æ˜¯ RE äº†çš„ï¼ˆé•¿åº¦ä¸è¶³ &lt;span class=&#34;math inline&#34;&gt;\(6\)&lt;/span&gt; æˆ‘çš„ &lt;code&gt;*std::max_element&lt;/code&gt; ä¼šé£èµ·æ¥ï¼‰ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥å°±æ˜¯ A äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;e.1&#34;&gt;E.1&lt;/h3&gt;
&lt;p&gt;çŒœåˆ°ç»“è®ºä¹‹åæ­¢æ­¥äºæ­¤ã€‚è¯•ç€æ‰“äº†åˆ†æ‹†æ•°ç„¶åï¼ˆå®é™…ä¸Šæ˜¯ï¼‰å†™æŒ‚äº†ï¼Œæ€€ç–‘è‡ªå·±ç»“è®ºå‡ºé”™ç›´åˆ° 5 é¢˜æ‹›ç¬‘ç¦»åœº ğŸ˜…&lt;/p&gt;
&lt;h3 id=&#34;b.1&#34;&gt;B.1&lt;/h3&gt;
&lt;p&gt;å“ˆå“ˆ B çš„ gcd æ²¡å¼€ &lt;code&gt;long long&lt;/code&gt; è¢« hack äº†ï¼Œrk55 to 6000+&lt;/p&gt;
</content>
        <category term="å·®åˆ†" />
        <category term="èƒŒåŒ…" />
        <updated>2025-07-23T07:06:07.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250721/</id>
        <title>è§£é¢˜æŠ¥å‘Š CF1804F Approximate Diameter</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250721/"/>
        <content type="html">&lt;p&gt;å”‰ç¡®å®æ²¡è§è¿‡è¿™ç§äºŒåˆ†å½¢å¼ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1804/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1804/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°è¿™ä¸ªèŒƒå›´åŸºæœ¬ä¸Šå°±æ˜¯ &lt;a href=&#34;/20231117/#æ ‘çš„ç›´å¾„å›¾çš„ç›´å¾„&#34;&gt;å›¾ç›´å¾„çš„è¿™ä¸ªæ€§è´¨&lt;/a&gt;ï¼Œä½†æ˜¯æˆ‘ä¸è®¤è¯† ğŸ˜…&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡ä¿®æ”¹åšä¸€æ¬¡ BFS è¿‡äºæŠ½è±¡ï¼Œå‘ç°è¿™ä¸ªä¸Šç•Œå¤šäº†ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; çš„ç³»æ•°ï¼ŒæŠŠä¸»å…ƒæ¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(d\in[0.5s,2s]\)&lt;/span&gt;ã€‚æœ‰ä¸€ä¸ªå¾ˆç‰›çš„æ“ä½œï¼Œå‡è®¾åœ¨å½“å‰å›¾ä¸Šæ±‚å‡ºæ¥äº†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(s&amp;#39;\)&lt;/span&gt;ï¼Œæ˜¾ç„¶ä¸€ç›´åŠ è¾¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2s\)&lt;/span&gt; è¿™ä¸ªä¸Šç•Œæ˜¯åœ¨å˜å°çš„ï¼Œä½†åªè¦ &lt;span class=&#34;math inline&#34;&gt;\(s&amp;#39;\le 2s\)&lt;/span&gt; æˆç«‹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(s&amp;#39;\)&lt;/span&gt; å°±ä¸€ç›´å¯ä»¥ä½œä¸ºåŒºé—´é‡Œçš„ä¸€ä¸ªä¼°å€¼ã€‚å¦‚æœä¸æˆç«‹ï¼Œå‘ç°é™¤ä»¥äºŒå°±æˆç«‹äº†ã€‚&lt;/p&gt;
&lt;p&gt;è½¬åŒ–æˆäºŒåˆ† &lt;span class=&#34;math inline&#34;&gt;\(s&amp;#39;\)&lt;/span&gt; æœ€è¿œå¯ä»¥è¾¾åˆ°çš„è·ç¦»å³å¯ã€‚æ¯æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(s&amp;#39;\)&lt;/span&gt; é™¤ä»¥äºŒï¼Œå…±é™¤äº† &lt;span class=&#34;math inline&#34;&gt;\(\log n\)&lt;/span&gt; æ¬¡ï¼›å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2 n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ³¨æ„ä¸è¦æ¯æ¬¡ check éƒ½å¤åˆ¶ä¸€éåŸæ•°ç»„ç„¶ååŠ è¾¹ï¼›åº”è¯¥é¢„å…ˆåœ¨åŸå›¾ä¸ŠåŠ å¥½æ‰€æœ‰è¾¹ï¼Œè®°å½•ç‰ˆæœ¬ã€‚åŸå› æ˜¯ç”³è¯·ç©ºé—´ç‰¹åˆ«è´¹æ—¶é—´ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m, q;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; q;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    for (int x, y; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].emplace_back(y, 0), g[y].emplace_back(x, 0);
    &amp;#125;
    for (int i = 1, x, y; i &amp;lt;= q; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].emplace_back(y, i), g[y].emplace_back(x, i);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; mem(q + 1, -1);
    auto calc = [&amp;amp;](int id) &amp;#123;
        if (~mem[id])
            return mem[id];
        std::queue&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; q;
        std::vector&amp;lt;int&amp;gt; tag(n + 1);
        q.emplace(1, 0), tag[1] = 1;
        int mx = 0;
        for (; !q.empty(); ) &amp;#123;
            auto [x, w] = q.front();
            q.pop(), mx = w;
            for (auto [i, ver] : g[x])
                if (ver &amp;lt;= id &amp;amp;&amp;amp; !tag[i]) &amp;#123;
                    tag[i] = 1;
                    q.emplace(i, w + 1);
                &amp;#125;
        &amp;#125;
        return mem[id] = mx;
    &amp;#125;;
    int s = calc(0);
    for (int i = 0; i &amp;lt;= q; ) &amp;#123;
        int j = i;
        for (int l = i + 1, r = q, mid; l &amp;lt;= r; ) &amp;#123;
            mid = (l + r) &amp;gt;&amp;gt; 1;
            if (s &amp;lt;= 2 * calc(mid))
                j = mid, l = mid + 1;
            else
                r = mid - 1;
        &amp;#125;
        for (; i &amp;lt;= j; ++i)
            std::cout &amp;lt;&amp;lt; s &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
        s /= 2;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="äºŒåˆ†" />
        <updated>2025-07-21T14:00:00.000Z</updated>
    </entry>
</feed>
