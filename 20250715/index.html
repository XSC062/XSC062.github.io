<!DOCTYPE html>
<html>
<head>
    <!-- ç½‘ç«™å›¾æ ‡ -->
<link rel="icon" type="image/png" sizes="32x32" href="/images/icon.svg">
<!-- å…¶ä»–å›¾æ ‡æ”¯æŒ -->
<link rel="stylesheet" href="/css/facss/fa-brands.min.css">
<link rel="stylesheet" href="/css/facss/fa-regular.min.css">
<link rel="stylesheet" href="/css/facss/fa-solid.min.css">
<link rel="stylesheet" href="/css/facss/fontawesome.min.css">
<link rel="stylesheet" href="/css/facss/fontawesome-all.css">
<link href="https://use.fontawesome.com/releases/v5.0.4/css/all.css" rel="stylesheet">
<!-- ç½‘ç«™æ ‡é¢˜ -->
<title>
	
		ç»ƒä¹  å†³ç­–å•è°ƒæ€§ -
	
	XSC062 çš„åšå®¢
</title>
<!-- js å¼•å…¥ -->
<script>
const searchPath = "/search.xml"
</script>

<script src="/js/afterloaded.js"></script>


<script src="/js/jQuery.js"></script>

<!-- è½½å…¥ Valine -->

<script src="/js/Valine.min.js"></script>

<!-- css å¼•å…¥ -->

<link rel="stylesheet" href="/css/layout.css">


<link rel="stylesheet" href="/css/prcss/prism.css">



<!-- rss -->
<link rel="alternate" type="application/rss+xml" title="" href="https://xsc062.netlify.app/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="" href="https://xsc062.netlify.app/atom.xml" />
<link rel="alternate" type="application/json" title="" href="https://xsc062.netlify.app/feed.json" />

<meta charset="utf-8"> 
<meta name="generator" content="Hexo 7.2.0"></head>
<body class="line-numbers match-braces no-brace-select rainbow-braces">
	
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            processEscapes: true
          }
        });
      </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
            tex2jax: {
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
          });
      </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
              var all = MathJax.Hub.getAllJax(), i;
              for(i=0; i < all.length; i += 1) {
                  all[i].SourceElement().parentNode.className += ' has-jax';
              }
          });
      </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML"></script>

	<!-- æœç´¢ -->
<script>
	function closeSearchBox() {
		$("#search-bg").css("transition", "null"); 
		$("#search-bg").css("z-index", "-1"); 
		$("#search-bg").css("opacity", "0%");
		return;
	}
</script>
<div id="search-bg">
	<div id="search-box">
		<button id="close-button" onclick="closeSearchBox()">
			<i class="fas fa-times"></i>
		</button>
		<input type="text" id="search-input" placeholder="Type to search...">
		<div id="search-results">
			<div id="emptyInput">
				<p>é”®å…¥ä»¥æœç´¢â€¦</p>
				<p><i>åŒ¹é…ç®—æ³•</i>ï¼šæŠŠè¾“å…¥æŒ‰ç©ºæ ¼æ‹†åˆ†ï¼Œå•ç‹¬<strong>åŒ¹é…</strong>æ¯ä¸€æ®µè¾“å…¥ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼Œä»…åŒ¹é…æ–‡ç« æ–‡æœ¬å†…å®¹ï¼‰ï¼Œè¾“å‡ºå–æˆ–åçš„ç»“æœã€‚</p>
				<p>æ¨¡ç³Šæœç´¢ä¼¼ä¹å¾ˆéš¾æï¼Œç›®å‰æ²¡æœ‰ç›¸å…³æ‰“ç®—ã€‚</p>
			</div>
		</div>
	</div>
</div>
<!-- é¡¶æ æ•´ä½“å¯¼èˆªèœå• -->
<div class="ui top menu">
	<!-- å·¦å¯¹é½ logo -->
	<a class="logo" href="/">
		<img width="25px" height="25px" style="border: solid transparent 2.5px" src="/images/icon.svg"></img>
		<div id="bartitle" class="text">
			XSC062 çš„åšå®¢
		</div>
	</a>
	<!-- å³å¯¹é½éƒ¨åˆ†å¯¼èˆª -->
	<div id="rightali" class="serif">
		<a class="item" id="Search" type="button">
			<i class="btn text-muted fa fa-search" id="search-icon" disabled></i>
		</a>
		<a class="item" id="Home" href="/">
			Home
		</a>
		<a class="item" id="Arch" href="/archives">
			Archives
		</a>
		<!-- <a class="item" id="Cate" href="/categories">
			Categories
		</a> -->
		<a class="item" id="Tags" href="/tags">
			Tags
		</a>
		<a class="item" id="Frie" href="/friends">
			Friends
		</a>
		<a class="item" id="Abou" href="/about">
			About
		</a>
	</div>
</div>
    
<link rel="stylesheet" href="/css/post.css">


<script src="/js/post.js"></script>


<div class="main">
	<div id="sidebar" class="text">
		<aside id="toc">
			<span id="toctitle">
				<i class="fas fa-list"></i>
				ç›®å½•
			</span>
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#a---%E5%BE%81%E9%80%94"><span class="toc-text">A - å¾é€”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b---%E5%88%B7%E9%87%8E-iii"><span class="toc-text">B - åˆ·é‡ III</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#c---traka"><span class="toc-text">C - TRAKA</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#d---%E6%9F%A0%E6%AA%AC"><span class="toc-text">D - æŸ æª¬</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#e---knapsack-with-diminishing-values"><span class="toc-text">E - Knapsack with Diminishing Values</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#f---managing-telephone-poles"><span class="toc-text">F - Managing Telephone Poles</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#g---partition-game"><span class="toc-text">G - Partition Game</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#h---battle-lemmings"><span class="toc-text">H - Battle Lemmings</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a---yakiniku-restaurants"><span class="toc-text">A - Yakiniku Restaurants</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b---jellyfish-and-miku"><span class="toc-text">B - Jellyfish and Miku</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cut-the-sequence"><span class="toc-text">Cut the Sequence</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%80%9A%E7%9F%A5%E5%8C%BA%E9%97%B4%E6%9C%80%E5%80%BC-%E4%B8%8D%E6%BB%A1%E8%B6%B3-%E5%9B%9B%E8%BE%B9%E5%BD%A2%E4%B8%8D%E7%AD%89%E5%BC%8F"><span class="toc-text">é€šçŸ¥ï¼šåŒºé—´æœ€å€¼ ä¸æ»¡è¶³ å››è¾¹å½¢ä¸ç­‰å¼ã€‚</span></a>
		</aside>
	</div>
	<div class="ui post container">
		<div class="ui text container">
			<span id="postcon">
				<span id="postinfo">
					<div class="ui post title serif">
						<div id="fortitle" data-content="ç»ƒä¹  å†³ç­–å•è°ƒæ€§">
							ç»ƒä¹  å†³ç­–å•è°ƒæ€§
						</div>
						<div class="ui title background">
						</div>
					</div>
					<span id="date">
						<i class="fas fa-calendar-alt" style="margin-right: 4px;"></i>
						2025-07-15
					</span>
				</span>
			</span>
			<div id="posttags" class="dotted border">
				
					
						<a href="/tags/æ–œç‡ä¼˜åŒ–/" class="citem">æ–œç‡ä¼˜åŒ–</a>
					
						<a href="/tags/DP/" class="citem">DP</a>
					
						<a href="/tags/å››è¾¹å½¢ä¸ç­‰å¼/" class="citem">å››è¾¹å½¢ä¸ç­‰å¼</a>
					
				
			</div>
			<!-- æœ¬æ¥ç”¨çš„æ˜¯ fromNow ç„¶åå­—ç¬¦ä¸²åˆ¤æ–­ï¼Œæ²¡æƒ³åˆ°å¯ä»¥ç›´æ¥è°ƒç”¨ moment() -->
			
			<div id="content">
				<p>ã€å¿ƒé™è‡ªç„¶å‡‰ã€å¤§æŠµæ˜¯å› ä¸ºæƒ…ç»ªå¹³å’Œæ—¶å‰¯äº¤æ„Ÿç¥ç»å…´å¥‹ï¼Œä½“æ¸©ç•¥æœ‰é™ä½å¯¼è‡´çš„ã€‚å—ï¼Ÿ</p>
<span id="more"></span>
<p>å…¶å®æ˜¯å› ä¸ºå¿ƒè„åœè·³åè¡€æ¶²å¾ªç¯ç»ˆæ­¢ã€ä»£è°¢ä¸­æ–­ï¼Œå¯¼è‡´äº§çƒ­ä½äºæ•£çƒ­ï¼ˆï¼Ÿï¼‰</p>
<hr />
<h2 id="a---å¾é€”">A - å¾é€”</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4072" class="uri">https://www.luogu.com.cn/problem/P4072</a></p>
<p>ç”¨å®Œå…¨å¹³æ–¹å…¬å¼å±•å¼€å¾—åˆ° <span class="math inline">\(m^2\sigma^2=m\left(\sum {x_i}^2\right)-S^2\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(S\)</span> ä¸ºæ±‚å’Œã€‚</p>
<p>æ‰€ä»¥ç›®æ ‡æ˜¯æœ€å°åŒ– <span class="math inline">\(\sum {x_i}^2\)</span> è¿™ä¸ªä¸œè¥¿ã€‚ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> å¤©èµ°åˆ° <span class="math inline">\(j\)</span>ï¼Œå¾—åˆ°ï¼š</p>
<p><span class="math display">\[
\begin{aligned}
f_{i,j}&amp;=\min\{f_{i-1,k}+(s_j-s_k)^2\}\\
&amp;=\min\{f_{i-1,k}-2\times s_j\times s_k+{s_k}^2\}+{s_j}^2
\end{aligned}
\]</span></p>
<p>æœ€åå¾—åˆ°çš„æ–œç‡å¼å­æ˜¯ <span class="math inline">\(\dfrac {f_{i - 1, a}-f_{i - 1, b}+{s_a}^2-{s_b}^2}{2(s_a-s_b)}&lt;s_j\)</span>ï¼Œç”±äº <span class="math inline">\(s_j\)</span> å•å¢ï¼Œ<del>å•è°ƒé˜Ÿåˆ—ç»´æŠ¤é€’å‡æ–œç‡å³å¯</del> <strong>æ›´æ­£ï¼šæ˜¯é€’å¢æ–œç‡ã€‚åŸå› æ˜¯ <span class="math inline">\(&lt;\)</span> æ˜¯å¼¹å‡ºæ¡ä»¶ï¼Œè€Œéä¿ç•™æ¡ä»¶â€¦â€¦</strong></p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const long long inf = 1e9;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m;
    std::vector&lt;int&gt; a(n + 1);
    std::vector&lt;long long&gt; s(n + 1);
    auto sum(0ll);
    for (int i = 1; i &lt;= n; ++i) &#123;
        std::cin &gt;&gt; a[i];
        s[i] = s[i - 1] + a[i];
        sum += a[i];
    &#125;
    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));
    f[0][0] = 0ll;
    for (int i = 1; i &lt;= m; ++i) &#123;
        auto f1 = [&amp;](int a, int b) &#123;
            return f[i - 1][a] - f[i - 1][b] + s[a] * s[a] - s[b] * s[b];
        &#125;;
        auto f2 = [&amp;](int a, int b) &#123;
            return 2 * (s[a] - s[b]);
        &#125;;
        std::vector&lt;int&gt; q(n + 1);
        int h = 0, t = -1;
        q[++t] = i - 1;
        for (int j = i; j &lt;= n; ++j) &#123;
            for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &lt; s[j] * f2(q[h + 1], q[h]); ++h);
            f[i][j] = f[i - 1][q[h]] + (s[j] - s[q[h]]) * (s[j] - s[q[h]]);
            for (; h &lt; t &amp;&amp; f1(j, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(j, q[t]); --t);
            q[++t] = j;
        &#125;
    &#125;
    std::cout &lt;&lt; m * f[m][n] - sum * sum &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="b---åˆ·é‡-iii">B - åˆ·é‡ III</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P10074" class="uri">https://www.luogu.com.cn/problem/P10074</a></p>
<p>å‘ç°æœ€åæƒ…å†µå°±æ˜¯æ¯æ¬¡ã€è¯•æ¢ã€éƒ½ä¸ä¸­çš„æƒ…å†µï¼Œå†è¯•æ¢ä¸­æœ€åçš„é‚£ä¸€ä¸ªã€‚ä¸ºå•¥å‘¢ï¼Œç›¸å½“äºæˆ‘ä»¬æ¯æ¬¡æ”»å‡»çš„ä¸€å®šæ˜¯æœªçŸ¥å…ƒç´ ä¸­è¡€æœ€å¤šçš„ä¸€ä¸ªã€‚æ—¢ç„¶å·²ç»è¯•æ¢å‡ºäº†æ¯”é˜ˆå€¼å¤§çš„æ‰€æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ”»å‡»çš„å°±ä¸€å®šæ˜¯é˜ˆå€¼æœ¬èº«ï¼Œå¦‚æœè¿™æ¬¡è·³è¿‡å®ƒï¼Œå®ƒå°±ä¼šæˆä¸ºä¸‹ä¸€æ¬¡è¯•æ¢å¤±è´¥çš„å…ƒç´ ã€‚è¿™æ˜¾ç„¶ä¸å¦‚ä¸€å¼€å§‹å°±ç›´æ¥ç”¨æ–°é˜ˆå€¼è¯•æ¢ã€‚</p>
<p>ä»å¤§åˆ°å°æ’åºã€‚ä»¤ <span class="math inline">\(f_{j, i}\)</span> è¡¨ç¤ºåªç¡®å®šäº†å‰ <span class="math inline">\(i\)</span> å¤§çš„æ•°ï¼Œå·²ç»æ€äº† <span class="math inline">\(j\)</span> ä¸ªäººçš„æœ€åæƒ…å†µæœ€å°ä»£ä»·ã€‚é‚£ä¹ˆæ˜¾ç„¶è¿™ä¸€æ¬¡çš„é˜ˆå€¼æ˜¯ <span class="math inline">\(a_i\)</span>ã€‚éšä¾¿é€‰å‡ºä¸Šä¸€æ¬¡çš„é˜ˆå€¼ <span class="math inline">\(a_k\)</span>ï¼Œé‚£ä¹ˆä¸­é—´è¿™ä¸€æ®µå¾…ç¡®å®šçš„å…ƒç´ æ•°é‡ä¸º <span class="math inline">\(i-k\)</span>ã€‚é‚£ä¹ˆæœ‰ï¼š</p>
<p><span class="math display">\[
\begin{aligned}
f_{j, i}&amp;=\min\limits_{k&lt;i}\{f_{j-1,k}+(i-k)\times a_i\}\\
&amp;=\min\limits_{k&lt;i}\{f_{j-1,k}-k\times a_i\}+i\times a_i
\end{aligned}
\]</span></p>
<p>ç»è¿‡éªŒè¯ï¼Œè™½ç„¶è¿™ä¸ªå¼å­å’Œé¢˜è§£é•¿å¾—ä¸ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¯¹çš„ <del>å› ä¸ºæˆ‘ n^3 æš´åŠ› A äº†</del></p>
<p>æ¨å‡ºæ–œä¼˜å½¢å¼ <span class="math inline">\(\dfrac {f_{j-1,A}-f_{j-1,B}}{A-B}&lt;a_i\)</span>ï¼Œä½†æˆ‘çš„æœ‹å‹ï¼Œ<span class="math inline">\(a_i\)</span> æ˜¯é€’å‡çš„ã€‚æ‰€ä»¥ç”¨å•è°ƒæ ˆç»´æŠ¤é€’å¢æ–œç‡å³å¯ã€‚<del>æˆ–è€…ä½ ä¹Ÿå¯ä»¥å­¦ä¹  grisses æ‰“ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—ä¸ŠäºŒåˆ†</del></p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const long long inf = 1e12;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;P10074_4.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m;
    std::vector&lt;long long&gt; a(n + 1);
    for (int i = 1; i &lt;= n; ++i)
        std::cin &gt;&gt; a[i];
    std::sort(a.begin() + 1, a.end(), std::greater&lt;long long&gt; ());
    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));
    f[0][0] = 0ll;
    for (int j = 1; j &lt;= m; ++j) &#123;
        std::vector&lt;int&gt; q(n + 1);
        int t = -1;
        q[++t] = j - 1;
        auto f1 = [&amp;](int A, int B) &#123;
            return f[j - 1][A] - f[j - 1][B];
        &#125;;
        auto f2 =[&amp;](int A, int B) &#123;
            return A - B;
        &#125;;
        for (int i = j; i &lt;= n; ++i) &#123;
            for (; t &gt;= 1 &amp;&amp; f1(q[t], q[t - 1]) &gt; a[i] * f2(q[t], q[t - 1]); --t);
            f[j][i] = f[j - 1][q[t]] + (i - q[t]) * a[i];
            for (; t &gt;= 1 &amp;&amp; f1(i, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(i, q[t]); --t);
            q[++t] = i;
        &#125;
    &#125;
    auto res(inf);
    for (int i = m; i &lt;= n; ++i)
        res = std::min(res, f[m][i]);
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="c---traka">C - TRAKA</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P7747" class="uri">https://www.luogu.com.cn/problem/P7747</a></p>
<p>ç¨å¾®æ‰‹ç©ä¸€ä¸‹å°±å¯ä»¥å‘ç°ï¼Œå‡å¦‚ç¬¬ <span class="math inline">\(j\)</span> ä¸ªäººåœ¨ç¬¬ <span class="math inline">\(i\)</span> æ¬¡çš„å·¥ä½œæ—¶é—´ä¸º <span class="math inline">\([L_{j,i},R_{j,i}]\)</span>ï¼Œç¬¬ <span class="math inline">\(i-1\)</span> æ¬¡ä¸º <span class="math inline">\([L_{j,i-1},R_{j,i-1}]\)</span>ï¼Œé‚£ä¹ˆè¦æ±‚ <span class="math inline">\(L_{j,i}\ge R_{j,i-1}\)</span>ã€‚</p>
<p>ä»¤ <span class="math inline">\(s_j\)</span> ä¸º <span class="math inline">\(t\)</span> çš„å‰ç¼€å’Œã€‚å‡è®¾ç¬¬ <span class="math inline">\(i-1\)</span> æ¬¡åŠ å·¥äº <span class="math inline">\(x_{i-1}\)</span> å¼€å§‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠä¸Šå¼è½¬å†™ä¸º <span class="math inline">\(x_{i}+s_{j-1}\times f_{i}\ge x_{i-1}+s_j\times f_{i-1}\)</span>ã€‚ä¹Ÿå³ <span class="math inline">\(x_i-x_{i-1}\ge s_j\times f_{i-1}-s_{j-1}\times f_i\)</span>ã€‚</p>
<p>æ˜¾ç„¶éœ€è¦æ‰¾åˆ°ä¸€ä¸ª <span class="math inline">\(j\)</span> ä½¿å¾— RSH å–å¾—æœ€å¤§å€¼ï¼›ç°åœ¨å°±å¯ä»¥è€ƒè™‘æ–œç‡ä¼˜åŒ–äº†ã€‚ç”±äºæ‰€æœ‰é¡¹éƒ½å’Œ <span class="math inline">\(i\)</span> æœ‰å…³ï¼Œæƒ³åˆ°ä¸¤è¾¹åŒé™¤ <span class="math inline">\(f_{i}\)</span> æ¶ˆæ‰ä¸€ä¸ª <span class="math inline">\(i\)</span> æœ‰å…³çš„ç³»æ•°ï¼Œæœ€ååŒ–å‡ºæ¥çš„æ–œä¼˜å½¢å¼æ˜¯ <span class="math inline">\(\dfrac {s_A-s_B}{s_{A-1}-s_{B-1}}&gt;\dfrac {f_{i-1}}{f_i}\)</span>ã€‚ç”±äº RSH ä¸å•è°ƒï¼ŒæŠŠæ‰€æœ‰ <span class="math inline">\(j\)</span> å¡åˆ°é˜Ÿåˆ—é‡Œç»´æŠ¤é€’å‡æ–œç‡ï¼Œæ‰“äºŒåˆ†å³å¯ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m;
    std::vector&lt;long long&gt; a(n + 1), w(m + 1), s(n + 1);
    for (int i = 1; i &lt;= n; ++i)
        std::cin &gt;&gt; a[i], s[i] = s[i - 1] + a[i];
    for (int i = 1; i &lt;= m; ++i)
        std::cin &gt;&gt; w[i];
    std::vector&lt;long long&gt; f(m + 1);
    std::vector&lt;int&gt; q(n + 1);
    int h = 0, t = -1;
    q[++t] = 1;
    for (int i = 2; i &lt;= n; ++i) &#123;
        for (; h &lt; t &amp;&amp; (s[i] - s[q[t]]) * (s[q[t] - 1] - s[q[t - 1] - 1]) &gt; (s[q[t]] - s[q[t - 1]]) * (s[i - 1] - s[q[t] - 1]); --t);
        q[++t] = i;
    &#125;
    for (int i = 2; i &lt;= m; ++i) &#123;
        int to = q[h];
        for (int l = h + 1, r = t, mid; l &lt;= r; ) &#123;
            mid = (l + r) &gt;&gt; 1;
            if ((s[q[mid]] - s[q[mid - 1]]) * w[i - 1] &gt; w[i] * (s[q[mid] - 1] - s[q[mid - 1] - 1]))
                to = q[mid], l = mid + 1;
            else
                r = mid - 1;
        &#125;
        f[i] = f[i - 1] + s[to] * w[i - 1] - s[to - 1] * w[i];
    &#125;
    std::cout &lt;&lt; f[m] + w[m] * s[n] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="d---æŸ æª¬">D - æŸ æª¬</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5504" class="uri">https://www.luogu.com.cn/problem/P5504</a></p>
<ul>
<li>è§‚å¯Ÿé›¶ï¼šåŸé—®é¢˜ã€ä»ä¸¤ç«¯å–ã€å¯ä»¥è½¬åŒ–ä¸ºåˆ†æ®µé—®é¢˜ï¼Œæ•…ä»å…¶ä¸­ä¸€ç«¯è€ƒè™‘å³å¯ã€‚</li>
<li>è§‚å¯Ÿä¸€ï¼šè‹¥æœ‰ä¸€æ®µè¿ç»­çš„ <span class="math inline">\(x\)</span>ï¼Œå®Œæ•´çš„æ¯”æ‹†å¼€çš„æ›´ä¼˜ã€‚</li>
<li>è§‚å¯ŸäºŒï¼šå¦‚æœä¸€æ®µ <span class="math inline">\(x\)</span> ä¸­å¤¹æ‚äº†ä¸€äº›å…¶ä»–å…ƒç´ ï¼Œé‚£ä¹ˆåœ¨å“ªé‡Œåˆ†æ®µæ˜¯è¯´ä¸å‡†çš„ã€‚</li>
<li>è§‚å¯Ÿä¸‰ï¼šå¦‚æœé€‰å–çš„åŒºé—´æ˜¯ <span class="math inline">\([1,r]\)</span>ï¼Œé‚£ä¹ˆè´ªå¿ƒåœ°æƒ³ï¼Œ<span class="math inline">\(a_r\)</span> ä¸€å®šæ˜¯å…³é”®å€¼ï¼Œä¸ç„¶å– <span class="math inline">\(a_r\)</span> å°±æµªè´¹äº†ã€‚</li>
<li>è§‚å¯Ÿå››ï¼šå¦‚æœé€‰å–çš„åŒºé—´æ˜¯ <span class="math inline">\([l,r]\)</span>ï¼Œé‚£ä¹ˆç”±è§‚å¯Ÿå››ï¼Œ<span class="math inline">\(a_l=a_r\)</span>ï¼Œä¸”è¯¥å€¼ä¸ºå…³é”®å€¼ã€‚</li>
</ul>
<p>ç»“åˆè¿™å‡ ä¸ªè§‚å¯Ÿï¼Œä»¤ <span class="math inline">\(c_i\)</span> è¡¨ç¤º <span class="math inline">\(a_i\)</span> åœ¨ <span class="math inline">\([1,i]\)</span> ä¸­å‡ºç°æ¬¡æ•°ï¼Œ<span class="math inline">\(f_i\)</span> è¡¨ç¤ºè¿™ä¸€æ®µä»¥ <span class="math inline">\(i\)</span> ç»“å°¾çš„æœ€å¤§ä»·å€¼ï¼š</p>
<p><span class="math display">\[
\begin{aligned}
f_i&amp;=\max\limits_{j&lt;i,a_{j+1}=a_i}\{f_j+a_i\times (c_i-c_{j + 1} + 1)^2\}\\
&amp;=\max\limits_{j&lt;i,a_{j+1}=a_i}\{f_j+a_{j+1}\times {c_{j+1}}^2-2\times c_i\times a_{j+1}\times c_{j+1}-2\times c_{j+1}\times a_{j+1}\}+a_i\times(c_i-1)^2
\end{aligned}
\]</span></p>
<p>ï¼ˆæ€ä¹ˆè¿™ä¹ˆå¤§ä¸€å †ã€‚ï¼‰æœ€åå¯ä»¥åŒ–å‡º <span class="math inline">\(\dfrac {f_A-f_B+a_{A+1}\cdot c_{A+1}\cdot (c_{A+1}-2)-a_{B+1}\cdot c_{B+1}\cdot (c_{B+1}-2)}{2(c_{A+1} - c_{B+1})}&gt;c_i\times a_i\)</span>ã€‚å‘ç°å¯¹äºæ¯ä¸€ç§ <span class="math inline">\(a_i\)</span>ï¼Œ<span class="math inline">\(c_i\times a_i\)</span> æ˜¯å•å¢çš„ã€‚å•è°ƒæ ˆç»´æŠ¤å³å¯ã€‚</p>
<p><em>è¿™å…¶å®æé†’æˆ‘ä»¬å…³äºä»£æ¢çš„é—®é¢˜â€”â€”æ˜¾ç„¶ï¼Œå½“ä¸ <span class="math inline">\(i\)</span> çš„é¡¹ã€ä¸ <span class="math inline">\(j\)</span> æœ‰å…³çš„é¡¹ä¹‹é—´å­˜åœ¨ä»£æ¢å…³ç³»æ—¶ï¼Œåº”è¯¥å°½é‡å¾€ <span class="math inline">\(j\)</span> çš„æ–¹å‘é ã€‚</em></p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;7.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    std::vector&lt;long long&gt; a(n + 1), c(n + 1), la(10001);
    for (int i = 1; i &lt;= n; ++i) &#123;
        std::cin &gt;&gt; a[i];
        c[i] = c[la[a[i]]] + 1, la[a[i]] = i;
    &#125;
    std::vector&lt;long long&gt; f(n + 1);
    std::vector&lt;int&gt; _t(10001, -1);
    std::vector&lt;std::vector&lt;int&gt; &gt; _q(10001);
    auto f1 = [&amp;](int A, int B) &#123;
        return f[A] - f[B] + a[A + 1] * c[A + 1] * (c[A + 1] - 2) - a[B + 1] * c[B + 1] * (c[B + 1] - 2);
    &#125;;
    auto f2 = [&amp;](int A, int B) &#123;
        return 2 * (c[A + 1] - c[B + 1]);
    &#125;;
    ++_t[a[1]], _q[a[1]].push_back(0);
    for (int i = 1; i &lt;= n; ++i) &#123;
        &#123;
            auto &amp;t = _t[a[i]];
            auto &amp;q = _q[a[i]];
            for (; t &gt;= 1 &amp;&amp; f1(q[t], q[t - 1]) &lt; c[i] * a[i] * f2(q[t], q[t - 1]); --t);
            f[i] = f[q[t]] + a[i] * (c[i] - c[q[t] + 1] + 1) * (c[i] - c[q[t] + 1] + 1);
        &#125;
        if (i &lt; n) &#123;
            auto &amp;t = _t[a[i + 1]];
            auto &amp;q = _q[a[i + 1]];
            for (; t &gt;= 1 &amp;&amp; f1(i, q[t]) * f2(q[t], q[t - 1]) &gt; f1(q[t], q[t - 1]) * f2(i, q[t]); --t);
            q.resize(++t + 1), q[t] = i;
        &#125;
    &#125;
    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="e---knapsack-with-diminishing-values">E - Knapsack with Diminishing Values</h2>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc373/tasks/abc373_f" class="uri">https://atcoder.jp/contests/abc373/tasks/abc373_f</a></p>
<p>å‘ç°å’Œ <a href="/20250707-1/#ä¾‹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…</a> æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</p>
<p>ä¸å¦¨ä»¤ <span class="math inline">\(v_i\)</span> è¡¨ç¤ºä½“ç§¯ï¼Œ<span class="math inline">\(w_i\)</span> è¡¨ç¤ºä»·å€¼ã€‚å¯¹äºæ¯ä¸€ä¸ª <span class="math inline">\(i\)</span>ï¼ŒæŠŠæ‰€æœ‰ä½“ç§¯æŒ‰æ¨¡ <span class="math inline">\(v_i\)</span> çš„ä½™æ•°åˆ†ç±»ï¼Œè®¾ä¸º <span class="math inline">\(j\cdot v_i+x\)</span>ã€‚å¯¹äº <span class="math inline">\(k\cdot v_i+x\)</span>ï¼Œæœ‰ï¼š</p>
<p><span class="math display">\[
\begin{aligned}
f_{i,j\cdot v_i+x}&amp;=\max\limits_{k&lt;j}\{f_{i-1,k\cdot v_i+x}+(j-k)\cdot w_i-(j-k)^2\}\\
&amp;=\max\limits_{k&lt;j}\{f_{i-1,k\cdot v_i+x}-k\cdot w_i-k^2+2\times j\times k\}-j^2+j\cdot w_i
\end{aligned}
\]</span></p>
<p>åˆ™å¾—åˆ° <span class="math inline">\(\dfrac {f_{i-1,A\cdot v_i+x}-f_{i-1,B\cdot v_i+x}+(B-A)\cdot w_i - A^2+B^2}{2(B-A)}&lt;j\)</span>ã€‚æ³¨æ„åˆ†æ¯ä¸ºè´Ÿã€‚æ€»ä¹‹å•è°ƒé˜Ÿåˆ—ç»´æŠ¤é€’å¢æ–œç‡å³å¯ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m;
    std::vector&lt;long long&gt; v(n + 1), w(n + 1);
    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (m + 1));
    for (int i = 1; i &lt;= n; ++i) &#123;
        std::cin &gt;&gt; v[i] &gt;&gt; w[i];
        for (int x = 0; x &lt; v[i]; ++x) &#123;
            int h = 0, t = -1;
            std::vector&lt;int&gt; q;
            auto f1 = [&amp;](int A, int B) &#123;
                return f[i - 1][A * v[i] + x] - f[i - 1][B * v[i] + x] + (B - A) * w[i] - A * A + B * B;
            &#125;;
            auto f2 = [&amp;](int A, int B) &#123;
                return 2 * (B - A);
            &#125;;
            for (int j = 0, J = x; J &lt;= m; ++j, J += v[i]) &#123;
                for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &gt; j * f2(q[h + 1], q[h]); ++h);
                f[i][J] = f[i - 1][J];
                if (h &lt;= t)
                    f[i][J] = std::max(f[i][J], f[i - 1][q[h] * v[i] + x] + (j - q[h]) * w[i] - (j - q[h]) * (j - q[h]));
                for (; h &lt; t &amp;&amp; f1(j, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(j, q[t]); --t);
                q.resize(++t + 1), q[t] = j;
            &#125;
        &#125;
    &#125;
    std::cout &lt;&lt; f[n][m] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="f---managing-telephone-poles">F - Managing Telephone Poles</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/1575/M" class="uri">https://codeforces.com/problemset/problem/1575/M</a></p>
<p>ï¼Ÿè§‚å¯Ÿåˆ°æ€§è´¨ç„¶åè¢«è‡ªå·±å¿½ç•¥äº†ã€‚éå¸¸å€¼å¾—æ‰¹è¯„ã€‚</p>
<p>ä¸éš¾å†™å‡ºç±»ä¼¼æ–œç‡ä¼˜åŒ–çš„å¼å­ <span class="math inline">\(S(i,j)=\min\{ {x_k}^2-2\times i\times x_k+{y_k}^2-2\times j \times y_k\}+i^2+j^2\)</span>ã€‚</p>
<p>ä¼šä¸‹æ„è¯†å°è¯•å›ºå®š <span class="math inline">\(i\)</span>ï¼Œå°±å¯ä»¥ <span class="math inline">\(O(n^2m)\)</span> å®Œæˆä»»åŠ¡ï¼Œä¼¼ä¹ä¸å¤ªè¡Œã€‚é¡ºç€è¿™ä¸ªæƒ³æ³•ä¼šè§‚å¯Ÿåˆ°ï¼Œå›ºå®š <span class="math inline">\(i\)</span> ä¹‹åï¼Œæ¯ä¸€åˆ—çš„ poles ä¸­åªæœ‰å’Œç¬¬ <span class="math inline">\(i\)</span> è¡Œæœ€è¿‘çš„æ‰ä¼šæœ‰è´¡çŒ®ã€‚</p>
<p>è¿™ä¸ªæ˜¯å¥½åšçš„ï¼Œä¸”è¿™æ ·çš„ç›¸é‚»ç‚¹æ•°é‡æ˜¯ <span class="math inline">\(O(m)\)</span> çš„ï¼›äºæ˜¯å°† <span class="math inline">\(i\)</span> è§†ä¸ºå¸¸æ•°è¿›è¡Œå˜å½¢ï¼Œè‹¥å°†æ‰€æœ‰ poles æŒ‰ <span class="math inline">\(y\)</span> ä»å°åˆ°å¤§æ’åºå°±èƒ½å¾—åˆ°æ–œç‡å½¢å¼ <span class="math inline">\(\dfrac { {x_A}^2-{x_B}^2+{y_A}^2-{y_B}^2-2\times i\times(x_A-x_B)}{2(y_A-y_B)}&lt;j\)</span>ã€‚ç»´æŠ¤é€’å¢æ–œç‡å°±èƒ½ <span class="math inline">\(O(n^2)\)</span> å®Œæˆé—®é¢˜ã€‚</p>
<p>é‚£ä¹ˆæ‰¾ç›¸é‚»ç‚¹è¿™ä¸€æ­¥å¤§å¯ä»¥æ‘†çƒ‚å†™äºŒåˆ†ã€‚æ‰€ä»¥æ€»å…±æ˜¯ <span class="math inline">\(O(nm\log m)\)</span> çš„ã€‚</p>
<p>ä¸è¦åƒæˆ‘ä¸€æ ·æŠŠä¸¤è¾¹æœ€è¿‘çš„éƒ½åŠ è¿›é˜Ÿåˆ—ï¼Œä¸ç„¶ä½ ä¼šæœ‰åˆ†æ¯ä¸º <span class="math inline">\(0\)</span> çš„æ–œç‡ <img src="/em/hsh.gif" /></p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m, ++n, ++m;
    std::vector&lt;std::vector&lt;int&gt; &gt; tag(n + 1, std::vector&lt;int&gt; (m + 1));
    std::vector&lt;std::vector&lt;int&gt; &gt; g(m + 1);
    for (int i = 1; i &lt;= n; ++i)
        for (int j = 1; j &lt;= m; ++j) &#123;
            char t;
            std::cin &gt;&gt; t;
            if (t == &#39;1&#39;)
                g[j].push_back(i), tag[i][j] = 1;
        &#125;
    struct node &#123; long long x, y; &#125;;
    auto res(0ll);
    for (int i = 1; i &lt;= n; ++i) &#123;
        std::vector&lt;node&gt; p;
        for (int j = 1; j &lt;= m; ++j) &#123;
            int to = std::lower_bound(g[j].begin(), g[j].end(), i) - g[j].begin();
            if (to &lt; (int)g[j].size()) &#123;
                p.push_back(&#123; g[j][to], j &#125;);
                if (g[j][to] != i &amp;&amp; to != 0 &amp;&amp; g[j][to] - i &gt; i - g[j][to - 1])
                    p.back() = &#123; g[j][to - 1], j &#125;;
            &#125;
            else if (to != 0)
                p.push_back(&#123; g[j][to - 1], j &#125;);
        &#125;
        std::vector&lt;int&gt; q(m + 1);
        int h = 0, t = -1;
        auto f1 = [&amp;](node A, node B) &#123;
            return A.x * A.x - B.x * B.x + A.y * A.y - B.y * B.y - 2 * i * (A.x - B.x);
        &#125;;
        auto f2 = [&amp;](node A, node B) &#123;
            return 2 * (A.y - B.y);
        &#125;;
        for (int j = 0; j &lt; (int)p.size(); ++j) &#123;
            for (; h &lt; t &amp;&amp; f1(p[j], p[q[t]]) * f2(p[q[t]], p[q[t - 1]]) &lt; f1(p[q[t]], p[q[t - 1]]) * f2(p[j], p[q[t]]); --t);
            q[++t] = j;
        &#125;
        for (int j = 1; j &lt;= m; ++j) &#123;  
            for (; h &lt; t &amp;&amp; f1(p[q[h + 1]], p[q[h]]) &lt; j * f2(p[q[h + 1]], p[q[h]]); ++h);
            res += (p[q[h]].x - i) * (p[q[h]].x - i) + (p[q[h]].y - j) * (p[q[h]].y - j);
        &#125;
    &#125;
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="g---partition-game">G - Partition Game</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/1527/E" class="uri">https://codeforces.com/problemset/problem/1527/E</a></p>
<p>å‘ç°ä¸å¤ªæ–œä¼˜ï¼Œç»ˆäºç»™æˆ‘æµ¸æ³¡äº†ä¸¤å¤©æ–œä¼˜å†…å®¹çš„å¤§è„‘åŠ äº†å‹ºæ–°çš„åº•ç‰©ã€‚</p>
<p>ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºç¬¬ <span class="math inline">\(i\)</span> æ®µä»¥ <span class="math inline">\(j\)</span> ç»“å°¾çš„æœ€å°ä»£ä»·ï¼›å¯¹ <span class="math inline">\(w\)</span> å¥—ç”¨å››è¾¹å½¢ä¸ç­‰å¼å˜å¼ <span class="math inline">\(w(l-1,r+1)+w(l,r)\ge w(l-1,r)+w(l,r+1)\)</span> å‘ç°æˆç«‹ï¼ˆå…¶ä¸­å¤§å¤šæ•°æ—¶å€™èƒ½å–ç­‰ï¼›éƒ¨åˆ†ç‰¹æ®Šæƒ…å†µå–åˆ°å¤§äºå·ï¼‰ã€‚</p>
<p>é‚£ä¹ˆå‘ç°å¯ä»¥ç”¨åˆ†æ²»ä¼˜åŒ–ã€‚å‘ç° <span class="math inline">\(w\)</span> ä¸é‚£ä¹ˆèƒ½å¿«é€Ÿæ±‚ï¼›è¿˜æ˜¯å¥—ç”¨ <a href="/20250707-1/#ä¾‹yet-another-minimization-problem">Yet Another Minimization Problem</a> ä¸­çš„æ–¹æ³•ï¼Œç”¨ç±»ä¼¼è«é˜Ÿçš„æ–¹å¼æ±‚è§£ã€‚</p>
<p>å‘ç°è¿™ä¸ªè«é˜Ÿå¥—è·¯ä¹Ÿå¾ˆç†Ÿæ‚‰äº†ï¼Œç›´æ¥ç”¨åŒç«¯é˜Ÿåˆ—ç»´æŠ¤å³å¯ã€‚å¤æ‚åº¦ <span class="math inline">\(O(nk\log n)\)</span>ï¼Œçœ‹ç€ä¸å¤ªå®‰å…¨ã€‚ä½†æ³¨æ„åˆ°æˆ‘ä»¬åœ¨ 20 ä¸ªæœˆå‰çš„æäº¤ä¸­ä½¿ç”¨äº† <span class="math inline">\(O(nk\log n)\)</span> çš„çº¿æ®µæ ‘ï¼Œæ‰€ä»¥èƒ½è¿‡çš„å…„å¼Ÿã€‚</p>
<details>
<p>é‰´äº deque çš„æ—¶ç©ºå¸¸æ•°éƒ½å¤§å¾—å“äººï¼Œæ‰€ä»¥æˆ‘ç”¨é™æ€ vector æ¨¡æ‹Ÿ deque äº†ã€‚</p>
<p>è·‘å¾—æ¯”æˆ‘ä¹‹å‰çº¿æ®µæ ‘çš„ä¸€åŠè¿˜å¿«ï¼Œå…„å¼Ÿã€‚</p>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int inf = 1e18;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m;
    std::vector&lt;std::vector&lt;int&gt; &gt; pos(n + 1);
    std::vector&lt;int&gt; a(n + 1), _h(n + 1), _t(n + 1, -1);
    for (int i = 1; i &lt;= n; ++i)
        std::cin &gt;&gt; a[i], pos[a[i]].push_back(i);
    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));
    f[0][0] = 0ll;
    auto w = [&amp;](int ql, int qr) &#123;
        static int l = 1, r = 0;
        static auto res(0ll);
        for (; l &gt; ql; ) &#123;
            --l;
            auto &amp;h = _h[a[l]], &amp;t = _t[a[l]];
            auto &amp;q = pos[a[l]];
            if (h &lt;= t)
                res -= q[t] - q[h];
            res += q[t] - q[--h];
        &#125;
        for (; r &gt; qr; ) &#123;
            auto &amp;h = _h[a[r]], &amp;t = _t[a[r]];
            auto &amp;q = pos[a[r]];
            res -= q[t--] - q[h];
            if (h &lt;= t)
                res += q[t] - q[h];
            --r;
        &#125;
        for (; r &lt; qr; ) &#123;
            ++r;
            auto &amp;h = _h[a[r]], &amp;t = _t[a[r]];
            auto &amp;q = pos[a[r]];
            if (h &lt;= t)
                res -= q[t] - q[h];
            res += q[++t] - q[h];
        &#125;
        for (; l &lt; ql; ) &#123;
            auto &amp;h = _h[a[l]], &amp;t = _t[a[l]];
            auto &amp;q = pos[a[l]];
            res -= q[t] - q[h++];
            if (h &lt;= t)
                res += q[t] - q[h];
            ++l;
        &#125;
        return res;
    &#125;;
    for (int t = 1; t &lt;= m; ++t) &#123;
        std::function&lt;void(int, int, int, int)&gt; calc = [&amp;](int l, int r, int lp, int rp) &#123;
            if (l &gt; r)
                return;
            if (l == r) &#123;
                for (int i = lp; i &lt;= rp &amp;&amp; i &lt; l; ++i)
                    f[t][l] = std::min(f[t][l], f[t - 1][i] + w(i + 1, l));
                return;
            &#125;
            int mid = (l + r) &gt;&gt; 1, p = -1;
            for (int i = lp; i &lt;= rp &amp;&amp; i &lt; mid; ++i)
                if (f[t - 1][i] + w(i + 1, mid) &lt; f[t][mid])
                    f[t][mid] = f[t - 1][i] + w(i + 1, mid), p = i;
            calc(l, mid - 1, lp, p), calc(mid + 1, r, p, rp);
            return;
        &#125;;
        calc(t, n, t - 1, n - 1);
    &#125;
    std::cout &lt;&lt; f[m][n] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="h---battle-lemmings">H - Battle Lemmings</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/1420/E" class="uri">https://codeforces.com/problemset/problem/1420/E</a></p>
<p>å®¹æ˜“å‘ç° <span class="math inline">\(0\)</span> çš„æ•°ç›®ä¸å˜ï¼Œç­”æ¡ˆå°±æ˜¯ <span class="math inline">\(0\)</span> çš„å¯¹æ•° - è¿ç»­ <span class="math inline">\(0\)</span> çš„å¯¹æ•°ã€‚</p>
<p>ç„¶åæœ‰ä¸€ä¸ªæˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„ trickï¼Œéšä¾¿æ‰¾ä¸€ä¸ªç›®æ ‡åºåˆ—ï¼Œé‚£ä¹ˆèŠ±è´¹çš„æ“ä½œæ¬¡æ•°å°±æ˜¯æ¯ä¸ªå¯¹åº”çš„ <span class="math inline">\(1\)</span> çš„ä½ç½®å·®ã€‚ä»¤ <span class="math inline">\(f_{i,j,k}\)</span> è¡¨ç¤ºç”¨äº† <span class="math inline">\(i\)</span> æ¬¡æ“ä½œã€<span class="math inline">\(j\)</span> ä¸ª <span class="math inline">\(1\)</span>ã€æœ€åä¸€ä¸ª <span class="math inline">\(1\)</span> åœ¨ <span class="math inline">\(k\)</span> çš„æœ€å°è¿ç»­ <span class="math inline">\(0\)</span> å¯¹æ•°ã€‚é‚£ä¹ˆæœ‰ï¼š</p>
<p><span class="math display">\[
\begin{aligned}
f_{i,j,k}&amp;=\min\limits_{p&lt;k}\left\{f_{i-|k-pos_j|,j-1,p}+\dfrac {(k-p-1)(k-p-2)}2\right\}\\
&amp;=\min\left\{f_{i-|k-pos_j|,j-1,p}-k\cdot p+\dfrac {p(p + 2)}2\right\}+\dfrac {k^2-3k+2}2
\end{aligned}
\]</span></p>
<p>å‘ç°è¿™ä¸ªå¼å­æ˜¯ <span class="math inline">\(O(n^5)\)</span> çš„ï¼Œè€Œä¸”çœ‹èµ·æ¥å¾ˆæ–œä¼˜ï¼ŒåŒ–ä¸ºæ–œç‡å½¢å¼ <span class="math inline">\(\dfrac{2\times f_A-2\times f_B+A(A+2)-B(B+2)}{2(A-B)}&lt;k\)</span>ã€‚ç»´æŠ¤é€’å¢æ–œç‡å°±å¯ä»¥ <span class="math inline">\(O(n^4)\)</span> åšäº†ã€‚</p>
<p>Tipï¼šå½“æ—¶å†™ç€å†™ç€æ„£ä½äº†ï¼Œæ¯”å¦‚è¿™ä¸ª <span class="math inline">\(i-|k-pos_j|\)</span> ä¸æ˜¯ä¸€ç›´åœ¨åŠ¨å—ã€‚è§£å†³æ–¹æ¡ˆï¼ŸåŒæ—¶ç»´æŠ¤å¾ˆå¤šä¸ªé˜Ÿåˆ—å³å¯ã€‚</p>
<details>
<p>æ³¨æ„è¿˜è¦æŠŠæœ€åä¸€ä¸ª <span class="math inline">\(1\)</span> ä¹‹åè¿ç»­ <span class="math inline">\(0\)</span> çš„ä»£ä»·ç®—ä¸Šã€‚</p>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const long long inf = 1e9;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    std::vector&lt;int&gt; a(n + 1);
    std::vector&lt;long long&gt; pos(1);
    for (int i = 1; i &lt;= n; ++i) &#123;
        std::cin &gt;&gt; a[i];
        if (a[i] == 1)
            pos.push_back(i);
    &#125;
    int m = n * (n - 1) / 2;
    std::vector&lt;std::vector&lt;std::vector&lt;long long&gt; &gt; &gt; f(pos.size(), std::vector&lt;std::vector&lt;long long&gt; &gt; (m + 1, std::vector&lt;long long&gt; (n + 1, inf)));
    f[0][0][0] = 0ll;
    for (int j = 1; j &lt; (int)pos.size(); ++j) &#123;
        std::vector&lt;std::vector&lt;int&gt; &gt; _q(m + 1, std::vector&lt;int&gt; (n + 1));
        std::vector&lt;int&gt; _h(m + 1), _t(m + 1, -1);
        for (int k = 0; k &lt;= n; ++k)
            for (int i = m; i &gt;= 0; --i) &#123;
                if (i &gt;= std::abs(k - pos[j])) &#123;
                    auto f1 = [&amp;](long long A, long long B) &#123;
                        return 2 * f[j - 1][i - std::abs(k - pos[j])][A] - 2 * f[j - 1][i - std::abs(k - pos[j])][B] + A * (A + 2) - B * (B + 2);
                    &#125;;
                    auto f2 = [&amp;](long long A, long long B) &#123;
                        return 2 * (A - B);
                    &#125;;
                    auto &amp;h = _h[i - std::abs(k - pos[j])], &amp;t = _t[i - std::abs(k - pos[j])];
                    auto &amp;q = _q[i - std::abs(k - pos[j])];
                    for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &lt; k * f2(q[h + 1], q[h]); ++h) &#123;&#125;
                    if (h &lt;= t)
                        f[j][i][k] = std::min(inf, f[j - 1][i - std::abs(k - pos[j])][q[h]] + (k - q[h] - 1) * (k - q[h] - 2) / 2);
                &#125;
                auto f1 = [&amp;](long long A, long long B) &#123;
                    return 2 * f[j - 1][i][A] - 2 * f[j - 1][i][B] + A * (A + 2) - B * (B + 2);
                &#125;;
                auto f2 = [&amp;](long long A, long long B) &#123;
                    return 2 * (A - B);
                &#125;;
                auto &amp;h = _h[i], &amp;t = _t[i];
                auto &amp;q = _q[i];
                for (; h &lt; t &amp;&amp; f1(k, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(k, q[t]); --t);
                q[++t] = k;
            &#125;
    &#125;
    auto res(-inf);
    int cnt = n - (int)pos.size() + 1;
    cnt = cnt * (cnt - 1) / 2;
    for (int i = 0; i &lt;= m; ++i) &#123;
        for (int k = 0; k &lt;= n; ++k)
            res = std::max(res, cnt - f.back()[i][k] - (n - k) * (n - k - 1) / 2);
        std::cout &lt;&lt; res &lt;&lt; &#39; &#39;;
    &#125;
    std::cout &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="a---yakiniku-restaurants">A - Yakiniku Restaurants</h2>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc067/tasks/arc067_d" class="uri">https://atcoder.jp/contests/arc067/tasks/arc067_d</a></p>
<p>å‘ç°å›ºå®šå·¦å³ç«¯ç‚¹åï¼Œæ”¶ç›Šæ˜¯å¯ä»¥è´ªå¿ƒç®—çš„ï¼›ä¸‹æ„è¯†æƒ³åˆ°åªå›ºå®šå·¦ç«¯ç‚¹ï¼Œé‚£ä¹ˆå³ç«¯ç‚¹åº”è¯¥å°±å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ä¹‹ç±»çš„æä¸€æã€‚</p>
<p>å…ˆæå‰æŠŠæ‰€æœ‰ä¸œè¥¿å¡åˆ°é˜Ÿåˆ—é‡Œã€‚å·¦ç«¯ç‚¹ä¸€å¼€å§‹åœ¨æœ€å³è¾¹ï¼›å¾€å·¦è¾¹åŠ¨ä¸€ä¸‹ä¹‹åï¼Œå°±å¯ä»¥æ›´æ–°æ¯ç§èœçš„é˜Ÿåˆ—ï¼›å‘ç°åœ¨æ‰€æœ‰å…ƒç´ ä¸­ä½œå†³ç­–ç‚¹çš„ä¸æ€»æ˜¯é˜Ÿå¤´ï¼›è¿™ä¸ªåœ°æ–¹ç”¨ <strong>å•è°ƒé€’å‡çš„å•è°ƒæ ˆ</strong> æ˜¯æå¥½çš„ã€‚è¿™é‡Œçš„å•è°ƒæ ˆå…¶å®å°±ç±»ä¼¼ <a href="/20250707-1/#ä¼˜åŒ–-dpå•è°ƒæ•°æ®ç»“æ„">å››è¾¹å½¢ä¸ç­‰å¼ä¸­çš„å•è°ƒæ•°æ®ç»“æ„</a> äº†ã€‚</p>
<p>ç»´æŠ¤å•è°ƒæ ˆä¸­æ¯ä¸ªå†³ç­–ç‚¹çš„å½±å“åŒºé—´ï¼›æ˜¾ç„¶æ¯ä¸ªå³ç«¯ç‚¹çš„ç­”æ¡ˆå˜åŒ–é‡ç›¸åŒï¼›ç”¨ä¸ªç±»ä¼¼äºå·®åˆ†çš„ä¸œè¥¿è®°å½•ä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<p>å¤æ‚åº¦ <span class="math inline">\(O(n^2)\)</span>ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const long long inf = 1e18;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m;
    std::vector&lt;long long&gt; s(n + 1), f(n + 1);
    for (int i = 2; i &lt;= n; ++i) &#123;
        std::cin &gt;&gt; s[i], s[i] += s[i - 1];
        f[i] = -s[i];
    &#125;
    std::vector&lt;std::vector&lt;int&gt; &gt; a(n + 1, std::vector&lt;int&gt; (m + 1));
    for (int i = 1; i &lt;= n; ++i)
        for (int j = 1; j &lt;= m; ++j)
            std::cin &gt;&gt; a[i][j];
    struct node &#123; int j, l, r; &#125;;
    std::vector&lt;std::stack&lt;node&gt; &gt; _q(m + 1);
    auto res(-inf);
    for (int l = n; l; --l) &#123;
        std::vector&lt;long long&gt; d(n + 1);
        auto add = [&amp;](int l, int r, long long v) &#123;
            d[l] += v;
            if (r != n)
                d[r + 1] -= v;
            return;
        &#125;;
        for (int j = 1; j &lt;= m; ++j) &#123;
            auto &amp;q = _q[j];
            node now = &#123; j, l, l &#125;;
            add(l, l, a[l][j]);
            for (; !q.empty() &amp;&amp; a[l][j] &gt;= a[q.top().l][q.top().j]; q.pop()) &#123;
                now.r = q.top().r;
                add(q.top().l, q.top().r, a[l][j] - a[q.top().l][q.top().j]);
            &#125;
            q.push(now);
        &#125;
        std::partial_sum(d.begin() + 1, d.end(), d.begin() + 1);
        for (int r = l; r &lt;= n; ++r) &#123;
            f[r] += d[r];
            res = std::max(res, f[r] + s[l]);
        &#125;
    &#125;
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="b---jellyfish-and-miku">B - Jellyfish and Miku</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/1874/D" class="uri">https://codeforces.com/problemset/problem/1874/D</a></p>
<p>å”‰æ•°åˆ—ã€‚å”‰æ¦‚ç»Ÿã€‚åœ¨æ•°å­¦è®²ä¹‰ä¸ŠæŠ˜ç£¨äº†æˆ‘ä¸€éä¹‹åè¿˜è¦åˆ°è¿™å„¿æ¥æŠ˜ç£¨æˆ‘ã€‚</p>
<p>å‡è®¾å·²ç»çŸ¥é“äº† <span class="math inline">\(a\)</span>ï¼Œè€ƒè™‘æ±‚æœŸæœ›æ­¥æ•°ã€‚è®¾ <span class="math inline">\(E_i\)</span> ä¸ºä» <span class="math inline">\(i\)</span> å‡ºå‘èµ°åˆ° <span class="math inline">\(n\)</span> çš„æœŸæœ›æ­¥æ•°ã€‚é‚£ä¹ˆæœ‰ï¼š</p>
<p><span class="math display">\[
E_i=\begin{cases}
E_1+1&amp;i=0\\
0&amp;i=n\\
E_i=(E_{i-1}+1)\cdot \dfrac {a_i}{a_{i+1}+a_i}+(E_{i+1}+1)\cdot \dfrac {a_{i+1}}{a_{i+1}+a_{i}}&amp;\text{otherwise}
\end{cases}
\]</span></p>
<p>ï¼ˆæç¤ºï¼šä»ã€<span class="math inline">\(i\)</span> ä¸‹ä¸€æ­¥ä¼šèµ°å“ªä¸ªæ–¹å‘ã€è€ƒè™‘ã€‚ï¼‰</p>
<p>æ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨ä½ çš„é«˜ä¸­æ•°å­¦çŸ¥è¯†è¿›è¡Œä¸€ä¸ª <span class="math inline">\(f_0\)</span> çš„æ±‚ï¼Œï¼ˆä¸€å †è¿‡ç¨‹ï¼‰ï¼Œå¾—åˆ° <span class="math inline">\(E_0=n+2\times \sum\limits_{i=1}^n\dfrac {\sum_{j\le i}a_j}{a_i}\)</span>ï¼Œç„¶åæƒ³è¦æœ€å°åŒ–è¿™ä¸ªä¸œè¥¿ã€‚</p>
<p>ä¸å¦¨ä»¤ <span class="math inline">\(f_{i,j}\)</span> è¡¨ç¤ºåˆ° <span class="math inline">\(i\)</span> æ—¶å·²ç»åˆ†é…èµ°äº† <span class="math inline">\(j\)</span> ä½“ç§¯ï¼Œ<span class="math inline">\(\sum_{k=1}^i \dfrac {\sum_{l\le k}a_l}{a_k}\)</span> çš„æœ€å°å€¼ï¼Œæœ‰ <span class="math inline">\(f_{i,j}=\min\limits_{k&lt;j}\left\{f_{i-1,k}+\dfrac {k}{j - k}\right\}\)</span>ã€‚å‘ç°å®ƒå¤§æŠµæ˜¯æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼çš„ï¼ŒæŒ‰ç…§ <a href="/20250707-1/#d1d-dp-ä¼˜åŒ–">2D/1D DP ä¼˜åŒ–çš„ç»“è®º</a>ï¼Œä»£å…¥ <span class="math inline">\(p_{i,j-1}&lt;p_{i,j}&lt;p_{i+1,j}\)</span> å¯ä»¥ <span class="math inline">\(O(nm)\)</span> è§£å†³é—®é¢˜ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m;
    std::vector&lt;std::vector&lt;int&gt; &gt; p(n + 1, std::vector&lt;int&gt; (m + 1));
    std::vector&lt;std::vector&lt;long double&gt; &gt; f(n + 1, std::vector&lt;long double&gt; (m + 1, 1e18));
    f[0][0] = 0ll;
    for (int j = 1; j &lt;= m; ++j)
        for (int i = std::min(j, n); i; --i) &#123;
            int to = ((i == std::min(j, n)) ? j : std::min(p[i + 1][j], j));
            for (int k = p[i][j - 1]; k &lt;= to; ++k)
                if (f[i - 1][k] + k * 1. / (j - k) &lt; f[i][j])
                    f[i][j] = f[i - 1][k] + k * 1. / (j - k), p[i][j] = k;
            // printf(&quot;f[%d][%d] = %Lf, p = %d\n&quot;, i, j, f[i][j], p[i][j]);
        &#125;
    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(10) &lt;&lt; n + 2 * f[n][m] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="cut-the-sequence">Cut the Sequence</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P10977" class="uri">https://www.luogu.com.cn/problem/P10977</a></p>
<h1 id="é€šçŸ¥åŒºé—´æœ€å€¼-ä¸æ»¡è¶³-å››è¾¹å½¢ä¸ç­‰å¼"><mark>é€šçŸ¥ï¼šåŒºé—´æœ€å€¼ ä¸æ»¡è¶³ å››è¾¹å½¢ä¸ç­‰å¼ã€‚</mark></h1>
<p>å…¶å®åœ¨çŒœçš„æ—¶å€™æ˜¯ä¸¾äº†åä¾‹çš„ï¼Œä½†æ˜¯å¤§è„‘èç¼©äº†æ¨ç€æ¨ç€å¿˜è®°ç¬¦å·äº† ğŸ˜…</p>
<p>çœ‹åˆ° <span class="math inline">\(f_i=\min\limits_{g(i)\le j&lt;i}\{f_j+\max\{a_{j+1\sim i}\}\}\)</span> è¿™ä¸ª <span class="math inline">\(j\)</span> çš„èŒƒå›´å…¶å®æ˜¯æœ‰ç‚¹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ„Ÿè§‰çš„ï¼Œä½†è¿™ä¸ªæœ€å¤§å€¼ä¼ ç»Ÿçš„å•è°ƒé˜Ÿåˆ—ä¸æ˜¯å¾ˆå¯åšã€‚å¯ä»¥æ³¨æ„åˆ°æœ€å¤§å€¼è¿™ä¸€é¡¹æœ‰ç‚¹ <strong>å•è°ƒé˜Ÿåˆ—</strong> åç¼€æœ€å¤§å€¼çš„æ„Ÿè§‰ï¼ˆå®é™…ä¸Šå°±æ˜¯ï¼‰ï¼›ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•æ˜¯åˆ©ç”¨è¿™ä¸ªæœ€å¤§å€¼å½±å“çš„åŒºé—´ï¼Œç»´æŠ¤ <span class="math inline">\(f\)</span> çš„çº¿æ®µæ ‘æ¥æš´åŠ›åšã€‚</p>
<p>å¦ä¸€ä¸ªæ¯”è¾ƒç‰›çš„åšæ³•æ˜¯å‘ç°åŒä¸€ä¸ªä¸‹æ ‡çš„ <span class="math inline">\(f\)</span> å’Œ <span class="math inline">\(a\)</span> çš„å…³ç³»ã€‚é¦–å…ˆéœ€è¦æ³¨æ„åˆ° <span class="math inline">\(f\)</span> å•è°ƒä¸é™ï¼›å¯¹äºåŒä¸€ä¸ª <span class="math inline">\(a\)</span>ï¼Œèƒ½å–åˆ°çš„ <span class="math inline">\(f\)</span> å°±æ˜¯æœ€é å‰çš„ï¼›ç»´æŠ¤ä¸€ä¸ª <span class="math inline">\(a\)</span> çš„å•å‡é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå…±ç”¨åŒä¸€ä¸ª <span class="math inline">\(a\)</span> çš„å°±æ˜¯ç›¸é‚»ä¸¤ä¸ªä¸‹æ ‡ä¹‹é—´çš„éƒ¨åˆ†ï¼Œå…¶æœ€ä¼˜å†³ç­–åœ¨èƒ½å–åˆ°çš„æœ€å‰ç«¯å–å¾—ï¼›éœ€è¦æ³¨æ„åˆ°é˜Ÿåˆ—é‡Œçš„è´¡çŒ®å¹¶ä¸å•è°ƒï¼Œéœ€è¦ç”¨ä¸€ä¸ª multiset æ¥å­˜å‚¨æ‰€æœ‰è´¡çŒ®å¹¶æŸ¥æ‰¾ã€æ›´æ–°ã€‚</p>
<p>éœ€è¦æ³¨æ„å•è°ƒé˜Ÿåˆ—é‡ŒæŸä¸ªå…ƒç´  <span class="math inline">\(f_{q_i}\)</span> ç»“åˆçš„å…¶å®æ˜¯ <span class="math inline">\(a_{q_{i+1}}\)</span>ã€‚è¿˜éœ€è¦æ³¨æ„é˜Ÿå¤´çš„ç»´æŠ¤ï¼Œå¯èƒ½éœ€è¦ä¸€äº›å°å·§æ€ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;1.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m;
    std::cin &gt;&gt; n &gt;&gt; m;
    std::vector&lt;int&gt; a(n + 1);
    std::vector&lt;long long&gt; s(n + 1);
    for (int i = 1; i &lt;= n; ++i)
        std::cin &gt;&gt; a[i], s[i] = s[i - 1] + a[i];
    int h = 0, t = -1;
    std::multiset&lt;long long&gt; st;
    std::vector&lt;long long&gt; f(n + 1);
    std::vector&lt;std::pair&lt;int, int&gt; &gt; q(n + 1);
    q[++t] = &#123; 0, 0 &#125;, a[0] = 0x3f3f3f3f;
    for (int i = 1; i &lt;= n; ++i) &#123;
        for (; s[i] - s[q[h].second] &gt; m; ) &#123;
            st.erase(st.find(f[q[h].second] + a[q[h + 1].first]));
            if (++q[h].second &gt;= q[h + 1].first)
                a[q[++h].first] = 0x3f3f3f3f;
            else
                st.insert(f[q[h].second] + a[q[h + 1].first]);
        &#125;
        for (; h &lt; t &amp;&amp; a[q[t].first] &lt;= a[i]; --t)
            st.erase(st.find(f[q[t - 1].second] + a[q[t].first]));
        st.insert(f[q[t].second] + a[i]), q[++t] = &#123; i, i &#125;;
        f[i] = *st.begin();
    &#125;
    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>

			</div>
			<hr class="dotted">
			<div class="post footer">
				<div id="hitokoto">
					<h3 id="hitokoto-title">
						è¨€è®º
					</h3>
					<div id="hitokoto-content">
					</div>
					<div id="hitokoto-from">
					</div>
				</div>
				<div class="button flex">
					<div id="prev">
						
							<!-- åæ§½ï¼Œä¸ºå•¥è¿˜éœ€è¦åŠ  / -->
							<a href="/20250716/">
								<i class="fas fa-angle-double-left" style="margin-right: 10px;"></i>
								ç»ƒä¹  æ ‘çš„å„ç§æ€§è´¨ I
							</a>
						
					</div>
					<div id="next">
						
							<a href="/20250712/">
								æ‚é¢˜
								<i class="fas fa-angle-double-right" style="margin-left: 10px;"></i>
							</a>
						
					</div>
				</div>
				<div id="vcomments" class="text"></div>
<script>
	new Valine({
		el: '#vcomments',
		appId: 'OlmvQ0a2Zw7xo3no2bwabOzx-gzGzoHsz',
		appKey: 'TW6t8mFeGLmhPjWisvmllvvo',
		recordIP: true,
		enableQQ: true, 
		// [EDITED] ç›®å‰ Valine çš„ QQ è‡ªåŠ¨è·å–æ˜µç§°ä¼¼ä¹ä¸å¯ç”¨
		// è¯¥é—®é¢˜åœ¨ v1.5.3 ä¸­å·²ä¿®å¤
		pageSize: 10,
		requiredFields:
			
				['nick']
			,
		placeholder: "The world is but a little place after all...\nèƒ½å¤Ÿæ ¹æ®é‚®ç®±è·å–ä½ çš„ Gravatar å¤´åƒã€‚æ˜µç§°æ˜¯å¿…å¡«é¡¹ï¼Œé•¿åº¦éœ€ä¸ä½äº 3ã€‚",
		avatar: 'identicon',
		avatar_cdn: 'https://cravatar.cn/avatar/',
		emojiCDN: 'https://xsc062.netlify.app/em/', 
		emojiMaps: {
			
				"å¾®ç¬‘": "wx.gif",
			
				"é¾‡ç‰™": "cy.gif",
			
				"æµæ³ª": "ll.gif",
			
				"ç¬‘å“­": "xk.gif",
			
				"æµæ±—": "lh.gif",
			
				"æ“¦æ±—": "ch.gif",
			
				"äº²äº²": "qq.gif",
			
				"è‰²": "se.gif",
			
				"ç–‘é—®": "yiw.gif",
			
				"å‘å‘†": "fd.gif",
			
				"æ™•": "yun.gif",
			
				"é¼“æŒ": "gz.gif",
			
				"æ†¨ç¬‘": "hanx.gif",
			
				"å¿«å“­äº†": "kk.gif",
			
				"å¾—æ„": "dy.gif",
			
				"ç‹‚ç¬‘": "kx.gif",
			
				"å®³ç¾": "hx.gif",
			
				"å¦ˆå¦ˆç”Ÿçš„": "dz.gif",
			
				"ç³—å¤§äº†": "qd.gif",
			
				"åƒç“œ": "cg.gif",
			
				"ççœ¼": "zy.webp",
			
				"è¾£çœ¼ç›": "lyj.gif",
			
				"é…¸äº†": "nm.gif",
			
				"æ»š": "gun.webp",
			
				"æƒŠæ": "jk.gif",
			
				"å¹½çµ": "youl.gif",
			
				"æ— èŠ": "wul.gif",
			
				"åƒ": "eat.gif",
			
				"ä½ å¾ˆæ£’æ£’": "bb.gif",
			
				"èµ": "qiang.gif",
			
				"è¸©": "ruo.gif",
			
				"æ¡æ‰‹": "wsh.gif",
			
				"å‘æŠ–": "fad.gif",
			
				"æŒ¥æ‰‹": "hsh.gif",
			
				"ç£•å¤´": "kt.gif",
			
				"æ€„ç«": "oh.gif",
			
		},
	})
</script>
			</div>
			<script>setHitokoto();</script>
		</div> 
	</div>
</div>
    <!-- é¡µè„šå¼€å§‹ -->
<div id="footer" class="serif">
    Powered by
    <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
    &
    <a href="/about-this-theme">
        iwll
    </a>
    <p style="margin-top: 5px;">
        2021 - 2025
    </p>
    <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" id="CCTAG"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg"></a>
</div>
<!-- Valine ç›¸å…³é…ç½® -->
<script>
    const getValineDomTimer = setInterval(() => {
        // ä¸çŸ¥é“ä¸ºä»€ä¹ˆ æˆ‘ä»åŸåšå®¢ js æ–‡ä»¶ç²˜è¿‡æ¥çš„å‚æ•°æ˜¯
        // "#valine .vcards .vcard"
        // DEBUG äº†åŠå¤©æ‰å®šä½åˆ°è¿™ä¸ªé—®é¢˜ã€‚ã€‚ã€‚
        const vcards =
            document.querySelectorAll('#valine, .vcards, .vcard');
        if (vcards.length > 0) {
            let author = 'XSC062';
            for (let vcard of vcards) {
                const vnick_dom = vcard.querySelector('.vhead .vnick');
                if (vnick_dom != null) {
                    const vnick = vnick_dom.innerHTML;
                    if (vnick === author) {
                        vnick_dom.innerHTML =
                        `${vnick} <span id="rootitem" class="code">root</span>`
                    }
                }
            }
        }
        else {
            clearInterval(getValineDomTimer);
        }
    }, 2000);
    SetActiveItem();
    setDetailsSummary();
    setTitleAnchor();
    setEmptyToc();
    setCodeClassName();
</script>


<!-- js -->
<!-- æœç´¢åŠŸèƒ½ç›¸å…³é…ç½® -->

<script src="/js/search.js"></script>


<script src="/js/local-search.js"></script>

</script>
<!-- prism ç›¸å…³é…ç½® -->
<script type="text/javascript" src="/js/prism.js" defer></script>
<!-- ä»£ç å—å¤åˆ¶åŠŸèƒ½ -->
<script type="text/javascript" src="/js/clipboard.min.js"></script>
<script type="text/javascript" src="/js/clipboard-use.js"></script>
<!-- é¡µè„šç»“æŸ -->
</body>
</html>