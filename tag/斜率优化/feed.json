{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"æ–œç‡ä¼˜åŒ–\" tag",
    "description": "",
    "home_page_url": "https://xsc062.netlify.app",
    "items": [
        {
            "id": "https://xsc062.netlify.app/20250715/",
            "url": "https://xsc062.netlify.app/20250715/",
            "title": "æ‚é¢˜é€‰è°ˆï¼šå†³ç­–å•è°ƒæ€§",
            "date_published": "2025-07-15T06:13:24.000Z",
            "content_html": "<p>ã€å¿ƒé™è‡ªç„¶å‡‰ã€å¤§æŠµæ˜¯å› ä¸ºæƒ…ç»ªå¹³å’Œæ—¶å‰¯äº¤æ„Ÿç¥ç»å…´å¥‹ï¼Œä½“æ¸©ç•¥æœ‰é™ä½å¯¼è‡´çš„ã€‚å—ï¼Ÿ</p>\n<span id=\"more\"></span>\n<p>å…¶å®æ˜¯å› ä¸ºå¿ƒè„åœè·³åè¡€æ¶²å¾ªç¯ç»ˆæ­¢ã€ä»£è°¢ä¸­æ–­ï¼Œå¯¼è‡´äº§çƒ­ä½äºæ•£çƒ­ï¼ˆï¼Ÿï¼‰</p>\n<hr />\n<h2 id=\"a---å¾é€”\">A - å¾é€”</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P4072\" class=\"uri\">https://www.luogu.com.cn/problem/P4072</a></p>\n<p>ç”¨å®Œå…¨å¹³æ–¹å…¬å¼å±•å¼€å¾—åˆ° <span class=\"math inline\">\\(m^2\\sigma^2=m\\left(\\sum {x_i}^2\\right)-S^2\\)</span>ï¼Œå…¶ä¸­ <span class=\"math inline\">\\(S\\)</span> ä¸ºæ±‚å’Œã€‚</p>\n<p>æ‰€ä»¥ç›®æ ‡æ˜¯æœ€å°åŒ– <span class=\"math inline\">\\(\\sum {x_i}^2\\)</span> è¿™ä¸ªä¸œè¥¿ã€‚ä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºç¬¬ <span class=\"math inline\">\\(i\\)</span> å¤©èµ°åˆ° <span class=\"math inline\">\\(j\\)</span>ï¼Œå¾—åˆ°ï¼š</p>\n<p><span class=\"math display\">\\[\n\\begin{aligned}\nf_{i,j}&amp;=\\min\\{f_{i-1,k}+(s_j-s_k)^2\\}\\\\\n&amp;=\\min\\{f_{i-1,k}-2\\times s_j\\times s_k+{s_k}^2\\}+{s_j}^2\n\\end{aligned}\n\\]</span></p>\n<p>æœ€åå¾—åˆ°çš„æ–œç‡å¼å­æ˜¯ <span class=\"math inline\">\\(\\dfrac {f_{i - 1, a}-f_{i - 1, b}+{s_a}^2-{s_b}^2}{2(s_a-s_b)}&lt;s_j\\)</span>ï¼Œç”±äº <span class=\"math inline\">\\(s_j\\)</span> å•å¢ï¼Œ<del>å•è°ƒé˜Ÿåˆ—ç»´æŠ¤é€’å‡æ–œç‡å³å¯</del> <strong>æ›´æ­£ï¼šæ˜¯é€’å¢æ–œç‡ã€‚åŸå› æ˜¯ <span class=\"math inline\">\\(&lt;\\)</span> æ˜¯å¼¹å‡ºæ¡ä»¶ï¼Œè€Œéä¿ç•™æ¡ä»¶â€¦â€¦</strong></p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e9;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; a(n + 1);\n    std::vector&lt;long long&gt; s(n + 1);\n    auto sum(0ll);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        s[i] = s[i - 1] + a[i];\n        sum += a[i];\n    &#125;\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));\n    f[0][0] = 0ll;\n    for (int i = 1; i &lt;= m; ++i) &#123;\n        auto f1 = [&amp;](int a, int b) &#123;\n            return f[i - 1][a] - f[i - 1][b] + s[a] * s[a] - s[b] * s[b];\n        &#125;;\n        auto f2 = [&amp;](int a, int b) &#123;\n            return 2 * (s[a] - s[b]);\n        &#125;;\n        std::vector&lt;int&gt; q(n + 1);\n        int h = 0, t = -1;\n        q[++t] = i - 1;\n        for (int j = i; j &lt;= n; ++j) &#123;\n            for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &lt; s[j] * f2(q[h + 1], q[h]); ++h);\n            f[i][j] = f[i - 1][q[h]] + (s[j] - s[q[h]]) * (s[j] - s[q[h]]);\n            for (; h &lt; t &amp;&amp; f1(j, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(j, q[t]); --t);\n            q[++t] = j;\n        &#125;\n    &#125;\n    std::cout &lt;&lt; m * f[m][n] - sum * sum &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---åˆ·é‡-iii\">B - åˆ·é‡ III</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P10074\" class=\"uri\">https://www.luogu.com.cn/problem/P10074</a></p>\n<p>å‘ç°æœ€åæƒ…å†µå°±æ˜¯æ¯æ¬¡ã€è¯•æ¢ã€éƒ½ä¸ä¸­çš„æƒ…å†µï¼Œå†è¯•æ¢ä¸­æœ€åçš„é‚£ä¸€ä¸ªã€‚ä¸ºå•¥å‘¢ï¼Œç›¸å½“äºæˆ‘ä»¬æ¯æ¬¡æ”»å‡»çš„ä¸€å®šæ˜¯æœªçŸ¥å…ƒç´ ä¸­è¡€æœ€å¤šçš„ä¸€ä¸ªã€‚æ—¢ç„¶å·²ç»è¯•æ¢å‡ºäº†æ¯”é˜ˆå€¼å¤§çš„æ‰€æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ”»å‡»çš„å°±ä¸€å®šæ˜¯é˜ˆå€¼æœ¬èº«ï¼Œå¦‚æœè¿™æ¬¡è·³è¿‡å®ƒï¼Œå®ƒå°±ä¼šæˆä¸ºä¸‹ä¸€æ¬¡è¯•æ¢å¤±è´¥çš„å…ƒç´ ã€‚è¿™æ˜¾ç„¶ä¸å¦‚ä¸€å¼€å§‹å°±ç›´æ¥ç”¨æ–°é˜ˆå€¼è¯•æ¢ã€‚</p>\n<p>ä»å¤§åˆ°å°æ’åºã€‚ä»¤ <span class=\"math inline\">\\(f_{j, i}\\)</span> è¡¨ç¤ºåªç¡®å®šäº†å‰ <span class=\"math inline\">\\(i\\)</span> å¤§çš„æ•°ï¼Œå·²ç»æ€äº† <span class=\"math inline\">\\(j\\)</span> ä¸ªäººçš„æœ€åæƒ…å†µæœ€å°ä»£ä»·ã€‚é‚£ä¹ˆæ˜¾ç„¶è¿™ä¸€æ¬¡çš„é˜ˆå€¼æ˜¯ <span class=\"math inline\">\\(a_i\\)</span>ã€‚éšä¾¿é€‰å‡ºä¸Šä¸€æ¬¡çš„é˜ˆå€¼ <span class=\"math inline\">\\(a_k\\)</span>ï¼Œé‚£ä¹ˆä¸­é—´è¿™ä¸€æ®µå¾…ç¡®å®šçš„å…ƒç´ æ•°é‡ä¸º <span class=\"math inline\">\\(i-k\\)</span>ã€‚é‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\n\\begin{aligned}\nf_{j, i}&amp;=\\min\\limits_{k&lt;i}\\{f_{j-1,k}+(i-k)\\times a_i\\}\\\\\n&amp;=\\min\\limits_{k&lt;i}\\{f_{j-1,k}-k\\times a_i\\}+i\\times a_i\n\\end{aligned}\n\\]</span></p>\n<p>ç»è¿‡éªŒè¯ï¼Œè™½ç„¶è¿™ä¸ªå¼å­å’Œé¢˜è§£é•¿å¾—ä¸ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¯¹çš„ <del>å› ä¸ºæˆ‘ n^3 æš´åŠ› A äº†</del></p>\n<p>æ¨å‡ºæ–œä¼˜å½¢å¼ <span class=\"math inline\">\\(\\dfrac {f_{j-1,A}-f_{j-1,B}}{A-B}&lt;a_i\\)</span>ï¼Œä½†æˆ‘çš„æœ‹å‹ï¼Œ<span class=\"math inline\">\\(a_i\\)</span> æ˜¯é€’å‡çš„ã€‚æ‰€ä»¥ç”¨å•è°ƒæ ˆç»´æŠ¤é€’å¢æ–œç‡å³å¯ã€‚<del>æˆ–è€…ä½ ä¹Ÿå¯ä»¥å­¦ä¹  grisses æ‰“ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—ä¸ŠäºŒåˆ†</del></p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e12;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;P10074_4.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;long long&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::sort(a.begin() + 1, a.end(), std::greater&lt;long long&gt; ());\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));\n    f[0][0] = 0ll;\n    for (int j = 1; j &lt;= m; ++j) &#123;\n        std::vector&lt;int&gt; q(n + 1);\n        int t = -1;\n        q[++t] = j - 1;\n        auto f1 = [&amp;](int A, int B) &#123;\n            return f[j - 1][A] - f[j - 1][B];\n        &#125;;\n        auto f2 =[&amp;](int A, int B) &#123;\n            return A - B;\n        &#125;;\n        for (int i = j; i &lt;= n; ++i) &#123;\n            for (; t &gt;= 1 &amp;&amp; f1(q[t], q[t - 1]) &gt; a[i] * f2(q[t], q[t - 1]); --t);\n            f[j][i] = f[j - 1][q[t]] + (i - q[t]) * a[i];\n            for (; t &gt;= 1 &amp;&amp; f1(i, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(i, q[t]); --t);\n            q[++t] = i;\n        &#125;\n    &#125;\n    auto res(inf);\n    for (int i = m; i &lt;= n; ++i)\n        res = std::min(res, f[m][i]);\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---traka\">C - TRAKA</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7747\" class=\"uri\">https://www.luogu.com.cn/problem/P7747</a></p>\n<p>ç¨å¾®æ‰‹ç©ä¸€ä¸‹å°±å¯ä»¥å‘ç°ï¼Œå‡å¦‚ç¬¬ <span class=\"math inline\">\\(j\\)</span> ä¸ªäººåœ¨ç¬¬ <span class=\"math inline\">\\(i\\)</span> æ¬¡çš„å·¥ä½œæ—¶é—´ä¸º <span class=\"math inline\">\\([L_{j,i},R_{j,i}]\\)</span>ï¼Œç¬¬ <span class=\"math inline\">\\(i-1\\)</span> æ¬¡ä¸º <span class=\"math inline\">\\([L_{j,i-1},R_{j,i-1}]\\)</span>ï¼Œé‚£ä¹ˆè¦æ±‚ <span class=\"math inline\">\\(L_{j,i}\\ge R_{j,i-1}\\)</span>ã€‚</p>\n<p>ä»¤ <span class=\"math inline\">\\(s_j\\)</span> ä¸º <span class=\"math inline\">\\(t\\)</span> çš„å‰ç¼€å’Œã€‚å‡è®¾ç¬¬ <span class=\"math inline\">\\(i-1\\)</span> æ¬¡åŠ å·¥äº <span class=\"math inline\">\\(x_{i-1}\\)</span> å¼€å§‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠä¸Šå¼è½¬å†™ä¸º <span class=\"math inline\">\\(x_{i}+s_{j-1}\\times f_{i}\\ge x_{i-1}+s_j\\times f_{i-1}\\)</span>ã€‚ä¹Ÿå³ <span class=\"math inline\">\\(x_i-x_{i-1}\\ge s_j\\times f_{i-1}-s_{j-1}\\times f_i\\)</span>ã€‚</p>\n<p>æ˜¾ç„¶éœ€è¦æ‰¾åˆ°ä¸€ä¸ª <span class=\"math inline\">\\(j\\)</span> ä½¿å¾— RSH å–å¾—æœ€å¤§å€¼ï¼›ç°åœ¨å°±å¯ä»¥è€ƒè™‘æ–œç‡ä¼˜åŒ–äº†ã€‚ç”±äºæ‰€æœ‰é¡¹éƒ½å’Œ <span class=\"math inline\">\\(i\\)</span> æœ‰å…³ï¼Œæƒ³åˆ°ä¸¤è¾¹åŒé™¤ <span class=\"math inline\">\\(f_{i}\\)</span> æ¶ˆæ‰ä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span> æœ‰å…³çš„ç³»æ•°ï¼Œæœ€ååŒ–å‡ºæ¥çš„æ–œä¼˜å½¢å¼æ˜¯ <span class=\"math inline\">\\(\\dfrac {s_A-s_B}{s_{A-1}-s_{B-1}}&gt;\\dfrac {f_{i-1}}{f_i}\\)</span>ã€‚ç”±äº RSH ä¸å•è°ƒï¼ŒæŠŠæ‰€æœ‰ <span class=\"math inline\">\\(j\\)</span> å¡åˆ°é˜Ÿåˆ—é‡Œç»´æŠ¤é€’å‡æ–œç‡ï¼Œæ‰“äºŒåˆ†å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;long long&gt; a(n + 1), w(m + 1), s(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], s[i] = s[i - 1] + a[i];\n    for (int i = 1; i &lt;= m; ++i)\n        std::cin &gt;&gt; w[i];\n    std::vector&lt;long long&gt; f(m + 1);\n    std::vector&lt;int&gt; q(n + 1);\n    int h = 0, t = -1;\n    q[++t] = 1;\n    for (int i = 2; i &lt;= n; ++i) &#123;\n        for (; h &lt; t &amp;&amp; (s[i] - s[q[t]]) * (s[q[t] - 1] - s[q[t - 1] - 1]) &gt; (s[q[t]] - s[q[t - 1]]) * (s[i - 1] - s[q[t] - 1]); --t);\n        q[++t] = i;\n    &#125;\n    for (int i = 2; i &lt;= m; ++i) &#123;\n        int to = q[h];\n        for (int l = h + 1, r = t, mid; l &lt;= r; ) &#123;\n            mid = (l + r) &gt;&gt; 1;\n            if ((s[q[mid]] - s[q[mid - 1]]) * w[i - 1] &gt; w[i] * (s[q[mid] - 1] - s[q[mid - 1] - 1]))\n                to = q[mid], l = mid + 1;\n            else\n                r = mid - 1;\n        &#125;\n        f[i] = f[i - 1] + s[to] * w[i - 1] - s[to - 1] * w[i];\n    &#125;\n    std::cout &lt;&lt; f[m] + w[m] * s[n] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---æŸ æª¬\">D - æŸ æª¬</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P5504\" class=\"uri\">https://www.luogu.com.cn/problem/P5504</a></p>\n<ul>\n<li>è§‚å¯Ÿé›¶ï¼šåŸé—®é¢˜ã€ä»ä¸¤ç«¯å–ã€å¯ä»¥è½¬åŒ–ä¸ºåˆ†æ®µé—®é¢˜ï¼Œæ•…ä»å…¶ä¸­ä¸€ç«¯è€ƒè™‘å³å¯ã€‚</li>\n<li>è§‚å¯Ÿä¸€ï¼šè‹¥æœ‰ä¸€æ®µè¿ç»­çš„ <span class=\"math inline\">\\(x\\)</span>ï¼Œå®Œæ•´çš„æ¯”æ‹†å¼€çš„æ›´ä¼˜ã€‚</li>\n<li>è§‚å¯ŸäºŒï¼šå¦‚æœä¸€æ®µ <span class=\"math inline\">\\(x\\)</span> ä¸­å¤¹æ‚äº†ä¸€äº›å…¶ä»–å…ƒç´ ï¼Œé‚£ä¹ˆåœ¨å“ªé‡Œåˆ†æ®µæ˜¯è¯´ä¸å‡†çš„ã€‚</li>\n<li>è§‚å¯Ÿä¸‰ï¼šå¦‚æœé€‰å–çš„åŒºé—´æ˜¯ <span class=\"math inline\">\\([1,r]\\)</span>ï¼Œé‚£ä¹ˆè´ªå¿ƒåœ°æƒ³ï¼Œ<span class=\"math inline\">\\(a_r\\)</span> ä¸€å®šæ˜¯å…³é”®å€¼ï¼Œä¸ç„¶å– <span class=\"math inline\">\\(a_r\\)</span> å°±æµªè´¹äº†ã€‚</li>\n<li>è§‚å¯Ÿå››ï¼šå¦‚æœé€‰å–çš„åŒºé—´æ˜¯ <span class=\"math inline\">\\([l,r]\\)</span>ï¼Œé‚£ä¹ˆç”±è§‚å¯Ÿå››ï¼Œ<span class=\"math inline\">\\(a_l=a_r\\)</span>ï¼Œä¸”è¯¥å€¼ä¸ºå…³é”®å€¼ã€‚</li>\n</ul>\n<p>ç»“åˆè¿™å‡ ä¸ªè§‚å¯Ÿï¼Œä»¤ <span class=\"math inline\">\\(c_i\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(a_i\\)</span> åœ¨ <span class=\"math inline\">\\([1,i]\\)</span> ä¸­å‡ºç°æ¬¡æ•°ï¼Œ<span class=\"math inline\">\\(f_i\\)</span> è¡¨ç¤ºè¿™ä¸€æ®µä»¥ <span class=\"math inline\">\\(i\\)</span> ç»“å°¾çš„æœ€å¤§ä»·å€¼ï¼š</p>\n<p><span class=\"math display\">\\[\n\\begin{aligned}\nf_i&amp;=\\max\\limits_{j&lt;i,a_{j+1}=a_i}\\{f_j+a_i\\times (c_i-c_{j + 1} + 1)^2\\}\\\\\n&amp;=\\max\\limits_{j&lt;i,a_{j+1}=a_i}\\{f_j+a_{j+1}\\times {c_{j+1}}^2-2\\times c_i\\times a_{j+1}\\times c_{j+1}-2\\times c_{j+1}\\times a_{j+1}\\}+a_i\\times(c_i-1)^2\n\\end{aligned}\n\\]</span></p>\n<p>ï¼ˆæ€ä¹ˆè¿™ä¹ˆå¤§ä¸€å †ã€‚ï¼‰æœ€åå¯ä»¥åŒ–å‡º <span class=\"math inline\">\\(\\dfrac {f_A-f_B+a_{A+1}\\cdot c_{A+1}\\cdot (c_{A+1}-2)-a_{B+1}\\cdot c_{B+1}\\cdot (c_{B+1}-2)}{2(c_{A+1} - c_{B+1})}&gt;c_i\\times a_i\\)</span>ã€‚å‘ç°å¯¹äºæ¯ä¸€ç§ <span class=\"math inline\">\\(a_i\\)</span>ï¼Œ<span class=\"math inline\">\\(c_i\\times a_i\\)</span> æ˜¯å•å¢çš„ã€‚å•è°ƒæ ˆç»´æŠ¤å³å¯ã€‚</p>\n<p><em>è¿™å…¶å®æé†’æˆ‘ä»¬å…³äºä»£æ¢çš„é—®é¢˜â€”â€”æ˜¾ç„¶ï¼Œå½“ä¸ <span class=\"math inline\">\\(i\\)</span> çš„é¡¹ã€ä¸ <span class=\"math inline\">\\(j\\)</span> æœ‰å…³çš„é¡¹ä¹‹é—´å­˜åœ¨ä»£æ¢å…³ç³»æ—¶ï¼Œåº”è¯¥å°½é‡å¾€ <span class=\"math inline\">\\(j\\)</span> çš„æ–¹å‘é ã€‚</em></p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;7.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;long long&gt; a(n + 1), c(n + 1), la(10001);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        c[i] = c[la[a[i]]] + 1, la[a[i]] = i;\n    &#125;\n    std::vector&lt;long long&gt; f(n + 1);\n    std::vector&lt;int&gt; _t(10001, -1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; _q(10001);\n    auto f1 = [&amp;](int A, int B) &#123;\n        return f[A] - f[B] + a[A + 1] * c[A + 1] * (c[A + 1] - 2) - a[B + 1] * c[B + 1] * (c[B + 1] - 2);\n    &#125;;\n    auto f2 = [&amp;](int A, int B) &#123;\n        return 2 * (c[A + 1] - c[B + 1]);\n    &#125;;\n    ++_t[a[1]], _q[a[1]].push_back(0);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        &#123;\n            auto &amp;t = _t[a[i]];\n            auto &amp;q = _q[a[i]];\n            for (; t &gt;= 1 &amp;&amp; f1(q[t], q[t - 1]) &lt; c[i] * a[i] * f2(q[t], q[t - 1]); --t);\n            f[i] = f[q[t]] + a[i] * (c[i] - c[q[t] + 1] + 1) * (c[i] - c[q[t] + 1] + 1);\n        &#125;\n        if (i &lt; n) &#123;\n            auto &amp;t = _t[a[i + 1]];\n            auto &amp;q = _q[a[i + 1]];\n            for (; t &gt;= 1 &amp;&amp; f1(i, q[t]) * f2(q[t], q[t - 1]) &gt; f1(q[t], q[t - 1]) * f2(i, q[t]); --t);\n            q.resize(++t + 1), q[t] = i;\n        &#125;\n    &#125;\n    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---knapsack-with-diminishing-values\">E - Knapsack with Diminishing Values</h2>\n<p><a href=\"https://atcoder.jp/contests/abc373/tasks/abc373_f\" class=\"uri\">https://atcoder.jp/contests/abc373/tasks/abc373_f</a></p>\n<p>å‘ç°å’Œ <a href=\"/20250707-1/#ä¾‹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…\">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…</a> æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚</p>\n<p>ä¸å¦¨ä»¤ <span class=\"math inline\">\\(v_i\\)</span> è¡¨ç¤ºä½“ç§¯ï¼Œ<span class=\"math inline\">\\(w_i\\)</span> è¡¨ç¤ºä»·å€¼ã€‚å¯¹äºæ¯ä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼ŒæŠŠæ‰€æœ‰ä½“ç§¯æŒ‰æ¨¡ <span class=\"math inline\">\\(v_i\\)</span> çš„ä½™æ•°åˆ†ç±»ï¼Œè®¾ä¸º <span class=\"math inline\">\\(j\\cdot v_i+x\\)</span>ã€‚å¯¹äº <span class=\"math inline\">\\(k\\cdot v_i+x\\)</span>ï¼Œæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\n\\begin{aligned}\nf_{i,j\\cdot v_i+x}&amp;=\\max\\limits_{k&lt;j}\\{f_{i-1,k\\cdot v_i+x}+(j-k)\\cdot w_i-(j-k)^2\\}\\\\\n&amp;=\\max\\limits_{k&lt;j}\\{f_{i-1,k\\cdot v_i+x}-k\\cdot w_i-k^2+2\\times j\\times k\\}-j^2+j\\cdot w_i\n\\end{aligned}\n\\]</span></p>\n<p>åˆ™å¾—åˆ° <span class=\"math inline\">\\(\\dfrac {f_{i-1,A\\cdot v_i+x}-f_{i-1,B\\cdot v_i+x}+(B-A)\\cdot w_i - A^2+B^2}{2(B-A)}&lt;j\\)</span>ã€‚æ³¨æ„åˆ†æ¯ä¸ºè´Ÿã€‚æ€»ä¹‹å•è°ƒé˜Ÿåˆ—ç»´æŠ¤é€’å¢æ–œç‡å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;long long&gt; v(n + 1), w(n + 1);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (m + 1));\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; v[i] &gt;&gt; w[i];\n        for (int x = 0; x &lt; v[i]; ++x) &#123;\n            int h = 0, t = -1;\n            std::vector&lt;int&gt; q;\n            auto f1 = [&amp;](int A, int B) &#123;\n                return f[i - 1][A * v[i] + x] - f[i - 1][B * v[i] + x] + (B - A) * w[i] - A * A + B * B;\n            &#125;;\n            auto f2 = [&amp;](int A, int B) &#123;\n                return 2 * (B - A);\n            &#125;;\n            for (int j = 0, J = x; J &lt;= m; ++j, J += v[i]) &#123;\n                for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &gt; j * f2(q[h + 1], q[h]); ++h);\n                f[i][J] = f[i - 1][J];\n                if (h &lt;= t)\n                    f[i][J] = std::max(f[i][J], f[i - 1][q[h] * v[i] + x] + (j - q[h]) * w[i] - (j - q[h]) * (j - q[h]));\n                for (; h &lt; t &amp;&amp; f1(j, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(j, q[t]); --t);\n                q.resize(++t + 1), q[t] = j;\n            &#125;\n        &#125;\n    &#125;\n    std::cout &lt;&lt; f[n][m] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"f---managing-telephone-poles\">F - Managing Telephone Poles</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1575/M\" class=\"uri\">https://codeforces.com/problemset/problem/1575/M</a></p>\n<p>ï¼Ÿè§‚å¯Ÿåˆ°æ€§è´¨ç„¶åè¢«è‡ªå·±å¿½ç•¥äº†ã€‚éå¸¸å€¼å¾—æ‰¹è¯„ã€‚</p>\n<p>ä¸éš¾å†™å‡ºç±»ä¼¼æ–œç‡ä¼˜åŒ–çš„å¼å­ <span class=\"math inline\">\\(S(i,j)=\\min\\{ {x_k}^2-2\\times i\\times x_k+{y_k}^2-2\\times j \\times y_k\\}+i^2+j^2\\)</span>ã€‚</p>\n<p>ä¼šä¸‹æ„è¯†å°è¯•å›ºå®š <span class=\"math inline\">\\(i\\)</span>ï¼Œå°±å¯ä»¥ <span class=\"math inline\">\\(O(n^2m)\\)</span> å®Œæˆä»»åŠ¡ï¼Œä¼¼ä¹ä¸å¤ªè¡Œã€‚é¡ºç€è¿™ä¸ªæƒ³æ³•ä¼šè§‚å¯Ÿåˆ°ï¼Œå›ºå®š <span class=\"math inline\">\\(i\\)</span> ä¹‹åï¼Œæ¯ä¸€åˆ—çš„ poles ä¸­åªæœ‰å’Œç¬¬ <span class=\"math inline\">\\(i\\)</span> è¡Œæœ€è¿‘çš„æ‰ä¼šæœ‰è´¡çŒ®ã€‚</p>\n<p>è¿™ä¸ªæ˜¯å¥½åšçš„ï¼Œä¸”è¿™æ ·çš„ç›¸é‚»ç‚¹æ•°é‡æ˜¯ <span class=\"math inline\">\\(O(m)\\)</span> çš„ï¼›äºæ˜¯å°† <span class=\"math inline\">\\(i\\)</span> è§†ä¸ºå¸¸æ•°è¿›è¡Œå˜å½¢ï¼Œè‹¥å°†æ‰€æœ‰ poles æŒ‰ <span class=\"math inline\">\\(y\\)</span> ä»å°åˆ°å¤§æ’åºå°±èƒ½å¾—åˆ°æ–œç‡å½¢å¼ <span class=\"math inline\">\\(\\dfrac { {x_A}^2-{x_B}^2+{y_A}^2-{y_B}^2-2\\times i\\times(x_A-x_B)}{2(y_A-y_B)}&lt;j\\)</span>ã€‚ç»´æŠ¤é€’å¢æ–œç‡å°±èƒ½ <span class=\"math inline\">\\(O(n^2)\\)</span> å®Œæˆé—®é¢˜ã€‚</p>\n<p>é‚£ä¹ˆæ‰¾ç›¸é‚»ç‚¹è¿™ä¸€æ­¥å¤§å¯ä»¥æ‘†çƒ‚å†™äºŒåˆ†ã€‚æ‰€ä»¥æ€»å…±æ˜¯ <span class=\"math inline\">\\(O(nm\\log m)\\)</span> çš„ã€‚</p>\n<p>ä¸è¦åƒæˆ‘ä¸€æ ·æŠŠä¸¤è¾¹æœ€è¿‘çš„éƒ½åŠ è¿›é˜Ÿåˆ—ï¼Œä¸ç„¶ä½ ä¼šæœ‰åˆ†æ¯ä¸º <span class=\"math inline\">\\(0\\)</span> çš„æ–œç‡ <img src=\"/em/hsh.gif\" /></p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m, ++n, ++m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; tag(n + 1, std::vector&lt;int&gt; (m + 1));\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(m + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        for (int j = 1; j &lt;= m; ++j) &#123;\n            char t;\n            std::cin &gt;&gt; t;\n            if (t == &#39;1&#39;)\n                g[j].push_back(i), tag[i][j] = 1;\n        &#125;\n    struct node &#123; long long x, y; &#125;;\n    auto res(0ll);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::vector&lt;node&gt; p;\n        for (int j = 1; j &lt;= m; ++j) &#123;\n            int to = std::lower_bound(g[j].begin(), g[j].end(), i) - g[j].begin();\n            if (to &lt; (int)g[j].size()) &#123;\n                p.push_back(&#123; g[j][to], j &#125;);\n                if (g[j][to] != i &amp;&amp; to != 0 &amp;&amp; g[j][to] - i &gt; i - g[j][to - 1])\n                    p.back() = &#123; g[j][to - 1], j &#125;;\n            &#125;\n            else if (to != 0)\n                p.push_back(&#123; g[j][to - 1], j &#125;);\n        &#125;\n        std::vector&lt;int&gt; q(m + 1);\n        int h = 0, t = -1;\n        auto f1 = [&amp;](node A, node B) &#123;\n            return A.x * A.x - B.x * B.x + A.y * A.y - B.y * B.y - 2 * i * (A.x - B.x);\n        &#125;;\n        auto f2 = [&amp;](node A, node B) &#123;\n            return 2 * (A.y - B.y);\n        &#125;;\n        for (int j = 0; j &lt; (int)p.size(); ++j) &#123;\n            for (; h &lt; t &amp;&amp; f1(p[j], p[q[t]]) * f2(p[q[t]], p[q[t - 1]]) &lt; f1(p[q[t]], p[q[t - 1]]) * f2(p[j], p[q[t]]); --t);\n            q[++t] = j;\n        &#125;\n        for (int j = 1; j &lt;= m; ++j) &#123;  \n            for (; h &lt; t &amp;&amp; f1(p[q[h + 1]], p[q[h]]) &lt; j * f2(p[q[h + 1]], p[q[h]]); ++h);\n            res += (p[q[h]].x - i) * (p[q[h]].x - i) + (p[q[h]].y - j) * (p[q[h]].y - j);\n        &#125;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"g---partition-game\">G - Partition Game</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1527/E\" class=\"uri\">https://codeforces.com/problemset/problem/1527/E</a></p>\n<p>å‘ç°ä¸å¤ªæ–œä¼˜ï¼Œç»ˆäºç»™æˆ‘æµ¸æ³¡äº†ä¸¤å¤©æ–œä¼˜å†…å®¹çš„å¤§è„‘åŠ äº†å‹ºæ–°çš„åº•ç‰©ã€‚</p>\n<p>ä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºç¬¬ <span class=\"math inline\">\\(i\\)</span> æ®µä»¥ <span class=\"math inline\">\\(j\\)</span> ç»“å°¾çš„æœ€å°ä»£ä»·ï¼›å¯¹ <span class=\"math inline\">\\(w\\)</span> å¥—ç”¨å››è¾¹å½¢ä¸ç­‰å¼å˜å¼ <span class=\"math inline\">\\(w(l-1,r+1)+w(l,r)\\ge w(l-1,r)+w(l,r+1)\\)</span> å‘ç°æˆç«‹ï¼ˆå…¶ä¸­å¤§å¤šæ•°æ—¶å€™èƒ½å–ç­‰ï¼›éƒ¨åˆ†ç‰¹æ®Šæƒ…å†µå–åˆ°å¤§äºå·ï¼‰ã€‚</p>\n<p>é‚£ä¹ˆå‘ç°å¯ä»¥ç”¨åˆ†æ²»ä¼˜åŒ–ã€‚å‘ç° <span class=\"math inline\">\\(w\\)</span> ä¸é‚£ä¹ˆèƒ½å¿«é€Ÿæ±‚ï¼›è¿˜æ˜¯å¥—ç”¨ <a href=\"/20250707-1/#ä¾‹yet-another-minimization-problem\">Yet Another Minimization Problem</a> ä¸­çš„æ–¹æ³•ï¼Œç”¨ç±»ä¼¼è«é˜Ÿçš„æ–¹å¼æ±‚è§£ã€‚</p>\n<p>å‘ç°è¿™ä¸ªè«é˜Ÿå¥—è·¯ä¹Ÿå¾ˆç†Ÿæ‚‰äº†ï¼Œç›´æ¥ç”¨åŒç«¯é˜Ÿåˆ—ç»´æŠ¤å³å¯ã€‚å¤æ‚åº¦ <span class=\"math inline\">\\(O(nk\\log n)\\)</span>ï¼Œçœ‹ç€ä¸å¤ªå®‰å…¨ã€‚ä½†æ³¨æ„åˆ°æˆ‘ä»¬åœ¨ 20 ä¸ªæœˆå‰çš„æäº¤ä¸­ä½¿ç”¨äº† <span class=\"math inline\">\\(O(nk\\log n)\\)</span> çš„çº¿æ®µæ ‘ï¼Œæ‰€ä»¥èƒ½è¿‡çš„å…„å¼Ÿã€‚</p>\n<details>\n<p>é‰´äº deque çš„æ—¶ç©ºå¸¸æ•°éƒ½å¤§å¾—å“äººï¼Œæ‰€ä»¥æˆ‘ç”¨é™æ€ vector æ¨¡æ‹Ÿ deque äº†ã€‚</p>\n<p>è·‘å¾—æ¯”æˆ‘ä¹‹å‰çº¿æ®µæ ‘çš„ä¸€åŠè¿˜å¿«ï¼Œå…„å¼Ÿã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; pos(n + 1);\n    std::vector&lt;int&gt; a(n + 1), _h(n + 1), _t(n + 1, -1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], pos[a[i]].push_back(i);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(m + 1, std::vector&lt;long long&gt; (n + 1, inf));\n    f[0][0] = 0ll;\n    auto w = [&amp;](int ql, int qr) &#123;\n        static int l = 1, r = 0;\n        static auto res(0ll);\n        for (; l &gt; ql; ) &#123;\n            --l;\n            auto &amp;h = _h[a[l]], &amp;t = _t[a[l]];\n            auto &amp;q = pos[a[l]];\n            if (h &lt;= t)\n                res -= q[t] - q[h];\n            res += q[t] - q[--h];\n        &#125;\n        for (; r &gt; qr; ) &#123;\n            auto &amp;h = _h[a[r]], &amp;t = _t[a[r]];\n            auto &amp;q = pos[a[r]];\n            res -= q[t--] - q[h];\n            if (h &lt;= t)\n                res += q[t] - q[h];\n            --r;\n        &#125;\n        for (; r &lt; qr; ) &#123;\n            ++r;\n            auto &amp;h = _h[a[r]], &amp;t = _t[a[r]];\n            auto &amp;q = pos[a[r]];\n            if (h &lt;= t)\n                res -= q[t] - q[h];\n            res += q[++t] - q[h];\n        &#125;\n        for (; l &lt; ql; ) &#123;\n            auto &amp;h = _h[a[l]], &amp;t = _t[a[l]];\n            auto &amp;q = pos[a[l]];\n            res -= q[t] - q[h++];\n            if (h &lt;= t)\n                res += q[t] - q[h];\n            ++l;\n        &#125;\n        return res;\n    &#125;;\n    for (int t = 1; t &lt;= m; ++t) &#123;\n        std::function&lt;void(int, int, int, int)&gt; calc = [&amp;](int l, int r, int lp, int rp) &#123;\n            if (l &gt; r)\n                return;\n            if (l == r) &#123;\n                for (int i = lp; i &lt;= rp &amp;&amp; i &lt; l; ++i)\n                    f[t][l] = std::min(f[t][l], f[t - 1][i] + w(i + 1, l));\n                return;\n            &#125;\n            int mid = (l + r) &gt;&gt; 1, p = -1;\n            for (int i = lp; i &lt;= rp &amp;&amp; i &lt; mid; ++i)\n                if (f[t - 1][i] + w(i + 1, mid) &lt; f[t][mid])\n                    f[t][mid] = f[t - 1][i] + w(i + 1, mid), p = i;\n            calc(l, mid - 1, lp, p), calc(mid + 1, r, p, rp);\n            return;\n        &#125;;\n        calc(t, n, t - 1, n - 1);\n    &#125;\n    std::cout &lt;&lt; f[m][n] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"h---battle-lemmings\">H - Battle Lemmings</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1420/E\" class=\"uri\">https://codeforces.com/problemset/problem/1420/E</a></p>\n<p>å®¹æ˜“å‘ç° <span class=\"math inline\">\\(0\\)</span> çš„æ•°ç›®ä¸å˜ï¼Œç­”æ¡ˆå°±æ˜¯ <span class=\"math inline\">\\(0\\)</span> çš„å¯¹æ•° - è¿ç»­ <span class=\"math inline\">\\(0\\)</span> çš„å¯¹æ•°ã€‚</p>\n<p>ç„¶åæœ‰ä¸€ä¸ªæˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„ trickï¼Œéšä¾¿æ‰¾ä¸€ä¸ªç›®æ ‡åºåˆ—ï¼Œé‚£ä¹ˆèŠ±è´¹çš„æ“ä½œæ¬¡æ•°å°±æ˜¯æ¯ä¸ªå¯¹åº”çš„ <span class=\"math inline\">\\(1\\)</span> çš„ä½ç½®å·®ã€‚ä»¤ <span class=\"math inline\">\\(f_{i,j,k}\\)</span> è¡¨ç¤ºç”¨äº† <span class=\"math inline\">\\(i\\)</span> æ¬¡æ“ä½œã€<span class=\"math inline\">\\(j\\)</span> ä¸ª <span class=\"math inline\">\\(1\\)</span>ã€æœ€åä¸€ä¸ª <span class=\"math inline\">\\(1\\)</span> åœ¨ <span class=\"math inline\">\\(k\\)</span> çš„æœ€å°è¿ç»­ <span class=\"math inline\">\\(0\\)</span> å¯¹æ•°ã€‚é‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\n\\begin{aligned}\nf_{i,j,k}&amp;=\\min\\limits_{p&lt;k}\\left\\{f_{i-|k-pos_j|,j-1,p}+\\dfrac {(k-p-1)(k-p-2)}2\\right\\}\\\\\n&amp;=\\min\\left\\{f_{i-|k-pos_j|,j-1,p}-k\\cdot p+\\dfrac {p(p + 2)}2\\right\\}+\\dfrac {k^2-3k+2}2\n\\end{aligned}\n\\]</span></p>\n<p>å‘ç°è¿™ä¸ªå¼å­æ˜¯ <span class=\"math inline\">\\(O(n^5)\\)</span> çš„ï¼Œè€Œä¸”çœ‹èµ·æ¥å¾ˆæ–œä¼˜ï¼ŒåŒ–ä¸ºæ–œç‡å½¢å¼ <span class=\"math inline\">\\(\\dfrac{2\\times f_A-2\\times f_B+A(A+2)-B(B+2)}{2(A-B)}&lt;k\\)</span>ã€‚ç»´æŠ¤é€’å¢æ–œç‡å°±å¯ä»¥ <span class=\"math inline\">\\(O(n^4)\\)</span> åšäº†ã€‚</p>\n<p>Tipï¼šå½“æ—¶å†™ç€å†™ç€æ„£ä½äº†ï¼Œæ¯”å¦‚è¿™ä¸ª <span class=\"math inline\">\\(i-|k-pos_j|\\)</span> ä¸æ˜¯ä¸€ç›´åœ¨åŠ¨å—ã€‚è§£å†³æ–¹æ¡ˆï¼ŸåŒæ—¶ç»´æŠ¤å¾ˆå¤šä¸ªé˜Ÿåˆ—å³å¯ã€‚</p>\n<details>\n<p>æ³¨æ„è¿˜è¦æŠŠæœ€åä¸€ä¸ª <span class=\"math inline\">\\(1\\)</span> ä¹‹åè¿ç»­ <span class=\"math inline\">\\(0\\)</span> çš„ä»£ä»·ç®—ä¸Šã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e9;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    std::vector&lt;long long&gt; pos(1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        if (a[i] == 1)\n            pos.push_back(i);\n    &#125;\n    int m = n * (n - 1) / 2;\n    std::vector&lt;std::vector&lt;std::vector&lt;long long&gt; &gt; &gt; f(pos.size(), std::vector&lt;std::vector&lt;long long&gt; &gt; (m + 1, std::vector&lt;long long&gt; (n + 1, inf)));\n    f[0][0][0] = 0ll;\n    for (int j = 1; j &lt; (int)pos.size(); ++j) &#123;\n        std::vector&lt;std::vector&lt;int&gt; &gt; _q(m + 1, std::vector&lt;int&gt; (n + 1));\n        std::vector&lt;int&gt; _h(m + 1), _t(m + 1, -1);\n        for (int k = 0; k &lt;= n; ++k)\n            for (int i = m; i &gt;= 0; --i) &#123;\n                if (i &gt;= std::abs(k - pos[j])) &#123;\n                    auto f1 = [&amp;](long long A, long long B) &#123;\n                        return 2 * f[j - 1][i - std::abs(k - pos[j])][A] - 2 * f[j - 1][i - std::abs(k - pos[j])][B] + A * (A + 2) - B * (B + 2);\n                    &#125;;\n                    auto f2 = [&amp;](long long A, long long B) &#123;\n                        return 2 * (A - B);\n                    &#125;;\n                    auto &amp;h = _h[i - std::abs(k - pos[j])], &amp;t = _t[i - std::abs(k - pos[j])];\n                    auto &amp;q = _q[i - std::abs(k - pos[j])];\n                    for (; h &lt; t &amp;&amp; f1(q[h + 1], q[h]) &lt; k * f2(q[h + 1], q[h]); ++h) &#123;&#125;\n                    if (h &lt;= t)\n                        f[j][i][k] = std::min(inf, f[j - 1][i - std::abs(k - pos[j])][q[h]] + (k - q[h] - 1) * (k - q[h] - 2) / 2);\n                &#125;\n                auto f1 = [&amp;](long long A, long long B) &#123;\n                    return 2 * f[j - 1][i][A] - 2 * f[j - 1][i][B] + A * (A + 2) - B * (B + 2);\n                &#125;;\n                auto f2 = [&amp;](long long A, long long B) &#123;\n                    return 2 * (A - B);\n                &#125;;\n                auto &amp;h = _h[i], &amp;t = _t[i];\n                auto &amp;q = _q[i];\n                for (; h &lt; t &amp;&amp; f1(k, q[t]) * f2(q[t], q[t - 1]) &lt; f1(q[t], q[t - 1]) * f2(k, q[t]); --t);\n                q[++t] = k;\n            &#125;\n    &#125;\n    auto res(-inf);\n    int cnt = n - (int)pos.size() + 1;\n    cnt = cnt * (cnt - 1) / 2;\n    for (int i = 0; i &lt;= m; ++i) &#123;\n        for (int k = 0; k &lt;= n; ++k)\n            res = std::max(res, cnt - f.back()[i][k] - (n - k) * (n - k - 1) / 2);\n        std::cout &lt;&lt; res &lt;&lt; &#39; &#39;;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a---yakiniku-restaurants\">A - Yakiniku Restaurants</h2>\n<p><a href=\"https://atcoder.jp/contests/arc067/tasks/arc067_d\" class=\"uri\">https://atcoder.jp/contests/arc067/tasks/arc067_d</a></p>\n<p>å‘ç°å›ºå®šå·¦å³ç«¯ç‚¹åï¼Œæ”¶ç›Šæ˜¯å¯ä»¥è´ªå¿ƒç®—çš„ï¼›ä¸‹æ„è¯†æƒ³åˆ°åªå›ºå®šå·¦ç«¯ç‚¹ï¼Œé‚£ä¹ˆå³ç«¯ç‚¹åº”è¯¥å°±å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ä¹‹ç±»çš„æä¸€æã€‚</p>\n<p>å…ˆæå‰æŠŠæ‰€æœ‰ä¸œè¥¿å¡åˆ°é˜Ÿåˆ—é‡Œã€‚å·¦ç«¯ç‚¹ä¸€å¼€å§‹åœ¨æœ€å³è¾¹ï¼›å¾€å·¦è¾¹åŠ¨ä¸€ä¸‹ä¹‹åï¼Œå°±å¯ä»¥æ›´æ–°æ¯ç§èœçš„é˜Ÿåˆ—ï¼›å‘ç°åœ¨æ‰€æœ‰å…ƒç´ ä¸­ä½œå†³ç­–ç‚¹çš„ä¸æ€»æ˜¯é˜Ÿå¤´ï¼›è¿™ä¸ªåœ°æ–¹ç”¨ <strong>å•è°ƒé€’å‡çš„å•è°ƒæ ˆ</strong> æ˜¯æå¥½çš„ã€‚è¿™é‡Œçš„å•è°ƒæ ˆå…¶å®å°±ç±»ä¼¼ <a href=\"/20250707-1/#ä¼˜åŒ–-dpå•è°ƒæ•°æ®ç»“æ„\">å››è¾¹å½¢ä¸ç­‰å¼ä¸­çš„å•è°ƒæ•°æ®ç»“æ„</a> äº†ã€‚</p>\n<p>ç»´æŠ¤å•è°ƒæ ˆä¸­æ¯ä¸ªå†³ç­–ç‚¹çš„å½±å“åŒºé—´ï¼›æ˜¾ç„¶æ¯ä¸ªå³ç«¯ç‚¹çš„ç­”æ¡ˆå˜åŒ–é‡ç›¸åŒï¼›ç”¨ä¸ªç±»ä¼¼äºå·®åˆ†çš„ä¸œè¥¿è®°å½•ä¸€ä¸‹å°±å¥½äº†ã€‚</p>\n<p>å¤æ‚åº¦ <span class=\"math inline\">\\(O(n^2)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;long long&gt; s(n + 1), f(n + 1);\n    for (int i = 2; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; s[i], s[i] += s[i - 1];\n        f[i] = -s[i];\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; a(n + 1, std::vector&lt;int&gt; (m + 1));\n    for (int i = 1; i &lt;= n; ++i)\n        for (int j = 1; j &lt;= m; ++j)\n            std::cin &gt;&gt; a[i][j];\n    struct node &#123; int j, l, r; &#125;;\n    std::vector&lt;std::stack&lt;node&gt; &gt; _q(m + 1);\n    auto res(-inf);\n    for (int l = n; l; --l) &#123;\n        std::vector&lt;long long&gt; d(n + 1);\n        auto add = [&amp;](int l, int r, long long v) &#123;\n            d[l] += v;\n            if (r != n)\n                d[r + 1] -= v;\n            return;\n        &#125;;\n        for (int j = 1; j &lt;= m; ++j) &#123;\n            auto &amp;q = _q[j];\n            node now = &#123; j, l, l &#125;;\n            add(l, l, a[l][j]);\n            for (; !q.empty() &amp;&amp; a[l][j] &gt;= a[q.top().l][q.top().j]; q.pop()) &#123;\n                now.r = q.top().r;\n                add(q.top().l, q.top().r, a[l][j] - a[q.top().l][q.top().j]);\n            &#125;\n            q.push(now);\n        &#125;\n        std::partial_sum(d.begin() + 1, d.end(), d.begin() + 1);\n        for (int r = l; r &lt;= n; ++r) &#123;\n            f[r] += d[r];\n            res = std::max(res, f[r] + s[l]);\n        &#125;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---jellyfish-and-miku\">B - Jellyfish and Miku</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1874/D\" class=\"uri\">https://codeforces.com/problemset/problem/1874/D</a></p>\n<p>å”‰æ•°åˆ—ã€‚å”‰æ¦‚ç»Ÿã€‚åœ¨æ•°å­¦è®²ä¹‰ä¸ŠæŠ˜ç£¨äº†æˆ‘ä¸€éä¹‹åè¿˜è¦åˆ°è¿™å„¿æ¥æŠ˜ç£¨æˆ‘ã€‚</p>\n<p>å‡è®¾å·²ç»çŸ¥é“äº† <span class=\"math inline\">\\(a\\)</span>ï¼Œè€ƒè™‘æ±‚æœŸæœ›æ­¥æ•°ã€‚è®¾ <span class=\"math inline\">\\(E_i\\)</span> ä¸ºä» <span class=\"math inline\">\\(i\\)</span> å‡ºå‘èµ°åˆ° <span class=\"math inline\">\\(n\\)</span> çš„æœŸæœ›æ­¥æ•°ã€‚é‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nE_i=\\begin{cases}\nE_1+1&amp;i=0\\\\\n0&amp;i=n\\\\\nE_i=(E_{i-1}+1)\\cdot \\dfrac {a_i}{a_{i+1}+a_i}+(E_{i+1}+1)\\cdot \\dfrac {a_{i+1}}{a_{i+1}+a_{i}}&amp;\\text{otherwise}\n\\end{cases}\n\\]</span></p>\n<p>ï¼ˆæç¤ºï¼šä»ã€<span class=\"math inline\">\\(i\\)</span> ä¸‹ä¸€æ­¥ä¼šèµ°å“ªä¸ªæ–¹å‘ã€è€ƒè™‘ã€‚ï¼‰</p>\n<p>æ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨ä½ çš„é«˜ä¸­æ•°å­¦çŸ¥è¯†è¿›è¡Œä¸€ä¸ª <span class=\"math inline\">\\(f_0\\)</span> çš„æ±‚ï¼Œï¼ˆä¸€å †è¿‡ç¨‹ï¼‰ï¼Œå¾—åˆ° <span class=\"math inline\">\\(E_0=n+2\\times \\sum\\limits_{i=1}^n\\dfrac {\\sum_{j\\le i}a_j}{a_i}\\)</span>ï¼Œç„¶åæƒ³è¦æœ€å°åŒ–è¿™ä¸ªä¸œè¥¿ã€‚</p>\n<p>ä¸å¦¨ä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºåˆ° <span class=\"math inline\">\\(i\\)</span> æ—¶å·²ç»åˆ†é…èµ°äº† <span class=\"math inline\">\\(j\\)</span> ä½“ç§¯ï¼Œ<span class=\"math inline\">\\(\\sum_{k=1}^i \\dfrac {\\sum_{l\\le k}a_l}{a_k}\\)</span> çš„æœ€å°å€¼ï¼Œæœ‰ <span class=\"math inline\">\\(f_{i,j}=\\min\\limits_{k&lt;j}\\left\\{f_{i-1,k}+\\dfrac {k}{j - k}\\right\\}\\)</span>ã€‚å‘ç°å®ƒå¤§æŠµæ˜¯æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼çš„ï¼ŒæŒ‰ç…§ <a href=\"/20250707-1/#d1d-dp-ä¼˜åŒ–\">2D/1D DP ä¼˜åŒ–çš„ç»“è®º</a>ï¼Œä»£å…¥ <span class=\"math inline\">\\(p_{i,j-1}&lt;p_{i,j}&lt;p_{i+1,j}\\)</span> å¯ä»¥ <span class=\"math inline\">\\(O(nm)\\)</span> è§£å†³é—®é¢˜ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; p(n + 1, std::vector&lt;int&gt; (m + 1));\n    std::vector&lt;std::vector&lt;long double&gt; &gt; f(n + 1, std::vector&lt;long double&gt; (m + 1, 1e18));\n    f[0][0] = 0ll;\n    for (int j = 1; j &lt;= m; ++j)\n        for (int i = std::min(j, n); i; --i) &#123;\n            int to = ((i == std::min(j, n)) ? j : std::min(p[i + 1][j], j));\n            for (int k = p[i][j - 1]; k &lt;= to; ++k)\n                if (f[i - 1][k] + k * 1. / (j - k) &lt; f[i][j])\n                    f[i][j] = f[i - 1][k] + k * 1. / (j - k), p[i][j] = k;\n            // printf(&quot;f[%d][%d] = %Lf, p = %d\\n&quot;, i, j, f[i][j], p[i][j]);\n        &#125;\n    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(10) &lt;&lt; n + 2 * f[n][m] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"cut-the-sequence\">Cut the Sequence</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P10977\" class=\"uri\">https://www.luogu.com.cn/problem/P10977</a></p>\n<h1 id=\"é€šçŸ¥åŒºé—´æœ€å€¼-ä¸æ»¡è¶³-å››è¾¹å½¢ä¸ç­‰å¼\"><mark>é€šçŸ¥ï¼šåŒºé—´æœ€å€¼ ä¸æ»¡è¶³ å››è¾¹å½¢ä¸ç­‰å¼ã€‚</mark></h1>\n<p>å…¶å®åœ¨çŒœçš„æ—¶å€™æ˜¯ä¸¾äº†åä¾‹çš„ï¼Œä½†æ˜¯å¤§è„‘èç¼©äº†æ¨ç€æ¨ç€å¿˜è®°ç¬¦å·äº† ğŸ˜…</p>\n<p>çœ‹åˆ° <span class=\"math inline\">\\(f_i=\\min\\limits_{g(i)\\le j&lt;i}\\{f_j+\\max\\{a_{j+1\\sim i}\\}\\}\\)</span> è¿™ä¸ª <span class=\"math inline\">\\(j\\)</span> çš„èŒƒå›´å…¶å®æ˜¯æœ‰ç‚¹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ„Ÿè§‰çš„ï¼Œä½†è¿™ä¸ªæœ€å¤§å€¼ä¼ ç»Ÿçš„å•è°ƒé˜Ÿåˆ—ä¸æ˜¯å¾ˆå¯åšã€‚å¯ä»¥æ³¨æ„åˆ°æœ€å¤§å€¼è¿™ä¸€é¡¹æœ‰ç‚¹ <strong>å•è°ƒé˜Ÿåˆ—</strong> åç¼€æœ€å¤§å€¼çš„æ„Ÿè§‰ï¼ˆå®é™…ä¸Šå°±æ˜¯ï¼‰ï¼›ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•æ˜¯åˆ©ç”¨è¿™ä¸ªæœ€å¤§å€¼å½±å“çš„åŒºé—´ï¼Œç»´æŠ¤ <span class=\"math inline\">\\(f\\)</span> çš„çº¿æ®µæ ‘æ¥æš´åŠ›åšã€‚</p>\n<p>å¦ä¸€ä¸ªæ¯”è¾ƒç‰›çš„åšæ³•æ˜¯å‘ç°åŒä¸€ä¸ªä¸‹æ ‡çš„ <span class=\"math inline\">\\(f\\)</span> å’Œ <span class=\"math inline\">\\(a\\)</span> çš„å…³ç³»ã€‚é¦–å…ˆéœ€è¦æ³¨æ„åˆ° <span class=\"math inline\">\\(f\\)</span> å•è°ƒä¸é™ï¼›å¯¹äºåŒä¸€ä¸ª <span class=\"math inline\">\\(a\\)</span>ï¼Œèƒ½å–åˆ°çš„ <span class=\"math inline\">\\(f\\)</span> å°±æ˜¯æœ€é å‰çš„ï¼›ç»´æŠ¤ä¸€ä¸ª <span class=\"math inline\">\\(a\\)</span> çš„å•å‡é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå…±ç”¨åŒä¸€ä¸ª <span class=\"math inline\">\\(a\\)</span> çš„å°±æ˜¯ç›¸é‚»ä¸¤ä¸ªä¸‹æ ‡ä¹‹é—´çš„éƒ¨åˆ†ï¼Œå…¶æœ€ä¼˜å†³ç­–åœ¨èƒ½å–åˆ°çš„æœ€å‰ç«¯å–å¾—ï¼›éœ€è¦æ³¨æ„åˆ°é˜Ÿåˆ—é‡Œçš„è´¡çŒ®å¹¶ä¸å•è°ƒï¼Œéœ€è¦ç”¨ä¸€ä¸ª multiset æ¥å­˜å‚¨æ‰€æœ‰è´¡çŒ®å¹¶æŸ¥æ‰¾ã€æ›´æ–°ã€‚</p>\n<p>éœ€è¦æ³¨æ„å•è°ƒé˜Ÿåˆ—é‡ŒæŸä¸ªå…ƒç´  <span class=\"math inline\">\\(f_{q_i}\\)</span> ç»“åˆçš„å…¶å®æ˜¯ <span class=\"math inline\">\\(a_{q_{i+1}}\\)</span>ã€‚è¿˜éœ€è¦æ³¨æ„é˜Ÿå¤´çš„ç»´æŠ¤ï¼Œå¯èƒ½éœ€è¦ä¸€äº›å°å·§æ€ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;1.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; a(n + 1);\n    std::vector&lt;long long&gt; s(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], s[i] = s[i - 1] + a[i];\n    int h = 0, t = -1;\n    std::multiset&lt;long long&gt; st;\n    std::vector&lt;long long&gt; f(n + 1);\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; q(n + 1);\n    q[++t] = &#123; 0, 0 &#125;, a[0] = 0x3f3f3f3f;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (; s[i] - s[q[h].second] &gt; m; ) &#123;\n            st.erase(st.find(f[q[h].second] + a[q[h + 1].first]));\n            if (++q[h].second &gt;= q[h + 1].first)\n                a[q[++h].first] = 0x3f3f3f3f;\n            else\n                st.insert(f[q[h].second] + a[q[h + 1].first]);\n        &#125;\n        for (; h &lt; t &amp;&amp; a[q[t].first] &lt;= a[i]; --t)\n            st.erase(st.find(f[q[t - 1].second] + a[q[t].first]));\n        st.insert(f[q[t].second] + a[i]), q[++t] = &#123; i, i &#125;;\n        f[i] = *st.begin();\n    &#125;\n    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "æ–œç‡ä¼˜åŒ–",
                "DP",
                "å››è¾¹å½¢ä¸ç­‰å¼"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20210214/",
            "url": "https://xsc062.netlify.app/20210214/",
            "title": "ã€æ€»ç»“ã€‘æ–œç‡ä¼˜åŒ– DP",
            "date_published": "2021-02-06T15:59:00.000Z",
            "content_html": "<p>äºæ˜¯ï¼ŒXSC062 å¼€å§‹å†™æ€»ç»“ã€‚</p>\n<h2 id=\"æ–œç‡ä¼˜åŒ–-dp\">æ–œç‡ä¼˜åŒ– DP</h2>\n<p><strong>å‰ç½®èŠå£«</strong></p>\n<p><a href=\"https://www.cnblogs.com/XSC062/p/14383610.html\">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ– DP</a></p>\n<p><strong>æ­£æ–‡</strong></p>\n<p>æˆ‘ä»¬ä»¥ä¸€é“é¢˜ä¸ºä¾‹ã€‚</p>\n<h3 id=\"æ‰“å°æ–‡ç« \"><a href=\"http://acm.hdu.edu.cn/showproblem.php?pid=3507\">æ‰“å°æ–‡ç« </a></h3>\n<p><a href=\"https://loj.ac/p/10191\">åŒå€ç»éªŒ</a> | <a href=\"https://www.acwing.com/problem/content/1096/\">ä¸‰å€ç»éªŒ</a></p>\n<h4 id=\"solution\">Solution</h4>\n<p>æ˜æ˜¾ DPã€‚</p>\n<p>é‚£ä¹ˆ DP å¼å°±æ˜¯ï¼š <span class=\"math display\">\\[\n\\begin{aligned}\nf_i&amp;=\\min\\{f_j+(s_i-s_j)^2+M\\}\n\\\\\n&amp;=\\min\\{f_j+{s_i}^2-2\\times s_i\\times s_j+{s_j}^2+M\\}\n\\\\\n&amp;=\\min\\{f_j-2\\times s_i\\times s_j+{s_j}^2\\}+{s_i}^2+M\n\\end{aligned}\n\\]</span> å…¶ä¸­ <span class=\"math inline\">\\(s\\)</span> ä¸º <span class=\"math inline\">\\(c\\)</span> çš„å‰ç¼€å’Œã€‚</p>\n<p>æ—¶é—´å¤æ‚åº¦ <span class=\"math inline\">\\(O(n^2)\\)</span>ï¼Œæ˜æ˜¾çˆ†ç‚¸ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ä¼˜åŒ–ã€‚</p>\n<p>åœ¨ä¸Šä¸€ç¯‡çš„ <a href=\"https://www.cnblogs.com/XSC062/p/14383610.html\">å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–DP</a> ä¸­ï¼Œæˆ‘ä»¬æåˆ°è¿‡ï¼Œåªæœ‰ DP å¼ä¸­çš„ä¸ <span class=\"math inline\">\\(i\\)</span> æœ‰å…³çš„é¡¹èƒ½ç›´æ¥æå‡ºæ¥æ—¶ï¼Œæˆ‘ä»¬æ‰èƒ½ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ï¼Œè€Œè¿™é‡Œçš„ <span class=\"math inline\">\\(s_i\\)</span> ä¸ <span class=\"math inline\">\\(s_j\\)</span> ç›¸ä¹˜ï¼Œæ— æ³•ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚</p>\n<p>æˆ‘ä»¬æ€è€ƒï¼Œå¯¹äº <span class=\"math inline\">\\(f_i\\)</span> æ¥è¯´ï¼Œæ— éå°±æ˜¯é€‰å‡ºæœ€ä¼˜çš„ <span class=\"math inline\">\\(j\\)</span> æ¥æ„é€ å®ƒã€‚</p>\n<p>å‡è®¾æœ‰ <span class=\"math inline\">\\(j\\)</span> ä¸ <span class=\"math inline\">\\(k\\)</span>ï¼Œå¦‚ä½•åˆ¤æ–­ <span class=\"math inline\">\\(j\\)</span> ä¸ <span class=\"math inline\">\\(k\\)</span> è°æ›´ä¼˜å‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬å…ˆé’¦å®š <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ï¼Œä¸” <span class=\"math inline\">\\(j&lt;k\\)</span>ã€‚</p>\n<p>é‚£ä¹ˆå¯ä»¥å¾—åˆ°ï¼š <span class=\"math display\">\\[\nf_j-2\\times s_i\\times s_j+{s_j}^2+{s_i}^2+M&lt;f_k-2\\times s_i\\times s_k+{s_k}^2+{s_i}^2+M\n\\]</span> åŒ–ç®€å¾—ï¼š <span class=\"math display\">\\[\nf_j-2\\times s_i\\times s_j+{s_j}^2&lt;f_k-2\\times s_i\\times s_k+{s_k}^2\n\\]</span> å†å°†<strong>åª</strong>ä¸ <span class=\"math inline\">\\(j,k\\)</span> æœ‰å…³çš„é¡¹æ”¾åˆ°å·¦è¾¹ï¼Œä¸ <span class=\"math inline\">\\(i\\)</span> æœ‰å…³çš„é¡¹æ”¾åˆ°å³è¾¹ï¼š <span class=\"math display\">\\[\nf_j-f_k+{s_j}^2-{s_k}^2&lt;2\\times s_i\\times s_j-2\\times s_i\\times s_k\n\\\\\nf_j-f_k+{s_j}^2-{s_k}^2&lt;2\\times s_i\\times(s_j-s_k)\n\\]</span> å·¦å³ä¸¤è¾¹åŒæ—¶ <span class=\"math inline\">\\(\\div\\)</span> ä¸ <span class=\"math inline\">\\(i\\)</span> æ— å…³çš„é¡¹ <span class=\"math inline\">\\(2\\times(s_j-s_k)\\)</span> ï¼š <span class=\"math display\">\\[\n\\dfrac{(f_j+{s_j}^2)-(f_k+{s_k}^2)}{(2\\times s_j)-(2\\times s_k)}&lt;s_i\n\\]</span> å¦‚æœæ»¡è¶³ä¸Šå¼ ï¼Œåˆ™ <span class=\"math inline\">\\(j&lt;k\\)</span> ä¸” <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ã€‚</p>\n<p>æ¥ä¸‹æ¥æ˜¯æ–œç‡ä¼˜åŒ–çš„é‡ç‚¹éƒ¨åˆ†ã€‚</p>\n<blockquote>\n<p>åœ¨ä¹‰åŠ¡æ•™è‚²é˜¶æ®µï¼Œå­¦ç”Ÿå­¦ä¹ äº† <a href=\"https://baike.baidu.com/item/ä¸€æ¬¡å‡½æ•°\">ä¸€æ¬¡å‡½æ•°</a>ï¼Œå®ƒçš„å‡ ä½•æ„ä¹‰è¡¨ç¤ºä¸ºä¸€æ¡ç›´çº¿ï¼Œä¸€æ¬¡é¡¹çš„ç³»æ•°å°±æ˜¯ç›´çº¿çš„æ–œç‡ï¼Œåªä¸è¿‡å½“ç›´çº¿ä¸ <span class=\"math inline\">\\(x\\)</span> è½´å‚ç›´çš„æ—¶å€™æ— æ³•è¡¨ç¤ºã€‚è™½ç„¶æ²¡æœ‰æ˜ç¡®ç»™å‡ºæ–œç‡è¿™ä¸ªåè¯ï¼Œä½†å®é™…ä¸Šæ€æƒ³å·²ç»æ¸—é€åˆ°å…¶ä¸­ã€‚</p>\n<p>ç›´çº¿å¯¹ <span class=\"math inline\">\\(x\\)</span> è½´çš„å€¾æ–œè§’ <span class=\"math inline\">\\(\\alpha\\)</span> çš„æ­£åˆ‡å€¼ <span class=\"math inline\">\\(\\tan\\alpha\\)</span> ç§°ä¸ºè¯¥ç›´çº¿çš„â€œæ–œç‡â€ï¼Œå¹¶è®°ä½œ <span class=\"math inline\">\\(k\\)</span> ï¼Œå…¬å¼ä¸º <span class=\"math inline\">\\(k=\\tan\\alpha\\)</span>ã€‚</p>\n<p>å³ <span class=\"math inline\">\\(k=\\tan\\alpha=\\dfrac{\\Delta y}{\\Delta x}=\\dfrac{y_2-y_1}{x_2-x_1}\\)</span> æˆ– <span class=\"math inline\">\\(\\dfrac{y_1-y_2}{x_1-x_2}\\)</span> ã€‚</p>\n<p align=\"right\">\nâ€”â€”é€‰è‡ª <a href=\"https://baike.baidu.com/item/%E6%96%9C%E7%8E%87/4914111?fr=aladdin\">æ–œç‡_ç™¾åº¦ç™¾ç§‘</a>\n</p>\n</blockquote>\n<p>XSC062 çœ‹å®Œäº†ç™¾åº¦ç™¾ç§‘è¡¨ç¤º <del>ä½  TM åœ¨è¯´äº›å•¥æ˜¯ä¸æ˜¯æ¬ºè´Ÿæˆ‘å…­å¹´ä¹‰åŠ¡æ•™è‚²çš„å°å­¦ç”Ÿ</del> æç„¶å¤§æ‚Ÿ</p>\n<p>ä¸Šé¢æ¨å‡ºæ¥çš„é‚£ä¸ªå…³äº <span class=\"math inline\">\\(j\\)</span> å’Œ <span class=\"math inline\">\\(k\\)</span> çš„DPå¼ï¼Œä¸å°±æ˜¯æ±‚ä¸¤ä¸ªç‚¹ <span class=\"math inline\">\\((2\\times s_j,f_j+{s_j}^2)\\)</span> å’Œ <span class=\"math inline\">\\((2\\times s_k,f_j+{s_k}^2)\\)</span> è¿æˆä¸€æ¡çº¿ä¹‹åçš„å¡åº¦å—ï¼Ÿ</p>\n<p>æœ¬æ–‡åé¢çš„éƒ¨åˆ†ï¼Œ<span class=\"math inline\">\\(x\\)</span> çš„å«ä¹‰ä¼šåœ¨ã€Œç‚¹<span class=\"math inline\">\\((2\\times s_x,f_x+{s_x}^2)\\)</span> ã€å’Œã€Œä¸‹æ ‡ <span class=\"math inline\">\\(x\\)</span> ã€ä¹‹é—´æ¼‚æµ®ï¼Œè¯·æ ¹æ®è¯­å¢ƒè¯†åˆ«ã€‚</p>\n<p>éšå XSC062 è¾¹æ‰“çŒç¡è¾¹å¬ GM è®²è¯¾ï¼ˆç‰¹å¼‚åŠŸèƒ½ï¼‰ï¼Œå‹‰å¼ºç®—æ˜¯æ˜ç™½äº†ä¸­å¿ƒæ„æ€ï¼š</p>\n<p>å¦‚å›¾ï¼Œå‡è®¾æœ‰ä¸‰ä¸ªç‚¹ <span class=\"math inline\">\\(A,B,C\\)</span>ï¼Œä»¥åŠ <span class=\"math inline\">\\(l_{AB}\\)</span> çš„æ–œç‡ <span class=\"math inline\">\\(k_1\\)</span>ï¼Œ<span class=\"math inline\">\\(l_{BC}\\)</span> çš„æ–œç‡ <span class=\"math inline\">\\(k_2\\)</span>ã€‚</p>\n<figure>\n<img src=\"https://img-blog.csdnimg.cn/img_convert/3bc5fea553ad6b06229ef9e9fa4c9664.png\" alt=\"ä¸Šå‡¸\" /><figcaption>ä¸Šå‡¸</figcaption>\n</figure>\n<p>æˆ‘ä»¬æš‚ä¸”æŠŠè¿™ä¸ªå‘å¤–å‡¸èµ·çš„å¥‡æ€ªç©æ„å„¿ç§°ä¸ºä¸€ä¸ªã€Œä¸Šå‡¸ã€ã€‚</p>\n<p>å›åˆ°å‰é¢çš„æˆ‘ä»¬å¾—åˆ°çš„é‚£ä¸ªç»“è®ºï¼š</p>\n<blockquote>\n<p><span class=\"math display\">\\[\n\\dfrac{(f_j+{s_j}^2)-(f_k+{s_k}^2)}{(2\\times s_j)-(2\\times s_k)}&lt;s_i\n\\]</span></p>\n<p>å¦‚æœæ»¡è¶³ä¸Šå¼ ï¼Œåˆ™ <span class=\"math inline\">\\(j&lt;k\\)</span> ä¸” <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ã€‚</p>\n</blockquote>\n<p>ç®€å•è®°å¿†ä¸ºï¼š</p>\n<ul>\n<li>è‹¥ <span class=\"math inline\">\\(l_{NM}\\)</span> çš„æ–œç‡æ¯” <span class=\"math inline\">\\(s_i\\)</span> å°ï¼Œåˆ™ <span class=\"math inline\">\\(N&lt;M\\)</span> ä¸” <span class=\"math inline\">\\(N\\)</span> ä¼˜äº <span class=\"math inline\">\\(M\\)</span> ã€‚</li>\n<li>åä¹‹ï¼Œè‹¥ç‚¹ <span class=\"math inline\">\\(l_{NM}\\)</span> çš„æ–œç‡æ¯” <span class=\"math inline\">\\(s_i\\)</span> å¤§ï¼Œåˆ™ <span class=\"math inline\">\\(M&lt;N\\)</span> ä¸” <span class=\"math inline\">\\(M\\)</span> ä¼˜äº <span class=\"math inline\">\\(N\\)</span>ã€‚</li>\n</ul>\n<p>å°† <span class=\"math inline\">\\(A,B\\)</span> ä»£å…¥ï¼Œæˆ‘ä»¬å¾—çŸ¥ï¼š</p>\n<ol type=\"1\">\n<li>è‹¥ <span class=\"math inline\">\\(k_1\\leqslant s_i\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(A\\)</span>ã€‚</li>\n<li>è‹¥ <span class=\"math inline\">\\(k_1&gt;s_i\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(A\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ã€‚</li>\n<li>è‹¥ <span class=\"math inline\">\\(k_2\\leqslant s_i\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(C\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ã€‚</li>\n<li>è‹¥ <span class=\"math inline\">\\(k_2&gt;s_i\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(C\\)</span>ã€‚</li>\n</ol>\n<p>å› ä¸ºæ–œç‡ = å€¾æ–œåº¦ = ç«–å¾—æœ‰å¤šé«˜ï¼Œæ˜æ˜¾ <span class=\"math inline\">\\(k_1&gt;k_2\\)</span>ã€‚æ‰€ä»¥é’ˆå¯¹ä¸€ä¸ªå¤§å°å…³ç³»ï¼Œ<span class=\"math inline\">\\(k_1\\)</span> å’Œ <span class=\"math inline\">\\(k_2\\)</span> ä¹‹é—´åªæœ‰å¯èƒ½æœ‰ï¼š</p>\n<ol type=\"1\">\n<li><span class=\"math inline\">\\(s_i&lt;k_2&lt;k_1\\)</span>ï¼Œæ­¤æ—¶ <span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(C\\)</span>ï¼Œ<span class=\"math inline\">\\(A\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ï¼Œ<span class=\"math inline\">\\(A\\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li>\n<li><span class=\"math inline\">\\(k_2&lt;s_i&lt;k_1\\)</span>ï¼Œæ­¤æ—¶ <span class=\"math inline\">\\(C\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ï¼Œ<span class=\"math inline\">\\(A\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ï¼Œ<span class=\"math inline\">\\(A,C\\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li>\n<li><span class=\"math inline\">\\(k_2&lt;k_1&lt;s_i\\)</span>ï¼Œæ­¤æ—¶ <span class=\"math inline\">\\(C\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ï¼Œ<span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(A\\)</span>ï¼Œ<span class=\"math inline\">\\(C\\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li>\n</ol>\n<p>å‘ç°äº†å—ï¼Ÿ<span class=\"math inline\">\\(B\\)</span> æ°¸è¿œéƒ½ä¸å¯èƒ½æ˜¯æœ€ä¼˜è§£ã€‚</p>\n<p>æ‰€ä»¥å¦‚æœæˆ‘ä»¬è¦ç»´æŠ¤ä¸€ä¸ªæœ€ä¼˜è§£çš„åºåˆ—ï¼Œå°±å¯ä»¥ä¸è¦ <span class=\"math inline\">\\(B\\)</span> äº†ã€‚</p>\n<figure>\n<img src=\"0.png\" alt=\"ä¸Šå‡¸\" /><figcaption>ä¸Šå‡¸</figcaption>\n</figure>\n<p>é‚£ä¹ˆï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»åˆ æ‰äº†æ‰€æœ‰ã€Œä¸Šå‡¸ã€çš„çªèµ·éƒ¨åˆ†ï¼Œæ‰€ä»¥è¿™ä¸ªæœ€ä¼˜è§£åºåˆ—é‡Œè‚¯å®šä¸ä¼šå†å­˜åœ¨ã€Œä¸Šå‡¸ã€äº†ã€‚</p>\n<p>å¦‚æœæ˜¯è¿™æ ·çš„ã€Œä¸‹å‡¸ã€å‘¢ï¼Ÿ</p>\n<figure>\n<img src=\"1.png\" alt=\"ä¸‹å‡¸\" /><figcaption>ä¸‹å‡¸</figcaption>\n</figure>\n<p><span class=\"math inline\">\\(k_1\\)</span> ä¸º <span class=\"math inline\">\\(l_{AB}\\)</span> çš„æ–œç‡ï¼Œ<span class=\"math inline\">\\(k_2\\)</span> ä¸º <span class=\"math inline\">\\(l_{BC}\\)</span> çš„æ–œç‡ã€‚</p>\n<p>å°† <span class=\"math inline\">\\(A,B\\)</span> ä»£å…¥ï¼Œæˆ‘ä»¬å¾—çŸ¥ï¼š</p>\n<ol type=\"1\">\n<li>è‹¥ <span class=\"math inline\">\\(k_1\\leqslant s_i\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(A\\)</span>ã€‚</li>\n<li>è‹¥ <span class=\"math inline\">\\(k_1&gt;s_i\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(A\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ã€‚</li>\n<li>è‹¥ <span class=\"math inline\">\\(k_2\\leqslant s_i\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(C\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ã€‚</li>\n<li>è‹¥ <span class=\"math inline\">\\(k_2&gt;s_i\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(C\\)</span>ã€‚</li>\n</ol>\n<p>æ˜æ˜¾ <span class=\"math inline\">\\(k_1&lt;k_2\\)</span>ã€‚æ‰€ä»¥ <span class=\"math inline\">\\(k_1\\)</span> å’Œ <span class=\"math inline\">\\(k_2\\)</span> ä¹‹é—´åªæœ‰å¯èƒ½æœ‰ï¼š</p>\n<ol type=\"1\">\n<li><span class=\"math inline\">\\(s_i&lt;k_1&lt;k_2\\)</span>ï¼Œæ­¤æ—¶ <span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(C\\)</span>ï¼Œ<span class=\"math inline\">\\(A\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ï¼Œ<span class=\"math inline\">\\(A\\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li>\n<li><span class=\"math inline\">\\(k_1&lt;s_i&lt;k_2\\)</span>ï¼Œæ­¤æ—¶ <span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(C\\)</span>ï¼Œ<span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(A\\)</span>ï¼Œ<span class=\"math inline\">\\(B\\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li>\n<li><span class=\"math inline\">\\(k_1&lt;k_2&lt;s_i\\)</span>ï¼Œæ­¤æ—¶ <span class=\"math inline\">\\(C\\)</span> ä¼˜äº <span class=\"math inline\">\\(B\\)</span>ï¼Œ<span class=\"math inline\">\\(B\\)</span> ä¼˜äº <span class=\"math inline\">\\(A\\)</span>ï¼Œ<span class=\"math inline\">\\(C\\)</span> ä¸ºæœ€ä¼˜è§£ã€‚</li>\n</ol>\n<p>æ‰€ä»¥ï¼Œåœ¨ä¸‹å‡¸çš„æƒ…å†µä¸­ï¼Œä¸‰ä¸ªç‚¹éƒ½æœ‰å¯èƒ½æ˜¯æœ€ä¼˜è§£ï¼Œéƒ½éœ€è¦ä¿ç•™ã€‚</p>\n<p>ç°åœ¨å‘¢ï¼Œæ‰€æœ‰ä¸Šå‡¸éƒ½è¢«å»æ‰äº†ï¼Œåªå‰©ä¸‹å‡¸ï¼Œæ‰€ä»¥å¤§æ¦‚æœ€åçš„æœ€ä¼˜è§£åºåˆ—å°±é•¿è¿™ä¸ªæ ·å­ï¼š</p>\n<figure>\n<img src=\"2.png\" alt=\"ä¸‹å‡¸åŒ…\" /><figcaption>ä¸‹å‡¸åŒ…</figcaption>\n</figure>\n<p><del>ä¸‹ ç§ƒ åŒ…</del></p>\n<p><del>åè¿‡æ¥çœ‹å°±æ˜¯ lifan çš„è„‘è¢‹äº†</del></p>\n<p>è§‚å¯Ÿå‘ç°ï¼Œæ–œç‡æ˜¯ä»å·¦å¾€å³é€’å¢çš„ã€‚</p>\n<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬è€ƒè™‘ç”¨å•è°ƒé˜Ÿåˆ—æ¥å½“è¿™ä¸ªã€Œæœ€ä¼˜è§£åºåˆ—ã€ã€‚</p>\n<h5 id=\"ç»´æŠ¤é˜Ÿå¤´\">ç»´æŠ¤é˜Ÿå¤´</h5>\n<p>å³ä¿è¯é˜Ÿå¤´å…ƒç´ ä¸ºæœ€ä¼˜è§£ã€‚</p>\n<p>è®¾é˜Ÿå¤´ä¸º <span class=\"math inline\">\\(q_l\\)</span>ã€‚</p>\n<p>å¦‚æœ <span class=\"math inline\">\\(q_{l+1}\\)</span> ä¸ <span class=\"math inline\">\\(q_l\\)</span> å½¢æˆçš„æ–œç‡ <span class=\"math inline\">\\(\\leqslant s_i\\)</span>ï¼Œæ ¹æ®ä¸Šé¢æ¨å‡ºæ¥çš„ç©æ„å„¿ï¼Œå¾—åˆ° <span class=\"math inline\">\\(q_{l+1}\\)</span> ä¼˜äº <span class=\"math inline\">\\(q_l\\)</span>ã€‚</p>\n<p>é‚£è¿˜è¦ <span class=\"math inline\">\\(q_l\\)</span> å¹²å•¥ï¼Œç›´æ¥ <code>l++</code>ã€‚</p>\n<h5 id=\"æ›´æ–°-dp-å€¼\">æ›´æ–° DP å€¼</h5>\n<p><span class=\"math inline\">\\(f_i=f_{q_l}-2\\times s_i\\times s_{q_l}+{s_{q_l}}^2+{s_i}^2+M\\)</span></p>\n<h5 id=\"ç»´æŠ¤é˜Ÿå°¾\">ç»´æŠ¤é˜Ÿå°¾</h5>\n<p>å³ä¿è¯é‡Œé¢å¡çš„ç‚¹ç›¸é‚»ä¸¤ä¸ªçš„æ–œç‡é€’å¢ã€‚</p>\n<p>è®¾é˜Ÿå°¾ä¸º <span class=\"math inline\">\\(q_r\\)</span>ï¼Œæˆ‘ä»¬è¦å¾€æœ€ä¼˜è§£é˜Ÿåˆ—é‡Œ <code>push</code> ä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span> ã€‚</p>\n<p>è‹¥é˜Ÿå°¾ä¸¤ä¸ªç‚¹ <span class=\"math inline\">\\(q_r,q_{r-1}\\)</span> å½¢æˆçš„æ–œç‡æ¯” <span class=\"math inline\">\\(i,q_r\\)</span> å½¢æˆçš„æ–œç‡å¤§ï¼Œé‚£ä¹ˆ<code>push(i)</code>åï¼Œæ•´ä¸ªé˜Ÿåˆ—çš„æ–œç‡å°±ä¸å†å•è°ƒé€’å¢ï¼Œæ‰€ä»¥æ­¤æ—¶è¦å°†<code>r--</code>ã€‚ï¼ˆå› ä¸º <a href=\"https://www.cnblogs.com/XSC062/p/14383610.html\">ä¸Šä¸€ç¯‡å…³äºå•è°ƒé˜Ÿåˆ—çš„åšå®¢</a> ä¸­è®²åˆ°çš„ <span class=\"math inline\">\\(i\\)</span> å¿…é¡»å…¥é˜Ÿï¼Œåªèƒ½å§”å±ˆä¸€ä¸‹ <span class=\"math inline\">\\(q_r\\)</span> äº†ï¼‰</p>\n<p><strong>æ³¨æ„äº‹é¡¹</strong></p>\n<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæ–œç‡æ˜¯ä¸ªæµ®ç‚¹æ•°ã€‚ä¸ºäº†é¿å…æŸå¤±ç²¾åº¦é€ æˆçš„ä¸€äº›æƒ¨æ¡ˆï¼Œæˆ‘ä»¬äº¤å‰ç›¸ä¹˜ï¼Œå°†åˆ†å­ã€åˆ†æ¯åˆ†å¼€å¤„ç†ã€‚</p>\n<p>ä»¥åŠæ—¶åˆ»éƒ½è¦ä¿è¯é˜Ÿåˆ—ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªç‚¹ï¼Œå› ä¸ºè¦è®¿é—® <span class=\"math inline\">\\(q_l,q_{l+1}\\)</span> å’Œ <span class=\"math inline\">\\(q_r,q_{r-1}\\)</span>ã€‚</p>\n<h4 id=\"code\">Code</h4>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\nconst int maxn = 5e5 + 5;\nint n, m, l, r;\nint f[maxn], c[maxn], q[maxn];\ninline int getDP(int i, int j) &#123;\n    return f[j] + m + (c[i] - c[j]) * (c[i] - c[j]);\n&#125;\ninline int getup(int j, int k)&#123;\n    return f[j] + c[j] * c[j] - f[k] - c[k] * c[k]; // è®¡ç®—åˆ†å­çš„å€¼\n&#125;\ninline int getdown(int j, int k) &#123;\n    return (c[j] - c[k]) * 2; // è®¡ç®—åˆ†æ¯çš„å€¼\n&#125;\nint main()&#123;\n    while (~scanf(&quot;%d %d&quot;, &amp;n, &amp;m)) &#123;\n        l = r = 1; // å‡¡æ˜¯æ¶‰åŠåˆ°å‰ç¼€å’Œçš„å•è°ƒé˜Ÿåˆ—ï¼Œé˜Ÿåˆ—ä¸­å¿…é¡»å­˜åœ¨åˆå§‹ 0\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            scanf(&quot;%d&quot;, &amp;c[i]); // c è‡ªç»™è‡ªè¶³\n            c[i] += c[i - 1];\n            // # ç»´æŠ¤é˜Ÿå¤´\n            // æ³¨æ„æ­¤å¤„çš„æ¡ä»¶ä¸º l &lt; rï¼Œå› ä¸ºé˜Ÿåˆ—ä¸­è‡³å°‘éœ€è¦å­˜åœ¨ä¸¤ä¸ªç‚¹\n            while (l &lt; r &amp;&amp; getup(q[l+1], q[l]) &lt;= c[i] * getdown(q[l + 1],q[l]))\n                l++;\n            // # è½¬ç§»çŠ¶æ€\n            f[i] = getDP(i, q[l]);\n            // # ç»´æŠ¤é˜Ÿå°¾\n            while(l &lt; r&amp;&amp; getup(i, q[r]) * getdown(q[r], q[r-1]) &lt;= getup(q[r] ,q[r - 1]) * getdown(i, q[r]))\n                r--;\n            q[++r] = i;\n        &#125;\n        printf(&quot;%d\\n&quot;,f[n]);\n    &#125;\n    return 0;\n&#125;</code></pre>\n<p>åœ¨å¯¹ DP å¼å˜å½¢æ—¶ï¼Œæˆ‘ä»¬æœ€å¥½å°†å…¶åŒ–ä¸º <span class=\"math inline\">\\(\\dfrac{(j)-(k)}{(j)-(k)}&lt;x\\)</span> æˆ– <span class=\"math inline\">\\(\\dfrac{(j)-(k)}{(j)-(k)}&gt;x\\)</span> çš„å½¢å¼ã€‚</p>\n<p>è¿™ä¸ªæ¿å­åªé€‚ç”¨äºç»´æŠ¤ä¸‹å‡¸åŒ…çš„æƒ…å†µã€‚å½“ä¸­é—´çš„ç¬¦å·ä¸º <span class=\"math inline\">\\(&gt;\\)</span> æ—¶ï¼Œæˆ‘ä»¬ä¼šåœ¨è¿™ä»½ä»£ç ä¸Šç¨ä½œæ”¹åŠ¨ï¼Œç»´æŠ¤ä¸€ä¸ªä¸Šå‡¸åŒ…ï¼Œåæ–‡ä¼šæåˆ°æœ‰å…³å†…å®¹ã€‚</p>\n<hr />\n<h3 id=\"ç©å…·è£…ç®±\"><a href=\"https://www.luogu.com.cn/problem/P3195\">ç©å…·è£…ç®±</a></h3>\n<p><a href=\"https://loj.ac/p/10188\">åŒå€ç»éªŒ</a> | <a href=\"https://www.acwing.com/problem/content/1094/\">ä¸‰å€ç»éªŒ</a></p>\n<p>ä»ä»Šå¾€åæˆ‘ä»¬å°±åªè®²æ€ä¹ˆæ¨å¼å­ï¼Œä¸å†è¯æ˜ä¸‹å‡¸ç­‰æ€§è´¨äº†ã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(f_i\\)</span> è¡¨ç¤ºç¬¬ <span class=\"math inline\">\\(i\\)</span> ä¸ªç©å…·æ”¾å®Œåçš„æœ€å°è´¹ç”¨ã€‚ <span class=\"math display\">\\[\nf_i=\\min\\{f_j+(i-j-1+\\sum\\limits_{k=i}^jC_k-L)^2\\}\n\\]</span> ä¸ºäº†è®©è¿™ä¸ªå¼å­å¥½æ‹†ï¼Œæˆ‘ä»¬åœ¨ä¸€å¼€å§‹è®© <code>l++</code>ï¼Œå¹¶ä¸” <span class=\"math inline\">\\(C\\)</span> å†æ¬¡è‡ªç»™è‡ªè¶³ï¼Œä¸ºè¾“å…¥çš„ <span class=\"math inline\">\\(C\\)</span> çš„å‰ç¼€å’Œæ•°ç»„ã€‚</p>\n<p>äºæ˜¯å¼å­å°±å˜æˆï¼š <span class=\"math display\">\\[\nf_i=\\min\\{f_j+(i-j-L+C_i-C_j)^2\\}\n\\]</span> æ˜æ˜¾ç¡¬æ‹†ä¼šæ­»äººã€‚ï¼ˆåæ­£æˆ‘è¯•è¿‡ï¼Œæ¯”è¾ƒé€‚åˆç”¨æ¥å‘æ³„</p>\n<p>æ‰€ä»¥æˆ‘ä»¬æŠŠå¼å­å˜æˆè¿™æ ·ï¼š <span class=\"math display\">\\[\nf_i=\\min\\{f_j+((C_i+i)-(C_j+j)-L)^2\\}\n\\]</span> æ—¢ç„¶ <span class=\"math inline\">\\(C_i\\)</span> ä¸ <span class=\"math inline\">\\(i\\)</span>ï¼Œ<span class=\"math inline\">\\(C_j\\)</span> ä¸ <span class=\"math inline\">\\(j\\)</span> æ˜¯å¯¹åº”çš„ï¼Œé‚£ä¹ˆç›´æ¥é¢„å¤„ç†ï¼Œç»™ <span class=\"math inline\">\\(C_i\\)</span> åŠ ä¸Š <span class=\"math inline\">\\(i\\)</span> ä¸å°±è¡Œäº†ï¼Ÿ</p>\n<p>ç°åœ¨è¿™ä¸ª <span class=\"math inline\">\\(C_i\\)</span> çš„å«ä¹‰å’Œå®ç°å°±å˜å¾—æœ‰ç‚¹æ›²æŠ˜éš¾æ‡‚äº†ã€‚</p>\n<p>å…·ä½“å®ç°å¦‚ä¸‹ï¼š</p>\n<pre class=\"cpp\"><code>for (int i = 1; i &lt;= n; ++i) &#123;\n    scanf(&quot;%lld&quot;, &amp;c[i]);\n    c[i] += c[i - 1];\n&#125;\nfor (int i = 1; i &lt;= n; ++i)\n    c[i] += i;</code></pre>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<span class=\"math inline\">\\(C_i\\)</span> æ˜¯åœ¨å‰ç¼€å’Œçš„åŸºç¡€ä¸ŠåŠ äº†ä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œæ³¨æ„ä¸èƒ½æŠŠ <span class=\"math inline\">\\(i\\)</span> ä¹Ÿä¸€èµ·å‰ç¼€å’Œäº†ã€‚</p>\n<p>ç„¶åå¼å­å°±å˜æˆäº†è¿™æ ·ï¼š <span class=\"math display\">\\[\n\\begin{aligned}\nf_i&amp;=\\min\\{f_j+(C_i-C_j-L)^2\\}\n\\\\\n&amp;=\\min\\{f_j+{C_i}^2+{C_j}^2+L^2-2\\times C_i\\times C_j-2\\times C_i\\times L+2\\times C_j\\times L\\}\n\\\\\n&amp;=\\min\\{f_j+{C_j}^2-2\\times C_i\\times C_j+2\\times C_j\\times L\\}+{C_i}^2+L^2-2\\times C_i\\times L\n\\end{aligned}\n\\]</span></p>\n<p>ä»¤ <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span> ä¸” <span class=\"math inline\">\\(j&lt;k\\)</span>ã€‚</p>\n<p>å¾—ï¼š <span class=\"math display\">\\[\nf_j+{C_j}^2-2\\times C_i\\times C_j+2\\times C_j\\times L&lt;f_k+{C_k}^2-2\\times C_i\\times C_k+2\\times C_k\\times L\n\\\\\nf_j-f_k+{C_j}^2-{C_k}^2+2\\times C_j\\times L-2\\times C_k\\times L&lt;2\\times C_i\\times C_j-2\\times C_i\\times C_k\n\\\\\nf_j-f_k+{C_j}^2-{C_k}^2+2\\times C_j\\times L-2\\times C_k\\times L&lt;2\\times(C_j-C_k)\\times C_i\n\\\\\n\\dfrac{f_j-f_k+{C_j}^2-{C_k}^2}{2\\times(C_j-C_k)}&lt;C_i\n\\\\\n\\dfrac{(f_j+{C_j}^2)-(f_k+{C_k}^2)}{(2\\times C_j)-(2\\times C_k)}&lt;C_i\n\\]</span></p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#define int long long\nconst int maxn = 5e5 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint n, m, h, t;\nint c[maxn], q[maxn], f[maxn];\n#define nec getchar\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1; ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\ninline int getup(int j, int k) &#123;\n    return (f[j] + c[j] * c[j] + 2 * c[j] * m)\n           - (f[k] + c[k] * c[k] + 2 * c[k] * m);\n&#125;\ninline int getdown(int j, int k) &#123;\n    return (2 * c[j]) - (2 * c[k]);\n&#125;\ninline int getDP(int i, int j) &#123;\n    return f[j] + (c[i] - c[j] - m) * (c[i] - c[j] - m);\n&#125;\nsigned main() &#123;\n    read(n); read(m); h = t = 1; ++m;\n    for (int i = 1; i &lt;= n; ++i)\n        read(c[i]), c[i] += c[i - 1];\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        c[i] += i;\n        while (h &lt; t &amp;&amp; getup(q[h + 1], q[h]) &lt;\n               c[i] * getdown(q[h + 1], q[h])) ++h;\n        f[i] = getDP(i, q[h]);\n        while (h &lt; t\n               &amp;&amp; getup(i, q[t]) * getdown(q[t], q[t - 1]) &lt;=\n               getdown(i, q[t]) * getup(q[t], q[t - 1])) --t;\n        q[++t] = i;\n    &#125;\n    printf(&quot;%lld&quot;, f[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"ä»»åŠ¡å®‰æ’-1\"><a href=\"https://loj.ac/p/10184\">ä»»åŠ¡å®‰æ’ 1</a></h3>\n<p><a href=\"https://www.acwing.com/problem/content/302/\">åŒå€ç»éªŒ</a> | <a href=\"https://www.luogu.com.cn/problem/P2365\">ä¸‰å€ç»éªŒ</a></p>\n<p>æ„Ÿè°¢è“ä¹¦ã€‚è¿™é‡ŒæŒ‰ç€è“ä¹¦ä¸Šçš„æ€ç»´èµ°ã€‚</p>\n<h4 id=\"è§£æ³•ä¸€\">è§£æ³•ä¸€</h4>\n<p>æš´åŠ›ã€‚</p>\n<p>æ­¤å¤„çš„ <span class=\"math inline\">\\(t,c\\)</span> ä¸ºè¾“å…¥çš„ <span class=\"math inline\">\\(t,c\\)</span> çš„å‰ç¼€å’Œæ•°ç»„ã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(f_{i,j}\\)</span> ä¸ºå‰ <span class=\"math inline\">\\(i\\)</span> ä¸ªä»»åŠ¡åˆ†æˆ <span class=\"math inline\">\\(j\\)</span> æ‰¹çš„æœ€å°è´¹ç”¨ã€‚</p>\n<p>æ•… <span class=\"math inline\">\\(S\\times j+t_i\\)</span> ä¸ºç¬¬ <span class=\"math inline\">\\(i\\)</span> ä¸ªä»»åŠ¡çš„å®Œæˆæ—¶é—´ã€‚</p>\n<p>å¾—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼ˆ<span class=\"math inline\">\\(k\\)</span> æšä¸¾ä¸Šä¸€æ‰¹ä»»åŠ¡ç»“æŸä½ç½®ï¼‰ï¼š <span class=\"math display\">\\[\nf_{i,j}=\\min\\limits_{0\\leqslant k&lt;i}\\{f_{k,j-1}+(S\\times j+t_i)\\times(c_i-c_k)\\}\n\\]</span> æ—¶é—´å¤æ‚åº¦ <span class=\"math inline\">\\(O(n^3)\\)</span>ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#define int long long\nconst int inf = 1e18;\nconst int maxn = 5005;\nconst int LEN = (1 &lt;&lt; 20);\nint f[maxn][maxn];\nint n, s, ans = inf;\nint t[maxn], c[maxn];\ninline int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF; p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nsigned main() &#123;\n    read(n); read(s);\n    memset(f, 0x3f, sizeof (f));\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(t[i]); read(c[i]);\n        t[i] += t[i - 1];\n        c[i] += c[i - 1];\n        f[i][1] = (s + t[i]) * c[i]; // åˆå§‹åŒ–\n    &#125;\n    for (int i = 2; i &lt;= n; ++i) &#123;\n        for (int j = 2; j &lt;= i; ++j) &#123;\n            for (int k = 1; k &lt; i; ++k)\n                f[i][j] = min(f[i][j], f[k][j - 1] + (t[i] + s * j) * (c[i] - c[k]));\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        ans = min(ans, f[n][i]);\n    printf(&quot;%lld&quot;, ans);\n    return 0;\n&#125;</code></pre>\n<p><del>äº²æµ‹ TLE 70</del></p>\n<h4 id=\"è§£æ³•äºŒ\">è§£æ³•äºŒ</h4>\n<p>è„‘å­ç‚¸äº†ï¼Œæƒ³äº†å¥½ä¹…æ‰æƒ³æ˜ç™½è¿™ä¸ªä¼˜åŒ–çš„æ­£ç¡®æ€§ã€‚</p>\n<p>æ€è€ƒï¼Œä»¥ä¸Šä»£ç éœ€è¦ <span class=\"math inline\">\\(j\\)</span> è¿™ä¸€ç»´çš„æ ¹æœ¬åŸå› æ˜¯ä»€ä¹ˆï¼Ÿ</p>\n<p>å› ä¸ºæˆ‘ä»¬æ— æ³•ç¡®å®šä¹‹å‰å·²ç»åˆ’åˆ†äº†å¤šå°‘æ‰¹ï¼Œä¹Ÿå°±æ˜¯æ— æ³•ç¡®å®š <span class=\"math inline\">\\(S\\)</span> çš„ä¸ªæ•°ã€‚</p>\n<p>æ¢ä¸ªè§’åº¦æ€è€ƒï¼Œæˆ‘ä»¬æ— æ³•ç¡®å®šä¹‹å‰ï¼Œå´å¯ä»¥ç¡®å®šä¹‹åã€‚</p>\n<p>ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬åœ¨ä»»åŠ¡ <span class=\"math inline\">\\(i\\)</span> å¤„åˆ’åˆ†ï¼Œé‚£ä¹ˆä»»åŠ¡ <span class=\"math inline\">\\(i\\)</span> ä»¥åŠä»»åŠ¡ <span class=\"math inline\">\\(i\\)</span> ä»¥åçš„æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´éƒ½ä¼šå»¶å <span class=\"math inline\">\\(S\\)</span>ã€‚</p>\n<p>å› ä¸º <span class=\"math inline\">\\(i\\)</span> ä»¥åçš„çŠ¶æ€ä¹Ÿä¼šä½¿ç”¨ <span class=\"math inline\">\\(f_i\\)</span> çš„å€¼ï¼Œæˆ‘ä»¬åœ¨è®¡ç®— <span class=\"math inline\">\\(f_i\\)</span> æ—¶å°±å°† <span class=\"math inline\">\\(S\\)</span> æå‡ºæ¥ï¼Œæå‰æŠŠåé¢çš„ <span class=\"math inline\">\\(c\\)</span> ä¹˜ä¸Šä¸å°±è¡Œäº†ï¼Ÿ</p>\n<p>ä¸­é—´çš„ç»“æœä¸å¯¹åŠ²ä¹Ÿæ— æ‰€è°“ï¼Œåªè¦æœ€åçš„ç­”æ¡ˆæ˜¯å¯¹çš„å°±è¡Œäº†ã€‚</p>\n<blockquote>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æ²¡æœ‰ç›´æ¥æ±‚å‡ºæ¯æ‰¹ä»»åŠ¡çš„å®Œæˆæ—¶åˆ»ï¼Œè€Œæ˜¯åœ¨ä¸€æ‰¹ä»»åŠ¡<strong>ã€Œå¼€å§‹ã€</strong>å¯¹åç»­ä»»åŠ¡äº§ç”Ÿå½±å“æ—¶ï¼Œå°±å…ˆæŠŠè´¹ç”¨ç´¯åŠ åˆ°ç­”æ¡ˆä¸­ã€‚è¿™æ˜¯ä¸€ç§åä¸º<strong>ã€Œè´¹ç”¨æå‰è®¡ç®—ã€</strong>çš„ç»å…¸æ€æƒ³ã€‚</p>\n<p align=\"right\">\nâ€”â€”æç…œä¸œã€Šç®—æ³•ç«èµ›è¿›é˜¶æŒ‡å—ã€‹\n</p>\n</blockquote>\n<p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š <span class=\"math display\">\\[\nf_i=\\min\\limits_{0\\leqslant j&lt;i}\\{f_j+(c_i-c_j)\\times t_i+s\\times(c_n-c_j)\\}\n\\]</span> æ­¤å¤„ï¼Œ<span class=\"math inline\">\\(f_i\\)</span> æ²¡æœ‰å…·ä½“å«ä¹‰ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#define int long long\nconst int maxn = 1e4 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint n, s;\nint f[maxn], t[maxn], c[maxn];\ninline int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF; p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nsigned main() &#123;\n    read(n); read(s);\n    memset(f, 0x3f, sizeof (f));\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(t[i]); read(c[i]);\n        t[i] += t[i - 1];\n        c[i] += c[i - 1];\n    &#125;\n    f[0] = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (int j = 0; j &lt; i; ++j)\n            f[i] = min(f[i], f[j] + t[i]* (c[i] - c[j]) + s * (c[n] - c[j]));\n    &#125;\n    printf(&quot;%lld&quot;, f[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"ä»»åŠ¡å®‰æ’-2\"><a href=\"https://loj.ac/p/10185\">ä»»åŠ¡å®‰æ’ 2</a></h3>\n<p><a href=\"https://www.acwing.com/problem/content/303/\">åŒå€ç»éªŒ</a></p>\n<p><span class=\"math inline\">\\(n\\)</span> çš„èŒƒå›´å˜å¤§äº†ï¼Œ<span class=\"math inline\">\\(n^2\\)</span> è¿‡ä¸äº†ã€‚</p>\n<p>è¿™ä¸éšæ‰‹åŠ ä¸ªæ–œç‡ä¼˜åŒ–çš„äº‹å„¿å—ã€‚</p>\n<p>æˆ‘ä»¬ç»§ç»­çæè¿™ä¸ªå¼å­ã€‚ <span class=\"math display\">\\[\n\\begin{aligned}\nf_i&amp;=\\min\\{f_j+(c_i-c_j)\\times t_i+s\\times(c_n-c_j)\\}\n\\\\\n&amp;=\\min\\{f_j+c_i\\times t_i-c_j\\times t_i+s\\times c_n-s\\times c_j\\}\n\\\\\n&amp;=\\min\\{f_j-c_j\\times t_i-s\\times c_j\\}+c_i\\times t_i+s\\times c_n\n\\end{aligned}\n\\]</span> ä»¤ <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span> ä¸” <span class=\"math inline\">\\(j&lt;k\\)</span> ã€‚</p>\n<p>åˆ™æœ‰ï¼š <span class=\"math display\">\\[\nf_j-c_j\\times t_i-s\\times c_j&lt;f_k-c_k\\times t_i-s\\times c_k\n\\\\\nf_j-f_k-s\\times c_j+s\\times c_k&lt;c_j\\times t_i-c_k\\times t_i\n\\\\\nf_j-f_k-s\\times c_j+s\\times c_k&lt;t_i\\times(c_j-c_k)\n\\\\\n\\dfrac{(f_j-s\\times c_j)-(f_k-s\\times c_k)}{(c_j)-(c_k)}&lt;t_i\n\\]</span> ç„¶åå°±æ˜¯è€å¥—è·¯ã€‚</p>\n<p>æ—¶é—´å¤æ‚åº¦ <span class=\"math inline\">\\(O(n)\\)</span>ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#define int long long\nconst int maxn = 5e5 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint n, s, L, R;\nint f[maxn], t[maxn], c[maxn], q[maxn];\n#define nec getchar\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1; ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\ninline int getup(int j, int k) &#123; return (f[j] - s * c[j]) - (f[k] - s * c[k]); &#125;\ninline int getdown(int j, int k) &#123; return (c[j]) - (c[k]); &#125;\ninline int getDP(int i, int j) &#123; return f[j] + (c[i] - c[j]) * t[i] + s * (c[n] - c[j]); &#125;\nsigned main() &#123;\n    read(n); read(s);\n    L = R = 1;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(t[i]); read(c[i]);\n        t[i] += t[i - 1];\n        c[i] += c[i - 1];\n    &#125;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        while (L &lt; R &amp;&amp; getup(q[L + 1], q[L]) &lt;= t[i] * getdown(q[L + 1], q[L]))\n            ++L;\n        f[i] = getDP(i, q[L]);\n        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &lt;= getdown(i, q[R]) * getup(q[R], q[R - 1]))\n            --R;\n        q[++R] = i;\n    &#125;\n    printf(&quot;%lld&quot;, f[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"ä»»åŠ¡å®‰æ’-3\"><a href=\"https://www.luogu.com.cn/problem/P5785\">ä»»åŠ¡å®‰æ’ 3</a></h3>\n<p><a href=\"https://loj.ac/p/10186\">åŒå€ç»éªŒ</a> | <a href=\"https://www.acwing.com/problem/content/304/\">ä¸‰å€ç»éªŒ</a></p>\n<p>æ³¨æ„ <span class=\"math inline\">\\(t\\)</span> æœ‰å¯èƒ½æ˜¯è´Ÿæ•°ã€‚</p>\n<p><span class=\"math inline\">\\(t\\)</span> ï¼ˆè¾“å…¥ï¼‰æœ‰å¯èƒ½ä¸ºè´Ÿï¼Œä»£è¡¨ç€ <span class=\"math inline\">\\(t\\)</span>ï¼ˆå‰ç¼€å’Œï¼‰ä¸å†å•è°ƒé€’å¢ï¼Œç”¨ä¸å•è°ƒçš„å¯¹è±¡ä½œä¸ºå•è°ƒé˜Ÿåˆ—çš„æ¡ä»¶ä¸€çœ‹å°±ååˆ†ä¸è®²æ­¦å¾·ï¼Œè¿™æ ·ç»´æŠ¤å‡ºæ¥çš„é˜Ÿå¤´æ˜¾ç„¶ä¸æ˜¯æ­£ç¡®ç­”æ¡ˆã€‚</p>\n<p>åé¢çš„ <span class=\"math inline\">\\(t,c\\)</span> é»˜è®¤ä¸ºå‰ç¼€å’Œã€‚</p>\n<p>æˆ‘ä»¬æ„Ÿæ€§è¯æ˜ä¸€ä¸‹ã€‚</p>\n<p>ä¸€ä¸ªæœ€æ™®é€šçš„ä¾‹å­ï¼Œå‡è®¾è¾“å…¥äº†ä¸€ä¸ªè´Ÿæ•°ï¼Œå¯¼è‡´ <span class=\"math inline\">\\(t_i&lt;t_{i-1}\\)</span>ï¼Œä¸”æœ‰ä¸€æ–œç‡ <span class=\"math inline\">\\(&gt;t_i\\)</span> ä¸” <span class=\"math inline\">\\(&lt;t_{i-1}\\)</span>ã€‚</p>\n<p>é‚£ä¹ˆåœ¨ <span class=\"math inline\">\\(i-1\\)</span> æ—¶ï¼Œå®ƒå°±è¢«ç»´æŠ¤é˜Ÿå¤´çš„æ“ä½œå‰”æ‰äº†ï¼Œä½†ä¹Ÿè®¸å®ƒå‡‘å·§å°±æ˜¯ <span class=\"math inline\">\\(i\\)</span> çš„æœ€ä¼˜è§£ï¼Œå‘œå‘¼å“€å“‰ã€‚</p>\n<p>äºæ˜¯æˆ‘ä»¬ä¸èƒ½åˆ é˜Ÿå¤´å…ƒç´ äº†ã€‚é‚£æ€ä¹ˆæŸ¥è¯¢æœ€ä¼˜è§£å‘¢ï¼Ÿ</p>\n<p>å•è°ƒé˜Ÿåˆ—é‡Œè£…çš„å§‹ç»ˆè¿˜æ˜¯ä¸ªå…·æœ‰å•è°ƒæ€§çš„ä¸‹å‡¸åŒ…ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥åœ¨é˜Ÿåˆ—ä¸­äºŒåˆ†ä¸€ä¸ª <span class=\"math inline\">\\(pos\\)</span>ï¼Œ<span class=\"math inline\">\\(pos\\)</span> ä¸ <span class=\"math inline\">\\(pos-1\\)</span> å½¢æˆçš„æ–œç‡æ¯” <span class=\"math inline\">\\(t_i\\)</span> å°ï¼Œ<span class=\"math inline\">\\(pos+1\\)</span> ä¸ <span class=\"math inline\">\\(pos\\)</span> å½¢æˆçš„æ–œç‡æ¯” <span class=\"math inline\">\\(t_i\\)</span> å¤§ã€‚</p>\n<p>ç„¶åæŠŠ <span class=\"math inline\">\\(pos\\)</span> å½“æˆ <span class=\"math inline\">\\(q_l\\)</span> æ¥å¤„ç†å°±å¥½äº†ã€‚</p>\n<p>é˜Ÿå°¾è¿˜æ˜¯ç»´æŠ¤ä¸€ä¸ªä¸‹å‡¸ã€‚</p>\n<p>æ—¶é—´å¤æ‚åº¦ <span class=\"math inline\">\\(O(n\\log n)\\)</span>ã€‚</p>\n<p><em>å¼ºçƒˆå»ºè®®ä¸è¦å»åŠ¨ AcWing ç‰ˆæœ¬çš„é‚£é“ã€‚</em></p>\n<p><em>æœ€åä¸¤ç»„æ•°æ®å ªç§°æ¯’ç˜¤ã€‚</em></p>\n<p><em>å¡ <code>long long</code> ä¹˜æ³•ï¼Œå¡ <code>__int128</code> æ—¶é™ï¼Œå¡ <code>double</code>ç²¾åº¦ï¼Œé T å³ WAã€‚</em></p>\n<p><em>åæ­£æˆ‘æäº†åŠä¸ªå°æ—¶ç¡¬æ˜¯æ²¡æœ‰æå‡ºæ¥ã€‚</em></p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#define int long long\nconst int maxn = 3e5 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint n, s, L, R;\nint f[maxn], t[maxn], c[maxn], q[maxn];\n#define nec getchar\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1; ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\ninline int getup(int j, int k) &#123; return (f[j] - s * c[j]) - (f[k] - s * c[k]); &#125;\ninline int getdown(int j, int k) &#123; return (c[j]) - (c[k]); &#125;\ninline int getDP(int i, int j) &#123; return f[j] + t[i] * (c[i] - c[j]) + s * (c[n] - c[j]); &#125;\ninline int Func(int u) &#123;\n    if (L == R) return q[L];\n    int l = L, r = R;\n    while (l &lt; r) &#123;\n        int mid = l + r &gt;&gt; 1;\n        if (getup(q[mid + 1], q[mid]) &lt;= u * getdown(q[mid + 1], q[mid]))\n            l = mid + 1;\n        else r = mid;\n    &#125;\n    return l;\n&#125;\nsigned main() &#123;\n    read(n); read(s);\n    L = R = 1;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(t[i]); read(c[i]);\n        t[i] += t[i - 1];\n        c[i] += c[i - 1];\n    &#125;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        int Best = Func(t[i]);\n        f[i] = getDP(i, q[Best]);\n        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &lt;= getdown(i, q[R]) * getup(q[R], q[R - 1]))\n            --R;\n        q[++R] = i;\n    &#125;\n    printf(&quot;%lld&quot;, f[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"åœŸåœ°è´­ä¹°\"><a href=\"https://www.luogu.com.cn/problem/P2900\">åœŸåœ°è´­ä¹°</a></h3>\n<p>é¦–å…ˆæˆ‘ä»¬æƒ³æ˜ç™½ä¸€ä»¶äº‹æƒ…ï¼šå¦‚æœä¸€å—åœŸåœ°ï¼Œæœ‰å¦ä¸€å—åœŸåœ°çš„é•¿å’Œå®½éƒ½æ¯”å®ƒå¤§ï¼Œé‚£å°±ä¸ç”¨å†ç†å®ƒäº†ï¼Œç›´æ¥ä»æ€»åºåˆ—é‡Œå‰”é™¤ã€‚</p>\n<pre class=\"cpp\"><code>struct _ &#123;\n    int w, l;\n    bool operator&lt; (const _ q) const &#123;\n        return w == q.w ? l &gt; q.l : w &gt; q.w;\n    &#125;\n&#125; a[maxn];\n...\n\nstd::sort(a + 1, a + n + 1);\nfor (int i = 1; i &lt;= n; ++i) &#123;\n    if (a[i].l &gt; a[cnt].l)\n        a[++cnt] = a[i];\n&#125;</code></pre>\n<p>ç„¶åå°±æ¨å¼å­ã€‚</p>\n<p>è´ªå¿ƒåœ°æƒ³ï¼Œåœ¨å‰é¢çš„æ“ä½œåï¼Œ<span class=\"math inline\">\\(a\\)</span> æ˜¯ä¸€ä¸ª <span class=\"math inline\">\\(w\\)</span> é€’å‡ï¼Œ<span class=\"math inline\">\\(l\\)</span> é€’å¢çš„åœŸåœ°åºåˆ—ã€‚</p>\n<p>æ‰€ä»¥æˆ‘ä»¬é€‰æ‹©å°†è¿ç»­çš„ä¸€æ®µåŒºé—´åˆ†ä¸ºä¸€ç»„ï¼Œè¿™æ ·çš„è¯ï¼Œä¸€ä¸ªç»„é‡Œçš„ä¸€æ®µè¿ç»­çš„åœŸåœ° <span class=\"math inline\">\\([x,y]\\)</span> å°±åªæœ‰ <span class=\"math inline\">\\(w_x\\)</span> å’Œ <span class=\"math inline\">\\(l_y\\)</span> èµ·äº†ä½œç”¨ï¼Œåˆæ²¡æœ‰ä¸­é—´é‚£ä¸€æ®µçš„äº‹äº†ã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(f_i\\)</span> è¡¨ç¤ºåˆ†é…å®Œç¬¬ <span class=\"math inline\">\\(i\\)</span> å—åœŸåœ°åçš„æœ€å°èŠ±è´¹ã€‚</p>\n<p>åˆ™æœ‰ï¼š <span class=\"math display\">\\[\nf_i=\\min\\{f_j+w_{j+1}\\times l_i\\}\n\\]</span> ä»¤ <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ã€‚</p>\n<p>åˆ™æœ‰ï¼š <span class=\"math display\">\\[\nf_j+w_{j+1}\\times l_i&lt;f_k+w_{k+1}\\times l_i\n\\\\\nf_j-f_k&lt;(-w_{j+1}+w_{k+1})\\times l_i\n\\\\\n\\dfrac{(f_j)-(f_k)}{(-w_{j+1})+(w_{k+1})}&lt;l_i\n\\]</span></p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#include &lt;algorithm&gt;\n#define int long long\nconst int maxn = 5e4 + 5;\nstruct _ &#123;\n    int w, l;\n    bool operator&lt; (const _ q) const&#123;\n        return w == q.w ? l &gt; q.l : w &gt; q.w;\n    &#125;\n&#125;;\n_ a[maxn];\nint n, cnt, l, r;\nint q[maxn], f[maxn];\nint getup(int j, int k) &#123; return f[j] - f[k]; &#125;\nint getdown(int j,int k) &#123; return a[k + 1].w - a[j + 1].w; &#125;\nint getDP(int i,int j) &#123; return f[j] + a[j + 1].w * a[i].l; &#125;\nsigned main() &#123;\n    scanf(&quot;%lld&quot;, &amp;n);\n    for(int i = 1; i &lt;= n; ++i)\n        scanf(&quot;%lld %lld&quot;, &amp;a[i].w, &amp;a[i].l);\n    std::sort(a + 1, a + n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (a[i].l &gt; a[cnt].l)\n            a[++cnt] = a[i];\n    &#125;\n    n = cnt; l = r = 1;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        while (l &lt; r &amp;&amp; getup(q[l + 1], q[l]) &lt;= a[i].l * getdown(q[l + 1], q[l]))\n            l++;\n        f[i] = getDP(i, q[l]);\n        while (l &lt; r &amp;&amp; getup(i, q[r]) * getdown(q[r], q[r - 1]) &lt;= getup(q[r],q[r - 1]) * getdown(i, q[r]))\n            r--;\n        q[++r] = i;\n    &#125;\n    printf(&quot;%lld&quot;, f[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"ä»“åº“å»ºè®¾\"><a href=\"https://www.luogu.com.cn/problem/P2120\">ä»“åº“å»ºè®¾</a></h3>\n<p><a href=\"https://loj.ac/p/10189\">åŒå€ç»éªŒ</a> | <a href=\"https://www.acwing.com/problem/content/description/1095/\">ä¸‰å€ç»éªŒ</a></p>\n<p>è®¾ <span class=\"math inline\">\\(f_i\\)</span> è¡¨ç¤ºåœ¨ <span class=\"math inline\">\\(i\\)</span> å·¥å‚å»ºç«‹ä»“åº“çš„æœ€å°èŠ±è´¹ã€‚</p>\n<p>åˆ™æœ‰ï¼š <span class=\"math display\">\\[\n\\begin{aligned}\nf_i&amp;=\\min\\{f_j+\\sum\\limits_{k=j+1}^{i-1}[(x_i-x_k)\\times p_k]+c_i\\}\n\\\\\n&amp;=\\min\\{f_j+\\sum\\limits_{k=j+1}^{i-1}(x_i\\times p_k)-\\sum\\limits_{k=j+1}^{i-1}(x_k\\times p_k)\\}+c_i\n\\\\\n&amp;=\\min\\{f_j+x_i\\times\\sum\\limits_{k=j+1}^{i-1}p_k-\\sum\\limits_{k=j+1}^{i-1}(x_k\\times p_k)\\}+c_i\n\\end{aligned}\n\\]</span> åˆ©ç”¨å‰ç¼€å’Œä¼˜åŒ–ï¼šè®¾ <span class=\"math inline\">\\(a\\)</span> ä¸º <span class=\"math inline\">\\(p\\)</span> çš„å‰ç¼€å’Œæ•°ç»„ï¼Œ<span class=\"math inline\">\\(b\\)</span> ä¸º <span class=\"math inline\">\\(x_i\\times p_i\\)</span> çš„å‰ç¼€å’Œæ•°ç»„ã€‚</p>\n<p>åˆ™åŸå¼å¯åŒ–ä¸ºï¼š <span class=\"math display\">\\[\n\\begin{aligned}\nf_i&amp;=\\min\\{f_j+x_i\\times(a_{i-1}-a_j)-(b_{i-1}-b_j)\\}+c_i\n\\\\\n&amp;=\\min\\{f_j+x_i\\times a_{i-1}-x_i\\times a_j-b_{i-1}+b_j\\}+c_i\n\\\\\n&amp;=\\min\\{f_j-x_i\\times a_j+b_j\\}+x_i\\times a_{i-1}-b_{i-1}+c_i\n\\end{aligned}\n\\]</span> ä»¤ <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span> ã€‚</p>\n<p>åˆ™æœ‰ï¼š <span class=\"math display\">\\[\nf_j-x_i\\times a_j+b_j&lt;f_k-x_i\\times a_k+b_k\n\\\\\nf_j-f_k+b_j-b_k&lt;x_i\\times a_j-x_i\\times a_k\n\\\\\n\\dfrac{(f_j+b_j)-(f_k+b_k)}{a_j-a_k}&lt;x_i\n\\]</span></p>\n<p><em>æƒ³æ„Ÿå—äººç”Ÿçš„åŒå­¦ä»¬å¯ä»¥å°è¯•åšä¸€ä¸‹ AcWing é‚£ä¸ªç‰ˆæœ¬ï¼Œé MLE å³ WAï¼Œçˆ½åˆ°ç‚¸ã€‚</em></p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#define int long long\nconst int maxn = 1e6 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint n, L, R;\nint f[maxn], x[maxn], p[maxn];\nint a[maxn], b[maxn], c[maxn], q[maxn];\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF; p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\ninline int getup(int j, int k) &#123; return (f[j] + b[j]) - (f[k] + b[k]); &#125;\ninline int getdown(int j, int k) &#123; return (a[j]) - (a[k]); &#125;\ninline int getDP(int i, int j) &#123; return f[j] - x[i] * a[j] + b[j] + x[i] * a[i - 1] - b[i - 1] + c[i]; &#125;\nsigned main() &#123;\n    read(n); L = R = 1;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(x[i]); read(p[i]); read(c[i]);\n        a[i] = a[i - 1] + p[i];\n        b[i] = b[i - 1] + x[i] * p[i];\n    &#125;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        while (L &lt; R &amp;&amp; getup(q[L + 1], q[L]) &lt;= x[i] * getdown(q[L + 1], q[L]))\n            ++L;\n        f[i] = getDP(i, q[L]);\n        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &lt;= getdown(i, q[R]) * getup(q[R], q[R - 1]))\n            --R;\n        q[++R] = i;\n    &#125;\n    printf(&quot;%lld&quot;, f[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"é”¯æœ¨å‚é€‰å€\"><a href=\"https://www.luogu.com.cn/problem/P4360\">é”¯æœ¨å‚é€‰å€</a></h3>\n<p><a href=\"https://loj.ac/p/10192\">åŒå€ç»éªŒ</a> | <a href=\"https://www.acwing.com/problem/content/1097/\">ä¸‰å€ç»éªŒ</a></p>\n<p>å’Œä»“åº“å»ºè®¾å¾ˆåƒã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(A_i=\\sum\\limits_{j=i}^nd_j\\)</span>ï¼Œè¡¨ç¤ºç¬¬ <span class=\"math inline\">\\(i\\)</span> æ£µæ ‘ä¸å±±è„šçš„è·ç¦»ï¼›<span class=\"math inline\">\\(B_i=\\sum\\limits_{j=1}^iw_j\\)</span>ï¼Œè¡¨ç¤º <span class=\"math inline\">\\(w\\)</span> çš„å‰ç¼€å’Œï¼›<span class=\"math inline\">\\(S=\\sum\\limits_{i=1}^nA_i\\times w_i\\)</span>ï¼Œè¡¨ç¤ºå°†æ‰€æœ‰æ ‘å…¨éƒ¨è¿åˆ°å±±è„šçš„èŠ±è´¹æ€»å’Œã€‚</p>\n<p>å‡è®¾åœ¨ <span class=\"math inline\">\\(j\\)</span> å¤„å»ºç«‹ç¬¬ <span class=\"math inline\">\\(1\\)</span> åº§é”¯æœ¨å‚ï¼Œåœ¨ <span class=\"math inline\">\\(i\\)</span> å¤„å»ºç«‹ç¬¬ <span class=\"math inline\">\\(2\\)</span> åº§é”¯æœ¨å‚ï¼Œæ­¤æ—¶ï¼š</p>\n<ul>\n<li>å¯¹äºç¬¬ <span class=\"math inline\">\\(1\\sim j\\)</span> æ£µæ ‘æ¥è¯´ï¼Œ<span class=\"math inline\">\\(S\\)</span> æ¯”å®é™…æƒ…å†µå¤šè¿äº† <span class=\"math inline\">\\(A_j\\)</span> çš„è·¯ç¨‹ï¼›</li>\n<li>å¯¹äºç¬¬ <span class=\"math inline\">\\(j+1\\sim i\\)</span> æ£µæ ‘æ¥è¯´ï¼Œ<span class=\"math inline\">\\(S\\)</span> æ¯”å®é™…æƒ…å†µå¤šè¿äº† <span class=\"math inline\">\\(A_i\\)</span> çš„è·¯ç¨‹ã€‚</li>\n</ul>\n<p>å°†å¯¹åº”çš„å¤šè¿çš„è·ç¦»ä¸èŠ±è´¹ç›¸ä¹˜çš„ç»“æœï¼Œè®© <span class=\"math inline\">\\(S\\)</span> å°†å…¶å‡å»å³å¯ã€‚ <span class=\"math display\">\\[\n\\begin{aligned}\nans&amp;=\\min\\{S-A_j\\times B_j-(B_i-B_j)\\times A_i\\}\\\\\n   &amp;=\\min\\{A_i\\times B_j-A_j\\times B_j\\}+S-A_i\\times B_i\n\\end{aligned}\n\\]</span> ä»¤ <span class=\"math inline\">\\(j&lt;k\\)</span> ä¸” <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ï¼Œåˆ™æœ‰ï¼š <span class=\"math display\">\\[\n\\begin{aligned}\nA_i\\times B_j-A_j\\times B_j&amp;&lt;A_i\\times B_k-A_k\\times B_k\\\\\n-A_j\\times B_j+A_k\\times B_k&amp;&lt;-A_i\\times B_j+A_i\\times B_k\\\\\n\\dfrac{-A_j\\times B_j+A_k\\times B_k}{-B_j+B_k}&amp;&lt;A_i\\\\\n\\dfrac{A_j\\times B_j-A_k\\times B_k}{B_j-B_k}&amp;&lt;A_i\\\\\n\\end{aligned}\n\\]</span> å…¶ä¸­ï¼Œ<span class=\"math inline\">\\(A_i\\)</span> å…·æœ‰å•è°ƒæ€§ï¼Œå¯ä»¥ç›´æ¥å¥—æ¿å­ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;algorithm&gt;\n#define int long long\nconst int inf = 1e18;\nconst int maxn = 1e6 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint w[maxn], d[maxn];\nint n, L, R, s, ans = inf;\nint q[maxn], a[maxn], b[maxn];\ninline int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;\ninline int getDP(int i, int j) &#123;\n    return s - a[j] * b[j] - (b[i] - b[j]) * a[i];\n&#125;\ninline int getup(int j, int k) &#123;\n    return a[j] * b[j] - a[k] * b[k];\n&#125;\ninline int getdown(int j, int k) &#123;\n    return b[j] - b[k];\n&#125;\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF; p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nsigned main() &#123;\n    read(n);\n    L = R = 1;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(w[i]), read(d[i]);\n        b[i] = b[i - 1] + w[i];\n    &#125;\n    for (int i = n; i; --i) &#123;\n        a[i] = a[i + 1] + d[i];\n        s += a[i] * w[i];\n    &#125;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        while (L &lt; R &amp;&amp; getup(q[L + 1], q[L]) &gt;= a[i] * getdown(q[L + 1], q[L]))\n            ++L;\n        ans = min(ans, getDP(i, q[L]));\n        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &gt;= getup(q[R], q[R - 1]) * getdown(i, q[R]))\n            --R;\n        q[++R] = i;\n    &#125;\n    printf(&quot;%lld&quot;, ans);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"cats-transport\"><a href=\"https://www.luogu.com.cn/problem/CF311B\">Cats Transport</a></h3>\n<p><a href=\"https://www.acwing.com/problem/content/305/\">åŒå€ç»éªŒ</a> | <a href=\"http://codeforces.com/problemset/problem/311/B\">ä¸‰å€ç»éªŒ</a></p>\n<p>ç»éªŒï¼šæ´›è°·çš„é¢˜é¢æ¯”è“ä¹¦å’Œ AcWing ä¸Šçš„æ ‡å‡†å¤šäº†ï¼Œè“ä¹¦çš„é¢˜æ„ä¸æ¸…ã€‚</p>\n<p>ç ”ç©¶è¡¨æ˜ï¼Œè¾¹çŒ›çŒå…»ä¹å¤šè¾¹çœ‹è“ä¹¦æœ‰åŠ©äºç†è§£ã€‚</p>\n<p>è¿™é“é¢˜éš¾åœ¨æ¨å¼å­ã€‚<del>ä¸ç„¶è¿˜èƒ½éš¾åœ¨å“ªé‡Œ</del></p>\n<p>è®¾ <span class=\"math inline\">\\(A_i\\)</span> è¡¨ç¤ºè¦æ¥åˆ°ç¬¬ <span class=\"math inline\">\\(i\\)</span> åªçŒ«çš„æœ€æ—©å‡ºå‘æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ­¤æ—¶å‡ºå‘ï¼ŒçŒ« <span class=\"math inline\">\\(i\\)</span> çš„ç­‰å¾…æ—¶é—´ä¸º <span class=\"math inline\">\\(0\\)</span>ã€‚</p>\n<p>å³ <span class=\"math inline\">\\(A_i=T_i-\\sum\\limits_{j=1}^{H_i}D_j\\)</span>ï¼Œä¹Ÿå°±æ˜¯å‡ºå‘æ—¶é—´=åˆ°è¾¾æ—¶é—´-ç»è¿‡æ—¶é—´ã€‚</p>\n<p>æ­¤æ—¶æˆ‘ä»¬å¯ä»¥æŠŠå…¶ä»–æ‰€æœ‰å› ç´ å»æ‰ï¼Œé¢˜æ„è½¬æ¢ä¸ºï¼š</p>\n<blockquote>\n<p>å·²çŸ¥åœ¨ <span class=\"math inline\">\\(\\geqslant A_i\\)</span> çš„æ—¶åˆ»å‡ºå‘å¯ä»¥æ¥åˆ°çŒ« <span class=\"math inline\">\\(i\\)</span> ï¼Œåœ¨ <span class=\"math inline\">\\(P\\)</span> æ¬¡å‡ºå‘æ¬¡æ•°çš„é™åˆ¶å†…æ¥åˆ°æ‰€æœ‰çŒ«ï¼ŒçŒ«çš„ç­‰å¾…æ—¶é—´ä¹‹å’Œæœ€å°æ˜¯å¤šå°‘ï¼Ÿ</p>\n</blockquote>\n<p>å‡è®¾é¥²å…»å‘˜åœ¨ <span class=\"math inline\">\\(t\\)</span> æ—¶åˆ»å‡ºå‘ï¼ŒçŒ« <span class=\"math inline\">\\(i\\)</span> çš„ç­‰å¾…æ—¶é—´å°±æ˜¯ <span class=\"math inline\">\\(t-A_i\\)</span>ã€‚</p>\n<p>å¯¹ <span class=\"math inline\">\\(A_i\\)</span> ä»å°åˆ°å¤§æ’åºã€‚</p>\n<p>æ˜¾ç„¶ï¼Œä¸€æ¬¡æ¥ä¸€æ®µè¿ç»­çš„çŒ«ï¼ŒèŠ±è´¹è‡ªç„¶æ˜¯æœ€å°çš„ã€‚</p>\n<p>è‹¥æˆ‘ä»¬è¦æ¥ <span class=\"math inline\">\\([k+1,j]\\)</span> èŒƒå›´å†…çš„çŒ«ï¼Œå®ƒä»¬çš„ç­‰å¾…æ—¶é—´ä¹‹å’Œå°±æ˜¯ï¼š <span class=\"math display\">\\[\n\\begin{aligned}\n\\sum\\limits_{p=k+1}^{j}(A_j-A_p)&amp;=[j-(k+1)+1]A_j-\\sum\\limits_{p=k+1}^{j}A_p\n\\\\\n&amp;=(j-k)\\times A_j-(S_j-S_k)\n\\\\\n&amp;=j\\times A_j-k\\times A_j-S_j+S_k\n\\end{aligned}\n\\]</span> å…¶ä¸­ <span class=\"math inline\">\\(S\\)</span> ä¸º <span class=\"math inline\">\\(A\\)</span> çš„å‰ç¼€å’Œã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºå‰ <span class=\"math inline\">\\(i\\)</span> ä¸ªé¥²å…»å‘˜å¸¦èµ°å‰ <span class=\"math inline\">\\(j\\)</span> åªçŒ«çš„æœ€å°èŠ±è´¹ã€‚</p>\n<p>åˆ™æœ‰ï¼š <span class=\"math display\">\\[\n\\begin{aligned}\nf_{i,j}&amp;=\\min\\{f_{i-1,k}+j\\times A_j-k\\times A_j-S_j+S_k\\}\n\\\\\n&amp;=\\min\\{f_{i-1,k}-A_j\\times k+S_k\\}+A_j\\times j-S_j\n\\end{aligned}\n\\]</span></p>\n<p>æˆ‘ä»¬å°†å¾ªç¯åœ°æšä¸¾æ¯ä¸ªé¥²å…»å‘˜çš„å¾ªç¯å˜é‡ <span class=\"math inline\">\\(i\\)</span> çœ‹åšå¸¸é‡ã€‚</p>\n<p>ä»¤ <span class=\"math inline\">\\(x\\)</span> ä¼˜äº <span class=\"math inline\">\\(y\\)</span>ï¼Œåˆ™æœ‰ï¼š <span class=\"math display\">\\[\nf_{i-1,x}-A_j\\times x+S_x&lt;f_{i-1,y}-A_j\\times y+S_y\n\\\\\n\\dfrac{(f_{i-1,x}+S_x)-(f_{i-1,y+S_y})}{x-y}&lt;A_j\n\\]</span> <strong>æ³¨æ„äº‹é¡¹</strong></p>\n<p><span class=\"math inline\">\\(f\\)</span> åˆå§‹åŒ–ä¸ºæå¤§å€¼ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;algorithm&gt;\n#define int long long\nconst int maxp = 105;\nconst int maxn = 1e5 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint f[maxp][maxn];\nint n, m, p, L, R, t, h;\nint q[maxn], a[maxn], d[maxn], s[maxn];\ninline int getDP(int i, int j, int k) &#123;\n    return f[i - 1][k] + (j - k) * a[j] - (s[j] - s[k]);\n&#125;\ninline int getup(int i, int j, int k) &#123;\n    return (f[i - 1][j] + s[j]) - (f[i - 1][k] + s[k]);\n&#125;\ninline int getdown(int j, int k) &#123;\n    return (j) - (k);\n&#125;\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF; p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nsigned main() &#123;\n    read(n); read(m); read(p);\n    memset(f, 0x3f, sizeof (f));\n    for (int i = 2; i &lt;= n; ++i)\n        read(d[i]), d[i] += d[i - 1];\n    for (int i = 1; i &lt;= m; ++i) &#123;\n        read(h); read(t);\n        a[i] = t - d[h];\n    &#125;\n    std::sort(a + 1, a + m + 1);\n    for (int i = 1; i &lt;= m; ++i)\n        s[i] = s[i - 1] + a[i];\n    f[0][0] = 0;\n    for (int i = 1; i &lt;= p; ++i) &#123;\n        L = R = 1;\n        for (int j = 1; j &lt;= m; ++j) &#123;\n            while (L &lt; R &amp;&amp; getup(i, q[L + 1], q[L]) &lt;= a[j] * getdown(q[L + 1], q[L]))\n                ++L;\n            f[i][j] = getDP(i, j, q[L]);\n            while (L &lt; R &amp;&amp; getup(i, j, q[R]) * getdown(q[R], q[R - 1]) &lt;= getup(i, q[R], q[R - 1]) * getdown(j, q[R]))\n                --R;\n            q[++R] = j;\n        &#125;\n    &#125;\n    printf(&quot;%lld&quot;, f[p][m]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ\"><a href=\"https://www.luogu.com.cn/problem/P3628\">ç‰¹åˆ«è¡ŒåŠ¨é˜Ÿ</a></h3>\n<p><a href=\"https://www.acwing.com/problem/content/337/\">åŒå€ç»éªŒ</a> | <a href=\"https://loj.ac/p/10190\">ä¸‰å€ç»éªŒ</a></p>\n<p>ç›´æ¥æ¨å¼å­ã€‚ <span class=\"math display\">\\[\n\\begin{aligned}\nf_i&amp;=\\max\\{f_j+a\\times(s_i-s_j)^2+b\\times(s_i-s_j)+c\\ \\}\\\\\n&amp;=\\max\\{f_j+a\\times({s_i}^2-2\\times s_i\\times s_j+{s_j}^2)+b\\times s_i-b\\times s_j\\ \\}+c\\\\\n&amp;=\\max\\{f_j+a\\times{s_i}^2-2\\times a\\times s_i\\times s_j+a\\times{s_j}^2-b\\times s_j\\ \\}+b\\times s_i+c\\\\\n&amp;=\\max\\{f_j-2\\times a\\times s_i\\times s_j+a\\times{s_j}^2-b\\times s_j\\ \\}+a\\times{s_i}^2+b\\times s_i+c\\\\\n\\end{aligned}\n\\]</span> ä»¤ <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ï¼Œåˆ™æœ‰ï¼š <span class=\"math display\">\\[\n\\begin{aligned}\nf_j-2\\times a\\times s_i\\times s_j+a\\times{s_j}^2-b\\times s_j&amp;&gt;f_k-2\\times a\\times s_i\\times s_k+a\\times{s_k}^2-b\\times s_k\\\\\n(f_j+a\\times{s_j}^2-b\\times s_j)-(f_k+a\\times{s_k}^2-b\\times s_k)&amp;&gt;(2\\times a\\times s_i\\times s_j)-(2\\times a\\times s_i\\times s_k)\\\\\n\\dfrac{(f_j+a\\times{s_j}^2-b\\times s_j)-(f_k+a\\times{s_k}^2-b\\times s_k)}{(2\\times a\\times s_j) - (2\\times a\\times s_k)}&amp;&gt;s_i\\\\\n\\end{aligned}\n\\]</span> æˆ‘ä»¬å‘ç°ä¸­é—´çš„ç¬¦å·æ˜¯ <span class=\"math inline\">\\(&gt;\\)</span>ã€‚</p>\n<p>æ‰€ä»¥æˆ‘ä»¬åœ¨å¼¹é˜Ÿå¤´çš„æ—¶å€™ï¼Œè¦æŠŠåˆ¤æ–­æ¡ä»¶ä¸­çš„ç¬¦å·åè¿‡æ¥ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#include &lt;cstring&gt;\n#include &lt;algorithm&gt;\n#define int long long\nconst int maxn = 1e6 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint n, L, R, a, b ,c;\nint q[maxn], s[maxn], f[maxn];\ninline int getDP(int i, int j) &#123;\n    return f[j] + a * (s[i] - s[j]) * (s[i] - s[j]) + b * (s[i] - s[j]) + c;\n&#125;\ninline int getup(int j, int k) &#123;\n    return (f[j] + a * s[j] * s[j] - b * s[j]) - (f[k] + a * s[k] * s[k] - b * s[k]);\n&#125;\ninline int getdown(int j, int k) &#123;\n    return (2 * a * s[j]) - (2 * a * s[k]);\n&#125;\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF; p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nsigned main() &#123;\n    read(n); read(a); read(b); read(c);\n    L = R = 1;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(s[i]), s[i] += s[i - 1];\n        while (L &lt; R &amp;&amp; getup(q[L + 1], q[L]) &gt;= s[i] * getdown(q[L + 1], q[L]))\n            ++L;\n        f[i] = getDP(i, q[L]);\n        while (L &lt; R &amp;&amp; getup(i, q[R]) * getdown(q[R], q[R - 1]) &lt;= getup(q[R], q[R - 1]) * getdown(i, q[R]))\n            --R;\n        q[++R] = i;\n    &#125;\n    printf(&quot;%lld&quot;, f[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"å¾é€”\"><a href=\"https://www.luogu.com.cn/problem/P4072\">å¾é€”</a></h3>\n<p><a href=\"https://loj.ac/p/2035\">åŒå€ç»éªŒ</a> | <a href=\"https://www.acwing.com/problem/content/2575/\">ä¸‰å€ç»éªŒ</a></p>\n<p>æ˜æ˜¾ï¼Œä¸åŒ–æ‰ <span class=\"math inline\">\\(v\\times m^2\\)</span> å°±æ— æ³•è¿›è¡Œä¼˜åŒ–ã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(x\\)</span> ä¸ºå½“å‰ä¼‘æ¯ç«™ç‚¹ä¸ä¸Šä¸€ä¼‘æ¯ç«™ç‚¹çš„è·ç¦»ï¼Œ <span class=\"math inline\">\\(x_0\\)</span> ä¸º <span class=\"math inline\">\\(x_1\\sim x_n\\)</span> çš„å¹³å‡æ•°ï¼Œ<span class=\"math inline\">\\(S\\)</span> ä¸º <span class=\"math inline\">\\(x\\)</span> çš„å‰ç¼€å’Œã€‚ <span class=\"math display\">\\[\n\\begin{aligned}\nV\\times m^2&amp;=[(x_1-x_0)^2+(x_2-x_0)^2+\\cdots+(x_m-x_0)^2]\\times m\n\\\\\n&amp;=m\\times \\sum\\limits_{i=1}^{m}{x_i}^2+(m\\times {x_0})^2-2\\times (x_0\\times m)\\times \\sum\\limits_{i=1}^{m}x_i\n\\\\\n&amp;=m\\times \\sum\\limits_{i=1}^{m}{x_i}^2+{S_m}^2-2\\times{S_m}^2\n\\\\\n&amp;=m\\times \\sum\\limits_{i=1}^{m}{x_i}^2-{S_m}^2\n\\end{aligned}\n\\]</span></p>\n<p>å…¶ä¸­ <span class=\"math inline\">\\(S_m\\)</span> æ˜¯ä¸€ä¸ªå®šå€¼ï¼ˆå³è¾“å…¥æ‰€æœ‰è·¯çš„é•¿åº¦å’Œï¼‰ã€‚</p>\n<p>å”¯ä¸€éœ€è¦è®¡ç®—çš„ï¼Œå°±æ˜¯ <span class=\"math inline\">\\(\\sum\\limits_{i=1}^{m}{x_i}^{2}\\)</span>ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±æ¥ DP å®ƒã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(a\\)</span> ä¸ºè¾“å…¥é“è·¯é•¿åº¦çš„å‰ç¼€å’Œæ•°ç»„ï¼Œ<span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºç¬¬ <span class=\"math inline\">\\(i\\)</span> æ¬¡ä¼‘æ¯åœ¨ <span class=\"math inline\">\\(j\\)</span> å¤„æ—¶ <span class=\"math inline\">\\(\\min\\{\\sum\\limits_{k=1}^{i}{x_k}^2\\}\\)</span> çš„å€¼ï¼Œåˆ™æœ‰ï¼š <span class=\"math display\">\\[\n\\begin{aligned}\nf_{i,j}&amp;=\\min\\{f_{i-1,j}+(a_i-a_j)^2\\}\n\\\\\n&amp;=\\min\\{f_{i-1,j}+{a_i}^2-2\\times a_i\\times a_j+{a_j}^2\\}\n\\end{aligned}\n\\]</span> ä»¤ <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ï¼Œåˆ™æœ‰ï¼š <span class=\"math display\">\\[\nf_{i-1,j}-2\\times a_i\\times a_j+{a_j}^2&lt;f_{i-1,k}-2\\times a_i\\times a_k+{a_k}^2\n\\\\\nf_{i-1,j}-f_{i-1,k}+{a_j}^2-{a_k}^2&lt;2\\times a_i\\times(a_j-a_k)\n\\\\\n\\dfrac{f_{i-1,j}-f_{i-1,k}+{a_j}^2-{a_k}^2}{2\\times(a_j-a_k)}&lt;a_i\n\\]</span></p>\n<p>åˆå§‹åŒ–ã€‚</p>\n<p>å°† <span class=\"math inline\">\\(f\\)</span> åˆå§‹åŒ–ä¸ºæå¤§å€¼ã€‚</p>\n<p>åœ¨ AcWing ä¸Šå°† <code>memset</code> æ”¹ä¸ºåˆå§‹åŒ– <code>f[0][i] = a[i] * a[i]</code> å°±å¯ä»¥è¿‡äº†ï¼Œä¸ç„¶ä¼š MLEï¼Œä¹Ÿè®¸æ˜¯å› ä¸ºæ²¡å¼€æ»šåŠ¨ã€‚ï¼ˆæœ¬æ¥ä¹Ÿç”¨ä¸ç€æ»š</p>\n<pre class=\"cpp\"><code>#include &lt;cstdio&gt;\n#define int long long\nconst int inf = 1e18;\nconst int maxn = 3005;\nconst int LEN = (1 &lt;&lt; 20);\nint f[maxn][maxn];\nint a[maxn], q[maxn];\nint n, m, L, R, ans = inf;\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF; p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    char ch = nec();\n    bool f = 0; x = 0;\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\ninline int min(int x, int y) &#123; return x &lt; y ? x : y; &#125;\nint getDP(int i, int j, int k) &#123;\n    return f[k - 1][j] + (a[i] - a[j]) * (a[i] - a[j]);\n&#125;\nint getup(int j, int k, int i) &#123;\n    return f[i - 1][j] - f[i - 1][k] + a[j] * a[j] - a[k] * a[k];\n&#125;\nint getdown(int j, int k) &#123;\n    return (a[j] - a[k]) &lt;&lt; 1;\n&#125;\nsigned main()&#123;\n    read(n); read(m);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(a[i]);\n        a[i] += a[i - 1];\n        f[0][i] = a[i] * a[i];\n    &#125;\n    for (int i = 1; i &lt; m; ++i) &#123;\n        L = R = 1; q[L] = i;\n        for (int j = i; j &lt;= n; ++j) &#123;\n            while (L &lt; R &amp;&amp; getup(q[L + 1], q[L], i) &lt;= a[j] * getdown(q[L + 1], q[L]))\n                ++L;\n            f[i][j] = getDP(j, q[L], i);\n            while (L &lt; R &amp;&amp; getup(i, q[R], i) * getdown(q[R], q[R - 1]) &lt;= getup(q[R], q[R - 1], i) * getdown(i, q[R]))\n                --R;\n            q[++R] = j;\n        &#125;\n    &#125;\n    printf(&quot;%lld&quot;,m * f[m - 1][n] - a[n] * a[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"æŸ æª¬\"><a href=\"https://www.luogu.com.cn/problem/P5504\">æŸ æª¬</a></h3>\n<p><a href=\"https://www.acwing.com/problem/content/2396/\">åŒå€ç»éªŒ</a></p>\n<p>æ˜¯è¾¹å†™è¿™ç¯‡é¢˜è§£è¾¹åšçš„ï¼ˆ</p>\n<p>é¢˜æ„ï¼š</p>\n<p>æœ‰ä¸€ä¸ªå«æœ‰ <span class=\"math inline\">\\(n\\)</span> ä¸ªå…ƒç´ çš„åºåˆ— <span class=\"math inline\">\\(s\\)</span>ã€‚å°†è¿™ä¸ªåºåˆ—åˆ†æˆè¿ç»­çš„è‹¥å¹²æ®µï¼Œå®šä¹‰æ¯ä¸€æ®µçš„ä»·å€¼ä¸ºã€Œåœ¨è¿™ä¸€æ®µå½“ä¸­ä»»é€‰æŸä¸ªå…ƒç´ çš„ä¸ªæ•°çš„å¹³æ–¹å†ä¹˜ä¸Šè¿™ä¸ªå…ƒç´ ã€çš„æœ€å¤§å€¼ã€‚æ±‚å°† <span class=\"math inline\">\\(s\\)</span> åˆ’åˆ†åçš„æœ€å¤§ä»·å€¼ã€‚</p>\n<p>ä¸éš¾æƒ³åˆ°åˆ†æˆçš„æ¯ä¸€æ®µé¦–å°¾å…ƒç´ å¿…é¡»ç›¸ç­‰ã€‚</p>\n<p>æ¯”å¦‚æœ‰è¿™æ ·ä¸€ä¸ªåºåˆ— <span class=\"math inline\">\\(x,a_1,a_2,a_3,\\cdots,a_k,x,y\\)</span> ã€‚å‡è®¾æˆ‘ä»¬æ±‚çš„æ˜¯è¿™ä¸€æ®µåŒ…å« <span class=\"math inline\">\\(x\\)</span> çš„ä¸ªæ•°çš„å¹³æ–¹ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥å°† <span class=\"math inline\">\\(y\\)</span> ä»è¿™ä¸€æ®µä¸­åˆ†ç¦»ï¼Œå•ç‹¬ä¸ºä¸€æ®µï¼Œæ˜æ˜¾æ›´ä¼˜ã€‚</p>\n<p>è€Œå…¶ä»–æ‰€æœ‰æƒ…å†µéƒ½æ˜¯è¿™ç§æƒ…å†µçš„æ‹“å±•ã€‚</p>\n<p>äºæ˜¯å¾—åˆ°å¼å­ï¼š <span class=\"math display\">\\[\nf_i=\\max\\{f_{j-1}+s_i\\times(cnt_i-cnt_j+1)^2\\}\n\\]</span> å…¶ä¸­ <span class=\"math inline\">\\(cnt_i\\)</span> ä¸º <span class=\"math inline\">\\(s_i\\)</span> å·²ç»å‡ºç°äº†å¤šå°‘æ¬¡ã€‚</p>\n<p>ç„¶åå°±æ˜¯å¥—è·¯ã€‚ <span class=\"math display\">\\[\n\\begin{aligned}\nf_i&amp;=\\max\\{f_{j-1}+s_i\\times({cnt_i}^2+{cnt_j}^2-2\\times cnt_i\\times cnt_j+2\\times cnt_i-2\\times cnt_j+1)\\}\n\\\\\n&amp;=\\max\\{f_{j-1}+s_i\\times{cnt_i}^2+s_i\\times{cnt_j}^2-2\\times s_i\\times cnt_i\\times cnt_j+2\\times s_i\\times cnt_i-2\\times s_i\\times cnt_j+s_i\\}\n\\\\\n&amp;=\\max\\{f_{j-1}+s_i\\times {cnt_j}^2-2\\times s_i\\times cnt_i\\times cnt_j-2\\times s_i\\times cnt_j\\}+s_i\\times {cnt_i}^2+2\\times s_i\\times cnt_i+s_i\n\\end{aligned}\n\\]</span> è¿™æ¬¡ä¸æ˜¯ <span class=\"math inline\">\\(\\min\\)</span>ï¼Œè€Œæ˜¯ <span class=\"math inline\">\\(\\max\\)</span>ï¼Œæˆ‘ä»¬è¿˜èƒ½åƒä»¥å‰é‚£æ ·æ¨å—ï¼Ÿ</p>\n<p>ä¸æ€¥ï¼Œæˆ‘ä»¬å…ˆæŒ‰ä»¥å‰çš„æ–¹æ³•è¯•è¯•ï¼Œè§æœºè¡Œäº‹ã€‚</p>\n<p>ä»¤ <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ï¼Œåˆ™æœ‰ï¼š <span class=\"math display\">\\[\nf_{j-1}+s_i\\times {cnt_j}^2-2\\times s_i\\times cnt_i\\times cnt_j-2\\times s_i\\times cnt_j&gt;f_{k-1}+s_i\\times {cnt_k}^2-2\\times s_i\\times cnt_i\\times cnt_k-2\\times s_i\\times cnt_k\n\\]</span> æš´åŠ›æä¸å‡ºæ¥ï¼Œå› ä¸ºé‚£ä¸ª <span class=\"math inline\">\\(s_i\\)</span> ä¹˜ä¸Šçš„å¹³æ–¹é¡¹ã€‚</p>\n<p>é‚£æˆ‘ä»¬æƒ³ä¸€ä¸ªåŠæ³•ï¼ŒæŠŠ <span class=\"math inline\">\\(s_i\\)</span> ç»™ç­æ‰å°±è¡Œäº†ã€‚</p>\n<p>æ—¢ç„¶æˆ‘ä»¬å·²çŸ¥ä¸€æ®µçš„é¦–å°¾å…ƒç´ å¿…é¡»ç›¸ç­‰ï¼Œé‚£ä¸å°±è¯´æ˜ <span class=\"math inline\">\\(s_i,s_j,s_k\\)</span> å¯ä»¥ç›¸äº’æ›¿æ¢å—ï¼Ÿ</p>\n<p>ç»§ç»­æã€‚ <span class=\"math display\">\\[\nf_{j-1}+s_j\\times {cnt_j}^2-2\\times s_i\\times cnt_i\\times cnt_j-2\\times s_j\\times cnt_j&gt;f_{k-1}+s_k\\times {cnt_k}^2-2\\times s_i\\times cnt_i\\times cnt_k-2\\times s_k\\times cnt_k\n\\\\\nf_{j-1}-f_{k-1}+s_j\\times {cnt_j}^2-s_k\\times {cnt_k}^2-2\\times s_j\\times cnt_j+2\\times s_k\\times cnt_k&gt;2\\times s_i\\times cnt_i\\times cnt_j-2\\times s_i\\times cnt_i\\times cnt_k\n\\\\\n\\dfrac{f_{j-1}-f_{k-1}+s_j\\times {cnt_j}^2-s_k\\times {cnt_k}^2-2\\times s_j\\times cnt_j+2\\times s_k\\times cnt_k}{cnt_j-cnt_k}&gt;2\\times s_i\\times cnt_i\n\\]</span></p>\n<p>è¿™é‡Œçš„ç¬¦å·å˜æˆ <span class=\"math inline\">\\(&gt;\\)</span> äº†ã€‚</p>\n<p>æ˜“å¾—ï¼Œè¿™é‡Œè¦ç»´æŠ¤çš„æ˜¯ä¸€ä¸ªæ–œç‡å•è°ƒé€’å‡çš„ä¸Šå‡¸åŒ…æœ€ä¼˜è§£åºåˆ—ã€‚</p>\n<p>å› ä¸º <span class=\"math inline\">\\(s_i\\)</span> å¿…é¡»ä¸ <span class=\"math inline\">\\(s_j,s_k\\)</span> ç›¸åŒï¼Œæ˜æ˜¾è¦é’ˆå¯¹æ¯ä¸ª <span class=\"math inline\">\\(s_i\\)</span> ç»´æŠ¤ä¸åŒçš„æœ€ä¼˜è§£åºåˆ—ï¼Œåœ¨æ¯æ¬¡å¯¹åº”çš„åºåˆ—ä¸­è®¡ç®—ã€‚</p>\n<p>ç»´æŠ¤çš„æ–œç‡å•è°ƒé€’å‡ï¼Œè€Œå¯¹äºæ¯ä¸€ä¸ªç›¸ç­‰çš„ <span class=\"math inline\">\\(s_i\\)</span>ï¼Œ <span class=\"math inline\">\\(2\\times s_i\\times cnt_i\\)</span> ä¸€å®šæ˜¯å•è°ƒé€’å¢çš„ï¼Œå¯¼è‡´äº†è¿™ä¸ªåºåˆ—å¤§æ¦‚é•¿è¿™ä¸ªæ ·å­ï¼šæ–œç‡å•è°ƒé€’å‡ï¼Œä½†æœ«å°¾çš„æœ€å°çš„æ–œç‡ä»å¤§äº <span class=\"math inline\">\\(2\\times s_i\\times cnt_i\\)</span>ã€‚</p>\n<p>å•è°ƒæ ˆå¯ä»¥è‡ªè¡Œç ”ç©¶ï¼Œå› ä¸ºä½œè€…ç„äº†ä¸€çœ¼æ—¶é—´å‘ç°å·²ç»æ˜¯æ˜å¤©äº†ã€‚ï¼ˆä»€</p>\n<pre class=\"cpp\"><code>#include&lt;cstdio&gt;\n#include&lt;vector&gt;\nusing namespace std;\n#define int long long\n#define top q[x].size() - 1\nconst int maxn = 1e5 + 5;\nconst int maxm = 1e4 + 5;\nint n;\nvector&lt;int&gt; q[maxm]; // ä¸ç”¨ vector ä¼š MLE\nint f[maxn], s[maxn];\nint cnt[maxn], tot[maxm];\nint getDP(int i,int j)&#123;\n    return f[j-1]+(cnt[i]-cnt[j]+1)*(cnt[i]-cnt[j]+1)*s[i];\n&#125;\nint getup(int j,int k)&#123;\n    return f[j-1]-f[k-1]+s[j]*cnt[j]*cnt[j]-s[k]*cnt[k]*cnt[k]-2*s[j]*cnt[j]+2*s[k]*cnt[k];\n&#125;\nint getdown(int j,int k)&#123;\n    return cnt[j]-cnt[k];\n&#125;\nsigned main()&#123;\n    scanf(&quot;%lld&quot;,&amp;n);\n    for(int i=1;i&lt;=n;++i)&#123;\n        scanf(&quot;%lld&quot;,&amp;s[i]);\n        cnt[i]=++tot[s[i]];\n    &#125;\n    for(int i=1;i&lt;=n;++i)&#123;\n        int x=s[i];\n        while(q[x].size()&gt;=2&amp;&amp;getup(q[x][top-1],i)*getdown(q[x][top-1],q[x][top])&gt;=getup(q[x][top-1],q[x][top])*getdown(q[x][top-1],i))\n            q[x].pop_back();\n        q[x].push_back(i);\n        while(q[x].size()&gt;=2&amp;&amp;getDP(i,q[x][top])&lt;=getDP(i,q[x][top-1]))\n            q[x].pop_back();\n        f[i]=getDP(i,q[x][top]);\n    &#125;\n    printf(&quot;%lld&quot;,f[n]);\n    return 0;\n&#125;</code></pre>\n<hr />\n<h3 id=\"æ€»ç»“\">æ€»ç»“</h3>\n<p>æ€»ç»“æ–œä¼˜çš„æ­¥éª¤ï¼š</p>\n<ol type=\"1\">\n<li>æ¨ DP å¼å­</li>\n<li>å¯¹å¼å­è¿›è¡Œå·§å¦™çš„ä¼˜åŒ–ï¼Œä½¿å…¶æ˜“äºåŒ–ç®€</li>\n<li>å‡è®¾ <span class=\"math inline\">\\(j\\)</span> ä¼˜äº <span class=\"math inline\">\\(k\\)</span>ï¼Œå°†å¼å­åŒ–æˆ <span class=\"math inline\">\\(\\dfrac{(j)-(k)}{(j)-(k)}&gt; \\text{or} &lt;x\\)</span> çš„å½¢å¼</li>\n<li>å•è°ƒé˜Ÿåˆ—æˆ–å•è°ƒæ ˆä¼˜åŒ–</li>\n</ol>\n",
            "tags": [
                "æ–œç‡ä¼˜åŒ–"
            ]
        }
    ]
}