<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xsc062.netlify.app</id>
    <title> â€¢ Posts by &#34;ac è‡ªåŠ¨æœº&#34; tag</title>
    <link href="https://xsc062.netlify.app" />
    <updated>2025-08-16T08:14:12.000Z</updated>
    <category term="å¹¶æŸ¥é›†" />
    <category term="æ–œç‡ä¼˜åŒ–" />
    <category term="æ‚¬çº¿æ³•" />
    <category term="å“ˆå¸Œ" />
    <category term="å­—å…¸æ ‘" />
    <category term="DP" />
    <category term="å•è°ƒé˜Ÿåˆ—" />
    <category term="åˆ†æ²»" />
    <category term="äºŒåˆ†å›¾" />
    <category term="CRT / exCRT" />
    <category term="æ’åˆ—ç»„åˆ" />
    <category term="ç½‘ç»œæµ" />
    <category term="è´¹ç”¨æµ" />
    <category term="äºŒåˆ†" />
    <category term="ä¸Šä¸‹ç•Œç½‘ç»œæµ" />
    <category term="å®¹æ–¥åŸç†" />
    <category term="çº¿æ®µæ ‘" />
    <category term="æ ‘çŠ¶æ•°ç»„" />
    <category term="åŒºé—´ DP" />
    <category term="æ„é€ " />
    <category term="Tarjan" />
    <category term="æ•°æ®ç»“æ„" />
    <category term="ä¸‹é¥­" />
    <category term="LCA" />
    <category term="å€å¢" />
    <category term="é¸½å·¢åŸç†" />
    <category term="æ¦‚ç‡æœŸæœ›" />
    <category term="è°ƒå’Œçº§æ•°" />
    <category term="å·®åˆ†" />
    <category term="æ€ç»´" />
    <category term="æ ‘å½¢ DP" />
    <category term="æœ€å°ç”Ÿæˆæ ‘" />
    <category term="SAM" />
    <category term="çŠ¶å‹" />
    <category term="åˆ†å—" />
    <category term="å¯æŒä¹…åŒ–" />
    <category term="ç¬›å¡å°”æ ‘" />
    <category term="é«˜ç»´å‰ç¼€å’Œ" />
    <category term="é—²è¯" />
    <category term="æ¬§æ‹‰å›è·¯" />
    <category term="æ ‘é“¾å‰–åˆ†" />
    <category term="é•¿é“¾å‰–åˆ†" />
    <category term="KMP" />
    <category term="border" />
    <category term="å­—ç¬¦ä¸²" />
    <category term="AC è‡ªåŠ¨æœº" />
    <category term="SA" />
    <category term="æ•°å­¦" />
    <category term="æ ‘ä¸Šå·®åˆ†" />
    <category term="FWT" />
    <category term="å †" />
    <category term="æ ‘çš„é‡å¿ƒ" />
    <category term="äºŒé¡¹å¼å®šç†" />
    <category term="äºŒé¡¹å¼åæ¼”" />
    <category term="è´ªå¿ƒ" />
    <category term="å‡æ‘Š" />
    <category term="è®¡æ•°" />
    <category term="ä¼˜åŒ–å»ºå›¾" />
    <category term="åæ‚”è´ªå¿ƒ" />
    <category term="è°ƒæ•´æ³•" />
    <category term="èƒŒåŒ…" />
    <category term="åšå¼ˆè®º" />
    <category term="DP ä¼˜åŒ–" />
    <category term="è™šæ ‘" />
    <category term="ç‚¹åˆ†æ²»" />
    <category term="WQS äºŒåˆ†" />
    <category term="é—µå¯å¤«æ–¯åŸºå’Œ" />
    <category term="slope trick" />
    <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
    <category term="æš´åŠ›" />
    <category term="çŠ¶å‹ DP" />
    <category term="ç»„åˆæ•°å­¦" />
    <category term="æ”¯é…å¯¹" />
    <category term="DDP" />
    <category term="å¹³è¡¡æ ‘" />
    <category term="å®¹æ–¥" />
    <category term="çŒ«æ ‘" />
    <category term="Kruskal é‡æ„æ ‘" />
    <category term="æè¶…çº¿æ®µæ ‘" />
    <entry>
        <id>https://xsc062.netlify.app/20250816/</id>
        <title>è¿‘æœŸæ‚é¢˜ II</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250816/"/>
        <content type="html">&lt;p&gt;å’Œ Aug 9th çš„æ‚é¢˜ä¸å¤ªèƒ½åˆå¹¶ï¼Œæ‰€ä»¥åˆ†å¼€äº†&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-gas-fire-extinguishers&#34;&gt;B. GAS-Fire Extinguishers&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3479&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3479&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶å¯ä»¥è´ªå¿ƒï¼Œä¸å¦¨ä»ä¸‹åˆ°ä¸Šï¼Œè®°å½•å½“å‰éå†è¿‡çš„ã€ç©ºä½™å‡ºæ¥çš„ç­ç«å™¨ï¼ˆå…¶å®ç®—çš„æ˜¯å¯ä»¥ä¾›ç»™çš„æˆ¿é—´æ•°ï¼‰å’Œè¿˜æœªåˆ†é…ç­ç«å™¨çš„æˆ¿é—´ï¼ŒæŒ‰è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\sim k\)&lt;/span&gt; åˆ†ç»„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°å¦‚æœåœ¨æŸä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„å­˜åœ¨è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ç©ºé—²ç­ç«å™¨ï¼Œå¯ä»¥è´ªå¿ƒåœ°åˆ†é…ç»™ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼›å¦‚æœå­˜åœ¨è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„æœªåˆ†é…æˆ¿é—´ï¼Œä¹Ÿå¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„æ”¾ç½®ç­ç«å™¨å¹¶åˆ†é…ç»™è¿™äº›æˆ¿é—´ã€‚ç±»ä¼¼åœ°ï¼Œè¿›è¡Œä¸¤ä¸¤é…å¯¹ä¸€å®šæ˜¯ä¸åŠ£çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°åŒå­æ ‘å†…è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„ç‚¹å¯¹ç•™åˆ° &lt;span class=&#34;math inline&#34;&gt;\(fa\)&lt;/span&gt; å†åŒ¹é…æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºè¿™æ—¶è·ç¦»ä¼šå˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(k+1\)&lt;/span&gt;ï¼Œä¸èƒ½åŒ¹é…ä¸Šï¼›å¯ä»¥æ„Ÿå—åˆ°è¿™æ ·æ˜¯æ›´åŠ£çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥åšäº†ï¼Œæ ¹èŠ‚ç‚¹ç‰¹æ®Šä¹±è´ªå¿ƒä¸€ä¸‹å°±è¡Œäº†ã€‚è®°å¾—å¼€ long longã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
#define int long long
signed main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, s, k, res = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; s &amp;gt;&amp;gt; k;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1), p(n + 1, std::vector&amp;lt;int&amp;gt; (k + 1)), q(n + 1, std::vector&amp;lt;int&amp;gt; (k + 1));
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        for (auto i : g[x])
            if (i != fa)  &amp;#123;
                DFS(i, x);
                for (int j = 0; j &amp;lt; k; ++j)
                    p[x][j + 1] += p[i][j], q[x][j + 1] += q[i][j];
            &amp;#125;
        ++q[x][0];
        if (x != 1) &amp;#123;
            int v = (q[x][k] + s - 1) / s;
            p[x][0] = v * s, res += v;
            for (int i = 0; i &amp;lt;= k; ++i) &amp;#123;
                int v = std::min(p[x][i], q[x][k - i]);
                p[x][i] -= v, q[x][k - i] -= v;
            &amp;#125;
            for (int i = 0; i &amp;lt; k; ++i) &amp;#123;
                int v = std::min(p[x][i], q[x][k - 1 - i]);
                p[x][i] -= v, q[x][k - 1 - i] -= v;
            &amp;#125;
        &amp;#125;
        else &amp;#123;
            // std::cerr &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            int sum = 0ll, r = 0;
            for (int i = k; ~i; --i) &amp;#123;
                sum += p[x][k - i];
                // std::cerr &amp;lt;&amp;lt; sum &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
                int v = std::min(sum, q[x][i]);
                sum -= v, q[x][i] -= v;
                r += q[x][i];
            &amp;#125;
            res += (r + s - 1) / s;
        &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-æ‰«åœ°æœºå™¨äºº&#34;&gt;C. æ‰«åœ°æœºå™¨äºº&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6502/problem/3&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6502/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å †è´§ç‰©ï¼Œæ¯å †è´§ç‰©æœ‰é‡é‡ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; å’Œä¸€ä¸ªå‚æ•° &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ã€‚æœ‰ä¸€ä¸ªåˆå§‹è´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€è´Ÿè½½ä¸Šé™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„æœºå™¨äººï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; éå†è¿™äº›è´§ç‰©ï¼Œå¯¹æ¯ä¸€å¤„è´§ç‰©æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ°æ¸…ç©ºè¿™å †è´§ç‰©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“å‰è´Ÿè½½æœªæ»¡ï¼šå¯ä»¥é€‰æ‹©è¿›è¡Œè£…è½½ç›´åˆ°è¾¾åˆ°è´Ÿè½½ä¸Šé™ï¼Œæˆ–è´§ç‰©æ¸…ç©ºã€‚èŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ç®¡å½“å‰è´Ÿè½½æ»¡æ²¡æ»¡ï¼šå¯ä»¥é€‰æ‹©æ¸…ç©ºå½“å‰è´Ÿè½½ï¼ŒèŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯ä¸€å¤„å¯ä»¥ä»»æ„æ“ä½œï¼Œè¦æ±‚éå†å®Œä¹‹åæœºå™¨äººè´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œé—®æœ€å°ä»£ä»·ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5,c\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;é¢˜é¢æ˜¯é‡æ„è¿‡çš„ï¼ŒåŸæ¥çš„é¢˜é¢å¤ªæœ‰æ­§ä¹‰äº†ã€‚ç»å¤§å¤šæ•°äººæ²¡åšå‡ºæ¥å°±æ˜¯å› ä¸ºæ²¡çœ‹æ‡‚é¢˜å§ï¼&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æš´åŠ›ï¼Œå¯ä»¥æƒ³åˆ°ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºå¤„ç†å®Œ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¿‡åè´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æœ€å°ä»£ä»·ï¼ˆæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,c}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,0}\)&lt;/span&gt; æ˜¯ç­‰æ•ˆçš„ï¼Œæ•…èˆå¼ƒå‰è€…ï¼‰ã€‚è®° &lt;span class=&#34;math inline&#34;&gt;\(k=\left\lceil\dfrac {v_i}c\right\rceil,w=(v_i\bmod c - 1)\bmod c+1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,(j+v_i)\bmod c}\gets f_{i-1,j}+k\cdot a_i+(k-1)\cdot b +
\begin{cases}
b&amp;amp;j+w=c\\
a_i+b&amp;amp;j+w&amp;gt; c\\
0&amp;amp;\text{otherwise}
\end{cases}\\
f_{i,0}\gets f_{i,j}+b
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¹‹é—´æ˜¯å­˜åœ¨å¯¹åº”å…³ç³»çš„ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥ç»§æ‰¿ï¼ˆçœŸå®çš„ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åº”è¯¥ä½äº &lt;span class=&#34;math inline&#34;&gt;\(-s_i\)&lt;/span&gt; çš„ä½ç½®ï¼‰ï¼Œå†åšå…¨å±€åŠ ã€åŒºé—´åŠ ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{i,0}\)&lt;/span&gt; çš„è½¬ç§»æ˜¯å…¨å±€ minï¼Œçº¿æ®µæ ‘ç»´æŠ¤å³å¯ï¼›æ¯æ¬¡åªä¼šæ–°å¢ä¸€ä¸ªçŠ¶æ€ï¼ŒåŠ¨æ€å¼€ç‚¹å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e6 + 5;
const __int128 inf = 1e18;
struct &amp;#123;
    int l, r;
    __int128 u, d;
&amp;#125; t[maxn];
#define lt t[p].l
#define rt t[p].r
int tot;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d += t[p].d, t[lt].u += t[p].d;
        t[rt].d += t[p].d, t[rt].u += t[p].d;
        t[p].d = 0ll;
    &amp;#125;
    return;
&amp;#125;
void upd(int &amp;amp;p, int l, int r, int x, __int128 v) &amp;#123;
    if (!p)
        p = ++tot, t[p].u = v;
    else
        t[p].u = std::min(t[p].u, v);
    if (l == r)
        return;
    pushdown(p);
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, l, mid, x, v);
    else
        upd(rt, mid + 1, r, x, v);
    return;
&amp;#125;
void add(int p, int l, int r, int ql, int qr, __int128 v) &amp;#123;
    if (!p)
        return;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr) &amp;#123;
        t[p].d += v, t[p].u += v;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    pushdown(p);
    if (ql &amp;lt;= mid)
        add(lt, l, mid, ql, qr, v);
    if (qr &amp;gt; mid)
        add(rt, mid + 1, r, ql, qr, v);
    t[p].u = std::min(t[lt].u, t[rt].u);
    return;
&amp;#125;
__int128 ask(int p, int l, int r, int x) &amp;#123;
    if (l == r)
        return t[p].u;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    pushdown(p);
    if (x &amp;lt;= mid)
        return ask(lt, l, mid, x);
    return ask(rt, mid + 1, r, x);
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;robot.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;robot.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;ex_robot4.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    t[0].u = inf;
    int n, b, c, p0 = 0, rt = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; c &amp;gt;&amp;gt; b;
    std::vector&amp;lt;int&amp;gt; a(n + 1), v(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; v[i];
    upd(rt, 0, c - 1, 0, 0ll);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        __int128 k = (v[i] + c - 1) / c, w = (v[i] % c == 0 ? c : v[i] % c);
        t[rt].d += k * a[i] + (k - 1) * b;
        t[rt].u += k * a[i] + (k - 1) * b;
        if (w &amp;lt;= c)
            add(rt, 0, c - 1, (c - w + p0) % c, (c - w + p0) % c, b);
        if (w != 1) &amp;#123;
            int l = (c - w + p0 + 1) % c, r = (p0 + c - 1) % c;
            if (l &amp;lt;= r)
                add(rt, 0, c - 1, l, r, a[i] + b);
            else &amp;#123;
                add(rt, 0, c - 1, 0, r, a[i] + b);
                add(rt, 0, c - 1, l, c - 1, a[i] + b);
            &amp;#125;
        &amp;#125;
        p0 = (p0 + c - v[i] % c) % c;
        upd(rt, 0, c - 1, p0, t[rt].u + b);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; (long long)ask(rt, 0, c - 1, p0) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-å¥—å¨ƒ&#34;&gt;D. å¥—å¨ƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6502/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6502/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šåˆå§‹ä¸ºå…¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n + 1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡å•ç‚¹ +1 æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåï¼Œæ±‚è§£ï¼š&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å‰ç¼€å’Œæ•°ç»„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œä½¿å¾—å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå‡æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\cdot i\ge s_i\)&lt;/span&gt; æˆç«‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6\)&lt;/span&gt;ï¼Œæ—¶é™ 0.5sã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;è¶£äº‹ä¸€åˆ™&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;è€ƒåœºä¸Šæœ€å 10min æ‹¿åˆ°é¢˜ï¼Œæ†‹äº†ä¸€ä¸ªèƒ½æ‹¿åˆ° 96pts çš„å‡åšæ³•ï¼šæ³¨æ„åˆ°å‰ç¼€å’Œæ˜¯å•å¢çš„ï¼Œéœ€è¦ç»´æŠ¤æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {s_i}i\)&lt;/span&gt;ï¼Œç”±äºåç¼€ +1 å¸¦æ¥çš„å½±å“å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥çŒœæµ‹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åªä¼šåœ¨åŸæ¥çš„å’Œä¿®æ”¹çš„ç‚¹ä¹‹é—´å˜åŒ–ã€‚åªç”¨ 10 è¡Œçš„æ ¸å¿ƒä»£ç å°±èƒ½æ‹¿åˆ°å¾ˆå¤šåˆ†ã€‚ä½†æ˜¯å±…ç„¶æœ‰è¿™ä¹ˆå¤šï¼Œå¯èƒ½å‡ºé¢˜äººéƒ½æ²¡æœ‰æƒ³åˆ°çœŸæœ‰äººæ•¢äº¤è¿™ç§åšæ³•å§ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
    std::freopen(&amp;quot;doll.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;doll.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    auto stime = std::chrono::steady_clock::now();
    int n, res = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; bit(n + 2);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x) &amp;#123;
        for (; x &amp;lt;= n + 1; x += lowbit(x))
            ++bit[x];
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        int res = 0;
        for (; x; x -= lowbit(x))
            res += bit[x];
        return res;
    &amp;#125;;
    int p = 1;
    for (int i = 1, x; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x, add(++x);
        long long s = ask(x), t = ask(p);
        if (s * p == t * x ? x &amp;gt; p : s * p &amp;gt; t * x)
            p = x;
        else
            s = t;
        if (s &amp;gt; p * res)
            ++res;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::cerr &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt;(std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;å¾ˆå®¹æ˜“å†™å‡ºæš´åŠ›ï¼Œè§‚å¯Ÿæ ·ä¾‹å°±èƒ½å‘ç°æ¯æ¬¡ä¿®æ”¹åç­”æ¡ˆæœ€å¤šå¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚è®°å½“å‰ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(res\)&lt;/span&gt;ï¼Œçº¿æ®µæ ‘ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(s_i-res\cdot i\)&lt;/span&gt; çš„æœ€å°å€¼ï¼Œè‹¥å…¶ä¸ºè´Ÿåˆ™ res++ï¼Œç„¶åé‡æ„çº¿æ®µæ ‘ï¼ˆç­‰å·®æ•°åˆ—å’Œ min ä¸å…¼å®¹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆåˆæœ‰ä¸ç­‰å¼ ğŸ˜±&lt;/p&gt;
&lt;p&gt;ç›®çš„æ˜¯åœ¨æœ¬æ¥åˆæ³•çš„èŒƒå›´é‡Œæ‰¾åˆ°æ–°çš„ä¸åˆæ³•å€¼ã€‚è€ƒè™‘åˆæ³•èŒƒå›´ï¼š&lt;span class=&#34;math inline&#34;&gt;\(s_i-res\cdot i\ge 0\)&lt;/span&gt;ï¼Œè§£ä¸€ä¸‹å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\le \dfrac {s_i}{res}\)&lt;/span&gt;ï¼Œæ”¾ç¼©å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\le\dfrac {n}{res}\)&lt;/span&gt;ï¼Œæ¯æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(res\)&lt;/span&gt; å˜åŒ–æ—¶åªé‡æ„ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {n}{res}\)&lt;/span&gt; ä»¥å‰çš„ä½ç½®ï¼Œé‡æ„çš„æ€»é•¿æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\ln n)\)&lt;/span&gt; çš„ã€‚ï¼ˆçº¿æ®µæ ‘å»ºæ ‘æ˜¯çº¿æ€§çš„ï¼‰&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
const int inf = 0x3f3f3f3f;
struct &amp;#123;
    int l, r, u, d;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].u = t[p].l = l, t[p].r = r;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d += t[p].d, t[rt].d += t[p].d;
        t[lt].u -= t[p].d, t[rt].u -= t[p].d;
        t[p].d = 0;
    &amp;#125;
    return;
&amp;#125;
void add(int p, int x) &amp;#123;
    if (x &amp;lt;= t[p].l) &amp;#123;
        ++t[p].d, --t[p].u;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, x);
    add(rt, x);
    t[p].u = std::min(t[lt].u, t[rt].u);
    // printf(&amp;quot;[%d, %d]: %d, [%d, %d]: %d\n&amp;quot;, t[p].l, mid, t[lt].u, mid + 1, t[p].r, t[rt].u);
    return;
&amp;#125;
void rem(int p, int r) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        t[p].u += t[p].l;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;lt;= mid)
        rem(lt, r), t[rt].u = inf;
    else
        rem(lt, r), rem(rt, r);
    t[p].u = std::min(t[lt].u, t[rt].u);
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;doll.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;doll.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    bld(1, 1, n + 1);
    for (int i = 1, x, res = 1, now = n; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x;
        if (x &amp;lt;= now)
            add(1, ++x);
        if (t[1].u &amp;lt; 0) &amp;#123;
            std::cout &amp;lt;&amp;lt; ++res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
            rem(1, now = n / res);
        &amp;#125;
        else
            std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
        // puts(&amp;quot;&amp;quot;);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---subarray-sum-divisibility&#34;&gt;E - Subarray Sum Divisibility&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¨¡æ„ä¹‰ä¸‹çš„æ•°åˆ—å…¨ç­‰ï¼Œå¯ä»¥å¯¹åº”åŸæ•°ç»„å…¨ç­‰ã€å·®åˆ†å…¨ç­‰ã€å‰ç¼€å’Œå…¨ç­‰ï¼ˆéƒ½æ˜¯æ¨¡æ„ä¹‰ä¸‹çš„ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¸€äº›çº¿æ€§å’Œéçº¿æ€§çš„å˜æ¢ä¹Ÿå¯ä»¥ï¼‰&lt;/p&gt;
&lt;p&gt;æœ¬ç€ä¿®æ”¹çš„ç‚¹å°½é‡å°‘çš„æƒ³æ³•ï¼Œå¦‚æœé¢˜ç›®ç»™å®šå•ç‚¹ä¿®æ”¹å°±å¯ä»¥åœ¨åŸæ•°ç»„ä¸Šåšæ–‡ç« ï¼Œç»™å®šåŒºé—´ä¿®æ”¹å¯ä»¥è€ƒè™‘å·®åˆ†æ•°ç»„ï¼Œå‰ç¼€å’Œå¯¹äºä¸€äº›åŒºé—´æŸ¥è¯¢æœ‰ä¼˜åŠ¿&lt;/p&gt;
&lt;p&gt;å…¶ä»–ä¸¤ç§ç”¨å¾—ä¹Ÿå¾ˆå¤šï¼Œåƒè¿™é¢˜åªéœ€è¦ç”¨åŸæ•°ç»„å…¨ç­‰å°±å¯ä»¥åšäº†&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, l;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; l;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; u(l + 1, std::vector&amp;lt;int&amp;gt; (m));
    for (int i = 1; i &amp;lt;= l; ++i)
        for (int j = 0; j &amp;lt; m; ++j)
            for (int k = i; k &amp;lt;= n; k += l)
                u[i][j] += (j + m - a[k]) % m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; f(l + 1, std::vector&amp;lt;int&amp;gt; (m, inf));
    f[0][0] = 0;
    for (int i = 1; i &amp;lt;= l; ++i)
        for (int j = 0; j &amp;lt; m; ++j)
            for (int k = 0; k &amp;lt; m; ++k)
                f[i][(j + k) % m] = std::min(f[i][(j + k) % m], f[i - 1][j] + u[i][k]);
    std::cout &amp;lt;&amp;lt; f[l][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---all-included&#34;&gt;F - All Included&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_f&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_f&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åŸé¢˜æ„è½¬åŒ–ä¸ºåœ¨ AC è‡ªåŠ¨æœºä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; æ­¥ï¼Œè¦æ±‚ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå¶å­çš„æ–¹æ¡ˆæ•°ã€‚ä¸å¤ªå¯åšï¼Œè½¬åŒ–æˆå®¹æ–¥ï¼ˆä»¤å­—ç¬¦ä¸²ç»ˆç‚¹ä¸å¯è¾¾ï¼‰ã€‚åœ¨å¤–å±‚æšä¸¾æ­¥æ•°æš´åŠ›æ¸¸èµ°ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚æ°å¥½èµ° &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; æ­¥ï¼Œä¹Ÿå¯ä»¥ç”¨çŸ©é˜µï¼›ä½†åŸå›¾å¾ˆç¨€ç–ï¼Œæ‰€ä»¥çŸ©é˜µå¹¶æ²¡æœ‰ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int tot = 1, T[805][26], fail[805];
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, l;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; l;
    std::vector&amp;lt;std::string&amp;gt; a;
    &amp;#123;
        std::vector&amp;lt;std::string&amp;gt; s(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; s[i];
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            bool flag = 1;
            for (int j = 1; j &amp;lt;= n; ++j)
                if (j != i)
                    if (s[j].find(s[i]) != std::string::npos) &amp;#123;
                        flag = 0;
                        break;
                    &amp;#125;
            if (flag)
                a.push_back(s[i]);
        &amp;#125;
        n = (int)a.size();
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; pos(n);
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        int &amp;amp;p = pos[i];
        for (auto j : a[i]) &amp;#123;
            if (!T[p][j - &amp;#39;a&amp;#39;])
                T[p][j - &amp;#39;a&amp;#39;] = tot++;
            p = T[p][j - &amp;#39;a&amp;#39;];
        &amp;#125;
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    auto res = 0ll;
    int siz = 1 &amp;lt;&amp;lt; n;
    for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; tag(tot);
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1)
                tag[pos[j]] = 1;
        std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(l + 1, std::vector&amp;lt;long long&amp;gt; (tot));
        f[0][0] = 1ll;
        for (int j = 0; j &amp;lt; l; ++j)
            for (int k = 0; k &amp;lt; tot; ++k)
                for (int a = 0; a &amp;lt; 26; ++a) &amp;#123;
                    if (!tag[T[k][a]])
                        (f[j + 1][T[k][a]] += f[j][k]) %= mod;
                &amp;#125;
        int k = (__builtin_popcount(i) &amp;amp; 1 ? mod - 1 : 1);
        auto s = 0ll;
        for (int j = 0; j &amp;lt; tot; ++j)
            if (!tag[j])
                (s += f[l][j]) %= mod;
        (res += k * s) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;g---count-simple-paths-2&#34;&gt;G - Count Simple Paths 2&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆæ–°çš„æ€§è´¨ã€‚è€ƒè™‘ã€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºèµ·ç‚¹çš„ç®€å•è·¯å¾„æ•°ã€å’Œåç¥–è¾¹æ•°é‡çš„å…³ç³»ï¼šé€‰å®šä¸€æ¡åç¥–è¾¹å¿…é¡»è¢«ç»è¿‡æ—¶ï¼ˆæ˜¾ç„¶åªæœ‰ä¸€ç§å¯èƒ½çš„ç»è¿‡æ–¹å‘ï¼‰ï¼Œæ ‘çš„å½¢æ€å‘ç”Ÿå˜åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ç§åç¥–è¾¹çš„é€‰å–æ–¹æ¡ˆå¯¹åº”ä¸€ç§æ ‘ï¼Œéå†å…¶ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¼€å§‹çš„ç®€å•è·¯å¾„å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚è®¾åç¥–è¾¹æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåˆæ³•çš„æ–¹æ¡ˆæ•°ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(2^k\)&lt;/span&gt;ï¼Œæš´åŠ› DFS çš„æ•´ä¸ªå›¾å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(2^k\cdot n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å¾ˆå¤šè·Ÿåç¥–è¾¹æ— å…³çš„éå†æ˜¯ä¸å¿…è¦çš„ï¼ˆåªæœ‰ä¸€ç§èµ°æ³•ï¼Œå¯ä»¥è®¾æˆè¾¹æƒï¼‰ï¼Œè€ƒè™‘å¯¹æ‰€æœ‰è¿æ¥åç¥–è¾¹çš„ç‚¹å»ºç«‹è™šæ ‘ï¼Œå¹¶æŠŠåŸæ ‘ä¸Šçš„åç¥–è¾¹ä¹Ÿç§»åˆ°è™šæ ‘ä¸Šï¼Œå°±èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(2^k\cdot k)\)&lt;/span&gt; è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1), g1(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g2(n + 1);
    for (int x, y; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1), vis(n + 1);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; be;
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        static int now = 0;
        tag[x] = 1, vis[x] = ++now;
        for (auto i : g[x])
            if (!tag[i]) &amp;#123;
                // fprintf(stderr, &amp;quot;%d -&amp;gt; %d\n&amp;quot;, x, i);
                g1[x].push_back(i), DFS(i, x);
            &amp;#125;
            else if (i != fa &amp;amp;&amp;amp; vis[i] &amp;lt; vis[x])
                be.emplace_back(i, x);
        return;
    &amp;#125;;
    DFS(1, -1);
    &amp;#123; // æ±‚è™šæ ‘
        std::vector&amp;lt;int&amp;gt; dep(n + 1), fa(n + 1), top(n + 1), siz(n + 1), son(n + 1), dfn(n + 1), rfn(n + 1);
        std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
            siz[x] = 1;
            for (auto i : g1[x]) &amp;#123;
                dep[i] = dep[x] + 1;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
            return;
        &amp;#125;;
        DFS(1);
        DFS = [&amp;amp;](int x) &amp;#123;
            static int now = 0;
            dfn[x] = ++now;
            if (son[x])
                top[son[x]] = top[x], DFS(son[x]);
            for (auto i : g1[x])
                if (i != son[x])
                    top[i] = i, DFS(i);
            rfn[x] = now;
            // printf(&amp;quot;%d: [%d, %d]\n&amp;quot;, x, dfn[x], rfn[x]);
            return;
        &amp;#125;;
        top[1] = 1, DFS(1);
        auto getLCA = [&amp;amp;](int x, int y) &amp;#123;
            for (; top[x] != top[y]; x = fa[top[x]])
                if (dep[top[x]] &amp;lt; dep[top[y]])
                    std::swap(x, y);
            return dep[x] &amp;lt; dep[y] ? x : y;
        &amp;#125;;
        tag.assign(n + 1, 0);
        tag[1] = tag[n] = 1;
        for (auto [u, v] : be)
            tag[u] = 1, tag[v] = 1;
        std::vector&amp;lt;int&amp;gt; p;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (tag[i])
                p.push_back(i);
        std::sort(p.begin(), p.end(), [&amp;amp;](int i, int j) &amp;#123; return dfn[i] &amp;lt; dfn[j]; &amp;#125;);
        for (int i = 1; i &amp;lt; (int)p.size(); ++i) &amp;#123;
            int fa = getLCA(p[i], p[i - 1]);
            if (!tag[fa])
                tag[fa] = 1;
        &amp;#125;
        p.clear();
        for (int i = 1; i &amp;lt;= n; ++i)
            if (tag[i])
                p.push_back(i);
        std::sort(p.begin(), p.end(), [&amp;amp;](int i, int j) &amp;#123; return dfn[i] &amp;lt; dfn[j]; &amp;#125;);
        std::vector&amp;lt;int&amp;gt; st;
        for (auto i : p) &amp;#123;
            if (st.empty())
                st.push_back(i);
            else &amp;#123;
                for (; rfn[st.back()] &amp;lt; dfn[i]; st.pop_back());
                g2[st.back()].emplace_back(i, dep[i] - dep[st.back()]);
                g2[i].emplace_back(st.back(), dep[i] - dep[st.back()]);
                // printf(&amp;quot;add (%d, %d): %d\n&amp;quot;, st.back(), i, dep[i] - dep[st.back()]);
                st.push_back(i);
            &amp;#125;
        &amp;#125;
        for (auto [u, v] : be) &amp;#123;
            g2[u].emplace_back(v, 1), g2[v].emplace_back(u, 1);
            // printf(&amp;quot;# add(%d, %d): 1\n&amp;quot;, u, v);
        &amp;#125;
    &amp;#125;
    tag.assign(n + 1, 0);
    std::vector&amp;lt;int&amp;gt; res(n + 1);
    DFS = [&amp;amp;](int x, int s) &amp;#123;
        if (x == n)
            ++res[s];
        tag[x] = 1;
        for (auto [i, w] : g2[x])
            if (!tag[i])
                DFS(i, s + w);
        tag[x] = 0;
        return;
    &amp;#125;;
    DFS(1, 0);
    for (int i = 1; i &amp;lt; n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <category term="AC è‡ªåŠ¨æœº" />
        <category term="è´ªå¿ƒ" />
        <category term="DP ä¼˜åŒ–" />
        <category term="è™šæ ‘" />
        <updated>2025-08-16T08:14:12.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250120/</id>
        <title>å­¦ä¹ ç¬”è®°ï¼šAC è‡ªåŠ¨æœº</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250120/"/>
        <content type="html">&lt;p&gt;è€³æœºå£°éŸ³ç–‘ä¼¼æœ‰ç‚¹å°äº†ï¼Œç”¨å¿ƒæ—·ç¥æ€¡çš„è¯æ¥è¯´å¤§è‡´ä¼šæ˜¯ã€Œæ¯”æœè‡â†‘å—¡å—¡å£°è¿˜å°ã€ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;ï¼Ÿå§æ§½è€³æœºä¸Šå±…ç„¶å¯ä»¥è°ƒéŸ³é‡ &lt;img src=&#34;/em/oh.gif&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å‰ç½®çŸ¥è¯†&#34;&gt;å‰ç½®çŸ¥è¯†&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆå¯èƒ½éœ€è¦çŸ¥é“ä¸“æœ‰åè¯ã€Œè‡ªåŠ¨æœºã€çš„å«ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;å¤§è‡´å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œä¸€ä¸ª DAGï¼Œå…¶ä¸­ç‚¹è¡¨ç¤ºçŠ¶æ€ï¼Œè¾¹è¡¨ç¤ºè½¬ç§»ã€‚ç»™è¿›å»ä¸€ä¸ªå­—ç¬¦ä¸²ä¹‹ç±»ï¼Œå°±å¯ä»¥åœ¨ DAG ä¸Šæ¸¸èµ°ï¼Œæ ¹æ®æœ€åæ‰€å¤„ç»“ç‚¹ï¼Œå¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ç›¸å…³ç‰¹å¾ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå®šä¹‰è®©æˆ‘ä»¬æƒ³åˆ°äº† Trieã€‚äº‹å®ä¸Šï¼ŒTrie å°±æ˜¯ä¸€ç§ç›¸å½“åŸºç¡€çš„è‡ªåŠ¨æœºã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¤ä¹  KMP ç›¸å…³æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;å‡æƒ³ä¸€ä¸ªåœºæ™¯ï¼šä½ éœ€è¦æ±‚å¾— &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ‹¥æœ‰ä¸€å®šé¢˜ç›®ç»éªŒçš„ä½ ï¼Œä¼šä½¿ç”¨ KMP æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„ &lt;code&gt;next&lt;/code&gt; æ•°ç»„ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸Šè¿›è¡ŒåŒ¹é…ï¼Œå¤±é…æˆ–å®Œå…¨åŒ¹é…æ—¶å›åˆ° &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨è¯¥å¤„çš„ &lt;code&gt;next&lt;/code&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸Šçš„æŒ‡é’ˆå§‹ç»ˆå‘å³ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ä¸Šçš„æŒ‡é’ˆå¦‚æœå‘å³ï¼Œæ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä½ï¼›å¦‚æœå‘å·¦ï¼Œæœ€å·¦ç§»åˆ°å¼€å¤´ï¼Œå‡æ‘Šä¸‹æ¥å¤æ‚åº¦å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(|S| + |T|)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‡å¦‚åœºæ™¯å˜å¾—æ›´å¤æ‚ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt;ï¼Œä½ éœ€è¦æ±‚å‡ºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; è¿›è¡Œä¸€æ¬¡ KMPï¼Œå¤æ‚åº¦å°†ä¼šä¸Šå‡åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(m|S|)\)&lt;/span&gt;ï¼Œéš¾ä»¥æ‰¿å—ã€‚æœ‰æ²¡æœ‰ä¼˜åŒ–çš„æ–¹æ³•å‘¢ï¼Ÿ&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºçš„å»ºç«‹&#34;&gt;AC è‡ªåŠ¨æœºçš„å»ºç«‹&lt;/h2&gt;
&lt;p&gt;ç»“åˆä¸Šé¢çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¸‹æ„è¯†æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½å°† &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt; å»ºæˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; åœ¨å…¶ä¸Šè¿›è¡Œ KMP å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt; å…¨éƒ¨åŠ å…¥ Trieï¼Œç”±äº &lt;code&gt;next&lt;/code&gt; åªä¼šç”±æ›´æ·±çš„ç‚¹æŒ‡å‘æ›´æµ…çš„ç‚¹ï¼Œä¼¼ä¹ä»ç›´è§‰ä¸Šæ˜¯æœ‰è§„åˆ™çš„ã€‚ä½†éšä¹‹è€Œæ¥çš„æ˜¯ä¸€ä¸ªé—®é¢˜ï¼šç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;next&lt;/code&gt; ä¸ä¸€å®šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\text{root}\to u\)&lt;/span&gt; çš„é“¾ä¸Šï¼ˆç”±äº Trie çš„æ€§è´¨ï¼Œå¯çŸ¥æŒ‡å‘çš„ç‚¹æ˜¯å”¯ä¸€çš„ï¼‰ã€‚é‰´äºè¿™ä¸€ç‚¹ä¸åŒï¼Œæˆ‘ä»¬ç»“åˆå…¶ã€Œå¤±é…æŒ‡é’ˆã€çš„å®šä¹‰ï¼Œå°† &lt;code&gt;next&lt;/code&gt; åœ¨ Trie ä¸Šçš„åŒåˆ†å¼‚æ„ä½“å”¤ä¸º &lt;code&gt;fail&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒå¯Ÿ Trie ä¸Šè¯¥ &lt;code&gt;fail&lt;/code&gt; è¾¹çš„æ€§è´¨ã€‚ç°æ¬²æ±‚è§£ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; æŒ‡å‘çš„ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼Œç»“åˆ KMP ä¸­ &lt;code&gt;next&lt;/code&gt; çš„æ€§è´¨ï¼Œå‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„çˆ¶èŠ‚ç‚¹çš„ &lt;code&gt;fail&lt;/code&gt; è¾¹æŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„å€¼ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt; ä¸Šæœ‰è¾¹æƒç›¸åŒçš„è¾¹ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å°±æ˜¯è¯¥è¾¹æŒ‡å‘çš„ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œå‰å¾€ &lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt;ï¼Œé‡å¤ä»¥ä¸Šåˆ¤å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‚£ä¹ˆå°±å®Œæˆäº†å¤±é…çš„å¤„ç†ã€‚ç›¸åº”åœ°ï¼Œå®Œå…¨åŒ¹é…æ—¶çš„è·³è½¬åº”å¦‚ä½•å¤„ç†ï¼Ÿç›´æ¥å°† &lt;code&gt;fail&lt;/code&gt; çš„å„¿å­å…¨éƒ¨æ¥åˆ° &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸‹é¢å³å¯ã€‚å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å’Œ &lt;code&gt;fail&lt;/code&gt; å…·æœ‰åŒä¸€ä¸ªè¾¹æƒçš„è¾¹æ—¶ï¼Œä¿ç•™ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„è¿™æ¡è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt;ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; å¿…å®šæŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; çš„å¯¹åº”å„¿å­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤ç‚¹ç»“åˆï¼Œæˆ‘ä»¬å‘ç°ä»å®ç°ä¸Šï¼Œå¯ä»¥ç›´æ¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; æŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; çš„å¯¹åº”å„¿å­ï¼ˆé‚£ä¹ˆæ—¶é—´å¤æ‚åº¦æ˜¾è€Œæ˜“è§æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(26\sum |T|)\)&lt;/span&gt; çš„ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åŒ¹é…æ—¶ï¼Œå¯¹äºæ¯ä¸ªç‚¹å’Œå…¶è¿”å›åˆ°æ ¹çš„ &lt;code&gt;fail&lt;/code&gt; é“¾ï¼Œå…¨éƒ¨æ ‡è®°ã€‚åˆ™ä¸€ä¸ªæ¨¡å¼ä¸²åŒ¹é…çš„æ¬¡æ•°å³ä¸ºè¢«æ‰“æ ‡è®°çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥å‘ç° AC è‡ªåŠ¨æœºçš„æœ¬è´¨å°±æ˜¯æ·»åŠ äº† &lt;code&gt;fail&lt;/code&gt; è¾¹çš„ Trieã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;é‚£ä¹ˆæ ¹æ®ä¸Šè¿°è¦æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§æ·±åº¦é¡ºåºæ±‚å¾— &lt;code&gt;fail&lt;/code&gt;ï¼Œè€ƒè™‘ BFSã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å“¦å“¦å¥½ç¥å¥‡å¤æ´»ä¹‹åè®°å¾—å•¥æ˜¯ KMP ä½†å¿˜äº†å•¥æ˜¯ C++ äº†ã€‚ç”šè‡³èŠ±äº†ä¸€ç‚¹æ—¶é—´å­¦ä¹ æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Ÿï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¤§å®¶å†™ AC è‡ªåŠ¨æœº Trie æ ¹èŠ‚ç‚¹ä¸‹æ ‡ä¸€å®šè¦è®¾æˆ 0 å•Š &lt;img src=&#34;/em/ll.gif&#34; /&gt; è®¾æˆ 1 è¢«å„ç§ç»†èŠ‚å‘æƒ¨äº† &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, cnt[maxn], fail[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    &amp;#123;
        int p = 0;
        for (auto i : s) &amp;#123;
            p = T[p][i - &amp;#39;a&amp;#39;];
            for (int fa = p; fa; fa = fail[fa])
                ++cnt[fa];
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; cnt[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;p&gt;è‚‰çœ¼å¯è§è¯¥æŸ¥è¯¢æ–¹å¼æ˜¯æå…¶ä½æ•ˆçš„ï¼Œæ•…è€ƒè™‘ä¼˜åŒ–è·³ &lt;code&gt;fail&lt;/code&gt; æ‰“æ ‡è®°çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶è‡ªåŠ¨æœºç»“æ„ä¸å˜ï¼Œä¸å¦‚å°†è·³ &lt;code&gt;fail&lt;/code&gt; çš„æ­¥éª¤æ”¾åœ¨æœ€åç»Ÿä¸€è¿›è¡Œã€‚å®¹æ˜“åœ¨å‘ç° &lt;code&gt;fail&lt;/code&gt; æ ‘ä¸Šè¿›è¡Œæ‹“æ‰‘æ’åºè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, cnt[maxn], fail[maxn], deg[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    &amp;#123;
        int p = 0;
        for (auto i : s)
            p = T[p][i - &amp;#39;a&amp;#39;], ++cnt[p];
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= tot; ++i)
            if (!deg[i])
                q.push(i);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            cnt[fail[u]] += cnt[u];
            if (!--deg[fail[u]])
                q.push(fail[u]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; cnt[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«&#34;&gt;AC è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“å…¶æœ€å…¸å‹çš„ç‰¹å¾æ˜¯ &lt;strong&gt;å¤šæ¨¡å¼ä¸²&lt;/strong&gt;ã€&lt;strong&gt;é™æ€ / ç¦»çº¿&lt;/strong&gt;ã€‚å½“ç¢°åˆ°ç±»ä¼¼ç‰¹ç‚¹æ—¶ï¼Œå¤§æ¦‚ç‡å°±æ˜¯ AC è‡ªåŠ¨æœºã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œå¯ä»¥è®¾ç½®çš„éš¾ç‚¹æœ‰ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;å­—ç¬¦ä¸²éš¾ç‚¹ï¼Œå’Œå…¶ä»–å­—ç¬¦ä¸²é¢˜å¯è®¾ç½®çš„éš¾ç‚¹ç›¸åŒã€‚&lt;/li&gt;
&lt;li&gt;fail æ ‘ç»´æŠ¤ï¼Œå¯èƒ½ç»“åˆæ•°æ®ç»“æ„ã€æ‹“æ‰‘æ’åºã€æ ‘å½¢ DP ç­‰è€ƒå¯Ÿã€‚&lt;/li&gt;
&lt;li&gt;DP çš„è®¾è®¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡&#34;&gt;å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡&lt;/h2&gt;
&lt;h3 id=&#34;eg.-indie-album&#34;&gt;eg. Indie Album&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1207/G&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1207/G&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¢˜ç›®çš„ã€Œå¯æŒä¹…åŒ–ã€è¯•å›¾è¯¯å¯¼æˆ‘ä»¬ç”¨æ“ä½œä¸²å»ºç«‹è‡ªåŠ¨æœºï¼Œä½†è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¿è¯ç­”æ¡ˆå¯æ±‚æˆ‘ä»¬ä»ç„¶åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸Šå»ºç«‹ ACAMã€‚å®¹æ˜“å‘ç°æ“ä½œä¸²ä»¥ Trie å½¢å¼ç»™å‡ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éå† Trie æ—¶åŒæ—¶å®Œæˆæ¸¸èµ°ï¼Œé€šè¿‡å›æº¯å®Œæˆè¯¢é—®ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾å½“å‰ DFS ä¸­ï¼Œéå†åˆ° Trie æ ‘ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç‚¹å’Œè‡ªåŠ¨æœºä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çŠ¶æ€ï¼Œé‚£ä¹ˆå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç‚¹æ‰€å¯¹åº”çš„ä¸€ä¸ªè¯¢é—®ä¸² &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œç›¸å½“äºè¯¢é—®ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€æœ‰å¤šå°‘ä¸ªåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; å¼•å¯¼çš„ fail æ ‘å­æ ‘ä¸­ã€‚æˆ‘ä»¬æ±‚å‡º fail æ ‘çš„ dfnï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç®€å•ç»Ÿè®¡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 4e5 + 5;
std::vector&amp;lt;int&amp;gt; g[maxn], q[maxn];
int fail[maxn], T[maxn][26], tot, bit[maxn], to[maxn][26], cnt[maxn];
int ins(std::string s) &amp;#123;
    int p = 0;
    for (auto i : s) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int lowbit(int x) &amp;#123;
    return x &amp;amp; -x;
&amp;#125;
void add(int x, int v) &amp;#123;
    for (; x &amp;lt;= tot + 1; x += lowbit(x))
        bit[x] += v;
    return;
&amp;#125;
int ask(int x) &amp;#123;
    int res = 0;
    for (; x; x -= lowbit(x))
        res += bit[x];
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, now = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; id(n + 1);
    for (int i = 1, op; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            std::cin &amp;gt;&amp;gt; t;
            if (!to[0][t - &amp;#39;a&amp;#39;])
                to[0][t - &amp;#39;a&amp;#39;] = ++now;
            ++cnt[to[0][t - &amp;#39;a&amp;#39;]], id[i] = to[0][t - &amp;#39;a&amp;#39;];
        &amp;#125;
        else &amp;#123;
            int j; 
            std::cin &amp;gt;&amp;gt; j &amp;gt;&amp;gt; t;
            if (!to[id[j]][t - &amp;#39;a&amp;#39;])
                to[id[j]][t - &amp;#39;a&amp;#39;] = ++now;
            ++cnt[to[id[j]][t - &amp;#39;a&amp;#39;]], id[i] = to[id[j]][t - &amp;#39;a&amp;#39;];
        &amp;#125;
    &amp;#125;
    int m;
    std::cin &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; tail(m + 1), res(m + 1);
    for (int i = 1, x; i &amp;lt;= m; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; t, tail[i] = ins(t);
        q[id[x]].push_back(i);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]), g[0].push_back(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v), g[fail[v]].push_back(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; dfn(tot + 1), rfn(tot + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now;
        // printf(&amp;quot;%d &amp;quot;, x);
        for (auto i : g[x])
            DFS(i);
        rfn[x] = now;
        return;
    &amp;#125;;
    DFS(0);
    std::function&amp;lt;void(int, int)&amp;gt; DFS1 = [&amp;amp;](int x, int u) &amp;#123;
        add(dfn[u], 1);
        for (auto i : q[x])
            res[i] += ask(rfn[tail[i]]) - ask(dfn[tail[i]] - 1);
        for (int i = 0; i &amp;lt; 26; ++i)
            if (to[x][i])
                DFS1(to[x][i], T[u][i]);
        add(dfn[u], -1);
        return;
    &amp;#125;;
    DFS1(0, 0);
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;fail-æ ‘çš„ç»´æŠ¤&#34;&gt;fail æ ‘çš„ç»´æŠ¤&lt;/h2&gt;
&lt;h3 id=&#34;eg.-divljak&#34;&gt;eg. Divljak&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5840&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5840&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;æ³•ä¸€æŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿&#34;&gt;æ³•ä¸€ï¼šæŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿&lt;/h4&gt;
&lt;p&gt;é—®é¢˜ç›¸å½“äºå°†æ¨¡å¼ä¸² &lt;span class=&#34;math inline&#34;&gt;\(T:\{P\}\)&lt;/span&gt; åŠ¨æ€åŒ–ï¼Œä½†æˆ‘ä»¬ä»å¯ä»¥æ— è„‘ç¦»çº¿ä¸‹æ¥è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åŸæœ¬çš„ç­”æ¡ˆè®¡ç®—è¿‡ç¨‹ï¼Œå³åœ¨ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€åŠå…¶ fail é“¾ä¸Šæ‰“æ ‡è®°ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ç¦»çº¿å¹¶åŒºåˆ†æ ‡è®°çš„æ¥æºï¼ˆå¹¶ä¸”æ ‡è®°ç±»å‹ä¸ºå¸ƒå°”å€¼ï¼‰ï¼Œä¸‹æ„è¯†æƒ³åˆ°ä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹æ¯ä¸ªçŠ¶æ€å»ºç«‹åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œæœ€åæ‹“æ‰‘æ’åºæ—¶ä½¿ç”¨çº¿æ®µæ ‘åˆå¹¶å¤„ç†ä¿¡æ¯ã€‚å®¹æ˜“è¯æ˜æ—¶é—´å¤æ‚åº¦ç›¸è¾ƒåŸæ¥å¤šäº†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ç†è®ºå¯è¡Œï¼Œå¼€å§‹å®è·µ&lt;/del&gt; å‡ºé¢˜äººä¼¼ä¹ä¸æ˜¯å¾ˆå–œæ¬¢çº¿æ®µæ ‘é€‰æ‰‹æ‰€ä»¥å†³å®šå‰¥å¤ºä½ çš„ Memory Limitã€‚æƒ³è¦ç”¨è¿™ç§åšæ³•é€šè¿‡æœ¬é¢˜å¯è§ &lt;a href=&#34;https://www.luogu.com.cn/article/jaxk3sno&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/article/jaxk3sno&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ³•äºŒè½¬è€Œå¤„ç†é™æ€é—®é¢˜&#34;&gt;æ³•äºŒï¼šè½¬è€Œå¤„ç†é™æ€é—®é¢˜&lt;/h4&gt;
&lt;p&gt;æ³¨æ„åˆ°é¢˜ç›®ä¸­çš„é™æ€çš„ &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt; æ¯”èµ· &lt;span class=&#34;math inline&#34;&gt;\(T:\{P\}\)&lt;/span&gt; æ›´é€‚åˆç”¨æ¥åšæ¨¡å¼ä¸²ï¼Œæˆ‘ä»¬åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt; ä¸Šæ„å»º AC è‡ªåŠ¨æœºï¼Œè€ƒè™‘åœ¨çº¿è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¯æ¬¡ &lt;code&gt;1&lt;/code&gt; æ“ä½œæ—¶ï¼Œæ›´æ–°æ¨¡å¼ä¸²ä¿¡æ¯ã€‚å¯¹äºé€”å¾„çš„æ‰€æœ‰çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(\{u\}\)&lt;/span&gt;ï¼Œè€ƒè™‘æ›´æ–°å…¶æ‰€åœ¨ fail é“¾ä¸Šçš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦ä¿®æ”¹æ•´æ¡ fail é“¾ä¸Šçš„ä¿¡æ¯ï¼Œè¯¢é—®åˆ™æ˜¯è¯¢é—®å•ç‚¹ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨æ ‘ä¸Šå·®åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ here comes a problemï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸€æ•´ä¸ªä¸²åªèƒ½åœ¨æ•´ä¸ªæ ‘ä¸Šæ¯ä¸ªç‚¹ä¸Šæ›´æ–°ä¸€æ¬¡ã€‚æ€ä¹ˆæ¶ˆå»ç›¸åŒçš„å½±å“å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå®ç°ä¸Šæˆ‘ä»¬å°†ç»è¿‡çš„ç‚¹æŒ‰ fail æ ‘ä¸Š dfn æ’åºï¼Œå¹¶ä¸”å¯¹äºåºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ç‚¹åœ¨å…¶ LCA ä¸Šå‡å»ä¸€æ¬¡æ ‡è®°ã€‚ä¸ºä»€ä¹ˆè¿™æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿå‚è€ƒè™šæ ‘ï¼Œæˆ‘ä»¬åªéœ€è¦è®©åºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ä¸ªç‚¹å°½é‡è¿‘å°±å¯ä»¥ä¿è¯é‡å¤çš„è¢«åˆ é™¤å®Œæ¯•ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e6 + 5;
int tot, bit[maxn], T[maxn][26], fail[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int lowbit(int x) &amp;#123;
    return x &amp;amp; -x;
&amp;#125;
void add(int x, int v) &amp;#123;
    // printf(&amp;quot;add (%d, %d)\n&amp;quot;, x, v);
    for (; x &amp;lt;= tot + 1; x += lowbit(x))
        bit[x] += v;
    return;
&amp;#125;
int ask(int x) &amp;#123;
    int res = 0, to = x;
    for (; x; x -= lowbit(x))
        res += bit[x];
    // printf(&amp;quot;ask(%d) = %d\n&amp;quot;, to, res);
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, q;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t, tail[i] = ins(t);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(tot + 2);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
        for (int i = 1; i &amp;lt;= tot; ++i)
            g[fail[i] + 1].push_back(i + 1);
    &amp;#125;
    std::vector&amp;lt;std::array&amp;lt;int, 22&amp;gt; &amp;gt; f(tot + 2);
    std::vector&amp;lt;int&amp;gt; dep(tot + 2), dfn(tot + 2), siz(tot + 2);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        siz[x] = 1, dfn[x] = ++now;
        // printf(&amp;quot;%d\n&amp;quot;, x);
        for (auto i : g[x]) &amp;#123;
            dep[i] = dep[x] + 1;
            f[i][0] = x;
            for (int j = 1; j &amp;lt;= 21; ++j)
                f[i][j] = f[f[i][j - 1]][j - 1];
            DFS(i), siz[x] += siz[i];
        &amp;#125;
        return;
    &amp;#125;;
    dep[1] = 1, DFS(1);
    auto askLCA = [&amp;amp;](int x, int y) &amp;#123;
        if (x == y)
            return x;
        if (dep[x] &amp;lt; dep[y])
            std::swap(x, y);
        for (int i = 21; ~i; --i)
            if (dep[f[x][i]] &amp;gt;= dep[y])
                x = f[x][i];
        if (x == y)
            return x;
        for (int i = 21; ~i; --i)
            if (f[x][i] != f[y][i])
                x = f[x][i], y = f[y][i];
        return f[x][0];
    &amp;#125;;
    std::cin &amp;gt;&amp;gt; q;
    for (; q--; ) &amp;#123;
        int op;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            std::string s;
            std::cin &amp;gt;&amp;gt; s;
            int p = 0, len = (int)s.length();
            std::vector&amp;lt;int&amp;gt; id(len + 1);
            for (int i = 1; i &amp;lt;= len; ++i)
                p = T[p][s[i - 1] - &amp;#39;a&amp;#39;], id[i] = p + 1;
            std::sort(id.begin() + 1, id.end(), [&amp;amp;](int x, int y) &amp;#123; return dfn[x] &amp;lt; dfn[y]; &amp;#125;);
            // for (int i = 1; i &amp;lt;= len; ++i)
            //     printf(&amp;quot;%d &amp;quot;, id[i]);
            // puts(&amp;quot;&amp;quot;);
            for (int i = 1; i &amp;lt;= len; ++i) &amp;#123;
                // printf(&amp;quot;%d %d %d\n&amp;quot;, i, id[i], dfn[id[i]]);
                // assert(0);
                add(dfn[id[i]], 1);
                if (i != 1)
                    add(dfn[askLCA(id[i], id[i - 1])], -1);
            &amp;#125;
        &amp;#125;
        else &amp;#123;
            int x;
            std::cin &amp;gt;&amp;gt; x;
            x = tail[x] + 1;
            std::cout &amp;lt;&amp;lt; ask(dfn[x] + siz[x] - 1) - ask(dfn[x] - 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºä¸Šçš„-dp&#34;&gt;AC è‡ªåŠ¨æœºä¸Šçš„ DP&lt;/h2&gt;
&lt;p&gt;é‰´äº AC è‡ªåŠ¨æœºçš„ä¼˜ç§€ç»“æ„ä¸æ€§è´¨ï¼Œå¹¶ä¸ç»å¸¸ä½œä¸ºå­—ç¬¦ä¸²åŒ¹é…å·¥å…·å‡ºç°ï¼Œå…¶ä¸€ä¸ªåº”ç”¨æ˜¯ä½œä¸º DP çš„è½½ä½“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;eg1.-l-è¯­è¨€&#34;&gt;eg1. L è¯­è¨€&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P2292&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P2292&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æƒ³åˆ°è¦åœ¨è‡ªåŠ¨æœºä¸ŠåŒ¹é…ï¼Œä½†æ­¤æ—¶ &lt;code&gt;fail&lt;/code&gt; ä½œä¸ºã€Œæ–­å¥ã€çš„å”¯ä¸€æ‰‹æ®µï¼ˆæ–­å¥çš„ä½ç½®åœ¨é“¾ä¸Šå½“å‰ç‚¹æ·±åº¦ - &lt;code&gt;fail&lt;/code&gt; æ·±åº¦å¤„ï¼‰ï¼Œä¸å†ä»…å½“å¤±é…æ—¶æ‰èƒ½ç»è¿‡ã€‚æˆ‘ä»¬è€ƒè™‘æœ´ç´ çš„ DPï¼šåœ¨ç»è¿‡çš„æ¯ä¸ªçŠ¶æ€è€ƒè™‘æ–­å¥ï¼Œé‚£ä¹ˆè¿™è¦æ±‚æ–­å¥å¤„æ˜¯ä¸€ä¸ªå•è¯çš„ç»“å°¾ï¼Œé‚£ä¹ˆæ­¤æ—¶ &lt;code&gt;fail&lt;/code&gt; æœ€é•¿åŒ¹é…é•¿åº¦å³å¯è¢«æ›´æ–°ã€‚æœ€åéå†æ‰€æœ‰å•è¯çš„æœ«ç»“ç‚¹ï¼Œå–æœ€å¤§ç­”æ¡ˆã€‚è¿™é‡Œçš„ &lt;code&gt;fail&lt;/code&gt; å…¶å®æ˜¯ &lt;code&gt;fail&lt;/code&gt; é“¾ä¸Šä»»æ„ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¤æ‚åº¦ã€‚å®¹æ˜“å‘ç°å¯¹äºæ¯ä¸€ä¸ªç‚¹æˆ‘ä»¬è·³äº†å…¶æ•´æ¡ fail é“¾ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±æ˜¯æœ€åŠ£ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; çš„ã€‚è€ƒè™‘ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹è‡³ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¢˜ç›®é‡Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¡ä»¶è¿˜æ²¡æœ‰ç”¨åˆ°ï¼šå•ä¸ªå•è¯é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\le 20\)&lt;/span&gt;ï¼Œè¿™è®©æˆ‘ä»¬æƒ³åˆ°çŠ¶æ€å‹ç¼©ã€‚å¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼Œè®°å½•å…¶æ–­å‡ºæ¥å•è¯çš„å¯èƒ½é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ DAG ä¸Šæ¸¸èµ°çš„æ—¶å€™è®°å½•ç›®å‰å¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ï¼Œå¦‚æœå…¶å’Œå½“å‰å¯æ–­å‡ºæ¥çš„é•¿åº¦ä¹‹äº¤ä¸ä¸ºç©ºï¼Œå°±å¯ä»¥å°†æ­¤å¤„åŠ å…¥ã€Œå¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ã€å¹¶æ›´æ–°ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, fail[maxn], len[maxn], dep[maxn], tag[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot, dep[tot] = dep[p] + 1;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    ++tag[p];
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            len[u] = len[fail[u]];
            if (tag[u])
                len[u] |= (1 &amp;lt;&amp;lt; dep[u]);
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    for (; m--; ) &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s;
        int p = 0, q = 1, res = 0;
        for (int i = 0; i &amp;lt; (int)s.length(); ++i) &amp;#123;
            p = T[p][s[i] - &amp;#39;a&amp;#39;], q &amp;lt;&amp;lt;= 1;
            if (len[p] &amp;amp; q)
                q |= 1, res = i + 1;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg2.-popcount-words&#34;&gt;eg2. Popcount Words&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/gym/103409/problem/H&#34; class=&#34;uri&#34;&gt;https://codeforces.com/gym/103409/problem/H&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;å’‹ä¸Šå¼ºåº¦äº†å•Šã€‚&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;å…ˆæŠŠæ•´ä¸ªåºåˆ—å†™å‡ºæ¥ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(w=\texttt{01101001100101}\cdots\)&lt;/span&gt;ï¼Œå°è¯•è¿›ä¸€æ­¥æ¢ç©¶å½¢å¼åŒ–çš„è§„å¾‹ï¼Œå¯ä»¥å¾—åˆ°ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(w_{[0, 2^n), 0}=w_{[0, 2^{n-1}),0}+w_{[0, 2^n), 1}\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(w_{[l, r], 0/1}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; å†…ï¼ŒåŸä¸² / å–åçš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºä¸ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å¤´çš„æ•´æ®µï¼Œå¯ä»¥ä»ä¸Šè¿°è§„åˆ™è½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å¤´çš„æ•´æ®µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¥ç€ä¸éš¾æƒ³åˆ°ä¸€ç§ç±»ä¼¼çº¿æ®µæ ‘çš„æ–¹å¼ï¼Œå°†å¾…æ±‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(w_{[l, r], 0}\)&lt;/span&gt; åˆ†åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(\log V)\)&lt;/span&gt; ä¸ªæ•´æ®µä¸Šï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å°±å¯ä»¥è¢« &lt;span class=&#34;math inline&#34;&gt;\(O(n\log V)\)&lt;/span&gt; ä¸ªæ•´æ®µï¼ˆä¹Ÿæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\log V\)&lt;/span&gt; ä¸ªæœ¬è´¨ä¸åŒæ•´æ®µï¼‰æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹ &lt;span class=&#34;math inline&#34;&gt;\({p_m}\)&lt;/span&gt; å»ºç«‹ AC è‡ªåŠ¨æœºï¼Œéœ€è¦çŸ¥é“è¿™ &lt;span class=&#34;math inline&#34;&gt;\(\log V\)&lt;/span&gt; ä¸ªæ•´æ®µåœ¨æ¯ä¸ªç‚¹ä¸Šçš„å‡ºç°æ¬¡æ•°ã€‚å¯¹äºè‡ªåŠ¨æœºä¸Šä»»æ„çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(to_{u, n, 0/1}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(w_{[0, 2^n), 0/1}\)&lt;/span&gt; ååˆ°è¾¾çš„ç‚¹ï¼Œåˆ™å¯å€å¢ï¼ˆå˜¶ï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯åº”è¯¥åè¿‡æ¥å«åˆ†æ²»å•Šï¼‰ç®€å•è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(to\)&lt;/span&gt; æ¥è¿›è¡Œå¿«é€Ÿæ¸¸èµ°äº†ã€‚é¡ºä¾¿æ‰“ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(cnt\)&lt;/span&gt; è®°å½•ä¸€ä¸‹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä½œä¸ºä¸åŒæ•´æ®µçš„å¼€å¤´è¢«ç»è¿‡çš„æ¬¡æ•°ã€‚ç„¶ååšä¸€ä¸ª DPï¼Œç±»ä¼¼äºçº¿æ®µæ ‘ä¸Š &lt;code&gt;pushdown&lt;/code&gt; çš„æ“ä½œæŠŠæ‰€æœ‰æ•´æ®µä¸‹æ”¾åˆ°å•ç‚¹ä¸Šçš„å•ä¸ªå­—ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€è¯´ä¸€ç”¨ DP æ¥å¤„ç†è¿™ä¸ªä¸œè¥¿è¿˜æŒºéš¾æƒ³çš„ã€‚å¯èƒ½ä¹Ÿæ˜¯åŸºäºå‰é¢çš„å€å¢å§ã€‚æœ€åæ‹“æ‰‘æ’åºå°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å¤§å®¶æ•°ç»„ä¸€å®šè¦ç”¨ C-style array å•Šï¼Œ&lt;code&gt;std::vector&amp;lt;&amp;gt;&lt;/code&gt; è®¡ç®—çš„æ˜¯ç”³è¯·ç©ºé—´åŒ… MLE çš„ &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¤§å®¶å¤§æ•°ç»„ä¸€å®šè¦å†…å­˜è¿ç»­è®¿é—®ä¼˜åŒ–å•Šï¼ŒTLE &lt;span class=&#34;math inline&#34;&gt;\(\to\)&lt;/span&gt; 100ms æ³ªç›®äº† &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e5 + 5;
long long sum[maxn], f[2][30][maxn];
int cnt[2][30][maxn], to[2][30][maxn];
int T[maxn][2], tot, fail[maxn], deg[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;0&amp;#39;])
            T[p][i - &amp;#39;0&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;0&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
void ask(std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;amp;s, int ql, int qr, int l = 0, int r = (1 &amp;lt;&amp;lt; 30) - 1, int len = 30, int v = 0) &amp;#123;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr) &amp;#123;
        s.emplace_back(len, v);
        return;
    &amp;#125;
    int mid = l + (r - l) / 2;
    if (ql &amp;lt;= mid)
        ask(s, ql, qr, l, mid, len - 1, v);
    if (qr &amp;gt; mid)
        ask(s, ql, qr, mid + 1, r, len - 1, v ^ 1);
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; s;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int l, r;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        ask(s, l, r);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tail(m + 1);
    for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t;
        tail[i] = ins(t);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 2; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 2; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    for (int i = 0; i &amp;lt;= tot; ++i)
        to[0][0][i] = T[i][0], to[1][0][i] = T[i][1];
    for (int j = 1; j &amp;lt; 30; ++j)
        for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
            to[0][j][i] = to[1][j - 1][to[0][j - 1][i]];
            to[1][j][i] = to[0][j - 1][to[1][j - 1][i]];
        &amp;#125;
    &amp;#123;
        int p = 0;
        for (auto [n, i] : s) &amp;#123;
            // printf(&amp;quot;# %d %d\n&amp;quot;, n, i);
            ++cnt[i][n][p], p = to[i][n][p];
        &amp;#125;
    &amp;#125;
    for (int j = 29; ~j; --j)
        for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
            if (j != 29) &amp;#123;
                f[0][j][i] += f[0][j + 1][i];
                f[1][j][i] += f[1][j + 1][i];
                f[0][j][to[1][j][i]] += f[1][j + 1][i];
                f[1][j][to[0][j][i]] += f[0][j + 1][i];
            &amp;#125;
            f[1][j][i] += cnt[1][j][i];
            f[0][j][i] += cnt[0][j][i];
        &amp;#125;
    for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
        sum[T[i][0]] += f[0][0][i], sum[T[i][1]] += f[1][0][i];
        // printf(&amp;quot;%d %d\n&amp;quot;, f[i][0][0], f[i][0][1]);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt;= tot; ++i)
            if (!deg[i])
                q.push(i);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            sum[fail[u]] += sum[u];
            if (!--deg[fail[u]])
                q.push(fail[u]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; sum[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg3.-legen&#34;&gt;eg3. Legenâ€¦&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/696/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/696/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…ˆåœ¨ fail æ ‘ä¸ŠæŠŠæ¯ä¸ªçŠ¶æ€çš„å®é™…ä»·å€¼è®¡ç®—å‡ºæ¥ã€‚æˆ‘ä»¬å‘ç°åŒ¹é…ä¸²æ˜¯æœªçŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦ä¸»åŠ¨å†³å®šæ¸¸èµ°è·¯å¾„ã€‚æ³¨æ„åˆ° &lt;span class=&#34;math inline&#34;&gt;\(l=10^{14}\)&lt;/span&gt;ï¼Œè€ƒè™‘çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{u, i}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çŠ¶æ€æ—¶å·²ç»èµ°äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ­¥ï¼Œå¯ä»¥å¾—åˆ°çš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{v,i+1}=f_{u,i}+s_v.
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ˜¯è‡ªåŠ¨æœºä¸Š &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ä»»æ„å‡ºè¾¹ã€‚å›¾çš„å¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(200\)&lt;/span&gt;ï¼Œå¯ä»¥æ”¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(+\max\)&lt;/span&gt; çŸ©é˜µé‡ŒåŠ é€Ÿè½¬ç§»ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
const long long inf = 1e18;
int fail[maxn], T[maxn][26], tot;
int ins(std::string s) &amp;#123;
    int p = 0;
    for (auto i : s) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
struct matrix &amp;#123;
    int n, m;
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; a;
    matrix(int n1, int m1, long long v = -inf, bool op = 0): n(n1), m(m1), a(n + 1, std::vector&amp;lt;long long&amp;gt; (m + 1, v)) &amp;#123;
        if (op)
            for (int i = 0; i &amp;lt;= n; ++i)
                a[i][i] = 0;
        return;
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; &amp;amp;operator[] (int i) &amp;#123;
        return a[i];
    &amp;#125;
    matrix operator* (matrix &amp;amp;q) const &amp;#123;
        matrix res(n, q.m);
        for (int k = 0; k &amp;lt;= m; ++k)
            for (int i = 0; i &amp;lt;= n; ++i)
                for (int j = 0; j &amp;lt;= q.m; ++j)
                    res[i][j] = std::max(res[i][j], a[i][k] + q[k][j]);
        return res;
    &amp;#125;
    matrix&amp;amp; operator*= (matrix q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
    matrix operator^ (long long q) &amp;#123;
        matrix res(n, n, -inf, 1), x(*this);
        for (; q; q &amp;gt;&amp;gt;= 1, x *= x)
            if (q &amp;amp; 1)
                res *= x;
        return res;
    &amp;#125;
&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    long long m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; t[i];
        tail[i] = ins(t[i]);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; s(tot + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        s[tail[i]] += a[i];
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]); 
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], s[v] += s[fail[v]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    matrix f(0, tot), op(tot, tot);
    f[0][0] = 0;
    for (int i = 0; i &amp;lt;= tot; ++i)
        for (int j = 0; j &amp;lt; 26; ++j)
            op[i][T[i][j]] = s[T[i][j]];
    f *= (op * m);
    std::cout &amp;lt;&amp;lt; *std::max_element(f[0].begin(), f[0].end()) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg4.-you-are-given-some-strings&#34;&gt;eg4. You Are Given Some Stringsâ€¦&lt;/h3&gt;
&lt;p&gt;goto &lt;a href=&#34;/20250121/#%E4%B8%80%E4%B8%AA%E6%A8%A1%E6%9D%BFcf1202e-you-are-given-some-strings...&#34;&gt;link&lt;/a&gt;.&lt;/p&gt;
</content>
        <category term="DP" />
        <category term="å­—ç¬¦ä¸²" />
        <category term="AC è‡ªåŠ¨æœº" />
        <updated>2025-01-20T03:21:15.000Z</updated>
    </entry>
</feed>
