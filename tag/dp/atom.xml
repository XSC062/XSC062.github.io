<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xsc062.netlify.app</id>
    <title> â€¢ Posts by &#34;dp&#34; tag</title>
    <link href="https://xsc062.netlify.app" />
    <updated>2025-10-07T08:29:43.000Z</updated>
    <category term="å¹¶æŸ¥é›†" />
    <category term="æ–œç‡ä¼˜åŒ–" />
    <category term="æ‚¬çº¿æ³•" />
    <category term="å“ˆå¸Œ" />
    <category term="å­—å…¸æ ‘" />
    <category term="DP" />
    <category term="å•è°ƒé˜Ÿåˆ—" />
    <category term="åˆ†æ²»" />
    <category term="è®¡æ•°" />
    <category term="å®¹æ–¥" />
    <category term="äºŒåˆ†å›¾" />
    <category term="CRT / exCRT" />
    <category term="æ’åˆ—ç»„åˆ" />
    <category term="ç½‘ç»œæµ" />
    <category term="äºŒåˆ†" />
    <category term="å®¹æ–¥åŸç†" />
    <category term="çº¿æ®µæ ‘" />
    <category term="æ ‘çŠ¶æ•°ç»„" />
    <category term="åŒºé—´ DP" />
    <category term="æ„é€ " />
    <category term="æ•°æ®ç»“æ„" />
    <category term="Tarjan" />
    <category term="ä¸‹é¥­" />
    <category term="æè¶…çº¿æ®µæ ‘" />
    <category term="æ ‘é“¾å‰–åˆ†" />
    <category term="LCA" />
    <category term="å€å¢" />
    <category term="é¸½å·¢åŸç†" />
    <category term="æ•°å­¦" />
    <category term="è°ƒå’Œçº§æ•°" />
    <category term="å·®åˆ†" />
    <category term="æ€ç»´" />
    <category term="æ ‘å½¢ DP" />
    <category term="æœ€å°ç”Ÿæˆæ ‘" />
    <category term="çŠ¶å‹" />
    <category term="é«˜ç»´å‰ç¼€å’Œ" />
    <category term="SAM" />
    <category term="åˆ†å—" />
    <category term="å¯æŒä¹…åŒ–" />
    <category term="ç¬›å¡å°”æ ‘" />
    <category term="é—²è¯" />
    <category term="æ¬§æ‹‰å›è·¯" />
    <category term="é•¿é“¾å‰–åˆ†" />
    <category term="KMP" />
    <category term="border" />
    <category term="éšæœºåŒ–" />
    <category term="å­—ç¬¦ä¸²" />
    <category term="AC è‡ªåŠ¨æœº" />
    <category term="SA" />
    <category term="æ ‘ä¸Šå·®åˆ†" />
    <category term="FWT" />
    <category term="å †" />
    <category term="æ ‘çš„é‡å¿ƒ" />
    <category term="è´ªå¿ƒ" />
    <category term="å‡æ‘Š" />
    <category term="ä¼˜åŒ–å»ºå›¾" />
    <category term="åæ‚”è´ªå¿ƒ" />
    <category term="è°ƒæ•´æ³•" />
    <category term="èƒŒåŒ…" />
    <category term="åšå¼ˆè®º" />
    <category term="DP ä¼˜åŒ–" />
    <category term="è™šæ ‘" />
    <category term="ç‚¹åˆ†æ²»" />
    <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
    <category term="æ”¯é…å¯¹" />
    <category term="DDP" />
    <category term="CDQ åˆ†æ²»" />
    <category term="çŒ«æ ‘" />
    <category term="DP å¥— DP" />
    <category term="Kruskal é‡æ„æ ‘" />
    <category term="é«˜ç²¾åº¦" />
    <category term="æœ€çŸ­è·¯" />
    <category term="æ ‘å¥—æ ‘" />
    <category term="äºŒé¡¹å¼åæ¼”" />
    <category term="æœç´¢" />
    <entry>
        <id>https://xsc062.netlify.app/20251007/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20251007/"/>
        <content type="html">&lt;p&gt;è¿‘æœŸæ¨¡æ‹Ÿèµ›&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-è€ƒè¯•&#34;&gt;A. è€ƒè¯•&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6624/problem/1&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6624/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; é“é¢˜ï¼Œåˆ†æ•°æ˜¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„æ’åˆ—ï¼ˆåˆå§‹æœªçŸ¥ï¼‰ï¼Œåšå¯¹å¾—æ»¡åˆ†ï¼Œåšé”™å¾— 0 åˆ†&lt;/p&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªäººå¯¹äºè¿™ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªé¢˜çš„è¿‡é¢˜æƒ…å†µçŸ©é˜µï¼Œä¸”ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªäººæœ‰ä¸€ä¸ªé¢„æœŸåˆ†æ•° &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ±‚æ¯åˆ°é¢˜çš„åˆ†æ•°ï¼Œä½¿å¾—æ¯ä¸ªäººå®é™…å¾—åˆ†ä¸æœŸæœ›çš„åˆ†å·®çš„ç»å¯¹å€¼ä¹‹å’Œæœ€å¤§ã€‚è¾“å‡ºè¯¥æ’åˆ—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10,m\le 10^4\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ç»å¯¹å€¼æ˜¯è´ªå¿ƒä¸€ä¸ªå¾ˆå¤§çš„é˜»ç¢&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¸€ä¸ªå…¸å‹çš„ã€é’¦å®šã€å‹è´ªå¿ƒï¼Œæšä¸¾æ¯ä¸ªäººçš„ç»å¯¹å€¼æ˜¯å¦å–åï¼Œå°±å¯ä»¥å¾—åˆ°æ¯ä¸ªé¢˜å¯¹åº”çš„ç³»æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºã€å°±ç®—é”™äº†ä¹Ÿä¸ä¼šå½±å“æœ€ä¼˜è§£ã€ï¼Œæ‰€ä»¥æ˜¯å¯¹çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;test.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;test.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, m;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
        std::vector&amp;lt;int&amp;gt; s(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; s[i];
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; pos(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
                char t;
                std::cin &amp;gt;&amp;gt; t;
                if (t == &amp;#39;1&amp;#39;)
                    pos[i].push_back(j);
            &amp;#125;
        auto res = 0ll;
        int siz = 1 &amp;lt;&amp;lt; n;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; id(2 * n + 1);
        std::vector&amp;lt;int&amp;gt; cnt(m + 1), ans(m + 1), p(m + 1);
        for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
            std::fill(cnt.begin() + 1, cnt.end(), 0);
            for (int j = 0; j &amp;lt;= 2 * n; ++j)
                id[j].clear();
            for (int j = 1; j &amp;lt;= n; ++j)
                if ((i &amp;gt;&amp;gt; (j - 1)) &amp;amp; 1)
                    for (auto k : pos[j])
                        ++cnt[k];
                else
                    for (auto k : pos[j])
                        --cnt[k];
            for (int j = 1; j &amp;lt;= m; ++j)
                id[cnt[j] + n].push_back(j);
            for (int i = 2 * n, k = m; ~i; --i)
                for (auto j : id[i])
                    p[j] = k--;
            auto now = 0ll;
            for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
                int sum = 0;
                for (auto j : pos[i])
                    sum += p[j];
                now += std::abs(sum - s[i]);
            &amp;#125;
            if (now &amp;gt;= res)
                res = now, ans = p;
        &amp;#125;
        // std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        for (int i = 1; i &amp;lt;= m; ++i)
            std::cout &amp;lt;&amp;lt; ans[i] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
        std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-å›´æ£‹&#34;&gt;B. å›´æ£‹&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6624/problem/2&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6624/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n \times n\)&lt;/span&gt; çš„æ£‹ç›˜ï¼Œä¸Šé¢æœ‰é»‘æ£‹ã€ç™½æ£‹å’Œç©ºåœ°ï¼Œå®šä¹‰ç™½æ£‹çš„ã€æ°”ã€ä¸ºå››ä¸ªæ–¹å‘ç©ºåœ°çš„æ•°é‡ï¼Œè‹¥ä¸€ä¸ªç™½æ£‹å››è¿é€šå—ä¸­æ‰€æœ‰ç™½æ£‹çš„ã€æ°”ã€éƒ½ä¸º 0ï¼Œåˆ™è®¤ä¸ºè¿™ä¸ªç™½æ£‹å››è¿é€šå—ä¸­çš„æ‰€æœ‰ç™½æ£‹æ˜¯ã€æ­»çš„ã€ã€‚&lt;/p&gt;
&lt;p&gt;ç°æšä¸¾æ¯ä¸ªæ£‹å­ï¼Œå¹¶å°†å…¶åè½¬é¢œè‰²ï¼Œé—®ã€æ­»çš„ã€ç™½æ£‹æ•°é‡ã€‚æ“ä½œæ˜¯ç‹¬ç«‹çš„ã€‚&lt;/p&gt;
&lt;p&gt;3sï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^3\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;åˆ†è®¨é¢˜ï¼Œéœ€è¦æƒ³æ¸…æ¥šã€‚é¦–å…ˆéœ€è¦ä¸€æ¬¡ floodfill å®ŒæˆæŸ“è‰²ï¼Œè®°å½•å“ªäº›è¿é€šå—æ­»äº†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è‹¥åè½¬é»‘æ£‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è‹¥é»‘æ£‹è‡ªå·±æœ‰æ°”ï¼Œæˆ–å’Œé»‘æ£‹ç›¸è¿çš„ç™½æ£‹å››è¿é€šå—æœ‰æ°”ï¼Œé‚£ä¹ˆé»‘æ£‹è‡ªå·±ï¼Œä»¥åŠæ‰€æœ‰å’Œé»‘æ£‹ç›¸è¿çš„ç™½æ£‹å››è¿é€šå—éƒ½æ˜¯æ´»çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶éœ€è¦æ‰¾åˆ°æ‰€æœ‰å’Œé»‘æ£‹ç›¸è¿çš„ï¼Œä¸”æ­»äº†çš„ç™½æ£‹å››è¿é€šå—çš„å¤§å°ï¼Œç­”æ¡ˆéœ€è¦å‡å»ä¹‹ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¦åˆ™ï¼Œé»‘æ£‹è‡ªèº«è´¡çŒ® &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è‹¥åè½¬ç™½æ£‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ç™½æ£‹æœ¬èº«æ˜¯æ­»çš„ï¼šç­”æ¡ˆ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¦åˆ™ï¼Œéœ€è¦è€ƒè™‘æœ‰å¤šå°‘ä¸ªåŸæœ¬æ˜¯æ´»çš„ç™½æ£‹æ­¤æ—¶ä¸æœ‰æ°”çš„ç™½æ£‹ä¸è¿é€šï¼Œè¿™ç§æƒ…å†µå‘ç”Ÿå½“ä¸”ä»…å½“æœ‰æ°”çš„ç™½æ£‹æ˜¯è¢«åè½¬çš„ç™½æ£‹è‡ªèº«ï¼Œæˆ–è€…è¢«åè½¬çš„ç™½æ£‹æ˜¯å‰²ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå¥‡å¦™çš„ä¸€ä¸ªæƒ³æ³•æ˜¯å»ºç«‹è¶…çº§æºç‚¹ï¼Œå‘æ‰€æœ‰ç©ºåœ°è¿è¾¹ï¼Œå†å»ºåœ†æ–¹æ ‘ï¼Œè¿™æ ·è¿™ä¸ªç‚¹çš„æ‰€æœ‰å„¿å­å°±æ˜¯å¾…æ±‚ã€‚åœ†æ–¹æ ‘å¹¶ä¸éœ€è¦æ˜¾å¼åœ°å»ºå‡ºæ¥ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»£ç ï¼šä¸ä¼š&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-ç›¸äº’æŠµæ¶ˆ&#34;&gt;C. ç›¸äº’æŠµæ¶ˆ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6624/problem/3&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6624/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¬¡æ“ä½œï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;åŒºé—´åŠ ã€‚&lt;/li&gt;
&lt;li&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(l,r\)&lt;/span&gt;ï¼ŒæŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(\left(\sum\limits_{i=l}^r\sum\limits_{j=i}^r ((\sum_{k=i}^j a_k)^2 + (r-l+2)\times(j-i)\times a_i\times a_j)\right) \bmod 998244353\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,m\le 5\times 10^5\)&lt;/span&gt;ï¼Œå¼ºåˆ¶åœ¨çº¿ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;é¢˜ç›®åå­—æ˜¯çœŸåœ¨é™ä½éš¾åº¦å§ï¼Œå¼ºåˆ¶åœ¨çº¿å°±æ’é™¤ç¦»çº¿å†å²å’Œäº†ï¼›çŒœæµ‹è¯¢é—®æ‰€æ±‚å¯ä»¥åŒ–æˆä¸€ä¸ªæ¯”è¾ƒç®€å•çš„ä¸œè¥¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ¨ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;p&gt;ï¼ˆçœç•¥ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
=-\left(\sum_{i=l}^r i\cdot a_i\right)^2 + (1-l)(r+1)\left(\sum_{i=l}^r a_i\right)^2+(l+r)\left(\sum_{i=l}^r i\cdot a_i\right)\left(\sum_{i=l}^r a_i\right)
\]&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æ•…çº¿æ®µæ ‘ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(\sum a_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\sum i\cdot a_i\)&lt;/span&gt; å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;/20251010/#excercise&#34;&gt;å®é™…ä¸Šå¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤&lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;p&gt;å–œææœ€ä¼˜è§£ï¼Œä¸å¾—ä¸è¯´ bit çš„é€Ÿåº¦ä¼˜åŠ¿è¿˜æ˜¯å¾ˆæ˜æ˜¾çš„ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353; 
const int inv2 = (mod + 1) &amp;gt;&amp;gt; 1;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;offset.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;offset.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;./test/20251008/offset/ex_offset5.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T, n, q;
    std::cin &amp;gt;&amp;gt; T &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q;
    std::vector&amp;lt;long long&amp;gt; bit(n + 1), bit1(n + 1), bit2(n + 1);
    auto lowbit = [&amp;amp;](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](long long x, long long v) &amp;#123;
        auto v1 = x * v % mod, v2 = x * x % mod * v % mod;
        for (; x &amp;lt;= n; x += lowbit(x)) &amp;#123;
            (bit[x] += v) %= mod;
            (bit1[x] += v1) %= mod;
            (bit2[x] += v2) %= mod;
        &amp;#125;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](long long x) &amp;#123;
        auto res = 0ll, res1 = 0ll, res2 = 0ll;
        for (int i = x; i; i -= lowbit(i))
            (res += bit[i]) %= mod, (res1 += bit1[i]) %= mod, (res2 += bit2[i]) %= mod;
        return std::make_pair(((x + 1) * res + mod - res1) % mod, (x * (x + 1) % mod * res % mod + res1 + mod - res2) * inv2 % mod);
    &amp;#125;;
    for (int i = 1, x; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; x, add(i, x), add(i + 1, mod - x);
    for (int op; q--; ) &amp;#123;
        static auto la = 0ll;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            int l, r, d;
            std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r &amp;gt;&amp;gt; d;
            if (T == 1)
                l ^= la, r ^= la, d ^= la;
            add(l, d), add(r + 1, mod - d);
        &amp;#125;
        else &amp;#123;
            long long l, r;
            std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
            if (T == 1)
                l ^= la, r ^= la;
            auto t1 = ask(r), t2 = ask(l - 1);
            auto res1 = t1.first + mod - t2.first, res2 = t1.second + mod - t2.second;
            la = (mod - res2 * res2 % mod + mod - (l - 1) * (r + 1) % mod * res1 % mod * res1 % mod + (l + r) * res1 % mod * res2 % mod) % mod;
            std::cout &amp;lt;&amp;lt; la &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-happylovelyeveryday&#34;&gt;A. HappyÂ·LovelyÂ·Everyday!&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6639/problem/1&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6639/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ 01 åºåˆ—ï¼Œå¯ä»¥æ‰§è¡Œä»»æ„æ¬¡ï¼ˆå¯ä»¥ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼‰ã€æŠŠç›¸é‚»ä¸¤ä¸ªæ•°åˆå¹¶ä¸ºå…¶å¼‚æˆ–å€¼ã€çš„æ“ä½œï¼Œé—®æœ€ç»ˆèƒ½å¾—åˆ°çš„æœ¬è´¨ä¸åŒçš„åºåˆ—ä¸ªæ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºä¸€ä¸ªæœ€ç»ˆåºåˆ—ï¼Œå¦‚æœè®¤ä¸ºå®ƒæ˜¯ç”±æŸä¸ªå­˜æ´»å…ƒç´ ã€åå¹¶ã€å®ƒå·¦ä¾§çš„è¿ç»­æ­»äº¡å…ƒç´ å¾—åˆ°çš„ï¼Œä¼šå‘ç°æœ€ç»ˆåºåˆ—ä¸­ï¼Œæ­¤å¤„çš„å‰ç¼€å¼‚æˆ–å€¼å°±æ˜¯åŸåºåˆ—çš„å‰ç¼€å¼‚æˆ–å€¼ã€‚&lt;/li&gt;
&lt;li&gt;ç»å…¸ trickï¼šå‰ç¼€å’Œå¯ä»¥å”¯ä¸€å¯¹åº”åŸæ•°ç»„ã€‚æ‰€ä»¥ã€æœ€ç»ˆæœ¬è´¨ä¸åŒåºåˆ—ã€ä¼šå’Œã€åŒ…å«ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå…ƒç´ çš„ï¼ŒåŸåºåˆ—å‰ç¼€å¼‚æˆ–å’Œçš„æœ¬è´¨ä¸åŒå­åºåˆ—ã€å½¢æˆåŒå°„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç»Ÿè®¡åŒ…å«ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå…ƒç´ çš„ï¼ŒåŸåºåˆ—å‰ç¼€å¼‚æˆ–å’Œçš„æœ¬è´¨ä¸åŒå­åºåˆ—å³å¯ã€‚å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;How to æœ¬è´¨ä¸åŒå­åºåˆ—ï¼Ÿ&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤º DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œä¸”å¼ºåˆ¶é€‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æœ¬è´¨ä¸åŒå­åºåˆ—æ•°é‡ï¼Œè®° &lt;span class=&#34;math inline&#34;&gt;\(pre_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å‰é©±ï¼ˆæ²¡æœ‰åˆ™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼‰ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_0=1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_i\gets \sum\limits_{j=pre_i}^{i-1} f_{j}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ–ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤º DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶ï¼ˆä¸å¼ºåˆ¶é€‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼‰æœ¬è´¨ä¸åŒå­åºåˆ—æ•°é‡ï¼Œè®° &lt;span class=&#34;math inline&#34;&gt;\(pre_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å‰é©±ï¼ˆæ²¡æœ‰åˆ™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼‰ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_0=0\)&lt;/span&gt;ï¼Œé‚£ä¹ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_i=\begin{cases}
2\cdot f_{i-1}+1&amp;amp;pre_i= 0\\
2\cdot f_{i-1}-f_{pre_i-1}&amp;amp;\text{otherwise}
\end{cases}
\]&lt;/span&gt;&lt;/p&gt;
&lt;/details&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;How to å¼ºåˆ¶é€‰ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå…ƒç´ çš„æœ¬è´¨ä¸åŒå­åºåˆ—ï¼Ÿ&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤º DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œä¸”å¼ºåˆ¶é€‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æœ¬è´¨ä¸åŒå­åºåˆ—æ•°é‡ï¼Œåˆ™ç­”æ¡ˆä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum\limits_{a_i=a_n} f_i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ–ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤º DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œä¸”ä¸å¼ºåˆ¶é€‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æœ¬è´¨ä¸åŒå­åºåˆ—æ•°é‡ï¼Œåˆ™ç­”æ¡ˆä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum\limits_{a_i=a_n}\begin{cases}
f_{i-1}+1&amp;amp;pre_i= 0\\
f_{i-1}-f_{pre_i-1}&amp;amp;\text{otherwise}
\end{cases}
\]&lt;/span&gt;&lt;/p&gt;
&lt;/details&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;a.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;a.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;./test/20251014/a/a1.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s;
        int n = (int)s.length();
        s = &amp;quot;#&amp;quot; + s;
        std::vector&amp;lt;int&amp;gt; a(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            a[i] = a[i - 1] ^ (s[i] - &amp;#39;0&amp;#39;);
        auto res = 0ll;
        std::vector&amp;lt;long long&amp;gt; f(n + 1), la(2);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            if (la[a[i]])
                f[i] = (2 * f[i - 1] + mod - f[la[a[i]] - 1]) % mod;
            else
                f[i] = (2 * f[i - 1] + 1) % mod;
            if (a[i] == a[n]) &amp;#123;
                if (la[a[i]])
                    res += (f[i - 1] + mod - f[la[a[i]] - 1]) % mod;
                else
                    res += f[i - 1] + 1;
            &amp;#125;
            la[a[i]] = i;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; res % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-æ•¬å¯è‡´é‚£æ—¶çš„æˆ‘&#34;&gt;B. æ•¬å¯ï¼Œè‡´é‚£æ—¶çš„æˆ‘&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6639/problem/2&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6639/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(f_0=f_1=1,f_i=f_{i-1}+f_{i-2}\)&lt;/span&gt;ï¼Œç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n,k\)&lt;/span&gt;ï¼Œæ±‚ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\left(\sum_{i=0}^n f_{i}\cdot [\text{popcount}(i)=k]\right)\bmod 10^9+7
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 2^{2000},0\le k\le \log_2(n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘æ•°ä½ DPï¼Œé‚£ä¹ˆéœ€è¦èƒ½å¤Ÿç”± &lt;code&gt;...xxx&lt;/code&gt; å‘ &lt;code&gt;...0xxx&lt;/code&gt; å’Œ &lt;code&gt;...1xxx&lt;/code&gt; è½¬ç§»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ˜¾ç„¶åªå…³å¿ƒå‘ &lt;code&gt;...1xxx&lt;/code&gt; çš„è½¬ç§»ï¼Œé‚£ä¹ˆéœ€è¦å†è½¬ç§» &lt;span class=&#34;math inline&#34;&gt;\(2^{?}\)&lt;/span&gt; æ¬¡ï¼Œè®°å½•è½¬ç§»çŸ©é˜µçš„ &lt;span class=&#34;math inline&#34;&gt;\(2^{?}\)&lt;/span&gt; æ¬¡æ–¹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€æ­¥ä¹Ÿå¯ä»¥ä¸ç”¨çŸ©é˜µï¼Œè€Œæ˜¯ç”¨æ–æ³¢é‚£å¥‘ &lt;span class=&#34;math inline&#34;&gt;\(f(ab)=...\)&lt;/span&gt; çš„æ€§è´¨ï¼Œä½†æ˜¾ç„¶äºŒè€…æ˜¯ç­‰ä»·çš„ï¼Œæ— ç”šå¿…è¦&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ ¹æ®æ•°ä½ DP çš„å®ç°æ–¹å¼ï¼Œå¸¸æ•°ä¸Šé¡ºåºç»“æ„è‚¯å®šæ˜¯ä¼šåŠæ‰“é€’å½’çš„ã€‚ç„¶è€Œå¹¶ä¸æƒ¯å†™é¡ºåºç»“æ„çš„æ•°ä½ DPï¼Œwhatever.&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
struct matrix &amp;#123;
    long long a[2][2];
    matrix() &amp;#123;
        a[0][0] = a[0][1] = a[1][0] = a[1][1] = 0ll;
        return;
    &amp;#125;
    long long* operator[] (const int q) &amp;#123;
        return a[q];
    &amp;#125;
    matrix operator* (matrix &amp;amp;q) const &amp;#123;
        matrix res;
        res[0][0] = (a[0][0] * q[0][0] + a[0][1] * q[1][0]) % mod;
        res[0][1] = (a[0][0] * q[0][1] + a[0][1] * q[1][1]) % mod;
        res[1][0] = (a[1][0] * q[0][0] + a[1][1] * q[1][0]) % mod;
        res[1][1] = (a[1][0] * q[0][1] + a[1][1] * q[1][1]) % mod;
        return res;
    &amp;#125;
    matrix&amp;amp; operator+= (matrix q) &amp;#123;
        if ((a[0][0] += q[0][0]) &amp;gt;= mod) a[0][0] -= mod;
        if ((a[0][1] += q[0][1]) &amp;gt;= mod) a[0][1] -= mod;
        if ((a[1][0] += q[1][0]) &amp;gt;= mod) a[1][0] -= mod;
        if ((a[1][1] += q[1][1]) &amp;gt;= mod) a[1][1] -= mod;
        return *this;
    &amp;#125;
&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;b.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;b.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;./test/20251014/b/b4.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; up(n);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t, up[n - i] = t - &amp;#39;0&amp;#39;;
    &amp;#125;
    matrix init, zmat;
    init[0][0] = init[0][1] = 1ll;
    std::vector&amp;lt;matrix&amp;gt; mat(n);
    mat[0][0][1] = mat[0][1][0] = mat[0][1][1] = 1ll;
    for (int i = 1; i &amp;lt; n; ++i)
        mat[i] = mat[i - 1] * mat[i - 1];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; tag(n, std::vector&amp;lt;int&amp;gt; (k + 1));
    std::vector&amp;lt;std::vector&amp;lt;matrix&amp;gt; &amp;gt; f(n, std::vector&amp;lt;matrix&amp;gt; (k + 1));
    std::function&amp;lt;matrix(int, int, int)&amp;gt; DFS = [&amp;amp;](int x, int k, int fl) &amp;#123;
        if (x == -1) &amp;#123;
            if (k == 0)
                return init;
            return zmat;
        &amp;#125;
        if (!fl &amp;amp;&amp;amp; tag[x][k])
            return f[x][k];
        matrix res = DFS(x - 1, k, fl &amp;amp;&amp;amp; !up[x]);
        if (k &amp;amp;&amp;amp; (!fl || up[x]))
            res += DFS(x - 1, k - 1, fl) * mat[x];
        if (!fl)
            tag[x][k] = 1, f[x][k] = res;
        return res;
    &amp;#125;;
    std::cout &amp;lt;&amp;lt; DFS(n - 1, k, 1)[0][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-lead-to-shine-more&#34;&gt;C. Lead to shine more&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6639/problem/3&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6639/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æ¬¡æ“ä½œæ—¶å˜é‡ &lt;span class=&#34;math inline&#34;&gt;\(x=1\)&lt;/span&gt;ï¼Œæ­¤åæ¯æ¬¡æ“ä½œä½¿ &lt;span class=&#34;math inline&#34;&gt;\(x\gets x+\text{popcount}(x)\)&lt;/span&gt;ï¼Œç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¬¡è¯¢é—®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(x&amp;#39;\)&lt;/span&gt;ï¼Œé—® &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åœ¨ç¬¬å‡ æ¬¡æ“ä½œåå˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x&amp;#39;\)&lt;/span&gt;ï¼Œæˆ–æŠ¥å‘Š &lt;span class=&#34;math inline&#34;&gt;\(x&amp;#39;\)&lt;/span&gt; ä¸ä¼šè¢«ç»è¿‡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(m\le 10^5,x&amp;#39;\le 10^{18}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªæœ´ç´ çš„æƒ³æ³•æ˜¯åˆ†é«˜ä½ä½ï¼Œåˆ™å› ä¸ºæ¯æ¬¡æ“ä½œå¸¦æ¥çš„å˜åŒ–é‡ä¸è¶…è¿‡ 60ï¼Œè¿œè¿œä½äºä½ä½çš„ &lt;span class=&#34;math inline&#34;&gt;\(2^30\)&lt;/span&gt;ï¼Œæ‰€ä»¥ä¸€æ¬¡æ“ä½œè‡³å¤šç»™é«˜ä½å¸¦æ¥ 1 çš„å˜åŒ–é‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é«˜ä½å¯¹æ•´ä½“çš„è´¡çŒ®åªå–å†³äºå…¶ popcountï¼Œæ‰€ä»¥å¯ä»¥æšä¸¾é«˜ä½ 1 çš„æ•°é‡ï¼Œå†æšä¸¾åˆå§‹å€¼ï¼Œæ‰¾åˆ°ç¬¬ä¸€æ¬¡è®©é«˜ä½å˜åŒ–èŠ±çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;åˆå§‹å€¼çš„å¯èƒ½å€¼æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(60\)&lt;/span&gt; ä¸ªï¼Œè€Œå¤–å±‚å¾ªç¯æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(30\)&lt;/span&gt; æ¬¡ï¼Œå†…å±‚å¾ªç¯å¤§æ¦‚æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {2^{30}}{60}\)&lt;/span&gt; çš„ï¼Œæ€»ä¹‹æ— æ³•é€šè¿‡ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é¢˜è§£è¯´æ–¹æ³•æ˜¯å¯¹ä¸Šé¢çš„æ‹“å±•ã€‚ç†è§£ä¸èƒ½ã€‚å‡ºå‘ç‚¹å¤§æ¦‚æ˜¯è€ƒè™‘åˆ°è®©ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½å˜åŒ–ç›¸å½“äºè®© &lt;span class=&#34;math inline&#34;&gt;\(i+1\)&lt;/span&gt; ä½å˜åŒ–ä¸¤æ¬¡ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€ä¸ªé€’æ¨çš„å…³ç³»ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, s, d}\)&lt;/span&gt; ä¸ºå‰ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; ä½çš„ popcount ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ï¼Œåˆå§‹å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œè®© &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½å˜åŒ–ä¸€æ¬¡çš„æ“ä½œæ¬¡æ•°ï¼›&lt;span class=&#34;math inline&#34;&gt;\(g_{i,s,d}\)&lt;/span&gt; ä¸ºä¸Šè¿°å˜åŒ–å &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å€¼ã€‚è®° &lt;span class=&#34;math inline&#34;&gt;\(pos=g_{i-1,s,d}\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
g_{i,pos,d}=g_{i-1,pos,d+1}\\
f_{i,pos,d}=f_{i-1,s,d}+f_{i-1,pos,d+1}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®æ˜¯ä¸€ä¸ªç±»ä¼¼&lt;strong&gt;å€å¢&lt;/strong&gt;çš„ç»“æ„ã€‚ä½†æ•æˆ‘å®åœ¨æ— æ³•è§£é‡Šæ€ä¹ˆæƒ³åˆ°çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æ˜¾ç„¶è¿™ä¸ªå¼å­åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\le 5\)&lt;/span&gt; æ—¶æ˜¯æœ‰é—®é¢˜çš„ï¼Œè¿™éƒ¨åˆ†æˆ‘ä»¬æš´åŠ›è·‘å³å¯ã€‚å¿½ç•¥è¿™ä¸€éƒ¨åˆ†å¸¸æ•°ï¼Œé¢„å¤„ç†æ€»å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(\log^3 n)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è€ƒè™‘æŸ¥è¯¢ï¼ŒæŒ‰ç…§ç±»ä¼¼æ•°ä½ DP çš„æ–¹æ³•ä»é«˜ä½åˆ°ä½ä½æ¨¡æ‹Ÿè¿›ä½è¿‡ç¨‹å³å¯ã€‚å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;c.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;c.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;./test/20251014/c/c1.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    crr f(61, brr(256, arr(61))), g(61, brr(256, arr(61)));
    for (int s = 0; s &amp;lt; 256; ++s)
        for (int d = 0; d &amp;lt;= 60; ++d)
            if (d || s) &amp;#123;
                int x = s, cnt = 0;
                for (; x &amp;lt; 256; x += __builtin_popcount(x) + d, ++cnt);
                f[8][s][d] = cnt, g[8][s][d] = x &amp;amp; 255;
            &amp;#125;
    for (int i = 9; i &amp;lt;= 60; ++i)
        for (int s = 0; s &amp;lt; 256; ++s)
            for (int d = 0; d &amp;lt; 60; ++d) &amp;#123;
                int pos = g[i - 1][s][d];
                g[i][s][d] = g[i - 1][pos][d + 1];
                f[i][s][d] = f[i - 1][s][d] + f[i - 1][pos][d + 1];
            &amp;#125;
    int m;
    std::cin &amp;gt;&amp;gt; m;
    for (long long x; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x;
        auto pos = 1ll, cnt = 0ll, tot = 0ll;
        for (int i = 60; i &amp;gt;= 8; --i)
            if ((x &amp;gt;&amp;gt; i) &amp;amp; 1) &amp;#123;
                cnt += f[i][pos][tot];
                pos = g[i][pos][tot++];
            &amp;#125;
        for (; pos &amp;lt; (x &amp;amp; 255); pos += __builtin_popcountll(pos) + tot, ++cnt);
        // std::cout &amp;lt;&amp;lt; pos &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; cnt &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        if (pos == (x &amp;amp; 255))
            std::cout &amp;lt;&amp;lt; cnt &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        else
            std::cout &amp;lt;&amp;lt; -1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-query-on-a-tree-17&#34;&gt;C. Query On A Tree 17&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/gym/102759/problem/I&#34; class=&#34;uri&#34;&gt;https://codeforces.com/gym/102759/problem/I&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªä»¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºæ ¹çš„æ ‘ï¼Œç‚¹æƒåˆå§‹ä¸ºå…¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¬¡ä¿®æ”¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;1 u&lt;/code&gt;ï¼Œè¡¨ç¤ºæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘å†…çš„ç‚¹æƒåŠ ä¸€ã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;2 u v&lt;/code&gt;ï¼Œè¡¨ç¤ºæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(u,v\)&lt;/span&gt; ç®€å•è·¯å¾„ä¸Šçš„ç‚¹æƒåŠ ä¸€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯æ¬¡ä¿®æ”¹åï¼Œè¾“å‡ºæ ‘æ·±åº¦æœ€å°çš„å¸¦æƒé‡å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,m\le 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è€ƒè™‘é“¾ä¸Šçš„é—®é¢˜ï¼Œè€ƒè™‘ä¸€ç‚¹å°å¥¥åšæ³•ï¼ŒæŠŠæ‰€æœ‰ç‚¹é‡å¤å…¶å‡ºç°æ¬¡æ•°æ¬¡ï¼Œä»å·¦åˆ°å³æ’åˆ—ï¼Œå‘ç°ç­”æ¡ˆåœ¨ä¸­ä½æ•°ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆæ®ç»„é¢˜äººæ‰€è¨€ï¼‰ï¼Œè¿™æ˜¯ç”¨æ¥æç¤ºæ­£è§£çš„ã€‚äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªå’Œå¸¦æƒé‡å¿ƒæœ‰å…³çš„ trickï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è‹¥ä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æ˜¯&lt;strong&gt;æ·±åº¦æœ€å°çš„&lt;/strong&gt;å¸¦æƒé‡å¿ƒï¼Œåˆ™å…¶å­æ ‘æƒå€¼å’Œå¿…é¡»&lt;strong&gt;ä¸¥æ ¼å¤§äº&lt;/strong&gt;æ€»æƒå€¼çš„ä¸€åŠã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¯æ˜æ˜¾ç„¶ï¼Œä½†ç»“è®ºä¸æ˜¾ç„¶ã€‚Whatever.&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç”±è¿™ä¸€ç‚¹ä¼šå¾—åˆ°ï¼Œï¼ˆå‚ç…§é“¾ä¸Šçš„åšæ³•ï¼‰ï¼ŒæŠŠç‚¹é‡å¤ç‚¹æƒæ¬¡ï¼Œå¹¶æŒ‰ dfn æ’æˆä¸€è¡Œï¼Œå–ä¸­ä½æ•°ï¼Œé‚£ä¹ˆå–åˆ°çš„ä¸€å®šåœ¨&lt;strong&gt;æ·±åº¦æœ€å°çš„&lt;/strong&gt;é‡å¿ƒå­æ ‘å†…ï¼Œï¼ˆè¿™å°±æ˜¯ç»„é¢˜äººè¯´çš„æç¤ºæ­£è§£ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€ç‚¹åè€Œæ²¡é‚£ä¹ˆæ˜¾ç„¶ï¼Œæ¨å¯¼è¿‡ç¨‹æ˜¯ï¼Œ&lt;strong&gt;æ·±åº¦æœ€å°çš„&lt;/strong&gt;é‡å¿ƒçš„å­æ ‘å äº†å¤§äºä¸€åŠï¼Œè€Œå…¶ dfn åˆæ˜¯è¿ç»­çš„ï¼Œï¼ˆç±»ä¼¼æ»‘åŠ¨çª—å£ï¼‰ï¼Œæ•…æ€»èƒ½å¤Ÿåˆ°ä¸­ä½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘éæ·±åº¦æœ€å°çš„é‡å¿ƒï¼Œæ­¤æ—¶å°±ä»&lt;strong&gt;ä¸¥æ ¼å¤§äº&lt;/strong&gt;å˜ä¸º&lt;strong&gt;ä¸ä¸¥æ ¼å¤§äº&lt;/strong&gt;ï¼Œå¯¼è‡´æ²¡æœ‰åŠæ³•å¾ˆå¥½åœ°ç²¾å‡†æ‰¾åˆ°ï¼Œéœ€è¦ä»ä¸­ä½æ•°å·¦å³åç§»ä¸€ä½ï¼Œæ˜¾ç„¶æ˜¯å¾ˆä¸‘é™‹çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å› æ­¤å¯ä»¥è€ƒè™‘çº¿æ®µæ ‘ä¸ŠäºŒåˆ†æ‰¾åˆ°ä¸­ä½æ•°ï¼ˆå®¹æ˜“å‘ç°çº¿æ®µæ ‘çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; è½´æœ¬æ¥å°±æ˜¯ dfnï¼‰ï¼Œç„¶åä»è¿™ä¸ªä¸­ä½æ•°å¾€ä¸Šè·³ï¼Œä¸€ç›´è·³åˆ°æ»¡è¶³ã€å­æ ‘æƒå€¼å’Œä¸¥æ ¼å¤§äºæ€»æƒå€¼ä¸€åŠã€çš„ç‚¹ï¼Œå°±æ˜¯æœ€æµ…çš„é‡å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸€ç‚¹é‡‡ç”¨å€å¢å³å¯ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
        <category term="DP" />
        <category term="æ ‘çŠ¶æ•°ç»„" />
        <category term="å€å¢" />
        <category term="è´ªå¿ƒ" />
        <updated>2025-10-07T08:29:43.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250924/</id>
        <title>æœ€çŸ­è·¯ç»ƒä¹ </title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250924/"/>
        <content type="html">&lt;p&gt;æœ€çŸ­è·¯ä¸ºèƒŒæ™¯çš„é¢˜ + åšæ³•æ˜¯æœ€çŸ­è·¯çš„é¢˜&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---minimum-path&#34;&gt;A - Minimum Path&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1473E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1473E&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»å…¸å¥—è·¯ï¼Œå‘ç°å¯ä»¥æŠŠ max å’Œ min æ¢æˆä»»æ„è·¯å¾„ä¸­çš„è¾¹ï¼Œç„¶å max å’Œ min å°±ä¼šæœ€å°åŒ–è¿™ä¸ªå¼å­&lt;/li&gt;
&lt;li&gt;æ•…å†™ä¸€ä¸ª Dijkstra + DPï¼Œæ±‚è¿™ä¸ªå¼å­çš„æœ€å°å€¼å³å¯&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    std::vector&amp;lt;brr&amp;gt; dis(2, brr(2, arr(n + 1, 1e18))), vis(2, brr(2, arr(n + 1)));
    for (int x, y, w; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w;
        g[x].emplace_back(y, w);
        g[y].emplace_back(x, w);
    &amp;#125;
    dis[0][0][1] = 0;
    std::array&amp;lt;std::array&amp;lt;std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt;, 2&amp;gt;, 2&amp;gt; q;
    q[0][0].emplace(0, 1);
    for (int i = 0; i &amp;lt; 2; ++i) &amp;#123;
        for (int j = 0; j &amp;lt; 2; ++j) &amp;#123;
            for (; !q[i][j].empty(); ) &amp;#123;
                int f = q[i][j].top().second;
                q[i][j].pop();
                if (vis[i][j][f])
                    continue;
                vis[i][j][f] = 1;
                for (auto k : g[f]) &amp;#123;
                    if (dis[i][j][k.first] &amp;gt; dis[i][j][f] + k.second) &amp;#123;
                        dis[i][j][k.first] = dis[i][j][f] + k.second;
                        q[i][j].emplace(-dis[i][j][k.first], k.first);
                    &amp;#125;
                    if (!i &amp;amp;&amp;amp; dis[1][j][k.first] &amp;gt; dis[i][j][f]) &amp;#123;
                        dis[1][j][k.first] = dis[i][j][f];
                        q[1][j].emplace(-dis[1][j][k.first], k.first);
                    &amp;#125;
                    if (!j &amp;amp;&amp;amp; dis[i][1][k.first] &amp;gt; dis[i][j][f] + 2 * k.second) &amp;#123;
                        dis[i][1][k.first] = dis[i][j][f] + 2 * k.second;
                        q[i][1].emplace(-dis[i][1][k.first], k.first);
                    &amp;#125;
                &amp;#125;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    for (int i = 2; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; std::min(&amp;#123; dis[0][0][i], dis[1][1][i] &amp;#125;) &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---train-delay&#34;&gt;B - Train Delay&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://vjudge.net/contest/750645#problem/B&#34; class=&#34;uri&#34;&gt;https://vjudge.net/contest/750645#problem/B&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€åŒ–é¢˜ç›®å¾ˆé‡è¦çš„ä¸€ä¸ªè½¬åŒ–æ˜¯&lt;strong&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(S\le T\)&lt;/span&gt; å¸¦æ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ°ä½å¹³ç­‰ï¼Œè€ƒè™‘æŠŠå‡ºå‘å’Œåˆ°è¾¾åˆ†åˆ«çœ‹ä½œä¸€æ¬¡äº‹ä»¶å¤„ç†ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŒ‰ç…§æ‰€æœ‰äº‹ä»¶çš„å‘ç”Ÿæ—¶åˆ»æ’åºï¼Œæœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºä¸€æ¬¡å‡ºå‘äº‹ä»¶ï¼Œå¯ä»¥å¾—åˆ°åœ¨å…¶ä¹‹å‰è¯¥ç«™ç‚¹æ‰€æœ‰åˆ°è¾¾äº‹ä»¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(\max\{T&amp;#39;\}\)&lt;/span&gt;ï¼Œç”¨ä¹‹æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºä¸€æ¬¡åˆ°è¾¾äº‹ä»¶ï¼Œç”±äºå¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; å·²ç»ç¡®å®šï¼Œæ›´æ–°è¯¥ç«™ç‚¹å½“å‰æœ€å¤§å€¼å³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; d(m + 1);
    std::cin &amp;gt;&amp;gt; d[1];
    struct event &amp;#123;
        int t, op, id, x;
    &amp;#125;;
    std::vector&amp;lt;event&amp;gt; a;
    std::vector&amp;lt;int&amp;gt; mx(n + 1);
    for (int i = 1, x, y, s, t; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t;
        a.push_back(&amp;#123; s, 0, i, x &amp;#125;);
        a.push_back(&amp;#123; t, 1, i, y &amp;#125;);
    &amp;#125;
    std::sort(a.begin(), a.end(), [&amp;amp;](event &amp;amp;x, event &amp;amp;y) &amp;#123; return x.t == y.t ? x.op &amp;gt; y.op : x.t &amp;lt; y.t; &amp;#125;);
    for (auto [t, op, id, x] : a)
        if (op == 1)
            mx[x] = std::max(mx[x], t + d[id]);
        else if (id != 1)
            d[id] = std::max(mx[x] - t, 0);
    for (int i = 2; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; d[i] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---complete-the-graph&#34;&gt;C - Complete The Graph&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF715B&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF715B&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç¥ä»™äºŒåˆ†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœåˆå§‹æŠŠæ‰€æœ‰ç™½è¾¹ç½®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¼šæƒ³åˆ°è°ƒæ•´æ³•æ„é€ &lt;/li&gt;
&lt;li&gt;ä½†æ˜¯ä¸çŸ¥é“åº”è¯¥åœ¨å“ªäº›è¾¹ä¸Šè°ƒæ•´ï¼Œç¡®å®šè°ƒæ•´å¤šå°‘ä¼¼ä¹ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç®€å•çš„åšæ³•&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…&lt;strong&gt;å¹³å‡ç”¨åŠ›&lt;/strong&gt;ï¼Œæ„é€ ä¸€ä¸ª è¾¹1 += 1ï¼Œè¾¹2 += 1ï¼Œè¾¹3 += 1, â€¦, è¾¹cnt0 += 1, è¾¹1 += 1, è¾¹2 += 1, â€¦ çš„æ“ä½œåºåˆ—&lt;/p&gt;
å®¹æ˜“&lt;strong&gt;å‘ç°æ¯æ¬¡æ“ä½œæœ€å¤šè®©å½“å‰æœ€çŸ­è·¯é•¿åº¦å¢åŠ  1&lt;/strong&gt;ï¼Œè€Œä¸”æœ‰å•è°ƒæ€§&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…äºŒåˆ†ç­”æ¡ˆå³å¯&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const __int128 inf = 1e18;
const __int128 inff = 1e23;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, s, t, l, cnt = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; l &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t, ++s, ++t;
    std::vector&amp;lt;std::tuple&amp;lt;int, int, long long&amp;gt; &amp;gt; u(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, long long&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt;= m; ++i) &amp;#123;
        long long w;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w, ++x, ++y;
        if (w == 0)
            w = -(++cnt);
        g[x].emplace_back(y, w), g[y].emplace_back(x, w);
        u[i] = &amp;#123; x, y, w &amp;#125;;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; vis(n + 1);
    std::vector&amp;lt;__int128&amp;gt; dis(n + 1);
    std::vector&amp;lt;long long&amp;gt; k(cnt + 1);
    __int128 res = -1;
    auto check = [&amp;amp;](__int128 x) &amp;#123;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            k[i] = x / cnt + (i &amp;lt;= x % cnt);
        std::fill(vis.begin() + 1, vis.end(), 0);
        std::fill(dis.begin() + 1, dis.end(), inf);
        std::priority_queue&amp;lt;std::pair&amp;lt;__int128, int&amp;gt; &amp;gt; q;
        dis[s] = 0, q.emplace(0, s);
        for (; !q.empty(); ) &amp;#123;
            int f = q.top().second;
            q.pop();
            if (vis[f])
                continue;
            vis[f] = 1;
            for (auto [v, w] : g[f]) &amp;#123;
                if (w &amp;lt; 0)
                    w = k[-w];
                if (dis[v] &amp;gt; dis[f] + w) &amp;#123;
                    dis[v] = dis[f] + w;
                    q.emplace(-dis[v], v);
                &amp;#125;
            &amp;#125;
        &amp;#125;
        return dis[t] &amp;lt;= l;
    &amp;#125;;
    for (__int128 l = cnt, r = cnt * inf, mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        if (check(mid))
            res = mid, l = mid + 1;
        else
            r = mid - 1;
    &amp;#125;
    if (res == -1)
        std::cout &amp;lt;&amp;lt; &amp;quot;NO\n&amp;quot;;
    else &amp;#123;
        check(res);
        if (dis[t] != l)
            std::cout &amp;lt;&amp;lt; &amp;quot;NO\n&amp;quot;;
        else &amp;#123;
            std::cout &amp;lt;&amp;lt; &amp;quot;YES\n&amp;quot;;
            for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
                auto [x, y, w] = u[i];
                if (w &amp;lt; 0)
                    w = k[-w];
                std::cout &amp;lt;&amp;lt; x - 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; y - 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; w &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            &amp;#125;
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---é‡åŠ›çƒ&#34;&gt;A - é‡åŠ›çƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7473&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7473&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ç›¸å¯¹å¾ˆå°ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆåŸºäº &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„åšæ³•&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡çƒåœä¸‹çš„ä½ç½®ä¸€å®šæ˜¯æŸä¸ªéšœç¢ç‰©ï¼ˆæˆ–è¾¹ç•Œï¼‰ä¸Š / ä¸‹ / å·¦ / å³çš„æ ¼å­ï¼Œæ•…å¯ä»¥åœ¨è¿™ &lt;span class=&#34;math inline&#34;&gt;\(O(n + m)\)&lt;/span&gt; ä¸ªç‚¹ä¸Šå»ºå›¾&lt;/li&gt;
&lt;li&gt;æ€ä¹ˆåŒæ—¶ç»´æŠ¤ä¸¤ä¸ªçƒçš„ä¿¡æ¯å‘¢ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; è¿˜æ˜¯å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥æŠŠä¸¤ä¸ªçƒå¡ä¸€èµ·ä½œä¸ºä¸€ä¸ªçŠ¶æ€&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(m^2\)&lt;/span&gt; æ¬¡ Dij è¿˜æ˜¯å¤ªæ¿€è¿›äº† è¿›ä¸€æ­¥æ€è€ƒå‘ç°å¯èƒ½çš„ç»ˆç‚¹å…± &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ª å¹¶ä¸”å½¼æ­¤ä¸åŒºåˆ†&lt;/p&gt;
&lt;p&gt;æ•…ä»¥è¿™ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªç»ˆç‚¹è·‘å¤šæºæœ€çŸ­è·¯å³å¯&lt;/p&gt;
&lt;p&gt;ä½† 5e6 è·‘ Dij è¿˜æ˜¯å¤ªå‹‰å¼ºäº†ã€‚&lt;strong&gt;å‘ç°è¾¹æƒä¸º 1ï¼Œä¸ºä»€ä¹ˆä¸ BFS å‘¢ ğŸ˜…&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°èµ·ç‚¹å¯èƒ½ä¸åœ¨æˆ‘ä»¬é™å®šçš„ç‚¹ä¸Šï¼Œä½†å¯ä»¥äººä¸ºé€‰æ‹©ä¸€æ¬¡é‡åŠ›æ–¹å‘ï¼Œç„¶åå°±å›åˆ°åˆšåˆšçš„é—®é¢˜äº†&lt;/p&gt;
&lt;p&gt;æˆ–è€…ç¦»çº¿ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç–‘ä¼¼å¸¸æ•°å¤ªå¤§ï¼Œæ‹¼å°½å…¨åŠ›å‹‰å¼ºå¡è¿‡&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#ifdef ONLINE_JUDGE
inline int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf)
            return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
#else
#define nec getchar
#endif
inline bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF)
            return 0;
        if (ch == &amp;#39;-&amp;#39;)
            f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f)
        x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0) &amp;#123;
        putchar(&amp;#39;-&amp;#39;);
        x = -x;
    &amp;#125;
    if (x &amp;gt;= 10)
        print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x);
    putchar(ch);
    return;
&amp;#125;
const int inf = 0x3f3f3f3f;
const int dir[][2] = &amp;#123;&amp;#123; -1, 0 &amp;#125;, &amp;#123; 1, 0 &amp;#125;, &amp;#123; 0, -1 &amp;#125;, &amp;#123; 0, 1 &amp;#125;&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, q;
    read(n), read(m), read(q);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; pos(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; a(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 1, x, y; i &amp;lt;= m; ++i) &amp;#123;
        read(x), read(y);
        pos[i] = &amp;#123; x, y &amp;#125;, a[x][y] = -1;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(0, i), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(i, n + 1), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(n + 1, i), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(i, 0), ++m;
    int cnt = 0;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; u(1);
    for (int i = 1; i &amp;lt;= m; ++i)
        for (auto [fx, fy] : dir) &amp;#123;
            int nx = pos[i].first + fx, ny = pos[i].second + fy;
            if (nx &amp;gt;= 1 &amp;amp;&amp;amp; nx &amp;lt;= n &amp;amp;&amp;amp; ny &amp;gt;= 1 &amp;amp;&amp;amp; ny &amp;lt;= n &amp;amp;&amp;amp; !a[nx][ny])
                a[nx][ny] = ++cnt, u.emplace_back(nx, ny);
        &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; &amp;gt; top(n + 1, std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; (n + 1));
    for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (a[i][j] != -1) &amp;#123;
                if (i == 1 || a[i - 1][j] == -1)
                    top[i][j][0] = a[i][j];
                else
                    top[i][j][0] = top[i - 1][j][0];
            &amp;#125;
        for (int i = n; i; --i)
            if (a[i][j] != -1) &amp;#123;
                if (i == n || a[i + 1][j] == -1)
                    top[i][j][1] = a[i][j];
                else
                    top[i][j][1] = top[i + 1][j][1];
            &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (int j = 1; j &amp;lt;= n; ++j)
            if (a[i][j] != -1) &amp;#123;
                if (j == 1 || a[i][j - 1] == -1)
                    top[i][j][2] = a[i][j];
                else
                    top[i][j][2] = top[i][j - 1][2];
            &amp;#125;
        for (int j = n; j; --j)
            if (a[i][j] != -1) &amp;#123;
                if (j == n || a[i][j + 1] == -1)
                    top[i][j][3] = a[i][j];
                else
                    top[i][j][3] = top[i][j + 1][3];
            &amp;#125;
    &amp;#125;
    const int N = cnt * cnt;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(N + 1);
    auto encode = [&amp;amp;](int x, int y) &amp;#123;
        return (x - 1) * cnt + y;
    &amp;#125;;
    auto decode = [&amp;amp;](int id) &amp;#123;
        return std::make_pair((id - 1) / cnt + 1, (id - 1) % cnt + 1);
    &amp;#125;;
    for (int i = 1; i &amp;lt;= N; ++i)
        for (int j = 0; j &amp;lt; 4; ++j) &amp;#123;
            auto [a, b] = decode(i);
            g[encode(top[u[a].first][u[a].second][j], top[u[b].first][u[b].second][j])].emplace_back(i);
        &amp;#125;
    std::vector&amp;lt;int&amp;gt; dis(N + 1, inf), vis(N + 1);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            dis[encode(i, i)] = 0, q.push(encode(i, i)), vis[encode(i, i)] = 1;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop();
            for (auto i : g[x])
                if (!vis[i])
                    dis[i] = dis[x] + 1, vis[i] = 1, q.push(i);
        &amp;#125;
    &amp;#125;
    for (int a, b, c, d; q--; ) &amp;#123;
        read(a), read(b), read(c), read(d);
        if (a == c &amp;amp;&amp;amp; b == d)
            print(0, &amp;#39;\n&amp;#39;);
        else &amp;#123;
            int res = inf;
            for (int j = 0; j &amp;lt; 4; ++j)
                res = std::min(res, dis[encode(top[a][b][j], top[c][d][j])] + 1);
            if (res == inf)
                print(-1, &amp;#39;\n&amp;#39;);
            else
                print(res, &amp;#39;\n&amp;#39;);
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---çŸ©é˜µæ¸¸æˆ&#34;&gt;B - çŸ©é˜µæ¸¸æˆ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7515&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7515&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æŠŠé—®é¢˜å½¢å¼åŒ–ä¸€ä¸‹ï¼Œç°åœ¨æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; ä¸ªæœªçŸ¥æ•°å’Œ &lt;span class=&#34;math inline&#34;&gt;\((n-1)\times (m-1)\)&lt;/span&gt; ä¸ªæ–¹ç¨‹&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥å¯¹è¾¹ä¸Šä¸€åœˆä»»æ„èµ‹å€¼ï¼Œé™åˆ¶æ˜¯å·¦ä¸Šè§’è¿™ &lt;span class=&#34;math inline&#34;&gt;\((n-1)\times (m-1)\)&lt;/span&gt; ä¸ªæœªçŸ¥æ•°å¿…é¡»è½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([0,10^6]\)&lt;/span&gt; ä¸Š&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€ä¸ªå¾ˆå®¹æ˜“è§‚å¯Ÿåˆ°çš„æ€§è´¨ï¼Œå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œé€‰å–ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼Œå¹¶æŠŠæ£‹ç›˜é»‘ç™½æŸ“è‰²ï¼Œé‚£ä¹ˆæŠŠæ‰€æœ‰é»‘æ ¼ &lt;span class=&#34;math inline&#34;&gt;\(+=v\)&lt;/span&gt;ï¼Œç™½æ ¼ &lt;span class=&#34;math inline&#34;&gt;\(-=v\)&lt;/span&gt;ï¼Œå¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; æ˜¯ä¸ä¼šå˜çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;è¿™ä¸ªæ“ä½œæ˜¯æ¶‰åŠå…¨å±€çš„ï¼Œå¤ªè‹›åˆ»äº†&lt;/strong&gt;ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´ mild çš„æ„é€ ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å‘ç°åªå¯¹ä¸€è¡Œ / åˆ—é»‘ç™½æŸ“è‰²å¹¶æ“ä½œä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚èƒ½æ„Ÿå—åˆ°&lt;strong&gt;æ“ä½œæ— æ³•å†ç®€åŒ–äº†&lt;/strong&gt;ã€‚è€ƒè™‘ç”¨è¿™ä¸ªç‰ˆæœ¬çš„æ“ä½œ&lt;strong&gt;è°ƒæ•´&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æ•…å¤§åŠ›ä»¤å‘¨å›´ä¸€åœˆçš„ä¸´æ—¶è§£ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä»¤æ¯è¡Œã€åˆ—çš„è°ƒæ•´ delta ä¸º &lt;span class=&#34;math inline&#34;&gt;\(r_i,c_i\)&lt;/span&gt;ï¼Œå¯ä»¥å¾—åˆ°è‹¥å¹²ä¸ªå…³äº &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(10^6\)&lt;/span&gt; çš„çº¦æŸã€‚æœ€åå»ºå‡ºæ¥ä¸€ä¸ªå®Œå…¨äºŒåˆ†å›¾çŠ¶ç‰©ï¼Œè·‘å·®åˆ†çº¦æŸå³å¯ï¼Œå®¹æ˜“å‘ç°å¤æ‚åº¦æ­£ç¡®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®ç°æŠ€å·§ï¼šè§„åˆ’ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„æŸ“è‰²æ–¹å¼ï¼Œä½¿å¾—å®ƒä»¬é”™å¼€ï¼Œå¯ä»¥æŠŠæ‰€æœ‰ä½ç½®éƒ½å†™ä½œ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;_{i,j}+c-r\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;_{i,j}+r-c\)&lt;/span&gt; çš„å½¢å¼ï¼Œä¾¿äºå·®åˆ†çº¦æŸ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---tax&#34;&gt;C - Tax&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6822&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6822&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®¹æ˜“æƒ³åˆ°åˆ†ç±»è®¨è®ºï¼Œå¦‚æœé’¦å®šæ˜¯å…¥è¾¹è´¡çŒ®è¾¹æƒï¼Œé‚£ä¹ˆå‡ºè¾¹è¾¹æƒä¸èƒ½å¤§äºå…¥è¾¹è¾¹æƒï¼›å¦åˆ™ï¼Œå‡ºè¾¹è´¡çŒ®è¾¹æƒã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘æŠŠæ¯ä¸ªç‚¹ä¸Šçš„å‡ºè¾¹æŒ‰è¾¹æƒä»å°åˆ°å¤§æ’åºï¼Œæ˜¾ç„¶éœ€è¦å…¥è¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µå‰ç¼€ï¼Œéœ€è¦å‡ºè¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µåç¼€ï¼Œå°±å¯ä»¥åšä¸€ä¸ªå‰åç¼€ä¼˜åŒ–å»ºå›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    struct edge &amp;#123; int v, w, id, pi, si; &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;edge&amp;gt; &amp;gt; g1(n + 2);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(1);
    int cnt = 0;
    for (int x, y, w; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w;
        g1[x].push_back(&amp;#123; y, w, ++cnt, 0, 0 &amp;#125;);
        g1[y].push_back(&amp;#123; x, w, ++cnt, 0, 0 &amp;#125;);
        g.emplace_back(), g.emplace_back();
    &amp;#125;
    int s = ++cnt, t = ++cnt;
    g1[0].push_back(&amp;#123; 1, 0, s, 0, 0 &amp;#125;), g1[n].push_back(&amp;#123; n + 1, 0, t, 0, 0 &amp;#125;);
    g.emplace_back(), g.emplace_back();
    for (int i = 0; i &amp;lt;= n + 1; ++i)
        if (!g1[i].empty()) &amp;#123;
            std::sort(g1[i].begin(), g1[i].end(), [&amp;amp;](edge &amp;amp;x, edge &amp;amp;y) &amp;#123; return x.w &amp;lt; y.w; &amp;#125;);
            for (int j = 0; j &amp;lt; (int)g1[i].size(); ++j) &amp;#123;
                g1[i][j].pi = ++cnt, g.emplace_back();
                if (j != 0)
                    g[cnt].emplace_back(cnt - 1, 0);
                g[cnt].emplace_back(g1[i][j].id, 0);
            &amp;#125;
            for (int j = (int)g1[i].size() - 1; ~j; --j) &amp;#123;
                g1[i][j].si = ++cnt, g.emplace_back();
                if (j != (int)g1[i].size() - 1)
                    g[cnt].emplace_back(cnt - 1, 0);
                g[cnt].emplace_back(g1[i][j].id, g1[i][j].w);
            &amp;#125;
        &amp;#125;
    for (int i = 0; i &amp;lt;= n + 1; ++i)
        for (auto &amp;amp;[v, w, id, pi, si] : g1[i]) &amp;#123;
            auto to = std::upper_bound(g1[v].begin(), g1[v].end(), w, [&amp;amp;](int x, edge &amp;amp;y) &amp;#123; return x &amp;lt; y.w; &amp;#125;);
            if (to != g1[v].end())
                g[id].emplace_back(to-&amp;gt;si, 0);
            if (to != g1[v].begin())
                g[id].emplace_back((--to)-&amp;gt;pi, w);
        &amp;#125;
    std::vector&amp;lt;int&amp;gt; vis(cnt + 1, 0);
    std::vector&amp;lt;long long&amp;gt; dis(cnt + 1, inf);
    std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; q;
    dis[s] = 0, q.emplace(0, s);
    for (; !q.empty(); ) &amp;#123;
        int f = q.top().second;
        q.pop();
        if (vis[f])
            continue;
        vis[f] = 1;
        for (auto [v, w] : g[f])
            if (dis[v] &amp;gt; dis[f] + w) &amp;#123;
                dis[v] = dis[f] + w;
                q.emplace(-dis[v], v);
            &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; dis[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---travelling-through-the-snow-queens-kingdom&#34;&gt;D - Travelling Through the Snow Queenâ€™s Kingdom&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF685E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF685E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç›®å‰è§è¿‡çš„æ•°æ®èŒƒå›´æç¤ºæ€§æå¼±ï¼ˆè¯¯å¯¼æ€§æå¼ºï¼‰çš„å¾ªç¯ç»“æ„é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;[BZOJ3620] ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/20240906/#å­—ç¬¦åˆå¹¶&#34;&gt;å­—ç¬¦åˆå¹¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/20250907/#e---subset-product-problem&#34;&gt;[ARC205E] Subset Product Problem&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ­£èµ›å› ä¸ºæœ‰éƒ¨åˆ†åˆ†ï¼Œåº”è¯¥ä¸ä¼šå‡ºç°ä¸æ•¢å†™çš„é—®é¢˜&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘ç¦»çº¿è¯¢é—®ï¼Œé€†åºåŠ è¾¹ï¼›åŸæ–‡æ— è¾¹æƒï¼›è¾¹çš„é€šè¡Œæ—¶åˆ»åªå†³å®šåˆ°è¾¾ç‚¹çš„æ—¶åˆ»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å€Ÿé‰´ &lt;a href=&#34;/20231113/#b.-å•†äºº&#34;&gt;merchant&lt;/a&gt; ä¸­çš„æ€è·¯ï¼Œåªéœ€è¦æ›´æ–°å½“å‰è¾¹ä¸¤ä¾§ç‚¹ä¸ºèµ·ç‚¹çš„ DP æ•°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„è¾¹ä»æŸç§æ„ä¹‰ä¸Šè¯´æ˜¯ã€æœ‰å‘ã€çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, q;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; q;
    struct query &amp;#123; int r, s, t, id; &amp;#125;;
    std::vector&amp;lt;int&amp;gt; res(q + 1);
    std::vector&amp;lt;std::vector&amp;lt;query&amp;gt; &amp;gt; u(m + 1);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; e(m + 1);
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cin &amp;gt;&amp;gt; e[i].first &amp;gt;&amp;gt; e[i].second;
    for (int i = 1, l, r, s, t; i &amp;lt;= q; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t;
        u[l].push_back(&amp;#123; r, s, t, i &amp;#125;);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1, inf));
    for (int i = m; i; --i) &amp;#123;
        auto [x, y] = e[i];
        g[x][y] = g[y][x] = i;
        for (int j = 1; j &amp;lt;= n; ++j)
            g[x][j] = g[y][j] = std::min(g[x][j], g[y][j]);
        for (auto [r, s, t, id] : u[i])
            if (g[s][t] &amp;lt;= r)
                res[id] = 1;
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        std::cout &amp;lt;&amp;lt; (res[i] ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---culture-code&#34;&gt;E - Culture Code&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1197E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1197E&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆæŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(out\)&lt;/span&gt; æ’åºï¼Œåšä¸€ä¸ªå‰ç¼€ä¼˜åŒ–å»ºå›¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®¹æ˜“å‘ç°é™¤äº†æœ€å¤–å±‚ï¼Œæ¯ä¸€ä¸ªå¥—å¨ƒéƒ½ä¼šæä¾› &lt;span class=&#34;math inline&#34;&gt;\(in_i-out_i\)&lt;/span&gt; çš„ä»£ä»·ï¼Œè€Œæœ€å¤–å±‚ä¼šæä¾› &lt;span class=&#34;math inline&#34;&gt;\(in_x\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/p&gt;
&lt;del&gt;å¥½åœ¨è¦æ±‚çš„æ˜¯æœ€é•¿è·¯ï¼Œè¿™æ ·å°±å¯ä»¥ Dij äº†&lt;/del&gt;ï¼Œå¹¶ä¸éœ€è¦çœŸæ­£æŠŠå›¾å»ºå‡ºæ¥ï¼Œå‘ç°è¿™ä¸ªå½¢å¼æ›´åºåˆ—ï¼Œç›´æ¥åœ¨åºåˆ—ä¸ŠäºŒåˆ†å‰ç¼€ + DP å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ±‚æ–¹æ¡ˆæ˜¯å®¹æ˜“çš„ã€‚æœ€åç»Ÿè®¡ DP å€¼æœ€å¤§ï¼Œ&lt;strong&gt;ä¸”ä¸èƒ½è¢«å…¶ä»–å¥—å¨ƒåŒ…å«çš„å…ƒç´ &lt;/strong&gt;å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;Tipï¼šåœ¨æ±‚è§£è¿‡ç¨‹ä¸­å¹¶ä¸ç”¨è€ƒè™‘å½“å‰å…ƒç´ å’Œå‰ç¼€ min å…ƒç´ é—´èƒ½å¦åŠ å…¥å…¶ä»–å¥—å¨ƒï¼Œå› ä¸ºä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(out&amp;gt;in\)&lt;/span&gt;ï¼Œå¦‚æœå­˜åœ¨è¿™æ ·çš„å¥—å¨ƒï¼Œå…¶ DP å€¼ä¼šæ¯”å‰ç¼€ min æ›´å°ï¼ŒçŸ›ç›¾ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; a(n + 1);
    int mxi = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i].first &amp;gt;&amp;gt; a[i].second;
        mxi = std::max(mxi, a[i].second);
    &amp;#125;
    std::sort(a.begin() + 1, a.end());
    std::vector&amp;lt;long long&amp;gt; g(n + 1), mxg(n + 1), f(n + 1), mx(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int j = std::upper_bound(a.begin() + 1, a.begin() + i, std::make_pair(a[i].second, 0x3f3f3f3f)) - a.begin() - 1;
        if (j == 0)
            f[i] = a[i].second, g[i] = 1ll;
        else
            f[i] = mx[j] + a[i].second, g[i] = mxg[j];
        long long now = f[i] - a[i].first;
        if (now &amp;lt; mx[i - 1])
            mx[i] = now, mxg[i] = g[i];
        else if (now == mx[i - 1])
            mx[i] = now, mxg[i] = (mxg[i - 1] + g[i]) % mod;
        else
            mx[i] = mx[i - 1], mxg[i] = mxg[i - 1];
    &amp;#125;
    auto now = 0x3f3f3f3fll, res = 0ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (a[i].first &amp;lt;= mxi)
            continue;
        if (f[i] &amp;lt; now)
            now = f[i], res = g[i];
        else if (f[i] == now)
            (res += g[i]) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---awesome-arrowland-adventure&#34;&gt;A - Awesome Arrowland Adventure&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6233&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6233&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ²¡ä»€ä¹ˆå¥½è¯´çš„å»ºå›¾ï¼Œæ³¨æ„åªèƒ½é¡ºæ—¶é’ˆè½¬&lt;/li&gt;
&lt;li&gt;ä»£ç ç•¥&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---åœ°é“çº¿è·¯&#34;&gt;B - åœ°é“çº¿è·¯&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6096&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6096&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘åšä¸€ä¸ªç¥ç§˜æ‹†ç‚¹ï¼ŒæŠŠæ¯ä¸ªç‚¹é™„ä¸Šçº¿è·¯å’Œè¿è¡Œæ–¹å‘çš„ä¿¡æ¯ï¼ˆæ‰€ä»¥æ˜¯å•å‘çš„ï¼‰&lt;/li&gt;
&lt;li&gt;è®¤ä¸ºè·¯å¾„ä»£ä»·æ˜¯äºŒå…ƒç»„ï¼Œé‚£ä¹ˆåŒæ¡çº¿è·¯ä¸­çš„ç‚¹é€šè¡Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\((0,-1)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;æ¢ä¹˜éœ€è¦ä¼˜åŒ–å»ºå›¾ï¼Œæ¯ä¸ªç‚¹å¯ä»¥èŠ± &lt;span class=&#34;math inline&#34;&gt;\((0,0)\)&lt;/span&gt; çš„ä»£ä»·èµ°åˆ°è¿™ä¸ªç‚¹çš„ã€æ¢ä¹˜ç‚¹ã€ï¼Œå†èŠ± &lt;span class=&#34;math inline&#34;&gt;\((1,0)\)&lt;/span&gt; çš„ä»£ä»·èµ°åˆ°å¦ä¸€ä¸ªåˆ†ç‚¹&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½† &lt;strong&gt;15 å¹´çš„æ—¶å€™ SPFA å·²ç»æ­»äº†&lt;/strong&gt;ï¼Œæ‰€ä»¥éœ€è¦å¥½å¥½è€ƒè™‘æ€ä¹ˆå®ç°æœ€çŸ­è·¯ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†ä¸¤é—®æ˜¯æœ‰æç¤ºæ€§åœ¨çš„ï¼Œå¯ä»¥æƒ³åˆ° 01 BFS è§£å†³ç¬¬ä¸€ä¸ªå…³é”®å­—ï¼Œæ¯”è¾ƒå¯¹çš„æƒ³æ³•æ˜¯&lt;strong&gt;æŠŠæ‰€æœ‰æœ€çŸ­è·¯æ‹¿å‡ºæ¥å½¢æˆ DAGï¼Œåœ¨ DAG ä¸Šå¯¹ç¬¬äºŒå…³é”®å­— DP&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; m &amp;gt;&amp;gt; n;
    std::unordered_map&amp;lt;std::string, int&amp;gt; tab;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; l(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::tuple&amp;lt;int, int, int&amp;gt; &amp;gt; &amp;gt; g0(n + 1), g1(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s, tab[s] = i;
    &amp;#125;
    int tot = n;
    for (int i = 1, k; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; k;
        int lp = 0, lq = 0;
        for (std::string s; k--; ) &amp;#123;
            std::cin &amp;gt;&amp;gt; s;
            int p = ++tot, q = ++tot, id = tab[s];
            g0.emplace_back(), g0.emplace_back();
            g1.emplace_back(), g1.emplace_back();
            if (lp) &amp;#123;
                g0[p].emplace_back(lp, 0, 1), g0[lq].emplace_back(q, 0, 1);
                g1[lp].emplace_back(p, 0, 1), g1[q].emplace_back(lq, 0, 1);
            &amp;#125;
            g0[p].emplace_back(id, 0, 0), g0[id].emplace_back(p, 1, 0);
            g1[id].emplace_back(p, 0, 0), g1[p].emplace_back(id, 1, 0);
            g0[q].emplace_back(id, 0, 0), g0[id].emplace_back(q, 1, 0);
            g1[id].emplace_back(q, 0, 0), g1[q].emplace_back(id, 1, 0);
            l[id].push_back(p), l[id].push_back(q);
            lp = p, lq = q;
        &amp;#125;
    &amp;#125;
    int s, t;
    &amp;#123;
        std::string s1, s2;
        std::cin &amp;gt;&amp;gt; s1 &amp;gt;&amp;gt; s2;
        s = ++tot, t = tab[s2];
        g0.emplace_back(), g1.emplace_back();
        int p = tab[s1];
        for (auto i : l[p])
            g0[s].emplace_back(i, 1, 0), g1[i].emplace_back(s, 1, 0);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; dis0(tot + 1, 0x3f3f3f3f), dis1(tot + 1, 0x3f3f3f3f);
    auto BFS = [&amp;amp;](decltype(g0) &amp;amp;g, decltype(dis0) &amp;amp;dis, int s) &amp;#123;
        std::deque&amp;lt;int&amp;gt; q;
        std::vector&amp;lt;int&amp;gt; vis(tot + 1);
        q.push_back(s), dis[s] = 0;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop_front();
            if (vis[x])
                continue;
            vis[x] = 1;
            for (auto [v, w1, w2] : g[x])
                if (dis[x] + w1 &amp;lt; dis[v]) &amp;#123;
                    dis[v] = dis[x] + w1;
                    if (w1 == 0)
                        q.push_front(v);
                    else
                        q.push_back(v);
                &amp;#125;
        &amp;#125;
        return;
    &amp;#125;;
    BFS(g0, dis0, s), BFS(g1, dis1, t);
    std::cout &amp;lt;&amp;lt; dis0[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::vector&amp;lt;int&amp;gt; deg(tot + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(tot + 1);
    for (int i = 1; i &amp;lt;= tot; ++i)
        for (auto [j, w1, w2] : g0[i])
            if (dis0[i] + dis1[j] + w1 == dis0[t])
                g[i].emplace_back(j, w2), ++deg[j];
    std::queue&amp;lt;int&amp;gt; q;
    for (int i = 1; i &amp;lt;= tot; ++i)
        if (!deg[i])
            q.push(i);
    std::vector&amp;lt;int&amp;gt; f(tot + 1);
    for (; !q.empty(); ) &amp;#123;
        int x = q.front();
        q.pop();
        for (auto [v, w] : g[x]) &amp;#123;
            f[v] = std::max(f[v], f[x] + w);
            if (!--deg[v])
                q.push(v);
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---droga-do-domu&#34;&gt;C - Droga do domu&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9402&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9402&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿˜æ˜¯åšä¸€ä¸ªå’Œä¸Šä¸€é¢˜ç±»ä¼¼çš„ä¼˜åŒ–å»ºå›¾&lt;/li&gt;
&lt;li&gt;æ­¤å¤–å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ Dij ä¸Š DP äº†ã€‚&lt;strong&gt;å›¾æ²¡æœ‰ç¯&lt;/strong&gt;ï¼Œç›´æ¥æ‹“æ‰‘å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥æ»šåŠ¨ä¼˜åŒ–ç©ºé—´ï¼Œä½†ä¼¼ä¹å¹¶æ— å¿…è¦ã€‚ä»£ç ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---tickets-p&#34;&gt;D - Tickets P&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7984&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7984&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ²¡ä»€ä¹ˆå¥½è¯´çš„çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œéš¾ç‚¹åœ¨äºå¦‚ä½•åŒæ—¶è·å– &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°ä»æŸä¸ªç‚¹èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼Œæœ‰ä¸€ç§ä¸åŠ£çš„èµ°æ³•ï¼š&lt;/p&gt;
&lt;img src=&#34;image.png&#34; /&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç»´æŠ¤ä¸€ä¸‹æ¯ä¸ªç‚¹å•ç‹¬èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æœ€å°ä»£ä»·å’ŒåŒæ—¶èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1,N\)&lt;/span&gt; çš„æœ€å°ä»£ä»·&lt;/p&gt;
çœ‹åˆ°ä¸€ç§æ›´åŠ å¯¹çš„å†™æ³•æ˜¯&lt;strong&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_v+w(u,v)\)&lt;/span&gt; æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é‚£ä¹ˆå¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(1,N\)&lt;/span&gt; å‡ºå‘åšä¸€ä¸ª Dijã€‚ä»£ç ç•¥ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---ç›‘ç‹±&#34;&gt;E - ç›‘ç‹±&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9520&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9520&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æ³¨æ„è¦èµ°ç®€å•è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨ç»•è·¯è®©é“çš„å¯èƒ½æ€§ã€‚å®¹æ˜“æ¨å‡ºï¼šè‹¥è¾“å…¥åˆæ³•ï¼Œæ€»èƒ½æ‰¾åˆ°ä¸€ç§æ–¹å¼ä½¿å¾—æ¯ä¸ªäººå—åˆ°çš„æŒ‡ä»¤æ˜¯è¿ç»­ç»™å‡ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;P.S. è¿™ä¸ªç»“è®ºæŒªåˆ°å›¾ä¸Šå°±ä¸æˆç«‹äº†ï¼Œå¾ˆå®¹æ˜“ä¸¾å‡ºåä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-1.png&#34; /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;è‹¥ä¸€ä¸ªäººçš„èµ·ç‚¹ / ç»ˆç‚¹åœ¨å¦ä¸€ä¸ªäººçš„è·¯å¾„ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªäººä¹‹é—´å­˜åœ¨å…ˆåå…³ç³»ã€‚å»ºå›¾åæ£€æŸ¥æ˜¯å¦ä¸º DAG å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½†å»ºå›¾æ˜¾ç„¶æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œå®¹æ˜“æ„é€ å‡ºæ•°æ®ä½¿å¾—è¾¹æ•°æ¥åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; çº§åˆ«ã€‚è€ƒè™‘ä¼˜åŒ–å»ºå›¾ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å¯ä»¥ç”¨ä¸€ä¸ªæ ‘å‰– / å€å¢çš„ç»“æ„æ¥å»ºå›¾ã€‚&lt;/p&gt;
Tipsï¼šè¿™ä¸€ç‚¹åŒæ ·æ˜¯ä¸€ä¸ªæ ‘ä¸Šè·¯å¾„é—®é¢˜ã€‚å‚è§ &lt;a href=&#34;/20231117/#æ ‘ä¸Šé—®é¢˜&#34;&gt;æ ‘ä¸Šé—®é¢˜ï¼Œå€å¢å’Œæ ‘å‰–çš„é€‰æ‹©ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿™é‡Œçš„è·¯å¾„è¦æ±‚ä¸¤ç«¯éƒ½æ˜¯å¼€çš„ï¼Œè¿™å°±å¯¼è‡´å€å¢å†™ç€å¾ˆå›°éš¾ï¼ˆè™½ç„¶æ ‘å‰–å¯èƒ½ä¹Ÿæ˜¯ï¼‰ï¼Œä¸æ’é™¤æˆ‘å†™ä¸‘äº†&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int K = 19;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;01-02.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, m;
        std::cin &amp;gt;&amp;gt; n;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
        std::vector&amp;lt;int&amp;gt; s(n + 1), t(n + 1);
        for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
            g1[x].push_back(y), g1[y].push_back(x);
        &amp;#125;
        std::cin &amp;gt;&amp;gt; m;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(m + 1);
        std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; a(m + 1);
        for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; a[i].first &amp;gt;&amp;gt; a[i].second;
            s[a[i].first] = i;
            t[a[i].second] = i;
        &amp;#125;
        int cnt = m;
        struct node &amp;#123; int fa, i0, i1; &amp;#125;;
        std::vector&amp;lt;std::array&amp;lt;node, K + 1&amp;gt; &amp;gt; p(n + 1);
        std::vector&amp;lt;int&amp;gt; i0(n + 1), i1(n + 1), dep(n + 1), deg(m + 1);
        auto init = [&amp;amp;](void) &amp;#123;
            g.emplace_back(), deg.emplace_back();
            return ++cnt;
        &amp;#125;;
        auto add = [&amp;amp;](int x, int y) &amp;#123;
            g[x].push_back(y), ++deg[y];
            return;
        &amp;#125;;
        for (int i = 1; i &amp;lt;= n; ++i)
            i0[i] = init(), i1[i] = init();
        std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
            if (s[x])
                add(s[x], i1[x]);
            if (t[x])
                add(i0[x], t[x]);
            for (auto i : g1[x])
                if (i != fa) &amp;#123;
                    dep[i] = dep[x] + 1;
                    p[i][0].fa = x;
                    p[i][0].i0 = init(), p[i][0].i1 = init();
                    add(p[i][0].i0, i0[i]), add(i1[i], p[i][0].i1);
                    for (int j = 1; j &amp;lt;= K; ++j) &amp;#123;
                        p[i][j].fa = p[p[i][j - 1].fa][j - 1].fa;
                        if (!p[i][j].fa)
                            break;
                        p[i][j].i0 = init(), p[i][j].i1 = init();
                        add(p[i][j].i0, p[i][j - 1].i0);
                        add(p[i][j].i0, p[p[i][j - 1].fa][j - 1].i0);
                        add(p[i][j - 1].i1, p[i][j].i1);
                        add(p[p[i][j - 1].fa][j - 1].i1, p[i][j].i1);
                    &amp;#125;
                    DFS(i, x);
                &amp;#125;
            return;
        &amp;#125;;
        dep[1] = 1, DFS(1, -1);
        for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
            auto [x, y] = a[i];
            if (x == y)
                continue;
            if (t[x])
                add(i, t[x]);
            if (s[y])
                add(s[y], i);
            if (dep[x] &amp;lt; dep[y])
                std::swap(x, y);
            x = p[x][0].fa;
            if (dep[x] &amp;gt;= dep[y]) &amp;#123;
                for (int j = K; ~j; --j)
                    if (dep[p[x][j].fa] &amp;gt;= dep[y]) &amp;#123;
                        add(i, p[x][j].i0), add(p[x][j].i1, i);
                        x = p[x][j].fa;
                    &amp;#125;
                if (x == y)
                    continue;
                add(i, p[x][0].i0), add(p[x][0].i1, i);
                x = p[x][0].fa;
            &amp;#125;
            y = p[y][0].fa;
            if (x != y) &amp;#123;
                for (int j = K; ~j; --j)
                    if (p[x][j].fa != p[y][j].fa) &amp;#123;
                        add(i, p[x][j].i0), add(i, p[y][j].i0);
                        add(p[x][j].i1, i), add(p[y][j].i1, i);
                        x = p[x][j].fa, y = p[y][j].fa;
                    &amp;#125;
                add(i, p[x][0].i0), add(i, p[y][0].i0);
                add(p[x][0].i1, i), add(p[y][0].i1, i);
                x = p[x][0].fa;
            &amp;#125;
            add(i, i0[x]), add(i1[x], i);
        &amp;#125;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            if (!deg[i])
                q.push(i);
        int tot = 0;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop(), ++tot;
            for (auto i : g[x])
                if (!--deg[i])
                    q.push(i);
        &amp;#125;
        std::cout &amp;lt;&amp;lt; (tot == cnt ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="äºŒåˆ†" />
        <category term="å€å¢" />
        <category term="è°ƒæ•´æ³•" />
        <category term="æœ€çŸ­è·¯" />
        <updated>2025-09-24T06:27:15.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250922/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250922/"/>
        <content type="html">&lt;p&gt;æœ€è¿‘çš„å‡ åœº abc, arc, cf, æ¨¡æ‹Ÿèµ›é¢˜&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;g---set-list&#34;&gt;G - Set list&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc424/tasks/abc424_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc424/tasks/abc424_g&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---slime-swap&#34;&gt;B - Slime Swap&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc206/tasks/arc206_b&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc206/tasks/arc206_b&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---lis-lds&#34;&gt;D - LIS âˆ© LDS&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc206/tasks/arc206_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc206/tasks/arc206_d&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;bubble-sort&#34;&gt;#3761. Bubble Sort&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://poj.org/problem?id=3761&#34; class=&#34;uri&#34;&gt;http://poj.org/problem?id=3761&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f.-bubble-sort&#34;&gt;F. Bubble Sort&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/2146/problem/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/2146/problem/F&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-limited-edition-shop&#34;&gt;E. Limited Edition Shop&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/2151/problem/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/2151/problem/E&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ„é€ å‡ ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n=2,3\)&lt;/span&gt; çš„ä¾‹å­æ‰‹ç©ä¸€ä¸‹ï¼Œä¼šå‘ç°å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; ä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœåœ¨ A é‡Œçš„ç›¸å¯¹é¡ºåºæ˜¯ abï¼Œåœ¨ B é‡Œçš„ç›¸å¯¹é¡ºåºæ˜¯ baï¼Œé‚£ä¹ˆè¦é€‰ b å°±å¿…é¡»é€‰ aã€‚&lt;/li&gt;
&lt;li&gt;é‚£ä¹ˆä¼šæƒ³åˆ°æŠŠ A å˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå¯¹äº B ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœå…¶åæ–¹æœ‰æ›´å°çš„å…ƒç´ ï¼Œé‚£ä¹ˆå¿…é¡»é€‰äº†å®ƒæ‰èƒ½é€‰è¿™ä¸ªæ•°ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘åœ¨ B ä¸­ DP æœ€åé€‰å‡ºæ¥çš„é›†åˆï¼Œé‚£ä¹ˆå¯¹äºå½“å‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œ&lt;strong&gt;è‹¥ä¸é€‰ï¼Œåˆ™ä¸å…è®¸ã€å·²é€‰é›†åˆã€ä¸­å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;x\)&lt;/span&gt; çš„æ•°ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤º DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå½“å‰å·²é€‰é›†åˆæœ€å¤§å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æœ€å¤§é›†åˆå¤§å°ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,B_i}\gets f_{i-1,j}+v, j&amp;lt;B_i\\
f_{i,j}\gets f_{i-1, j}+v, j &amp;gt; B_i\\
f_{i,j}\gets f_{i-1,j}, j &amp;lt; B_i
\]&lt;/span&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ˜¾ç„¶å¯ä»¥çº¿æ®µæ ‘ä¼˜åŒ–è½¬ç§»&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
const long long inf = 1e18;
struct &amp;#123;
    int l, r;
    long long u, d;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void pushval(int p, long long v) &amp;#123;
    t[p].d += v, t[p].u += v;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d), pushval(rt, t[p].d);
    t[p].d = 0ll;
    return;
&amp;#125;
void pushup(int p) &amp;#123;
    t[p].u = std::max(t[lt].u, t[rt].u);
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    t[p].u = -inf, t[p].d = 0ll;
    if (l == r)
        return;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void upd(int p, int x, long long v) &amp;#123;
    t[p].u = std::max(t[p].u, v);
    if (t[p].l == t[p].r)
        return;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, x, v);
    else
        upd(rt, x, v);
    return;
&amp;#125;
void add(int p, int l, int r, long long v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
long long ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u;
    pushdown(p);
    long long res = -inf;
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        res = ask(lt, l, r);
    if (r &amp;gt; mid)
        res = std::max(res, ask(rt, l, r));
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n;
        std::cin &amp;gt;&amp;gt; n;
        std::vector&amp;lt;int&amp;gt; w(n + 1), k(n + 1), a(n + 1), b(n + 1), tab(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; w[i];
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; a[i], tab[a[i]] = i;
        for (int i = 1; i &amp;lt;= n; ++i)
            k[i] = w[a[i]];
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; b[i], b[i] = tab[b[i]];
        bld(1, 0, n), upd(1, 0, 0);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            if (b[i] != n)
                add(1, b[i] + 1, n, k[b[i]]);
            upd(1, b[i], ask(1, 0, b[i] - 1) + k[b[i]]);
        &amp;#125;
        std::cout &amp;lt;&amp;lt; t[1].u &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-å°çŒªç›–æˆ¿å­&#34;&gt;A. å°çŒªç›–æˆ¿å­&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/problem/51898&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/problem/51898&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; çš„ 01 çŸ©é˜µï¼Œæ¯ä¸€è¡Œæœ‰ 2 ä¸ª 1 æˆ–æ²¡æœ‰ 1ã€‚ç°éœ€é€‰æ‹©ä¸¤ä¸ª&lt;strong&gt;ç›¸é‚»çš„&lt;/strong&gt;è¡ŒåŒºé—´ï¼Œå¹¶ä¸º&lt;strong&gt;èŒƒå›´å†…çš„ç©ºè¡Œ&lt;/strong&gt;é€‰æ‹©ä¸¤ä¸ªä½ç½®æ”¹ä¸º 1ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªåŒºé—´æ˜¯å…¨ç­‰çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ±‚å¯èƒ½çš„æ–¹æ¡ˆã€‚å½“ç©ºè¡Œçš„æ¶‚è‰²æ–¹å¼ä¸åŒæˆ–é€‰æ‹©èŒƒå›´ä¸åŒçœ‹ä½œä¸åŒçš„æ–¹æ¡ˆã€‚å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt; å–æ¨¡ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,m\le 5000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;ç¬¬ä¸€ååº”æ˜¯æšä¸¾åˆ†ç•Œçº¿ + ä¸Šç«¯ç‚¹ï¼Œå‘ç°æ²¡æœ‰åŠæ³•åšï¼šå½“ä¸Šç«¯ç‚¹ç§»åŠ¨çš„æ—¶å€™ï¼Œä¸‹éƒ¨çŸ©å½¢ä¼šæ•´ä½“å¹³ç§»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;è¿›ä¸€æ­¥è€ƒè™‘å¯¼è‡´è¿™ä¸ªé—®é¢˜çš„åŸå› &lt;/strong&gt;ï¼Œæ„Ÿå—åˆ°ä¸€ä¸ªå› ç´ æ˜¯é•¿åº¦åœ¨å˜ã€‚&lt;/li&gt;
&lt;li&gt;æ•…å›ºå®šé•¿åº¦æšä¸¾ï¼Œå‰ç¼€å’Œç»Ÿè®¡ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {m(m-1)}2\)&lt;/span&gt; çš„å¹‚æ¬¡å³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
    std::freopen(&amp;quot;piggy.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;piggy.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    const auto stime = std::chrono::steady_clock::now();
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::array&amp;lt;int, 2&amp;gt; &amp;gt; a(n + 1);
    std::vector&amp;lt;long long&amp;gt; ps(n + 1);
    const int s = m * (m - 1) / 2;
    ps[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i][0] &amp;gt;&amp;gt; a[i][1];
        ps[i] = ps[i - 1] * s % mod;
    &amp;#125;
    auto res = 0ll;
    for (int i = 1; i &amp;lt;= n / 2; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; cnt0(n + 1), cnts(n + 1);
        for (int u = 1; u &amp;lt;= n - i; ++u) &amp;#123;
            int d = u + i;
            if (!a[u][0] &amp;amp;&amp;amp; !a[d][0])
                cnts[u] = 1;
            else if (a[u][0] &amp;amp;&amp;amp; a[d][0] &amp;amp;&amp;amp; (a[u][0] != a[d][0] || a[u][1] != a[d][1]))
                cnt0[u] = 1;
            cnts[u] += cnts[u - 1], cnt0[u] += cnt0[u - 1];
        &amp;#125;
        for (int u = 1; u &amp;lt;= n - 2 * i + 1; ++u) &amp;#123;
            int ss = cnts[u + i - 1] - cnts[u - 1], s0 = cnt0[u + i - 1] - cnt0[u - 1];
            if (!s0)
                (res += ps[ss] % mod) %= mod;
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-æ¢ä¹˜æ—…è¡Œ&#34;&gt;B. æ¢ä¹˜æ—…è¡Œ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/problem/51900&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/problem/51900&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‰‹ç©å¯ä»¥å‘ç°ã€ç¯ã€åœ¨é¢˜ç›®ä¸­æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿&lt;/li&gt;
&lt;li&gt;é‡è¦æ€§è´¨ï¼šè€ƒè™‘ä¸€ä¸ªç¯ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„ç‚¹ï¼Œä¸€å®šä¼šä»è¿™ä¸ªç‚¹å‡ºå‘æŠŠè¿™ä¸ªç¯è®¿é—®ä¸€éï¼Œåè¯æ³•æ˜“è¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…å¯ä»¥æŠŠæ¯ä¸ªç¯ç»™ã€åˆ é™¤ã€ã€‚å¯ä»¥ç”¨ä¸‹å›¾æ¦‚æ‹¬æ‰€æœ‰æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾å½“å‰ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; ä¸ºèµ·ç‚¹ï¼Œç»ˆç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œä¸”ä¹‹å‰å·²ç»åœ¨ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(s&amp;#39;\)&lt;/span&gt; ä¸ºèµ·ç‚¹æ—¶è®¿é—®è¿‡äº†ä¸€éƒ¨åˆ†è·¯å¾„ä¸Šçš„ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(m\to t\)&lt;/span&gt; æ˜¯æœ‰ç­”æ¡ˆçš„ï¼Œè€Œ &lt;span class=&#34;math inline&#34;&gt;\(s\to m\)&lt;/span&gt; éƒ½å¯ä»¥ç»§æ‰¿ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::freopen(&amp;quot;travel.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;travel.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt;::iterator&amp;gt; it(n + 1);
    for (int i = 1, k; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; k;
        for (int x; k--; )
            std::cin &amp;gt;&amp;gt; x, g[i].push_back(x);
        it[i] = g[i].begin();
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; res(n + 1), inq(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        if (!res[i]) &amp;#123;
            std::stack&amp;lt;int&amp;gt; st;
            for (int x = i; ; ) &amp;#123;
                if (it[x] == g[x].end() || res[x]) &amp;#123;
                    if (!res[x])
                        res[x] = x;
                    res[i] = res[x];
                    for (; !st.empty(); st.pop())
                        res[st.top()] = res[x], inq[st.top()] = 0;
                    break;
                &amp;#125;
                st.push(x), inq[x] = 1, x = *it[x];
                if (inq[x])
                    for (int p = -1; p != x; ) &amp;#123;
                        p = st.top(), st.pop();
                        inq[p] = 0, ++it[p];
                    &amp;#125;
            &amp;#125;
        &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-ä¼˜ç¾çš„è¡—æ™¯&#34;&gt;C. ä¼˜ç¾çš„è¡—æ™¯&lt;/h2&gt;
&lt;p&gt;no link&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_{1\cdots n}\)&lt;/span&gt;ï¼Œç°å®šä¹‰ã€ä¼˜ç¾å­æ®µã€&lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼šå­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(l\le t&amp;lt;r\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\max\{a_{l\sim t}\}&amp;lt;\min\{a_{t+1\sim r}\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ±‚å‡ºè¯¥æ’åˆ—ã€ä¼˜ç¾å­æ®µã€çš„ä¸ªæ•°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\le 3\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ç”±ç»å…¸ trick å‡ºå‘ï¼Œä¸€ä¸ªæƒ³æ³•æ˜¯ä»å°åˆ°å¤§æšä¸¾åˆ†è§£å€¼ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼Œå¹¶æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\le v\)&lt;/span&gt; çš„å€¼æ¶‚æˆç™½è‰²ï¼Œå‰©ä¸‹çš„æ¶‚æˆé»‘è‰²ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ­¤æ—¶ä¸€ä¸ªå‰ç™½åé»‘çš„å­æ®µæ˜¯ä¼˜ç¾çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä»¤å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„å…ƒç´ å¿…é¡»å‚ä¸å­æ®µç»„æˆã€‚æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ—¶ï¼Œåºåˆ—æ¯ä¸ªç‚¹é¢œè‰²å·²çŸ¥ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ‰€åœ¨çš„ä¼˜ç¾å­æ®µè¢«åŒ…å«äº &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ‰€åœ¨çš„ç™½é»‘å­æ®µä¸­ã€‚&lt;/p&gt;
&lt;p&gt;æ±‚å‡ºè¯¥å­æ®µï¼Œåˆ™åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ä¼˜ç¾å­æ®µï¼Œå·¦å³ç«¯ç‚¹å„æœ‰èŒƒå›´ï¼Œä¸”ä¸ä¼šç›¸äº’å½±å“ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ­¤æ—¶ä¸å¯ç›´æ¥è®¡æ•°ï¼šä¸€ä¸ªä¼˜ç¾å­æ®µä¼šè¢«å…¶ä¸­æ‰€æœ‰åˆæ³•åˆ†å‰²ç‚¹ç»Ÿè®¡ã€‚æ•…åšä¸€ä¸ª &lt;a href=&#34;https://www.luogu.com.cn/problem/P5490&#34;&gt;äºšç‰¹å…°è’‚æ–¯&lt;/a&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåƒæˆ‘ä¸€æ ·æ²¡æœ‰ç”šåŒºé—´é—®é¢˜ç»éªŒï¼Œå¯ä»¥ç”¨ 0 è¦†ç›–æ¬¡æ•°è¿™ä¸ª trick æ¥åå‘æ±‚ã€‚&lt;del&gt;å› è€Œè¢«ç¾¤å˜²äº†&lt;/del&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 3e5 + 5;
struct &amp;#123;
    int l, r, mn, u, d;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    t[p].u = r - l + 1;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void pushval(int p, int v) &amp;#123;
    t[p].d += v, t[p].mn += v;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    pushval(lt, t[p].d), pushval(rt, t[p].d);
    t[p].d = 0;
    return;
&amp;#125;
void pushup(int p) &amp;#123;
    t[p].u = 0;
    t[p].mn = std::min(t[lt].mn, t[rt].mn);
    if (t[lt].mn == t[p].mn)
        t[p].u = t[lt].u;
    if (t[rt].mn == t[p].mn)
        t[p].u += t[rt].u;
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        pushval(p, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid)
        add(lt, l, r, v);
    if (r &amp;gt; mid)
        add(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
    std::freopen(&amp;quot;street.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;street.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    const auto stime = std::chrono::steady_clock::now();
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), tab(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; mn(20, std::vector&amp;lt;int&amp;gt; (n + 1)), mx(20, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        tab[a[i]] = i, mn[0][i] = mx[0][i] = a[i];
    &amp;#125;
    for (int j = 1; (1 &amp;lt;&amp;lt; j) &amp;lt;= n; ++j)
        for (int i = 1; i + (1 &amp;lt;&amp;lt; j) - 1 &amp;lt;= n; ++i) &amp;#123;
            mn[j][i] = std::min(mn[j - 1][i], mn[j - 1][i + (1 &amp;lt;&amp;lt; (j - 1))]);
            mx[j][i] = std::max(mx[j - 1][i], mx[j - 1][i + (1 &amp;lt;&amp;lt; (j - 1))]);
        &amp;#125;
    auto askmn = [&amp;amp;](int l, int r) &amp;#123;
        int k = std::__lg(r - l + 1);
        return std::min(mn[k][l], mn[k][r - (1 &amp;lt;&amp;lt; k) + 1]);
    &amp;#125;;
    auto askmx = [&amp;amp;](int l, int r) &amp;#123;
        int k = std::__lg(r - l + 1);
        return std::max(mx[k][l], mx[k][r - (1 &amp;lt;&amp;lt; k) + 1]);
    &amp;#125;;
    auto res = 0ll;
    std::vector&amp;lt;std::vector&amp;lt;std::tuple&amp;lt;int, int, int&amp;gt; &amp;gt; &amp;gt; t(n + 1);
    auto ask1 = [&amp;amp;](int x, int v) &amp;#123; // æ‰¾åˆ° x å·¦ä¾§æœ€åä¸€ä¸ª &amp;lt;= v çš„
        int res = x;
        for (int l = 1, r = x, mid; l &amp;lt;= r; ) &amp;#123;
            mid = (l + r) &amp;gt;&amp;gt; 1;
            if (askmx(mid, x) &amp;lt;= v)
                r = mid - 1, res = mid;
            else
                l = mid + 1;
        &amp;#125;
        return res;
    &amp;#125;;
    auto ask2 = [&amp;amp;](int x, int v) &amp;#123; // æ‰¾åˆ° x å³ä¾§ç¬¬ä¸€ä¸ª &amp;gt; v çš„
        int res = -1;
        for (int l = x + 1, r = n, mid; l &amp;lt;= r; ) &amp;#123;
            mid = (l + r) &amp;gt;&amp;gt; 1;
            if (askmx(x, mid) &amp;gt; v)
                r = mid - 1, res = mid;
            else
                l = mid + 1;
        &amp;#125;
        return res;
    &amp;#125;;
    auto ask3 = [&amp;amp;](int x, int v) &amp;#123; // æ‰¾åˆ° x å³ä¾§æœ€åä¸€ä¸ª &amp;gt; v çš„
        int res = x;
        for (int l = x, r = n, mid; l &amp;lt;= r; ) &amp;#123;
            mid = (l + r) &amp;gt;&amp;gt; 1;
            if (askmn(x, mid) &amp;gt; v)
                l = mid + 1, res = mid;
            else
                r = mid - 1;
        &amp;#125;
        return res;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int cr = ask1(tab[i], i), tl = ask2(tab[i], i);
        if (tl != -1) &amp;#123;
            int tr = ask3(tl, i);
            t[cr].emplace_back(1, tl, tr);
            if (tab[i] != n)
                t[tab[i] + 1].emplace_back(-1, tl, tr);
        &amp;#125;
    &amp;#125;
    bld(1, 0, n);
    std::vector&amp;lt;int&amp;gt; cnt(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::sort(t[i].begin(), t[i].end(), std::greater&amp;lt;std::tuple&amp;lt;int, int, int&amp;gt; &amp;gt; ());
        for (auto [k, l, r] : t[i])
            add(1, l, r, k);
        res += n + 1 - ::t[1].u;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <updated>2025-09-22T10:37:38.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250820/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250820/"/>
        <content type="html">&lt;p&gt;å›°éš¾&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;b.-beautyæ‹†è´¡çŒ®&#34;&gt;B. beautyï¼ˆæ‹†è´¡çŒ®ï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6513/problem/2&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6513/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n,V\)&lt;/span&gt;ï¼Œæ±‚å‡ºå¯¹äºæ‰€æœ‰é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œå€¼åŸŸä¸º &lt;span class=&#34;math inline&#34;&gt;\([1,V]\)&lt;/span&gt; çš„åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\sum_{i=1}^n |a_i-a_{n-i+1}|\)&lt;/span&gt; çš„å’Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,V\le 5000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;å®¹æ˜“æƒ³åˆ°ç®—è´¡çŒ®ï¼Œä¼šæœ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(O(n^2V)\)&lt;/span&gt; çš„åšæ³•ã€‚ä½†æ˜¯æƒ³ &lt;span class=&#34;math inline&#34;&gt;\(O(nV)\)&lt;/span&gt; åšæ˜¯å¾ˆæŠ½è±¡çš„ï¼Œå’Œ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2V)\)&lt;/span&gt; çš„æ€è·¯å·²ç»å¾ˆä¸ä¸€æ ·äº†&lt;/li&gt;
&lt;li&gt;ç»å…¸ trickï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_{i+n/2}-a_i=\sum\limits_{x=0}^{+\infty} [a_i\le x&amp;lt;a_{i+n/2}]\)&lt;/span&gt; æ‹†è´¡çŒ® ã€‚æ•…è¦ç®— &lt;span class=&#34;math inline&#34;&gt;\(a_{i}-a_{i+n/2}\)&lt;/span&gt;ï¼Œåªéœ€è¦å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\in[a_i,a_{i+n/2})\)&lt;/span&gt; è®¡ç®—è´¡çŒ®ã€‚&lt;/li&gt;
&lt;li&gt;æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(x\in [1,V)\)&lt;/span&gt;ï¼Œå†æšä¸¾æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_t\ge x\)&lt;/span&gt;ã€‚é‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i\le x\)&lt;/span&gt;ï¼ŒåŒæ—¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n-t\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;gt;x\)&lt;/span&gt;ï¼›æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(i\le n/2\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_{i},a_{i+n/2}\)&lt;/span&gt; å¯¹æ•°åº”è¯¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\min(t,n-t)\)&lt;/span&gt;ã€‚æ•…å¯¹äºä¸€ä¸ªç¡®å®šçš„åºåˆ—ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\min(t,n-t)\)&lt;/span&gt; çš„è´¡çŒ®ã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘è®¡æ•°æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_t\le x\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œè¿™è¦æ±‚ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; å¤§çš„æ•° &lt;span class=&#34;math inline&#34;&gt;\(\le x\)&lt;/span&gt; è€Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(t+1\)&lt;/span&gt; å¤§çš„æ•° &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;x\)&lt;/span&gt;ï¼Œä¹Ÿå³åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([1,x]\)&lt;/span&gt; é‡Œæ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸ªæ•°å†åœ¨ &lt;span class=&#34;math inline&#34;&gt;\((x,V]\)&lt;/span&gt; é‡Œæ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(n-t\)&lt;/span&gt; ä¸ªæ•°ï¼Œæ³¨æ„è¿˜è¦å†ä¹˜ä¸Šè¿™ä¸¤ç§æ•°æ‹¼èµ·æ¥çš„æ–¹æ¡ˆæ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;beauty.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;beauty.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    std::vector&amp;lt;long long&amp;gt; fac(5001), inv(5001);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; pw(5001, std::vector&amp;lt;long long&amp;gt; (5001));
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= 5000; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
        pw[i][0] = 1ll;
        for (int j = 1; j &amp;lt;= 5000; ++j)
            pw[i][j] = pw[i][j - 1] * i % mod;
    &amp;#125;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[5000] = qkp(fac[5000], mod - 2);
    for (int i = 4999; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[m] % mod * inv[n - m] % mod;
    &amp;#125;;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, V;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; V;
        auto res(0ll);
        for (int x = 1; x &amp;lt; V; ++x)
            for (int t = 1; t &amp;lt; n; ++t) &amp;#123;
                int k = std::min(t, n - t);
                (res += k * pw[x][t] % mod * pw[V - x][n - t] % mod * C(n, t) % mod) %= mod;
            &amp;#125;
        std::cout &amp;lt;&amp;lt; res * 2 % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;c.-drink-barå®¹æ–¥-ååº&#34;&gt;C. Drink Barï¼ˆå®¹æ–¥ + ååºï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/AT_snuke21_j&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/AT_snuke21_j&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸‰ä¸ªå±æ€§éƒ½æ˜¯æ’åˆ—ï¼Œå¯ä»¥æ¨ç†å‡ºåªè¦ä¸¤ä¸ªä¸‰å…ƒç»„ä¸­ï¼Œä½œå‡ºè´¡çŒ®çš„å…ƒç´ ä¸å®Œå…¨ç›¸åŒï¼Œä¸¤ä¸ªä¸‰å…ƒç»„å°±ä¸åŒã€‚è®¨è®ºä½œå‡ºè´¡çŒ®çš„å…ƒç´ æ•°é‡ã€‚&lt;/li&gt;
&lt;li&gt;åªæœ‰ä¸€ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;æœ‰ä¸¤ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œä»»é€‰çš„è¯ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(C_n^2\)&lt;/span&gt;ï¼Œè¦å‡å»ä¸€ä¸ªå…ƒç´ ä¸¥æ ¼ä¼˜äºå¦ä¸€ä¸ªå…ƒç´ çš„æƒ…å†µï¼Œä¸‰ç»´ååºå³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æœ‰ä¸‰ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œæ˜¯ä¸ªæœ‰ç‚¹å¤æ‚çš„å®¹æ–¥ï¼Œä¸å¦¨è®¾ä¸‰å…ƒç»„ä¸º &lt;span class=&#34;math inline&#34;&gt;\((i,j,k)\)&lt;/span&gt;ï¼Œå…¶ä¸­è´¡çŒ®æ¬¡æ•°æœ€å¤šçš„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è´¡çŒ®äº† &lt;span class=&#34;math inline&#34;&gt;\(\ge 1\)&lt;/span&gt; æ¬¡ï¼Œæ–¹æ¡ˆæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(C_n^3\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è´¡çŒ®äº† &lt;span class=&#34;math inline&#34;&gt;\(\ge 2\)&lt;/span&gt; æ¬¡ï¼Œæšä¸¾ä½œå‡ºä¸¤æ¬¡è´¡çŒ®çš„å±æ€§ï¼Œä»¥ &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; ä¸ºä¾‹ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a_j,a_k&amp;lt;a_i\)&lt;/span&gt;ï¼Œä»¥åŠ &lt;span class=&#34;math inline&#34;&gt;\(b_j,b_k&amp;lt;b_i\)&lt;/span&gt;ï¼ŒäºŒç»´ååºå³å¯&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è´¡çŒ®äº† &lt;span class=&#34;math inline&#34;&gt;\(\ge 3\)&lt;/span&gt; æ¬¡ï¼Œä¾ç„¶æ˜¯ä¸‰ç»´ååºï¼Œå¯ä»¥ç”¨ã€ä¸¤ä¸ªå…ƒç´ åšå‡ºè´¡çŒ®ã€ä¸­ cdq å¾—åˆ°çš„å€¼ç®—å‡ºç­”æ¡ˆã€‚è®°å¾—ä¹˜ 2ï¼Œå› ä¸ºè¢«å¤šå‡äº† 2 æ¬¡ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    struct node &amp;#123; int a, b, c, res; &amp;#125;;
    std::vector&amp;lt;node&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i].a &amp;gt;&amp;gt; a[i].b &amp;gt;&amp;gt; a[i].c;
        a[i].res = 0;
    &amp;#125;
    long long res = n;
    res += (long long)n * (n - 1) / 2;
    std::vector&amp;lt;int&amp;gt; bit(n + 1);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            bit[x] += v;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        int res = 0;
        for (; x; x -= lowbit(x))
            res += bit[x];
        return res;
    &amp;#125;;
    std::function&amp;lt;void(int, int)&amp;gt; calc = [&amp;amp;](int l, int r) &amp;#123;
        if (l == r)
            return;
        int mid = (l + r) &amp;gt;&amp;gt; 1;
        calc(l, mid), calc(mid + 1, r);
        int j = l;
        for (int i = mid + 1; i &amp;lt;= r; ++i) &amp;#123;
            for (; j &amp;lt;= mid &amp;amp;&amp;amp; a[j].b &amp;lt; a[i].b; ++j)
                add(a[j].c, 1);
            a[i].res += ask(a[i].c);
        &amp;#125;
        for (int i = l; i &amp;lt; j; ++i)
            add(a[i].c, -1);
        std::inplace_merge(a.begin() + l, a.begin() + mid + 1, a.begin() + r + 1, [&amp;amp;](node x, node y) &amp;#123; return x.b &amp;lt; y.b; &amp;#125;);
        return;
    &amp;#125;;
    std::sort(a.begin() + 1, a.end(), [&amp;amp;](node x, node y) &amp;#123; return x.a &amp;lt; y.a; &amp;#125;);
    calc(1, n);
    for (int i = 1; i &amp;lt;= n; ++i)
        res -= a[i].res;
    res += (long long)n * (n - 1) * (n - 2) / 6;
    for (int k = 0; k &amp;lt; 3; ++k) &amp;#123;
        std::sort(a.begin() + 1, a.end(), [&amp;amp;](node x, node y) &amp;#123; return x.a &amp;lt; y.a; &amp;#125;);
        std::fill(bit.begin() + 1, bit.end(), 0);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            int t = ask(a[i].b);
            res -= (long long)t * (t - 1) / 2;
            add(a[i].b, 1);
            std::tie(a[i].a, a[i].b, a[i].c) = std::make_tuple(a[i].b, a[i].c, a[i].a);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        res += (long long)a[i].res * (a[i].res - 1);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;c.-æ˜Ÿç™½-by-ttpandasç¬›å¡å°”æ ‘-dsu-on-tree&#34;&gt;C. æ˜Ÿç™½ by TTpandaSï¼ˆç¬›å¡å°”æ ‘ + dsu on treeï¼‰&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;/20250819/#æ˜Ÿç™½-by-ttpandasç¬›å¡å°”æ ‘-dsu-on-tree&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;c.-isn&#34;&gt;C. isn&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://hydro.ac/p/bzoj-P4361&#34; class=&#34;uri&#34;&gt;https://hydro.ac/p/bzoj-P4361&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æœ€åä¸€ä¸ªåˆ å»çš„ä¸€å®šæ˜¯è¿æ¥ &lt;code&gt;&amp;gt;&lt;/code&gt; çš„æ•°ï¼Œå¯ä»¥ DP è¿˜å‰©ä¸€ä¸ªæ•°æ²¡åˆ æ—¶å¯èƒ½çš„åºåˆ—ã€‚&lt;/p&gt;
ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,0/1}\)&lt;/span&gt; è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œåºåˆ—é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œæœ€åä¸€ä¸ªè¢«åˆ å»çš„æ•°ï¼ˆæœªï¼‰è¢«ç¡®å®šçš„æ–¹æ¡ˆæ•°ã€‚&lt;strong&gt;æ³¨æ„ç¡®å®šæœ€åä¸€ä¸ªè¢«åˆ å»çš„æ•°è¦åœ¨è½¬ç§»è¿‡ç¨‹ä¸­è¿›è¡Œï¼Œè€Œä¸æ˜¯ä½œä¸ºä¸€ä¸ª DP èŠ‚ç‚¹&lt;/strong&gt;ï¼Œå¾ˆå®¹æ˜“å‘ç°åè€…æ˜¯é”™çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä¼˜åŒ–çš„æ€è·¯å°±ä¸ä¸€æ ·äº†ã€‚å› ä¸ºè¦ä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\((n-j)!\)&lt;/span&gt;ï¼Œæ‰€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„è¿™ä¸€ç»´æ˜¯çœä¸æ‰çš„&lt;/p&gt;
è€ƒè™‘ä¸ç®¡æœ€åä¸€ä¸ªè¢«åˆ æ‰çš„æ•°ï¼Œç›´æ¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œåºåˆ—é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\sum\limits_{a_k\le a_i}f_{k,j - 1}\)&lt;/span&gt;ï¼Œå¯ä»¥ DS ä¼˜åŒ–ã€‚ä½†è¿™æ ·ä¼šäº§ç”Ÿä¸åˆæ³•çš„æƒ…å†µã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è€ƒå¯Ÿä»€ä¹ˆæ ·çš„åºåˆ—åˆæ³•ï¼Œå‘ç°&lt;strong&gt;åˆ å»çš„æœ€åä¸€ä¸ªæ•°ä¸€å®šæ˜¯éæ³•çš„ï¼Œä¹Ÿå°±æ˜¯åŒ…å«ä¹‹çš„åºåˆ—éƒ½æ˜¯éæ³•çš„ï¼›åä¹‹æ˜“å¾—è¢«åˆæ³•åºåˆ—åŒ…å«çš„åºåˆ—éƒ½éæ³•&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;æ˜ç™½äº†è¿™ä¸€ç‚¹è¿‡åå°±ä¼šçŸ¥é“é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„åˆæ³•åºåˆ—ç³»æ•°éƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\((n-j)!\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ•…å®¹æ–¥ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g_i\)&lt;/span&gt; è¡¨ç¤ºåºåˆ—é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(h_i\)&lt;/span&gt; è¡¨ç¤ºåºåˆ—é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„åˆæ³•æ–¹æ¡ˆæ•°ã€‚ä»å¼‚æˆ–è§’åº¦è€ƒè™‘ï¼Œæ˜“å¾— &lt;span class=&#34;math inline&#34;&gt;\(h_i=g_i-\sum\limits_{j=i+1}h_j\times (j-i)!\times C_j^i\)&lt;/span&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;isn.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;isn.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), l(1);
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i], l.push_back(a[i]);
        fac[i] = fac[i - 1] * i % mod;
    &amp;#125;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[m] % mod * inv[n - m] % mod;
    &amp;#125;;
    std::sort(l.begin(), l.end());
    l.erase(std::unique(l.begin(), l.end()), l.end());
    for (int i = 0; i &amp;lt;= n; ++i)
        a[i] = std::lower_bound(l.begin(), l.end(), a[i]) - l.begin() + 1;
    int m = (int)l.size();
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; bit(n + 1, std::vector&amp;lt;long long&amp;gt; (m + 1));
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int id, int x, long long v) &amp;#123;
        for (; x &amp;lt;= m; x += lowbit(x))
            (bit[id][x] += v) %= mod;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int id, int x) &amp;#123;
        auto res(0ll);
        for (; x; x -= lowbit(x))
            (res += bit[id][x]) %= mod;
        return res;
    &amp;#125;;
    std::vector&amp;lt;long long&amp;gt; g(n + 1), h(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long long&amp;gt; (n + 1));
    add(0, a[0], 1ll), f[0][0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = n; j; --j) &amp;#123;
            f[i][j] = ask(j - 1, a[i]);
            add(j, a[i], f[i][j]);
            (g[j] += f[i][j] * fac[n - j]) %= mod;
        &amp;#125;
    auto res(0ll);
    for (int i = n; i; --i) &amp;#123;
        h[i] = g[i];
        for (int j = i + 1; j &amp;lt;= n; ++j)
            (h[i] += mod - h[j] * fac[j - i] % mod * C(j, i) % mod) %= mod;
        (res += h[i]) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;d.-thepowers&#34;&gt;D. ThePowers&lt;/h3&gt;
&lt;p&gt;TopCoder - 12185ï¼ŒåŸé¢˜äº¤ä¸äº†æ•…ä¸æ”¾é“¾æ¥äº†&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6522/problem/4&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6522/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(A,B\)&lt;/span&gt;ï¼Œå¯¹äºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(X\le A,Y\le B\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(X^Y\)&lt;/span&gt; çš„å¯èƒ½å–å€¼æ•°é‡ã€‚&lt;span class=&#34;math inline&#34;&gt;\(A,B\le10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘ä»€ä¹ˆæ—¶å€™ç®—é‡ã€‚å‘ç°å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(x^a=y^b\)&lt;/span&gt;ï¼Œæ­¤æ—¶è®° &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;=a\div\gcd(a,b),b&amp;#39;=b\div \gcd(a,b)\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(t=\sqrt[a&amp;#39;]x=\sqrt[b&amp;#39;]y\)&lt;/span&gt; ä¸ºæ•´ï¼ˆå†™æˆè´¨å› æ•°ä¹˜ç§¯æ˜¯æ˜“è¯çš„ï¼‰ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(x=t^b,y=t^a\)&lt;/span&gt;ï¼Œæ˜¯åŒä¸€ä¸ªæ•°çš„ä¸åŒæ¬¡å¹‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å†…æ‰€æœ‰æ•°åˆ†ç»„ï¼Œè®° &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt; è¡¨ç¤ºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„æ¬¡å¹‚ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸æ˜¯å…¶ä»–æ•°çš„æ¬¡å¹‚&lt;/p&gt;
å‘ç°ä¸€ä¸ªå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;\sqrt A\)&lt;/span&gt; çš„æ•° &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt;ï¼Œåªæœ‰å¯èƒ½å±äº &lt;span class=&#34;math inline&#34;&gt;\(S_y\)&lt;/span&gt;ï¼Œæˆ–ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\le \sqrt A\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt;ã€‚æ¯ç»„æœ€å¤šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(30\)&lt;/span&gt; ä¸ªï¼Œæ•…æ‰«ä¸€é &lt;span class=&#34;math inline&#34;&gt;\(\le\sqrt A\)&lt;/span&gt; çš„æ•°å³å¯å®Œæˆåˆ†ç»„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿™æ ·å°±åªç”¨è€ƒè™‘åŒç»„å†…çš„è®¡æ•°ã€‚å³å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(p\le |S_x|,y\le B\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x^{py}\)&lt;/span&gt; æœ‰å¤šå°‘ç§å–å€¼ï¼Œä¹Ÿå³ &lt;span class=&#34;math inline&#34;&gt;\(py\)&lt;/span&gt; æœ‰å¤šå°‘ç§å–å€¼&lt;/p&gt;
å‘ç°å› ä¸ºå€¼åŸŸæ˜¯è¿ç»­çš„ï¼Œå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt;ï¼Œåªè¦ &lt;span class=&#34;math inline&#34;&gt;\(pB\)&lt;/span&gt; èŒƒå›´å†…æŸä¸ªæ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; çš„å€æ•°å°±å¯ä»¥å–åˆ°ï¼Œæšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\([(p-1)B+1,pB]\)&lt;/span&gt;ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å®¹æ–¥ï¼Œå°±éœ€è¦è®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(p\sim |S_x|\)&lt;/span&gt; çš„æ¯ä¸ªå­é›†ï¼Œå¤æ‚åº¦ä¼šçˆ†ç‚¸ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x,y\in[p,|S_x|]\)&lt;/span&gt;ï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å€æ•°ï¼Œå°±å¯ä»¥ skipï¼Œåªåœ¨å‰©ä¸‹çš„å…ƒç´ é‡Œæšä¸¾å­é›†ï¼Œå¯ä»¥ä»£ç éªŒè¯ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(30\)&lt;/span&gt; ä»¥å†…æœ€å¤šå‰©ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(15\)&lt;/span&gt; ä¸ªæ•°ï¼Œå¯ä»¥æ¥å—ï¼Œæ³¨æ„å­é›†ä¿¡æ¯ç±»ä¼¼é«˜ç»´å‰ç¼€å’Œåœ° &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ±‚å°±è¡Œäº†&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;power.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;power.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    long long A, B, mx = 1ll;
    std::cin &amp;gt;&amp;gt; A &amp;gt;&amp;gt; B;
    if (A == 1) &amp;#123;
        std::cout &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    int cnt = 1;
    long long res = 1ll;
    for (; (mx + 1) * (mx + 1) &amp;lt;= A; ++mx);
    std::vector&amp;lt;int&amp;gt; tag(mx + 1);
    for (int i = 2; i &amp;lt;= mx; ++i)
        if (!tag[i]) &amp;#123;
            int siz = 1;
            for (long long j = i; j &amp;lt;= A; j *= i, ++siz)
                if (j &amp;lt;= mx)
                    tag[j] = 1;
            cnt += --siz;
            for (int j = 1; j &amp;lt;= siz; ++j) &amp;#123;
                std::vector&amp;lt;int&amp;gt; p(&amp;#123; j &amp;#125;);
                for (int k = j + 1; k &amp;lt;= siz; ++k) &amp;#123;
                    bool flag = 1;
                    for (auto l : p)
                        if (k % l == 0) &amp;#123;
                            flag = 0;
                            break;
                        &amp;#125;
                    if (flag)
                        p.push_back(k);
                &amp;#125;
                int m = (int)p.size(), s = 1 &amp;lt;&amp;lt; m;
                std::vector&amp;lt;long long&amp;gt; mul(s);
                mul[0] = 1ll;
                auto lcm = [&amp;amp;](long long x, long long y) &amp;#123;
                    return x / std::__gcd(x, y) * y;
                &amp;#125;;
                for (int k = 1; k &amp;lt; s; ++k) &amp;#123;
                    mul[k] = lcm(p[std::__lg(k ^ ((k - 1) &amp;amp; k))], mul[(k - 1) &amp;amp; k]);
                    if (__builtin_popcount(k) &amp;amp; 1)
                        res += j * B / mul[k] - (j - 1) * B / mul[k];
                    else
                        res -= j * B / mul[k] - (j - 1) * B / mul[k];
                &amp;#125;
            &amp;#125;
        &amp;#125;
    res += (A - cnt) * B;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;æœç´¢åšæ³•æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå°±ä¸èµ˜è¿°äº†&lt;/p&gt;
</content>
        <category term="DP" />
        <category term="è®¡æ•°" />
        <category term="CDQ åˆ†æ²»" />
        <updated>2025-08-20T12:26:44.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250807/</id>
        <title>å­¦ä¹ ç¬”è®°ï¼šåˆ†æ‹†æ•°ä¸ Ferrers å›¾</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250807/"/>
        <content type="html">&lt;p&gt;éœ€è¦çŸ¥é“æ¦‚å¿µå’Œæ±‚æ³•ï¼Œæœ‰ä¸€å®šçš„ç”¨å¤„&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;åˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°&#34;&gt;åˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°&lt;/h2&gt;
&lt;p&gt;è¦æ±‚ï¼šç»™å®šä¸€ä¸ªæ­£æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œè¦æ±‚å°†å…¶åˆ’åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªå¯é‡ / ä¸å¯é‡çš„æ­£æ•´æ•°ï¼Œé—®æœ¬è´¨ä¸åŒçš„æ–¹æ¡ˆæ•°ã€‚ï¼ˆæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(\sqrt n\)&lt;/span&gt; åŒé˜¶ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;ä¸å¦¨ä»¤åˆ’åˆ†ç»“æœå•è°ƒä¸é™ï¼Œåˆ™æœ‰ä¸¤ç§ DP è·¯å¾„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æ³•ä¸€ï¼šä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ†æˆ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæ­£æ•´æ•°çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯é‡ï¼šè€ƒè™‘å°†è¿™ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæ•°å‡å» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚æœ€å¤šä¸€ä¸ªå…ƒç´ ç”± &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œç»„æ•°å‡å°‘ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼›å…¶ä»–æ—¶å€™è¿˜æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ç»„ã€‚æ•…äº‘ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=f_{i-j,j-1}+f_{i-j,j}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¯é‡ï¼šå¦‚æœå­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå¯ä»¥åˆ é™¤ä¹‹ç„¶åè½¬ç§»ï¼›å¦åˆ™ä»æ•´ä½“å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; è½¬ç§»ã€‚æ•…æ›° &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=f_{i-1,j-1}+f_{i-j,j}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
è¯¥è½¬ç§»æ–¹æ³•å”¯ä¸€æ€§å¾ˆæ˜¾ç„¶ã€‚&lt;strong&gt;æ³¨æ„åˆ°ç¬¬äºŒç»´åªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(j,j-1\)&lt;/span&gt; æœ‰å…³ï¼›å¯ä»¥äº¤æ¢å‰åä¸¤ç»´é¡ºåºç„¶åæ»šåŠ¨ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ³•äºŒï¼šä»¤ &lt;span class=&#34;math inline&#34;&gt;\(n=\sum a_i\)&lt;/span&gt;ï¼Œå»ºç«‹ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å·®åˆ†æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ï¼Œåˆ™æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n=\sum\limits_{i=1}^m \sum\limits_{j=1}^i c_j=\sum\limits_{i=1}^m (n-i+1)\times a_i\)&lt;/span&gt;ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æ¯å¢å¤§ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œç­”æ¡ˆä¼šå¢å¤§ &lt;span class=&#34;math inline&#34;&gt;\(n-i+1\)&lt;/span&gt;ã€‚æ•…è½¬åŒ–ä¸ºã€ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‰©å“é‡é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n-i+1\)&lt;/span&gt;ã€çš„å®Œå…¨èƒŒåŒ…ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸å¯é‡ï¼šè¦æ±‚æ¯ä¸ªç‰©å“è‡³å°‘é€‰ä¸€æ¬¡ã€‚&lt;/li&gt;
&lt;li&gt;å¯é‡ï¼šæ— é™åˆ¶ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯¥æ–¹æ³•å”¯ä¸€æ€§æ›´æ˜¾ç„¶ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¤æ‚åº¦å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(O(V\sqrt V)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¾‹sets-of-complementary-sums&#34;&gt;ä¾‹ï¼šSets of Complementary Sums&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;/20250723/#e.-sets-of-complementary-sums&#34;&gt;link&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ferrers-å›¾&#34;&gt;Ferrers å›¾&lt;/h2&gt;
&lt;p&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªåˆ†æ‹†å‡ºæ¥çš„æ•°ç”¨æ¨ªå‘æŸ±çŠ¶å›¾è¡¨ç¤ºå¹¶å•è°ƒä¸å¢æ’åˆ—ï¼Œå¾—åˆ° Ferrers å›¾ã€‚&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;image-1.png&#34; alt=&#34;ä¾‹ï¼š12=5+4+2+1 çš„ Ferrers å›¾ï¼ˆå›¾æº OI Wikiï¼‰&#34; /&gt;&lt;figcaption&gt;ä¾‹ï¼š&lt;span class=&#34;math inline&#34;&gt;\(12=5+4+2+1\)&lt;/span&gt; çš„ Ferrers å›¾ï¼ˆå›¾æº OI Wikiï¼‰&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;å°†å›¾åƒæ–œå‘ç¿»æŠ˜å¾—åˆ°ä¸€ç»„å…±è½­è§£ï¼ŒåŸå›¾ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å³ä¸ºå…±è½­è§£ä¸­çš„å…ƒç´ æœ€å€¼ã€‚æ•…äº¦å¯é™å®šåˆ†æ‹†ç»“æœçš„æœ€å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œåˆ™ç»“æœä»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{n,k}\)&lt;/span&gt;ã€‚åŒæ—¶é€‚ç”¨äºåˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é¡ºå¸¦æä¸€å˜´æ¨è¡¨ï¼šæŠŠç‚¹æ›¿æ¢æˆ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt;ï¼Œå¹¶ä½¿å¾—ä¸€ä¸ªç‚¹åŒæ—¶å¤§äºå·¦ä¾§å’Œä¸Šæ–¹çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¼¼ä¹å°±ä¸æ˜¯å¾ˆæœ‰ç”¨äº†ã€‚è®¡æ•°é¢˜å¯èƒ½ä¼šè€ƒã€‚&lt;/p&gt;
</content>
        <category term="DP" />
        <updated>2025-08-07T08:20:45.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250805/</id>
        <title>çŠ¶å‹ DP</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250805/"/>
        <content type="html">&lt;p&gt;æ²¡è¡¥å®Œï¼ˆ1/3ï¼‰ï¼ŒåŠ¨ä½œè¿˜æ˜¯å¤ªæ…¢äº†&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---åªä¸è¿‡æ˜¯é•¿çš„é¢†å¸¦-2-just-long-neckties-2&#34;&gt;A - åªä¸è¿‡æ˜¯é•¿çš„é¢†å¸¦ 2 / Just Long Neckties 2&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11665&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11665&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦è§‚å¯Ÿåˆ°ï¼Œä»»æ„æ—¶åˆ» &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; ä¸­ä¸å­˜åœ¨é‡å¤å…ƒç´ ã€‚æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; å‹å‡ºæ¥ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,S}\)&lt;/span&gt; è¡¨ç¤ºé€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå½“å‰ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; æ˜¯å¦å¯è¡Œï¼Œèƒ½å¤Ÿ &lt;span class=&#34;math inline&#34;&gt;\(O(n\cdot 2^V)\)&lt;/span&gt;ã€‚å¯¹äºæŸä¸ª &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œåªå…³å¿ƒå®ƒæœ€è¿œèƒ½åˆ°è¾¾å“ªä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; è®°å½•ä¹‹ã€‚å¯¹äºæ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œéƒ½å¯ä»¥æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; åç¬¬ä¸€å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i,a_{i+1}\notin S\)&lt;/span&gt;ï¼Œç”¨å…¶åˆ·è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°ã€æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; åç¬¬ä¸€å¯¹éæ³•å…ƒç´ ã€æ˜¯å¾ˆæ…¢çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ï¼›å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; åœ¨å…¶åç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_x=p\)&lt;/span&gt; ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åæ–¹ &lt;span class=&#34;math inline&#34;&gt;\(a_y=p,a_{y+1}=q\)&lt;/span&gt; ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œç›¸å½“äº&lt;strong&gt;å…ˆæ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å†æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\((p,q)\)&lt;/span&gt;&lt;/strong&gt;ï¼Œå°±å¯ä»¥åšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(V^2\cdot 2^V+n\cdot V)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    int V = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        V = std::max(V, a[i]--);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; tx(n + 1, std::vector&amp;lt;int&amp;gt; (V)), ty(n + 1, std::vector&amp;lt;int&amp;gt; (V));
    std::vector&amp;lt;int&amp;gt; lp(V);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; lpq(V, std::vector&amp;lt;int&amp;gt; (V));
    for (int i = n; ~i; --i) &amp;#123;
        if (i &amp;amp;&amp;amp; i != n)
            lpq[a[i]][a[i + 1]] = i;
        for (int j = 0; j &amp;lt; V; ++j) &amp;#123;
            tx[i][j] = lp[j];
            if (i != n)
                ty[i][j] = lpq[a[i]][j];
        &amp;#125;
        if (i != 0)
            lp[a[i]] = i;
    &amp;#125;
    int siz = 1 &amp;lt;&amp;lt; V, res = 21;
    std::vector&amp;lt;int&amp;gt; f(siz);
    for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; p0, p1;
        for (int j = 0; j &amp;lt; V; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1)
                p1.push_back(j);
            else
                p0.push_back(j);
        int j = n;
        for (auto p : p0)
            if (tx[f[i]][p])
                for (auto q : p0)
                    if (ty[tx[f[i]][p]][q])
                        j = std::min(j, ty[tx[f[i]][p]][q]);
        if (j != n) &amp;#123;
            f[i ^ (1 &amp;lt;&amp;lt; a[j])] = std::max(f[i ^ (1 &amp;lt;&amp;lt; a[j])], j);
            f[i ^ (1 &amp;lt;&amp;lt; a[j + 1])] = std::max(f[i ^ (1 &amp;lt;&amp;lt; a[j + 1])], j + 1);
            for (auto k : p1) &amp;#123;
                f[i ^ (1 &amp;lt;&amp;lt; k) ^ (1 &amp;lt;&amp;lt; a[j])] = std::max(f[i ^ (1 &amp;lt;&amp;lt; k) ^ (1 &amp;lt;&amp;lt; a[j])], j);
                f[i ^ (1 &amp;lt;&amp;lt; k) ^ (1 &amp;lt;&amp;lt; a[j + 1])] = std::max(f[i ^ (1 &amp;lt;&amp;lt; k) ^ (1 &amp;lt;&amp;lt; a[j + 1])], j + 1);
            &amp;#125;
        &amp;#125;
        else
            res = std::min(res, __builtin_popcount(i));
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---cut-and-reorder&#34;&gt;B - Cut and Reorder&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc328/tasks/abc328_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc328/tasks/abc328_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸å¦¨å…ˆé‡æ’å†ä¿®æ”¹ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,S}\)&lt;/span&gt; è¡¨ç¤ºå·²ç»é‡æ’å¥½æ–°åºåˆ—çš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå…ƒç´ ï¼Œå¯¹åº”åŸåºåˆ—çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; çš„æœ€å°ä»£ä»·ã€‚æšä¸¾æ–°åŒºé—´å®¹æ˜“è½¬ç§»ã€‚å¯ä»¥å‘ç°æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(i,S\)&lt;/span&gt; çš„å®é™…å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(2^n)\)&lt;/span&gt;ï¼ˆç©ºé—´ä¹Ÿå¯ä»¥è¿™ä¹ˆä¼˜åŒ–ï¼‰ï¼Œé¢„å¤„ç†ä¹‹åæ€»æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2\cdot 2^n)\)&lt;/span&gt;ï¼Œè·‘ä¸æ»¡ï¼Œå¯ä»¥é€šè¿‡ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    long long c;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; c;
    std::vector&amp;lt;long long&amp;gt; a(n), b(n);
    for (int i = 0; i &amp;lt; n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 0; i &amp;lt; n; ++i)
        std::cin &amp;gt;&amp;gt; b[i];
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    brr p(n, arr(n));
    crr g(n, brr(n, arr(n)));
    for (int l = 0; l &amp;lt; n; ++l)
        for (int r = l; r &amp;lt; n; ++r) &amp;#123;
            for (int k = l; k &amp;lt;= r; ++k)
                p[l][r] ^= (1 &amp;lt;&amp;lt; k);
            for (int R = r - l; R &amp;lt; n; ++R)
                for (int L = R, j = r; j &amp;gt;= l; --L, --j)
                    g[l][r][R] += std::abs(b[L] - a[j]);
        &amp;#125;
    int siz = 1 &amp;lt;&amp;lt; n;
    std::vector&amp;lt;long long&amp;gt; f(siz, inf);
    f[0] = 0ll;
    for (int j = 1; j &amp;lt; siz; ++j) &amp;#123;
        int i = __builtin_popcount(j) - 1;
        for (int r = 0; r &amp;lt; n; ++r)
            for (int l = r; ~l &amp;amp;&amp;amp; ((j &amp;gt;&amp;gt; l) &amp;amp; 1); --l)
                f[j] = std::min(f[j], f[j ^ p[l][r]] + g[l][r][i] + c);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[siz - 1] - c &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---electric-circuit&#34;&gt;C - Electric Circuit&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc321/tasks/abc321_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc321/tasks/abc321_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆåƒ&lt;a href=&#34;/20250430/#æœ‰æ ‡å·æ— å‘å›¾è®¡æ•°&#34;&gt;æ— å‘å›¾å®¹æ–¥&lt;/a&gt;ï¼Ÿä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; è¡¨ç¤ºè®© &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…éƒ¨å®Œæˆé…å¯¹ï¼Œå¯ä»¥ä¸è¿é€šçš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å†…éƒ¨ç‚¹å‡ºã€å…¥åº¦ä¹‹å’Œç›¸ç­‰ï¼ˆè®°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(cnt\)&lt;/span&gt;ï¼‰æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_S\)&lt;/span&gt; æœ‰å€¼ &lt;span class=&#34;math inline&#34;&gt;\(cnt!\)&lt;/span&gt;ã€‚ç›¸ä¼¼åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(g_S\)&lt;/span&gt; è¡¨ç¤ºè®© &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å®Œæˆé…å¯¹ï¼Œæˆä¸ºä¸€ä¸ªè¿é€šå—çš„æ–¹æ¡ˆæ•°ï¼Œå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(g_S=f_S-\sum\limits_{v\in S} f_{S\oplus v}\cdot g_v\)&lt;/span&gt;ã€‚è®© &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å¿…é¡»åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­ç¼–å·æœ€å°çš„ç‚¹å°±å¯ä»¥å»é‡ã€‚&lt;/p&gt;
&lt;p&gt;ä»è´¡çŒ®çš„è§’åº¦å‡ºå‘ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å¸¦æ¥çš„è´¡çŒ®å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(g_S\cdot f_{U\oplus S}\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(U\)&lt;/span&gt; æ˜¯å…¨é›†ã€‚æœ€åé™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(M!\)&lt;/span&gt; æ±‚å‡ºæœŸæœ›ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(3^n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; ci(n), co(n);
    for (int i = 1, x; i &amp;lt;= m; ++i)
        std::cin &amp;gt;&amp;gt; x, ++ci[x - 1];
    for (int i = 1, x; i &amp;lt;= m; ++i)
        std::cin &amp;gt;&amp;gt; x, ++co[x - 1];
    std::vector&amp;lt;long long&amp;gt; fac(m + 1);
    fac[0] = 1ll;
    for (int i = 1; i &amp;lt;= m; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    int siz = 1 &amp;lt;&amp;lt; n;
    std::vector&amp;lt;long long&amp;gt; f(siz), g(siz);
    for (int i = 1; i &amp;lt; siz; ++i) &amp;#123;
        int si = 0, so = 0;
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1)
                si += ci[j], so += co[j];
        if (si == so)
            f[i] = fac[si];
    &amp;#125;
    auto res(0ll);
    for (int i = 1; i &amp;lt; siz; ++i) &amp;#123;
        g[i] = f[i];
        int mn = 0;
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1) &amp;#123;
                mn = j;
                break;
            &amp;#125;
        int s = i ^ (1 &amp;lt;&amp;lt; mn);
        (g[i] += mod - g[1 &amp;lt;&amp;lt; mn] * f[s] % mod) %= mod;
        for (int j = (s - 1) &amp;amp; s; j; j = (j - 1) &amp;amp; s)
            (g[i] += mod - g[j ^ (1 &amp;lt;&amp;lt; mn)] * f[s ^ j] % mod) %= mod;
        if (i != siz - 1)
            (res += g[i] * f[(siz - 1) ^ i]) %= mod;
        else
            (res += g[i]) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res * qkp(fac[m], mod - 2) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---count-grid-3-coloring&#34;&gt;D - Count Grid 3-coloring&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc379/tasks/abc379_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc379/tasks/abc379_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è½®å»“çº¿ DPã€‚æŠŠæ¯ä¸€åˆ—å·²ç»ç¡®å®šçš„æœ€é ä¸‹çš„å…ƒç´ å‹èµ·æ¥ï¼Œæ¯è¡Œé€ä¸ªç¡®å®šå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æœ‰æ•ˆçŠ¶æ€ä¸­åªèƒ½å®¹è®¸æœ€å¤šä¸€å¯¹ç›¸é‚»ç›¸åŒå…ƒç´ ï¼Œè¿™æ ·å¤æ‚åº¦å°±èƒ½é™ä¸‹æ¥äº†ã€‚æ³¨æ„ç‰¹åˆ¤ &lt;span class=&#34;math inline&#34;&gt;\(1\times 1\)&lt;/span&gt; çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::array&amp;lt;int, 15&amp;gt; p;
    p[0] = 1;
    for (int i = 1; i &amp;lt; 15; ++i)
        p[i] = p[i - 1] * 3;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; a;
    if (n &amp;gt;= m) &amp;#123;
        a.assign(n + 1, std::vector&amp;lt;int&amp;gt; (m + 1));
        for (int i = 1; i &amp;lt;= n; ++i) 
            for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
                char t;
                std::cin &amp;gt;&amp;gt; t, a[i][j] = (t == &amp;#39;?&amp;#39; ? -1 : t - &amp;#39;1&amp;#39;);
            &amp;#125;
    &amp;#125;
    else &amp;#123;
        std::swap(n, m);
        a.assign(n + 1, std::vector&amp;lt;int&amp;gt; (m + 1));
        for (int i = 1; i &amp;lt;= m; ++i)
            for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
                char t;
                std::cin &amp;gt;&amp;gt; t, a[j][i] = (t == &amp;#39;?&amp;#39; ? -1 : t - &amp;#39;1&amp;#39;);
            &amp;#125;
    &amp;#125;
    int siz = p[m];
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    std::vector&amp;lt;int&amp;gt; s, tab(siz, -1);
    auto getv_1 = [&amp;amp;](int j, int i) &amp;#123;
        return (j / p[i - 1]) % 3;
    &amp;#125;;
    auto getv = [&amp;amp;](int j, int i) &amp;#123;
        return (s[j] / p[i - 1]) % 3;
    &amp;#125;;
    auto chg = [&amp;amp;](int j, int i, int v) &amp;#123;
        return tab[s[j] - p[i - 1] * getv(j, i) + p[i - 1] * v];
    &amp;#125;;
    auto out = [&amp;amp;](int i) &amp;#123;
        std::string s;
        for (int j = 1; j &amp;lt;= m; ++j)
            s += &amp;#39;1&amp;#39; + getv_1(i, j);
        return s.c_str();
    &amp;#125;;
    for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
        s.push_back(i);
        int cnt = 0;
        for (int j = 2; j &amp;lt;= m; ++j)
            if (getv_1(i, j - 1) == getv_1(i, j) &amp;amp;&amp;amp; ++cnt &amp;gt;= 2) &amp;#123;
                s.pop_back();
                break;
            &amp;#125;
    &amp;#125;
    for (int i = 0; i &amp;lt; (int)s.size(); ++i)
        tab[s[i]] = i;
    siz = (int)s.size();
    if (n == 1) &amp;#123;
        std::cout &amp;lt;&amp;lt; (a[1][1] == -1 ? 3 : 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    crr f(n + 1, brr(m + 1, arr(siz)));
    for (int i = 0; i &amp;lt; siz; ++i)
        if ([&amp;amp;](int i, int s) &amp;#123;
            for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
                if (a[i][j] != -1 &amp;amp;&amp;amp; a[i][j] != getv(s, j))
                    return false;
                if (j != 1 &amp;amp;&amp;amp; getv(s, j) == getv(s, j - 1))
                    return false;
            &amp;#125;
            return true;
        &amp;#125; (1, i)) &amp;#123;
            for (int p = 0; p &amp;lt; 3; ++p)
                if ((a[2][1] == -1 || a[2][1] == p) &amp;amp;&amp;amp; getv(i, 1) != p &amp;amp;&amp;amp; ~chg(i, 1, p))
                    (++f[2][1][chg(i, 1, p)]) %= mod;
        &amp;#125;
    for (int i = 2; i &amp;lt;= n; ++i) &amp;#123;
        for (int k = 1; k &amp;lt; m; ++k)
            for (int j = 0; j &amp;lt; siz; ++j)
                if (f[i][k][j]) &amp;#123;
                    // printf(&amp;quot;f[%d][%d][%s] = %lld\n&amp;quot;, i, k, out(s[j]), f[i][k][j]);
                    for (int p = 0; p &amp;lt; 3; ++p)
                        if ((a[i][k + 1] == -1 || a[i][k + 1] == p) &amp;amp;&amp;amp; getv(j, k) != p &amp;amp;&amp;amp; getv(j, k + 1) != p &amp;amp;&amp;amp; ~chg(j, k + 1, p))
                            (f[i][k + 1][chg(j, k + 1, p)] += f[i][k][j]) %= mod;
                &amp;#125;
        for (int j = 0; j &amp;lt; siz; ++j)
            if (i != n &amp;amp;&amp;amp; f[i][m][j])
                for (int p = 0; p &amp;lt; 3; ++p)
                    if ((a[i + 1][1] == -1 || a[i + 1][1] == p) &amp;amp;&amp;amp; getv(j, 1) != p &amp;amp;&amp;amp; ~chg(j, 1, p))
                        (f[i + 1][1][chg(j, 1, p)] += f[i][m][j]) %= mod;
    &amp;#125;
    auto res = 0ll;
    for (int i = 0; i &amp;lt; siz; ++i)
        (res += f[n][m][i]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---pure-straight&#34;&gt;E - Pure Straight&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc126/tasks/arc126_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc126/tasks/arc126_d&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ‰‹ç©å‘ç°åªè¦æœ€ç»ˆåºåˆ—ç¡®å®šï¼Œé‚£ä¹ˆç§»åŠ¨çš„é¡ºåºä¸å½±å“ç­”æ¡ˆã€‚æ•…è€ƒè™‘ç¡®å®šç›®æ ‡ä½ç½®å’Œç§»åŠ¨åºåˆ—ã€‚è€ƒè™‘ç»å¯¹å€¼çš„å‡ ä½•æ„ä¹‰ï¼Œä¸å¦¨ä»¤ç›®æ ‡å­åºåˆ—ä¸­å…ƒç´ é›†ä¸­åˆ°è¢«é€‰ä¸­ä½ç½®çš„ä¸­é—´å…ƒç´ ï¼Œæ­¤æ—¶çš„ä»£ä»·å¯ä»¥è®¡ç®—ã€‚ç”¨ç‚¹äºŒè¿›åˆ¶æŠ€å·§å’Œåº“å‡½æ•°å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; ç®—ä»£ä»·ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    int siz = 1 &amp;lt;&amp;lt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1), f(siz, 0x3f3f3f3f);
    auto out = [&amp;amp;](int j) &amp;#123;
        std::string s;
        for (int i = 0; i &amp;lt; k; ++i)
            s += (&amp;#39;0&amp;#39; + ((j &amp;gt;&amp;gt; i) &amp;amp; 1));
        return s.c_str();
    &amp;#125;;
    f[0] = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i], --a[i];
        for (int j = siz - 1; j &amp;gt;= 0; --j) &amp;#123;
            if (!((j &amp;gt;&amp;gt; a[i]) &amp;amp; 1))
                f[j | (1 &amp;lt;&amp;lt; a[i])] = std::min(f[j | (1 &amp;lt;&amp;lt; a[i])], f[j] + __builtin_popcount(j &amp;amp; (~((1 &amp;lt;&amp;lt; a[i]) - 1))));
            f[j] += std::min(__builtin_popcount(j), k - __builtin_popcount(j));
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[siz - 1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---123-set&#34;&gt;F - 123 Set&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc184/tasks/arc184_b&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc184/tasks/arc184_b&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åšè¿‡ &lt;a href=&#34;https://www.luogu.com.cn/problem/P3226&#34;&gt;é›†åˆé€‰æ•°&lt;/a&gt;ï¼ˆè¿™ä¸ª trick è§è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œåº”è¯¥ä¸åªè¿™ä¸€é“ï¼Œä½†æˆ‘æƒ³ä¸èµ·æ¥äº†ï¼‰å¾ˆå®¹æ˜“æƒ³åˆ°ç”»ä¸€ä¸ªè¡¨æ ¼æˆ–è€… DAG å‡ºæ¥ï¼Œå…¶å®éƒ½èƒ½åš&lt;/p&gt;
&lt;p&gt;å¯¹äºè¡¨æ ¼å·¦ä¸Šè§’å’Œ DAG çš„æºç‚¹ï¼Œè‚¯å®šæ˜¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå…¶ä¸æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; çš„å€æ•°ã€‚å¦‚æœç”»è¡¨ï¼Œæ¨ªä¹˜ 3 ç«–ä¹˜ 2ï¼Œè§‚å¯Ÿä¸€ä¸‹æ˜¯åŒ…å«äº† &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; æ°å¥½ä¸€æ¬¡çš„å¾ˆå¤šä¸ªæ¨è¡¨ï¼ˆæ²¡ä»€ä¹ˆç”¨ï¼Œæä¸€å˜´è€Œå·²ï¼‰ï¼Œè€ƒè™‘è½¬åŒ–ç›®æ ‡ï¼Œå‘ç°æ˜¯ç”¨ä¸€ä¸ªä¸å¯æ—‹è½¬çš„å€’ L å½¢éª¨ç‰Œå¯å æ”¾åœ°é“ºæ»¡å¼‚å½¢è¡¨æ ¼ï¼Œå¯ä»¥è€ƒè™‘è½®å»“çº¿ DP&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œç”¨ 1 æ¥è¡¨ç¤ºæ‹è§’å¤„ï¼Œ0 è¡¨ç¤ºå…¶ä»–ï¼Œå æ”¾çš„æ—¶å€™ 1 çš„ä¼˜å…ˆçº§æ¯” 0 é«˜ï¼Œç„¶åå°±å¯ä»¥åšäº†ã€‚ä»¥ 3 ä¸ºè¡Œï¼Œæ‚²è§‚ä¼°è®¡å•ä¸ªè¡¨æ ¼å¤§æ¦‚æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(31\times 2^{19}\)&lt;/span&gt; ä¸ªçŠ¶æ€ï¼Œè¿ç®—æ¬¡æ•°å·®ä¸å¤š &lt;span class=&#34;math inline&#34;&gt;\(31\times 19\times 2^{19}\)&lt;/span&gt;ï¼›å†å‘ç°é•¿å¾—ä¸€æ¨¡ä¸€æ ·çš„è¡¨æ ¼è‚¯å®šæ–¹æ¡ˆæ•°æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœæŠŠä»»æ„ä¸€ä¸ªè¡¨æ ¼å…¨éƒ¨é™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå°±ä¼šå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n=10^9\div x\)&lt;/span&gt; æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºå·¦ä¸Šè§’çš„æ¨è¡¨ï¼Œå°±æ˜¯è¯´é•¿ç›¸åªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(10^9\div x\)&lt;/span&gt; çš„å€¼æœ‰å…³ï¼Œå¯ä»¥æ•´é™¤åˆ†å— ğŸ˜± å¯é¢„è®¡çš„è·‘å¾—éå¸¸ä¸æ»¡ï¼Œå®è·µä¸‹æ¥æ˜¯å¯ä»¥è¿‡çš„ï¼ˆä½†æ˜¯å¾ˆæ…¢ï¼‰&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    auto calc = [&amp;amp;](int r) &amp;#123;
        return r - r / 2 - r / 3 + r / 6;
    &amp;#125;;
    auto dp = [&amp;amp;](int lim) &amp;#123;
        if (lim == 1) &amp;#123;
            // printf(&amp;quot;lim = 1, ret 1&amp;quot;);
            return 1;
        &amp;#125;
        int n = 1, m = 1;
        for (int k = 1; k * 2 &amp;lt;= lim; ++n, k *= 2);
        for (int k = 1; k * 3 &amp;lt;= lim; ++m, k *= 3);
        int siz = 1 &amp;lt;&amp;lt; m;
        std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; &amp;gt; f(2, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (2, std::vector&amp;lt;int&amp;gt; (siz))), p(n + 1, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (m));
        std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; &amp;gt; t(2, std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; (2, std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; (siz))); // sb
        auto upd = [&amp;amp;](int i, int k, int j, int v) &amp;#123;
            if (t[i &amp;amp; 1][k &amp;amp; 1][j] != std::make_pair(i, k)) &amp;#123;
                p[i][k].push_back(j);
                t[i &amp;amp; 1][k &amp;amp; 1][j] = &amp;#123; i, k &amp;#125;, f[i &amp;amp; 1][k &amp;amp; 1][j] = v;
            &amp;#125;
            else
                f[i &amp;amp; 1][k &amp;amp; 1][j] = std::min(f[i &amp;amp; 1][k &amp;amp; 1][j], v);
            return;
        &amp;#125;;
        auto chg = [&amp;amp;](int i, int j, int v) &amp;#123;
            return i ^ (((i &amp;gt;&amp;gt; j) &amp;amp; 1) &amp;lt;&amp;lt; j) ^ (v &amp;lt;&amp;lt; j);
        &amp;#125;;
        for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
            bool flag = 0;
            for (int j = 0; j &amp;lt; m; ++j)
                if (((i &amp;gt;&amp;gt; j) &amp;amp; 1) || (j &amp;amp;&amp;amp; ((i &amp;gt;&amp;gt; (j - 1)) &amp;amp; 1)));
                else &amp;#123;
                    flag = 1;
                    break;
                &amp;#125;
            if (!flag)
                upd(1, m - 1, i, __builtin_popcount(i));
        &amp;#125;
        for (int i = 2; i &amp;lt;= n; i++) &amp;#123;
            int m1 = 1;
            for (int x = (1 &amp;lt;&amp;lt; (i - 1)); x * 3ll &amp;lt;= lim; ++m1, x *= 3);
            int siz1 = 1 &amp;lt;&amp;lt; m1;
            for (auto j : p[i - 1][m - 1]) &amp;#123;
                if (j &amp;amp; 1)
                    upd(i, 0, chg(j &amp;amp; (siz1 - 1), 0, 0), f[(i - 1) &amp;amp; 1][(m - 1) &amp;amp; 1][j]);
                upd(i, 0, chg(j &amp;amp; (siz1 - 1), 0, 1), f[(i - 1) &amp;amp; 1][(m - 1) &amp;amp; 1][j] + 1);
            &amp;#125;
            m = m1, siz = siz1;
            for (int k = 0; k &amp;lt; m - 1; ++k)
                for (auto j : p[i][k]) &amp;#123;
                    if (((j &amp;gt;&amp;gt; k) &amp;amp; 1) || ((j &amp;gt;&amp;gt; (k + 1)) &amp;amp; 1))
                        upd(i, k + 1, chg(j, k + 1, 0), f[i &amp;amp; 1][k &amp;amp; 1][j]);
                    upd(i, k + 1, chg(j, k + 1, 1), f[i &amp;amp; 1][k &amp;amp; 1][j] + 1);
                &amp;#125;
        &amp;#125;
        int res = 0x3f3f3f3f;
        for (auto i : p[n][m - 1])
            res = std::min(res, f[n &amp;amp; 1][(m - 1) &amp;amp; 1][i]);
        return res;
    &amp;#125;;
    int res = 0;
    for (int l = 1, r; l &amp;lt;= n; l = r + 1) &amp;#123;
        r = n / (n / l);
        if (calc(r) - calc(l - 1))
            res += (calc(r) - calc(l - 1)) * dp(n / l);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="çŠ¶å‹" />
        <updated>2025-08-05T06:33:55.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250803/</id>
        <title>æ ‘ DP</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250803/"/>
        <content type="html">&lt;p&gt;æ ‘ä¸Šçš„ DP ä»¥åŠ å’Œæ ‘æœ‰å…³çš„ DP&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---svjetlo&#34;&gt;A - Svjetlo&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7163&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7163&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œå³ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,0/1/2}\)&lt;/span&gt; åˆ†åˆ«è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/2\)&lt;/span&gt; ä¸ªç«¯ç‚¹åœ¨å­æ ‘å†…éƒ¨çš„æƒ…å†µï¼›ç„¶åå°±å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ»¡è¶³å¯¹äºå¼€å…³çŠ¶æ€çš„è¦æ±‚ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯æƒ³å°‘äº†ã€‚å¦‚æœå†åŠ ä¸€ç»´ï¼Œä»ã€çŠ¶æ€ä¸ºå¼€æˆ–å…³ã€æ€è€ƒå°±ä¼šè½»æ¾å¾ˆå¤šï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,0/1/2,0/1}\)&lt;/span&gt; è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/2\)&lt;/span&gt; ä¸ªç«¯ç‚¹å†å­æ ‘å¤–éƒ¨ï¼Œä¸”å­æ ‘å†…æ“ä½œå®Œå &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ºå…³ / å¼€çš„æœ€å°‘æ­¥æ•°ã€‚ç„¶ååˆ†ç±»è®¨è®ºè½¬ç§»æ–¹å¼å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„è®¨è®ºæ–¹å¼æ˜¯ï¼Œå…ˆç¡®å®šæŸç§æƒ…å†µä¸‹ï¼Œè®¿é—® &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æ¬¡æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°å®ƒä»¬åŸæœ¬çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, rt = -1;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t;
        a[i] = t - &amp;#39;0&amp;#39;;
        if (!a[i])
            rt = i;
    &amp;#125;
    if (rt == -1) &amp;#123;
        std::cout &amp;lt;&amp;lt; 0 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        tag[x] = a[x];
        for (auto i : g[x])
            if (i != fa)
                DFS(i, x), tag[x] &amp;amp;= tag[i];
        return;
    &amp;#125;;
    DFS(rt, -1);
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (3, std::vector&amp;lt;int&amp;gt; (2, 0x3f3f3f3f)));
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        f[x][0][a[x]] = 0;
        for (auto i : g[x])
            if (i != fa &amp;amp;&amp;amp; !tag[i]) &amp;#123;
                DFS(i, x);
                auto g = f[x];
                f[x][0][0] = std::min(g[0][0] + f[i][0][1] + 4, g[0][1] + f[i][0][0] + 2);
                f[x][0][1] = std::min(g[0][1] + f[i][0][1] + 4, g[0][0] + f[i][0][0] + 2);
                f[x][1][0] = std::min(&amp;#123; g[1][0] + f[i][0][1] + 4, g[1][1] + f[i][0][0] + 2, g[0][0] + f[i][1][0] + 3, g[0][1] + f[i][1][1] + 1 &amp;#125;);
                f[x][1][1] = std::min(&amp;#123; g[1][1] + f[i][0][1] + 4, g[1][0] + f[i][0][0] + 2, g[0][1] + f[i][1][0] + 3, g[0][0] + f[i][1][1] + 1 &amp;#125;);
                f[x][2][0] = std::min(&amp;#123; g[2][0] + f[i][0][1] + 4, g[2][1] + f[i][0][0] + 2, g[1][0] + f[i][1][1], g[1][1] + f[i][1][0] + 2, g[0][0] + f[i][2][1] + 4, g[0][1] + f[i][2][0] + 2 &amp;#125;);
                f[x][2][1] = std::min(&amp;#123; g[2][1] + f[i][0][1] + 4, g[2][0] + f[i][0][0] + 2, g[1][1] + f[i][1][1], g[1][0] + f[i][1][0] + 2, g[0][1] + f[i][2][1] + 4, g[0][0] + f[i][2][0] + 2 &amp;#125;);
            &amp;#125;
        f[x][1][0] = std::min(f[x][1][0], f[x][0][1] + 1);
        f[x][1][1] = std::min(f[x][1][1], f[x][0][0] + 1);
        f[x][2][0] = std::min(f[x][2][0], f[x][1][0]);
        f[x][2][1] = std::min(f[x][2][1], f[x][1][1]);
        // for (int i = 0; i &amp;lt; 3; ++i)
        //     for (int j = 0; j &amp;lt; 2; ++j)
        //         printf(&amp;quot;f[%d][%d][%d] = %d\n&amp;quot;, x, i, j, f[x][i][j]);
        return;
    &amp;#125;;
    DFS(rt, -1);
    std::cout &amp;lt;&amp;lt; f[rt][2][1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---one-to-one&#34;&gt;B - One to One&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc140/tasks/arc140_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc140/tasks/arc140_d&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è§‚å¯ŸåŸå›¾ä¸Šè¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯æ²¡æœ‰æœªç¡®å®šè¾¹çš„åŸºç¯æ ‘ï¼Œè¦ä¹ˆæ˜¯æœ‰æ°å¥½ä¸€æ¡æœªç¡®å®šè¾¹çš„æ ‘ã€‚ç¼©ç‚¹ï¼Œä»»æ„ä¸ºæœªç¡®å®šè¾¹èµ‹å€¼ï¼Œè€ƒå¯Ÿæœ€åå¾—åˆ°çš„è¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯ä»¥ã€åŸºç¯æ ‘ç‚¹ã€ä¸ºæ ¹çš„æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸åŒ…å«ã€åŸºç¯æ ‘ç‚¹ã€çš„ï¼ˆå†…å‘ï¼‰åŸºç¯æ ‘ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè¦ç”¨åˆ°è´¡çŒ®çš„æ€æƒ³ã€‚è€ƒè™‘å°†å…¨å±€åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œä¿è¯æ¯éƒ¨åˆ†çš„å•æ­¥ä»·å€¼æ˜¯å¯ç¡®å®šçš„ã€‚å°†ç¬¬ä¸€æ­¥ï¼Œå³å¯¹æ ‘å’ŒåŸºç¯æ ‘çš„è®¨è®ºæ‹†å¼€ï¼Œå¯¹äºæ ‘ï¼Œå…¶æ•°é‡ç¡®å®šï¼›å¯¹äºåŸºç¯æ ‘ï¼Œå‘ç°ç¯çš„æ•°é‡å³ä¸ºåŸºç¯æ ‘çš„æ•°é‡ï¼Œè¿›ä¸€æ­¥å°†æ‰€æœ‰æ­¥ä¸­çš„ã€ç¯ã€è¿™ä¸€ç±»åˆ†å¼€ï¼Œç»Ÿè®¡æˆç¯çš„æ–¹æ¡ˆæ•°å°±å¯ä»¥å¾—åˆ°åŸºç¯æ ‘çš„è´¡çŒ®ã€‚å…·ä½“åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; ä¸ºåœ¨å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‚¹ä¸­é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæˆä¸€ä¸ªç¯çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,j}=f_{i-1,j}+f_{i-1,j-1}\times siz_i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æœ€åè®¡ç®—æ¯ä¸ªç¯çš„è´¡çŒ®å³å¯ã€‚æ³¨æ„è¿˜è¦ç®—ä¸Šç¯å†…éƒ¨çš„æ’åˆ—ï¼ˆæ³¨æ„å¾ªç¯ä½ç§»ï¼‰ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), tag(n + 1), s(n + 1, 1), fa(n + 1), siz(n + 1);
    std::iota(fa.begin() + 1, fa.end(), 1);
    std::function&amp;lt;int(int)&amp;gt; find = [&amp;amp;](int x) &amp;#123;
        return x == fa[x] ? x : fa[x] = find(fa[x]);
    &amp;#125;;
    auto merge = [&amp;amp;](int x, int y) &amp;#123;
        x = find(x), y = find(y);
        if (x != y) &amp;#123;
            tag[y] += tag[x];
            s[y] += s[x];
            fa[x] = y;
        &amp;#125;
        return;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)  &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i], fa[i] = i;
        if (a[i] == -1)
            tag[i] = 1;
        else
            merge(i, a[i]);
    &amp;#125;
    int cnt1 = 0, cnt2 = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        cnt1 += (fa[i] == i &amp;amp;&amp;amp; !tag[i]);
        if (fa[i] == i &amp;amp;&amp;amp; tag[i])
            siz[++cnt2] = s[i];
    &amp;#125;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    auto res(cnt1 * qkp(n, cnt2) % mod);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(cnt2 + 1, std::vector&amp;lt;long long&amp;gt; (cnt2 + 1));
    f[0][0] = 1ll;
    for (int i = 1; i &amp;lt;= cnt2; ++i) &amp;#123;
        // printf(&amp;quot;i = %d, siz = %d: \n&amp;quot;, i, siz[i]);
        for (int j = 0; j &amp;lt;= i; ++j) &amp;#123;
            f[i][j] = f[i - 1][j];
            if (j != 0)
                (f[i][j] += f[i - 1][j - 1] * siz[i]) %= mod;
            // printf(&amp;quot;  f[%d][%d] = %lld\n&amp;quot;, i, j, f[i][j]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= cnt2; ++i) &amp;#123;
        static auto fac(1ll);
        (res += f[cnt2][i] * fac % mod * qkp(n, cnt2 - i) % mod) %= mod;
        (fac *= i) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---diameter-cuts&#34;&gt;C - Diameter Cuts&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1499/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1499/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,i}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸Šçš„æœ€é•¿é“¾é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªç±»ä¼¼èƒŒåŒ…çš„è¿‡ç¨‹æ±‚ç­”æ¡ˆäº†ã€‚å‘ç°è¿™ä¸ªèƒŒåŒ…æ»¡è¶³å¯ä»¥è¢«ä¼˜åŒ–çš„å½¢å¼ï¼Œæ•…èƒ½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(nk)\)&lt;/span&gt; å†…è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k, ++k;
    if (k == 0) &amp;#123;
        std::cout &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; h(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long long&amp;gt; (k + 1));
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        f[x][1] = 1ll, h[x] = 1;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                std::vector&amp;lt;long long&amp;gt; g(k + 1);
                g.swap(f[x]);
                for (int j = std::min(h[x], k); j; --j)
                    for (int l = std::min(h[i], k - j); ~l; --l)
                        (f[x][std::max(j, l + 1)] += g[j] * f[i][l] % mod) %= mod;
                h[x] = std::max(h[x], h[i] + 1);
            &amp;#125;
        for (int i = 1; i &amp;lt;= h[x] &amp;amp;&amp;amp; i &amp;lt;= k; ++i)
            (f[x][0] += f[x][i]) %= mod;
        // for (int i = 0; i &amp;lt;= h[x] &amp;amp;&amp;amp; i &amp;lt;= k; ++i)
        //     printf(&amp;quot;f[%d][%d] = %lld\n&amp;quot;, x, i, f[x][i]);
        return;
    &amp;#125;;
    DFS(1, -1);
    auto res(0ll);
    for (int i = 1; i &amp;lt;= k; ++i)
        (res += f[1][i]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---leaf-partition&#34;&gt;D - Leaf Partition&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1146/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1146/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾å·²ç»å®Œæˆåˆ†ç»„ï¼Œæ¬²åˆ¤å®šè¿™ç§æ–¹å¼æ˜¯å¦åˆæ³•ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ¯ä¸€ç»„å¶å­å»ºç«‹è™šæ ‘ï¼Œåˆ™è¯¥åˆ†ç»„æ–¹å¼åˆæ³•ï¼Œå½“ä¸”ä»…å½“æ²¡æœ‰ä¸€ä¸ªç‚¹è¢«å¤šä¸ªè™šæ ‘å ç”¨ã€‚ä¹Ÿå³ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ€»çš„è™šæ ‘ä¸Šé€‰å‡ºä¸€äº›ç‚¹ï¼Œè®©å®ƒä»¬å¯ä»¥è¦†ç›–æ‰€æœ‰å¶å­ã€‚&lt;/p&gt;
&lt;p&gt;è™šæ ‘ä¸Š DPï¼Œå®¹æ˜“å‘ç°å½“ä¸”ä»…å½“å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\ge 2\)&lt;/span&gt; ä¸ªå„¿å­æƒ³è¦åˆ†è¿›åŒä¸€ä¸ªè™šæ ‘æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¼šè¢«é€‰åˆ°ã€‚æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, 0/1/2}\)&lt;/span&gt; è¡¨ç¤ºå½“å‰æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/\ge 2\)&lt;/span&gt; ä¸ªå„¿å­æƒ³è¦é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶çš„æ–¹æ¡ˆæ•°ï¼ŒDP å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç°æ ¹æœ¬ä¸éœ€è¦æ±‚è™šæ ‘ï¼ŒåŸæ ‘ä¸Š DP å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; fa(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 2; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; fa[i], g[fa[i]].push_back(i);
    std::vector&amp;lt;std::array&amp;lt;long long, 3&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        if (g[x].empty())
            f[x][2] = 1ll;
        else
            f[x][0] = 1ll;
        for (auto i : g[x]) &amp;#123;
            DFS(i);
            auto F0 = (f[i][0] + f[i][2]) % mod, F1 = (f[i][1] + f[i][2]) % mod;
            f[x][2] = (f[x][2] * F0 % mod + f[x][2] * F1 % mod + f[x][1] * F1 % mod) % mod;
            f[x][1] = (f[x][1] * F0 % mod + f[x][0] * F1 % mod) % mod;
            (f[x][0] *= F0) %= mod;
        &amp;#125;
        // printf(&amp;quot;%d: %lld / %lld / %lld\n&amp;quot;, x, f[x][0], f[x][1], f[x][2]);
        return;
    &amp;#125;;
    DFS(1);
    std::cout &amp;lt;&amp;lt; (f[1][0] + f[1][2]) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---uniformly-branched-trees&#34;&gt;E - Uniformly Branched Trees&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/724/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/724/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰æ˜¯å¾ˆå¸¸è§çš„å¥—è·¯ï¼Œä½†æ˜¯æˆ‘ä¸ä¼š ğŸ˜±&lt;/p&gt;
&lt;p&gt;åœ¨æ‰‹ç©æ ·ä¾‹çš„æ—¶å€™å¯ä»¥æ„Ÿæ€§è®¤çŸ¥åˆ°ï¼Œæ¯ä¸ªæ ‘ä¼šè¢«æ¯ç§ç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µç»Ÿè®¡ä¸€æ¬¡ã€‚ä¸”å¦‚æœå›ºå®šä»¥æŸç§ï¼ˆåŒ–å­¦ç¯å¢ƒï¼‰çš„ç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥é€šè¿‡æŒ‰ siz ä»å°åˆ°å¤§æ’åˆ—å”¯ä¸€æ±‚è§£å‡ºè¯¥æ ‘ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°ä»¥é‡å¿ƒä¸ºæ ¹ï¼ˆå³é’¦å®šæ ¹ä¸ºé‡å¿ƒï¼‰å¯ä»¥å¸¦æ¥å¾ˆå¤šä¼˜ç¾çš„æ€§è´¨ã€‚å› ä¸º siz æ˜¯å¥½ç¡®å®šçš„ï¼Œä¸”æ˜¯å„¿å­çš„æ’åºä¾æ®ï¼Œæ‰€ä»¥é€‰é‡å¿ƒä¾¿äºç»Ÿè®¡ï¼ŒåŒæ—¶æ»¡è¶³æ¯ç§æ ‘æœ€å¤šè¢«ç»Ÿè®¡ä¸¤æ¬¡ï¼ˆå½“ä¸”ä»…å½“æœ‰ä¸¤ä¸ªé‡å¿ƒï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™å°±å˜æˆäº†å¤šé‡é›†çš„ç»„åˆæ•°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,k}\)&lt;/span&gt; è¡¨ç¤ºå·²ç»èŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‚¹ç»„æˆä¸€ä¸ªå­æ ‘ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹å½“å‰å·²ç»ç¡®è®¤äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªå„¿å­ï¼Œæœ€é å³çš„ä¸€ä¸ª siz &lt;span class=&#34;math inline&#34;&gt;\(\le k\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,k}=\sum_{x=0} f_{i-x\cdot k,j-x,k-1}\cdot \binom{f_{k,d-1,k}+x-1}{x}\)&lt;/span&gt;ï¼ˆç›¸å½“äºå°† &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªæ— æ ‡å·çš„ä½ç½® / çƒåˆ†é…ç»™ &lt;span class=&#34;math inline&#34;&gt;\(f_{k,d-1,k}\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·çš„é€‰é¡¹ / ç›’å­ï¼Œæ’æ¿å³å¯ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ç›´æ¥è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_{n,d,\lfloor\frac n2\rfloor}\)&lt;/span&gt;ï¼›è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¶æ•°ï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸¤ä¸ªé‡å¿ƒï¼Œå³éœ€è¦ç»Ÿè®¡æ‹¥æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸”ä»¥ä¸¤ä¸ªé‡å¿ƒåˆ†åˆ«ä¸ºæ ¹æ—¶é•¿ç›¸ä¸åŒçš„æ ‘ç§ç±»ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¾ç„¶å­˜åœ¨ä¸€æ¡è¾¹ï¼Œå·¦å³ä¸¤è¾¹ siz ç›¸åŒä¸”é•¿ç›¸ä¸åŒã€‚æ•…æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\binom{f_{\lfloor \frac n2\rfloor, d-1,\lfloor \frac n2\rfloor}}{2}\)&lt;/span&gt;ï¼Œå®¹æ–¥æ‰å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦ç‰¹åˆ¤ &lt;span class=&#34;math inline&#34;&gt;\(n\le2\)&lt;/span&gt; çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, d, mod;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; d &amp;gt;&amp;gt; mod;
    if (n &amp;lt;= 2) &amp;#123;
        std::cout &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    arr inv(d + 1);
    inv[0] = inv[1] = 1ll;
    auto fac = 1ll;
    for (int i = 2; i &amp;lt;= d; ++i) &amp;#123;
        (fac *= i) %= mod;
        inv[i] = qkp(fac, mod - 2);
    &amp;#125;
    auto C = [&amp;amp;](long long n, int m) &amp;#123;
        if (m == 0)
            return 1ll;
        if (m &amp;gt; n)
            return 0ll;
        auto res(1ll);
        for (auto i = 0; i &amp;lt; m; ++i)
            (res *= n - i) %= mod;
        return res * inv[m] % mod;
    &amp;#125;;
    crr f(n + 1, brr(d + 1, arr(n / 2 + 1)));
    f[1][0][0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 0; j &amp;lt;= d &amp;amp;&amp;amp; 1 + j &amp;lt;= i; ++j) &amp;#123;
            for (int x = 0; x &amp;lt;= j &amp;amp;&amp;amp; x &amp;lt;= i; ++x)
                f[i][j][1] += f[i - x][j - x][0];
            f[i][j][1] %= mod;
            for (int k = 2; k &amp;lt;= n / 2; ++k) &amp;#123;
                // bool flag = (i == 10 &amp;amp;&amp;amp; j == 3 &amp;amp;&amp;amp; k == 3);
                for (int x = 0; x &amp;lt;= j &amp;amp;&amp;amp; x * k &amp;lt;= i; ++x) &amp;#123;
                    f[i][j][k] += f[i - x * k][j - x][k - 1] * C(f[k][d - 1][k - 1] + x - 1, x);
                    // if (flag)
                    //     printf(&amp;quot;x = %d, f[%d][%d][%d](%lld) * C(%lld, %d)(%lld)\n&amp;quot;, x, i - x * k, j - x, k - 1, f[i - x * k][j - x][k - 1], f[k][d - 1][k - 1] + x - 1, x, C(f[k][d - 1][k - 1] + x - 1, x));
                &amp;#125;
                f[i][j][k] %= mod;
            &amp;#125;
        &amp;#125;
    // for (int i = 1; i &amp;lt;= n; ++i)
    //     for (int j = 0; j &amp;lt;= d &amp;amp;&amp;amp; j &amp;lt;= i - 1; ++j, puts(&amp;quot;&amp;quot;))
    //         for (int k = 0; k &amp;lt;= n / 2; ++k) &amp;#123;
    //             printf(&amp;quot;f[%d][%d][%d] = %lld\n&amp;quot;, i, j, k, f[i][j][k]);
    //         &amp;#125;
    if (n &amp;amp; 1)
        std::cout &amp;lt;&amp;lt; f[n][d][n / 2] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    else &amp;#123;
        auto res(f[n][d][n / 2]);
        res = (res + mod - C(f[n / 2][d - 1][n / 2 - 1], 2)) % mod;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---dominant-indices&#34;&gt;A - Dominant Indices&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1009/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1009/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é•¿å‰–æ¿å­ï¼›éš¾ç‚¹åœ¨äºå¯èƒ½è¦å¤ä¹ ä¸€ä¸‹é•¿å‰–æ€ä¹ˆå†™ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; h(n + 1), son(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        h[x] = 1;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                h[x] = std::max(h[x], h[i] + 1);
                if (h[i] &amp;gt; h[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::vector&amp;lt;int&amp;gt; _f(2 * n + 1), res(n + 1);
    auto pos(_f.begin());
    std::vector&amp;lt;decltype(pos)&amp;gt; f(n + 1);
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        ++f[x][0];
        if (!son[x]) &amp;#123;
            res[x] = 0;
            return;
        &amp;#125;
        f[son[x]] = std::next(f[x]);
        DFS(son[x], x);
        int mx = -std::max(std::make_pair(f[x][res[son[x]] + 1], -(res[son[x]] + 1)), std::make_pair(1, 0)).second;
        for (auto i : g[x])
            if (i != fa &amp;amp;&amp;amp; i != son[x]) &amp;#123;
                f[i] = pos, pos = std::next(pos, h[i] + 1);
                DFS(i, x);
                for (int j = 0; j &amp;lt;= h[i]; ++j) &amp;#123;
                    f[x][j + 1] += f[i][j];
                    if (j + 1 != mx &amp;amp;&amp;amp; std::make_pair(f[x][j + 1], -(j + 1)) &amp;gt; std::make_pair(f[x][mx], -mx))
                        mx = j + 1;
                &amp;#125;
            &amp;#125;
        // printf(&amp;quot;%d: &amp;quot;, x);
        // for (int i = 0; i &amp;lt;= h[x]; ++i)
        //     printf(&amp;quot;%d &amp;quot;, f[x][i]);
        // puts(&amp;quot;&amp;quot;);
        res[x] = mx;
        return;
    &amp;#125;;
    f[1] = pos, pos = std::next(pos, h[1]);
    DFS(1, -1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---æ ‘ä¸Šå¼‚æˆ–&#34;&gt;B - æ ‘ä¸Šå¼‚æˆ–&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9745&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9745&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’Œ &lt;a href=&#34;#a---svjetlo&#34;&gt;Svjetlo&lt;/a&gt; å¾ˆåƒï¼ŒæŠŠè¿é€šå—çš„å¼‚æˆ–å’Œæ”¾åˆ°çŠ¶æ€é‡Œï¼Œæ‹†ä½åä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,0/1}\)&lt;/span&gt; è¡¨ç¤ºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰€åœ¨çš„è¿é€šå—åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt; çš„æƒå€¼ï¼ˆ&lt;strong&gt;ä¸è®¡ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰€åœ¨è¿é€šå—&lt;/strong&gt;ï¼‰ï¼Œè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 2, x; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x;
        g[x].push_back(i), g[i].push_back(x);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; dp(n + 1);
    std::vector&amp;lt;std::array&amp;lt;std::array&amp;lt;long long, 2&amp;gt;, 60&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        for (int i = 0; i &amp;lt; 60; ++i)
            f[x][i][(a[x] &amp;gt;&amp;gt; i) &amp;amp; 1] = 1ll;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                for (int j = 0; j &amp;lt; 60; ++j) &amp;#123;
                    auto f1 = f[x][j];
                    f[x][j][0] = (f1[0] * dp[i] % mod + f1[0] * f[i][j][0] % mod + f1[1] * f[i][j][1] % mod) % mod;
                    f[x][j][1] = (f1[1] * dp[i] % mod + f1[0] * f[i][j][1] % mod + f1[1] * f[i][j][0] % mod) % mod;
                &amp;#125;
            &amp;#125;
        for (int i = 0; i &amp;lt; 60; ++i)
            dp[x] += (1ll &amp;lt;&amp;lt; i) % mod * f[x][i][1] % mod;
        dp[x] %= mod;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; dp[1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---ä¸€ä¸ªç½‘çš„è·¯&#34;&gt;C - ä¸€ä¸ªç½‘çš„è·¯&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P8595&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P8595&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦æ„è¯†åˆ°ï¼Œæ ‘å’Œé“¾çš„è¾¹æ•°æ˜¯ä¸€æ ·çš„ï¼Œç‚¸æ‰äº†å¤šå°‘æ¡è¾¹ï¼Œåœ¨ä¹‹åå°±ä¼šèŠ±å¤šå°‘ä»£ä»·è¡¥å›æ¥ã€‚æ•…ç‚¸ä¸€ä¸ªç‚¹çš„ä»£ä»·ä¸ºåº¦æ•° +1ã€‚å¯¹äºä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œåˆ†ä¸ºå››ç§å¯èƒ½æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¢«ç‚¸äº†ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿é€šå—ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œå„¿å­å…¨éƒ¨è¢«ç‚¸äº†ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œæœ‰ 1 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œæœ‰ 2 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆ†åˆ«ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,0/1/2/3}\)&lt;/span&gt; ä»£è¡¨ä¸Šé¢å››ç§å¯èƒ½æ€§ï¼Œè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è´ºäº†ä¸ª freadï¼Œæ“¦è¾¹è·‘è¿‡äº†ã€‚è¿™ä¸ªä¸æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„å—ï¼Ÿ&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#ifdef ONLINE_JUDGE
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
#else
#define nec getchar

#endif
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
int main() &amp;#123;
    int n, m;
    read(n), read(m);
    int res = (n - 1) - m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int x, y; m--; ) &amp;#123;
        read(x), read(y);
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1);
    std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        tag[x] = 1;
        f[x][0] = (fa != -1) + 1;
        f[x][2] = f[x][3] = 0x3f3f3f3f;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                f[x][3] = std::min(f[x][3] + f[i][0], f[x][2] + std::min(f[i][1], f[i][2]));
                f[x][2] = std::min(f[x][2] + f[i][0], f[x][1] + std::min(f[i][1], f[i][2]));
                f[x][1] += f[i][0];
                f[x][0] += std::min(&amp;#123; f[i][0] - 1, f[i][1], f[i][2], f[i][3] &amp;#125;) + 1;
            &amp;#125;
        return;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        if (!tag[i]) &amp;#123;
            DFS(i, -1);
            res += *std::min_element(f[i].begin(), f[i].end());
        &amp;#125;
    print(res, &amp;#39;\n&amp;#39;);
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---éšæœºæ ‘&#34;&gt;D - éšæœºæ ‘&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3830&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3830&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºç¬¬ä¸€é—®ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_x\)&lt;/span&gt; è¡¨ç¤ºå…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªå¶å­æ—¶çš„æœŸæœ›æ·±åº¦ï¼Œä¸¤ä¸ªæ–°å¶å­çš„æœŸæœ›æ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{x-1}+1\)&lt;/span&gt;ï¼Œdelta ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{x-1}+2\)&lt;/span&gt;ï¼Œæ•…æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_x=\dfrac {(x-1)f_{x-1}+f_{x-1}+2}x\)&lt;/span&gt;ï¼Œé€’æ¨å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºç¬¬äºŒé—®ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,k}\)&lt;/span&gt; è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªå¶å­ï¼Œæ·±åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt; çš„æ¦‚ç‡ï¼ˆä¸€ç§ç†è§£æ˜¯ä»æ•´æ•°æ¦‚ç‡å…¬å¼çš„è§’åº¦å‡ºå‘ï¼‰ã€‚åˆ™è€ƒè™‘æšä¸¾å·¦ã€å³å¶å­æ•°ï¼Œå¯¹äºå·¦ä¾§å¶å­æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æƒ…å†µï¼Œ&lt;strong&gt;ä¸ºäº†å»é‡ï¼Œåªé€‰æ‹©æ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„å¶å­å±•å¼€&lt;/strong&gt;ã€‚åªè€ƒè™‘æŸç§ç»„åˆçš„å‡ºç°æ¦‚ç‡ï¼Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{i,k-1}+f_{x-i,k-1}-f_{i,k-1}\cdot f_{x-i,k-1}\)&lt;/span&gt;ã€‚æ•°å½’å¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„å¶å­è¢«é€‰ä¸­çš„æ¦‚ç‡å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac 1{x-1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int q, n;
    std::cin &amp;gt;&amp;gt; q &amp;gt;&amp;gt; n;
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6);
    if (q == 1) &amp;#123;
        std::vector&amp;lt;double&amp;gt; f(n + 1);
        for (int i = 2; i &amp;lt;= n; ++i)
            f[i] = (f[i - 1] * (i - 1) + f[i - 1] + 2.) / i;
        std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    else &amp;#123;
        std::vector&amp;lt;std::vector&amp;lt;double&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;double&amp;gt; (n + 1));
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            f[i][0] = 1.;
            for (int j = 1; j &amp;lt; i; ++j) &amp;#123;
                auto s(0.);
                for (int k = 1; k &amp;lt; i; ++k)
                    s += f[k][j - 1] + f[i - k][j - 1] - f[k][j - 1] * f[i - k][j - 1];
                f[i][j] = s / (i - 1);
            &amp;#125;
        &amp;#125;
        auto res(0.);
        for (int i = 1; i &amp;lt; n; ++i)
            res += f[n][i];
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---complete-compress&#34;&gt;E - Complete Compress&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/agc034/tasks/agc034_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/agc034/tasks/agc034_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºé“¾ï¼Œå‘ç°å¯ä»¥æšä¸¾æœ€åèšé›†çš„ç‚¹ï¼Œç­”æ¡ˆä¸é…å¯¹æ–¹å¼æ— å…³ï¼Œcheck æ˜¯å¦èƒ½é…å¯¹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸æ˜¯é“¾ï¼Œåˆ™ç›¸æ¯”é“¾ï¼Œè¿˜å¯ä»¥é€‰æ‹©åŒä¸€å­æ ‘ä¸­ä¸å­˜åœ¨ç¥–å­™å…³ç³»çš„ä¸¤ä¸ªç‚¹ï¼Œå°†å®ƒä»¬éƒ½å‘ LCA ç§»ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;æ•…è€Œï¼Œå¯ä»¥åœ¨é“¾çš„åšæ³•ä¸Šæ‰“ä¸€ä¸ªè¡¥ä¸ï¼Œè§‚å¯Ÿåˆ°å…ˆã€å†…éƒ¨æ¶ˆåŒ–ã€ï¼Œå†åœ¨å­æ ‘é—´é…å¯¹ä¸€å®šä¸åŠ£ï¼Œä¸”ç­”æ¡ˆä»ç„¶å’Œé…å¯¹æ–¹å¼æ— å…³ã€‚æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_x\)&lt;/span&gt; è¡¨ç¤ºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å†…æœ€å¤šæ¶ˆæ‰å¤šå°‘å¯¹ï¼Œå°±å¯ä»¥ check äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;line_02.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t;
        a[i] = t - &amp;#39;0&amp;#39;;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    auto res(inf);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; s(n + 1);
        std::vector&amp;lt;long long&amp;gt; f(n + 1), cnt(n + 1);
        std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
            s[x] = a[x];
            int son = 0;
            auto sum(0ll);
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    DFS(i, x), s[x] += s[i];
                    sum += cnt[i];
                    if (cnt[i] &amp;gt; cnt[son])
                        son = i;
                &amp;#125;
            if (son) &amp;#123;
                if (cnt[son] * 2 &amp;lt;= sum)
                    f[x] = sum / 2;
                else
                    f[x] = sum - cnt[son] + std::min(f[son], (cnt[son] - (sum - cnt[son])) / 2);
            &amp;#125;
            cnt[x] = sum;
            if (x != i)
                cnt[x] += s[x];
            return;
        &amp;#125;;
        DFS(i, -1);
        if (cnt[i] % 2 == 0 &amp;amp;&amp;amp; f[i] == cnt[i] / 2)
            res = std::min(res, cnt[i] / 2);
    &amp;#125;
    if (res == inf)
        std::cout &amp;lt;&amp;lt; -1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    else
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="æ ‘å½¢ DP" />
        <category term="é•¿é“¾å‰–åˆ†" />
        <updated>2025-08-03T03:44:54.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250715/</id>
        <title>ç»ƒä¹  å†³ç­–å•è°ƒæ€§</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250715/"/>
        <content type="html">&lt;p&gt;ã€å¿ƒé™è‡ªç„¶å‡‰ã€å¤§æŠµæ˜¯å› ä¸ºæƒ…ç»ªå¹³å’Œæ—¶å‰¯äº¤æ„Ÿç¥ç»å…´å¥‹ï¼Œä½“æ¸©ç•¥æœ‰é™ä½å¯¼è‡´çš„ã€‚å—ï¼Ÿ&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;å…¶å®æ˜¯å› ä¸ºå¿ƒè„åœè·³åè¡€æ¶²å¾ªç¯ç»ˆæ­¢ã€ä»£è°¢ä¸­æ–­ï¼Œå¯¼è‡´äº§çƒ­ä½äºæ•£çƒ­ï¼ˆï¼Ÿï¼‰&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---å¾é€”&#34;&gt;A - å¾é€”&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4072&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4072&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç”¨å®Œå…¨å¹³æ–¹å…¬å¼å±•å¼€å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(m^2\sigma^2=m\left(\sum {x_i}^2\right)-S^2\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸ºæ±‚å’Œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç›®æ ‡æ˜¯æœ€å°åŒ– &lt;span class=&#34;math inline&#34;&gt;\(\sum {x_i}^2\)&lt;/span&gt; è¿™ä¸ªä¸œè¥¿ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤©èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œå¾—åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{i,j}&amp;amp;=\min\{f_{i-1,k}+(s_j-s_k)^2\}\\
&amp;amp;=\min\{f_{i-1,k}-2\times s_j\times s_k+{s_k}^2\}+{s_j}^2
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æœ€åå¾—åˆ°çš„æ–œç‡å¼å­æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {f_{i - 1, a}-f_{i - 1, b}+{s_a}^2-{s_b}^2}{2(s_a-s_b)}&amp;lt;s_j\)&lt;/span&gt;ï¼Œç”±äº &lt;span class=&#34;math inline&#34;&gt;\(s_j\)&lt;/span&gt; å•å¢ï¼Œ&lt;del&gt;å•è°ƒé˜Ÿåˆ—ç»´æŠ¤é€’å‡æ–œç‡å³å¯&lt;/del&gt; &lt;strong&gt;æ›´æ­£ï¼šæ˜¯é€’å¢æ–œç‡ã€‚åŸå› æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;\)&lt;/span&gt; æ˜¯å¼¹å‡ºæ¡ä»¶ï¼Œè€Œéä¿ç•™æ¡ä»¶â€¦â€¦&lt;/strong&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e9;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    std::vector&amp;lt;long long&amp;gt; s(n + 1);
    auto sum(0ll);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        s[i] = s[i - 1] + a[i];
        sum += a[i];
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(m + 1, std::vector&amp;lt;long long&amp;gt; (n + 1, inf));
    f[0][0] = 0ll;
    for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
        auto f1 = [&amp;amp;](int a, int b) &amp;#123;
            return f[i - 1][a] - f[i - 1][b] + s[a] * s[a] - s[b] * s[b];
        &amp;#125;;
        auto f2 = [&amp;amp;](int a, int b) &amp;#123;
            return 2 * (s[a] - s[b]);
        &amp;#125;;
        std::vector&amp;lt;int&amp;gt; q(n + 1);
        int h = 0, t = -1;
        q[++t] = i - 1;
        for (int j = i; j &amp;lt;= n; ++j) &amp;#123;
            for (; h &amp;lt; t &amp;amp;&amp;amp; f1(q[h + 1], q[h]) &amp;lt; s[j] * f2(q[h + 1], q[h]); ++h);
            f[i][j] = f[i - 1][q[h]] + (s[j] - s[q[h]]) * (s[j] - s[q[h]]);
            for (; h &amp;lt; t &amp;amp;&amp;amp; f1(j, q[t]) * f2(q[t], q[t - 1]) &amp;lt; f1(q[t], q[t - 1]) * f2(j, q[t]); --t);
            q[++t] = j;
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; m * f[m][n] - sum * sum &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---åˆ·é‡-iii&#34;&gt;B - åˆ·é‡ III&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P10074&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P10074&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°æœ€åæƒ…å†µå°±æ˜¯æ¯æ¬¡ã€è¯•æ¢ã€éƒ½ä¸ä¸­çš„æƒ…å†µï¼Œå†è¯•æ¢ä¸­æœ€åçš„é‚£ä¸€ä¸ªã€‚ä¸ºå•¥å‘¢ï¼Œç›¸å½“äºæˆ‘ä»¬æ¯æ¬¡æ”»å‡»çš„ä¸€å®šæ˜¯æœªçŸ¥å…ƒç´ ä¸­è¡€æœ€å¤šçš„ä¸€ä¸ªã€‚æ—¢ç„¶å·²ç»è¯•æ¢å‡ºäº†æ¯”é˜ˆå€¼å¤§çš„æ‰€æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆä¸‹ä¸€ä¸ªæ”»å‡»çš„å°±ä¸€å®šæ˜¯é˜ˆå€¼æœ¬èº«ï¼Œå¦‚æœè¿™æ¬¡è·³è¿‡å®ƒï¼Œå®ƒå°±ä¼šæˆä¸ºä¸‹ä¸€æ¬¡è¯•æ¢å¤±è´¥çš„å…ƒç´ ã€‚è¿™æ˜¾ç„¶ä¸å¦‚ä¸€å¼€å§‹å°±ç›´æ¥ç”¨æ–°é˜ˆå€¼è¯•æ¢ã€‚&lt;/p&gt;
&lt;p&gt;ä»å¤§åˆ°å°æ’åºã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{j, i}\)&lt;/span&gt; è¡¨ç¤ºåªç¡®å®šäº†å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤§çš„æ•°ï¼Œå·²ç»æ€äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªäººçš„æœ€åæƒ…å†µæœ€å°ä»£ä»·ã€‚é‚£ä¹ˆæ˜¾ç„¶è¿™ä¸€æ¬¡çš„é˜ˆå€¼æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ã€‚éšä¾¿é€‰å‡ºä¸Šä¸€æ¬¡çš„é˜ˆå€¼ &lt;span class=&#34;math inline&#34;&gt;\(a_k\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¸­é—´è¿™ä¸€æ®µå¾…ç¡®å®šçš„å…ƒç´ æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i-k\)&lt;/span&gt;ã€‚é‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{j, i}&amp;amp;=\min\limits_{k&amp;lt;i}\{f_{j-1,k}+(i-k)\times a_i\}\\
&amp;amp;=\min\limits_{k&amp;lt;i}\{f_{j-1,k}-k\times a_i\}+i\times a_i
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç»è¿‡éªŒè¯ï¼Œè™½ç„¶è¿™ä¸ªå¼å­å’Œé¢˜è§£é•¿å¾—ä¸ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¯¹çš„ &lt;del&gt;å› ä¸ºæˆ‘ n^3 æš´åŠ› A äº†&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;æ¨å‡ºæ–œä¼˜å½¢å¼ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {f_{j-1,A}-f_{j-1,B}}{A-B}&amp;lt;a_i\)&lt;/span&gt;ï¼Œä½†æˆ‘çš„æœ‹å‹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æ˜¯é€’å‡çš„ã€‚æ‰€ä»¥ç”¨å•è°ƒæ ˆç»´æŠ¤é€’å¢æ–œç‡å³å¯ã€‚&lt;del&gt;æˆ–è€…ä½ ä¹Ÿå¯ä»¥å­¦ä¹  grisses æ‰“ä¸€ä¸ªå•è°ƒé˜Ÿåˆ—ä¸ŠäºŒåˆ†&lt;/del&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e12;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;P10074_4.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::sort(a.begin() + 1, a.end(), std::greater&amp;lt;long long&amp;gt; ());
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(m + 1, std::vector&amp;lt;long long&amp;gt; (n + 1, inf));
    f[0][0] = 0ll;
    for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
        std::vector&amp;lt;int&amp;gt; q(n + 1);
        int t = -1;
        q[++t] = j - 1;
        auto f1 = [&amp;amp;](int A, int B) &amp;#123;
            return f[j - 1][A] - f[j - 1][B];
        &amp;#125;;
        auto f2 =[&amp;amp;](int A, int B) &amp;#123;
            return A - B;
        &amp;#125;;
        for (int i = j; i &amp;lt;= n; ++i) &amp;#123;
            for (; t &amp;gt;= 1 &amp;amp;&amp;amp; f1(q[t], q[t - 1]) &amp;gt; a[i] * f2(q[t], q[t - 1]); --t);
            f[j][i] = f[j - 1][q[t]] + (i - q[t]) * a[i];
            for (; t &amp;gt;= 1 &amp;amp;&amp;amp; f1(i, q[t]) * f2(q[t], q[t - 1]) &amp;lt; f1(q[t], q[t - 1]) * f2(i, q[t]); --t);
            q[++t] = i;
        &amp;#125;
    &amp;#125;
    auto res(inf);
    for (int i = m; i &amp;lt;= n; ++i)
        res = std::min(res, f[m][i]);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---traka&#34;&gt;C - TRAKA&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7747&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7747&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç¨å¾®æ‰‹ç©ä¸€ä¸‹å°±å¯ä»¥å‘ç°ï¼Œå‡å¦‚ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªäººåœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¬¡çš„å·¥ä½œæ—¶é—´ä¸º &lt;span class=&#34;math inline&#34;&gt;\([L_{j,i},R_{j,i}]\)&lt;/span&gt;ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; æ¬¡ä¸º &lt;span class=&#34;math inline&#34;&gt;\([L_{j,i-1},R_{j,i-1}]\)&lt;/span&gt;ï¼Œé‚£ä¹ˆè¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(L_{j,i}\ge R_{j,i-1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(s_j\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„å‰ç¼€å’Œã€‚å‡è®¾ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; æ¬¡åŠ å·¥äº &lt;span class=&#34;math inline&#34;&gt;\(x_{i-1}\)&lt;/span&gt; å¼€å§‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æŠŠä¸Šå¼è½¬å†™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x_{i}+s_{j-1}\times f_{i}\ge x_{i-1}+s_j\times f_{i-1}\)&lt;/span&gt;ã€‚ä¹Ÿå³ &lt;span class=&#34;math inline&#34;&gt;\(x_i-x_{i-1}\ge s_j\times f_{i-1}-s_{j-1}\times f_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶éœ€è¦æ‰¾åˆ°ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½¿å¾— RSH å–å¾—æœ€å¤§å€¼ï¼›ç°åœ¨å°±å¯ä»¥è€ƒè™‘æ–œç‡ä¼˜åŒ–äº†ã€‚ç”±äºæ‰€æœ‰é¡¹éƒ½å’Œ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœ‰å…³ï¼Œæƒ³åˆ°ä¸¤è¾¹åŒé™¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i}\)&lt;/span&gt; æ¶ˆæ‰ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœ‰å…³çš„ç³»æ•°ï¼Œæœ€ååŒ–å‡ºæ¥çš„æ–œä¼˜å½¢å¼æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {s_A-s_B}{s_{A-1}-s_{B-1}}&amp;gt;\dfrac {f_{i-1}}{f_i}\)&lt;/span&gt;ã€‚ç”±äº RSH ä¸å•è°ƒï¼ŒæŠŠæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¡åˆ°é˜Ÿåˆ—é‡Œç»´æŠ¤é€’å‡æ–œç‡ï¼Œæ‰“äºŒåˆ†å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; a(n + 1), w(m + 1), s(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], s[i] = s[i - 1] + a[i];
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cin &amp;gt;&amp;gt; w[i];
    std::vector&amp;lt;long long&amp;gt; f(m + 1);
    std::vector&amp;lt;int&amp;gt; q(n + 1);
    int h = 0, t = -1;
    q[++t] = 1;
    for (int i = 2; i &amp;lt;= n; ++i) &amp;#123;
        for (; h &amp;lt; t &amp;amp;&amp;amp; (s[i] - s[q[t]]) * (s[q[t] - 1] - s[q[t - 1] - 1]) &amp;gt; (s[q[t]] - s[q[t - 1]]) * (s[i - 1] - s[q[t] - 1]); --t);
        q[++t] = i;
    &amp;#125;
    for (int i = 2; i &amp;lt;= m; ++i) &amp;#123;
        int to = q[h];
        for (int l = h + 1, r = t, mid; l &amp;lt;= r; ) &amp;#123;
            mid = (l + r) &amp;gt;&amp;gt; 1;
            if ((s[q[mid]] - s[q[mid - 1]]) * w[i - 1] &amp;gt; w[i] * (s[q[mid] - 1] - s[q[mid - 1] - 1]))
                to = q[mid], l = mid + 1;
            else
                r = mid - 1;
        &amp;#125;
        f[i] = f[i - 1] + s[to] * w[i - 1] - s[to - 1] * w[i];
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[m] + w[m] * s[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---æŸ æª¬&#34;&gt;D - æŸ æª¬&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5504&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5504&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è§‚å¯Ÿé›¶ï¼šåŸé—®é¢˜ã€ä»ä¸¤ç«¯å–ã€å¯ä»¥è½¬åŒ–ä¸ºåˆ†æ®µé—®é¢˜ï¼Œæ•…ä»å…¶ä¸­ä¸€ç«¯è€ƒè™‘å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;è§‚å¯Ÿä¸€ï¼šè‹¥æœ‰ä¸€æ®µè¿ç»­çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå®Œæ•´çš„æ¯”æ‹†å¼€çš„æ›´ä¼˜ã€‚&lt;/li&gt;
&lt;li&gt;è§‚å¯ŸäºŒï¼šå¦‚æœä¸€æ®µ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸­å¤¹æ‚äº†ä¸€äº›å…¶ä»–å…ƒç´ ï¼Œé‚£ä¹ˆåœ¨å“ªé‡Œåˆ†æ®µæ˜¯è¯´ä¸å‡†çš„ã€‚&lt;/li&gt;
&lt;li&gt;è§‚å¯Ÿä¸‰ï¼šå¦‚æœé€‰å–çš„åŒºé—´æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\([1,r]\)&lt;/span&gt;ï¼Œé‚£ä¹ˆè´ªå¿ƒåœ°æƒ³ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_r\)&lt;/span&gt; ä¸€å®šæ˜¯å…³é”®å€¼ï¼Œä¸ç„¶å– &lt;span class=&#34;math inline&#34;&gt;\(a_r\)&lt;/span&gt; å°±æµªè´¹äº†ã€‚&lt;/li&gt;
&lt;li&gt;è§‚å¯Ÿå››ï¼šå¦‚æœé€‰å–çš„åŒºé—´æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œé‚£ä¹ˆç”±è§‚å¯Ÿå››ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_l=a_r\)&lt;/span&gt;ï¼Œä¸”è¯¥å€¼ä¸ºå…³é”®å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»“åˆè¿™å‡ ä¸ªè§‚å¯Ÿï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(c_i\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([1,i]\)&lt;/span&gt; ä¸­å‡ºç°æ¬¡æ•°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤ºè¿™ä¸€æ®µä»¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾çš„æœ€å¤§ä»·å€¼ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_i&amp;amp;=\max\limits_{j&amp;lt;i,a_{j+1}=a_i}\{f_j+a_i\times (c_i-c_{j + 1} + 1)^2\}\\
&amp;amp;=\max\limits_{j&amp;lt;i,a_{j+1}=a_i}\{f_j+a_{j+1}\times {c_{j+1}}^2-2\times c_i\times a_{j+1}\times c_{j+1}-2\times c_{j+1}\times a_{j+1}\}+a_i\times(c_i-1)^2
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆæ€ä¹ˆè¿™ä¹ˆå¤§ä¸€å †ã€‚ï¼‰æœ€åå¯ä»¥åŒ–å‡º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {f_A-f_B+a_{A+1}\cdot c_{A+1}\cdot (c_{A+1}-2)-a_{B+1}\cdot c_{B+1}\cdot (c_{B+1}-2)}{2(c_{A+1} - c_{B+1})}&amp;gt;c_i\times a_i\)&lt;/span&gt;ã€‚å‘ç°å¯¹äºæ¯ä¸€ç§ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(c_i\times a_i\)&lt;/span&gt; æ˜¯å•å¢çš„ã€‚å•è°ƒæ ˆç»´æŠ¤å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;è¿™å…¶å®æé†’æˆ‘ä»¬å…³äºä»£æ¢çš„é—®é¢˜â€”â€”æ˜¾ç„¶ï¼Œå½“ä¸ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„é¡¹ã€ä¸ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æœ‰å…³çš„é¡¹ä¹‹é—´å­˜åœ¨ä»£æ¢å…³ç³»æ—¶ï¼Œåº”è¯¥å°½é‡å¾€ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹å‘é ã€‚&lt;/em&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;7.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; a(n + 1), c(n + 1), la(10001);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        c[i] = c[la[a[i]]] + 1, la[a[i]] = i;
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; f(n + 1);
    std::vector&amp;lt;int&amp;gt; _t(10001, -1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; _q(10001);
    auto f1 = [&amp;amp;](int A, int B) &amp;#123;
        return f[A] - f[B] + a[A + 1] * c[A + 1] * (c[A + 1] - 2) - a[B + 1] * c[B + 1] * (c[B + 1] - 2);
    &amp;#125;;
    auto f2 = [&amp;amp;](int A, int B) &amp;#123;
        return 2 * (c[A + 1] - c[B + 1]);
    &amp;#125;;
    ++_t[a[1]], _q[a[1]].push_back(0);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        &amp;#123;
            auto &amp;amp;t = _t[a[i]];
            auto &amp;amp;q = _q[a[i]];
            for (; t &amp;gt;= 1 &amp;amp;&amp;amp; f1(q[t], q[t - 1]) &amp;lt; c[i] * a[i] * f2(q[t], q[t - 1]); --t);
            f[i] = f[q[t]] + a[i] * (c[i] - c[q[t] + 1] + 1) * (c[i] - c[q[t] + 1] + 1);
        &amp;#125;
        if (i &amp;lt; n) &amp;#123;
            auto &amp;amp;t = _t[a[i + 1]];
            auto &amp;amp;q = _q[a[i + 1]];
            for (; t &amp;gt;= 1 &amp;amp;&amp;amp; f1(i, q[t]) * f2(q[t], q[t - 1]) &amp;gt; f1(q[t], q[t - 1]) * f2(i, q[t]); --t);
            q.resize(++t + 1), q[t] = i;
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---knapsack-with-diminishing-values&#34;&gt;E - Knapsack with Diminishing Values&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc373/tasks/abc373_f&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc373/tasks/abc373_f&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°å’Œ &lt;a href=&#34;/20250707-1/#ä¾‹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…&#34;&gt;å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…&lt;/a&gt; æœ‰å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; è¡¨ç¤ºä½“ç§¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(w_i\)&lt;/span&gt; è¡¨ç¤ºä»·å€¼ã€‚å¯¹äºæ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼ŒæŠŠæ‰€æœ‰ä½“ç§¯æŒ‰æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; çš„ä½™æ•°åˆ†ç±»ï¼Œè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\cdot v_i+x\)&lt;/span&gt;ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k\cdot v_i+x\)&lt;/span&gt;ï¼Œæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{i,j\cdot v_i+x}&amp;amp;=\max\limits_{k&amp;lt;j}\{f_{i-1,k\cdot v_i+x}+(j-k)\cdot w_i-(j-k)^2\}\\
&amp;amp;=\max\limits_{k&amp;lt;j}\{f_{i-1,k\cdot v_i+x}-k\cdot w_i-k^2+2\times j\times k\}-j^2+j\cdot w_i
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;åˆ™å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {f_{i-1,A\cdot v_i+x}-f_{i-1,B\cdot v_i+x}+(B-A)\cdot w_i - A^2+B^2}{2(B-A)}&amp;lt;j\)&lt;/span&gt;ã€‚æ³¨æ„åˆ†æ¯ä¸ºè´Ÿã€‚æ€»ä¹‹å•è°ƒé˜Ÿåˆ—ç»´æŠ¤é€’å¢æ–œç‡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; v(n + 1), w(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long long&amp;gt; (m + 1));
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; v[i] &amp;gt;&amp;gt; w[i];
        for (int x = 0; x &amp;lt; v[i]; ++x) &amp;#123;
            int h = 0, t = -1;
            std::vector&amp;lt;int&amp;gt; q;
            auto f1 = [&amp;amp;](int A, int B) &amp;#123;
                return f[i - 1][A * v[i] + x] - f[i - 1][B * v[i] + x] + (B - A) * w[i] - A * A + B * B;
            &amp;#125;;
            auto f2 = [&amp;amp;](int A, int B) &amp;#123;
                return 2 * (B - A);
            &amp;#125;;
            for (int j = 0, J = x; J &amp;lt;= m; ++j, J += v[i]) &amp;#123;
                for (; h &amp;lt; t &amp;amp;&amp;amp; f1(q[h + 1], q[h]) &amp;gt; j * f2(q[h + 1], q[h]); ++h);
                f[i][J] = f[i - 1][J];
                if (h &amp;lt;= t)
                    f[i][J] = std::max(f[i][J], f[i - 1][q[h] * v[i] + x] + (j - q[h]) * w[i] - (j - q[h]) * (j - q[h]));
                for (; h &amp;lt; t &amp;amp;&amp;amp; f1(j, q[t]) * f2(q[t], q[t - 1]) &amp;lt; f1(q[t], q[t - 1]) * f2(j, q[t]); --t);
                q.resize(++t + 1), q[t] = j;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n][m] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---managing-telephone-poles&#34;&gt;F - Managing Telephone Poles&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1575/M&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1575/M&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ï¼Ÿè§‚å¯Ÿåˆ°æ€§è´¨ç„¶åè¢«è‡ªå·±å¿½ç•¥äº†ã€‚éå¸¸å€¼å¾—æ‰¹è¯„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å†™å‡ºç±»ä¼¼æ–œç‡ä¼˜åŒ–çš„å¼å­ &lt;span class=&#34;math inline&#34;&gt;\(S(i,j)=\min\{ {x_k}^2-2\times i\times x_k+{y_k}^2-2\times j \times y_k\}+i^2+j^2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¼šä¸‹æ„è¯†å°è¯•å›ºå®š &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå°±å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2m)\)&lt;/span&gt; å®Œæˆä»»åŠ¡ï¼Œä¼¼ä¹ä¸å¤ªè¡Œã€‚é¡ºç€è¿™ä¸ªæƒ³æ³•ä¼šè§‚å¯Ÿåˆ°ï¼Œå›ºå®š &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¹‹åï¼Œæ¯ä¸€åˆ—çš„ poles ä¸­åªæœ‰å’Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¡Œæœ€è¿‘çš„æ‰ä¼šæœ‰è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯å¥½åšçš„ï¼Œä¸”è¿™æ ·çš„ç›¸é‚»ç‚¹æ•°é‡æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(m)\)&lt;/span&gt; çš„ï¼›äºæ˜¯å°† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è§†ä¸ºå¸¸æ•°è¿›è¡Œå˜å½¢ï¼Œè‹¥å°†æ‰€æœ‰ poles æŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(y\)&lt;/span&gt; ä»å°åˆ°å¤§æ’åºå°±èƒ½å¾—åˆ°æ–œç‡å½¢å¼ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac { {x_A}^2-{x_B}^2+{y_A}^2-{y_B}^2-2\times i\times(x_A-x_B)}{2(y_A-y_B)}&amp;lt;j\)&lt;/span&gt;ã€‚ç»´æŠ¤é€’å¢æ–œç‡å°±èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; å®Œæˆé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ‰¾ç›¸é‚»ç‚¹è¿™ä¸€æ­¥å¤§å¯ä»¥æ‘†çƒ‚å†™äºŒåˆ†ã€‚æ‰€ä»¥æ€»å…±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(nm\log m)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸è¦åƒæˆ‘ä¸€æ ·æŠŠä¸¤è¾¹æœ€è¿‘çš„éƒ½åŠ è¿›é˜Ÿåˆ—ï¼Œä¸ç„¶ä½ ä¼šæœ‰åˆ†æ¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„æ–œç‡ &lt;img src=&#34;/em/hsh.gif&#34; /&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m, ++n, ++m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; tag(n + 1, std::vector&amp;lt;int&amp;gt; (m + 1));
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(m + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
            char t;
            std::cin &amp;gt;&amp;gt; t;
            if (t == &amp;#39;1&amp;#39;)
                g[j].push_back(i), tag[i][j] = 1;
        &amp;#125;
    struct node &amp;#123; long long x, y; &amp;#125;;
    auto res(0ll);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::vector&amp;lt;node&amp;gt; p;
        for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
            int to = std::lower_bound(g[j].begin(), g[j].end(), i) - g[j].begin();
            if (to &amp;lt; (int)g[j].size()) &amp;#123;
                p.push_back(&amp;#123; g[j][to], j &amp;#125;);
                if (g[j][to] != i &amp;amp;&amp;amp; to != 0 &amp;amp;&amp;amp; g[j][to] - i &amp;gt; i - g[j][to - 1])
                    p.back() = &amp;#123; g[j][to - 1], j &amp;#125;;
            &amp;#125;
            else if (to != 0)
                p.push_back(&amp;#123; g[j][to - 1], j &amp;#125;);
        &amp;#125;
        std::vector&amp;lt;int&amp;gt; q(m + 1);
        int h = 0, t = -1;
        auto f1 = [&amp;amp;](node A, node B) &amp;#123;
            return A.x * A.x - B.x * B.x + A.y * A.y - B.y * B.y - 2 * i * (A.x - B.x);
        &amp;#125;;
        auto f2 = [&amp;amp;](node A, node B) &amp;#123;
            return 2 * (A.y - B.y);
        &amp;#125;;
        for (int j = 0; j &amp;lt; (int)p.size(); ++j) &amp;#123;
            for (; h &amp;lt; t &amp;amp;&amp;amp; f1(p[j], p[q[t]]) * f2(p[q[t]], p[q[t - 1]]) &amp;lt; f1(p[q[t]], p[q[t - 1]]) * f2(p[j], p[q[t]]); --t);
            q[++t] = j;
        &amp;#125;
        for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;  
            for (; h &amp;lt; t &amp;amp;&amp;amp; f1(p[q[h + 1]], p[q[h]]) &amp;lt; j * f2(p[q[h + 1]], p[q[h]]); ++h);
            res += (p[q[h]].x - i) * (p[q[h]].x - i) + (p[q[h]].y - j) * (p[q[h]].y - j);
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;g---partition-game&#34;&gt;G - Partition Game&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1527/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1527/E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°ä¸å¤ªæ–œä¼˜ï¼Œç»ˆäºç»™æˆ‘æµ¸æ³¡äº†ä¸¤å¤©æ–œä¼˜å†…å®¹çš„å¤§è„‘åŠ äº†å‹ºæ–°çš„åº•ç‰©ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ®µä»¥ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ç»“å°¾çš„æœ€å°ä»£ä»·ï¼›å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; å¥—ç”¨å››è¾¹å½¢ä¸ç­‰å¼å˜å¼ &lt;span class=&#34;math inline&#34;&gt;\(w(l-1,r+1)+w(l,r)\ge w(l-1,r)+w(l,r+1)\)&lt;/span&gt; å‘ç°æˆç«‹ï¼ˆå…¶ä¸­å¤§å¤šæ•°æ—¶å€™èƒ½å–ç­‰ï¼›éƒ¨åˆ†ç‰¹æ®Šæƒ…å†µå–åˆ°å¤§äºå·ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå‘ç°å¯ä»¥ç”¨åˆ†æ²»ä¼˜åŒ–ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; ä¸é‚£ä¹ˆèƒ½å¿«é€Ÿæ±‚ï¼›è¿˜æ˜¯å¥—ç”¨ &lt;a href=&#34;/20250707-1/#ä¾‹yet-another-minimization-problem&#34;&gt;Yet Another Minimization Problem&lt;/a&gt; ä¸­çš„æ–¹æ³•ï¼Œç”¨ç±»ä¼¼è«é˜Ÿçš„æ–¹å¼æ±‚è§£ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™ä¸ªè«é˜Ÿå¥—è·¯ä¹Ÿå¾ˆç†Ÿæ‚‰äº†ï¼Œç›´æ¥ç”¨åŒç«¯é˜Ÿåˆ—ç»´æŠ¤å³å¯ã€‚å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(nk\log n)\)&lt;/span&gt;ï¼Œçœ‹ç€ä¸å¤ªå®‰å…¨ã€‚ä½†æ³¨æ„åˆ°æˆ‘ä»¬åœ¨ 20 ä¸ªæœˆå‰çš„æäº¤ä¸­ä½¿ç”¨äº† &lt;span class=&#34;math inline&#34;&gt;\(O(nk\log n)\)&lt;/span&gt; çš„çº¿æ®µæ ‘ï¼Œæ‰€ä»¥èƒ½è¿‡çš„å…„å¼Ÿã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;é‰´äº deque çš„æ—¶ç©ºå¸¸æ•°éƒ½å¤§å¾—å“äººï¼Œæ‰€ä»¥æˆ‘ç”¨é™æ€ vector æ¨¡æ‹Ÿ deque äº†ã€‚&lt;/p&gt;
&lt;p&gt;è·‘å¾—æ¯”æˆ‘ä¹‹å‰çº¿æ®µæ ‘çš„ä¸€åŠè¿˜å¿«ï¼Œå…„å¼Ÿã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; pos(n + 1);
    std::vector&amp;lt;int&amp;gt; a(n + 1), _h(n + 1), _t(n + 1, -1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], pos[a[i]].push_back(i);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(m + 1, std::vector&amp;lt;long long&amp;gt; (n + 1, inf));
    f[0][0] = 0ll;
    auto w = [&amp;amp;](int ql, int qr) &amp;#123;
        static int l = 1, r = 0;
        static auto res(0ll);
        for (; l &amp;gt; ql; ) &amp;#123;
            --l;
            auto &amp;amp;h = _h[a[l]], &amp;amp;t = _t[a[l]];
            auto &amp;amp;q = pos[a[l]];
            if (h &amp;lt;= t)
                res -= q[t] - q[h];
            res += q[t] - q[--h];
        &amp;#125;
        for (; r &amp;gt; qr; ) &amp;#123;
            auto &amp;amp;h = _h[a[r]], &amp;amp;t = _t[a[r]];
            auto &amp;amp;q = pos[a[r]];
            res -= q[t--] - q[h];
            if (h &amp;lt;= t)
                res += q[t] - q[h];
            --r;
        &amp;#125;
        for (; r &amp;lt; qr; ) &amp;#123;
            ++r;
            auto &amp;amp;h = _h[a[r]], &amp;amp;t = _t[a[r]];
            auto &amp;amp;q = pos[a[r]];
            if (h &amp;lt;= t)
                res -= q[t] - q[h];
            res += q[++t] - q[h];
        &amp;#125;
        for (; l &amp;lt; ql; ) &amp;#123;
            auto &amp;amp;h = _h[a[l]], &amp;amp;t = _t[a[l]];
            auto &amp;amp;q = pos[a[l]];
            res -= q[t] - q[h++];
            if (h &amp;lt;= t)
                res += q[t] - q[h];
            ++l;
        &amp;#125;
        return res;
    &amp;#125;;
    for (int t = 1; t &amp;lt;= m; ++t) &amp;#123;
        std::function&amp;lt;void(int, int, int, int)&amp;gt; calc = [&amp;amp;](int l, int r, int lp, int rp) &amp;#123;
            if (l &amp;gt; r)
                return;
            if (l == r) &amp;#123;
                for (int i = lp; i &amp;lt;= rp &amp;amp;&amp;amp; i &amp;lt; l; ++i)
                    f[t][l] = std::min(f[t][l], f[t - 1][i] + w(i + 1, l));
                return;
            &amp;#125;
            int mid = (l + r) &amp;gt;&amp;gt; 1, p = -1;
            for (int i = lp; i &amp;lt;= rp &amp;amp;&amp;amp; i &amp;lt; mid; ++i)
                if (f[t - 1][i] + w(i + 1, mid) &amp;lt; f[t][mid])
                    f[t][mid] = f[t - 1][i] + w(i + 1, mid), p = i;
            calc(l, mid - 1, lp, p), calc(mid + 1, r, p, rp);
            return;
        &amp;#125;;
        calc(t, n, t - 1, n - 1);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[m][n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;h---battle-lemmings&#34;&gt;H - Battle Lemmings&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1420/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1420/E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„æ•°ç›®ä¸å˜ï¼Œç­”æ¡ˆå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„å¯¹æ•° - è¿ç»­ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„å¯¹æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæœ‰ä¸€ä¸ªæˆ‘ä»¬å¾ˆç†Ÿæ‚‰çš„ trickï¼Œéšä¾¿æ‰¾ä¸€ä¸ªç›®æ ‡åºåˆ—ï¼Œé‚£ä¹ˆèŠ±è´¹çš„æ“ä½œæ¬¡æ•°å°±æ˜¯æ¯ä¸ªå¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä½ç½®å·®ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,k}\)&lt;/span&gt; è¡¨ç¤ºç”¨äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¬¡æ“ä½œã€&lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€æœ€åä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„æœ€å°è¿ç»­ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¯¹æ•°ã€‚é‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{i,j,k}&amp;amp;=\min\limits_{p&amp;lt;k}\left\{f_{i-|k-pos_j|,j-1,p}+\dfrac {(k-p-1)(k-p-2)}2\right\}\\
&amp;amp;=\min\left\{f_{i-|k-pos_j|,j-1,p}-k\cdot p+\dfrac {p(p + 2)}2\right\}+\dfrac {k^2-3k+2}2
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™ä¸ªå¼å­æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^5)\)&lt;/span&gt; çš„ï¼Œè€Œä¸”çœ‹èµ·æ¥å¾ˆæ–œä¼˜ï¼ŒåŒ–ä¸ºæ–œç‡å½¢å¼ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac{2\times f_A-2\times f_B+A(A+2)-B(B+2)}{2(A-B)}&amp;lt;k\)&lt;/span&gt;ã€‚ç»´æŠ¤é€’å¢æ–œç‡å°±å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n^4)\)&lt;/span&gt; åšäº†ã€‚&lt;/p&gt;
&lt;p&gt;Tipï¼šå½“æ—¶å†™ç€å†™ç€æ„£ä½äº†ï¼Œæ¯”å¦‚è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i-|k-pos_j|\)&lt;/span&gt; ä¸æ˜¯ä¸€ç›´åœ¨åŠ¨å—ã€‚è§£å†³æ–¹æ¡ˆï¼ŸåŒæ—¶ç»´æŠ¤å¾ˆå¤šä¸ªé˜Ÿåˆ—å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;æ³¨æ„è¿˜è¦æŠŠæœ€åä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¹‹åè¿ç»­ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä»£ä»·ç®—ä¸Šã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e9;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    std::vector&amp;lt;long long&amp;gt; pos(1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        if (a[i] == 1)
            pos.push_back(i);
    &amp;#125;
    int m = n * (n - 1) / 2;
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; &amp;gt; f(pos.size(), std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; (m + 1, std::vector&amp;lt;long long&amp;gt; (n + 1, inf)));
    f[0][0][0] = 0ll;
    for (int j = 1; j &amp;lt; (int)pos.size(); ++j) &amp;#123;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; _q(m + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
        std::vector&amp;lt;int&amp;gt; _h(m + 1), _t(m + 1, -1);
        for (int k = 0; k &amp;lt;= n; ++k)
            for (int i = m; i &amp;gt;= 0; --i) &amp;#123;
                if (i &amp;gt;= std::abs(k - pos[j])) &amp;#123;
                    auto f1 = [&amp;amp;](long long A, long long B) &amp;#123;
                        return 2 * f[j - 1][i - std::abs(k - pos[j])][A] - 2 * f[j - 1][i - std::abs(k - pos[j])][B] + A * (A + 2) - B * (B + 2);
                    &amp;#125;;
                    auto f2 = [&amp;amp;](long long A, long long B) &amp;#123;
                        return 2 * (A - B);
                    &amp;#125;;
                    auto &amp;amp;h = _h[i - std::abs(k - pos[j])], &amp;amp;t = _t[i - std::abs(k - pos[j])];
                    auto &amp;amp;q = _q[i - std::abs(k - pos[j])];
                    for (; h &amp;lt; t &amp;amp;&amp;amp; f1(q[h + 1], q[h]) &amp;lt; k * f2(q[h + 1], q[h]); ++h) &amp;#123;&amp;#125;
                    if (h &amp;lt;= t)
                        f[j][i][k] = std::min(inf, f[j - 1][i - std::abs(k - pos[j])][q[h]] + (k - q[h] - 1) * (k - q[h] - 2) / 2);
                &amp;#125;
                auto f1 = [&amp;amp;](long long A, long long B) &amp;#123;
                    return 2 * f[j - 1][i][A] - 2 * f[j - 1][i][B] + A * (A + 2) - B * (B + 2);
                &amp;#125;;
                auto f2 = [&amp;amp;](long long A, long long B) &amp;#123;
                    return 2 * (A - B);
                &amp;#125;;
                auto &amp;amp;h = _h[i], &amp;amp;t = _t[i];
                auto &amp;amp;q = _q[i];
                for (; h &amp;lt; t &amp;amp;&amp;amp; f1(k, q[t]) * f2(q[t], q[t - 1]) &amp;lt; f1(q[t], q[t - 1]) * f2(k, q[t]); --t);
                q[++t] = k;
            &amp;#125;
    &amp;#125;
    auto res(-inf);
    int cnt = n - (int)pos.size() + 1;
    cnt = cnt * (cnt - 1) / 2;
    for (int i = 0; i &amp;lt;= m; ++i) &amp;#123;
        for (int k = 0; k &amp;lt;= n; ++k)
            res = std::max(res, cnt - f.back()[i][k] - (n - k) * (n - k - 1) / 2);
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---yakiniku-restaurants&#34;&gt;A - Yakiniku Restaurants&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc067/tasks/arc067_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc067/tasks/arc067_d&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°å›ºå®šå·¦å³ç«¯ç‚¹åï¼Œæ”¶ç›Šæ˜¯å¯ä»¥è´ªå¿ƒç®—çš„ï¼›ä¸‹æ„è¯†æƒ³åˆ°åªå›ºå®šå·¦ç«¯ç‚¹ï¼Œé‚£ä¹ˆå³ç«¯ç‚¹åº”è¯¥å°±å¯ä»¥ç”¨å•è°ƒé˜Ÿåˆ—ä¹‹ç±»çš„æä¸€æã€‚&lt;/p&gt;
&lt;p&gt;å…ˆæå‰æŠŠæ‰€æœ‰ä¸œè¥¿å¡åˆ°é˜Ÿåˆ—é‡Œã€‚å·¦ç«¯ç‚¹ä¸€å¼€å§‹åœ¨æœ€å³è¾¹ï¼›å¾€å·¦è¾¹åŠ¨ä¸€ä¸‹ä¹‹åï¼Œå°±å¯ä»¥æ›´æ–°æ¯ç§èœçš„é˜Ÿåˆ—ï¼›å‘ç°åœ¨æ‰€æœ‰å…ƒç´ ä¸­ä½œå†³ç­–ç‚¹çš„ä¸æ€»æ˜¯é˜Ÿå¤´ï¼›è¿™ä¸ªåœ°æ–¹ç”¨ &lt;strong&gt;å•è°ƒé€’å‡çš„å•è°ƒæ ˆ&lt;/strong&gt; æ˜¯æå¥½çš„ã€‚è¿™é‡Œçš„å•è°ƒæ ˆå…¶å®å°±ç±»ä¼¼ &lt;a href=&#34;/20250707-1/#ä¼˜åŒ–-dpå•è°ƒæ•°æ®ç»“æ„&#34;&gt;å››è¾¹å½¢ä¸ç­‰å¼ä¸­çš„å•è°ƒæ•°æ®ç»“æ„&lt;/a&gt; äº†ã€‚&lt;/p&gt;
&lt;p&gt;ç»´æŠ¤å•è°ƒæ ˆä¸­æ¯ä¸ªå†³ç­–ç‚¹çš„å½±å“åŒºé—´ï¼›æ˜¾ç„¶æ¯ä¸ªå³ç«¯ç‚¹çš„ç­”æ¡ˆå˜åŒ–é‡ç›¸åŒï¼›ç”¨ä¸ªç±»ä¼¼äºå·®åˆ†çš„ä¸œè¥¿è®°å½•ä¸€ä¸‹å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; s(n + 1), f(n + 1);
    for (int i = 2; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; s[i], s[i] += s[i - 1];
        f[i] = -s[i];
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; a(n + 1, std::vector&amp;lt;int&amp;gt; (m + 1));
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 1; j &amp;lt;= m; ++j)
            std::cin &amp;gt;&amp;gt; a[i][j];
    struct node &amp;#123; int j, l, r; &amp;#125;;
    std::vector&amp;lt;std::stack&amp;lt;node&amp;gt; &amp;gt; _q(m + 1);
    auto res(-inf);
    for (int l = n; l; --l) &amp;#123;
        std::vector&amp;lt;long long&amp;gt; d(n + 1);
        auto add = [&amp;amp;](int l, int r, long long v) &amp;#123;
            d[l] += v;
            if (r != n)
                d[r + 1] -= v;
            return;
        &amp;#125;;
        for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
            auto &amp;amp;q = _q[j];
            node now = &amp;#123; j, l, l &amp;#125;;
            add(l, l, a[l][j]);
            for (; !q.empty() &amp;amp;&amp;amp; a[l][j] &amp;gt;= a[q.top().l][q.top().j]; q.pop()) &amp;#123;
                now.r = q.top().r;
                add(q.top().l, q.top().r, a[l][j] - a[q.top().l][q.top().j]);
            &amp;#125;
            q.push(now);
        &amp;#125;
        std::partial_sum(d.begin() + 1, d.end(), d.begin() + 1);
        for (int r = l; r &amp;lt;= n; ++r) &amp;#123;
            f[r] += d[r];
            res = std::max(res, f[r] + s[l]);
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---jellyfish-and-miku&#34;&gt;B - Jellyfish and Miku&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1874/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1874/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å”‰æ•°åˆ—ã€‚å”‰æ¦‚ç»Ÿã€‚åœ¨æ•°å­¦è®²ä¹‰ä¸ŠæŠ˜ç£¨äº†æˆ‘ä¸€éä¹‹åè¿˜è¦åˆ°è¿™å„¿æ¥æŠ˜ç£¨æˆ‘ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾å·²ç»çŸ¥é“äº† &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œè€ƒè™‘æ±‚æœŸæœ›æ­¥æ•°ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(E_i\)&lt;/span&gt; ä¸ºä» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å‡ºå‘èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æœŸæœ›æ­¥æ•°ã€‚é‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
E_i=\begin{cases}
E_1+1&amp;amp;i=0\\
0&amp;amp;i=n\\
E_i=(E_{i-1}+1)\cdot \dfrac {a_i}{a_{i+1}+a_i}+(E_{i+1}+1)\cdot \dfrac {a_{i+1}}{a_{i+1}+a_{i}}&amp;amp;\text{otherwise}
\end{cases}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆæç¤ºï¼šä»ã€&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸‹ä¸€æ­¥ä¼šèµ°å“ªä¸ªæ–¹å‘ã€è€ƒè™‘ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±å¯ä»¥åˆ©ç”¨ä½ çš„é«˜ä¸­æ•°å­¦çŸ¥è¯†è¿›è¡Œä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f_0\)&lt;/span&gt; çš„æ±‚ï¼Œï¼ˆä¸€å †è¿‡ç¨‹ï¼‰ï¼Œå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(E_0=n+2\times \sum\limits_{i=1}^n\dfrac {\sum_{j\le i}a_j}{a_i}\)&lt;/span&gt;ï¼Œç„¶åæƒ³è¦æœ€å°åŒ–è¿™ä¸ªä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºåˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶å·²ç»åˆ†é…èµ°äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½“ç§¯ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\sum_{k=1}^i \dfrac {\sum_{l\le k}a_l}{a_k}\)&lt;/span&gt; çš„æœ€å°å€¼ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\min\limits_{k&amp;lt;j}\left\{f_{i-1,k}+\dfrac {k}{j - k}\right\}\)&lt;/span&gt;ã€‚å‘ç°å®ƒå¤§æŠµæ˜¯æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼çš„ï¼ŒæŒ‰ç…§ &lt;a href=&#34;/20250707-1/#d1d-dp-ä¼˜åŒ–&#34;&gt;2D/1D DP ä¼˜åŒ–çš„ç»“è®º&lt;/a&gt;ï¼Œä»£å…¥ &lt;span class=&#34;math inline&#34;&gt;\(p_{i,j-1}&amp;lt;p_{i,j}&amp;lt;p_{i+1,j}\)&lt;/span&gt; å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt; è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; p(n + 1, std::vector&amp;lt;int&amp;gt; (m + 1));
    std::vector&amp;lt;std::vector&amp;lt;long double&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long double&amp;gt; (m + 1, 1e18));
    f[0][0] = 0ll;
    for (int j = 1; j &amp;lt;= m; ++j)
        for (int i = std::min(j, n); i; --i) &amp;#123;
            int to = ((i == std::min(j, n)) ? j : std::min(p[i + 1][j], j));
            for (int k = p[i][j - 1]; k &amp;lt;= to; ++k)
                if (f[i - 1][k] + k * 1. / (j - k) &amp;lt; f[i][j])
                    f[i][j] = f[i - 1][k] + k * 1. / (j - k), p[i][j] = k;
            // printf(&amp;quot;f[%d][%d] = %Lf, p = %d\n&amp;quot;, i, j, f[i][j], p[i][j]);
        &amp;#125;
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(10) &amp;lt;&amp;lt; n + 2 * f[n][m] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;cut-the-sequence&#34;&gt;Cut the Sequence&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P10977&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P10977&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&#34;é€šçŸ¥åŒºé—´æœ€å€¼-ä¸æ»¡è¶³-å››è¾¹å½¢ä¸ç­‰å¼&#34;&gt;&lt;mark&gt;é€šçŸ¥ï¼šåŒºé—´æœ€å€¼ ä¸æ»¡è¶³ å››è¾¹å½¢ä¸ç­‰å¼ã€‚&lt;/mark&gt;&lt;/h1&gt;
&lt;p&gt;å…¶å®åœ¨çŒœçš„æ—¶å€™æ˜¯ä¸¾äº†åä¾‹çš„ï¼Œä½†æ˜¯å¤§è„‘èç¼©äº†æ¨ç€æ¨ç€å¿˜è®°ç¬¦å·äº† ğŸ˜…&lt;/p&gt;
&lt;p&gt;çœ‹åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_i=\min\limits_{g(i)\le j&amp;lt;i}\{f_j+\max\{a_{j+1\sim i}\}\}\)&lt;/span&gt; è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„èŒƒå›´å…¶å®æ˜¯æœ‰ç‚¹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–çš„æ„Ÿè§‰çš„ï¼Œä½†è¿™ä¸ªæœ€å¤§å€¼ä¼ ç»Ÿçš„å•è°ƒé˜Ÿåˆ—ä¸æ˜¯å¾ˆå¯åšã€‚å¯ä»¥æ³¨æ„åˆ°æœ€å¤§å€¼è¿™ä¸€é¡¹æœ‰ç‚¹ &lt;strong&gt;å•è°ƒé˜Ÿåˆ—&lt;/strong&gt; åç¼€æœ€å¤§å€¼çš„æ„Ÿè§‰ï¼ˆå®é™…ä¸Šå°±æ˜¯ï¼‰ï¼›ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æƒ³æ³•æ˜¯åˆ©ç”¨è¿™ä¸ªæœ€å¤§å€¼å½±å“çš„åŒºé—´ï¼Œç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; çš„çº¿æ®µæ ‘æ¥æš´åŠ›åšã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ä¸ªæ¯”è¾ƒç‰›çš„åšæ³•æ˜¯å‘ç°åŒä¸€ä¸ªä¸‹æ ‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å…³ç³»ã€‚é¦–å…ˆéœ€è¦æ³¨æ„åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å•è°ƒä¸é™ï¼›å¯¹äºåŒä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œèƒ½å–åˆ°çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å°±æ˜¯æœ€é å‰çš„ï¼›ç»´æŠ¤ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å•å‡é˜Ÿåˆ—ï¼Œé‚£ä¹ˆå…±ç”¨åŒä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å°±æ˜¯ç›¸é‚»ä¸¤ä¸ªä¸‹æ ‡ä¹‹é—´çš„éƒ¨åˆ†ï¼Œå…¶æœ€ä¼˜å†³ç­–åœ¨èƒ½å–åˆ°çš„æœ€å‰ç«¯å–å¾—ï¼›éœ€è¦æ³¨æ„åˆ°é˜Ÿåˆ—é‡Œçš„è´¡çŒ®å¹¶ä¸å•è°ƒï¼Œéœ€è¦ç”¨ä¸€ä¸ª multiset æ¥å­˜å‚¨æ‰€æœ‰è´¡çŒ®å¹¶æŸ¥æ‰¾ã€æ›´æ–°ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„å•è°ƒé˜Ÿåˆ—é‡ŒæŸä¸ªå…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(f_{q_i}\)&lt;/span&gt; ç»“åˆçš„å…¶å®æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_{q_{i+1}}\)&lt;/span&gt;ã€‚è¿˜éœ€è¦æ³¨æ„é˜Ÿå¤´çš„ç»´æŠ¤ï¼Œå¯èƒ½éœ€è¦ä¸€äº›å°å·§æ€ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;1.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    std::vector&amp;lt;long long&amp;gt; s(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], s[i] = s[i - 1] + a[i];
    int h = 0, t = -1;
    std::multiset&amp;lt;long long&amp;gt; st;
    std::vector&amp;lt;long long&amp;gt; f(n + 1);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; q(n + 1);
    q[++t] = &amp;#123; 0, 0 &amp;#125;, a[0] = 0x3f3f3f3f;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (; s[i] - s[q[h].second] &amp;gt; m; ) &amp;#123;
            st.erase(st.find(f[q[h].second] + a[q[h + 1].first]));
            if (++q[h].second &amp;gt;= q[h + 1].first)
                a[q[++h].first] = 0x3f3f3f3f;
            else
                st.insert(f[q[h].second] + a[q[h + 1].first]);
        &amp;#125;
        for (; h &amp;lt; t &amp;amp;&amp;amp; a[q[t].first] &amp;lt;= a[i]; --t)
            st.erase(st.find(f[q[t - 1].second] + a[q[t].first]));
        st.insert(f[q[t].second] + a[i]), q[++t] = &amp;#123; i, i &amp;#125;;
        f[i] = *st.begin();
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="æ–œç‡ä¼˜åŒ–" />
        <category term="DP" />
        <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
        <updated>2025-07-15T06:13:24.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250712/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250712/"/>
        <content type="html">&lt;p&gt;æˆ‘ç”Ÿå¾…æ˜æ—¥ï¼Œä¸‡äº‹æˆè¹‰è·ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;town&#34;&gt;town&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6407/problem/1&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6407/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€æ£µå¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ ‘ï¼Œç‚¹æœ‰ç‚¹æƒï¼Œæ¬²å°†æ ‘åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªè¿é€šå—ï¼Œä½¿å¾—æ¯ä¸ªå—å†…çš„ç‚¹æƒå¼‚æˆ–å’Œéƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œæ±‚æ–¹æ¡ˆæ•°ï¼Œæ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(998244353\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6,0\le x\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è®° &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¼•å¯¼çš„å­æ ‘å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(s_u\)&lt;/span&gt;ã€‚æŠŠè¿é€šå—è½¬åŒ–ä¸ºå¯¹æ–­è¾¹çš„è®¨è®ºã€‚è€ƒå¯Ÿä¸€æ¡æœ€æœ«ç«¯çš„è¾¹ï¼Œå…¶ä¸‹æ–¹å­æ ‘çš„å¼‚æˆ–å’Œä¸€å®šä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç®€å•æ•°å½’å¯å¾—æ–­æ‰çš„æ¯ä¸€æ¡è¾¹ï¼Œå…¶ä¸‹æ–¹å­æ ‘å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼ˆé‚£ä¹ˆæ˜¾ç„¶æœ‰è§£çš„å……è¦æ¡ä»¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(s_1=0\lor s_1=x\)&lt;/span&gt;ï¼‰ã€‚è€ƒè™‘æ ‘å½¢ DPï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,0/1}\)&lt;/span&gt; è¡¨ç¤ºå½“å‰ DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘å¤´ä¸Šé‚£æ¡è¾¹ï¼Œå®ƒè¿æ¥äº†ä¸€ä¸ªå¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(s_u\)&lt;/span&gt; ï¼ˆæˆ– &lt;span class=&#34;math inline&#34;&gt;\(s_u\oplus x\)&lt;/span&gt;ï¼‰çš„è¿é€šå—çš„åˆæ³•æ–¹æ¡ˆæ•°ï¼Œåˆ†åˆ«ä»£è¡¨å·²ç»ã€æ–­ã€æ‰äº†å¶æ•° / å¥‡æ•°ä¸ªåˆæ³•è¿é€šå—ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè‡ªç„¶å¯ä»¥ä¸€æ¡è¾¹éƒ½ä¸æ–­ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{u,0}=1\)&lt;/span&gt;ã€‚é‚£ä¹ˆæ›´æ–°å°±åº”ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f&amp;#39;_{u,0}=f_{u,0}\cdot f_{v,0}+f_{u,1}\cdot f_{v,1}\\
f&amp;#39;_{u,1}=f_{u,0}\cdot f_{v,1}+f_{u,1}\cdot f_{v,0}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ¥ç€ï¼Œå¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(s_u\)&lt;/span&gt; æ°å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œè¿™æ¡è¾¹è¿æ¥çš„è¿é€šå—çš„å¼‚æˆ–å’Œå°±å¯ä»¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨è¿™æ¡è¾¹å¤„æ–­å¼€ï¼Œæä¾›ä¸€ä¸ªç©ºè¿é€šå—ï¼ˆåŠ å…¥å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„æ–¹æ¡ˆï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åæ³¨æ„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å¯èƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†â€”â€”æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(s_u=0\)&lt;/span&gt; å¤„éƒ½å¯ä»¥æ–­å¼€ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ª DP çŠ¶æ€å®åœ¨éå¸¸æ–°å¥‡ï¼›åŒæ—¶ DP å’Œåˆ è¾¹åˆæ˜¯åˆ†å¼€çš„ï¼Œæ˜¾å¾—éå¸¸å‰²è£‚ã€‚çœ‹ solã€å¬ grisses è®²è§£çš„æ—¶å€™éƒ½å®Œå…¨ä¸€å¤´é›¾æ°´ã€‚quack è¯´è¿™æ˜¯å› ä¸ºæˆ‘æ²¡åšè¿‡è¿é€šå— DP /ll&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;ex_town1.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; a(n + 1), s(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        s[x] = a[x];
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                s[x] ^= s[i];
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    if (s[1] != 0 &amp;amp;&amp;amp; s[1] != m) &amp;#123;
        std::cout &amp;lt;&amp;lt; 0 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    if (m == 0) &amp;#123;
        auto res(1ll);
        for (int i = 2; i &amp;lt;= n; ++i)
            if (s[i] == 0)
                (res *= 2) %= mod;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    else &amp;#123;
        std::vector&amp;lt;std::array&amp;lt;long long, 2&amp;gt; &amp;gt; f(n + 1);
        DFS = [&amp;amp;](int x, int fa) &amp;#123;
            f[x][0] = 1ll;
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    DFS(i, x);
                    std::tie(f[x][0], f[x][1]) = std::make_tuple((f[x][0] * f[i][0] + f[x][1] * f[i][1]) % mod, (f[x][0] * f[i][1] + f[x][1] * f[i][0]) % mod);
                &amp;#125;
            if (x != 1) &amp;#123;
                if (s[x] == m)
                    (f[x][1] += f[x][0]) %= mod;
                if (s[x] == 0)
                    (f[x][0] += f[x][1]) %= mod;
            &amp;#125;
            // printf(&amp;quot;f[%d][0] = %lld, f[%d][1] = %lld\n&amp;quot;, x, f[x][0], x, f[x][1]);
            return;
        &amp;#125;;
        DFS(1, -1);
        std::cout &amp;lt;&amp;lt; (s[1] == m ? f[1][0] : f[1][1]) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;perm&#34;&gt;perm&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6407/problem/3&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6407/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€å…ƒç´ ä¸¤ä¸¤ä¸åŒçš„åºåˆ—ï¼Œä½ å¯ä»¥äº¤æ¢ä»»æ„ä¸¤ä¸ªå…ƒç´ ã€‚è¯•ä½¿ç”¨æœ€å°‘äº¤æ¢æ¬¡æ•°ä½¿å¾—åºåˆ—æœ‰åºï¼Œé—®æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ªä¸‹æ ‡ï¼Œå°†å®ƒå’Œå®ƒä¸Šé¢å…ƒç´ çš„ rank è¿æœ‰å‘è¾¹ï¼Œé‚£ä¹ˆæ¯ä¸ªä¸‹æ ‡çš„å‡ºã€å…¥åº¦éƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œåˆ™å›¾ç”±è‹¥å¹²ä¸ªç®€å•ç¯ç»„æˆã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€ï¼Œè€ƒè™‘ä¸€æ¬¡ä»»æ„ä¸€æ¬¡äº¤æ¢ &lt;span class=&#34;math inline&#34;&gt;\((x,y)\)&lt;/span&gt; çš„æ“ä½œä¼šå¸¦æ¥ä»€ä¹ˆï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt; ä¸åœ¨åŒä¸€ç¯ä¸Šï¼š&lt;/p&gt;
è¯¥æ“ä½œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt; æ‰€åœ¨çš„ç¯åˆä¸ºä¸€ä¸ªå¤§ç¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt; åœ¨åŒä¸€ç¯ä¸Šï¼š&lt;/p&gt;
&lt;p&gt;è¯¥æ“ä½œä½¿å¾—ç¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt; ä¸ºåˆ†ç•Œçº¿è£‚æˆä¸¤ä¸ªå°ç¯ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªè‡ªç¯ä¸ºç›®æ ‡ï¼Œæ•°å½’å¾—åˆ°ï¼Œå¯¹äºæœ€ä¼˜æ–¹æ¡ˆï¼Œå½“ä¸”ä»…å½“æ¯æ¬¡äº¤æ¢çš„ç›®æ ‡éƒ½åœ¨åŒä¸€ç¯ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ–¹æ¡ˆæ•°ã€‚æŠŠä¸€ä¸ªå¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ç¯ï¼Œæ¬²å°†å…¶æ‹†æˆ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªè‡ªç¯ï¼Œå…±éœ€ &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; æ¬¡ &lt;em&gt;æœ‰åº&lt;/em&gt; çš„æ‹†è§£ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ DPï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_k\)&lt;/span&gt; ä¸ºæ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(f_k=\dfrac {k\sum\limits_{j=1}^{k-1} f_j\cdot f_{k-j}\cdot C_{k-2}^j}2\)&lt;/span&gt;ã€‚å°è¯•æ‰“è¡¨ï¼Œï¼ˆæƒŠè®¶åœ°ï¼‰å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_k=k^{k-2}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒçš„ç¯ä¹‹é—´çš„æ“ä½œå¯ä»¥äº¤é”™ï¼Œçœ‹ä½œå¤šé‡é›†æ’åˆ—å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), p(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], p[i] = i;
    std::sort(p.begin() + 1, p.end(), [&amp;amp;](int i, int j) &amp;#123; return a[i] &amp;lt; a[j]; &amp;#125;);
    std::vector&amp;lt;int&amp;gt; f(n + 1), siz(n + 1, 1);
    std::iota(f.begin() + 1, f.end(), 1);
    std::function&amp;lt;int(int)&amp;gt; find = [&amp;amp;](int x) &amp;#123;
        return x == f[x] ? x : f[x] = find(f[x]);
    &amp;#125;;
    auto merge = [&amp;amp;](int x, int y) &amp;#123;
        x = find(x), y = find(y);
        if (x != y)
            siz[y] += siz[x], f[x] = y;
        return;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        merge(i, p[i]);
    std::vector&amp;lt;long long&amp;gt; g(n + 1), fac(n + 1), inv(n + 1);
    g[1] = g[2] = 1ll, fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    for (int i = 3; i &amp;lt;= n; ++i)
        g[i] = qkp(i, i - 2);
    int cnt(0);
    auto res(1ll);
    for (int i = 1; i &amp;lt;= n; ++i)
        if (f[i] == i) &amp;#123;
            cnt += siz[i] - 1;
            (res *= g[siz[i]]) %= mod;
            (res *= inv[siz[i] - 1]) %= mod;
        &amp;#125;
    (res *= fac[cnt]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;cf2122d-traffic-lights&#34;&gt;CF2122D Traffic Lights&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/2122/problem/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/2122/problem/D&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™ä½ ä¸€ä¸ªç”± &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªé¡¶ç‚¹å’Œ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¡è¾¹ç»„æˆçš„ç®€å•æ— å‘è¿é€šå›¾ã€‚åœ¨é¡¶ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æœ‰ä¸€ä¸ªæ ‡è®°ã€‚è®¤ä¸ºåˆå§‹æ—¶é—´ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t=0\)&lt;/span&gt;ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’åï¼Œå¦‚æœæ ‡è®°ä½äºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ï¼Œåˆ™å¿…é¡»æ‰§è¡Œä»¥ä¸‹æ“ä½œä¹‹ä¸€ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç­‰å¾…ä¸€ç§’ã€‚&lt;/li&gt;
&lt;li&gt;å°†æ ‡è®°æ²¿ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\((t \bmod \mathrm{deg}(u) + 1)\)&lt;/span&gt; æ¡è¾¹ç§»åŠ¨ï¼ŒèŠ±è´¹ä¸€ç§’ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®¡ç®—å°†æ ‡è®°ä»é¡¶ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç§»åˆ°é¡¶ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ‰€éœ€çš„æœ€çŸ­æ—¶é—´ï¼Œä»¥åŠåœ¨ä½¿æ€»æ—¶é—´æœ€å°åŒ–çš„åŒæ—¶æ‰€èƒ½è¾¾åˆ°çš„æœ€çŸ­ç­‰å¾…æ—¶é—´ã€‚&lt;span class=&#34;math inline&#34;&gt;\(m\le 5\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;èƒ½å¤Ÿå‘ç°è¿™æ˜¯ä¸€ä¸ªè¾¹æƒå’Œ dis æœ‰å…³çš„æœ€çŸ­è·¯ï¼Œæœ¬ç€åˆ†å±‚å›¾ä¸€ç±»çš„æƒ³æ³•ï¼Œè€ƒå¯Ÿç­”æ¡ˆçš„æœ€å€¼ã€‚å‘ç°ä¸€ä¸ªå¾ˆæ¾çš„ä¸Šç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(m)\)&lt;/span&gt;ï¼›å‘ç°å®é™…æƒ…å†µä¼šæ¯”è¿™ä¸ªä¹è§‚å¾—å¤šï¼Œè¿™ä¸ªæ—¶å€™å°±ä¼šè€ƒè™‘ç”¨ä¸€äº›æš´åŠ›åšæ³•è‰è¿‡å»äº†ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šæœ‰ä¸€ä¸ªä¸Šç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(3n\)&lt;/span&gt;ï¼šå–ä¸€æ¡æœ€çŸ­è·¯ï¼Œåˆ™ä¸å­˜åœ¨è·¯å¾„å¤–çš„ç‚¹ï¼Œä¸è·¯å¾„ä¸Šè‡³å°‘å››ä¸ªç‚¹æœ‰è¿è¾¹ï¼Œå¦åˆ™å¯ä»¥æ›´æ–°æœ€çŸ­è·¯ã€‚è®¾æœ€çŸ­è·¯é•¿ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œè®©æ¯æ¬¡ç­‰å¾…æ—¶é—´å–æ»¡ï¼Œè€ƒå¯Ÿç­”æ¡ˆå‘ç°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2k\)&lt;/span&gt;ï¼ˆè·¯å¾„ä¸Šç‚¹ä¹‹é—´ï¼‰ã€&lt;span class=&#34;math inline&#34;&gt;\(3(n-k)\)&lt;/span&gt;ï¼ˆè·¯å¾„ä¸Šä¸è·¯å¾„å¤–ï¼‰ï¼Œå…±ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\le 3n\)&lt;/span&gt;ã€‚è¿˜æœ‰ä¸€ä¸ªä¸Šç¡®ç•Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2n-3\)&lt;/span&gt;ï¼Œå¯ä»¥æ¬£èµä¸€ä¸‹ &lt;a href=&#34;https://codeforces.com/blog/entry/144876?#comment-1295568&#34; class=&#34;uri&#34;&gt;https://codeforces.com/blog/entry/144876?#comment-1295568&lt;/a&gt;ï¼Œæˆ‘æ²¡çœ‹æ‡‚ ğŸ˜°&lt;/p&gt;
&lt;p&gt;æ€»ä¹‹å¯ä»¥çŒœåˆ°æš´åŠ› dij ä¸Š DP å¾—åˆ°â€¦â€¦ å•Šé¢˜è§£æ€ä¹ˆè¯´æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2+m)\)&lt;/span&gt; çš„ã€‚åŸå› æ˜¯æ±‚å¾—ç­”æ¡ˆä¸Šç•Œä¹‹åå°±èƒ½æš´åŠ›æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹äº† ğŸ˜…&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, m;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
        for (int x, y; m--; ) &amp;#123;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
            g[x].push_back(y), g[y].push_back(x);
        &amp;#125;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; dis(2, std::vector&amp;lt;int&amp;gt; (n + 1, inf));
        dis[1][1] = 0;
        for (int t = 0; ; ++t) &amp;#123;
            auto &amp;amp;d = dis[t &amp;amp; 1], &amp;amp;la = dis[(t &amp;amp; 1) ^ 1];
            std::vector&amp;lt;int&amp;gt; (n + 1, inf).swap(d);
            for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
                int to = t % ((int)g[i].size());
                d[g[i][to]] = std::min(d[g[i][to]], la[i]);
                d[i] = std::min(d[i], la[i] + 1);
            &amp;#125;
            if (d[n] != inf) &amp;#123;
                std::cout &amp;lt;&amp;lt; t + 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; d[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
                break;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;arc202a-merge-and-increment&#34;&gt;ARC202A Merge and Increment&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc202/tasks/arc202_a&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc202/tasks/arc202_a&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾ç›¸é‚»å…ƒç´ å…¨éƒ¨ä¸åŒï¼Œè‡³å°‘åœ¨å½“å‰è¿™ä¸€æ­¥æœ‰ä¸€ä¸ªå¾ˆæ˜¾ç„¶çš„ç­–ç•¥ï¼ˆè®°ä¸º &lt;em&gt;ç­–ç•¥ä¸€&lt;/em&gt;ï¼‰æ˜¯é€‰å…¨å±€æœ€å°å€¼ï¼ŒæŠŠå®ƒå’Œå®ƒå·¦è¾¹ã€å³è¾¹æ›´å°çš„ä¸€ä¸ª merge èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°å¦‚æœå½“å‰å…¨å±€æœ€å°å€¼æœ‰ç›¸é‚»çš„å¶æ•°ä¸ªï¼Œå¯ä»¥æŠŠç›¸é‚»é¡¹åˆå¹¶ä¸€æ¬¡ï¼Œå¾—åˆ°é•¿åº¦å‡åŠçš„åŒºé—´ï¼Œä¸€å®šä¸åŠ£ï¼ˆè®°ä¸º &lt;em&gt;ç­–ç•¥äºŒ&lt;/em&gt;ï¼‰ï¼›å‡å¦‚å½“å‰å…¨å±€æœ€å°å€¼å­˜åœ¨ç›¸é‚»çš„å¥‡æ•°ä¸ªï¼Œå¾ˆå®¹æ˜“æ³¨æ„åˆ°æœ‰ä¸¤ç§å¤„ç†æ–¹å¼ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;é€‰å–å¶æ•°ä¸ªåº”ç”¨ç­–ç•¥äºŒï¼Œå‰©ä½™ä¸€ä¸ªåº”ç”¨ç­–ç•¥ä¸€ã€‚&lt;/li&gt;
&lt;li&gt;èŠ±ä¸€æ­¥ï¼Œè¡¥ä¸€ä¸ªå…¨å±€æœ€å°å€¼ï¼Œè½¬åŒ–ä¸ºç­–ç•¥äºŒã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å¾ˆå®¹æ˜“å‘ç°ç¬¬äºŒç§æ–¹å¼ä¸€å®šä¸åŠ£ ğŸ˜…ã€‚æ¨¡æ‹Ÿå³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n;
        std::cin &amp;gt;&amp;gt; n;
        std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; a(1);
        &amp;#123;
            for (int i = 1, x; i &amp;lt;= n; ++i) &amp;#123;
                std::cin &amp;gt;&amp;gt; x;
                if (x != a.back().first)
                    a.emplace_back(x, 1);
                else
                    ++a.back().second;
            &amp;#125;
            n = (int)a.size() - 1;
        &amp;#125;
        std::vector&amp;lt;int&amp;gt; pre(n + 2), nex(n + 1), tag(n + 1);
        std::priority_queue&amp;lt;std::pair&amp;lt;int, int&amp;gt;, std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt;, std::greater&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; q;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            q.emplace(a[i].first, i);
            pre[i] = i - 1, nex[i] = i + 1;
        &amp;#125;
        nex[0] = 1, pre[n + 1] = n;
        auto del = [&amp;amp;](int i) &amp;#123;
            tag[i] = 1;
            pre[nex[i]] = pre[i], nex[pre[i]] = nex[i];
            return;
        &amp;#125;;
        auto res(0ll);
        for (; (int)q.size() &amp;gt; 1;) &amp;#123;
            auto [x, id] = q.top();
            q.pop();
            if (tag[id] || a[id].first != x)
                continue;
            if (a[id].second == 1) &amp;#123;
                if (!pre[id] || (nex[id] != n + 1 &amp;amp;&amp;amp; a[nex[id]].first &amp;lt;= a[pre[id]].first))
                    res += a[nex[id]].first - x, a[id].first = a[nex[id]].first;
                else
                    res += a[pre[id]].first - x, a[id].first = a[pre[id]].first;
            &amp;#125;
            else &amp;#123;
                if (a[id].second &amp;amp; 1)
                    ++res, ++a[id].second;
                ++a[id].first, a[id].second /= 2;
            &amp;#125;
            if (pre[id] &amp;amp;&amp;amp; a[id].first == a[pre[id]].first)
                a[id].second += a[pre[id]].second, del(pre[id]);
            if (nex[id] != n + 1 &amp;amp;&amp;amp; a[id].first == a[nex[id]].first)
                a[id].second += a[nex[id]].second, del(nex[id]);
            q.emplace(a[id].first, id);
        &amp;#125;
        &amp;#123;
            auto [x, id] = q.top();
            for ( ; a[id].second != 1; ) &amp;#123;
                if (a[id].second &amp;amp; 1)
                    ++res, ++a[id].second;
                ++a[id].first, a[id].second /= 2;
            &amp;#125;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="æ ‘å½¢ DP" />
        <category term="è´ªå¿ƒ" />
        <updated>2025-07-12T07:36:52.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250709/</id>
        <title>ç»ƒä¹  - DP å‡¸ä¼˜åŒ–</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250709/"/>
        <content type="html">&lt;p&gt;Stewartâ€™s theoremï¼šåœ¨çº¿æ®µ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸Šå–ä¸€ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\vec{AB}=\lambda \vec{AM}\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸Šæ–¹ä»»å–ä¸€ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt;ï¼Œåˆ™æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(PM^2=(1-\lambda) PA^2+\lambda PB^2-\lambda(1-\lambda) AB^2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-akvizna&#34;&gt;D. Akvizna&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6393/problem/4&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6393/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®åˆ°è¿™é‡Œåº”è¯¥å‘ç°äº†ï¼ŒWQS çš„å¥–åŠ±éƒ½ä»¥ä¸€æ¬¡é¡¹ç³»æ•°å‡ºç°ï¼ŒåŸå› ä¹Ÿå¾ˆæ˜¾ç„¶ï¼Œå¥–åŠ±çš„å¯¹è±¡æ˜¯ä¸€æ¬¡é¡¹ç³»æ•°å˜›ã€‚æ­¤å¤–ï¼ŒWQS å†…å±‚ DP æ•°ç»„çš„ç»´åº¦éƒ½åº”å’Œæ“ä½œæ¬¡æ•°æ— å…³ï¼Œè€Œ DP å€¼åº”ä¸ºæœ€å¤§æ”¶ç›Šã€‚è¿™ä¸ªä¹Ÿå¾ˆæ˜¾ç„¶ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ä¸€è½®æ¯”èµ›çš„æƒ©ç½šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(mid\)&lt;/span&gt; ç„¶åäºŒåˆ†ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{j}\)&lt;/span&gt; è¡¨ç¤ºå‰©ä½™äººæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ—¶çš„æœ€å¤§æ”¶ç›Šï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{j}=\max\limits_{k\ge j}\left\{f_k+\frac {k-j}k\right\}-mid\)&lt;/span&gt;ã€‚æœ€ååœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f_0\)&lt;/span&gt; å¤„æ‰¾ç­”æ¡ˆå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å‘ç°ä¸€ä¸ªå¾ˆå¯æ€•çš„é—®é¢˜ï¼Œå†…å±‚ DP å’‹å†™ã€‚å‘ç°æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\frac {k-j}k\)&lt;/span&gt; æ”¹å†™æˆ &lt;span class=&#34;math inline&#34;&gt;\(1-\frac jk\)&lt;/span&gt; åå‡ºç°äº¤å‰é¡¹ï¼Œè€ƒè™‘æ–œä¼˜ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;lt;b\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¼˜äº &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {f_a-f_b}{\frac 1a - \frac 1b} &amp;gt; j\)&lt;/span&gt;ã€‚ç»´æŠ¤å•å‡çš„æ–œç‡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;ç¬‘è¯ï¼šäºŒåˆ† 50 æ¬¡ä¸å¤Ÿï¼Œéœ€è¦ 60 æ¬¡ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    double l = 0., r = 1e5, mid;
    auto calc = [&amp;amp;](double mid) &amp;#123;
        std::vector&amp;lt;double&amp;gt; f(n + 1, -1e18);
        f[n] = 0.;
        int h = 1, t = 0;
        std::vector&amp;lt;int&amp;gt; q(n + 1), p(n + 1);
        q[++t] = n;
        // printf(&amp;quot;mid = %.3lf: \n&amp;quot;, mid);
        for (int i = n - 1; ~i; --i) &amp;#123;
            for (; h &amp;lt; t &amp;amp;&amp;amp; (f[q[h + 1]] - f[q[h]]) / (1. / q[h + 1] - 1. / q[h]) &amp;gt;= i; ++h);
            f[i] = f[q[h]] + 1. - i * 1.0 / q[h] - mid, p[i] = p[q[h]] + 1;
            // printf(&amp;quot;  %d: f = %.3lf, p = %d, q[h] = %d(%.3lf / %d)\n&amp;quot;, i, f[i], p[i], q[h], f[q[h]], p[q[h]]);
            if (i) &amp;#123;
                for (; h &amp;lt; t &amp;amp;&amp;amp; (f[i] - f[q[t]]) / (1. / i - 1. / q[t]) &amp;gt;= (f[q[t]] - f[q[t - 1]]) / (1. / q[t] - 1. / q[t - 1]); --t);
                q[++t] = i;
            &amp;#125;
        &amp;#125;
        // printf(&amp;quot;res = %.3lf\n&amp;quot;, f[0] + p[0] * mid);
        return std::make_pair(f[0], p[0]);
    &amp;#125;;
    // calc(0.);
    // return 0;
    double res(0.);
    for (int i = 1; i &amp;lt;= 60; ++i) &amp;#123;
        mid = (l + r) / 2.;
        auto t(calc(mid));
        if (t.second &amp;gt;= k)
            l = mid, res = t.first + k * mid;
        else
            r = mid;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(8) &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-poborcy-podatkowi&#34;&gt;E. Poborcy podatkowi&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6393/problem/5&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6393/problem/5&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,l}(i),l=0,1,2,3\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸ŠæŒ‚äº†é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; çš„åŠæ¡é“¾ï¼Œå…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¡æ•´é“¾çš„æœ€å¤§æ”¶ç›Šã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è§‚å¯Ÿåˆ°æ˜¯å‡¸çš„ã€‚é‚£ä¹ˆä¸éš¾å‘ç°éœ€è¦é—µå¯å¤«æ–¯åŸºå’Œï¼Œè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä½ç½®ä¸Šçš„åˆå¹¶ã€‚&lt;strong&gt;é¦–å…ˆéœ€è¦æ³¨æ„åˆ°å„¿å­ä¸Šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; çš„é“¾åˆ°çˆ¶äº²ä¸Šä¼šå˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(l+1\)&lt;/span&gt;&lt;/strong&gt;ã€‚æ˜¾ç„¶æ¯æ¡å¯ä»¥ä¸é€‰ï¼›å¦‚æœé€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(cnt_a\)&lt;/span&gt; æ¡é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„åŠé“¾ï¼Œé‚£ä¹ˆåˆå¹¶å‡ºæ¥çš„ç»“æœæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(cnt_1-cnt_3\)&lt;/span&gt; æ¡é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; çš„é“¾ã€&lt;span class=&#34;math inline&#34;&gt;\(cnt_2\bmod 2\)&lt;/span&gt; æ¡é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; çš„é“¾ï¼Œå¹¶ä¸”è¦æ±‚ä¸¤è€…ä¸åŒæ—¶å‡ºç°ã€‚å‘ç°è¿™ä¸ªä¸œè¥¿åŸºæœ¬ä¸Šå¤„ç†ä¸äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€æ³¨æ„åˆ°è¿™ä¸ªå½¢å¼æœ‰ç‚¹åƒèƒŒåŒ…ã€‚ä½†æ€ä¹ˆå¤„ç† &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt; é…å¯¹çš„è¿™ä¸ªè¦æ±‚å‘¢ï¼Ÿæœ‰ä¸ªéå¸¸ç²¾å¦™çš„åœ¨ç‰©å“ä½“ç§¯ä¸Šåšæ–‡ç« çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ³¨æ„åˆ°æˆ‘ä»¬æœ€åçš„æŸ¥è¯¢çš„ç­”æ¡ˆè‚¯å®šè¦æ±‚æŠŠæ‰€æœ‰å„¿å­ç”¨å®Œã€‚é‚£ä¹ˆä¸å¦¨è®¾ä½“ç§¯ä¹‹å’Œä¸ºå„¿å­æ€»æ•° &lt;span class=&#34;math inline&#34;&gt;\(tot\)&lt;/span&gt;ã€‚æ¥ç€ï¼Œå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(cnt_0\)&lt;/span&gt;ï¼ˆåŒæ—¶ä¹Ÿæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(cnt_4\)&lt;/span&gt;ï¼‰æ²¡æœ‰é™åˆ¶ï¼Œç›´æ¥ä»¤å…¶ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(cnt_2\)&lt;/span&gt; å•ç‹¬å¤„ç†ï¼ˆç­‰ä¼šå„¿ä¼šè¯´ï¼‰ï¼Œä¸ºäº†ä¸å¯¹ç°åœ¨çš„é—®é¢˜äº§ç”Ÿå½±å“ä¹Ÿä»¤å…¶ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt;ï¼Œæ˜¾ç„¶ä¸¤è€…å¹³å‡ä½“ç§¯éœ€è¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼›ä½ å¯ä»¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt; ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±æœ‰ä¸ªå¾ˆå¥½çš„æ€§è´¨ï¼š&lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; å¿…é¡»å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt; é…å¯¹æ‰èƒ½è®©å¹³å‡ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(tot\)&lt;/span&gt; å¤„æŸ¥æ‰¾çš„ç­”æ¡ˆï¼Œç”± &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªä½“ç§¯ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ç‰©å“å’Œ &lt;span class=&#34;math inline&#34;&gt;\(tot-x\)&lt;/span&gt; ä¸ªä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ç‰©å“ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt;ï¼‰ç»„æˆï¼ŒåŸå› æ˜¯èƒŒåŒ…ä¼šè´ªå¿ƒåœ°åœ¨æ‰€æœ‰ã€å‰©ä½™ã€çš„åˆ†ç»„ä¸­é€‰æ‹©ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä¸€é¡¹ã€‚å†è®¡ç®—ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt;ï¼Œå‘ç°æ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(tot-x\)&lt;/span&gt;ã€‚ç¬¦åˆç›®çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(dp_{tot}\)&lt;/span&gt; å¤„æŸ¥æ‰¾å¯ä»¥æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(cnt_1=cnt_3\)&lt;/span&gt; æ—¶çš„ç­”æ¡ˆï¼›åŒç†ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(dp_{tot-1},dp_{tot1+1}\)&lt;/span&gt; å¤„å¯ä»¥æŸ¥æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(cnt_1=cnt_3\pm 1\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥å†è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(cnt_2\)&lt;/span&gt;ï¼Œè§£å†³ã€&lt;span class=&#34;math inline&#34;&gt;\(cnt\bmod2=1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\ne cnt_3\)&lt;/span&gt; ä¸èƒ½åŒæ—¶æˆç«‹ã€çš„é™åˆ¶ã€‚é‚£å¤ªå¥½äº†ï¼Œç›´æ¥å¤šå¼€ä¸€ç»´è®°å½• &lt;span class=&#34;math inline&#34;&gt;\(cnt_2\bmod 2\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å•Šå•Šå¤ªå¦™äº†ã€‚åƒåˆ©ç”¨ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1,1\)&lt;/span&gt; çš„éšæœºæ•°æ®èƒŒåŒ…æœŸæœ›æœ€å¤§ä½“ç§¯ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(\sqrt V\)&lt;/span&gt; çš„é‚£ä¸ªæ–¹æ³•ï¼Œæ˜¾ç„¶å°±æ²¡æœ‰åŠæ³•åˆ©ç”¨å‡¸æ€§äº†ã€‚æ‰€ä»¥è¿™æˆ–è®¸æ˜¯é—µå¯å¤«æ–¯åŸºå’Œåšæ³•çš„å”¯ä¸€è§£ï¼Ÿ&lt;/p&gt;
&lt;p&gt;éœ€è¦çŸ¥é“ï¼Œå¦‚æœè®¾ &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; è€Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œå§‹ç»ˆä¼šå‡ºä¸€äº›é—®é¢˜ã€‚è¿™ä¸ªæˆ‘å’Œ yly è®¨è®ºäº†ä¸€ä¸‹æ²¡å•¥ç»“æœã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e12;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;1.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y, w; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w;
        g[x].emplace_back(y, w), g[y].emplace_back(x, w);
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    std::vector&amp;lt;arr&amp;gt; f(n + 1, arr(4));
    struct node &amp;#123;
        std::vector&amp;lt;arr&amp;gt; f;
        node(): f(2) &amp;#123;&amp;#125;
        node(std::vector&amp;lt;arr&amp;gt; f1): f(f1) &amp;#123;&amp;#125;
        arr&amp;amp; operator[](int q) &amp;#123;
            return f[q];
        &amp;#125;
    &amp;#125;;
    auto getmax = [&amp;amp;](arr p, arr q) &amp;#123;
        arr res(p);
        if (q.size() &amp;gt; p.size())
            res.resize(q.size());
        for (int i = 0; i &amp;lt; (int)q.size(); ++i)
            res[i] = std::max(res[i], q[i]);
        return res;
    &amp;#125;;
    auto merge = [&amp;amp;](arr &amp;amp;p, arr &amp;amp;q) &amp;#123;
        arr res(p.size() + q.size() - 1), dp(p.size()), dq(q.size());
        std::adjacent_difference(p.begin(), p.end(), dp.begin());
        std::adjacent_difference(q.begin(), q.end(), dq.begin());
        std::merge(dp.begin() + 1, dp.end(), dq.begin() + 1, dq.end(), res.begin() + 1, std::greater&amp;lt;long long&amp;gt; ());
        res[0] = p[0] + q[0];
        std::partial_sum(res.begin(), res.end(), res.begin());
        return res;
    &amp;#125;; 
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        if ((int)g[x].size() == 1 &amp;amp;&amp;amp; x != 1) &amp;#123;
            f[x][1] = f[x][2] = f[x][3] = -inf;
            return;
        &amp;#125;
        int tot = (int)g[x].size() - (x != 1);
        std::vector&amp;lt;arr&amp;gt; w1(1), w2(1);
        for (auto [i, w] : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                w1.push_back(&amp;#123; f[i][0] + w, std::max(f[i][0], f[i][3] + w), f[i][2] + w &amp;#125;);
                w2.push_back(&amp;#123; -inf, f[i][1] + w &amp;#125;);
            &amp;#125;
        auto fun = [&amp;amp;](arr &amp;amp;p, arr &amp;amp;q) &amp;#123;
            arr res(p.size() + q.size() - 1, -inf);
            for (int ip = 0; ip &amp;lt; 2; ++ip)
                for (int iq = 0; iq &amp;lt; 2; ++iq) &amp;#123;
                    arr tp, tq;
                    for (int i = ip; i &amp;lt; (int)p.size(); i += 2)
                        tp.push_back(p[i]);
                    for (int i = iq; i &amp;lt; (int)q.size(); i += 2)
                        tq.push_back(q[i]);
                    auto t = merge(tp, tq);
                    for (int i = 0; i &amp;lt; (int)t.size(); ++i)
                        if (i * 2 + ip + iq &amp;lt; (int)res.size())
                            res[i * 2 + ip + iq] = std::max(res[i * 2 + ip + iq], t[i]);
                &amp;#125;
            return res;
        &amp;#125;; 
        std::function&amp;lt;node(int, int)&amp;gt; calc = [&amp;amp;](int l, int r) &amp;#123;
            if (l == r)
                return node(&amp;#123; w1[l], w2[l] &amp;#125;);
            int mid = (l + r) &amp;gt;&amp;gt; 1;
            node t1(calc(l, mid)), t2(calc(mid + 1, r));
            return node(&amp;#123; getmax(fun(t1[0], t2[0]), fun(t1[1], t2[1])),
                          getmax(fun(t1[0], t2[1]), fun(t1[1], t2[0])) &amp;#125;);
        &amp;#125;;
        auto t(calc(1, tot));
        f[x][0] = t[0][tot], f[x][1] = t[0][tot - 1], f[x][2] = t[1][tot], f[x][3] = t[0][tot + 1];
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; f[1][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="DP ä¼˜åŒ–" />
        <updated>2025-07-09T13:59:41.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250707-1/</id>
        <title>å†³ç­–å•è°ƒæ€§</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250707-1/"/>
        <content type="html">&lt;p&gt;ç­‰å’Œçº¿ï¼šåœ¨çº¿æ®µ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸Šå–ä¸€ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\vec{AB}=\lambda \vec{AM}\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸Šæ–¹ä»»å–ä¸€ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt;ï¼Œåˆ™æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\vec{PM}=(1-\lambda) \vec{PA}+\lambda \vec{PB}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-xdyd-dp&#34;&gt;ä»€ä¹ˆæ˜¯ xD/yD DP&lt;/h2&gt;
&lt;p&gt;å³ DP æ•°ç»„å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç»´ï¼Œä¸€æ¬¡è½¬ç§»å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^y)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ä¸ºä»€ä¹ˆè¦ç»™ä¸€å¥è¯å•å¼€ä¸€ä¸ªæ ‡é¢˜&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è®¾é€šå¼ &lt;span class=&#34;math inline&#34;&gt;\(f_i=\max\left\{f_j+w(i,j)\right\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–-dp&#34;&gt;å•è°ƒé˜Ÿåˆ—ä¼˜åŒ– DP&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; ä»…åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; çš„æœ€é«˜ä¸€æ¬¡é¡¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœè¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(j\in [1,i]\)&lt;/span&gt;ï¼Œå‰ç¼€æœ€å°å€¼å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å–å€¼èŒƒå›´åœ¨åˆ°å¤„ä¹±åŠ¨ï¼Œå¯ä»¥å†™ DS =_=&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å–å€¼èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; éšç€ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¢å¤§è€Œ &lt;span class=&#34;math inline&#34;&gt;\(l,r\)&lt;/span&gt; éƒ½ä¸å‡å°ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;é¡ºå¸¦ä¸€æï¼Œå’Œè¿™ç§çš„å•è°ƒé˜Ÿåˆ—ç”¨æ³•ç›¸ä¼¼çš„ã€å•è°ƒæ ˆã€ä¸»è¦åœ¨æ–œä¼˜é‡Œå‡ºç°ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…·ä½“è¿‡ç¨‹è¢« grizzly bear åƒæ‰äº† &lt;img src=&#34;/em/eat.gif&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¾‹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…&#34;&gt;ä¾‹ï¼šå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…&lt;/h3&gt;
&lt;p&gt;æœ´ç´ çš„å¤šé‡èƒŒåŒ…å¼å­æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\max\left\{f_{i-1,j-k\times v_i}+k\times w_i\right\}\)&lt;/span&gt;ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å’Œæ•´ä¸ªå¼å­æ— å…³ï¼Œæ‰€ä»¥æ˜¯å…³äº &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„ 1D/1Dã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å¥—ç”¨å•è°ƒé˜Ÿåˆ—ï¼Œéœ€è¦æŠŠæŸ¥è¯¢çš„é¡¹å˜æˆè¿ç»­çš„ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(j-k\times v_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å…³äº &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; åŒä½™ï¼›ä¸”éšç€ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å¢å¤§ï¼ŒæŸ¥è¯¢çš„ä½ç½®ä¸æ–­ç§»åŠ¨ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt;ã€‚é‚£ä¹ˆä¸å¦¨æŠŠæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æŒ‰ç…§æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; çš„ä½™æ•°åˆ†å¼€åšã€‚å…·ä½“åœ°ï¼Œä¸å¦¨è®¾ &lt;span class=&#34;math inline&#34;&gt;\(j=a\times v_i+b\)&lt;/span&gt;ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(j-k\times v_i\)&lt;/span&gt; æ›¿æ¢ä¸ºä½™æ•°å†™æ³•ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{i,j}&amp;amp;=\max\{f_{i-1,x\times v_i+b}+(a-x)\times v_i\}\\
&amp;amp;=\max\{f_{i-1,x\times v_i+b}-x\times v_i\}+a\times v_i
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é™åˆ¶ &lt;span class=&#34;math inline&#34;&gt;\((a-x)\)&lt;/span&gt; çš„å–å€¼ä¸è¶…è¿‡ç‰©å“æ•°ï¼Œåœ¨ä¸åŒæ¨¡æ•°ä¸‹æŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä»å°åˆ°å¤§å°† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; è¿™ä¸€ç»´è¿›è¡Œå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å³å¯ã€‚å®¹æ˜“å‘ç°ä¼šä¸é‡ä¸æ¼æšä¸¾æ‰€æœ‰ä½“ç§¯ï¼›å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(nV)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;æ–œç‡ä¼˜åŒ–-dp&#34;&gt;æ–œç‡ä¼˜åŒ– DP&lt;/h2&gt;
&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; ç§å«æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; çš„äº¤å‰é¡¹ï¼Œå¯ä»¥è€ƒè™‘æ–œä¼˜ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“è¿‡ç¨‹ï¼Œï¼ˆå¦‚æœä½ æ„¿æ„ï¼‰ï¼Œå¯ä»¥çœ‹è¿™ç¯‡ &lt;a href=&#34;/20210214/&#34;&gt;å››å¹´åŠå‰çš„åšå®¢&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºç¬¦å·ç­‰é—®é¢˜ï¼Œåˆ†äº«ä¸€ä¸‹æˆ‘çš„åšæ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ï¼šé€‚ç”¨äºç¬¦å·å’Œå³ä¾§æ–œç‡è¦æ±‚å•è°ƒæ€§ç›¸åçš„æƒ…å†µã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼Œè®¨è®ºé˜Ÿå¤´ç»´æŠ¤ã€‚ä¸å¦¨å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸ºé˜Ÿå¤´ç¬¬äºŒä¸ªå…ƒç´ ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ä¸ºé˜Ÿå¤´ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœé˜Ÿå¤´ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; éœ€è¦è¢«å¼¹å‡ºï¼Œè¯´æ˜ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¼˜äº &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼›å‡è®¾å¼å­è¦æ±‚ maxï¼Œåˆ™ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; è½¬ç§»å¾—åˆ°çš„ç­”æ¡ˆ &amp;gt; ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; è½¬ç§»å¾—åˆ°çš„ç­”æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;åŒ–å¼å­ï¼Œæ³¨æ„ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;gt;b\)&lt;/span&gt;ï¼›ä¸”è´Ÿæ•°ä¹˜é™¤è¦å˜å·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æœ€åå¾—åˆ°çš„å¼å­ä¸­é—´çš„ä¸ç­‰å·å°±å†³å®šäº†éœ€è¦ç»´æŠ¤çš„æ–œç‡å•è°ƒæƒ…å†µã€‚ä»¥æ­¤å†³å®šé˜Ÿå°¾ç»´æŠ¤æ–¹å¼å³å¯ã€‚&lt;/p&gt;
&lt;strong&gt;æ³¨æ„è¿™ä¸ªå¼å­çš„ä¸ç­‰å·ä½“ç°çš„æ˜¯å¼¹å‡ºæ¡ä»¶ï¼›ä¿ç•™æ¡ä»¶å’Œå…¶ç›¸å&lt;/strong&gt; &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å•è°ƒæ ˆç»´æŠ¤ï¼šé€‚ç”¨äºç¬¦å·å’Œå³ä¾§æ–œç‡è¦æ±‚å•è°ƒæ€§ç›¸åŒçš„æƒ…å†µï¼›éœ€è¦æ¸…æ¥šï¼Œç»´æŠ¤åˆæ³•æ€§ã€ç»´æŠ¤å•è°ƒå’Œå–ç­”æ¡ˆéƒ½åœ¨æ ˆé¡¶è¿›è¡Œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼Œéƒ½çŸ¥é“è¦ç”¨å•è°ƒæ ˆäº†ï¼Œè¯´æ˜æ–œä¼˜å½¢å¼å·²ç»è¢«åŒ–å‡ºæ¥äº†ï¼›ä»¥æ­¤ç»´æŠ¤åˆæ³•æ€§å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;ç»´æŠ¤ä¸€ä¸ªä»åº•åˆ°é¡¶ï¼Œã€ä¼˜ã€å¾—è¶Šæ¥è¶Šå°çš„æ–œç‡åºåˆ—ã€‚æ‰¾åˆ°ä»æ›´ä¼˜åˆ°æ›´åŠ£çš„ä¸´ç•Œç‚¹ï¼Œæ›´æ–°ç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å•Šï¼Œæœç„¶é«˜ä¸­æ–‡åŒ–å­¦ç§‘æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ç®—æ˜¯æ˜ç™½ä¸ºä»€ä¹ˆæˆ‘å°å­¦ / åˆä¸­åŸºæœ¬æ²¡å¼„æ‡‚è¿‡æ–œä¼˜ï¼Œè€Œæ—è¾¹çš„å¤§ä½¬å·²ç»åœ¨ä¹±æ€äº† &lt;img src=&#34;/em/hsh.gif&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;ç°åœ¨å‡è®¾æ­£åœ¨ç»´æŠ¤ä¸€ä¸ªä¸Šå‡¸åŒ…ï¼Œå¯ä»¥è¿›è¡Œä¸€äº›æ€è€ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å¦‚æœæŸ¥è¯¢åŒºé—´ä¸å•å¢ï¼Ÿ&lt;/p&gt;
æä¸äº†å•Šè¿™ä¸ªã€‚åºŸäº†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŸ¥è¯¢çš„æ–œç‡ä¸å•å¢ï¼Ÿ&lt;/p&gt;
å†™ä¸ªäºŒåˆ† + å•è°ƒæ ˆã€‚å‚è§ &lt;a href=&#34;https://www.luogu.com.cn/problem/P5785&#34;&gt;ä»»åŠ¡å®‰æ’&lt;/a&gt;ã€&lt;a href=&#34;#ä¾‹traka&#34;&gt;TRAKA&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åŠ å…¥æ–œç‡çš„ä½ç½®ä¸å•å¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æè¶… / CDQ / å¹³è¡¡æ ‘ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–-dp&#34;&gt;å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ– DP&lt;/h2&gt;
&lt;h3 id=&#34;å…³äºå››è¾¹å½¢ä¸ç­‰å¼&#34;&gt;å…³äºå››è¾¹å½¢ä¸ç­‰å¼&lt;/h3&gt;
&lt;p&gt;å¯¹äºä»£ä»·çŸ©é˜µ &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; å’Œå®šä¹‰åŸŸå†… &lt;span class=&#34;math inline&#34;&gt;\(\forall\,a\le b\le c\le d\)&lt;/span&gt;ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(a,d)+w(b,c)\ge w(a,c)+w(b,d)\)&lt;/span&gt;ï¼Œè®¤ä¸º &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚ç®€è®°ä¸ºé‡å å¤§äºäº¤å‰ã€‚&lt;/p&gt;
&lt;p&gt;å‘½åæ¥æºæ˜¯å››è¾¹å½¢å¯¹è§’çº¿ä¹‹å’Œå¤§äºå¯¹è¾¹ä¹‹å’Œï¼›å°†æ’å¤§äºæ”¹ä¸ºæ’å°äºä¹Ÿèƒ½å¾—åˆ°ç›¸ä¼¼çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;å°±ä¼šå‘ç°å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å’Œæ–œä¼˜å…¶å®æ˜¯å››è¾¹å½¢ä¸ç­‰å¼çš„ç‰¹åŒ–ï¼Œå¯¼è‡´å®ƒä»¬å¯ä»¥å°‘ä¸€ä¸ª logã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æ€§è´¨&#34;&gt;æ€§è´¨&lt;/h3&gt;
&lt;p&gt;ç”¨äºè¯æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(c\le l\le r\)&lt;/span&gt;ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(l-c,r+c) + w(l,r)\le w(l-c,r)+ w(l,r+c)\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”¨äºé¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§è´¨ä¸€&lt;/strong&gt;ï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼ˆæˆ–å…¶åå¼ï¼‰ï¼Œé‚£ä¹ˆæœ€ä¼˜å†³ç­–ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœ‰å•è°ƒå…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§è´¨äºŒ&lt;/strong&gt;ï¼šå½“ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å˜åŒ–æ—¶ï¼Œæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¸¦æ¥è´¡çŒ®çš„ç›¸å¯¹å¤§å° rank ä¸å˜ã€‚äº¦ä½œï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(j_1\)&lt;/span&gt; ç›¸å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(j_2\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ›´ä¼˜ï¼Œå¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;#39;\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(j_1\)&lt;/span&gt; ç›¸å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(j_2\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;#39;\)&lt;/span&gt; æ›´ä¼˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;åœ¨ä¼˜åŒ–-dp-ä¹‹å‰&#34;&gt;åœ¨ä¼˜åŒ– DP ä¹‹å‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¦–å…ˆæˆ‘å¿…é¡»è¦æä¸€å˜´ã€‚ç”±äºæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦ã€å››è¾¹å½¢ä¸ç­‰å¼ã€æ˜¯åœ¨å››å¹´å‰ï¼Œçœ‹åˆ°ã€çŸ³å­åˆå¹¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; åšæ³•ã€æ—¶ã€‚ç„¶è€Œï¼Œè¿™ä¸€é¢˜çš„ DP æœ¬èº«æœ‰ä¸€ä¸ªç‰¹æ®Šæ€§è´¨ï¼Œå³è´¡çŒ®æ˜¯ä¸€ä¸ªä»¥å†³ç­–ç‚¹ä¸ºæå€¼çš„å‡¸å‡½æ•°ï¼›è¿™ç›´æ¥å¯¼è‡´æˆ‘è¯¯ä»¥ä¸ºè¿™æ˜¯å››è¾¹å½¢ä¸ç­‰å¼æœ¬èº«å¸¦æ¥çš„æ€§è´¨ï¼Œå¯¼è‡´æˆ‘åœ¨ç†è§£ä¸Šæµªè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚&lt;strong&gt;å››è¾¹å½¢ä¸ç­‰å¼å¸¦æ¥çš„æ€§è´¨ï¼Œåªæœ‰ä¸Šè¿°ä¸¤æ¡ï¼&lt;/strong&gt;&lt;/p&gt;
å½“ç„¶è¿™ä¹Ÿå‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æœä½ å‘ç°ã€è´¡çŒ®æ˜¯ä¸€ä¸ªä»¥å†³ç­–ç‚¹ä¸ºæå€¼çš„å‡¸å‡½æ•°ã€ï¼Œä½ å°±å¯ä»¥ç”¨ç±»ä¼¼çŸ³å­åˆå¹¶ä¸­çš„çº¿æ€§è½¬ç§»å®Œæˆé—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ã€æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€å¹¶ä¸èƒ½ç­‰ä»·äºã€å†³ç­–å•è°ƒæ€§ã€ã€‚å†³ç­–å•è°ƒæ€§å¹¶ä¸å…·å¤‡æ€§è´¨äºŒã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåªæ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œåªæœ‰æœ€ä¼˜å†³ç­–ç‚¹æ˜¯å•è°ƒçš„ï¼Œä½†è´¡çŒ®å‡½æ•°éšç€ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å˜åŒ–ï¼Œå…¶å½¢çŠ¶ä¼šæœ‰å¾ˆå¤§çš„å˜åŠ¨ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¼˜åŒ–-dpåˆ†æ²»&#34;&gt;ä¼˜åŒ– DPï¼šåˆ†æ²»&lt;/h3&gt;
&lt;p&gt;ä¸»è¦é€‚ç”¨äº &lt;span class=&#34;math inline&#34;&gt;\(f_{i}=g_j+w(j,i)\)&lt;/span&gt; çš„åœºæ™¯ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; æ˜¯ä¸ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ— å…³çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºåˆ†æ²»èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; å’Œå…¶å†³ç­–ç‚¹èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\([L_p,R_p]\)&lt;/span&gt;ï¼Œé¦–å…ˆæŠŠæš´åŠ› &lt;span class=&#34;math inline&#34;&gt;\(mid\)&lt;/span&gt; çš„å†³ç­–ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(p_{mid}\)&lt;/span&gt; æ‰¾å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\([l,mid)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((mid,R]\)&lt;/span&gt;ï¼Œåˆ†åˆ«åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([L_p,p_{mid}]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([p_{mid},R_p]\)&lt;/span&gt; é‡Œæ‰¾å†³ç­–ç‚¹ï¼ˆæ³¨æ„ä¸¤è¾¹éƒ½æ˜¯é—­çš„ï¼‰ã€‚é€’å½’åœ°åšã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™ä½ è‚¯å®šå°±ä¼šæ€€ç–‘äº†ï¼Œä¸»æ’­ä¸»æ’­ï¼Œè™½ç„¶ä½ çš„åŒºé—´æ¯æ¬¡åœ¨å‡åŠï¼Œä½†å†³ç­–ç‚¹èŒƒå›´å¹¶ä¸æ˜¯å‡åˆ†çš„ï¼Œè¿˜ä¼šè¢«å…±ç”¨ï¼Œå¤æ‚åº¦çœŸçš„å¯¹å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯¹çš„å…„å¼Ÿï¼Œå¯¹çš„ã€‚è§‚å¯Ÿæœç´¢æ ‘ï¼Œä½ ä¼šå‘ç°è™½ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(p_{mid}\)&lt;/span&gt; ä¼šè¢«ç»™ä¸¤ä¸ªå„¿å­å…±ç”¨ï¼Œä½†æ˜¯åœ¨ä»»ä½•ä¸€å±‚ä¸­ï¼Œè¢«é‡å¤ç»è¿‡çš„ç‚¹åªä¼šå‡ºç°åœ¨ä¸¤ä¸ªåŒºé—´çš„äº¤ç•Œå¤„ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯æ•´å±‚å¤§æ¦‚éå† &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; æ¬¡ã€‚æ˜¯ä¸æ˜¯å¾ˆå¯¹äº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;ä¾‹yet-another-minimization-problem&#34;&gt;ä¾‹ï¼šYet Another Minimization Problem&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/868/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/868/F&lt;/a&gt;&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;æˆ‘çš„å¤©å“ªï¼æ˜¯ç½•è§çš„å››çº§æ ‡é¢˜ï¼&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;ç¬‘ç‚¹è§£æï¼šè¿™ä¸ªäººå› ä¸ºæ‡’å¾—å†™ CSS æ‰€ä»¥åªå†™äº†ç»å¸¸ç”¨çš„ h2 å’Œ h3 çš„æ ·å¼ï¼Œç°åœ¨è¿«ä¸å¾—å·²ç”¨ h4 è¢«å€’é€¼å»å†™äº† h4 çš„ CSSã€‚&lt;/p&gt;
&lt;/details&gt;
&lt;p&gt;å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(k\le 20\)&lt;/span&gt;ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨å†™ WQS äºŒåˆ†ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ®µåˆ†åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¤„çš„ä»£ä»·ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\min\{f_{i-1,l}+w(l+1,j)\}\)&lt;/span&gt;ï¼Œåˆ†æ²»è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€å‘ç°é—®é¢˜ï¼š&lt;span class=&#34;math inline&#34;&gt;\(w(l+1,j)\)&lt;/span&gt; å¹¶ä¸èƒ½å¾ˆå¿«åœ°æ±‚å‡ºæ¥ï¼›ç„¶åæ³¨æ„åˆ°è¿™ä¸ªä»£ä»·çš„å½¢å¼å¾ˆè«é˜Ÿï¼ˆå…¶å®åœ¨çœ‹åˆ°è¿™ä¸ªé¢˜çš„æ—¶å€™å°±ä¼šæœ‰è«é˜Ÿçš„æƒ³æ³•ï¼‰ï¼Œè€ƒè™‘ä½¿ç”¨è«é˜Ÿç§»åŠ¨ç«¯ç‚¹çš„æ–¹å¼è§£å†³é—®é¢˜ã€‚ç”±äºåˆ†æ²»ä¸­æŸ¥è¯¢çš„åŒºé—´ä¸¤ç«¯å•å¢ï¼Œæ¯å±‚çš„æ€»ç§»åŠ¨æ¬¡æ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ï¼Œæ€»å¤æ‚åº¦å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(nk\log n)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e12;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;long long&amp;gt; cnt(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; p(k + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(k + 1, std::vector&amp;lt;long long&amp;gt; (n + 1, inf));
    auto w = [&amp;amp;](int l, int r) &amp;#123;
        static int L = 1, R = 0;
        static long long res = 0ll;
        for (; L &amp;gt; l; --L, res -= cnt[a[L]] * (cnt[a[L]] - 1) / 2, ++cnt[a[L]], res += cnt[a[L]] * (cnt[a[L]] - 1) / 2);
        for (; R &amp;gt; r; res -= cnt[a[R]] * (cnt[a[R]] - 1) / 2, --cnt[a[R]], res += cnt[a[R]] * (cnt[a[R]] - 1) / 2, --R);
        for (; R &amp;lt; r; ++R, res -= cnt[a[R]] * (cnt[a[R]] - 1) / 2, ++cnt[a[R]], res += cnt[a[R]] * (cnt[a[R]] - 1) / 2);
        for (; L &amp;lt; l; res -= cnt[a[L]] * (cnt[a[L]] - 1) / 2, --cnt[a[L]], res += cnt[a[L]] * (cnt[a[L]] - 1) / 2, ++L);
        return res;
    &amp;#125;;
    f[0][0] = 0ll;
    for (int t = 1; t &amp;lt;= k; ++t) &amp;#123;
        std::function&amp;lt;void(int, int, int, int)&amp;gt; calc = [&amp;amp;](int l, int r, int lp, int rp) &amp;#123;
            if (l &amp;gt; r)
                return;
            if (l == r) &amp;#123;
                for (int i = lp; i &amp;lt;= rp &amp;amp;&amp;amp; i &amp;lt; l; ++i)
                    if (f[t - 1][i] + w(i + 1, l) &amp;lt; f[t][l])
                        f[t][l] = f[t - 1][i] + w(i + 1, l), p[t][l] = i;
                return;
            &amp;#125;
            int mid = (l + r) &amp;gt;&amp;gt; 1;
            for (int i = lp; i &amp;lt;= rp &amp;amp;&amp;amp; i &amp;lt; mid; ++i)
                if (f[t - 1][i] + w(i + 1, mid) &amp;lt; f[t][mid])
                    f[t][mid] = f[t - 1][i] + w(i + 1, mid), p[t][mid] = i;
            calc(l, mid - 1, lp, p[t][mid]), calc(mid + 1, r, p[t][mid], rp);
            return;
        &amp;#125;;
        calc(1, n, 0, n - 1);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[k][n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¼˜åŒ–-dpå•è°ƒæ•°æ®ç»“æ„&#34;&gt;ä¼˜åŒ– DPï¼šå•è°ƒæ•°æ®ç»“æ„&lt;/h3&gt;
&lt;p&gt;æœ‰çš„æ—¶å€™ä¼šå‡ºç° &lt;span class=&#34;math inline&#34;&gt;\(f_{i}=f_{j}+w(j,i)\)&lt;/span&gt; çš„ç»“æ„ï¼Œä¹Ÿå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; çš„å–å€¼ä¸è‡ªå·±æœ‰å…³ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æƒ…å†µæˆ‘ä»¬é€šå¸¸é€‰æ‹©å¡«è¡¨æ³•ï¼Œæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; åæ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ˜¯å“ªäº›ç‚¹çš„æœ€ä¼˜å†³ç­–ï¼ˆé‚£ä¹ˆæ˜¾ç„¶è¿™äº›ç‚¹æ˜¯ä¸€æ®µè¿ç»­åŒºé—´ï¼‰ã€‚ç”¨ &lt;span class=&#34;math inline&#34;&gt;\((i,l_i,r_i)\)&lt;/span&gt; è¿™ä¸ªä¸‰å…ƒç»„è¡¨ç¤ºå½“å‰ç®—å‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç®¡è¾–çš„èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿç»“åˆæ€§è´¨äºŒï¼Œæ¯å½“æˆ‘ä»¬æ‰‹ä¸Šæ‹¿åˆ°ä¸€ä¸ªæ–°çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæ¨å‡ºæ¥å…¶ç®¡è¾–èŒƒå›´å³ç«¯ç‚¹å°±ä¼šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚æ¥ç€æƒ³åŠæ³•æ‰¾åˆ°å·¦ç«¯ç‚¹ï¼ŒåŒæ ·åˆ©ç”¨æ€§è´¨äºŒï¼ŒäºŒåˆ†å‡ºæœ€é å·¦çš„ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œæ»¡è¶³ä¹‹å‰ç®—å‡ºæ¥çš„å†³ç­–ç‚¹æ²¡æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¼˜ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\([j,n]\)&lt;/span&gt; å°±æ˜¯å½“å‰æ¡ä»¶ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ç®¡è¾–èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é˜Ÿåˆ—é‡ŒåŠ å…¥å½“å‰ç‰ˆæœ¬çš„æ•´ä¸ªä¸‰å…ƒç»„åºåˆ—å°±å¯ä»¥æ–¹ä¾¿åœ°å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚ä¸ºå¯»æ‰¾å½“å‰å…ƒç´ çš„ç­”æ¡ˆï¼Œéœ€è¦å°†é˜Ÿå¤´ä¸Šï¼Œç®¡è¾–èŒƒå›´å®Œå…¨æ—©äºå½“å‰å…ƒç´ çš„å¼¹å‡ºå»ã€‚ç”±äºç»´æŠ¤çš„è¿‡ç¨‹å’Œå•è°ƒé˜Ÿåˆ—å¾ˆåƒï¼Œæ‰€ä»¥ä¹Ÿæœ‰äººç›´æ¥æŠŠè¿™é‡Œçš„é˜Ÿåˆ—å«å•è°ƒé˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;è§†é¢˜ç›®ä¸åŒï¼Œä¹Ÿå¯èƒ½ç”¨åˆ°å•è°ƒæ ˆï¼Œä¹Ÿæœ‰å¯èƒ½ä¸ç”¨äºŒåˆ†ï¼ˆä¾‹å¦‚æ»¡è¶³å‰ä¸¤ç§ç‰¹åŒ–çš„æƒ…å†µï¼‰ã€‚goto &lt;a href=&#34;/20250715/#a---yakiniku-restaurants&#34;&gt;Yakiniku Restaurants&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;ä¾‹è¯—äººå°g&#34;&gt;ä¾‹ï¼šè¯—äººå°G&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P1912&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P1912&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;æˆ‘è§‰å¾—ç»™å‡ºå­—ç¬¦ä¸²å†…å®¹çš„å”¯ä¸€ä»·å€¼æ˜¯è®©å‡ºé¢˜äººæ¬£èµç™½æ—¥ä¾å±±å°½&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{j}\)&lt;/span&gt; ä¸ºæŸä¸€è¡Œåˆ†åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¥å¤„çš„ä»£ä»·ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{j}=\min\limits_{k&amp;lt;j}\left\{f_{k}+|(s_j-s_k+j-k-1)-L|^P\right\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘å•è°ƒé˜Ÿåˆ— + äºŒåˆ†äº†ã€‚éœ€è¦æ³¨æ„æ— ç©·å¤§ä¹‹é—´çš„å¤§å°æ¯”è¾ƒï¼Œæˆ‘å†™è¿™ä¸ªå†™çº¢æ¸©äº†ï¼Œç›´æ¥ç”¨æŒ‡æ•°é¡¹ç›¸å¯¹å¤§å°æ¥ä»£æ›¿äº†ï¼Œä¼¼ä¹å¯ä»¥è¿‡ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1000000000000000001ll;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;P1912_2.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, l, p;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; l &amp;gt;&amp;gt; p;
        long long to;
        switch (p) &amp;#123; // ä¼šæœ‰ç²¾åº¦é—®é¢˜
        case 1:
            to = 1e18;
            break;
        case 2:
            to = 1e9;
            break;
        case 3:
            to = 1e6;
            break;
        case 4:
            to = 31622;
            break;
        case 5:
            to = 3981;
            break;
        case 6:
            to = 1e3;
            break;
        case 7:
            to = 372;
            break;
        case 8:
            to = 177;
            break;
        case 9:
            to = 100;
            break;
        default:
            to = 63;
            break;
        &amp;#125;
        std::vector&amp;lt;int&amp;gt; s(n + 1);
        std::vector&amp;lt;std::string&amp;gt; a(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; a[i], s[i] = (int)a[i].length();
        std::partial_sum(s.begin() + 1, s.end(), s.begin() + 1);
        struct node &amp;#123; int i, l, r; &amp;#125;;
        std::vector&amp;lt;node&amp;gt; q(n + 1);
        int h = 0, t = -1;
        q[++t] = &amp;#123; 0, 1, n &amp;#125;;
        auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
            if (x &amp;gt; to)
                return inf;
            auto res(1ll);
            for (; y--; res *= x);
            return res;
        &amp;#125;;
        std::vector&amp;lt;int&amp;gt; pre(n + 1);
        std::vector&amp;lt;long long&amp;gt; f(n + 1);
        auto calc = [&amp;amp;](int k, int j) &amp;#123;
            return std::min(inf, f[k] + qkp(std::abs(s[j] - s[k] + j - k - 1 - l), p));
        &amp;#125;;
        auto less = [&amp;amp;](int k1, int j1, int k2, int j2) &amp;#123;
            auto t1(calc(k1, j1)), t2(calc(k2, j2));
            if (t1 == inf &amp;amp;&amp;amp; t2 == inf)
                return std::abs(s[j1] - s[k1] + j1 - k1 - 1 - l) &amp;lt; std::abs(s[j2] - s[k2] + j2 - k2 - 1 - l);
            return t1 &amp;lt; t2;
        &amp;#125;;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            for (; h &amp;lt;= t &amp;amp;&amp;amp; q[h].r &amp;lt; i; ++h);
            f[i] = calc(q[h].i, i), pre[i] = q[h].i;
            for (; h &amp;lt;= t &amp;amp;&amp;amp; q[t].l &amp;gt; i &amp;amp;&amp;amp; less(i, q[t].l, q[t].i, q[t].l); --t)
                q[t - 1].r = q[t].r;
            for (int l = std::max(q[t].l, i + 1), r = q[t].r, mid; l &amp;lt;= r; ) &amp;#123;
                mid = (l + r) &amp;gt;&amp;gt; 1;
                if (less(i, mid, q[t].i, mid))
                    r = q[t].r = mid - 1, q[t + 1] = &amp;#123; i, mid, n &amp;#125;;
                else
                    l = mid + 1;
            &amp;#125;
            if (q[t + 1].i == i)
                ++t;
        &amp;#125;
        if (f[n] &amp;gt;= inf)
            std::cout &amp;lt;&amp;lt; &amp;quot;Too hard to arrange&amp;quot; &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        else &amp;#123;
            std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            std::function&amp;lt;void(int)&amp;gt; print = [&amp;amp;](int x) &amp;#123;
                if (x == 0)
                    return;
                print(pre[x]);
                for (int i = pre[x] + 1; i &amp;lt;= x; ++i) &amp;#123;
                    std::cout &amp;lt;&amp;lt; a[i];
                    if (i != x)
                        std::cout &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
                &amp;#125;
                std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
                return;
            &amp;#125;;
            print(n);
        &amp;#125;
        std::cout &amp;lt;&amp;lt; &amp;quot;--------------------&amp;quot;;
        if (T)
            std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;éœ€è¦æ³¨æ„ï¼Œæœ¬é¢˜ä¹Ÿå¯ä»¥å†åŠ ä¸€ä¸ªã€æ°å¥½åˆ† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µã€çš„é™åˆ¶ï¼Œç›´æ¥åœ¨å¤–å±‚å¥—ä¸€ä¸ª WQS äºŒåˆ†å°±å¥½äº†ï¼Œå‚è§ &lt;a href=&#34;https://www.luogu.com.cn/problem/P6246&#34;&gt;é‚®å±€ åŠ å¼ºç‰ˆ åŠ å¼ºç‰ˆ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d1d-dp-ä¼˜åŒ–&#34;&gt;2D/1D DP ä¼˜åŒ–&lt;/h3&gt;
&lt;p&gt;è‹¥å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f(i,j)=\min\limits_{k&amp;lt;j} f(i-1,k)+w(k+1,j)\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(p(i,j)\)&lt;/span&gt; ä¸ºæœ€ä¼˜å†³ç­–ç‚¹ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(p(i,j)\le p(i,j+1)\le p(i+1,j+1)\)&lt;/span&gt;ï¼Œäº¦ä½œ &lt;span class=&#34;math inline&#34;&gt;\(p(i,j-1)\le p(i,j)\le p(i+1,j)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt; è§£å†³é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image.png&#34; /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å›ºå®šï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)\)&lt;/span&gt; ä¸ºå‡¸å‡½æ•°ã€‚ï¼ˆä¾‹ï¼šé‚®å±€ åŠ å¼ºç‰ˆ åŠ å¼ºç‰ˆï¼‰&lt;/p&gt;
&lt;p&gt;goto &lt;a href=&#34;/20250707/&#34;&gt;DP å‡¸ä¼˜åŒ–&lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
        <category term="DP" />
        <category term="DP ä¼˜åŒ–" />
        <updated>2025-07-07T13:23:01.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250707/</id>
        <title>DP å‡¸ä¼˜åŒ–</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250707/"/>
        <content type="html">&lt;p&gt;è¢œï¼Œè¿™ç¯‡æ–‡ç« ä¸€ä¸‹å­åˆ›å»ºäº†ä¸‰ä¸ªæ–° tagã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯å‡¸å‡½æ•°&#34;&gt;ä»€ä¹ˆæ˜¯å‡¸å‡½æ•°&lt;/h2&gt;
&lt;h3 id=&#34;å®šä¹‰&#34;&gt;å®šä¹‰&lt;/h3&gt;
&lt;p&gt;åœ¨ä¿¡æ¯å­¦ä¸­ç ”ç©¶çš„å‡¸å‡½æ•°å¤§æŠµæ˜¯åªåœ¨æ­£æ•´æ•°åŸŸä¸Šæœ‰å®šä¹‰çš„ï¼Œæ‰€ä»¥åªèƒ½ç›´æ¥æ‘’å¼ƒå¯¼å‡½æ•°çš„æ¦‚å¿µäº†ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥æ–œç‡é€’å¢ï¼Œæ¢è¨€ä¹‹ï¼Œå·®åˆ†æ•°ç»„é€’å¢ï¼Œè®¤ä¸ºå‡½æ•°æ˜¯å‡¸çš„ï¼ˆå¥½åç›´è§‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…çœ‹çœ‹ç¬¦å·åŒ–çš„å®šä¹‰ï¼šè‹¥å¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(\lambda\in[0,1]\)&lt;/span&gt;ï¼Œå‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; å‡æ»¡è¶³ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(\lambda x+(1-\lambda) y)\le \lambda f(x)+(1-\lambda) f(y).
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ–ç­‰ä»·åœ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(x)-f(x - 1)\le f(x + 1) - f(x)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè®¤ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ˜¯å‡¸å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºå‡¹å‡¸åœ¨æ€§è´¨ä¸Šæ²¡åŒºåˆ«ï¼Œæ‰€ä»¥ &lt;strong&gt;ä¸‹æ–‡æ–½è¡Œæš´æ”¿ï¼Œå°†å‡¹å‡½æ•°å’Œå‡¸å‡½æ•°ç»Ÿç§°ä¸ºå‡¸å‡½æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;åˆ¤å®š&#34;&gt;åˆ¤å®š&lt;/h3&gt;
&lt;p&gt;å¯¹äºå…·ä½“æƒ…å¢ƒä¸‹çš„é—®é¢˜ï¼Œæ€ä¹ˆåˆ¤æ–­ DP æ•°ç»„æ˜¯å¦å…³äºå…¶æŸä¸€ç»´ä¸ºå‡¸å‡½æ•°ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›¸ä¿¡ç›¸ä¿¡çš„åŠ›é‡ï¼ˆæœ€å¸¸ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äºåˆ†æ®µé—®é¢˜ï¼Œè¯æ˜åˆ†å‡ºæ¥çš„æ¯ä¸€æ®µæ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚&lt;/p&gt;
&lt;em&gt;å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ•°å­¦ä¸Šä¸è®¤ä¸ºæ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼èƒ½å¤Ÿæ¨å‡ºå‡½æ•°ä¸ºå‡¸ã€‚ä½†è¿™æ˜¯ä¿¡æ¯å­¦.jpg&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å…¶ç”±ä¸¤ä¸ªå‡¸å‡½æ•°çº¿æ€§ç›¸åŠ å¾—åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\forall\, \lambda,\mu\ge 0\)&lt;/span&gt; å’Œå‡¸å‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(f,g\)&lt;/span&gt;ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(h=\lambda f+\mu g\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; ä¸ºå‡¸å‡½æ•°ã€‚&lt;/p&gt;
æ­¤å¤–ï¼Œæ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; çš„å·®åˆ†æ•°ç»„å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f,g\)&lt;/span&gt; å·®åˆ†æ•°ç»„ä¹Ÿæ»¡è¶³ä¸Šè¿°å…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;å…¶æ˜¯ä¸¤ä¸ªå‡¸å‡½æ•°çš„ &lt;a href=&#34;#é—µå¯å¤«æ–¯åŸºå’Œ&#34;&gt;é—µå¯å¤«æ–¯åŸºå’Œ&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å…¶ç”±ä¸¤ä¸ªå‡¸å‡½æ•°çº¿æ€§ max å¾—åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸¤ä¸ªå‡¸å‡½æ•°çš„çº¿æ€§ minï¼Œä¸€èˆ¬ä¸æ˜¯å‡¸å‡½æ•°ï¼Œç”šè‡³å¯èƒ½æ˜¯å‡¹çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æ€§è´¨&#34;&gt;æ€§è´¨&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœ€å€¼ä¸ºå”¯ä¸€æå€¼ã€‚&lt;/li&gt;
&lt;li&gt;æ–œç‡ / å·®åˆ†æ•°ç»„å…·æœ‰å•è°ƒæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨è§£é¢˜ä¸­ä¸»è¦ç”¨åˆ°çš„å¤§æ¦‚å°±æ˜¯ä¸Šé¢ä¸¤æ¡ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;wqs-äºŒåˆ†&#34;&gt;WQS äºŒåˆ†&lt;/h2&gt;
&lt;h3 id=&#34;ä¸»è¦ä»»åŠ¡&#34;&gt;ä¸»è¦ä»»åŠ¡&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¾‹ï¼šæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt; åˆ†ä¸ºæ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µï¼Œæ¯æ®µçš„ä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(sum^2+c\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸ºç»™å®šçš„å¸¸æ•°ï¼‰ï¼Œé—®æœ€å°ä»£ä»·ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5,a_i\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœå¯¹æ®µæ•°æ²¡æœ‰è¦æ±‚ï¼Œå¯ä»¥ç”¨æ–œä¼˜ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; åšã€‚&lt;/p&gt;
&lt;p&gt;åŠ ä¸Šäº† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„é™åˆ¶ï¼ŒDP å˜æˆäºŒç»´çš„ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„åˆ†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ®µï¼Œå¯ä»¥åœ¨ç¬¬ä¸€ç»´æ–œç‡ä¼˜åŒ–ï¼Œåšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(nk)\)&lt;/span&gt;ï¼›äº¦æˆ–å‘ç° &lt;span class=&#34;math inline&#34;&gt;\((i,j)\)&lt;/span&gt; æœ‰å†³ç­–å•è°ƒæ€§ï¼Œç„¶åå››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å…³äº &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; è¿™ä¸€ç»´æ˜¯å‡¸çš„ï¼ˆè€Œéä¸Šæ–‡çš„ &lt;span class=&#34;math inline&#34;&gt;\((i,j)\)&lt;/span&gt;ï¼‰ï¼Œæ•…å°† &lt;span class=&#34;math inline&#34;&gt;\(f(n,j)\)&lt;/span&gt; å…³äº &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å‡½æ•°æå–å‡ºæ¥ï¼ˆè®°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_n(j)\)&lt;/span&gt;ï¼‰ã€‚å‘ç°åªæœ‰æœ€é«˜ç‚¹æ˜¯å¯ä»¥ä¸€æ¬¡æ–œä¼˜å¿«é€Ÿæ±‚å‡ºæ¥çš„ï¼Œæ•…å¯ä»¥è®¤ä¸ºåœ¨å½“å‰å¤æ‚åº¦é™åˆ¶ä¸‹ï¼Œæ•´ä¸ªå‡½æ•°é™¤äº†æœ€é«˜ç‚¹ä»¥å¤–éƒ½æ˜¯æœªçŸ¥çš„ï¼ˆæ³¨æ„å¯ä»¥åœ¨ DP æ—¶è®°å½•æå€¼ç‚¹çš„æ¨ªåæ ‡ï¼Œå³åˆ†äº†å‡ æ®µï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç»™æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f_n(j)\)&lt;/span&gt; åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(\alpha\cdot j\)&lt;/span&gt;ï¼ˆåœ¨æœ¬é¢˜ä¸­å³å°† &lt;span class=&#34;math inline&#34;&gt;\(c\gets c+k\)&lt;/span&gt;ï¼‰ï¼Œå‹‰å¼ºå¯ä»¥è®¤ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\alpha\cdot j\)&lt;/span&gt; æ˜¯å‡¸çš„ï¼Œæ‰€ä»¥æ–°å‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;_n(j)\)&lt;/span&gt; ä¹Ÿæ˜¯å‡¸çš„ã€‚è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(k&amp;gt;0\)&lt;/span&gt;ï¼Œå¯ä»¥æ„Ÿå—åˆ°æå€¼ç‚¹å‘å·¦åç§»ï¼Œä¸”éšç€ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å¢å¤§ï¼Œæå€¼ç‚¹ä¸ä¼šå³ç§»ï¼›&lt;span class=&#34;math inline&#34;&gt;\(k&amp;lt;0\)&lt;/span&gt; æ—¶åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;ç»“åˆå‡ ä½•è§‚ç‚¹ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f_n\)&lt;/span&gt; ä¸Šçš„æå€¼ç‚¹å¯ä»¥ç”¨æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ç›´çº¿åˆ‡åˆ°ï¼›è€ŒåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(\alpha\cdot j\)&lt;/span&gt; çš„è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯åˆ‡çº¿æ–œç‡å‡å» &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; çš„è¿‡ç¨‹ã€‚ç›¸å½“äºä»¤åˆ‡çº¿æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-\alpha\)&lt;/span&gt;ï¼Œçœ‹çœ‹èƒ½åˆ‡åˆ°å“ªé‡Œã€‚&lt;/p&gt;
&lt;p&gt;æ•…å¯ä»¥äºŒåˆ†ä¸€ä¸ªåˆé€‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œä½¿å¾—æå€¼ç‚¹çš„æ¨ªåæ ‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚æ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;_n(k)-\alpha\cdot k\)&lt;/span&gt; å³ä¸ºå¾…æ±‚ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;WQS äºŒåˆ†å‚ä¸çš„é—®é¢˜ä¸€èˆ¬ä»¥å¦‚ä¸‹å½¢å¼å‘ˆç°ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šåºåˆ—ï¼Œå°†å…¶æ°å¥½åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µ / æ°å¥½é€‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªï¼Œæ±‚æœ€å¤§ / æœ€å°ä»£ä»·ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¢˜ç›®è¦æ±‚æœ€å¤§ / æœ€å°å€¼ä¸€èˆ¬èƒ½å¤Ÿåæ˜ å‡½æ•°çš„å‡¹å‡¸æ€§ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸€ç‚¹æ¥çŒœã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ç»†èŠ‚å¤„ç†&#34;&gt;ç»†èŠ‚å¤„ç†&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘å¦‚ä¸‹å‡¸å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;1.png&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¾ç„¶å¯¹äºã€å‡¸å‡ºæ¥ã€çš„ç‚¹ï¼ˆå³å›¾ä¸­é™¤äº† &lt;span class=&#34;math inline&#34;&gt;\(E,H\)&lt;/span&gt; ä»¥å¤–çš„ç‚¹ï¼‰ï¼Œèƒ½åˆ‡åˆ°çš„ç›´çº¿æ–œç‡ä¸ºä¸€ä¸ªèŒƒå›´ï¼›è€Œä½äºç›´çº¿ä¸Šçš„ç‚¹ï¼ˆé€”ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(E,H\)&lt;/span&gt;ï¼‰ï¼Œèƒ½åˆ‡åˆ°çš„ç›´çº¿æ–œç‡æ›´æ˜¯å®šæ­»äº†ã€‚æ‰€ä»¥è¿™è¦æ±‚ä½ çš„äºŒåˆ†ç²¾åº¦éœ€è¦ç•¥é«˜ä¸€ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(E\)&lt;/span&gt;ï¼ˆæˆ– &lt;span class=&#34;math inline&#34;&gt;\(H\)&lt;/span&gt;ï¼‰ï¼Œä¸èƒ½æ‰¾åˆ°åªè¿‡å®ƒä¸€ç‚¹çš„åˆ‡çº¿ã€‚æ ¹æ® DP çš„å†™æ³•ï¼Œè®°å½•çš„æ¨ªåæ ‡å¯èƒ½æ˜¯æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(D\)&lt;/span&gt;ï¼Œä¹Ÿå¯èƒ½æ˜¯æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(F\)&lt;/span&gt;ï¼Œæ­¤æ—¶ä½ å¯ä»¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŒæ—¶è®°å½•æœ€å°å’Œæœ€å¤§çš„æ¨ªåæ ‡ï¼Œçœ‹çœ‹ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; åœ¨ä¸åœ¨ä¸­é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é¢˜ç›®è¦æ±‚æœ€å¤§ä»£ä»·æ—¶ï¼Œè®°å½•æœ€å¤§æ¨ªåæ ‡ï¼ŒäºŒåˆ†åˆ°ä¸€ä¸ªæå€¼ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(k&amp;#39;\ge k\)&lt;/span&gt; æ—¶ï¼Œæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(\alpha&amp;#39;\ge \alpha\)&lt;/span&gt;ï¼Œç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;_n(k&amp;#39;)-\alpha&amp;#39;\cdot k\)&lt;/span&gt; æ›´æ–°ç­”æ¡ˆï¼ˆæ˜¯èµ‹å€¼è€Œä¸æ˜¯å–æœ€å€¼ï¼‰ï¼›æ±‚æœ€å°ä»£ä»·æ—¶åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦æ˜¯éœ€è¦è®°ä½æ–œç‡æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; çš„ç›¸åæ•°ï¼Œ&lt;del&gt;å®åœ¨æä¸æ¸…å¯¹åº”å…³ç³»å¯ä»¥éƒ½è¯•ä¸€è¯•&lt;/del&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹ç§æ ‘&#34;&gt;ä¾‹ï¼šç§æ ‘&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P1484&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P1484&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå‡½æ•°æ˜¯å‡¸çš„â€”â€”æ„Ÿæ€§ç†è§£å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€ï¼Œè¦æ±‚çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\le k\)&lt;/span&gt; æ—¶çš„æœ€å€¼ã€‚åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ˜¯å¦å³äºåŸå‡½æ•°æå€¼ç‚¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å³äºåŸå‡½æ•°æå€¼ç‚¹ï¼Œåˆ™åŸå‡½æ•°æå€¼ç‚¹ä¸ºç­”æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¥½æ¶ˆæ¯æ˜¯æ•´æ•°åŸŸä¸Šä¸€å®šæœ‰è§£ï¼ˆæœ€åç­”æ¡ˆä¸ºæ•´ã€å€’æ¨å³å¯ï¼‰ï¼Œæ‰€ä»¥ä¸ç”¨æ‰“æµ®ç‚¹æ•°äºŒåˆ†äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int lim = 1e6;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    auto calc = [&amp;amp;](int c) &amp;#123;
        std::vector&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; f(n + 1);
        auto mx = f.front();
        auto upd = [&amp;amp;](auto &amp;amp;x, auto y) &amp;#123;
            if (y.first &amp;gt; x.first || (y.first == x.first &amp;amp;&amp;amp; y.second &amp;lt; x.second))
                x = y;
            return;
        &amp;#125;;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            f[i].first = mx.first + a[i] + c;
            f[i].second = mx.second + 1;
            upd(mx, f[i - 1]);
        &amp;#125;
        upd(mx, f[n]);
        return mx;
    &amp;#125;;
    auto t(calc(0));
    if (t.second &amp;lt;= k) &amp;#123;
        std::cout &amp;lt;&amp;lt; t.first &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    auto res(-inf);
    for (int l = -lim, r = lim, mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        auto t = calc(mid);
        if (t.second &amp;lt;= k)
            res = t.first - (long long)mid * k, l = mid + 1;
        else
            r = mid - 1;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹raper&#34;&gt;ä¾‹ï¼šRaper&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4694&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4694&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™æ‰€æœ‰å…‰ç›˜é™„ä¸€ä¸ªå¥–åŠ± &lt;span class=&#34;math inline&#34;&gt;\(mid\)&lt;/span&gt;ï¼Œè¿›è¡Œ WQS äºŒåˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå†…å±‚å°±å’Œ &lt;a href=&#34;#ä¾‹åºåˆ—-sequence&#34;&gt;sequence&lt;/a&gt; å·®å¾—ä¸æ˜¯ç‰¹åˆ«å¤šï¼Œæ‰€ä»¥è€ƒè™‘åæ‚”è´ªå¿ƒã€‚ï¼ˆï¼Ÿï¼‰&lt;/p&gt;
&lt;p&gt;æŠŠè·¯è¿‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(-a_j\)&lt;/span&gt; ä¸¢åˆ°å¤§æ ¹å †é‡Œï¼Œå°è¯•å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b_i\)&lt;/span&gt; é…å¯¹ã€‚å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(mid-a_i-b_i\ge 0\)&lt;/span&gt; é‚£ä¹ˆæš‚æ—¶é…å¯¹ï¼Œé¡ºä¾¿æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(b_i-mid\)&lt;/span&gt; ä¸¢è¿›å»ç”¨äºåæ‚”ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(b_{i&amp;#39;}\)&lt;/span&gt; é€‰ä¸­äº† &lt;span class=&#34;math inline&#34;&gt;\(b_i-mid\)&lt;/span&gt; è¯´æ˜åæ‚”ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(b_{i&amp;#39;}\)&lt;/span&gt; é…å¯¹ã€‚&lt;/p&gt;
&lt;p&gt;è´ªå¿ƒçš„æ—¶å€™éœ€è¦è®°å½•å·²ç»é…çš„å¯¹æ•°ï¼Œä¼˜å…ˆé˜Ÿåˆ—ä¸­éœ€è¦å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(-a_j\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b_i-mid\)&lt;/span&gt; æ‰“æ ‡è®°è¿›è¡ŒåŒºåˆ†ï¼ŒåŒ¹é…åˆ°å‰è€…æ—¶æ‰å¢åŠ æˆåŠŸå¯¹æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æ•´æ•°åŸŸä¸Šä»ç„¶å¿…æœ‰è§£ï¼ˆç­”æ¡ˆä¸ºæ•´ï¼Œå€’æ¨ï¼‰ï¼Œä¸ç”¨æ‰“æµ®ç‚¹æ•°äºŒåˆ† neiher.&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 2e9 + 5;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1), b(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; b[i];
    auto calc = [&amp;amp;](long long mid) &amp;#123;
        std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; q;
        int cnt = 0;
        auto res(0ll);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            q.emplace(-a[i], 1);
            auto [v, ty] = q.top();
            if (mid + v - b[i] &amp;gt;= 0) &amp;#123;
                q.pop(), cnt += ty;
                res += mid + v - b[i], q.emplace(b[i] - mid, 0);
            &amp;#125;
        &amp;#125;
        return std::make_pair(cnt, res);
    &amp;#125;;
    auto res(inf);
    for (long long l = 1ll, r = inf, mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        auto t(calc(mid));
        if (t.first &amp;gt;= k)
            r = mid - 1, res = -(t.second - k * mid);
        else
            l = mid + 1;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;åŒºé—´åˆ†æ‹†é—®é¢˜&#34;&gt;åŒºé—´åˆ†æ‹†é—®é¢˜&lt;/h3&gt;
&lt;p&gt;ç›®æ ‡ï¼šå°è¯•å°† &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt; åˆ†å‰²æˆæ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\([i,j]\)&lt;/span&gt; ä½œä¸ºä¸€æ®µçš„ä»£ä»·ï¼Œæ±‚ä»£ä»·æœ€å€¼ã€‚å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨è®¾æ±‚æœ€å°ä»£ä»·ã€‚å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(f(i,j)\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„åˆ†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ®µï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(i,j)=\min(f(i-1,p-1)+w(p,j)).
\]&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰å®šç†ï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f(i-1,j)\le f(i,j)\le f(i,j+1)\)&lt;/span&gt;ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å®šä¹‰å‡ºå‘å¾ˆå¥½æ„Ÿæ€§ç†è§£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥ä»è¿™ä¸€ç‚¹å‡ºå‘ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; è¿™ä¸€ç»´å°±å¯ä»¥è¢«æ‘Šæ‰ï¼Œåšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n(n+m))\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰å®šç†ï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(f_i(j)\)&lt;/span&gt; æ˜¯å‡¸å‡½æ•°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‚£å¾ˆå¥½äº†ã€‚ç›´æ¥å†²åˆº WQS å³å¯ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;é—µå¯å¤«æ–¯åŸºå’Œ&#34;&gt;é—µå¯å¤«æ–¯åŸºå’Œ&lt;/h2&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªå‡¸å‡½æ•°ï¼ˆå½“ç„¶æ˜¯æŒ‡ OI ä¸­é‚£ç§é•¿å¾—å¾ˆç›´çš„å‡½æ•°ï¼‰ï¼Œå°†å®ƒä»¬çš„ã€è¾¹ã€æ‹†ä¸‹æ¥è¿‡åï¼Œä»¥æŸç§æ–¹å¼æ‹¼åœ¨ä¸€èµ·ï¼Œä½¿å¾—æœ€åå¾—åˆ°ä¸€ä¸ªæ–°çš„å‡¸å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‰æ¯æ¡ã€è¾¹ã€çš„æ–œç‡å½’å¹¶ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°ï¼Œæ˜¾ç„¶ç­”æ¡ˆå­˜åœ¨ä¸”å”¯ä¸€ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºé—µå¯å¤«æ–¯åŸºå’Œã€‚å¯ä»¥å‘ç°è¿™æ˜¯ä¸€ç§æœ€å€¼ - åŠ å·ç§¯ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬è¦æ±‚çš„ DP æ•°ç»„æ˜¯ä¸¤ä¸ªå·²çŸ¥çš„å­æ•°ç»„ä»¥ç±»ä¼¼çš„æ–¹æ³•å·èµ·æ¥çš„ï¼Œæœ€åè¦æ±‚å®Œæ•´çš„ DP æ•°ç»„ï¼ˆè€Œé WQS ä¸­çš„å•ç‚¹å€¼ï¼‰ï¼Œå°±å¯ä»¥è€ƒè™‘é—µå¯å¤«æ–¯åŸºå’Œã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™ä¸ªç»“æ„æ˜¯å¾ˆé€‚åˆå½’å¹¶çš„ï¼Œä½¿ç”¨å½’å¹¶è¦æ±‚çŠ¶æ€ä¸­å«æœ‰ç‰ˆæœ¬ç»´ã€å› å˜é‡ç»´ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹its-mooin-time-p&#34;&gt;ä¾‹ï¼šIt&#39;s Mooin&#39; Time P&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11459&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11459&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(w_i\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\([i,i+L)\)&lt;/span&gt; æ”¹ä¸º &lt;code&gt;MOO&lt;/code&gt; çš„ä»£ä»·ï¼Œé—®é¢˜è½¬åŒ–ä¸ºé€‰å– &lt;span class=&#34;math inline&#34;&gt;\(1\sim \frac nL\)&lt;/span&gt; ä¸ªä¸é‡åŒºé—´çš„æœ€å°ä»£ä»·å’Œã€‚&lt;/p&gt;
&lt;p&gt;å°è¯•å½’å¹¶ï¼Œæ¯æ¬¡å°† &lt;span class=&#34;math inline&#34;&gt;\([l,mid]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((mid, r]\)&lt;/span&gt; å·èµ·æ¥ã€‚ä½†æ˜¯ä¼šæœ‰ä¸€ç‚¹é—®é¢˜ï¼šå¦‚æœæ°å¥½æœ‰åŒºé—´å¡åœ¨ä¸­é—´å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{l,r,0/1/2,0/1/2}(i)\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; å†…é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ª &lt;code&gt;MOO&lt;/code&gt;ï¼Œä¸”ä¸¤ä¾§æœ€è¿œçš„è¢«é€‰ç‚¹è·ç¦»ç«¯ç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1/\ge 2\)&lt;/span&gt; çš„ DP å€¼ã€‚ç„¶åå¯ä»¥è¿›è¡Œç›¸åº”çš„è®¨è®ºã€å¹³ç§»ã€é—µå¯å¤«æ–¯åŸºå’Œï¼Œæœ€åå°†æ‰€æœ‰æƒ…å†µçº¿æ€§å– max å¾—åˆ°è¿™ä¸€å±‚çš„ç­”æ¡ˆï¼Œå®¹æ˜“å‘ç°å¾—åˆ°çš„ç­”æ¡ˆä¹Ÿæ˜¯å‡¸çš„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int L;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; L &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    std::vector&amp;lt;char&amp;gt; t(n + 1);
    std::vector&amp;lt;long long&amp;gt; w(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n - L + 1; ++i) &amp;#123;
        w[i] = a[i] * (t[i] != &amp;#39;M&amp;#39;);
        for (int j = i + 1; j &amp;lt; i + L; ++j)
            w[i] += a[j] * (t[j] != &amp;#39;O&amp;#39;);
        // printf(&amp;quot;[%d, %d]: %lld\n&amp;quot;, i, i + L - 1, w[i]);
    &amp;#125;
    if (L == 1) &amp;#123;
        std::sort(w.begin() + 1, w.end());
        auto s(0ll);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            s += w[i];
            std::cout &amp;lt;&amp;lt; s &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
        return 0;
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    struct node &amp;#123;
        crr f;
        node(int len): f(L, brr(L, arr(len, inf))) &amp;#123;
            for (int i = 0; i &amp;lt; L; ++i)
                for (int j = 0; j &amp;lt; L; ++j)
                    f[i][j][0] = 0ll;
            return;
        &amp;#125;
        brr&amp;amp; operator[] (int q) &amp;#123; return f[q]; &amp;#125;
    &amp;#125;;
    auto upd = [&amp;amp;](arr &amp;amp;x, arr y) &amp;#123;
        if (x.size() &amp;lt; y.size())
            x.resize(y.size(), inf);
        for (int i = 0; i &amp;lt; (int)y.size(); ++i)
            x[i] = std::min(x[i], y[i]);
        return;
    &amp;#125;;
    auto merge = [&amp;amp;](arr l, arr r) &amp;#123;
        arr out((int)(l.size() + r.size()) - 1), dl(l.size()), dr(r.size());
        for (int i = 1; i &amp;lt; (int)l.size(); ++i)
            dl[i] = l[i] - l[i - 1];
        for (int i = 1; i &amp;lt; (int)r.size(); ++i)
            dr[i] = r[i] - r[i - 1];
        std::merge(dl.begin() + 1, dl.end(), dr.begin() + 1, dr.end(), out.begin() + 1);
        out[0] = l[0] + r[0];
        std::partial_sum(out.begin(), out.end(), out.begin());
        return out;
    &amp;#125;;
    std::function&amp;lt;node(int, int)&amp;gt; calc = [&amp;amp;](int l, int r) &amp;#123;
        if (r - l + 1 &amp;lt; 2 * L) &amp;#123;
            node res(1);
            for (int ll = 0; ll &amp;lt; L; ++ll)
                for (int rr = 0; rr &amp;lt; L; ++rr)
                    if (l + ll &amp;lt;= r - rr - L + 1) &amp;#123;
                        res[ll][rr].resize(2, inf);
                        for (int i = l + ll; i &amp;lt;= r - rr - L + 1; ++i)
                            res[ll][rr][1] = std::min(res[ll][rr][1], w[i]);
                        // printf(&amp;quot;[%d, %d]: (%d, %d) = %lld\n&amp;quot;, l, r, ll, rr, res[ll][rr][1]);
                    &amp;#125;
            // for (int i = 0; i &amp;lt; L; ++i)
            //     if (l + i + L - 1 &amp;lt;= r) &amp;#123;
            //         printf(&amp;quot;[%d, %d]: (%d, %d) = %lld\n&amp;quot;, l, r, i, r - (l + i + L - 1), w[l + i]);
            //         res[i][r - (l + i + L - 1)].emplace_back(w[l + i]);
            //     &amp;#125;
            return res;
        &amp;#125;   
        int mid = (l + r) &amp;gt;&amp;gt; 1;
        node tl(calc(l, mid)), tr(calc(mid + 1, r)), res((r - l + 1) / L + 1);
        for (int ll = 0; ll &amp;lt; L; ++ll)
            for (int rr = 0; rr &amp;lt; L; ++rr)
                res[ll][rr] = merge(tl[ll][0], tr[0][rr]);
        for (int ll = 0; ll &amp;lt; L; ++ll)
            for (int rr = 0; rr &amp;lt; L; ++rr)
                for (int i = 1; i &amp;lt; L &amp;amp;&amp;amp; i &amp;lt; mid; ++i)
                    upd(res[ll][rr], merge(merge(tl[ll][i], tr[L - i][rr]), &amp;#123; 0, w[mid - i + 1] &amp;#125;));
        for (int ll = 0; ll &amp;lt; L; ++ll)
            for (int rr = L - 1; rr; --rr)
                upd(res[ll][rr - 1], res[ll][rr]);
        for (int rr = 0; rr &amp;lt; L; ++rr)
            for (int ll = L - 1; ll; --ll)
                upd(res[ll - 1][rr], res[ll][rr]);
        // for (int i = 0; i &amp;lt; L; ++i)
        //     for (int j = 0; j &amp;lt; L; ++j) &amp;#123;
        //         printf(&amp;quot;  (%d, %d): &amp;quot;, i, j);
        //         for (auto p : res[i][j])
        //             printf(&amp;quot;%lld &amp;quot;, p);
        //         puts(&amp;quot;&amp;quot;);
        //     &amp;#125;
        return res;
    &amp;#125;;
    auto res(calc(1, n));
    for (int i = 1; i &amp;lt;= n / L; ++i)
        std::cout &amp;lt;&amp;lt; res[0][0][i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹å‡äºº&#34;&gt;ä¾‹ï¼šå‡äºº&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/problem/47728&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/problem/47728&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºå‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»„é€‰å®Œå äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½“ç§¯çš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\max\{f_{i-1,k}+a_{i,j-k}\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;è¢œï¼Œè¿™ä¸ªä¸œè¥¿å¥½å‡¸çš„æ ·å­ï¼å•Šï¼Ÿå±…ç„¶ä¸æ˜¯å‡¸çš„ï¼Ÿ&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œæœ‰ç»“è®ºï¼šè‹¥å¹²ä¸ªä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\sim 4\)&lt;/span&gt; çš„ç‰©å“åšèƒŒåŒ…ï¼Œå¯ä»¥å‡‘å‡ºå€¼åŸŸå†…ä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(24\)&lt;/span&gt; çš„å€æ•°ã€‚æ‰€ä»¥å…ˆæŠŠä½“ç§¯å…¨éƒ¨ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\sim 4\)&lt;/span&gt; çš„ç‰©å“ã€‚ç„¶åä¼šå‘ç°ä»–ä»¬æŒ‰ç…§æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(12\)&lt;/span&gt; çš„ä½™æ•°åˆ†åˆ«æ˜¯å‡¸çš„ã€‚&lt;/p&gt;
&lt;p&gt;èƒ½æ„Ÿå—åˆ°æ¶æ„äº†ã€‚ç„¶åå°±å¯ä»¥æšä¸¾ä½“ç§¯ï¼Œå†é—µå¯å¤«æ–¯åŸºå’Œäº†ã€‚åŒæ ·éœ€è¦åœ¨çŠ¶æ€ä¸­å¼•å…¥ä½œä¸ºç‰ˆæœ¬å·çš„ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; ç»´ï¼Œæ˜¾ç„¶å› å˜é‡æ˜¯ä½“ç§¯ã€ç‰ˆæœ¬å·æ˜¯ç»„æ•°ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;fake2.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; siz(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; siz[i], m += siz[i];
        a[i].resize(siz[i] + 1);
        for (int j = 1; j &amp;lt;= siz[i]; ++j)
            std::cin &amp;gt;&amp;gt; a[i][j];
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    struct node &amp;#123;
        std::vector&amp;lt;arr&amp;gt; f;
        node(): f(12) &amp;#123;&amp;#125;
        arr &amp;amp;operator[] (int q) &amp;#123;
            return f[q];
        &amp;#125;
    &amp;#125;;
    auto merge = [&amp;amp;](arr &amp;amp;p, arr &amp;amp;q) &amp;#123;
        arr res((int)(p.size() + q.size()) - 1), dp(p.size()), dq(q.size());
        std::adjacent_difference(p.begin(), p.end(), dp.begin());
        std::adjacent_difference(q.begin(), q.end(), dq.begin());
        std::merge(dp.begin() + 1, dp.end(), dq.begin() + 1, dq.end(), res.begin() + 1, std::greater&amp;lt;long long&amp;gt; ());
        res[0] = p[0] + q[0];
        std::partial_sum(res.begin(), res.end(), res.begin());
        return res;
    &amp;#125;;
    auto upd = [&amp;amp;](arr y, arr &amp;amp;x, int tag) &amp;#123;
        if (tag)
            y.insert(y.begin(), -inf);
        if (y.size() &amp;gt; x.size())
            x.resize(y.size(), -inf);
        for (int i = 0; i &amp;lt; (int)y.size(); ++i)
            x[i] = std::max(x[i], y[i]);
        return;
    &amp;#125;;
    std::function&amp;lt;node(int, int)&amp;gt; calc = [&amp;amp;](int l, int r) &amp;#123;
        if (l == r) &amp;#123;
            node res;
            for (int i = 1; i &amp;lt;= siz[l]; ++i)
                res[i - 1].push_back(a[l][i]);
            return res;
        &amp;#125;
        int mid = (l + r) &amp;gt;&amp;gt; 1;
        node tl(calc(l, mid)), tr(calc(mid + 1, r)), res;
        for (int p = 0; p &amp;lt; 12; ++p)
            for (int q = 0; q &amp;lt; 12; ++q)
                if (!tl[p].empty() &amp;amp;&amp;amp; !tr[q].empty())
                    upd(merge(tl[p], tr[q]), res[(p + q) % 12], p + q &amp;gt;= 12);
        return res;
    &amp;#125;;
    auto res(calc(1, n));
    for (int i = 0; i &amp;lt;= m - n; ++i)
        std::cout &amp;lt;&amp;lt; res[i % 12][i / 12] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;slope-trick&#34;&gt;slope trick&lt;/h2&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ª OI ä¸­çš„å‡¸å‡½æ•°ï¼Œå®ƒæ˜¯ç”±ä¸€äº›æ–œç‡å•è°ƒçš„çº¿æ®µæ‹¼æ¥æˆçš„å›¾å½¢ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå‘ç°å¯ä»¥ç”¨æ•´ä¸ªå‡½æ•°çš„å·¦ / å³ç«¯ç‚¹å€¼ï¼ˆæˆªè·ï¼‰å’Œ &lt;span class=&#34;math inline&#34;&gt;\((n-1)\)&lt;/span&gt; ä¸ªæ–œç‡ / å·®åˆ†ä¿¡æ¯æè¿°å‡½æ•°ã€‚è€Œè¿™æœ‰æ—¶æ¯”ç›´æ¥ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹å€¼æœ‰ç€æ›´ä¼˜ç¾çš„æ€§è´¨ï¼Œå”¤å…¶ä¸º slope trickã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå…³äºæ–œç‡åºåˆ—ï¼Œå¦‚æœå®šä¹‰åŸŸä¸å¤§ï¼Œå¯ä»¥ç›´æ¥ç»´æŠ¤ï¼›å¦‚æœå®ƒçš„å˜åŒ–æ¬¡æ•°ä¸å¤šï¼Œå¯ä»¥åˆ©ç”¨å®ƒçš„å•è°ƒæ€§è´¨ï¼Œç”¨å•è°ƒæ•°æ®ç»“æ„ç»´æŠ¤ï¼›å¦‚æœå®ƒçš„å€¼åŸŸå¾ˆå°ï¼Œå¯ä»¥ç›´æ¥ç»´æŠ¤æ‹ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„å‰ä¸¤ç§æ–¹æ³•ä¸€èˆ¬å…³æ³¨æ¨ªåæ ‡å¯¹åº”çš„å‡½æ•°å€¼ï¼Œæ‰€ä»¥è‡ªå˜é‡ä¸€èˆ¬æ˜¯å’Œæ“ä½œæ¬¡æ•°ä¸€ç±»æœ‰å…³çš„ï¼›è€Œè¿™é‡Œå…³æ³¨å‡½æ•°æœ€å€¼è€Œå¼±åŒ–äº†å…·ä½“æ¨ªåæ ‡ï¼Œæ“ä½œæ¬¡æ•°ä¸€èˆ¬ä¼šä½œä¸ºå¾…æœ€ä¼˜åŒ–çš„å› å˜é‡ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘æƒ³è¦å°†æ•°åˆ—é€šè¿‡è‹¥å¹²æ¬¡å•ç‚¹ä¿®æ”¹ä½¿åºåˆ—å•è°ƒï¼Œä½†ä¸å…³å¿ƒåºåˆ—æœ€ç»ˆå½¢æ€ï¼Œé—®æœ€å°æ“ä½œæ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘æƒ³è¦è®©æ ‘ä¸Šæ‰€æœ‰å¶å­åˆ°æ ¹çš„è·¯å¾„è¾¹æƒå’Œç›¸ç­‰ï¼Œä½†ä¸å…³å¿ƒè¿™ä¸ªå€¼æ˜¯å¤šå°‘ï¼Œé—®æœ€å°æ“ä½œæ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢ä¾æ¬¡è§£å†³ä¸Šè¿°é—®é¢˜ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹åºåˆ—-sequence&#34;&gt;ä¾‹ï¼šåºåˆ— sequence&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4597&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4597&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æš´åŠ›åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æœ€ç»ˆè¢«ä¿®æ”¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œå®¹æ˜“å†™å‡º DP å¼å­ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\min\limits_{k\le j}\{f_{i-1,k}\}+|a_i-j|\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±ä¼šå‘ç°å®ƒçš„å®šä¹‰åŸŸå®åœ¨æ˜¯å¤ªå¤§äº†ï¼é‚£å¦‚æœå…³æ³¨æ–œç‡çš„å˜åŒ–æƒ…å†µå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}(k)\)&lt;/span&gt; çš„æå€¼ç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt;ï¼Œåˆ†ç±»è®¨è®ºæ‹†ç»å¯¹å€¼å’Œ minï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j\le a_i\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=\min\limits_{k\le j}\{f_{i-1}(k)\}+a_i - j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j &amp;lt; k_m\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=f_{i-1}(j)+a_i-j\)&lt;/span&gt;ï¼Œæ–œç‡ç›¸å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}(j)\)&lt;/span&gt; æ•´ä½“å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;del&gt;æˆ‘å°±è¯´å¯¼æ•°æ²¡ç™½å­¦å§&lt;/del&gt;&lt;/li&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j \ge k_m\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=f_{i-1}(k_m)+a_i-j\)&lt;/span&gt;ï¼Œæ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j &amp;gt; a_i\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=\min\limits_{k\le j}\{f_{i-1}(k)\}+j-a_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j &amp;lt; k_m\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=f_{i-1}(j)+j-a_i\)&lt;/span&gt;ï¼Œæ–œç‡ç›¸å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}(j)\)&lt;/span&gt; æ•´ä½“åŠ  &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j\ge k_m\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j) = f_{i-1}(k_m)+j-a_i\)&lt;/span&gt;ï¼Œæ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœç°åœ¨æˆ‘ä»¬æä¸€ä¸ªæ”¯æŒåŒºé—´åŠ æ–œç‡ã€åŒºé—´æ¨å¹³æ–œç‡ä¸”ç»´æŠ¤åŒºé—´å‡½æ•°æœ€å€¼ç‚¹çš„æ•°æ®ç»“æ„ï¼Œé‚£å°±å¤ªé€†å¤©äº†ã€‚ä¸€ä¸ªç»å…¸çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨å †ç»´æŠ¤çº¿æ®µæ–œç‡çš„å·®åˆ†ï¼ˆä¹Ÿå°±æ˜¯å·®åˆ†çš„å·®åˆ†ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æ•´ä½“ä¿®æ”¹æ¬¡æ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ï¼Œä¸”å¦‚æœåªçœ‹æ¯” &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; æ›´å·¦çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼ˆæ›´é å³çš„å·²ç»ä¸æå€¼æ— å…³æ‰€ä»¥ä¸ç”¨ç»´æŠ¤ï¼‰ï¼Œé‚£ä¹ˆå°±åªéœ€è¦ç»´æŠ¤åŒºé—´å‡æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå°†ä¸€æ¬¡åŒºé—´å‰ç¼€å‡æ³•çœ‹ä½œä¸€æ¬¡å‰ç¼€å³ç«¯ç‚¹å…¥é˜Ÿï¼Œæ˜¾ç„¶å·¦ä¾§æŸç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å®é™…è¢«å‡æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å…¥é˜Ÿçš„æ¬¡æ•° + æ‰€æœ‰å³äº &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ç‚¹çš„å…ƒç´ çš„å…¥é˜Ÿæ¬¡æ•°ã€‚ç”¨å¤§æ ¹å †ç»´æŠ¤è¿™äº›å…ƒç´ ï¼Œå°±å¯ä»¥å¿«é€Ÿç»´æŠ¤æ•´ä¸ªæ–œç‡åºåˆ—ã€‚ä¾‹å¦‚ &lt;code&gt;3 2 2 1&lt;/code&gt;ï¼Œä»£è¡¨ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; å¤„æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; å¤„æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-3\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¤„æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-4\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(a_i\ge k_m\)&lt;/span&gt; æ—¶ï¼ˆå®¹æ˜“å‘ç°å®ƒä¼šæˆä¸ºæ–°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt;ï¼‰ï¼Œç›´æ¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åŠ å…¥å¤§æ ¹å †ï¼Œå°±å¯ä»¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\le a_i\)&lt;/span&gt; çš„æ‰€æœ‰ä½ç½®æ–œç‡å‡å» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
ä»€ä¹ˆä½ é—®åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¹‹é—´çš„æ¨å¹³æ€ä¹ˆåŠï¼Ÿç”±äºå”¯ä¸€å³äºå®ƒä»¬çš„æ‹ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å…¥äº†ä¸€æ¬¡é˜Ÿï¼Œæ‰€ä»¥ä¸­é—´çš„å…ƒç´ æ–œç‡è‡ªç„¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt; å•Šã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;lt;k_m\)&lt;/span&gt; æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä»¥å·¦çš„ä½ç½®æ–œç‡å‡å» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œç›´æ¥å°† &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å…¥é˜Ÿå³å¯ã€‚&lt;/li&gt;
&lt;li&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; ä¹‹é—´çš„ä½ç½®æ–œç‡åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å¼¹å‡ºï¼ˆå¤ªå¥½äº†å°±åœ¨é˜Ÿé¦–ï¼‰å†æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åŠ å…¥å³å¯ã€‚ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; æ˜¾ç„¶æ˜¯ä¸€ä¸ªæ‹ç‚¹ï¼Œæ‰€ä»¥åˆ é™¤ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å¹¶éè™šç©ºç´¢æ•Œï¼Œä½†æ³¨æ„ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å¯èƒ½ä¼šå˜åŒ–æˆå…¶åç»§ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶å®å°±ä¼šå‘ç°è¿˜æœ‰ä¸€äº›æœ‰è¶£çš„å°æ€§è´¨ï¼Œæ¯”å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; ä¸é˜Ÿé¦–ç­‰ä»·ï¼ˆç”¨äºå®ç°ï¼‰ï¼›&lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å³ä¾§æ–œç‡å…¨éƒ¨ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œä¹Ÿæ˜¯å”¯ä¸€å¯ä»¥å–åˆ°çš„æ­£æ–œç‡ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;è¢œå†™èµ·æ¥å¥½ç®€å•ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    long long res = 0ll;
    std::priority_queue&amp;lt;int&amp;gt; q;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        if (i == 1 || a[i] &amp;gt;= q.top())
            q.push(a[i]);
        else &amp;#123;
            res += q.top() - a[i];
            q.pop(), q.push(a[i]), q.push(a[i]);
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹çƒŸèŠ±è¡¨æ¼”&#34;&gt;ä¾‹ï¼šçƒŸèŠ±è¡¨æ¼”&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3642&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3642&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,d}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘ä¸­æ‰€æœ‰å¶å­è·æ ¹å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„æœ€å°ä»£ä»·ã€‚é‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{u,d}=\sum\limits_{(v, w)\in u}\min\limits_{0\le w&amp;#39;\le d}\{f_{v,d-w&amp;#39;}+|w-w&amp;#39;|\}.
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥å½’çº³è¯æ˜ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,d}\)&lt;/span&gt; ä¸ºå‡¸ï¼›å’Œä¸Šä¸€é¢˜ç›¸ä¼¼åœ°ï¼Œè€ƒè™‘ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_v\)&lt;/span&gt; çš„å †å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; çš„å †ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæœ€å¤–å±‚æ˜¯ä¸€ä¸ªçº¿æ€§åŠ ï¼Œè¿™å…¶å®å°±æ˜¯æŠŠå·®åˆ†æ•°ç»„ / æ–œç‡åŠ èµ·æ¥ï¼Œæ”¾åˆ°æˆ‘ä»¬è¿™ä¸ªå †é‡Œé¢å°±æ˜¯åˆå¹¶ä¸¤ä¸ªå †ã€‚è™½ç„¶ä½ å¯èƒ½å’Œæˆ‘ä¸€æ ·ä¸è®¤è¯†å¯å¹¶å †ï¼Œä½†æ˜¯ä½ å¯ä»¥å’Œæˆ‘ä¸€æ ·ä¸ä¼š pd_dsã€‚&lt;/p&gt;
&lt;p&gt;å†çœ‹å†…å±‚ï¼Œå‘ç°å’Œä¸Šä¸€é¢˜é•¿å¾—åƒä½†å…¶å®ä¸ä¸€æ ·ï¼Œå‘œå‘œå‘œã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(|w-w&amp;#39;|\)&lt;/span&gt; æ˜¯ä¸€ä¸ªå·¦å³æ–œç‡åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1,1\)&lt;/span&gt; çš„åˆ†æ®µå‡½æ•°ï¼Œè€Œå·¦è¾¹ç±»æ¯”å¯å¾—æ–œç‡æœ€å¤§ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±é—µå¯å¤«æ–¯åŸºå’Œï¼Œå†…å±‚å‡½æ•°æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;-1\)&lt;/span&gt; çš„éƒ¨åˆ†æ¥è‡ª &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d-w&amp;#39;}\)&lt;/span&gt;ï¼›&lt;span class=&#34;math inline&#34;&gt;\(=-1\)&lt;/span&gt; çš„éƒ¨åˆ†æ¥è‡ª &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d-w&amp;#39;}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(|w-w&amp;#39;|\)&lt;/span&gt; çš„å·¦åŠè¾¹ï¼ˆæ„Ÿè°¢ &lt;span class=&#34;math inline&#34;&gt;\(w&amp;#39;\)&lt;/span&gt; æ˜¯æœ‰ä¸‹ç¡®ç•Œçš„ï¼‰ï¼›&lt;span class=&#34;math inline&#34;&gt;\(=0\)&lt;/span&gt; çš„éƒ¨åˆ†æ¥è‡ª &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d-w&amp;#39;}\)&lt;/span&gt;ï¼›&lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;0\)&lt;/span&gt; çš„éƒ¨åˆ†æˆ‘ä»¬ä¸å…³å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆå‡½æ•°å›¾åƒçš„å˜åŒ–ï¼šæ°´å¹³éƒ¨åˆ†çš„å·¦ç«¯ç‚¹å³ç§»äº† &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt;ã€‚æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d}\)&lt;/span&gt; ä¸­çš„æ°´å¹³çº¿æ®µå’Œæ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„çº¿æ®µï¼Œä»¤å…¶åœ¨å †ä¸­çš„å€¼ &lt;span class=&#34;math inline&#34;&gt;\(+w\)&lt;/span&gt; å°±èƒ½è¾¾åˆ°å¹³ç§»çš„ç›®çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†éœ€è¦æ³¨æ„ï¼Œæ­¤æ—¶ä»ç„¶éœ€è¦ &lt;strong&gt;ä¿ç•™å†…å±‚å‡½æ•°ä¸­æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„éƒ¨åˆ†ï¼Œä½†æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;1\)&lt;/span&gt; çš„éƒ¨åˆ†è¢«åˆ é™¤&lt;/strong&gt;ã€‚åŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»å¯¹å€¼å‡½æ•°ä¸å†…å±‚å‡½æ•°å®šä¹‰åŸŸç›¸åŒï¼Œä½œé—µå¯å¤«æ–¯åŸºå’Œåï¼Œæ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„å³ä¾§çº¿æ®µä¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d-w&amp;#39;}\)&lt;/span&gt; ä¸­åŸæœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;1\)&lt;/span&gt; çš„éƒ¨åˆ†ã€æŒ¤ã€å‡ºå®šä¹‰åŸŸï¼Œæ•…å¯ä»¥å°†å…¶ç›´æ¥åˆ é™¤ã€‚&lt;/li&gt;
&lt;li&gt;æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„éƒ¨åˆ†ï¼Œè™½ç„¶å¯¹å†…å±‚å‡½æ•°ä¸­æå€¼ç‚¹æ— è´¡çŒ®ï¼Œä½†åœ¨å¤–å±‚å‡½æ•°ä¸­æå€¼ç‚¹å¯èƒ½å‘å³åç§»ï¼Œæ­¤æ—¶ä¼šå¯¹å…¶äº§ç”Ÿå½±å“ï¼Œéœ€è¦ç»´æŠ¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®¹æ˜“å‘ç°ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(w&amp;#39;\)&lt;/span&gt; çš„å–å€¼ä¸Šé™æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ï¼Œä½† &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; æ²¡æœ‰ä¸Šç•Œï¼Œæ‰€ä»¥æ¯ä¸ªå†…å±‚å‡½æ•°çš„å³ä¾§éƒ½ä¸€å®šæ˜¯ä¸€æ¡æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„å°„çº¿ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªå¤–å±‚å‡½æ•°ä¸€å®šæœ‰ï¼ˆå„¿å­ä¸ªæ•°ï¼‰ä¸ªæ‹ç‚¹ï¼ˆå †ä¸­å…ƒç´ ï¼‰ï¼Œå¼¹å‡ºè¿™ä¹ˆå¤šä¸ªå°±å¯ä»¥åˆ é™¤å¤–å±‚å‡½æ•°ä¸­æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;1\)&lt;/span&gt; çš„çº¿æ®µï¼Œé¡ºä¾¿æ‰¾åˆ°æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„çº¿æ®µã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
#include &amp;lt;ext/pb_ds/priority_queue.hpp&amp;gt;
const int inf= 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m, n += m;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    auto res(0ll);
    for (int i = 2, fa, w; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; fa &amp;gt;&amp;gt; w, res += w;
        g[fa].emplace_back(i, w);
    &amp;#125;
    std::vector&amp;lt;__gnu_pbds::priority_queue&amp;lt;long long&amp;gt; &amp;gt; q(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        if (g[x].empty())
            q[x].push(0), q[x].push(0);
        else
            for (auto [i, w] : g[x]) &amp;#123;
                DFS(i);
                for (int j = 1; j &amp;lt; (int)g[i].size(); ++j)
                    q[i].pop();
                long long t1 = q[i].top(), t0;
                q[i].pop(), t0 = q[i].top(), q[i].pop();
                q[i].push(t1 + w), q[i].push(t0 + w);
                q[x].join(q[i]);
            &amp;#125;
        // fprintf(stderr, &amp;quot;size(%d) = %d\n&amp;quot;, x, (int)q[x].size());
        return;
    &amp;#125;;
    DFS(1);
    for (int i = 1; i &amp;lt;= (int)g[1].size(); ++i)
        q[1].pop();
    for (; !q[1].empty(); q[1].pop())
        res -= q[1].top();
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹buy-low-sell-high&#34;&gt;ä¾‹ï¼šBuy Low Sell High&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/865/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/865/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤©ç»“æŸåæŒæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ”¯è‚¡ç¥¨çš„æœ€å¤§æ”¶ç›Šã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\max\{f_{i-1,j},f_{i-1,j-1}-a_i,f_{i-1,j+1}+a_i\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆç”±äºè¿™é‡Œå’Œ max æœ‰å…³æ‰€ä»¥éœ€è¦ç²¾ç»†æè¿°å‡¹å‡¸äº†ï¼‰å‘ç°å°±æ˜¯æŠŠä¸‰ä¸ªï¼ˆå¯èƒ½ï¼‰ç»è¿‡å¹³ç§»çš„ï¼ˆå¯èƒ½ï¼‰å‡¹çš„å‡½æ•°åšçº¿æ€§ maxã€‚è™½ç„¶å®é™…ä¸Šçš„ç»“è®ºã€å‡½æ•°åœ¨æ•´ç‚¹ä¸Šæ˜¯å‡¹çš„ã€ä¸ç®—å¤ªæ˜¾ç„¶ï¼Œä½†æ˜¯å¯ä»¥çŒœæ˜¯å‡¹çš„ã€‚&lt;/p&gt;
&lt;p&gt;çº¿æ€§ max åœ¨ slope trick ä¸­æ˜¯ä¸å¤ªèƒ½ä½“ç°çš„ï¼Œä½†æˆ‘ä»¬å‘ç°è¿™é‡Œæ˜¯åŒä¸€ä¸ªå‡¹å‡½æ•°å‘å·¦ä¸Šã€å³ä¸‹å¹³ç§»åŒä¸€ä¸ªå‘é‡ï¼Œå¸Œæœ›å¾—åˆ°æ–°çš„å‡¹å‡½æ•°ä¸ç®¡æ˜¯ä»å·®åˆ†è§’åº¦è¿˜æ˜¯å›¾è±¡ï¼Œéƒ½èƒ½å¾—åˆ°æ–°å‡½æ•°ç”±å·¦ä¸Šéƒ¨åˆ†æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;-a_i\)&lt;/span&gt; çš„çº¿æ®µã€ä¸¤æ®µæ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(=-a_i\)&lt;/span&gt; çš„çº¿æ®µã€å³ä¸‹éƒ¨åˆ†æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;-a_i\)&lt;/span&gt; çš„çº¿æ®µç»„æˆã€‚æ­¤å¤–ï¼Œç”±äºå‘å·¦ä¸Šå¹³ç§»çš„å‡½æ•°æœ‰ä¸€å¤„ç¦»å¼€äº†å®šä¹‰åŸŸï¼Œè¿˜éœ€å°†å…¶å‰”é™¤ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(-a_i\)&lt;/span&gt; æ¯”æœ€å°æ–œç‡è¿˜è¦å°æ—¶ä¼šæœ‰å˜åŒ–ï¼Œå¯ä»¥ç”»å›¾çœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;2.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°å®šä¹‰åŸŸæ˜¯ç›¸å¯¹å°çš„ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(0\le j\le n\)&lt;/span&gt;ï¼‰ï¼Œæ•…ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤æ•´ä¸ªæ–œç‡åºåˆ—å°±å¯ä»¥å¿«é€Ÿæ’å…¥ä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k=-a_i\)&lt;/span&gt; çš„çº¿æ®µã€‚å®¹æ˜“å‘ç°é¡¶ç‚¹åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(j=0\)&lt;/span&gt; å¤„å–å¾—ï¼ˆä»å›¾è±¡å’Œå®šä¹‰éƒ½æ˜“çŸ¥ï¼‰ï¼Œæœ€å³ä¾§æ˜¯åªä¹°ä¸å–çš„æœ€åŠ£æ–¹æ¡ˆï¼Œå¯ä»¥å€’æ¨ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    auto res = 0ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], res -= a[i];
    std::priority_queue&amp;lt;int&amp;gt; q;
    q.push(-a[1]);
    for (int i = 2; i &amp;lt;= n; ++i)
        if (a[i] &amp;lt; -q.top())
            q.push(-a[i]);
        else
            q.pop(), q.push(-a[i]), q.push(-a[i]);
    for (; !q.empty(); res -= q.top(), q.pop());
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="åæ‚”è´ªå¿ƒ" />
        <category term="DP ä¼˜åŒ–" />
        <updated>2025-07-07T06:10:02.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250526/</id>
        <title>å¤šç»´ DP</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250526/"/>
        <content type="html">&lt;p&gt;ä¸Šæ¥¼å¬åˆ°æœ‰äººåœ¨å“¼ &lt;em&gt;Climbing on the Trees&lt;/em&gt;ï¼Œä¸Šæ¥å¬åˆ°éš”å£ç­åœ¨æ”¾ &lt;em&gt;Burn the House Down&lt;/em&gt;ï¼Œæœç„¶æ˜¥å¤©æ˜¯ AJR çš„å­£èŠ‚ï¼ˆï¼‰&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;p&gt;ä¸»è¦æ˜¯å¤šç»´ DP ç‰¹æœ‰çš„ä¼˜åŒ–ï¼&lt;/p&gt;
&lt;h2 id=&#34;åˆ†æ­¥è½¬ç§»&#34;&gt;åˆ†æ­¥è½¬ç§»&lt;/h2&gt;
&lt;p&gt;å¦‚æœçŠ¶æ€çš„è‹¥å¹²ç»´ä¹‹é—´åªå­˜åœ¨å¾ˆå¼±çš„è”ç³»ï¼Œå¯ä»¥åˆ†æ­¥è½¬ç§»æ¯ä¸€ç»´ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æœ‰äºŒç»´çŠ¶æ€è½¬ç§» &lt;span class=&#34;math inline&#34;&gt;\((a,b)\to (a&amp;#39;,b&amp;#39;)\)&lt;/span&gt;ï¼Œã€å¾ˆå¼±çš„è”ç³»ã€ä¸¾ä¾‹ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;DP å€¼ä¸­åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(w(a&amp;#39;,b&amp;#39;)\)&lt;/span&gt;ï¼Œä½†ä¸åŒ…å«è¯¸å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(w(a&amp;#39;,b),w(a,b&amp;#39;)\)&lt;/span&gt; ä¹‹ç±»ã€‚ä¹Ÿå³è¯¥å€¼çš„æ±‚è§£ä¸ä¾èµ–äºä¸Šä¸€ä¸ªçŠ¶æ€ã€ä¸ä¾èµ–äºè½¬ç§»ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\((a&amp;#39;,b&amp;#39;)\)&lt;/span&gt; çš„å–å€¼æœ‰é™åˆ¶ï¼Œæ¯”å¦‚ &lt;span class=&#34;math inline&#34;&gt;\((114,514)\)&lt;/span&gt; ä¸èƒ½å–åˆ°ä¹‹ç±»ã€‚æ˜¾ç„¶è¿™ä¹Ÿä¸ä¾èµ–äºä¸Šä¸€ä¸ªçŠ¶æ€ã€ä¸ä¾èµ–äºè½¬ç§»ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¦å·é™åˆ¶ï¼ˆå¦‚è½¬ç§»é—´ä¸º &lt;span class=&#34;math inline&#34;&gt;\(+\)&lt;/span&gt;ï¼ŒçŠ¶æ€é—´ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\times\)&lt;/span&gt; ä¹‹ç±»ï¼‰ï¼Œåœ¨è®¡æ•°ä¸­å¸¸å‡ºç°ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªå˜åŠ¨çš„æ—¶å€™å¦ä¸€ä¸ªå¿…é¡»ä¹Ÿä¸€èµ·åŠ¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ³¨æ„ï¼æœ‰çš„æ—¶å€™ä¸€ä¸ªçŠ¶æ€ä¹Ÿå¯ä»¥æ‹†æˆä¸¤ä¸ªçŠ¶æ€ï¼Œç„¶ååˆ†æ­¥è½¬ç§»ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜ç»å…¸é¢˜&#34;&gt;ä¾‹é¢˜ï¼šç»å…¸é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(w_{N\times M}\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\((A,B)_{1\sim K}\)&lt;/span&gt;ï¼Œæœ€å¤§åŒ– &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=1}^K w_{A_i,B_i}+w_{A_{i-1},A_i}+w_{B_{i-1},B_i}\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‘ç°å¦‚æœè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,a,b}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\((A,B)_i=(a,b)\)&lt;/span&gt; çš„è¯ï¼Œè½¬ç§»å°±ä¼šè¾¾åˆ°å¯è§‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(O(N\times M)\)&lt;/span&gt;ï¼›ä½†å‘ç°é‡Œé¢çš„ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; å…¶å®æ²¡ä»€ä¹ˆæœ‰æœºè”ç³»ï¼›å”¯ä¸€çš„è”ç³» &lt;span class=&#34;math inline&#34;&gt;\(w_{A_i,B_i}\)&lt;/span&gt;ï¼ˆä¸Šé¢ã€å¾ˆå¼±çš„è”ç³»ã€ä¸­çš„ç¬¬ä¸€ã€å››ç§æƒ…å†µï¼‰ã€‚å› æ­¤åˆ†å¸ƒè½¬ç§»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f&amp;#39;_{a&amp;#39;,b}\gets \max\limits_a f_{a,b}+w_{a&amp;#39;,a}\\
f_{a&amp;#39;,b&amp;#39;}\gets \max\limits_b f&amp;#39;_{a&amp;#39;, b} + w_{b,b&amp;#39;}+w_{a&amp;#39;,b&amp;#39;}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç”±æ­¤ä¾¿ä¼˜åŒ–è½¬ç§»å¤æ‚åº¦åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(N+M)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜å½©ç¯æ™šä¼š&#34;&gt;ä¾‹é¢˜ï¼šå½©ç¯æ™šä¼š&lt;/h3&gt;
&lt;p&gt;goto &lt;a href=&#34;/20250407/#e---kdoi-11å½©ç¯æ™šä¼š&#34;&gt;link&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Tipsï¼šå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(l_1,l_2\)&lt;/span&gt; ä¹‹é—´ä¹Ÿæ²¡å•¥æœ‰æœºè”ç³»ï¼ˆä¸Šé¢ã€å¾ˆå¼±çš„è”ç³»ã€ä¸­çš„ç¬¬ä¸‰ã€å››ç§æƒ…å†µï¼‰ï¼Œæ•…åˆ†æ­¥è½¬ç§»ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜åºåˆ—å¦™å¦™å€¼&#34;&gt;ä¾‹é¢˜ï¼šåºåˆ—å¦™å¦™å€¼&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://uoj.ac/problem/549&#34; class=&#34;uri&#34;&gt;https://uoj.ac/problem/549&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ´ç´ åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå¤„åˆ†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ®µçš„æœ€å¤§ä»·å€¼ï¼Œæ˜¾ç„¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(k\times n^2)\)&lt;/span&gt;ï¼Œä¸”å¹¶æ²¡æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ©ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å¾ˆå°è¿™ä¸€æ¡ä»¶ï¼Œå‘ç°ä¸Šä¸€æ¡æ— æ³•ä¼˜åŒ–æ˜¯å› ä¸ºè¦è·å– &lt;span class=&#34;math inline&#34;&gt;\(sum_{i}\)&lt;/span&gt; çš„å€¼ï¼›é‚£ä¹ˆæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(sum_i\)&lt;/span&gt; å¡åˆ°çŠ¶æ€é‡Œã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{s&amp;#39;,j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(sum=s&amp;#39;\)&lt;/span&gt; æ—¶ï¼Œåˆ†äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ®µçš„æœ€å¤§ä»·å€¼ã€‚åŒæ ·å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(k\cdot n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æœ‰ä¸¤ä¸ªç†è§£è¿™ä¸ªä¼˜åŒ–çš„è§’åº¦ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;p&gt;ä»å¹³è¡¡è§’åº¦ï¼ŒåŸé—®é¢˜ç­‰ä»·äº &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\((s,j)\)&lt;/span&gt; å¤„çš„æœ€å¤§å€¼ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(v)\)&lt;/span&gt; æŸ¥æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(j-1\)&lt;/span&gt; å¤„çš„æœ€å¤§å€¼ï¼›æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; æ‹†æˆå‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ã€å &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ä¸¤ä¸ª partï¼Œå½“æ›´æ–°&lt;/p&gt;
&lt;p&gt;å¯¹äºä¿®æ”¹ï¼šç›¸å½“äºå›ºå®šå‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œæšä¸¾å &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå¹¶æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\((s,x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
å¯¹äºæŸ¥è¯¢ï¼šç›¸å½“äºå›ºå®šå &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œæšä¸¾å‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œå¹¶æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\((s,x)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä»åˆ†æ­¥è½¬ç§»è§’åº¦ï¼Œç”±äºã€ç°æ—¶åˆ»ã€çš„è´¡çŒ®æ˜¯æŒ‰ä½çš„ï¼ŒäºŒè¿›åˆ¶çŠ¶æ€çš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½å’Œå &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½æ²¡å•¥æœ‰æœºè”ç³»ï¼Œæ•…ç›´æ¥æ‹†å¼€ï¼Œå…ˆè½¬ç§»å‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ï¼Œå†è½¬ç§»å &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ ·å°±è¢«ä¼˜åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(k\cdot n\times \sqrt v)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxv = 1 &amp;lt;&amp;lt; 8;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    using arr = std::vector&amp;lt;int&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    arr s(n + 1), tag0(maxv), d0;
    crr f(maxv, brr(maxv, arr(k + 1, inf))), g(maxv, brr(maxv, arr(k + 1, inf)));
    f[0][0][0] = 0;
    for (int j = 0; j &amp;lt; maxv; ++j)
        g[0][j][1] = j;
    tag0[0] = 1, d0.push_back(0);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; s[i], s[i] ^= s[i - 1];
        int p0 = s[i] &amp;gt;&amp;gt; 8, p1 = s[i] &amp;amp; ((1 &amp;lt;&amp;lt; 8) - 1);
        for (int j = k; j; --j) &amp;#123;
            for (auto a : d0)
                f[p0][p1][j] = std::min(f[p0][p1][j], g[a][p1][j] + ((a ^ p0) &amp;lt;&amp;lt; 8));
            // printf(&amp;quot;f[%d][%d][%d] = %d\n&amp;quot;, p0, p1, j, f[p0][p1][j]);
            if (j != k)
                for (int a = 0; a &amp;lt; maxv; ++a)
                    g[p0][a][j + 1] = std::min(g[p0][a][j + 1], f[p0][p1][j] + (a ^ p1));
        &amp;#125;
        if (i &amp;gt;= k)
            std::cout &amp;lt;&amp;lt; f[p0][p1][k] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
        if (!tag0[p0])
            tag0[p0] = 1, d0.push_back(p0);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å‰²è£‚&#34;&gt;å‰²è£‚&lt;/h2&gt;
&lt;p&gt;å¦‚æœçŠ¶æ€çš„è‹¥å¹²ç»´ä¹‹é—´è¿æ— æœºè”ç³»éƒ½æ²¡äº†ï¼Œå¯ä»¥ç›´æ¥æŠŠ DP æ•°ç»„æ‹†å¼€ï¼Œå„è‡ªè½¬ç§»å„è‡ªçš„ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åç­”æ¡ˆçš„æ‹¼æ¥ï¼Œå¯èƒ½æ˜¯æšä¸¾ã€ç›´æ¥æ‹¼ã€ç”¨ä¸€ä¸ªè½¬ç§»å¦ä¸€ä¸ªä¹‹ç±»ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜ç»å…¸é¢˜-1&#34;&gt;ä¾‹é¢˜ï¼šç»å…¸é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(w_{N\times M}\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\((A,B)_{1\sim K}\)&lt;/span&gt;ï¼Œæœ€å¤§åŒ– &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=1}^K w_{A_{i-1},A_i}+w_{B_{i-1},B_i}\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…ˆ DP å‡ºæ¥ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œå† DP å‡ºæ¥ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt;ï¼Œç›´æ¥ç›¸åŠ å³å¯ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜mnogomet&#34;&gt;ä¾‹é¢˜ï¼šMNOGOMET&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7648&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7648&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æƒ³åˆ°è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{t,i,a,b}\)&lt;/span&gt; è¡¨ç¤ºã€è¿‡å»äº† &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’ï¼Œä¸”çƒåœ¨çƒå‘˜ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰‹ä¸Šï¼Œä¸”ä¸¤ä¸ªé˜Ÿä¼å¾—åˆ†åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt;ã€çš„æ¦‚ç‡ã€‚é‚£ä¹ˆæšä¸¾çƒä¸Šä¸€æ¬¡åœ¨è°æ‰‹ä¸Šï¼Œæœ‰ç¾è§‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(O(T\cdot N^2R^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æ¯”åˆ†å˜åŠ¨æ—¶ï¼ˆä¸ŠåŠä¸ªæ—¶åˆ»å®Œæˆå°„é—¨å¹¶ä¼ çƒï¼‰çƒä¸€å®šåœ¨æŸä¸ªé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·æ‰‹ä¸Šï¼›&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¿™ä¸€ç»´å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; ä¹Ÿæ²¡æœ‰ç›¸äº’çš„å¹²æ‰°ï¼›æ•…å¯ä»¥å°† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æå–å‡ºæ¥ï¼ˆä½œä¸ºå¯¹æ¯”ï¼Œå°„é—¨å’Œå¤ºçƒã€ä¼ çƒéƒ½ä¼šå½±å“ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œæ‰€ä»¥åˆ†è£‚å‡ºæ¥çš„çŠ¶æ€ä¸­å¿…é¡»åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼‰ã€‚å…·ä½“åœ°ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g_{t,0/1,i}\)&lt;/span&gt; è¡¨ç¤ºã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ï¼ŒèŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’ï¼Œä¸”æ²¡äººå°„é—¨ï¼Œä¸”çƒåœ¨çƒå‘˜ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰‹ä¸Šã€çš„æ¦‚ç‡ã€‚å‘ç°å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(T\times N^2)\)&lt;/span&gt; è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶è¿™é‡Œå°±æ˜¯æ¡ä»¶æ¦‚ç‡äº†ã€‚å…¶ä¸­ã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ã€å°±æ˜¯æ¡ä»¶ã€‚&lt;/p&gt;
å†é¢„å¤„ç†å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(G_{t,0/1,0/1,0/1}\)&lt;/span&gt; è¡¨ç¤ºã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ï¼ŒèŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’ï¼Œå“ªä¸ªçƒé˜Ÿå°„é—¨ï¼Œï¼ˆæ²¡ï¼‰å°„è¿›ã€çš„æ¦‚ç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{t,0/1,a,b}\)&lt;/span&gt; è¡¨ç¤ºã€è¿‡å»äº† &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’ï¼Œçƒåœ¨å“ªä¸ªé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ï¼Œä¸”å¾—åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt;ã€çš„æ¦‚ç‡ã€‚æšä¸¾è·ç¦»ä¸Šä¸€æ¬¡å°„é—¨çš„æ—¶é—´ï¼Œå¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(T^2\times R^2)\)&lt;/span&gt; å®Œæˆè½¬ç§»ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, r, T;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; r &amp;gt;&amp;gt; T;
    using arr = std::vector&amp;lt;double&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    brr p(2 * n + 1, arr(2)), pp(2 * n + 1, arr(2 * n + 1));
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; p[i][1], p[i][0] = 1. - p[i][1];
        int ss, sd;
        std::cin &amp;gt;&amp;gt; ss &amp;gt;&amp;gt; sd;
        double P = 1. / (ss + sd + 1);
        p[i][0] *= P, p[i][1] *= P;
        for (int x; ss--; pp[i][x] = P)
            std::cin &amp;gt;&amp;gt; x;
        for (int x; sd--; pp[i][x + n] = P)
            std::cin &amp;gt;&amp;gt; x;
    &amp;#125;
    for (int i = n + 1; i &amp;lt;= 2 * n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; p[i][1], p[i][0] = 1. - p[i][1];
        int ss, sd;
        std::cin &amp;gt;&amp;gt; ss &amp;gt;&amp;gt; sd;
        double P = 1. / (ss + sd + 1);
        p[i][0] *= P, p[i][1] *= P;
        for (int x; ss--; pp[i][x + n] = P)
            std::cin &amp;gt;&amp;gt; x;
        for (int x; sd--; pp[i][x] = P)
            std::cin &amp;gt;&amp;gt; x;
    &amp;#125;
    brr s(T + 1, arr(2));
    crr g(T + 1, brr(2, arr(2 * n + 1)));
    std::vector&amp;lt;crr&amp;gt; G(T + 1, crr(2, brr(2, arr(2)))), f(T + 1, crr(2, brr(r + 1, arr(r + 1))));
    g[0][0][1] = g[0][1][n + 1] = 1.;
    for (int t = 1; t &amp;lt;= T; ++t) &amp;#123;
        for (int f1 = 0; f1 &amp;lt;= 1; ++f1)
            for (int i = 1; i &amp;lt;= 2 * n; ++i) &amp;#123;
                G[t][f1][i &amp;gt; n][0] += g[t - 1][f1][i] * p[i][0];
                G[t][f1][i &amp;gt; n][1] += g[t - 1][f1][i] * p[i][1];
                for (int j = 1; j &amp;lt;= 2 * n; ++j)
                    if (j != i)
                        g[t][f1][i] += pp[j][i] * g[t - 1][f1][j];
                // printf(&amp;quot;spend %ds, start from %d, now at %d: %.10lf\n&amp;quot;, t, 1 + f1 * n, i, g[t][f1][i]);
                s[t][f1] += g[t][f1][i];
            &amp;#125;
    &amp;#125;
    // puts(&amp;quot;------------------------------------&amp;quot;);
    // for (int t = 1; t &amp;lt;= T; ++t) &amp;#123;
    //     for (int f1 = 0; f1 &amp;lt;= 1; ++f1)
    //         for (int f2 = 0; f2 &amp;lt;= 1; ++f2)
    //             for (int f3 = 0; f3 &amp;lt;= 1; ++f3)
    //                 printf(&amp;quot;spend %ds, start from %d, %d shoots, STATUS: %d, P = %.10lf\n&amp;quot;, t, 1 + f1 * n, 1 + f2, f3, G[t][f1][f2][f3]);
    // &amp;#125;
    // puts(&amp;quot;------------------------------------&amp;quot;);
    f[0][0][0][0] = 1.;
    for (int t = 0; t &amp;lt; T; ++t)
        for (int f1 = 0; f1 &amp;lt;= 1; ++f1)
            for (int a = 0; a &amp;lt; r; ++a)
                for (int b = 0; b &amp;lt; r; ++b) &amp;#123;
                    for (int t1 = 1; t + t1 &amp;lt;= T; ++t1) &amp;#123;
                        f[t + t1][0][a][b] += f[t][f1][a][b] * G[t1][f1][1][0];
                        f[t + t1][0][a][b + 1] += f[t][f1][a][b] * G[t1][f1][1][1];
                        f[t + t1][1][a][b] += f[t][f1][a][b] * G[t1][f1][0][0];
                        f[t + t1][1][a + 1][b] += f[t][f1][a][b] * G[t1][f1][0][1];
                        if (t + t1 == T)
                            f[T][0][a][b] += f[t][f1][a][b] * s[t1][f1];
                    &amp;#125;
                &amp;#125;
    // for (int t = 0; t &amp;lt;= T; ++t)
    //     for (int f1 = 0; f1 &amp;lt;= 1; ++f1)
    //         for (int a = 0; a &amp;lt;= r; ++a)
    //             for (int b = 0; b &amp;lt;= r; ++b)
    //                 if (f[t][f1][a][b] &amp;gt; 1e-10)
    //                     printf(&amp;quot;%ds later, %d shoots, %d : %d, P = %.10lf\n&amp;quot;, t, 1 + !f1 * n, a, b, f[t][f1][a][b]);
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(10);
    for (int a = 0; a &amp;lt;= r; ++a) &amp;#123;
        for (int b = 0; b &amp;lt;= r; ++b) &amp;#123;
            if (a == r &amp;amp;&amp;amp; b == r)
                continue;
            double res(0.);
            if (a == r)
                for (int t = r; t &amp;lt;= T; ++t)
                    res += f[t][1][r][b];
            else if (b == r)
                for (int t = r; t &amp;lt;= T; ++t)
                    res += f[t][0][a][r];
            else
                res = f[T][0][a][b] + f[T][1][a][b];
            std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="DP ä¼˜åŒ–" />
        <updated>2025-05-26T07:05:53.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250510/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250510/"/>
        <content type="html">&lt;p&gt;å•Šå•Šã€‚å°å°æ¡ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---pass-to-next&#34;&gt;A - Pass to Next&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc124/tasks/arc124_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc124/tasks/arc124_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰å…¶ä»–ä¸€äº›é¢˜è§£è®²å¾—ä¸æ˜¯ç‰¹åˆ«æ¸…æ¥šï¼Œè¿™é‡Œå‚è€ƒäº† &lt;a href=&#34;https://blog.csdn.net/weixin_43960287/article/details/119140590&#34;&gt;XJX çš„æ–‡ç« &lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚çš„ç­”æ¡ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\prod a&amp;#39;_i\)&lt;/span&gt;ï¼Œ&lt;mark&gt;å‘ç°è¿ç®—æ˜¯ä¹˜æ³•ï¼Œæ¯”è¾ƒæ€ªï¼›ç”±æ­¤è€ƒè™‘è½¬åŒ–ä¸ºæ–¹æ¡ˆæ•°ï¼Œä¹Ÿå°±æ˜¯å‡è®¾æ¯ä¸ªäººæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;_i\)&lt;/span&gt; ä¸ªäº’ä¸ç›¸åŒçš„çƒï¼Œæ¯ä¸ªäººåœ¨å…¶ä¸­é€‰å‡ºæ°å¥½ä¸€ä¸ªçš„æ–¹æ¡ˆæ•°&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ DPã€‚å‘ç°æ¯ä¸ªäººæ‰‹ä¸Šçš„çƒåˆ†ä¸ºã€è‡ªå·±çš„ã€å’Œã€å·¦è¾¹çš„äººä¼ è¿‡æ¥çš„ã€ä¸¤ç§ç±»å‹ï¼›&lt;mark&gt;æ˜¾ç„¶ç¬¬äºŒç§ä¼šæœ‰æ¥è‡ªä¸Šä¸€ä¸ªäººçš„é™åˆ¶ï¼Œè€ƒè™‘æŠŠç¬¬äºŒç§åœ¨ä¸Šä¸€ä¸ªäººå°±å®Œæˆæ±‚è§£&lt;/mark&gt;ã€‚å…·ä½“åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,0}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªäººé€‰å–è‡ªå·±çš„çƒï¼Œä½†åªè®°å½• &lt;span class=&#34;math inline&#34;&gt;\(1\sim i-1\)&lt;/span&gt; çš„æ–¹æ¡ˆï¼›&lt;span class=&#34;math inline&#34;&gt;\(f_{i,1}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªäººé€‰å–ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; ä¸ªäººçš„çƒï¼Œå¹¶è®°å…¥ç­”æ¡ˆçš„æ–¹æ¡ˆã€‚&lt;em&gt;ä½ å¯èƒ½éœ€è¦æ³¨æ„åˆ°ï¼šæœ€åä¸€ä¸ªè¢«è®°å…¥æ–¹æ¡ˆçš„çƒæ¥è‡ªç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; ä¸ªäºº&lt;/em&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¿™æ ·ä¼šæœ‰ä¸ªå°é—®é¢˜ã€‚æˆ‘ä»¬è®©æ‰€æœ‰äººå¤šå¾€å³è¾¹ä¼ ä¸€ä¸ªçƒï¼Œé‚£ä¹ˆåœ¨æˆ‘ä»¬çš„è¿™ç§åˆ†å‰²æ–¹æ³•çœ‹æ¥æ˜¯ä¸ä¸€æ ·çš„å±€é¢ï¼›ä½†å®é™…ä¸Šå®ƒä»¬æ˜¯ç­‰ä»·çš„ã€‚ä»æ¯ä¸ªäººä¼ å‡ºäº†å¤šå°‘ä¸ªçƒï¼ˆè®¾ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt;ï¼‰çš„è§’åº¦æ¥çœ‹ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\min\{x_n\}\ne 0\)&lt;/span&gt;ï¼Œåªéœ€è¦ä¸æ–­æ‰§è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(\forall\, x_i\gets x_i-1\)&lt;/span&gt; å°±å¯ä»¥åœ¨å±€é¢ä¸å˜çš„æƒ…å†µä¸‹ä½¿ &lt;span class=&#34;math inline&#34;&gt;\(\min\{x_n\}\ne 0\)&lt;/span&gt;ã€‚è¿™æ˜¯åœ¨è¯´ï¼Œå¯ä»¥è®© &lt;span class=&#34;math inline&#34;&gt;\(\min\{x_n\}\ne 0\)&lt;/span&gt; çš„æ–¹æ¡ˆå’Œç»ˆå±€ä¸€ä¸€å¯¹åº”ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å¯ä»¥å®¹æ–¥ï¼šé’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(x_i\ge 1\)&lt;/span&gt;ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªäººå¿…é¡»å¾€å³ä¼ è‡³å°‘ä¸€ä¸ªï¼Œç›¸ä¼¼åœ°ç®—ä¸€éå°±èƒ½å¾—åˆ°éæ³•æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘è½¬ç§»ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt; å¯é€‰æœ€å°å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt;ï¼Œæœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_{i+1,0}\gets f_{i,0}\)&lt;/span&gt;ï¼šå°†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªäººæœªè¢«è®°å…¥çš„è‡ªå·±çš„çƒè®°å…¥ï¼Œçƒæ•°å¯èƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\([0,a_i-l]\)&lt;/span&gt;ã€‚ç­‰å·®æ•°åˆ—æ±‚å’Œå³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_{i+1,0}\gets f_{i,1}\)&lt;/span&gt;ï¼šæ²¡æœ‰çƒéœ€è¦è¢«è®°å…¥ï¼Œä½†æ˜¯è¿™ç§æƒ…å†µå¯¹åº”å¤šç§ &lt;span class=&#34;math inline&#34;&gt;\(x_i\)&lt;/span&gt;ã€‚å…·ä½“åœ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x_i\in [l,a_i]\)&lt;/span&gt;ã€‚å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(a_i-l+1\)&lt;/span&gt; ç§æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_{i+1,1}\gets f_{i,0}\)&lt;/span&gt;ï¼šå°†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªäººçš„ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¸ªçƒåˆ†ç»™ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(i+1\)&lt;/span&gt;ã€‚å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x_i\cdot (a_i-x_i)\)&lt;/span&gt; ç§å¯èƒ½ï¼Œä¹Ÿå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\left(a_i\cdot \sum_{x_i=l}^{a_i} x_i\right)-\left(\sum_{x_i=l}^{a_i}{x_i}^2\right)\)&lt;/span&gt; ç§æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_{i+1,1}\gets f_{i,1}\)&lt;/span&gt;ï¼šå°†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i+1\)&lt;/span&gt; ä¸ªäººå¾—åˆ°çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªäººçš„çƒè®°å…¥ï¼ŒåŒç¬¬ä¸€æ¡ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç ´ç¯ä¸ºé“¾ï¼Œåˆ†åˆ«é’¦å®šç¬¬ä¸€ä¸ªäººæ˜¯ç”¨è‡ªå·±çš„çƒè¿˜æ˜¯ä¸Šä¸€ä¸ªäººçš„çƒæ¥è§£å†³é—®é¢˜ï¼ˆå¿…é¡»å¯¹äºä¸¤ç§å¯èƒ½æ€§åˆ†å¼€è®¡ç®—ï¼›å¦åˆ™å°±ä¸çŸ¥é“ç­”æ¡ˆåº”è¯¥å– &lt;span class=&#34;math inline&#34;&gt;\(f_{n,0}\)&lt;/span&gt; è¿˜æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{n,1}\)&lt;/span&gt;ï¼‰ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353, inv2 = (mod + 1) &amp;gt;&amp;gt; 1, inv6 = 166374059;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; a(n);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i % n];
    auto sum = [&amp;amp;](long long r) &amp;#123;
        return r * (r + 1) % mod * inv2 % mod;
    &amp;#125;;
    auto sum2 = [&amp;amp;](long long r) &amp;#123;
        return r * (r + 1) % mod * (2 * r % mod + 1) % mod * inv6 % mod;
    &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f0(n, std::vector&amp;lt;long long&amp;gt; (2)), f1(n, std::vector&amp;lt;long long&amp;gt; (2));
    auto calc = [&amp;amp;](long long l, std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; &amp;amp;f) &amp;#123;
        f[0][0] = 1ll;
        for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
            int j = (i + 1) % n;
            f[j][0] = f[i][0] * sum(a[i] - l) % mod;
            (f[j][0] += f[i][1] * (a[i] - l + 1)) %= mod;
            f[j][1] = f[i][0] * (a[i] * sum(a[i]) % mod - sum2(a[i])) % mod;
            (f[j][1] += f[i][1] * sum(a[i]) % mod) %= mod;
            // printf(&amp;quot;0, l = %lld, f[%d]: %lld / %lld\n&amp;quot;, l, j, f[j][0], f[j][1]);
        &amp;#125;
        auto res(f[0][0]);
        f.assign(n, std::vector&amp;lt;long long&amp;gt; (2));
        f[0][1] = 1ll;
        for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
            int j = (i + 1) % n;
            f[j][0] = f[i][0] * sum(a[i] - l) % mod;
            (f[j][0] += f[i][1] * (a[i] - l + 1)) %= mod;
            f[j][1] = f[i][0] * (a[i] * sum(a[i]) % mod - sum2(a[i])) % mod;
            (f[j][1] += f[i][1] * sum(a[i]) % mod) %= mod;
            // printf(&amp;quot;1, l = %lld, f[%d]: %lld / %lld\n&amp;quot;, l, j, f[j][0], f[j][1]);
        &amp;#125;
        return (res + f[0][1]) % mod;
    &amp;#125;;
    std::cout &amp;lt;&amp;lt; (calc(0, f0) + mod - calc(1, f1)) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---ç»¿å®çŸ³ä¹‹å²›&#34;&gt;B - ç»¿å®çŸ³ä¹‹å²›&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://loj.ac/p/6406&#34; class=&#34;uri&#34;&gt;https://loj.ac/p/6406&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å› ä¸ºåªå…³å¿ƒæœ€ç»ˆçŠ¶æ€ï¼ŒåŸé¢˜å¯ä»¥è½¬åŒ–ä¸ºï¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; åˆ†æˆ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªéè´Ÿæ•´æ•°ï¼Œå‰ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¤§æ•°ä¹‹å’Œçš„æœŸæœ›ï¼ˆå½“ç„¶ä½ éœ€è¦åŠ ä¸Šåˆå§‹çš„ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸ªï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºéè´Ÿæ•´æ•°æ‹†åˆ†ï¼šè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºå°† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ†æˆ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ª &lt;strong&gt;éè´Ÿæ•´æ•°&lt;/strong&gt; çš„æ–¹æ¡ˆï¼Œé’¦å®šå…¶ä¸­æ°æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ª &lt;strong&gt;æ­£æ•´æ•°&lt;/strong&gt; è¿›è¡Œè½¬ç§»ï¼Œç»™è¿™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªæ•°å…ˆåˆ†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\sum\limits_{k=0}^{\min(i,j)} C_j^k\cdot f_{i-k,k}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å†è®¾ &lt;span class=&#34;math inline&#34;&gt;\(g_{i,j}\)&lt;/span&gt; è¡¨ç¤ºå°† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ†æˆ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªéè´Ÿæ•´æ•°çš„æ‰€æœ‰æ–¹æ¡ˆä¸­ã€å‰ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¤§çš„æ•°ä¹‹å’Œã€‚ç±»ä¼¼åœ°ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(g_{i,j}=\sum\limits_{k=0}^{\min(i,j)} C_j^k\cdot (g_{i-k,k}+\min(k,r)\cdot f_{i-k,k})\)&lt;/span&gt;ã€‚å…¶ä¸­ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\min(k,r)\)&lt;/span&gt; çš„æ¥æºæ˜¯ï¼Œåªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªæ•°æœ‰å€¼ï¼Œå‰ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¤§çš„æ•°ä¸€å®šåœ¨è¿™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªæ•°é‡Œé¢ã€‚&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {g_{d,n}}{f_{d,n}}+r\)&lt;/span&gt;ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, d, r;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; d &amp;gt;&amp;gt; r;
    using arr = std::vector&amp;lt;double&amp;gt;;
    std::vector&amp;lt;arr&amp;gt; f(d + 1, arr(n + 1)), g(d + 1, arr(n + 1)), C(n + 1, arr(n + 1));
    for (int i = 0; i &amp;lt;= n; ++i) &amp;#123;
        C[i][0] = 1.;
        for (int j = 1; j &amp;lt;= i; ++j)
            C[i][j] = C[i - 1][j - 1] + C[i - 1][j];
    &amp;#125;
    f[0].assign(n + 1, 1.);
    for (int i = 1; i &amp;lt;= d; ++i)
        for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
            for (int k = 1; k &amp;lt;= i &amp;amp;&amp;amp; k &amp;lt;= j; ++k) &amp;#123;
                f[i][j] += C[j][k] * f[i - k][k];
                g[i][j] += C[j][k] * (g[i - k][k] + std::min(k, r) * f[i - k][k]);
                // printf(&amp;quot;  k = %d, %.0lf + %.0lf\n&amp;quot;, k, C[j][k] * g[i - k][k], std::min(k, r) * f[i - k][k]);
            &amp;#125;
            // printf(&amp;quot;f[%d][%d] = %.0lf, g[%d][%d] = %.0lf\n&amp;quot;, i, j, f[i][j], i, j, g[i][j]);
        &amp;#125;
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(8) &amp;lt;&amp;lt; g[d][n] / f[d][n] + r &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---uddered-but-not-herd-g&#34;&gt;C - Uddered but not Herd G&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7296&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7296&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™æ¯ä¸ªå­—æ¯åˆ†é…ä¸€ä¸ªæ ‡å· &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ€å°æ®µæ•°å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\sum \left[x_i\ge x_{i+1}\right]\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘çŠ¶å‹å®Œæˆæ˜ å°„æ“ä½œï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{s}\)&lt;/span&gt; è¡¨ç¤ºç»™æ ‡å· &lt;span class=&#34;math inline&#34;&gt;\(1\sim |s|\)&lt;/span&gt; åˆ†é…å­—æ¯åï¼Œå ç”¨å­—ç¬¦é›† &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå°±èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; å¾—åˆ°è´¡çŒ®â€”â€”åªéœ€é¢„å¤„ç†å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_{c, s}\)&lt;/span&gt; è¡¨ç¤ºåˆ†é…åˆ°å­—æ¯ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; æ—¶ï¼Œå·²ç»å…ˆç»™ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; ä¸­å­—æ¯åˆ†é…äº†æ›´å°æ ‡å·æ—¶çš„è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„å­—ç¬¦é›†å¤§å°åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(20\)&lt;/span&gt;ï¼Œå¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(|S|\cdot 2^{|S|})\)&lt;/span&gt; è§£å†³é—®é¢˜ï¼Œ&lt;mark&gt;æ³¨æ„åˆ°é¢„å¤„ç†çš„å†…å®¹æ˜¯ç±»é«˜ç»´å‰ç¼€æœ€å€¼çš„å½¢å¼ï¼Œå¯ä»¥é€’æ¨é™ä½å¤æ‚åº¦&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre data-line=&#34;26-28&#34; class=&#34;cpp language-cpp&#34;&gt;&lt;code data-line=&#34;26-28&#34; class=&#34;cpp language-cpp&#34;&gt;#include &amp;lt;bits/stdc++.h&gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&#34;.in&#34;, &#34;r&#34;, stdin);
    std::freopen(&#34;.out&#34;, &#34;w&#34;, stdout);
#endif
    int n;
    std::string t;
    std::cin &gt;&gt; t, n = (int)t.length(), t = &#34;#&#34; + t;
    std::vector&amp;lt;int&gt; a, tag(26, -1), s(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (tag[t[i] - &#39;a&#39;] == -1)
            tag[t[i] - &#39;a&#39;] = (int)a.size(), a.push_back(t[i] - &#39;a&#39;);
        s[i] = tag[t[i] - &#39;a&#39;];
    &amp;#125;
    int m = (int)a.size(), siz = 1 &amp;lt;&amp;lt; m;
    std::vector&amp;lt;std::vector&amp;lt;int&gt; &gt; cnt(m, std::vector&amp;lt;int&gt; (m));
    for (int i = 1; i &amp;lt; n; ++i)
        ++cnt[s[i]][s[i + 1]];
    std::vector&amp;lt;std::vector&amp;lt;int&gt; &gt; g(m, std::vector&amp;lt;int&gt; (siz));
    for (int i = 0; i &amp;lt; m; ++i)
        for (int k = 0; k &amp;lt; m; ++k) // æ³¨æ„è¿™é‡Œç›¸å½“äºæ˜¯é’¦å®šä» k å¤„è½¬ç§»
            for (int j = (1 &amp;lt;&amp;lt; k); j &amp;lt; (2 &amp;lt;&amp;lt; k); ++j) // æšä¸¾çš„æ˜¯ k ä½ä¸º 1 çš„æ‰€æœ‰æ•°ï¼›è¿™ä¸¤å±‚å¾ªç¯çš„å¤æ‚åº¦ä¸º O(siz)
                g[i][j] = g[i][j ^ (1 &amp;lt;&amp;lt; k)] + cnt[i][k]; // ç›®çš„æ˜¯æ­¤å¤„çš„å†…å­˜è¿ç»­è®¿é—®ä¼˜åŒ–ï¼ŒæŠŠ ^ çœ‹ä½œ - åº”è¯¥å°±èƒ½ç†è§£ä¸ºä»€ä¹ˆç¬¬äºŒç»´æ˜¯è¿ç»­çš„
    std::vector&amp;lt;int&gt; f(siz, inf);
    f[0] = 1;
    for (int i = 1; i &amp;lt; siz; ++i)
        for (int j = 0; j &amp;lt; m; ++j)
            if ((i &gt;&gt; j) &amp; 1)
                f[i] = std::min(f[i], f[i ^ (1 &amp;lt;&amp;lt; j)] + g[j][i]);
    std::cout &amp;lt;&amp;lt; f[siz - 1] &amp;lt;&amp;lt; &#39;\n&#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---min-max-subarrays-p&#34;&gt;D - Min Max Subarrays P&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11845&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11845&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…ˆè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(01\)&lt;/span&gt; åºåˆ—çš„ç­”æ¡ˆï¼šå¦‚æœåºåˆ—ä¸­å­˜åœ¨ç›¸é‚»çš„ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œæ€»èƒ½ä¿è¯æœ€åçš„ä¸€ä¸ªæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåºåˆ—ä¸­å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\ge 3\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œå¯ä»¥ç‰ºç‰²å…¶ä¸­çš„ä¸€äº›ä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç›¸é‚»ã€‚&lt;/p&gt;
&lt;p&gt;å½“åºåˆ—ä¸­åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ—¶ï¼Œåªæœ‰å› ä¸ºå‰©ä¸‹çš„ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä¸å¤ªå¤Ÿï¼Œå¯¼è‡´æˆ‘ä»¬æ— æ³•éšæ„ã€ä¸Šä¸‹å…¶æ‰‹ã€æ—¶ä¸èƒ½å°† &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æŒªåˆ°ä¸€èµ·ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºåºåˆ—æœ€å¤§å€¼ä¸æ¬¡å¤§å€¼ï¼Œæš´æœå¤„ç†åºåˆ—é•¿åº¦è¾ƒå°çš„æƒ…å†µï¼Œå‰©ä¸‹çš„ç›´æ¥ç”¨å¥‡å¶æ€§åˆ¤æ–­ä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å–å“ªä¸ªã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---mst-on-line&#34;&gt;A - MST on Line++&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc167/tasks/arc167_c&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc167/tasks/arc167_c&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç›¸å½“äºæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æ‰“ä¹±ç„¶åå¤„ç†åŸé—®é¢˜ã€‚è€ƒè™‘æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„è´¡çŒ®æ¬¡æ•°ã€‚æ¨¡æ‹Ÿ Kruskal è¿è¾¹ï¼Œä»å°åˆ°å¤§æŠŠç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åŠ å…¥å›¾ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å¯ä»¥å‘ &lt;span class=&#34;math inline&#34;&gt;\(a_{[i-K,i+K]}\)&lt;/span&gt; å†…æ‰€æœ‰è¿é€šå—è¿è¾¹ã€‚&lt;/p&gt;
&lt;p&gt;è¿é€šå—æ•°é‡å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\([i-K,i)\)&lt;/span&gt; å†…æœ€é å³çš„ç‚¹å’Œ &lt;span class=&#34;math inline&#34;&gt;\((i, i+K]\)&lt;/span&gt; å†…æœ€é å·¦çš„ç‚¹è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;K\)&lt;/span&gt; æ—¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ï¼Œå…¶ä½™æƒ…å†µä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¦æ˜¯ä»è¿™ä¸ªè§’åº¦æƒ³è¿™ä¸ªé¢˜å°±ä¸å¤ªå¥½åšäº†ã€‚æ­£ç¡®çš„æƒ³æ³•åº”è¯¥æ˜¯&lt;mark&gt;æ‹†åˆ†ä¸ºã€è‹¥ &lt;span class=&#34;math inline&#34;&gt;\([i-K,i)\)&lt;/span&gt; ä¸­æœ‰ç‚¹ï¼Œè´¡çŒ®æ¬¡æ•° &lt;span class=&#34;math inline&#34;&gt;\(+1\)&lt;/span&gt;ã€å’Œã€è‹¥ &lt;span class=&#34;math inline&#34;&gt;\((i,i+K]\)&lt;/span&gt; ä¸­æœ‰ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\([j-K,j)\)&lt;/span&gt; ä¸­æ— ç‚¹ï¼Œè´¡çŒ®æ¬¡æ•° &lt;span class=&#34;math inline&#34;&gt;\(+1\)&lt;/span&gt;ã€&lt;/mark&gt;ã€‚å¯¹äºç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œè´¡çŒ®æ¬¡æ•°å°†å‰ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; å¤§çš„æ•°åˆ†é…è‡³å°‘ä¸€ä¸ªåˆ° &lt;span class=&#34;math inline&#34;&gt;\([i-K,i)\)&lt;/span&gt; ä¸­çš„æ–¹æ¡ˆæ•°ï¼›å¯¹äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œæšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œè´¡çŒ®æ¬¡æ•°ä¸ºå°†å‰ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; å¤§çš„æ•°åˆ†é…åˆ° &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([1,j-K)\cup (j, n]\)&lt;/span&gt; ä¸­çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å®ç°çš„æ—¶å€™åƒä¸‡æ³¨æ„å¾ªç¯å˜é‡æšä¸¾çš„æ˜¯ä½ç½®è¿˜æ˜¯å€¼ï¼ä¸ç„¶ä½ ä¼šè°ƒå¾—å¾ˆç—›è‹¦ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;03-max-01.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::sort(a.begin() + 1, a.end());
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto A = [&amp;amp;](int n, int m) &amp;#123;
        if (n &amp;lt; m)
            return 0ll;
        return fac[n] * inv[n - m] % mod;
    &amp;#125;;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return A(n, m) * inv[m] % mod;
    &amp;#125;;
    long long res = 0ll;
    for (int i = 2; i &amp;lt;= n; ++i) &amp;#123;
        for (int j = 1; j &amp;lt;= n; ++j)
            (res += a[i] * (fac[n - 1] + mod - A(n - 1 - (j - std::max(1, j - k)), i - 1) * fac[n - i] % mod) % mod) %= mod;
        for (int j = 2; j &amp;lt;= n; ++j)
            (res += a[i] * C(i - 1, i - 2) % mod * C(j - std::max(1, j - k), 1) % mod * A(n - (j - std::max(1, j - k) + 1), i - 2) % mod * fac[n - i] % mod) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---existence-counting&#34;&gt;B - Existence Counting&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc174/tasks/arc174_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc174/tasks/arc174_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°å¯ä»¥åˆ†ç±»è®¨è®ºã€‚å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;\)&lt;/span&gt; ä¸­ç¬¬ä¸€ä¸ªå¼‚äº &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„ä½ç½®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸­ä½ç½®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(pos_x\)&lt;/span&gt;ï¼ˆä¸å­˜åœ¨åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(pos_x=k+1\)&lt;/span&gt;ï¼‰ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¸ºè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(1\sim i-1\)&lt;/span&gt; å‡ç›¸åŒï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½ç½®å¯é€‰çš„é€‰é¡¹æ•°ã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å‡ºç°çš„æ¬¡æ•°ï¼š&lt;/p&gt;
&lt;table&gt;
&lt;colgroup&gt;
&lt;col style=&#34;width: 25%&#34; /&gt;
&lt;col style=&#34;width: 25%&#34; /&gt;
&lt;col style=&#34;width: 25%&#34; /&gt;
&lt;col style=&#34;width: 25%&#34; /&gt;
&lt;/colgroup&gt;
&lt;thead&gt;
&lt;tr class=&#34;header&#34;&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(pos_x&amp;lt;i\)&lt;/span&gt;&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(pos_x=i\)&lt;/span&gt;&lt;/th&gt;
&lt;th style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(pos_x&amp;gt;i,i&amp;lt;k\)&lt;/span&gt;&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr class=&#34;odd&#34;&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(x\le a_i\)&lt;/span&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(1+f_i\cdot A_{n-i}^{k-i}\)&lt;/span&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_i\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\)&lt;/span&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\((f_i-1)\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}+A_{n-i}^{k-i}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr class=&#34;even&#34;&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(x&amp;gt;a_i\)&lt;/span&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_i\cdot A_{n-i}^{k-i}\)&lt;/span&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;&lt;/td&gt;
&lt;td style=&#34;text-align: center;&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(f_i\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\)&lt;/span&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ•…ï¼Œå¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œç­”æ¡ˆä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
&amp;amp;1+\left(\sum_{i=pos_x+1}^k f_i\cdot A_{n-i}^{k-i}\right)
+\sum_{i=1}^{pos_x} (f_i-[x&amp;lt; a_i])\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}+[x&amp;lt; a_i]\cdot A_{n-i}^{k-i}\\
=&amp;amp;1+\left(\sum_{i=pos_x+1}^k f_i\cdot A_{n-i}^{k-i}\right)
+\left(\sum_{i=1}^{pos_x} f_i\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\right)+\sum_{i=1,a_i&amp;gt; x}^{pos_x}A_{n-i}^{k-i}-C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\\
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é¢„å¤„ç†å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_i=\sum\limits_{j=i+1}^k [a_j&amp;lt; a_i]\)&lt;/span&gt;ï¼ˆéœ€è¦æ•°æ®ç»“æ„ï¼‰ã€&lt;span class=&#34;math inline&#34;&gt;\(g_i=\sum\limits_{j=1}^i f_j\cdot A_{n-j}^{k-j}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(h_j=\sum\limits_{j=1}^i f_i\cdot C_{k-i}^1\cdot A_{n-i-1}^{k-i-1}\)&lt;/span&gt;ï¼Œå†ç”¨æ•°æ®ç»“æ„è®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=1,a_i&amp;gt;x}^{pos_x}C_{k-i}^1\cdot A_{n-i-1}^{k-i-1} - A_{n-i}^{k-i}\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; a(k + 1), p(n + 1, k + 1);
    for (int i = 1; i &amp;lt;= k; ++i)
        std::cin &amp;gt;&amp;gt; a[i], p[a[i]] = i;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    &amp;#123;
        fac[0] = inv[0] = 1ll;
        for (int i = 1; i &amp;lt;= n; ++i)
            fac[i] = fac[i - 1] * i % mod;
        auto qkp = [](long long x, int y) &amp;#123;
            auto res(1ll);
            for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
                if (y &amp;amp; 1)
                    (res *= x) %= mod;
            return res;
        &amp;#125;;
        inv[n] = qkp(fac[n], mod - 2);
        for (int i = n - 1; i; --i)
            inv[i] = inv[i + 1] * (i + 1) % mod;
    &amp;#125;
    auto A = [&amp;amp;](int n, int m) &amp;#123;
        if (n &amp;lt; m || m &amp;lt; 0)
            return 0ll;
        return fac[n] * inv[n - m] % mod;
    &amp;#125;;
    std::vector&amp;lt;long long&amp;gt; f(k + 1), g(k + 1), h(k + 1);
    std::vector&amp;lt;long long&amp;gt; bit(n + 1);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            (bit[x] += v) %= mod;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        auto res(0ll);
        for (; x; x -= lowbit(x))
            (res += bit[x]) %= mod;
        return res;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        if (p[i] == k + 1)
            add(i, 1);
    for (int i = k; i; --i)
        f[i] = ask(a[i]), add(a[i], 1);
    for (int i = 1; i &amp;lt;= k; ++i) &amp;#123;
        g[i] = (g[i - 1] + f[i] * A(n - i, k - i)) % mod;
        h[i] = (h[i - 1] + f[i] * (k - i) % mod * A(n - i - 1, k - i - 1)) % mod;
        // printf(&amp;quot;%d: f = %lld, g = %lld, h = %lld\n&amp;quot;, i, f[i], g[i], h[i]);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; res(n + 1);
    bit.assign(n + 1, 0ll);
    auto s(0ll);
    for (int i = 1; i &amp;lt;= k; ++i) &amp;#123;
        // printf(&amp;quot;%d: %lld + %lld + %lld\n&amp;quot;, a[i], 1 + g[k] - g[i], h[i], s - ask(a[i]));
        res[a[i]] = (1 + g[k] - g[i] + h[i] + (s - ask(a[i]))) % mod;
        res[a[i]] = (res[a[i]] + mod) % mod;
        (s += A(n - i, k - i) - (k - i) * A(n - i - 1, k - i - 1)) %= mod;
        add(a[i], (A(n - i, k - i) - (k - i) * A(n - i - 1, k - i - 1)) % mod);
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        if (p[i] == k + 1) &amp;#123;
            res[i] = (h[k] + (s - ask(i))) % mod;
            res[i] = (res[i] + mod) % mod;
        &amp;#125;
    for (int x = 1; x &amp;lt;= n; ++x)
        std::cout &amp;lt;&amp;lt; res[x] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---1-loop-bubble-sort&#34;&gt;C - 1 Loop Bubble Sort&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc187/tasks/arc187_c&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc187/tasks/arc187_c&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ˜¯è¢«è€ƒçƒ‚äº†çš„ï¼šå¯¹åºåˆ—è¿›è¡Œä¸€æ¬¡å†’æ³¡æ’åºï¼Œç­‰ä»·äºå°†åºåˆ—åœ¨å‰ç¼€æœ€å¤§å€¼å¤„åˆ†æ®µï¼Œå¹¶å°†å…¶ä»æ®µé¦–ç§»åˆ°æ®µå°¾ï¼›ä¸”æ»¡è¶³æ’åºå‰ä¸ºå‰ç¼€æœ€å¤§å€¼çš„å…ƒç´ ï¼Œæ’åºåä»ä¸ºå‰ç¼€æœ€å¤§å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ç”¨ DP è§£å†³é—®é¢˜ã€‚æ³¨æ„çŠ¶æ€è¦ä» &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; çš„è§’åº¦å‡ºå‘â€”â€”å‡å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; ä¸­ä¸å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œå‘ç°ä¹Ÿéœ€è¦ DPã€‚æ­¤æ—¶å†è®¾è®¡æœ‰å…³ &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; çš„çŠ¶æ€å°±å¾ˆæ‰¯æ·¡äº†ï¼Œè€ƒè™‘ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; ä¸­ç›´åˆ°ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä½çš„å‰ç¼€æœ€å¤§å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚ä¸ºä»€ä¹ˆæŠŠå‰ç¼€æœ€å¤§å€¼ä½œä¸ºçŠ¶æ€å‘¢ï¼Ÿå› ä¸ºå®ƒå¯ä»¥è¡¨ç¤ºåˆ†æ®µï¼›åŒæ—¶é™åˆ¶æ®µé—´æ•°çš„å–å€¼ã€‚å…·ä½“åœ°ï¼Œè€ƒè™‘è½¬ç§»ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;è‹¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(P_i=j\)&lt;/span&gt;ï¼Œåˆ™åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„åˆ†æ®µã€‚å¯¹åº”åˆ° &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; ä¸­ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; ä½æ˜¯ä¸Šä¸€ä¸ªå‰ç¼€æœ€å¤§å€¼ï¼Œé‚£ä¹ˆè¿™è¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(Q_{i-1}&amp;lt;j\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(Q_{i-1}\)&lt;/span&gt; æ˜¯ä¸€ä¸ªå‰ç¼€æœ€å¤§å€¼ã€‚ä¹Ÿå³ï¼šå½“ &lt;span class=&#34;math inline&#34;&gt;\(Q_{i-1}\ne -1\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\gets f_{i-1, Q_{i-1}}\)&lt;/span&gt;ï¼›å¦åˆ™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\gets \sum\limits_{k&amp;lt;j} f_{i-1,k}\)&lt;/span&gt;ã€‚å…¶ä¸­ï¼ŒäºŒå¼éƒ½è¦æ±‚è½¬ç§»æ¥æºä¸ºå‰ç¼€æœ€å¤§å€¼ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(P_i&amp;lt;j\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; ä¸­æ°å¥½å‰ç§»ä¸€ä½ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(Q_{i-1}=P_i&amp;lt;j\)&lt;/span&gt;ã€‚åˆ™å½“ &lt;span class=&#34;math inline&#34;&gt;\(Q_{i-1}\ne -1\)&lt;/span&gt; æ—¶ï¼Œè¯¥ä½ç¡®å®šï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\gets f_{i-1,j}\)&lt;/span&gt;ï¼›å¦åˆ™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(Q_{i-1}\)&lt;/span&gt; å¯é€‰çš„å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;j\)&lt;/span&gt; çš„æ‰€æœ‰æœªé€‰æ•°ï¼ˆå®šå€¼ï¼Œå¯é¢„å¤„ç†ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å…³äºåˆå€¼ï¼Œå¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt; å‰åŠ ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä½œä¸ºæ’åˆ—çš„ä¸€éƒ¨åˆ†ï¼ˆé‚£ä¹ˆæŒ‰ç…§å†’æ³¡æ’åºçš„è§„åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(Q\)&lt;/span&gt; çš„ç¬¬ä¸€ä½ä¹Ÿä¸€å®šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼‰æ¥å¤„ç†å°±å¥½äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; q(n + 1), t(n + 1), c(n + 1), pos(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; q[i], c[i] = c[i - 1];
        if (q[i] == -1)
            ++c[i];
        else
            pos[q[i]] = i;
    &amp;#125;
    for (int i = 1; i &amp;lt; n; ++i) &amp;#123;
        // printf(&amp;quot;t[%d] = %d\n&amp;quot;, i, t[i]);
        if (!pos[i])
            for (int j = i + 1; j &amp;lt;= n; ++j)
                ++t[j];
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long long&amp;gt; (n + 1)), s(n + 1, std::vector&amp;lt;long long&amp;gt; (n + 1));
    f[0][0] = 1ll;
    s[0].assign(n + 1, 1ll);
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
            if (q[i - 1] == -1)
                f[i][j] = (s[i - 1][j - 1] + f[i - 1][j] * std::max(0, 1 + t[j] - c[i - 1])) % mod;
            else if (q[i - 1] &amp;lt; j)
                f[i][j] = (f[i - 1][q[i - 1]] + f[i - 1][j]) % mod;
            s[i][j] = s[i][j - 1];
            if (q[i] == j || !pos[j]) // æ»¡è¶³å‰ç¼€æœ€å¤§å€¼
                (s[i][j] += f[i][j]) %= mod;
            // printf(&amp;quot;f[%d][%d] = %lld\n&amp;quot;, i, j, f[i][j]);
        &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n][n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---1.-intro&#34;&gt;(F - 1). Intro&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªå¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ ‘ï¼Œç‚¹æœ‰ç‚¹æƒã€‚ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; æ¬¡æ“ä½œï¼Œåˆ†ä¸ºä¸¤ç§ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;code&gt;1 x&lt;/code&gt;ï¼šæŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„ç‚¹æƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;code&gt;2 x d v&lt;/code&gt; å¯¹äºæ‰€æœ‰è· &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„ç‚¹ï¼Œå°†å®ƒä»¬çš„æƒå€¼åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,q\le 10^5,d\le 20\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; å¾ˆå°ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æšä¸¾ä¸ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(0\sim d\)&lt;/span&gt; çš„ç‚¹è¿›è¡Œä¿®æ”¹ï¼›é‚£ä¹ˆå¯¹è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ç‚¹çš„æ›´æ”¹å­˜å‚¨åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,i}\)&lt;/span&gt;ï¼ŒæŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ—¶å°±å¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_i f_{fa(v,i),i}\)&lt;/span&gt; æ±‚å¾—ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¿®æ”¹ã€‚è®° &lt;span class=&#34;math inline&#34;&gt;\(S_{x,d}\)&lt;/span&gt; ä¸ºè· &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„ç‚¹é›†ã€‚&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å­æ ‘å†…æ˜¯å¥½å¤„ç†çš„ï¼Œä½†å­æ ‘å¤–çš„å‘¢ï¼Ÿå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(S_{fa,d-1}\)&lt;/span&gt; ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å­æ ‘å¤–çš„ç‚¹ï¼Œå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(fa\)&lt;/span&gt; å­æ ‘ä¸‹ã€&lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å­æ ‘å¤–è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„æ‰€æœ‰ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(S_{fa(x,i),d-i}\)&lt;/span&gt; æ— äº¤ï¼Œè¿™å¯èƒ½æ»¡è¶³æˆ‘ä»¬æ¯ä¸ªå¾…æ“ä½œç‚¹è¢«ä¸é‡ä¸æ¼åŠ ä¸€æ¬¡çš„è¦æ±‚ã€‚è€ƒè™‘å°†æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(S_{fa(x,i),d-i}\)&lt;/span&gt; æ ‡è®°å‡ºæ¥ï¼š&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;1.png&#34; alt=&#34;ç²‰è‰²è™šçº¿æ¡†æ˜¯å¾…æ“ä½œç‚¹é›†&#34; /&gt;&lt;figcaption&gt;ç²‰è‰²è™šçº¿æ¡†æ˜¯å¾…æ“ä½œç‚¹é›†&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å¯ä»¥ä¸€çœ¼å‘ç°è¢«å‰çš„ç‚¹å’Œæœªè¢«å‰çš„å¾…æ“ä½œç‚¹æ˜¯äº¤é”™çš„ï¼è¿™æ„å‘³ç€æˆ‘ä»¬åªéœ€è¦å†è¡¥å……ä¸Šæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(S_{fa(x,i),d-i-1}\)&lt;/span&gt; å³å¯ï¼ˆæ˜¾ç„¶å®ƒä»¬ä¹‹é—´ã€å®ƒä»¬å’Œæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(S_{fa(x,i),d-i}\)&lt;/span&gt; ä¹‹é—´éƒ½ä¸äº¤ï¼‰ã€‚&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;2.png&#34; alt=&#34;è™šçº¿å‰ä¸º S_{fa(x,i),d-i-1}&#34; /&gt;&lt;figcaption&gt;è™šçº¿å‰ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S_{fa(x,i),d-i-1}\)&lt;/span&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;æ­¤æ—¶å°±å¯ä»¥ä¸é‡ä¸æ¼ã€‚å½“ç„¶ï¼Œä¹Ÿä¼šå­˜åœ¨ä¸€äº›ç»†èŠ‚ï¼šæ¯”å¦‚è¯´ &lt;span class=&#34;math inline&#34;&gt;\(fa(x,i)\)&lt;/span&gt; ä¸å­˜åœ¨ä¹‹ç±»ã€‚åªéœ€è¦åœ¨æ ¹èŠ‚ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¤„å°†å‰©ä½™çš„ &lt;span class=&#34;math inline&#34;&gt;\(S_{1,i\to 0}\)&lt;/span&gt; å…¨éƒ¨æ›´æ–°å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ•…æ¯æ¬¡ä¿®æ”¹æ“ä½œåªéœ€è¦ä¿®æ”¹ &lt;span class=&#34;math inline&#34;&gt;\(O(d)\)&lt;/span&gt; å¨ç‚¹ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(qd)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f.-distance-to-the-path&#34;&gt;F. Distance to the Path&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1749/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1749/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ¬ä¾‹ä¸­å°†å•ç‚¹ä¿®æ”¹æ›¿æ¢ä¸ºè·¯å¾„ä¿®æ”¹ï¼›è€ƒè™‘æ ‘å‰–è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè·¯å¾„ä¸Šçš„æ‰€æœ‰ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œå®¹æ˜“å‘ç°åªéœ€è¦ä¿®æ”¹æ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(S_{u,d}\)&lt;/span&gt; å°±å¯ä»¥å®Œæˆå¯¹ã€&lt;strong&gt;ä¸€éƒ¨åˆ†è·¯å¾„å†…ä¾§çš„ç‚¹&lt;/strong&gt;ã€çš„ä¿®æ”¹ã€‚è¿™ã€ä¸€éƒ¨åˆ†ã€ï¼Œæ˜¯å› ä¸ºä¸åŒ…æ‹¬è·ç¦» LCA &lt;span class=&#34;math inline&#34;&gt;\(\le d\)&lt;/span&gt; çš„ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;è€Œã€&lt;strong&gt;å¦ä¸€éƒ¨åˆ†è·¯å¾„å†…ä¾§çš„ç‚¹&lt;/strong&gt;ï¼ˆè· LCA &lt;span class=&#34;math inline&#34;&gt;\(\le d\)&lt;/span&gt;ï¼šè§ä¸Šä¸€è¡Œè¯´æ˜ï¼‰ã€åŠã€&lt;strong&gt;è·¯å¾„å¤–ä¾§çš„ç‚¹&lt;/strong&gt;ï¼ˆè· LCA &lt;span class=&#34;math inline&#34;&gt;\(\le d\)&lt;/span&gt;ï¼šå› ä¸ºè·¯å¾„åœ¨ LCA å­æ ‘å†…ï¼ŒLCA èƒ½å¤Ÿåˆ°æœ€è¿œçš„å¤–ä¾§ç‚¹ï¼‰ã€ï¼Œç­‰ä»·äºã€&lt;strong&gt;è· LCA &lt;span class=&#34;math inline&#34;&gt;\(\le d\)&lt;/span&gt; çš„ç‚¹&lt;/strong&gt;ã€ï¼Œåªéœ€è¦æŠŠ LCA ä»£å…¥ä¸Šä¾‹ä¸­æ–¹å¼ä¿®æ”¹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹è·¯å¾„ä¸Šæ‰€æœ‰ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(S_{u,d}\)&lt;/span&gt; æ—¶ï¼Œå¯ä»¥å¯¹æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{*,i}\)&lt;/span&gt; å»ºç«‹æ•°æ®ç»“æ„ï¼Œç”±äºåªéœ€è¦åŒºé—´ä¿®æ”¹ã€å•ç‚¹æŸ¥è¯¢ï¼Œä½¿ç”¨å·®åˆ†æ ‘çŠ¶æ•°ç»„å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt; 
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; siz(n + 1), dep(n + 1), fa(n + 1), son(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int faa) &amp;#123;
        siz[x] = 1;
        for (auto i : g[x])
            if (i != faa) &amp;#123;
                fa[i] = x, dep[i] = dep[x] + 1;
                DFS(i, x);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::vector&amp;lt;int&amp;gt; dfn(n + 1), top(n + 1);
    DFS = [&amp;amp;](int x, int toop) &amp;#123;
        static int now = 0;
        dfn[x] = ++now, top[x] = toop;
        if (son[x])
            DFS(son[x], toop);
        for (auto i : g[x])
            if (i != fa[x] &amp;amp;&amp;amp; i != son[x])
                DFS(i, i);
        return;
    &amp;#125;;
    DFS(1, 1);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; bit(21, std::vector&amp;lt;long long&amp;gt; (n + 1));
    auto lowbit = [&amp;amp;](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](auto &amp;amp;bit, int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            bit[x] += v;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](auto &amp;amp;bit, int x) &amp;#123;
        auto res(0ll);
        for (; x; x -= lowbit(x))
            res += bit[x];
        return res;
    &amp;#125;;
    std::cin &amp;gt;&amp;gt; m;
    for (int op; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            int x;
            std::cin &amp;gt;&amp;gt; x;
            auto res(0ll);
            for (int i = 0; i &amp;lt;= 20 &amp;amp;&amp;amp; x; ++i, x = fa[x])
                res += ask(bit[i], dfn[x]);
            std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
        else &amp;#123;
            int x, y, v, d;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; v &amp;gt;&amp;gt; d;
            for (; top[x] != top[y]; x = fa[top[x]]) &amp;#123;
                if (dep[top[x]] &amp;lt; dep[top[y]])
                    std::swap(x, y);
                add(bit[d], dfn[top[x]], v);
                add(bit[d], dfn[x] + 1, -v);
            &amp;#125;
            if (dep[x] &amp;gt; dep[y])
                std::swap(x, y);
            add(bit[d], dfn[x] + 1, v), add(bit[d], dfn[y] + 1, -v);
            for (x = x, y = d; ~y &amp;amp;&amp;amp; x; x = fa[x], --y) &amp;#123;
                add(bit[y], dfn[x], v), add(bit[y], dfn[x] + 1, -v);
                if (y &amp;amp;&amp;amp; fa[x])
                    add(bit[y - 1], dfn[x], v), add(bit[y - 1], dfn[x] + 1, -v);
            &amp;#125;
            if (x == 0)
                for (; ~y; --y)
                    add(bit[y], dfn[1], v), add(bit[y], dfn[1] + 1, -v);
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---ina-of-the-mountain&#34;&gt;A - Ina of the Mountain&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1852/C&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1852/C&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘è¿™ä¹ˆä¸€ä¸ªç®€åŒ–ç‰ˆçš„é—®é¢˜ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\{a_n\}\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯ä»¥è¿›è¡ŒåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œé—®æ“ä½œå¤šå°‘æ¬¡æ‰èƒ½å°†æ‰€æœ‰å…ƒç´ å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¼šæƒ³åˆ°å·®åˆ†ï¼›å¯¹åŸæ•°ç»„è¿›è¡Œå·®åˆ†ï¼Œä¸€æ¬¡æ“ä½œç›¸å½“äºä»¤ &lt;span class=&#34;math inline&#34;&gt;\(d_l\gets d_l-1\)&lt;/span&gt; è€Œ &lt;span class=&#34;math inline&#34;&gt;\(d_{r+1}\gets d_{r+1}+1\)&lt;/span&gt;ï¼Œæœ€åè¦è®© &lt;span class=&#34;math inline&#34;&gt;\(\forall \,d_i=0\)&lt;/span&gt;ã€‚é‚£ä¹ˆç­”æ¡ˆå°±æ˜¯å·®åˆ†æ•°ç»„ä¸­æ­£æ•°ä¹‹å’Œå˜›ã€‚&lt;/p&gt;
&lt;p&gt;å›åˆ°åŸé—®é¢˜ã€‚åŸé—®é¢˜ç­‰ä»·äºæŠŠä¸Šè¿°é—®é¢˜å˜ä¸ºï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\{a_n\}\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯ä»¥è¿›è¡ŒåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œæ¯ä¸ªæ•°çš„æ€»æ“ä½œæ¬¡æ•°å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å–æ¨¡ï¼Œé—®æ“ä½œå¤šå°‘æ¬¡æ‰èƒ½å°†æ‰€æœ‰å…ƒç´ å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ€ä¹ˆå¥—å›åˆ°åˆšåˆšçš„é—®é¢˜ä¸Šå‘¢ï¼Ÿè¿˜åŸè¢«å–æ¨¡æ‰çš„æ“ä½œå³å¯ã€‚å…·ä½“æ¥è¯´ï¼Œæå‰åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; ä¸Šè¿›è¡Œè‹¥å¹²æ¬¡æ“ä½œï¼ˆè®°ä¸ºæ“ä½œ 1ï¼‰ï¼Œå½¢å¦‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(d_i\gets d_i+k\)&lt;/span&gt;ï¼ŒåŒæ—¶ &lt;span class=&#34;math inline&#34;&gt;\(d_{i+1}\gets d_{i+1}-k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¼šå‘ç°ç›¸é‚»çš„æ“ä½œ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¯¹ä¸€ä¸ªæ•°åŠ åŠ å‡å‡å½±å“åˆ¤æ–­ï¼›å‘ç°å¯ä»¥åˆå¹¶ä¸€æ®µè¿ç»­çš„æ“ä½œ 1ï¼Œè¡¨ç°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸Šä¹Ÿå°±æ˜¯åŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\(+k\)&lt;/span&gt;ã€‚æ­¤æ—¶å¯ä»¥å‘ç°ï¼Œä¸€ä¸ªä½ç½®ä¸Šåªä¼šå‰©ä¸‹è‹¥å¹²æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(+k\)&lt;/span&gt; æˆ–è‹¥å¹²æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(-k\)&lt;/span&gt; ï¼ˆå¦åˆ™å¯ä»¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(+k\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(-k\)&lt;/span&gt; ä»£è¡¨çš„ä¸åŒæ“ä½œåˆå¹¶ï¼‰ï¼Œå°±ä¸ä¼šæœ‰äº’ç›¸å½±å“ä¸€è¯´äº†ã€‚è¿™ä¹Ÿæ˜¯æœ‰çš„é¢˜è§£è¯´å¯ä»¥æå‰åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸ŠåŒºé—´ &lt;span class=&#34;math inline&#34;&gt;\(+k\)&lt;/span&gt; çš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶é—®é¢˜å˜ä¸ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; è¿›è¡Œä»»æ„æ¬¡å‰åŠ  &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; åå‡ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„æ“ä½œï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{d_i&amp;gt;0}d_i\)&lt;/span&gt; æœ€å¤§åŒ–ã€‚é‚£ä¹ˆæ˜¾ç„¶å¦‚æœè¦ä½¿ä»£ä»·æ›´å°ï¼Œåªå¯èƒ½åœ¨åŸæœ¬ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;0\)&lt;/span&gt; çš„ä½ç½®åšåŠ æ³•ã€&lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;0\)&lt;/span&gt; çš„ä½ç½®åšå‡æ³•ï¼ˆå…¶ä»–æƒ…å†µä¼šå‘ç°ä¸€å®šä¸ä¼˜ï¼‰ã€‚è€ƒè™‘ä¸¤ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(d_l,d_r\)&lt;/span&gt;ï¼Œå¯ä»¥æ„Ÿå—åˆ°å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œé€‰æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(d_l\)&lt;/span&gt; æ˜¯æœ€ä¼˜çš„ï¼Œä½†ä»€ä¹ˆæ—¶å€™åº”è¯¥é€‰å‘¢ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(d_l\le -k,d_r\ge k\)&lt;/span&gt;ï¼šå½“ç„¶å¯é€‰ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è¢«å®Œå…¨åˆ©ç”¨ï¼Œç­”æ¡ˆå‡å°‘ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(d_l&amp;gt;-k,d_r\ge k\)&lt;/span&gt;ï¼šæ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æœªè¢«å®Œå…¨åˆ©ç”¨ï¼Œä½†å¿…é¡»é€‰ï¼šé€‰æ‹©å…¶ä»–æ›´å¤§çš„æ•°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„åˆ©ç”¨ç‡åªä¼šæ›´ä½ï¼›å¦‚æœä¸é€‰ï¼Œç­”æ¡ˆä¹Ÿæ— æ³•å‡å°‘ã€‚&lt;/p&gt;
&lt;p&gt;Qï¼šæ­¤æ—¶æ˜¯å¦éœ€è¦å°è¯•æ‰¾åˆ°ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(l&amp;#39;&amp;lt;l\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; åšæ“ä½œï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; é‡æ–°å˜ä¸ºè´Ÿæ•°å‘¢ï¼Ÿ&lt;/p&gt;
Aï¼šå¦ã€‚å› ä¸ºä½ å¯ä»¥å°†è¿™ä¸¤æ¬¡æ“ä½œåˆå¹¶ï¼Œå‘ç°ç›¸å½“äºæ˜¯ç›´æ¥å¯¹ &lt;span class=&#34;math inline&#34;&gt;\((l&amp;#39;,r)\)&lt;/span&gt; åšæ“ä½œï¼Œæ˜¯æ›´åŠ£çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(d_l\le -k,d_r&amp;lt;k\)&lt;/span&gt;ï¼šæ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æœªè¢«å®Œå…¨åˆ©ç”¨ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(d_r\)&lt;/span&gt; æˆä¸ºè´Ÿæ•°ã€‚è¿™æ„å‘³ç€ &lt;span class=&#34;math inline&#34;&gt;\(d_r\)&lt;/span&gt; å°†ä¼šæˆä¸ºæŸä¸ª &lt;span class=&#34;math inline&#34;&gt;\(r&amp;#39;\)&lt;/span&gt; çš„å¯é€‰é¡¹ã€‚è€ƒå¯Ÿ &lt;span class=&#34;math inline&#34;&gt;\(d_{r&amp;#39;}\)&lt;/span&gt; å¯ç”¨çš„æœ€å°å€¼ã€‚å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(d_r\)&lt;/span&gt; åœ¨å½“å‰ä¸åº”è¯¥ä½œä¸ºå³ç«¯ç‚¹ï¼Œå®ƒå°±ä¸€å®šä¼šè¢« &lt;span class=&#34;math inline&#34;&gt;\(d_{r&amp;#39;}\)&lt;/span&gt; é€‰æ‹©ã€‚å…·ä½“çš„æœ‰ç‚¹æŠ½è±¡ï¼Œä½†æ˜¯ä½ å¯ä»¥ç†è§£ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d_r\)&lt;/span&gt; é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(d_l\)&lt;/span&gt; çš„è´¡çŒ®æ˜¯è¢«æ•´åˆåˆ° &lt;span class=&#34;math inline&#34;&gt;\(d_r\)&lt;/span&gt; é‡Œçš„ï¼›å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(d_r\)&lt;/span&gt; è¢«é€‰äº†å°±è¯´æ˜ &lt;span class=&#34;math inline&#34;&gt;\(d_{r&amp;#39;}\)&lt;/span&gt; é€‰ &lt;span class=&#34;math inline&#34;&gt;\(d_l\)&lt;/span&gt; ä¼šæ‹¥æœ‰æ›´å¤§çš„ä¼˜åŠ¿ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(d_l&amp;gt;-k,d_r&amp;lt;k\)&lt;/span&gt;ï¼šå’Œä¸Šé¢çš„æƒ…å†µç›¸ä¼¼ï¼›ä½†è¿™ç§æƒ…å†µä¸‹ç­”æ¡ˆå¯èƒ½åè€Œå˜å¾—æ›´å¤§ï¼Œå› ä¸ºæ²¡æœ‰åæ•ˆæ€§ï¼Œæ‰€ä»¥è‡³å°‘è¦ä¿è¯å•æ­¥æœ€ä¼˜ã€‚æ­¤æ—¶ä¸èƒ½é€‰ã€‚&lt;/p&gt;
&lt;p&gt;è¯´åˆ°å•æ­¥æœ€ä¼˜ï¼Œå°±ä¼šå‘ç°è¿™é‡Œå°±æ˜¯åæ‚”è´ªå¿ƒï¼›å•æ­¥æœ€ä¼˜ä¸€å®šæ˜¯å…¨å±€æœ€ä¼˜ï¼Œä½†æ›´é å‰çš„å±€éƒ¨æœ€ä¼˜å¯èƒ½è¢«å¦å®šæ‰ã€‚è€Œã€å¦å®šã€çš„æ–¹æ³•è¡¨ç°ä¸ºä¸€æ¬¡æ“ä½œã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç»¼ä¸Šï¼Œä»å‰å¾€åæ‰«ï¼Œä¼˜å…ˆé˜Ÿåˆ—å®æ—¶ç»´æŠ¤è´Ÿæ•°æœ€å°å€¼ï¼Œå¯¹äºæ¯ä¸ªæ­£æ•°ï¼Œcheck é€‰æœ€å°å€¼æ˜¯å¦ä¼˜äºå½“å‰ç­”æ¡ˆï¼Œæœ‰å°±é€‰ã€‚å¦‚æœæ­£æ•°è¢«å‡ä¸ºè´Ÿï¼ŒåŠ å…¥é˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, k;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
        std::vector&amp;lt;int&amp;gt; a(n + 1), d(n + 1);
        long long res(0ll);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; a[i], a[i] %= k;
            d[i] = a[i] - a[i - 1];
            if (d[i] &amp;gt; 0)
                (res += d[i]);
        &amp;#125;
        std::priority_queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (d[i] &amp;lt; 0)
                q.push(-d[i]);
            else &amp;#123;
                for (; !q.empty() &amp;amp;&amp;amp; d[i] &amp;gt; 0; ) &amp;#123;
                    int x = -q.top(), y = d[i];
                    auto t(res - y);
                    x += k, y -= k;
                    if (x &amp;gt; 0)
                        t += x;
                    if (y &amp;gt; 0)
                        t += y;
                    if (t &amp;gt;= res)
                        break;
                    q.pop();
                    res = t, d[i] = y;
                    if (d[i] &amp;lt; 0)
                        q.push(-d[i]);
                &amp;#125;
            &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---miriany-and-matchstick&#34;&gt;B - Miriany and Matchstick&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1852/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1852/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»æ„é€ çš„è§’åº¦å‡ºå‘ï¼Œçœ‹åˆ°ã€æ°å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€ï¼Œä¼šæƒ³åˆ°æ‰¾åˆ°ä¸Šç•Œå’Œä¸‹ç•Œå¹¶è¯æ˜ä¸­é—´æ¯ä¸€ä¸ªæ•°éƒ½èƒ½å–åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;ä½†ä¼¼ä¹å¾ˆå®¹æ˜“è¯ä¼ªï¼šä¾‹å¦‚å¯¹äº &lt;code&gt;AAAA&lt;/code&gt;ï¼Œä¸‹ç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä¸Šç•Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt;ï¼Œä½†æœ‰ä¸”ä»…æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å–ä¸åˆ°ã€‚ä½†è¯¥æƒ³æ³•å¹¶æœªç ´äº§â€”â€”å¯ä»¥æ„Ÿå—åˆ°è¿™æ ·çš„ä½ç½®å¾ˆå°‘ã€‚è¿›ä¸€æ­¥åœ°ï¼Œä½  &lt;a href=&#34;https://www.luogu.com.cn/article/2mmg5rjd&#34;&gt;å¯ä»¥è¯æ˜åªæœ‰ä¸€ä¸ªè¿™æ ·çš„ä½ç½®&lt;/a&gt;ï¼Œä¹Ÿå¯ä»¥ &lt;a href=&#34;https://www.luogu.com.cn/article/679cwjgl&#34;&gt;å¤§èƒ†çŒœæƒ³è¿™æ ·çš„ä½ç½®ä¸€å®šå‡ºç°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(l+1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(r-1\)&lt;/span&gt;&lt;/a&gt;ã€‚æ€»ä¹‹ç°åœ¨æˆ‘ä»¬çš„çŠ¶æ€å°±å‡å°‘äº†ï¼ˆæˆ–è€…è¯´çŠ¶æ€å˜æˆ DP å€¼äº†ï¼‰ã€‚é¢„å¤„ç†å‡ºè¿™ä¸ªä¸œè¥¿ä¹‹åå¤§åŠ›æœç´¢æ‰¾æ–¹æ¡ˆå³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, k;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
        std::vector&amp;lt;int&amp;gt; a(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            char t;
            std::cin &amp;gt;&amp;gt; t, a[i] = (t == &amp;#39;A&amp;#39;);
            if (i &amp;gt;= 2)
                k -= (a[i] ^ a[i - 1]);
        &amp;#125;
        std::vector&amp;lt;std::array&amp;lt;std::tuple&amp;lt;int, int, int&amp;gt;, 2&amp;gt; &amp;gt; f(n + 1);
        f[n][0] = &amp;#123; a[n], a[n], 0 &amp;#125;, f[n][1] = &amp;#123; !a[n], !a[n], 0 &amp;#125;;
        auto merge = [&amp;amp;](int i, int l0, int r0, int p0, int l1, int r1, int p1) &amp;#123;
            if (l0 &amp;gt; l1)
                std::swap(l0, l1), std::swap(r0, r1), std::swap(p0, p1);
            int l = l0, r = std::max(r0, r1), p = 0;
            if (!p0 &amp;amp;&amp;amp; !p1) &amp;#123;
                if (r0 &amp;lt; l1 - 1)
                    assert(r0 == l1 - 2), p = r0 + 1;
                else;
            &amp;#125;
            else if (p0 &amp;amp;&amp;amp; p1) &amp;#123;
                if (p0 == p1)
                    p = p0;
                else &amp;#123;
                    int tag0 = (l1 &amp;lt;= p0 &amp;amp;&amp;amp; p0 &amp;lt;= r1), tag1 = (l0 &amp;lt;= p1 &amp;amp;&amp;amp; p1 &amp;lt;= r0);
                    if (!tag0 &amp;amp;&amp;amp; !tag1);
                    else if (!tag0)
                        p = p0;
                    else if (!tag1)
                        p = p1;
                    else;
                &amp;#125;
            &amp;#125;
            else if (p0) &amp;#123;
                if (l1 &amp;lt;= p0 &amp;amp;&amp;amp; p0 &amp;lt;= r1);
                else
                    p = p0;
            &amp;#125;
            else &amp;#123;
                if (l0 &amp;lt;= p1 &amp;amp;&amp;amp; p1 &amp;lt;= r0);
                else
                    p = p1;
            &amp;#125;
            assert(p != l &amp;amp;&amp;amp; p != r &amp;amp;&amp;amp; l &amp;lt;= r);
            return std::make_tuple(l, r, p);
        &amp;#125;;
        for (int i = n - 1; i; --i) &amp;#123;
            &amp;#123;
                auto [l0, r0, p0] = f[i + 1][0];
                auto [l1, r1, p1] = f[i + 1][1];
                if (a[i]) &amp;#123;
                    ++l0, ++r0, ++l1, ++r1;
                    if (p0) ++p0;
                    if (p1) ++p1;
                &amp;#125;
                ++l1, ++r1;
                if (p1) ++p1;
                f[i][0] = merge(i, l0, r0, p0, l1, r1, p1);
            &amp;#125;
            &amp;#123;
                auto [l0, r0, p0] = f[i + 1][0];
                auto [l1, r1, p1] = f[i + 1][1];
                if (!a[i]) &amp;#123;
                    ++l0, ++r0, ++l1, ++r1;
                    if (p0) ++p0;
                    if (p1) ++p1;
                &amp;#125;
                ++l0, ++r0;
                if (p0) ++p0;
                f[i][1] = merge(i, l0, r0, p0, l1, r1, p1);
            &amp;#125;
        &amp;#125;
        std::vector&amp;lt;int&amp;gt; res(n + 1);
        std::function&amp;lt;bool(int, int, int)&amp;gt; DFS = [&amp;amp;](int x, int cnt, int la) &amp;#123;
            if (x == n + 1)
                return cnt == k;
            auto [l0, r0, p0] = f[x][0];
            auto [l1, r1, p1] = f[x][1];
            if (cnt + (la == 1) + l0 &amp;lt;= k &amp;amp;&amp;amp; cnt + (la == 1) + r0 &amp;gt;= k &amp;amp;&amp;amp; (!p0 || cnt + (la == 1) + p0 != k) &amp;amp;&amp;amp; DFS(x + 1, cnt + (la == 1) + a[x], 0))
                res[x] = 0;
            else if (cnt + !la + l1 &amp;lt;= k &amp;amp;&amp;amp; cnt + !la + r1 &amp;gt;= k &amp;amp;&amp;amp; (!p1 || cnt + !la + p1 != k) &amp;amp;&amp;amp; DFS(x + 1, cnt + !la + !a[x], 1))
                res[x] = 1;
            else
                return false;
            return true;
        &amp;#125;;
        if (DFS(1, 0, -1)) &amp;#123;
            std::cout &amp;lt;&amp;lt; &amp;quot;YES\n&amp;quot;;
            for (int i = 1; i &amp;lt;= n; ++i)
                std::cout &amp;lt;&amp;lt; (res[i] ? &amp;#39;A&amp;#39; : &amp;#39;B&amp;#39;);
            std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
        else
            std::cout &amp;lt;&amp;lt; &amp;quot;NO\n&amp;quot;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="å®¹æ–¥åŸç†" />
        <category term="æ ‘é“¾å‰–åˆ†" />
        <category term="åæ‚”è´ªå¿ƒ" />
        <updated>2025-05-10T02:18:21.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250421/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250421/"/>
        <content type="html">&lt;figure&gt;
&lt;img src=&#34;/20250421/neko.png&#34; alt=&#34;çŒ«&#34; style=&#34;width: 75px&#34;&gt;
&lt;figcaption&gt;
çŒ«
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---t-shirt&#34;&gt;A - T-shirt&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/183/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/183/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœçŸ¥é“ä¸€ä¸ªè¡£æœåºåˆ—ï¼Œæ€ä¹ˆç®—å‡ºæœŸæœ›å‘¢ï¼Ÿ&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---two-melodies&#34;&gt;B - Two Melodies&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/813/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/813/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ä¸€ä¸ªä»¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾ï¼Œç¬¬äºŒä¸ªä»¥ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ç»“å°¾çš„æ–¹æ¡ˆæ•°ï¼Œå°±ä¼šæœ‰ä¸€ä¸ªå¼Šç«¯â€”â€”å‡è®¾ç°åœ¨æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;gt;j\)&lt;/span&gt;ï¼Œåˆå‡è®¾æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j&amp;lt;j&amp;#39;&amp;lt;i\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°±ä¸å¯ä»¥ç›´æ¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è½¬ç§»åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j&amp;#39;}\)&lt;/span&gt;ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\)&lt;/span&gt; å¯èƒ½å·²ç»è¢«ç¬¬ä¸€ä¸ªé€‰è¿‡äº†ã€‚ä½†å¦‚æœä» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è½¬ç§»å°±æ²¡æœ‰è¿™æ ·çš„é—®é¢˜ï¼ˆä¸ç®¡ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;#39;\)&lt;/span&gt; æ˜¯æ¯” &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¤§è¿˜æ˜¯æ¯” &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å°ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‚£å°±å¯ä»¥å›ºå®šä»è¾ƒå¤§çš„ä¸€ç»´è½¬ç§»ï¼Œä¹Ÿå¯ä»¥æšä¸¾æ‰€æœ‰æƒ…å†µã€‚ä½†æ˜¯è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n^3\)&lt;/span&gt; çš„è¿‡ç¨‹ï¼Œè€Œä¸”å¯¹äºä¸å•è°ƒçš„å†…å±‚ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œç»´æŠ¤å®ƒçš„æ•°å€¼åªèƒ½ç”¨å¸¦ &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; çš„æ•°æ®ç»“æ„ä¼˜åŒ–ï¼Œä¼¼ä¹ä¸å¤ªè¿‡å¾—äº†ï¼›ä½† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å´å¯ä»¥å‰ç¼€ä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;å…¶å®ï¼Œä¸¤ä¸ªç»„æ˜¯æ— åºçš„ï¼Œè¿™æ„å‘³ç€å¯ä»¥å¼ºåˆ¶ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;gt;j\)&lt;/span&gt; å†ä» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è½¬ç§»ï¼›è¿™ä¸ªæ—¶å€™è½¬ç§»å°±å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ²¡æœ‰å¤ªå¤§çš„å…³ç³»äº†ï¼Œå¯ä»¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ”¾åˆ°å¤–å±‚ï¼Œå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å‰ç¼€ä¼˜åŒ–ã€‚å¯èƒ½éœ€è¦æ³¨æ„è¾¹ç•Œçš„å¤„ç†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, res = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int j = 0; j &amp;lt; n; ++j) &amp;#123;
        std::vector&amp;lt;int&amp;gt; mx(100002), mmx(7);
        for (int i = 1; i &amp;lt; j; ++i) &amp;#123;
            mx[a[i]] = std::max(mx[a[i]], f[j][i]);
            mmx[a[i] % 7] = std::max(mmx[a[i] % 7], f[j][i]);
        &amp;#125;
        for (int i = j + 1; i &amp;lt;= n; ++i) &amp;#123;
            f[i][j] = std::max(&amp;#123; !!i + !!j, mx[a[i] - 1] + 1, mx[a[i] + 1] + 1, mmx[a[i] % 7] + 1, f[j][0] + 1 &amp;#125;);
            mx[a[i]] = std::max(mx[a[i]], f[i][j]);
            mmx[a[i] % 7] = std::max(mmx[a[i] % 7], f[i][j]);
            // printf(&amp;quot;f[%d][%d] = %d\n&amp;quot;, i, j, f[i][j]);
            res = std::max(res, f[i][j]);
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;cf633f-the-chocolate-spree&#34;&gt;CF633F The Chocolate Spree&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/633/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/633/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ ‘å½¢ DP æ±‚ç›´å¾„çš„æ—¶å€™ï¼Œæœ‰ä¸€ç§æ–¹æ³•æ˜¯æ‰¾åˆ°æ¯ä¸ªç‚¹ä¸‹é¢çš„æœ€å¤§ä¸¤æ¡ä¸äº¤é“¾ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä¹Ÿå¯ä»¥æœ‰ç±»ä¼¼çš„æ±‚æ³•ã€‚å‡è®¾ç­”æ¡ˆå‡ºç°åœ¨å­æ ‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸­ï¼ˆä¸‹é¢çš„ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ç›´æ¥å„¿å­ï¼‰ï¼Œå¯ä»¥è®¨è®º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å‚ä¸æ„æˆä¸¤æ¡è·¯å¾„çš„æƒ…å†µï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;ä¸å‚ä¸æ„æˆä»»ä½•ä¸€æ¡è·¯å¾„ï¼Œç­”æ¡ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(v_1,v_2\)&lt;/span&gt; å­æ ‘ä¸­çš„æœ€é•¿è·¯å¾„ä¹‹å’Œã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‚ä¸æ„æˆå…¶ä¸­ä¸€æ¡ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;è¿™ä¸€æ¡ä¸å­æ ‘ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å®Œå…¨ç›¸ç¦»ï¼Œç­”æ¡ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; ä¸­æœ€é•¿è·¯å¾„ï¼Œå’Œ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸‹é¢ä¸ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æœ€å¤§ä¸¤æ¡ä¸äº¤é“¾ã€‚&lt;/li&gt;
&lt;li&gt;è¿™ä¸€æ¡æœ‰ä¸€æ”¯æ¥è‡ª &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å­æ ‘ï¼Œä½†å’Œ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; ä¸­æœ€é•¿è·¯å¾„æ²¡æœ‰é‡åˆçš„ç‚¹ã€‚ç­”æ¡ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ç‚¹æƒã€&lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸‹é¢ä¸ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æœ€å¤§é“¾ã€&lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; ä¸­ä¸€æ¡è·¯å¾„ï¼ˆä¸ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼‰å’Œ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; ä¸‹é¢ä¸€æ¡é“¾ä¹‹å’Œçš„æœ€å¤§å€¼ï¼›&lt;/li&gt;
&lt;li&gt;è¿™ä¸€æ¡ä¸¤æ”¯éƒ½æ¥è‡ª &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å­æ ‘ï¼šæœ‰é‡åˆï¼Œä¸å¯èƒ½å‘ç”Ÿã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‚ä¸æ„æˆå…¶ä¸­ä¸¤æ¡ï¼Œç­”æ¡ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸‹é¢æœ€é•¿çš„å››æ¡é“¾ï¼šè·¯å¾„é‡å¤ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œä¸å¯èƒ½å‘ç”Ÿã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;2.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥è®°å½• &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸‹æ–¹æœ€å¤§çš„å››æ¡ä¸äº¤é“¾ã€&lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸­é€‰å–ä¸€æ¡ä¸ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„è·¯å¾„å’Œ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸‹æ–¹ä¸€æ¡é“¾ä¹‹å’Œçš„æœ€å¤§å€¼ã€&lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸­æœ€é•¿è·¯å¾„æ±‚è§£ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp language-cpp&#34; data-line=&#34;42-44&#34;&gt;&lt;code class=&#34;cpp langauage-cpp&#34;&gt;#include &amp;lt;bits/stdc++.h&gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&#34;.in&#34;, &#34;r&#34;, stdin);
    std::freopen(&#34;.out&#34;, &#34;w&#34;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    std::vector&amp;lt;int&gt; a(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&gt; &gt; g(n + 1);
    for (int i = 1; i &lt;= n; ++i)
        std::cin &gt;&gt; a[i];
    for (int i = 1, x, y; i &lt; n; ++i) &amp;#123;
        std::cin &gt;&gt; x &gt;&gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    auto res(0ll);
    std::vector&amp;lt;long long&gt; s(n + 1), w(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;long long, int&gt; &gt; &gt; f(n + 1, std::vector&amp;lt;std::pair&amp;lt;long long, int&gt; &gt; (4));
    std::function&amp;lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &amp;#123;
        f[x][0] = &amp;#123; 0, x &amp;#125;;
        w[x] = s[x] = a[x];
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                &amp;#123;
                    if (f[i][0].first + a[i] &gt; f[x][3].first)
                        f[x][3].first = f[i][0].first + a[i], f[x][3].second = i;
                    std::sort(f[x].begin(), f[x].end(), std::greater&amp;lt;std::pair&amp;lt;long long, int&gt; &gt; ());
                &amp;#125;
                w[x] = std::max(w[x], w[i] + a[x]);
            &amp;#125;
        auto mx(0ll);
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                s[x] = std::max(&amp;#123; s[x], s[i], f[x][0].first + f[x][1].first + a[x] &amp;#125;);
                w[x] = std::max(w[x], (f[x][0].second != i ? f[x][0] : f[x][1]).first + s[i] + a[x]);
                res = std::max(&amp;#123; res,
                    mx + s[i], // æƒ…å†µ 1
                    (f[x][0].second == i ? f[x][1].first + f[x][2].first : (f[x][1].second == i ? f[x][0].first + f[x][2].first : f[x][0].first + f[x][1].first)) + s[i] + a[x], // æƒ…å†µ 2.1
                    (f[x][0].second == i ? f[x][1].first : f[x][0].first) + w[i] + a[x], // æƒ…å†µ 2.2
                &amp;#125;);
                mx = std::max(mx, s[i]);
            &amp;#125;
    //     printf(&#34;%d: res = %lld\n  f: \n&#34;, a[x], res);
    //     for (int i = 0; i &lt; 4; ++i)
    //         printf(&#34;    [%d] %lld\n&#34;, f[x][i].second, f[x][i].first);
    //     printf(&#34;  s: %lld\n  w: %lld\n&#34;, s[x], w[x]);
    &amp;#125;;
    DFS(1, -1);
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---å·¡é€»&#34;&gt;C - å·¡é€»&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3629&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3629&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä½ å¯èƒ½éœ€è¦æ³¨æ„ï¼šç›®çš„æ˜¯éå†æ‰€æœ‰è¾¹è€Œéæ‰€æœ‰ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(K=1\)&lt;/span&gt; çš„æ—¶å€™ï¼Œç¯ä¸Šé™¤äº†å…³é”®è¾¹çš„æ‰€æœ‰è¾¹ç»è¿‡æ¬¡æ•°ä¼šå‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚æ‰€ä»¥é€‰æ ‘çš„ç›´å¾„å°±å¯ä»¥æœ€ä¼˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(K=2\)&lt;/span&gt; çš„æ—¶å€™ï¼Œç­”æ¡ˆæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(2\times (m + 2)\)&lt;/span&gt; å‡å»ä¸¤ä¸ªè¾¹æ„æˆçš„ç¯çš„ &lt;em&gt;å¹¶é›†å‡äº¤é›†&lt;/em&gt; å¤§å° &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt;ã€‚ç¯å®é™…ä¸Šæ˜¯ä¸å­˜åœ¨çš„ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; å…¶å®æ˜¯ä¸¤æ¡è·¯å¾„ &lt;em&gt;å¹¶é›†å‡äº¤é›†&lt;/em&gt; å†åŠ ä¸Šä¸¤æ¡æ–°è¾¹çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤æ¡è·¯å¾„æœ‰äº¤çš„æ—¶å€™ï¼Œå¯ä»¥ç­‰æ•ˆæˆæ— äº¤çš„æƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;1.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å°±åŒ–å½’æˆä¸Šä¸€ä¸ªé—®é¢˜äº†ã€‚æ³¨æ„æ­¤æ—¶æƒ…å†µ 3 å¯èƒ½å‘ç”Ÿï¼›åŒæ—¶æƒ…å†µ 2.2 å¯ä»¥é€‰å–ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„è·¯å¾„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp language-cpp&#34; data-line=&#34;55-56,64-67&#34;&gt;&lt;code class=&#34;cpp langauage-cpp&#34;&gt;#include &amp;lt;bits/stdc++.h&gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&#34;.in&#34;, &#34;r&#34;, stdin);
    std::freopen(&#34;.out&#34;, &#34;w&#34;, stdout);
#endif
    int n, k;
    std::cin &gt;&gt; n &gt;&gt; k;
    std::vector&amp;lt;std::vector&amp;lt;int&gt; &gt; g(n + 1);
    for (int i = 1, x, y; i &lt; n; ++i) &amp;#123;
        std::cin &gt;&gt; x &gt;&gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    int res = 0;
    if (k == 1) &amp;#123;
        std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&gt; &gt; &gt; f(n + 1, std::vector&amp;lt;std::pair&amp;lt;int, int&gt; &gt; (2));
        std::function&amp;lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &amp;#123;
            f[x][0] = &amp;#123; 0, x &amp;#125;;
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    DFS(i, x);
                    &amp;#123;
                        if (f[i][0].first + 1 &gt; f[x][1].first)
                            f[x][1].first = f[i][0].first + 1, f[x][1].second = i;
                        std::sort(f[x].begin(), f[x].end(), std::greater&amp;lt;std::pair&amp;lt;int, int&gt; &gt; ());
                    &amp;#125;
                &amp;#125;
            res = std::max(res, f[x][0].first + f[x][1].first);
        &amp;#125;;
        DFS(1, -1);
        std::cout &lt;&lt; 2 * n - res - 1 &lt;&lt; &#39;\n&#39;;
    &amp;#125;
    else &amp;#123;
        std::vector&amp;lt;int&gt; s(n + 1), w(n + 1);
        std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&gt; &gt; &gt; f(n + 1, std::vector&amp;lt;std::pair&amp;lt;int, int&gt; &gt; (4));
        std::function&amp;lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &amp;#123;
            f[x][0] = &amp;#123; 0, x &amp;#125;;
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    DFS(i, x);
                    &amp;#123;
                        if (f[i][0].first + 1 &gt; f[x][3].first)
                            f[x][3].first = f[i][0].first + 1, f[x][3].second = i;
                        std::sort(f[x].begin(), f[x].end(), std::greater&amp;lt;std::pair&amp;lt;int, int&gt; &gt; ());
                    &amp;#125;
                    w[x] = std::max(w[x], w[i] + 1);
                &amp;#125;
            &amp;#123;
                int t = 0;
                for (auto [v, id] : f[x])
                    t += v;
                res = std::max(res, t); // æƒ…å†µ 3
                w[x] = std::max(w[x], t - f[x][3].first); // è·¯å¾„å¯ç»è¿‡ u
            &amp;#125;
            int mx = 0;
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    s[x] = std::max(&amp;#123; s[x], s[i], f[x][0].first + f[x][1].first &amp;#125;);
                    w[x] = std::max(w[x], (f[x][0].second != i ? f[x][0] : f[x][1]).first + std::max(s[i], f[i][0].first + 1));
                    res = std::max(&amp;#123; res,
                        mx + s[i], // æƒ…å†µ 1
                        (f[x][0].second == i ? f[x][1].first + f[x][2].first : (f[x][1].second == i ? f[x][0].first + f[x][2].first : f[x][0].first + f[x][1].first)) + s[i], // æƒ…å†µ 2.1
                        (f[x][0].second == i ? f[x][1].first : f[x][0].first) + w[i] + 1, // æƒ…å†µ 2.2
                    &amp;#125;);
                    mx = std::max(mx, s[i]);
                &amp;#125;
        &amp;#125;;
        DFS(1, -1);
        std::cout &lt;&lt; 2 * (n + 1) - res - 2 &lt;&lt; &#39;\n&#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---ç¬é—´ä¼ é€-teleport&#34;&gt;D - ç¬é—´ä¼ é€ / Teleport&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11915&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11915&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦è§‚å¯Ÿåˆ°ä¸€ä¸ªå¾ˆå‰å®³çš„è´ªå¿ƒç­–ç•¥ï¼šå¦‚æœé’¦å®šæ‰€æœ‰ç‚¹çš„è·ç¦»ä¸å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼Œä¸”å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(d(i,j)&amp;gt;r\)&lt;/span&gt;ã€‚&lt;strong&gt;å‡è®¾&lt;/strong&gt; ä¸€ç§æ»¡è¶³æ¡ä»¶çš„æ–°è¾¹æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt;ï¼ˆç”±äºä¸¤è€…æ— åºï¼Œä¸å¦¨é’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(d(i,u)&amp;lt;d(i,v)\)&lt;/span&gt;ï¼‰ï¼Œå¯ä»¥è¿›è¡Œè®¨è®ºï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(d(j,v)&amp;lt;d(j,u)\)&lt;/span&gt;ï¼š&lt;/p&gt;
æ­¤æ—¶æœ€ä¼˜è·¯å¾„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\to u\to v\to j\)&lt;/span&gt;ï¼Œåˆ¤æ–­ä¸€ä¸‹è¿™ç§æ–¹æ¡ˆæ˜¯å¦ä¸å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å°±å¯ä»¥äº†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(d(j,v)\ge d(j, u)\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ä¸ç®¡æ˜¯èµ° &lt;span class=&#34;math inline&#34;&gt;\(i\to u\to v\to j\)&lt;/span&gt; è¿˜æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(i\to v\to u\to j\)&lt;/span&gt; éƒ½ä¸å¦‚èµ°å·²ç»å­˜åœ¨çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\to u\to j\)&lt;/span&gt; è¿™æ¡è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœè¦èµ°æ–°è¾¹ï¼Œä»£ä»·æ˜¯ä¸€å®šæ¯”åŸè·ç¦»å¤§ï¼Œæ›´æ˜¯æ¯” &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¤§çš„ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt; ä¸èƒ½è§£å†³ &lt;span class=&#34;math inline&#34;&gt;\((i,j)\)&lt;/span&gt; ä¹‹é—´çš„é—®é¢˜ï¼Œå‡è®¾å°±ä¸æˆç«‹äº†ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç»¼ä¸Šï¼Œåªéœ€è¦åˆ¤æ–­ &lt;span class=&#34;math inline&#34;&gt;\(i\to u\to v\to j\le r\)&lt;/span&gt; æ˜¯å¦æˆç«‹ï¼Œå°±å¯ä»¥åˆ¤æ–­ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt; æ˜¯å¦åˆæ³•ã€‚ä»å¤§åˆ°å°æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼ŒåŒæ—¶ç»´æŠ¤å½“å‰ä¾ç„¶åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt;ï¼ˆæ˜¾ç„¶æ˜¯æœ‰å•è°ƒæ€§çš„ï¼‰ï¼Œå¯¹äºä¸åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\((i,j)\)&lt;/span&gt;ï¼Œæšä¸¾æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(\max\{d(v,j)\}\)&lt;/span&gt;ï¼Œç²¾ç»†å®ç°ï¼ˆä¸»è¦æ˜¯åˆ©ç”¨å„ç§å‡æ‘Šï¼‰ä¸€ä¸‹å°±èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå…·ä½“æä¸€ä¸‹éœ€è¦æ‘Šçš„å‡ ä¸ªç‚¹ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;æšä¸¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„æ—¶å€™ç”¨æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(d(i,j)=r+1\)&lt;/span&gt; æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„çš„æœ€å¤§ &lt;span class=&#34;math inline&#34;&gt;\(d(v,j)\)&lt;/span&gt; æ›´æ–°ï¼Œæ–¹ä¾¿åé¢ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; åœ° checkã€‚æ‘Šå‡ºæ¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt; çš„ã€‚&lt;/li&gt;
&lt;li&gt;æšä¸¾ä»ç„¶å¤„åœ¨åˆæ³•é˜Ÿåˆ—é‡Œçš„ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt;ï¼Œå¦‚æœ check åˆæ³•ï¼Œå°±è¯´æ˜å¯¹äºå½“å‰ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; è‡³å°‘å­˜åœ¨ä¸€ä¸ªåˆæ³•è§£ï¼Œå°±å¯ä»¥ &lt;code&gt;break&lt;/code&gt; äº†ï¼›å¦åˆ™ï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\((u,v)\)&lt;/span&gt; å¼¹å‡ºï¼Œç»§ç»­ check ä¸‹ä¸€æ¡è¾¹ã€‚è¿™æ ·æ¯æ¡è¾¹åªä¼šè¢«å¼¹å‡ºä¸€æ¬¡ï¼Œè€Œæœªå¼¹å‡ºè¾¹çš„ check æ¬¡æ•°æœ€å¤šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ï¼›åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ checkï¼Œæ‘Šå‡ºæ¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt; çš„ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n;
        std::cin &amp;gt;&amp;gt; n;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1, inf));
        for (int i = 1; i &amp;lt;= n; ++i)
            for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
                char t;
                std::cin &amp;gt;&amp;gt; t;
                if (t == &amp;#39;1&amp;#39; || i == j)
                    g[i][j] = t - &amp;#39;0&amp;#39;;
            &amp;#125;
        for (int k = 1; k &amp;lt;= n; ++k)
            for (int i = 1; i &amp;lt;= n; ++i)
                if (i != k)
                    for (int j = 1; j &amp;lt;= n; ++j)
                        if (j != i &amp;amp;&amp;amp; j != k)
                            g[i][j] = std::min(g[i][j], g[i][k] + g[k][j]);
        std::queue&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; q;
        std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; p(n + 1);
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; mx(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
        for (int i = 1; i &amp;lt; n; ++i)
            for (int j = i + 1; j &amp;lt;= n; ++j) &amp;#123;
                q.emplace(i, j);
                p[g[i][j] - 1].emplace_back(i, j);
            &amp;#125;
        auto check = [&amp;amp;](int u, int v, int r) &amp;#123;
            for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
                if (g[u][i] &amp;gt; g[v][i])
                    std::swap(u, v);
                if (g[u][i] + mx[v][i] &amp;gt; r)
                    return false;
            &amp;#125;
            return true;
        &amp;#125;;
        for (int r = n; r &amp;gt;= -1; --r) &amp;#123;
            for (auto [i, j] : p[r])
                for (int v = 1; v &amp;lt;= n; ++v) &amp;#123;
                    mx[v][i] = std::max(mx[v][i], g[v][j]);
                    mx[v][j] = std::max(mx[v][j], g[v][i]);
                &amp;#125;
            for (; !q.empty(); ) &amp;#123;
                auto [u, v] = q.front();
                if (!check(u, v, r))
                    q.pop();
                else
                    break;
            &amp;#125;
            if (q.empty()) &amp;#123;
                std::cout &amp;lt;&amp;lt; r + 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
                break;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-two-tanks&#34;&gt;E. Two Tanks&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1809/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1809/E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœç„¶è¿˜æ˜¯ä¸ä¼šç®€å• DP &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥è§‚å¯Ÿåˆ°å¦‚æœæ€»æ°´é‡ç›¸åŒï¼Œä¸”æŸä¸ªæ—¶åˆ»ä¸¤ç§åˆå§‹çŠ¶æ€å½“å‰æ˜¯ç›¸åŒçŠ¶æ€ï¼Œé‚£ä¹ˆä»¥åå®ƒä»¬ä¹Ÿä¼šæ˜¯ç›¸åŒçŠ¶æ€ã€‚ä½†å…‰å‡­è¿™ä¸ªå¥½åƒè¿˜æ˜¯ä¸å¤ªèƒ½åšå‡ºæ¥çš„æ ·å­ &lt;img src=&#34;/em/kt.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå¤§æ¦‚ç®—ä¸€ä¸ªå®šå¼ï¼Œå¯¹äºç±»ä¼¼è¿™ç§ä¸¤ä¸ªå…ƒç´ æ€»å’Œä¸å˜çš„é—®é¢˜ï¼Œå¯ä»¥æŠŠä¸¤ä¸ªå…ƒç´ çš„å®¹é‡ç”»åˆ°æ•°è½´ä¸Šï¼ŒåŸç‚¹è¡¨ç¤ºåˆ†ç•Œï¼Œå½“å‰æ°´ä¸ºä¸€æ¡å®šé•¿çº¿æ®µï¼Œå€’æ°´å°±ç›¸å½“äºå·¦å³å¹³ç§»è¿™æ¡çº¿æ®µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;3.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦æ„è¯†åˆ°ï¼Œ&lt;mark&gt;&lt;/mark&gt;&lt;/p&gt;
</content>
        <category term="DP" />
        <category term="è´ªå¿ƒ" />
        <category term="å‡æ‘Š" />
        <updated>2025-04-21T06:42:31.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250407/</id>
        <title>ç»„åˆè®¡æ•°</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250407/"/>
        <content type="html">&lt;p&gt;æ¯…æ¯…ï¼šç»Ÿè®¡ä¸æ˜¯æ•°å­¦ï¼ˆæ–­ç« å–ä¹‰ edï¼‰ã€‚&lt;del&gt;æ•…åˆ æ‰äº†æ•°å­¦æ ‡ç­¾ã€‚&lt;/del&gt; å…¶å®å¹¶æ²¡æœ‰ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-äºŒåˆ†å›¾æŸ“è‰²&#34;&gt;A. äºŒåˆ†å›¾æŸ“è‰²&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6181/problem/1&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6181/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåªçœ‹çº¢è‰²ã€‚æ˜¾ç„¶ä¸€ä¸ªå·¦éƒ¨ç‚¹æœ€å¤šåªèƒ½ç”¨çº¢è¾¹è¿æ¥ä¸€ä¸ªå³éƒ¨ç‚¹ï¼Œåä¹‹åŒç†ã€‚æŠŠå·¦éƒ¨ç‚¹è§†ä¸ºä¸‹æ ‡ï¼Œå…¶ç”¨çº¢è¾¹ç›¸è¿çš„å³éƒ¨ç‚¹è§†ä¸ºå€¼ï¼Œåˆ™ä¸€ä¸ªåˆæ³•çš„æ–¹æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„åªä¿ç•™ä¸€éƒ¨åˆ†å…ƒç´ çš„æ’åˆ—ã€‚æ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f(n)=\sum\limits_{i=0}^nC_n^i\cdot A_n^i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å†åŠ ä¸Šè“è‰²ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f^2(n)\)&lt;/span&gt; ä¼šç»™ä¸€æ¡è¾¹æ¶‚ä¸¤ç§é¢œè‰²ï¼Œæ•…é’¦å®šæœ‰ä¸¤ç§é¢œè‰²çš„è¾¹æ•°ï¼Œå®¹æ–¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=0}^n(-1)^i\cdot C_n^i\cdot A_n^i\cdot f^2(n-i)\)&lt;/span&gt;ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; çš„è®¡ç®—å¯èƒ½éœ€è¦ä¼˜åŒ–ä¸€ä¸‹ã€‚è€ƒè™‘å·²ç»çŸ¥é“ &lt;span class=&#34;math inline&#34;&gt;\(f(n-1)\)&lt;/span&gt;ï¼Œæ­¤æ—¶å¯¹äºæ–°å¢çš„ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å¯¹ç‚¹ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;ä»»æ„è¿è¾¹ï¼ˆæ˜¾ç„¶ä¸¤ä¸ªå½“ä¸­åªèƒ½æœ‰ä¸€ä¸ªç‚¹å‘å‡ºè¾¹ï¼‰ï¼Œå…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(2n-1\)&lt;/span&gt; ç§æ–¹æ¡ˆï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\((n, n)\)&lt;/span&gt; ä¼šè¢«ç®—é‡ã€‚&lt;/li&gt;
&lt;li&gt;ä¸è¿ï¼Œå…± &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ç§æ–¹æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;å‘ç° 1 ä¸­å¯èƒ½è¿åˆ°å·²ç»æœ‰è¿è¾¹çš„ç‚¹ä¸Šäº†ï¼Œæ–°è¾¹çš„ç›®çš„åœ°æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n-1\)&lt;/span&gt; ä¸ªé€‰é¡¹ï¼Œç›®çš„åœ°åŸæœ¬è¿æ¥çš„ç‚¹ä¹Ÿæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n-1\)&lt;/span&gt; ä¸ªé€‰é¡¹ï¼Œå»æ‰ä¸¤è¾¹å…± &lt;span class=&#34;math inline&#34;&gt;\(4\)&lt;/span&gt; ä¸ªç‚¹ï¼Œéæ³•çš„å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\((n-1)^2\cdot f(n-2)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; f(n + 1), fac(n + 1), inv(n + 1);
    f[0] = 1ll, f[1] = 2ll;
    fac[0] = 1ll, fac[1] = 1ll, inv[0] = 1ll;
    for (int i = 2; i &amp;lt;= n; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
        f[i] = (f[i - 1] * 2 * i % mod + mod - f[i - 2] * (i - 1) % mod * (i - 1) % mod) % mod;
    &amp;#125;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    auto A = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod;
    &amp;#125;;
    long long res = 0ll;
    for (int i = 0, k = 1; i &amp;lt;= n; ++i, k = mod - k)
        (res += k * C(n, i) % mod * A(n, i) % mod * f[n - i] % mod * f[n - i]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-ä¸ƒé€‰äº”&#34;&gt;B. ä¸ƒé€‰äº”&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6181/problem/2&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6181/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; å›ºå®šï¼Œé’¦å®šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªæ•°ç›¸ç­‰ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(C_k^x\)&lt;/span&gt; ä¸ªæ–¹æ¡ˆï¼Œå‰©ä¸‹çš„å°±æ˜¯ä» &lt;span class=&#34;math inline&#34;&gt;\(n-x\)&lt;/span&gt; ä¸ªå…ƒç´ é‡Œé€‰å‡º &lt;span class=&#34;math inline&#34;&gt;\(k-x\)&lt;/span&gt; ä¸ªæ¥é”™æ’ï¼Œè€ƒè™‘é’¦å®šç›¸åŒçš„ä¸ªæ•°æ¥å®¹æ–¥ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum_{i=0}^{k-x}(-1)^i\cdot C_{k-x}^i\cdot A_{n-x-i}^{k-x-i}
\]&lt;/span&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k, x;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k &amp;gt;&amp;gt; x;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    fac[0] = 1ll, fac[1] = 1ll, inv[0] = 1ll;
    for (int i = 2; i &amp;lt;= n; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    auto A = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod;
    &amp;#125;;
    long long res = C(k, x), sum = 0ll;
    for (int i = 0, p = 1; i &amp;lt;= k - x; ++i, p = mod - p)
        (sum += p * C(k - x, i) % mod * A(n - x - i, k - x - i) % mod) %= mod;
    std::cout &amp;lt;&amp;lt; res * sum % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-ç¡¬å¸è´­ç‰©&#34;&gt;D. ç¡¬å¸è´­ç‰©&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6181/problem/4&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6181/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡å¤šé‡èƒŒåŒ…ä¼šè¶…æ—¶ï¼Œè€ƒè™‘ç”¨é’¦å®šæ¯ç§ç¡¬å¸æ˜¯å¦è¶…é¢æ¥å®¹æ–¥ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_s\)&lt;/span&gt; è¡¨ç¤ºå‡‘å‡º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼ˆå®Œå…¨èƒŒåŒ…ï¼‰ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(f_{s-c_1\times (d_1 + 1)}\)&lt;/span&gt; å°±è¡¨ç¤ºé’¦å®šç¬¬ 1 ç§ç¡¬å¸è¶…é¢æ—¶å‡‘å‡º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int c[4], T, m = 1e5;
    std::vector&amp;lt;long long&amp;gt; f(m + 1);
    f[0] = 1;
    for (int i = 0; i &amp;lt; 4; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; c[i];
        for (int j = c[i]; j &amp;lt;= m; ++j)
            f[j] += f[j - c[i]];
    &amp;#125;
    std::cin &amp;gt;&amp;gt; T;
    for (int d[4], m; T--; ) &amp;#123;
        for (int i = 0; i &amp;lt; 4; ++i)
            std::cin &amp;gt;&amp;gt; d[i];
        std::cin &amp;gt;&amp;gt; m;
        long long res = 0ll;
        for (int i = 0; i &amp;lt; (1 &amp;lt;&amp;lt; 4); ++i) &amp;#123;
            int s = m;
            for (int j = 0; j &amp;lt; 4; ++j)
                if ((i &amp;gt;&amp;gt; j) &amp;amp; 1)
                    s -= (d[j] + 1) * c[j];
            if (s &amp;gt;= 0) &amp;#123;
                int k = (__builtin_popcount(i) &amp;amp; 1) ? -1 : 1;
                res += k * f[s];
            &amp;#125;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-distinct-multiples&#34;&gt;E. Distinct Multiples&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6181/problem/5&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6181/problem/5&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¨å¼å­é¢˜ã€‚é¢˜æ„è½¬åŒ–ä¸ºï¼Œç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªä½ç½®å¯é€‰çš„å€¼é›†åˆï¼Œè¦æ±‚ä»»æ„ä¸¤ä¸ªä½ç½®å€¼ä¸ç­‰ï¼Œé—®æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæŠŠä¸¤ä¸ªä½ç½®å–ç­‰è§†ä½œåœ¨å›¢ä¸Šé€‰ä¸­è¾¹ï¼Œé‚£ä¹ˆæœ‰æœ´ç´ åšæ³•é’¦å®šé€‰è¾¹çš„é›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ç„¶åå®¹æ–¥ï¼Œè€ƒè™‘å®ƒä»¬æ„æˆçš„è¿é€šå— &lt;span class=&#34;math inline&#34;&gt;\(\{s\} \subseteq S\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(res=\sum\limits_{S\subseteq V}(-1)^{|S|}\cdot \prod\limits_{s_i} \left\lfloor \frac m{\operatorname{lcm} s_i} \right\rfloor\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸ªå¾ˆç¥å¥‡çš„æ“ä½œæ˜¯æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸¢æ‰ï¼Œç›´æ¥æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(\{s\}\)&lt;/span&gt; å°è¯•å­é›† DPã€‚æœ‰ï¼š&lt;span class=&#34;math inline&#34;&gt;\(res=\sum\limits_{\{s\}}\prod\limits_s f(s)\cdot\left\lfloor \frac m{\operatorname{lcm} s} \right\rfloor\)&lt;/span&gt;ã€‚å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(f(s)\)&lt;/span&gt; è¡¨ç¤ºé€‰å–ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„å¯¼å‡ºå­å›¾çš„å®¹æ–¥ç³»æ•°ä¹‹å’Œï¼Œå…¶ä¸­æ¬¡æ•°ä¸ºå¯¼å‡ºå­å›¾ä¸­è¾¹æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; ç®—å‡ºæ¥å‘¢ï¼Ÿå®¹æ˜“å‘ç°å…¶å€¼åªä¸ &lt;span class=&#34;math inline&#34;&gt;\(|s|\)&lt;/span&gt; æœ‰å…³ï¼Œè€ƒè™‘é’¦å®šä¸ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; è¿é€šçš„ç‚¹æ•°å®¹æ–¥ï¼Œåˆ™æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(n)=\sum\limits_{i=0}^{n - 1} (-1)^i \times C_{n-1}^{i-1} \times f(i) \cdot \sum_{j=0}^{m\gets i\times (i-1)\div 2} (-1)^j\cdot C_m^j
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ï¼ŒäºŒé¡¹å¼å®šç†å– &lt;span class=&#34;math inline&#34;&gt;\(a=1, b = -1\)&lt;/span&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0^m=[m=0]=\sum_{j=0}^m(-1)^j\cdot C_m^j\)&lt;/span&gt;ï¼Œä»£å…¥å¾—ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f(n)&amp;amp;=\sum\limits_{i=0}^{n - 1} (-1)^i \times C_{n-1}^{n-i-1} \times f(n-i)\cdot [m=0\iff i=1]\\
&amp;amp;=(1 - n)\cdot f(n-1)
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå°±èƒ½çº¿æ€§æ±‚å‡ºã€‚å†ç”¨ä¸€ä¸ªå­é›† DPï¼Œä¸ºäº†ä¿è¯é¡ºåºæšä¸¾æœ€å°çš„æœªè¢«ç¡®å®šçš„ç‚¹æ‰€åœ¨è¿é€šå—è¿›è¡Œè½¬ç§»ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, l;
    long long m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m, l = 1 &amp;lt;&amp;lt; n;
    std::vector&amp;lt;long long&amp;gt; d(n), f(n + 1), dp(l), g(l);
    f[1] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; d[i - 1];
        if (i &amp;gt;= 2)
            f[i] = (1 + mod - i) * f[i - 1] % mod;
        // printf(&amp;quot;f[%d] = %lld\n&amp;quot;, i, f[i]);
    &amp;#125;
    for (int i = 0; i &amp;lt; l; ++i) &amp;#123;
        long long now = 1ll;
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1) &amp;#123;
                if (now / std::__gcd(now, d[j]) &amp;gt; m / d[j])
                    goto nosol;
                now = now / std::__gcd(now, d[j]) * d[j];
            &amp;#125;
        g[i] = (m / now) % mod;
        // printf(&amp;quot;lcm = %lld, g[%d] = %lld\n&amp;quot;, now, i, g[i]);
    nosol: ;
    &amp;#125;
    dp[0] = 1ll;
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    for (int i = 1; i &amp;lt; l; ++i) &amp;#123;
        int to = std::__lg(lowbit(i));
        for (int j = i; j; j = (j - 1) &amp;amp; i)
            if ((j &amp;gt;&amp;gt; to) &amp;amp; 1)
                (dp[i] += dp[i ^ j] * f[__builtin_popcount(j)] % mod * g[j] % mod) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; dp[l - 1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f.-permutation&#34;&gt;F. Permutation&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6181/problem/6&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6181/problem/6&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœå…¨æ˜¯ &lt;code&gt;&amp;lt;&lt;/code&gt;ï¼Œæ–¹æ¡ˆæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æŠŠå…¶ä¸­ä¸€äº› &lt;code&gt;&amp;lt;&lt;/code&gt; å˜æˆ &lt;code&gt;?&lt;/code&gt;ï¼Œæ¯”å¦‚ &lt;code&gt;&amp;lt;&amp;lt;??&amp;lt;?&amp;lt;&amp;lt;&amp;lt;&amp;lt;&lt;/code&gt; çš„æ–¹æ¡ˆæ•°ï¼Œ&lt;del&gt;å¤ªå¥½äº†æ˜¯å¤šé‡é›†æ’åˆ—ï¼Œæˆ‘ä»¬æ²¡æ•‘äº†&lt;/del&gt; æ˜¾ç„¶è¢« &lt;code&gt;&amp;lt;&lt;/code&gt; è¿æ¥èµ·æ¥çš„ä¸€æ®µå…ƒç´ åªæœ‰ä¸€ç§æ’åˆ—æ–¹å¼ï¼Œæ‰€ä»¥å¯ä»¥è§†ä¸ºå¤šé‡é›†æ’åˆ—ï¼Œæ–¹æ¡ˆæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {11!}{3!\times 2!\times 5!}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¼¼ä¹åªéœ€è¦æšä¸¾æŠŠ &lt;code&gt;&amp;gt;&lt;/code&gt; å˜æˆ &lt;code&gt;&amp;lt;&lt;/code&gt; æˆ– &lt;code&gt;=&lt;/code&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(2^k\)&lt;/span&gt; ç§æƒ…å†µå†è®¡ç®—å°±å¯ä»¥äº†ï¼Œå¯æƒœ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æœ‰ç‚¹å¤§ã€‚ä½†æˆ‘ä»¬å‘ç°å®ƒåœ¨ä¸€å®šç¨‹åº¦ä¸Šæ˜¯æ²¡æœ‰åæ•ˆæ€§çš„ï¼Œæ¯”å¦‚ &lt;code&gt;&amp;lt;&amp;lt;??&amp;lt;&lt;/code&gt; å’Œ &lt;code&gt;&amp;lt;&amp;lt;?&amp;lt;&amp;lt;&lt;/code&gt;ï¼Œå‰é¢çš„ &lt;code&gt;&amp;lt;&amp;lt;&lt;/code&gt; ä¸ä¼šå¯¹åé¢çš„å†…å®¹å¸¦æ¥å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤ºå¯¹äºå‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå…ƒç´ çš„æ–¹æ¡ˆæ•°ï¼Œæšä¸¾æœ€åä¸€ä¸ªè¢«é’¦å®šä¸º &lt;code&gt;?&lt;/code&gt; çš„ &lt;code&gt;&amp;gt;&lt;/code&gt; &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼ˆå³ &lt;span class=&#34;math inline&#34;&gt;\([j + 1, i-1]\)&lt;/span&gt; é—´çš„ &lt;code&gt;&amp;gt;&lt;/code&gt; éƒ½è¢«æ›¿æ¢ä¸º &lt;code&gt;&amp;lt;&lt;/code&gt;ï¼‰ï¼Œå¸¦ä¸Šå®¹æ–¥ç³»æ•°ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_i=\sum\limits_{s_j=\texttt{&amp;#39;&amp;gt;&amp;#39;}}(-1)^{cnt_\texttt{&amp;#39;&amp;gt;&amp;#39;}[j + 1, i - 1]}\times f_j\times\dfrac1{(i-j)!}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    fac[0] = 1ll, inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    std::vector&amp;lt;char&amp;gt; s(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; s[i];
    std::vector&amp;lt;long long&amp;gt; f(n + 1);
    s[0] = &amp;#39;&amp;gt;&amp;#39;, f[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int cnt = 0;
        for (int j = i - 1; ~j; --j)
            if (s[j] == &amp;#39;&amp;gt;&amp;#39;) &amp;#123;
                long long k = (cnt &amp;amp; 1) ? mod - 1 : 1;
                (k *= f[j]) %= mod, (k *= inv[i - j]) %= mod;
                (f[i] += k) %= mod;
                ++cnt;
            &amp;#125;
        // printf(&amp;quot;f[%d] = %lld\n&amp;quot;, i, f[i]);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n] * fac[n] % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;p&gt;&lt;em&gt;å¿³éƒé‚‘ä½™ä¾˜å‚ºå…®ï¼Œä½™ç‹¬ç©·å›°ä¹æ­¤æ—¶ä¹Ÿã€‚&lt;/em&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;h.-k-perm-counting&#34;&gt;H. ~K Perm Counting&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/6181/problem/8&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/6181/problem/8&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘é’¦å®šä»¤å‡ ä¸ªå…ƒç´ ä¸æ»¡è¶³æ¡ä»¶è¿›è¡Œå®¹æ–¥ï¼Œå³ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=0}^n (-1)^i\cdot f(i)\)&lt;/span&gt;ã€‚ä½†æˆ‘ä»¬å‘ç° &lt;span class=&#34;math inline&#34;&gt;\([n-k,n+k]\)&lt;/span&gt; éƒ½æœ‰ä¸¤ä¸ªä¸èƒ½é€‰çš„å€¼ï¼Œç›´æ¥å– &lt;span class=&#34;math inline&#34;&gt;\(f(i)=\prod 2\)&lt;/span&gt; è‚¯å®šä¼šé€‰åˆ°ç›¸åŒå€¼ï¼Œä¸€ä¸ªè‡ªç„¶ï¼ˆï¼Ÿï¼‰çš„æƒ³æ³•æ˜¯å†å®¹æ–¥ä¸€éï¼Œå¯æƒœæ‰‹ç©ä¸€ä¸‹å‘ç°ä¼¼ä¹å®¹ä¸åŠ¨ã€‚è€ƒè™‘æŠŠç©æ„å„¿æ‹åœ¨æ£‹ç›˜ä¸Šï¼š&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;1.png&#34; alt=&#34;ä»¥ k=2 ä¸ºä¾‹&#34; /&gt;&lt;figcaption&gt;ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(k=2\)&lt;/span&gt; ä¸ºä¾‹&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(\times\)&lt;/span&gt; æ˜¯éæ³•æ ¼å­ï¼Œè¾¹æ˜¯éæ³•æ ¼å­é—´çš„ä¸åŒé€‰å…³ç³»ï¼ŒåŒé¢œè‰²çš„è¾¹éš¶å±åŒä¸€æ¡é“¾ã€‚å®¹æ˜“å‘ç°å¦‚æœæ£‹ç›˜ç»§ç»­æ‰©å¤§ï¼Œè¿™äº›é“¾è¿˜ä¼šç»§ç»­å»¶é•¿ã€‚&lt;/p&gt;
&lt;p&gt;ä¼šå‘ç°è¿™äº›é“¾äº’ä¸å¹²æ‰°ï¼Œå°±æ˜¯è¯´æˆ‘é€‰äº†è¿™æ¡é“¾ä¸Šçš„æŸä¸ªç‚¹å’Œé“¾å¤–çš„ç‚¹æ²¡æœ‰ä»»ä½•å…³ç³»ï¼ˆæ˜¾ç„¶ï¼‰ã€‚æŠŠè¿™äº›é“¾é¦–å°¾ç›¸è¿æ‹¼èµ·æ¥ï¼Œè¦åšçš„å°±æ˜¯æ‹¼æ¥å¤„å¯ä»¥é€‰ç›¸é‚»ï¼Œå…¶ä½™ä½ç½®ä¸èƒ½é€‰ç›¸é‚»ï¼Œé€‰å‡ºæ¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªçš„æ–¹æ¡ˆæ•°ã€‚æå‰é¢„å¤„ç†å‡ºæ¥æ•´ä¸ªåºåˆ—ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(tag_j\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ˜¯å¦èƒ½å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j-1\)&lt;/span&gt; åŒé€‰ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(dp_{j,i,0/1}\)&lt;/span&gt; è¡¨ç¤º DP åˆ°äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œå·²ç»é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªæ•°ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªå…ƒç´ ï¼ˆä¸ï¼‰é€‰çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
dp_{j,i,0} = dp_{j - 1, i, 0} + dp_{j-1, i, 1}\\
dp_{j,i,1} = \begin{cases}
dp_{j-1, i - 1, 1} + dp_{j-1,i - 1,0}&amp;amp;tag_j=1
\\
dp_{j-1,i,0}&amp;amp;\text{otherwise}
\end{cases}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å¤§åŠ› DP å³å¯ã€‚&lt;span class=&#34;math inline&#34;&gt;\(f(i)\)&lt;/span&gt; å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\((n-i)!\times (dp_{m, i, 0} + dp_{m, i, 1})\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ºæ€»é“¾é•¿ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;æ³¨æ„ä¸æ»šåŠ¨å¯èƒ½ä¼š MLE &lt;img src=&#34;/em/kt.gif&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 924844033;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; tag(1);
    std::vector&amp;lt;long long&amp;gt; fac(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; vis(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
    auto calc = [&amp;amp;](int i, int j, int s) &amp;#123;
        tag.push_back(1);
        for (; ; s ^= 1) &amp;#123;
            // printf(&amp;quot;(%d, %d) &amp;quot;, i, j);
            vis[i][j] = 1;
            if (!s) &amp;#123;
                i = j + k;
                if (i &amp;lt;= n)
                    tag.push_back(0);
                else
                    break;
            &amp;#125;
            else &amp;#123;
                j = i + k;
                if (j &amp;lt;= n)
                    tag.push_back(0);
                else
                    break;
            &amp;#125;
        &amp;#125;
        // puts(&amp;quot;&amp;quot;);
        return;
    &amp;#125;;
    fac[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
        int j = i - k;
        if (j &amp;gt;= 1 &amp;amp;&amp;amp; !vis[i][j])
            calc(i, j, 1);
        j = i + k;
        if (j &amp;lt;= n &amp;amp;&amp;amp; !vis[i][j])
            calc(i, j, 0);
    &amp;#125;
    int m = (int)tag.size() - 1;
    // printf(&amp;quot;m = %d\n&amp;quot;, m);
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; &amp;gt; dp(2, std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; (n + 1, std::vector&amp;lt;long long&amp;gt; (2)));
    dp[0][0][0] = 1ll;
    for (int j = 1, now = 1; j &amp;lt;= m; ++j, now ^= 1) &amp;#123;
        for (int i = 0; i &amp;lt;= n &amp;amp;&amp;amp; i &amp;lt;= j; ++i) &amp;#123;
            dp[now][i][0] = dp[!now][i][0];
            dp[now][i][1] = 0ll;
            if (i) &amp;#123;
                (dp[now][i][0] += dp[!now][i][1]) %= mod;
                dp[now][i][1] = dp[!now][i - 1][0];
                if (tag[j]) &amp;#123;
                    (dp[now][i][1] += dp[!now][i - 1][1]) %= mod;
                    // assert(0);
                &amp;#125;
            &amp;#125;
            // printf(&amp;quot;dp[%d][%d] = %lld / %lld\n&amp;quot;, j, i, dp[j][i][0], dp[j][i][1]);
        &amp;#125;
    &amp;#125;
    long long res = 0ll;
    for (int i = 0, p = 1; i &amp;lt;= n; ++i, p = mod - p)
        (res += p * fac[n - i] % mod * (dp[m &amp;amp; 1][i][0] + dp[m &amp;amp; 1][i][1]) % mod) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---positions-in-permutations&#34;&gt;A - Positions in Permutations&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/285/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/285/E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ï¼ˆçœ‹å‘ä¸Šä¸€é¢˜ï¼‰è¿™ç…§ç‰‡æ˜¯ä½ å—ï¼Ÿ&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ä¸Šä¸€é¢˜çš„åŸºç¡€ä¸Šï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(k=1\)&lt;/span&gt;ã€‚ä½†æ˜¯æœ‰ä¸ªå°å°çš„é—®é¢˜â€”â€”æ‰€æ±‚çš„ã€Œè‡³å°‘ã€ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œæ— æ³•ç®€å•å®¹æ–¥ã€‚å…·ä½“åœ°ï¼Œå¦‚æœä¸€ä¸ªæ’åˆ—ä¸€å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; ä¸ªéæ³•æ’åˆ—ï¼Œé‚£ä¹ˆå®ƒä¼šè¢« &lt;span class=&#34;math inline&#34;&gt;\(f(i)\)&lt;/span&gt; ç»Ÿè®¡ &lt;span class=&#34;math inline&#34;&gt;\(C_p^i\)&lt;/span&gt; æ¬¡ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g(p)\)&lt;/span&gt; è¡¨ç¤ºéæ³•æ ¼å­æ•°æ°å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; çš„æ’åˆ—çš„çœŸå®æ•°é‡ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f(i)=\sum\limits_{j=i}^n C_j^i\cdot g(j)\)&lt;/span&gt;ï¼ŒäºŒé¡¹å¼åæ¼”å³å¯å¾—åˆ°çœŸå®å€¼ &lt;span class=&#34;math inline&#34;&gt;\(g(m)=\sum\limits_{j=m}^n (-1)^{j-m}\cdot C_j^m\cdot f(j)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; tag(1);
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; vis(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
    auto calc = [&amp;amp;](int i, int j, int s) &amp;#123;
        tag.push_back(1);
        for (; i &amp;lt;= n &amp;amp;&amp;amp; j &amp;lt;= n; s ^= 1) &amp;#123;
            vis[i][j] = 1;
            if (!s) &amp;#123;
                i = j + 1;
                if (i &amp;lt;= n)
                    tag.push_back(0);
            &amp;#125;
            else &amp;#123;
                j = i + 1;
                if (j &amp;lt;= n)
                    tag.push_back(0);
            &amp;#125;
        &amp;#125;
        return;
    &amp;#125;;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    fac[0] = 1ll, inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
        int j = i - 1;
        if (j &amp;gt;= 1 &amp;amp;&amp;amp; !vis[i][j])
            calc(i, j, 1);
        j = i + 1;
        if (j &amp;lt;= n &amp;amp;&amp;amp; !vis[i][j])
            calc(i, j, 0);
    &amp;#125;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    int m = (int)tag.size() - 1;
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; &amp;gt; dp(2, std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; (n + 1, std::vector&amp;lt;long long&amp;gt; (2)));
    dp[0][0][0] = 1ll;
    for (int j = 1, now = 1; j &amp;lt;= m; ++j, now ^= 1) &amp;#123;
        for (int i = 0; i &amp;lt;= n &amp;amp;&amp;amp; i &amp;lt;= j; ++i) &amp;#123;
            dp[now][i][0] = dp[!now][i][0];
            dp[now][i][1] = 0ll;
            if (i) &amp;#123;
                (dp[now][i][0] += dp[!now][i][1]) %= mod;
                dp[now][i][1] = dp[!now][i - 1][0];
                if (tag[j])
                    (dp[now][i][1] += dp[!now][i - 1][1]) %= mod;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    long long res = 0ll;
    for (int i = k, p = 1; i &amp;lt;= n; ++i, p = mod - p) &amp;#123;
        // printf(&amp;quot;%d: %lld\n&amp;quot;, i, C(i, k) * fac[n - i] % mod * (dp[m &amp;amp; 1][i][0] + dp[m &amp;amp; 1][i][1]) % mod);
        (res += p * C(i, k) % mod * fac[n - i] % mod * (dp[m &amp;amp; 1][i][0] + dp[m &amp;amp; 1][i][1]) % mod) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---all-pairs-similarity-p&#34;&gt;D - All Pairs Similarity P&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11458&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11458&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;çœæµï¼šæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(\forall\,i,f_i=\sum\limits_{j=1}^n \dfrac{|a_i\cap a_j|}{|a_i\cup a_j|}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåˆ†ç¦»å¸¸æ•°ï¼Œæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_i&amp;amp;=\sum\limits_{j=1}^n \dfrac{|a_i\cap a_j|}{|a_i\cup a_j|}\\
&amp;amp;=\sum_{j=1}^n\dfrac {|a_i|+|a_j|-|a_i\cup a_j|}{|a_i\cup a_j|}\\
&amp;amp;=\sum_{j=1}^n \dfrac {|a_i|+|a_j|}{|a_i\cup a_j|}-1
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å°½é‡æŠŠåˆ†å­å˜å¾—æ›´ç®€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_i&amp;amp;=\sum_{j=1}^n \dfrac {|a_i|+|a_j|}{|a_i\cup a_j|}-1\\
&amp;amp;=|a_i|\cdot\left(\sum_{j=1}^n\dfrac 1{|a_i\cup a_j|}\right)-n+\sum_{j=1}^n \dfrac {|a_j|}{|a_i\cup a_j|}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é—®é¢˜è½¬åŒ–ä¸ºæ±‚è§£ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{j=1}^n\dfrac 1{|a_i\cup a_j|}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{j=1}^n\dfrac {|a_j|}{|a_i\cup a_j|}\)&lt;/span&gt;ï¼Œä»¥ &lt;span class=&#34;math inline&#34;&gt;\(*=\sum\limits_{j=1}^n\dfrac 1{|a_i\cup a_j|}\)&lt;/span&gt; ä¸ºä¾‹ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(b_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; è¡¥é›†ï¼Œåˆ™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
*&amp;amp;=\sum\limits_{j=1}^n\dfrac 1{|a_i\cup a_j|}\\
&amp;amp;=\sum_{j=1}^n\dfrac 1{k-|b_i\cap b_j|}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¸ºä»€ä¹ˆè¦åšè¿™ä¸ªè½¬æ¢å‘¢ï¼Ÿç›¸æ¯”èµ·å¹¶é›†è¿ç®—ï¼Œäº¤é›†è¿ç®—æœ‰ç€ä¼˜ç§€çš„æ€§è´¨ï¼š&lt;span class=&#34;math inline&#34;&gt;\(s\subseteq(b_i\cap b_j)\iff s\subseteq b_i\land s\subseteq b_j\)&lt;/span&gt;ï¼Œ&lt;del&gt;ç›´æ¥å–æˆ–å½“ç„¶ä¹Ÿæœ‰ç›¸ä¼¼çš„æ€§è´¨ï¼Œä½†æ˜¯å¤ªçƒ§è„‘äº†&lt;/del&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åŸºäºè¿™ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæƒ³æ³•ï¼šå¯¹äºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\forall \, s\subseteq b_j\)&lt;/span&gt; å¤„æ”¾ç½® &lt;span class=&#34;math inline&#34;&gt;\(\dfrac 1{k-|s|}\)&lt;/span&gt; çš„è´¡çŒ®ï¼›å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(\forall \, s\subseteq b_i\)&lt;/span&gt; å¤„çš„è´¡çŒ®æ±‚å’Œã€‚ä½†æ˜¯è¿™æ ·è‚¯å®šä¼šæ‹¿åˆ°å¾ˆå¤šæˆ‘ä»¬ä¸æƒ³è¦çš„è´¡çŒ®ï¼Œä¾‹å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(\forall \, s\subset (b_i\cap b_j)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ç²¾ç»†å¸ƒç½®è´¡çŒ®â€”â€”æ„é€  &lt;span class=&#34;math inline&#34;&gt;\(g(|s|)\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{j=1}^n\sum\limits_{s\subseteq b_j}g(|s|)=*\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå¯ä»¥äºŒé¡¹å¼åæ¼”å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt;ï¼Œå…·ä½“åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(F(|S|)=\dfrac 1{k-|S|}=\sum\limits_{s\subseteq S}g(|s|)=\sum\limits_{j=0}^{|S|} C_{|S|}^j g(j)\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(g(i)=\sum\limits_{j=0}^iC_i^j\cdot \dfrac {(-1)^{i-j}}{k-j}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å†ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(h(s)=\sum\limits_{b_j\supseteq s}g(|s|)=g(|s|)\cdot \sum\limits_{b_j\supseteq s}1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; å°±æ˜¯é«˜ç»´åç¼€å’Œã€‚æˆ‘ä»¬æ­£åœ¨åšçš„äº‹æƒ…å°±æ˜¯æ±‚è§£ &lt;span class=&#34;math inline&#34;&gt;\(*=\sum\limits_{s\subseteq b_i}h(s)\)&lt;/span&gt;ï¼Œè¿™å°±åˆæ˜¯ä¸€ä¸ªé«˜ç»´å‰ç¼€å’Œäº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{j=1}^n\dfrac {|a_j|}{|a_i\cup a_j|}\)&lt;/span&gt; å‘¢ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(h(s)=\sum\limits_{b_j\supseteq s}g(|s|)\cdot {\color{red}{|a_j|}} = g(|s|) \cdot \sum\limits_{b_j\supseteq s} \color{red}{k - |b_j|}\)&lt;/span&gt;ï¼Œæ”¹å˜é«˜ç»´åç¼€å’Œæ±‚å’Œå¯¹è±¡å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n+k\cdot 2^k)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(k\cdot 2^k\)&lt;/span&gt; æ¥è‡ªæ•´ä½“é«˜ç»´å‰ / åç¼€å’Œï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(n\cdot k\)&lt;/span&gt; æ¥è‡ªæšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k, l;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k, l = 1 &amp;lt;&amp;lt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1), b(n + 1), cnt(l);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i], b[i] = (l - 1) ^ a[i];
        ++cnt[b[i]];
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; g(k + 1), fac(k + 1);
    auto qkp = [&amp;amp;](long long x, int y = mod - 2) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * qkp(fac[n - m]) % mod * qkp(fac[m]) % mod;
    &amp;#125;;
    fac[0] = 1ll;
    for (int i = 1; i &amp;lt;= k; ++i)
        fac[i] = fac[i - 1] * i % mod;
    for (int i = 0; i &amp;lt;= k; ++i) &amp;#123;
        for (int j = 0, p = (i &amp;amp; 1) ? mod - 1 : 1; j &amp;lt;= i; ++j, p = mod - p)
            (g[i] += C(i, j) * p % mod * qkp(k - j) % mod) %= mod;
        // printf(&amp;quot;g[%d] = %lld\n&amp;quot;, i, g[i]);
    &amp;#125;
    // for (int i = 0; i &amp;lt;= k; ++i) &amp;#123;
    //     long long F = 0ll;
    //     for (int j = 0; j &amp;lt;= i; ++j)
    //         (F += C(i, j) * g[j] % mod) %= mod;
    //     printf(&amp;quot;%d: %lld / %lld\n&amp;quot;, i, F, qkp(k - i));
    // &amp;#125;
    std::vector&amp;lt;long long&amp;gt; h(l);
    std::copy(cnt.begin(), cnt.end(), h.begin());
    for (int i = 0; i &amp;lt; k; ++i)
        for (int j = l - 1; ~j; --j)
            if (!((j &amp;gt;&amp;gt; i) &amp;amp; 1))
                (h[j] += h[j ^ (1 &amp;lt;&amp;lt; i)]) %= mod;
    auto f1(h);
    for (int i = 0; i &amp;lt; l; ++i)
        (f1[i] *= g[__builtin_popcount(i)]) %= mod;
    for (int i = 0; i &amp;lt; k; ++i)
        for (int j = 0; j &amp;lt; l; ++j)
            if ((j &amp;gt;&amp;gt; i) &amp;amp; 1)
                (f1[j] += f1[j ^ (1 &amp;lt;&amp;lt; i)]) %= mod;
    for (int i = 0; i &amp;lt; l; ++i)
        h[i] = cnt[i] * (k - __builtin_popcount(i));
    for (int i = 0; i &amp;lt; k; ++i)
        for (int j = l - 1; ~j; --j)
            if (!((j &amp;gt;&amp;gt; i) &amp;amp; 1))
                (h[j] += h[j ^ (1 &amp;lt;&amp;lt; i)]) %= mod;
    auto f2(h);
    for (int i = 0; i &amp;lt; l; ++i)
        (f2[i] *= g[__builtin_popcount(i)]) %= mod;
    for (int i = 0; i &amp;lt; k; ++i)
        for (int j = 0; j &amp;lt; l; ++j)
            if ((j &amp;gt;&amp;gt; i) &amp;amp; 1)
                (f2[j] += f2[j ^ (1 &amp;lt;&amp;lt; i)]) %= mod;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        // fprintf(stderr, &amp;quot;%d: %d * %lld - %d + %lld\n&amp;quot;, i, __builtin_popcount(a[i]), f1[b[i]], n, f2[b[i]]);
        std::cout &amp;lt;&amp;lt; (__builtin_popcount(a[i]) * f1[b[i]] % mod + mod - n + f2[b[i]]) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---prefix-xors&#34;&gt;E - Prefix XORs&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc137/tasks/arc137_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc137/tasks/arc137_d&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;çœæµï¼šåš &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡å‰ç¼€å’Œï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k=1,2,\cdots,m\)&lt;/span&gt;ï¼Œåˆ†åˆ«è¯¢é—®ï¼šä»¤ &lt;span class=&#34;math inline&#34;&gt;\(x_i\gets a_i\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(s_n\)&lt;/span&gt; çš„è´¡çŒ®æ¬¡æ•°ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(\sum a_i\cdot (x_i\bmod 2)\)&lt;/span&gt;ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(a_p\)&lt;/span&gt;ï¼Œå®¹æ˜“å‘ç°ç¬¬ä¸€è½®å…¶å¯¹ä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(s_q\)&lt;/span&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æ¬¡è´¡çŒ®ï¼Œæ‹‰å¼€æ¥å°±æ˜¯å¸¸æ•°åˆ—ï¼›ç¬¬äºŒè½®æœ‰ &lt;span class=&#34;math inline&#34;&gt;\((q-p+1)\)&lt;/span&gt; æ¬¡è´¡çŒ®ï¼Œæ˜¯å…¬å·®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ç­‰å·®æ•°åˆ—ï¼›ç¬¬ä¸‰è½®æ˜¯ç±»ä¸‰è§’å½¢æ•°â€”â€”è‡³æ­¤ï¼Œè‚¯å®šå’Œç»„åˆæ•°æœ‰å…³äº†ã€‚æ‰‹ç©å¯ä»¥å‘ç°ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; è½® &lt;span class=&#34;math inline&#34;&gt;\(a_p\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(s_n\)&lt;/span&gt; çš„è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(C_{n-p+(k-2)}^{n-p}\)&lt;/span&gt;ï¼Œå°½é‡ä»¤å…¶ä¸­ä¸€ä¸ªä¸åŠ¨ï¼Œå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(C_{n-p+(k-2)}^{k-1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å‘ç°ç›´æ¥æšä¸¾æ¯è½®æ¯ä¸ªæ•°ä¼šèµ·é£ï¼Œè€Œä¸”æ¨¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; ä¼¼ä¹åªèƒ½ Lucasï¼ˆå†å¸¦ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ï¼‰ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;é‚£å°± Lucas å‘—ã€‚ç”±å…¶è§‚å¯Ÿå®¹æ˜“å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(C_{n-p+(k-2)}^{k-2}\bmod2=1\)&lt;/span&gt; å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\((k-2)\subseteq (n-p+k-2)\iff (k-2)\subseteq \complement_U(n-p)\)&lt;/span&gt;ï¼Œæ•…é—®é¢˜è½¬åŒ–ä¸ºé«˜ç»´åç¼€å’Œï¼Œ&lt;del&gt;å½“ç„¶ä½ ä¹Ÿå¯ä»¥åšä¸€æ¬¡ and-FWT&lt;/del&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(res_k=\sum (C_{n-p+(k-2)}^{k-2}\bmod 2)\cdot a_p=S_{k-2}\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸ºé«˜ç»´åç¼€å’Œï¼Œåˆå€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(S_{\complement_u(n-i)}\gets a_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m, l, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m, k = std::__lg(n + m) + 1, l = 1 &amp;lt;&amp;lt; k;
    std::vector&amp;lt;int&amp;gt; s(l);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; s[l - 1 - (n - i)];
    for (int i = 0; i &amp;lt; k; ++i)
        for (int j = l - 1; ~j; --j)
            if (!((j &amp;gt;&amp;gt; i) &amp;amp; 1))
                s[j] ^= s[j ^ (1 &amp;lt;&amp;lt; i)];
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; s[i - 1] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---the-top-scorer&#34;&gt;B - The Top Scorer&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1096/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1096/E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é‰´äºæ¯ç§æ–¹æ¡ˆç­‰æ¦‚ç‡ï¼ˆç¿»è¯‘æ²¡è¯´ï¼Œä½†åŸé¢˜é¢æœ‰æåˆ°ï¼‰ï¼Œè€ƒè™‘è®¡ç®—å°æ˜èƒ½å¤Ÿå–èƒœçš„æ–¹æ¡ˆæ•°ï¼Œå†å¯¹æ€»æ–¹æ¡ˆæ•°åšé™¤æ³•ã€‚å…ˆæšä¸¾æœ€é«˜åˆ† &lt;span class=&#34;math inline&#34;&gt;\(k\ge r\)&lt;/span&gt;ï¼Œå†æšä¸¾åŒ…æ‹¬å°æ˜åœ¨å†…æ°æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(c\ge 1\)&lt;/span&gt; ä¸ªäºº æ‹¿åˆ° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; åˆ†ã€‚ä½†å‰©ä¸‹çš„äººå‘¢ï¼Ÿæ˜¾ç„¶æ˜¯ä¸èƒ½æ’æ¿éšæœºåˆ†é…çš„ï¼Œå› ä¸ºå­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;k\)&lt;/span&gt; çš„é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å®¹æ–¥ï¼Œé’¦å®šå‰©ä¸‹çš„ &lt;span class=&#34;math inline&#34;&gt;\(p-c\)&lt;/span&gt; ä¸ªäººä¸­æ‹¿åˆ° &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt; åˆ†çš„äººæ•°åå†å¯ç©ºåœ°æ’æ¿å³å¯ï¼Œåˆ™æ€»æ–¹æ¡ˆæ•°ä¸ºï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\sum_{k=r}^s\sum_{c=1}^p\dfrac {C_{p - 1}^{c-1}}c\cdot \sum_{i=0}^{p-c}C_{p-c}^i\cdot C_{s-k\cdot (c+i)+(p-c-1)}^{p-c-1}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­åˆ†æ¯ä¸Šçš„ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; æ¥æºäºç­‰æ¦‚ç‡åˆ†é…ç»™æœ€é«˜åˆ†ï¼Œè™½ç„¶ä¸æ˜¯æ•´æ•°ï¼Œä½†ä¹Ÿä»£è¡¨ç€ã€Œå°æ˜è·èƒœå¯è¡Œæ–¹æ¡ˆæ•°ã€ã€‚æœ€åå°†ç­”æ¡ˆé™¤ä¸Šæ€»æ–¹æ¡ˆæ•° &lt;span class=&#34;math inline&#34;&gt;\(C_{s-r+p-1}^{p-1}\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int p, s, r;
    std::cin &amp;gt;&amp;gt; p &amp;gt;&amp;gt; s &amp;gt;&amp;gt; r;
    std::vector&amp;lt;long long&amp;gt; fac(s + p), inv(s + p);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt; s + p; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
    &amp;#125;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv.back() = qkp(fac.back(), mod - 2);
    for (int i = s + p - 2; i &amp;gt; 0; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        if (n == -1 &amp;amp;&amp;amp; m == -1)
            return 1ll;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    auto res(0ll);
    for (int k = r; k &amp;lt;= s; ++k)
        for (int c = 1; c &amp;lt;= p; ++c)
            if ((p - c) * (k - 1) + c * k &amp;gt;= s) &amp;#123;
                auto t(0ll);
                for (int i = 0, now = 1; i &amp;lt;= p - c &amp;amp;&amp;amp; k * (c + i) &amp;lt;= s; ++i, now = mod - now)
                    (t += now * C(p - c, i) % mod * C(s - k * (c + i) + (p - c - 1), p - c - 1) % mod) %= mod;
                (res += C(p - 1, c - 1) * qkp(c, mod - 2) % mod * t % mod) %= mod;
            &amp;#125;
    std::cout &amp;lt;&amp;lt; res * qkp(C(s - r + p - 1, p - 1), mod - 2) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---sky-full-of-stars&#34;&gt;C - Sky Full of Stars&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/997/C&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/997/C&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(3^{n\times n}\)&lt;/span&gt; å‡å»ä»»æ„ä¸€è¡Œä¸€åˆ—ä¸åŒè‰²çš„æ–¹æ¡ˆå°±æ˜¯ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä¸€å…ƒå®¹æ–¥ï¼Œå¦‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤ºè‡³å°‘ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ—åŒè‰²çš„æ–¹æ¡ˆï¼Œä½†ä¼šå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_0\)&lt;/span&gt; ä¸­åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ—åŒè‰²ç­‰ä¸é¢„æœŸä¸ç¬¦çš„æƒ…å†µã€‚å—æ­¤å¯å‘è€ƒè™‘ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºè‡³å°‘ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; åˆ—åŒè‰²è¿›è¡ŒäºŒå…ƒå®¹æ–¥ã€‚å®¹æ˜“å‘ç°å½“ &lt;span class=&#34;math inline&#34;&gt;\(i\times j\ne 0\)&lt;/span&gt; æ—¶ï¼Œè¢«é€‰ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; åˆ—å…¨éƒ¨è¿é€šï¼Œåº”ä¸ºåŒä¸€ç§é¢œè‰²ï¼›å°†å®ƒä»¬æŒªåˆ°è§’è½ï¼Œå¯ä»¥å‘ç°æœªè¢«é€‰ä¸­çš„æ ¼å­å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\((n-i)\times (n-j)\)&lt;/span&gt; ä¸ªã€‚æ•…æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,j}=\begin{cases}
C_n^j\times 3^j\times 3^{n\times(n - j)}&amp;amp;i=0\\
C_n^i\times 3^i\times 3^{n\times(n-i)}&amp;amp;j=0\\
C_n^i\times C_n^j\times 3\times 3^{(n-i)\times (n-j)}&amp;amp;\text{otherwise}
\end{cases}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g_{i,j}\)&lt;/span&gt; è¡¨ç¤ºæ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; åˆ—åŒè‰²çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(3^{n\times n}-g_{0,0}\)&lt;/span&gt;ã€‚äºŒé¡¹å¼åæ¼” / å®¹æ–¥åŸç†å¾— &lt;span class=&#34;math inline&#34;&gt;\(g_{0,0}=\sum\limits_{i=0}^n\sum\limits_{j=0}^n (-1)^{i+j}\cdot f_{i,j}\)&lt;/span&gt;ã€‚å¾ˆæƒŠè®¶åœ°å‘ç°è¿™æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; çš„ï¼è€ƒè™‘ä¼˜åŒ–ã€‚æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(f_{1\to n,1\to n}\)&lt;/span&gt; åˆå¹¶åŒç±»é¡¹ï¼Œå¾—åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
g_{0, 0}
&amp;amp;=\left[\sum_{j=0}^n (-1)^j\cdot f_{0,j}\right]+\sum_{i=1}^n (-1)^i\cdot f_{i,0}+\sum_{j=1}^n (-1)^{i+j}\cdot C_n^i\times C_n^j\times 3^{(n-i)\times (n-j)+1}\\
&amp;amp;=\left[\sum_{j=0}^n (-1)^j\cdot f_{0,j}\right]+\sum_{i=1}^n (-1)^i\cdot f_{i,0}+(-1)^i\cdot C_n^i\times 3^{n^2-n\times i+1}\times\sum_{j=1}^n (-1)^j\cdot C_n^j\times 3^{j\times(-n+i)}\\
&amp;amp;=\left[\sum_{j=0}^n (-1)^j\cdot f_{0,j}\right]+\sum_{i=1}^n (-1)^i\cdot f_{i,0}+(-1)^i\cdot C_n^i\times 3^{n^2-n\times i+1}\times\left[\left(\sum_{j=0}^n (-1)^j\cdot C_n^j\times (3^{-n+i})^j\right)-1\right]\\
&amp;amp;=\left[\sum_{j=0}^n (-1)^j\cdot f_{0,j}\right]+\sum_{i=1}^n (-1)^i\cdot f_{i,0}+(-1)^i\cdot C_n^i\times 3^{n^2-n\times i+1}\times\left[(-3^{-n+i}+1)^n-1\right]
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç”±æ­¤ä¾¿å¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; è®¡ç®—ã€‚æ‹…å¿ƒè¶…æ—¶å¯ä»¥æŠŠæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(3^{-n+i}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(3^{n\times i}\)&lt;/span&gt; çº¿æ€§é¢„å¤„ç†å‡ºæ¥ï¼Œå¤æ‚åº¦ä¸ä¼šå˜å°±æ˜¯äº†ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè§£é‡Šä¸€ä¸‹æœ€åä¸€æ­¥çš„äºŒé¡¹å¼å®šç†ï¼Œéå¸¸é—æ†¾åœ°å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(3^{-n+i}\)&lt;/span&gt; éƒ½æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ¬¡çš„ï¼Œæ²¡åŠæ³•æŠŠäºŒè€…ç›¸åŠ å‡åšäºŒé¡¹å¼å®šç†ï¼›ä½†ç”±äºæ¬¡æ•°ç›¸åŒï¼Œè¿™æç¤ºæˆ‘ä»¬å¯ä»¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt; ä¹˜åˆ° &lt;span class=&#34;math inline&#34;&gt;\(3^{-n+i}\)&lt;/span&gt; é‡Œå»ï¼Œç»™æ¯ä¸€é¡¹é…ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(1^{n-k}\)&lt;/span&gt; å°±å¯ä»¥åš &lt;span class=&#34;math inline&#34;&gt;\(-3^{n-i}\)&lt;/span&gt;ï¼ˆæ³¨æ„ä¸æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\((-3)^{n-i}\)&lt;/span&gt;ï¼‰ å’Œ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„äºŒé¡¹å¼å®šç†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    long long n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1), invn(n + 1), invi(n + 1), powi(n + 1), pown(n + 1);
    auto qkp = [&amp;amp;](long long x, long long y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    const long long pnn = qkp(3ll, n * n), pn = qkp(3ll, n);
    fac[0] = inv[0] = invn[0] = invi[0] = powi[0] = pown[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
        powi[i] = powi[i - 1] * 3 % mod;
        pown[i] = pown[i - 1] * pn % mod;
    &amp;#125;
    inv[n] = qkp(fac[n], mod - 2);
    invi[n] = qkp(powi[n], mod - 2);
    invn[n] = qkp(pown[n], mod - 2);
    for (int i = n - 1; i; --i) &amp;#123;
        inv[i] = inv[i + 1] * (i + 1) % mod;
        invi[i] = invi[i + 1] * 3 % mod;
        invn[i] = invn[i + 1] * pn % mod;
    &amp;#125;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    long long g = 0ll;
    auto f = [&amp;amp;](int i, int j) &amp;#123; // make sure (!i || !j)
        if (i == 0 &amp;amp;&amp;amp; j == 0)
            return pnn;
        else if (i == 0)
            return C(n, j) * powi[j] % mod * pown[n - j] % mod;
        return C(n, i) * powi[i] % mod * pown[n - i] % mod;
    &amp;#125;;
    for (int j = 0, p = 1; j &amp;lt;= n; ++j, p = mod - p)
        (g += p * f(0, j)) %= mod;
    for (int i = 1, p = mod - 1; i &amp;lt;= n; ++i, p = mod - p)
        (g += p * f(i, 0) % mod + p * C(n, i) % mod * pnn % mod * invn[i] % mod * 3 % mod * (qkp(mod - invi[n - i] + 1, n) + mod - 1) % mod) %= mod;
    std::cout &amp;lt;&amp;lt; (pnn + mod - g) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---å»-m-nom&#34;&gt;D - å» M / NoM&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11316&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11316&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f(i)\)&lt;/span&gt; ä¸ºè‡³å°‘æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯¹ä¸åˆæ³•å…ƒç´ çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™å®¹æ–¥å¾—åˆ°ç­”æ¡ˆ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=0}^n (-1)^i\cdot f(i)\)&lt;/span&gt;ã€‚è€ƒè™‘æ€ä¹ˆè®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(f(i)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;&lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; æ•´é™¤ &lt;span class=&#34;math inline&#34;&gt;\(dis(x, y) \iff (pos_x - pos_y)\bmod M=0\iff pos_x\equiv pos_y\pmod M\)&lt;/span&gt;ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æŠŠå…³äº &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt; åŒä½™çš„ä½ç½®æ”¾åœ¨ä¸€ä¸ªç»„ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦è®©ä¸€å¯¹å…ƒç´ ä¸èƒ½é€‰åŒä¸€ç»„çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å®¹æ–¥ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f(i)\)&lt;/span&gt; è¡¨ç¤ºè‡³å°‘æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯¹ç‚¹é€‰åˆ°ä¸€ç»„çš„æ–¹æ¡ˆæ•°ï¼Œè€ƒè™‘æ€ä¹ˆè®¡ç®—ã€‚å‡è®¾æˆ‘ä»¬è¦åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ç»„ï¼ˆsize ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s_k\)&lt;/span&gt;ï¼‰ä¸­é€‰å‡º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å¯¹ä½ç½®ï¼Œå®é™…ä¸Šåªéœ€è¦é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(2x\)&lt;/span&gt; ä¸ªä½ç½®ç„¶åä»»æ„åˆ†é…ç»™è¿™ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å¯¹æ•°ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(A_{s_k}^{2x}\)&lt;/span&gt;ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(dp_{i, j}\)&lt;/span&gt; è¡¨ç¤º DP åˆ°ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç»„ï¼Œå·²ç»é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¯¹ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(dp_{i,j}=\sum\limits_{k=0}^jC_{n-(j - k)}^{j-k}\times dp_{i-1,j-k}\times A_{s_i}^{2k}\)&lt;/span&gt;ã€‚ä¹ä¸€çœ‹å¥½åƒæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt; çš„ï¼Œä½†æ˜¯åˆ«å¿˜äº† &lt;span class=&#34;math inline&#34;&gt;\(\sum s_i=2n\)&lt;/span&gt;ï¼Œæ‰€ä»¥åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(f(i)\)&lt;/span&gt; å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(dp_{m,i}\times (2n-2i)!\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; s(m + 1);
    std::vector&amp;lt;long long&amp;gt; fac(2 * n + 1), inv(2 * n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= 2 * n; ++i)
        ++s[i % m + 1], fac[i] = fac[i - 1] * i % mod;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[2 * n] = qkp(fac[2 * n], mod - 2);
    for (int i = 2 * n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto A = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod;
    &amp;#125;;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; dp(m + 1, std::vector&amp;lt;long long&amp;gt; (n + 1));
    dp[0][0] = 1ll;
    for (int i = 1; i &amp;lt;= m; ++i)
        for (int j = 0; j &amp;lt;= n; ++j) &amp;#123;
            for (int k = 0; k &amp;lt;= j &amp;amp;&amp;amp; 2 * k &amp;lt;= s[i]; ++k)
                (dp[i][j] += C(n - (j - k), k) * dp[i - 1][j - k] % mod * A(s[i], 2 * k) % mod) %= mod;
            // printf(&amp;quot;s = %d, dp[%d][%d] = %lld\n&amp;quot;, s[i], i, j, dp[i][j]);
        &amp;#125;
    long long res = 0ll;
    for (int i = 0, p = 1; i &amp;lt;= n; ++i, p = mod - p)
        (res += p * dp[m][i] % mod * fac[2 * n - 2 * i] % mod) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---kdoi-11å½©ç¯æ™šä¼š&#34;&gt;E - ã€ŒKDOI-11ã€å½©ç¯æ™šä¼š&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11292&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11292&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\({cnt_i}^2\)&lt;/span&gt; çš„å«ä¹‰ï¼Œå³åœ¨æ‰€æœ‰é¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ã€é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; çš„é“¾ä¸­æœ‰æ”¾å›åœ°é€‰ä¸¤æ¬¡çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶å¤æ‚åº¦é‡Œæ˜¯ä¸èƒ½åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ï¼Œæ‰€ä»¥æ”¾å¼ƒç›´æ¥ç»Ÿè®¡ &lt;span class=&#34;math inline&#34;&gt;\(cnt_i\)&lt;/span&gt; çš„æƒ³æ³•ã€‚æ˜¾ç„¶æ¯ç§é¢œè‰²æ˜¯ç­‰ä»·çš„ï¼Œè€ƒè™‘è®¡ç®—é€‰æ‹©ä¸¤æ¡é“¾å¯ä»¥ç»™ç­”æ¡ˆå¸¦æ¥çš„è´¡çŒ®ï¼šç­”æ¡ˆçš„å½¢å¼æ˜¯ä¸ªå’Œå¼ï¼›å¯¹äºä¸¤æ¡åŒè‰²é“¾ &lt;span class=&#34;math inline&#34;&gt;\(p,q\)&lt;/span&gt;ï¼Œå‡è®¾é¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¼šå¯¹ &lt;span class=&#34;math inline&#34;&gt;\({cnt_i}^2\)&lt;/span&gt; å¸¦æ¥ &lt;span class=&#34;math inline&#34;&gt;\(k^{n-2l-|p\cap q|}\)&lt;/span&gt; çš„è´¡çŒ®ï¼Œå¯¹æ€»ç­”æ¡ˆå¸¦æ¥ &lt;span class=&#34;math inline&#34;&gt;\(k^{n-2l-|p\cap q| + 1}\)&lt;/span&gt; çš„è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œå¦‚æœè¦æšä¸¾è®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(|p\cap q|\)&lt;/span&gt; å°±æ— æ³•é¿å… &lt;span class=&#34;math inline&#34;&gt;\(O(n^5)\)&lt;/span&gt;ï¼Œè€ƒè™‘æ›´æœ‰æ½œåŠ›çš„æ–¹æ³•ï¼šå°†é—®é¢˜è½¬åŒ–ä¸ºå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œæ±‚äº¤é›†å¤§å°æ°å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„é“¾å¯¹ä¸ªæ•°ã€‚ç„¶è€Œã€Œæ°å¥½ã€æ˜¯ä¸æ–¹ä¾¿è®¡ç®—çš„â€”â€”å‡å¦‚å½“å‰ä¸¤é“¾åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æ¬¡é‡åˆï¼Œå¦‚æœå‡è®¾ä¸‹ä¸€æ¬¡åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ¬¡é‡åˆï¼Œå°±éœ€è¦ä¿è¯åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u,v\)&lt;/span&gt; ä¹‹é—´ä¸èƒ½é‡åˆâ€”â€”è¿™å¹¶ä¸å¥½æ“ä½œã€‚äºŒé¡¹å¼åæ¼”å°†æ°å¥½è½¬åŒ–ä¸ºè‡³å°‘ï¼Œåˆ™é™åˆ¶å‡å¼±ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,c,l_1,l_2}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(p,q\)&lt;/span&gt; å½“å‰åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„é‡åˆï¼Œè§†é‡å†…çš„ &lt;span class=&#34;math inline&#34;&gt;\(p,q\)&lt;/span&gt; é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l_1,l_2\)&lt;/span&gt;ï¼Œè‡³å°‘å·²ç»é‡åˆäº† &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; æ¬¡çš„æ–¹æ¡ˆæ•°ã€‚é¢„å¤„ç†å‡ºèµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æ­¥æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l_1,l_2\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ä¸ºåˆå§‹å€¼ã€‚æšä¸¾å¯èƒ½çš„åç»­é‡åˆç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼ˆæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æ‹“æ‰‘åº &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;u\)&lt;/span&gt;ï¼‰æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{v,c+1,l_1&amp;#39;,l_2&amp;#39;}\gets f_{v,c+1,l_1&amp;#39;,l_2&amp;#39;} + f_{u,c,l_1,l_2}\)&lt;/span&gt;ã€‚é¢„å¤„ç†å‡º &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt; é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\Delta\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼ˆè¿™æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^3l)\)&lt;/span&gt; çš„ï¼‰ä¼˜åŒ–è½¬ç§»ï¼Œåœ¨ç®—å‡º &lt;span class=&#34;math inline&#34;&gt;\(nex_{u,l}\)&lt;/span&gt; è¡¨ç¤ºä» &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å‡ºå‘èµ° &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; æ­¥çš„æ–¹æ¡ˆæ•°å¤„ç†ç­”æ¡ˆï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(F(i)=\sum_{u,l_1,l_2}f_{u,l_1,l_2}\cdot nex_{u,l-l_1}\cdot nex_{u,l-l_2}\)&lt;/span&gt;ï¼Œæšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(u,c,l_1,l_2,v,l_1&amp;#39;,l_2&amp;#39;\)&lt;/span&gt;ï¼Œå°±å¯ä»¥è¾¾åˆ°ä¼˜ç§€çš„ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2l^5+n^3l)\)&lt;/span&gt;ï¼ç®€ç›´æ˜¯ä»¤äººéœ‡æ’¼ &lt;img src=&#34;/em/kt.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ç»™å‡ºç¬¬ä¸€ä¸ªä¼˜åŒ–ï¼šå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(l_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(l_2\)&lt;/span&gt; çš„è½¬ç§»å½¼æ­¤ä¸å¹²æ‰°ï¼Œè€ƒè™‘å»ºç«‹ä¸€ä¸ªä¸´æ—¶æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt;ï¼Œå…ˆä» &lt;span class=&#34;math inline&#34;&gt;\(f_u,c\)&lt;/span&gt; è½¬ç§» &lt;span class=&#34;math inline&#34;&gt;\(l_1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt;ï¼Œå†ä» &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; è½¬ç§» &lt;span class=&#34;math inline&#34;&gt;\(l_2\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{v,c+1}\)&lt;/span&gt;ï¼Œåˆ™å¤æ‚åº¦é™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2l^4+n^3l)\)&lt;/span&gt;ï¼Œä»ä¸è¶³ä»¥é€šè¿‡ã€‚&lt;/p&gt;
&lt;p&gt;DP è¿‡ç¨‹ä¸Šçš„ä¼˜åŒ–å·²ç»ä¸‡ç­–å°½ï¼Œè€ƒè™‘ä»å¼å­æœ¬èº«æ¶ˆå…ƒå‡å°‘ DP ç»´åº¦å…¥æ‰‹ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(h(i)\)&lt;/span&gt; è¡¨ç¤ºäº¤é›†å¤§å°æ°å¥½æ°å¥½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æ­¤æ—¶ç­”æ¡ˆå¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=0}^l k^{n-2l+i+1}\times h(i)\)&lt;/span&gt;ã€‚åˆ &lt;span class=&#34;math inline&#34;&gt;\(F(i)=\sum\limits_{j=i}^lC_j^i\cdot h(j)\)&lt;/span&gt;ï¼ŒäºŒé¡¹å¼åæ¼”å¾—ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
res&amp;amp;=\sum\limits_{i=0}^lk^{n-2l+i+1}\cdot \sum_{j=i}^l(-1)^{j-i}\cdot C_j^i\cdot F(j)\\
&amp;amp;=k^{n-2l+1}\cdot\sum_{j=0}^l \sum_{i=0}^j k^i\cdot (-1)^{j-i}\cdot C_j^i\cdot F(j)\\
&amp;amp;=k^{n-2l+1}\cdot \sum_{j=0}^l (k-1)^j\cdot F(j)
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;æ³¨æ„è¿™é‡Œåˆ©ç”¨äº†äºŒé¡¹å¼åæ¼”çš„ç³»æ•°å¯ä»¥å’Œäº¤æ¢æ±‚å’Œé¡ºåºåçš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¬¡é¡¹ï¼ˆæˆ– &lt;span class=&#34;math inline&#34;&gt;\(j-i\)&lt;/span&gt; æ¬¡é¡¹ï¼Œå‚è§ &lt;a href=&#34;#c---sky-full-of-stars&#34;&gt;Sky Full of Stars ä¸­æœ€åä¸€æ­¥çš„å¤„ç†&lt;/a&gt;ï¼‰ç»„æˆäºŒé¡¹å¼å®šç†çš„ç‰¹ç‚¹&lt;/mark&gt;ï¼Œä»¥ä¾¿åŸºäºå¼å­ç»“æ„å°½å¯èƒ½æ¶ˆå…ƒã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ­¤æ—¶ç­”æ¡ˆå¼å·²ç»å’Œ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; æ— å…³ï¼Œå¯ä»¥ä¸¢æ‰ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; è¿™ä¸€ç»´ï¼Œå’Œ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; æœ‰å…³çš„è®¡ç®—å·²ç»åœ¨è½¬ç§»æ—¶å¤„ç†äº†ã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_{v,l_1&amp;#39;,l_2&amp;#39;}=\sum f_{u,l_1,l_2}\times (k-1)\)&lt;/span&gt;ï¼Œå¤æ‚åº¦é™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2l^3+n^3l)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;è®°å¾—è¿˜è¦ç®—ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(F(0)\)&lt;/span&gt;ï¼Œå³ä»»é€‰ä¸€æ¡åˆæ³•é“¾çš„æ–¹æ¡ˆæ•°å¹³æ–¹ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;// å…„å¼Ÿä½ å¥½é¦™
// å…„å¼Ÿä½ æ˜¯ä¾æ‰˜æ‰“åˆ†ï¼Œæˆ‘è¸é©¬åƒåƒåƒåƒåƒ
#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;party3.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using arrr = std::vector&amp;lt;arr&amp;gt;;
    using arrrr = std::vector&amp;lt;arrr&amp;gt;;
    int n, k, l, m;
    std::cin &amp;gt;&amp;gt; n, std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k &amp;gt;&amp;gt; l &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; deg(n + 1), id;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    for (int x, y, c; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; c;
        ++deg[y], g[x].emplace_back(y, c);
    &amp;#125;
    arrrr to(n + 1, arrr(n + 1, arr(l + 1)));
    arrr pre(n + 1, arr(l + 1)), nex(n + 1, arr(l + 1));
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (!deg[i])
                q.push(i);
        for (int u; !q.empty(); ) &amp;#123;
            u = q.front(), q.pop();
            to[u][u][0] = 1ll, id.push_back(u);
            for (auto i : id)
                for (int j = 0; j &amp;lt;= l; ++j) &amp;#123;
                    (pre[u][j] += to[i][u][j]) %= mod;
                    // printf(&amp;quot;to[%d][%d][%d] = %lld\n&amp;quot;, i, u, j, to[i][u][j]);
                &amp;#125;
            // for (int j = 0; j &amp;lt;= l; ++j)
            //     printf(&amp;quot;pre[%d][%d] = %lld\n&amp;quot;, u, j, pre[u][j]);
            for (auto [v, c] : g[u]) &amp;#123;
                for (auto i : id)
                    for (int j = 1; j &amp;lt;= l; ++j)
                        (to[i][v][j] += to[i][u][j - 1] * c) %= mod;
                if (!--deg[v])
                    q.push(v);
            &amp;#125;
        &amp;#125;
        for (int u = 1; u &amp;lt;= n; ++u)
            for (int v = 1; v &amp;lt;= n; ++v)
                for (int i = 0; i &amp;lt;= l; ++i)
                    (nex[u][i] += to[u][v][i]) %= mod;
    &amp;#125;
    arrrr f(n + 1, arrr(l + 1, arr(l + 1)));
    &amp;#123;
        for (int i = 1; i &amp;lt;= n; ++i)
            for (int l1 = 1; l1 &amp;lt;= l; ++l1)
                for (int l2 = 1; l2 &amp;lt;= l; ++l2)
                    f[i][l1][l2] = pre[i][l1 - 1] * pre[i][l2 - 1] % mod * (k - 1) % mod;
        for (auto i = 0; i &amp;lt; n; ++i) &amp;#123;
            int u = id[i];
            // for (int l1 = 1; l1 &amp;lt;= l; ++l1)
            //     for (int l2 = 1; l2 &amp;lt;= l; ++l2)
            //         printf(&amp;quot;f[%d][%d][%d] = %lld\n&amp;quot;, u, l1, l2, f[u][l1][l2]);
            for (auto j = i + 1; j &amp;lt; n; ++j) &amp;#123;
                arrr g(l + 1, arr(l + 1));
                int v = id[j];
                for (int l1 = 1; l1 &amp;lt; l; ++l1)
                    for (int _l1 = l1 + 1; _l1 &amp;lt;= l; ++_l1) &amp;#123;
                        auto K = to[u][v][_l1 - l1];
                        if (K)
                            for (int l2 = 1; l2 &amp;lt; l; ++l2)
                                (g[_l1][l2] += f[u][l1][l2] * K) %= mod;
                    &amp;#125;
                for (int _l1 = 2; _l1 &amp;lt;= l; ++_l1)
                    for (int l2 = 1; l2 &amp;lt; l; ++l2)
                        if (g[_l1][l2])
                            for (int _l2 = l2 + 1; _l2 &amp;lt;= l; ++_l2)
                                (f[v][_l1][_l2] += g[_l1][l2] * to[u][v][_l2 - l2] % mod * (k - 1)) %= mod; 
            &amp;#125;
        &amp;#125;
    &amp;#125;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    auto res(0ll);
    for (int u = 1; u &amp;lt;= n; ++u)
        for (int v = 1; v &amp;lt;= n; ++v)
            (res += to[u][v][l - 1]) %= mod;
    (res *= res) %= mod;
    for (int u = 1; u &amp;lt;= n; ++u)
        for (int l1 = 1; l1 &amp;lt;= l; ++l1)
            for (int l2 = 1; l2 &amp;lt;= l; ++l2)
                (res += f[u][l1][l2] * nex[u][l - l1] % mod * nex[u][l - l2] % mod) %= mod;
    res = res % mod * (qkp(k, n + 1) * qkp(qkp(k, 2 * l), mod - 2) % mod) % mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;g---å°æ˜Ÿæ˜Ÿ&#34;&gt;G - å°æ˜Ÿæ˜Ÿ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3349&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3349&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè€ƒè™‘æ¯”è¾ƒæš´åŠ›çš„åšæ³•ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,S}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¿™ä¸ªå­æ ‘é‡Œé¢é€‰äº†é›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„é¢œè‰²ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œç»´æ•°é‡Œä¹‹æ‰€ä»¥æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ˜¯ä¸ºäº†æ»¡è¶³è¿è¾¹é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ ‘ä¸Šå­é›† DPï¼Œå‘ç°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n^4\cdot 2^n)\)&lt;/span&gt; çš„ï¼Œ&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;cf785d-anton-and-school---2&#34;&gt;CF785D Anton and School - 2&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/785/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/785/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“æƒ³åˆ°æšä¸¾æ¯ä¸ª &lt;code&gt;(&lt;/code&gt; ä½œä¸ºåˆ†ç•Œç‚¹çš„æƒ…å†µï¼Œé‚£ä¹ˆé’¦å®šå½“å‰æšä¸¾çš„ &lt;code&gt;(&lt;/code&gt; æ˜¯è¦é€‰çš„ã€‚å¯¹äºå½“å‰ &lt;code&gt;(&lt;/code&gt;ï¼Œè‹¥å…¶å·¦è¾¹ï¼ˆä¸å«ï¼‰çš„ &lt;code&gt;(&lt;/code&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªè€Œå³è¾¹çš„ &lt;code&gt;)&lt;/code&gt; æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªï¼Œæšä¸¾é™¤äº†å½“å‰ &lt;code&gt;(&lt;/code&gt; è¿˜è¦é€‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ª &lt;code&gt;(&lt;/code&gt;ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum_{i=0}C_n^{i-1}\cdot C_m^i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™ä¸ªå½¢å¼å¯ä»¥èŒƒå¾·è’™å¾·å·ç§¯ï¼š&lt;span class=&#34;math inline&#34;&gt;\(\sum_{i=0}C_n^{i-1}\cdot C_m^i=\sum_{i=0}C_n^{n-i+1}\cdot C_m^i=C_{n+m}^{n+1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºæ€ä¹ˆè®°å¿†èŒƒå¾·è’™å¾·å·ç§¯ï¼Œå‘ç°ä¸Šä¸‹ç›¸åŠ ï¼Œä¹Ÿå¯ä»¥ä»ç»„åˆæ„ä¹‰è®°å¿†ï¼šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªçƒä¸­é€‰å‡º &lt;span class=&#34;math inline&#34;&gt;\(k-i\)&lt;/span&gt; ä¸ªçƒï¼Œå†ä» &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªçƒä¸­é€‰å‡º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªçƒçš„æ€»æ–¹æ¡ˆå°±æ˜¯ä» &lt;span class=&#34;math inline&#34;&gt;\(n+m\)&lt;/span&gt; ä¸ªçƒä¸­ç›´æ¥é€‰å‡º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªçƒçš„æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ¤æ–­å³ä¾§æ²¡æœ‰ &lt;code&gt;)&lt;/code&gt; çš„æ—¶å€™è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    int n = s.length();
    s = &amp;quot; &amp;quot; + s;
    std::vector&amp;lt;int&amp;gt; cnt1(n + 1), cnt2(n + 1);
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
        cnt1[i] = cnt1[i - 1] + (s[i] == &amp;#39;(&amp;#39;);
    &amp;#125;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    cnt2[n] = (s[n] == &amp;#39;)&amp;#39;);
    for (int i = n - 1; i; --i) &amp;#123;
        cnt2[i] = cnt2[i + 1] + (s[i] == &amp;#39;)&amp;#39;);
        inv[i] = inv[i + 1] * (i + 1) % mod;
    &amp;#125;
    long long res = 0ll;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        if (n &amp;lt; m)
            return 0ll;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        if (s[i] == &amp;#39;(&amp;#39;)
            (res += C(cnt1[i] + cnt2[i] - 1, cnt1[i])) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;cf1332e-height-all-the-same&#34;&gt;CF1332E Height All the Same&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1332/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1332/E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°ç¬¬ä¸€ä¸ªæ“ä½œæ˜¯ç”¨æ¥æ”¹å˜ä¸¤ä¸ªæ•°å¥‡å¶æ€§çš„ï¼›è€Œç¬¬äºŒä¸ªæ“ä½œèƒ½åœ¨å…¨å›¾å¥‡å¶æ€§ç›¸åŒçš„ä»»ä½•æƒ…å†µä¸‹è¾¾æˆè¦æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°å¦‚æœæˆ‘ä»¬æƒ³åŒæ—¶ä»…æ”¹å˜ä»»æ„ä¸¤ä¸ªæ•°çš„å¥‡å¶æ€§ï¼Œå¯ä»¥åœ¨æ£‹ç›˜ä¸Šä»»æ‰¾ä¸€æ¡è·¯å¾„ä¸€è·¯ä½¿ç”¨æ“ä½œä¸€ã€‚åªè¦æŸç§å¥‡å¶æ€§çš„å…ƒç´ ä¸ªæ•°å…±æœ‰å¶æ•°ä¸ªï¼Œå°±èƒ½é€šè¿‡è‹¥å¹²æ¬¡æ“ä½œä¸€æŠŠå®ƒä»¬å…¨éƒ¨å˜æˆå¦ä¸€ç§å¥‡å¶æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(K_1\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(L\sim R\)&lt;/span&gt; ä¸­å¥‡æ•°çš„ä¸ªæ•°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(K_2\)&lt;/span&gt; ä¸ºå¶æ•°ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
res=\sum_{i=0}^{nm} C_{nm}^i\times {K_1}^i\cdot {K_2}^{nm-i}\cdot [i\bmod 2=0]
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°è¿™ä¸ªä¸œè¥¿å’ŒäºŒé¡¹å¼å®šç†ç®€ç›´åƒå¾—ä¸èƒ½å†åƒäº†ï¼ä½†å¤šäº†ä¸€ä¸ªç³»æ•°å¯¼è‡´æ²¡åŠæ³•çœç•¥æšä¸¾è¿‡ç¨‹ã€‚å¦‚æœè¿›è¡Œå˜å½¢å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
res=(K_1+K_2)^{nm}-\sum_{i=0}^{nm} C_{nm}^i\times {K_1}^i\cdot {K_2}^{nm-i}\cdot [i\bmod 2=1]
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä¼¼ä¹ä¾ç„¶æ²¡æœ‰å‡ºè·¯ï¼ä½†è¿™é‡Œæœ‰ä¸ªç¥å¥‡çš„æ“ä½œï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
res=(-K_1+K_2)^{nm}+\sum_{i=0}^{nm} C_{nm}^i\times {K_1}^i\cdot {K_2}^i\cdot [i\bmod 2=1]
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;äºŒå¼ç›¸åŠ å°±å¯ä»¥&lt;mark&gt;æ¶ˆå…ƒ&lt;/mark&gt;ï¼Œå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(2\cdot res=(K_1+K_2)^{nm}+(K_1-K_2)^{nm}\)&lt;/span&gt;ã€‚&lt;mark&gt;è¿™å¯ç¤ºæˆ‘ä»¬äºŒé¡¹å¼å®šç†ä¸­çš„ç¬¦å·å’Œå¥‡å¶æ€§çš„æ·±åˆ‡è”ç³»ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨è´¹é©¬å°å®šç†å¯¹æ¬¡æ•°è¿›è¡Œäº†å¤„ç†ï¼Œä½ å¯èƒ½éœ€è¦æ³¨æ„æ¬¡æ•°å¯èƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\text{mod} -1\)&lt;/span&gt; çš„å€æ•°ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
const int inv2 = 499122177;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    long long n, m, l, r, k1, k2;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r, k1 = (r - l + 1) / 2, k2 = (r - l + 1) - k1;
    auto qkp = [](long long x, long long y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    if (n * m % 2)
        std::cout &amp;lt;&amp;lt; qkp(r - l + 1, n * m) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    else
        std::cout &amp;lt;&amp;lt; (qkp(r - l + 1, n * m) + qkp((k1 + mod - k2) % mod, n * m)) % mod * inv2 % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---äº¤é”™åºåˆ—&#34;&gt;A - äº¤é”™åºåˆ—&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4456&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4456&lt;/a&gt;&lt;/p&gt;
&lt;figure&gt;
&lt;img src=&#34;2.png&#34; alt=&#34;å‡ºé¢˜äººç–‘ä¼¼éœ€è¦åŠ å¼ºæ•°å­¦åŠŸåº•ï¼ˆï¼Ÿï¼‰&#34; /&gt;&lt;figcaption&gt;å‡ºé¢˜äººç–‘ä¼¼éœ€è¦åŠ å¼ºæ•°å­¦åŠŸåº•ï¼ˆï¼Ÿï¼‰&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;p&gt;å®¹æ˜“æƒ³åˆ°æŠŠç­”æ¡ˆç”¨äºŒé¡¹å¼å®šç†æ‹†å¼€ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
res&amp;amp;=\sum_y f_y\cdot y^b\cdot (n-y)^a\\
&amp;amp;=\sum_y f_y\cdot y^b\cdot \sum_{i=0}^a C_a^i\cdot n^i\cdot(-y)^{a-i}\\
&amp;amp;=\sum_y\sum_{i=0}^a f_y\cdot C_a^i\cdot n^i\cdot(-1)^{a-i}\cdot y^{a+b-i}\\
&amp;amp;=\sum_{i=0}^a C_a^i\cdot n^i\cdot(-1)^{a-i}\cdot \sum_y f_y\cdot y^{a+b-i}\\
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå‘ç°åé¢é‚£ä¸ª sigma ä¸å¤ªæœ‰åŠæ³•æ±‚ã€‚ä¸€ä¸ªæ¯”è¾ƒä¼˜é›…çš„æ–¹æ³•æ˜¯æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(y^{a+b-i}\)&lt;/span&gt; ç›´æ¥ä½œä¸ºç³»æ•°è€Œéä¸‹æ ‡å¡åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; é‡Œå»ï¼Œå³ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(\forall \,y\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\sum y^i\)&lt;/span&gt; ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(dp_{n,i,0/1}\)&lt;/span&gt; è¡¨ç¤ºå½“å‰ DP åˆ°ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä½ï¼Œè¦æ±‚å¹‚æ¬¡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæœ€åä¸€ä½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚åˆ™æ˜¾ç„¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(dp_{n,i,0}=dp_{n-1,i,0}+dp_{n-1,i,1}\)&lt;/span&gt;ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(dp_{n,i,1}\)&lt;/span&gt;ï¼Œå› ä¸ºæ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(\forall\, k,k\gets k+1\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\((k+1)^i=\sum\limits_{j=0}^i C_i^j \cdot k^j\)&lt;/span&gt; å³ &lt;span class=&#34;math inline&#34;&gt;\(dp_{n,i,1}=\sum\limits_{j=0}^i C_i^j\cdot dp_{n-1,j,0}\)&lt;/span&gt;ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; çš„èŒƒå›´æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(90\)&lt;/span&gt;ï¼Œå¾ˆææ€–çš„äº‹æƒ…æ˜¯è¿™æ˜¯å¯ä»¥çŸ©é˜µçš„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å°±åƒæˆ‘ä»¬éƒ½çŸ¥é“çš„é‚£æ ·ï¼ŒçŸ©é˜µåœ¨åŠ å®Œä¹‹åå†å–æ¨¡å°±ä¼šå¿«å¾ˆå¤šâ€¦â€¦&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int mod;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, a, b;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; a &amp;gt;&amp;gt; b &amp;gt;&amp;gt; mod;
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; C(a + b + 1, std::vector&amp;lt;long long&amp;gt;(a + b + 1));
    for (int i = 0; i &amp;lt;= a + b; ++i) &amp;#123;
        C[i][0] = 1ll;
        for (int j = 1; j &amp;lt;= i; ++j)
            C[i][j] = (C[i - 1][j - 1] + C[i - 1][j]) % mod;
    &amp;#125;
    struct mat &amp;#123;
        int n, m;
        std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; a;
        mat(int n, int m, bool flag = 0): n(n), m(m), a(n, std::vector&amp;lt;long long&amp;gt; (m)) &amp;#123;
            if (flag)
                for (int i = 0; i &amp;lt; n; ++i)
                    a[i][i] = 1ll;
            return;
        &amp;#125;
        mat operator* (const mat &amp;amp;q) const &amp;#123;
            mat res(n, q.m);
            for (int i = 0; i &amp;lt; n; ++i)
                for (int k = 0; k &amp;lt; q.m; ++k) &amp;#123;
                    for (int j = 0; j &amp;lt; m; ++j)
                        res.a[i][k] += a[i][j] * q.a[j][k];
                    res.a[i][k] %= mod;
                &amp;#125;
            return res;
        &amp;#125;
        mat operator^ (int q) const &amp;#123;
            mat res(n, n, 1), x(*this);
            for (; q; x = x * x, q &amp;gt;&amp;gt;= 1)
                if (q &amp;amp; 1)
                    res = res * x;
            return res;
        &amp;#125;
    &amp;#125; f(1, 2 * (a + b + 1)), op(2 * (a + b + 1), 2 * (a + b + 1));
    auto fun = [&amp;amp;](int i, int j) &amp;#123;
        return i + j * (a + b + 1);
    &amp;#125;;
    f.a[0][fun(0, 0)] = 1ll;
    for (int i = 0; i &amp;lt;= a + b; ++i)
        op.a[fun(i, 0)][fun(i, 0)] = op.a[fun(i, 1)][fun(i, 0)] = 1ll;
    for (int i = 0; i &amp;lt;= a + b; ++i)
        for (int j = 0; j &amp;lt;= i; ++j)
            op.a[fun(j, 0)][fun(i, 1)] = C[i][j];
    f = f * (op ^ n);
    // for (int i = 0; i &amp;lt;= n; ++i) &amp;#123;
    //     if (i)
    //         f = f * op;
    //     for (int j = 0; j &amp;lt;= a + b; ++j)
    //         printf(&amp;quot;f[%d][%d] = %lld / %lld\n&amp;quot;, i, j, f.a[0][fun(j, 0)], f.a[0][fun(j, 1)]);
    // &amp;#125;
    auto res = 0ll;
    for (int i = 0; i &amp;lt;= a; ++i) &amp;#123;
        static auto p(1ll), k((a % 2) ? mod - 1ll : 1ll);
        (res += C[a][i] * p % mod * k % mod * (f.a[0][fun(a + b - i, 0)] + f.a[0][fun(a + b - i, 1)]) % mod) %= mod;
        (p *= n) %= mod, k = mod - k;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---different-subsets-for-all-tuples&#34;&gt;B - Different Subsets For All Tuples&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF660E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF660E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä½ å¯èƒ½éœ€è¦çŸ¥é“ï¼Œå¦‚æœå·²çŸ¥ä¸€ä¸ªåºåˆ—ï¼Œå¦‚ä½•å¾—åˆ°ç­”æ¡ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„å–ä¸€ä¸ªå­åºåˆ—çš„æœ«å°¾ï¼Œæšä¸¾ä¸Šä¸€ä¸ªå…ƒç´  &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œæ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¹‹å‰æœ€é åçš„ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_j=x\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_i=\sum f_j\)&lt;/span&gt;ï¼Œæ¢è¨€ä¹‹éœ€è¦ä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\((j,i)\)&lt;/span&gt; èŒƒå›´å†…æ²¡æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å‡ºç°ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶åºåˆ—æœªçŸ¥ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, x}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„å–ä¸€ä¸ªå­åºåˆ—æœ«å°¾ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼›æŒ‰ç…§è´¡çŒ®çš„è§†è§’æ¥çœ‹å¾…ï¼Œæ¯ä¸ªå¯ä»¥å’Œ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»„æˆæ–°å­åºåˆ—çš„æ–¹æ¡ˆå¯ä»¥å¸¦æ¥ &lt;span class=&#34;math inline&#34;&gt;\(m^{i-1}\)&lt;/span&gt; çš„è´¡çŒ®ï¼ˆå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å·²ç»å›ºå®šä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå…¶ä»–ä½ç½®å¯ä»¥ä»»é€‰ï¼‰ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,x}=m^i\times \sum_{j&amp;lt;i,y}f_{j,y}\times (m-1)^{i-j-1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±æƒŠè®¶åœ°å‘ç°å¼å­å’Œ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; è¿™ä¸€ç»´æ²¡æœ‰å…³ç³»äº†ã€‚æ‰€ä»¥ç›´æ¥å¸¦ä¸Šç³»æ•°å¾—åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_i&amp;amp;=m^i\times \sum_{j&amp;lt;i} f_j\times (m-1)^{i-j-1}\times m\\
&amp;amp;=m^i\times (m-1)^{i-1}\times m\cdot \sum_{j&amp;lt;i} f_j\times (m-1)^{-j}
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‰ç¼€å’Œä¼˜åŒ–ä¸€ä¸‹å°±å¯ä»¥å¿«é€Ÿæ±‚äº†ã€‚æœ€ç»ˆçš„ç­”æ¡ˆå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(res=m^n+\sum f_i\times (m-1)^{n-i}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    if (m == 1)
        std::cout &amp;lt;&amp;lt; (n + 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    else &amp;#123;
        std::vector&amp;lt;long long&amp;gt; f(n + 1), s(n + 1), pm1(n + 1);
        pm1[0] = 1ll;
        for (int i = 1; i &amp;lt;= n; ++i)
            pm1[i] = pm1[i - 1] * (m - 1) % mod;
        auto qkp = [](long long x, int y) &amp;#123;
            auto res(1ll);
            for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
                if (y &amp;amp; 1)
                    (res *= x) %= mod;
            return res;
        &amp;#125;;
        auto res(qkp(m, n));
        const auto invm = qkp(m - 1, mod - 2);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            static long long p(m), inv(invm);
            f[i] = (p + pm1[i - 1] * m % mod * s[i - 1] % mod) % mod;
            s[i] = (s[i - 1] + f[i] * inv % mod) % mod;
            (res += f[i] * pm1[n - i] % mod) %= mod;
            (p *= m) %= mod, (inv *= invm) %= mod;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;; 
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;g---gardens&#34;&gt;G - Gardens&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc235/tasks/abc235_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc235/tasks/abc235_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ²¡æœ‰ã€æ¯ä¸ªäººå¿…é¡»æœ‰ä¸€ä¸ªå…ƒç´ ã€è¿™ä¸ªé™åˆ¶ï¼Œå°±å¯ä»¥éšä¾¿åšäº†ã€‚ç°åœ¨åŠ ä¸Šäº†è¿™ä¸ªé™åˆ¶ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨æ²¡å¾—åˆ°çš„äººæ¥å®¹æ–¥ã€‚é’¦å®šè‡³å°‘æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªäººæ²¡æ‹¿åˆ°ï¼Œå¾—åˆ°ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=0}^n (-1)^i\cdot C_n^i\cdot \left(\sum\limits_{j=0}^a C_i^j\right)\cdot \left(\sum\limits_{j=0}^b C_i^j\right)\cdot \left(\sum\limits_{j=0}^c C_i^j\right)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆç®— &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{j=0}^a C_i^j\)&lt;/span&gt; å‘¢ï¼Ÿå½“ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;gt; i\)&lt;/span&gt; æ—¶ï¼ŒäºŒé¡¹å¼æ˜¯å¥½æ±‚çš„ï¼›å½“ &lt;span class=&#34;math inline&#34;&gt;\(a\le i\)&lt;/span&gt; æ—¶å‘¢ï¼Ÿçœ‹åˆ°è¿™ä¸ªå¼å­å¾ˆå®¹æ˜“å¸¦åˆ°æ¨è¾‰ä¸‰è§’é‡Œå»ï¼Œä¹Ÿå°±æ˜¯æ±‚ä¸€è¡Œçš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸ªæ•°ã€‚æ³¨æ„åˆ°å¯ä»¥ç”¨ä¸Šä¸€è¡Œçš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; å¾—åˆ°ï¼ˆå‡è®¾ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j-1\)&lt;/span&gt; è¡Œå‰ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸ªæ•°ä¹‹å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_a(j-1)\)&lt;/span&gt;ï¼‰ï¼š&lt;span class=&#34;math inline&#34;&gt;\(f_a(j)=f_a(j-1)\times 2-C_{j-1,a}\)&lt;/span&gt;ã€‚&lt;mark&gt;ä½ éœ€è¦æ„è¯†åˆ°ï¼Œç”±äºä¸Šä¸€è¡Œä¹Ÿæ˜¯ç­”æ¡ˆä¸­è¦æ±‚çš„ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨é€’æ¨è§£å†³é—®é¢˜ã€‚&lt;strong&gt;åœ¨ç»„åˆè®¡æ•°ä¸­ï¼Œé€’æ¨ / DP æ— è®ºæ˜¯åœ¨åŒ–ç®€å¼å­è¿˜æ˜¯æ±‚å®¹æ–¥ / äºŒé¡¹å¼åæ¼”é‡Œå…·ä½“æŸä¸€é™åˆ¶ä¸‹çš„æ–¹æ¡ˆæ•°éƒ½æ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œåœ¨éœ€è¦ä¼˜åŒ–å¤æ‚åº¦æ—¶ï¼Œå¯ä»¥ä»é€’æ¨ / DPã€æ’ç­‰å¼ã€å‰ç¼€å’Œã€é¢„å¤„ç†ç­‰æ–¹æ³•å…¥æ‰‹è€ƒè™‘&lt;/strong&gt;&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, a, b, c;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; a &amp;gt;&amp;gt; b &amp;gt;&amp;gt; c;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1), fa(n + 1), fb(n + 1), fc(n + 1), pow2(n + 1);
    fac[0] = inv[0] = pow2[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        fac[i] = fac[i - 1] * i % mod;
        pow2[i] = pow2[i - 1] * 2 % mod;
    &amp;#125;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    for (int i = 0; i &amp;lt;= a; ++i)
        (fa[a] += C(a, i)) %= mod;
    for (int i = a + 1; i &amp;lt;= n; ++i)
        fa[i] = (2 * fa[i - 1] % mod + mod - C(i - 1, a)) % mod;
    for (int i = 0; i &amp;lt;= b; ++i)
        (fb[b] += C(b, i)) %= mod;
    for (int i = b + 1; i &amp;lt;= n; ++i)
        fb[i] = (2 * fb[i - 1] % mod + mod - C(i - 1, b)) % mod;
    for (int i = 0; i &amp;lt;= c; ++i)
        (fc[c] += C(c, i)) %= mod;
    for (int i = c + 1; i &amp;lt;= n; ++i)
        fc[i] = (2 * fc[i - 1] % mod + mod - C(i - 1, c)) % mod;
    auto res(0ll);
    for (int i = n, p = 1; ~i; --i, p = mod - p)
        (res += p * C(n, i) % mod * (i &amp;gt;= a ? fa[i] : pow2[i]) % mod * (i &amp;gt;= b ? fb[i] : pow2[i]) % mod * (i &amp;gt;= c ? fc[i] : pow2[i]) % mod) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="è®¡æ•°" />
        <updated>2025-04-07T06:57:14.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250120/</id>
        <title>å­¦ä¹ ç¬”è®°ï¼šAC è‡ªåŠ¨æœº</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250120/"/>
        <content type="html">&lt;p&gt;è€³æœºå£°éŸ³ç–‘ä¼¼æœ‰ç‚¹å°äº†ï¼Œç”¨å¿ƒæ—·ç¥æ€¡çš„è¯æ¥è¯´å¤§è‡´ä¼šæ˜¯ã€Œæ¯”æœè‡â†‘å—¡å—¡å£°è¿˜å°ã€ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;ï¼Ÿå§æ§½è€³æœºä¸Šå±…ç„¶å¯ä»¥è°ƒéŸ³é‡ &lt;img src=&#34;/em/oh.gif&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å‰ç½®çŸ¥è¯†&#34;&gt;å‰ç½®çŸ¥è¯†&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆå¯èƒ½éœ€è¦çŸ¥é“ä¸“æœ‰åè¯ã€Œè‡ªåŠ¨æœºã€çš„å«ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;å¤§è‡´å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œä¸€ä¸ª DAGï¼Œå…¶ä¸­ç‚¹è¡¨ç¤ºçŠ¶æ€ï¼Œè¾¹è¡¨ç¤ºè½¬ç§»ã€‚ç»™è¿›å»ä¸€ä¸ªå­—ç¬¦ä¸²ä¹‹ç±»ï¼Œå°±å¯ä»¥åœ¨ DAG ä¸Šæ¸¸èµ°ï¼Œæ ¹æ®æœ€åæ‰€å¤„ç»“ç‚¹ï¼Œå¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ç›¸å…³ç‰¹å¾ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå®šä¹‰è®©æˆ‘ä»¬æƒ³åˆ°äº† Trieã€‚äº‹å®ä¸Šï¼ŒTrie å°±æ˜¯ä¸€ç§ç›¸å½“åŸºç¡€çš„è‡ªåŠ¨æœºã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¤ä¹  KMP ç›¸å…³æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;å‡æƒ³ä¸€ä¸ªåœºæ™¯ï¼šä½ éœ€è¦æ±‚å¾— &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ‹¥æœ‰ä¸€å®šé¢˜ç›®ç»éªŒçš„ä½ ï¼Œä¼šä½¿ç”¨ KMP æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„ &lt;code&gt;next&lt;/code&gt; æ•°ç»„ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸Šè¿›è¡ŒåŒ¹é…ï¼Œå¤±é…æˆ–å®Œå…¨åŒ¹é…æ—¶å›åˆ° &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨è¯¥å¤„çš„ &lt;code&gt;next&lt;/code&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸Šçš„æŒ‡é’ˆå§‹ç»ˆå‘å³ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ä¸Šçš„æŒ‡é’ˆå¦‚æœå‘å³ï¼Œæ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä½ï¼›å¦‚æœå‘å·¦ï¼Œæœ€å·¦ç§»åˆ°å¼€å¤´ï¼Œå‡æ‘Šä¸‹æ¥å¤æ‚åº¦å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(|S| + |T|)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‡å¦‚åœºæ™¯å˜å¾—æ›´å¤æ‚ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt;ï¼Œä½ éœ€è¦æ±‚å‡ºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; è¿›è¡Œä¸€æ¬¡ KMPï¼Œå¤æ‚åº¦å°†ä¼šä¸Šå‡åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(m|S|)\)&lt;/span&gt;ï¼Œéš¾ä»¥æ‰¿å—ã€‚æœ‰æ²¡æœ‰ä¼˜åŒ–çš„æ–¹æ³•å‘¢ï¼Ÿ&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºçš„å»ºç«‹&#34;&gt;AC è‡ªåŠ¨æœºçš„å»ºç«‹&lt;/h2&gt;
&lt;p&gt;ç»“åˆä¸Šé¢çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¸‹æ„è¯†æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½å°† &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt; å»ºæˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; åœ¨å…¶ä¸Šè¿›è¡Œ KMP å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt; å…¨éƒ¨åŠ å…¥ Trieï¼Œç”±äº &lt;code&gt;next&lt;/code&gt; åªä¼šç”±æ›´æ·±çš„ç‚¹æŒ‡å‘æ›´æµ…çš„ç‚¹ï¼Œä¼¼ä¹ä»ç›´è§‰ä¸Šæ˜¯æœ‰è§„åˆ™çš„ã€‚ä½†éšä¹‹è€Œæ¥çš„æ˜¯ä¸€ä¸ªé—®é¢˜ï¼šç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;next&lt;/code&gt; ä¸ä¸€å®šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\text{root}\to u\)&lt;/span&gt; çš„é“¾ä¸Šï¼ˆç”±äº Trie çš„æ€§è´¨ï¼Œå¯çŸ¥æŒ‡å‘çš„ç‚¹æ˜¯å”¯ä¸€çš„ï¼‰ã€‚é‰´äºè¿™ä¸€ç‚¹ä¸åŒï¼Œæˆ‘ä»¬ç»“åˆå…¶ã€Œå¤±é…æŒ‡é’ˆã€çš„å®šä¹‰ï¼Œå°† &lt;code&gt;next&lt;/code&gt; åœ¨ Trie ä¸Šçš„åŒåˆ†å¼‚æ„ä½“å”¤ä¸º &lt;code&gt;fail&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒå¯Ÿ Trie ä¸Šè¯¥ &lt;code&gt;fail&lt;/code&gt; è¾¹çš„æ€§è´¨ã€‚ç°æ¬²æ±‚è§£ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; æŒ‡å‘çš„ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼Œç»“åˆ KMP ä¸­ &lt;code&gt;next&lt;/code&gt; çš„æ€§è´¨ï¼Œå‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„çˆ¶èŠ‚ç‚¹çš„ &lt;code&gt;fail&lt;/code&gt; è¾¹æŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„å€¼ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt; ä¸Šæœ‰è¾¹æƒç›¸åŒçš„è¾¹ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å°±æ˜¯è¯¥è¾¹æŒ‡å‘çš„ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œå‰å¾€ &lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt;ï¼Œé‡å¤ä»¥ä¸Šåˆ¤å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‚£ä¹ˆå°±å®Œæˆäº†å¤±é…çš„å¤„ç†ã€‚ç›¸åº”åœ°ï¼Œå®Œå…¨åŒ¹é…æ—¶çš„è·³è½¬åº”å¦‚ä½•å¤„ç†ï¼Ÿç›´æ¥å°† &lt;code&gt;fail&lt;/code&gt; çš„å„¿å­å…¨éƒ¨æ¥åˆ° &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸‹é¢å³å¯ã€‚å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å’Œ &lt;code&gt;fail&lt;/code&gt; å…·æœ‰åŒä¸€ä¸ªè¾¹æƒçš„è¾¹æ—¶ï¼Œä¿ç•™ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„è¿™æ¡è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt;ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; å¿…å®šæŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; çš„å¯¹åº”å„¿å­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤ç‚¹ç»“åˆï¼Œæˆ‘ä»¬å‘ç°ä»å®ç°ä¸Šï¼Œå¯ä»¥ç›´æ¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; æŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; çš„å¯¹åº”å„¿å­ï¼ˆé‚£ä¹ˆæ—¶é—´å¤æ‚åº¦æ˜¾è€Œæ˜“è§æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(26\sum |T|)\)&lt;/span&gt; çš„ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åŒ¹é…æ—¶ï¼Œå¯¹äºæ¯ä¸ªç‚¹å’Œå…¶è¿”å›åˆ°æ ¹çš„ &lt;code&gt;fail&lt;/code&gt; é“¾ï¼Œå…¨éƒ¨æ ‡è®°ã€‚åˆ™ä¸€ä¸ªæ¨¡å¼ä¸²åŒ¹é…çš„æ¬¡æ•°å³ä¸ºè¢«æ‰“æ ‡è®°çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥å‘ç° AC è‡ªåŠ¨æœºçš„æœ¬è´¨å°±æ˜¯æ·»åŠ äº† &lt;code&gt;fail&lt;/code&gt; è¾¹çš„ Trieã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;é‚£ä¹ˆæ ¹æ®ä¸Šè¿°è¦æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§æ·±åº¦é¡ºåºæ±‚å¾— &lt;code&gt;fail&lt;/code&gt;ï¼Œè€ƒè™‘ BFSã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å“¦å“¦å¥½ç¥å¥‡å¤æ´»ä¹‹åè®°å¾—å•¥æ˜¯ KMP ä½†å¿˜äº†å•¥æ˜¯ C++ äº†ã€‚ç”šè‡³èŠ±äº†ä¸€ç‚¹æ—¶é—´å­¦ä¹ æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Ÿï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¤§å®¶å†™ AC è‡ªåŠ¨æœº Trie æ ¹èŠ‚ç‚¹ä¸‹æ ‡ä¸€å®šè¦è®¾æˆ 0 å•Š &lt;img src=&#34;/em/ll.gif&#34; /&gt; è®¾æˆ 1 è¢«å„ç§ç»†èŠ‚å‘æƒ¨äº† &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, cnt[maxn], fail[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    &amp;#123;
        int p = 0;
        for (auto i : s) &amp;#123;
            p = T[p][i - &amp;#39;a&amp;#39;];
            for (int fa = p; fa; fa = fail[fa])
                ++cnt[fa];
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; cnt[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;p&gt;è‚‰çœ¼å¯è§è¯¥æŸ¥è¯¢æ–¹å¼æ˜¯æå…¶ä½æ•ˆçš„ï¼Œæ•…è€ƒè™‘ä¼˜åŒ–è·³ &lt;code&gt;fail&lt;/code&gt; æ‰“æ ‡è®°çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶è‡ªåŠ¨æœºç»“æ„ä¸å˜ï¼Œä¸å¦‚å°†è·³ &lt;code&gt;fail&lt;/code&gt; çš„æ­¥éª¤æ”¾åœ¨æœ€åç»Ÿä¸€è¿›è¡Œã€‚å®¹æ˜“åœ¨å‘ç° &lt;code&gt;fail&lt;/code&gt; æ ‘ä¸Šè¿›è¡Œæ‹“æ‰‘æ’åºè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, cnt[maxn], fail[maxn], deg[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    &amp;#123;
        int p = 0;
        for (auto i : s)
            p = T[p][i - &amp;#39;a&amp;#39;], ++cnt[p];
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= tot; ++i)
            if (!deg[i])
                q.push(i);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            cnt[fail[u]] += cnt[u];
            if (!--deg[fail[u]])
                q.push(fail[u]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; cnt[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«&#34;&gt;AC è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“å…¶æœ€å…¸å‹çš„ç‰¹å¾æ˜¯ &lt;strong&gt;å¤šæ¨¡å¼ä¸²&lt;/strong&gt;ã€&lt;strong&gt;é™æ€ / ç¦»çº¿&lt;/strong&gt;ã€‚å½“ç¢°åˆ°ç±»ä¼¼ç‰¹ç‚¹æ—¶ï¼Œå¤§æ¦‚ç‡å°±æ˜¯ AC è‡ªåŠ¨æœºã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œå¯ä»¥è®¾ç½®çš„éš¾ç‚¹æœ‰ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;å­—ç¬¦ä¸²éš¾ç‚¹ï¼Œå’Œå…¶ä»–å­—ç¬¦ä¸²é¢˜å¯è®¾ç½®çš„éš¾ç‚¹ç›¸åŒã€‚&lt;/li&gt;
&lt;li&gt;fail æ ‘ç»´æŠ¤ï¼Œå¯èƒ½ç»“åˆæ•°æ®ç»“æ„ã€æ‹“æ‰‘æ’åºã€æ ‘å½¢ DP ç­‰è€ƒå¯Ÿã€‚&lt;/li&gt;
&lt;li&gt;DP çš„è®¾è®¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡&#34;&gt;å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡&lt;/h2&gt;
&lt;h3 id=&#34;eg.-indie-album&#34;&gt;eg. Indie Album&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1207/G&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1207/G&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¢˜ç›®çš„ã€Œå¯æŒä¹…åŒ–ã€è¯•å›¾è¯¯å¯¼æˆ‘ä»¬ç”¨æ“ä½œä¸²å»ºç«‹è‡ªåŠ¨æœºï¼Œä½†è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¿è¯ç­”æ¡ˆå¯æ±‚æˆ‘ä»¬ä»ç„¶åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸Šå»ºç«‹ ACAMã€‚å®¹æ˜“å‘ç°æ“ä½œä¸²ä»¥ Trie å½¢å¼ç»™å‡ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éå† Trie æ—¶åŒæ—¶å®Œæˆæ¸¸èµ°ï¼Œé€šè¿‡å›æº¯å®Œæˆè¯¢é—®ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾å½“å‰ DFS ä¸­ï¼Œéå†åˆ° Trie æ ‘ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç‚¹å’Œè‡ªåŠ¨æœºä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çŠ¶æ€ï¼Œé‚£ä¹ˆå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç‚¹æ‰€å¯¹åº”çš„ä¸€ä¸ªè¯¢é—®ä¸² &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œç›¸å½“äºè¯¢é—®ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€æœ‰å¤šå°‘ä¸ªåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; å¼•å¯¼çš„ fail æ ‘å­æ ‘ä¸­ã€‚æˆ‘ä»¬æ±‚å‡º fail æ ‘çš„ dfnï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç®€å•ç»Ÿè®¡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 4e5 + 5;
std::vector&amp;lt;int&amp;gt; g[maxn], q[maxn];
int fail[maxn], T[maxn][26], tot, bit[maxn], to[maxn][26], cnt[maxn];
int ins(std::string s) &amp;#123;
    int p = 0;
    for (auto i : s) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int lowbit(int x) &amp;#123;
    return x &amp;amp; -x;
&amp;#125;
void add(int x, int v) &amp;#123;
    for (; x &amp;lt;= tot + 1; x += lowbit(x))
        bit[x] += v;
    return;
&amp;#125;
int ask(int x) &amp;#123;
    int res = 0;
    for (; x; x -= lowbit(x))
        res += bit[x];
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, now = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; id(n + 1);
    for (int i = 1, op; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            std::cin &amp;gt;&amp;gt; t;
            if (!to[0][t - &amp;#39;a&amp;#39;])
                to[0][t - &amp;#39;a&amp;#39;] = ++now;
            ++cnt[to[0][t - &amp;#39;a&amp;#39;]], id[i] = to[0][t - &amp;#39;a&amp;#39;];
        &amp;#125;
        else &amp;#123;
            int j; 
            std::cin &amp;gt;&amp;gt; j &amp;gt;&amp;gt; t;
            if (!to[id[j]][t - &amp;#39;a&amp;#39;])
                to[id[j]][t - &amp;#39;a&amp;#39;] = ++now;
            ++cnt[to[id[j]][t - &amp;#39;a&amp;#39;]], id[i] = to[id[j]][t - &amp;#39;a&amp;#39;];
        &amp;#125;
    &amp;#125;
    int m;
    std::cin &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; tail(m + 1), res(m + 1);
    for (int i = 1, x; i &amp;lt;= m; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; t, tail[i] = ins(t);
        q[id[x]].push_back(i);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]), g[0].push_back(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v), g[fail[v]].push_back(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; dfn(tot + 1), rfn(tot + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now;
        // printf(&amp;quot;%d &amp;quot;, x);
        for (auto i : g[x])
            DFS(i);
        rfn[x] = now;
        return;
    &amp;#125;;
    DFS(0);
    std::function&amp;lt;void(int, int)&amp;gt; DFS1 = [&amp;amp;](int x, int u) &amp;#123;
        add(dfn[u], 1);
        for (auto i : q[x])
            res[i] += ask(rfn[tail[i]]) - ask(dfn[tail[i]] - 1);
        for (int i = 0; i &amp;lt; 26; ++i)
            if (to[x][i])
                DFS1(to[x][i], T[u][i]);
        add(dfn[u], -1);
        return;
    &amp;#125;;
    DFS1(0, 0);
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;fail-æ ‘çš„ç»´æŠ¤&#34;&gt;fail æ ‘çš„ç»´æŠ¤&lt;/h2&gt;
&lt;h3 id=&#34;eg.-divljak&#34;&gt;eg. Divljak&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5840&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5840&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;æ³•ä¸€æŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿&#34;&gt;æ³•ä¸€ï¼šæŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿&lt;/h4&gt;
&lt;p&gt;é—®é¢˜ç›¸å½“äºå°†æ¨¡å¼ä¸² &lt;span class=&#34;math inline&#34;&gt;\(T:\{P\}\)&lt;/span&gt; åŠ¨æ€åŒ–ï¼Œä½†æˆ‘ä»¬ä»å¯ä»¥æ— è„‘ç¦»çº¿ä¸‹æ¥è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åŸæœ¬çš„ç­”æ¡ˆè®¡ç®—è¿‡ç¨‹ï¼Œå³åœ¨ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€åŠå…¶ fail é“¾ä¸Šæ‰“æ ‡è®°ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ç¦»çº¿å¹¶åŒºåˆ†æ ‡è®°çš„æ¥æºï¼ˆå¹¶ä¸”æ ‡è®°ç±»å‹ä¸ºå¸ƒå°”å€¼ï¼‰ï¼Œä¸‹æ„è¯†æƒ³åˆ°ä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹æ¯ä¸ªçŠ¶æ€å»ºç«‹åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œæœ€åæ‹“æ‰‘æ’åºæ—¶ä½¿ç”¨çº¿æ®µæ ‘åˆå¹¶å¤„ç†ä¿¡æ¯ã€‚å®¹æ˜“è¯æ˜æ—¶é—´å¤æ‚åº¦ç›¸è¾ƒåŸæ¥å¤šäº†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ç†è®ºå¯è¡Œï¼Œå¼€å§‹å®è·µ&lt;/del&gt; å‡ºé¢˜äººä¼¼ä¹ä¸æ˜¯å¾ˆå–œæ¬¢çº¿æ®µæ ‘é€‰æ‰‹æ‰€ä»¥å†³å®šå‰¥å¤ºä½ çš„ Memory Limitã€‚æƒ³è¦ç”¨è¿™ç§åšæ³•é€šè¿‡æœ¬é¢˜å¯è§ &lt;a href=&#34;https://www.luogu.com.cn/article/jaxk3sno&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/article/jaxk3sno&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ³•äºŒè½¬è€Œå¤„ç†é™æ€é—®é¢˜&#34;&gt;æ³•äºŒï¼šè½¬è€Œå¤„ç†é™æ€é—®é¢˜&lt;/h4&gt;
&lt;p&gt;æ³¨æ„åˆ°é¢˜ç›®ä¸­çš„é™æ€çš„ &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt; æ¯”èµ· &lt;span class=&#34;math inline&#34;&gt;\(T:\{P\}\)&lt;/span&gt; æ›´é€‚åˆç”¨æ¥åšæ¨¡å¼ä¸²ï¼Œæˆ‘ä»¬åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt; ä¸Šæ„å»º AC è‡ªåŠ¨æœºï¼Œè€ƒè™‘åœ¨çº¿è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¯æ¬¡ &lt;code&gt;1&lt;/code&gt; æ“ä½œæ—¶ï¼Œæ›´æ–°æ¨¡å¼ä¸²ä¿¡æ¯ã€‚å¯¹äºé€”å¾„çš„æ‰€æœ‰çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(\{u\}\)&lt;/span&gt;ï¼Œè€ƒè™‘æ›´æ–°å…¶æ‰€åœ¨ fail é“¾ä¸Šçš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦ä¿®æ”¹æ•´æ¡ fail é“¾ä¸Šçš„ä¿¡æ¯ï¼Œè¯¢é—®åˆ™æ˜¯è¯¢é—®å•ç‚¹ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨æ ‘ä¸Šå·®åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ here comes a problemï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸€æ•´ä¸ªä¸²åªèƒ½åœ¨æ•´ä¸ªæ ‘ä¸Šæ¯ä¸ªç‚¹ä¸Šæ›´æ–°ä¸€æ¬¡ã€‚æ€ä¹ˆæ¶ˆå»ç›¸åŒçš„å½±å“å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå®ç°ä¸Šæˆ‘ä»¬å°†ç»è¿‡çš„ç‚¹æŒ‰ fail æ ‘ä¸Š dfn æ’åºï¼Œå¹¶ä¸”å¯¹äºåºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ç‚¹åœ¨å…¶ LCA ä¸Šå‡å»ä¸€æ¬¡æ ‡è®°ã€‚ä¸ºä»€ä¹ˆè¿™æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿå‚è€ƒè™šæ ‘ï¼Œæˆ‘ä»¬åªéœ€è¦è®©åºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ä¸ªç‚¹å°½é‡è¿‘å°±å¯ä»¥ä¿è¯é‡å¤çš„è¢«åˆ é™¤å®Œæ¯•ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e6 + 5;
int tot, bit[maxn], T[maxn][26], fail[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int lowbit(int x) &amp;#123;
    return x &amp;amp; -x;
&amp;#125;
void add(int x, int v) &amp;#123;
    // printf(&amp;quot;add (%d, %d)\n&amp;quot;, x, v);
    for (; x &amp;lt;= tot + 1; x += lowbit(x))
        bit[x] += v;
    return;
&amp;#125;
int ask(int x) &amp;#123;
    int res = 0, to = x;
    for (; x; x -= lowbit(x))
        res += bit[x];
    // printf(&amp;quot;ask(%d) = %d\n&amp;quot;, to, res);
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, q;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t, tail[i] = ins(t);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(tot + 2);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
        for (int i = 1; i &amp;lt;= tot; ++i)
            g[fail[i] + 1].push_back(i + 1);
    &amp;#125;
    std::vector&amp;lt;std::array&amp;lt;int, 22&amp;gt; &amp;gt; f(tot + 2);
    std::vector&amp;lt;int&amp;gt; dep(tot + 2), dfn(tot + 2), siz(tot + 2);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        siz[x] = 1, dfn[x] = ++now;
        // printf(&amp;quot;%d\n&amp;quot;, x);
        for (auto i : g[x]) &amp;#123;
            dep[i] = dep[x] + 1;
            f[i][0] = x;
            for (int j = 1; j &amp;lt;= 21; ++j)
                f[i][j] = f[f[i][j - 1]][j - 1];
            DFS(i), siz[x] += siz[i];
        &amp;#125;
        return;
    &amp;#125;;
    dep[1] = 1, DFS(1);
    auto askLCA = [&amp;amp;](int x, int y) &amp;#123;
        if (x == y)
            return x;
        if (dep[x] &amp;lt; dep[y])
            std::swap(x, y);
        for (int i = 21; ~i; --i)
            if (dep[f[x][i]] &amp;gt;= dep[y])
                x = f[x][i];
        if (x == y)
            return x;
        for (int i = 21; ~i; --i)
            if (f[x][i] != f[y][i])
                x = f[x][i], y = f[y][i];
        return f[x][0];
    &amp;#125;;
    std::cin &amp;gt;&amp;gt; q;
    for (; q--; ) &amp;#123;
        int op;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            std::string s;
            std::cin &amp;gt;&amp;gt; s;
            int p = 0, len = (int)s.length();
            std::vector&amp;lt;int&amp;gt; id(len + 1);
            for (int i = 1; i &amp;lt;= len; ++i)
                p = T[p][s[i - 1] - &amp;#39;a&amp;#39;], id[i] = p + 1;
            std::sort(id.begin() + 1, id.end(), [&amp;amp;](int x, int y) &amp;#123; return dfn[x] &amp;lt; dfn[y]; &amp;#125;);
            // for (int i = 1; i &amp;lt;= len; ++i)
            //     printf(&amp;quot;%d &amp;quot;, id[i]);
            // puts(&amp;quot;&amp;quot;);
            for (int i = 1; i &amp;lt;= len; ++i) &amp;#123;
                // printf(&amp;quot;%d %d %d\n&amp;quot;, i, id[i], dfn[id[i]]);
                // assert(0);
                add(dfn[id[i]], 1);
                if (i != 1)
                    add(dfn[askLCA(id[i], id[i - 1])], -1);
            &amp;#125;
        &amp;#125;
        else &amp;#123;
            int x;
            std::cin &amp;gt;&amp;gt; x;
            x = tail[x] + 1;
            std::cout &amp;lt;&amp;lt; ask(dfn[x] + siz[x] - 1) - ask(dfn[x] - 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºä¸Šçš„-dp&#34;&gt;AC è‡ªåŠ¨æœºä¸Šçš„ DP&lt;/h2&gt;
&lt;p&gt;é‰´äº AC è‡ªåŠ¨æœºçš„ä¼˜ç§€ç»“æ„ä¸æ€§è´¨ï¼Œå¹¶ä¸ç»å¸¸ä½œä¸ºå­—ç¬¦ä¸²åŒ¹é…å·¥å…·å‡ºç°ï¼Œå…¶ä¸€ä¸ªåº”ç”¨æ˜¯ä½œä¸º DP çš„è½½ä½“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;eg1.-l-è¯­è¨€&#34;&gt;eg1. L è¯­è¨€&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P2292&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P2292&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æƒ³åˆ°è¦åœ¨è‡ªåŠ¨æœºä¸ŠåŒ¹é…ï¼Œä½†æ­¤æ—¶ &lt;code&gt;fail&lt;/code&gt; ä½œä¸ºã€Œæ–­å¥ã€çš„å”¯ä¸€æ‰‹æ®µï¼ˆæ–­å¥çš„ä½ç½®åœ¨é“¾ä¸Šå½“å‰ç‚¹æ·±åº¦ - &lt;code&gt;fail&lt;/code&gt; æ·±åº¦å¤„ï¼‰ï¼Œä¸å†ä»…å½“å¤±é…æ—¶æ‰èƒ½ç»è¿‡ã€‚æˆ‘ä»¬è€ƒè™‘æœ´ç´ çš„ DPï¼šåœ¨ç»è¿‡çš„æ¯ä¸ªçŠ¶æ€è€ƒè™‘æ–­å¥ï¼Œé‚£ä¹ˆè¿™è¦æ±‚æ–­å¥å¤„æ˜¯ä¸€ä¸ªå•è¯çš„ç»“å°¾ï¼Œé‚£ä¹ˆæ­¤æ—¶ &lt;code&gt;fail&lt;/code&gt; æœ€é•¿åŒ¹é…é•¿åº¦å³å¯è¢«æ›´æ–°ã€‚æœ€åéå†æ‰€æœ‰å•è¯çš„æœ«ç»“ç‚¹ï¼Œå–æœ€å¤§ç­”æ¡ˆã€‚è¿™é‡Œçš„ &lt;code&gt;fail&lt;/code&gt; å…¶å®æ˜¯ &lt;code&gt;fail&lt;/code&gt; é“¾ä¸Šä»»æ„ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¤æ‚åº¦ã€‚å®¹æ˜“å‘ç°å¯¹äºæ¯ä¸€ä¸ªç‚¹æˆ‘ä»¬è·³äº†å…¶æ•´æ¡ fail é“¾ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±æ˜¯æœ€åŠ£ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; çš„ã€‚è€ƒè™‘ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹è‡³ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¢˜ç›®é‡Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¡ä»¶è¿˜æ²¡æœ‰ç”¨åˆ°ï¼šå•ä¸ªå•è¯é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\le 20\)&lt;/span&gt;ï¼Œè¿™è®©æˆ‘ä»¬æƒ³åˆ°çŠ¶æ€å‹ç¼©ã€‚å¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼Œè®°å½•å…¶æ–­å‡ºæ¥å•è¯çš„å¯èƒ½é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ DAG ä¸Šæ¸¸èµ°çš„æ—¶å€™è®°å½•ç›®å‰å¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ï¼Œå¦‚æœå…¶å’Œå½“å‰å¯æ–­å‡ºæ¥çš„é•¿åº¦ä¹‹äº¤ä¸ä¸ºç©ºï¼Œå°±å¯ä»¥å°†æ­¤å¤„åŠ å…¥ã€Œå¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ã€å¹¶æ›´æ–°ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, fail[maxn], len[maxn], dep[maxn], tag[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot, dep[tot] = dep[p] + 1;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    ++tag[p];
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            len[u] = len[fail[u]];
            if (tag[u])
                len[u] |= (1 &amp;lt;&amp;lt; dep[u]);
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    for (; m--; ) &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s;
        int p = 0, q = 1, res = 0;
        for (int i = 0; i &amp;lt; (int)s.length(); ++i) &amp;#123;
            p = T[p][s[i] - &amp;#39;a&amp;#39;], q &amp;lt;&amp;lt;= 1;
            if (len[p] &amp;amp; q)
                q |= 1, res = i + 1;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg2.-popcount-words&#34;&gt;eg2. Popcount Words&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/gym/103409/problem/H&#34; class=&#34;uri&#34;&gt;https://codeforces.com/gym/103409/problem/H&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;å’‹ä¸Šå¼ºåº¦äº†å•Šã€‚&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;å…ˆæŠŠæ•´ä¸ªåºåˆ—å†™å‡ºæ¥ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(w=\texttt{01101001100101}\cdots\)&lt;/span&gt;ï¼Œå°è¯•è¿›ä¸€æ­¥æ¢ç©¶å½¢å¼åŒ–çš„è§„å¾‹ï¼Œå¯ä»¥å¾—åˆ°ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(w_{[0, 2^n), 0}=w_{[0, 2^{n-1}),0}+w_{[0, 2^n), 1}\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(w_{[l, r], 0/1}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; å†…ï¼ŒåŸä¸² / å–åçš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºä¸ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å¤´çš„æ•´æ®µï¼Œå¯ä»¥ä»ä¸Šè¿°è§„åˆ™è½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å¤´çš„æ•´æ®µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¥ç€ä¸éš¾æƒ³åˆ°ä¸€ç§ç±»ä¼¼çº¿æ®µæ ‘çš„æ–¹å¼ï¼Œå°†å¾…æ±‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(w_{[l, r], 0}\)&lt;/span&gt; åˆ†åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(\log V)\)&lt;/span&gt; ä¸ªæ•´æ®µä¸Šï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å°±å¯ä»¥è¢« &lt;span class=&#34;math inline&#34;&gt;\(O(n\log V)\)&lt;/span&gt; ä¸ªæ•´æ®µï¼ˆä¹Ÿæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\log V\)&lt;/span&gt; ä¸ªæœ¬è´¨ä¸åŒæ•´æ®µï¼‰æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹ &lt;span class=&#34;math inline&#34;&gt;\({p_m}\)&lt;/span&gt; å»ºç«‹ AC è‡ªåŠ¨æœºï¼Œéœ€è¦çŸ¥é“è¿™ &lt;span class=&#34;math inline&#34;&gt;\(\log V\)&lt;/span&gt; ä¸ªæ•´æ®µåœ¨æ¯ä¸ªç‚¹ä¸Šçš„å‡ºç°æ¬¡æ•°ã€‚å¯¹äºè‡ªåŠ¨æœºä¸Šä»»æ„çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(to_{u, n, 0/1}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(w_{[0, 2^n), 0/1}\)&lt;/span&gt; ååˆ°è¾¾çš„ç‚¹ï¼Œåˆ™å¯å€å¢ï¼ˆå˜¶ï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯åº”è¯¥åè¿‡æ¥å«åˆ†æ²»å•Šï¼‰ç®€å•è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(to\)&lt;/span&gt; æ¥è¿›è¡Œå¿«é€Ÿæ¸¸èµ°äº†ã€‚é¡ºä¾¿æ‰“ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(cnt\)&lt;/span&gt; è®°å½•ä¸€ä¸‹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä½œä¸ºä¸åŒæ•´æ®µçš„å¼€å¤´è¢«ç»è¿‡çš„æ¬¡æ•°ã€‚ç„¶ååšä¸€ä¸ª DPï¼Œç±»ä¼¼äºçº¿æ®µæ ‘ä¸Š &lt;code&gt;pushdown&lt;/code&gt; çš„æ“ä½œæŠŠæ‰€æœ‰æ•´æ®µä¸‹æ”¾åˆ°å•ç‚¹ä¸Šçš„å•ä¸ªå­—ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€è¯´ä¸€ç”¨ DP æ¥å¤„ç†è¿™ä¸ªä¸œè¥¿è¿˜æŒºéš¾æƒ³çš„ã€‚å¯èƒ½ä¹Ÿæ˜¯åŸºäºå‰é¢çš„å€å¢å§ã€‚æœ€åæ‹“æ‰‘æ’åºå°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å¤§å®¶æ•°ç»„ä¸€å®šè¦ç”¨ C-style array å•Šï¼Œ&lt;code&gt;std::vector&amp;lt;&amp;gt;&lt;/code&gt; è®¡ç®—çš„æ˜¯ç”³è¯·ç©ºé—´åŒ… MLE çš„ &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¤§å®¶å¤§æ•°ç»„ä¸€å®šè¦å†…å­˜è¿ç»­è®¿é—®ä¼˜åŒ–å•Šï¼ŒTLE &lt;span class=&#34;math inline&#34;&gt;\(\to\)&lt;/span&gt; 100ms æ³ªç›®äº† &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e5 + 5;
long long sum[maxn], f[2][30][maxn];
int cnt[2][30][maxn], to[2][30][maxn];
int T[maxn][2], tot, fail[maxn], deg[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;0&amp;#39;])
            T[p][i - &amp;#39;0&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;0&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
void ask(std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;amp;s, int ql, int qr, int l = 0, int r = (1 &amp;lt;&amp;lt; 30) - 1, int len = 30, int v = 0) &amp;#123;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr) &amp;#123;
        s.emplace_back(len, v);
        return;
    &amp;#125;
    int mid = l + (r - l) / 2;
    if (ql &amp;lt;= mid)
        ask(s, ql, qr, l, mid, len - 1, v);
    if (qr &amp;gt; mid)
        ask(s, ql, qr, mid + 1, r, len - 1, v ^ 1);
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; s;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int l, r;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        ask(s, l, r);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tail(m + 1);
    for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t;
        tail[i] = ins(t);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 2; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 2; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    for (int i = 0; i &amp;lt;= tot; ++i)
        to[0][0][i] = T[i][0], to[1][0][i] = T[i][1];
    for (int j = 1; j &amp;lt; 30; ++j)
        for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
            to[0][j][i] = to[1][j - 1][to[0][j - 1][i]];
            to[1][j][i] = to[0][j - 1][to[1][j - 1][i]];
        &amp;#125;
    &amp;#123;
        int p = 0;
        for (auto [n, i] : s) &amp;#123;
            // printf(&amp;quot;# %d %d\n&amp;quot;, n, i);
            ++cnt[i][n][p], p = to[i][n][p];
        &amp;#125;
    &amp;#125;
    for (int j = 29; ~j; --j)
        for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
            if (j != 29) &amp;#123;
                f[0][j][i] += f[0][j + 1][i];
                f[1][j][i] += f[1][j + 1][i];
                f[0][j][to[1][j][i]] += f[1][j + 1][i];
                f[1][j][to[0][j][i]] += f[0][j + 1][i];
            &amp;#125;
            f[1][j][i] += cnt[1][j][i];
            f[0][j][i] += cnt[0][j][i];
        &amp;#125;
    for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
        sum[T[i][0]] += f[0][0][i], sum[T[i][1]] += f[1][0][i];
        // printf(&amp;quot;%d %d\n&amp;quot;, f[i][0][0], f[i][0][1]);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt;= tot; ++i)
            if (!deg[i])
                q.push(i);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            sum[fail[u]] += sum[u];
            if (!--deg[fail[u]])
                q.push(fail[u]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; sum[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg3.-legen&#34;&gt;eg3. Legenâ€¦&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/696/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/696/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…ˆåœ¨ fail æ ‘ä¸ŠæŠŠæ¯ä¸ªçŠ¶æ€çš„å®é™…ä»·å€¼è®¡ç®—å‡ºæ¥ã€‚æˆ‘ä»¬å‘ç°åŒ¹é…ä¸²æ˜¯æœªçŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦ä¸»åŠ¨å†³å®šæ¸¸èµ°è·¯å¾„ã€‚æ³¨æ„åˆ° &lt;span class=&#34;math inline&#34;&gt;\(l=10^{14}\)&lt;/span&gt;ï¼Œè€ƒè™‘çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{u, i}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çŠ¶æ€æ—¶å·²ç»èµ°äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ­¥ï¼Œå¯ä»¥å¾—åˆ°çš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{v,i+1}=f_{u,i}+s_v.
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ˜¯è‡ªåŠ¨æœºä¸Š &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ä»»æ„å‡ºè¾¹ã€‚å›¾çš„å¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(200\)&lt;/span&gt;ï¼Œå¯ä»¥æ”¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(+\max\)&lt;/span&gt; çŸ©é˜µé‡ŒåŠ é€Ÿè½¬ç§»ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
const long long inf = 1e18;
int fail[maxn], T[maxn][26], tot;
int ins(std::string s) &amp;#123;
    int p = 0;
    for (auto i : s) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
struct matrix &amp;#123;
    int n, m;
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; a;
    matrix(int n1, int m1, long long v = -inf, bool op = 0): n(n1), m(m1), a(n + 1, std::vector&amp;lt;long long&amp;gt; (m + 1, v)) &amp;#123;
        if (op)
            for (int i = 0; i &amp;lt;= n; ++i)
                a[i][i] = 0;
        return;
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; &amp;amp;operator[] (int i) &amp;#123;
        return a[i];
    &amp;#125;
    matrix operator* (matrix &amp;amp;q) const &amp;#123;
        matrix res(n, q.m);
        for (int k = 0; k &amp;lt;= m; ++k)
            for (int i = 0; i &amp;lt;= n; ++i)
                for (int j = 0; j &amp;lt;= q.m; ++j)
                    res[i][j] = std::max(res[i][j], a[i][k] + q[k][j]);
        return res;
    &amp;#125;
    matrix&amp;amp; operator*= (matrix q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
    matrix operator^ (long long q) &amp;#123;
        matrix res(n, n, -inf, 1), x(*this);
        for (; q; q &amp;gt;&amp;gt;= 1, x *= x)
            if (q &amp;amp; 1)
                res *= x;
        return res;
    &amp;#125;
&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    long long m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; t[i];
        tail[i] = ins(t[i]);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; s(tot + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        s[tail[i]] += a[i];
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]); 
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], s[v] += s[fail[v]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    matrix f(0, tot), op(tot, tot);
    f[0][0] = 0;
    for (int i = 0; i &amp;lt;= tot; ++i)
        for (int j = 0; j &amp;lt; 26; ++j)
            op[i][T[i][j]] = s[T[i][j]];
    f *= (op * m);
    std::cout &amp;lt;&amp;lt; *std::max_element(f[0].begin(), f[0].end()) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg4.-you-are-given-some-strings&#34;&gt;eg4. You Are Given Some Stringsâ€¦&lt;/h3&gt;
&lt;p&gt;goto &lt;a href=&#34;/20250121/#%E4%B8%80%E4%B8%AA%E6%A8%A1%E6%9D%BFcf1202e-you-are-given-some-strings...&#34;&gt;link&lt;/a&gt;.&lt;/p&gt;
</content>
        <category term="DP" />
        <category term="å­—ç¬¦ä¸²" />
        <category term="AC è‡ªåŠ¨æœº" />
        <updated>2025-01-20T03:21:15.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20241104/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20241104/"/>
        <content type="html">&lt;p&gt;å“­ã„ãŸé–ƒå…‰ãŒç›®ã«åˆºã•ã‚‹ / ãŠåˆ¥ã‹ã‚Œã®é˜ãŒé³´ã‚‹ / ç¥ãŒæˆã—ãŸæ­´å²ã® / çµã¶ç­”ãˆã¯ç ‚ã®å‘³ãŒã™ã‚‹&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-ç¾å‘³ã—ã„ç¾å‘³ã—ã„ãƒãƒ³ãƒãƒ¼ã‚°&#34;&gt;A. ç¾å‘³ã—ã„ç¾å‘³ã—ã„ãƒãƒ³ãƒãƒ¼ã‚°&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://vjudge.net/contest/669299#problem/A&#34; class=&#34;uri&#34;&gt;https://vjudge.net/contest/669299#problem/A&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªå¾ˆç¥å¥‡çš„éšæœºåŒ–åšæ³•ï¼šæˆ‘ä»¬ä»å‰å¾€åä¸²ç­¾å­ï¼Œæœ€å¼€å§‹ç­¾å­æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œå¦‚æœå½“å‰ä»»ä½•ä¸€ä¸ªç­¾å­éƒ½æ²¡åŠæ³•å†ä¸²è¿™ä¸€ä¸ªå°±æ–°å¢ç­¾å­ã€‚å¦‚æœæ²¡æœ‰ç­¾å­å¯ä»¥ç”¨äº†ï¼Œå°±è¯´æ˜è¿™å—è‚‰ä¸åˆæ³•ï¼ŒæŒªåˆ°å‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å—ä¸­çš„éšæœºä½ç½®ä½¿å…¶ä¼˜å…ˆè¢«é€‰æ‹©ã€‚&lt;/p&gt;
&lt;p&gt;ä½ ä¼šå‘ç°è¿™ä¸ªåšæ³•è·‘å¾—å¾ˆå¿«ï¼Œspdarkle è¯´å› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(K\)&lt;/span&gt; å¾ˆå°è¿˜ä¿è¯æœ‰è§£ï¼Œæ‰€ä»¥æœŸæœ›æ¬¡æ•°æ˜¯éå¸¸å¯¹çš„ã€‚æˆ‘å¤ªèœäº†ä»–ä¹Ÿæ²¡ç»†è¯´æ‰€ä»¥å¼€æ‘†ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºç¥ç§˜åŸå› ï¼Œæˆ‘çš„ &lt;code&gt;std::mt19937::operator()&lt;/code&gt; å¦‚æœå¤–è¾¹ä¸å¥—ä¸€å±‚ abs å°±ä¼šèµ·é£ &lt;img src=&#34;/em/yun.gif&#34; alt=&#34;æ™•&#34; /&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    struct _ &amp;#123; int l, r, u, d; &amp;#125;;
    std::vector&amp;lt;_&amp;gt; a(n + 1), b(k + 1);
    std::mt19937 rand(time(nullptr));
    auto random = [&amp;amp;](int l, int r) &amp;#123;
        return l + std::abs((int)rand()) % (r - l + 1);
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i].l &amp;gt;&amp;gt; a[i].u &amp;gt;&amp;gt; a[i].r &amp;gt;&amp;gt; a[i].d;
    for (;;) &amp;#123;
        std::copy(a.begin() + 1, a.begin() + k + 1, b.begin() + 1);
        for (int i = k + 1; i &amp;lt;= n; ++i) &amp;#123;
            for (int j = 1; j &amp;lt;= k; ++j) &amp;#123;
                if (std::min(b[j].r, a[i].r) &amp;gt;= std::max(b[j].l, a[i].l) &amp;amp;&amp;amp; std::min(b[j].d, a[i].d) &amp;gt;= std::max(b[j].u, a[i].u)) &amp;#123;
                    b[j].l = std::max(b[j].l, a[i].l);
                    b[j].r = std::min(b[j].r, a[i].r);
                    b[j].u = std::max(b[j].u, a[i].u);
                    b[j].d = std::min(b[j].d, a[i].d);
                    goto issol;
                &amp;#125;
            &amp;#125;
            std::swap(a[i], a[random(1, i)]);
            goto nosol;
        issol: ;
        &amp;#125;
        for (int i = 1; i &amp;lt;= k; ++i)
            std::cout &amp;lt;&amp;lt; b[i].l &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; b[i].u &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        break;
    nosol: ;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-shik-and-travel&#34;&gt;B. Shik and Travel&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://vjudge.net/contest/669299#problem/B&#34; class=&#34;uri&#34;&gt;https://vjudge.net/contest/669299#problem/B&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ€å°åŒ–æœ€å¤§ï¼Œæ˜¾ç„¶éœ€è¦äºŒåˆ†ç­”æ¡ˆï¼Œcheck æ‰“ä¸ª DPã€‚å…·ä½“æ€ä¹ˆ DP å‘¢ï¼Ÿé¦–å…ˆè€ƒè™‘æš´åŠ›ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{u, a, b}\)&lt;/span&gt; è¡¨ç¤ºåœ¨å½“å‰ &lt;span class=&#34;math inline&#34;&gt;\(mid\)&lt;/span&gt; çš„é™åˆ¶ä¸‹ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å‡ºå‘åˆ°ç¬¬ä¸€ä¸ªå¶å­è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œæœ€åä¸€ä¸ªè·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; çš„å¯è¡Œæ€§ã€‚é‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,a,b} = (f_{l,a,i}\land f_{r,j,b})\lor (f_{r,a,i}\land f_{l,j,b})\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…ˆä¸è¯´è½¬ç§»ï¼ŒçŠ¶æ€æ•°å·²ç»éš¾ä»¥æ¥å—ã€‚æ‰€ä»¥æˆ‘ä»¬ä»çŠ¶æ€æ•°å…¥æ‰‹ï¼Œæ˜¾ç„¶å¦‚æœå­˜åœ¨ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;\le a\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b&amp;#39;\le b\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\((a&amp;#39;,b&amp;#39;)\)&lt;/span&gt; å°±æ˜¯æ— ç”¨çŠ¶æ€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æŠŠæ‰€æœ‰æœ‰ç”¨çš„ &lt;span class=&#34;math inline&#34;&gt;\((a, b)\)&lt;/span&gt; æŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä»å°åˆ°å¤§æ’åºï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; åº”è¯¥æ˜¯å•è°ƒé€’å‡çš„ï¼›è€ƒè™‘è¿™ä¸ªæŠ½è±¡çš„è¿‡ç¨‹ï¼Œç›¸å½“äºä»å¤´åˆ°å°¾éå†ä¸€ä¸²çŠ¶æ€ï¼Œåœ¨è·¯ä¸Šç¢°åˆ°çš„æ‰€æœ‰è¾ƒå¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; éƒ½ä¼šè¢«å½“åœºä¸¢å¼ƒã€‚&lt;/p&gt;
&lt;p&gt;æ„Ÿæ€§æ€è€ƒå¯ä»¥å‘ç°&lt;mark&gt;å½“æˆ‘ä»¬è¯•å›¾è®© &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; æœ€å°çš„æ—¶å€™ï¼Œè¿™ä¸ªçŠ¶æ€æœ€æœ‰ç”¨ï¼ˆå³æœ€ä¸å¯èƒ½è¢«ä¸¢å¼ƒï¼‰&lt;/mark&gt;ã€‚å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f_{l,a,i}\)&lt;/span&gt;ï¼Œæˆ‘ä»¬æ‰¾åˆ°èƒ½å¤Ÿè½¬ç§»çš„ &lt;span class=&#34;math inline&#34;&gt;\(f_{r,j,b_{\min}}\)&lt;/span&gt; æ¥è½¬ç§»ã€‚æ­£ç¡®æ€§å¾ˆå¥½è¯æ˜ï¼Œæˆ‘ä»¬çš„ check åªè¦æ±‚åœ¨æ ¹èŠ‚ç‚¹ä¸Šå­˜åœ¨ä»»æ„åˆæ³•çŠ¶æ€ï¼Œé‚£åªéœ€è¦è®©æœ€ä¸å¯èƒ½è¢«ä¸¢å¼ƒçš„ä¸è¢«ä¸¢å¼ƒå³å¯ï¼Œæ›´å¯èƒ½è¢«ä¸¢å¼ƒçš„çŠ¶æ€æ˜¯å¦è¢«ä¸¢å¼ƒå°±ä¸ä¼šäº§ç”Ÿå½±å“äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä¼˜åŒ–åçš„çŠ¶æ€æ•°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸Šåªä¼šå¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(\min(|a_l|,|b_r|)+\min(|a_r|,|b_l|)\)&lt;/span&gt;ï¼Œå³ä¸¤ä¸ªå„¿å­ä¸Šçš„çŠ¶æ€æ•°è¾ƒå°è€…ï¼Œå‚è€ƒ DSU on treeï¼Œæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log)\)&lt;/span&gt; çš„ã€‚åŠ ä¸Šå¯¹çŠ¶æ€æ’åºçš„æ•°æ®ç»“æ„ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2 n\log V)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    for (int i = 2, x, w; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; w;
        g[x].emplace_back(i, w);
    &amp;#125;
    long long res = -1;
    for (long long l = 0, r = inf, mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        if ([&amp;amp;](void) -&amp;gt; bool &amp;#123;
            std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;long long, long&amp;gt; &amp;gt; &amp;gt; f(n + 1);
            std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
                if (g[x].empty()) &amp;#123;
                    f[x].emplace_back(0, 0);
                    return;
                &amp;#125;
                long long lim = mid;
                for (auto [i, w] : g[x])
                    DFS(i), lim -= w;
                std::vector&amp;lt;std::pair&amp;lt;long long, long long&amp;gt; &amp;gt; t;
                for (int i = 0; i &amp;lt; 2; ++i) &amp;#123;
                    int j = 0;
                    auto l = g[x][0], r = g[x][1];
                    for (auto [a, b] : f[l.first]) &amp;#123;
                        for (; j + 1 &amp;lt; (int)f[r.first].size() &amp;amp;&amp;amp; f[r.first][j + 1].first + b &amp;lt;= lim; ++j);
                        if (j &amp;lt; (int)f[r.first].size() &amp;amp;&amp;amp; f[r.first][j].first + b &amp;lt;= lim)
                            t.emplace_back(a + l.second, f[r.first][j].second + r.second);
                    &amp;#125;
                    std::swap(g[x][0], g[x][1]);
                &amp;#125;
                std::sort(t.begin(), t.end());
                for (auto [a, b] : t)
                    if (f[x].empty() || f[x].back().second &amp;gt; b)
                        f[x].emplace_back(a, b);
                return;
            &amp;#125;;
            DFS(1);
            return !f[1].empty();
        &amp;#125; ())
            res = mid, r = mid - 1;
        else 
            l = mid + 1;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-candy-piles&#34;&gt;D. Candy Piles&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://vjudge.net/contest/669299#problem/D&#34; class=&#34;uri&#34;&gt;https://vjudge.net/contest/669299#problem/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°æˆ‘ä»¬å¯ä»¥æŠŠé¢˜æ„è½¬åŒ–ä¸ºï¼ŒæŠŠæ‰€æœ‰åˆ—ä»å¤§åˆ°å°æ’åˆ—ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©åˆ æ‰æœ€å·¦è¾¹ä¸€åˆ—æˆ–æœ€ä¸‹è¾¹ä¸€è¡Œï¼Œåˆ ç©ºè€…èƒœã€‚&lt;/p&gt;
&lt;p&gt;æŠŠè¯¥æŸ±çŠ¶å›¾è½¬åŒ–ä¸ºç½‘æ ¼å›¾ï¼Œå®šä¹‰è¾¹ç•Œä¸ºèƒœåˆ©ç‚¹ï¼Œå¯¹äºéè¾¹ç•Œä¸Šçš„ç‚¹ï¼Œå…¶ä¸€å®šå¯ä»¥å¾€å³èµ°ã€å¾€ä¸Šèµ°ã€‚è‹¥ä¸€ä¸ªç‚¹ä¸Šæ–¹ã€å³ä¾§ç‚¹å‡ä¸ºèƒœåˆ©ç‚¹ï¼Œæ­¤ç‚¹ä¸ºå¤±è´¥ç‚¹ï¼›å¦åˆ™ï¼Œæ­¤ç‚¹ä¸ºèƒœåˆ©ç‚¹ã€‚&lt;/p&gt;
</content>
        <category term="DP" />
        <category term="éšæœºåŒ–" />
        <updated>2024-11-04T01:05:07.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20240906/</id>
        <title>åŠ¨æ€è§„åˆ’ 10 é¢˜ - I</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20240906/"/>
        <content type="html">&lt;p&gt;ç°åœ¨æ˜¯ 10 é¢˜ã€‚è™½ç„¶çœ‹ç€å¾ˆæ‰ä»·ï¼Œä½†æ˜¯å†™å¤Ÿäº† 10 å°±æ”¹æˆ 20 é¢˜ã€‚ä»¥æ­¤ç±»æ¨ï¼Œå…å¾—æˆ‘æ‘†çƒ‚ï¼ˆï¼‰&lt;/p&gt;
&lt;p&gt;è‡ªç”¨å‘ï¼Œä¸å†™å¤ªè¯¦ç»†ï¼ŒæŠŠç ´é¢˜ç‚¹å†™å‡ºæ¥å°±å·®ä¸å¤šäº†ã€‚å“¦å“¦è¿™é‡Œçš„ç ´é¢˜æ˜¯åŠ¨è¯ä¸æ˜¯åè¯ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å­—ç¬¦åˆå¹¶&#34;&gt;1. å­—ç¬¦åˆå¹¶&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3736&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3736&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(01\)&lt;/span&gt; ä¸²å’Œ &lt;span class=&#34;math inline&#34;&gt;\(2^k\)&lt;/span&gt; æ¡è§„åˆ™ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¡è§„åˆ™å½¢å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºåºåˆ—ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä½äºŒè¿›åˆ¶æ•° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå¯ä»¥å°†å®ƒåˆå¹¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c(c\in\{0,1\})\)&lt;/span&gt;ï¼Œå¹¶äº§ç”Ÿ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ä»·å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿›è¡Œä»»æ„æ¬¡åˆå¹¶ï¼Œæ±‚å‡ºèƒ½å–å¾—çš„æœ€å¤§æ€»ä»·å€¼ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 300,k\le 8\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;çŠ¶å‹&lt;/strong&gt;ï¼Œ&lt;strong&gt;åŒºé—´ DP&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt;ï¼Œç‹¬ç‰¹çš„è¾“å…¥æ–¹å¼ä¹Ÿå¼•å¯¼æˆ‘ä»¬æ³¨æ„åˆ°çŠ¶æ€æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(10^2\)&lt;/span&gt; çº§åˆ«ã€‚åˆå¹¶çš„èƒŒæ™¯åˆè®©æˆ‘ä»¬æœ¬èƒ½æƒ³åˆ°åŒºé—´ DPï¼Œæ‰€ä»¥åˆšå¥½ç›²çŒœè¿™é¢˜æ˜¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(O(2^k\times n^2)\)&lt;/span&gt; çš„åŒºé—´çŠ¶å‹ DPã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ç„¶åæˆ‘è§‰å¾—æœ€ç¥çš„ä¸€ä¸ªåœ°æ–¹æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæœ€åçš„ç­”æ¡ˆä¸€å®šæ˜¯ä¸€ä¸ªé•¿åº¦å°äº &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ä¸²ï¼Œ&lt;mark&gt;æ¯ä½å±•å¼€è¿˜åŸï¼Œå¯ä»¥çŸ¥é“ï¼Œæ¯ä¸ªåˆå¹¶æ“ä½œé€‰å–çš„åŒºé—´å¯èƒ½åŒ…å«ä½†ä¸ç›¸äº¤ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;çœ‹èµ·æ¥å¾ˆè ¢å¾ˆæ˜¾ç„¶ï¼Œä½†è¿™æ˜¯æˆ‘ä»¬ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; åŒºé—´ DP çš„åŸºç¡€å•Šï¼ˆï¼ˆï¼ˆ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬åŒºé—´ DP å¥—è·¯ï¼Œæšä¸¾å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; æœ€å·¦è¾¹ä¸€ä½ï¼Œç„¶åå°±å¯ä»¥å¼€å§‹å¤§åŠ›è½¬ç§»äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œè¿™ä¸€ä½åŸæœ¬çš„æ ·å­æœ‰ç‚¹å¤šï¼Œå¯ä»¥æ˜¯ä»»ä½•ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1 + d\times (k-1)\)&lt;/span&gt; çš„æ•°ï¼Œæ‰€ä»¥åªèƒ½å†æ¥ä¸€å±‚ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac nk\)&lt;/span&gt; çš„æšä¸¾ï¼Œæé™æƒ…å†µæ˜¯ä¸ªæœ‰ç‚¹éš¾ç»·çš„ 3e9ï¼Œä½œä¸ºæ­£è§£åªèƒ½è¯´è¿™ä¸ªæ•°æ®èŒƒå›´çš„æç¤ºæ€§æœ‰ç‚¹ä»¤äººéš¾è¯„äº†ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°ç€å®ç°ç€æŠŠè‡ªå·±æ•´æ‡µäº†ï¼š&lt;code&gt;00000&lt;/code&gt; å’Œ &lt;code&gt;0&lt;/code&gt; å‹å‡ºæ¥éƒ½æ˜¯ &lt;code&gt;0&lt;/code&gt;ï¼Œä½†äºŒè€…ä»£è¡¨çš„å«ä¹‰æ˜¾ç„¶ä¸åŒï¼Œåˆæ— æ³•ç®€å•åŒºåˆ«ã€‚ä½†å…¶å®&lt;mark&gt;é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1+d\times (k-1)\)&lt;/span&gt; çš„åŒºé—´å’Œé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„æœ€ç»ˆç»“æœæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬è®¾è®¡çš„åŒ…å«äº†åŒºé—´ä½œå³ç«¯ç‚¹çš„çŠ¶æ€ä¸­ï¼Œå‹å‡ºæ¥çš„å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„é‚£ä¸ªã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;è¿™é‡Œçš„å®ç°æ¯”&lt;strong&gt;æ‰€æœ‰&lt;/strong&gt;æˆ‘æ‰¾åˆ°çš„é¢˜è§£éƒ½æ›´åƒäººæ‰“å‡ºæ¥çš„ã€‚å¯¼è‡´æˆ‘æƒ³å¯¹æ¯”ç–—æ³•éƒ½æ‰¾ä¸åˆ°åˆé€‚çš„ä»£ç  &lt;img src=&#34;/em/lh.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;æ¢è¨€ä¹‹ï¼Œè¿™æœ€åƒæ˜¯ä¸€ä»½é€šå¸¸çš„åŒºé—´ DP ä»£ç ï¼Œä¸å­˜åœ¨å…¶ä»–é¢˜è§£ä¸­ä¹±ä¸ƒå…«ç³Ÿçš„å¡«è¡¨å•Šç›¸äº’å½±å“å•Šä¹‹ç±»çš„æ¶å¿ƒ featureã€‚&lt;/p&gt;
&lt;p&gt;sto rybp orz&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 305;
const int maxm = (1 &amp;lt;&amp;lt; 8) + 5;
char a[maxn];
int c[maxm], w[maxm];
long long f[maxn][maxn][maxm];
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#else
    freopen(&amp;quot;in.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    freopen(&amp;quot;out.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    int siz = (1 &amp;lt;&amp;lt; k), si = (1 &amp;lt;&amp;lt; (k - 1));
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 0; i &amp;lt; siz; ++i)
        std::cin &amp;gt;&amp;gt; c[i] &amp;gt;&amp;gt; w[i];
    memset(f, -0x3f, sizeof(f));
    for (int l = 1; l &amp;lt; k; ++l)
        for (int i = 1; i &amp;lt;= n - l + 1; ++i) &amp;#123;
            int j = i + l - 1, now = 0;
            for (int p = i; p &amp;lt;= j; ++p)
                now = now * 2 + a[p] - &amp;#39;0&amp;#39;;
            f[i][j][now] = 0;
        &amp;#125;
    for (int i = 1; i &amp;lt;= n - k + 1; ++i) &amp;#123;
        int now = 0;
        for (int j = i; j &amp;lt;= i + k - 1; ++j)
            now = now * 2 + a[j] - &amp;#39;0&amp;#39;;
        f[i][i + k - 1][c[now]] = w[now];
    &amp;#125;
    for (int l = k + 1; l &amp;lt;= n; ++l)
        for (int i = 1; i &amp;lt;= n - l + 1; ++i) &amp;#123;
            int j = i + l - 1;
            for (int p = i; p &amp;lt; j; p += k - 1) &amp;#123;
                for (int q = 0; q &amp;lt; si; ++q)
                    if (!(q &amp;gt;&amp;gt; ((l - 1) % (k - 1) + 1)))
                        f[i][j][q] = std::max(f[i][j][q], f[i][p][q &amp;gt;&amp;gt; ((l - 1) % (k - 1))] + f[p + 1][j][q &amp;amp; ((1 &amp;lt;&amp;lt; ((l - 1) % (k - 1))) - 1)]);
                if (l % (k - 1) == 1 || k == 2)
                    for (int q = 0; q &amp;lt; siz; ++q)
                        f[i][j][c[q]] = std::max(f[i][j][c[q]], f[i][p][q &amp;gt;&amp;gt; (k - 1)] + f[p + 1][j][q &amp;amp; ((1 &amp;lt;&amp;lt; (k - 1)) - 1)] + w[q]);
            &amp;#125;
        &amp;#125;
    std::cout &amp;lt;&amp;lt; *std::max_element(f[1][n], f[1][n] + si) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;p&gt;å…¶å®ä¸€å¼€å§‹æŒºæ‹…å¿ƒä¼šä¸ä¼šå› ä¸ºå†™åšå®¢å½±å“åšé¢˜æ—¶é—´ä¹‹ç±»çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç›´åˆ°å‘ç°æˆ‘å¯ä»¥çœ‹çŸ¥ä¹çœ‹ä¸€ä¸ªä¸Šåˆç„¶åä»£ç åŠ¨éƒ½ä¸åŠ¨ä¸€ä¸‹ &lt;img src=&#34;/em/lh.gif&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;mod-mod-mod&#34;&gt;2. Mod Mod Mod&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/889/problem/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/889/problem/E&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œå¯¹äºæ‰€æœ‰éè´Ÿæ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(f(x,n)=x\bmod a_n\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f(x,i)=x\bmod a_i+f(x\bmod a_i,i+1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(f(x,1)\)&lt;/span&gt; æœ€å¤§å€¼ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;æŠ€å·§ / ç‰¹æ®Šæ€§è´¨ç±» DP&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å°ç¥é¢˜ã€‚æ³¨æ„åˆ°é¢˜æ„å¯ä»¥è½¬åŒ–ä¸ºï¼Œæ‰¾åˆ°ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œæœ€å¤§åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
x\bmod a_1 + x\bmod a_1\bmod a_2 + \cdots + x\bmod a_1\bmod a_2\bmod\cdots\bmod a_n.
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç®€ç§° &lt;span class=&#34;math inline&#34;&gt;\(x\bmod a_1\bmod a_2\bmod \cdots\bmod a_i\)&lt;/span&gt; çš„å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¸éš¾æ³¨æ„åˆ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è‚¯å®šæ˜¯&lt;mark&gt;å•è°ƒä¸å‡&lt;/mark&gt;çš„ã€‚å½¢è±¡åŒ–åœ°ï¼Œæ•´ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; åºåˆ—è‚¯å®šæ˜¯ç”±è‹¥å¹²ä¸ªå•è°ƒä¸‹é™çš„æ®µç»„æˆçš„ã€‚å¹¶ä¸”ï¼Œ&lt;mark&gt;å¿…å®šå­˜åœ¨è‡³å°‘ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(f_i = a_i-1\)&lt;/span&gt;ï¼Œå¦åˆ™å¯ä»¥å°†æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_i\gets f_i+1\)&lt;/span&gt;ï¼ŒåŒæ—¶ &lt;span class=&#34;math inline&#34;&gt;\(\sum f\gets (\sum f) + n\)&lt;/span&gt;&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¯ç¤ºæˆ‘ä»¬å…³æ³¨ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; çš„å€¼åŸŸã€‚å‡è®¾å·²ç»ç¡®å®šäº† &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; åºåˆ—çš„ä¸€ä¸ªå‰ç¼€ &lt;span class=&#34;math inline&#34;&gt;\(f_1\sim i\)&lt;/span&gt;ï¼Œå¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(0\le k\le f_{\min}\)&lt;/span&gt;ï¼ˆæ³¨æ„ç”±äºå•è°ƒä¸é™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{\min} = f_i\)&lt;/span&gt;ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_j\gets f_j-k\)&lt;/span&gt;ï¼Œå¾—åˆ°ä¸€ä¸ªæ–°çš„åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;_{1\sim i}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½¢è±¡åŒ–åœ°ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(f_{1\sim i}\)&lt;/span&gt; æƒ³è±¡ä¸ºä¸€ä¸ªé€æ¸é™ä½çš„æŸ±çŠ¶å›¾ï¼Œä»»æ„åˆ‡å»äº†ä¸€ä¸ªé«˜åº¦çš„åº•éƒ¨ï¼Œå¹¶ä¸”è¿™ä¸ªé«˜åº¦ä¸é«˜äºæœ€çŸ®çš„å…ƒç´ ï¼ˆå³ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå…ƒç´ ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™æœ‰ä¸€ä¸ªå¾ˆç¾å¦™çš„æ€§è´¨ï¼Œå°±æ˜¯æˆ‘ä»¬&lt;mark&gt;å¯¹äºåˆ‡ä¹‹å‰å’Œåˆ‡ä¹‹åçš„æŸ±çŠ¶å›¾ï¼Œå…¶ &lt;strong&gt;æœ€çŸ®å…ƒç´ ä»¥ä¸Šçš„éƒ¨åˆ†&lt;/strong&gt; é•¿å¾—å®Œå…¨ç›¸åŒ&lt;/mark&gt;ã€‚ç„¶åå°±æ˜¯ç¥ä¸­ç¥ä¹‹ DP çŠ¶æ€è®¾è®¡ã€‚å¾ˆéš¾æƒ³è±¡æ˜¯åœ¨ä»€ä¹ˆæ ·çš„ç²¾ç¥çŠ¶æ€ä¸‹å‡‘å‡ºæ¥è¿™ç§ç¥å¥‡çŠ¶æ€çš„ï¼Œå¯èƒ½æ˜¯æŸç§æˆ‘ä¸äº†è§£çš„ trickï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(dp_{i, j}\)&lt;/span&gt; è¡¨ç¤ºå¯¹äºå‰ç¼€ &lt;span class=&#34;math inline&#34;&gt;\(f_{1, i}\)&lt;/span&gt;ï¼Œå½“åˆ‡å»çš„é«˜åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\sim j\)&lt;/span&gt; æ—¶ï¼Œ&lt;strong&gt;æœ€çŸ®å…ƒç´ ä»¥ä¸Šçš„éƒ¨åˆ†&lt;/strong&gt; çš„å’Œéƒ½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(dp_{i, j}\)&lt;/span&gt;ã€‚é‚£ä¹ˆæ˜“å¾— &lt;span class=&#34;math inline&#34;&gt;\(\sum f_{1\sim i}=j\times i + dp_{i, j}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘è½¬ç§»ã€‚å‡è®¾å·²çŸ¥æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(dp_{i - 1, j}\)&lt;/span&gt;ï¼Œéœ€è½¬ç§»åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæˆ‘ä»¬æœ‰ä¸‰ç§è½¬ç§»è·¯å¾„ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(j &amp;lt; a_i\)&lt;/span&gt;ï¼š&lt;/p&gt;
å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å–æ¨¡å–ä¸åŠ¨ï¼Œä¸ä¼šäº§ç”Ÿä»»ä½•å½±å“ã€‚&lt;span class=&#34;math inline&#34;&gt;\(dp_{i, j}\gets dp_{i - 1, j}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(j\ge a_i\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è®© &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰¿æ‹… &lt;span class=&#34;math inline&#34;&gt;\(f_i=a_i-1\)&lt;/span&gt; çš„è´£ä»»ã€‚æˆ‘ä»¬ä» &lt;span class=&#34;math inline&#34;&gt;\(0\sim j\)&lt;/span&gt; ä¸­æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\bmod a_i=a_i-1\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;\)&lt;/span&gt; è‚¯å®šæ˜¯è¶Šå¤§è¶Šå¥½ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(j&amp;#39;=(\left\lfloor \dfrac {j}{a_i}\right\rfloor-1)\times a_i+(a_i-1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
æ­¤æ—¶ä¾¿æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(dp_{i, a_i-1}\gets dp_{i - 1, j&amp;#39;} + [j&amp;#39; - (a_i-1)]\times (i-1)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç›²çŒœ &lt;span class=&#34;math inline&#34;&gt;\(0\sim i - 1\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(i+1\sim n\)&lt;/span&gt; ä¸­ä¼šå‡ºç°æ‰¿æ‹… &lt;span class=&#34;math inline&#34;&gt;\(f_{i&amp;#39;}=a_{i&amp;#39;-1}\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;#39;\)&lt;/span&gt;ï¼Œæ•…æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å–æœ€å¤§æ¥è½¬ç§»ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(dp_{i, j\bmod a_i}=dp_{i-1,j}+(j-j\bmod a_i)\times (i-1)\)&lt;/span&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç­”æ¡ˆå³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\max\{j\times n+dp_{n, j}\}\)&lt;/span&gt;ã€‚ç”±äºä¸å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f_i=a_i-1\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; è‚¯å®šæ¯”å­˜åœ¨çš„è¦åŠ£ï¼Œæ‰€ä»¥æˆ‘ä»¬è‚¯å®šé€‰åˆ°çš„æ˜¯æ­£ç¡®çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åªä¼šæ–°å¢ &lt;span class=&#34;math inline&#34;&gt;\(a_i-1\)&lt;/span&gt; ä¸€ä¸ªçŠ¶æ€ï¼Œæ•…çŠ¶æ€æ€»æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(dp\)&lt;/span&gt; å¼€æˆ map å°±å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt; åœ°è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#else
    freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    std::map&amp;lt;long long, long long&amp;gt; t;
    std::cin &amp;gt;&amp;gt; a[1];
    t[a[1] - 1] = 0;
    for (int i = 2; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        for (;;) &amp;#123;
            auto p = t.lower_bound(a[i]);
            if (p == t.end())
                break;
            long long j = p-&amp;gt;first, f = p-&amp;gt;second;
            t[j % a[i]] = std::max(t[j % a[i]], f + (j - j % a[i]) * (i - 1));
            if (j &amp;gt;= a[i]) &amp;#123;
                j = (j / a[i] - 1) * a[i] + a[i] - 1;
                t[a[i] - 1] = std::max(t[a[i] - 1], f + (j - (a[i] - 1)) * (i - 1));
            &amp;#125;
            t.erase(p);
        &amp;#125;
    &amp;#125;
    long long res = 0;
    for (auto i : t)
        res = std::max(res, i.first * n + i.second);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;stalinsort-algorithm&#34;&gt;3. StalinSort Algorithm&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://qoj.ac/problem/1456&#34; class=&#34;uri&#34;&gt;https://qoj.ac/problem/1456&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šæ’åˆ— &lt;span class=&#34;math inline&#34;&gt;\(A_{1\sim n}\)&lt;/span&gt;ã€‚ä» &lt;span class=&#34;math inline&#34;&gt;\(i=2\)&lt;/span&gt; å¼€å§‹å¾€å³æ‰«ï¼Œæ¯ä¸€æ­¥æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(A_i&amp;gt; A_{i-1}\)&lt;/span&gt;ï¼Œä»€ä¹ˆä¹Ÿä¸åšã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œä½ å¯ä»¥åˆ é™¤ &lt;span class=&#34;math inline&#34;&gt;\(A_{i-1}\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(A_i\)&lt;/span&gt;ï¼Œä½†è¦æ±‚åˆ é™¤åï¼Œè¯¥å‰ç¼€å¿…é¡»å•è°ƒé€’å¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é—®æœ€å°‘å¯ä»¥åˆ é™¤å¤šå°‘ä¸ªæ•°ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½ ä¼šå‘ç°&lt;mark&gt;åˆ æœ€å°‘ = ç•™æœ€å¤š&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; èƒ½å¤Ÿè½¬ç§»åˆ°çš„ &lt;span class=&#34;math inline&#34;&gt;\(j(j&amp;gt;i)\)&lt;/span&gt; éœ€æ»¡è¶³çš„æ¡ä»¶ã€‚è‹¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(nex_p\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; ä¹‹åç¬¬ä¸€ä¸ªå€¼æ¯” &lt;span class=&#34;math inline&#34;&gt;\(a_p\)&lt;/span&gt; å¤§çš„å…ƒç´ ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(j\in [nex_i, nex_{nex_i})\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(a_j&amp;gt;a_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;èµ›æ—¶è¯¯è®¤ä¸ºå³ç«¯ç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¹‹åç¬¬äºŒä¸ªå€¼æ¯” &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å¤§çš„å…ƒç´ ï¼Œå¯¼è‡´å®Œå…¨å¯„æ‰ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚&lt;mark&gt;æ³¨æ„åˆ°å¦‚æœåªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\in [nex_i, nex_{nex_i})\)&lt;/span&gt; è¿™ä¸ªæ¡ä»¶å¾ˆå®¹æ˜“ç”¨çº¿æ®µæ ‘ç»´æŠ¤ï¼Œè€ƒè™‘æ¶ˆå» &lt;span class=&#34;math inline&#34;&gt;\(a_j&amp;gt;a_i\)&lt;/span&gt; çš„å½±å“ã€‚æ•…è€ƒè™‘æŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; &lt;strong&gt;ä»å°åˆ°å¤§&lt;/strong&gt; çš„é¡ºåºé€‰å– &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå› ä¸ºå½“å‰æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸€å®šå·²ç»è¢«åˆ·å®Œè¡¨äº†&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e5 + 5;
const int inf = 0x3f3f3f3f;
struct _ &amp;#123; int u, d; &amp;#125; t1[maxn &amp;lt;&amp;lt; 2];
int n, t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void upd(int p, int l, int r, int x, int v) &amp;#123;
    t[p] = std::min(t[p], v);
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, l, mid, x, v);
    else
        upd(rt, mid + 1, r, x, v);
    return;
&amp;#125;
int ask(int p, int l, int r, int ql, int qr) &amp;#123;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr)
        return t[p];
    int mid = (l + r) &amp;gt;&amp;gt; 1, res = n + 1;
    if (ql &amp;lt;= mid)
        res = ask(lt, l, mid, ql, qr);
    if (qr &amp;gt; mid)
        res = std::min(res, ask(rt, mid + 1, r, ql, qr));
    return res;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t1[p].d) &amp;#123;
        t1[lt].u = std::max(t1[lt].u, t1[p].d);
        t1[lt].d = std::max(t1[lt].d, t1[p].d);       
        t1[rt].u = std::max(t1[rt].u, t1[p].d);
        t1[rt].d = std::max(t1[rt].d, t1[p].d);       
        t1[p].d = 0;
    &amp;#125;
    return;
&amp;#125;
void upd(int p, int l, int r, int ql, int qr, int v) &amp;#123;
    t1[p].u = std::max(t1[p].u, v);
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr) &amp;#123;
        t1[p].d = std::max(t1[p].d, v);
        return;
    &amp;#125;
    pushdown(p);
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (ql &amp;lt;= mid)
        upd(lt, l, mid, ql, qr, v);
    if (qr &amp;gt; mid)
        upd(rt, mid + 1, r, ql, qr, v);
    return;
&amp;#125;
int ask(int p, int l, int r, int x) &amp;#123;
    if (l == r)
        return t1[p].u;
    pushdown(p);
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        return ask(lt, l, mid, x);
    return ask(rt, mid + 1, r, x);
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#else
    freopen(&amp;quot;sort3.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    // freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int res = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), ne(n + 1), f(n + 1);
    std::fill(t + 1, t + 4 * n + 1, n + 1);
    std::fill(t1 + 1, t1 + 4 * n + 1, (_)&amp;#123; -inf, 0 &amp;#125;);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = n; ~i; --i) &amp;#123;
        ne[i] = ask(1, 0, n, a[i] + 1, n);
        upd(1, 0, n, a[i], i);   
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; id(n + 1);
    std::iota(id.begin(), id.end(), 0);
    std::sort(id.begin(), id.end(), [&amp;amp;](int x, int y) &amp;#123; return a[x] &amp;lt; a[y]; &amp;#125;);
    f[0] = 0;
    for (int i = 0; i &amp;lt;= n; ++i) &amp;#123;
        if (i) &amp;#123;
            f[id[i]] = ask(1, 0, n, id[i]);
            res = std::max(res, f[id[i]]);
        &amp;#125;
        if (ne[id[i]] &amp;lt;= n)
            upd(1, 0, n, ne[id[i]], ne[ne[id[i]]] - 1, f[id[i]] + 1);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; n - res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;merge-triplets&#34;&gt;4. Merge Triplets&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/agc043/tasks/agc043_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/agc043/tasks/agc043_d&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(A_{1\sim 3N}=\{1, 2, \dots, 3N\}\)&lt;/span&gt;ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¼€å§‹æ¯ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªæ•°åˆ†ä¸ºä¸€ç»„ï¼Œæ¯ä¸€ç»„åˆå§‹æœ‰ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚æ‰§è¡Œè‹¥å¹²æ¬¡ä»¥ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åœ¨æ‰€æœ‰æŒ‡é’ˆæŒ‡å‘çš„æ•°ä¸­é€‰æ‹©ä¸€ä¸ªæœ€å°çš„ï¼ŒæŠŠå®ƒæ”¾åˆ°åºåˆ—æœ«ï¼ˆä¸ä¼šåŠ å…¥æœ«ç«¯çš„ç»„ï¼‰ï¼›å°†åŸæœ¬æŒ‡å‘å®ƒçš„æŒ‡é’ˆåç§»ä¸€ä½ï¼Œå¦‚æœç§»å‡ºåŸæœ¬çš„ç»„å°±åˆ é™¤è¿™ä¸ªæŒ‡é’ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é—®ä»»æ„æ¬¡æ“ä½œåï¼Œå¯èƒ½å¾—åˆ°å¤šå°‘ç§åºåˆ—ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^3\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç”±äºè¦å¯¹åˆæ³•çš„æœ€ç»ˆåºåˆ—è¿›è¡Œè®¡æ•°ï¼Œè€ƒè™‘æœ€ç»ˆåºåˆ—çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥åºåˆ—ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(a_{i+1}&amp;lt;a_i\)&lt;/span&gt;ï¼Œåˆ™è¯´æ˜åœ¨æŸä¸€ç»„ä¸­ï¼Œå€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„å…ƒç´ ä¸‹ä¸€ä¸ªå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_{i+1}\)&lt;/span&gt;ã€‚å¦åˆ™ï¼Œå›  &lt;span class=&#34;math inline&#34;&gt;\(a_{i+1}\)&lt;/span&gt; å¯é€‰ä¸”æ¯” &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_{i+1}\)&lt;/span&gt; åº”æ’åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å‰é¢ã€‚&lt;/p&gt;
&lt;p&gt;å¦åˆ™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(a_{i+1}\)&lt;/span&gt; æ—¢å¯ä»¥ä¸ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¸åœ¨åŒä¸€ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ç»„æœ€å¤šä¸‰ä¸ªå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸èƒ½å‡ºç° &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;gt;a_{i+1},a_{i+2},a_{i+3}\)&lt;/span&gt; çš„æƒ…å†µã€‚è€Œ &lt;span class=&#34;math inline&#34;&gt;\(N=1\)&lt;/span&gt; æ—¶åºåˆ—é•¿åº¦åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt;ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ ·ä¾‹ä¸€çš„ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(3!\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¿™ä¸ªé™åˆ¶å¹¶ä¸èƒ½æ’é™¤æ‰€æœ‰éæ³•æƒ…å†µã€‚&lt;span class=&#34;math inline&#34;&gt;\(N=2\)&lt;/span&gt; æ—¶æš´æœæˆ‘ä»¬ç›®å‰é™åˆ¶ä¸‹çš„è§£ï¼Œå…±æœ‰ 276 ä¸ªï¼Œæ¯”ç­”æ¡ˆä¸­çš„ 261 ä¸ªè¦å¤šï¼Œè¯´æ˜åŒ…å«äº†å…¶ä»–éæ³•è§£ã€‚&lt;/p&gt;
&lt;p&gt;æš´æœè¾“å‡ºå¹¶è§‚å¯Ÿï¼Œæ˜“å¾—è¿™ 15 ä¸ªéæ³•åºåˆ—å³ä¸ºæ»¡è¶³ç›®å‰é™åˆ¶ä¸”å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;gt;a_{i+1}\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;lt;a_{i+2}\)&lt;/span&gt; çš„æ‰€æœ‰åºåˆ—ï¼Œ&lt;mark&gt;ç”±å‰é¢çš„æ¨å¯¼ï¼Œå¿…é¡»åˆ†ä¸ºä¸‰ä¸ªé•¿åº¦ä¸º 2 çš„ç»„ï¼Œè€Œæˆ‘ä»¬è¦æ±‚çš„æ˜¯é•¿åº¦ä¸º 3 çš„ç»„ã€‚æ˜¾ç„¶æ— æ³•ç”¨å‰è€…ç»„åˆå¾—åˆ°åè€…&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬ç¬¬ä¸€ä¸ªæ¡ä»¶çš„é™åˆ¶ä¸‹ï¼Œå¿…é¡»è¢«åˆ†åˆ°åŒä¸€ç»„çš„æ•°çš„è¿ç»­é•¿åº¦ï¼Œåªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(1,2,3\)&lt;/span&gt; ä¸‰ç§ã€‚è€Œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é•¿åº¦ä¸º 3 çš„å¯¹ç­”æ¡ˆåˆæ³•æ€§æ— å½±å“ï¼›&lt;/li&gt;
&lt;li&gt;è€Œé•¿åº¦ä¸º 1 çš„æ—¢å¯ä»¥å’Œ 2 ç»„ä¸ºä¸€ç»„ï¼Œä¹Ÿå¯ä»¥å’Œå…¶ä»–ä¸¤ä¸ª 1 ç»„ä¸ºä¸€ç»„ï¼›&lt;/li&gt;
&lt;li&gt;é•¿åº¦ä¸º 2 çš„åªèƒ½å’Œ 1 ç»„æˆä¸€ç»„ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;mark&gt;è¿™æ—¶ï¼Œæˆ‘ä»¬å‘ç°æ‰€æœ‰é™åˆ¶éƒ½æŒ‡å‘é•¿åº¦ä¸º 2 çš„æ®µï¼Œå…¶æ€»ä¸ªæ•°ä¸èƒ½æ¯”é•¿åº¦ä¸º 1 çš„æ®µå¤šã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;äºæ˜¯ä¹ï¼Œä¸Šè¿°é™åˆ¶å¯æ€»ç»“ä¸ºä¸¤ç‚¹ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;è‹¥ä»¤æ‰€æœ‰æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_l&amp;gt;\max\{a_{l\sim r}\}\)&lt;/span&gt; çš„æå¤§åŒºé—´ä¸ºä¸€æ®µï¼ˆæ˜“è¯æ¯æ®µäº’ä¸é‡åˆä¸”è¦†ç›–å…¨åºåˆ—ï¼‰ï¼Œé‚£ä¹ˆå…¶é•¿åº¦ä¸èƒ½è¶…è¿‡ 3ã€‚&lt;/li&gt;
&lt;li&gt;å…¶ä¸­ï¼Œé•¿åº¦ä¸º 2 çš„ä¸ªæ•°ä¸èƒ½æ¯”é•¿åº¦ä¸º 1 çš„ä¸ªæ•°å¤šã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;mark&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j}\)&lt;/span&gt; è¡¨ç¤ºè‹¥å½“å‰æšä¸¾çš„æœ€åä¸€æ®µå³ç«¯ç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œé•¿åº¦ä¸º 1 çš„æ®µæ¯”é•¿åº¦ä¸º 2 çš„æ®µå¤š &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;æœ€åç­”æ¡ˆå³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{j=0}^n f_{i, j}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#else
    freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, mod;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; mod;
    n *= 3;
    std::vector&amp;lt;std::unordered_map&amp;lt;int, long long&amp;gt; &amp;gt; f(n + 1);
    f[0][0] = 1;
    for (int i = 0; i &amp;lt; n; ++i)
        for (auto [j, k] : f[i]) &amp;#123;
            (f[i + 1][j + 1] += k) %= mod;
            if (i + 2 &amp;lt;= n)
                (f[i + 2][j - 1] += k * (i + 1) % mod) %= mod;
            if (i + 3 &amp;lt;= n)
                (f[i + 3][j] += k * (i + 1) % mod * (i + 2) % mod) %= mod;
        &amp;#125;
    long long res = 0;
    for (int i = 0; i &amp;lt;= n; ++i)
        (res += f[n][i]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;runaway-quail&#34;&gt;5. Runaway Quail&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://qoj.ac/problem/5978&#34; class=&#34;uri&#34;&gt;https://qoj.ac/problem/5978&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ•°è½´ä¸Šæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; åªé¸¡ï¼Œåˆå§‹ä½ç½®ä¸ºé &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; æ•´æ•° &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt;ï¼Œå¥”è·‘é€Ÿåº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s_i\)&lt;/span&gt;ã€‚ä½ åˆå§‹åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; ä½ç½®ï¼Œå¥”è·‘é€Ÿåº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(Y(Y&amp;gt;s_i)\)&lt;/span&gt;ã€‚ä½ è¦æŠ“åˆ°æ‰€æœ‰é¸¡ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥åœ¨ä»»æ„æ—¶åˆ»è°ƒè½¬æ–¹å‘ï¼›é¸¡æ€»ä¼šæœç€è¿œç¦»ä½ çš„æ–¹å‘å¥”è·‘ï¼›å½“ä½ çš„åæ ‡å’Œé¸¡é‡åˆæ—¶ï¼Œä½ æŠ“åˆ°é¸¡ã€‚&lt;/p&gt;
&lt;p&gt;é—®æŠ“åˆ°æ‰€æœ‰é¸¡çš„æœ€çŸ­æ—¶é—´ï¼ˆæ˜¾ç„¶æ˜¯ä¸ªå®æ•°ï¼‰ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 500\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®¹æ˜“å‘ç°é¸¡çš„å¥”è·‘æ–¹å‘ä»å§‹è‡³ç»ˆä¸ä¼šå˜ï¼Œå¦‚æœæˆ‘ä»¬è¦ä»å¾€å·¦è¿½å˜æˆå¾€å³è¿½ï¼Œæ˜¾è€Œæ˜“è§åœ°æˆ‘ä»¬ä¼š&lt;mark&gt;åœ¨è¿½ä¸Šå³è¾¹ç¬¬ä¸€åªé¸¡å‰ç»è¿‡åŸç‚¹&lt;/mark&gt;ï¼Œåä¹‹åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæœ‰ä¸€ä¸ªå¾ˆç¥å¥‡çš„çŠ¶æ€è®¾è®¡ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; ä¸ºè¿½ä¸Šäº†å·¦è¾¹é€Ÿåº¦ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(1\sim i - 1\)&lt;/span&gt; å¤§çš„æ‰€æœ‰é¸¡å’Œå³è¾¹é€Ÿåº¦ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(1\sim j - 1\)&lt;/span&gt; å¤§çš„æ‰€æœ‰é¸¡ï¼Œç„¶åè·‘å›åŸç‚¹çš„æœ€å°æ—¶é—´ï¼Œè¿™æ ·æˆ‘ä»¬å°±ä¸ç”¨è®°å½•è¿™ä¸ªéå¸¸éš¾è®°å½•çš„å½“å‰ä½ç½®ä¿¡æ¯ï¼Œå¯¹äºé€Ÿåº¦æ’å &lt;span class=&#34;math inline&#34;&gt;\(\ge i,j\)&lt;/span&gt; çš„æ‰€æœ‰é¸¡ï¼Œå½“å‰æ˜¯å¦è¿½ä¸Šæˆ‘ä»¬å¹¶ä¸å…³å¿ƒâ€”â€”&lt;mark&gt;å¦‚æœå…¶ä½ç½®æ¯”è¾ƒè¿œï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šåœ¨åç»­è½¬ç§»ä¸­å†è€ƒè™‘ï¼›å¦‚æœå…¶ä½ç½®æ¯”è¾ƒè¿‘ï¼Œåœ¨è§£å†³é€Ÿåº¦æ’å &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;i,j\)&lt;/span&gt; çš„é¸¡æ—¶å°±å·²ç»æŠ“ä½&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;æˆ‘ä»¬ &lt;span class=&#34;math inline&#34;&gt;\(\mathcal O(n)\)&lt;/span&gt; æšä¸¾ä¸Šä¸€æ¬¡åå‘æ˜¯åœ¨æŠ“ä½å“ªä¸€åªé¸¡æ—¶ï¼Œç„¶åè®©ä¸­é—´å…¨éƒ¨åŒå‘è·‘å³å¯&lt;/mark&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå‡è®¾æˆ‘ä»¬è¦ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(f_{k,j}\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(k&amp;lt;i\)&lt;/span&gt;ï¼‰ï¼Œé‚£ä¹ˆåªéœ€è¦æ›´æ–°æŠ“ä½é€Ÿåº¦æ’å &lt;span class=&#34;math inline&#34;&gt;\(i\sim k+1\)&lt;/span&gt; ä¸­è·‘å¾—æœ€è¿œçš„ä¸€åªé¸¡æ‰€éœ€é¢å¤–æ—¶é—´ã€‚æŒ‰é€Ÿåº¦æ’åºåå¯ä»¥çº¿æ€§ç®—ä»£ä»·ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long double eps = 1e-12;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int v, n;
        std::cin &amp;gt;&amp;gt; v &amp;gt;&amp;gt; n;
        std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; a(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; a[i].first;
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; a[i].second;
        a.emplace_back(0, 0), ++n;
        std::sort(a.begin() + 1, a.end());
        int p = std::lower_bound(a.begin() + 1, a.end(), std::make_pair(0, 0)) - a.begin();
        std::sort(a.begin() + 1, a.begin() + p, [](std::pair&amp;lt;int, int&amp;gt; x, std::pair&amp;lt;int, int&amp;gt; y) &amp;#123; return x.second == y.second ? x.first &amp;lt; y.first : x.second &amp;gt; y.second; &amp;#125;);
        std::sort(a.begin() + p + 1, a.end(), [](std::pair&amp;lt;int, int&amp;gt; x, std::pair&amp;lt;int, int&amp;gt; y) &amp;#123; return x.second == y.second ? x.first &amp;lt; y.first : x.second &amp;lt; y.second; &amp;#125;);
        std::vector&amp;lt;std::vector&amp;lt;long double&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long double&amp;gt; (n + 1, 1e18));
        f[1][n] = 0.;
        auto at = [&amp;amp;](int i, long double t) &amp;#123;
            return std::fabs(a[i].first + t * a[i].second * (i &amp;lt; p ? -1 : 1));
        &amp;#125;;
        auto calc = [&amp;amp;](int i, long double t) &amp;#123;
            return at(i, t) / (v - a[i].second);
        &amp;#125;;
        // for (int i = 1; i &amp;lt;= n; ++i)
        //     printf(&amp;quot;%d: (%d, %d)\n&amp;quot;, i, a[i].first, a[i].second);
        for (int i = 1; i &amp;lt;= p; ++i)
            for (int j = n; j &amp;gt;= p; --j) &amp;#123;
                if (i == p &amp;amp;&amp;amp; j == p)
                    break;
                long double d = 0.;
                // printf(&amp;quot;[%d, %d]: %lf\n&amp;quot;, i, j, f[i][j]);
                for (int k = i; k &amp;lt; p; ++k) &amp;#123;
                    if (at(k, f[i][j]) &amp;gt;= at(i, f[i][j]) - eps)
                        d = std::max(d, calc(k, f[i][j]));
                    // printf(&amp;quot;  k1 = %d, d = %lf\n&amp;quot;, k, d);
                    f[k + 1][j] = std::min(f[k + 1][j], f[i][j] + d + (k != j - 1) * d);
                &amp;#125;
                d = 0.;
                for (int k = j; k &amp;gt; p; --k) &amp;#123;
                    if (at(k, f[i][j]) &amp;gt;= at(j, f[i][j]) - eps)
                        d = std::max(d, calc(k, f[i][j]));
                    // printf(&amp;quot;  k2 = %d, d = %lf\n&amp;quot;, k, d);
                    f[i][k - 1] = std::min(f[i][k - 1], f[i][j] + d + (k != i + 1) * d);
                &amp;#125;
            &amp;#125;
        &amp;#123;
            static int casetot = 0;
            std::cout &amp;lt;&amp;lt; &amp;quot;Case #&amp;quot; &amp;lt;&amp;lt; ++casetot &amp;lt;&amp;lt; &amp;quot;: &amp;quot;;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(9) &amp;lt;&amp;lt; f[p][p] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;the-great-marathon&#34;&gt;6. The Great Marathon&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/38/H&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/38/H&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; æ¡è¾¹çš„æ— å‘è¿é€šå›¾ï¼Œç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸Šåˆå§‹æœ‰é€‰æ‰‹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ã€‚ä¸ºæ¯ä¸ªé€‰æ‰‹ä»»æ„æŒ‡å®šç»ˆç‚¹ï¼ˆå¯é‡å¤ï¼‰ï¼Œé‚£ä¹ˆæœ€åçš„æ’åæŒ‰ç…§æœ€çŸ­è·¯ä¸ºç¬¬ä¸€å…³é”®å­—ã€ç¼–å·ä¸ºç¬¬äºŒå…³é”®å­—æ’åºã€‚&lt;/p&gt;
&lt;p&gt;ç°æŒ‰ç…§æ’ååºåˆ—åˆ†æˆå‰ä¸­åä¸‰æ®µï¼Œè®°ä¸ºé‡‘é“¶é“œç‰Œï¼›æ»¡è¶³é‡‘ç‰Œæ•°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([g_1,g_2]\)&lt;/span&gt; ä¹‹é—´ï¼Œé“¶ç‰Œæ•°åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([s_1,s_2]\)&lt;/span&gt; ä¹‹é—´ã€‚ä»»æ„æŒ‡å®šå‘ç‰Œæ•°é‡å’Œæ¯ä¸ªäººçš„ç»ˆç‚¹ï¼Œé—®æœ€åæœ‰å¤šå°‘ç§æ–¹æ¡ˆæ•°ï¼›ä¸¤ä¸ªæ–¹æ¡ˆä¸åŒå½“ä¸”ä»…å½“æœ‰è‡³å°‘ä¸€ä¸ªäººæ‹¿çš„ç‰Œä¸ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 50,m\le 1000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;mark&gt;&lt;span class=&#34;math inline&#34;&gt;\(n=50\)&lt;/span&gt;ï¼šå¯èƒ½éœ€è¦è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(n^5\)&lt;/span&gt; åšæ³•ã€‚&lt;/mark&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°æ˜¯ &lt;mark&gt;éœ€è¦ç¡®å®šé¡ºåºçš„ DP&lt;/mark&gt;ã€‚å…³é”®ä½ç½®è‡ªç„¶åœ¨äºã€é‡‘é“¶ã€é“¶é“œç•Œå¤„ã€ã€‚è€ƒè™‘é’¦å®šé‡‘ç‰Œæœ€åä¸€åã€é“œç‰Œç¬¬ä¸€åçš„äººé€‰ï¼ˆä¸è€ƒè™‘ä¸­é—´çš„é“¶ç‰Œæ˜¯å› ä¸ºä¼šå‡ºç°è¿™æ ·é‚£æ ·çš„é—®é¢˜ï¼‰ï¼Œè¿˜éœ€è¦æšä¸¾ä»–ä»¬çš„è·¯ç¨‹å—ï¼Ÿå¹¶ä¸ã€‚ç”šè€Œè‡³äºï¼Œè¿™æ ·åšä¼šç®—é‡ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘&lt;mark&gt;ã€æœ€å°åŒ–ã€å·¦å³ä¸¤ä¾§çš„é‡‘ç‰Œã€é“œç‰Œå¯é€‰é›†åˆ&lt;/mark&gt;ã€‚å¼ºè¡Œè®©é‡‘ç‰Œæœ€åä¸€å &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„è·¯ç¨‹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\min\{dis_{u,i}\}\)&lt;/span&gt;ï¼Œæœ€å°è·¯ç¨‹å°äºè¿™ä¸ªå€¼çš„æ‰€æœ‰å…ƒç´ éƒ½å¯ä»¥æˆä¸ºé‡‘ç‰Œï¼›åŒæ—¶è®©é“œç‰Œç¬¬ä¸€å &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„è·¯ç¨‹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\max\{dis_{v,i}\}\)&lt;/span&gt;ï¼Œæœ€å¤§è·¯ç¨‹å¤§äºè¿™ä¸ªå€¼çš„æ‰€æœ‰æ•°éƒ½å¯ä»¥æˆä¸ºé“œç‰Œã€‚&lt;/p&gt;
&lt;p&gt;Q1: å¦‚æœå­˜åœ¨ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå®ƒæœ€å°çš„è·ç¦»ä¹Ÿæ¯” &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„æœ€å°è·ç¦»å¤§ï¼Œä½†å®é™…ä¸Šå½“ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; æ›´å¤§ä¸€ç‚¹å„¿çš„æ—¶å€™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯ä»¥æˆä¸ºé‡‘ç‰Œå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;A1ï¼šè¿™ç§æƒ…å†µåœ¨é’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ºæœ€åä¸€åçš„æ—¶å€™è®¨è®ºè¿‡äº†ã€‚&lt;/p&gt;
&lt;p&gt;Q2ï¼šæ˜¯å¦ä¼šç®—é‡ï¼Ÿ&lt;/p&gt;
&lt;p&gt;A2ï¼šå¦‚ä¸Šæ‰€è¿°ï¼Œå‡å¦‚åœ¨é’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ—¶å€™ç»Ÿè®¡äº† &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåœ¨é’¦å®š &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„æ—¶å€™å°±ä¸ä¼šç»Ÿè®¡ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘è½¬ç§»ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,u,v,j,k}\)&lt;/span&gt; ä¸ºè€ƒè™‘åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œé‡‘ç‰Œå€’ä¸€ä¸º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œé“œç‰Œç¬¬ä¸€ä¸º &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼Œé€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªé‡‘ã€&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªé“œçš„æ–¹æ¡ˆæ•°ã€‚è½¬ç§»æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;æ³¨æ„ &lt;code&gt;vector&lt;/code&gt; è¦å¼€åœ¨å¾ªç¯å¤–é¢ï¼Œä¸ç„¶ç”³è¯·ç©ºé—´å¾ˆè€—æ—¶é—´ /ll&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1, inf));
    for (int x, y; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        std::cin &amp;gt;&amp;gt; g[x][y], g[y][x] = g[x][y];
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        g[i][i] = 0;
    for (int k = 1; k &amp;lt;= n; ++k)
        for (int i = 1; i &amp;lt;= n; ++i)
            if (k != i)
                for (int j = 1; j &amp;lt;= n; ++j)
                    if (i != k &amp;amp;&amp;amp; j != k)
                        g[i][j] = std::min(g[i][j], g[i][k] + g[k][j]);
    int g1, g2, s1, s2;
    std::cin &amp;gt;&amp;gt; g1 &amp;gt;&amp;gt; g2 &amp;gt;&amp;gt; s1 &amp;gt;&amp;gt; s2;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 1; j &amp;lt;= n; ++j)
            if (g[i][j] != inf)
                g[i][j] = g[i][j] * n + i;
    std::vector&amp;lt;int&amp;gt; mx(n + 1), mn(n + 1, inf);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (int j = 1; j &amp;lt;= n; ++j)
            if (j != i)
                mn[i] = std::min(mn[i], g[i][j]);
        mx[i] = *std::max_element(g[i].begin() + 1, g[i].end());
    &amp;#125;
    auto res(0ll);
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; (n + 1, std::vector&amp;lt;long long&amp;gt; (n + 1)));
    for (int u = 1; u &amp;lt;= n; ++u)
        for (int v = 1; v &amp;lt;= n; ++v)
            if (v != u) &amp;#123;
                f[0][1][1] = 1ll;
                for (int i = 1; i &amp;lt;= n; ++i)
                    if (i == u || i == v)
                        f[i] = f[i - 1];
                    else &amp;#123;
                        bool flag = 0;
                        for (int j = 1; j &amp;lt;= n; ++j)
                            if (mn[u] &amp;lt; g[i][j] &amp;amp;&amp;amp; g[i][j] &amp;lt; mx[v]) &amp;#123;
                                flag = 1;
                                break;
                            &amp;#125;
                        for (int j = 1; j &amp;lt;= g2; ++j)
                            for (int k = 1; k &amp;lt;= n - g1 - s1; ++k) &amp;#123;
                                f[i][j][k] = 0ll;
                                if (mx[i] &amp;lt; mn[u])
                                    f[i][j][k] = f[i - 1][j - 1][k];
                                else if (mn[i] &amp;gt; mx[v])
                                    f[i][j][k] = f[i - 1][j][k - 1];
                                else &amp;#123;
                                    if (flag)
                                        f[i][j][k] = f[i - 1][j][k];
                                    if (mn[i] &amp;lt; mn[u])
                                        f[i][j][k] += f[i - 1][j - 1][k];
                                    if (mx[i] &amp;gt; mx[v])
                                        f[i][j][k] += f[i - 1][j][k - 1];
                                &amp;#125;
                            &amp;#125;
                    &amp;#125;
                for (int g = g1; g &amp;lt;= g2; ++g)
                    for (int s = s1; s &amp;lt;= s2; ++s)
                        res += f[n][g][n - g - s];
            &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;sorting-pancakes&#34;&gt;7. Sorting Pancakes&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/1675/problem/G&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/1675/problem/G&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šç›’å­ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; å’Œæ¯ä¸ªç›’å­ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; é‡Œçš„åˆå§‹çƒæ•° &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œæ¯æ¬¡å¯ä»¥é€‰æ‹©ä¸€ä¸ªçƒç§»åŠ¨åˆ°ç›¸é‚»ç›’å­ï¼Œæœ€åæ¬²ä½¿ç›’å­å†…çƒæ•°å•è°ƒä¸å‡,æ±‚æœ€å°ç§»çƒæ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,\sum a_i\le 250\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç®€å•é¢˜ï¼è¿™ç§ã€ç§»åŠ¨å…ƒç´ çš„é¢˜ã€ï¼Œä¼šè€ƒè™‘&lt;mark&gt;é’¦å®šæ¯ä¸ªå…ƒç´ æœ€ç»ˆçš„å€¼ï¼ŒæŠŠå‰é¢çš„å…ƒç´ å¯Œä½™çš„ / æ¬ ä¸‹æ¥çš„å­˜å‚¨èµ·æ¥&lt;/mark&gt;ã€‚&lt;em&gt;å½“ç„¶ä¹Ÿæœ‰ä¾‹å¤–ï¼Œæ¯”å¦‚æ·»åŠ äº†ã€æ—¶é—´ã€è¿™ä¸€ç»´çš„é™åˆ¶ï¼Œgoto &lt;a href=&#34;http://localhost:4000/20250510/#a---pass-to-next&#34;&gt;solu to Pass to Next&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;åœ¨å¦‚æœåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„å¯Œä½™äº† &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåœ¨ç§»åŠ¨åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i+1\)&lt;/span&gt; çš„è¿‡ç¨‹ä¸­å°±ä¼šäº§ç”Ÿ &lt;span class=&#34;math inline&#34;&gt;\(|x|\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,k,j}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå…ƒç´ å¤„ï¼Œé’¦å®šå®ƒæœ€ç»ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œå¯Œä½™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,k,j}\gets \min\limits_{j&amp;#39;\ge j}\{f_{i-1, k-(j-a_i),j&amp;#39;}\}\)&lt;/span&gt;ã€‚æ˜¾è€Œæ˜“è§åç¼€ min ä¼˜åŒ–å°±èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(n\cdot m^2)\)&lt;/span&gt; åœ°åšäº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;DP æ•°ç»„å’Œåç¼€ min æ•°ç»„è¦åˆèµ·æ¥ï¼Œä¸ç„¶ä¼š MLE /ll&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    using arr = std::vector&amp;lt;int&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    crr f(n + 1, brr(2 * m + 1, arr(m + 1, inf)));
    std::fill(f[0][m].begin(), f[0][m].begin() + m + 1, 0);
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int k = 0; k &amp;lt;= 2 * m; ++k)
            for (int j = std::min(m, k + a[i]); j &amp;gt;= std::max(0, k + a[i] - 2 * m); --j) &amp;#123;
                f[i][k][j] = f[i - 1][k - (j - a[i])][j] + std::abs(k - m);
                if (j != m)
                    f[i][k][j] = std::min(f[i][k][j], f[i][k][j + 1]);
            &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n][m][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;complexity&#34;&gt;8. Complexity&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/agc033/tasks/agc033_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/agc033/tasks/agc033_d&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(01\)&lt;/span&gt; çŸ©é˜µã€‚å®šä¹‰å…¶å­çŸ©é˜µçš„å‡Œä¹±åº¦ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥è¯¥çŸ©é˜µä¸­åªæœ‰ä¸€ç§å€¼ï¼Œå‡Œä¹±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œä»»æ„ç«–ç›´ / æ°´å¹³åˆ‡ä¸€åˆ€ï¼Œå¾—åˆ°ä¸¤ä¸ªå°çŸ©é˜µï¼›è‹¥å®ƒä»¬çš„å‡Œä¹±åº¦åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt;ï¼Œåˆ™å¤§çŸ©é˜µçš„å‡Œä¹±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\max(a,b)+1\)&lt;/span&gt; çš„æœ€å°å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ±‚ç»™å®šçŸ©é˜µçš„å‡Œä¹±åº¦ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n,m\le 185\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœæš´åŠ›æšä¸¾ DPï¼Œå¾ˆä¸å¹¸æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n^5\)&lt;/span&gt; çš„ã€‚è€ƒè™‘ä¼˜åŒ–ã€‚å‘ç°çŸ©é˜µçš„å‡Œä¹±åº¦å¤§è‡´åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(\log n)\)&lt;/span&gt; çº§åˆ«ï¼Œè€ƒè™‘ç”¨&lt;mark&gt;çŠ¶æ€äº¤æ¢ç­”æ¡ˆ&lt;/mark&gt;å‡å°å¤æ‚åº¦ã€‚å…·ä½“åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{k,u,d,l}\)&lt;/span&gt; è¡¨ç¤ºå‡Œä¹±åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\le k\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¯å–åˆ°çš„æœ€å¤§å€¼ï¼Œé‚£ä¹ˆæœ‰è½¬ç§»ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç«–ç€åˆ‡ä¸€åˆ€ï¼Œæšä¸¾åˆ‡ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\le f_{k-1,u,d,l}\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{k,u,d,l}\gets f_{k-1,u,d,i+1}\)&lt;/span&gt;ã€‚å‘ç°æ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å– &lt;span class=&#34;math inline&#34;&gt;\(f_{k-1,u,d,l}\)&lt;/span&gt; çš„æ—¶å€™æœ€ä¼˜ï¼Œè¿™ä¸ªæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; çš„ã€‚&lt;/li&gt;
&lt;li&gt;æ¨ªç€åˆ‡ä¸€åˆ€ï¼Œæšä¸¾åˆ‡ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\in[u,d)\)&lt;/span&gt;ï¼Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{k,u,d,l}\gets \min(f_{k-1,u,i,l},f_{k-1,i+1,d,l})\)&lt;/span&gt;ã€‚å‘ç°éš &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¢å¤§å·¦è¾¹å•è°ƒä¸å¢ï¼Œå³è¾¹å•è°ƒä¸é™ã€‚éšç€ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„å¢å¤§ï¼Œå·¦è¾¹ä¸å˜ï¼Œå³è¾¹ä¸‹ç§»ï¼Œäº¤å‡ºæ¥çš„äº¤ç‚¹ä¸€ç›´å³ç§»ã€‚ç„¶åå°±å¯ä»¥ä¼˜åŒ–åˆ°å‡æ‘Š &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::vector&amp;lt;char&amp;gt; &amp;gt; a(n + 1, std::vector&amp;lt;char&amp;gt; (m + 1));
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 1; j &amp;lt;= m; ++j)
            std::cin &amp;gt;&amp;gt; a[i][j];
    using arr = std::vector&amp;lt;int&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    std::vector&amp;lt;std::string&amp;gt; res;
    std::vector&amp;lt;crr&amp;gt; _f(2, crr(n + 1, brr(m + 1, arr(n + 1))));
    for (int k = 0; ; ++k) &amp;#123;
        auto &amp;amp;f = _f[k &amp;amp; 1], &amp;amp;f1 = _f[(k &amp;amp; 1) ^ 1];
        if (k == 0) &amp;#123;
            crr tag(m + 1, brr(n + 1, arr(n + 1, -1)));
            for (int l = 1; l &amp;lt;= m; ++l)
                for (int u = 1; u &amp;lt;= n; ++u)
                    for (int d = u; d &amp;lt;= n &amp;amp;&amp;amp; a[d][l] == a[u][l]; ++d)
                        tag[l][u][d] = a[u][l];
            for (int u = 1; u &amp;lt;= n; ++u)
                for (int d = u; d &amp;lt;= n; ++d)
                    for (int l = m; l; --l) &amp;#123;
                        f[u][l][d] = l - 1;
                        if (~tag[l][u][d]) &amp;#123;
                            if (l != m &amp;amp;&amp;amp; tag[l][u][d] == tag[l + 1][u][d])
                                f[u][l][d] = f[u][l + 1][d];
                            else
                                f[u][l][d] = l;
                        &amp;#125;
                    &amp;#125;
        &amp;#125;
        else
            for (int u = 1; u &amp;lt;= n; ++u)
                for (int l = 1; l &amp;lt;= m; ++l)
                    for (int d = u, pos = 1; d &amp;lt;= n; ++d) &amp;#123;
                        f[u][l][d] = f1[u][l][d];
                        if (f[u][l][d] != m) &amp;#123;
                            f[u][l][d] = std::max(f[u][l][d], f1[u][f1[u][l][d] + 1][d]);
                            int mx = 0;
                            for (int i = pos; i &amp;lt; d; ++i) &amp;#123;
                                if (std::min(f1[u][l][i], f1[i + 1][l][d]) &amp;gt;= mx)
                                    mx = std::min(f1[u][l][i], f1[i + 1][l][d]), pos = i;
                                else
                                    break;
                            &amp;#125;
                            f[u][l][d] = std::max(f[u][l][d], mx);
                        &amp;#125;
                    &amp;#125;
        if (f[1][1][n] == m) &amp;#123;
            std::cout &amp;lt;&amp;lt; k &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            return 0;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;boxes-and-balls&#34;&gt;9. Boxes and Balls&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1845E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1845E&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(01\)&lt;/span&gt; åºåˆ— &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ã€‚ä½ å¯ä»¥è¿›è¡Œæ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡å¦‚ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€‰æ‹©åºåˆ—ä¸­ä¸€å¯¹ç›¸é‚»ä¸”å€¼ä¸åŒçš„å…ƒç´ ï¼Œå°†å®ƒä»¬äº¤æ¢ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é—®æœ‰å¤šå°‘ç§æœ€ç»ˆåºåˆ—ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n,k\le 1500\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ²¿ç”¨ &lt;a href=&#34;#sorting-pancakes&#34;&gt;7. Sorting Pancakes&lt;/a&gt; çš„æ€è·¯ï¼Œè€ƒè™‘ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,l}\)&lt;/span&gt; è¡¨ç¤ºæœ€ç»ˆåºåˆ—çš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªé‡Œæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œä»£ä»·å·²ç»æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼›é‚£ä¹ˆä»¤ &lt;span class=&#34;math inline&#34;&gt;\(s_i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å‰ç¼€å’Œï¼Œæ˜¾ç„¶æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i+1,j+1,k+|j-s_i|}\gets f_{i,j,k}\\
f_{i+1,j,k+|j-s_i|}\gets f_{i,j,k}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æœ€ååœ¨æ¯” &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å°ä¸”å¥‡å¶æ€§å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ç›¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; é‡Œæ‰¾ç­”æ¡ˆã€‚ç„¶åæƒ³æ€ä¹ˆä¼˜åŒ–ã€‚&lt;/p&gt;
&lt;p&gt;ç­”æ¡ˆæ˜¯ä¸ç”¨ä¼˜åŒ–ã€‚è€ƒè™‘&lt;mark&gt;æœ‰æ•ˆçŠ¶æ€æ•°&lt;/mark&gt;ï¼Œ&lt;del&gt;æ‰“ä¸ªè¡¨å‘ç°æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(n\sqrt n)\)&lt;/span&gt; å·¦å³&lt;/del&gt;ï¼Œä½†æœ‰å¦ä¸€ç§æ–¹æ³•æ˜¯å‘ç°æœ‰æ•ˆçš„ &lt;span class=&#34;math inline&#34;&gt;\(|j-s_i|\)&lt;/span&gt; ä¸ä¼šè¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n)\)&lt;/span&gt;ï¼ˆåŸå› ï¼šä¸ºäº†æ¶ˆé™¤ &lt;span class=&#34;math inline&#34;&gt;\(|j-s_i|\)&lt;/span&gt; çš„æ¬ è´¦ï¼Œéœ€è¦ &lt;span class=&#34;math inline&#34;&gt;\(|j-s_i|\)&lt;/span&gt; ä¸ªä½ç½®ï¼›æ¯ä¸ªä½ç½®éƒ½ä¼šæœ‰å·®ä¸å¤š &lt;span class=&#34;math inline&#34;&gt;\(|j-s_i|\)&lt;/span&gt; çš„ä»£ä»·ï¼‰ï¼Œæ‰€ä»¥æšä¸¾æ—¶åªç”¨æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n)\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€»ä¹‹åªç”¨å­˜æœ‰æ•ˆçŠ¶æ€ä¼šå‘ç°è·‘ä¸æ»¡ &lt;img src=&#34;/em/bb.gif&#34; /&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1), s(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::partial_sum(a.begin() + 1, a.end(), s.begin() + 1);
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    brr tag(n + 1, arr(n + 1));
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; stt(2);
    stt[0].emplace_back(0, 0);
    crr _f(2, brr(n + 1, arr(k + 1)));
    _f[0][0][0] = 1;
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        auto &amp;amp;f = _f[i &amp;amp; 1], &amp;amp;f1 = _f[(i &amp;amp; 1) ^ 1];
        std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt;().swap(stt[(i &amp;amp; 1) ^ 1]);
        for (auto [j, l] : stt[i &amp;amp; 1]) &amp;#123;
                if (j + 1 &amp;lt;= s[n] &amp;amp;&amp;amp; l + std::abs(j - s[i]) &amp;lt;= k) &amp;#123;
                    if (tag[j + 1][l + std::abs(j - s[i])] != i + 1)
                        tag[j + 1][l + std::abs(j - s[i])] = i + 1, stt[(i &amp;amp; 1) ^ 1].emplace_back(j + 1, l + std::abs(j - s[i])), f1[j + 1][l + std::abs(j - s[i])] = 0ll;
                    (f1[j + 1][l + std::abs(j - s[i])] += f[j][l]) %= mod;
                &amp;#125;
                if (l + std::abs(j - s[i]) &amp;lt;= k) &amp;#123;
                    if (tag[j][l + std::abs(j - s[i])] != i + 1)
                        tag[j][l + std::abs(j - s[i])] = i + 1, stt[(i &amp;amp; 1) ^ 1].emplace_back(j, l + std::abs(j - s[i])), f1[j][l + std::abs(j - s[i])] = 0ll;
                    (f1[j][l + std::abs(j - s[i])] += f[j][l]) %= mod;
                &amp;#125;
            &amp;#125;
        std::cout &amp;lt;&amp;lt; (int)stt[i &amp;amp; 1].size() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    auto res(0ll);
    for (int i = k &amp;amp; 1; i &amp;lt;= k; i += 2)
        if (tag[s[n]][i] == n)
            (res += _f[n &amp;amp; 1][s[n]][i]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;legondary-grandmaster&#34;&gt;10. LEGOndary Grandmaster&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1615/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1615/F&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(0/1/?\)&lt;/span&gt; ä¸² &lt;span class=&#34;math inline&#34;&gt;\(s,t\)&lt;/span&gt;ï¼Œä½ å¯ä»¥å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; è¿›è¡Œè‹¥å¹²æ¬¡å¦‚ä¸‹æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é€‰æ‹©åºåˆ—ä¸­ä¸€å¯¹ç›¸é‚»ä¸”å€¼ç›¸åŒçš„å…ƒç´ ï¼Œå°†å®ƒä»¬å–åã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç°ä»»æ„å°† &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸­çš„ &lt;code&gt;?&lt;/code&gt; å¡«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt;ï¼Œé—®æ‰€æœ‰æƒ…å†µä¸­ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; è½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; æ‰€éœ€æœ€å°æ“ä½œæ¬¡æ•°å’Œï¼ˆè§„å®šæ— è§£çš„æ“ä½œæ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼‰ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2000\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬ä¹‹å‰åšè¿‡æŸäº›ä»¤äººå¿ƒï¼ˆå’¬ï¼‰æ—·ï¼ˆç‰™ï¼‰ç¥ï¼ˆåˆ‡ï¼‰æ€¡ï¼ˆé½¿ï¼‰çš„é¢˜ç›®ï¼Œä¼šå‘ç°è¿™ä¸ªæ“ä½œç­‰ä»·äºäº¤æ¢ä»»æ„ä¸¤ä¸ªç›¸é‚»æ•°ï¼Œå†è®©ä»–ä»¬å–åã€‚&lt;/p&gt;
&lt;p&gt;è¿›ä¸€æ­¥åœ°ï¼Œå¯ä»¥äº¤æ¢è¿ç®—é¡ºåºï¼Œå…ˆå–åæŸä¸ªä½ç½®ï¼Œå†äº¤æ¢ï¼Œå†å–åè¿™ä¸ªä½ç½®â€”â€”æŠŠè¿™ä¸ªæ“ä½œå¹³å‡åˆ†é…åˆ° &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸Šï¼Œ&lt;mark&gt;ç»“åˆã€ç›¸é‚»ä¸¤æ•°ä½ç½®å¿…ä¸€å¥‡ä¸€å¶ã€è¿™ä¸ªç¾å¦™çš„æ€§è´¨ï¼Œæƒ³åˆ°æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„å¥‡æ•°ä½éƒ½æå‰å–åï¼Œè¿™æ ·å°±å¯ä»¥è½¬åŒ–æˆç›´æ¥äº¤æ¢äº†&lt;/mark&gt;ï¼Œ&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±å’Œä¸Šä¸€é¢˜æœ‰ç‚¹ä¸ä¸€æ ·äº†ã€‚è¿™é‡Œæˆ‘ä»¬ç›´æ¥ç®—ä¸€ä¸ªä½ç½®çš„è´¡çŒ®â€”â€”è¿™æ„å‘³ç€ä¸éœ€è¦ç»Ÿè®¡ä¸€ä¸ªåºåˆ—çš„ä»£ä»·ï¼ˆæ­¤æ—¶å¤±å»äº† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„é™åˆ¶ï¼Œä»£ä»·æ¥åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; çº§åˆ«ï¼‰ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºä»å‰å¾€ååˆ°äº†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªä½ç½®ï¼Œæ¬ å€ºä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼›åŒæ ·åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g_{i,j}\)&lt;/span&gt; è¡¨ç¤ºä»ååˆ°å‰åˆ°äº†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªä½ç½®ï¼Œæ¬ å€ºä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚åˆ™è´¡çŒ®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum_i \sum_j f_{i, j}\times g_{i + 1, -j}\times j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n;
        std::string s, t;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t, s = &amp;#39;#&amp;#39; + s, t = &amp;#39;#&amp;#39; + t;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (i &amp;amp; 1) &amp;#123;
                if (s[i] != &amp;#39;?&amp;#39;)
                    s[i] = &amp;#39;0&amp;#39; + &amp;#39;1&amp;#39; - s[i];
                if (t[i] != &amp;#39;?&amp;#39;)
                    t[i] = &amp;#39;0&amp;#39; + &amp;#39;1&amp;#39; - t[i];
            &amp;#125;
        using arr = std::vector&amp;lt;long long&amp;gt;;
        using brr = std::vector&amp;lt;arr&amp;gt;;
        brr f(n + 1, arr(2 * n + 1)), g(n + 2, arr(2 * n + 1));
        f[0][n] = 1ll;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            for (int S = 0; S &amp;lt;= 1; ++S)
                if ((S == 0 &amp;amp;&amp;amp; s[i] == &amp;#39;1&amp;#39;) || (S == 1 &amp;amp;&amp;amp; s[i] == &amp;#39;0&amp;#39;));
                else
                    for (int T = 0; T &amp;lt;= 1; ++T) &amp;#123;
                        if ((T == 0 &amp;amp;&amp;amp; t[i] == &amp;#39;1&amp;#39;) || (T == 1 &amp;amp;&amp;amp; t[i] == &amp;#39;0&amp;#39;));
                        else
                            for (int j = 0; j &amp;lt;= 2 * n; ++j)
                                if (j - (T - S) &amp;gt;= 0 &amp;amp;&amp;amp; j - (T - S) &amp;lt;= 2 * n)
                                    (f[i][j] += f[i - 1][j - (T - S)]) %= mod;
                    &amp;#125;
        &amp;#125;
        g[n + 1][n] = 1ll;
        for (int i = n; i; --i) &amp;#123;
            for (int S = 0; S &amp;lt;= 1; ++S)
                if ((S == 0 &amp;amp;&amp;amp; s[i] == &amp;#39;1&amp;#39;) || (S == 1 &amp;amp;&amp;amp; s[i] == &amp;#39;0&amp;#39;));
                else
                    for (int T = 0; T &amp;lt;= 1; ++T) &amp;#123;
                        if ((T == 0 &amp;amp;&amp;amp; t[i] == &amp;#39;1&amp;#39;) || (T == 1 &amp;amp;&amp;amp; t[i] == &amp;#39;0&amp;#39;));
                        else
                            for (int j = 0; j &amp;lt;= 2 * n; ++j)
                                if (j - (T - S) &amp;gt;= 0 &amp;amp;&amp;amp; j - (T - S) &amp;lt;= 2 * n)
                                    (g[i][j] += g[i + 1][j - (T - S)]) %= mod;
                    &amp;#125;
        &amp;#125;
        auto res(0ll);
        for (int i = 1; i &amp;lt; n; ++i)
            for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
                (res += j * f[i][n + j] % mod * g[i + 1][n - j] % mod) %= mod;
                (res += j * f[i][n - j] % mod * g[i + 1][n + j] % mod) %= mod;
            &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <updated>2024-09-06T07:30:38.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20240501/</id>
        <title>äº”ä¸€æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20240501/"/>
        <content type="html">&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5169&#34;&gt;SAM æ‚é¢˜&lt;/a&gt; + &lt;a href=&#34;https://www.becoder.com.cn/contest/5170&#34;&gt;NOIPS8&lt;/a&gt; + &lt;a href=&#34;https://www.becoder.com.cn/contest/5175&#34;&gt;å‘¨è€ƒ&lt;/a&gt; é€‰è®²ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹çœ‹è¿™ä¸ªæ ‡ç­¾åˆ—è¡¨é•¿åº¦å°±çŸ¥é“è¿™ä¸‰å¤©åšçš„é¢˜æœ‰å¤šæ‚ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;d.-å­—ç¬¦ä¸²&#34;&gt;D. å­—ç¬¦ä¸²&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5169/problem/4&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/5169/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’Œ SA çš„åšæ³•ä¸€æ ·ï¼Œå…ˆäºŒåˆ† &lt;span class=&#34;math inline&#34;&gt;\(s_{c\sim d}\)&lt;/span&gt; çš„å‰ç¼€é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(mid\)&lt;/span&gt;ï¼Œåªéœ€ check &lt;span class=&#34;math inline&#34;&gt;\(s_{c \sim c + mid - 1}\)&lt;/span&gt; æ˜¯å¦åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(s_{a\sim b}\)&lt;/span&gt; ä¸­å‡ºç°è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ€ä¹ˆå¿«é€Ÿ checkã€‚ä» &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸€æ­¥ä¸€æ­¥è·³åˆ° &lt;span class=&#34;math inline&#34;&gt;\(c+mid-1\)&lt;/span&gt; æ˜¾ç„¶ä¼šèµ·é£ï¼Œè€ƒè™‘åˆ°æŸ¥è¯¢æ˜¯é™æ€çš„ï¼Œæˆ‘ä»¬äº‹å…ˆé¢„å¤„ç†ä¸€ä¸‹ç„¶åå€å¢åœ°è·³å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶åªéœ€çœ‹å½“å‰çŠ¶æ€çš„ &lt;span class=&#34;math inline&#34;&gt;\(\text {endpos}\)&lt;/span&gt; æ˜¯å¦åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([a + mid - 1, b]\)&lt;/span&gt; å‡ºç°è¿‡ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºè¿™ä¸ªä¸èƒ½ç”¨æœ€å¤§æœ€å°ç®€å•ä»£æ›¿ï¼Œæ‰€ä»¥å°±åˆ°äº†æˆ‘ä»¬å–œé—»ä¹è§çš„çº¿æ®µæ ‘åˆå¹¶ç¯èŠ‚ã€‚å°†æ’å…¥åçš„æ¯ä¸ªå•ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(\text {endpos}\)&lt;/span&gt; åœ¨æƒå€¼çº¿æ®µæ ‘ä¸Šæ›´æ–°ï¼Œåœ¨ parent tree ä¸Šæš´åŠ›çº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¹‹å‰ä¸€ç›´æœ‰ä¸€ä¸ªè¯¯åŒºï¼Œå°±æ˜¯è§‰å¾—çº¿æ®µæ ‘åˆå¹¶æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œæ¯”å¦‚ç”¨ A æ ‘å’Œ B æ ‘å¹¶å‡ºæ¥äº† C æ ‘ä¹‹åï¼ŒA æ ‘å’Œ B æ ‘çš„æ•°æ®å°±æ— æ•ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¿™æ˜¾ç„¶æ˜¯å¾ˆè’è°¬çš„ï¼ŒåŒæ ·å› ä¸ºæˆ‘ä»¬çš„æŸ¥è¯¢æ˜¯é™æ€çš„ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ç”¨ä¸€ç§ç±»ä¼¼äºå¯æŒä¹…åŒ–çš„æ–¹å¼ï¼Œå»ºç«‹ä¸€äº›æ–°çš„ç‚¹è¡¨ç¤ºåˆå¹¶åçš„ä¿¡æ¯çŠ¶æ€ç‚¹ï¼Œä¸€äº›å¯ä»¥ä¿ç•™çš„ç‚¹å°±ä¿ç•™ä½œå„¿å­ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å¯¹åº”çš„çŠ¶æ€ä¸ŠæŸ¥è¯¢å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxm = 35;
const int maxn = 6e5 + 5;
const int maxk = 8e7 + 5;
struct _ &amp;#123;
    int l, f;
    int ne[maxm]; 
    _() &amp;#123;&amp;#125;
    _(int l1, int f1): l(l1), f(f1) &amp;#123;&amp;#125;
&amp;#125;;
_ t[maxn &amp;lt;&amp;lt; 1];
int vis[maxn &amp;lt;&amp;lt; 1];
int fa[maxn][maxm];
int n, la, tot, siz;
struct &amp;#123; int l, r, u; &amp;#125; t1[maxk];
int tab[maxn &amp;lt;&amp;lt; 1], cnt[maxn &amp;lt;&amp;lt; 1];
void Init(void) &amp;#123;
    la = tot = 1;
    t[1] = _(0, 0);
    return;
&amp;#125;
void ext(int c) &amp;#123;
    int p = la, np = ++tot;
    la = tot;
    t[np] = _(t[p].l + 1, 0);
    while (p &amp;amp;&amp;amp; !t[p].ne[c])
        t[p].ne[c] = np, p = t[p].f;
    if (!p)
        t[np].f = 1;
    else &amp;#123;
        int q = t[p].ne[c];
        if (t[q].l == t[p].l + 1)
            t[np].f = q;
        else &amp;#123;
            int nq = ++tot;
            t[nq] = _(t[p].l + 1, t[q].f);
            std::copy(t[q].ne, t[q].ne + 26, t[nq].ne);
            while (p &amp;amp;&amp;amp; t[p].ne[c] == q)
                t[p].ne[c] = nq, p = t[p].f;
            t[q].f = nq;
            t[np].f = nq;
        &amp;#125;
    &amp;#125;
    return;
&amp;#125;
int now = 0;
void ins(int &amp;amp;p, int l, int r, int v) &amp;#123;
    if (!p)
        p = ++now;
    ++t1[p].u;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (v &amp;lt;= mid)
        ins(t1[p].l, l, mid, v);
    else
        ins(t1[p].r, mid + 1, r, v);
    return;
&amp;#125;
int ask(int p, int l, int r, int ql, int qr) &amp;#123;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr)
        return t1[p].u;
    int mid = (l + r) &amp;gt;&amp;gt; 1, res = 0;
    if (ql &amp;lt;= mid)
        res = ask(t1[p].l, l, mid, ql, qr);
    if (qr &amp;gt; mid)
        res += ask(t1[p].r, mid + 1, r, ql, qr);
    return res;
&amp;#125;
int merge(int p, int q, int l, int r) &amp;#123;
    if (!p || !q)
        return p + q;
    int np = ++now, mid = (l + r) &amp;gt;&amp;gt; 1;
    t1[np].u = t1[p].u + t1[q].u;
    if (l == r) return np;
    t1[np].l = merge(t1[p].l, t1[q].l, l, mid);
    t1[np].r = merge(t1[p].r, t1[q].r, mid + 1, r);
    return np;
&amp;#125;
int pos[maxn], rt[maxn &amp;lt;&amp;lt; 1];
bool check(int x, int a, int b, int c, int d) &amp;#123;
    assert(c + x - 1 &amp;gt;= 0);
    int p = pos[c + x - 1];
    for (int i = siz; ~i; --i)
        if (fa[p][i] &amp;amp;&amp;amp; t[fa[p][i]].l &amp;gt;= x)
            p = fa[p][i];
    return ask(rt[p], 0, n - 1, a + x - 1, b) &amp;gt; 0;
&amp;#125;
int solve(int a, int b, int c, int d) &amp;#123;
    int l = 1, r = std::min(d - c + 1, b - a + 1), res = 0;
    while (l &amp;lt;= r) &amp;#123;
        int mid = (l + r) &amp;gt;&amp;gt; 1;
        if (check(mid, a, b, c, d))
            l = mid + 1, res = mid;
        else
            r = mid - 1;
    &amp;#125;
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#endif
    int m;
    std::string s;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; s;
    Init();
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        ext(s[i] - &amp;#39;a&amp;#39;);
        pos[i] = la;
        ins(rt[la], 0, n - 1, i);
    &amp;#125;
    siz = log(tot) / log(2.0);
    for (int i = 1; i &amp;lt;= tot; ++i)
        ++cnt[t[i].l];
    std::partial_sum(cnt + 1, cnt + tot + 1, cnt + 1);
    for (int i = 1; i &amp;lt;= tot; ++i)
        tab[cnt[t[i].l]--] = i;
    for (int i = 1; i &amp;lt;= tot; ++i) &amp;#123;
        int u = tab[i];
        fa[u][0] = t[u].f;
        for (int j = 1; j &amp;lt;= siz; ++j)
            fa[u][j] = fa[fa[u][j - 1]][j - 1];
    &amp;#125;
    for (int i = tot; i; --i) &amp;#123;
        int u = tab[i];
        if (t[u].f)
            rt[t[u].f] = merge(rt[t[u].f], rt[u], 0, n - 1);
    &amp;#125;
    while (m--) &amp;#123;
        int a, b, c, d;
        std::cin &amp;gt;&amp;gt; a &amp;gt;&amp;gt; b &amp;gt;&amp;gt; c &amp;gt;&amp;gt; d;
        std::cout &amp;lt;&amp;lt; solve(a - 1, b - 1, c - 1, d - 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;f.-security&#34;&gt;F. Security&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5169/problem/6&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/5169/problem/6&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹æˆ‘ä»¬æ¥è¯´åº”è¯¥æ˜¯ä¼š D å°±ä¼š F çš„ã€‚æ‰€ä»¥åªæ‰“äº† 10minã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå¤§å®¶å–œé—»ä¹è§çš„ DFS æ±‚æœ€å°å­—å…¸åºã€‚æ˜¾ç„¶åœ°ï¼Œå¦‚æœå­˜åœ¨å’Œå½“å‰ä½ç›¸ç­‰çš„å­—ç¬¦ï¼Œé‚£ä¹ˆä¼˜å…ˆè·³ç›¸ç­‰å­—ç¬¦ï¼Œè¿›å…¥ä¸‹ä¸€å±‚æ·±æœï¼›å¦åˆ™æ‰¾åˆ°æœ€å°çš„æ›´å¤§å­—ç¬¦ï¼Œç„¶åç›´æ¥ outã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶ SAM å°±æ˜¯æˆ‘ä»¬ç”¨æ¥åˆ¤æ–­ &lt;span class=&#34;math inline&#34;&gt;\(S_{l, r}\)&lt;/span&gt; ä¸­æ˜¯å¦å­˜åœ¨æŸçŠ¶æ€çš„å·¥å…·äº†ã€‚ç”šè‡³æ¯”ä¸Šä¸€é¢˜ç®€å•ï¼Œå› ä¸ºä¸ç”¨å†™äºŒåˆ†å’Œå€å¢ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(S_{l, r}\)&lt;/span&gt; åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; é‚£ä¹ˆè¿˜è¦åœ¨åé¢éšä¾¿åŠ ä¸€ä¸ªå­—ç¬¦ä»¥å­—å…¸åºä¿è¯ä¸¥æ ¼å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯å› ä¸ºæˆ‘å†™çš„å¤ªä¸‘äº†ä»¥è‡³äºåœ¨ CF ä¸Šä¼šå…‰è£ MLE #46ã€‚ç„¶ååˆ†å±å·¦åŠè¾¹çœ‹æˆ‘ä»£ç å³åŠè¾¹å†™çš„ zwb å´æ²¡æœ‰ã€‚å•§ã€‚ä¸ºä»€ä¹ˆå‘¢ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxm = 35;
const int maxn = 6e5 + 5;
const int maxk = 8e7 + 5;
struct _ &amp;#123;
    int l, f;
    int ne[maxm]; 
    _() &amp;#123;&amp;#125;
    _(int l1, int f1): l(l1), f(f1) &amp;#123;&amp;#125;
&amp;#125;;
_ t[maxn &amp;lt;&amp;lt; 1];
int vis[maxn &amp;lt;&amp;lt; 1];
int fa[maxn][maxm];
int n, la, tot, siz;
struct &amp;#123; int l, r, u; &amp;#125; t1[maxk];
int tab[maxn &amp;lt;&amp;lt; 1], cnt[maxn &amp;lt;&amp;lt; 1];
void Init(void) &amp;#123;
    la = tot = 1;
    t[1] = _(0, 0);
    return;
&amp;#125;
void ext(int c) &amp;#123;
    int p = la, np = ++tot;
    la = tot;
    t[np] = _(t[p].l + 1, 0);
    while (p &amp;amp;&amp;amp; !t[p].ne[c])
        t[p].ne[c] = np, p = t[p].f;
    if (!p)
        t[np].f = 1;
    else &amp;#123;
        int q = t[p].ne[c];
        if (t[q].l == t[p].l + 1)
            t[np].f = q;
        else &amp;#123;
            int nq = ++tot;
            t[nq] = _(t[p].l + 1, t[q].f);
            std::copy(t[q].ne, t[q].ne + 26, t[nq].ne);
            while (p &amp;amp;&amp;amp; t[p].ne[c] == q)
                t[p].ne[c] = nq, p = t[p].f;
            t[q].f = nq;
            t[np].f = nq;
        &amp;#125;
    &amp;#125;
    return;
&amp;#125;
int now = 0;
void ins(int &amp;amp;p, int l, int r, int v) &amp;#123;
    if (!p)
        p = ++now;
    ++t1[p].u;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (v &amp;lt;= mid)
        ins(t1[p].l, l, mid, v);
    else
        ins(t1[p].r, mid + 1, r, v);
    return;
&amp;#125;
int ask(int p, int l, int r, int ql, int qr) &amp;#123;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr)
        return t1[p].u;
    int mid = (l + r) &amp;gt;&amp;gt; 1, res = 0;
    if (ql &amp;lt;= mid)
        res = ask(t1[p].l, l, mid, ql, qr);
    if (qr &amp;gt; mid)
        res += ask(t1[p].r, mid + 1, r, ql, qr);
    return res;
&amp;#125;
int merge(int p, int q, int l, int r) &amp;#123;
    if (!p || !q)
        return p + q;
    int np = ++now, mid = (l + r) &amp;gt;&amp;gt; 1;
    t1[np].u = t1[p].u + t1[q].u;
    if (l == r) return np;
    t1[np].l = merge(t1[p].l, t1[q].l, l, mid);
    t1[np].r = merge(t1[p].r, t1[q].r, mid + 1, r);
    return np;
&amp;#125;
int pos[maxn], rt[maxn &amp;lt;&amp;lt; 1];
bool check(int p, int ch, int l, int r) &amp;#123;
    return ask(rt[t[p].ne[ch]], 0, n - 1, l, r) &amp;gt; 0;
&amp;#125;
bool fun(std::string &amp;amp;res, std::string now, std::string &amp;amp;t, int x, int p, int l, int r) &amp;#123;
    // std::cout &amp;lt;&amp;lt; &amp;quot;x = &amp;quot; &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &amp;quot;, now = \&amp;quot;&amp;quot; &amp;lt;&amp;lt; now &amp;lt;&amp;lt; &amp;quot;\&amp;quot;;\n&amp;quot;;
    if (x != (int)t.length() &amp;amp;&amp;amp; check(p, t[x] - &amp;#39;a&amp;#39;, l + x, r) &amp;amp;&amp;amp; fun(res, now + t[x], t, x + 1, ::t[p].ne[t[x] - &amp;#39;a&amp;#39;], l, r))
        return 1;
    for (int i = (x == (int)t.length()) ? 0 : t[x] - &amp;#39;a&amp;#39; + 1; i &amp;lt; 26; ++i) &amp;#123;
        if (check(p, i, l + x, r)) &amp;#123;
            now += i + &amp;#39;a&amp;#39;;
            res = now;
            return 1;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;
std::string solve(std::string &amp;amp;t, int l, int r) &amp;#123;
    std::string res;
    return fun(res, &amp;quot;&amp;quot;, t, 0, 1, l, r) ? res : &amp;quot;-1&amp;quot;;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#endif
    int q;
    std::string s;
    std::cin &amp;gt;&amp;gt; s &amp;gt;&amp;gt; q;
    n = (int)s.length();
    Init();
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        ext(s[i] - &amp;#39;a&amp;#39;);
        pos[i] = la;
        ins(rt[la], 0, n - 1, i);
    &amp;#125;
    siz = log(tot) / log(2.0);
    for (int i = 1; i &amp;lt;= tot; ++i)
        ++cnt[t[i].l];
    std::partial_sum(cnt + 1, cnt + tot + 1, cnt + 1);
    for (int i = 1; i &amp;lt;= tot; ++i)
        tab[cnt[t[i].l]--] = i;
    for (int i = 1; i &amp;lt;= tot; ++i) &amp;#123;
        int u = tab[i];
        fa[u][0] = t[u].f;
        for (int j = 1; j &amp;lt;= siz; ++j)
            fa[u][j] = fa[fa[u][j - 1]][j - 1];
    &amp;#125;
    for (int i = tot; i; --i) &amp;#123;
        int u = tab[i];
        if (t[u].f)
            rt[t[u].f] = merge(rt[t[u].f], rt[u], 0, n - 1);
    &amp;#125;
    while (q--) &amp;#123;
        int l, r;
        std::string t;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r &amp;gt;&amp;gt; t;
        std::cout &amp;lt;&amp;lt; solve(t, l - 1, r - 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;a.-å…­å‡ºç¥å±±&#34;&gt;A. å…­å‡ºç¥å±±&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5170/problem/1&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/5170/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ˜¯èƒ½ç”¨è´ªå¿ƒæ‹¿ 60pts çš„ DP é¢˜ /tuu&lt;/p&gt;
&lt;p&gt;éœ€è¦å…ˆæŠŠæš´åŠ›çš„å¼å­å†™å‡ºæ¥ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j}\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å±±ä¿®æ”¹é«˜åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„ä»£ä»·ï¼Œåˆ™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i, j} = \min\limits_{k\in [j-d, j+d]}\left\{f_{i-1, k}\right\} + |h_i - j|
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°å¯ä»¥å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚ä½†æ˜¯è¿™æ ·åšå¤æ‚åº¦è¿˜æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(nV)\)&lt;/span&gt; çš„ï¼Œæ ¹æœ¬åŸå› åœ¨äºç¬¬äºŒç»´è¿™ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt; çš„çŠ¶æ€æ•°å¤ªå¤šäº†ã€‚&lt;/p&gt;
&lt;p&gt;æ ¹æ®ç›´è§‰ï¼Œæœ€å &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å€¼åº”ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k+d\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(k-d\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œåˆæ³•çš„çŠ¶æ€æ•°ä¸ºæ‰€æœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_i+x\times d, x\in[-n, n]\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;æ­£ç¡®æ€§è¯æ˜â€¦â€¦&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å…¨éƒ¨æ›´æ”¹å®Œåçš„ç»“æŸçŠ¶æ€ï¼Œå³æœ€åçš„æœ€ä¼˜çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ‰€æœ‰å±±ä¸­æœ€çŸ®çš„å±± &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæ­¤å±±çš„é«˜åº¦è¦ä¹ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(h_i\)&lt;/span&gt;ï¼Œè¦ä¹ˆä¸ºå‰ä¸€åº§å±±çš„é«˜åº¦ &lt;span class=&#34;math inline&#34;&gt;\(-d\)&lt;/span&gt;ï¼Œè¦ä¹ˆä¸ºåä¸€åº§å±±çš„é«˜åº¦ &lt;span class=&#34;math inline&#34;&gt;\(-d\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ç¬¬äºŒçŸ®çš„å±±ï¼Œä»¥æ­¤ç±»æ¨å³å¯ã€‚&lt;/p&gt;
&lt;/details&gt;
&lt;p&gt;å°†ç¬¬äºŒç»´çš„çŠ¶æ€é›†å¤§å°å‡å°‘ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^3)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;éœ€æ³¨æ„åˆ°å› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a_i+x\times d\)&lt;/span&gt; ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; èŒƒå›´ä¸º &lt;span class=&#34;math inline&#34;&gt;\([-n, n]\)&lt;/span&gt; å…± &lt;span class=&#34;math inline&#34;&gt;\(2\times n\)&lt;/span&gt;ï¼Œæ‰€ä»¥ DP æ•°ç»„ç¬¬äºŒç»´å¤§å°ä¸€å®šè¦å¼€ &lt;span class=&#34;math inline&#34;&gt;\(2\times n^2\)&lt;/span&gt; å‘€ï¼ï¼ï¼&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
using ll = long long;
const int maxn = 305;
const int maxm = 18e4 + 5;
const ll inf = 0x3f3f3f3f3f3f3f3f;
ll d;
int n;
ll h[maxn];
ll f[maxn][maxm];
int main() &amp;#123;
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
    memset(f, 0x3f, sizeof (f));
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; d;
    std::vector&amp;lt;ll&amp;gt; st;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; h[i];
        for (ll j = -n; j &amp;lt;= n; ++j)
            st.push_back(h[i] + j * d);
    &amp;#125;
    std::sort(st.begin(), st.end());
    st.erase(std::unique(st.begin(), st.end()), st.end());
    auto abs = [&amp;amp;](ll x) -&amp;gt; ll &amp;#123; return x &amp;gt;= 0 ? x : -x; &amp;#125;;
    f[1][lower_bound(st.begin(), st.end(), h[1]) - st.begin()] = 0;
    for (int i = 2; i &amp;lt;= n; ++i) &amp;#123;
        int h(1), t(0), p(-1);
        static int q[maxm];
        for (int j = 0; j &amp;lt; (int)st.size(); ++j) &amp;#123;
            while (p &amp;lt; (int)st.size() &amp;amp;&amp;amp; st[p + 1] &amp;lt;= st[j] + d) &amp;#123;
                ++p;
                while (h &amp;lt;= t &amp;amp;&amp;amp; f[i - 1][p] &amp;lt;= f[i - 1][q[t]])
                    --t;
                q[++t] = p;
            &amp;#125;
            while (h &amp;lt;= t &amp;amp;&amp;amp; st[q[h]] &amp;lt; st[j] - d)
                ++h;
            if (h &amp;lt;= t)
                f[i][j] = std::min(inf, f[i - 1][q[h]] + abs(st[j] - ::h[i]));
        &amp;#125;
    &amp;#125;
    ll res = f[n][std::lower_bound(st.begin(), st.end(), h[n]) - st.begin()];
    std::cout &amp;lt;&amp;lt; (res == inf ? -1 : res) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;b.-æ°´æ·¹ä¸ƒå†›&#34;&gt;B. æ°´æ·¹ä¸ƒå†›&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5170/problem/2&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/5170/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°æœ€åè¿å‡ºæ¥ä¸€å®šæ˜¯æ²¡æœ‰ç¯çš„ã€‚æ‰€ä»¥ä¸€å®šæ˜¯ä¸€ä¸ª DAGã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“çŠ¶æ€å‹ç¼©æ˜¯ä¼šéå†åˆ°æ¯ä¸€ç§æƒ…å†µçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‡è®¾å½“å‰çš„ DAG å°±æ˜¯è¯¥çŠ¶æ€ä¸‹çš„æœ€ä¼˜ã€‚&lt;/p&gt;
&lt;p&gt;è‡³äºè¿™ä¸ªã€Œæœ€ä¼˜ã€å¦‚ä½•å®šä¹‰å°±è¦äº¤ç»™æˆ‘ä»¬äº†ã€‚æˆ‘ä»¬ä¸å¦¨å¼ºåˆ¶è®¤ä¸ºè¿™ä¸ª DAG æ˜¯æŒ‰å±‚åºéå†å¾—åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿ç»­éå†åˆ°çš„ç‚¹å±äºåŒä¸€å±‚ï¼ˆè¿™é‡Œçš„å±‚æ˜¯æŒ‡æŸç‚¹åˆ°ä»»æ„æºç‚¹çš„æœ€é•¿è·¯é•¿åº¦ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶åªæœ‰ä¸€ç»„ç›¸äº’ä¹‹é—´æ²¡æœ‰ä»»ä½•è¿è¾¹çš„ç‚¹æ‰èƒ½ç»„æˆåŒä¸€å±‚ã€‚ä¸å¦¨æšä¸¾ç‚¹é›†ç„¶åæš´åŠ›è½¬ç§»ï¼Œè½¬ç§»æ—¶è®°å½•è·¯å¾„å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;æ³¨æ„åˆ°åœ¨å†™è¿™ç©æ„å„¿çš„æ—¶å€™æˆ‘è¿˜ä¸ä¼š &lt;a href=&#34;/2024/05/17/20240517/&#34;&gt;çŠ¶å‹æšä¸¾å­é›†&lt;/a&gt;ï¼Œæ‰€ä»¥æšä¸¾å­é›†çš„éƒ¨åˆ†å¯èƒ½æ‰“å¾—æ¯”è¾ƒæŠ½è±¡ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 25;
const int inf = 0x3f3f3f3f;
const int maxm = (1 &amp;lt;&amp;lt; 16) + 5;
int n, res;
int tag[maxn][maxn];
int f[maxn], g[maxn];
int solve(std::vector&amp;lt;int&amp;gt;&amp;amp; a) &amp;#123;
    static int g[maxn];
    static int f[maxm], p[maxm];
    int n(a.size()), siz(1 &amp;lt;&amp;lt; n);
    std::fill(g, g + n, 0);
    std::fill(p, p + siz + 1, 0);
    std::fill(f, f + siz + 1, inf);
    std::vector&amp;lt;int&amp;gt; st;
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        for (int j = 0; j &amp;lt; n; ++j) &amp;#123;
            if (::g[a[i]] &amp;amp; (1 &amp;lt;&amp;lt; a[j]))
                g[i] |= 1 &amp;lt;&amp;lt; j;
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt; siz; ++i) &amp;#123;
        int now = 0;
        for (int j = 0; j &amp;lt; n; ++j) &amp;#123;
            if (i &amp;amp; (1 &amp;lt;&amp;lt; j))
                now |= g[j];
        &amp;#125;
        if (!(now &amp;amp; i))
            st.push_back(i), f[i] = 0, p[i] = i;
        for (auto j : st) &amp;#123;
            if (!(i &amp;amp; j)) &amp;#123;
                if (f[i | j] &amp;gt; f[i] + 1)
                    f[i | j] = f[i] + 1, p[i | j] = j;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    int now = siz - 1;
    while (now) &amp;#123;
        int fa = now ^ p[now];
        for (int i = 0; i &amp;lt; n; ++i)
            if (p[now] &amp;amp; (1 &amp;lt;&amp;lt; i))
                for (int j = 0; j &amp;lt; n; ++j)
                    if ((fa &amp;amp; (1 &amp;lt;&amp;lt; j)) &amp;amp;&amp;amp; tag[a[j]][a[i]] == 2)
                        tag[a[j]][a[i]] = 1, tag[a[i]][a[j]] = -1;
        now = fa;
    &amp;#125;
    return f[siz - 1];
&amp;#125;
int find(int x) &amp;#123;
    return x == f[x] ? x : f[x] = find(f[x]);
&amp;#125;
int main() &amp;#123;
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
    int m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; edge;
    for (int i = 0; i &amp;lt; n; ++i)
        f[i] = i;
    while (m--) &amp;#123;
        int x, y;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        edge.emplace_back(--x, --y);
        f[find(x)] = find(y);
        g[x] |= 1 &amp;lt;&amp;lt; y;
        g[y] |= 1 &amp;lt;&amp;lt; x;
        tag[x][y] = tag[y][x] = 2;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; ver[maxn];
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        ver[find(i)].push_back(i);
    &amp;#125;
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        if (f[i] == i)
            res = std::max(res, solve(ver[i]));
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    for (auto i : edge) &amp;#123;
        if (tag[i.first][i.second] == 1)
            std::cout &amp;lt;&amp;lt; i.first + 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; i.second + 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        else std::cout &amp;lt;&amp;lt; i.second + 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; i.first + 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;c.-ç…®é…’è®ºè‹±é›„&#34;&gt;C. ç…®é…’è®ºè‹±é›„&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5170/problem/3&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/5170/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°å¦‚æœå­˜åœ¨ä¸²è¢«å…¶ä»–ä¸²åŒ…å«é‚£ä¹ˆç›´æ¥å°†å…¶æ¯™æ‰å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºç›¸äº’ä¸å®Œå…¨åŒ…å«çš„ä¸²ï¼Œæˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(mx_{i, j, 0/1, 0/1}\)&lt;/span&gt; è¡¨ç¤ºå°†æ­£åº / é€†åºçš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸²æ‹¼åˆ°æ­£åº / é€†åºçš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸²ä¹‹å‰ï¼Œä¸¤è€…å…±ç”¨ç›¸æ¥å…¬å…±éƒ¨åˆ†çš„ä¸²é•¿ã€‚è¿™ä¸ªå¯ä»¥ç”¨å­—ç¬¦ä¸²å“ˆå¸Œæš´åŠ›æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨çŠ¶å‹æšä¸¾æ‹¼æ¥é¡ºåºï¼Œæ±‚å¾—æœ€å°æ€»ä¸²é•¿å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„å¦‚æœå»æ‰è¢«åŒ…å«ä¸²å &lt;span class=&#34;math inline&#34;&gt;\(n=1\)&lt;/span&gt; æ—¶éœ€ç›´æ¥è¾“å‡ºä¸²çš„ borderï¼›ä»¥åŠç­”æ¡ˆéœ€å’Œ &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; å– &lt;span class=&#34;math inline&#34;&gt;\(\max\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°èµ·æ¥åˆè‡­åˆé•¿ï¼Œä½†å®é™…ä¸Šæ€è·¯ç¡®å®éå¸¸ç®€å•ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
using ll = long long;
const int p = 131;
const int maxn = 25;
const int lim = 2e4;
const int maxl = 2e4 + 5;
const int mod = 998244353;
const int inf = 0x3f3f3f3f;
const int maxm = (1 &amp;lt;&amp;lt; 16) + 5;
int n;
std::vector&amp;lt;std::string&amp;gt; s;
std::vector&amp;lt;std::vector&amp;lt;ll&amp;gt; &amp;gt; h[2];
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#endif
    std::cin &amp;gt;&amp;gt; n;
    s.resize(n);
    h[0].resize(n);
    h[1].resize(n);
    static ll base[maxl];
    static bool del[maxn];
    base[0] = 1;
    for (int i = 1; i &amp;lt;= lim; ++i)
        base[i] = base[i - 1] * p % mod;

    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; s[i];
        h[0][i].resize((int)s[i].length());
        h[1][i].resize((int)s[i].length());
        ll x = 0;
        for (int j = 0; j &amp;lt; (int)s[i].length(); ++j, (x *= p) %= mod)
            h[0][i][j] = ((x += s[i][j]) %= mod);
        std::reverse(s[i].begin(), s[i].end());
        x = 0;
        for (int j = 0; j &amp;lt; (int)s[i].length(); ++j, (x *= p) %= mod)
            h[1][i][j] = ((x += s[i][j]) %= mod);
        std::reverse(s[i].begin(), s[i].end());
    &amp;#125;

    std::vector&amp;lt;int&amp;gt; tab;
    auto gethash = [&amp;amp;](int i, int l, int r, bool t) -&amp;gt; ll &amp;#123;
        if (l &amp;gt; r) return 0;
        ll res = (h[t][i][r] - (l ? h[t][i][l - 1] : 0) * base[r - l + 1] % mod);
        return (res % mod + mod) % mod;
    &amp;#125;;
    // ll now = 0;
    // for (int i = 0; i &amp;lt;= 4; ++i)
    //     now = (now * p + s[1][i]) % mod;
    // printf(&amp;quot;now = %lld\n&amp;quot;, now);
    // now = 0;
    // for (int i = 3; i &amp;lt;= 7; ++i)
    //     now = (now * p + s[0][i]) % mod;
    // printf(&amp;quot;now = %lld\n&amp;quot;, now);
    // printf(&amp;quot;# %lld\n&amp;quot;, h[0][0].back());
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        tab.push_back(i);
        for (int j = 0; j &amp;lt; n; ++j)
            if (!del[j] &amp;amp;&amp;amp; i != j)
                for (int k = 0; k &amp;lt;= ((int)s[j].length()) - ((int)s[i].length()); ++k) &amp;#123;
                    // printf(&amp;quot;i = %d, j = %d, k = %d, %lld / %lld\n&amp;quot;, i, j, k,
                    //         gethash(i, 0, ((int)s[i].length()) - 1, 0), gethash(j, k, k + ((int)s[i].length()) - 1, 0));
                    if (h[0][i].back() == gethash(j, k, k + ((int)s[i].length()) - 1, 0)) &amp;#123;
                        tab.pop_back();
                        del[i] = 1;
                        goto outo;
                    &amp;#125;
                &amp;#125;
        outo: ;
    &amp;#125;
    n = (int)tab.size();
    if (n == 1) &amp;#123;
        int border;
        for (border = ((int)s[tab[0]].length()) - 1; ~border; --border) &amp;#123;
            if (gethash(tab[0], 0, border - 1, 0) == gethash(tab[0], ((int)s[tab[0]].length()) - border, ((int)s[tab[0]].length()) - 1, 0))
                break;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; std::max(2, ((int)s[tab[0]].length()) - border) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    else &amp;#123;
        static int mx[maxn][maxn][2][2];
        for (int i = 0; i &amp;lt; n; ++i)
            for (int j = 0; j &amp;lt; n; ++j)
                for (int a = 0; a &amp;lt; 2; ++a)
                    for (int b = 0; b &amp;lt; 2; ++b)
                        for (int k = std::min((int)s[tab[i]].length(), (int)s[tab[j]].length()); ~k; --k) &amp;#123;
                            if (gethash(tab[i], ((int)s[tab[i]].length()) - k, ((int)s[tab[i]].length()) - 1, a) ==
                                                                                            gethash(tab[j], 0, k - 1, b)) &amp;#123;
                                mx[i][j][a][b] = (int)s[tab[j]].length() - k;
                                // printf(&amp;quot;%d(%d) + %d(%d) = %d, k = %d\n&amp;quot;, i, a, j, b, mx[i][j][a][b], k);
                                break;
                            &amp;#125;
                        &amp;#125;
        static int f[maxm][maxn][2];
        memset(f, 0x3f, sizeof (f));

        int siz = 1 &amp;lt;&amp;lt; n, res = inf;
        f[1][0][0] = (int)s[tab[0]].length();
        for (int i = 1; i &amp;lt; siz; ++i)
            for (int j = 0; j &amp;lt; n; ++j)
                if (i &amp;amp; (1 &amp;lt;&amp;lt; j))
                    for (int a = 0; a &amp;lt; 2; ++a) &amp;#123;
                        // printf(&amp;quot;f[%d][%d][%d] = %d\n&amp;quot;, i, j, a, f[i][j][a]);
                        for (int k = 0; k &amp;lt; n; ++k)
                            if (!(i &amp;amp; (1 &amp;lt;&amp;lt; k)))
                                for (int b = 0; b &amp;lt; 2; ++b)
                                    f[i | (1 &amp;lt;&amp;lt; k)][k][b] = std::min(f[i | (1 &amp;lt;&amp;lt; k)][k][b], f[i][j][a] + mx[j][k][a][b]);
                        if (i == siz - 1)
                            res = std::min(res, f[i][j][a] - (int)s[tab[0]].length() + mx[j][0][a][0]);
                    &amp;#125;
        
        std::cout &amp;lt;&amp;lt; std::max(2, res) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;a.-ææ–‘é©¬&#34;&gt;A. ææ–‘é©¬&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5175/problem/1&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/5175/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ç”šè‡³ä¸ä¼šï¼ˆï¼‰&lt;/p&gt;
&lt;p&gt;ç¿»è½¬ + æ‹¼æ¥æœ¬è´¨ä¸Šå°±æ˜¯é¦–å°¾ç›¸æ¥ã€‚æˆ‘ä»¬æŠŠå­—ç¬¦ä¸²æ•´ä¸ªæ‹¼åˆ°è‡ªå·±åè¾¹å„¿ï¼Œç„¶åä»»å–ä¸€æ®µé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ä¸²å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå€’è¿‡æ¥çš„æ“ä½œåçš„å­—ç¬¦ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°å¯ä»¥æ“ä½œå¾ˆå¤šæ¬¡ã€‚ä½†æ˜¯æ—¢ç„¶æˆ‘ä»¬æ“ä½œåçš„ä¸²ä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªæ‹¼æ¥åçš„ä¸²ä¸­æ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå…¶å®å¤šæ¬¡æ“ä½œåçš„ä¹Ÿè¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å‘¢æˆ‘ä»¬åœ¨æ‹¼æ¥åçš„ä¸²ç§æšä¸¾æ¯ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ä¸²è®¡ç®—ç­”æ¡ˆå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“æ€ä¹ˆç®—å‘¢ï¼Ÿæ³¨æ„åˆ°åªçœ‹å¼€å¤´ï¼Œä¹Ÿå°±æ˜¯åœ¨æ–°ä¸²ä¸­åªçœ‹ç¦»æˆ‘ä»¬å½“å‰æšä¸¾çš„å³ç«¯ç‚¹æœ€è¿‘çš„é‚£ä¸€æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“ä¸€ä¸ªåŒæŒ‡é’ˆï¼Œçœ‹è¿™ä¸€æ®µæ˜¯å¦åœ¨å³ç§»åä»ç„¶åˆæ³•ï¼Œå¦‚æœéæ³•å°±æŠŠç­”æ¡ˆåŒºé—´å·¦ç«¯ç‚¹æ›´æ–°ä¸ºå³ç«¯ç‚¹è‡ªå·±ã€‚ä»¥åŠæ³¨æ„åˆ°å·¦å³ç«¯ç‚¹çš„è·ç¦»ä¸èƒ½è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int res;
std::string s;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#endif
    std::cin &amp;gt;&amp;gt; s;
    int l = 0, r = -1, n = (int)s.length();
    char la = 0;
    s += s;
    while (++r &amp;lt; (int)s.length()) &amp;#123;
        if (s[r] == la)
            l = r;
        while (r - l + 1 &amp;gt; n) ++l;
        la = s[r];
        res = std::max(res, r - l + 1);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;d.-é“¾çŠ¶é—ªç”µ&#34;&gt;D. é“¾çŠ¶é—ªç”µ&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5175/problem/4&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/5175/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è«åå…¶å¦™ä¸”åˆè‡­åˆé•¿çš„æ ¹å·åšæ³•ã€‚&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°ä¸€ä¸ªæ€ªè¢«æ€æ‰äº†åºåˆ—å°±ä¼šè£‚å¼€æˆä¸¤æ®µè¿ç»­å­åºåˆ—ï¼Œä»¥åŠæœ€å…ˆè¢«æ€æ‰çš„æ€ªç‰©ä¸€å®šè¡€é‡æœ€å°‘ã€‚åœ¨è£‚å¼€æ¥çš„ä¸¤æ®µè¿ç»­å­åºåˆ—ä¸­ä¹Ÿæ»¡è¶³æ­¤è§„å¾‹ï¼Œä»¥æ­¤ç±»æ¨ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¯¹åºåˆ—å»ºç«‹ç¬›å¡å°”æ ‘ã€‚ä»¤æ ‘æ ¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(rt\)&lt;/span&gt;ï¼Œå½“å‰æ”»å‡»åŠ›ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œè®° &lt;span class=&#34;math inline&#34;&gt;\(t_{x, k}=\left\lceil \dfrac {h_x}k \right\rceil\)&lt;/span&gt;ï¼Œå³ä¸è€ƒè™‘å…¶ä»–æ¡ä»¶æ—¶å‡»å€’ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; æ‰€éœ€æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(rt\)&lt;/span&gt; çš„å·¦ã€å³å„¿å­ &lt;span class=&#34;math inline&#34;&gt;\(l,r\)&lt;/span&gt;ï¼Œå•è€ƒè™‘è¿™ä¸‰ä¸ªæ€ªç‰©æ‰€éœ€çš„æ€»å‡»å€’æ¬¡æ•°ï¼Œå®¹æ˜“å‘ç°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_{rt,k}+(t_{l,k}-t_{rt,k})+(t_{r,k}-t_{rt,k})\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; å¼•å¯¼çš„å­æ ‘ï¼Œæ­¤æ—¶çš„å®é™…å·²æ”»å‡»æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_{l,k}\)&lt;/span&gt;ï¼›æ‰€ä»¥å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; çš„å·¦å³å„¿å­ &lt;span class=&#34;math inline&#34;&gt;\(l&amp;#39;,r&amp;#39;\)&lt;/span&gt;ï¼Œå‡»å€’è¿™ä¸¤ä¸ªæ€ªç‰©çš„æ‰€éœ€æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\((t_{l&amp;#39;,k} - t_{l,k})+(t_{r&amp;#39;,k}-t_{l,k})\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å¼•å¯¼çš„å­æ ‘åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ï¼Œå¦‚æœå­˜åœ¨æ ‘è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå‡»å€’ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æ‰€éœ€æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_{v,k}-t_{u,k}\)&lt;/span&gt;ï¼›ç‰¹åˆ«åœ°ï¼Œå‡»å€’ &lt;span class=&#34;math inline&#34;&gt;\(rt\)&lt;/span&gt; çš„æ‰€éœ€æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_{rt,k}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„æ ‘ä¸Š DFS å¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ‰¾åˆ°ç­”æ¡ˆäº†ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(2\times 10^4\)&lt;/span&gt; èŒƒå›´å†…çš„æ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦åˆ©ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„æ€§è´¨è¿›è¡Œæ ¹å·åˆ†æ²»äº†ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k\le \sqrt {2\times 10^4}\)&lt;/span&gt;ï¼Œæˆ‘ä»¬å¤§å¯ä»¥ç›´æ¥åšè¿™ä¹ˆå¤šæ¬¡ DFS å¾—åˆ°ç­”æ¡ˆï¼›&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k&amp;gt;\sqrt {2\times 10^4}\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å®¹æ˜“å‘ç°æœ€ç»ˆçš„ç»“æœæ˜¯è‹¥å¹²ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„å€¼ç›¸åŠ å‡å¾—åˆ°çš„ï¼Œè€Œæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„æƒå€¼ &lt;span class=&#34;math inline&#34;&gt;\(cnt\)&lt;/span&gt; å–å†³äºå…¶åœ¨ç¬›å¡å°”æ ‘ä¸Šçš„å„¿å­ä¸ªæ•°ï¼Œæœ‰å¤šå°‘å°±åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„åŸºç¡€ä¸Šå‡å»å¤šå°‘ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; å®åœ¨è¿‡äºç‰¹æ®Šï¼Œè€ƒè™‘æ•´é™¤åˆ†å— / æ•°è®ºåˆ†å—ã€‚å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(k&amp;#39;\in (\sqrt {2\times 10^4}, 2\times 10^4]\)&lt;/span&gt;ï¼Œå¯èƒ½çš„ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; å€¼åªæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\sqrt {2\times 10^4 }\)&lt;/span&gt; ç§ã€‚è®¡ç®—å‡ºå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(t&amp;#39;\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\left\lceil \dfrac {h_x}{k&amp;#39;} \right\rceil=t&amp;#39;\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(k&amp;#39;\)&lt;/span&gt; èŒƒå›´ï¼Œå¯¹è¯¥èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\(k&amp;#39;\)&lt;/span&gt; çš„ç­”æ¡ˆåŒºé—´åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(t&amp;#39;\times cnt\)&lt;/span&gt; å³å¯ï¼Œå¯ä»¥ä½¿ç”¨å·®åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;è‡³æ­¤ï¼Œå°±å¯ä»¥åœ¨ä¸€æ¬¡ DFS å†…è§£å†³è¿™ç§æƒ…å†µä¸‹çš„é—®é¢˜ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ€»æ—¶é—´å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n\sqrt {2\times 10^4})\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘åœ¨åšè¿™é“é¢˜çš„æ—¶å€™å¹¶æ²¡æœ‰æ„è¯†åˆ°è‡ªå·±ç”¨åˆ°äº†ç¬›å¡å°”æ ‘ï¼Œ&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä»£ç ä¸­ç¬›å¡å°”æ ‘çš„å»ºæ ‘éƒ¨åˆ†å¯èƒ½é•¿å¾—ç‰¹åˆ«æŠ½è±¡ï¼ˆ&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæ˜¯ä½¿ç”¨äº†ä¸‹æ ‡ä¸Šçš„ ST è¡¨å¸¦ log åœ°æ±‚è§£äº†å·¦å³å„¿å­ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxm = 35;
const int maxn = 1e5 + 5;
using ll = long long;
ll res;
int n, k, l;
int g[maxn][2];
int f[maxn][maxm];
int a[maxn], t[maxn];
ll dif[maxn], cnt[maxn];
int ask(int l, int r) &amp;#123;
    if (l &amp;gt; r) return 0;
    int k = log(r - l + 1) / log(2.0);
    return (a[f[l][k]] &amp;lt; a[f[r - (1 &amp;lt;&amp;lt; k) + 1][k]]) ? f[l][k] : f[r - (1 &amp;lt;&amp;lt; k) + 1][k];
&amp;#125;
void bld(int rt, int l, int r) &amp;#123;
    if (rt != l) &amp;#123;
        g[rt][0] = ask(l, rt - 1);
        bld(g[rt][0], l, rt - 1);
    &amp;#125;
    if (rt != r) &amp;#123;
        g[rt][1] = ask(rt + 1, r);
        bld(g[rt][1], rt + 1, r);
    &amp;#125;
    return;
&amp;#125;
// k &amp;lt;= sqrt(lim)
void DFS(int x, int k, int fa) &amp;#123;
    t[x] = (a[x] + k - 1) / k;
    res += t[x] - t[fa];
    for (int i = 0; i &amp;lt; 2; ++i) &amp;#123;
        if (g[x][i])
            DFS(g[x][i], k, x);
    &amp;#125;
    return;
&amp;#125;
// k &amp;gt; sqrt(lim)
void DFS(int x, int fa) &amp;#123;
    ++cnt[x];
    --cnt[fa];
    for (int i = 0; i &amp;lt; 2; ++i) &amp;#123;
        if (g[x][i])
            DFS(g[x][i], x);
    &amp;#125;
    int l = k + 1, r;
    // æ³¨æ„è¿™é‡Œ i çš„èŒƒå›´åˆ¤å®šï¼Œå¦‚æœç›´æ¥å†™æˆ i * i &amp;lt;= k ä¼šå°‘è®¡ç®—ä¸€äº›æƒ…å†µ
    for (int i = 1; (i - 1) * (i - 1) &amp;lt; k; ++i) &amp;#123;
        r = l - 1;
        l = (a[x] + i - 1) / i;
        // fprintf(stderr, &amp;quot;%d: [%d, %d] += %d * %d\n&amp;quot;, a[x], l, r, cnt[x], i);
        dif[l] += i * cnt[x], dif[r + 1] -= i * cnt[x];
    &amp;#125;
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#endif
    std::cin &amp;gt;&amp;gt; n;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        f[i][0] = i;
        k = std::max(k, a[i]);
    &amp;#125;
    for (int j = 1; (1 &amp;lt;&amp;lt; j) &amp;lt;= n; ++j)
        for (int i = 1; i + (1 &amp;lt;&amp;lt; j) - 1 &amp;lt;= n; ++i)
            f[i][j] = (a[f[i][j - 1]] &amp;lt; a[f[i + (1 &amp;lt;&amp;lt; (j - 1))][j - 1]]) ? f[i][j - 1] : f[i + (1 &amp;lt;&amp;lt; (j - 1))][j - 1];
    int rt = ask(1, n);
    bld(rt, 1, n);
    for (int i = 1; i * i &amp;lt;= k; ++i) &amp;#123;
        res = 0;
        DFS(rt, i, 0);
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
        l = i + 1;
    &amp;#125;
    // fputs(&amp;quot;\n&amp;quot;, stderr);
    DFS(rt, 0);
    std::partial_sum(dif + 1, dif + k + 1, dif + 1);
    for (int i = l; i &amp;lt;= k; ++i)
        std::cout &amp;lt;&amp;lt; dif[i] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;f.-å¼¹é£ç»µç¾Š&#34;&gt;F. å¼¹é£ç»µç¾Š&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.becoder.com.cn/contest/5175/problem/6&#34; class=&#34;uri&#34;&gt;https://www.becoder.com.cn/contest/5175/problem/6&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆæ£’å¯æŒä¹…åŒ–åˆ†å—ï¼Œä½¿æˆ‘ lxl æ—‹è½¬ã€‚&lt;/p&gt;
&lt;p&gt;ç¬‘è¯ï¼šèµ›å 5s æ‰äº¤ä¸Šå»ã€‚ç„¶å A äº†ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çŒœå¤§å®¶éƒ½ä¼šæ™®é€šçš„å¼¹é£ç»µç¾Šè¿™é“é¢˜ã€‚å°±æ˜¯å—é—´æš´åŠ›è·³å˜›ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œç»™ä¸€ä¸ªæˆ‘è‡ªå·±æ•´çš„ç®€å•å®ç°æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æŠŠåˆ†å‡ºæ¥çš„å—è§†ä½œè‹¥å¹²ä¸ªæ— å…³è”çš„æ•£å—å¹¶çº³å…¥å—é›†åˆï¼›å¯¹äºæ¯ä¸€ä¸ªç‰ˆæœ¬ï¼Œç”¨ä¸€ä¸ªå¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sqrt n\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(id\)&lt;/span&gt; æ•°ç»„è®°å½•æ¯ä¸€ä½ç½®çš„å—åœ¨å—é›†åˆä¸­å¯¹åº”çš„ä½ç½®ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åè¯¥æ€ä¹ˆææ€ä¹ˆæå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;P.S. zwb åšå®šä¸ç§»ä¿¡ä»° lxl ç¥æ•™äºæ˜¯å†³å®šç”¨å¯æŒä¹…åŒ–å¹³è¡¡æ ‘å®ç°å¯æŒä¹…åŒ–åˆ†å—ï¼Œç»“æœå½“ç„¶æ˜¯å› ä¸ºå¤šäº†ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; è¢«å¡é£äº†ï¼Œæœ€åæ°”æ€¥è´¥åæ…Œä¸æ‹©è·¯æ¼ç¾æˆæ€’æŠ„èµ·äº†æˆ‘çš„ä»£ç ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxk = 320;
const int maxn = 2e5 + 5;
class devicer &amp;#123;
public:
    int l, r;
    std::vector&amp;lt;int&amp;gt; ne, u, a;
    int &amp;amp;nex(int x);
    int &amp;amp;val(int x);
&amp;#125;;
int id[maxn][maxk];
std::vector&amp;lt;devicer&amp;gt; b;
int n, q, ty, siz, k, la;
int a[maxn], tab[maxn], blk[maxn];
void upd(int x, int a, devicer &amp;amp;p) &amp;#123;
    if (x + a &amp;gt; n)
        p.nex(x) = -1, p.val(x) = 1;
    else if (x + a &amp;gt; p.r)
        p.nex(x) = x + a, p.val(x) = 1;
    else
        p.nex(x) = p.nex(x + a), p.val(x) = p.val(x + a) + 1;
    // printf(&amp;quot;x = %d, a = %d, r = %d, upd ne[%d] to %d\n&amp;quot;, x, a, p.r, x, p.nex(x));
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr);
    std::cout.tie(nullptr);
#endif
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q &amp;gt;&amp;gt; ty;
    siz = sqrt(n);
    k = (n + siz - 1) / siz;
    b.resize(k);
    int la = 0, now = k - 1;
    for (auto &amp;amp;i : b)
        i.l = la + 1, la = i.r = i.l + siz - 1;
    b.back().r = n;
    for (int i = 0; i &amp;lt; k; ++i) &amp;#123;
        id[0][i] = i;
        b[i].a.resize(b[i].r - b[i].l + 1);
        b[i].u.resize(b[i].r - b[i].l + 1);
        b[i].ne.resize(b[i].r - b[i].l + 1);
        for (int j = b[i].l; j &amp;lt;= b[i].r; ++j)
            tab[j] = j - b[i].l, blk[j] = i;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; b[blk[i]].a[tab[i]];
    for (int i = n; i; --i)
        upd(i, b[blk[i]].a[tab[i]], b[blk[i]]);
    int ver = 0;
    while (q--) &amp;#123;
        int op, pr, x;
        static int res = 0;
        std::cin &amp;gt;&amp;gt; op &amp;gt;&amp;gt; pr &amp;gt;&amp;gt; x;
        if (!ty)
            res = 0;
        x ^= res;
        if (op == 1) &amp;#123;
            std::copy(id[pr], id[pr] + k, id[++ver]);
            b.push_back(b[id[ver][blk[x]]]);
            id[ver][blk[x]] = ++now;
            std::cin &amp;gt;&amp;gt; b.back().a[tab[x]];
            b.back().a[tab[x]] ^= res;
            for (int i = x; i &amp;gt;= b.back().l; --i)
                upd(i, b.back().a[tab[i]], b.back());
        &amp;#125;
        else &amp;#123;
            int p = x;
            res = 0;
            while (~p) &amp;#123;
                // printf(&amp;quot;p = %d\n&amp;quot;, p);
                res += b[id[pr][blk[p]]].u[tab[p]];
                p = b[id[pr][blk[p]]].ne[tab[p]];
            &amp;#125;
            std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;
int&amp;amp; devicer::nex(int x) &amp;#123;
    return ne[tab[x]];
&amp;#125;
int&amp;amp; devicer::val(int x) &amp;#123;
    return u[tab[x]];
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="çŠ¶å‹" />
        <category term="SAM" />
        <category term="åˆ†å—" />
        <category term="å¯æŒä¹…åŒ–" />
        <category term="ç¬›å¡å°”æ ‘" />
        <updated>2024-05-01T07:44:48.000Z</updated>
    </entry>
</feed>
