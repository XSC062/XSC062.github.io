<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xsc062.netlify.app</id>
    <title> â€¢ Posts by &#34;dp ä¼˜åŒ–&#34; tag</title>
    <link href="https://xsc062.netlify.app" />
    <updated>2025-08-16T08:14:12.000Z</updated>
    <category term="å¹¶æŸ¥é›†" />
    <category term="æ–œç‡ä¼˜åŒ–" />
    <category term="æ‚¬çº¿æ³•" />
    <category term="å“ˆå¸Œ" />
    <category term="å­—å…¸æ ‘" />
    <category term="DP" />
    <category term="å•è°ƒé˜Ÿåˆ—" />
    <category term="åˆ†æ²»" />
    <category term="äºŒåˆ†å›¾" />
    <category term="CRT / exCRT" />
    <category term="æ’åˆ—ç»„åˆ" />
    <category term="ç½‘ç»œæµ" />
    <category term="è´¹ç”¨æµ" />
    <category term="äºŒåˆ†" />
    <category term="ä¸Šä¸‹ç•Œç½‘ç»œæµ" />
    <category term="å®¹æ–¥åŸç†" />
    <category term="çº¿æ®µæ ‘" />
    <category term="æ ‘çŠ¶æ•°ç»„" />
    <category term="åŒºé—´ DP" />
    <category term="æ„é€ " />
    <category term="æ•°æ®ç»“æ„" />
    <category term="Tarjan" />
    <category term="ä¸‹é¥­" />
    <category term="LCA" />
    <category term="å€å¢" />
    <category term="é¸½å·¢åŸç†" />
    <category term="æ¦‚ç‡æœŸæœ›" />
    <category term="è°ƒå’Œçº§æ•°" />
    <category term="å·®åˆ†" />
    <category term="æ€ç»´" />
    <category term="æ ‘å½¢ DP" />
    <category term="æœ€å°ç”Ÿæˆæ ‘" />
    <category term="SAM" />
    <category term="çŠ¶å‹" />
    <category term="åˆ†å—" />
    <category term="å¯æŒä¹…åŒ–" />
    <category term="ç¬›å¡å°”æ ‘" />
    <category term="é«˜ç»´å‰ç¼€å’Œ" />
    <category term="é—²è¯" />
    <category term="æ¬§æ‹‰å›è·¯" />
    <category term="æ ‘é“¾å‰–åˆ†" />
    <category term="é•¿é“¾å‰–åˆ†" />
    <category term="KMP" />
    <category term="border" />
    <category term="å­—ç¬¦ä¸²" />
    <category term="AC è‡ªåŠ¨æœº" />
    <category term="SA" />
    <category term="æ•°å­¦" />
    <category term="æ ‘ä¸Šå·®åˆ†" />
    <category term="FWT" />
    <category term="å †" />
    <category term="æ ‘çš„é‡å¿ƒ" />
    <category term="äºŒé¡¹å¼å®šç†" />
    <category term="äºŒé¡¹å¼åæ¼”" />
    <category term="è´ªå¿ƒ" />
    <category term="å‡æ‘Š" />
    <category term="è®¡æ•°" />
    <category term="ä¼˜åŒ–å»ºå›¾" />
    <category term="åæ‚”è´ªå¿ƒ" />
    <category term="è°ƒæ•´æ³•" />
    <category term="èƒŒåŒ…" />
    <category term="åšå¼ˆè®º" />
    <category term="DP ä¼˜åŒ–" />
    <category term="è™šæ ‘" />
    <category term="ç‚¹åˆ†æ²»" />
    <category term="WQS äºŒåˆ†" />
    <category term="é—µå¯å¤«æ–¯åŸºå’Œ" />
    <category term="slope trick" />
    <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
    <category term="çŠ¶å‹ DP" />
    <category term="ç»„åˆæ•°å­¦" />
    <category term="æ”¯é…å¯¹" />
    <category term="DDP" />
    <category term="å®¹æ–¥" />
    <category term="Kruskal é‡æ„æ ‘" />
    <category term="é«˜ç²¾åº¦" />
    <category term="æœ€çŸ­è·¯" />
    <category term="æè¶…çº¿æ®µæ ‘" />
    <entry>
        <id>https://xsc062.netlify.app/20250816/</id>
        <title>è¿‘æœŸæ‚é¢˜ II</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250816/"/>
        <content type="html">&lt;p&gt;å’Œ Aug 9th çš„æ‚é¢˜ä¸å¤ªèƒ½åˆå¹¶ï¼Œæ‰€ä»¥åˆ†å¼€äº†&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-gas-fire-extinguishers&#34;&gt;B. GAS-Fire Extinguishers&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3479&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3479&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶å¯ä»¥è´ªå¿ƒï¼Œä¸å¦¨ä»ä¸‹åˆ°ä¸Šï¼Œè®°å½•å½“å‰éå†è¿‡çš„ã€ç©ºä½™å‡ºæ¥çš„ç­ç«å™¨ï¼ˆå…¶å®ç®—çš„æ˜¯å¯ä»¥ä¾›ç»™çš„æˆ¿é—´æ•°ï¼‰å’Œè¿˜æœªåˆ†é…ç­ç«å™¨çš„æˆ¿é—´ï¼ŒæŒ‰è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\sim k\)&lt;/span&gt; åˆ†ç»„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸éš¾å‘ç°å¦‚æœåœ¨æŸä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„å­˜åœ¨è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ç©ºé—²ç­ç«å™¨ï¼Œå¯ä»¥è´ªå¿ƒåœ°åˆ†é…ç»™ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼›å¦‚æœå­˜åœ¨è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„æœªåˆ†é…æˆ¿é—´ï¼Œä¹Ÿå¯ä»¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å¤„æ”¾ç½®ç­ç«å™¨å¹¶åˆ†é…ç»™è¿™äº›æˆ¿é—´ã€‚ç±»ä¼¼åœ°ï¼Œè¿›è¡Œä¸¤ä¸¤é…å¯¹ä¸€å®šæ˜¯ä¸åŠ£çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°åŒå­æ ‘å†…è·ç¦»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„ç‚¹å¯¹ç•™åˆ° &lt;span class=&#34;math inline&#34;&gt;\(fa\)&lt;/span&gt; å†åŒ¹é…æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºè¿™æ—¶è·ç¦»ä¼šå˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(k+1\)&lt;/span&gt;ï¼Œä¸èƒ½åŒ¹é…ä¸Šï¼›å¯ä»¥æ„Ÿå—åˆ°è¿™æ ·æ˜¯æ›´åŠ£çš„ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥åšäº†ï¼Œæ ¹èŠ‚ç‚¹ç‰¹æ®Šä¹±è´ªå¿ƒä¸€ä¸‹å°±è¡Œäº†ã€‚è®°å¾—å¼€ long longã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
#define int long long
signed main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, s, k, res = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; s &amp;gt;&amp;gt; k;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1), p(n + 1, std::vector&amp;lt;int&amp;gt; (k + 1)), q(n + 1, std::vector&amp;lt;int&amp;gt; (k + 1));
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        for (auto i : g[x])
            if (i != fa)  &amp;#123;
                DFS(i, x);
                for (int j = 0; j &amp;lt; k; ++j)
                    p[x][j + 1] += p[i][j], q[x][j + 1] += q[i][j];
            &amp;#125;
        ++q[x][0];
        if (x != 1) &amp;#123;
            int v = (q[x][k] + s - 1) / s;
            p[x][0] = v * s, res += v;
            for (int i = 0; i &amp;lt;= k; ++i) &amp;#123;
                int v = std::min(p[x][i], q[x][k - i]);
                p[x][i] -= v, q[x][k - i] -= v;
            &amp;#125;
            for (int i = 0; i &amp;lt; k; ++i) &amp;#123;
                int v = std::min(p[x][i], q[x][k - 1 - i]);
                p[x][i] -= v, q[x][k - 1 - i] -= v;
            &amp;#125;
        &amp;#125;
        else &amp;#123;
            // std::cerr &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            int sum = 0ll, r = 0;
            for (int i = k; ~i; --i) &amp;#123;
                sum += p[x][k - i];
                // std::cerr &amp;lt;&amp;lt; sum &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
                int v = std::min(sum, q[x][i]);
                sum -= v, q[x][i] -= v;
                r += q[x][i];
            &amp;#125;
            res += (r + s - 1) / s;
        &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-æ‰«åœ°æœºå™¨äºº&#34;&gt;C. æ‰«åœ°æœºå™¨äºº&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6502/problem/3&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6502/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; å †è´§ç‰©ï¼Œæ¯å †è´§ç‰©æœ‰é‡é‡ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; å’Œä¸€ä¸ªå‚æ•° &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ã€‚æœ‰ä¸€ä¸ªåˆå§‹è´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€è´Ÿè½½ä¸Šé™ä¸º &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„æœºå™¨äººï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; éå†è¿™äº›è´§ç‰©ï¼Œå¯¹æ¯ä¸€å¤„è´§ç‰©æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ°æ¸…ç©ºè¿™å †è´§ç‰©ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“å‰è´Ÿè½½æœªæ»¡ï¼šå¯ä»¥é€‰æ‹©è¿›è¡Œè£…è½½ç›´åˆ°è¾¾åˆ°è´Ÿè½½ä¸Šé™ï¼Œæˆ–è´§ç‰©æ¸…ç©ºã€‚èŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ç®¡å½“å‰è´Ÿè½½æ»¡æ²¡æ»¡ï¼šå¯ä»¥é€‰æ‹©æ¸…ç©ºå½“å‰è´Ÿè½½ï¼ŒèŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¯ä¸€å¤„å¯ä»¥ä»»æ„æ“ä½œï¼Œè¦æ±‚éå†å®Œä¹‹åæœºå™¨äººè´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œé—®æœ€å°ä»£ä»·ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5,c\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;em&gt;é¢˜é¢æ˜¯é‡æ„è¿‡çš„ï¼ŒåŸæ¥çš„é¢˜é¢å¤ªæœ‰æ­§ä¹‰äº†ã€‚ç»å¤§å¤šæ•°äººæ²¡åšå‡ºæ¥å°±æ˜¯å› ä¸ºæ²¡çœ‹æ‡‚é¢˜å§ï¼&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æš´åŠ›ï¼Œå¯ä»¥æƒ³åˆ°ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºå¤„ç†å®Œ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¿‡åè´Ÿè½½ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æœ€å°ä»£ä»·ï¼ˆæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,c}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,0}\)&lt;/span&gt; æ˜¯ç­‰æ•ˆçš„ï¼Œæ•…èˆå¼ƒå‰è€…ï¼‰ã€‚è®° &lt;span class=&#34;math inline&#34;&gt;\(k=\left\lceil\dfrac {v_i}c\right\rceil,w=(v_i\bmod c - 1)\bmod c+1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,(j+v_i)\bmod c}\gets f_{i-1,j}+k\cdot a_i+(k-1)\cdot b +
\begin{cases}
b&amp;amp;j+w=c\\
a_i+b&amp;amp;j+w&amp;gt; c\\
0&amp;amp;\text{otherwise}
\end{cases}\\
f_{i,0}\gets f_{i,j}+b
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; ä¹‹é—´æ˜¯å­˜åœ¨å¯¹åº”å…³ç³»çš„ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥ç»§æ‰¿ï¼ˆçœŸå®çš„ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; åº”è¯¥ä½äº &lt;span class=&#34;math inline&#34;&gt;\(-s_i\)&lt;/span&gt; çš„ä½ç½®ï¼‰ï¼Œå†åšå…¨å±€åŠ ã€åŒºé—´åŠ ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_{i,0}\)&lt;/span&gt; çš„è½¬ç§»æ˜¯å…¨å±€ minï¼Œçº¿æ®µæ ‘ç»´æŠ¤å³å¯ï¼›æ¯æ¬¡åªä¼šæ–°å¢ä¸€ä¸ªçŠ¶æ€ï¼ŒåŠ¨æ€å¼€ç‚¹å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e6 + 5;
const __int128 inf = 1e18;
struct &amp;#123;
    int l, r;
    __int128 u, d;
&amp;#125; t[maxn];
#define lt t[p].l
#define rt t[p].r
int tot;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d += t[p].d, t[lt].u += t[p].d;
        t[rt].d += t[p].d, t[rt].u += t[p].d;
        t[p].d = 0ll;
    &amp;#125;
    return;
&amp;#125;
void upd(int &amp;amp;p, int l, int r, int x, __int128 v) &amp;#123;
    if (!p)
        p = ++tot, t[p].u = v;
    else
        t[p].u = std::min(t[p].u, v);
    if (l == r)
        return;
    pushdown(p);
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        upd(lt, l, mid, x, v);
    else
        upd(rt, mid + 1, r, x, v);
    return;
&amp;#125;
void add(int p, int l, int r, int ql, int qr, __int128 v) &amp;#123;
    if (!p)
        return;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr) &amp;#123;
        t[p].d += v, t[p].u += v;
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    pushdown(p);
    if (ql &amp;lt;= mid)
        add(lt, l, mid, ql, qr, v);
    if (qr &amp;gt; mid)
        add(rt, mid + 1, r, ql, qr, v);
    t[p].u = std::min(t[lt].u, t[rt].u);
    return;
&amp;#125;
__int128 ask(int p, int l, int r, int x) &amp;#123;
    if (l == r)
        return t[p].u;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    pushdown(p);
    if (x &amp;lt;= mid)
        return ask(lt, l, mid, x);
    return ask(rt, mid + 1, r, x);
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;robot.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;robot.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;ex_robot4.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    t[0].u = inf;
    int n, b, c, p0 = 0, rt = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; c &amp;gt;&amp;gt; b;
    std::vector&amp;lt;int&amp;gt; a(n + 1), v(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; v[i];
    upd(rt, 0, c - 1, 0, 0ll);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        __int128 k = (v[i] + c - 1) / c, w = (v[i] % c == 0 ? c : v[i] % c);
        t[rt].d += k * a[i] + (k - 1) * b;
        t[rt].u += k * a[i] + (k - 1) * b;
        if (w &amp;lt;= c)
            add(rt, 0, c - 1, (c - w + p0) % c, (c - w + p0) % c, b);
        if (w != 1) &amp;#123;
            int l = (c - w + p0 + 1) % c, r = (p0 + c - 1) % c;
            if (l &amp;lt;= r)
                add(rt, 0, c - 1, l, r, a[i] + b);
            else &amp;#123;
                add(rt, 0, c - 1, 0, r, a[i] + b);
                add(rt, 0, c - 1, l, c - 1, a[i] + b);
            &amp;#125;
        &amp;#125;
        p0 = (p0 + c - v[i] % c) % c;
        upd(rt, 0, c - 1, p0, t[rt].u + b);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; (long long)ask(rt, 0, c - 1, p0) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-å¥—å¨ƒ&#34;&gt;D. å¥—å¨ƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6502/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6502/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é¢˜æ„ï¼šç»™å®šåˆå§‹ä¸ºå…¨ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„æ•°ç»„ &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n + 1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡å•ç‚¹ +1 æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåï¼Œæ±‚è§£ï¼š&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å‰ç¼€å’Œæ•°ç»„ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œä½¿å¾—å¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå‡æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(k\cdot i\ge s_i\)&lt;/span&gt; æˆç«‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6\)&lt;/span&gt;ï¼Œæ—¶é™ 0.5sã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;è¶£äº‹ä¸€åˆ™&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;è€ƒåœºä¸Šæœ€å 10min æ‹¿åˆ°é¢˜ï¼Œæ†‹äº†ä¸€ä¸ªèƒ½æ‹¿åˆ° 96pts çš„å‡åšæ³•ï¼šæ³¨æ„åˆ°å‰ç¼€å’Œæ˜¯å•å¢çš„ï¼Œéœ€è¦ç»´æŠ¤æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {s_i}i\)&lt;/span&gt;ï¼Œç”±äºåç¼€ +1 å¸¦æ¥çš„å½±å“å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥çŒœæµ‹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åªä¼šåœ¨åŸæ¥çš„å’Œä¿®æ”¹çš„ç‚¹ä¹‹é—´å˜åŒ–ã€‚åªç”¨ 10 è¡Œçš„æ ¸å¿ƒä»£ç å°±èƒ½æ‹¿åˆ°å¾ˆå¤šåˆ†ã€‚ä½†æ˜¯å±…ç„¶æœ‰è¿™ä¹ˆå¤šï¼Œå¯èƒ½å‡ºé¢˜äººéƒ½æ²¡æœ‰æƒ³åˆ°çœŸæœ‰äººæ•¢äº¤è¿™ç§åšæ³•å§ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
    std::freopen(&amp;quot;doll.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;doll.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    auto stime = std::chrono::steady_clock::now();
    int n, res = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; bit(n + 2);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x) &amp;#123;
        for (; x &amp;lt;= n + 1; x += lowbit(x))
            ++bit[x];
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        int res = 0;
        for (; x; x -= lowbit(x))
            res += bit[x];
        return res;
    &amp;#125;;
    int p = 1;
    for (int i = 1, x; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x, add(++x);
        long long s = ask(x), t = ask(p);
        if (s * p == t * x ? x &amp;gt; p : s * p &amp;gt; t * x)
            p = x;
        else
            s = t;
        if (s &amp;gt; p * res)
            ++res;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::cerr &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt;(std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;å¾ˆå®¹æ˜“å†™å‡ºæš´åŠ›ï¼Œè§‚å¯Ÿæ ·ä¾‹å°±èƒ½å‘ç°æ¯æ¬¡ä¿®æ”¹åç­”æ¡ˆæœ€å¤šå¢åŠ  &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚è®°å½“å‰ç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(res\)&lt;/span&gt;ï¼Œçº¿æ®µæ ‘ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(s_i-res\cdot i\)&lt;/span&gt; çš„æœ€å°å€¼ï¼Œè‹¥å…¶ä¸ºè´Ÿåˆ™ res++ï¼Œç„¶åé‡æ„çº¿æ®µæ ‘ï¼ˆç­‰å·®æ•°åˆ—å’Œ min ä¸å…¼å®¹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆåˆæœ‰ä¸ç­‰å¼ ğŸ˜±&lt;/p&gt;
&lt;p&gt;ç›®çš„æ˜¯åœ¨æœ¬æ¥åˆæ³•çš„èŒƒå›´é‡Œæ‰¾åˆ°æ–°çš„ä¸åˆæ³•å€¼ã€‚è€ƒè™‘åˆæ³•èŒƒå›´ï¼š&lt;span class=&#34;math inline&#34;&gt;\(s_i-res\cdot i\ge 0\)&lt;/span&gt;ï¼Œè§£ä¸€ä¸‹å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\le \dfrac {s_i}{res}\)&lt;/span&gt;ï¼Œæ”¾ç¼©å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\le\dfrac {n}{res}\)&lt;/span&gt;ï¼Œæ¯æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(res\)&lt;/span&gt; å˜åŒ–æ—¶åªé‡æ„ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {n}{res}\)&lt;/span&gt; ä»¥å‰çš„ä½ç½®ï¼Œé‡æ„çš„æ€»é•¿æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\ln n)\)&lt;/span&gt; çš„ã€‚ï¼ˆçº¿æ®µæ ‘å»ºæ ‘æ˜¯çº¿æ€§çš„ï¼‰&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 1e6 + 5;
const int inf = 0x3f3f3f3f;
struct &amp;#123;
    int l, r, u, d;
&amp;#125; t[maxn &amp;lt;&amp;lt; 2];
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
void bld(int p, int l, int r) &amp;#123;
    t[p].u = t[p].l = l, t[p].r = r;
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d += t[p].d, t[rt].d += t[p].d;
        t[lt].u -= t[p].d, t[rt].u -= t[p].d;
        t[p].d = 0;
    &amp;#125;
    return;
&amp;#125;
void add(int p, int x) &amp;#123;
    if (x &amp;lt;= t[p].l) &amp;#123;
        ++t[p].d, --t[p].u;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, x);
    add(rt, x);
    t[p].u = std::min(t[lt].u, t[rt].u);
    // printf(&amp;quot;[%d, %d]: %d, [%d, %d]: %d\n&amp;quot;, t[p].l, mid, t[lt].u, mid + 1, t[p].r, t[rt].u);
    return;
&amp;#125;
void rem(int p, int r) &amp;#123;
    if (t[p].l == t[p].r) &amp;#123;
        t[p].u += t[p].l;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (r &amp;lt;= mid)
        rem(lt, r), t[rt].u = inf;
    else
        rem(lt, r), rem(rt, r);
    t[p].u = std::min(t[lt].u, t[rt].u);
    return;
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;doll.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;doll.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    bld(1, 1, n + 1);
    for (int i = 1, x, res = 1, now = n; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x;
        if (x &amp;lt;= now)
            add(1, ++x);
        if (t[1].u &amp;lt; 0) &amp;#123;
            std::cout &amp;lt;&amp;lt; ++res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
            rem(1, now = n / res);
        &amp;#125;
        else
            std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
        // puts(&amp;quot;&amp;quot;);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---subarray-sum-divisibility&#34;&gt;E - Subarray Sum Divisibility&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ¨¡æ„ä¹‰ä¸‹çš„æ•°åˆ—å…¨ç­‰ï¼Œå¯ä»¥å¯¹åº”åŸæ•°ç»„å…¨ç­‰ã€å·®åˆ†å…¨ç­‰ã€å‰ç¼€å’Œå…¨ç­‰ï¼ˆéƒ½æ˜¯æ¨¡æ„ä¹‰ä¸‹çš„ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¸€äº›çº¿æ€§å’Œéçº¿æ€§çš„å˜æ¢ä¹Ÿå¯ä»¥ï¼‰&lt;/p&gt;
&lt;p&gt;æœ¬ç€ä¿®æ”¹çš„ç‚¹å°½é‡å°‘çš„æƒ³æ³•ï¼Œå¦‚æœé¢˜ç›®ç»™å®šå•ç‚¹ä¿®æ”¹å°±å¯ä»¥åœ¨åŸæ•°ç»„ä¸Šåšæ–‡ç« ï¼Œç»™å®šåŒºé—´ä¿®æ”¹å¯ä»¥è€ƒè™‘å·®åˆ†æ•°ç»„ï¼Œå‰ç¼€å’Œå¯¹äºä¸€äº›åŒºé—´æŸ¥è¯¢æœ‰ä¼˜åŠ¿&lt;/p&gt;
&lt;p&gt;å…¶ä»–ä¸¤ç§ç”¨å¾—ä¹Ÿå¾ˆå¤šï¼Œåƒè¿™é¢˜åªéœ€è¦ç”¨åŸæ•°ç»„å…¨ç­‰å°±å¯ä»¥åšäº†&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, l;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; l;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; u(l + 1, std::vector&amp;lt;int&amp;gt; (m));
    for (int i = 1; i &amp;lt;= l; ++i)
        for (int j = 0; j &amp;lt; m; ++j)
            for (int k = i; k &amp;lt;= n; k += l)
                u[i][j] += (j + m - a[k]) % m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; f(l + 1, std::vector&amp;lt;int&amp;gt; (m, inf));
    f[0][0] = 0;
    for (int i = 1; i &amp;lt;= l; ++i)
        for (int j = 0; j &amp;lt; m; ++j)
            for (int k = 0; k &amp;lt; m; ++k)
                f[i][(j + k) % m] = std::min(f[i][(j + k) % m], f[i - 1][j] + u[i][k]);
    std::cout &amp;lt;&amp;lt; f[l][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;f---all-included&#34;&gt;F - All Included&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_f&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_f&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åŸé¢˜æ„è½¬åŒ–ä¸ºåœ¨ AC è‡ªåŠ¨æœºä¸Šèµ° &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; æ­¥ï¼Œè¦æ±‚ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªå¶å­çš„æ–¹æ¡ˆæ•°ã€‚ä¸å¤ªå¯åšï¼Œè½¬åŒ–æˆå®¹æ–¥ï¼ˆä»¤å­—ç¬¦ä¸²ç»ˆç‚¹ä¸å¯è¾¾ï¼‰ã€‚åœ¨å¤–å±‚æšä¸¾æ­¥æ•°æš´åŠ›æ¸¸èµ°ã€‚&lt;/p&gt;
&lt;p&gt;è¦æ±‚æ°å¥½èµ° &lt;span class=&#34;math inline&#34;&gt;\(L\)&lt;/span&gt; æ­¥ï¼Œä¹Ÿå¯ä»¥ç”¨çŸ©é˜µï¼›ä½†åŸå›¾å¾ˆç¨€ç–ï¼Œæ‰€ä»¥çŸ©é˜µå¹¶æ²¡æœ‰ä¼˜åŠ¿ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int tot = 1, T[805][26], fail[805];
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, l;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; l;
    std::vector&amp;lt;std::string&amp;gt; a;
    &amp;#123;
        std::vector&amp;lt;std::string&amp;gt; s(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; s[i];
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            bool flag = 1;
            for (int j = 1; j &amp;lt;= n; ++j)
                if (j != i)
                    if (s[j].find(s[i]) != std::string::npos) &amp;#123;
                        flag = 0;
                        break;
                    &amp;#125;
            if (flag)
                a.push_back(s[i]);
        &amp;#125;
        n = (int)a.size();
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; pos(n);
    for (int i = 0; i &amp;lt; n; ++i) &amp;#123;
        int &amp;amp;p = pos[i];
        for (auto j : a[i]) &amp;#123;
            if (!T[p][j - &amp;#39;a&amp;#39;])
                T[p][j - &amp;#39;a&amp;#39;] = tot++;
            p = T[p][j - &amp;#39;a&amp;#39;];
        &amp;#125;
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    auto res = 0ll;
    int siz = 1 &amp;lt;&amp;lt; n;
    for (int i = 0; i &amp;lt; siz; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; tag(tot);
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1)
                tag[pos[j]] = 1;
        std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(l + 1, std::vector&amp;lt;long long&amp;gt; (tot));
        f[0][0] = 1ll;
        for (int j = 0; j &amp;lt; l; ++j)
            for (int k = 0; k &amp;lt; tot; ++k)
                for (int a = 0; a &amp;lt; 26; ++a) &amp;#123;
                    if (!tag[T[k][a]])
                        (f[j + 1][T[k][a]] += f[j][k]) %= mod;
                &amp;#125;
        int k = (__builtin_popcount(i) &amp;amp; 1 ? mod - 1 : 1);
        auto s = 0ll;
        for (int j = 0; j &amp;lt; tot; ++j)
            if (!tag[j])
                (s += f[l][j]) %= mod;
        (res += k * s) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;g---count-simple-paths-2&#34;&gt;G - Count Simple Paths 2&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc419/tasks/abc419_g&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc419/tasks/abc419_g&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆæ–°çš„æ€§è´¨ã€‚è€ƒè™‘ã€ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºèµ·ç‚¹çš„ç®€å•è·¯å¾„æ•°ã€å’Œåç¥–è¾¹æ•°é‡çš„å…³ç³»ï¼šé€‰å®šä¸€æ¡åç¥–è¾¹å¿…é¡»è¢«ç»è¿‡æ—¶ï¼ˆæ˜¾ç„¶åªæœ‰ä¸€ç§å¯èƒ½çš„ç»è¿‡æ–¹å‘ï¼‰ï¼Œæ ‘çš„å½¢æ€å‘ç”Ÿå˜åŒ–ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ç§åç¥–è¾¹çš„é€‰å–æ–¹æ¡ˆå¯¹åº”ä¸€ç§æ ‘ï¼Œéå†å…¶ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¼€å§‹çš„ç®€å•è·¯å¾„å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚è®¾åç¥–è¾¹æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé‚£ä¹ˆåˆæ³•çš„æ–¹æ¡ˆæ•°ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(2^k\)&lt;/span&gt;ï¼Œæš´åŠ› DFS çš„æ•´ä¸ªå›¾å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(2^k\cdot n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å¾ˆå¤šè·Ÿåç¥–è¾¹æ— å…³çš„éå†æ˜¯ä¸å¿…è¦çš„ï¼ˆåªæœ‰ä¸€ç§èµ°æ³•ï¼Œå¯ä»¥è®¾æˆè¾¹æƒï¼‰ï¼Œè€ƒè™‘å¯¹æ‰€æœ‰è¿æ¥åç¥–è¾¹çš„ç‚¹å»ºç«‹è™šæ ‘ï¼Œå¹¶æŠŠåŸæ ‘ä¸Šçš„åç¥–è¾¹ä¹Ÿç§»åˆ°è™šæ ‘ä¸Šï¼Œå°±èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(2^k\cdot k)\)&lt;/span&gt; è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1), g1(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g2(n + 1);
    for (int x, y; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1), vis(n + 1);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; be;
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        static int now = 0;
        tag[x] = 1, vis[x] = ++now;
        for (auto i : g[x])
            if (!tag[i]) &amp;#123;
                // fprintf(stderr, &amp;quot;%d -&amp;gt; %d\n&amp;quot;, x, i);
                g1[x].push_back(i), DFS(i, x);
            &amp;#125;
            else if (i != fa &amp;amp;&amp;amp; vis[i] &amp;lt; vis[x])
                be.emplace_back(i, x);
        return;
    &amp;#125;;
    DFS(1, -1);
    &amp;#123; // æ±‚è™šæ ‘
        std::vector&amp;lt;int&amp;gt; dep(n + 1), fa(n + 1), top(n + 1), siz(n + 1), son(n + 1), dfn(n + 1), rfn(n + 1);
        std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
            siz[x] = 1;
            for (auto i : g1[x]) &amp;#123;
                dep[i] = dep[x] + 1;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
            return;
        &amp;#125;;
        DFS(1);
        DFS = [&amp;amp;](int x) &amp;#123;
            static int now = 0;
            dfn[x] = ++now;
            if (son[x])
                top[son[x]] = top[x], DFS(son[x]);
            for (auto i : g1[x])
                if (i != son[x])
                    top[i] = i, DFS(i);
            rfn[x] = now;
            // printf(&amp;quot;%d: [%d, %d]\n&amp;quot;, x, dfn[x], rfn[x]);
            return;
        &amp;#125;;
        top[1] = 1, DFS(1);
        auto getLCA = [&amp;amp;](int x, int y) &amp;#123;
            for (; top[x] != top[y]; x = fa[top[x]])
                if (dep[top[x]] &amp;lt; dep[top[y]])
                    std::swap(x, y);
            return dep[x] &amp;lt; dep[y] ? x : y;
        &amp;#125;;
        tag.assign(n + 1, 0);
        tag[1] = tag[n] = 1;
        for (auto [u, v] : be)
            tag[u] = 1, tag[v] = 1;
        std::vector&amp;lt;int&amp;gt; p;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (tag[i])
                p.push_back(i);
        std::sort(p.begin(), p.end(), [&amp;amp;](int i, int j) &amp;#123; return dfn[i] &amp;lt; dfn[j]; &amp;#125;);
        for (int i = 1; i &amp;lt; (int)p.size(); ++i) &amp;#123;
            int fa = getLCA(p[i], p[i - 1]);
            if (!tag[fa])
                tag[fa] = 1;
        &amp;#125;
        p.clear();
        for (int i = 1; i &amp;lt;= n; ++i)
            if (tag[i])
                p.push_back(i);
        std::sort(p.begin(), p.end(), [&amp;amp;](int i, int j) &amp;#123; return dfn[i] &amp;lt; dfn[j]; &amp;#125;);
        std::vector&amp;lt;int&amp;gt; st;
        for (auto i : p) &amp;#123;
            if (st.empty())
                st.push_back(i);
            else &amp;#123;
                for (; rfn[st.back()] &amp;lt; dfn[i]; st.pop_back());
                g2[st.back()].emplace_back(i, dep[i] - dep[st.back()]);
                g2[i].emplace_back(st.back(), dep[i] - dep[st.back()]);
                // printf(&amp;quot;add (%d, %d): %d\n&amp;quot;, st.back(), i, dep[i] - dep[st.back()]);
                st.push_back(i);
            &amp;#125;
        &amp;#125;
        for (auto [u, v] : be) &amp;#123;
            g2[u].emplace_back(v, 1), g2[v].emplace_back(u, 1);
            // printf(&amp;quot;# add(%d, %d): 1\n&amp;quot;, u, v);
        &amp;#125;
    &amp;#125;
    tag.assign(n + 1, 0);
    std::vector&amp;lt;int&amp;gt; res(n + 1);
    DFS = [&amp;amp;](int x, int s) &amp;#123;
        if (x == n)
            ++res[s];
        tag[x] = 1;
        for (auto [i, w] : g2[x])
            if (!tag[i])
                DFS(i, s + w);
        tag[x] = 0;
        return;
    &amp;#125;;
    DFS(1, 0);
    for (int i = 1; i &amp;lt; n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <category term="AC è‡ªåŠ¨æœº" />
        <category term="è´ªå¿ƒ" />
        <category term="DP ä¼˜åŒ–" />
        <category term="è™šæ ‘" />
        <updated>2025-08-16T08:14:12.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250709/</id>
        <title>ç»ƒä¹  - DP å‡¸ä¼˜åŒ–</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250709/"/>
        <content type="html">&lt;p&gt;Stewartâ€™s theoremï¼šåœ¨çº¿æ®µ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸Šå–ä¸€ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\vec{AB}=\lambda \vec{AM}\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸Šæ–¹ä»»å–ä¸€ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt;ï¼Œåˆ™æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(PM^2=(1-\lambda) PA^2+\lambda PB^2-\lambda(1-\lambda) AB^2\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-akvizna&#34;&gt;D. Akvizna&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6393/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6393/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¶å®åˆ°è¿™é‡Œåº”è¯¥å‘ç°äº†ï¼ŒWQS çš„å¥–åŠ±éƒ½ä»¥ä¸€æ¬¡é¡¹ç³»æ•°å‡ºç°ï¼ŒåŸå› ä¹Ÿå¾ˆæ˜¾ç„¶ï¼Œå¥–åŠ±çš„å¯¹è±¡æ˜¯ä¸€æ¬¡é¡¹ç³»æ•°å˜›ã€‚æ­¤å¤–ï¼ŒWQS å†…å±‚ DP æ•°ç»„çš„ç»´åº¦éƒ½åº”å’Œæ“ä½œæ¬¡æ•°æ— å…³ï¼Œè€Œ DP å€¼åº”ä¸ºæœ€å¤§æ”¶ç›Šã€‚è¿™ä¸ªä¹Ÿå¾ˆæ˜¾ç„¶ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ä¸€è½®æ¯”èµ›çš„æƒ©ç½šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(mid\)&lt;/span&gt; ç„¶åäºŒåˆ†ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{j}\)&lt;/span&gt; è¡¨ç¤ºå‰©ä½™äººæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ—¶çš„æœ€å¤§æ”¶ç›Šï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{j}=\max\limits_{k\ge j}\left\{f_k+\frac {k-j}k\right\}-mid\)&lt;/span&gt;ã€‚æœ€ååœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f_0\)&lt;/span&gt; å¤„æ‰¾ç­”æ¡ˆå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å‘ç°ä¸€ä¸ªå¾ˆå¯æ€•çš„é—®é¢˜ï¼Œå†…å±‚ DP å’‹å†™ã€‚å‘ç°æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\frac {k-j}k\)&lt;/span&gt; æ”¹å†™æˆ &lt;span class=&#34;math inline&#34;&gt;\(1-\frac jk\)&lt;/span&gt; åå‡ºç°äº¤å‰é¡¹ï¼Œè€ƒè™‘æ–œä¼˜ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;lt;b\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¼˜äº &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {f_a-f_b}{\frac 1a - \frac 1b} &amp;gt; j\)&lt;/span&gt;ã€‚ç»´æŠ¤å•å‡çš„æ–œç‡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;ç¬‘è¯ï¼šäºŒåˆ† 50 æ¬¡ä¸å¤Ÿï¼Œéœ€è¦ 60 æ¬¡ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    double l = 0., r = 1e5, mid;
    auto calc = [&amp;amp;](double mid) &amp;#123;
        std::vector&amp;lt;double&amp;gt; f(n + 1, -1e18);
        f[n] = 0.;
        int h = 1, t = 0;
        std::vector&amp;lt;int&amp;gt; q(n + 1), p(n + 1);
        q[++t] = n;
        // printf(&amp;quot;mid = %.3lf: \n&amp;quot;, mid);
        for (int i = n - 1; ~i; --i) &amp;#123;
            for (; h &amp;lt; t &amp;amp;&amp;amp; (f[q[h + 1]] - f[q[h]]) / (1. / q[h + 1] - 1. / q[h]) &amp;gt;= i; ++h);
            f[i] = f[q[h]] + 1. - i * 1.0 / q[h] - mid, p[i] = p[q[h]] + 1;
            // printf(&amp;quot;  %d: f = %.3lf, p = %d, q[h] = %d(%.3lf / %d)\n&amp;quot;, i, f[i], p[i], q[h], f[q[h]], p[q[h]]);
            if (i) &amp;#123;
                for (; h &amp;lt; t &amp;amp;&amp;amp; (f[i] - f[q[t]]) / (1. / i - 1. / q[t]) &amp;gt;= (f[q[t]] - f[q[t - 1]]) / (1. / q[t] - 1. / q[t - 1]); --t);
                q[++t] = i;
            &amp;#125;
        &amp;#125;
        // printf(&amp;quot;res = %.3lf\n&amp;quot;, f[0] + p[0] * mid);
        return std::make_pair(f[0], p[0]);
    &amp;#125;;
    // calc(0.);
    // return 0;
    double res(0.);
    for (int i = 1; i &amp;lt;= 60; ++i) &amp;#123;
        mid = (l + r) / 2.;
        auto t(calc(mid));
        if (t.second &amp;gt;= k)
            l = mid, res = t.first + k * mid;
        else
            r = mid;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(8) &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-poborcy-podatkowi&#34;&gt;E. Poborcy podatkowi&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6393/problem/5&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6393/problem/5&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,l}(i),l=0,1,2,3\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸ŠæŒ‚äº†é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; çš„åŠæ¡é“¾ï¼Œå…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¡æ•´é“¾çš„æœ€å¤§æ”¶ç›Šã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥è§‚å¯Ÿåˆ°æ˜¯å‡¸çš„ã€‚é‚£ä¹ˆä¸éš¾å‘ç°éœ€è¦é—µå¯å¤«æ–¯åŸºå’Œï¼Œè€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä½ç½®ä¸Šçš„åˆå¹¶ã€‚&lt;strong&gt;é¦–å…ˆéœ€è¦æ³¨æ„åˆ°å„¿å­ä¸Šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(l\)&lt;/span&gt; çš„é“¾åˆ°çˆ¶äº²ä¸Šä¼šå˜æˆ &lt;span class=&#34;math inline&#34;&gt;\(l+1\)&lt;/span&gt;&lt;/strong&gt;ã€‚æ˜¾ç„¶æ¯æ¡å¯ä»¥ä¸é€‰ï¼›å¦‚æœé€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(cnt_a\)&lt;/span&gt; æ¡é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„åŠé“¾ï¼Œé‚£ä¹ˆåˆå¹¶å‡ºæ¥çš„ç»“æœæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(cnt_1-cnt_3\)&lt;/span&gt; æ¡é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; çš„é“¾ã€&lt;span class=&#34;math inline&#34;&gt;\(cnt_2\bmod 2\)&lt;/span&gt; æ¡é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; çš„é“¾ï¼Œå¹¶ä¸”è¦æ±‚ä¸¤è€…ä¸åŒæ—¶å‡ºç°ã€‚å‘ç°è¿™ä¸ªä¸œè¥¿åŸºæœ¬ä¸Šå¤„ç†ä¸äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€æ³¨æ„åˆ°è¿™ä¸ªå½¢å¼æœ‰ç‚¹åƒèƒŒåŒ…ã€‚ä½†æ€ä¹ˆå¤„ç† &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt; é…å¯¹çš„è¿™ä¸ªè¦æ±‚å‘¢ï¼Ÿæœ‰ä¸ªéå¸¸ç²¾å¦™çš„åœ¨ç‰©å“ä½“ç§¯ä¸Šåšæ–‡ç« çš„æ–¹æ³•ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ³¨æ„åˆ°æˆ‘ä»¬æœ€åçš„æŸ¥è¯¢çš„ç­”æ¡ˆè‚¯å®šè¦æ±‚æŠŠæ‰€æœ‰å„¿å­ç”¨å®Œã€‚é‚£ä¹ˆä¸å¦¨è®¾ä½“ç§¯ä¹‹å’Œä¸ºå„¿å­æ€»æ•° &lt;span class=&#34;math inline&#34;&gt;\(tot\)&lt;/span&gt;ã€‚æ¥ç€ï¼Œå¯¹ &lt;span class=&#34;math inline&#34;&gt;\(cnt_0\)&lt;/span&gt;ï¼ˆåŒæ—¶ä¹Ÿæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(cnt_4\)&lt;/span&gt;ï¼‰æ²¡æœ‰é™åˆ¶ï¼Œç›´æ¥ä»¤å…¶ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(cnt_2\)&lt;/span&gt; å•ç‹¬å¤„ç†ï¼ˆç­‰ä¼šå„¿ä¼šè¯´ï¼‰ï¼Œä¸ºäº†ä¸å¯¹ç°åœ¨çš„é—®é¢˜äº§ç”Ÿå½±å“ä¹Ÿä»¤å…¶ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt;ï¼Œæ˜¾ç„¶ä¸¤è€…å¹³å‡ä½“ç§¯éœ€è¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼›ä½ å¯ä»¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt; ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±æœ‰ä¸ªå¾ˆå¥½çš„æ€§è´¨ï¼š&lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; å¿…é¡»å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt; é…å¯¹æ‰èƒ½è®©å¹³å‡ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(tot\)&lt;/span&gt; å¤„æŸ¥æ‰¾çš„ç­”æ¡ˆï¼Œç”± &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªä½“ç§¯ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ç‰©å“å’Œ &lt;span class=&#34;math inline&#34;&gt;\(tot-x\)&lt;/span&gt; ä¸ªä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ç‰©å“ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt;ï¼‰ç»„æˆï¼ŒåŸå› æ˜¯èƒŒåŒ…ä¼šè´ªå¿ƒåœ°åœ¨æ‰€æœ‰ã€å‰©ä½™ã€çš„åˆ†ç»„ä¸­é€‰æ‹©ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ä¸€é¡¹ã€‚å†è®¡ç®—ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt;ï¼Œå‘ç°æ˜¾ç„¶ä¸º &lt;span class=&#34;math inline&#34;&gt;\(tot-x\)&lt;/span&gt;ã€‚ç¬¦åˆç›®çš„ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(dp_{tot}\)&lt;/span&gt; å¤„æŸ¥æ‰¾å¯ä»¥æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(cnt_1=cnt_3\)&lt;/span&gt; æ—¶çš„ç­”æ¡ˆï¼›åŒç†ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(dp_{tot-1},dp_{tot1+1}\)&lt;/span&gt; å¤„å¯ä»¥æŸ¥æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(cnt_1=cnt_3\pm 1\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥å†è€ƒè™‘ &lt;span class=&#34;math inline&#34;&gt;\(cnt_2\)&lt;/span&gt;ï¼Œè§£å†³ã€&lt;span class=&#34;math inline&#34;&gt;\(cnt\bmod2=1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\ne cnt_3\)&lt;/span&gt; ä¸èƒ½åŒæ—¶æˆç«‹ã€çš„é™åˆ¶ã€‚é‚£å¤ªå¥½äº†ï¼Œç›´æ¥å¤šå¼€ä¸€ç»´è®°å½• &lt;span class=&#34;math inline&#34;&gt;\(cnt_2\bmod 2\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å•Šå•Šå¤ªå¦™äº†ã€‚åƒåˆ©ç”¨ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1,1\)&lt;/span&gt; çš„éšæœºæ•°æ®èƒŒåŒ…æœŸæœ›æœ€å¤§ä½“ç§¯ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(\sqrt V\)&lt;/span&gt; çš„é‚£ä¸ªæ–¹æ³•ï¼Œæ˜¾ç„¶å°±æ²¡æœ‰åŠæ³•åˆ©ç”¨å‡¸æ€§äº†ã€‚æ‰€ä»¥è¿™æˆ–è®¸æ˜¯é—µå¯å¤«æ–¯åŸºå’Œåšæ³•çš„å”¯ä¸€è§£ï¼Ÿ&lt;/p&gt;
&lt;p&gt;éœ€è¦çŸ¥é“ï¼Œå¦‚æœè®¾ &lt;span class=&#34;math inline&#34;&gt;\(cnt_1\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; è€Œ &lt;span class=&#34;math inline&#34;&gt;\(cnt_3\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œå§‹ç»ˆä¼šå‡ºä¸€äº›é—®é¢˜ã€‚è¿™ä¸ªæˆ‘å’Œ yly è®¨è®ºäº†ä¸€ä¸‹æ²¡å•¥ç»“æœã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e12;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;1.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y, w; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w;
        g[x].emplace_back(y, w), g[y].emplace_back(x, w);
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    std::vector&amp;lt;arr&amp;gt; f(n + 1, arr(4));
    struct node &amp;#123;
        std::vector&amp;lt;arr&amp;gt; f;
        node(): f(2) &amp;#123;&amp;#125;
        node(std::vector&amp;lt;arr&amp;gt; f1): f(f1) &amp;#123;&amp;#125;
        arr&amp;amp; operator[](int q) &amp;#123;
            return f[q];
        &amp;#125;
    &amp;#125;;
    auto getmax = [&amp;amp;](arr p, arr q) &amp;#123;
        arr res(p);
        if (q.size() &amp;gt; p.size())
            res.resize(q.size());
        for (int i = 0; i &amp;lt; (int)q.size(); ++i)
            res[i] = std::max(res[i], q[i]);
        return res;
    &amp;#125;;
    auto merge = [&amp;amp;](arr &amp;amp;p, arr &amp;amp;q) &amp;#123;
        arr res(p.size() + q.size() - 1), dp(p.size()), dq(q.size());
        std::adjacent_difference(p.begin(), p.end(), dp.begin());
        std::adjacent_difference(q.begin(), q.end(), dq.begin());
        std::merge(dp.begin() + 1, dp.end(), dq.begin() + 1, dq.end(), res.begin() + 1, std::greater&amp;lt;long long&amp;gt; ());
        res[0] = p[0] + q[0];
        std::partial_sum(res.begin(), res.end(), res.begin());
        return res;
    &amp;#125;; 
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        if ((int)g[x].size() == 1 &amp;amp;&amp;amp; x != 1) &amp;#123;
            f[x][1] = f[x][2] = f[x][3] = -inf;
            return;
        &amp;#125;
        int tot = (int)g[x].size() - (x != 1);
        std::vector&amp;lt;arr&amp;gt; w1(1), w2(1);
        for (auto [i, w] : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                w1.push_back(&amp;#123; f[i][0] + w, std::max(f[i][0], f[i][3] + w), f[i][2] + w &amp;#125;);
                w2.push_back(&amp;#123; -inf, f[i][1] + w &amp;#125;);
            &amp;#125;
        auto fun = [&amp;amp;](arr &amp;amp;p, arr &amp;amp;q) &amp;#123;
            arr res(p.size() + q.size() - 1, -inf);
            for (int ip = 0; ip &amp;lt; 2; ++ip)
                for (int iq = 0; iq &amp;lt; 2; ++iq) &amp;#123;
                    arr tp, tq;
                    for (int i = ip; i &amp;lt; (int)p.size(); i += 2)
                        tp.push_back(p[i]);
                    for (int i = iq; i &amp;lt; (int)q.size(); i += 2)
                        tq.push_back(q[i]);
                    auto t = merge(tp, tq);
                    for (int i = 0; i &amp;lt; (int)t.size(); ++i)
                        if (i * 2 + ip + iq &amp;lt; (int)res.size())
                            res[i * 2 + ip + iq] = std::max(res[i * 2 + ip + iq], t[i]);
                &amp;#125;
            return res;
        &amp;#125;; 
        std::function&amp;lt;node(int, int)&amp;gt; calc = [&amp;amp;](int l, int r) &amp;#123;
            if (l == r)
                return node(&amp;#123; w1[l], w2[l] &amp;#125;);
            int mid = (l + r) &amp;gt;&amp;gt; 1;
            node t1(calc(l, mid)), t2(calc(mid + 1, r));
            return node(&amp;#123; getmax(fun(t1[0], t2[0]), fun(t1[1], t2[1])),
                          getmax(fun(t1[0], t2[1]), fun(t1[1], t2[0])) &amp;#125;);
        &amp;#125;;
        auto t(calc(1, tot));
        f[x][0] = t[0][tot], f[x][1] = t[0][tot - 1], f[x][2] = t[1][tot], f[x][3] = t[0][tot + 1];
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; f[1][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="DP ä¼˜åŒ–" />
        <updated>2025-07-09T13:59:41.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250707-1/</id>
        <title>å†³ç­–å•è°ƒæ€§</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250707-1/"/>
        <content type="html">&lt;p&gt;ç­‰å’Œçº¿ï¼šåœ¨çº¿æ®µ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸Šå–ä¸€ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(M\)&lt;/span&gt;ï¼Œä½¿å¾— &lt;span class=&#34;math inline&#34;&gt;\(\vec{AB}=\lambda \vec{AM}\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(AB\)&lt;/span&gt; ä¸Šæ–¹ä»»å–ä¸€ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(P\)&lt;/span&gt;ï¼Œåˆ™æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\vec{PM}=(1-\lambda) \vec{PA}+\lambda \vec{PB}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯-xdyd-dp&#34;&gt;ä»€ä¹ˆæ˜¯ xD/yD DP&lt;/h2&gt;
&lt;p&gt;å³ DP æ•°ç»„å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç»´ï¼Œä¸€æ¬¡è½¬ç§»å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n^y)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ä¸ºä»€ä¹ˆè¦ç»™ä¸€å¥è¯å•å¼€ä¸€ä¸ªæ ‡é¢˜&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è®¾é€šå¼ &lt;span class=&#34;math inline&#34;&gt;\(f_i=\max\left\{f_j+w(i,j)\right\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–-dp&#34;&gt;å•è°ƒé˜Ÿåˆ—ä¼˜åŒ– DP&lt;/h2&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; ä»…åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; çš„æœ€é«˜ä¸€æ¬¡é¡¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœè¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(j\in [1,i]\)&lt;/span&gt;ï¼Œå‰ç¼€æœ€å°å€¼å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å–å€¼èŒƒå›´åœ¨åˆ°å¤„ä¹±åŠ¨ï¼Œå¯ä»¥å†™ DS =_=&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å–å€¼èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; éšç€ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¢å¤§è€Œ &lt;span class=&#34;math inline&#34;&gt;\(l,r\)&lt;/span&gt; éƒ½ä¸å‡å°ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å•è°ƒé˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;é¡ºå¸¦ä¸€æï¼Œå’Œè¿™ç§çš„å•è°ƒé˜Ÿåˆ—ç”¨æ³•ç›¸ä¼¼çš„ã€å•è°ƒæ ˆã€ä¸»è¦åœ¨æ–œä¼˜é‡Œå‡ºç°ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…·ä½“è¿‡ç¨‹è¢« grizzly bear åƒæ‰äº† &lt;img src=&#34;/em/eat.gif&#34; /&gt;&lt;/p&gt;
&lt;h3 id=&#34;ä¾‹å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…&#34;&gt;ä¾‹ï¼šå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å¤šé‡èƒŒåŒ…&lt;/h3&gt;
&lt;p&gt;æœ´ç´ çš„å¤šé‡èƒŒåŒ…å¼å­æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\max\left\{f_{i-1,j-k\times v_i}+k\times w_i\right\}\)&lt;/span&gt;ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å’Œæ•´ä¸ªå¼å­æ— å…³ï¼Œæ‰€ä»¥æ˜¯å…³äº &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„ 1D/1Dã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å¥—ç”¨å•è°ƒé˜Ÿåˆ—ï¼Œéœ€è¦æŠŠæŸ¥è¯¢çš„é¡¹å˜æˆè¿ç»­çš„ã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(j-k\times v_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å…³äº &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; åŒä½™ï¼›ä¸”éšç€ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å¢å¤§ï¼ŒæŸ¥è¯¢çš„ä½ç½®ä¸æ–­ç§»åŠ¨ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt;ã€‚é‚£ä¹ˆä¸å¦¨æŠŠæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æŒ‰ç…§æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(v_i\)&lt;/span&gt; çš„ä½™æ•°åˆ†å¼€åšã€‚å…·ä½“åœ°ï¼Œä¸å¦¨è®¾ &lt;span class=&#34;math inline&#34;&gt;\(j=a\times v_i+b\)&lt;/span&gt;ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(j-k\times v_i\)&lt;/span&gt; æ›¿æ¢ä¸ºä½™æ•°å†™æ³•ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
f_{i,j}&amp;amp;=\max\{f_{i-1,x\times v_i+b}+(a-x)\times v_i\}\\
&amp;amp;=\max\{f_{i-1,x\times v_i+b}-x\times v_i\}+a\times v_i
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é™åˆ¶ &lt;span class=&#34;math inline&#34;&gt;\((a-x)\)&lt;/span&gt; çš„å–å€¼ä¸è¶…è¿‡ç‰©å“æ•°ï¼Œåœ¨ä¸åŒæ¨¡æ•°ä¸‹æŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä»å°åˆ°å¤§å°† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; è¿™ä¸€ç»´è¿›è¡Œå•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å³å¯ã€‚å®¹æ˜“å‘ç°ä¼šä¸é‡ä¸æ¼æšä¸¾æ‰€æœ‰ä½“ç§¯ï¼›å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(nV)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;æ–œç‡ä¼˜åŒ–-dp&#34;&gt;æ–œç‡ä¼˜åŒ– DP&lt;/h2&gt;
&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; ç§å«æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; çš„äº¤å‰é¡¹ï¼Œå¯ä»¥è€ƒè™‘æ–œä¼˜ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“è¿‡ç¨‹ï¼Œï¼ˆå¦‚æœä½ æ„¿æ„ï¼‰ï¼Œå¯ä»¥çœ‹è¿™ç¯‡ &lt;a href=&#34;/20210214/&#34;&gt;å››å¹´åŠå‰çš„åšå®¢&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å…³äºç¬¦å·ç­‰é—®é¢˜ï¼Œåˆ†äº«ä¸€ä¸‹æˆ‘çš„åšæ³•ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å•è°ƒé˜Ÿåˆ—ç»´æŠ¤ï¼šé€‚ç”¨äºç¬¦å·å’Œå³ä¾§æ–œç‡è¦æ±‚å•è°ƒæ€§ç›¸åçš„æƒ…å†µã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼Œè®¨è®ºé˜Ÿå¤´ç»´æŠ¤ã€‚ä¸å¦¨å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¸ºé˜Ÿå¤´ç¬¬äºŒä¸ªå…ƒç´ ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ä¸ºé˜Ÿå¤´ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœé˜Ÿå¤´ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; éœ€è¦è¢«å¼¹å‡ºï¼Œè¯´æ˜ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ä¼˜äº &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼›å‡è®¾å¼å­è¦æ±‚ maxï¼Œåˆ™ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; è½¬ç§»å¾—åˆ°çš„ç­”æ¡ˆ &amp;gt; ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; è½¬ç§»å¾—åˆ°çš„ç­”æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;åŒ–å¼å­ï¼Œæ³¨æ„ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;gt;b\)&lt;/span&gt;ï¼›ä¸”è´Ÿæ•°ä¹˜é™¤è¦å˜å·ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æœ€åå¾—åˆ°çš„å¼å­ä¸­é—´çš„ä¸ç­‰å·å°±å†³å®šäº†éœ€è¦ç»´æŠ¤çš„æ–œç‡å•è°ƒæƒ…å†µã€‚ä»¥æ­¤å†³å®šé˜Ÿå°¾ç»´æŠ¤æ–¹å¼å³å¯ã€‚&lt;/p&gt;
&lt;strong&gt;æ³¨æ„è¿™ä¸ªå¼å­çš„ä¸ç­‰å·ä½“ç°çš„æ˜¯å¼¹å‡ºæ¡ä»¶ï¼›ä¿ç•™æ¡ä»¶å’Œå…¶ç›¸å&lt;/strong&gt; &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å•è°ƒæ ˆç»´æŠ¤ï¼šé€‚ç”¨äºç¬¦å·å’Œå³ä¾§æ–œç‡è¦æ±‚å•è°ƒæ€§ç›¸åŒçš„æƒ…å†µï¼›éœ€è¦æ¸…æ¥šï¼Œç»´æŠ¤åˆæ³•æ€§ã€ç»´æŠ¤å•è°ƒå’Œå–ç­”æ¡ˆéƒ½åœ¨æ ˆé¡¶è¿›è¡Œã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;é¦–å…ˆï¼Œéƒ½çŸ¥é“è¦ç”¨å•è°ƒæ ˆäº†ï¼Œè¯´æ˜æ–œä¼˜å½¢å¼å·²ç»è¢«åŒ–å‡ºæ¥äº†ï¼›ä»¥æ­¤ç»´æŠ¤åˆæ³•æ€§å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;ç»´æŠ¤ä¸€ä¸ªä»åº•åˆ°é¡¶ï¼Œã€ä¼˜ã€å¾—è¶Šæ¥è¶Šå°çš„æ–œç‡åºåˆ—ã€‚æ‰¾åˆ°ä»æ›´ä¼˜åˆ°æ›´åŠ£çš„ä¸´ç•Œç‚¹ï¼Œæ›´æ–°ç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å•Šï¼Œæœç„¶é«˜ä¸­æ–‡åŒ–å­¦ç§‘æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ç®—æ˜¯æ˜ç™½ä¸ºä»€ä¹ˆæˆ‘å°å­¦ / åˆä¸­åŸºæœ¬æ²¡å¼„æ‡‚è¿‡æ–œä¼˜ï¼Œè€Œæ—è¾¹çš„å¤§ä½¬å·²ç»åœ¨ä¹±æ€äº† &lt;img src=&#34;/em/hsh.gif&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;ç°åœ¨å‡è®¾æ­£åœ¨ç»´æŠ¤ä¸€ä¸ªä¸Šå‡¸åŒ…ï¼Œå¯ä»¥è¿›è¡Œä¸€äº›æ€è€ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å¦‚æœæŸ¥è¯¢åŒºé—´ä¸å•å¢ï¼Ÿ&lt;/p&gt;
æä¸äº†å•Šè¿™ä¸ªã€‚åºŸäº†ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŸ¥è¯¢çš„æ–œç‡ä¸å•å¢ï¼Ÿ&lt;/p&gt;
å†™ä¸ªäºŒåˆ† + å•è°ƒæ ˆã€‚å‚è§ &lt;a href=&#34;https://www.luogu.com.cn/problem/P5785&#34;&gt;ä»»åŠ¡å®‰æ’&lt;/a&gt;ã€&lt;a href=&#34;#ä¾‹traka&#34;&gt;TRAKA&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;åŠ å…¥æ–œç‡çš„ä½ç½®ä¸å•å¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æè¶… / CDQ / å¹³è¡¡æ ‘ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–-dp&#34;&gt;å››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ– DP&lt;/h2&gt;
&lt;h3 id=&#34;å…³äºå››è¾¹å½¢ä¸ç­‰å¼&#34;&gt;å…³äºå››è¾¹å½¢ä¸ç­‰å¼&lt;/h3&gt;
&lt;p&gt;å¯¹äºä»£ä»·çŸ©é˜µ &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; å’Œå®šä¹‰åŸŸå†… &lt;span class=&#34;math inline&#34;&gt;\(\forall\,a\le b\le c\le d\)&lt;/span&gt;ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(a,d)+w(b,c)\ge w(a,c)+w(b,d)\)&lt;/span&gt;ï¼Œè®¤ä¸º &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚ç®€è®°ä¸ºé‡å å¤§äºäº¤å‰ã€‚&lt;/p&gt;
&lt;p&gt;å‘½åæ¥æºæ˜¯å››è¾¹å½¢å¯¹è§’çº¿ä¹‹å’Œå¤§äºå¯¹è¾¹ä¹‹å’Œï¼›å°†æ’å¤§äºæ”¹ä¸ºæ’å°äºä¹Ÿèƒ½å¾—åˆ°ç›¸ä¼¼çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;p&gt;å°±ä¼šå‘ç°å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–å’Œæ–œä¼˜å…¶å®æ˜¯å››è¾¹å½¢ä¸ç­‰å¼çš„ç‰¹åŒ–ï¼Œå¯¼è‡´å®ƒä»¬å¯ä»¥å°‘ä¸€ä¸ª logã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æ€§è´¨&#34;&gt;æ€§è´¨&lt;/h3&gt;
&lt;p&gt;ç”¨äºè¯æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(c\le l\le r\)&lt;/span&gt;ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(l-c,r+c) + w(l,r)\le w(l-c,r)+ w(l,r+c)\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç”¨äºé¢˜ç›®ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;æ€§è´¨ä¸€&lt;/strong&gt;ï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼ˆæˆ–å…¶åå¼ï¼‰ï¼Œé‚£ä¹ˆæœ€ä¼˜å†³ç­–ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(p_i\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœ‰å•è°ƒå…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;æ€§è´¨äºŒ&lt;/strong&gt;ï¼šå½“ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å˜åŒ–æ—¶ï¼Œæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¸¦æ¥è´¡çŒ®çš„ç›¸å¯¹å¤§å° rank ä¸å˜ã€‚äº¦ä½œï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(j_1\)&lt;/span&gt; ç›¸å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(j_2\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ›´ä¼˜ï¼Œå¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;#39;\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(j_1\)&lt;/span&gt; ç›¸å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(j_2\)&lt;/span&gt; å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(i&amp;#39;\)&lt;/span&gt; æ›´ä¼˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;åœ¨ä¼˜åŒ–-dp-ä¹‹å‰&#34;&gt;åœ¨ä¼˜åŒ– DP ä¹‹å‰&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;é¦–å…ˆæˆ‘å¿…é¡»è¦æä¸€å˜´ã€‚ç”±äºæˆ‘ç¬¬ä¸€æ¬¡æ¥è§¦ã€å››è¾¹å½¢ä¸ç­‰å¼ã€æ˜¯åœ¨å››å¹´å‰ï¼Œçœ‹åˆ°ã€çŸ³å­åˆå¹¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; åšæ³•ã€æ—¶ã€‚ç„¶è€Œï¼Œè¿™ä¸€é¢˜çš„ DP æœ¬èº«æœ‰ä¸€ä¸ªç‰¹æ®Šæ€§è´¨ï¼Œå³è´¡çŒ®æ˜¯ä¸€ä¸ªä»¥å†³ç­–ç‚¹ä¸ºæå€¼çš„å‡¸å‡½æ•°ï¼›è¿™ç›´æ¥å¯¼è‡´æˆ‘è¯¯ä»¥ä¸ºè¿™æ˜¯å››è¾¹å½¢ä¸ç­‰å¼æœ¬èº«å¸¦æ¥çš„æ€§è´¨ï¼Œå¯¼è‡´æˆ‘åœ¨ç†è§£ä¸Šæµªè´¹äº†å¾ˆå¤šæ—¶é—´ã€‚&lt;strong&gt;å››è¾¹å½¢ä¸ç­‰å¼å¸¦æ¥çš„æ€§è´¨ï¼Œåªæœ‰ä¸Šè¿°ä¸¤æ¡ï¼&lt;/strong&gt;&lt;/p&gt;
å½“ç„¶è¿™ä¹Ÿå‘Šè¯‰æˆ‘ä»¬ï¼Œå¦‚æœä½ å‘ç°ã€è´¡çŒ®æ˜¯ä¸€ä¸ªä»¥å†³ç­–ç‚¹ä¸ºæå€¼çš„å‡¸å‡½æ•°ã€ï¼Œä½ å°±å¯ä»¥ç”¨ç±»ä¼¼çŸ³å­åˆå¹¶ä¸­çš„çº¿æ€§è½¬ç§»å®Œæˆé—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ã€æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€å¹¶ä¸èƒ½ç­‰ä»·äºã€å†³ç­–å•è°ƒæ€§ã€ã€‚å†³ç­–å•è°ƒæ€§å¹¶ä¸å…·å¤‡æ€§è´¨äºŒã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœåªæ»¡è¶³å†³ç­–å•è°ƒæ€§ï¼Œåªæœ‰æœ€ä¼˜å†³ç­–ç‚¹æ˜¯å•è°ƒçš„ï¼Œä½†è´¡çŒ®å‡½æ•°éšç€ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å˜åŒ–ï¼Œå…¶å½¢çŠ¶ä¼šæœ‰å¾ˆå¤§çš„å˜åŠ¨ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¼˜åŒ–-dpåˆ†æ²»&#34;&gt;ä¼˜åŒ– DPï¼šåˆ†æ²»&lt;/h3&gt;
&lt;p&gt;ä¸»è¦é€‚ç”¨äº &lt;span class=&#34;math inline&#34;&gt;\(f_{i}=g_j+w(j,i)\)&lt;/span&gt; çš„åœºæ™¯ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(g\)&lt;/span&gt; æ˜¯ä¸ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ— å…³çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºåˆ†æ²»èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; å’Œå…¶å†³ç­–ç‚¹èŒƒå›´ &lt;span class=&#34;math inline&#34;&gt;\([L_p,R_p]\)&lt;/span&gt;ï¼Œé¦–å…ˆæŠŠæš´åŠ› &lt;span class=&#34;math inline&#34;&gt;\(mid\)&lt;/span&gt; çš„å†³ç­–ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(p_{mid}\)&lt;/span&gt; æ‰¾å‡ºæ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\([l,mid)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((mid,R]\)&lt;/span&gt;ï¼Œåˆ†åˆ«åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([L_p,p_{mid}]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\([p_{mid},R_p]\)&lt;/span&gt; é‡Œæ‰¾å†³ç­–ç‚¹ï¼ˆæ³¨æ„ä¸¤è¾¹éƒ½æ˜¯é—­çš„ï¼‰ã€‚é€’å½’åœ°åšã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™ä½ è‚¯å®šå°±ä¼šæ€€ç–‘äº†ï¼Œä¸»æ’­ä¸»æ’­ï¼Œè™½ç„¶ä½ çš„åŒºé—´æ¯æ¬¡åœ¨å‡åŠï¼Œä½†å†³ç­–ç‚¹èŒƒå›´å¹¶ä¸æ˜¯å‡åˆ†çš„ï¼Œè¿˜ä¼šè¢«å…±ç”¨ï¼Œå¤æ‚åº¦çœŸçš„å¯¹å—ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯¹çš„å…„å¼Ÿï¼Œå¯¹çš„ã€‚è§‚å¯Ÿæœç´¢æ ‘ï¼Œä½ ä¼šå‘ç°è™½ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(p_{mid}\)&lt;/span&gt; ä¼šè¢«ç»™ä¸¤ä¸ªå„¿å­å…±ç”¨ï¼Œä½†æ˜¯åœ¨ä»»ä½•ä¸€å±‚ä¸­ï¼Œè¢«é‡å¤ç»è¿‡çš„ç‚¹åªä¼šå‡ºç°åœ¨ä¸¤ä¸ªåŒºé—´çš„äº¤ç•Œå¤„ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯æ•´å±‚å¤§æ¦‚éå† &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt; æ¬¡ã€‚æ˜¯ä¸æ˜¯å¾ˆå¯¹äº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;ä¾‹yet-another-minimization-problem&#34;&gt;ä¾‹ï¼šYet Another Minimization Problem&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/868/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/868/F&lt;/a&gt;&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;æˆ‘çš„å¤©å“ªï¼æ˜¯ç½•è§çš„å››çº§æ ‡é¢˜ï¼&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;ç¬‘ç‚¹è§£æï¼šè¿™ä¸ªäººå› ä¸ºæ‡’å¾—å†™ CSS æ‰€ä»¥åªå†™äº†ç»å¸¸ç”¨çš„ h2 å’Œ h3 çš„æ ·å¼ï¼Œç°åœ¨è¿«ä¸å¾—å·²ç”¨ h4 è¢«å€’é€¼å»å†™äº† h4 çš„ CSSã€‚&lt;/p&gt;
&lt;/details&gt;
&lt;p&gt;å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(k\le 20\)&lt;/span&gt;ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨å†™ WQS äºŒåˆ†ã€‚ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ®µåˆ†åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¤„çš„ä»£ä»·ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\min\{f_{i-1,l}+w(l+1,j)\}\)&lt;/span&gt;ï¼Œåˆ†æ²»è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€å‘ç°é—®é¢˜ï¼š&lt;span class=&#34;math inline&#34;&gt;\(w(l+1,j)\)&lt;/span&gt; å¹¶ä¸èƒ½å¾ˆå¿«åœ°æ±‚å‡ºæ¥ï¼›ç„¶åæ³¨æ„åˆ°è¿™ä¸ªä»£ä»·çš„å½¢å¼å¾ˆè«é˜Ÿï¼ˆå…¶å®åœ¨çœ‹åˆ°è¿™ä¸ªé¢˜çš„æ—¶å€™å°±ä¼šæœ‰è«é˜Ÿçš„æƒ³æ³•ï¼‰ï¼Œè€ƒè™‘ä½¿ç”¨è«é˜Ÿç§»åŠ¨ç«¯ç‚¹çš„æ–¹å¼è§£å†³é—®é¢˜ã€‚ç”±äºåˆ†æ²»ä¸­æŸ¥è¯¢çš„åŒºé—´ä¸¤ç«¯å•å¢ï¼Œæ¯å±‚çš„æ€»ç§»åŠ¨æ¬¡æ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ï¼Œæ€»å¤æ‚åº¦å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(nk\log n)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e12;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;long long&amp;gt; cnt(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; p(k + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(k + 1, std::vector&amp;lt;long long&amp;gt; (n + 1, inf));
    auto w = [&amp;amp;](int l, int r) &amp;#123;
        static int L = 1, R = 0;
        static long long res = 0ll;
        for (; L &amp;gt; l; --L, res -= cnt[a[L]] * (cnt[a[L]] - 1) / 2, ++cnt[a[L]], res += cnt[a[L]] * (cnt[a[L]] - 1) / 2);
        for (; R &amp;gt; r; res -= cnt[a[R]] * (cnt[a[R]] - 1) / 2, --cnt[a[R]], res += cnt[a[R]] * (cnt[a[R]] - 1) / 2, --R);
        for (; R &amp;lt; r; ++R, res -= cnt[a[R]] * (cnt[a[R]] - 1) / 2, ++cnt[a[R]], res += cnt[a[R]] * (cnt[a[R]] - 1) / 2);
        for (; L &amp;lt; l; res -= cnt[a[L]] * (cnt[a[L]] - 1) / 2, --cnt[a[L]], res += cnt[a[L]] * (cnt[a[L]] - 1) / 2, ++L);
        return res;
    &amp;#125;;
    f[0][0] = 0ll;
    for (int t = 1; t &amp;lt;= k; ++t) &amp;#123;
        std::function&amp;lt;void(int, int, int, int)&amp;gt; calc = [&amp;amp;](int l, int r, int lp, int rp) &amp;#123;
            if (l &amp;gt; r)
                return;
            if (l == r) &amp;#123;
                for (int i = lp; i &amp;lt;= rp &amp;amp;&amp;amp; i &amp;lt; l; ++i)
                    if (f[t - 1][i] + w(i + 1, l) &amp;lt; f[t][l])
                        f[t][l] = f[t - 1][i] + w(i + 1, l), p[t][l] = i;
                return;
            &amp;#125;
            int mid = (l + r) &amp;gt;&amp;gt; 1;
            for (int i = lp; i &amp;lt;= rp &amp;amp;&amp;amp; i &amp;lt; mid; ++i)
                if (f[t - 1][i] + w(i + 1, mid) &amp;lt; f[t][mid])
                    f[t][mid] = f[t - 1][i] + w(i + 1, mid), p[t][mid] = i;
            calc(l, mid - 1, lp, p[t][mid]), calc(mid + 1, r, p[t][mid], rp);
            return;
        &amp;#125;;
        calc(1, n, 0, n - 1);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[k][n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¼˜åŒ–-dpå•è°ƒæ•°æ®ç»“æ„&#34;&gt;ä¼˜åŒ– DPï¼šå•è°ƒæ•°æ®ç»“æ„&lt;/h3&gt;
&lt;p&gt;æœ‰çš„æ—¶å€™ä¼šå‡ºç° &lt;span class=&#34;math inline&#34;&gt;\(f_{i}=f_{j}+w(j,i)\)&lt;/span&gt; çš„ç»“æ„ï¼Œä¹Ÿå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; çš„å–å€¼ä¸è‡ªå·±æœ‰å…³ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æƒ…å†µæˆ‘ä»¬é€šå¸¸é€‰æ‹©å¡«è¡¨æ³•ï¼Œæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; åæ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ˜¯å“ªäº›ç‚¹çš„æœ€ä¼˜å†³ç­–ï¼ˆé‚£ä¹ˆæ˜¾ç„¶è¿™äº›ç‚¹æ˜¯ä¸€æ®µè¿ç»­åŒºé—´ï¼‰ã€‚ç”¨ &lt;span class=&#34;math inline&#34;&gt;\((i,l_i,r_i)\)&lt;/span&gt; è¿™ä¸ªä¸‰å…ƒç»„è¡¨ç¤ºå½“å‰ç®—å‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç®¡è¾–çš„èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿç»“åˆæ€§è´¨äºŒï¼Œæ¯å½“æˆ‘ä»¬æ‰‹ä¸Šæ‹¿åˆ°ä¸€ä¸ªæ–°çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæ¨å‡ºæ¥å…¶ç®¡è¾–èŒƒå›´å³ç«¯ç‚¹å°±ä¼šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ã€‚æ¥ç€æƒ³åŠæ³•æ‰¾åˆ°å·¦ç«¯ç‚¹ï¼ŒåŒæ ·åˆ©ç”¨æ€§è´¨äºŒï¼ŒäºŒåˆ†å‡ºæœ€é å·¦çš„ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œæ»¡è¶³ä¹‹å‰ç®—å‡ºæ¥çš„å†³ç­–ç‚¹æ²¡æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¼˜ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\([j,n]\)&lt;/span&gt; å°±æ˜¯å½“å‰æ¡ä»¶ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ç®¡è¾–èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨é˜Ÿåˆ—é‡ŒåŠ å…¥å½“å‰ç‰ˆæœ¬çš„æ•´ä¸ªä¸‰å…ƒç»„åºåˆ—å°±å¯ä»¥æ–¹ä¾¿åœ°å®Œæˆè¿™ä¸ªè¿‡ç¨‹ã€‚ä¸ºå¯»æ‰¾å½“å‰å…ƒç´ çš„ç­”æ¡ˆï¼Œéœ€è¦å°†é˜Ÿå¤´ä¸Šï¼Œç®¡è¾–èŒƒå›´å®Œå…¨æ—©äºå½“å‰å…ƒç´ çš„å¼¹å‡ºå»ã€‚ç”±äºç»´æŠ¤çš„è¿‡ç¨‹å’Œå•è°ƒé˜Ÿåˆ—å¾ˆåƒï¼Œæ‰€ä»¥ä¹Ÿæœ‰äººç›´æ¥æŠŠè¿™é‡Œçš„é˜Ÿåˆ—å«å•è°ƒé˜Ÿåˆ—ã€‚&lt;/p&gt;
&lt;p&gt;è§†é¢˜ç›®ä¸åŒï¼Œä¹Ÿå¯èƒ½ç”¨åˆ°å•è°ƒæ ˆï¼Œä¹Ÿæœ‰å¯èƒ½ä¸ç”¨äºŒåˆ†ï¼ˆä¾‹å¦‚æ»¡è¶³å‰ä¸¤ç§ç‰¹åŒ–çš„æƒ…å†µï¼‰ã€‚goto &lt;a href=&#34;/20250715/#a---yakiniku-restaurants&#34;&gt;Yakiniku Restaurants&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;ä¾‹è¯—äººå°g&#34;&gt;ä¾‹ï¼šè¯—äººå°G&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P1912&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P1912&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;æˆ‘è§‰å¾—ç»™å‡ºå­—ç¬¦ä¸²å†…å®¹çš„å”¯ä¸€ä»·å€¼æ˜¯è®©å‡ºé¢˜äººæ¬£èµç™½æ—¥ä¾å±±å°½&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{j}\)&lt;/span&gt; ä¸ºæŸä¸€è¡Œåˆ†åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; å¥å¤„çš„ä»£ä»·ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{j}=\min\limits_{k&amp;lt;j}\left\{f_{k}+|(s_j-s_k+j-k-1)-L|^P\right\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘å•è°ƒé˜Ÿåˆ— + äºŒåˆ†äº†ã€‚éœ€è¦æ³¨æ„æ— ç©·å¤§ä¹‹é—´çš„å¤§å°æ¯”è¾ƒï¼Œæˆ‘å†™è¿™ä¸ªå†™çº¢æ¸©äº†ï¼Œç›´æ¥ç”¨æŒ‡æ•°é¡¹ç›¸å¯¹å¤§å°æ¥ä»£æ›¿äº†ï¼Œä¼¼ä¹å¯ä»¥è¿‡ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1000000000000000001ll;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;P1912_2.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, l, p;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; l &amp;gt;&amp;gt; p;
        long long to;
        switch (p) &amp;#123; // ä¼šæœ‰ç²¾åº¦é—®é¢˜
        case 1:
            to = 1e18;
            break;
        case 2:
            to = 1e9;
            break;
        case 3:
            to = 1e6;
            break;
        case 4:
            to = 31622;
            break;
        case 5:
            to = 3981;
            break;
        case 6:
            to = 1e3;
            break;
        case 7:
            to = 372;
            break;
        case 8:
            to = 177;
            break;
        case 9:
            to = 100;
            break;
        default:
            to = 63;
            break;
        &amp;#125;
        std::vector&amp;lt;int&amp;gt; s(n + 1);
        std::vector&amp;lt;std::string&amp;gt; a(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            std::cin &amp;gt;&amp;gt; a[i], s[i] = (int)a[i].length();
        std::partial_sum(s.begin() + 1, s.end(), s.begin() + 1);
        struct node &amp;#123; int i, l, r; &amp;#125;;
        std::vector&amp;lt;node&amp;gt; q(n + 1);
        int h = 0, t = -1;
        q[++t] = &amp;#123; 0, 1, n &amp;#125;;
        auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
            if (x &amp;gt; to)
                return inf;
            auto res(1ll);
            for (; y--; res *= x);
            return res;
        &amp;#125;;
        std::vector&amp;lt;int&amp;gt; pre(n + 1);
        std::vector&amp;lt;long long&amp;gt; f(n + 1);
        auto calc = [&amp;amp;](int k, int j) &amp;#123;
            return std::min(inf, f[k] + qkp(std::abs(s[j] - s[k] + j - k - 1 - l), p));
        &amp;#125;;
        auto less = [&amp;amp;](int k1, int j1, int k2, int j2) &amp;#123;
            auto t1(calc(k1, j1)), t2(calc(k2, j2));
            if (t1 == inf &amp;amp;&amp;amp; t2 == inf)
                return std::abs(s[j1] - s[k1] + j1 - k1 - 1 - l) &amp;lt; std::abs(s[j2] - s[k2] + j2 - k2 - 1 - l);
            return t1 &amp;lt; t2;
        &amp;#125;;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            for (; h &amp;lt;= t &amp;amp;&amp;amp; q[h].r &amp;lt; i; ++h);
            f[i] = calc(q[h].i, i), pre[i] = q[h].i;
            for (; h &amp;lt;= t &amp;amp;&amp;amp; q[t].l &amp;gt; i &amp;amp;&amp;amp; less(i, q[t].l, q[t].i, q[t].l); --t)
                q[t - 1].r = q[t].r;
            for (int l = std::max(q[t].l, i + 1), r = q[t].r, mid; l &amp;lt;= r; ) &amp;#123;
                mid = (l + r) &amp;gt;&amp;gt; 1;
                if (less(i, mid, q[t].i, mid))
                    r = q[t].r = mid - 1, q[t + 1] = &amp;#123; i, mid, n &amp;#125;;
                else
                    l = mid + 1;
            &amp;#125;
            if (q[t + 1].i == i)
                ++t;
        &amp;#125;
        if (f[n] &amp;gt;= inf)
            std::cout &amp;lt;&amp;lt; &amp;quot;Too hard to arrange&amp;quot; &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        else &amp;#123;
            std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            std::function&amp;lt;void(int)&amp;gt; print = [&amp;amp;](int x) &amp;#123;
                if (x == 0)
                    return;
                print(pre[x]);
                for (int i = pre[x] + 1; i &amp;lt;= x; ++i) &amp;#123;
                    std::cout &amp;lt;&amp;lt; a[i];
                    if (i != x)
                        std::cout &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
                &amp;#125;
                std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
                return;
            &amp;#125;;
            print(n);
        &amp;#125;
        std::cout &amp;lt;&amp;lt; &amp;quot;--------------------&amp;quot;;
        if (T)
            std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;éœ€è¦æ³¨æ„ï¼Œæœ¬é¢˜ä¹Ÿå¯ä»¥å†åŠ ä¸€ä¸ªã€æ°å¥½åˆ† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µã€çš„é™åˆ¶ï¼Œç›´æ¥åœ¨å¤–å±‚å¥—ä¸€ä¸ª WQS äºŒåˆ†å°±å¥½äº†ï¼Œå‚è§ &lt;a href=&#34;https://www.luogu.com.cn/problem/P6246&#34;&gt;é‚®å±€ åŠ å¼ºç‰ˆ åŠ å¼ºç‰ˆ&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;d1d-dp-ä¼˜åŒ–&#34;&gt;2D/1D DP ä¼˜åŒ–&lt;/h3&gt;
&lt;p&gt;è‹¥å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f(i,j)=\min\limits_{k&amp;lt;j} f(i-1,k)+w(k+1,j)\)&lt;/span&gt;ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(p(i,j)\)&lt;/span&gt; ä¸ºæœ€ä¼˜å†³ç­–ç‚¹ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(p(i,j)\le p(i,j+1)\le p(i+1,j+1)\)&lt;/span&gt;ï¼Œäº¦ä½œ &lt;span class=&#34;math inline&#34;&gt;\(p(i,j-1)\le p(i,j)\le p(i+1,j)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt; è§£å†³é—®é¢˜ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image.png&#34; /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å›ºå®šï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)\)&lt;/span&gt; ä¸ºå‡¸å‡½æ•°ã€‚ï¼ˆä¾‹ï¼šé‚®å±€ åŠ å¼ºç‰ˆ åŠ å¼ºç‰ˆï¼‰&lt;/p&gt;
&lt;p&gt;goto &lt;a href=&#34;/20250707/&#34;&gt;DP å‡¸ä¼˜åŒ–&lt;/a&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
        <category term="DP" />
        <category term="DP ä¼˜åŒ–" />
        <updated>2025-07-07T13:23:01.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250707/</id>
        <title>DP å‡¸ä¼˜åŒ–</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250707/"/>
        <content type="html">&lt;p&gt;è¢œï¼Œè¿™ç¯‡æ–‡ç« ä¸€ä¸‹å­åˆ›å»ºäº†ä¸‰ä¸ªæ–° tagã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ä»€ä¹ˆæ˜¯å‡¸å‡½æ•°&#34;&gt;ä»€ä¹ˆæ˜¯å‡¸å‡½æ•°&lt;/h2&gt;
&lt;h3 id=&#34;å®šä¹‰&#34;&gt;å®šä¹‰&lt;/h3&gt;
&lt;p&gt;åœ¨ä¿¡æ¯å­¦ä¸­ç ”ç©¶çš„å‡¸å‡½æ•°å¤§æŠµæ˜¯åªåœ¨æ­£æ•´æ•°åŸŸä¸Šæœ‰å®šä¹‰çš„ï¼Œæ‰€ä»¥åªèƒ½ç›´æ¥æ‘’å¼ƒå¯¼å‡½æ•°çš„æ¦‚å¿µäº†ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥æ–œç‡é€’å¢ï¼Œæ¢è¨€ä¹‹ï¼Œå·®åˆ†æ•°ç»„é€’å¢ï¼Œè®¤ä¸ºå‡½æ•°æ˜¯å‡¸çš„ï¼ˆå¥½åç›´è§‰ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…çœ‹çœ‹ç¬¦å·åŒ–çš„å®šä¹‰ï¼šè‹¥å¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(\lambda\in[0,1]\)&lt;/span&gt;ï¼Œå‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(f(x)\)&lt;/span&gt; å‡æ»¡è¶³ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(\lambda x+(1-\lambda) y)\le \lambda f(x)+(1-\lambda) f(y).
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æˆ–ç­‰ä»·åœ°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(x)-f(x - 1)\le f(x + 1) - f(x)
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆè®¤ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ˜¯å‡¸å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºå‡¹å‡¸åœ¨æ€§è´¨ä¸Šæ²¡åŒºåˆ«ï¼Œæ‰€ä»¥ &lt;strong&gt;ä¸‹æ–‡æ–½è¡Œæš´æ”¿ï¼Œå°†å‡¹å‡½æ•°å’Œå‡¸å‡½æ•°ç»Ÿç§°ä¸ºå‡¸å‡½æ•°&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;åˆ¤å®š&#34;&gt;åˆ¤å®š&lt;/h3&gt;
&lt;p&gt;å¯¹äºå…·ä½“æƒ…å¢ƒä¸‹çš„é—®é¢˜ï¼Œæ€ä¹ˆåˆ¤æ–­ DP æ•°ç»„æ˜¯å¦å…³äºå…¶æŸä¸€ç»´ä¸ºå‡¸å‡½æ•°ï¼Ÿ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›¸ä¿¡ç›¸ä¿¡çš„åŠ›é‡ï¼ˆæœ€å¸¸ç”¨ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äºåˆ†æ®µé—®é¢˜ï¼Œè¯æ˜åˆ†å‡ºæ¥çš„æ¯ä¸€æ®µæ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚&lt;/p&gt;
&lt;em&gt;å€¼å¾—ä¸€æçš„æ˜¯ï¼Œæ•°å­¦ä¸Šä¸è®¤ä¸ºæ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼èƒ½å¤Ÿæ¨å‡ºå‡½æ•°ä¸ºå‡¸ã€‚ä½†è¿™æ˜¯ä¿¡æ¯å­¦.jpg&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å…¶ç”±ä¸¤ä¸ªå‡¸å‡½æ•°çº¿æ€§ç›¸åŠ å¾—åˆ°ï¼š&lt;/p&gt;
&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\forall\, \lambda,\mu\ge 0\)&lt;/span&gt; å’Œå‡¸å‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(f,g\)&lt;/span&gt;ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(h=\lambda f+\mu g\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; ä¸ºå‡¸å‡½æ•°ã€‚&lt;/p&gt;
æ­¤å¤–ï¼Œæ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; çš„å·®åˆ†æ•°ç»„å’Œ &lt;span class=&#34;math inline&#34;&gt;\(f,g\)&lt;/span&gt; å·®åˆ†æ•°ç»„ä¹Ÿæ»¡è¶³ä¸Šè¿°å…³ç³»ã€‚&lt;/li&gt;
&lt;li&gt;å…¶æ˜¯ä¸¤ä¸ªå‡¸å‡½æ•°çš„ &lt;a href=&#34;#é—µå¯å¤«æ–¯åŸºå’Œ&#34;&gt;é—µå¯å¤«æ–¯åŸºå’Œ&lt;/a&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å…¶ç”±ä¸¤ä¸ªå‡¸å‡½æ•°çº¿æ€§ max å¾—åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä¸¤ä¸ªå‡¸å‡½æ•°çš„çº¿æ€§ minï¼Œä¸€èˆ¬ä¸æ˜¯å‡¸å‡½æ•°ï¼Œç”šè‡³å¯èƒ½æ˜¯å‡¹çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æ€§è´¨&#34;&gt;æ€§è´¨&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;æœ€å€¼ä¸ºå”¯ä¸€æå€¼ã€‚&lt;/li&gt;
&lt;li&gt;æ–œç‡ / å·®åˆ†æ•°ç»„å…·æœ‰å•è°ƒæ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨è§£é¢˜ä¸­ä¸»è¦ç”¨åˆ°çš„å¤§æ¦‚å°±æ˜¯ä¸Šé¢ä¸¤æ¡ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;wqs-äºŒåˆ†&#34;&gt;WQS äºŒåˆ†&lt;/h2&gt;
&lt;h3 id=&#34;ä¸»è¦ä»»åŠ¡&#34;&gt;ä¸»è¦ä»»åŠ¡&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¾‹ï¼šæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt; åˆ†ä¸ºæ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µï¼Œæ¯æ®µçš„ä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(sum^2+c\)&lt;/span&gt;ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; ä¸ºç»™å®šçš„å¸¸æ•°ï¼‰ï¼Œé—®æœ€å°ä»£ä»·ã€‚&lt;span class=&#34;math inline&#34;&gt;\(n\le 2\times 10^5,a_i\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æœå¯¹æ®µæ•°æ²¡æœ‰è¦æ±‚ï¼Œå¯ä»¥ç”¨æ–œä¼˜ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; åšã€‚&lt;/p&gt;
&lt;p&gt;åŠ ä¸Šäº† &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„é™åˆ¶ï¼ŒDP å˜æˆäºŒç»´çš„ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„åˆ†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ®µï¼Œå¯ä»¥åœ¨ç¬¬ä¸€ç»´æ–œç‡ä¼˜åŒ–ï¼Œåšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(nk)\)&lt;/span&gt;ï¼›äº¦æˆ–å‘ç° &lt;span class=&#34;math inline&#34;&gt;\((i,j)\)&lt;/span&gt; æœ‰å†³ç­–å•è°ƒæ€§ï¼Œç„¶åå››è¾¹å½¢ä¸ç­‰å¼ä¼˜åŒ–åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å…³äº &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; è¿™ä¸€ç»´æ˜¯å‡¸çš„ï¼ˆè€Œéä¸Šæ–‡çš„ &lt;span class=&#34;math inline&#34;&gt;\((i,j)\)&lt;/span&gt;ï¼‰ï¼Œæ•…å°† &lt;span class=&#34;math inline&#34;&gt;\(f(n,j)\)&lt;/span&gt; å…³äº &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„å‡½æ•°æå–å‡ºæ¥ï¼ˆè®°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_n(j)\)&lt;/span&gt;ï¼‰ã€‚å‘ç°åªæœ‰æœ€é«˜ç‚¹æ˜¯å¯ä»¥ä¸€æ¬¡æ–œä¼˜å¿«é€Ÿæ±‚å‡ºæ¥çš„ï¼Œæ•…å¯ä»¥è®¤ä¸ºåœ¨å½“å‰å¤æ‚åº¦é™åˆ¶ä¸‹ï¼Œæ•´ä¸ªå‡½æ•°é™¤äº†æœ€é«˜ç‚¹ä»¥å¤–éƒ½æ˜¯æœªçŸ¥çš„ï¼ˆæ³¨æ„å¯ä»¥åœ¨ DP æ—¶è®°å½•æå€¼ç‚¹çš„æ¨ªåæ ‡ï¼Œå³åˆ†äº†å‡ æ®µï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç»™æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(f_n(j)\)&lt;/span&gt; åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(\alpha\cdot j\)&lt;/span&gt;ï¼ˆåœ¨æœ¬é¢˜ä¸­å³å°† &lt;span class=&#34;math inline&#34;&gt;\(c\gets c+k\)&lt;/span&gt;ï¼‰ï¼Œå‹‰å¼ºå¯ä»¥è®¤ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\alpha\cdot j\)&lt;/span&gt; æ˜¯å‡¸çš„ï¼Œæ‰€ä»¥æ–°å‡½æ•° &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;_n(j)\)&lt;/span&gt; ä¹Ÿæ˜¯å‡¸çš„ã€‚è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(k&amp;gt;0\)&lt;/span&gt;ï¼Œå¯ä»¥æ„Ÿå—åˆ°æå€¼ç‚¹å‘å·¦åç§»ï¼Œä¸”éšç€ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„å¢å¤§ï¼Œæå€¼ç‚¹ä¸ä¼šå³ç§»ï¼›&lt;span class=&#34;math inline&#34;&gt;\(k&amp;lt;0\)&lt;/span&gt; æ—¶åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;ç»“åˆå‡ ä½•è§‚ç‚¹ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f_n\)&lt;/span&gt; ä¸Šçš„æå€¼ç‚¹å¯ä»¥ç”¨æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„ç›´çº¿åˆ‡åˆ°ï¼›è€ŒåŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(\alpha\cdot j\)&lt;/span&gt; çš„è¿‡ç¨‹ï¼Œå…¶å®å°±æ˜¯åˆ‡çº¿æ–œç‡å‡å» &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; çš„è¿‡ç¨‹ã€‚ç›¸å½“äºä»¤åˆ‡çº¿æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-\alpha\)&lt;/span&gt;ï¼Œçœ‹çœ‹èƒ½åˆ‡åˆ°å“ªé‡Œã€‚&lt;/p&gt;
&lt;p&gt;æ•…å¯ä»¥äºŒåˆ†ä¸€ä¸ªåˆé€‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œä½¿å¾—æå€¼ç‚¹çš„æ¨ªåæ ‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚æ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;_n(k)-\alpha\cdot k\)&lt;/span&gt; å³ä¸ºå¾…æ±‚ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;WQS äºŒåˆ†å‚ä¸çš„é—®é¢˜ä¸€èˆ¬ä»¥å¦‚ä¸‹å½¢å¼å‘ˆç°ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šåºåˆ—ï¼Œå°†å…¶æ°å¥½åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µ / æ°å¥½é€‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªï¼Œæ±‚æœ€å¤§ / æœ€å°ä»£ä»·ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¢˜ç›®è¦æ±‚æœ€å¤§ / æœ€å°å€¼ä¸€èˆ¬èƒ½å¤Ÿåæ˜ å‡½æ•°çš„å‡¹å‡¸æ€§ï¼Œå¯ä»¥æ ¹æ®è¿™ä¸€ç‚¹æ¥çŒœã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ç»†èŠ‚å¤„ç†&#34;&gt;ç»†èŠ‚å¤„ç†&lt;/h3&gt;
&lt;p&gt;è€ƒè™‘å¦‚ä¸‹å‡¸å‡½æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;1.png&#34; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¾ç„¶å¯¹äºã€å‡¸å‡ºæ¥ã€çš„ç‚¹ï¼ˆå³å›¾ä¸­é™¤äº† &lt;span class=&#34;math inline&#34;&gt;\(E,H\)&lt;/span&gt; ä»¥å¤–çš„ç‚¹ï¼‰ï¼Œèƒ½åˆ‡åˆ°çš„ç›´çº¿æ–œç‡ä¸ºä¸€ä¸ªèŒƒå›´ï¼›è€Œä½äºç›´çº¿ä¸Šçš„ç‚¹ï¼ˆé€”ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(E,H\)&lt;/span&gt;ï¼‰ï¼Œèƒ½åˆ‡åˆ°çš„ç›´çº¿æ–œç‡æ›´æ˜¯å®šæ­»äº†ã€‚æ‰€ä»¥è¿™è¦æ±‚ä½ çš„äºŒåˆ†ç²¾åº¦éœ€è¦ç•¥é«˜ä¸€ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(E\)&lt;/span&gt;ï¼ˆæˆ– &lt;span class=&#34;math inline&#34;&gt;\(H\)&lt;/span&gt;ï¼‰ï¼Œä¸èƒ½æ‰¾åˆ°åªè¿‡å®ƒä¸€ç‚¹çš„åˆ‡çº¿ã€‚æ ¹æ® DP çš„å†™æ³•ï¼Œè®°å½•çš„æ¨ªåæ ‡å¯èƒ½æ˜¯æœ€å°çš„ &lt;span class=&#34;math inline&#34;&gt;\(D\)&lt;/span&gt;ï¼Œä¹Ÿå¯èƒ½æ˜¯æœ€å¤§çš„ &lt;span class=&#34;math inline&#34;&gt;\(F\)&lt;/span&gt;ï¼Œæ­¤æ—¶ä½ å¯ä»¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;åŒæ—¶è®°å½•æœ€å°å’Œæœ€å¤§çš„æ¨ªåæ ‡ï¼Œçœ‹çœ‹ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; åœ¨ä¸åœ¨ä¸­é—´ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é¢˜ç›®è¦æ±‚æœ€å¤§ä»£ä»·æ—¶ï¼Œè®°å½•æœ€å¤§æ¨ªåæ ‡ï¼ŒäºŒåˆ†åˆ°ä¸€ä¸ªæå€¼ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(k&amp;#39;\ge k\)&lt;/span&gt; æ—¶ï¼Œæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(\alpha&amp;#39;\ge \alpha\)&lt;/span&gt;ï¼Œç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;_n(k&amp;#39;)-\alpha&amp;#39;\cdot k\)&lt;/span&gt; æ›´æ–°ç­”æ¡ˆï¼ˆæ˜¯èµ‹å€¼è€Œä¸æ˜¯å–æœ€å€¼ï¼‰ï¼›æ±‚æœ€å°ä»£ä»·æ—¶åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸»è¦æ˜¯éœ€è¦è®°ä½æ–œç‡æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\alpha\)&lt;/span&gt; çš„ç›¸åæ•°ï¼Œ&lt;del&gt;å®åœ¨æä¸æ¸…å¯¹åº”å…³ç³»å¯ä»¥éƒ½è¯•ä¸€è¯•&lt;/del&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹ç§æ ‘&#34;&gt;ä¾‹ï¼šç§æ ‘&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P1484&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P1484&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå‡½æ•°æ˜¯å‡¸çš„â€”â€”æ„Ÿæ€§ç†è§£å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ç€ï¼Œè¦æ±‚çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\le k\)&lt;/span&gt; æ—¶çš„æœ€å€¼ã€‚åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼š&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ˜¯å¦å³äºåŸå‡½æ•°æå€¼ç‚¹ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å³äºåŸå‡½æ•°æå€¼ç‚¹ï¼Œåˆ™åŸå‡½æ•°æå€¼ç‚¹ä¸ºç­”æ¡ˆã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ºç­”æ¡ˆã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¥½æ¶ˆæ¯æ˜¯æ•´æ•°åŸŸä¸Šä¸€å®šæœ‰è§£ï¼ˆæœ€åç­”æ¡ˆä¸ºæ•´ã€å€’æ¨å³å¯ï¼‰ï¼Œæ‰€ä»¥ä¸ç”¨æ‰“æµ®ç‚¹æ•°äºŒåˆ†äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int lim = 1e6;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    auto calc = [&amp;amp;](int c) &amp;#123;
        std::vector&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; f(n + 1);
        auto mx = f.front();
        auto upd = [&amp;amp;](auto &amp;amp;x, auto y) &amp;#123;
            if (y.first &amp;gt; x.first || (y.first == x.first &amp;amp;&amp;amp; y.second &amp;lt; x.second))
                x = y;
            return;
        &amp;#125;;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            f[i].first = mx.first + a[i] + c;
            f[i].second = mx.second + 1;
            upd(mx, f[i - 1]);
        &amp;#125;
        upd(mx, f[n]);
        return mx;
    &amp;#125;;
    auto t(calc(0));
    if (t.second &amp;lt;= k) &amp;#123;
        std::cout &amp;lt;&amp;lt; t.first &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    auto res(-inf);
    for (int l = -lim, r = lim, mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        auto t = calc(mid);
        if (t.second &amp;lt;= k)
            res = t.first - (long long)mid * k, l = mid + 1;
        else
            r = mid - 1;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹raper&#34;&gt;ä¾‹ï¼šRaper&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4694&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4694&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç»™æ‰€æœ‰å…‰ç›˜é™„ä¸€ä¸ªå¥–åŠ± &lt;span class=&#34;math inline&#34;&gt;\(mid\)&lt;/span&gt;ï¼Œè¿›è¡Œ WQS äºŒåˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå†…å±‚å°±å’Œ &lt;a href=&#34;#ä¾‹åºåˆ—-sequence&#34;&gt;sequence&lt;/a&gt; å·®å¾—ä¸æ˜¯ç‰¹åˆ«å¤šï¼Œæ‰€ä»¥è€ƒè™‘åæ‚”è´ªå¿ƒã€‚ï¼ˆï¼Ÿï¼‰&lt;/p&gt;
&lt;p&gt;æŠŠè·¯è¿‡çš„ &lt;span class=&#34;math inline&#34;&gt;\(-a_j\)&lt;/span&gt; ä¸¢åˆ°å¤§æ ¹å †é‡Œï¼Œå°è¯•å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b_i\)&lt;/span&gt; é…å¯¹ã€‚å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(mid-a_i-b_i\ge 0\)&lt;/span&gt; é‚£ä¹ˆæš‚æ—¶é…å¯¹ï¼Œé¡ºä¾¿æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(b_i-mid\)&lt;/span&gt; ä¸¢è¿›å»ç”¨äºåæ‚”ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(b_{i&amp;#39;}\)&lt;/span&gt; é€‰ä¸­äº† &lt;span class=&#34;math inline&#34;&gt;\(b_i-mid\)&lt;/span&gt; è¯´æ˜åæ‚”ï¼Œå°† &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(b_{i&amp;#39;}\)&lt;/span&gt; é…å¯¹ã€‚&lt;/p&gt;
&lt;p&gt;è´ªå¿ƒçš„æ—¶å€™éœ€è¦è®°å½•å·²ç»é…çš„å¯¹æ•°ï¼Œä¼˜å…ˆé˜Ÿåˆ—ä¸­éœ€è¦å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(-a_j\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b_i-mid\)&lt;/span&gt; æ‰“æ ‡è®°è¿›è¡ŒåŒºåˆ†ï¼ŒåŒ¹é…åˆ°å‰è€…æ—¶æ‰å¢åŠ æˆåŠŸå¯¹æ•°ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æ•´æ•°åŸŸä¸Šä»ç„¶å¿…æœ‰è§£ï¼ˆç­”æ¡ˆä¸ºæ•´ï¼Œå€’æ¨ï¼‰ï¼Œä¸ç”¨æ‰“æµ®ç‚¹æ•°äºŒåˆ† neiher.&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 2e9 + 5;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;int&amp;gt; a(n + 1), b(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; b[i];
    auto calc = [&amp;amp;](long long mid) &amp;#123;
        std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; q;
        int cnt = 0;
        auto res(0ll);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            q.emplace(-a[i], 1);
            auto [v, ty] = q.top();
            if (mid + v - b[i] &amp;gt;= 0) &amp;#123;
                q.pop(), cnt += ty;
                res += mid + v - b[i], q.emplace(b[i] - mid, 0);
            &amp;#125;
        &amp;#125;
        return std::make_pair(cnt, res);
    &amp;#125;;
    auto res(inf);
    for (long long l = 1ll, r = inf, mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        auto t(calc(mid));
        if (t.first &amp;gt;= k)
            r = mid - 1, res = -(t.second - k * mid);
        else
            l = mid + 1;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;åŒºé—´åˆ†æ‹†é—®é¢˜&#34;&gt;åŒºé—´åˆ†æ‹†é—®é¢˜&lt;/h3&gt;
&lt;p&gt;ç›®æ ‡ï¼šå°è¯•å°† &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt; åˆ†å‰²æˆæ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ®µï¼Œå®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\([i,j]\)&lt;/span&gt; ä½œä¸ºä¸€æ®µçš„ä»£ä»·ï¼Œæ±‚ä»£ä»·æœ€å€¼ã€‚å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨è®¾æ±‚æœ€å°ä»£ä»·ã€‚å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(f(i,j)\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤„åˆ†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ®µï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f(i,j)=\min(f(i-1,p-1)+w(p,j)).
\]&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰å®šç†ï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f(i-1,j)\le f(i,j)\le f(i,j+1)\)&lt;/span&gt;ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å®šä¹‰å‡ºå‘å¾ˆå¥½æ„Ÿæ€§ç†è§£ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥ä»è¿™ä¸€ç‚¹å‡ºå‘ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(p\)&lt;/span&gt; è¿™ä¸€ç»´å°±å¯ä»¥è¢«æ‘Šæ‰ï¼Œåšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n(n+m))\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰å®šç†ï¼šè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(w(i,j)\)&lt;/span&gt; æ»¡è¶³å››è¾¹å½¢ä¸ç­‰å¼ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(f_i(j)\)&lt;/span&gt; æ˜¯å‡¸å‡½æ•°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é‚£å¾ˆå¥½äº†ã€‚ç›´æ¥å†²åˆº WQS å³å¯ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;é—µå¯å¤«æ–¯åŸºå’Œ&#34;&gt;é—µå¯å¤«æ–¯åŸºå’Œ&lt;/h2&gt;
&lt;p&gt;ç»™å®šä¸¤ä¸ªå‡¸å‡½æ•°ï¼ˆå½“ç„¶æ˜¯æŒ‡ OI ä¸­é‚£ç§é•¿å¾—å¾ˆç›´çš„å‡½æ•°ï¼‰ï¼Œå°†å®ƒä»¬çš„ã€è¾¹ã€æ‹†ä¸‹æ¥è¿‡åï¼Œä»¥æŸç§æ–¹å¼æ‹¼åœ¨ä¸€èµ·ï¼Œä½¿å¾—æœ€åå¾—åˆ°ä¸€ä¸ªæ–°çš„å‡¸å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æŒ‰æ¯æ¡ã€è¾¹ã€çš„æ–œç‡å½’å¹¶ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°ï¼Œæ˜¾ç„¶ç­”æ¡ˆå­˜åœ¨ä¸”å”¯ä¸€ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºé—µå¯å¤«æ–¯åŸºå’Œã€‚å¯ä»¥å‘ç°è¿™æ˜¯ä¸€ç§æœ€å€¼ - åŠ å·ç§¯ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æˆ‘ä»¬è¦æ±‚çš„ DP æ•°ç»„æ˜¯ä¸¤ä¸ªå·²çŸ¥çš„å­æ•°ç»„ä»¥ç±»ä¼¼çš„æ–¹æ³•å·èµ·æ¥çš„ï¼Œæœ€åè¦æ±‚å®Œæ•´çš„ DP æ•°ç»„ï¼ˆè€Œé WQS ä¸­çš„å•ç‚¹å€¼ï¼‰ï¼Œå°±å¯ä»¥è€ƒè™‘é—µå¯å¤«æ–¯åŸºå’Œã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™ä¸ªç»“æ„æ˜¯å¾ˆé€‚åˆå½’å¹¶çš„ï¼Œä½¿ç”¨å½’å¹¶è¦æ±‚çŠ¶æ€ä¸­å«æœ‰ç‰ˆæœ¬ç»´ã€å› å˜é‡ç»´ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹its-mooin-time-p&#34;&gt;ä¾‹ï¼šIt&#39;s Mooin&#39; Time P&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P11459&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P11459&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(w_i\)&lt;/span&gt; ä¸ºå°† &lt;span class=&#34;math inline&#34;&gt;\([i,i+L)\)&lt;/span&gt; æ”¹ä¸º &lt;code&gt;MOO&lt;/code&gt; çš„ä»£ä»·ï¼Œé—®é¢˜è½¬åŒ–ä¸ºé€‰å– &lt;span class=&#34;math inline&#34;&gt;\(1\sim \frac nL\)&lt;/span&gt; ä¸ªä¸é‡åŒºé—´çš„æœ€å°ä»£ä»·å’Œã€‚&lt;/p&gt;
&lt;p&gt;å°è¯•å½’å¹¶ï¼Œæ¯æ¬¡å°† &lt;span class=&#34;math inline&#34;&gt;\([l,mid]\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\((mid, r]\)&lt;/span&gt; å·èµ·æ¥ã€‚ä½†æ˜¯ä¼šæœ‰ä¸€ç‚¹é—®é¢˜ï¼šå¦‚æœæ°å¥½æœ‰åŒºé—´å¡åœ¨ä¸­é—´å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{l,r,0/1/2,0/1/2}(i)\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; å†…é€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ª &lt;code&gt;MOO&lt;/code&gt;ï¼Œä¸”ä¸¤ä¾§æœ€è¿œçš„è¢«é€‰ç‚¹è·ç¦»ç«¯ç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1/\ge 2\)&lt;/span&gt; çš„ DP å€¼ã€‚ç„¶åå¯ä»¥è¿›è¡Œç›¸åº”çš„è®¨è®ºã€å¹³ç§»ã€é—µå¯å¤«æ–¯åŸºå’Œï¼Œæœ€åå°†æ‰€æœ‰æƒ…å†µçº¿æ€§å– max å¾—åˆ°è¿™ä¸€å±‚çš„ç­”æ¡ˆï¼Œå®¹æ˜“å‘ç°å¾—åˆ°çš„ç­”æ¡ˆä¹Ÿæ˜¯å‡¸çš„ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int L;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; L &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    std::vector&amp;lt;char&amp;gt; t(n + 1);
    std::vector&amp;lt;long long&amp;gt; w(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n - L + 1; ++i) &amp;#123;
        w[i] = a[i] * (t[i] != &amp;#39;M&amp;#39;);
        for (int j = i + 1; j &amp;lt; i + L; ++j)
            w[i] += a[j] * (t[j] != &amp;#39;O&amp;#39;);
        // printf(&amp;quot;[%d, %d]: %lld\n&amp;quot;, i, i + L - 1, w[i]);
    &amp;#125;
    if (L == 1) &amp;#123;
        std::sort(w.begin() + 1, w.end());
        auto s(0ll);
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            s += w[i];
            std::cout &amp;lt;&amp;lt; s &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
        return 0;
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    struct node &amp;#123;
        crr f;
        node(int len): f(L, brr(L, arr(len, inf))) &amp;#123;
            for (int i = 0; i &amp;lt; L; ++i)
                for (int j = 0; j &amp;lt; L; ++j)
                    f[i][j][0] = 0ll;
            return;
        &amp;#125;
        brr&amp;amp; operator[] (int q) &amp;#123; return f[q]; &amp;#125;
    &amp;#125;;
    auto upd = [&amp;amp;](arr &amp;amp;x, arr y) &amp;#123;
        if (x.size() &amp;lt; y.size())
            x.resize(y.size(), inf);
        for (int i = 0; i &amp;lt; (int)y.size(); ++i)
            x[i] = std::min(x[i], y[i]);
        return;
    &amp;#125;;
    auto merge = [&amp;amp;](arr l, arr r) &amp;#123;
        arr out((int)(l.size() + r.size()) - 1), dl(l.size()), dr(r.size());
        for (int i = 1; i &amp;lt; (int)l.size(); ++i)
            dl[i] = l[i] - l[i - 1];
        for (int i = 1; i &amp;lt; (int)r.size(); ++i)
            dr[i] = r[i] - r[i - 1];
        std::merge(dl.begin() + 1, dl.end(), dr.begin() + 1, dr.end(), out.begin() + 1);
        out[0] = l[0] + r[0];
        std::partial_sum(out.begin(), out.end(), out.begin());
        return out;
    &amp;#125;;
    std::function&amp;lt;node(int, int)&amp;gt; calc = [&amp;amp;](int l, int r) &amp;#123;
        if (r - l + 1 &amp;lt; 2 * L) &amp;#123;
            node res(1);
            for (int ll = 0; ll &amp;lt; L; ++ll)
                for (int rr = 0; rr &amp;lt; L; ++rr)
                    if (l + ll &amp;lt;= r - rr - L + 1) &amp;#123;
                        res[ll][rr].resize(2, inf);
                        for (int i = l + ll; i &amp;lt;= r - rr - L + 1; ++i)
                            res[ll][rr][1] = std::min(res[ll][rr][1], w[i]);
                        // printf(&amp;quot;[%d, %d]: (%d, %d) = %lld\n&amp;quot;, l, r, ll, rr, res[ll][rr][1]);
                    &amp;#125;
            // for (int i = 0; i &amp;lt; L; ++i)
            //     if (l + i + L - 1 &amp;lt;= r) &amp;#123;
            //         printf(&amp;quot;[%d, %d]: (%d, %d) = %lld\n&amp;quot;, l, r, i, r - (l + i + L - 1), w[l + i]);
            //         res[i][r - (l + i + L - 1)].emplace_back(w[l + i]);
            //     &amp;#125;
            return res;
        &amp;#125;   
        int mid = (l + r) &amp;gt;&amp;gt; 1;
        node tl(calc(l, mid)), tr(calc(mid + 1, r)), res((r - l + 1) / L + 1);
        for (int ll = 0; ll &amp;lt; L; ++ll)
            for (int rr = 0; rr &amp;lt; L; ++rr)
                res[ll][rr] = merge(tl[ll][0], tr[0][rr]);
        for (int ll = 0; ll &amp;lt; L; ++ll)
            for (int rr = 0; rr &amp;lt; L; ++rr)
                for (int i = 1; i &amp;lt; L &amp;amp;&amp;amp; i &amp;lt; mid; ++i)
                    upd(res[ll][rr], merge(merge(tl[ll][i], tr[L - i][rr]), &amp;#123; 0, w[mid - i + 1] &amp;#125;));
        for (int ll = 0; ll &amp;lt; L; ++ll)
            for (int rr = L - 1; rr; --rr)
                upd(res[ll][rr - 1], res[ll][rr]);
        for (int rr = 0; rr &amp;lt; L; ++rr)
            for (int ll = L - 1; ll; --ll)
                upd(res[ll - 1][rr], res[ll][rr]);
        // for (int i = 0; i &amp;lt; L; ++i)
        //     for (int j = 0; j &amp;lt; L; ++j) &amp;#123;
        //         printf(&amp;quot;  (%d, %d): &amp;quot;, i, j);
        //         for (auto p : res[i][j])
        //             printf(&amp;quot;%lld &amp;quot;, p);
        //         puts(&amp;quot;&amp;quot;);
        //     &amp;#125;
        return res;
    &amp;#125;;
    auto res(calc(1, n));
    for (int i = 1; i &amp;lt;= n / L; ++i)
        std::cout &amp;lt;&amp;lt; res[0][0][i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹å‡äºº&#34;&gt;ä¾‹ï¼šå‡äºº&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/problem/47728&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/problem/47728&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºå‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»„é€‰å®Œå äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½“ç§¯çš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\max\{f_{i-1,k}+a_{i,j-k}\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;em&gt;è¢œï¼Œè¿™ä¸ªä¸œè¥¿å¥½å‡¸çš„æ ·å­ï¼å•Šï¼Ÿå±…ç„¶ä¸æ˜¯å‡¸çš„ï¼Ÿ&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œæœ‰ç»“è®ºï¼šè‹¥å¹²ä¸ªä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\sim 4\)&lt;/span&gt; çš„ç‰©å“åšèƒŒåŒ…ï¼Œå¯ä»¥å‡‘å‡ºå€¼åŸŸå†…ä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(24\)&lt;/span&gt; çš„å€æ•°ã€‚æ‰€ä»¥å…ˆæŠŠä½“ç§¯å…¨éƒ¨ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°ä½“ç§¯ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\sim 4\)&lt;/span&gt; çš„ç‰©å“ã€‚ç„¶åä¼šå‘ç°ä»–ä»¬æŒ‰ç…§æ¨¡ &lt;span class=&#34;math inline&#34;&gt;\(12\)&lt;/span&gt; çš„ä½™æ•°åˆ†åˆ«æ˜¯å‡¸çš„ã€‚&lt;/p&gt;
&lt;p&gt;èƒ½æ„Ÿå—åˆ°æ¶æ„äº†ã€‚ç„¶åå°±å¯ä»¥æšä¸¾ä½“ç§¯ï¼Œå†é—µå¯å¤«æ–¯åŸºå’Œäº†ã€‚åŒæ ·éœ€è¦åœ¨çŠ¶æ€ä¸­å¼•å…¥ä½œä¸ºç‰ˆæœ¬å·çš„ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt; ç»´ï¼Œæ˜¾ç„¶å› å˜é‡æ˜¯ä½“ç§¯ã€ç‰ˆæœ¬å·æ˜¯ç»„æ•°ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;fake2.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; siz(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; siz[i], m += siz[i];
        a[i].resize(siz[i] + 1);
        for (int j = 1; j &amp;lt;= siz[i]; ++j)
            std::cin &amp;gt;&amp;gt; a[i][j];
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    struct node &amp;#123;
        std::vector&amp;lt;arr&amp;gt; f;
        node(): f(12) &amp;#123;&amp;#125;
        arr &amp;amp;operator[] (int q) &amp;#123;
            return f[q];
        &amp;#125;
    &amp;#125;;
    auto merge = [&amp;amp;](arr &amp;amp;p, arr &amp;amp;q) &amp;#123;
        arr res((int)(p.size() + q.size()) - 1), dp(p.size()), dq(q.size());
        std::adjacent_difference(p.begin(), p.end(), dp.begin());
        std::adjacent_difference(q.begin(), q.end(), dq.begin());
        std::merge(dp.begin() + 1, dp.end(), dq.begin() + 1, dq.end(), res.begin() + 1, std::greater&amp;lt;long long&amp;gt; ());
        res[0] = p[0] + q[0];
        std::partial_sum(res.begin(), res.end(), res.begin());
        return res;
    &amp;#125;;
    auto upd = [&amp;amp;](arr y, arr &amp;amp;x, int tag) &amp;#123;
        if (tag)
            y.insert(y.begin(), -inf);
        if (y.size() &amp;gt; x.size())
            x.resize(y.size(), -inf);
        for (int i = 0; i &amp;lt; (int)y.size(); ++i)
            x[i] = std::max(x[i], y[i]);
        return;
    &amp;#125;;
    std::function&amp;lt;node(int, int)&amp;gt; calc = [&amp;amp;](int l, int r) &amp;#123;
        if (l == r) &amp;#123;
            node res;
            for (int i = 1; i &amp;lt;= siz[l]; ++i)
                res[i - 1].push_back(a[l][i]);
            return res;
        &amp;#125;
        int mid = (l + r) &amp;gt;&amp;gt; 1;
        node tl(calc(l, mid)), tr(calc(mid + 1, r)), res;
        for (int p = 0; p &amp;lt; 12; ++p)
            for (int q = 0; q &amp;lt; 12; ++q)
                if (!tl[p].empty() &amp;amp;&amp;amp; !tr[q].empty())
                    upd(merge(tl[p], tr[q]), res[(p + q) % 12], p + q &amp;gt;= 12);
        return res;
    &amp;#125;;
    auto res(calc(1, n));
    for (int i = 0; i &amp;lt;= m - n; ++i)
        std::cout &amp;lt;&amp;lt; res[i % 12][i / 12] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;slope-trick&#34;&gt;slope trick&lt;/h2&gt;
&lt;p&gt;å¯¹äºä¸€ä¸ª OI ä¸­çš„å‡¸å‡½æ•°ï¼Œå®ƒæ˜¯ç”±ä¸€äº›æ–œç‡å•è°ƒçš„çº¿æ®µæ‹¼æ¥æˆçš„å›¾å½¢ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå‘ç°å¯ä»¥ç”¨æ•´ä¸ªå‡½æ•°çš„å·¦ / å³ç«¯ç‚¹å€¼ï¼ˆæˆªè·ï¼‰å’Œ &lt;span class=&#34;math inline&#34;&gt;\((n-1)\)&lt;/span&gt; ä¸ªæ–œç‡ / å·®åˆ†ä¿¡æ¯æè¿°å‡½æ•°ã€‚è€Œè¿™æœ‰æ—¶æ¯”ç›´æ¥ç»´æŠ¤ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹å€¼æœ‰ç€æ›´ä¼˜ç¾çš„æ€§è´¨ï¼Œå”¤å…¶ä¸º slope trickã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå…³äºæ–œç‡åºåˆ—ï¼Œå¦‚æœå®šä¹‰åŸŸä¸å¤§ï¼Œå¯ä»¥ç›´æ¥ç»´æŠ¤ï¼›å¦‚æœå®ƒçš„å˜åŒ–æ¬¡æ•°ä¸å¤šï¼Œå¯ä»¥åˆ©ç”¨å®ƒçš„å•è°ƒæ€§è´¨ï¼Œç”¨å•è°ƒæ•°æ®ç»“æ„ç»´æŠ¤ï¼›å¦‚æœå®ƒçš„å€¼åŸŸå¾ˆå°ï¼Œå¯ä»¥ç›´æ¥ç»´æŠ¤æ‹ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„å‰ä¸¤ç§æ–¹æ³•ä¸€èˆ¬å…³æ³¨æ¨ªåæ ‡å¯¹åº”çš„å‡½æ•°å€¼ï¼Œæ‰€ä»¥è‡ªå˜é‡ä¸€èˆ¬æ˜¯å’Œæ“ä½œæ¬¡æ•°ä¸€ç±»æœ‰å…³çš„ï¼›è€Œè¿™é‡Œå…³æ³¨å‡½æ•°æœ€å€¼è€Œå¼±åŒ–äº†å…·ä½“æ¨ªåæ ‡ï¼Œæ“ä½œæ¬¡æ•°ä¸€èˆ¬ä¼šä½œä¸ºå¾…æœ€ä¼˜åŒ–çš„å› å˜é‡ï¼Œä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æˆ‘æƒ³è¦å°†æ•°åˆ—é€šè¿‡è‹¥å¹²æ¬¡å•ç‚¹ä¿®æ”¹ä½¿åºåˆ—å•è°ƒï¼Œä½†ä¸å…³å¿ƒåºåˆ—æœ€ç»ˆå½¢æ€ï¼Œé—®æœ€å°æ“ä½œæ¬¡æ•°ã€‚&lt;/li&gt;
&lt;li&gt;æˆ‘æƒ³è¦è®©æ ‘ä¸Šæ‰€æœ‰å¶å­åˆ°æ ¹çš„è·¯å¾„è¾¹æƒå’Œç›¸ç­‰ï¼Œä½†ä¸å…³å¿ƒè¿™ä¸ªå€¼æ˜¯å¤šå°‘ï¼Œé—®æœ€å°æ“ä½œæ¬¡æ•°ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢ä¾æ¬¡è§£å†³ä¸Šè¿°é—®é¢˜ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹åºåˆ—-sequence&#34;&gt;ä¾‹ï¼šåºåˆ— sequence&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4597&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4597&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æš´åŠ›åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; æœ€ç»ˆè¢«ä¿®æ”¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œå®¹æ˜“å†™å‡º DP å¼å­ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\min\limits_{k\le j}\{f_{i-1,k}\}+|a_i-j|\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå°±ä¼šå‘ç°å®ƒçš„å®šä¹‰åŸŸå®åœ¨æ˜¯å¤ªå¤§äº†ï¼é‚£å¦‚æœå…³æ³¨æ–œç‡çš„å˜åŒ–æƒ…å†µå‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}(k)\)&lt;/span&gt; çš„æå€¼ç‚¹ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt;ï¼Œåˆ†ç±»è®¨è®ºæ‹†ç»å¯¹å€¼å’Œ minï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j\le a_i\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=\min\limits_{k\le j}\{f_{i-1}(k)\}+a_i - j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j &amp;lt; k_m\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=f_{i-1}(j)+a_i-j\)&lt;/span&gt;ï¼Œæ–œç‡ç›¸å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}(j)\)&lt;/span&gt; æ•´ä½“å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;del&gt;æˆ‘å°±è¯´å¯¼æ•°æ²¡ç™½å­¦å§&lt;/del&gt;&lt;/li&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j \ge k_m\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=f_{i-1}(k_m)+a_i-j\)&lt;/span&gt;ï¼Œæ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j &amp;gt; a_i\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=\min\limits_{k\le j}\{f_{i-1}(k)\}+j-a_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j &amp;lt; k_m\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j)=f_{i-1}(j)+j-a_i\)&lt;/span&gt;ï¼Œæ–œç‡ç›¸å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(f_{i-1}(j)\)&lt;/span&gt; æ•´ä½“åŠ  &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(j\ge k_m\)&lt;/span&gt; æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(f_i(j) = f_{i-1}(k_m)+j-a_i\)&lt;/span&gt;ï¼Œæ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœç°åœ¨æˆ‘ä»¬æä¸€ä¸ªæ”¯æŒåŒºé—´åŠ æ–œç‡ã€åŒºé—´æ¨å¹³æ–œç‡ä¸”ç»´æŠ¤åŒºé—´å‡½æ•°æœ€å€¼ç‚¹çš„æ•°æ®ç»“æ„ï¼Œé‚£å°±å¤ªé€†å¤©äº†ã€‚ä¸€ä¸ªç»å…¸çš„è§£å†³æ–¹æ¡ˆæ˜¯ç”¨å †ç»´æŠ¤çº¿æ®µæ–œç‡çš„å·®åˆ†ï¼ˆä¹Ÿå°±æ˜¯å·®åˆ†çš„å·®åˆ†ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æ•´ä½“ä¿®æ”¹æ¬¡æ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ï¼Œä¸”å¦‚æœåªçœ‹æ¯” &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; æ›´å·¦çš„ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼ˆæ›´é å³çš„å·²ç»ä¸æå€¼æ— å…³æ‰€ä»¥ä¸ç”¨ç»´æŠ¤ï¼‰ï¼Œé‚£ä¹ˆå°±åªéœ€è¦ç»´æŠ¤åŒºé—´å‡æ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœå°†ä¸€æ¬¡åŒºé—´å‰ç¼€å‡æ³•çœ‹ä½œä¸€æ¬¡å‰ç¼€å³ç«¯ç‚¹å…¥é˜Ÿï¼Œæ˜¾ç„¶å·¦ä¾§æŸç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„å®é™…è¢«å‡æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å…¥é˜Ÿçš„æ¬¡æ•° + æ‰€æœ‰å³äº &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ç‚¹çš„å…ƒç´ çš„å…¥é˜Ÿæ¬¡æ•°ã€‚ç”¨å¤§æ ¹å †ç»´æŠ¤è¿™äº›å…ƒç´ ï¼Œå°±å¯ä»¥å¿«é€Ÿç»´æŠ¤æ•´ä¸ªæ–œç‡åºåˆ—ã€‚ä¾‹å¦‚ &lt;code&gt;3 2 2 1&lt;/code&gt;ï¼Œä»£è¡¨ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; å¤„æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt; å¤„æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-3\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¤„æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-4\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(a_i\ge k_m\)&lt;/span&gt; æ—¶ï¼ˆå®¹æ˜“å‘ç°å®ƒä¼šæˆä¸ºæ–°çš„ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt;ï¼‰ï¼Œç›´æ¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åŠ å…¥å¤§æ ¹å †ï¼Œå°±å¯ä»¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\le a_i\)&lt;/span&gt; çš„æ‰€æœ‰ä½ç½®æ–œç‡å‡å» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
ä»€ä¹ˆä½ é—®åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¹‹é—´çš„æ¨å¹³æ€ä¹ˆåŠï¼Ÿç”±äºå”¯ä¸€å³äºå®ƒä»¬çš„æ‹ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å…¥äº†ä¸€æ¬¡é˜Ÿï¼Œæ‰€ä»¥ä¸­é—´çš„å…ƒç´ æ–œç‡è‡ªç„¶æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt; å•Šã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(a_i&amp;lt;k_m\)&lt;/span&gt; æ—¶ï¼Œæˆ‘ä»¬éœ€è¦ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä»¥å·¦çš„ä½ç½®æ–œç‡å‡å» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œç›´æ¥å°† &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å…¥é˜Ÿå³å¯ã€‚&lt;/li&gt;
&lt;li&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; ä¹‹é—´çš„ä½ç½®æ–œç‡åŠ ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å¼¹å‡ºï¼ˆå¤ªå¥½äº†å°±åœ¨é˜Ÿé¦–ï¼‰å†æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; åŠ å…¥å³å¯ã€‚ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; æ˜¾ç„¶æ˜¯ä¸€ä¸ªæ‹ç‚¹ï¼Œæ‰€ä»¥åˆ é™¤ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å¹¶éè™šç©ºç´¢æ•Œï¼Œä½†æ³¨æ„ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å¯èƒ½ä¼šå˜åŒ–æˆå…¶åç»§ã€‚&lt;/li&gt;
&lt;/ol&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶å®å°±ä¼šå‘ç°è¿˜æœ‰ä¸€äº›æœ‰è¶£çš„å°æ€§è´¨ï¼Œæ¯”å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; ä¸é˜Ÿé¦–ç­‰ä»·ï¼ˆç”¨äºå®ç°ï¼‰ï¼›&lt;span class=&#34;math inline&#34;&gt;\(k_m\)&lt;/span&gt; å³ä¾§æ–œç‡å…¨éƒ¨ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œä¹Ÿæ˜¯å”¯ä¸€å¯ä»¥å–åˆ°çš„æ­£æ–œç‡ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;è¢œå†™èµ·æ¥å¥½ç®€å•ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    long long res = 0ll;
    std::priority_queue&amp;lt;int&amp;gt; q;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i];
        if (i == 1 || a[i] &amp;gt;= q.top())
            q.push(a[i]);
        else &amp;#123;
            res += q.top() - a[i];
            q.pop(), q.push(a[i]), q.push(a[i]);
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹çƒŸèŠ±è¡¨æ¼”&#34;&gt;ä¾‹ï¼šçƒŸèŠ±è¡¨æ¼”&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3642&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3642&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,d}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å­æ ‘ä¸­æ‰€æœ‰å¶å­è·æ ¹å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; çš„æœ€å°ä»£ä»·ã€‚é‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{u,d}=\sum\limits_{(v, w)\in u}\min\limits_{0\le w&amp;#39;\le d}\{f_{v,d-w&amp;#39;}+|w-w&amp;#39;|\}.
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥å½’çº³è¯æ˜ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,d}\)&lt;/span&gt; ä¸ºå‡¸ï¼›å’Œä¸Šä¸€é¢˜ç›¸ä¼¼åœ°ï¼Œè€ƒè™‘ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_v\)&lt;/span&gt; çš„å †å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; çš„å †ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæœ€å¤–å±‚æ˜¯ä¸€ä¸ªçº¿æ€§åŠ ï¼Œè¿™å…¶å®å°±æ˜¯æŠŠå·®åˆ†æ•°ç»„ / æ–œç‡åŠ èµ·æ¥ï¼Œæ”¾åˆ°æˆ‘ä»¬è¿™ä¸ªå †é‡Œé¢å°±æ˜¯åˆå¹¶ä¸¤ä¸ªå †ã€‚è™½ç„¶ä½ å¯èƒ½å’Œæˆ‘ä¸€æ ·ä¸è®¤è¯†å¯å¹¶å †ï¼Œä½†æ˜¯ä½ å¯ä»¥å’Œæˆ‘ä¸€æ ·ä¸ä¼š pd_dsã€‚&lt;/p&gt;
&lt;p&gt;å†çœ‹å†…å±‚ï¼Œå‘ç°å’Œä¸Šä¸€é¢˜é•¿å¾—åƒä½†å…¶å®ä¸ä¸€æ ·ï¼Œå‘œå‘œå‘œã€‚å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(|w-w&amp;#39;|\)&lt;/span&gt; æ˜¯ä¸€ä¸ªå·¦å³æ–œç‡åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(-1,1\)&lt;/span&gt; çš„åˆ†æ®µå‡½æ•°ï¼Œè€Œå·¦è¾¹ç±»æ¯”å¯å¾—æ–œç‡æœ€å¤§ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç”±é—µå¯å¤«æ–¯åŸºå’Œï¼Œå†…å±‚å‡½æ•°æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;-1\)&lt;/span&gt; çš„éƒ¨åˆ†æ¥è‡ª &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d-w&amp;#39;}\)&lt;/span&gt;ï¼›&lt;span class=&#34;math inline&#34;&gt;\(=-1\)&lt;/span&gt; çš„éƒ¨åˆ†æ¥è‡ª &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d-w&amp;#39;}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(|w-w&amp;#39;|\)&lt;/span&gt; çš„å·¦åŠè¾¹ï¼ˆæ„Ÿè°¢ &lt;span class=&#34;math inline&#34;&gt;\(w&amp;#39;\)&lt;/span&gt; æ˜¯æœ‰ä¸‹ç¡®ç•Œçš„ï¼‰ï¼›&lt;span class=&#34;math inline&#34;&gt;\(=0\)&lt;/span&gt; çš„éƒ¨åˆ†æ¥è‡ª &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d-w&amp;#39;}\)&lt;/span&gt;ï¼›&lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;0\)&lt;/span&gt; çš„éƒ¨åˆ†æˆ‘ä»¬ä¸å…³å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;æœ€ç»ˆå‡½æ•°å›¾åƒçš„å˜åŒ–ï¼šæ°´å¹³éƒ¨åˆ†çš„å·¦ç«¯ç‚¹å³ç§»äº† &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt;ã€‚æ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d}\)&lt;/span&gt; ä¸­çš„æ°´å¹³çº¿æ®µå’Œæ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„çº¿æ®µï¼Œä»¤å…¶åœ¨å †ä¸­çš„å€¼ &lt;span class=&#34;math inline&#34;&gt;\(+w\)&lt;/span&gt; å°±èƒ½è¾¾åˆ°å¹³ç§»çš„ç›®çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä½†éœ€è¦æ³¨æ„ï¼Œæ­¤æ—¶ä»ç„¶éœ€è¦ &lt;strong&gt;ä¿ç•™å†…å±‚å‡½æ•°ä¸­æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„éƒ¨åˆ†ï¼Œä½†æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;1\)&lt;/span&gt; çš„éƒ¨åˆ†è¢«åˆ é™¤&lt;/strong&gt;ã€‚åŸå› å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»å¯¹å€¼å‡½æ•°ä¸å†…å±‚å‡½æ•°å®šä¹‰åŸŸç›¸åŒï¼Œä½œé—µå¯å¤«æ–¯åŸºå’Œåï¼Œæ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„å³ä¾§çº¿æ®µä¼šå°† &lt;span class=&#34;math inline&#34;&gt;\(f_{v,d-w&amp;#39;}\)&lt;/span&gt; ä¸­åŸæœ‰çš„ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;1\)&lt;/span&gt; çš„éƒ¨åˆ†ã€æŒ¤ã€å‡ºå®šä¹‰åŸŸï¼Œæ•…å¯ä»¥å°†å…¶ç›´æ¥åˆ é™¤ã€‚&lt;/li&gt;
&lt;li&gt;æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„éƒ¨åˆ†ï¼Œè™½ç„¶å¯¹å†…å±‚å‡½æ•°ä¸­æå€¼ç‚¹æ— è´¡çŒ®ï¼Œä½†åœ¨å¤–å±‚å‡½æ•°ä¸­æå€¼ç‚¹å¯èƒ½å‘å³åç§»ï¼Œæ­¤æ—¶ä¼šå¯¹å…¶äº§ç”Ÿå½±å“ï¼Œéœ€è¦ç»´æŠ¤ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å®¹æ˜“å‘ç°ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(w&amp;#39;\)&lt;/span&gt; çš„å–å€¼ä¸Šé™æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ï¼Œä½† &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; æ²¡æœ‰ä¸Šç•Œï¼Œæ‰€ä»¥æ¯ä¸ªå†…å±‚å‡½æ•°çš„å³ä¾§éƒ½ä¸€å®šæ˜¯ä¸€æ¡æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„å°„çº¿ï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªå¤–å±‚å‡½æ•°ä¸€å®šæœ‰ï¼ˆå„¿å­ä¸ªæ•°ï¼‰ä¸ªæ‹ç‚¹ï¼ˆå †ä¸­å…ƒç´ ï¼‰ï¼Œå¼¹å‡ºè¿™ä¹ˆå¤šä¸ªå°±å¯ä»¥åˆ é™¤å¤–å±‚å‡½æ•°ä¸­æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;1\)&lt;/span&gt; çš„çº¿æ®µï¼Œé¡ºä¾¿æ‰¾åˆ°æ–œç‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„çº¿æ®µã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
#include &amp;lt;ext/pb_ds/priority_queue.hpp&amp;gt;
const int inf= 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m, n += m;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    auto res(0ll);
    for (int i = 2, fa, w; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; fa &amp;gt;&amp;gt; w, res += w;
        g[fa].emplace_back(i, w);
    &amp;#125;
    std::vector&amp;lt;__gnu_pbds::priority_queue&amp;lt;long long&amp;gt; &amp;gt; q(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        if (g[x].empty())
            q[x].push(0), q[x].push(0);
        else
            for (auto [i, w] : g[x]) &amp;#123;
                DFS(i);
                for (int j = 1; j &amp;lt; (int)g[i].size(); ++j)
                    q[i].pop();
                long long t1 = q[i].top(), t0;
                q[i].pop(), t0 = q[i].top(), q[i].pop();
                q[i].push(t1 + w), q[i].push(t0 + w);
                q[x].join(q[i]);
            &amp;#125;
        // fprintf(stderr, &amp;quot;size(%d) = %d\n&amp;quot;, x, (int)q[x].size());
        return;
    &amp;#125;;
    DFS(1);
    for (int i = 1; i &amp;lt;= (int)g[1].size(); ++i)
        q[1].pop();
    for (; !q[1].empty(); q[1].pop())
        res -= q[1].top();
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹buy-low-sell-high&#34;&gt;ä¾‹ï¼šBuy Low Sell High&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/865/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/865/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¤©ç»“æŸåæŒæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ”¯è‚¡ç¥¨çš„æœ€å¤§æ”¶ç›Šã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\max\{f_{i-1,j},f_{i-1,j-1}-a_i,f_{i-1,j+1}+a_i\}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ï¼ˆç”±äºè¿™é‡Œå’Œ max æœ‰å…³æ‰€ä»¥éœ€è¦ç²¾ç»†æè¿°å‡¹å‡¸äº†ï¼‰å‘ç°å°±æ˜¯æŠŠä¸‰ä¸ªï¼ˆå¯èƒ½ï¼‰ç»è¿‡å¹³ç§»çš„ï¼ˆå¯èƒ½ï¼‰å‡¹çš„å‡½æ•°åšçº¿æ€§ maxã€‚è™½ç„¶å®é™…ä¸Šçš„ç»“è®ºã€å‡½æ•°åœ¨æ•´ç‚¹ä¸Šæ˜¯å‡¹çš„ã€ä¸ç®—å¤ªæ˜¾ç„¶ï¼Œä½†æ˜¯å¯ä»¥çŒœæ˜¯å‡¹çš„ã€‚&lt;/p&gt;
&lt;p&gt;çº¿æ€§ max åœ¨ slope trick ä¸­æ˜¯ä¸å¤ªèƒ½ä½“ç°çš„ï¼Œä½†æˆ‘ä»¬å‘ç°è¿™é‡Œæ˜¯åŒä¸€ä¸ªå‡¹å‡½æ•°å‘å·¦ä¸Šã€å³ä¸‹å¹³ç§»åŒä¸€ä¸ªå‘é‡ï¼Œå¸Œæœ›å¾—åˆ°æ–°çš„å‡¹å‡½æ•°ä¸ç®¡æ˜¯ä»å·®åˆ†è§’åº¦è¿˜æ˜¯å›¾è±¡ï¼Œéƒ½èƒ½å¾—åˆ°æ–°å‡½æ•°ç”±å·¦ä¸Šéƒ¨åˆ†æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;gt;-a_i\)&lt;/span&gt; çš„çº¿æ®µã€ä¸¤æ®µæ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(=-a_i\)&lt;/span&gt; çš„çº¿æ®µã€å³ä¸‹éƒ¨åˆ†æ–œç‡ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;-a_i\)&lt;/span&gt; çš„çº¿æ®µç»„æˆã€‚æ­¤å¤–ï¼Œç”±äºå‘å·¦ä¸Šå¹³ç§»çš„å‡½æ•°æœ‰ä¸€å¤„ç¦»å¼€äº†å®šä¹‰åŸŸï¼Œè¿˜éœ€å°†å…¶å‰”é™¤ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“ &lt;span class=&#34;math inline&#34;&gt;\(-a_i\)&lt;/span&gt; æ¯”æœ€å°æ–œç‡è¿˜è¦å°æ—¶ä¼šæœ‰å˜åŒ–ï¼Œå¯ä»¥ç”»å›¾çœ‹ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;2.png&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°å®šä¹‰åŸŸæ˜¯ç›¸å¯¹å°çš„ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(0\le j\le n\)&lt;/span&gt;ï¼‰ï¼Œæ•…ç”¨ä¼˜å…ˆé˜Ÿåˆ—ç»´æŠ¤æ•´ä¸ªæ–œç‡åºåˆ—å°±å¯ä»¥å¿«é€Ÿæ’å…¥ä¸¤ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k=-a_i\)&lt;/span&gt; çš„çº¿æ®µã€‚å®¹æ˜“å‘ç°é¡¶ç‚¹åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(j=0\)&lt;/span&gt; å¤„å–å¾—ï¼ˆä»å›¾è±¡å’Œå®šä¹‰éƒ½æ˜“çŸ¥ï¼‰ï¼Œæœ€å³ä¾§æ˜¯åªä¹°ä¸å–çš„æœ€åŠ£æ–¹æ¡ˆï¼Œå¯ä»¥å€’æ¨ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    auto res = 0ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], res -= a[i];
    std::priority_queue&amp;lt;int&amp;gt; q;
    q.push(-a[1]);
    for (int i = 2; i &amp;lt;= n; ++i)
        if (a[i] &amp;lt; -q.top())
            q.push(-a[i]);
        else
            q.pop(), q.push(-a[i]), q.push(-a[i]);
    for (; !q.empty(); res -= q.top(), q.pop());
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="åæ‚”è´ªå¿ƒ" />
        <category term="DP ä¼˜åŒ–" />
        <category term="WQS äºŒåˆ†" />
        <category term="é—µå¯å¤«æ–¯åŸºå’Œ" />
        <category term="slope trick" />
        <updated>2025-07-07T06:10:02.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250526/</id>
        <title>å¤šç»´ DP</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250526/"/>
        <content type="html">&lt;p&gt;ä¸Šæ¥¼å¬åˆ°æœ‰äººåœ¨å“¼ &lt;em&gt;Climbing on the Trees&lt;/em&gt;ï¼Œä¸Šæ¥å¬åˆ°éš”å£ç­åœ¨æ”¾ &lt;em&gt;Burn the House Down&lt;/em&gt;ï¼Œæœç„¶æ˜¥å¤©æ˜¯ AJR çš„å­£èŠ‚ï¼ˆï¼‰&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;p&gt;ä¸»è¦æ˜¯å¤šç»´ DP ç‰¹æœ‰çš„ä¼˜åŒ–ï¼&lt;/p&gt;
&lt;h2 id=&#34;åˆ†æ­¥è½¬ç§»&#34;&gt;åˆ†æ­¥è½¬ç§»&lt;/h2&gt;
&lt;p&gt;å¦‚æœçŠ¶æ€çš„è‹¥å¹²ç»´ä¹‹é—´åªå­˜åœ¨å¾ˆå¼±çš„è”ç³»ï¼Œå¯ä»¥åˆ†æ­¥è½¬ç§»æ¯ä¸€ç»´ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾æœ‰äºŒç»´çŠ¶æ€è½¬ç§» &lt;span class=&#34;math inline&#34;&gt;\((a,b)\to (a&amp;#39;,b&amp;#39;)\)&lt;/span&gt;ï¼Œã€å¾ˆå¼±çš„è”ç³»ã€ä¸¾ä¾‹ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;DP å€¼ä¸­åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(w(a&amp;#39;,b&amp;#39;)\)&lt;/span&gt;ï¼Œä½†ä¸åŒ…å«è¯¸å¦‚ &lt;span class=&#34;math inline&#34;&gt;\(w(a&amp;#39;,b),w(a,b&amp;#39;)\)&lt;/span&gt; ä¹‹ç±»ã€‚ä¹Ÿå³è¯¥å€¼çš„æ±‚è§£ä¸ä¾èµ–äºä¸Šä¸€ä¸ªçŠ¶æ€ã€ä¸ä¾èµ–äºè½¬ç§»ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\((a&amp;#39;,b&amp;#39;)\)&lt;/span&gt; çš„å–å€¼æœ‰é™åˆ¶ï¼Œæ¯”å¦‚ &lt;span class=&#34;math inline&#34;&gt;\((114,514)\)&lt;/span&gt; ä¸èƒ½å–åˆ°ä¹‹ç±»ã€‚æ˜¾ç„¶è¿™ä¹Ÿä¸ä¾èµ–äºä¸Šä¸€ä¸ªçŠ¶æ€ã€ä¸ä¾èµ–äºè½¬ç§»ã€‚&lt;/li&gt;
&lt;li&gt;ç¬¦å·é™åˆ¶ï¼ˆå¦‚è½¬ç§»é—´ä¸º &lt;span class=&#34;math inline&#34;&gt;\(+\)&lt;/span&gt;ï¼ŒçŠ¶æ€é—´ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\times\)&lt;/span&gt; ä¹‹ç±»ï¼‰ï¼Œåœ¨è®¡æ•°ä¸­å¸¸å‡ºç°ã€‚&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªå˜åŠ¨çš„æ—¶å€™å¦ä¸€ä¸ªå¿…é¡»ä¹Ÿä¸€èµ·åŠ¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ³¨æ„ï¼æœ‰çš„æ—¶å€™ä¸€ä¸ªçŠ¶æ€ä¹Ÿå¯ä»¥æ‹†æˆä¸¤ä¸ªçŠ¶æ€ï¼Œç„¶ååˆ†æ­¥è½¬ç§»ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜ç»å…¸é¢˜&#34;&gt;ä¾‹é¢˜ï¼šç»å…¸é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(w_{N\times M}\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\((A,B)_{1\sim K}\)&lt;/span&gt;ï¼Œæœ€å¤§åŒ– &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=1}^K w_{A_i,B_i}+w_{A_{i-1},A_i}+w_{B_{i-1},B_i}\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‘ç°å¦‚æœè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,a,b}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\((A,B)_i=(a,b)\)&lt;/span&gt; çš„è¯ï¼Œè½¬ç§»å°±ä¼šè¾¾åˆ°å¯è§‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(O(N\times M)\)&lt;/span&gt;ï¼›ä½†å‘ç°é‡Œé¢çš„ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt; å…¶å®æ²¡ä»€ä¹ˆæœ‰æœºè”ç³»ï¼›å”¯ä¸€çš„è”ç³» &lt;span class=&#34;math inline&#34;&gt;\(w_{A_i,B_i}\)&lt;/span&gt;ï¼ˆä¸Šé¢ã€å¾ˆå¼±çš„è”ç³»ã€ä¸­çš„ç¬¬ä¸€ã€å››ç§æƒ…å†µï¼‰ã€‚å› æ­¤åˆ†å¸ƒè½¬ç§»ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f&amp;#39;_{a&amp;#39;,b}\gets \max\limits_a f_{a,b}+w_{a&amp;#39;,a}\\
f_{a&amp;#39;,b&amp;#39;}\gets \max\limits_b f&amp;#39;_{a&amp;#39;, b} + w_{b,b&amp;#39;}+w_{a&amp;#39;,b&amp;#39;}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç”±æ­¤ä¾¿ä¼˜åŒ–è½¬ç§»å¤æ‚åº¦åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(N+M)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜å½©ç¯æ™šä¼š&#34;&gt;ä¾‹é¢˜ï¼šå½©ç¯æ™šä¼š&lt;/h3&gt;
&lt;p&gt;goto &lt;a href=&#34;/20250407/#e---kdoi-11å½©ç¯æ™šä¼š&#34;&gt;link&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Tipsï¼šå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(l_1,l_2\)&lt;/span&gt; ä¹‹é—´ä¹Ÿæ²¡å•¥æœ‰æœºè”ç³»ï¼ˆä¸Šé¢ã€å¾ˆå¼±çš„è”ç³»ã€ä¸­çš„ç¬¬ä¸‰ã€å››ç§æƒ…å†µï¼‰ï¼Œæ•…åˆ†æ­¥è½¬ç§»ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜åºåˆ—å¦™å¦™å€¼&#34;&gt;ä¾‹é¢˜ï¼šåºåˆ—å¦™å¦™å€¼&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://uoj.ac/problem/549&#34; class=&#34;uri&#34;&gt;https://uoj.ac/problem/549&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æœ´ç´ åœ°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå¤„åˆ†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ®µçš„æœ€å¤§ä»·å€¼ï¼Œæ˜¾ç„¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(k\times n^2)\)&lt;/span&gt;ï¼Œä¸”å¹¶æ²¡æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åˆ©ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å¾ˆå°è¿™ä¸€æ¡ä»¶ï¼Œå‘ç°ä¸Šä¸€æ¡æ— æ³•ä¼˜åŒ–æ˜¯å› ä¸ºè¦è·å– &lt;span class=&#34;math inline&#34;&gt;\(sum_{i}\)&lt;/span&gt; çš„å€¼ï¼›é‚£ä¹ˆæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(sum_i\)&lt;/span&gt; å¡åˆ°çŠ¶æ€é‡Œã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{s&amp;#39;,j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(sum=s&amp;#39;\)&lt;/span&gt; æ—¶ï¼Œåˆ†äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; æ®µçš„æœ€å¤§ä»·å€¼ã€‚åŒæ ·å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(k\cdot n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æœ‰ä¸¤ä¸ªç†è§£è¿™ä¸ªä¼˜åŒ–çš„è§’åº¦ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;p&gt;ä»å¹³è¡¡è§’åº¦ï¼ŒåŸé—®é¢˜ç­‰ä»·äº &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\((s,j)\)&lt;/span&gt; å¤„çš„æœ€å¤§å€¼ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(v)\)&lt;/span&gt; æŸ¥æ‰¾ &lt;span class=&#34;math inline&#34;&gt;\(j-1\)&lt;/span&gt; å¤„çš„æœ€å¤§å€¼ï¼›æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; æ‹†æˆå‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ã€å &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ä¸¤ä¸ª partï¼Œå½“æ›´æ–°&lt;/p&gt;
&lt;p&gt;å¯¹äºä¿®æ”¹ï¼šç›¸å½“äºå›ºå®šå‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œæšä¸¾å &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œå¹¶æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\((s,x)\)&lt;/span&gt;ã€‚&lt;/p&gt;
å¯¹äºæŸ¥è¯¢ï¼šç›¸å½“äºå›ºå®šå &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼Œæšä¸¾å‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œå¹¶æŸ¥è¯¢ &lt;span class=&#34;math inline&#34;&gt;\((s,x)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä»åˆ†æ­¥è½¬ç§»è§’åº¦ï¼Œç”±äºã€ç°æ—¶åˆ»ã€çš„è´¡çŒ®æ˜¯æŒ‰ä½çš„ï¼ŒäºŒè¿›åˆ¶çŠ¶æ€çš„å‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½å’Œå &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½æ²¡å•¥æœ‰æœºè”ç³»ï¼Œæ•…ç›´æ¥æ‹†å¼€ï¼Œå…ˆè½¬ç§»å‰ &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ï¼Œå†è½¬ç§»å &lt;span class=&#34;math inline&#34;&gt;\(8\)&lt;/span&gt; ä½ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ ·å°±è¢«ä¼˜åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(k\cdot n\times \sqrt v)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxv = 1 &amp;lt;&amp;lt; 8;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    using arr = std::vector&amp;lt;int&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    arr s(n + 1), tag0(maxv), d0;
    crr f(maxv, brr(maxv, arr(k + 1, inf))), g(maxv, brr(maxv, arr(k + 1, inf)));
    f[0][0][0] = 0;
    for (int j = 0; j &amp;lt; maxv; ++j)
        g[0][j][1] = j;
    tag0[0] = 1, d0.push_back(0);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; s[i], s[i] ^= s[i - 1];
        int p0 = s[i] &amp;gt;&amp;gt; 8, p1 = s[i] &amp;amp; ((1 &amp;lt;&amp;lt; 8) - 1);
        for (int j = k; j; --j) &amp;#123;
            for (auto a : d0)
                f[p0][p1][j] = std::min(f[p0][p1][j], g[a][p1][j] + ((a ^ p0) &amp;lt;&amp;lt; 8));
            // printf(&amp;quot;f[%d][%d][%d] = %d\n&amp;quot;, p0, p1, j, f[p0][p1][j]);
            if (j != k)
                for (int a = 0; a &amp;lt; maxv; ++a)
                    g[p0][a][j + 1] = std::min(g[p0][a][j + 1], f[p0][p1][j] + (a ^ p1));
        &amp;#125;
        if (i &amp;gt;= k)
            std::cout &amp;lt;&amp;lt; f[p0][p1][k] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
        if (!tag0[p0])
            tag0[p0] = 1, d0.push_back(p0);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å‰²è£‚&#34;&gt;å‰²è£‚&lt;/h2&gt;
&lt;p&gt;å¦‚æœçŠ¶æ€çš„è‹¥å¹²ç»´ä¹‹é—´è¿æ— æœºè”ç³»éƒ½æ²¡äº†ï¼Œå¯ä»¥ç›´æ¥æŠŠ DP æ•°ç»„æ‹†å¼€ï¼Œå„è‡ªè½¬ç§»å„è‡ªçš„ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åç­”æ¡ˆçš„æ‹¼æ¥ï¼Œå¯èƒ½æ˜¯æšä¸¾ã€ç›´æ¥æ‹¼ã€ç”¨ä¸€ä¸ªè½¬ç§»å¦ä¸€ä¸ªä¹‹ç±»ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜ç»å…¸é¢˜-1&#34;&gt;ä¾‹é¢˜ï¼šç»å…¸é¢˜&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(w_{N\times M}\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\((A,B)_{1\sim K}\)&lt;/span&gt;ï¼Œæœ€å¤§åŒ– &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i=1}^K w_{A_{i-1},A_i}+w_{B_{i-1},B_i}\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å…ˆ DP å‡ºæ¥ &lt;span class=&#34;math inline&#34;&gt;\(A\)&lt;/span&gt;ï¼Œå† DP å‡ºæ¥ &lt;span class=&#34;math inline&#34;&gt;\(B\)&lt;/span&gt;ï¼Œç›´æ¥ç›¸åŠ å³å¯ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ä¾‹é¢˜mnogomet&#34;&gt;ä¾‹é¢˜ï¼šMNOGOMET&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7648&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7648&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æƒ³åˆ°è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{t,i,a,b}\)&lt;/span&gt; è¡¨ç¤ºã€è¿‡å»äº† &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’ï¼Œä¸”çƒåœ¨çƒå‘˜ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰‹ä¸Šï¼Œä¸”ä¸¤ä¸ªé˜Ÿä¼å¾—åˆ†åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt;ã€çš„æ¦‚ç‡ã€‚é‚£ä¹ˆæšä¸¾çƒä¸Šä¸€æ¬¡åœ¨è°æ‰‹ä¸Šï¼Œæœ‰ç¾è§‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(O(T\cdot N^2R^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æ¯”åˆ†å˜åŠ¨æ—¶ï¼ˆä¸ŠåŠä¸ªæ—¶åˆ»å®Œæˆå°„é—¨å¹¶ä¼ çƒï¼‰çƒä¸€å®šåœ¨æŸä¸ªé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·æ‰‹ä¸Šï¼›&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¿™ä¸€ç»´å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; ä¹Ÿæ²¡æœ‰ç›¸äº’çš„å¹²æ‰°ï¼›æ•…å¯ä»¥å°† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æå–å‡ºæ¥ï¼ˆä½œä¸ºå¯¹æ¯”ï¼Œå°„é—¨å’Œå¤ºçƒã€ä¼ çƒéƒ½ä¼šå½±å“ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œæ‰€ä»¥åˆ†è£‚å‡ºæ¥çš„çŠ¶æ€ä¸­å¿…é¡»åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼‰ã€‚å…·ä½“åœ°ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(g_{t,0/1,i}\)&lt;/span&gt; è¡¨ç¤ºã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ï¼ŒèŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’ï¼Œä¸”æ²¡äººå°„é—¨ï¼Œä¸”çƒåœ¨çƒå‘˜ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰‹ä¸Šã€çš„æ¦‚ç‡ã€‚å‘ç°å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(T\times N^2)\)&lt;/span&gt; è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶è¿™é‡Œå°±æ˜¯æ¡ä»¶æ¦‚ç‡äº†ã€‚å…¶ä¸­ã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ã€å°±æ˜¯æ¡ä»¶ã€‚&lt;/p&gt;
å†é¢„å¤„ç†å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(G_{t,0/1,0/1,0/1}\)&lt;/span&gt; è¡¨ç¤ºã€ä¸€å¼€å§‹çƒåœ¨å“ªä¸ªçƒé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ï¼ŒèŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’ï¼Œå“ªä¸ªçƒé˜Ÿå°„é—¨ï¼Œï¼ˆæ²¡ï¼‰å°„è¿›ã€çš„æ¦‚ç‡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{t,0/1,a,b}\)&lt;/span&gt; è¡¨ç¤ºã€è¿‡å»äº† &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ç§’ï¼Œçƒåœ¨å“ªä¸ªé˜Ÿçš„ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å·ï¼Œä¸”å¾—åˆ†ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt;ã€çš„æ¦‚ç‡ã€‚æšä¸¾è·ç¦»ä¸Šä¸€æ¬¡å°„é—¨çš„æ—¶é—´ï¼Œå¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(T^2\times R^2)\)&lt;/span&gt; å®Œæˆè½¬ç§»ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, r, T;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; r &amp;gt;&amp;gt; T;
    using arr = std::vector&amp;lt;double&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    brr p(2 * n + 1, arr(2)), pp(2 * n + 1, arr(2 * n + 1));
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; p[i][1], p[i][0] = 1. - p[i][1];
        int ss, sd;
        std::cin &amp;gt;&amp;gt; ss &amp;gt;&amp;gt; sd;
        double P = 1. / (ss + sd + 1);
        p[i][0] *= P, p[i][1] *= P;
        for (int x; ss--; pp[i][x] = P)
            std::cin &amp;gt;&amp;gt; x;
        for (int x; sd--; pp[i][x + n] = P)
            std::cin &amp;gt;&amp;gt; x;
    &amp;#125;
    for (int i = n + 1; i &amp;lt;= 2 * n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; p[i][1], p[i][0] = 1. - p[i][1];
        int ss, sd;
        std::cin &amp;gt;&amp;gt; ss &amp;gt;&amp;gt; sd;
        double P = 1. / (ss + sd + 1);
        p[i][0] *= P, p[i][1] *= P;
        for (int x; ss--; pp[i][x + n] = P)
            std::cin &amp;gt;&amp;gt; x;
        for (int x; sd--; pp[i][x] = P)
            std::cin &amp;gt;&amp;gt; x;
    &amp;#125;
    brr s(T + 1, arr(2));
    crr g(T + 1, brr(2, arr(2 * n + 1)));
    std::vector&amp;lt;crr&amp;gt; G(T + 1, crr(2, brr(2, arr(2)))), f(T + 1, crr(2, brr(r + 1, arr(r + 1))));
    g[0][0][1] = g[0][1][n + 1] = 1.;
    for (int t = 1; t &amp;lt;= T; ++t) &amp;#123;
        for (int f1 = 0; f1 &amp;lt;= 1; ++f1)
            for (int i = 1; i &amp;lt;= 2 * n; ++i) &amp;#123;
                G[t][f1][i &amp;gt; n][0] += g[t - 1][f1][i] * p[i][0];
                G[t][f1][i &amp;gt; n][1] += g[t - 1][f1][i] * p[i][1];
                for (int j = 1; j &amp;lt;= 2 * n; ++j)
                    if (j != i)
                        g[t][f1][i] += pp[j][i] * g[t - 1][f1][j];
                // printf(&amp;quot;spend %ds, start from %d, now at %d: %.10lf\n&amp;quot;, t, 1 + f1 * n, i, g[t][f1][i]);
                s[t][f1] += g[t][f1][i];
            &amp;#125;
    &amp;#125;
    // puts(&amp;quot;------------------------------------&amp;quot;);
    // for (int t = 1; t &amp;lt;= T; ++t) &amp;#123;
    //     for (int f1 = 0; f1 &amp;lt;= 1; ++f1)
    //         for (int f2 = 0; f2 &amp;lt;= 1; ++f2)
    //             for (int f3 = 0; f3 &amp;lt;= 1; ++f3)
    //                 printf(&amp;quot;spend %ds, start from %d, %d shoots, STATUS: %d, P = %.10lf\n&amp;quot;, t, 1 + f1 * n, 1 + f2, f3, G[t][f1][f2][f3]);
    // &amp;#125;
    // puts(&amp;quot;------------------------------------&amp;quot;);
    f[0][0][0][0] = 1.;
    for (int t = 0; t &amp;lt; T; ++t)
        for (int f1 = 0; f1 &amp;lt;= 1; ++f1)
            for (int a = 0; a &amp;lt; r; ++a)
                for (int b = 0; b &amp;lt; r; ++b) &amp;#123;
                    for (int t1 = 1; t + t1 &amp;lt;= T; ++t1) &amp;#123;
                        f[t + t1][0][a][b] += f[t][f1][a][b] * G[t1][f1][1][0];
                        f[t + t1][0][a][b + 1] += f[t][f1][a][b] * G[t1][f1][1][1];
                        f[t + t1][1][a][b] += f[t][f1][a][b] * G[t1][f1][0][0];
                        f[t + t1][1][a + 1][b] += f[t][f1][a][b] * G[t1][f1][0][1];
                        if (t + t1 == T)
                            f[T][0][a][b] += f[t][f1][a][b] * s[t1][f1];
                    &amp;#125;
                &amp;#125;
    // for (int t = 0; t &amp;lt;= T; ++t)
    //     for (int f1 = 0; f1 &amp;lt;= 1; ++f1)
    //         for (int a = 0; a &amp;lt;= r; ++a)
    //             for (int b = 0; b &amp;lt;= r; ++b)
    //                 if (f[t][f1][a][b] &amp;gt; 1e-10)
    //                     printf(&amp;quot;%ds later, %d shoots, %d : %d, P = %.10lf\n&amp;quot;, t, 1 + !f1 * n, a, b, f[t][f1][a][b]);
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(10);
    for (int a = 0; a &amp;lt;= r; ++a) &amp;#123;
        for (int b = 0; b &amp;lt;= r; ++b) &amp;#123;
            if (a == r &amp;amp;&amp;amp; b == r)
                continue;
            double res(0.);
            if (a == r)
                for (int t = r; t &amp;lt;= T; ++t)
                    res += f[t][1][r][b];
            else if (b == r)
                for (int t = r; t &amp;lt;= T; ++t)
                    res += f[t][0][a][r];
            else
                res = f[T][0][a][b] + f[T][1][a][b];
            std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="DP ä¼˜åŒ–" />
        <updated>2025-05-26T07:05:53.000Z</updated>
    </entry>
</feed>
