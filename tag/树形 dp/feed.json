{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"æ ‘å½¢ dp\" tag",
    "description": "",
    "home_page_url": "https://xsc062.netlify.app",
    "items": [
        {
            "id": "https://xsc062.netlify.app/20250824/",
            "url": "https://xsc062.netlify.app/20250824/",
            "title": "æ‚é¢˜",
            "date_published": "2025-08-24T07:37:55.000Z",
            "content_html": "<p>ä¸ä¼šçš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šäº†</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"b.-k-set-tree\">B. K-Set Tree</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1691F\" class=\"uri\">https://www.luogu.com.cn/problem/CF1691F</a></p>\n<p>ä»¤ <span class=\"math inline\">\\(F_i\\)</span> è¡¨ç¤ºä»¥ <span class=\"math inline\">\\(1\\)</span> ä¸ºæ ¹æ—¶ï¼Œ<span class=\"math inline\">\\(S\\)</span> åœ¨ <span class=\"math inline\">\\(i\\)</span> å­æ ‘å†…çš„ç­”æ¡ˆã€‚åˆ™ï¼š</p>\n<p><span class=\"math display\">\\[\nF_u=\\left(C_{siz_u}^k-\\sum C_{siz_v}^k\\right)\\cdot siz_u+\\sum F_v\\\\\n\\]</span></p>\n<p>ç›´æ¥æ¢æ ¹æ˜¯å¾ˆå¤æ‚çš„ï¼›æŠŠ <span class=\"math inline\">\\(\\sum C_{siz_v}^k\\)</span> è®°ä½œ <span class=\"math inline\">\\(dp_u\\)</span>ï¼ŒæŠŠ <span class=\"math inline\">\\(\\sum F_v\\)</span> è®°ä½œ <span class=\"math inline\">\\(f_u\\)</span>ï¼Œé‚£ä¹ˆï¼š</p>\n<p><span class=\"math display\">\\[\nres=\\sum(C_n^k-dp_u)\\cdot n+f_u\\\\\n\\]</span></p>\n<p><strong>è¿™æ ·åšæ˜¯ä¸ºäº†æŠŠä¸¤ä¸ªå’Œ <span class=\"math inline\">\\(v\\)</span> æœ‰å…³çš„ä¹˜é¡¹æ‹†å¼€æ¥æ¢æ ¹</strong>ï¼Œå®é™…æ¢æ ¹çš„æ—¶å€™å°±åªç”¨åˆ†åˆ«æ¢ <span class=\"math inline\">\\(f,dp\\)</span> ä¸¤ä¸ªå€¼ï¼Œä¸ç”¨è€ƒè™‘äºŒæ¬¡é¡¹ç­‰é—®é¢˜ï¼Œè®¡ç®—é‡ä¼šå°‘å¾ˆå¤š</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, k;\n    std::cin &gt;&gt; n &gt;&gt; k;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[n] = qkp(fac[n], mod - 2);\n    for (int i = n - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        if (m &gt; n)\n            return 0ll;\n        return fac[n] * inv[m] % mod * inv[n - m] % mod;\n    &#125;;\n    auto res(0ll);\n    std::vector&lt;int&gt; siz(n + 1), ss(n + 1);\n    std::vector&lt;long long&gt; f(n + 1), dp(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        siz[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                (f[x] += (C(siz[i], k) - dp[i]) * siz[i] + f[i]) %= mod;\n                (dp[x] += C(siz[i], k)) %= mod;\n                siz[x] += siz[i];\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    DFS = [&amp;](int x, int fa) &#123;\n        (res += (C(n, k) - dp[x]) * n + f[x]) %= mod;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                (f[i] += (C(n - siz[i], k) - (dp[x] - C(siz[i], k))) * (n - siz[i]) + f[x] - f[i] - (C(siz[i], k) - dp[i]) * siz[i]) %= mod;\n                (dp[i] += C(n - siz[i], k)) %= mod;\n                DFS(i, x);\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::cout &lt;&lt; (res + mod) % mod &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c.-li-hua-and-path\">C. Li Hua and Path</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1797F\" class=\"uri\">https://www.luogu.com.cn/problem/CF1797F</a></p>\n<p>è€ƒè™‘<strong>å®¹æ–¥</strong>ï¼Œåˆ†åˆ«æ±‚è§£æ»¡è¶³ 1ã€æ»¡è¶³ 2ã€æ»¡è¶³ 12ï¼ˆæ³¨æ„è¦å‡ä¸¤å€ï¼‰å°±èƒ½è®¡ç®—ç­”æ¡ˆ</p>\n<p>å‘ç°é¢˜ç›®æ‰€æ±‚ç‚¹å¯¹å½¢å¼å¾ˆç¬¦åˆ Kruskal é‡æ„æ ‘çš„è¦æ±‚ï¼Œè€ƒè™‘ä»¥å¯¹åº”ç‚¹æƒä¸ºè¾¹æƒï¼Œåˆ†åˆ«å»ºç«‹ minï¼Œmax Kruskal ç‚¹æƒå¤šå‰é‡æ„æ ‘ã€‚</p>\n<details>\n<p><summary>ç‚¹æƒå¤šå‰é‡æ„æ ‘ï¼Ÿ</summary></p>\n<p>åœ¨ç‚¹æƒä¸Šåš Kruskal é‡æ„æ ‘æ—¶ï¼Œå‘ç°è¾¹çš„è™šç‚¹æ˜¯ä¸å¿…è¦çš„ï¼Œå¯ä»¥ç›´æ¥å°†æ›´ä¼˜ç‚¹ä½œä¸ºçˆ¶äº²ã€‚</p>\n<p>å†™çš„æ—¶å€™æœ‰ç‚¹éš¾æƒ³æ¸…æ¥šâ€¦â€¦ å¯ä»¥ç”»ç”»å›¾ï¼Œä»”ç»†ç¡®å®šä¸€ä¸‹ Kruskal é‡æ„æ ‘çš„å…·ä½“æ€§è´¨</p>\n<p>è¿™æ ·åšçš„ä¼˜åŠ¿æ˜¯æ²¡æœ‰è™šç‚¹ï¼Œä¸€äº›é—®é¢˜ä¼šæ–¹ä¾¿ä¸€äº›ï¼›ä½†åŒæ—¶æ”¾å¼ƒäº†äºŒå‰æ ‘çš„ç»“æ„ï¼Œä¸€äº›é¢˜å¯èƒ½æ²¡é‚£ä¹ˆå¥½åšã€‚</p>\n<p>è¿™é“é¢˜åªç”¨ç»å…¸ Kruskal é‡æ„æ ‘ä¹Ÿå¯ä»¥è§£å†³ã€‚</p>\n</details>\n<p>å‘ç° 1 2 å‡å¯ä»¥è½¬åŒ–æˆä¸¤æ£µæ ‘åœ¨ä¸¤æ£µæ ‘ä¸Šçš„ç¥–å­™å…³ç³»è¦æ±‚ï¼Œå¯ä»¥è½»æ¾åœ°åˆ†åˆ«ç»Ÿè®¡æ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„ç‚¹å¯¹æ•°é‡</p>\n<p>è€ƒè™‘æ€ä¹ˆå¤„ç†åŒæ—¶æ»¡è¶³ 12 çš„ï¼Œå‘ç°è¦æ±‚åœ¨ä¸¤æ£µæ ‘ä¸ŠäºŒè€…åº”è¯¥éƒ½å…·æœ‰ç¥–å­™å…³ç³»ï¼Œä¸”æ˜¯ç›¸åçš„ã€‚<del>å¯ä»¥è€ƒè™‘åœ¨ä¸€æ£µæ ‘ä¸Š DFS çš„åŒæ—¶ç”¨ä¸»å¸­æ ‘å­˜å‚¨ç¥–å…ˆï¼Œåœ¨å¦ä¸€é¢—æ ‘ä¸Š ask</del></p>\n<p>è€ƒè™‘ä»æ›´å®¹æ˜“ç”¨ dfn è¡¨ç¤ºçš„å­æ ‘é—®é¢˜æ€è€ƒï¼Œåœ¨ min æ ‘ä¸Šåˆ†é… dfn åï¼Œåœ¨ max æ ‘ä¸Šç”¨ DFS + å›æº¯å¾—åˆ°æ¯ä¸ªç‚¹å®æ—¶ç¥–å…ˆåºåˆ—ï¼Œå­˜åœ¨æ ‘çŠ¶æ•°ç»„é‡Œï¼›ask è¯¥ç‚¹è¢«åˆ†é…çš„ dfn å­æ ‘åŒºé—´å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚</p>\n<p>è€ƒè™‘è¯¢é—®ï¼Œç”±äºæ¯æ¬¡åŠ å…¥çš„éƒ½æ˜¯ç¼–å·æœ€å¤§çš„ç‚¹ï¼Œå¯¹äºæ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„è´¡çŒ®æ˜¯æ˜¾ç„¶çš„ï¼Œè€ŒåŒæ—¶æ»¡è¶³ 12 çš„ç‚¹å°±æ˜¯åœ¨ min æ ‘ä¸Šçš„ç¥–å…ˆï¼Œéƒ½æ˜¯å¥½åšçš„ã€‚</p>\n<p>å®ç°çš„æ—¶å€™ä¸€å®šè¦æŠŠ min / max æ ‘å¯¹åº”çš„æ€§è´¨æ€è€ƒæ¸…æ¥šï¼Œä¸ç„¶ä¼šå¾ˆéº»çƒ¦</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; f1(n + 1), f2(n + 1);\n    std::iota(f1.begin() + 1, f1.end(), 1);\n    std::iota(f2.begin() + 1, f2.end(), 1);\n    std::function&lt;int(int)&gt; find1 = [&amp;](int x) &#123;\n        return x == f1[x] ? x : f1[x] = find1(f1[x]);\n    &#125;;\n    std::function&lt;int(int)&gt; find2 = [&amp;](int x) &#123;\n        return x == f2[x] ? x : f2[x] = find2(f2[x]);\n    &#125;;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1), g2(n + 1), adj1(n + 1), adj2(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        if (x &gt; y)\n            std::swap(x, y);\n        adj1[y].push_back(x);\n        adj2[x].push_back(y);\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        for (auto j : adj1[i]) &#123;\n            int fi = find1(i), fj = find1(j);\n            g1[fi].push_back(fj), f1[fj] = fi;\n        &#125;\n    for (int i = n; i; --i)\n        for (auto j : adj2[i]) &#123;\n            int fi = find2(i), fj = find2(j);\n            g2[fi].push_back(fj), f2[fj] = fi;\n        &#125;\n    std::vector&lt;int&gt; bit(n + 1), dfn(n + 1), rfn(n + 1);\n    auto lowbit = [](int x) &#123;\n        return x &amp; -x;\n    &#125;;\n    auto add = [&amp;](int x, int v) &#123;\n        for (; x &lt;= n; x += lowbit(x))\n            bit[x] += v;\n        return;\n    &#125;;\n    auto ask = [&amp;](int x) &#123;\n        int res = 0;\n        for (; x; x -= lowbit(x))\n            res += bit[x];\n        return res;\n    &#125;;\n    int rt1 = 0, rt2 = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (f1[i] == i)\n            rt1 = i;\n        if (f2[i] == i)\n            rt2 = i;\n    &#125;\n    int q;\n    std::cin &gt;&gt; q;\n    std::vector&lt;int&gt; dep1(n + 1), dep2(n + q + 1);\n    long long res = 0ll;\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now;\n        res += dep1[x];\n        for (auto i : g1[x]) &#123;\n            dep1[i] = dep1[x] + 1;\n            DFS(i);\n        &#125;\n        rfn[x] = now;\n        return;\n    &#125;;\n    DFS(rt1);\n    DFS = [&amp;](int x) &#123;\n        res += dep2[x];\n        res -= 2 * (ask(rfn[x]) - ask(dfn[x] - 1));\n        add(dfn[x], 1);\n        for (auto i : g2[x]) &#123;\n            dep2[i] = dep2[x] + 1;\n            DFS(i);\n        &#125;\n        add(dfn[x], -1);\n        return;\n    &#125;;\n    DFS(rt2);\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    for (int fa; q--; ) &#123;\n        std::cin &gt;&gt; fa;\n        dep2[++n] = dep2[fa] + 1;\n        res += (n - 1) - dep2[n];\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-å›¢é˜Ÿé€‰æ‹”\">D. å›¢é˜Ÿé€‰æ‹”</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6534/problem/4\" class=\"uri\">http://222.180.160.110:61235/contest/6534/problem/4</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œä»ä¸­ä»»é€‰ä¸€äº›äº’ä¸ç›¸äº¤çš„åŒºé—´ï¼Œæ»¡è¶³æ¯ä¸ªåŒºé—´å†…å…ƒç´ çš„ gcd ç›¸åŒã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 10^5,V\\le 10^7\\)</span>ã€‚</p>\n</blockquote>\n<p>æ³¨æ„åˆ°å›ºå®šä¸€ä¸ªå·¦ç«¯ç‚¹åï¼Œç§»åŠ¨å³ç«¯ç‚¹ï¼Œgcd æ¯æ¬¡è‡³å¤šå‡å°åˆ°åŸæ¥çš„ä¸€åŠï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ç§ç±»æœ‰ <span class=\"math inline\">\\(\\log V\\)</span> ç§ã€‚æ•…å…¨åºåˆ—çš„ gcd æ€»æ•°æ˜¯ <span class=\"math inline\">\\(O(n\\log V)\\)</span> çš„ã€‚</p>\n<p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸æ­¤åŸç†ç±»ä¼¼çš„å…¨å±€ç­”æ¡ˆæ±‚æ³•ï¼šå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œå‘å·¦å¤„ç†å‡ºæ¯ä¸€æ®µ <span class=\"math inline\">\\([l,r]\\)</span>ï¼Œæ»¡è¶³ <span class=\"math inline\">\\(\\gcd(a_{l\\cdots i})=\\gcd(a_r\\cdots i)\\)</span>ï¼Œå¹¶è®°å½•è¯¥ <span class=\"math inline\">\\(\\gcd\\)</span>ã€‚è¿™æ ·æ±‚å‡ºæ¥çš„ <span class=\"math inline\">\\((i,l,r)\\)</span> å…±æœ‰ <span class=\"math inline\">\\(O(n\\log V)\\)</span> æ®µã€‚</p>\n<p>å¯¹äºæ¯ä¸ª gcd æœ‰ <span class=\"math inline\">\\(f_{i}=f_{i-1}+\\sum\\limits_{j=l_i}^{r_i} f_{j - 1}\\)</span>ï¼Œå¯ä»¥åšä¸€ä¸ªæ‰«æçº¿ï¼Œå¾—åˆ°å…¨å±€ç­”æ¡ˆï¼›å‘å‰å‘ååˆ†åˆ«åšåˆ° <span class=\"math inline\">\\(i-1,i+1\\)</span>ï¼Œç›¸ä¹˜å°±èƒ½å¾—åˆ° <span class=\"math inline\">\\(i\\)</span> æœªè¢«é€‰å–æ—¶çš„ç­”æ¡ˆ</p>\n<p>è€ƒè™‘æ€ä¹ˆå®Œæˆã€ç›¸ä¹˜ã€è¿™ä¸ªåŠ¨ä½œï¼šæœ€åçš„ <span class=\"math inline\">\\(f\\)</span> åœ¨æ¯ä¸ªå³ç«¯ç‚¹å¤„å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥è½¬åŒ–æˆè‹¥å¹²æ®µ <span class=\"math inline\">\\(f\\)</span>ï¼›åè¿‡æ¥çš„ <span class=\"math inline\">\\(f&#39;\\)</span> äº¦å¯ä»¥è¿™æ ·è½¬åŒ–ã€‚å°† <span class=\"math inline\">\\(f\\)</span> æ•´ä½“åç§»ä¸€ä½ã€<span class=\"math inline\">\\(f&#39;\\)</span> æ•´ä½“å‰ç§»ä¸€ä½ï¼Œå°±å¯ä»¥å¯¹é½ã€‚äºŒè€…çš„ç«¯ç‚¹æ€»æ•°æ˜¯å‡æ‘Šå• log çš„ï¼ŒåŒºé—´æ€»æ•°ä¹Ÿå°±æ˜¯å‡æ‘Šå• log çš„ï¼ˆå½’å¹¶å°±èƒ½å¿«é€Ÿå¯»æ‰¾åˆ°åŒºé—´ï¼‰ï¼Œç”¨å·®åˆ†åšä¸€ä¸ªåŒºé—´åŠ å³å¯ã€‚</p>\n<p>ç”¨äºŒåˆ†å‹‰å¼ºå• log è§£å†³äº†è½¬ç§»ï¼›è¿˜çœ‹åˆ° <span class=\"citation\" data-cites=\"spdarkle\">@spdarkle</span> ç–‘ä¼¼åœ¨ <span class=\"math inline\">\\(1\\sim n\\)</span> ä¸Šç›´æ¥åšçš„<a href=\"http://222.180.160.110:61235/submission/3108272\">åšæ³•</a>ï¼Œå’Œ <span class=\"citation\" data-cites=\"Rosmist\">@Rosmist</span> ç–‘ä¼¼ç›´æ¥åœ¨æ¯ä¸ª <span class=\"math inline\">\\(i\\)</span> ä¸Šåšçš„<a href=\"http://222.180.160.110:61235/submission/3108581\">åšæ³•</a>ã€‚å®˜è§£æ˜¯ä¸ªçœ‹ä¸æ‡‚çš„åšæ³•</p>\n<p>å‘ƒï¼Œå¥½åƒä¸€ä¸å°å¿ƒæ‹¿äº†æœ€ä¼˜è§£ã€‚è€Œä¸”ä¼˜åŠ¿å¾ˆæ˜æ˜¾ï¼ˆæ€ä¹ˆæ€»ç”¨æ—¶æ¯”åˆ«äººä¸€ä¸ªç‚¹è¿˜å°‘ï¼Ÿï¼‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p>\n<p>å¯èƒ½å› ä¸ºå¤§å®¶éƒ½çœ‹ä¸æ‡‚å®˜è§£ï¼Œåšæ³•æ¯”è¾ƒå¤šæ ·ï¼Ÿé™¤äº†æˆ‘ä¹‹å¤–æ¯”è¾ƒå¿«çš„ lwz å’Œ <span class=\"citation\" data-cites=\"GoldSpade\">@GoldSpade</span> éƒ½ç”¨å½’å¹¶å®Œæˆæœ€åä¸€æ­¥ï¼›æˆ‘è¾ƒä»–ä»¬çš„é¢å¤–ä¼˜åŠ¿å¤§æ¦‚æ˜¯ç”¨äºŒåˆ†æ¢æ‰äº†æ ‘çŠ¶æ•°ç»„ï¼Ÿè¿·æƒ‘</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;selection.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;selection.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;ex_selection2.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; st(20, std::vector&lt;int&gt; (n + 1));\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], st[0][i] = a[i];\n    for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)\n        for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)\n            st[j][i] = std::__gcd(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);\n    auto askgcd = [&amp;](int l, int r) &#123;\n        int k = std::__lg(r - l + 1);\n        return std::__gcd(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);\n    &#125;;\n    std::unordered_map&lt;int, int&gt; tab;\n    struct node &#123;\n        int i, l, r;\n        bool operator&lt; (const int q) const &#123;\n            return i &lt; q;\n        &#125;\n        bool operator&lt;= (const int q) const &#123;\n            return i &lt;= q;\n        &#125;\n    &#125;;\n    std::vector&lt;std::vector&lt;node&gt; &gt; p1, p2;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (int to = i; to &gt;= 1; ) &#123;\n            int at = i, g = askgcd(to, i);\n            for (int l = 1, r = to, mid; l &lt;= r; ) &#123;\n                mid = (l + r) &gt;&gt; 1;\n                if (askgcd(mid, i) == g)\n                    at = mid, r = mid - 1;\n                else\n                    l = mid + 1;\n            &#125;\n            if (!tab.count(g)) &#123;\n                tab[g] = (int)p1.size();\n                p1.emplace_back(), p2.emplace_back();\n            &#125;\n            p1[tab[g]].push_back(&#123; i, at, to &#125;);\n            to = at - 1;\n        &#125;\n        for (int to = i; to &lt;= n; ) &#123;\n            int at = i, g = askgcd(i, to);\n            for (int l = to, r = n, mid; l &lt;= r; ) &#123;\n                mid = (l + r) &gt;&gt; 1;\n                if (askgcd(i, mid) == g)\n                    at = mid, l = mid + 1;\n                else\n                    r = mid - 1;\n            &#125;\n            if (!tab.count(g)) &#123;\n                tab[g] = (int)p2.size();\n                p1.emplace_back(), p2.emplace_back();\n            &#125;\n            p2[tab[g]].push_back(&#123; i, to, at &#125;);\n            to = at + 1;\n        &#125;\n    &#125;\n    auto s(0ll);\n    std::vector&lt;int&gt; x1(n + 1), x2(n + 2), pos(2 * n + 3);\n    std::vector&lt;long long&gt; f1(n + 1), f2(n + 2), s1(n + 1), s2(n + 2), diff(n + 1);\n    for (auto [g, id] : tab) &#123;\n        // printf(&quot;g = %d: \\n&quot;, g);\n        int n1 = (int)p1[id].size();\n        x1[0] = 0, f1[0] = s1[0] = 1ll;\n        for (int i = 1; i &lt;= n1; ++i) &#123;\n            auto [x, L, R] = p1[id][i - 1];\n            --L, --R;\n            x1[i] = x, f1[i] = f1[i - 1];\n            int l = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, L) - x1.begin() - 1,\n                r = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, R) - x1.begin() - 1;\n            if (l == r)\n                (f1[i] += f1[l] * (R - L + 1)) %= mod;\n            else &#123;\n                f1[i] += s1[r - 1] + mod - s1[l];\n                f1[i] += f1[r] * (R - x1[r] + 1);\n                f1[i] += f1[l] * (x1[l + 1] - L);\n                f1[i] %= mod;\n            &#125;\n            // printf(&quot;  r = %d, l = [%d, %d]: %lld\\n&quot;, x, L, R, f1[i]);\n            if (i != n1)\n                s1[i] = (s1[i - 1] + f1[i] * (p1[id][i].i - x)) % mod;\n        &#125;\n        (s += f1[n1] - 1) %= mod;\n        int n2 = (int)p2[id].size();\n        x2[n2 + 1] = n + 1, f2[n2 + 1] = s2[n2 + 1] = 1ll;\n        for (int i = n2; i; --i) &#123;\n            auto [x, L, R] = p2[id][i - 1];\n            ++L, ++R;\n            x2[i] = x, f2[i] = f2[i + 1];\n            int l = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, L) - x2.begin(),\n                r = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, R) - x2.begin();\n            if (l == r)\n                (f2[i] += f2[l] * (R - L + 1)) %= mod;\n            else&#123;\n                f2[i] += s2[l + 1] + mod - s2[r];\n                f2[i] += f2[r] * (R - x2[r - 1]);\n                f2[i] += f2[l] * (x2[l] - L + 1);\n                f2[i] %= mod;\n            &#125;\n            // printf(&quot;  l = %d, r = [%d, %d]: %lld\\n&quot;, x, L, R, f2[i]);\n            if (i != 1)\n                s2[i] = (s2[i + 1] + f2[i] * (x - p2[id][i - 2].i)) % mod;\n        &#125;\n        for (int i = 0; i &lt; n1; ++i)\n            x1[i] = x1[i + 1];\n        x1[n1] = n;\n        int t = (x2[1] == 1) + 1;\n        for (int i = 1; i &lt;= n2 + 1; ++i)\n            --x2[i];\n        std::merge(x1.begin(), x1.begin() + n1 + 1, x2.begin() + t, x2.begin() + n2 + 2, pos.begin() + 1);\n        int m = std::unique(pos.begin() + 1, pos.begin() + n1 + n2 + 4 - t) - pos.begin() - 1;\n        for (int i = 1, p1 = 0, p2 = t, la = 0; i &lt;= m; ++i) &#123;\n            for (; p1 + 1 &lt;= n1 &amp;&amp; x1[p1] &lt; pos[i]; ++p1);\n            for (; p2 + 1 &lt;= n2 + 1 &amp;&amp; x2[p2] &lt; pos[i]; ++p2);\n            (diff[la + 1] += f1[p1] * f2[p2] + mod - 1) %= mod;\n            // printf(&quot;  [%d, %d]: %lld, %lld\\n&quot;, la + 1, pos[i], f1[p1], f2[p2]);\n            if (pos[i] + 1 &lt;= n)\n                (diff[pos[i] + 1] += mod - f1[p1] * f2[p2] + 1) %= mod;\n            la = pos[i];\n        &#125;\n    &#125;\n    // std::cout &lt;&lt; s &lt;&lt; &#39;\\n&#39;;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        (diff[i] += diff[i - 1]) %= mod;\n        std::cout &lt;&lt; (s + mod - diff[i]) % mod &lt;&lt; &#39; &#39;;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<p>æˆ‘ä¸€å¼€å§‹å°† <span class=\"math inline\">\\(f\\)</span> å®šä¹‰ä¸ºå•ç‚¹ç­”æ¡ˆè€Œéå‰ç¼€å’Œï¼Œä¼šå¯¼è‡´éœ€è¦çº¿æ®µæ ‘ç»´æŠ¤ç­‰å·®åºåˆ—ï¼Œè¿˜ä¸¢å¤±äº†ç­”æ¡ˆæ®µæ•°ä¸å¤šè¿™ä¸ªæ€§è´¨ï¼Œéå¸¸éº»çƒ¦ã€‚å°† <span class=\"math inline\">\\(f\\)</span> çš„æ„ä¹‰æ›¿æ¢ä¸ºå‰ç¼€å’Œåï¼Œå°±å¯ä»¥å¾ˆè½»æ¾åœ°åšäº†ã€‚</p>\n<hr />\n<h2 id=\"a.-å®‡å®™\">A. å®‡å®™</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6535/problem/1\" class=\"uri\">http://222.180.160.110:61235/contest/6535/problem/1</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œå¯¹äº <span class=\"math inline\">\\(k=1,2,\\cdots,n-1\\)</span>ï¼Œå›ç­”ï¼š</p>\n<ul>\n<li>ä»¤ <span class=\"math inline\">\\(i\\)</span> ä» <span class=\"math inline\">\\(1\\)</span> å¼€å§‹è‡ªå¢ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œéƒ½å¯ä»¥é€‰å– <span class=\"math inline\">\\(k\\)</span> ä¸ªäº’ä¸ç›¸åŒçš„ä¸‹æ ‡ï¼Œå¹¶ä½¿å®ƒä»¬å¯¹åº”çš„å…ƒç´ å¢åŠ  1ã€‚æ­¤æ—¶ï¼Œè‹¥å­˜åœ¨å…ƒç´ ä¸å¤§äº <span class=\"math inline\">\\(i\\)</span>ï¼Œåœæ­¢ã€‚è¾“å‡ºåœæ­¢æ—¶ <span class=\"math inline\">\\(i\\)</span> å¯èƒ½çš„æœ€å¤§å€¼ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n\\le 10^6,V\\le 10^9\\)</span>ã€‚</p>\n</blockquote>\n<p>å‘ç°ä¸å¤§äºè¿™ä¸ª condition æœ‰äº›åäººç±»ï¼Œå…ˆå°† <span class=\"math inline\">\\(a\\)</span> å…¨éƒ¨å‡ 1ï¼Œè½¬åŒ–æˆå°äºæ¥è€ƒè™‘</p>\n<p>è€ƒè™‘èƒ½åšæŒåˆ° <span class=\"math inline\">\\(i\\)</span> çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶ï¼Œå³ <span class=\"math inline\">\\(\\sum\\limits_{a_j&lt;i} i-a_j\\le k\\cdot i\\)</span></p>\n<p>å®¹æ˜“å‘ç°è¯¥æ¡ä»¶åŒæ—¶æ˜¯å……åˆ†çš„ï¼Œå¯ä»¥æœæ‘©å°”æŠ•ç¥¨æ€è€ƒ</p>\n<p>å¯¹ <span class=\"math inline\">\\(a\\)</span> æ’åºï¼Œåœæ­¢æ—¶å‚ä¸è¿ç®—çš„ <span class=\"math inline\">\\(a_j\\)</span> æ˜¯è¶Šæ¥è¶Šå¤šçš„ï¼Œæ•…è®°å½•æœ€åä¸€ä¸ªå‚ä¸è¿ç®—çš„ä¸‹æ ‡ï¼Œé€æ­¥æŒªåŠ¨ï¼ˆå½“å‘ç°è§£å‡ºæ¥çš„ <span class=\"math inline\">\\(i\\)</span> æ¯”ä¸‹ä¸€ä¸ªæ›´å¤§æ—¶å°±éœ€è¦æŒªåŠ¨ï¼‰ï¼ŒåŒæ—¶è§£ä¸ç­‰å¼å³å¯ã€‚</p>\n<p><span class=\"citation\" data-cites=\"Quack\">@Quack</span> äº‘æˆ‘åœ¨åœºä¸Šèƒ½æƒ³å‡ºå®˜è§£å¯¹æˆ‘æ¥è¯´æ˜¯éå¸¸äº†ä¸èµ·çš„ï¼ˆå…¶å®åœºä¸Šå†™æ­£è§£çš„äººå°‘å¾—å‡ºå¥‡ï¼‰ï¼Œæˆ‘ä¹Ÿä¸å¾—ä¸æ‰¿è®¤æˆ‘èƒ½åšå‡ºæ¥ç¡®å®æœ‰ä¸€å®šè¿æ°”æˆåˆ†ï¼Œä¹Ÿèƒ½ä»ä¸­ä¸€çª¥æˆ‘ä»¤äººçœ¼å‰ä¸€é»‘çš„æ•°å­¦ç´ å…»ï¼</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n    std::freopen(&quot;universe.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;universe.out&quot;, &quot;w&quot;, stdout);\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    int n;\n    std::cin &gt;&gt; n, std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], --a[i];\n    std::sort(a.begin() + 1, a.end());\n    int id = 1;\n    long long s = a[1];\n    for (int i = 1; i &lt; n; ++i) &#123;\n        if (id &lt; i + 1)\n            s += a[++id];\n        long long x = s / (id - i);\n        for (; id != n &amp;&amp; x &gt; a[id + 1]; s += a[++id], x = s / (id - i));\n        std::cout &lt;&lt; x &lt;&lt; &#39; &#39;;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b.-è·³è·ƒ\">B. è·³è·ƒ</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6535/problem/2\" class=\"uri\">http://222.180.160.110:61235/contest/6535/problem/2</a></p>\n<blockquote>\n<p>ç»™å®šé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„ 01 åºåˆ—å’Œè·³è·ƒä¸Šé™ <span class=\"math inline\">\\(k\\)</span>ã€‚ç»™å®š <span class=\"math inline\">\\(q\\)</span> ä¸ªè¯¢é—®ï¼Œå›ç­”ï¼š</p>\n<ul>\n<li>ä» <span class=\"math inline\">\\(a\\)</span> è·³åˆ° <span class=\"math inline\">\\(b\\)</span>ï¼Œä¿è¯ <span class=\"math inline\">\\(a,b\\)</span> çš„é¢œè‰²å‡ä¸º 1ï¼Œæ¯æ¬¡ä¸èƒ½è·³è¶…è¿‡ <span class=\"math inline\">\\(k\\)</span> æ ¼æˆ–è·³å‡ºå»ï¼Œåœ¨æœ€å°åŒ–è¸©åˆ° 0 æ•°é‡çš„å‰æä¸‹ï¼Œæœ€å°åŒ–è·³è·ƒæ¬¡æ•°ï¼Œè¾“å‡ºè¿™ä¸¤ä¸ªå€¼ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n,q\\le5\\times10^5\\)</span>ã€‚</p>\n</blockquote>\n<p>å®¹æ˜“å‘ç°åªèƒ½å¾€ä¸€ä¸ªæ–¹å‘è·³ï¼Œé‚£ä¹ˆä¸å¦¨ä»¤ <span class=\"math inline\">\\(a&lt;b\\)</span>ã€‚æœ‰ä¸€ä¸ªè´ªå¿ƒçš„æƒ³æ³•æ˜¯èƒ½å¾€å³å°±å¾€å³ï¼Œæ‰‹ç©å‘ç°<strong>æ˜¯å¯¹çš„</strong>ï¼ˆæˆ‘åœºä¸Šæ‰‹ç©è¿‡ååšå®šåœ°è®¤ä¸ºæ˜¯é”™çš„ï¼›å¯èƒ½å’Œæ²¡æ—¶é—´äº†å…µè’é©¬ä¹±æœ‰å…³ï¼‰ã€‚è¿™æ ·å°±å¾ˆå¥½æƒ³åˆ°ç¬¬äºŒé—®éœ€è¦å€å¢ï¼›ä½†æŠŠä¸¤ä¸ªé—®ç»“åˆèµ·æ¥è€ƒè™‘æ˜¯æœ‰ç‚¹å›°éš¾çš„ï¼Œèµ›æ—¶å°±æ„è¯†åˆ°è¿™ä¸¤é—®çš„è”ç³»æ²¡æœ‰çœ‹èµ·æ¥é‚£ä¹ˆå¤§ï¼Œç”šè‡³å¾ˆå¯èƒ½æ˜¯å‰²è£‚çš„ã€‚</p>\n<p>å•ç‹¬è€ƒè™‘ç¬¬ä¸€é—®ï¼Œå‘ç°å¯¹äºä¸€æ®µé•¿åº¦ä¸º <span class=\"math inline\">\\(len\\)</span> çš„ 0ï¼Œéœ€è¦è¸©åˆ°æ°å¥½ <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {len}k\\right\\rfloor\\)</span> ä¸ª 0ã€‚ç­”æ¡ˆå®¹æ˜“è®¡ç®—ã€‚</p>\n<p>å•ç‹¬è€ƒè™‘ç¬¬äºŒé—®ï¼Œè€ƒè™‘ä¸€ä¸ªç¬¬ä¸€é—®ç­”æ¡ˆå›ºå®šä¸º 0 çš„æƒ…å†µï¼Œä¹Ÿå³æ¯ä¸ª len éƒ½æ¯” <span class=\"math inline\">\\(k\\)</span> å°ã€‚åˆ™é—®é¢˜è½¬åŒ–æˆåœ¨ä¸è¸© 0 çš„æƒ…å†µä¸‹æœ€å°çš„æ­¥æ•°ã€‚å®¹æ˜“ç”¨å€å¢è§£å†³ã€‚</p>\n<p>æœ¬é¢˜æœ€ä»¤äººå°è±¡æ·±åˆ»çš„ç‚¹åœ¨äºäºŒè€…çš„ç»“åˆï¼Œå‘ç°è¿™ <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {len}k\\right\\rfloor\\cdot k\\)</span> ä¸ª 0 æ˜¯æ— è®ºå¦‚ä½•éƒ½ä¼šè¢«ç»è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨åŸå§‹æ•°ç»„é‡Œåˆ æ‰å®ƒä»¬ï¼Œè½¬åŒ–æˆåªè€ƒè™‘ç¬¬äºŒé—®çš„æƒ…å†µ</p>\n<details>\n<p>ï¼Ÿï¼Ÿï¼Ÿ</p>\n<p>æˆ‘å¯¹äºè‡ªå·±è«åå…¶å¦™è·‘å¾—æ¯”åˆ«äººå¿«ä¸€å¤§æˆªè¿™ä»¶äº‹æƒ…å·²ç»å¿«è¦è§æ€ªä¸æ€ªäº†ï¼Œè¿™æ¬¡åˆæ˜¯ä»€ä¹ˆåŸç†ï¼Œæˆ‘é¢„å¤„ç†å†™å¾—æ¯”è¾ƒæ¼‚äº®å—ï¼Ÿï¼Ÿ</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;jump.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;jump.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, k, q, op;\n    std::cin &gt;&gt; n, std::cin &gt;&gt; n &gt;&gt; q &gt;&gt; k &gt;&gt; op;\n    std::vector&lt;int&gt; tmp(n + 1), a(1), s(1), to(n + 2);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        tmp[i] = t - &#39;0&#39;;\n    &#125;\n    tmp.push_back(1), ++n;\n    int cnt = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (tmp[i] == 1) &#123;\n            a.push_back(1), to[i] = (int)a.size() - 1;\n            s.push_back(s.back() + cnt), cnt = 0;\n        &#125;\n        else &#123;\n            ++cnt;\n            if (i == n || tmp[i + 1] == 1) &#123;\n                for (int j = 1; j &lt;= cnt % k; ++j)\n                    a.push_back(0), s.push_back(s.back());\n                cnt /= k;\n            &#125;\n        &#125;\n    &#125;\n    n = (int)a.size() - 1;\n    std::vector&lt;std::vector&lt;int&gt; &gt; f(20, std::vector&lt;int&gt; (n + 1));\n    for (int i = 0; i &lt; 20; ++i)\n        f[i][n] = n;\n    for (int i = n - 1; i; --i) &#123;\n        f[0][i] = std::min(&#123; n, i + k, f[0][i + 1] &#125;);\n        for (; !a[f[0][i]]; --f[0][i]);\n        if (a[i] == 1) &#123;\n            for (int j = 1; j &lt; 20; ++j)\n                f[j][i] = f[j - 1][f[j - 1][i]];\n        &#125;\n    &#125;\n    for (int a, b; q--; ) &#123;\n        std::cin &gt;&gt; a &gt;&gt; b;\n        if (a &gt; b)\n            std::swap(a, b);\n        a = to[a], b = to[b];\n        std::cout &lt;&lt; s[b] - s[a];\n        if (op == 1) &#123;\n            int res = s[b] - s[a];\n            for (int i = 19; ~i; --i)\n                if (f[i][a] &lt; b)\n                    a = f[i][a], res += (1 &lt;&lt; i);\n            std::cout &lt;&lt; &#39; &#39; &lt;&lt; res + 1;\n        &#125;\n        std::cout &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-jongmah\">D. Jongmah</h2>\n<p><a href=\"https://codeforces.com/contest/1110/problem/D\" class=\"uri\">https://codeforces.com/contest/1110/problem/D</a></p>\n<p>å®¹æ˜“å‘ç°å½“è¿ç»­å‡ºç°ä¸‰æ¬¡ <span class=\"math inline\">\\((i-1,i,i+1)\\)</span> æ—¶ï¼Œå¯ä»¥è¢«ä¸‰æ¬¡ç›¸åŒä»£æ›¿ï¼›</p>\n<p>å®¹æ˜“å‘ç°éœ€è¦ä½¿ç”¨ <span class=\"math inline\">\\(f_{i,a,b}\\)</span> æ¥ä»£è¡¨ DP åˆ° <span class=\"math inline\">\\(i\\)</span> æ—¶ï¼Œç”¨äº† <span class=\"math inline\">\\(a\\)</span> ç»„ <span class=\"math inline\">\\((i-1,i,i+1)\\)</span> å’Œ <span class=\"math inline\">\\(b\\)</span> ç»„ <span class=\"math inline\">\\((i,i+1,i+2)\\)</span> æ—¶çš„æœ€å¤§ç»„æ•°ï¼›</p>\n<p>ä½†æ˜¯å¹¶æ²¡æœ‰æƒ³åˆ°è¦å°†äºŒè€…ç»“åˆèµ·æ¥ï¼æ„Ÿè§‰åº”è¯¥æ˜¯èƒ½æ¯”è¾ƒå¿«åšå‡ºæ¥çš„æ°´å¹³ã€‚èƒ½å¯Ÿè§‰åˆ°ä¸å¤ªè®¤çœŸã€‚æ‚”è¿‡ï¼</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 0x3f3f3f3f;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; cnt(m + 1);\n    for (int i = 1, x; i &lt;= n; ++i)\n        std::cin &gt;&gt; x, ++cnt[x];\n    std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(m + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (3, std::vector&lt;int&gt; (3, -inf)));\n    f[0][0][0] = 0ll;\n    for (int i = 1; i &lt;= m; ++i)\n        for (int a = 0; a &lt;= 2; ++a) // i - 1, i, i + 1\n            for (int b = 0; b &lt;= 2; ++b) // i, i + 1, i + 2\n                for (int c = 0; c &lt;= 2; ++c) &#123; // i - 2, i - 1, i\n                    if (a + b + c &gt; cnt[i]) continue;\n                    f[i][a][b] = std::max(f[i][a][b], f[i - 1][c][a] + b + (cnt[i] - a - b - c) / 3);\n                &#125;\n    std::cout &lt;&lt; f[m][0][0] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e.-magic-stones\">E. Magic Stones</h2>\n<p><a href=\"https://codeforces.com/contest/1110/problem/F\" class=\"uri\">https://codeforces.com/contest/1110/problem/F</a></p>\n<p>å®¹æ˜“æƒ³åˆ°è€ƒå¯Ÿå·®åˆ†æ•°ç»„ï¼Œå‘ç°è¿™ä¸ªæ“ä½œå°±æ˜¯äº¤æ¢äº†å·®åˆ†æ•°ç»„çš„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ã€‚æ•…å¯¹äº <span class=\"math inline\">\\(c\\)</span> å’Œ <span class=\"math inline\">\\(t\\)</span> çš„å·®åˆ†æ•°ç»„åˆ†åˆ«æ’åºï¼Œç„¶å check æ˜¯å¦ç›¸ç­‰å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), b(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; b[i];\n    if (a[1] != b[1] || a[n] != b[n]) &#123;\n        std::cout &lt;&lt; &quot;No&quot; &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;int&gt; da(n), db(n);\n    std::adjacent_difference(a.begin() + 1, a.end(), da.begin());\n    std::adjacent_difference(b.begin() + 1, b.end(), db.begin());\n    std::sort(da.begin(), da.end());\n    std::sort(db.begin(), db.end());\n    std::cout &lt;&lt; (da == db ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "å€å¢",
                "æ ‘å½¢ DP",
                "Kruskal é‡æ„æ ‘"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250803/",
            "url": "https://xsc062.netlify.app/20250803/",
            "title": "æ ‘ DP",
            "date_published": "2025-08-03T03:44:54.000Z",
            "content_html": "<p>æ ‘ä¸Šçš„ DP ä»¥åŠ å’Œæ ‘æœ‰å…³çš„ DP</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a---svjetlo\">A - Svjetlo</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7163\" class=\"uri\">https://www.luogu.com.cn/problem/P7163</a></p>\n<p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œå³ä»¤ <span class=\"math inline\">\\(f_{x,0/1/2}\\)</span> åˆ†åˆ«è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(0/1/2\\)</span> ä¸ªç«¯ç‚¹åœ¨å­æ ‘å†…éƒ¨çš„æƒ…å†µï¼›ç„¶åå°±å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ»¡è¶³å¯¹äºå¼€å…³çŠ¶æ€çš„è¦æ±‚ï¼Ÿ</p>\n<p>è¿˜æ˜¯æƒ³å°‘äº†ã€‚å¦‚æœå†åŠ ä¸€ç»´ï¼Œä»ã€çŠ¶æ€ä¸ºå¼€æˆ–å…³ã€æ€è€ƒå°±ä¼šè½»æ¾å¾ˆå¤šï¼Œä»¤ <span class=\"math inline\">\\(f_{x,0/1/2,0/1}\\)</span> è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(0/1/2\\)</span> ä¸ªç«¯ç‚¹å†å­æ ‘å¤–éƒ¨ï¼Œä¸”å­æ ‘å†…æ“ä½œå®Œå <span class=\"math inline\">\\(x\\)</span> ä¸ºå…³ / å¼€çš„æœ€å°‘æ­¥æ•°ã€‚ç„¶ååˆ†ç±»è®¨è®ºè½¬ç§»æ–¹å¼å³å¯ã€‚</p>\n<p>ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„è®¨è®ºæ–¹å¼æ˜¯ï¼Œå…ˆç¡®å®šæŸç§æƒ…å†µä¸‹ï¼Œè®¿é—® <span class=\"math inline\">\\(u\\)</span> ä¸ <span class=\"math inline\">\\(v\\)</span> çš„æ¬¡æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°å®ƒä»¬åŸæœ¬çš„çŠ¶æ€ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, rt = -1;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        a[i] = t - &#39;0&#39;;\n        if (!a[i])\n            rt = i;\n    &#125;\n    if (rt == -1) &#123;\n        std::cout &lt;&lt; 0 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; tag(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        tag[x] = a[x];\n        for (auto i : g[x])\n            if (i != fa)\n                DFS(i, x), tag[x] &amp;= tag[i];\n        return;\n    &#125;;\n    DFS(rt, -1);\n    std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(n + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (3, std::vector&lt;int&gt; (2, 0x3f3f3f3f)));\n    DFS = [&amp;](int x, int fa) &#123;\n        f[x][0][a[x]] = 0;\n        for (auto i : g[x])\n            if (i != fa &amp;&amp; !tag[i]) &#123;\n                DFS(i, x);\n                auto g = f[x];\n                f[x][0][0] = std::min(g[0][0] + f[i][0][1] + 4, g[0][1] + f[i][0][0] + 2);\n                f[x][0][1] = std::min(g[0][1] + f[i][0][1] + 4, g[0][0] + f[i][0][0] + 2);\n                f[x][1][0] = std::min(&#123; g[1][0] + f[i][0][1] + 4, g[1][1] + f[i][0][0] + 2, g[0][0] + f[i][1][0] + 3, g[0][1] + f[i][1][1] + 1 &#125;);\n                f[x][1][1] = std::min(&#123; g[1][1] + f[i][0][1] + 4, g[1][0] + f[i][0][0] + 2, g[0][1] + f[i][1][0] + 3, g[0][0] + f[i][1][1] + 1 &#125;);\n                f[x][2][0] = std::min(&#123; g[2][0] + f[i][0][1] + 4, g[2][1] + f[i][0][0] + 2, g[1][0] + f[i][1][1], g[1][1] + f[i][1][0] + 2, g[0][0] + f[i][2][1] + 4, g[0][1] + f[i][2][0] + 2 &#125;);\n                f[x][2][1] = std::min(&#123; g[2][1] + f[i][0][1] + 4, g[2][0] + f[i][0][0] + 2, g[1][1] + f[i][1][1], g[1][0] + f[i][1][0] + 2, g[0][1] + f[i][2][1] + 4, g[0][0] + f[i][2][0] + 2 &#125;);\n            &#125;\n        f[x][1][0] = std::min(f[x][1][0], f[x][0][1] + 1);\n        f[x][1][1] = std::min(f[x][1][1], f[x][0][0] + 1);\n        f[x][2][0] = std::min(f[x][2][0], f[x][1][0]);\n        f[x][2][1] = std::min(f[x][2][1], f[x][1][1]);\n        // for (int i = 0; i &lt; 3; ++i)\n        //     for (int j = 0; j &lt; 2; ++j)\n        //         printf(&quot;f[%d][%d][%d] = %d\\n&quot;, x, i, j, f[x][i][j]);\n        return;\n    &#125;;\n    DFS(rt, -1);\n    std::cout &lt;&lt; f[rt][2][1] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---one-to-one\">B - One to One</h2>\n<p><a href=\"https://atcoder.jp/contests/arc140/tasks/arc140_d\" class=\"uri\">https://atcoder.jp/contests/arc140/tasks/arc140_d</a></p>\n<p>è§‚å¯ŸåŸå›¾ä¸Šè¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯æ²¡æœ‰æœªç¡®å®šè¾¹çš„åŸºç¯æ ‘ï¼Œè¦ä¹ˆæ˜¯æœ‰æ°å¥½ä¸€æ¡æœªç¡®å®šè¾¹çš„æ ‘ã€‚ç¼©ç‚¹ï¼Œä»»æ„ä¸ºæœªç¡®å®šè¾¹èµ‹å€¼ï¼Œè€ƒå¯Ÿæœ€åå¾—åˆ°çš„è¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯ä»¥ã€åŸºç¯æ ‘ç‚¹ã€ä¸ºæ ¹çš„æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸åŒ…å«ã€åŸºç¯æ ‘ç‚¹ã€çš„ï¼ˆå†…å‘ï¼‰åŸºç¯æ ‘ã€‚</p>\n<p>è¿™é‡Œè¦ç”¨åˆ°è´¡çŒ®çš„æ€æƒ³ã€‚è€ƒè™‘å°†å…¨å±€åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œä¿è¯æ¯éƒ¨åˆ†çš„å•æ­¥ä»·å€¼æ˜¯å¯ç¡®å®šçš„ã€‚å°†ç¬¬ä¸€æ­¥ï¼Œå³å¯¹æ ‘å’ŒåŸºç¯æ ‘çš„è®¨è®ºæ‹†å¼€ï¼Œå¯¹äºæ ‘ï¼Œå…¶æ•°é‡ç¡®å®šï¼›å¯¹äºåŸºç¯æ ‘ï¼Œå‘ç°ç¯çš„æ•°é‡å³ä¸ºåŸºç¯æ ‘çš„æ•°é‡ï¼Œè¿›ä¸€æ­¥å°†æ‰€æœ‰æ­¥ä¸­çš„ã€ç¯ã€è¿™ä¸€ç±»åˆ†å¼€ï¼Œç»Ÿè®¡æˆç¯çš„æ–¹æ¡ˆæ•°å°±å¯ä»¥å¾—åˆ°åŸºç¯æ ‘çš„è´¡çŒ®ã€‚å…·ä½“åœ°ï¼Œä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> ä¸ºåœ¨å‰ <span class=\"math inline\">\\(i\\)</span> ä¸ªç‚¹ä¸­é€‰æ‹© <span class=\"math inline\">\\(j\\)</span> ä¸ªæˆä¸€ä¸ªç¯çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{i,j}=f_{i-1,j}+f_{i-1,j-1}\\times siz_i\n\\]</span></p>\n<p>æœ€åè®¡ç®—æ¯ä¸ªç¯çš„è´¡çŒ®å³å¯ã€‚æ³¨æ„è¿˜è¦ç®—ä¸Šç¯å†…éƒ¨çš„æ’åˆ—ï¼ˆæ³¨æ„å¾ªç¯ä½ç§»ï¼‰ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), tag(n + 1), s(n + 1, 1), fa(n + 1), siz(n + 1);\n    std::iota(fa.begin() + 1, fa.end(), 1);\n    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;\n        return x == fa[x] ? x : fa[x] = find(fa[x]);\n    &#125;;\n    auto merge = [&amp;](int x, int y) &#123;\n        x = find(x), y = find(y);\n        if (x != y) &#123;\n            tag[y] += tag[x];\n            s[y] += s[x];\n            fa[x] = y;\n        &#125;\n        return;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)  &#123;\n        std::cin &gt;&gt; a[i], fa[i] = i;\n        if (a[i] == -1)\n            tag[i] = 1;\n        else\n            merge(i, a[i]);\n    &#125;\n    int cnt1 = 0, cnt2 = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        cnt1 += (fa[i] == i &amp;&amp; !tag[i]);\n        if (fa[i] == i &amp;&amp; tag[i])\n            siz[++cnt2] = s[i];\n    &#125;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    auto res(cnt1 * qkp(n, cnt2) % mod);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(cnt2 + 1, std::vector&lt;long long&gt; (cnt2 + 1));\n    f[0][0] = 1ll;\n    for (int i = 1; i &lt;= cnt2; ++i) &#123;\n        // printf(&quot;i = %d, siz = %d: \\n&quot;, i, siz[i]);\n        for (int j = 0; j &lt;= i; ++j) &#123;\n            f[i][j] = f[i - 1][j];\n            if (j != 0)\n                (f[i][j] += f[i - 1][j - 1] * siz[i]) %= mod;\n            // printf(&quot;  f[%d][%d] = %lld\\n&quot;, i, j, f[i][j]);\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= cnt2; ++i) &#123;\n        static auto fac(1ll);\n        (res += f[cnt2][i] * fac % mod * qkp(n, cnt2 - i) % mod) %= mod;\n        (fac *= i) %= mod;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---diameter-cuts\">C - Diameter Cuts</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1499/F\" class=\"uri\">https://codeforces.com/problemset/problem/1499/F</a></p>\n<p>ä»¤ <span class=\"math inline\">\\(f_{x,i}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(x\\)</span> ä¸Šçš„æœ€é•¿é“¾é•¿ä¸º <span class=\"math inline\">\\(i\\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªç±»ä¼¼èƒŒåŒ…çš„è¿‡ç¨‹æ±‚ç­”æ¡ˆäº†ã€‚å‘ç°è¿™ä¸ªèƒŒåŒ…æ»¡è¶³å¯ä»¥è¢«ä¼˜åŒ–çš„å½¢å¼ï¼Œæ•…èƒ½åœ¨ <span class=\"math inline\">\\(O(nk)\\)</span> å†…è§£å†³é—®é¢˜ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, k;\n    std::cin &gt;&gt; n &gt;&gt; k, ++k;\n    if (k == 0) &#123;\n        std::cout &lt;&lt; 1 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; h(n + 1);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (k + 1));\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        f[x][1] = 1ll, h[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                std::vector&lt;long long&gt; g(k + 1);\n                g.swap(f[x]);\n                for (int j = std::min(h[x], k); j; --j)\n                    for (int l = std::min(h[i], k - j); ~l; --l)\n                        (f[x][std::max(j, l + 1)] += g[j] * f[i][l] % mod) %= mod;\n                h[x] = std::max(h[x], h[i] + 1);\n            &#125;\n        for (int i = 1; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)\n            (f[x][0] += f[x][i]) %= mod;\n        // for (int i = 0; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)\n        //     printf(&quot;f[%d][%d] = %lld\\n&quot;, x, i, f[x][i]);\n        return;\n    &#125;;\n    DFS(1, -1);\n    auto res(0ll);\n    for (int i = 1; i &lt;= k; ++i)\n        (res += f[1][i]) %= mod;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---leaf-partition\">D - Leaf Partition</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1146/F\" class=\"uri\">https://codeforces.com/problemset/problem/1146/F</a></p>\n<p>å‡è®¾å·²ç»å®Œæˆåˆ†ç»„ï¼Œæ¬²åˆ¤å®šè¿™ç§æ–¹å¼æ˜¯å¦åˆæ³•ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ¯ä¸€ç»„å¶å­å»ºç«‹è™šæ ‘ï¼Œåˆ™è¯¥åˆ†ç»„æ–¹å¼åˆæ³•ï¼Œå½“ä¸”ä»…å½“æ²¡æœ‰ä¸€ä¸ªç‚¹è¢«å¤šä¸ªè™šæ ‘å ç”¨ã€‚ä¹Ÿå³ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ€»çš„è™šæ ‘ä¸Šé€‰å‡ºä¸€äº›ç‚¹ï¼Œè®©å®ƒä»¬å¯ä»¥è¦†ç›–æ‰€æœ‰å¶å­ã€‚</p>\n<p>è™šæ ‘ä¸Š DPï¼Œå®¹æ˜“å‘ç°å½“ä¸”ä»…å½“å­˜åœ¨ <span class=\"math inline\">\\(\\ge 2\\)</span> ä¸ªå„¿å­æƒ³è¦åˆ†è¿›åŒä¸€ä¸ªè™šæ ‘æ—¶ï¼Œ<span class=\"math inline\">\\(i\\)</span> ä¼šè¢«é€‰åˆ°ã€‚æ•…ä»¤ <span class=\"math inline\">\\(f_{i, 0/1/2}\\)</span> è¡¨ç¤ºå½“å‰æœ‰ <span class=\"math inline\">\\(0/1/\\ge 2\\)</span> ä¸ªå„¿å­æƒ³è¦é€‰æ‹© <span class=\"math inline\">\\(i\\)</span> æ—¶çš„æ–¹æ¡ˆæ•°ï¼ŒDP å³å¯ã€‚</p>\n<p>åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç°æ ¹æœ¬ä¸éœ€è¦æ±‚è™šæ ‘ï¼ŒåŸæ ‘ä¸Š DP å°±å¯ä»¥äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; fa(n + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 2; i &lt;= n; ++i)\n        std::cin &gt;&gt; fa[i], g[fa[i]].push_back(i);\n    std::vector&lt;std::array&lt;long long, 3&gt; &gt; f(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        if (g[x].empty())\n            f[x][2] = 1ll;\n        else\n            f[x][0] = 1ll;\n        for (auto i : g[x]) &#123;\n            DFS(i);\n            auto F0 = (f[i][0] + f[i][2]) % mod, F1 = (f[i][1] + f[i][2]) % mod;\n            f[x][2] = (f[x][2] * F0 % mod + f[x][2] * F1 % mod + f[x][1] * F1 % mod) % mod;\n            f[x][1] = (f[x][1] * F0 % mod + f[x][0] * F1 % mod) % mod;\n            (f[x][0] *= F0) %= mod;\n        &#125;\n        // printf(&quot;%d: %lld / %lld / %lld\\n&quot;, x, f[x][0], f[x][1], f[x][2]);\n        return;\n    &#125;;\n    DFS(1);\n    std::cout &lt;&lt; (f[1][0] + f[1][2]) % mod &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---uniformly-branched-trees\">E - Uniformly Branched Trees</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/724/F\" class=\"uri\">https://codeforces.com/problemset/problem/724/F</a></p>\n<p>æ„Ÿè§‰æ˜¯å¾ˆå¸¸è§çš„å¥—è·¯ï¼Œä½†æ˜¯æˆ‘ä¸ä¼š ğŸ˜±</p>\n<p>åœ¨æ‰‹ç©æ ·ä¾‹çš„æ—¶å€™å¯ä»¥æ„Ÿæ€§è®¤çŸ¥åˆ°ï¼Œæ¯ä¸ªæ ‘ä¼šè¢«æ¯ç§ç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µç»Ÿè®¡ä¸€æ¬¡ã€‚ä¸”å¦‚æœå›ºå®šä»¥æŸç§ï¼ˆåŒ–å­¦ç¯å¢ƒï¼‰çš„ç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥é€šè¿‡æŒ‰ siz ä»å°åˆ°å¤§æ’åˆ—å”¯ä¸€æ±‚è§£å‡ºè¯¥æ ‘ã€‚</p>\n<p>å‘ç°ä»¥é‡å¿ƒä¸ºæ ¹ï¼ˆå³é’¦å®šæ ¹ä¸ºé‡å¿ƒï¼‰å¯ä»¥å¸¦æ¥å¾ˆå¤šä¼˜ç¾çš„æ€§è´¨ã€‚å› ä¸º siz æ˜¯å¥½ç¡®å®šçš„ï¼Œä¸”æ˜¯å„¿å­çš„æ’åºä¾æ®ï¼Œæ‰€ä»¥é€‰é‡å¿ƒä¾¿äºç»Ÿè®¡ï¼ŒåŒæ—¶æ»¡è¶³æ¯ç§æ ‘æœ€å¤šè¢«ç»Ÿè®¡ä¸¤æ¬¡ï¼ˆå½“ä¸”ä»…å½“æœ‰ä¸¤ä¸ªé‡å¿ƒï¼‰ã€‚</p>\n<p>å‘ç°è¿™å°±å˜æˆäº†å¤šé‡é›†çš„ç»„åˆæ•°ï¼Œè®¾ <span class=\"math inline\">\\(f_{i,j,k}\\)</span> è¡¨ç¤ºå·²ç»èŠ±è´¹ <span class=\"math inline\">\\(i\\)</span> ä¸ªç‚¹ç»„æˆä¸€ä¸ªå­æ ‘ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹å½“å‰å·²ç»ç¡®è®¤äº† <span class=\"math inline\">\\(j\\)</span> ä¸ªå„¿å­ï¼Œæœ€é å³çš„ä¸€ä¸ª siz <span class=\"math inline\">\\(\\le k\\)</span> çš„æ–¹æ¡ˆæ•°ã€‚å¾—åˆ° <span class=\"math inline\">\\(f_{i,j,k}=\\sum_{x=0} f_{i-x\\cdot k,j-x,k-1}\\cdot \\binom{f_{k,d-1,k}+x-1}{x}\\)</span>ï¼ˆç›¸å½“äºå°† <span class=\"math inline\">\\(x\\)</span> ä¸ªæ— æ ‡å·çš„ä½ç½® / çƒåˆ†é…ç»™ <span class=\"math inline\">\\(f_{k,d-1,k}\\)</span> ä¸ªæœ‰æ ‡å·çš„é€‰é¡¹ / ç›’å­ï¼Œæ’æ¿å³å¯ï¼‰ã€‚</p>\n<p>è‹¥ <span class=\"math inline\">\\(n\\)</span> ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ç›´æ¥è¾“å‡º <span class=\"math inline\">\\(f_{n,d,\\lfloor\\frac n2\\rfloor}\\)</span>ï¼›è‹¥ <span class=\"math inline\">\\(n\\)</span> ä¸ºå¶æ•°ï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸¤ä¸ªé‡å¿ƒï¼Œå³éœ€è¦ç»Ÿè®¡æ‹¥æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸”ä»¥ä¸¤ä¸ªé‡å¿ƒåˆ†åˆ«ä¸ºæ ¹æ—¶é•¿ç›¸ä¸åŒçš„æ ‘ç§ç±»ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¾ç„¶å­˜åœ¨ä¸€æ¡è¾¹ï¼Œå·¦å³ä¸¤è¾¹ siz ç›¸åŒä¸”é•¿ç›¸ä¸åŒã€‚æ•…æ•°é‡ä¸º <span class=\"math inline\">\\(\\binom{f_{\\lfloor \\frac n2\\rfloor, d-1,\\lfloor \\frac n2\\rfloor}}{2}\\)</span>ï¼Œå®¹æ–¥æ‰å³å¯ã€‚</p>\n<p>éœ€è¦ç‰¹åˆ¤ <span class=\"math inline\">\\(n\\le2\\)</span> çš„æƒ…å†µã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, d, mod;\n    std::cin &gt;&gt; n &gt;&gt; d &gt;&gt; mod;\n    if (n &lt;= 2) &#123;\n        std::cout &lt;&lt; 1 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    using arr = std::vector&lt;long long&gt;;\n    using brr = std::vector&lt;arr&gt;;\n    using crr = std::vector&lt;brr&gt;;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    arr inv(d + 1);\n    inv[0] = inv[1] = 1ll;\n    auto fac = 1ll;\n    for (int i = 2; i &lt;= d; ++i) &#123;\n        (fac *= i) %= mod;\n        inv[i] = qkp(fac, mod - 2);\n    &#125;\n    auto C = [&amp;](long long n, int m) &#123;\n        if (m == 0)\n            return 1ll;\n        if (m &gt; n)\n            return 0ll;\n        auto res(1ll);\n        for (auto i = 0; i &lt; m; ++i)\n            (res *= n - i) %= mod;\n        return res * inv[m] % mod;\n    &#125;;\n    crr f(n + 1, brr(d + 1, arr(n / 2 + 1)));\n    f[1][0][0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        for (int j = 0; j &lt;= d &amp;&amp; 1 + j &lt;= i; ++j) &#123;\n            for (int x = 0; x &lt;= j &amp;&amp; x &lt;= i; ++x)\n                f[i][j][1] += f[i - x][j - x][0];\n            f[i][j][1] %= mod;\n            for (int k = 2; k &lt;= n / 2; ++k) &#123;\n                // bool flag = (i == 10 &amp;&amp; j == 3 &amp;&amp; k == 3);\n                for (int x = 0; x &lt;= j &amp;&amp; x * k &lt;= i; ++x) &#123;\n                    f[i][j][k] += f[i - x * k][j - x][k - 1] * C(f[k][d - 1][k - 1] + x - 1, x);\n                    // if (flag)\n                    //     printf(&quot;x = %d, f[%d][%d][%d](%lld) * C(%lld, %d)(%lld)\\n&quot;, x, i - x * k, j - x, k - 1, f[i - x * k][j - x][k - 1], f[k][d - 1][k - 1] + x - 1, x, C(f[k][d - 1][k - 1] + x - 1, x));\n                &#125;\n                f[i][j][k] %= mod;\n            &#125;\n        &#125;\n    // for (int i = 1; i &lt;= n; ++i)\n    //     for (int j = 0; j &lt;= d &amp;&amp; j &lt;= i - 1; ++j, puts(&quot;&quot;))\n    //         for (int k = 0; k &lt;= n / 2; ++k) &#123;\n    //             printf(&quot;f[%d][%d][%d] = %lld\\n&quot;, i, j, k, f[i][j][k]);\n    //         &#125;\n    if (n &amp; 1)\n        std::cout &lt;&lt; f[n][d][n / 2] &lt;&lt; &#39;\\n&#39;;\n    else &#123;\n        auto res(f[n][d][n / 2]);\n        res = (res + mod - C(f[n / 2][d - 1][n / 2 - 1], 2)) % mod;\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a---dominant-indices\">A - Dominant Indices</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1009/F\" class=\"uri\">https://codeforces.com/problemset/problem/1009/F</a></p>\n<p>é•¿å‰–æ¿å­ï¼›éš¾ç‚¹åœ¨äºå¯èƒ½è¦å¤ä¹ ä¸€ä¸‹é•¿å‰–æ€ä¹ˆå†™ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; h(n + 1), son(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        h[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                h[x] = std::max(h[x], h[i] + 1);\n                if (h[i] &gt; h[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::vector&lt;int&gt; _f(2 * n + 1), res(n + 1);\n    auto pos(_f.begin());\n    std::vector&lt;decltype(pos)&gt; f(n + 1);\n    DFS = [&amp;](int x, int fa) &#123;\n        ++f[x][0];\n        if (!son[x]) &#123;\n            res[x] = 0;\n            return;\n        &#125;\n        f[son[x]] = std::next(f[x]);\n        DFS(son[x], x);\n        int mx = -std::max(std::make_pair(f[x][res[son[x]] + 1], -(res[son[x]] + 1)), std::make_pair(1, 0)).second;\n        for (auto i : g[x])\n            if (i != fa &amp;&amp; i != son[x]) &#123;\n                f[i] = pos, pos = std::next(pos, h[i] + 1);\n                DFS(i, x);\n                for (int j = 0; j &lt;= h[i]; ++j) &#123;\n                    f[x][j + 1] += f[i][j];\n                    if (j + 1 != mx &amp;&amp; std::make_pair(f[x][j + 1], -(j + 1)) &gt; std::make_pair(f[x][mx], -mx))\n                        mx = j + 1;\n                &#125;\n            &#125;\n        // printf(&quot;%d: &quot;, x);\n        // for (int i = 0; i &lt;= h[x]; ++i)\n        //     printf(&quot;%d &quot;, f[x][i]);\n        // puts(&quot;&quot;);\n        res[x] = mx;\n        return;\n    &#125;;\n    f[1] = pos, pos = std::next(pos, h[1]);\n    DFS(1, -1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---æ ‘ä¸Šå¼‚æˆ–\">B - æ ‘ä¸Šå¼‚æˆ–</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P9745\" class=\"uri\">https://www.luogu.com.cn/problem/P9745</a></p>\n<p>å’Œ <a href=\"#a---svjetlo\">Svjetlo</a> å¾ˆåƒï¼ŒæŠŠè¿é€šå—çš„å¼‚æˆ–å’Œæ”¾åˆ°çŠ¶æ€é‡Œï¼Œæ‹†ä½åä»¤ <span class=\"math inline\">\\(f_{i,j,0/1}\\)</span> è¡¨ç¤ºç‚¹ <span class=\"math inline\">\\(i\\)</span> æ‰€åœ¨çš„è¿é€šå—åœ¨ç¬¬ <span class=\"math inline\">\\(j\\)</span> ä½å¼‚æˆ–å’Œä¸º <span class=\"math inline\">\\(0/1\\)</span> çš„æƒå€¼ï¼ˆ<strong>ä¸è®¡ <span class=\"math inline\">\\(i\\)</span> æ‰€åœ¨è¿é€šå—</strong>ï¼‰ï¼Œè½¬ç§»å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;long long&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 2, x; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; x;\n        g[x].push_back(i), g[i].push_back(x);\n    &#125;\n    std::vector&lt;long long&gt; dp(n + 1);\n    std::vector&lt;std::array&lt;std::array&lt;long long, 2&gt;, 60&gt; &gt; f(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        for (int i = 0; i &lt; 60; ++i)\n            f[x][i][(a[x] &gt;&gt; i) &amp; 1] = 1ll;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                for (int j = 0; j &lt; 60; ++j) &#123;\n                    auto f1 = f[x][j];\n                    f[x][j][0] = (f1[0] * dp[i] % mod + f1[0] * f[i][j][0] % mod + f1[1] * f[i][j][1] % mod) % mod;\n                    f[x][j][1] = (f1[1] * dp[i] % mod + f1[0] * f[i][j][1] % mod + f1[1] * f[i][j][0] % mod) % mod;\n                &#125;\n            &#125;\n        for (int i = 0; i &lt; 60; ++i)\n            dp[x] += (1ll &lt;&lt; i) % mod * f[x][i][1] % mod;\n        dp[x] %= mod;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::cout &lt;&lt; dp[1] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---ä¸€ä¸ªç½‘çš„è·¯\">C - ä¸€ä¸ªç½‘çš„è·¯</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P8595\" class=\"uri\">https://www.luogu.com.cn/problem/P8595</a></p>\n<p>é¦–å…ˆéœ€è¦æ„è¯†åˆ°ï¼Œæ ‘å’Œé“¾çš„è¾¹æ•°æ˜¯ä¸€æ ·çš„ï¼Œç‚¸æ‰äº†å¤šå°‘æ¡è¾¹ï¼Œåœ¨ä¹‹åå°±ä¼šèŠ±å¤šå°‘ä»£ä»·è¡¥å›æ¥ã€‚æ•…ç‚¸ä¸€ä¸ªç‚¹çš„ä»£ä»·ä¸ºåº¦æ•° +1ã€‚å¯¹äºä¸€ä¸ªç‚¹ <span class=\"math inline\">\\(u\\)</span>ï¼Œåˆ†ä¸ºå››ç§å¯èƒ½æ€§ï¼š</p>\n<ul>\n<li>è¢«ç‚¸äº†ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿é€šå—ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œå„¿å­å…¨éƒ¨è¢«ç‚¸äº†ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 1 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 2 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li>\n</ul>\n<p>åˆ†åˆ«ç”¨ <span class=\"math inline\">\\(f_{u,0/1/2/3}\\)</span> ä»£è¡¨ä¸Šé¢å››ç§å¯èƒ½æ€§ï¼Œè½¬ç§»å³å¯ã€‚</p>\n<p>è´ºäº†ä¸ª freadï¼Œæ“¦è¾¹è·‘è¿‡äº†ã€‚è¿™ä¸ªä¸æ˜¯ <span class=\"math inline\">\\(O(n)\\)</span> çš„å—ï¼Ÿ</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int LEN = (1 &lt;&lt; 20);\n#ifdef ONLINE_JUDGE\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n\n#endif\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nint main() &#123;\n    int n, m;\n    read(n), read(m);\n    int res = (n - 1) - m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int x, y; m--; ) &#123;\n        read(x), read(y);\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; tag(n + 1);\n    std::vector&lt;std::array&lt;int, 4&gt; &gt; f(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        tag[x] = 1;\n        f[x][0] = (fa != -1) + 1;\n        f[x][2] = f[x][3] = 0x3f3f3f3f;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                f[x][3] = std::min(f[x][3] + f[i][0], f[x][2] + std::min(f[i][1], f[i][2]));\n                f[x][2] = std::min(f[x][2] + f[i][0], f[x][1] + std::min(f[i][1], f[i][2]));\n                f[x][1] += f[i][0];\n                f[x][0] += std::min(&#123; f[i][0] - 1, f[i][1], f[i][2], f[i][3] &#125;) + 1;\n            &#125;\n        return;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)\n        if (!tag[i]) &#123;\n            DFS(i, -1);\n            res += *std::min_element(f[i].begin(), f[i].end());\n        &#125;\n    print(res, &#39;\\n&#39;);\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---éšæœºæ ‘\">D - éšæœºæ ‘</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P3830\" class=\"uri\">https://www.luogu.com.cn/problem/P3830</a></p>\n<p>å¯¹äºç¬¬ä¸€é—®ï¼Œä»¤ <span class=\"math inline\">\\(f_x\\)</span> è¡¨ç¤ºå…±æœ‰ <span class=\"math inline\">\\(x\\)</span> ä¸ªå¶å­æ—¶çš„æœŸæœ›æ·±åº¦ï¼Œä¸¤ä¸ªæ–°å¶å­çš„æœŸæœ›æ·±åº¦ä¸º <span class=\"math inline\">\\(f_{x-1}+1\\)</span>ï¼Œdelta ä¸º <span class=\"math inline\">\\(f_{x-1}+2\\)</span>ï¼Œæ•…æœ‰ <span class=\"math inline\">\\(f_x=\\dfrac {(x-1)f_{x-1}+f_{x-1}+2}x\\)</span>ï¼Œé€’æ¨å³å¯ã€‚</p>\n<p>å¯¹äºç¬¬äºŒé—®ï¼Œä»¤ <span class=\"math inline\">\\(f_{x,k}\\)</span> è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(x\\)</span> ä¸ªå¶å­ï¼Œæ·±åº¦ <span class=\"math inline\">\\(\\ge k\\)</span> çš„æ¦‚ç‡ï¼ˆä¸€ç§ç†è§£æ˜¯ä»æ•´æ•°æ¦‚ç‡å…¬å¼çš„è§’åº¦å‡ºå‘ï¼‰ã€‚åˆ™è€ƒè™‘æšä¸¾å·¦ã€å³å¶å­æ•°ï¼Œå¯¹äºå·¦ä¾§å¶å­æ•°ä¸º <span class=\"math inline\">\\(i\\)</span> çš„æƒ…å†µï¼Œ<strong>ä¸ºäº†å»é‡ï¼Œåªé€‰æ‹©æ·±åº¦ä¸º <span class=\"math inline\">\\(k-1\\)</span> çš„å¶å­å±•å¼€</strong>ã€‚åªè€ƒè™‘æŸç§ç»„åˆçš„å‡ºç°æ¦‚ç‡ï¼Œä¸º <span class=\"math inline\">\\(f_{i,k-1}+f_{x-i,k-1}-f_{i,k-1}\\cdot f_{x-i,k-1}\\)</span>ã€‚æ•°å½’å¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»æ„ <span class=\"math inline\">\\(i\\)</span>ï¼Œæ·±åº¦ä¸º <span class=\"math inline\">\\(k-1\\)</span> çš„å¶å­è¢«é€‰ä¸­çš„æ¦‚ç‡å‡ä¸º <span class=\"math inline\">\\(\\dfrac 1{x-1}\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int q, n;\n    std::cin &gt;&gt; q &gt;&gt; n;\n    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(6);\n    if (q == 1) &#123;\n        std::vector&lt;double&gt; f(n + 1);\n        for (int i = 2; i &lt;= n; ++i)\n            f[i] = (f[i - 1] * (i - 1) + f[i - 1] + 2.) / i;\n        std::cout &lt;&lt; f[n] &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    else &#123;\n        std::vector&lt;std::vector&lt;double&gt; &gt; f(n + 1, std::vector&lt;double&gt; (n + 1));\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            f[i][0] = 1.;\n            for (int j = 1; j &lt; i; ++j) &#123;\n                auto s(0.);\n                for (int k = 1; k &lt; i; ++k)\n                    s += f[k][j - 1] + f[i - k][j - 1] - f[k][j - 1] * f[i - k][j - 1];\n                f[i][j] = s / (i - 1);\n            &#125;\n        &#125;\n        auto res(0.);\n        for (int i = 1; i &lt; n; ++i)\n            res += f[n][i];\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---complete-compress\">E - Complete Compress</h2>\n<p><a href=\"https://atcoder.jp/contests/agc034/tasks/agc034_e\" class=\"uri\">https://atcoder.jp/contests/agc034/tasks/agc034_e</a></p>\n<p>å¯¹äºé“¾ï¼Œå‘ç°å¯ä»¥æšä¸¾æœ€åèšé›†çš„ç‚¹ï¼Œç­”æ¡ˆä¸é…å¯¹æ–¹å¼æ— å…³ï¼Œcheck æ˜¯å¦èƒ½é…å¯¹å³å¯ã€‚</p>\n<p>å¦‚æœä¸æ˜¯é“¾ï¼Œåˆ™ç›¸æ¯”é“¾ï¼Œè¿˜å¯ä»¥é€‰æ‹©åŒä¸€å­æ ‘ä¸­ä¸å­˜åœ¨ç¥–å­™å…³ç³»çš„ä¸¤ä¸ªç‚¹ï¼Œå°†å®ƒä»¬éƒ½å‘ LCA ç§»ä¸€æ­¥ã€‚</p>\n<p>æ•…è€Œï¼Œå¯ä»¥åœ¨é“¾çš„åšæ³•ä¸Šæ‰“ä¸€ä¸ªè¡¥ä¸ï¼Œè§‚å¯Ÿåˆ°å…ˆã€å†…éƒ¨æ¶ˆåŒ–ã€ï¼Œå†åœ¨å­æ ‘é—´é…å¯¹ä¸€å®šä¸åŠ£ï¼Œä¸”ç­”æ¡ˆä»ç„¶å’Œé…å¯¹æ–¹å¼æ— å…³ã€‚æ•…ä»¤ <span class=\"math inline\">\\(f_x\\)</span> è¡¨ç¤ºç‚¹ <span class=\"math inline\">\\(x\\)</span> å†…æœ€å¤šæ¶ˆæ‰å¤šå°‘å¯¹ï¼Œå°±å¯ä»¥ check äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;line_02.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        a[i] = t - &#39;0&#39;;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    auto res(inf);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::vector&lt;int&gt; s(n + 1);\n        std::vector&lt;long long&gt; f(n + 1), cnt(n + 1);\n        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n            s[x] = a[x];\n            int son = 0;\n            auto sum(0ll);\n            for (auto i : g[x])\n                if (i != fa) &#123;\n                    DFS(i, x), s[x] += s[i];\n                    sum += cnt[i];\n                    if (cnt[i] &gt; cnt[son])\n                        son = i;\n                &#125;\n            if (son) &#123;\n                if (cnt[son] * 2 &lt;= sum)\n                    f[x] = sum / 2;\n                else\n                    f[x] = sum - cnt[son] + std::min(f[son], (cnt[son] - (sum - cnt[son])) / 2);\n            &#125;\n            cnt[x] = sum;\n            if (x != i)\n                cnt[x] += s[x];\n            return;\n        &#125;;\n        DFS(i, -1);\n        if (cnt[i] % 2 == 0 &amp;&amp; f[i] == cnt[i] / 2)\n            res = std::min(res, cnt[i] / 2);\n    &#125;\n    if (res == inf)\n        std::cout &lt;&lt; -1 &lt;&lt; &#39;\\n&#39;;\n    else\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "DP",
                "æ ‘å½¢ DP",
                "é•¿é“¾å‰–åˆ†"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20240131/",
            "url": "https://xsc062.netlify.app/20240131/",
            "title": "USACO2024JAN ä¸‰ç»„è¿æ‰“",
            "date_published": "2024-01-31T02:30:29.000Z",
            "content_html": "<p>å‡çš„ï¼Œåªè¿æ‰“äº†ä¸¤ç»„ã€‚Ag æ²¡æ—¶é—´äº†ã€‚æ—¥åå†è¡¥å§ã€‚</p>\n<span id=\"more\"></span>\n<p><img src=\"https://pic.imgdb.cn/item/65b7b152871b83018ac5e7b7.gif\" /></p>\n<p>æ— æ„ä¸­å­˜äº†é¢˜é¢ï¼Œä½†ä»£ç å¤§éƒ¨åˆ†å› ä¸ºç³»ç»Ÿè¿˜åŸæ¶ˆå¤±äº†ï¼Œåªæœ‰æ–‡å­—é¢˜è§£ï¼Œå°†å°±ç€çœ‹å§ã€‚</p>\n<hr />\n<h3 id=\"cu-a.-majority-opinion\">Cu A. Majority Opinion</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P10131\" class=\"uri\">https://www.luogu.com.cn/problem/P10131</a></p>\n<p><em>çœæµï¼šä»»æ„åŒºé—´å†…ï¼Œè‹¥æŸå…ƒç´ å‡ºç°ä¸ªæ•°ä¸¥æ ¼å¤§äºåŒºé—´é•¿åº¦ä¸€åŠï¼Œåˆ™å¯å°†æ•´ä¸ªåŒºé—´æ¨å¹³ä¸ºè¯¥å€¼ã€‚é—®æœ€ç»ˆå¯ä»¥ä½¿æ•´ä¸ªåºåˆ—è¢«æ¨å¹³ä¸ºå“ªäº›å€¼ã€‚</em></p>\n<p>æ³¨æ„åˆ°å½“ä»»æ„é•¿åº¦ <span class=\"math inline\">\\(\\ge 2\\)</span> çš„åŒºé—´å¯ä»¥è¢«æ¨å¹³ä¸ºæŸç§å…ƒç´ æ—¶ï¼Œæ•´ä¸ªæ•°åˆ—éƒ½å¯ä»¥è¢«æ¨å¹³ä¸ºè¯¥å…ƒç´ ã€‚æ•…ç›®æ ‡è½¬åŒ–ä¸ºå¯¹äºæŸç§å…ƒç´ åˆ¤å®šæ˜¯å¦å­˜åœ¨ä¸€ä¸ªå¯è¢«å…¶æ¨å¹³çš„åŒºé—´ã€‚</p>\n<p>ç»Ÿè®¡å…ƒç´ ä¸ªæ•°é‡‡ç”¨å‰ç¼€å’Œã€‚ä»¤ <span class=\"math inline\">\\(s_i\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(h_i\\)</span> åœ¨å‰ <span class=\"math inline\">\\(i\\)</span> é¡¹ä¸­å‡ºç°çš„æ¬¡æ•°ï¼Œå‡è®¾æœ‰ <span class=\"math inline\">\\([j,i]\\)</span> æ»¡è¶³æ¡ä»¶ï¼Œè´ªå¿ƒå¯çŸ¥ <span class=\"math inline\">\\(h_i=h_j\\)</span>ã€‚</p>\n<p>é‚£ä¹ˆç”±å®šä¹‰æœ‰ <span class=\"math inline\">\\(i-j+1&lt;2\\times (s_i-s_j+1)\\)</span>ã€‚å…¸ä¸­å…¸ï¼Œç›´æ¥ç§»é¡¹åˆ†ç¦»å˜é‡ã€‚åˆ™æœ‰ <span class=\"math inline\">\\(i-2\\times s_i-1&lt;j-2\\times s_j\\)</span>ã€‚ä»¤ <span class=\"math inline\">\\(t_p\\gets p-2\\times s_p\\)</span>ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(h\\)</span> è®°å½• <span class=\"math inline\">\\(t_j\\)</span> æœ€å¤§å€¼æŸ¥çœ‹æ˜¯å¦æœ‰ <span class=\"math inline\">\\(i,j\\)</span> æ»¡è¶³æ¡ä»¶å³å¯ã€‚</p>\n<h3 id=\"cu-b.-cannonball\">Cu B. Cannonball</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P10132\" class=\"uri\">https://www.luogu.com.cn/problem/P10132</a></p>\n<p><em>çœæµï¼šæœ‰ <span class=\"math inline\">\\(N\\)</span> ä¸ªæ ¼å­ï¼Œä» <span class=\"math inline\">\\(s\\)</span> æ ¼å­å¼€å§‹ä»¥ <span class=\"math inline\">\\(1\\)</span> ä¸ºåˆå§‹èƒ½é‡å‘å³è·³ï¼Œè·³ä¸€æ­¥çš„è·ç¦»ä¸ºèƒ½é‡å¤§å°ã€‚æ ¼å­åˆ†ä¸¤ç§ï¼Œä¸€ç§ç»è¿‡åŠ ä¸€å®šèƒ½é‡å¹¶åå‘ï¼Œå¦ä¸€ç§è‹¥å½“å‰èƒ½é‡å¤§äºä¸€å®šå€¼åˆ™å¯æ°¸ä¹…æ‘§æ¯ï¼Œé—®è·³å‡ºèŒƒå›´æˆ–æ— é™é•¿æ—¶é—´åå¯æ‘§æ¯æ ¼å­ä¸ªæ•°ã€‚</em></p>\n<p>ä¸éš¾å‘ç°è‹¥å¿½ç•¥å¢åŠ èƒ½é‡ä¸º <span class=\"math inline\">\\(0\\)</span> çš„è·³æ¿åˆ™æ¯ç»è¿‡ä¸€ä¸ªè·³æ¿å¯è·³è·ç¦»å¢åŠ  <span class=\"math inline\">\\(1\\)</span>ï¼Œæœ€å¤šå¢åŠ åˆ° <span class=\"math inline\">\\(n\\)</span>ï¼Œå¦åˆ™ä¼šè·³å‡ºå»ã€‚</p>\n<p>æ³¨æ„åˆ°è°ƒå’Œçº§æ•°ï¼Œæ•…ç›´æ¥æ¨¡æ‹Ÿè·³çš„è¿‡ç¨‹ã€‚å”¯ä¸€å¯¼è‡´æ—¶é—´æ— é™çš„æƒ…å†µæ˜¯å­˜åœ¨ç›¸é‚»çš„å¢åŠ èƒ½é‡ä¸º <span class=\"math inline\">\\(0\\)</span> çš„è·³æ¿ï¼Œä½†å…¶å®å®ƒå…·ä½“æ˜¯ä»€ä¹ˆå¹¶ä¸é‡è¦ï¼Œåæ­£æˆ‘ä»¬è·³çš„æ¬¡æ•°ä¸¥æ ¼å¤§äºè°ƒå’Œçº§æ•°åå°±å¯ä»¥è®¤ä¸ºè¿›å…¥æ­»å¾ªç¯ï¼Œç›´æ¥ç»“æŸæ¨¡æ‹Ÿå³å¯ã€‚æˆ‘è¿™é‡Œå«Œéº»çƒ¦ç›´æ¥æ‹¿äº† <span class=\"math inline\">\\(2\\times 10^8\\)</span> ä½œé˜ˆå€¼ã€‚</p>\n<h3 id=\"cu-c.-balancing-bacteria\">Cu C. Balancing Bacteria</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P10133\" class=\"uri\">https://www.luogu.com.cn/problem/P10133</a></p>\n<p><em>çœæµï¼šå®šä¹‰ä¸€æ¬¡æ“ä½œä¸ºé€‰å–ä¸€ä¸ªæ•´æ•° <span class=\"math inline\">\\(\\Delta\\le N\\)</span>ï¼Œå¹¶ä» <span class=\"math inline\">\\(N\\)</span> åˆ° <span class=\"math inline\">\\(1\\)</span>ï¼Œä»¤ <span class=\"math inline\">\\(a_i\\gets a_i+\\Delta\\)</span> å¹¶ä»¤ <span class=\"math inline\">\\(\\Delta\\)</span> å‘ <span class=\"math inline\">\\(0\\)</span> é è¿‘ <span class=\"math inline\">\\(1\\)</span>ï¼Œ<span class=\"math inline\">\\(\\Delta=0\\)</span> æ—¶åœæ­¢ã€‚é—®ä»¤æ‰€æœ‰ <span class=\"math inline\">\\(a_i=0\\)</span> æ‰€éœ€æœ€å°‘æ“ä½œæ¬¡æ•°ã€‚</em></p>\n<p>æŒºæœ‰æ„æ€çš„æ€ç»´é¢˜ï¼Œé¦–å…ˆéœ€è¦è¿›è¡Œä¸€ä¸ªæ€ç»´è½¬åŒ–ã€‚<span class=\"math inline\">\\(\\Delta\\le N\\)</span> æ˜¯ä¸€ä¸ªåˆ©äºè§£é¢˜çš„é™åˆ¶ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æƒ³è®©ä»»ä½•ä¸€ä¸ª <span class=\"math inline\">\\(a_i\\)</span> æ”¹å˜ <span class=\"math inline\">\\(1\\)</span> è€Œä¸å½±å“åˆ°ä¹‹å‰çš„å€¼ï¼Œä»è®© <span class=\"math inline\">\\(a_1\\gets 0\\)</span> å…¥æ‰‹ï¼Œè¿›è¡Œä¸€æ¬¡æ“ä½œåæ¯ä¸ª <span class=\"math inline\">\\(a_i\\)</span> åˆ†åˆ°çš„ <span class=\"math inline\">\\(\\Delta\\)</span> åº”ä¾æ¬¡åŠ  1 æˆ–ä¾æ¬¡å‡ 1ã€‚åˆ™å·®åˆ†æ•°ç»„ä¸º <span class=\"math inline\">\\(0\\)</span> åè·Ÿç€ä¸€æˆª <span class=\"math inline\">\\(1\\)</span> æ˜¯ç†æƒ³çŠ¶æ€ã€‚ä¸­é—´æ¯æœ‰ä¸€é¡¹ä¸æ»¡è¶³è§„å¾‹éƒ½ä¼šå¸¦æ¥é¢å¤–çš„æ“ä½œæ¬¡æ•°ã€‚</p>\n<p>å½’çº³ä¸ºå·®åˆ†æ•°ç»„çš„å·®åˆ†æ•°ç»„ç»å¯¹å€¼ä¹‹å’Œå³ä¸ºç­”æ¡ˆã€‚</p>\n<hr />\n<h3 id=\"ag-a.-cowmpetency\">Ag A. Cowmpetency</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P10134\" class=\"uri\">https://www.luogu.com.cn/problem/P10134</a></p>\n<p><em>çœæµï¼šæœ‰è‹¥å¹²æ¡é™åˆ¶ï¼Œæ¯æ¡å½¢å¦‚ <span class=\"math inline\">\\(\\max\\limits_{i=1}^{a_h-1}\\{A_i\\}=\\max\\limits_{i=1}^{a_j}\\{A_i\\}\\)</span> ä¸” <span class=\"math inline\">\\(A_{a_h}&gt;\\max\\limits_{i=1}^{a_h-1}\\{A_i\\}\\)</span>ï¼Œéƒ¨åˆ†æ•°å·²çŸ¥ï¼Œæ„é€ å‡ºç¬¦åˆæ¡ä»¶ä¸”å­—å…¸åºæœ€å°çš„åºåˆ—ã€‚</em></p>\n<p>æ˜¯æœ¬åœºæœ€éš¾é¢˜å§ï¼Œä½†ä¹Ÿæ²¡å•¥å¡çš„ã€‚ç”»ä¸ªçº¿æ®µå›¾å®¹æ˜“å‘ç°ï¼Œè‹¥å°† <span class=\"math inline\">\\([a,h)\\)</span> è§†ä½œä¸€æ¡çº¿æ®µï¼Œé‚£ä¹ˆé™¤é <span class=\"math inline\">\\(h\\)</span> ç›¸åŒï¼Œå¦åˆ™ä¸¤æ¡çº¿æ®µä¸èƒ½æœ‰äº¤é›†ã€‚ä¸ç„¶çš„è¯å°±æ— è§£ã€‚ä»¥åŠå¦‚æœå­˜åœ¨ä¸æ»¡è¶³æ¡ä»¶çš„å®šå€¼ä¹Ÿæ˜¾ç„¶æ— è§£ã€‚</p>\n<p>ä»å‰å¾€åçœ‹æ¯ä¸ª <span class=\"math inline\">\\(h\\)</span> å¹¶å°è¯•èµ‹å€¼ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(1\\sim a\\)</span> è®°å½•ä¸€ä¸ªéœ€è¦æ»¡è¶³çš„æœ€å¤§å€¼æ•°å€¼ï¼ŒæŒ‰ç…§æ­¤æ•°å€¼ä»åå¾€å‰å¡«ç©ºæ ¼ã€‚</p>\n<p>å¡«å®Œè¿‡åæ‰«ä¸€éçœ‹çœ‹æ˜¯ä¸æ˜¯å…¨éƒ¨åˆæ³•ï¼Œå¯ä»¥è¯æ˜è‹¥æ­¤æ—¶ä¸åˆæ³•åˆ™æ— è§£ã€‚</p>\n<h3 id=\"ag-b.-potion-farming\">Ag B. Potion Farming</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P10135\" class=\"uri\">https://www.luogu.com.cn/problem/P10135</a></p>\n<p><em>çœæµï¼šä¸€æ£µæ ‘ï¼Œæ¯ä¸ªç‚¹ä¸Šæœ‰è‹¥å¹²ä¸ªç‰©å“ï¼Œå¯¹äºæ¯æ¡ä»æ ¹åˆ°å¶å­çš„ç®€å•è·¯å¾„ï¼Œå¯ä»¥é€‰æ‹©è·¯å¾„ä¸Šçš„ä¸€ä¸ªç‰©å“ï¼Œæ¯ä¸ªç‰©å“åªèƒ½è¢«é€‰ä¸€æ¬¡ï¼Œé—®æœ€å¤šå¯é€‰ç‰©å“æ•°ã€‚</em></p>\n<p>å¦‚æœä¸€ä¸ªç‚¹å¼•å¯¼çš„å­æ ‘ä¸‹æ‰€æœ‰å¶å­æœ‰æ²¡æœ‰åˆ†é…åˆ°çš„ï¼Œå°±å¯ä»¥æŠŠè¿™ä¸ªç‚¹çš„ç‰©å“åˆ†é…ç»™è¯¥å¶å­ã€‚</p>\n<p>è·‘ä¸€ä¸ªæ ‘å½¢ DP å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>namespace XSC062 &#123;\nusing namespace fastIO;\nconst int maxn = 1e5 + 5;\nint n, x, y;\nint cnt[maxn];\nstd::vector&lt;int&gt; g[maxn];\nint a[maxn], f[maxn], p[maxn];\nint min(int x, int y) &#123;\n    return x &lt; y ? x : y;\n&#125;\nvoid DFS(int x, int fa) &#123;\n    if ((int)g[x].size() == 1)\n        cnt[x] = 1;\n    for (auto i : g[x]) &#123;\n        if (i == fa) continue;\n        DFS(i, x);\n        f[x] += f[i];\n        cnt[x] += cnt[i];\n    &#125;\n    if (f[x] &lt; cnt[x])\n        f[x] = min(f[x] + a[x], cnt[x]);\n    return;\n&#125;\nvoid add(int x, int y) &#123;\n    g[x].push_back(y);\n    return;\n&#125;\nint main() &#123;\n    read(n);\n    for (int i = 1; i &lt;= n; ++i) read(p[i]);\n    for (int i = 1; i &lt; n; ++i) &#123;\n        read(x), read(y);\n        add(x, y), add(y, x);\n    &#125;\n    int tot = 0;\n    for (int i = 2; i &lt;= n; ++i)\n        tot += ((int)g[i].size() == 1);\n    for (int i = 1; i &lt;= tot; ++i) ++a[p[i]];\n    DFS(1, -1);\n    print(f[1], &#39;\\n&#39;);\n    return 0;\n&#125;\n&#125; // namespace XSC062</code></pre>\n</details>\n<h3 id=\"ag-c.-cowlendar\">Ag C. Cowlendar</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P10136\" class=\"uri\">https://www.luogu.com.cn/problem/P10136</a></p>\n<p><em>çœæµï¼šå¯¹äºç»™å®šçš„åºåˆ— <span class=\"math inline\">\\(a\\)</span>ï¼Œæ‰¾å‡ºæ‰€æœ‰æ»¡è¶³ <span class=\"math inline\">\\(a_i\\bmod L\\)</span> çš„å€¼çš„ç§ç±»æœ€å¤šä¸º 3 çš„ <span class=\"math inline\">\\(L\\)</span>ã€‚</em></p>\n<p>ä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„æ•°å­¦é¢˜äº†ã€‚è‹¥å°† <span class=\"math inline\">\\(a_i\\)</span> æŒ‰ç…§æ¨¡ <span class=\"math inline\">\\(L\\)</span> çš„æƒ…å†µåˆ†ç»„ï¼Œåˆ™å¯¹äºä»»æ„ä¸€ä¸ª <span class=\"math inline\">\\(a_i\\)</span>ï¼Œåœ¨ <span class=\"math inline\">\\((a_i,a_i+L)\\)</span> ä¸­æœ€å¤šåŒ…å«ä¸¤ä¸ªåˆ†åˆ«æ¥è‡ªå…¶ä½™ä¸¤ç»„çš„æ•°ã€‚</p>\n<p>å¯¹äºå»é‡å <span class=\"math inline\">\\(n&gt;3\\)</span> çš„æƒ…å†µï¼Œç”±é¸½å·¢å¾—å¿…å®šæœ‰ä¸¤ä¸ªæ•°å¯åˆ†ä¸ºä¸€ç»„ã€‚æ•…æˆ‘ä»¬æšä¸¾å¯èƒ½çš„ç»„é—´é—´éš”ï¼Œè€Œå¯èƒ½çš„ <span class=\"math inline\">\\(L\\)</span> å°±æ˜¯è¿™äº›é—´éš”çš„å› æ•°ã€‚</p>\n<p>ç”±ä¸Šé¢æˆ‘ä»¬æ¨å‡ºä¸€ä¸ªåˆæ³•ç»„é—´é—´éš”ä¸­æœ€å¤šé—´éš”ä¸‰ä¸ªæ•°ï¼Œæˆ‘ä»¬å°†æ‰€æœ‰ <span class=\"math inline\">\\(a_{i+3}-a_i\\)</span>ã€<span class=\"math inline\">\\(a_{i+2}-a_i\\)</span> å’Œ <span class=\"math inline\">\\(a_{i+1}-a_i\\)</span> çº³å…¥è€ƒè™‘èŒƒå›´å³å¯ã€‚å¯¹äºæ‰€æœ‰å¯èƒ½çš„ <span class=\"math inline\">\\(L\\)</span>ï¼Œç›´æ¥ <span class=\"math inline\">\\(O(n)\\)</span> è·‘ä¸€ä¸ª <code>check</code> æ£€æŸ¥æ˜¯å¦åˆæ³•ã€‚</p>\n<p>å› å­ä¸ªæ•°ç…§ç†æ¥è¯´æ˜¯ <span class=\"math inline\">\\(\\sqrt{V}\\times n\\)</span> çº§åˆ«çš„ï¼Œä½†æ˜¯å®æµ‹ <span class=\"math inline\">\\(n\\)</span> æœ€å¤šåªæœ‰ä¸€ç™¾å¤šã€‚ä¼°è®¡æ˜¯å› ä¸º <span class=\"math inline\">\\(n\\)</span> å¤ªå¤§å°±å¾ˆéš¾æ„é€ å‡ºæ›´å¤šçš„åˆæ³•è§£å§ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#define int long long\nnamespace XSC062 &#123;\nusing namespace fastIO;\nconst int maxn = 1e4 + 5;\nconst int maxm = 3e4 + 5;\nstd::set&lt;int&gt; u;\nint n, res, mn, tot;\nint a[maxn], b[maxm];\nbool check(int x) &#123;\n    int l1 = 0, l2 = 0, l3 = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (l1 == 0) l1 = a[i];\n        else if (x &amp;&amp; (a[i] - l1) % x == 0) l1 = a[i];\n        else if (l2 == 0) l2 = a[i];\n        else if (x &amp;&amp; (a[i] - l2) % x == 0) l2 = a[i];\n        else if (l3 == 0) l3 = a[i];\n        else if (x &amp;&amp; (a[i] - l3) % x == 0) l3 = a[i];\n        else return 0;\n    &#125;\n    return 1;\n&#125;\nint main() &#123;\n    read(n);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(a[i]);\n        if (!mn || a[i] / 4 &lt; mn) mn = a[i] / 4;\n    &#125;\n    std::sort(a + 1, a + n + 1);\n    n = std::unique(a + 1, a + n + 1) - a - 1;\n    if (check(0)) &#123;\n        print(mn * (mn + 1) / 2, &#39;\\n&#39;);\n        return 0;\n    &#125;\n    for (int i = 2; i &lt;= n; ++i) &#123;\n        b[++tot] = a[i] - a[i - 1];\n        if (i &gt;= 3) b[++tot] = a[i] - a[i - 2];\n        if (i &gt;= 4) b[++tot] = a[i] - a[i - 3];\n    &#125;\n    std::sort(b + 1, b + tot + 1);\n    tot = std::unique(b + 1, b + tot + 1) - b - 1;\n    for (int i = 1; i &lt;= tot; ++i) &#123;\n        if (check(b[i])) &#123;\n            for (int j = 1; j * j &lt;= b[i]; ++j) &#123;\n                if (b[i] % j == 0)\n                    u.insert(j), u.insert(b[i] / j);\n            &#125;\n        &#125;\n    &#125;\n    for (auto i : u) &#123;\n        if (i &gt; mn) break;\n        res += i;\n    &#125;\n    print(res, &#39;\\n&#39;);\n    return 0;\n&#125;\n&#125; // namespace XSC062\n#undef int</code></pre>\n<p></deteails></p>\n",
            "tags": [
                "é¸½å·¢åŸç†",
                "è°ƒå’Œçº§æ•°",
                "å·®åˆ†",
                "æ€ç»´",
                "æ ‘å½¢ DP"
            ]
        }
    ]
}