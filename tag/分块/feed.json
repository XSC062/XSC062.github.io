{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"åˆ†å—\" tag",
    "description": "",
    "home_page_url": "https://xsc062.netlify.app",
    "items": [
        {
            "id": "https://xsc062.netlify.app/20251028/",
            "url": "https://xsc062.netlify.app/20251028/",
            "title": "æ‚é¢˜",
            "date_published": "2025-10-28T09:06:42.000Z",
            "content_html": "<p>æ¨¡æ‹Ÿèµ›çš„å¯†åº¦æ­£åœ¨å¨èƒå…¶ä»–æ–‡ç« çš„ç”Ÿå­˜ç¯å¢ƒã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a.-æ’åº\">A. æ’åº</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P14352\" class=\"uri\">https://www.luogu.com.cn/problem/P14352</a></p>\n<blockquote>\n<p>å¯¹äºä¸€ä¸ªé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„æ’åˆ— <span class=\"math inline\">\\(p\\)</span>ï¼Œå®šä¹‰ä¸€è½®å†’æ³¡ï¼š</p>\n<pre class=\"python\"><code>for i in range(1, n):\n    if p[i] &gt; p[i + 1]:\n        swap(p[i], p[i + 1])</code></pre>\n<p>ç»™å®š <span class=\"math inline\">\\(n,k\\)</span>ï¼Œé—®åœ¨æ‰€æœ‰é•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„æ’åˆ—ä¸­ï¼Œå¯ä»¥åœ¨ <span class=\"math inline\">\\(k\\)</span> è½®å†’æ³¡åå•å¢çš„æ’åˆ—æ•°é‡ã€‚å¯¹ <span class=\"math inline\">\\(998244353\\)</span> å–æ¨¡ã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 10^{18},k\\le 2\\times 10^7\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li><p>ååºè¡¨ã€‚ä»¤ <span class=\"math inline\">\\(a_i\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(i\\)</span> ç»“å°¾çš„é€†åºå¯¹æ•°ï¼Œé‚£ä¹ˆé™åˆ¶ç›¸å½“äºè¯´ <span class=\"math inline\">\\(\\max\\{a\\}\\le k\\)</span>ã€‚</p></li>\n<li><p>ä¹Ÿå³é™åˆ¶ä¸€ä¸ªå…ƒç´ ä¹‹å‰å¤§äºä¹‹çš„å…ƒç´ æ•°ä¸è¶…è¿‡ <span class=\"math inline\">\\(k\\)</span>ï¼Œå¯ä»¥ç›´æ¥è®¡æ•°ã€‚æƒ³è±¡æŠŠ <span class=\"math inline\">\\(1\\sim n\\)</span> ä¾æ¬¡å¡«å…¥æ’åˆ—çš„è¿‡ç¨‹ï¼š</p>\n<ul>\n<li><p>å¯¹äº <span class=\"math inline\">\\(1\\sim n-k\\)</span>ï¼Œåªèƒ½å¡«åœ¨å‰©ä½™ç©ºä½çš„å·¦ <span class=\"math inline\">\\(k+1\\)</span> ä¸ªï¼ˆå› ä¸ºå¡«å®Œå®ƒåï¼Œå‰©ä¸‹çš„ç©ºä½éƒ½æ¯”å®ƒå¤§ï¼‰ï¼›</p></li>\n<li><p>å¯¹äº <span class=\"math inline\">\\(n-k+1\\sim n\\)</span>ï¼Œå¯ä»¥å¡«åœ¨å‰©ä½™ä»»æ„ä¸€ä¸ªç©ºä½ã€‚</p></li>\n</ul>\n<p>æ•…ç­”æ¡ˆä¸º <span class=\"math inline\">\\((k+1)^{n-k}\\cdot k!\\)</span>ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;sorting.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;sorting.out&quot;, &quot;w&quot;, stdout);\n    auto stime = std::chrono::steady_clock::now();\n    long long n;\n    int k;\n    std::cin &gt;&gt; n &gt;&gt; k, k = std::min((long long)k, n);\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res = 1ll;\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    auto res = qkp(k + 1, (n - k) % (mod - 1));\n    for (int i = 1; i &lt;= k; ++i)\n        (res *= i) %= mod;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt;(std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s \\n&quot;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b.-é‡æ’\">B. é‡æ’</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P14353\" class=\"uri\">https://www.luogu.com.cn/problem/P14353</a></p>\n<blockquote>\n<p>ç»™å®šä¸€ä¸ªåˆå§‹ä¸ºç©ºçš„æ•°ç»„ <span class=\"math inline\">\\(a\\)</span>ï¼Œå†ç»™å‡º <span class=\"math inline\">\\(n\\)</span> æ¬¡åŠ æ•°æ“ä½œï¼Œæ¯æ¬¡åŠ æ•°åè¾“å‡ºï¼š</p>\n<p>ä»»æ„æ’åˆ— <span class=\"math inline\">\\(a\\)</span>ï¼Œå¾—åˆ°çš„ <span class=\"math inline\">\\(\\sum\\limits_{i=2}^n |a_{i+1}-a_{i}|\\)</span> çš„æœ€å¤§å€¼ã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 3\\times 10^6\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li><p>æ˜¾ç„¶ä»å°åˆ°å¤§æ’åˆ—ï¼Œç­”æ¡ˆæ˜¯å <span class=\"math inline\">\\(\\left\\lfloor \\dfrac n2\\right\\rfloor\\)</span> ä¸ªæ•°çš„å’Œå‡å»å‰ <span class=\"math inline\">\\(\\left\\lfloor \\dfrac n2\\right\\rfloor\\)</span> çš„å’Œçš„å·®çš„äºŒå€ï¼Œå†å‡å»ä½äºä¸­é—´ 2 / 3 ä¸ªæ•°ä¸­ï¼Œç›¸é‚»ä¸¤ä¸ªå·®çš„æœ€å°å€¼ã€‚</p>\n<p>è¿™å®¶ä¼™åœ¨è¯´ä»€ä¹ˆå‘¢.jpg</p></li>\n<li><p>ç”¨å¤§æ ¹å † + å°æ ¹å †ç»´æŠ¤å³å¯ï¼Œå› ä¸º pbds è¿‡ä¸å»</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;rearrange.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;rearrange.out&quot;, &quot;w&quot;, stdout);\n    auto stime = std::chrono::steady_clock::now();\n    int n, T;\n    std::cin &gt;&gt; n &gt;&gt; T;\n    auto res = 0ll, la = 0ll, sL = 0ll, sR = 0ll;\n    std::priority_queue&lt;int&gt; L;\n    std::priority_queue&lt;int, std::vector&lt;int&gt;, std::greater&lt;int&gt; &gt; R;\n    for (int i = 1, mid = 0; i &lt;= n; ++i) &#123;\n        long long x;\n        std::cin &gt;&gt; x;\n        int b =  T ? x ^ la : x;\n        if (i == 1)\n            mid = b, la = 0ll;\n        else if (i &amp; 1) &#123;\n            if (b &lt; L.top()) &#123;\n                mid = L.top(), sL -= mid;\n                L.pop();\n                sL += b, L.push(b);\n            &#125;\n            else if (b &gt; R.top()) &#123;\n                mid = R.top(), sR -= mid;\n                R.pop();\n                sR += b, R.push(b);\n            &#125;\n            else\n                mid = b;\n            la = 2 * (sR - sL) - std::min(R.top() - mid, mid - L.top());\n        &#125;\n        else &#123;\n            if (b &lt;= mid) &#123;\n                sL += b, sR += mid;\n                L.push(b), R.push(mid);\n            &#125;\n            else &#123;\n                sL += mid, sR += b;\n                L.push(mid), R.push(b);\n            &#125;\n            la = 2 * (sR - sL) - (R.top() - L.top());\n        &#125;\n        res ^= la;\n    &#125;\n    printf(&quot;%lld\\n&quot;, res);\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt;(std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s \\n&quot;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c.-æ•´å¼æ¯”è¾ƒ-qoj10506.-waga\">C. æ•´å¼æ¯”è¾ƒ / qoj#10506. Waga</h2>\n<p><a href=\"https://www.becoder.com.cn/contest/6685/problem/3\" class=\"uri\">https://www.becoder.com.cn/contest/6685/problem/3</a> / <a href=\"https://qoj.ac/problem/10506\" class=\"uri\">https://qoj.ac/problem/10506</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(a_{1\\cdots n}\\)</span>ï¼Œå’Œä¸€ä¸ªç§°ï¼Œå¦‚ä¸‹æ“ä½œç§°ä¸ºä¸€æ¬¡ã€ç§°é‡ã€ï¼š</p>\n<ul>\n<li>é€‰ä¸­ <span class=\"math inline\">\\(a\\)</span> çš„ä¸€ä¸ªå­é›†ï¼Œè¾“å…¥ç»™ç§°ã€‚è®°å®ƒä»¬çš„å’Œä¸º <span class=\"math inline\">\\(s\\)</span>ï¼Œé‚£ä¹ˆç§°ä¼šè¿”å› <span class=\"math inline\">\\(\\min(k,\\left\\lfloor \\dfrac sc \\right\\rfloor)\\)</span>ï¼Œå…¶ä¸­ï¼Œ<span class=\"math inline\">\\(c\\)</span> ä¸ºç»™å®šå¸¸æ•°ã€‚</li>\n</ul>\n<p>ç°åœ¨å¯¹äºæ¯ä¸ªæ— åºå¯¹ <span class=\"math inline\">\\((i,j)\\)</span>ï¼ˆ<span class=\"math inline\">\\(i\\ne j\\)</span>ï¼‰ï¼Œä½ éœ€è¦åˆ¤æ–­ï¼š</p>\n<ul>\n<li>åœ¨å·²çŸ¥ <span class=\"math inline\">\\(a\\)</span> ä¸­é™¤ <span class=\"math inline\">\\(a_i,a_j\\)</span> å¤–æ‰€æœ‰å…ƒç´ å€¼ï¼Œä¸” <span class=\"math inline\">\\(a_i,a_j\\)</span> æ•°å€¼æœªçŸ¥çš„å‰æä¸‹ï¼Œæ˜¯å¦å¯ä»¥é€šè¿‡è‹¥å¹²æ¬¡ç§°é‡ç¡®å®š <span class=\"math inline\">\\(a_i,a_j\\)</span> çš„å¤§å°å…³ç³»ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n,c\\le 8000,k\\le 10^5,1\\le a_i&lt; kc\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li><p>æ˜¾ç„¶ï¼Œ<span class=\"math inline\">\\(a_i\\)</span> å’Œ <span class=\"math inline\">\\(a_j\\)</span> èƒ½åŒºåˆ†ï¼Œå½“ä¸”ä»…å½“ <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {a_i}c\\right\\rfloor\\ne \\left\\lfloor\\dfrac {a_j}c\\right\\rfloor\\)</span>ï¼Œæˆ–è€…å­˜åœ¨ä¸€ä¸ªå…¶ä»–å…ƒç´ çš„å­é›† <span class=\"math inline\">\\(s\\)</span>ï¼Œä½¿å¾— <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {a_i+s}c\\right\\rfloor\\ne \\left\\lfloor\\dfrac {a_j + s}c\\right\\rfloor\\)</span>ã€‚</p>\n<p>åè¿‡æ¥ï¼Œå¦‚æœ <span class=\"math inline\">\\(a_i\\)</span> å’Œ <span class=\"math inline\">\\(a_j\\)</span> ä¸èƒ½åŒºåˆ†ï¼Œä¸€ä¸ªå‰ææ˜¯ <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {a_i}c\\right\\rfloor =\\left\\lfloor\\dfrac {a_j}c\\right\\rfloor\\)</span>ã€‚</p></li>\n<li><p>ä¸‹æ„è¯†çŒœè¦æ’åºï¼Œæ’åºåæ‰“è¡¨å‘ç°ä½¿ <span class=\"math inline\">\\(i\\)</span> ä¸åˆæ³•çš„ <span class=\"math inline\">\\(j\\)</span> æ€»æ˜¯è¿ç»­çš„ã€‚</p>\n<details>\n<p><summary>è¯æ˜</summary></p>\n<ol type=\"1\">\n<li><p>éœ€è¦è¯ï¼šå¯¹äº <span class=\"math inline\">\\(x&lt;y&lt;z\\)</span>ï¼Œè‹¥ <span class=\"math inline\">\\(x,y\\)</span> ä¸å¯åŒºåˆ†ï¼Œä¸” <span class=\"math inline\">\\(y,z\\)</span> ä¸å¯åŒºåˆ†ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(x,z\\)</span> ä¸å¯åŒºåˆ†ã€‚</p>\n<p>è®° <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {x}c\\right\\rfloor=\\left\\lfloor\\dfrac {y}c\\right\\rfloor=\\left\\lfloor\\dfrac {z}c\\right\\rfloor=w\\)</span>ï¼Œä¸å­˜åœ¨ <span class=\"math inline\">\\(s\\le c\\cdot (k-w)\\)</span>ï¼Œä½¿å¾— <span class=\"math inline\">\\(y\\)</span> å¯ä»¥è¿›ä½ä½† <span class=\"math inline\">\\(x\\)</span> ä¸å¯ï¼Œä¹Ÿä¸å­˜åœ¨è¿™æ ·çš„ <span class=\"math inline\">\\(s\\)</span> ä½¿å¾— <span class=\"math inline\">\\(z\\)</span> å¯ä»¥è¿›ä½ä½† <span class=\"math inline\">\\(y\\)</span> ä¸å¯ã€‚</p>\n<p>åˆå¹¶ä¸ç­‰å¼å®¹æ˜“å¾—åˆ°ä¸å­˜åœ¨è¿™æ ·çš„ <span class=\"math inline\">\\(x\\)</span> ä½¿å¾— <span class=\"math inline\">\\(z\\)</span> å¯ä»¥è¿›ä½ä½† <span class=\"math inline\">\\(x\\)</span> ä¸å¯ã€‚</p></li>\n<li><p>éœ€è¦è¯ï¼šå¯¹äº <span class=\"math inline\">\\(x&lt;y&lt;z\\)</span>ï¼Œè‹¥ <span class=\"math inline\">\\(x,y\\)</span> å¯åŒºåˆ†æˆ– <span class=\"math inline\">\\(y,z\\)</span> å¯åŒºåˆ†ï¼Œåˆ™ <span class=\"math inline\">\\(x,z\\)</span> å¯åŒºåˆ†ã€‚</p>\n<p>è°ƒæ•´æ³•æ˜“å¾—ã€‚</p></li>\n</ol>\n</details></li>\n<li><p>æ•…å‘ç°åªéœ€è¦è®¨è®ºç›¸é‚»ä¸¤ä¸ªå…ƒç´ æ˜¯å¦å¯åŒºåˆ†ã€‚éœ€è¦çŸ¥é“æ‰€æœ‰å¯èƒ½çš„å­é›†å’Œç”¨äº checkï¼Œå¯ä»¥ç”¨åˆ†æ²»é¢„å¤„ç†ã€åªæœ‰æŸç›¸é‚»ä¸¤ä¸ªå…ƒç´ ä¸é€‰ã€æ—¶çš„å‰åç¼€èƒŒåŒ…æ•°ç»„ï¼ˆåˆ°è¾¾æŸä¸ªä½™æ•°æ—¶éœ€è¦çš„æœ€å°æ•´å€æ•°ï¼‰ï¼Œå°±å¯ä»¥ <span class=\"math inline\">\\(O(nc\\log n)\\)</span> è§£å†³é—®é¢˜ã€‚</p>\n<p>è€ƒè™‘åœ¨åšä»€ä¹ˆï¼šåˆ ç‚¹åœ¨ <span class=\"math inline\">\\([l,mid]\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\([mid+1,r]\\)</span> çš„ DP æ•°ç»„ä¸ä¼šå—åˆ°å½±å“ï¼›åˆ ç‚¹åœ¨ <span class=\"math inline\">\\([mid + 1, r]\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\([l,mid]\\)</span> çš„ DP æ•°ç»„ä¸ä¼šå—åˆ°å½±å“ã€‚èƒŒåŒ…çš„ç‰©å“æ˜¯æ— é¡ºåºçš„ï¼Œæ‰€ä»¥æœ‰æ­£ç¡®æ€§ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´å¤§éƒ¨åˆ†ä¿¡æ¯æ˜¯å¯ç»§æ‰¿çš„ã€‚<em>ä¸ºä»€ä¹ˆé¢˜è§£ç®¡è¿™ä¸ªå« CDQï¼Ÿæ˜¯å› ä¸ºæ™®é€šåˆ†æ²»æ€»ä¼šè¢«å« CDQ å—ï¼Ÿ</em></p>\n<p>åšä¸€ä¸ªç±»ä¼¼ 01 èƒŒåŒ…æ»šåŠ¨æ•°ç»„çš„ä¸œè¥¿ï¼Œç»´æŠ¤æ¯ä¸ªç‚¹å‰ / åå¯ä»¥å‡‘å‡ºæ¥çš„èƒŒåŒ…å€¼ï¼Œåœ¨æœ€åä¸‹ä¼ åˆ°å•ç‚¹æ—¶ç»Ÿè®¡ç­”æ¡ˆå³å¯ã€‚</p></li>\n</ul>\n<details>\n<p>ç›¸é‚»ä¸¤ä¸ªçš„å¤„ç†ç•¥æ˜¾çƒ§è„‘ï¼Œä½†æ„å¤–åœ°ç®€æ´ã€‚</p>\n<p><code>&gt;=</code> ä¸è¦å†™æˆé™¤ï¼Œä¸ç„¶ä¼šæ…¢æˆå”è¯—</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 8e3 + 5;\nchar nec(void) &#123;\n    static char buf[1 &lt;&lt; 20], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, 1 &lt;&lt; 20, stdin);\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\nint read(void) &#123;\n    auto x = 0ll;\n    char t = nec();\n    for (; t &lt; &#39;0&#39; || t &gt; &#39;9&#39;; t = nec());\n    for (; t &gt;= &#39;0&#39; &amp;&amp; t &lt;= &#39;9&#39;; t = nec())\n        x = x * 10 + t - &#39;0&#39;;\n    return x;\n&#125;\nint ok[maxn], m, k;\nstd::pair&lt;int, int&gt; a[maxn];\nvoid calc(int l, int r, const std::vector&lt;int&gt; f) &#123;\n    if (l &gt; r)\n        return;\n    if (l == r) &#123;\n        if (a[l].first == a[l + 1].first)\n            ok[l] = 1;\n        else if (a[l].first / m == a[l + 1].first / m)\n            ok[l] = (*std::min_element(f.begin() + m - a[l + 1].first % m, f.begin() + m - a[l].first % m) + a[l].first / m &gt;= k);\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    auto g = f;\n    for (int i = mid + 2; i &lt;= r + 1; ++i) &#123;\n        auto h = g;\n        for (int j = 0, k; j &lt; m; ++j) &#123;\n            k = (j + m - a[i].first % m) % m;\n            h[j] = std::min(h[j], g[k] + a[i].first / m + (k + a[i].first % m &gt;= m));\n        &#125;\n        h.swap(g);\n    &#125;\n    calc(l, mid, g);\n    g = f;\n    for (int i = l; i &lt;= mid; ++i) &#123;\n        auto h = g;\n        for (int j = 0, k; j &lt; m; ++j) &#123;\n            k = (j + m - a[i].first % m) % m;\n            h[j] = std::min(h[j], g[k] + a[i].first / m + (k + a[i].first % m &gt;= m));\n        &#125;\n        h.swap(g);\n    &#125;\n    calc(mid + 1, r, g);\n    return;\n&#125;;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;intcmp.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;intcmp.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n = read();\n    m = read(), k = read();\n    for (int i = 1; i &lt;= n; ++i)\n        a[i].first = read(), a[i].second = i;\n    std::sort(a + 1, a + n + 1);\n    std::vector&lt;int&gt; f(m, 0x3f3f3f3f);\n    f[0] = 0;\n    calc(1, n - 1, f);\n    std::vector&lt;int&gt; resL(n + 1), resR(n + 1);\n    int now = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        resR[a[i].second] = i - 1 - now;\n        if (i != n &amp;&amp; ok[i])\n            ++now;\n        else\n            now = 0;\n    &#125;\n    now = 0;\n    for (int i = n; i; --i) &#123;\n        resL[a[i].second] = n - i - now;\n        if (ok[i - 1])\n            ++now;\n        else\n            now = 0;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        printf(&quot;%d %d \\n&quot;, resL[i], resR[i]);\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b.-å­—ç¬¦ä¸²è½¬æ¢\">B. å­—ç¬¦ä¸²è½¬æ¢</h2>\n<p><a href=\"https://www.becoder.com.cn/problem/52055\" class=\"uri\">https://www.becoder.com.cn/problem/52055</a></p>\n<blockquote>\n<p>ç»™å®šç­‰é•¿ 01 ä¸² <span class=\"math inline\">\\(S,T\\)</span>ï¼Œç»´æŠ¤ <span class=\"math inline\">\\(Q\\)</span> æ¬¡æ“ä½œï¼š</p>\n<ul>\n<li>ä¿®æ”¹ï¼šFlip <span class=\"math inline\">\\(S\\)</span> çš„æŸä¸ªå­—ç¬¦ã€‚</li>\n<li>ä¿®æ”¹ï¼šFlip <span class=\"math inline\">\\(T\\)</span> çš„æŸä¸ªå­—ç¬¦ã€‚</li>\n</ul>\n<p>æ¯æ¬¡æ“ä½œåï¼Œé—® <span class=\"math inline\">\\(S\\)</span> èƒ½å¦é€šè¿‡è‹¥å¹²æ¬¡ä¸‹åˆ—æ“ä½œå˜ä¸º <span class=\"math inline\">\\(T\\)</span>ï¼š</p>\n<ul>\n<li>é€‰æ‹© <span class=\"math inline\">\\(S\\)</span> ä¸­çš„ä¸€ä¸ª <code>00</code>ï¼Œå˜ä¸º <code>10</code>ã€‚</li>\n<li>é€‰æ‹© <span class=\"math inline\">\\(S\\)</span> ä¸­çš„ä¸€ä¸ª <code>11</code>ï¼Œå˜ä¸º <code>01</code>ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(|S|,Q\\le 3\\times 10^5\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li><p>è¿ç»­ 00 / 11 æ“ä½œï¼Œè€ƒè™‘å¥‡æ•°ä½å–åã€‚å–åä¹‹åå‘ç°åŸæ“ä½œç­‰ä»·äº <span class=\"math inline\">\\(a_i\\gets a_{i+1}\\)</span>ã€‚</p></li>\n<li><p>è¿™ä¸ªæ“ä½œåªä¼šä½¿è¿ç»­æ®µçš„æ•°é‡å‡å°‘ï¼Œæ•…è¦æ±‚æ¯ä¸€ä¸ªåç¼€ï¼Œ<span class=\"math inline\">\\(S\\)</span> çš„è¿ç»­æ®µä¸ªæ•°ä¸å°‘äº <span class=\"math inline\">\\(T\\)</span> çš„è¿ç»­æ®µä¸ªæ•°ï¼Œè€Œä¸”äºŒè€…ç»“å°¾ç›¸åŒã€‚</p>\n<p>çº¿æ®µæ ‘ç»´æŠ¤å³å¯ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 3e5 + 5;\nstruct &#123; int l, r, mn, d; &#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    t[p].mn = t[p].d = 0;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    if (t[p].d) &#123;\n        t[lt].mn += t[p].d, t[lt].d += t[p].d;\n        t[rt].mn += t[p].d, t[rt].d += t[p].d;\n        t[p].d = 0;\n    &#125;\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        t[p].mn += v, t[p].d += v;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    t[p].mn = std::min(t[lt].mn, t[rt].mn);\n    return;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;string.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;string.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n, q;\n        std::cin &gt;&gt; n &gt;&gt; q;\n        std::vector&lt;int&gt; a(n + 1), b(n + 1);\n        bld(1, 1, n);\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            char t;\n            std::cin &gt;&gt; t, a[i] = (t == &#39;B&#39;);\n            if (i &amp; 1)\n                a[i] ^= 1;\n        &#125;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            char t;\n            std::cin &gt;&gt; t, b[i] = (t == &#39;B&#39;);\n            if (i &amp; 1)\n                b[i] ^= 1;\n        &#125;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            int v = 0;\n            v += (i == n || a[i] != a[i + 1]);\n            v -= (i == n || b[i] != b[i + 1]);\n            if (v)\n                add(1, 1, i, v);\n        &#125;\n        for (char op; q--; ) &#123;\n            int i;\n            std::cin &gt;&gt; op &gt;&gt; i;\n            if (op == &#39;X&#39;) &#123;\n                int v = 0, v1 = 0;\n                v -= (i == n || a[i] != a[i + 1]);\n                v1 -= (i != 1 &amp;&amp; a[i] != a[i - 1]);\n                a[i] ^= 1;\n                v += (i == n || a[i] != a[i + 1]);\n                v1 += (i != 1 &amp;&amp; a[i] != a[i - 1]);\n                if (v)\n                    add(1, 1, i, v);\n                if (v1)\n                    add(1, 1, i - 1, v1);\n            &#125;\n            else &#123;\n                int v = 0, v1 = 0;\n                v += (i == n || b[i] != b[i + 1]);\n                v1 += (i != 1 &amp;&amp; b[i] != b[i - 1]);\n                b[i] ^= 1;\n                v -= (i == n || b[i] != b[i + 1]);\n                v1 -= (i != 1 &amp;&amp; b[i] != b[i - 1]);\n                if (v)\n                    add(1, 1, i, v);\n                if (v1)\n                    add(1, 1, i - 1, v1);\n            &#125;\n            std::cout &lt;&lt; ((a[n] == b[n] &amp;&amp; t[1].mn &gt;= 0) ? &quot;YES&quot; : &quot;NO&quot;) &lt;&lt; &#39;\\n&#39;;\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c.-ç›‘æ§\">C. ç›‘æ§</h2>\n<p><a href=\"https://www.becoder.com.cn/problem/52057\" class=\"uri\">https://www.becoder.com.cn/problem/52057</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(n\\)</span> ä¸ªæ€ªï¼Œæ¯ä¸ªæ€ªæœ‰ <span class=\"math inline\">\\(B_i\\)</span> æ»´è¡€ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªæ€ªèƒ½è¢«æ‰“ <span class=\"math inline\">\\(\\le B_i\\)</span> æ¬¡ã€‚</p>\n<p>è¦æ±‚æ¯ä¸ªæ€ªå¿…é¡»è¢«æ‰“ <span class=\"math inline\">\\(\\ge A_i\\)</span> æ¬¡ï¼Œå¹¶è®¤ä¸ºè¢«æ‰“æ°å¥½ <span class=\"math inline\">\\(A_i\\)</span> æ¬¡æ—¶è¿™ä¸ªæ€ªæ˜¯å¥½çš„ã€‚</p>\n<p>å¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(1\\le x\\le \\sum B_i\\)</span>ï¼Œæ±‚ï¼šåœ¨æ”»å‡»æ¬¡æ•°åªèƒ½ä¸º <span class=\"math inline\">\\(x\\)</span> çš„å€æ•°çš„å‰æä¸‹ï¼Œä¸å¥½çš„æ€ªçš„æœ€å°å€¼ã€‚ä½ åªéœ€è¦è¾“å‡ºç­”æ¡ˆçš„å’Œã€‚</p>\n<p><span class=\"math inline\">\\(N\\le 10^5,1\\le A_i&lt; B_i\\le 10^5\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li><p>è®° <span class=\"math inline\">\\(c_i=B_i-A_i\\)</span>ï¼ŒæŠŠ <span class=\"math inline\">\\(c_i\\)</span> é™åºæ’åˆ—ï¼Œè®° <span class=\"math inline\">\\(s=\\sum A_i\\)</span>ï¼Œé‚£ä¹ˆä¸€ä¸ª <span class=\"math inline\">\\(x\\)</span> çš„ç­”æ¡ˆä¸ºï¼š</p>\n<p><span class=\"math display\">\\[\n\\min\\left\\{i\\mid{\\left\\lceil \\frac{s}x \\right\\rceil\\cdot x - s\\ge c_i}\\right\\}\n\\]</span></p></li>\n<li><p>å®¹æ˜“æƒ³åˆ°æ•´é™¤åˆ†å—ï¼Œæšä¸¾ <span class=\"math inline\">\\(\\left\\lceil \\dfrac{s}x \\right\\rceil\\)</span> çš„å€¼ <span class=\"math inline\">\\(k\\)</span>ï¼Œé‚£ä¹ˆç›¸å½“äºæƒ³è¦æ‰¾åˆ° <span class=\"math inline\">\\([L_i,R_i]\\)</span> ä¸­çš„æ¯ä¸ª <span class=\"math inline\">\\(x\\)</span>ï¼Œ<span class=\"math inline\">\\(x\\cdot k-s\\)</span> ä¼šè½åœ¨å“ªä¸ª <span class=\"math inline\">\\(c\\)</span> çš„ç®¡è¾–èŒƒå›´é‡Œã€‚</p>\n<p>ä¸å¦¨è®° <span class=\"math inline\">\\(c_i\\)</span> çš„ç®¡è¾–èŒƒå›´ä¸º <span class=\"math inline\">\\([cL_i,cR_i]\\)</span>ï¼Œé‚£ä¹ˆè½¬åŒ–ä¸º <span class=\"math inline\">\\(x\\cdot k-s\\in [cL_i,cR_i]\\)</span>ï¼Œæšä¸¾ <span class=\"math inline\">\\(c\\)</span> è§£ä¸ç­‰å¼å³å¯ã€‚</p></li>\n<li><p>ä½†å‘ç°ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ï¼šå¤–å±‚æ•´é™¤åˆ†å—å¤æ‚åº¦æ˜¯ <span class=\"math inline\">\\(\\sqrt(s)\\)</span> çš„ï¼Œæœ€åŠ£ <span class=\"math inline\">\\(10^5\\)</span> çº§åˆ«ï¼Œå¾ˆåäº†ã€‚</p>\n<p>å‘ç°æšä¸¾å•†æ•°åŠ£çš„åŸå› æ˜¯ä½¿ <span class=\"math inline\">\\(\\left\\lceil \\dfrac{s}x \\right\\rceil\\)</span> å¾ˆå¤§çš„ <span class=\"math inline\">\\(x\\)</span> å¹¶ä¸å¤šï¼Œå´å ç”¨äº†å¾ˆå¤šæšä¸¾æ¬¡æ•°</p>\n<p>å¦‚æœåšç»å…¸çš„æ•´é™¤åˆ†å—åŒæ ·ä¼šå‘ç°åˆ°åæœŸå—å†…å…ƒç´ è¿œè¿œå°‘äº <span class=\"math inline\">\\(n\\)</span>ï¼Œå´è¦èŠ±è´¹ <span class=\"math inline\">\\(n\\)</span> æ¬¡æ“ä½œæ¥å¤„ç†å®ƒä»¬ã€‚æ‰€ä»¥å¯¹äºè¿™éƒ¨åˆ†æ•°æˆ‘ä»¬ç›´æ¥æœ´ç´ äºŒåˆ†ã€‚</p></li>\n<li><p>å–é˜ˆå€¼ä¸º 1500 å³å¯ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int B = 1500;\nconst long long inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;long long&gt; c(n + 1);\n    auto sa = 0ll, sb = 0ll;\n    for (int i = 1, a, b; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a &gt;&gt; b;\n        sa += a, sb += b, c[i] = b - a;\n    &#125;\n    std::sort(c.begin() + 1, c.end(), std::greater&lt;int&gt; ());\n    std::partial_sum(c.begin() + 1, c.end(), c.begin() + 1);\n    auto L = sb + 1;\n    std::stack&lt;std::pair&lt;long long, int&gt; &gt; st;\n    for (int k = 1; k &lt;= 1500; ++k) &#123;\n        auto l = (sa + k - 1) / k, r = L - 1;\n        if (l &gt; r)\n            continue;\n        L = l;\n        st.emplace(r, n + 1);\n        for (int i = n; ~i; --i)\n            st.emplace(std::min(r, (c[i] + sa) / k), i);\n    &#125;\n    for (int i = L - 1; i; --i)\n        st.emplace(i, std::lower_bound(c.begin(), c.end(), ((sa + i - 1) / i) * i - sa) - c.begin());\n    auto res = 0ll;\n    for (auto l = 1ll; !st.empty(); ) &#123;\n        auto [r, v] = st.top();\n        st.pop();\n        if (l &gt; r)\n            continue;\n        if (v == n + 1)\n            v = 0;\n        res += (r - l + 1) * v;\n        l = r + 1;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"g---range-set-modifying-query\">G - Range Set Modifying Query</h2>\n<p><a href=\"https://atcoder.jp/contests/abc430/tasks/abc430_g\" class=\"uri\">https://atcoder.jp/contests/abc430/tasks/abc430_g</a></p>\n<ul>\n<li><p>å‘ç°å¼€ 60 ä¸ªçº¿æ®µæ ‘éå¸¸åˆç†</p></li>\n<li><p>æ¥ç€å‘ç°æ˜¯ beats æ¿å­é¢˜ã€‚çœ‹ä¼¼éœ€è¦ä¸‰åª logï¼Œå…¶å®åªæœ‰ä¸¤åªã€‚</p></li>\n<li><p>å‚è§ abc426ï¼Œæœ€è¿‘ abc éƒ½å–œæ¬¢ beats æ¿å­é¢˜å—ï¼Ÿ</p></li>\n</ul>\n",
            "tags": [
                "åˆ†æ²»",
                "åˆ†å—",
                "èƒŒåŒ…"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250907/",
            "url": "https://xsc062.netlify.app/20250907/",
            "title": "è¿‘æœŸæ‚é¢˜",
            "date_published": "2025-09-07T08:13:09.000Z",
            "content_html": "<p>çªå›´</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"e---colinear\">E - Colinear</h2>\n<p><a href=\"https://atcoder.jp/contests/abc422/tasks/abc422_e\" class=\"uri\">https://atcoder.jp/contests/abc422/tasks/abc422_e</a></p>\n<p>çœ‹åˆ°é¢˜ç›®ä¼šæœ‰ä¸€ä¸ªä¹±æçš„æƒ³æ³•ï¼šéšæœºå–ä¸€å¯¹ç‚¹ï¼Œé‚£ä¹ˆæ˜¯æœ‰ <span class=\"math inline\">\\(\\dfrac 14\\)</span> çš„æ¦‚ç‡éƒ½åœ¨ç›´çº¿ä¸Šçš„ã€‚å¸¦è¿›å»æš´åŠ› check ä¸€ä¸‹ï¼Œå¤šæ¥å‡ æ¬¡æ­£ç¡®ç‡å°±æ¯”è¾ƒé«˜ã€‚</p>\n<p>ä»€ä¹ˆï¼Œè¿™æ˜¯æ­£è§£ï¼Ÿabc çš„é£æ ¼çœŸæ˜¯è¶Šæ¥è¶Šå¥‡æ€ªäº†ã€‚</p>\n<hr />\n<h2 id=\"f---eat-and-ride\">F - Eat and Ride</h2>\n<p><a href=\"https://atcoder.jp/contests/abc422/tasks/abc422_f\" class=\"uri\">https://atcoder.jp/contests/abc422/tasks/abc422_f</a></p>\n<p>è€ƒè™‘ä¸€ä¸ªè´¹ç”¨æå‰è®¡ç®—çš„åˆ†å±‚å›¾ï¼Œå°±å¯ä»¥è·‘ Dij äº†ã€‚</p>\n<p>å®˜è§£ç»™å‡ºäº†ä¸€ä¸ªä¼˜åŒ–ï¼š<strong>æœç´¢å®é™…ä¸Šæ˜¯åœ¨ç»™è¾¹å®šå‘ï¼›è¿™æ ·å›¾å°±è½¬åŒ–ä¸º DAG</strong>ï¼ˆå®é™…ä¸Šåå‘è¾¹å¹¶ä¸ä¼šäº§ç”Ÿæœ‰æ•ˆæ›´æ–°ï¼Œæ•…ç›´æ¥æœ´ç´ è½¬ç§»å³å¯ï¼‰ã€‚</p>\n<hr />\n<h2 id=\"b---triangle-toggle\">B - Triangle Toggle</h2>\n<p><a href=\"https://atcoder.jp/contests/arc205/tasks/arc205_b\" class=\"uri\">https://atcoder.jp/contests/arc205/tasks/arc205_b</a></p>\n<p>ç°åœºæ˜¯æ‰“è¡¨æ‰¾è§„å¾‹åšå‡ºæ¥çš„ ğŸ˜…</p>\n<p>å‘ç°è¿™æ ·ä¸€æ¬¡æ“ä½œä¹‹åæ¯ä¸ªç‚¹ä¸Šé»‘è¾¹çš„å¥‡å¶æ€§æ˜¯ä¸ä¼šå˜çš„ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€ä¸ªä¸Šç•Œï¼Œéš¾ç‚¹åœ¨äºæ˜¯å¦å¯ä»¥è¾¾åˆ°è¿™ä¸ªä¸Šç•Œã€‚</p>\n<p>å‘ç°åªè¦å­˜åœ¨ä¸€ä¸ªç‚¹ä¸Šè¿æœ‰ä¸¤æ¡ç™½è¾¹ï¼Œå°±å¯ä»¥æŠŠ 001 åè½¬ä¸º 110ï¼Œä¸€æ¬¡æ“ä½œè‡³å°‘å¯ä»¥æ–°å¢ä¸€æ¡é»‘è¾¹ã€‚æ•…æ˜¯å¯ä»¥è¾¾åˆ°çš„ã€‚</p>\n<hr />\n<h2 id=\"d---non-ancestor-matching\">D - Non-Ancestor Matching</h2>\n<p><a href=\"https://atcoder.jp/contests/arc205/tasks/arc205_d\" class=\"uri\">https://atcoder.jp/contests/arc205/tasks/arc205_d</a></p>\n<p>æ²¡å•¥å¥½è¯´çš„æ‘©å°”æŠ•ç¥¨ï¼Œæœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„ä¼˜å…ˆé˜Ÿåˆ—åšæ³•</p>\n<p>ä½† Rosmist æ‰“äº†å¦ä¸€ä¸ªçœ‹èµ·æ¥æœ‰ç‚¹ç„å­¦çš„ä¸œè¥¿ï¼šå¯ä»¥æ„Ÿå—åˆ°æ¯æ¬¡åªå‘æœ€å¤§çš„å­æ ‘é€’å½’æ˜¯åˆç†çš„ï¼Œå°è¯•è¯æ˜ä¸€ä¸‹å‘ç°ç¡®å®æ¯”è¾ƒæ˜¾ç„¶</p>\n<hr />\n<h2 id=\"e---subset-product-problem\">E - Subset Product Problem</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/AT_arc205_e\" class=\"uri\">https://www.luogu.com.cn/problem/AT_arc205_e</a></p>\n<p>å¥‡æ€ªé¢˜ç›®</p>\n<p>é«˜ç»´å‰ç¼€å’Œ + åˆ†å—å…¶å®ä¸ç®—ç‰¹åˆ«ç½•è§çš„ trick</p>\n<p>ç”¨ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºå‰ <span class=\"math inline\">\\(10\\)</span> ä½ä¸º <span class=\"math inline\">\\(i\\)</span>ï¼Œå <span class=\"math inline\">\\(10\\)</span> ä½çš„é«˜ç»´å‰ç¼€å’Œ</p>\n<p>æ¯æ¬¡æŸ¥è¯¢ / æ›´æ–°éƒ½æ˜¯ <span class=\"math inline\">\\(O(2^{10})\\)</span> çš„ï¼Œå¯ä»¥æ¥å—ï¼ˆå—ï¼‰</p>\n<p>ç„¶åè¿˜æœ‰ä¸€ä¸ªç§‘ç ”æ€§çš„åšæ³• è§ <a href=\"https://www.luogu.com.cn/article/1uyz0hn2\" class=\"uri\">https://www.luogu.com.cn/article/1uyz0hn2</a></p>\n<hr />\n<h2 id=\"c.-by-the-assignment\">C. By the Assignment</h2>\n<p><a href=\"https://codeforces.com/contest/2135/problem/C\" class=\"uri\">https://codeforces.com/contest/2135/problem/C</a></p>\n",
            "tags": [
                "åˆ†å—",
                "éšæœºåŒ–",
                "æœ€çŸ­è·¯"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20240501/",
            "url": "https://xsc062.netlify.app/20240501/",
            "title": "äº”ä¸€æ‚é¢˜",
            "date_published": "2024-05-01T07:44:48.000Z",
            "content_html": "<p><a href=\"https://www.becoder.com.cn/contest/5169\">SAM æ‚é¢˜</a> + <a href=\"https://www.becoder.com.cn/contest/5170\">NOIPS8</a> + <a href=\"https://www.becoder.com.cn/contest/5175\">å‘¨è€ƒ</a> é€‰è®²ã€‚</p>\n<p>çœ‹çœ‹è¿™ä¸ªæ ‡ç­¾åˆ—è¡¨é•¿åº¦å°±çŸ¥é“è¿™ä¸‰å¤©åšçš„é¢˜æœ‰å¤šæ‚ã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<h3 id=\"d.-å­—ç¬¦ä¸²\">D. å­—ç¬¦ä¸²</h3>\n<p><a href=\"https://www.becoder.com.cn/contest/5169/problem/4\" class=\"uri\">https://www.becoder.com.cn/contest/5169/problem/4</a></p>\n<p>å’Œ SA çš„åšæ³•ä¸€æ ·ï¼Œå…ˆäºŒåˆ† <span class=\"math inline\">\\(s_{c\\sim d}\\)</span> çš„å‰ç¼€é•¿åº¦ <span class=\"math inline\">\\(mid\\)</span>ï¼Œåªéœ€ check <span class=\"math inline\">\\(s_{c \\sim c + mid - 1}\\)</span> æ˜¯å¦åœ¨ <span class=\"math inline\">\\(s_{a\\sim b}\\)</span> ä¸­å‡ºç°è¿‡ã€‚</p>\n<p>è€ƒè™‘æ€ä¹ˆå¿«é€Ÿ checkã€‚ä» <span class=\"math inline\">\\(c\\)</span> ä¸€æ­¥ä¸€æ­¥è·³åˆ° <span class=\"math inline\">\\(c+mid-1\\)</span> æ˜¾ç„¶ä¼šèµ·é£ï¼Œè€ƒè™‘åˆ°æŸ¥è¯¢æ˜¯é™æ€çš„ï¼Œæˆ‘ä»¬äº‹å…ˆé¢„å¤„ç†ä¸€ä¸‹ç„¶åå€å¢åœ°è·³å³å¯ã€‚</p>\n<p>æ­¤æ—¶åªéœ€çœ‹å½“å‰çŠ¶æ€çš„ <span class=\"math inline\">\\(\\text {endpos}\\)</span> æ˜¯å¦åœ¨ <span class=\"math inline\">\\([a + mid - 1, b]\\)</span> å‡ºç°è¿‡ã€‚</p>\n<p>å› ä¸ºè¿™ä¸ªä¸èƒ½ç”¨æœ€å¤§æœ€å°ç®€å•ä»£æ›¿ï¼Œæ‰€ä»¥å°±åˆ°äº†æˆ‘ä»¬å–œé—»ä¹è§çš„çº¿æ®µæ ‘åˆå¹¶ç¯èŠ‚ã€‚å°†æ’å…¥åçš„æ¯ä¸ªå•ç‚¹ <span class=\"math inline\">\\(\\text {endpos}\\)</span> åœ¨æƒå€¼çº¿æ®µæ ‘ä¸Šæ›´æ–°ï¼Œåœ¨ parent tree ä¸Šæš´åŠ›çº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚</p>\n<p>ä¹‹å‰ä¸€ç›´æœ‰ä¸€ä¸ªè¯¯åŒºï¼Œå°±æ˜¯è§‰å¾—çº¿æ®µæ ‘åˆå¹¶æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œæ¯”å¦‚ç”¨ A æ ‘å’Œ B æ ‘å¹¶å‡ºæ¥äº† C æ ‘ä¹‹åï¼ŒA æ ‘å’Œ B æ ‘çš„æ•°æ®å°±æ— æ•ˆäº†ã€‚</p>\n<p>ä½†è¿™æ˜¾ç„¶æ˜¯å¾ˆè’è°¬çš„ï¼ŒåŒæ ·å› ä¸ºæˆ‘ä»¬çš„æŸ¥è¯¢æ˜¯é™æ€çš„ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥ç”¨ä¸€ç§ç±»ä¼¼äºå¯æŒä¹…åŒ–çš„æ–¹å¼ï¼Œå»ºç«‹ä¸€äº›æ–°çš„ç‚¹è¡¨ç¤ºåˆå¹¶åçš„ä¿¡æ¯çŠ¶æ€ç‚¹ï¼Œä¸€äº›å¯ä»¥ä¿ç•™çš„ç‚¹å°±ä¿ç•™ä½œå„¿å­ã€‚</p>\n<p>åœ¨å¯¹åº”çš„çŠ¶æ€ä¸ŠæŸ¥è¯¢å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxm = 35;\nconst int maxn = 6e5 + 5;\nconst int maxk = 8e7 + 5;\nstruct _ &#123;\n    int l, f;\n    int ne[maxm]; \n    _() &#123;&#125;\n    _(int l1, int f1): l(l1), f(f1) &#123;&#125;\n&#125;;\n_ t[maxn &lt;&lt; 1];\nint vis[maxn &lt;&lt; 1];\nint fa[maxn][maxm];\nint n, la, tot, siz;\nstruct &#123; int l, r, u; &#125; t1[maxk];\nint tab[maxn &lt;&lt; 1], cnt[maxn &lt;&lt; 1];\nvoid Init(void) &#123;\n    la = tot = 1;\n    t[1] = _(0, 0);\n    return;\n&#125;\nvoid ext(int c) &#123;\n    int p = la, np = ++tot;\n    la = tot;\n    t[np] = _(t[p].l + 1, 0);\n    while (p &amp;&amp; !t[p].ne[c])\n        t[p].ne[c] = np, p = t[p].f;\n    if (!p)\n        t[np].f = 1;\n    else &#123;\n        int q = t[p].ne[c];\n        if (t[q].l == t[p].l + 1)\n            t[np].f = q;\n        else &#123;\n            int nq = ++tot;\n            t[nq] = _(t[p].l + 1, t[q].f);\n            std::copy(t[q].ne, t[q].ne + 26, t[nq].ne);\n            while (p &amp;&amp; t[p].ne[c] == q)\n                t[p].ne[c] = nq, p = t[p].f;\n            t[q].f = nq;\n            t[np].f = nq;\n        &#125;\n    &#125;\n    return;\n&#125;\nint now = 0;\nvoid ins(int &amp;p, int l, int r, int v) &#123;\n    if (!p)\n        p = ++now;\n    ++t1[p].u;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    if (v &lt;= mid)\n        ins(t1[p].l, l, mid, v);\n    else\n        ins(t1[p].r, mid + 1, r, v);\n    return;\n&#125;\nint ask(int p, int l, int r, int ql, int qr) &#123;\n    if (ql &lt;= l &amp;&amp; r &lt;= qr)\n        return t1[p].u;\n    int mid = (l + r) &gt;&gt; 1, res = 0;\n    if (ql &lt;= mid)\n        res = ask(t1[p].l, l, mid, ql, qr);\n    if (qr &gt; mid)\n        res += ask(t1[p].r, mid + 1, r, ql, qr);\n    return res;\n&#125;\nint merge(int p, int q, int l, int r) &#123;\n    if (!p || !q)\n        return p + q;\n    int np = ++now, mid = (l + r) &gt;&gt; 1;\n    t1[np].u = t1[p].u + t1[q].u;\n    if (l == r) return np;\n    t1[np].l = merge(t1[p].l, t1[q].l, l, mid);\n    t1[np].r = merge(t1[p].r, t1[q].r, mid + 1, r);\n    return np;\n&#125;\nint pos[maxn], rt[maxn &lt;&lt; 1];\nbool check(int x, int a, int b, int c, int d) &#123;\n    assert(c + x - 1 &gt;= 0);\n    int p = pos[c + x - 1];\n    for (int i = siz; ~i; --i)\n        if (fa[p][i] &amp;&amp; t[fa[p][i]].l &gt;= x)\n            p = fa[p][i];\n    return ask(rt[p], 0, n - 1, a + x - 1, b) &gt; 0;\n&#125;\nint solve(int a, int b, int c, int d) &#123;\n    int l = 1, r = std::min(d - c + 1, b - a + 1), res = 0;\n    while (l &lt;= r) &#123;\n        int mid = (l + r) &gt;&gt; 1;\n        if (check(mid, a, b, c, d))\n            l = mid + 1, res = mid;\n        else\n            r = mid - 1;\n    &#125;\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n#endif\n    int m;\n    std::string s;\n    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; s;\n    Init();\n    for (int i = 0; i &lt; n; ++i) &#123;\n        ext(s[i] - &#39;a&#39;);\n        pos[i] = la;\n        ins(rt[la], 0, n - 1, i);\n    &#125;\n    siz = log(tot) / log(2.0);\n    for (int i = 1; i &lt;= tot; ++i)\n        ++cnt[t[i].l];\n    std::partial_sum(cnt + 1, cnt + tot + 1, cnt + 1);\n    for (int i = 1; i &lt;= tot; ++i)\n        tab[cnt[t[i].l]--] = i;\n    for (int i = 1; i &lt;= tot; ++i) &#123;\n        int u = tab[i];\n        fa[u][0] = t[u].f;\n        for (int j = 1; j &lt;= siz; ++j)\n            fa[u][j] = fa[fa[u][j - 1]][j - 1];\n    &#125;\n    for (int i = tot; i; --i) &#123;\n        int u = tab[i];\n        if (t[u].f)\n            rt[t[u].f] = merge(rt[t[u].f], rt[u], 0, n - 1);\n    &#125;\n    while (m--) &#123;\n        int a, b, c, d;\n        std::cin &gt;&gt; a &gt;&gt; b &gt;&gt; c &gt;&gt; d;\n        std::cout &lt;&lt; solve(a - 1, b - 1, c - 1, d - 1) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"f.-security\">F. Security</h3>\n<p><a href=\"https://www.becoder.com.cn/contest/5169/problem/6\" class=\"uri\">https://www.becoder.com.cn/contest/5169/problem/6</a></p>\n<p>å¯¹æˆ‘ä»¬æ¥è¯´åº”è¯¥æ˜¯ä¼š D å°±ä¼š F çš„ã€‚æ‰€ä»¥åªæ‰“äº† 10minã€‚</p>\n<p>é¦–å…ˆè€ƒè™‘ä¸€ä¸ªå¤§å®¶å–œé—»ä¹è§çš„ DFS æ±‚æœ€å°å­—å…¸åºã€‚æ˜¾ç„¶åœ°ï¼Œå¦‚æœå­˜åœ¨å’Œå½“å‰ä½ç›¸ç­‰çš„å­—ç¬¦ï¼Œé‚£ä¹ˆä¼˜å…ˆè·³ç›¸ç­‰å­—ç¬¦ï¼Œè¿›å…¥ä¸‹ä¸€å±‚æ·±æœï¼›å¦åˆ™æ‰¾åˆ°æœ€å°çš„æ›´å¤§å­—ç¬¦ï¼Œç„¶åç›´æ¥ outã€‚</p>\n<p>æ­¤æ—¶ SAM å°±æ˜¯æˆ‘ä»¬ç”¨æ¥åˆ¤æ–­ <span class=\"math inline\">\\(S_{l, r}\\)</span> ä¸­æ˜¯å¦å­˜åœ¨æŸçŠ¶æ€çš„å·¥å…·äº†ã€‚ç”šè‡³æ¯”ä¸Šä¸€é¢˜ç®€å•ï¼Œå› ä¸ºä¸ç”¨å†™äºŒåˆ†å’Œå€å¢ã€‚</p>\n<p>å€¼å¾—æ³¨æ„çš„æ˜¯å¦‚æœ <span class=\"math inline\">\\(S_{l, r}\\)</span> åŒ…å« <span class=\"math inline\">\\(T\\)</span> é‚£ä¹ˆè¿˜è¦åœ¨åé¢éšä¾¿åŠ ä¸€ä¸ªå­—ç¬¦ä»¥å­—å…¸åºä¿è¯ä¸¥æ ¼å¤§äº <span class=\"math inline\">\\(T\\)</span>ã€‚</p>\n<details>\n<p>å€¼å¾—æ³¨æ„çš„æ˜¯å› ä¸ºæˆ‘å†™çš„å¤ªä¸‘äº†ä»¥è‡³äºåœ¨ CF ä¸Šä¼šå…‰è£ MLE #46ã€‚ç„¶ååˆ†å±å·¦åŠè¾¹çœ‹æˆ‘ä»£ç å³åŠè¾¹å†™çš„ zwb å´æ²¡æœ‰ã€‚å•§ã€‚ä¸ºä»€ä¹ˆå‘¢ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxm = 35;\nconst int maxn = 6e5 + 5;\nconst int maxk = 8e7 + 5;\nstruct _ &#123;\n    int l, f;\n    int ne[maxm]; \n    _() &#123;&#125;\n    _(int l1, int f1): l(l1), f(f1) &#123;&#125;\n&#125;;\n_ t[maxn &lt;&lt; 1];\nint vis[maxn &lt;&lt; 1];\nint fa[maxn][maxm];\nint n, la, tot, siz;\nstruct &#123; int l, r, u; &#125; t1[maxk];\nint tab[maxn &lt;&lt; 1], cnt[maxn &lt;&lt; 1];\nvoid Init(void) &#123;\n    la = tot = 1;\n    t[1] = _(0, 0);\n    return;\n&#125;\nvoid ext(int c) &#123;\n    int p = la, np = ++tot;\n    la = tot;\n    t[np] = _(t[p].l + 1, 0);\n    while (p &amp;&amp; !t[p].ne[c])\n        t[p].ne[c] = np, p = t[p].f;\n    if (!p)\n        t[np].f = 1;\n    else &#123;\n        int q = t[p].ne[c];\n        if (t[q].l == t[p].l + 1)\n            t[np].f = q;\n        else &#123;\n            int nq = ++tot;\n            t[nq] = _(t[p].l + 1, t[q].f);\n            std::copy(t[q].ne, t[q].ne + 26, t[nq].ne);\n            while (p &amp;&amp; t[p].ne[c] == q)\n                t[p].ne[c] = nq, p = t[p].f;\n            t[q].f = nq;\n            t[np].f = nq;\n        &#125;\n    &#125;\n    return;\n&#125;\nint now = 0;\nvoid ins(int &amp;p, int l, int r, int v) &#123;\n    if (!p)\n        p = ++now;\n    ++t1[p].u;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    if (v &lt;= mid)\n        ins(t1[p].l, l, mid, v);\n    else\n        ins(t1[p].r, mid + 1, r, v);\n    return;\n&#125;\nint ask(int p, int l, int r, int ql, int qr) &#123;\n    if (ql &lt;= l &amp;&amp; r &lt;= qr)\n        return t1[p].u;\n    int mid = (l + r) &gt;&gt; 1, res = 0;\n    if (ql &lt;= mid)\n        res = ask(t1[p].l, l, mid, ql, qr);\n    if (qr &gt; mid)\n        res += ask(t1[p].r, mid + 1, r, ql, qr);\n    return res;\n&#125;\nint merge(int p, int q, int l, int r) &#123;\n    if (!p || !q)\n        return p + q;\n    int np = ++now, mid = (l + r) &gt;&gt; 1;\n    t1[np].u = t1[p].u + t1[q].u;\n    if (l == r) return np;\n    t1[np].l = merge(t1[p].l, t1[q].l, l, mid);\n    t1[np].r = merge(t1[p].r, t1[q].r, mid + 1, r);\n    return np;\n&#125;\nint pos[maxn], rt[maxn &lt;&lt; 1];\nbool check(int p, int ch, int l, int r) &#123;\n    return ask(rt[t[p].ne[ch]], 0, n - 1, l, r) &gt; 0;\n&#125;\nbool fun(std::string &amp;res, std::string now, std::string &amp;t, int x, int p, int l, int r) &#123;\n    // std::cout &lt;&lt; &quot;x = &quot; &lt;&lt; x &lt;&lt; &quot;, now = \\&quot;&quot; &lt;&lt; now &lt;&lt; &quot;\\&quot;;\\n&quot;;\n    if (x != (int)t.length() &amp;&amp; check(p, t[x] - &#39;a&#39;, l + x, r) &amp;&amp; fun(res, now + t[x], t, x + 1, ::t[p].ne[t[x] - &#39;a&#39;], l, r))\n        return 1;\n    for (int i = (x == (int)t.length()) ? 0 : t[x] - &#39;a&#39; + 1; i &lt; 26; ++i) &#123;\n        if (check(p, i, l + x, r)) &#123;\n            now += i + &#39;a&#39;;\n            res = now;\n            return 1;\n        &#125;\n    &#125;\n    return 0;\n&#125;\nstd::string solve(std::string &amp;t, int l, int r) &#123;\n    std::string res;\n    return fun(res, &quot;&quot;, t, 0, 1, l, r) ? res : &quot;-1&quot;;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n#endif\n    int q;\n    std::string s;\n    std::cin &gt;&gt; s &gt;&gt; q;\n    n = (int)s.length();\n    Init();\n    for (int i = 0; i &lt; n; ++i) &#123;\n        ext(s[i] - &#39;a&#39;);\n        pos[i] = la;\n        ins(rt[la], 0, n - 1, i);\n    &#125;\n    siz = log(tot) / log(2.0);\n    for (int i = 1; i &lt;= tot; ++i)\n        ++cnt[t[i].l];\n    std::partial_sum(cnt + 1, cnt + tot + 1, cnt + 1);\n    for (int i = 1; i &lt;= tot; ++i)\n        tab[cnt[t[i].l]--] = i;\n    for (int i = 1; i &lt;= tot; ++i) &#123;\n        int u = tab[i];\n        fa[u][0] = t[u].f;\n        for (int j = 1; j &lt;= siz; ++j)\n            fa[u][j] = fa[fa[u][j - 1]][j - 1];\n    &#125;\n    for (int i = tot; i; --i) &#123;\n        int u = tab[i];\n        if (t[u].f)\n            rt[t[u].f] = merge(rt[t[u].f], rt[u], 0, n - 1);\n    &#125;\n    while (q--) &#123;\n        int l, r;\n        std::string t;\n        std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; t;\n        std::cout &lt;&lt; solve(t, l - 1, r - 1) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"a.-å…­å‡ºç¥å±±\">A. å…­å‡ºç¥å±±</h3>\n<p><a href=\"https://www.becoder.com.cn/contest/5170/problem/1\" class=\"uri\">https://www.becoder.com.cn/contest/5170/problem/1</a></p>\n<p>æ˜¯èƒ½ç”¨è´ªå¿ƒæ‹¿ 60pts çš„ DP é¢˜ /tuu</p>\n<p>éœ€è¦å…ˆæŠŠæš´åŠ›çš„å¼å­å†™å‡ºæ¥ã€‚è®¾ <span class=\"math inline\">\\(f_{i, j}\\)</span> ä¸ºå°† <span class=\"math inline\">\\(i\\)</span> å±±ä¿®æ”¹é«˜åº¦ä¸º <span class=\"math inline\">\\(j\\)</span> çš„ä»£ä»·ï¼Œåˆ™ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{i, j} = \\min\\limits_{k\\in [j-d, j+d]}\\left\\{f_{i-1, k}\\right\\} + |h_i - j|\n\\]</span></p>\n<p>æ³¨æ„åˆ°å¯ä»¥å•è°ƒé˜Ÿåˆ—ä¼˜åŒ–ã€‚ä½†æ˜¯è¿™æ ·åšå¤æ‚åº¦è¿˜æ˜¯ <span class=\"math inline\">\\(O(nV)\\)</span> çš„ï¼Œæ ¹æœ¬åŸå› åœ¨äºç¬¬äºŒç»´è¿™ä¸ª <span class=\"math inline\">\\(V\\)</span> çš„çŠ¶æ€æ•°å¤ªå¤šäº†ã€‚</p>\n<p>æ ¹æ®ç›´è§‰ï¼Œæœ€å <span class=\"math inline\">\\(j\\)</span> çš„å€¼åº”ä¸º <span class=\"math inline\">\\(k+d\\)</span> æˆ– <span class=\"math inline\">\\(k-d\\)</span> æˆ– <span class=\"math inline\">\\(a_i\\)</span>ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºï¼Œåˆæ³•çš„çŠ¶æ€æ•°ä¸ºæ‰€æœ‰çš„ <span class=\"math inline\">\\(a_i+x\\times d, x\\in[-n, n]\\)</span>ã€‚</p>\n<details>\n<p><summary>æ­£ç¡®æ€§è¯æ˜â€¦â€¦</summary></p>\n<p>è€ƒè™‘å…¨éƒ¨æ›´æ”¹å®Œåçš„ç»“æŸçŠ¶æ€ï¼Œå³æœ€åçš„æœ€ä¼˜çŠ¶æ€ã€‚</p>\n<p>è€ƒè™‘æ‰€æœ‰å±±ä¸­æœ€çŸ®çš„å±± <span class=\"math inline\">\\(i\\)</span>ï¼Œæ­¤å±±çš„é«˜åº¦è¦ä¹ˆä¸º <span class=\"math inline\">\\(h_i\\)</span>ï¼Œè¦ä¹ˆä¸ºå‰ä¸€åº§å±±çš„é«˜åº¦ <span class=\"math inline\">\\(-d\\)</span>ï¼Œè¦ä¹ˆä¸ºåä¸€åº§å±±çš„é«˜åº¦ <span class=\"math inline\">\\(-d\\)</span>ã€‚</p>\n<p>è€ƒè™‘ç¬¬äºŒçŸ®çš„å±±ï¼Œä»¥æ­¤ç±»æ¨å³å¯ã€‚</p>\n</details>\n<p>å°†ç¬¬äºŒç»´çš„çŠ¶æ€é›†å¤§å°å‡å°‘ä¸º <span class=\"math inline\">\\(O(n^2)\\)</span>ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º <span class=\"math inline\">\\(O(n^3)\\)</span>ã€‚</p>\n<details>\n<p>éœ€æ³¨æ„åˆ°å› ä¸º <span class=\"math inline\">\\(a_i+x\\times d\\)</span> ä¸­çš„ <span class=\"math inline\">\\(x\\)</span> èŒƒå›´ä¸º <span class=\"math inline\">\\([-n, n]\\)</span> å…± <span class=\"math inline\">\\(2\\times n\\)</span>ï¼Œæ‰€ä»¥ DP æ•°ç»„ç¬¬äºŒç»´å¤§å°ä¸€å®šè¦å¼€ <span class=\"math inline\">\\(2\\times n^2\\)</span> å‘€ï¼ï¼ï¼</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nusing ll = long long;\nconst int maxn = 305;\nconst int maxm = 18e4 + 5;\nconst ll inf = 0x3f3f3f3f3f3f3f3f;\nll d;\nint n;\nll h[maxn];\nll f[maxn][maxm];\nint main() &#123;\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n    memset(f, 0x3f, sizeof (f));\n    std::cin &gt;&gt; n &gt;&gt; d;\n    std::vector&lt;ll&gt; st;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; h[i];\n        for (ll j = -n; j &lt;= n; ++j)\n            st.push_back(h[i] + j * d);\n    &#125;\n    std::sort(st.begin(), st.end());\n    st.erase(std::unique(st.begin(), st.end()), st.end());\n    auto abs = [&amp;](ll x) -&gt; ll &#123; return x &gt;= 0 ? x : -x; &#125;;\n    f[1][lower_bound(st.begin(), st.end(), h[1]) - st.begin()] = 0;\n    for (int i = 2; i &lt;= n; ++i) &#123;\n        int h(1), t(0), p(-1);\n        static int q[maxm];\n        for (int j = 0; j &lt; (int)st.size(); ++j) &#123;\n            while (p &lt; (int)st.size() &amp;&amp; st[p + 1] &lt;= st[j] + d) &#123;\n                ++p;\n                while (h &lt;= t &amp;&amp; f[i - 1][p] &lt;= f[i - 1][q[t]])\n                    --t;\n                q[++t] = p;\n            &#125;\n            while (h &lt;= t &amp;&amp; st[q[h]] &lt; st[j] - d)\n                ++h;\n            if (h &lt;= t)\n                f[i][j] = std::min(inf, f[i - 1][q[h]] + abs(st[j] - ::h[i]));\n        &#125;\n    &#125;\n    ll res = f[n][std::lower_bound(st.begin(), st.end(), h[n]) - st.begin()];\n    std::cout &lt;&lt; (res == inf ? -1 : res) &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"b.-æ°´æ·¹ä¸ƒå†›\">B. æ°´æ·¹ä¸ƒå†›</h3>\n<p><a href=\"https://www.becoder.com.cn/contest/5170/problem/2\" class=\"uri\">https://www.becoder.com.cn/contest/5170/problem/2</a></p>\n<p>å®¹æ˜“å‘ç°æœ€åè¿å‡ºæ¥ä¸€å®šæ˜¯æ²¡æœ‰ç¯çš„ã€‚æ‰€ä»¥ä¸€å®šæ˜¯ä¸€ä¸ª DAGã€‚</p>\n<p>æˆ‘ä»¬çŸ¥é“çŠ¶æ€å‹ç¼©æ˜¯ä¼šéå†åˆ°æ¯ä¸€ç§æƒ…å†µçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å‡è®¾å½“å‰çš„ DAG å°±æ˜¯è¯¥çŠ¶æ€ä¸‹çš„æœ€ä¼˜ã€‚</p>\n<p>è‡³äºè¿™ä¸ªã€Œæœ€ä¼˜ã€å¦‚ä½•å®šä¹‰å°±è¦äº¤ç»™æˆ‘ä»¬äº†ã€‚æˆ‘ä»¬ä¸å¦¨å¼ºåˆ¶è®¤ä¸ºè¿™ä¸ª DAG æ˜¯æŒ‰å±‚åºéå†å¾—åˆ°çš„ï¼Œä¹Ÿå°±æ˜¯è¯´è¿ç»­éå†åˆ°çš„ç‚¹å±äºåŒä¸€å±‚ï¼ˆè¿™é‡Œçš„å±‚æ˜¯æŒ‡æŸç‚¹åˆ°ä»»æ„æºç‚¹çš„æœ€é•¿è·¯é•¿åº¦ï¼‰ã€‚</p>\n<p>æ˜¾ç„¶åªæœ‰ä¸€ç»„ç›¸äº’ä¹‹é—´æ²¡æœ‰ä»»ä½•è¿è¾¹çš„ç‚¹æ‰èƒ½ç»„æˆåŒä¸€å±‚ã€‚ä¸å¦¨æšä¸¾ç‚¹é›†ç„¶åæš´åŠ›è½¬ç§»ï¼Œè½¬ç§»æ—¶è®°å½•è·¯å¾„å³å¯ã€‚</p>\n<details>\n<p>æ³¨æ„åˆ°åœ¨å†™è¿™ç©æ„å„¿çš„æ—¶å€™æˆ‘è¿˜ä¸ä¼š <a href=\"/2024/05/17/20240517/\">çŠ¶å‹æšä¸¾å­é›†</a>ï¼Œæ‰€ä»¥æšä¸¾å­é›†çš„éƒ¨åˆ†å¯èƒ½æ‰“å¾—æ¯”è¾ƒæŠ½è±¡ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 25;\nconst int inf = 0x3f3f3f3f;\nconst int maxm = (1 &lt;&lt; 16) + 5;\nint n, res;\nint tag[maxn][maxn];\nint f[maxn], g[maxn];\nint solve(std::vector&lt;int&gt;&amp; a) &#123;\n    static int g[maxn];\n    static int f[maxm], p[maxm];\n    int n(a.size()), siz(1 &lt;&lt; n);\n    std::fill(g, g + n, 0);\n    std::fill(p, p + siz + 1, 0);\n    std::fill(f, f + siz + 1, inf);\n    std::vector&lt;int&gt; st;\n    for (int i = 0; i &lt; n; ++i) &#123;\n        for (int j = 0; j &lt; n; ++j) &#123;\n            if (::g[a[i]] &amp; (1 &lt;&lt; a[j]))\n                g[i] |= 1 &lt;&lt; j;\n        &#125;\n    &#125;\n    for (int i = 1; i &lt; siz; ++i) &#123;\n        int now = 0;\n        for (int j = 0; j &lt; n; ++j) &#123;\n            if (i &amp; (1 &lt;&lt; j))\n                now |= g[j];\n        &#125;\n        if (!(now &amp; i))\n            st.push_back(i), f[i] = 0, p[i] = i;\n        for (auto j : st) &#123;\n            if (!(i &amp; j)) &#123;\n                if (f[i | j] &gt; f[i] + 1)\n                    f[i | j] = f[i] + 1, p[i | j] = j;\n            &#125;\n        &#125;\n    &#125;\n    int now = siz - 1;\n    while (now) &#123;\n        int fa = now ^ p[now];\n        for (int i = 0; i &lt; n; ++i)\n            if (p[now] &amp; (1 &lt;&lt; i))\n                for (int j = 0; j &lt; n; ++j)\n                    if ((fa &amp; (1 &lt;&lt; j)) &amp;&amp; tag[a[j]][a[i]] == 2)\n                        tag[a[j]][a[i]] = 1, tag[a[i]][a[j]] = -1;\n        now = fa;\n    &#125;\n    return f[siz - 1];\n&#125;\nint find(int x) &#123;\n    return x == f[x] ? x : f[x] = find(f[x]);\n&#125;\nint main() &#123;\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n    int m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; edge;\n    for (int i = 0; i &lt; n; ++i)\n        f[i] = i;\n    while (m--) &#123;\n        int x, y;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        edge.emplace_back(--x, --y);\n        f[find(x)] = find(y);\n        g[x] |= 1 &lt;&lt; y;\n        g[y] |= 1 &lt;&lt; x;\n        tag[x][y] = tag[y][x] = 2;\n    &#125;\n    std::vector&lt;int&gt; ver[maxn];\n    for (int i = 0; i &lt; n; ++i) &#123;\n        ver[find(i)].push_back(i);\n    &#125;\n    for (int i = 0; i &lt; n; ++i) &#123;\n        if (f[i] == i)\n            res = std::max(res, solve(ver[i]));\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    for (auto i : edge) &#123;\n        if (tag[i.first][i.second] == 1)\n            std::cout &lt;&lt; i.first + 1 &lt;&lt; &#39; &#39; &lt;&lt; i.second + 1 &lt;&lt; &#39;\\n&#39;;\n        else std::cout &lt;&lt; i.second + 1 &lt;&lt; &#39; &#39; &lt;&lt; i.first + 1 &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"c.-ç…®é…’è®ºè‹±é›„\">C. ç…®é…’è®ºè‹±é›„</h3>\n<p><a href=\"https://www.becoder.com.cn/contest/5170/problem/3\" class=\"uri\">https://www.becoder.com.cn/contest/5170/problem/3</a></p>\n<p>æ³¨æ„åˆ°å¦‚æœå­˜åœ¨ä¸²è¢«å…¶ä»–ä¸²åŒ…å«é‚£ä¹ˆç›´æ¥å°†å…¶æ¯™æ‰å°±å¯ä»¥äº†ã€‚</p>\n<p>å¯¹äºç›¸äº’ä¸å®Œå…¨åŒ…å«çš„ä¸²ï¼Œæˆ‘ä»¬ä»¤ <span class=\"math inline\">\\(mx_{i, j, 0/1, 0/1}\\)</span> è¡¨ç¤ºå°†æ­£åº / é€†åºçš„ <span class=\"math inline\">\\(i\\)</span> ä¸²æ‹¼åˆ°æ­£åº / é€†åºçš„ <span class=\"math inline\">\\(j\\)</span> ä¸²ä¹‹å‰ï¼Œä¸¤è€…å…±ç”¨ç›¸æ¥å…¬å…±éƒ¨åˆ†çš„ä¸²é•¿ã€‚è¿™ä¸ªå¯ä»¥ç”¨å­—ç¬¦ä¸²å“ˆå¸Œæš´åŠ›æ±‚ã€‚</p>\n<p>ç”¨çŠ¶å‹æšä¸¾æ‹¼æ¥é¡ºåºï¼Œæ±‚å¾—æœ€å°æ€»ä¸²é•¿å³å¯ã€‚</p>\n<p>æ³¨æ„å¦‚æœå»æ‰è¢«åŒ…å«ä¸²å <span class=\"math inline\">\\(n=1\\)</span> æ—¶éœ€ç›´æ¥è¾“å‡ºä¸²çš„ borderï¼›ä»¥åŠç­”æ¡ˆéœ€å’Œ <span class=\"math inline\">\\(2\\)</span> å– <span class=\"math inline\">\\(\\max\\)</span>ã€‚</p>\n<p>å®ç°èµ·æ¥åˆè‡­åˆé•¿ï¼Œä½†å®é™…ä¸Šæ€è·¯ç¡®å®éå¸¸ç®€å•ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nusing ll = long long;\nconst int p = 131;\nconst int maxn = 25;\nconst int lim = 2e4;\nconst int maxl = 2e4 + 5;\nconst int mod = 998244353;\nconst int inf = 0x3f3f3f3f;\nconst int maxm = (1 &lt;&lt; 16) + 5;\nint n;\nstd::vector&lt;std::string&gt; s;\nstd::vector&lt;std::vector&lt;ll&gt; &gt; h[2];\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n#endif\n    std::cin &gt;&gt; n;\n    s.resize(n);\n    h[0].resize(n);\n    h[1].resize(n);\n    static ll base[maxl];\n    static bool del[maxn];\n    base[0] = 1;\n    for (int i = 1; i &lt;= lim; ++i)\n        base[i] = base[i - 1] * p % mod;\n\n    for (int i = 0; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; s[i];\n        h[0][i].resize((int)s[i].length());\n        h[1][i].resize((int)s[i].length());\n        ll x = 0;\n        for (int j = 0; j &lt; (int)s[i].length(); ++j, (x *= p) %= mod)\n            h[0][i][j] = ((x += s[i][j]) %= mod);\n        std::reverse(s[i].begin(), s[i].end());\n        x = 0;\n        for (int j = 0; j &lt; (int)s[i].length(); ++j, (x *= p) %= mod)\n            h[1][i][j] = ((x += s[i][j]) %= mod);\n        std::reverse(s[i].begin(), s[i].end());\n    &#125;\n\n    std::vector&lt;int&gt; tab;\n    auto gethash = [&amp;](int i, int l, int r, bool t) -&gt; ll &#123;\n        if (l &gt; r) return 0;\n        ll res = (h[t][i][r] - (l ? h[t][i][l - 1] : 0) * base[r - l + 1] % mod);\n        return (res % mod + mod) % mod;\n    &#125;;\n    // ll now = 0;\n    // for (int i = 0; i &lt;= 4; ++i)\n    //     now = (now * p + s[1][i]) % mod;\n    // printf(&quot;now = %lld\\n&quot;, now);\n    // now = 0;\n    // for (int i = 3; i &lt;= 7; ++i)\n    //     now = (now * p + s[0][i]) % mod;\n    // printf(&quot;now = %lld\\n&quot;, now);\n    // printf(&quot;# %lld\\n&quot;, h[0][0].back());\n    for (int i = 0; i &lt; n; ++i) &#123;\n        tab.push_back(i);\n        for (int j = 0; j &lt; n; ++j)\n            if (!del[j] &amp;&amp; i != j)\n                for (int k = 0; k &lt;= ((int)s[j].length()) - ((int)s[i].length()); ++k) &#123;\n                    // printf(&quot;i = %d, j = %d, k = %d, %lld / %lld\\n&quot;, i, j, k,\n                    //         gethash(i, 0, ((int)s[i].length()) - 1, 0), gethash(j, k, k + ((int)s[i].length()) - 1, 0));\n                    if (h[0][i].back() == gethash(j, k, k + ((int)s[i].length()) - 1, 0)) &#123;\n                        tab.pop_back();\n                        del[i] = 1;\n                        goto outo;\n                    &#125;\n                &#125;\n        outo: ;\n    &#125;\n    n = (int)tab.size();\n    if (n == 1) &#123;\n        int border;\n        for (border = ((int)s[tab[0]].length()) - 1; ~border; --border) &#123;\n            if (gethash(tab[0], 0, border - 1, 0) == gethash(tab[0], ((int)s[tab[0]].length()) - border, ((int)s[tab[0]].length()) - 1, 0))\n                break;\n        &#125;\n        std::cout &lt;&lt; std::max(2, ((int)s[tab[0]].length()) - border) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    else &#123;\n        static int mx[maxn][maxn][2][2];\n        for (int i = 0; i &lt; n; ++i)\n            for (int j = 0; j &lt; n; ++j)\n                for (int a = 0; a &lt; 2; ++a)\n                    for (int b = 0; b &lt; 2; ++b)\n                        for (int k = std::min((int)s[tab[i]].length(), (int)s[tab[j]].length()); ~k; --k) &#123;\n                            if (gethash(tab[i], ((int)s[tab[i]].length()) - k, ((int)s[tab[i]].length()) - 1, a) ==\n                                                                                            gethash(tab[j], 0, k - 1, b)) &#123;\n                                mx[i][j][a][b] = (int)s[tab[j]].length() - k;\n                                // printf(&quot;%d(%d) + %d(%d) = %d, k = %d\\n&quot;, i, a, j, b, mx[i][j][a][b], k);\n                                break;\n                            &#125;\n                        &#125;\n        static int f[maxm][maxn][2];\n        memset(f, 0x3f, sizeof (f));\n\n        int siz = 1 &lt;&lt; n, res = inf;\n        f[1][0][0] = (int)s[tab[0]].length();\n        for (int i = 1; i &lt; siz; ++i)\n            for (int j = 0; j &lt; n; ++j)\n                if (i &amp; (1 &lt;&lt; j))\n                    for (int a = 0; a &lt; 2; ++a) &#123;\n                        // printf(&quot;f[%d][%d][%d] = %d\\n&quot;, i, j, a, f[i][j][a]);\n                        for (int k = 0; k &lt; n; ++k)\n                            if (!(i &amp; (1 &lt;&lt; k)))\n                                for (int b = 0; b &lt; 2; ++b)\n                                    f[i | (1 &lt;&lt; k)][k][b] = std::min(f[i | (1 &lt;&lt; k)][k][b], f[i][j][a] + mx[j][k][a][b]);\n                        if (i == siz - 1)\n                            res = std::min(res, f[i][j][a] - (int)s[tab[0]].length() + mx[j][0][a][0]);\n                    &#125;\n        \n        std::cout &lt;&lt; std::max(2, res) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"a.-ææ–‘é©¬\">A. ææ–‘é©¬</h3>\n<p><a href=\"https://www.becoder.com.cn/contest/5175/problem/1\" class=\"uri\">https://www.becoder.com.cn/contest/5175/problem/1</a></p>\n<p>æˆ‘ç”šè‡³ä¸ä¼šï¼ˆï¼‰</p>\n<p>ç¿»è½¬ + æ‹¼æ¥æœ¬è´¨ä¸Šå°±æ˜¯é¦–å°¾ç›¸æ¥ã€‚æˆ‘ä»¬æŠŠå­—ç¬¦ä¸²æ•´ä¸ªæ‹¼åˆ°è‡ªå·±åè¾¹å„¿ï¼Œç„¶åä»»å–ä¸€æ®µé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„ä¸²å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªå€’è¿‡æ¥çš„æ“ä½œåçš„å­—ç¬¦ä¸²ã€‚</p>\n<p>æ³¨æ„åˆ°å¯ä»¥æ“ä½œå¾ˆå¤šæ¬¡ã€‚ä½†æ˜¯æ—¢ç„¶æˆ‘ä»¬æ“ä½œåçš„ä¸²ä¹Ÿå¯ä»¥åœ¨è¿™ä¸ªæ‹¼æ¥åçš„ä¸²ä¸­æ‰¾åˆ°äº†ï¼Œé‚£ä¹ˆå…¶å®å¤šæ¬¡æ“ä½œåçš„ä¹Ÿè¡Œã€‚</p>\n<p>æ‰€ä»¥å‘¢æˆ‘ä»¬åœ¨æ‹¼æ¥åçš„ä¸²ç§æšä¸¾æ¯ä¸€ä¸ªé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„ä¸²è®¡ç®—ç­”æ¡ˆå³å¯ã€‚</p>\n<p>å…·ä½“æ€ä¹ˆç®—å‘¢ï¼Ÿæ³¨æ„åˆ°åªçœ‹å¼€å¤´ï¼Œä¹Ÿå°±æ˜¯åœ¨æ–°ä¸²ä¸­åªçœ‹ç¦»æˆ‘ä»¬å½“å‰æšä¸¾çš„å³ç«¯ç‚¹æœ€è¿‘çš„é‚£ä¸€æ®µï¼Œæ‰€ä»¥æˆ‘ä»¬æ‰“ä¸€ä¸ªåŒæŒ‡é’ˆï¼Œçœ‹è¿™ä¸€æ®µæ˜¯å¦åœ¨å³ç§»åä»ç„¶åˆæ³•ï¼Œå¦‚æœéæ³•å°±æŠŠç­”æ¡ˆåŒºé—´å·¦ç«¯ç‚¹æ›´æ–°ä¸ºå³ç«¯ç‚¹è‡ªå·±ã€‚ä»¥åŠæ³¨æ„åˆ°å·¦å³ç«¯ç‚¹çš„è·ç¦»ä¸èƒ½è¶…è¿‡ <span class=\"math inline\">\\(n\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint res;\nstd::string s;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n#endif\n    std::cin &gt;&gt; s;\n    int l = 0, r = -1, n = (int)s.length();\n    char la = 0;\n    s += s;\n    while (++r &lt; (int)s.length()) &#123;\n        if (s[r] == la)\n            l = r;\n        while (r - l + 1 &gt; n) ++l;\n        la = s[r];\n        res = std::max(res, r - l + 1);\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"d.-é“¾çŠ¶é—ªç”µ\">D. é“¾çŠ¶é—ªç”µ</h3>\n<p><a href=\"https://www.becoder.com.cn/contest/5175/problem/4\" class=\"uri\">https://www.becoder.com.cn/contest/5175/problem/4</a></p>\n<p>è«åå…¶å¦™ä¸”åˆè‡­åˆé•¿çš„æ ¹å·åšæ³•ã€‚</p>\n<p>å®¹æ˜“å‘ç°ä¸€ä¸ªæ€ªè¢«æ€æ‰äº†åºåˆ—å°±ä¼šè£‚å¼€æˆä¸¤æ®µè¿ç»­å­åºåˆ—ï¼Œä»¥åŠæœ€å…ˆè¢«æ€æ‰çš„æ€ªç‰©ä¸€å®šè¡€é‡æœ€å°‘ã€‚åœ¨è£‚å¼€æ¥çš„ä¸¤æ®µè¿ç»­å­åºåˆ—ä¸­ä¹Ÿæ»¡è¶³æ­¤è§„å¾‹ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>\n<p>è€ƒè™‘å¯¹åºåˆ—å»ºç«‹ç¬›å¡å°”æ ‘ã€‚ä»¤æ ‘æ ¹ä¸º <span class=\"math inline\">\\(rt\\)</span>ï¼Œå½“å‰æ”»å‡»åŠ›ä¸º <span class=\"math inline\">\\(k\\)</span>ï¼Œè®° <span class=\"math inline\">\\(t_{x, k}=\\left\\lceil \\dfrac {h_x}k \\right\\rceil\\)</span>ï¼Œå³ä¸è€ƒè™‘å…¶ä»–æ¡ä»¶æ—¶å‡»å€’ <span class=\"math inline\">\\(x\\)</span> æ‰€éœ€æ¬¡æ•°ã€‚</p>\n<p>é‚£ä¹ˆå¯¹äº <span class=\"math inline\">\\(rt\\)</span> çš„å·¦ã€å³å„¿å­ <span class=\"math inline\">\\(l,r\\)</span>ï¼Œå•è€ƒè™‘è¿™ä¸‰ä¸ªæ€ªç‰©æ‰€éœ€çš„æ€»å‡»å€’æ¬¡æ•°ï¼Œå®¹æ˜“å‘ç°ä¸º <span class=\"math inline\">\\(t_{rt,k}+(t_{l,k}-t_{rt,k})+(t_{r,k}-t_{rt,k})\\)</span>ã€‚</p>\n<p>å¯¹äº <span class=\"math inline\">\\(l\\)</span> å¼•å¯¼çš„å­æ ‘ï¼Œæ­¤æ—¶çš„å®é™…å·²æ”»å‡»æ¬¡æ•°ä¸º <span class=\"math inline\">\\(t_{l,k}\\)</span>ï¼›æ‰€ä»¥å¯¹äº <span class=\"math inline\">\\(l\\)</span> çš„å·¦å³å„¿å­ <span class=\"math inline\">\\(l&#39;,r&#39;\\)</span>ï¼Œå‡»å€’è¿™ä¸¤ä¸ªæ€ªç‰©çš„æ‰€éœ€æ¬¡æ•°ä¸º <span class=\"math inline\">\\((t_{l&#39;,k} - t_{l,k})+(t_{r&#39;,k}-t_{l,k})\\)</span>ã€‚<span class=\"math inline\">\\(r\\)</span> å¼•å¯¼çš„å­æ ‘åŒç†ã€‚</p>\n<p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“ï¼Œå¦‚æœå­˜åœ¨æ ‘è¾¹ <span class=\"math inline\">\\(u\\to v\\)</span>ï¼Œé‚£ä¹ˆå‡»å€’ <span class=\"math inline\">\\(v\\)</span> çš„æ‰€éœ€æ¬¡æ•°ä¸º <span class=\"math inline\">\\(t_{v,k}-t_{u,k}\\)</span>ï¼›ç‰¹åˆ«åœ°ï¼Œå‡»å€’ <span class=\"math inline\">\\(rt\\)</span> çš„æ‰€éœ€æ¬¡æ•°ä¸º <span class=\"math inline\">\\(t_{rt,k}\\)</span>ã€‚</p>\n<p>é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸€æ¬¡ <span class=\"math inline\">\\(O(n)\\)</span> çš„æ ‘ä¸Š DFS å¯¹äºä¸€ä¸ª <span class=\"math inline\">\\(k\\)</span> æ‰¾åˆ°ç­”æ¡ˆäº†ã€‚</p>\n<p>é‚£ä¹ˆå¯¹äº <span class=\"math inline\">\\(2\\times 10^4\\)</span> èŒƒå›´å†…çš„æ‰€æœ‰ <span class=\"math inline\">\\(k\\)</span>ï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿè¿™ä¸ªæ—¶å€™å°±è¦åˆ©ç”¨ <span class=\"math inline\">\\(t\\)</span> çš„æ€§è´¨è¿›è¡Œæ ¹å·åˆ†æ²»äº†ã€‚</p>\n<ul>\n<li><p>å¯¹äº <span class=\"math inline\">\\(k\\le \\sqrt {2\\times 10^4}\\)</span>ï¼Œæˆ‘ä»¬å¤§å¯ä»¥ç›´æ¥åšè¿™ä¹ˆå¤šæ¬¡ DFS å¾—åˆ°ç­”æ¡ˆï¼›</p></li>\n<li><p>å¯¹äº <span class=\"math inline\">\\(k&gt;\\sqrt {2\\times 10^4}\\)</span>ï¼š</p>\n<p>æˆ‘ä»¬å®¹æ˜“å‘ç°æœ€ç»ˆçš„ç»“æœæ˜¯è‹¥å¹²ä¸ª <span class=\"math inline\">\\(t\\)</span> çš„å€¼ç›¸åŠ å‡å¾—åˆ°çš„ï¼Œè€Œæ¯ä¸ª <span class=\"math inline\">\\(t\\)</span> çš„æƒå€¼ <span class=\"math inline\">\\(cnt\\)</span> å–å†³äºå…¶åœ¨ç¬›å¡å°”æ ‘ä¸Šçš„å„¿å­ä¸ªæ•°ï¼Œæœ‰å¤šå°‘å°±åœ¨ <span class=\"math inline\">\\(1\\)</span> çš„åŸºç¡€ä¸Šå‡å»å¤šå°‘ã€‚</p>\n<p>ç”±äº <span class=\"math inline\">\\(t\\)</span> å®åœ¨è¿‡äºç‰¹æ®Šï¼Œè€ƒè™‘æ•´é™¤åˆ†å— / æ•°è®ºåˆ†å—ã€‚å¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(x\\)</span>ï¼Œå¯¹äºä»»æ„ <span class=\"math inline\">\\(k&#39;\\in (\\sqrt {2\\times 10^4}, 2\\times 10^4]\\)</span>ï¼Œå¯èƒ½çš„ <span class=\"math inline\">\\(t\\)</span> å€¼åªæœ‰ <span class=\"math inline\">\\(\\sqrt {2\\times 10^4 }\\)</span> ç§ã€‚è®¡ç®—å‡ºå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(t&#39;\\)</span>ï¼Œæ»¡è¶³ <span class=\"math inline\">\\(\\left\\lceil \\dfrac {h_x}{k&#39;} \\right\\rceil=t&#39;\\)</span> çš„ <span class=\"math inline\">\\(k&#39;\\)</span> èŒƒå›´ï¼Œå¯¹è¯¥èŒƒå›´ <span class=\"math inline\">\\(k&#39;\\)</span> çš„ç­”æ¡ˆåŒºé—´åŠ ä¸Š <span class=\"math inline\">\\(t&#39;\\times cnt\\)</span> å³å¯ï¼Œå¯ä»¥ä½¿ç”¨å·®åˆ†ã€‚</p>\n<p>è‡³æ­¤ï¼Œå°±å¯ä»¥åœ¨ä¸€æ¬¡ DFS å†…è§£å†³è¿™ç§æƒ…å†µä¸‹çš„é—®é¢˜ã€‚</p></li>\n</ul>\n<p>æ€»æ—¶é—´å¤æ‚åº¦ä¸º <span class=\"math inline\">\\(O(n\\sqrt {2\\times 10^4})\\)</span>ã€‚</p>\n<details>\n<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæˆ‘åœ¨åšè¿™é“é¢˜çš„æ—¶å€™å¹¶æ²¡æœ‰æ„è¯†åˆ°è‡ªå·±ç”¨åˆ°äº†ç¬›å¡å°”æ ‘ï¼Œ</p>\n<p>æ‰€ä»¥ä»£ç ä¸­ç¬›å¡å°”æ ‘çš„å»ºæ ‘éƒ¨åˆ†å¯èƒ½é•¿å¾—ç‰¹åˆ«æŠ½è±¡ï¼ˆ</p>\n<p>è¿™é‡Œæ˜¯ä½¿ç”¨äº†ä¸‹æ ‡ä¸Šçš„ ST è¡¨å¸¦ log åœ°æ±‚è§£äº†å·¦å³å„¿å­ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxm = 35;\nconst int maxn = 1e5 + 5;\nusing ll = long long;\nll res;\nint n, k, l;\nint g[maxn][2];\nint f[maxn][maxm];\nint a[maxn], t[maxn];\nll dif[maxn], cnt[maxn];\nint ask(int l, int r) &#123;\n    if (l &gt; r) return 0;\n    int k = log(r - l + 1) / log(2.0);\n    return (a[f[l][k]] &lt; a[f[r - (1 &lt;&lt; k) + 1][k]]) ? f[l][k] : f[r - (1 &lt;&lt; k) + 1][k];\n&#125;\nvoid bld(int rt, int l, int r) &#123;\n    if (rt != l) &#123;\n        g[rt][0] = ask(l, rt - 1);\n        bld(g[rt][0], l, rt - 1);\n    &#125;\n    if (rt != r) &#123;\n        g[rt][1] = ask(rt + 1, r);\n        bld(g[rt][1], rt + 1, r);\n    &#125;\n    return;\n&#125;\n// k &lt;= sqrt(lim)\nvoid DFS(int x, int k, int fa) &#123;\n    t[x] = (a[x] + k - 1) / k;\n    res += t[x] - t[fa];\n    for (int i = 0; i &lt; 2; ++i) &#123;\n        if (g[x][i])\n            DFS(g[x][i], k, x);\n    &#125;\n    return;\n&#125;\n// k &gt; sqrt(lim)\nvoid DFS(int x, int fa) &#123;\n    ++cnt[x];\n    --cnt[fa];\n    for (int i = 0; i &lt; 2; ++i) &#123;\n        if (g[x][i])\n            DFS(g[x][i], x);\n    &#125;\n    int l = k + 1, r;\n    // æ³¨æ„è¿™é‡Œ i çš„èŒƒå›´åˆ¤å®šï¼Œå¦‚æœç›´æ¥å†™æˆ i * i &lt;= k ä¼šå°‘è®¡ç®—ä¸€äº›æƒ…å†µ\n    for (int i = 1; (i - 1) * (i - 1) &lt; k; ++i) &#123;\n        r = l - 1;\n        l = (a[x] + i - 1) / i;\n        // fprintf(stderr, &quot;%d: [%d, %d] += %d * %d\\n&quot;, a[x], l, r, cnt[x], i);\n        dif[l] += i * cnt[x], dif[r + 1] -= i * cnt[x];\n    &#125;\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n#endif\n    std::cin &gt;&gt; n;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        f[i][0] = i;\n        k = std::max(k, a[i]);\n    &#125;\n    for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)\n        for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)\n            f[i][j] = (a[f[i][j - 1]] &lt; a[f[i + (1 &lt;&lt; (j - 1))][j - 1]]) ? f[i][j - 1] : f[i + (1 &lt;&lt; (j - 1))][j - 1];\n    int rt = ask(1, n);\n    bld(rt, 1, n);\n    for (int i = 1; i * i &lt;= k; ++i) &#123;\n        res = 0;\n        DFS(rt, i, 0);\n        std::cout &lt;&lt; res &lt;&lt; &#39; &#39;;\n        l = i + 1;\n    &#125;\n    // fputs(&quot;\\n&quot;, stderr);\n    DFS(rt, 0);\n    std::partial_sum(dif + 1, dif + k + 1, dif + 1);\n    for (int i = l; i &lt;= k; ++i)\n        std::cout &lt;&lt; dif[i] &lt;&lt; &#39; &#39;;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"f.-å¼¹é£ç»µç¾Š\">F. å¼¹é£ç»µç¾Š</h3>\n<p><a href=\"https://www.becoder.com.cn/contest/5175/problem/6\" class=\"uri\">https://www.becoder.com.cn/contest/5175/problem/6</a></p>\n<p>å¾ˆæ£’å¯æŒä¹…åŒ–åˆ†å—ï¼Œä½¿æˆ‘ lxl æ—‹è½¬ã€‚</p>\n<p>ç¬‘è¯ï¼šèµ›å 5s æ‰äº¤ä¸Šå»ã€‚ç„¶å A äº†ã€‚</p>\n<p>æˆ‘ä»¬çŒœå¤§å®¶éƒ½ä¼šæ™®é€šçš„å¼¹é£ç»µç¾Šè¿™é“é¢˜ã€‚å°±æ˜¯å—é—´æš´åŠ›è·³å˜›ã€‚</p>\n<p>è¿™é‡Œç»™ä¸€ä¸ªæˆ‘è‡ªå·±æ•´çš„ç®€å•å®ç°æ–¹æ³•ã€‚</p>\n<p>æˆ‘ä»¬æŠŠåˆ†å‡ºæ¥çš„å—è§†ä½œè‹¥å¹²ä¸ªæ— å…³è”çš„æ•£å—å¹¶çº³å…¥å—é›†åˆï¼›å¯¹äºæ¯ä¸€ä¸ªç‰ˆæœ¬ï¼Œç”¨ä¸€ä¸ªå¤§å°ä¸º <span class=\"math inline\">\\(\\sqrt n\\)</span> çš„ <span class=\"math inline\">\\(id\\)</span> æ•°ç»„è®°å½•æ¯ä¸€ä½ç½®çš„å—åœ¨å—é›†åˆä¸­å¯¹åº”çš„ä½ç½®ã€‚</p>\n<p>ç„¶åè¯¥æ€ä¹ˆææ€ä¹ˆæå³å¯ã€‚</p>\n<p>P.S. zwb åšå®šä¸ç§»ä¿¡ä»° lxl ç¥æ•™äºæ˜¯å†³å®šç”¨å¯æŒä¹…åŒ–å¹³è¡¡æ ‘å®ç°å¯æŒä¹…åŒ–åˆ†å—ï¼Œç»“æœå½“ç„¶æ˜¯å› ä¸ºå¤šäº†ä¸ª <span class=\"math inline\">\\(\\log\\)</span> è¢«å¡é£äº†ï¼Œæœ€åæ°”æ€¥è´¥åæ…Œä¸æ‹©è·¯æ¼ç¾æˆæ€’æŠ„èµ·äº†æˆ‘çš„ä»£ç ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxk = 320;\nconst int maxn = 2e5 + 5;\nclass devicer &#123;\npublic:\n    int l, r;\n    std::vector&lt;int&gt; ne, u, a;\n    int &amp;nex(int x);\n    int &amp;val(int x);\n&#125;;\nint id[maxn][maxk];\nstd::vector&lt;devicer&gt; b;\nint n, q, ty, siz, k, la;\nint a[maxn], tab[maxn], blk[maxn];\nvoid upd(int x, int a, devicer &amp;p) &#123;\n    if (x + a &gt; n)\n        p.nex(x) = -1, p.val(x) = 1;\n    else if (x + a &gt; p.r)\n        p.nex(x) = x + a, p.val(x) = 1;\n    else\n        p.nex(x) = p.nex(x + a), p.val(x) = p.val(x + a) + 1;\n    // printf(&quot;x = %d, a = %d, r = %d, upd ne[%d] to %d\\n&quot;, x, a, p.r, x, p.nex(x));\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr);\n    std::cout.tie(nullptr);\n#endif\n    std::cin &gt;&gt; n &gt;&gt; q &gt;&gt; ty;\n    siz = sqrt(n);\n    k = (n + siz - 1) / siz;\n    b.resize(k);\n    int la = 0, now = k - 1;\n    for (auto &amp;i : b)\n        i.l = la + 1, la = i.r = i.l + siz - 1;\n    b.back().r = n;\n    for (int i = 0; i &lt; k; ++i) &#123;\n        id[0][i] = i;\n        b[i].a.resize(b[i].r - b[i].l + 1);\n        b[i].u.resize(b[i].r - b[i].l + 1);\n        b[i].ne.resize(b[i].r - b[i].l + 1);\n        for (int j = b[i].l; j &lt;= b[i].r; ++j)\n            tab[j] = j - b[i].l, blk[j] = i;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; b[blk[i]].a[tab[i]];\n    for (int i = n; i; --i)\n        upd(i, b[blk[i]].a[tab[i]], b[blk[i]]);\n    int ver = 0;\n    while (q--) &#123;\n        int op, pr, x;\n        static int res = 0;\n        std::cin &gt;&gt; op &gt;&gt; pr &gt;&gt; x;\n        if (!ty)\n            res = 0;\n        x ^= res;\n        if (op == 1) &#123;\n            std::copy(id[pr], id[pr] + k, id[++ver]);\n            b.push_back(b[id[ver][blk[x]]]);\n            id[ver][blk[x]] = ++now;\n            std::cin &gt;&gt; b.back().a[tab[x]];\n            b.back().a[tab[x]] ^= res;\n            for (int i = x; i &gt;= b.back().l; --i)\n                upd(i, b.back().a[tab[i]], b.back());\n        &#125;\n        else &#123;\n            int p = x;\n            res = 0;\n            while (~p) &#123;\n                // printf(&quot;p = %d\\n&quot;, p);\n                res += b[id[pr][blk[p]]].u[tab[p]];\n                p = b[id[pr][blk[p]]].ne[tab[p]];\n            &#125;\n            std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n        &#125;\n    &#125;\n    return 0;\n&#125;\nint&amp; devicer::nex(int x) &#123;\n    return ne[tab[x]];\n&#125;\nint&amp; devicer::val(int x) &#123;\n    return u[tab[x]];\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "DP",
                "çŠ¶å‹",
                "SAM",
                "åˆ†å—",
                "å¯æŒä¹…åŒ–",
                "ç¬›å¡å°”æ ‘"
            ]
        }
    ]
}