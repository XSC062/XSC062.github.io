{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"å€å¢\" tag",
    "description": "",
    "home_page_url": "https://xsc062.netlify.app",
    "items": [
        {
            "id": "https://xsc062.netlify.app/20250924/",
            "url": "https://xsc062.netlify.app/20250924/",
            "title": "æœ€çŸ­è·¯ç»ƒä¹ ",
            "date_published": "2025-09-24T06:27:15.000Z",
            "content_html": "<p>æœ€çŸ­è·¯ä¸ºèƒŒæ™¯çš„é¢˜ + åšæ³•æ˜¯æœ€çŸ­è·¯çš„é¢˜</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a---minimum-path\">A - Minimum Path</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1473E\" class=\"uri\">https://www.luogu.com.cn/problem/CF1473E</a></p>\n<ul>\n<li>ç»å…¸å¥—è·¯ï¼Œå‘ç°å¯ä»¥æŠŠ max å’Œ min æ¢æˆä»»æ„è·¯å¾„ä¸­çš„è¾¹ï¼Œç„¶å max å’Œ min å°±ä¼šæœ€å°åŒ–è¿™ä¸ªå¼å­</li>\n<li>æ•…å†™ä¸€ä¸ª Dijkstra + DPï¼Œæ±‚è¿™ä¸ªå¼å­çš„æœ€å°å€¼å³å¯</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    using arr = std::vector&lt;long long&gt;;\n    using brr = std::vector&lt;arr&gt;;\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);\n    std::vector&lt;brr&gt; dis(2, brr(2, arr(n + 1, 1e18))), vis(2, brr(2, arr(n + 1)));\n    for (int x, y, w; m--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;\n        g[x].emplace_back(y, w);\n        g[y].emplace_back(x, w);\n    &#125;\n    dis[0][0][1] = 0;\n    std::array&lt;std::array&lt;std::priority_queue&lt;std::pair&lt;long long, int&gt; &gt;, 2&gt;, 2&gt; q;\n    q[0][0].emplace(0, 1);\n    for (int i = 0; i &lt; 2; ++i) &#123;\n        for (int j = 0; j &lt; 2; ++j) &#123;\n            for (; !q[i][j].empty(); ) &#123;\n                int f = q[i][j].top().second;\n                q[i][j].pop();\n                if (vis[i][j][f])\n                    continue;\n                vis[i][j][f] = 1;\n                for (auto k : g[f]) &#123;\n                    if (dis[i][j][k.first] &gt; dis[i][j][f] + k.second) &#123;\n                        dis[i][j][k.first] = dis[i][j][f] + k.second;\n                        q[i][j].emplace(-dis[i][j][k.first], k.first);\n                    &#125;\n                    if (!i &amp;&amp; dis[1][j][k.first] &gt; dis[i][j][f]) &#123;\n                        dis[1][j][k.first] = dis[i][j][f];\n                        q[1][j].emplace(-dis[1][j][k.first], k.first);\n                    &#125;\n                    if (!j &amp;&amp; dis[i][1][k.first] &gt; dis[i][j][f] + 2 * k.second) &#123;\n                        dis[i][1][k.first] = dis[i][j][f] + 2 * k.second;\n                        q[i][1].emplace(-dis[i][1][k.first], k.first);\n                    &#125;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n    for (int i = 2; i &lt;= n; ++i)\n        std::cout &lt;&lt; std::min(&#123; dis[0][0][i], dis[1][1][i] &#125;) &lt;&lt; &#39; &#39;;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---train-delay\">B - Train Delay</h2>\n<p><a href=\"https://vjudge.net/contest/750645#problem/B\" class=\"uri\">https://vjudge.net/contest/750645#problem/B</a></p>\n<ul>\n<li>ç®€åŒ–é¢˜ç›®å¾ˆé‡è¦çš„ä¸€ä¸ªè½¬åŒ–æ˜¯<strong>ç”±äº <span class=\"math inline\">\\(S\\le T\\)</span> å¸¦æ¥çš„ <span class=\"math inline\">\\(S\\)</span> å’Œ <span class=\"math inline\">\\(T\\)</span> åœ°ä½å¹³ç­‰ï¼Œè€ƒè™‘æŠŠå‡ºå‘å’Œåˆ°è¾¾åˆ†åˆ«çœ‹ä½œä¸€æ¬¡äº‹ä»¶å¤„ç†ã€‚</strong></li>\n<li><p>æŒ‰ç…§æ‰€æœ‰äº‹ä»¶çš„å‘ç”Ÿæ—¶åˆ»æ’åºï¼Œæœ‰ï¼š</p>\n<ul>\n<li>å¯¹äºä¸€æ¬¡å‡ºå‘äº‹ä»¶ï¼Œå¯ä»¥å¾—åˆ°åœ¨å…¶ä¹‹å‰è¯¥ç«™ç‚¹æ‰€æœ‰åˆ°è¾¾äº‹ä»¶çš„ <span class=\"math inline\">\\(\\max\\{T&#39;\\}\\)</span>ï¼Œç”¨ä¹‹æ›´æ–° <span class=\"math inline\">\\(X\\)</span> å³å¯ã€‚</li>\n<li>å¯¹äºä¸€æ¬¡åˆ°è¾¾äº‹ä»¶ï¼Œç”±äºå¯¹åº”çš„ <span class=\"math inline\">\\(X\\)</span> å·²ç»ç¡®å®šï¼Œæ›´æ–°è¯¥ç«™ç‚¹å½“å‰æœ€å¤§å€¼å³å¯ã€‚</li>\n</ul></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; d(m + 1);\n    std::cin &gt;&gt; d[1];\n    struct event &#123;\n        int t, op, id, x;\n    &#125;;\n    std::vector&lt;event&gt; a;\n    std::vector&lt;int&gt; mx(n + 1);\n    for (int i = 1, x, y, s, t; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; s &gt;&gt; t;\n        a.push_back(&#123; s, 0, i, x &#125;);\n        a.push_back(&#123; t, 1, i, y &#125;);\n    &#125;\n    std::sort(a.begin(), a.end(), [&amp;](event &amp;x, event &amp;y) &#123; return x.t == y.t ? x.op &gt; y.op : x.t &lt; y.t; &#125;);\n    for (auto [t, op, id, x] : a)\n        if (op == 1)\n            mx[x] = std::max(mx[x], t + d[id]);\n        else if (id != 1)\n            d[id] = std::max(mx[x] - t, 0);\n    for (int i = 2; i &lt;= m; ++i)\n        std::cout &lt;&lt; d[i] &lt;&lt; &#39; &#39;;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---complete-the-graph\">C - Complete The Graph</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF715B\" class=\"uri\">https://www.luogu.com.cn/problem/CF715B</a></p>\n<p>ç¥ä»™äºŒåˆ†</p>\n<ul>\n<li>å¦‚æœåˆå§‹æŠŠæ‰€æœ‰ç™½è¾¹ç½®ä¸º <span class=\"math inline\">\\(1\\)</span>ï¼Œé‚£ä¹ˆä¼šæƒ³åˆ°è°ƒæ•´æ³•æ„é€ </li>\n<li>ä½†æ˜¯ä¸çŸ¥é“åº”è¯¥åœ¨å“ªäº›è¾¹ä¸Šè°ƒæ•´ï¼Œç¡®å®šè°ƒæ•´å¤šå°‘ä¼¼ä¹ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç®€å•çš„åšæ³•</li>\n<li><p>æ•…<strong>å¹³å‡ç”¨åŠ›</strong>ï¼Œæ„é€ ä¸€ä¸ª è¾¹1 += 1ï¼Œè¾¹2 += 1ï¼Œè¾¹3 += 1, â€¦, è¾¹cnt0 += 1, è¾¹1 += 1, è¾¹2 += 1, â€¦ çš„æ“ä½œåºåˆ—</p>\nå®¹æ˜“<strong>å‘ç°æ¯æ¬¡æ“ä½œæœ€å¤šè®©å½“å‰æœ€çŸ­è·¯é•¿åº¦å¢åŠ  1</strong>ï¼Œè€Œä¸”æœ‰å•è°ƒæ€§</li>\n<li><p>æ•…äºŒåˆ†ç­”æ¡ˆå³å¯</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst __int128 inf = 1e18;\nconst __int128 inff = 1e23;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m, s, t, l, cnt = 0;\n    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; l &gt;&gt; s &gt;&gt; t, ++s, ++t;\n    std::vector&lt;std::tuple&lt;int, int, long long&gt; &gt; u(m + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, long long&gt; &gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt;= m; ++i) &#123;\n        long long w;\n        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w, ++x, ++y;\n        if (w == 0)\n            w = -(++cnt);\n        g[x].emplace_back(y, w), g[y].emplace_back(x, w);\n        u[i] = &#123; x, y, w &#125;;\n    &#125;\n    std::vector&lt;int&gt; vis(n + 1);\n    std::vector&lt;__int128&gt; dis(n + 1);\n    std::vector&lt;long long&gt; k(cnt + 1);\n    __int128 res = -1;\n    auto check = [&amp;](__int128 x) &#123;\n        for (int i = 1; i &lt;= cnt; ++i)\n            k[i] = x / cnt + (i &lt;= x % cnt);\n        std::fill(vis.begin() + 1, vis.end(), 0);\n        std::fill(dis.begin() + 1, dis.end(), inf);\n        std::priority_queue&lt;std::pair&lt;__int128, int&gt; &gt; q;\n        dis[s] = 0, q.emplace(0, s);\n        for (; !q.empty(); ) &#123;\n            int f = q.top().second;\n            q.pop();\n            if (vis[f])\n                continue;\n            vis[f] = 1;\n            for (auto [v, w] : g[f]) &#123;\n                if (w &lt; 0)\n                    w = k[-w];\n                if (dis[v] &gt; dis[f] + w) &#123;\n                    dis[v] = dis[f] + w;\n                    q.emplace(-dis[v], v);\n                &#125;\n            &#125;\n        &#125;\n        return dis[t] &lt;= l;\n    &#125;;\n    for (__int128 l = cnt, r = cnt * inf, mid; l &lt;= r; ) &#123;\n        mid = (l + r) &gt;&gt; 1;\n        if (check(mid))\n            res = mid, l = mid + 1;\n        else\n            r = mid - 1;\n    &#125;\n    if (res == -1)\n        std::cout &lt;&lt; &quot;NO\\n&quot;;\n    else &#123;\n        check(res);\n        if (dis[t] != l)\n            std::cout &lt;&lt; &quot;NO\\n&quot;;\n        else &#123;\n            std::cout &lt;&lt; &quot;YES\\n&quot;;\n            for (int i = 1; i &lt;= m; ++i) &#123;\n                auto [x, y, w] = u[i];\n                if (w &lt; 0)\n                    w = k[-w];\n                std::cout &lt;&lt; x - 1 &lt;&lt; &#39; &#39; &lt;&lt; y - 1 &lt;&lt; &#39; &#39; &lt;&lt; w &lt;&lt; &#39;\\n&#39;;\n            &#125;\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a---é‡åŠ›çƒ\">A - é‡åŠ›çƒ</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7473\" class=\"uri\">https://www.luogu.com.cn/problem/P7473</a></p>\n<ul>\n<li><span class=\"math inline\">\\(m\\)</span> ç›¸å¯¹å¾ˆå°ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆåŸºäº <span class=\"math inline\">\\(m\\)</span> çš„åšæ³•</li>\n<li>æ¯æ¬¡çƒåœä¸‹çš„ä½ç½®ä¸€å®šæ˜¯æŸä¸ªéšœç¢ç‰©ï¼ˆæˆ–è¾¹ç•Œï¼‰ä¸Š / ä¸‹ / å·¦ / å³çš„æ ¼å­ï¼Œæ•…å¯ä»¥åœ¨è¿™ <span class=\"math inline\">\\(O(n + m)\\)</span> ä¸ªç‚¹ä¸Šå»ºå›¾</li>\n<li>æ€ä¹ˆåŒæ—¶ç»´æŠ¤ä¸¤ä¸ªçƒçš„ä¿¡æ¯å‘¢ï¼Œå‘ç° <span class=\"math inline\">\\(m\\)</span> è¿˜æ˜¯å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥æŠŠä¸¤ä¸ªçƒå¡ä¸€èµ·ä½œä¸ºä¸€ä¸ªçŠ¶æ€</li>\n<li><p><span class=\"math inline\">\\(m^2\\)</span> æ¬¡ Dij è¿˜æ˜¯å¤ªæ¿€è¿›äº† è¿›ä¸€æ­¥æ€è€ƒå‘ç°å¯èƒ½çš„ç»ˆç‚¹å…± <span class=\"math inline\">\\(m\\)</span> ä¸ª å¹¶ä¸”å½¼æ­¤ä¸åŒºåˆ†</p>\n<p>æ•…ä»¥è¿™ <span class=\"math inline\">\\(m\\)</span> ä¸ªç»ˆç‚¹è·‘å¤šæºæœ€çŸ­è·¯å³å¯</p>\n<p>ä½† 5e6 è·‘ Dij è¿˜æ˜¯å¤ªå‹‰å¼ºäº†ã€‚<strong>å‘ç°è¾¹æƒä¸º 1ï¼Œä¸ºä»€ä¹ˆä¸ BFS å‘¢ ğŸ˜…</strong></p></li>\n<li><p>å‘ç°èµ·ç‚¹å¯èƒ½ä¸åœ¨æˆ‘ä»¬é™å®šçš„ç‚¹ä¸Šï¼Œä½†å¯ä»¥äººä¸ºé€‰æ‹©ä¸€æ¬¡é‡åŠ›æ–¹å‘ï¼Œç„¶åå°±å›åˆ°åˆšåˆšçš„é—®é¢˜äº†</p>\n<p>æˆ–è€…ç¦»çº¿ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•</p></li>\n</ul>\n<p>ç–‘ä¼¼å¸¸æ•°å¤ªå¤§ï¼Œæ‹¼å°½å…¨åŠ›å‹‰å¼ºå¡è¿‡</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int LEN = (1 &lt;&lt; 20);\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf)\n            return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF)\n            return 0;\n        if (ch == &#39;-&#39;)\n            f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f)\n        x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0) &#123;\n        putchar(&#39;-&#39;);\n        x = -x;\n    &#125;\n    if (x &gt;= 10)\n        print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x);\n    putchar(ch);\n    return;\n&#125;\nconst int inf = 0x3f3f3f3f;\nconst int dir[][2] = &#123;&#123; -1, 0 &#125;, &#123; 1, 0 &#125;, &#123; 0, -1 &#125;, &#123; 0, 1 &#125;&#125;;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m, q;\n    read(n), read(m), read(q);\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; pos(m + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; a(n + 1, std::vector&lt;int&gt; (n + 1));\n    for (int i = 1, x, y; i &lt;= m; ++i) &#123;\n        read(x), read(y);\n        pos[i] = &#123; x, y &#125;, a[x][y] = -1;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        pos.emplace_back(0, i), ++m;\n    for (int i = 1; i &lt;= n; ++i)\n        pos.emplace_back(i, n + 1), ++m;\n    for (int i = 1; i &lt;= n; ++i)\n        pos.emplace_back(n + 1, i), ++m;\n    for (int i = 1; i &lt;= n; ++i)\n        pos.emplace_back(i, 0), ++m;\n    int cnt = 0;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; u(1);\n    for (int i = 1; i &lt;= m; ++i)\n        for (auto [fx, fy] : dir) &#123;\n            int nx = pos[i].first + fx, ny = pos[i].second + fy;\n            if (nx &gt;= 1 &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= 1 &amp;&amp; ny &lt;= n &amp;&amp; !a[nx][ny])\n                a[nx][ny] = ++cnt, u.emplace_back(nx, ny);\n        &#125;\n    std::vector&lt;std::vector&lt;std::array&lt;int, 4&gt; &gt; &gt; top(n + 1, std::vector&lt;std::array&lt;int, 4&gt; &gt; (n + 1));\n    for (int j = 1; j &lt;= n; ++j) &#123;\n        for (int i = 1; i &lt;= n; ++i)\n            if (a[i][j] != -1) &#123;\n                if (i == 1 || a[i - 1][j] == -1)\n                    top[i][j][0] = a[i][j];\n                else\n                    top[i][j][0] = top[i - 1][j][0];\n            &#125;\n        for (int i = n; i; --i)\n            if (a[i][j] != -1) &#123;\n                if (i == n || a[i + 1][j] == -1)\n                    top[i][j][1] = a[i][j];\n                else\n                    top[i][j][1] = top[i + 1][j][1];\n            &#125;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (int j = 1; j &lt;= n; ++j)\n            if (a[i][j] != -1) &#123;\n                if (j == 1 || a[i][j - 1] == -1)\n                    top[i][j][2] = a[i][j];\n                else\n                    top[i][j][2] = top[i][j - 1][2];\n            &#125;\n        for (int j = n; j; --j)\n            if (a[i][j] != -1) &#123;\n                if (j == n || a[i][j + 1] == -1)\n                    top[i][j][3] = a[i][j];\n                else\n                    top[i][j][3] = top[i][j + 1][3];\n            &#125;\n    &#125;\n    const int N = cnt * cnt;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(N + 1);\n    auto encode = [&amp;](int x, int y) &#123;\n        return (x - 1) * cnt + y;\n    &#125;;\n    auto decode = [&amp;](int id) &#123;\n        return std::make_pair((id - 1) / cnt + 1, (id - 1) % cnt + 1);\n    &#125;;\n    for (int i = 1; i &lt;= N; ++i)\n        for (int j = 0; j &lt; 4; ++j) &#123;\n            auto [a, b] = decode(i);\n            g[encode(top[u[a].first][u[a].second][j], top[u[b].first][u[b].second][j])].emplace_back(i);\n        &#125;\n    std::vector&lt;int&gt; dis(N + 1, inf), vis(N + 1);\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 1; i &lt;= cnt; ++i)\n            dis[encode(i, i)] = 0, q.push(encode(i, i)), vis[encode(i, i)] = 1;\n        for (; !q.empty(); ) &#123;\n            int x = q.front();\n            q.pop();\n            for (auto i : g[x])\n                if (!vis[i])\n                    dis[i] = dis[x] + 1, vis[i] = 1, q.push(i);\n        &#125;\n    &#125;\n    for (int a, b, c, d; q--; ) &#123;\n        read(a), read(b), read(c), read(d);\n        if (a == c &amp;&amp; b == d)\n            print(0, &#39;\\n&#39;);\n        else &#123;\n            int res = inf;\n            for (int j = 0; j &lt; 4; ++j)\n                res = std::min(res, dis[encode(top[a][b][j], top[c][d][j])] + 1);\n            if (res == inf)\n                print(-1, &#39;\\n&#39;);\n            else\n                print(res, &#39;\\n&#39;);\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---çŸ©é˜µæ¸¸æˆ\">B - çŸ©é˜µæ¸¸æˆ</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7515\" class=\"uri\">https://www.luogu.com.cn/problem/P7515</a></p>\n<ul>\n<li><p>æŠŠé—®é¢˜å½¢å¼åŒ–ä¸€ä¸‹ï¼Œç°åœ¨æœ‰ <span class=\"math inline\">\\(n\\times m\\)</span> ä¸ªæœªçŸ¥æ•°å’Œ <span class=\"math inline\">\\((n-1)\\times (m-1)\\)</span> ä¸ªæ–¹ç¨‹</p>\n<p>é‚£ä¹ˆå¯ä»¥å¯¹è¾¹ä¸Šä¸€åœˆä»»æ„èµ‹å€¼ï¼Œé™åˆ¶æ˜¯å·¦ä¸Šè§’è¿™ <span class=\"math inline\">\\((n-1)\\times (m-1)\\)</span> ä¸ªæœªçŸ¥æ•°å¿…é¡»è½åœ¨ <span class=\"math inline\">\\([0,10^6]\\)</span> ä¸Š</p></li>\n<li>æœ‰ä¸€ä¸ªå¾ˆå®¹æ˜“è§‚å¯Ÿåˆ°çš„æ€§è´¨ï¼Œå¯¹äºä¸€ä¸ª <span class=\"math inline\">\\(a\\)</span>ï¼Œé€‰å–ä¸€ä¸ª <span class=\"math inline\">\\(v\\)</span>ï¼Œå¹¶æŠŠæ£‹ç›˜é»‘ç™½æŸ“è‰²ï¼Œé‚£ä¹ˆæŠŠæ‰€æœ‰é»‘æ ¼ <span class=\"math inline\">\\(+=v\\)</span>ï¼Œç™½æ ¼ <span class=\"math inline\">\\(-=v\\)</span>ï¼Œå¯¹åº”çš„ <span class=\"math inline\">\\(b\\)</span> æ˜¯ä¸ä¼šå˜çš„ã€‚</li>\n<li><p><strong>è¿™ä¸ªæ“ä½œæ˜¯æ¶‰åŠå…¨å±€çš„ï¼Œå¤ªè‹›åˆ»äº†</strong>ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´ mild çš„æ„é€ ï¼Ÿ</p>\n<p>å‘ç°åªå¯¹ä¸€è¡Œ / åˆ—é»‘ç™½æŸ“è‰²å¹¶æ“ä½œä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚èƒ½æ„Ÿå—åˆ°<strong>æ“ä½œæ— æ³•å†ç®€åŒ–äº†</strong>ã€‚è€ƒè™‘ç”¨è¿™ä¸ªç‰ˆæœ¬çš„æ“ä½œ<strong>è°ƒæ•´</strong>ã€‚</p></li>\n<li>æ•…å¤§åŠ›ä»¤å‘¨å›´ä¸€åœˆçš„ä¸´æ—¶è§£ <span class=\"math inline\">\\(a&#39;\\)</span> ä¸º <span class=\"math inline\">\\(0\\)</span>ï¼Œä»¤æ¯è¡Œã€åˆ—çš„è°ƒæ•´ delta ä¸º <span class=\"math inline\">\\(r_i,c_i\\)</span>ï¼Œå¯ä»¥å¾—åˆ°è‹¥å¹²ä¸ªå…³äº <span class=\"math inline\">\\(0\\)</span> å’Œ <span class=\"math inline\">\\(10^6\\)</span> çš„çº¦æŸã€‚æœ€åå»ºå‡ºæ¥ä¸€ä¸ªå®Œå…¨äºŒåˆ†å›¾çŠ¶ç‰©ï¼Œè·‘å·®åˆ†çº¦æŸå³å¯ï¼Œå®¹æ˜“å‘ç°å¤æ‚åº¦æ­£ç¡®ã€‚</li>\n<li><p>å®ç°æŠ€å·§ï¼šè§„åˆ’ä¸€ä¸‹ <span class=\"math inline\">\\(r\\)</span> å’Œ <span class=\"math inline\">\\(c\\)</span> çš„æŸ“è‰²æ–¹å¼ï¼Œä½¿å¾—å®ƒä»¬é”™å¼€ï¼Œå¯ä»¥æŠŠæ‰€æœ‰ä½ç½®éƒ½å†™ä½œ <span class=\"math inline\">\\(a&#39;_{i,j}+c-r\\)</span> æˆ– <span class=\"math inline\">\\(a&#39;_{i,j}+r-c\\)</span> çš„å½¢å¼ï¼Œä¾¿äºå·®åˆ†çº¦æŸ</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code></code></pre>\n</details>\n<hr />\n<h2 id=\"c---tax\">C - Tax</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P6822\" class=\"uri\">https://www.luogu.com.cn/problem/P6822</a></p>\n<ul>\n<li>å®¹æ˜“æƒ³åˆ°åˆ†ç±»è®¨è®ºï¼Œå¦‚æœé’¦å®šæ˜¯å…¥è¾¹è´¡çŒ®è¾¹æƒï¼Œé‚£ä¹ˆå‡ºè¾¹è¾¹æƒä¸èƒ½å¤§äºå…¥è¾¹è¾¹æƒï¼›å¦åˆ™ï¼Œå‡ºè¾¹è´¡çŒ®è¾¹æƒã€‚</li>\n<li>è€ƒè™‘æŠŠæ¯ä¸ªç‚¹ä¸Šçš„å‡ºè¾¹æŒ‰è¾¹æƒä»å°åˆ°å¤§æ’åºï¼Œæ˜¾ç„¶éœ€è¦å…¥è¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µå‰ç¼€ï¼Œéœ€è¦å‡ºè¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µåç¼€ï¼Œå°±å¯ä»¥åšä¸€ä¸ªå‰åç¼€ä¼˜åŒ–å»ºå›¾ã€‚</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    struct edge &#123; int v, w, id, pi, si; &#125;;\n    std::vector&lt;std::vector&lt;edge&gt; &gt; g1(n + 2);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(1);\n    int cnt = 0;\n    for (int x, y, w; m--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;\n        g1[x].push_back(&#123; y, w, ++cnt, 0, 0 &#125;);\n        g1[y].push_back(&#123; x, w, ++cnt, 0, 0 &#125;);\n        g.emplace_back(), g.emplace_back();\n    &#125;\n    int s = ++cnt, t = ++cnt;\n    g1[0].push_back(&#123; 1, 0, s, 0, 0 &#125;), g1[n].push_back(&#123; n + 1, 0, t, 0, 0 &#125;);\n    g.emplace_back(), g.emplace_back();\n    for (int i = 0; i &lt;= n + 1; ++i)\n        if (!g1[i].empty()) &#123;\n            std::sort(g1[i].begin(), g1[i].end(), [&amp;](edge &amp;x, edge &amp;y) &#123; return x.w &lt; y.w; &#125;);\n            for (int j = 0; j &lt; (int)g1[i].size(); ++j) &#123;\n                g1[i][j].pi = ++cnt, g.emplace_back();\n                if (j != 0)\n                    g[cnt].emplace_back(cnt - 1, 0);\n                g[cnt].emplace_back(g1[i][j].id, 0);\n            &#125;\n            for (int j = (int)g1[i].size() - 1; ~j; --j) &#123;\n                g1[i][j].si = ++cnt, g.emplace_back();\n                if (j != (int)g1[i].size() - 1)\n                    g[cnt].emplace_back(cnt - 1, 0);\n                g[cnt].emplace_back(g1[i][j].id, g1[i][j].w);\n            &#125;\n        &#125;\n    for (int i = 0; i &lt;= n + 1; ++i)\n        for (auto &amp;[v, w, id, pi, si] : g1[i]) &#123;\n            auto to = std::upper_bound(g1[v].begin(), g1[v].end(), w, [&amp;](int x, edge &amp;y) &#123; return x &lt; y.w; &#125;);\n            if (to != g1[v].end())\n                g[id].emplace_back(to-&gt;si, 0);\n            if (to != g1[v].begin())\n                g[id].emplace_back((--to)-&gt;pi, w);\n        &#125;\n    std::vector&lt;int&gt; vis(cnt + 1, 0);\n    std::vector&lt;long long&gt; dis(cnt + 1, inf);\n    std::priority_queue&lt;std::pair&lt;long long, int&gt; &gt; q;\n    dis[s] = 0, q.emplace(0, s);\n    for (; !q.empty(); ) &#123;\n        int f = q.top().second;\n        q.pop();\n        if (vis[f])\n            continue;\n        vis[f] = 1;\n        for (auto [v, w] : g[f])\n            if (dis[v] &gt; dis[f] + w) &#123;\n                dis[v] = dis[f] + w;\n                q.emplace(-dis[v], v);\n            &#125;\n    &#125;\n    std::cout &lt;&lt; dis[t] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---travelling-through-the-snow-queens-kingdom\">D - Travelling Through the Snow Queenâ€™s Kingdom</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF685E\" class=\"uri\">https://www.luogu.com.cn/problem/CF685E</a></p>\n<p>ç›®å‰è§è¿‡çš„æ•°æ®èŒƒå›´æç¤ºæ€§æå¼±ï¼ˆè¯¯å¯¼æ€§æå¼ºï¼‰çš„å¾ªç¯ç»“æ„é¢˜ï¼š</p>\n<ul>\n<li>[BZOJ3620] ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­</li>\n<li><a href=\"/20240906/#å­—ç¬¦åˆå¹¶\">å­—ç¬¦åˆå¹¶</a></li>\n<li><a href=\"/20250907/#e---subset-product-problem\">[ARC205E] Subset Product Problem</a></li>\n</ul>\n<p>æ­£èµ›å› ä¸ºæœ‰éƒ¨åˆ†åˆ†ï¼Œåº”è¯¥ä¸ä¼šå‡ºç°ä¸æ•¢å†™çš„é—®é¢˜</p>\n<ul>\n<li>è€ƒè™‘ç¦»çº¿è¯¢é—®ï¼Œé€†åºåŠ è¾¹ï¼›åŸæ–‡æ— è¾¹æƒï¼›è¾¹çš„é€šè¡Œæ—¶åˆ»åªå†³å®šåˆ°è¾¾ç‚¹çš„æ—¶åˆ»ã€‚</li>\n<li><p>å€Ÿé‰´ <a href=\"/20231113/#b.-å•†äºº\">merchant</a> ä¸­çš„æ€è·¯ï¼Œåªéœ€è¦æ›´æ–°å½“å‰è¾¹ä¸¤ä¾§ç‚¹ä¸ºèµ·ç‚¹çš„ DP æ•°ç»„ã€‚</p>\n<p>éœ€è¦æ³¨æ„è¾¹ä»æŸç§æ„ä¹‰ä¸Šè¯´æ˜¯ã€æœ‰å‘ã€çš„ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 0x3f3f3f3f;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m, q;\n    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;\n    struct query &#123; int r, s, t, id; &#125;;\n    std::vector&lt;int&gt; res(q + 1);\n    std::vector&lt;std::vector&lt;query&gt; &gt; u(m + 1);\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; e(m + 1);\n    for (int i = 1; i &lt;= m; ++i)\n        std::cin &gt;&gt; e[i].first &gt;&gt; e[i].second;\n    for (int i = 1, l, r, s, t; i &lt;= q; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; s &gt;&gt; t;\n        u[l].push_back(&#123; r, s, t, i &#125;);\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1, std::vector&lt;int&gt; (n + 1, inf));\n    for (int i = m; i; --i) &#123;\n        auto [x, y] = e[i];\n        g[x][y] = g[y][x] = i;\n        for (int j = 1; j &lt;= n; ++j)\n            g[x][j] = g[y][j] = std::min(g[x][j], g[y][j]);\n        for (auto [r, s, t, id] : u[i])\n            if (g[s][t] &lt;= r)\n                res[id] = 1;\n    &#125;\n    for (int i = 1; i &lt;= q; ++i)\n        std::cout &lt;&lt; (res[i] ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---culture-code\">E - Culture Code</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1197E\" class=\"uri\">https://www.luogu.com.cn/problem/CF1197E</a></p>\n<ul>\n<li>å…ˆæŒ‰ <span class=\"math inline\">\\(out\\)</span> æ’åºï¼Œåšä¸€ä¸ªå‰ç¼€ä¼˜åŒ–å»ºå›¾ã€‚</li>\n<li><p>å®¹æ˜“å‘ç°é™¤äº†æœ€å¤–å±‚ï¼Œæ¯ä¸€ä¸ªå¥—å¨ƒéƒ½ä¼šæä¾› <span class=\"math inline\">\\(in_i-out_i\\)</span> çš„ä»£ä»·ï¼Œè€Œæœ€å¤–å±‚ä¼šæä¾› <span class=\"math inline\">\\(in_x\\)</span> çš„ä»£ä»·ã€‚</p>\n<del>å¥½åœ¨è¦æ±‚çš„æ˜¯æœ€é•¿è·¯ï¼Œè¿™æ ·å°±å¯ä»¥ Dij äº†</del>ï¼Œå¹¶ä¸éœ€è¦çœŸæ­£æŠŠå›¾å»ºå‡ºæ¥ï¼Œå‘ç°è¿™ä¸ªå½¢å¼æ›´åºåˆ—ï¼Œç›´æ¥åœ¨åºåˆ—ä¸ŠäºŒåˆ†å‰ç¼€ + DP å³å¯ã€‚</li>\n<li><p>æ±‚æ–¹æ¡ˆæ˜¯å®¹æ˜“çš„ã€‚æœ€åç»Ÿè®¡ DP å€¼æœ€å¤§ï¼Œ<strong>ä¸”ä¸èƒ½è¢«å…¶ä»–å¥—å¨ƒåŒ…å«çš„å…ƒç´ </strong>å³å¯ã€‚</p>\n<p>Tipï¼šåœ¨æ±‚è§£è¿‡ç¨‹ä¸­å¹¶ä¸ç”¨è€ƒè™‘å½“å‰å…ƒç´ å’Œå‰ç¼€ min å…ƒç´ é—´èƒ½å¦åŠ å…¥å…¶ä»–å¥—å¨ƒï¼Œå› ä¸ºä¿è¯ <span class=\"math inline\">\\(out&gt;in\\)</span>ï¼Œå¦‚æœå­˜åœ¨è¿™æ ·çš„å¥—å¨ƒï¼Œå…¶ DP å€¼ä¼šæ¯”å‰ç¼€ min æ›´å°ï¼ŒçŸ›ç›¾ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; a(n + 1);\n    int mxi = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i].first &gt;&gt; a[i].second;\n        mxi = std::max(mxi, a[i].second);\n    &#125;\n    std::sort(a.begin() + 1, a.end());\n    std::vector&lt;long long&gt; g(n + 1), mxg(n + 1), f(n + 1), mx(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        int j = std::upper_bound(a.begin() + 1, a.begin() + i, std::make_pair(a[i].second, 0x3f3f3f3f)) - a.begin() - 1;\n        if (j == 0)\n            f[i] = a[i].second, g[i] = 1ll;\n        else\n            f[i] = mx[j] + a[i].second, g[i] = mxg[j];\n        long long now = f[i] - a[i].first;\n        if (now &lt; mx[i - 1])\n            mx[i] = now, mxg[i] = g[i];\n        else if (now == mx[i - 1])\n            mx[i] = now, mxg[i] = (mxg[i - 1] + g[i]) % mod;\n        else\n            mx[i] = mx[i - 1], mxg[i] = mxg[i - 1];\n    &#125;\n    auto now = 0x3f3f3f3fll, res = 0ll;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (a[i].first &lt;= mxi)\n            continue;\n        if (f[i] &lt; now)\n            now = f[i], res = g[i];\n        else if (f[i] == now)\n            (res += g[i]) %= mod;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a---awesome-arrowland-adventure\">A - Awesome Arrowland Adventure</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P6233\" class=\"uri\">https://www.luogu.com.cn/problem/P6233</a></p>\n<ul>\n<li>æ²¡ä»€ä¹ˆå¥½è¯´çš„å»ºå›¾ï¼Œæ³¨æ„åªèƒ½é¡ºæ—¶é’ˆè½¬</li>\n<li>ä»£ç ç•¥</li>\n</ul>\n<hr />\n<h2 id=\"b---åœ°é“çº¿è·¯\">B - åœ°é“çº¿è·¯</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P6096\" class=\"uri\">https://www.luogu.com.cn/problem/P6096</a></p>\n<ul>\n<li>è€ƒè™‘åšä¸€ä¸ªç¥ç§˜æ‹†ç‚¹ï¼ŒæŠŠæ¯ä¸ªç‚¹é™„ä¸Šçº¿è·¯å’Œè¿è¡Œæ–¹å‘çš„ä¿¡æ¯ï¼ˆæ‰€ä»¥æ˜¯å•å‘çš„ï¼‰</li>\n<li>è®¤ä¸ºè·¯å¾„ä»£ä»·æ˜¯äºŒå…ƒç»„ï¼Œé‚£ä¹ˆåŒæ¡çº¿è·¯ä¸­çš„ç‚¹é€šè¡Œä»£ä»·ä¸º <span class=\"math inline\">\\((0,-1)\\)</span></li>\n<li>æ¢ä¹˜éœ€è¦ä¼˜åŒ–å»ºå›¾ï¼Œæ¯ä¸ªç‚¹å¯ä»¥èŠ± <span class=\"math inline\">\\((0,0)\\)</span> çš„ä»£ä»·èµ°åˆ°è¿™ä¸ªç‚¹çš„ã€æ¢ä¹˜ç‚¹ã€ï¼Œå†èŠ± <span class=\"math inline\">\\((1,0)\\)</span> çš„ä»£ä»·èµ°åˆ°å¦ä¸€ä¸ªåˆ†ç‚¹</li>\n<li><p>ä½† <strong>15 å¹´çš„æ—¶å€™ SPFA å·²ç»æ­»äº†</strong>ï¼Œæ‰€ä»¥éœ€è¦å¥½å¥½è€ƒè™‘æ€ä¹ˆå®ç°æœ€çŸ­è·¯ã€‚</p>\n<p>åˆ†ä¸¤é—®æ˜¯æœ‰æç¤ºæ€§åœ¨çš„ï¼Œå¯ä»¥æƒ³åˆ° 01 BFS è§£å†³ç¬¬ä¸€ä¸ªå…³é”®å­—ï¼Œæ¯”è¾ƒå¯¹çš„æƒ³æ³•æ˜¯<strong>æŠŠæ‰€æœ‰æœ€çŸ­è·¯æ‹¿å‡ºæ¥å½¢æˆ DAGï¼Œåœ¨ DAG ä¸Šå¯¹ç¬¬äºŒå…³é”®å­— DP</strong>ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; m &gt;&gt; n;\n    std::unordered_map&lt;std::string, int&gt; tab;\n    std::vector&lt;std::vector&lt;int&gt; &gt; l(n + 1);\n    std::vector&lt;std::vector&lt;std::tuple&lt;int, int, int&gt; &gt; &gt; g0(n + 1), g1(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::string s;\n        std::cin &gt;&gt; s, tab[s] = i;\n    &#125;\n    int tot = n;\n    for (int i = 1, k; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; k;\n        int lp = 0, lq = 0;\n        for (std::string s; k--; ) &#123;\n            std::cin &gt;&gt; s;\n            int p = ++tot, q = ++tot, id = tab[s];\n            g0.emplace_back(), g0.emplace_back();\n            g1.emplace_back(), g1.emplace_back();\n            if (lp) &#123;\n                g0[p].emplace_back(lp, 0, 1), g0[lq].emplace_back(q, 0, 1);\n                g1[lp].emplace_back(p, 0, 1), g1[q].emplace_back(lq, 0, 1);\n            &#125;\n            g0[p].emplace_back(id, 0, 0), g0[id].emplace_back(p, 1, 0);\n            g1[id].emplace_back(p, 0, 0), g1[p].emplace_back(id, 1, 0);\n            g0[q].emplace_back(id, 0, 0), g0[id].emplace_back(q, 1, 0);\n            g1[id].emplace_back(q, 0, 0), g1[q].emplace_back(id, 1, 0);\n            l[id].push_back(p), l[id].push_back(q);\n            lp = p, lq = q;\n        &#125;\n    &#125;\n    int s, t;\n    &#123;\n        std::string s1, s2;\n        std::cin &gt;&gt; s1 &gt;&gt; s2;\n        s = ++tot, t = tab[s2];\n        g0.emplace_back(), g1.emplace_back();\n        int p = tab[s1];\n        for (auto i : l[p])\n            g0[s].emplace_back(i, 1, 0), g1[i].emplace_back(s, 1, 0);\n    &#125;\n    std::vector&lt;int&gt; dis0(tot + 1, 0x3f3f3f3f), dis1(tot + 1, 0x3f3f3f3f);\n    auto BFS = [&amp;](decltype(g0) &amp;g, decltype(dis0) &amp;dis, int s) &#123;\n        std::deque&lt;int&gt; q;\n        std::vector&lt;int&gt; vis(tot + 1);\n        q.push_back(s), dis[s] = 0;\n        for (; !q.empty(); ) &#123;\n            int x = q.front();\n            q.pop_front();\n            if (vis[x])\n                continue;\n            vis[x] = 1;\n            for (auto [v, w1, w2] : g[x])\n                if (dis[x] + w1 &lt; dis[v]) &#123;\n                    dis[v] = dis[x] + w1;\n                    if (w1 == 0)\n                        q.push_front(v);\n                    else\n                        q.push_back(v);\n                &#125;\n        &#125;\n        return;\n    &#125;;\n    BFS(g0, dis0, s), BFS(g1, dis1, t);\n    std::cout &lt;&lt; dis0[t] &lt;&lt; &#39;\\n&#39;;\n    std::vector&lt;int&gt; deg(tot + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(tot + 1);\n    for (int i = 1; i &lt;= tot; ++i)\n        for (auto [j, w1, w2] : g0[i])\n            if (dis0[i] + dis1[j] + w1 == dis0[t])\n                g[i].emplace_back(j, w2), ++deg[j];\n    std::queue&lt;int&gt; q;\n    for (int i = 1; i &lt;= tot; ++i)\n        if (!deg[i])\n            q.push(i);\n    std::vector&lt;int&gt; f(tot + 1);\n    for (; !q.empty(); ) &#123;\n        int x = q.front();\n        q.pop();\n        for (auto [v, w] : g[x]) &#123;\n            f[v] = std::max(f[v], f[x] + w);\n            if (!--deg[v])\n                q.push(v);\n        &#125;\n    &#125;\n    std::cout &lt;&lt; f[t] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---droga-do-domu\">C - Droga do domu</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P9402\" class=\"uri\">https://www.luogu.com.cn/problem/P9402</a></p>\n<ul>\n<li>è¿˜æ˜¯åšä¸€ä¸ªå’Œä¸Šä¸€é¢˜ç±»ä¼¼çš„ä¼˜åŒ–å»ºå›¾</li>\n<li>æ­¤å¤–å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ Dij ä¸Š DP äº†ã€‚<strong>å›¾æ²¡æœ‰ç¯</strong>ï¼Œç›´æ¥æ‹“æ‰‘å³å¯ã€‚</li>\n<li>å¯ä»¥æ»šåŠ¨ä¼˜åŒ–ç©ºé—´ï¼Œä½†ä¼¼ä¹å¹¶æ— å¿…è¦ã€‚ä»£ç ç•¥ã€‚</li>\n</ul>\n<hr />\n<h2 id=\"d---tickets-p\">D - Tickets P</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7984\" class=\"uri\">https://www.luogu.com.cn/problem/P7984</a></p>\n<ul>\n<li>æ²¡ä»€ä¹ˆå¥½è¯´çš„çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œéš¾ç‚¹åœ¨äºå¦‚ä½•åŒæ—¶è·å– <span class=\"math inline\">\\(1\\)</span> å’Œ <span class=\"math inline\">\\(N\\)</span> çš„ä¿¡æ¯</li>\n<li><p>å‘ç°ä»æŸä¸ªç‚¹èµ°åˆ° <span class=\"math inline\">\\(1\\)</span> å’Œ <span class=\"math inline\">\\(N\\)</span>ï¼Œæœ‰ä¸€ç§ä¸åŠ£çš„èµ°æ³•ï¼š</p>\n<img src=\"image.png\" /></li>\n<li><p>ç»´æŠ¤ä¸€ä¸‹æ¯ä¸ªç‚¹å•ç‹¬èµ°åˆ° <span class=\"math inline\">\\(1\\)</span>ï¼Œ<span class=\"math inline\">\\(N\\)</span> çš„æœ€å°ä»£ä»·å’ŒåŒæ—¶èµ°åˆ° <span class=\"math inline\">\\(1,N\\)</span> çš„æœ€å°ä»£ä»·</p>\nçœ‹åˆ°ä¸€ç§æ›´åŠ å¯¹çš„å†™æ³•æ˜¯<strong>ä»¤ <span class=\"math inline\">\\(f_u\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(v\\)</span> çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ <span class=\"math inline\">\\(f_v+w(u,v)\\)</span> æ›´æ–° <span class=\"math inline\">\\(f_u\\)</span></strong>ã€‚</li>\n<li><p>é‚£ä¹ˆå¯ä»¥ä» <span class=\"math inline\">\\(1,N\\)</span> å‡ºå‘åšä¸€ä¸ª Dijã€‚ä»£ç ç•¥ã€‚</p></li>\n</ul>\n<hr />\n<h2 id=\"e---ç›‘ç‹±\">E - ç›‘ç‹±</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P9520\" class=\"uri\">https://www.luogu.com.cn/problem/P9520</a></p>\n<ul>\n<li><p>æ³¨æ„è¦èµ°ç®€å•è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨ç»•è·¯è®©é“çš„å¯èƒ½æ€§ã€‚å®¹æ˜“æ¨å‡ºï¼šè‹¥è¾“å…¥åˆæ³•ï¼Œæ€»èƒ½æ‰¾åˆ°ä¸€ç§æ–¹å¼ä½¿å¾—æ¯ä¸ªäººå—åˆ°çš„æŒ‡ä»¤æ˜¯è¿ç»­ç»™å‡ºçš„ã€‚</p>\n<p>P.S. è¿™ä¸ªç»“è®ºæŒªåˆ°å›¾ä¸Šå°±ä¸æˆç«‹äº†ï¼Œå¾ˆå®¹æ˜“ä¸¾å‡ºåä¾‹ã€‚</p>\n<p><img src=\"image-1.png\" /></p></li>\n<li>è‹¥ä¸€ä¸ªäººçš„èµ·ç‚¹ / ç»ˆç‚¹åœ¨å¦ä¸€ä¸ªäººçš„è·¯å¾„ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªäººä¹‹é—´å­˜åœ¨å…ˆåå…³ç³»ã€‚å»ºå›¾åæ£€æŸ¥æ˜¯å¦ä¸º DAG å³å¯ã€‚</li>\n<li><p>ä½†å»ºå›¾æ˜¾ç„¶æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œå®¹æ˜“æ„é€ å‡ºæ•°æ®ä½¿å¾—è¾¹æ•°æ¥åˆ° <span class=\"math inline\">\\(n^2\\)</span> çº§åˆ«ã€‚è€ƒè™‘ä¼˜åŒ–å»ºå›¾ã€‚</p>\n<p>å‘ç°å¯ä»¥ç”¨ä¸€ä¸ªæ ‘å‰– / å€å¢çš„ç»“æ„æ¥å»ºå›¾ã€‚</p>\nTipsï¼šè¿™ä¸€ç‚¹åŒæ ·æ˜¯ä¸€ä¸ªæ ‘ä¸Šè·¯å¾„é—®é¢˜ã€‚å‚è§ <a href=\"/20231117/#æ ‘ä¸Šé—®é¢˜\">æ ‘ä¸Šé—®é¢˜ï¼Œå€å¢å’Œæ ‘å‰–çš„é€‰æ‹©ï¼Ÿ</a></li>\n<li><p>è¿™é‡Œçš„è·¯å¾„è¦æ±‚ä¸¤ç«¯éƒ½æ˜¯å¼€çš„ï¼Œè¿™å°±å¯¼è‡´å€å¢å†™ç€å¾ˆå›°éš¾ï¼ˆè™½ç„¶æ ‘å‰–å¯èƒ½ä¹Ÿæ˜¯ï¼‰ï¼Œä¸æ’é™¤æˆ‘å†™ä¸‘äº†</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int K = 19;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;01-02.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n, m;\n        std::cin &gt;&gt; n;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n        std::vector&lt;int&gt; s(n + 1), t(n + 1);\n        for (int i = 1, x, y; i &lt; n; ++i) &#123;\n            std::cin &gt;&gt; x &gt;&gt; y;\n            g1[x].push_back(y), g1[y].push_back(x);\n        &#125;\n        std::cin &gt;&gt; m;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g(m + 1);\n        std::vector&lt;std::pair&lt;int, int&gt; &gt; a(m + 1);\n        for (int i = 1; i &lt;= m; ++i) &#123;\n            std::cin &gt;&gt; a[i].first &gt;&gt; a[i].second;\n            s[a[i].first] = i;\n            t[a[i].second] = i;\n        &#125;\n        int cnt = m;\n        struct node &#123; int fa, i0, i1; &#125;;\n        std::vector&lt;std::array&lt;node, K + 1&gt; &gt; p(n + 1);\n        std::vector&lt;int&gt; i0(n + 1), i1(n + 1), dep(n + 1), deg(m + 1);\n        auto init = [&amp;](void) &#123;\n            g.emplace_back(), deg.emplace_back();\n            return ++cnt;\n        &#125;;\n        auto add = [&amp;](int x, int y) &#123;\n            g[x].push_back(y), ++deg[y];\n            return;\n        &#125;;\n        for (int i = 1; i &lt;= n; ++i)\n            i0[i] = init(), i1[i] = init();\n        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n            if (s[x])\n                add(s[x], i1[x]);\n            if (t[x])\n                add(i0[x], t[x]);\n            for (auto i : g1[x])\n                if (i != fa) &#123;\n                    dep[i] = dep[x] + 1;\n                    p[i][0].fa = x;\n                    p[i][0].i0 = init(), p[i][0].i1 = init();\n                    add(p[i][0].i0, i0[i]), add(i1[i], p[i][0].i1);\n                    for (int j = 1; j &lt;= K; ++j) &#123;\n                        p[i][j].fa = p[p[i][j - 1].fa][j - 1].fa;\n                        if (!p[i][j].fa)\n                            break;\n                        p[i][j].i0 = init(), p[i][j].i1 = init();\n                        add(p[i][j].i0, p[i][j - 1].i0);\n                        add(p[i][j].i0, p[p[i][j - 1].fa][j - 1].i0);\n                        add(p[i][j - 1].i1, p[i][j].i1);\n                        add(p[p[i][j - 1].fa][j - 1].i1, p[i][j].i1);\n                    &#125;\n                    DFS(i, x);\n                &#125;\n            return;\n        &#125;;\n        dep[1] = 1, DFS(1, -1);\n        for (int i = 1; i &lt;= m; ++i) &#123;\n            auto [x, y] = a[i];\n            if (x == y)\n                continue;\n            if (t[x])\n                add(i, t[x]);\n            if (s[y])\n                add(s[y], i);\n            if (dep[x] &lt; dep[y])\n                std::swap(x, y);\n            x = p[x][0].fa;\n            if (dep[x] &gt;= dep[y]) &#123;\n                for (int j = K; ~j; --j)\n                    if (dep[p[x][j].fa] &gt;= dep[y]) &#123;\n                        add(i, p[x][j].i0), add(p[x][j].i1, i);\n                        x = p[x][j].fa;\n                    &#125;\n                if (x == y)\n                    continue;\n                add(i, p[x][0].i0), add(p[x][0].i1, i);\n                x = p[x][0].fa;\n            &#125;\n            y = p[y][0].fa;\n            if (x != y) &#123;\n                for (int j = K; ~j; --j)\n                    if (p[x][j].fa != p[y][j].fa) &#123;\n                        add(i, p[x][j].i0), add(i, p[y][j].i0);\n                        add(p[x][j].i1, i), add(p[y][j].i1, i);\n                        x = p[x][j].fa, y = p[y][j].fa;\n                    &#125;\n                add(i, p[x][0].i0), add(i, p[y][0].i0);\n                add(p[x][0].i1, i), add(p[y][0].i1, i);\n                x = p[x][0].fa;\n            &#125;\n            add(i, i0[x]), add(i1[x], i);\n        &#125;\n        std::queue&lt;int&gt; q;\n        for (int i = 1; i &lt;= cnt; ++i)\n            if (!deg[i])\n                q.push(i);\n        int tot = 0;\n        for (; !q.empty(); ) &#123;\n            int x = q.front();\n            q.pop(), ++tot;\n            for (auto i : g[x])\n                if (!--deg[i])\n                    q.push(i);\n        &#125;\n        std::cout &lt;&lt; (tot == cnt ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "DP",
                "äºŒåˆ†",
                "å€å¢",
                "è°ƒæ•´æ³•",
                "æœ€çŸ­è·¯"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250824/",
            "url": "https://xsc062.netlify.app/20250824/",
            "title": "æ‚é¢˜",
            "date_published": "2025-08-24T07:37:55.000Z",
            "content_html": "<p>ä¸ä¼šçš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šäº†</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"b.-k-set-tree\">B. K-Set Tree</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1691F\" class=\"uri\">https://www.luogu.com.cn/problem/CF1691F</a></p>\n<p>ä»¤ <span class=\"math inline\">\\(F_i\\)</span> è¡¨ç¤ºä»¥ <span class=\"math inline\">\\(1\\)</span> ä¸ºæ ¹æ—¶ï¼Œ<span class=\"math inline\">\\(S\\)</span> åœ¨ <span class=\"math inline\">\\(i\\)</span> å­æ ‘å†…çš„ç­”æ¡ˆã€‚åˆ™ï¼š</p>\n<p><span class=\"math display\">\\[\nF_u=\\left(C_{siz_u}^k-\\sum C_{siz_v}^k\\right)\\cdot siz_u+\\sum F_v\\\\\n\\]</span></p>\n<p>ç›´æ¥æ¢æ ¹æ˜¯å¾ˆå¤æ‚çš„ï¼›æŠŠ <span class=\"math inline\">\\(\\sum C_{siz_v}^k\\)</span> è®°ä½œ <span class=\"math inline\">\\(dp_u\\)</span>ï¼ŒæŠŠ <span class=\"math inline\">\\(\\sum F_v\\)</span> è®°ä½œ <span class=\"math inline\">\\(f_u\\)</span>ï¼Œé‚£ä¹ˆï¼š</p>\n<p><span class=\"math display\">\\[\nres=\\sum(C_n^k-dp_u)\\cdot n+f_u\\\\\n\\]</span></p>\n<p><strong>è¿™æ ·åšæ˜¯ä¸ºäº†æŠŠä¸¤ä¸ªå’Œ <span class=\"math inline\">\\(v\\)</span> æœ‰å…³çš„ä¹˜é¡¹æ‹†å¼€æ¥æ¢æ ¹</strong>ï¼Œå®é™…æ¢æ ¹çš„æ—¶å€™å°±åªç”¨åˆ†åˆ«æ¢ <span class=\"math inline\">\\(f,dp\\)</span> ä¸¤ä¸ªå€¼ï¼Œä¸ç”¨è€ƒè™‘äºŒæ¬¡é¡¹ç­‰é—®é¢˜ï¼Œè®¡ç®—é‡ä¼šå°‘å¾ˆå¤š</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, k;\n    std::cin &gt;&gt; n &gt;&gt; k;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[n] = qkp(fac[n], mod - 2);\n    for (int i = n - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        if (m &gt; n)\n            return 0ll;\n        return fac[n] * inv[m] % mod * inv[n - m] % mod;\n    &#125;;\n    auto res(0ll);\n    std::vector&lt;int&gt; siz(n + 1), ss(n + 1);\n    std::vector&lt;long long&gt; f(n + 1), dp(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        siz[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                (f[x] += (C(siz[i], k) - dp[i]) * siz[i] + f[i]) %= mod;\n                (dp[x] += C(siz[i], k)) %= mod;\n                siz[x] += siz[i];\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    DFS = [&amp;](int x, int fa) &#123;\n        (res += (C(n, k) - dp[x]) * n + f[x]) %= mod;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                (f[i] += (C(n - siz[i], k) - (dp[x] - C(siz[i], k))) * (n - siz[i]) + f[x] - f[i] - (C(siz[i], k) - dp[i]) * siz[i]) %= mod;\n                (dp[i] += C(n - siz[i], k)) %= mod;\n                DFS(i, x);\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::cout &lt;&lt; (res + mod) % mod &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c.-li-hua-and-path\">C. Li Hua and Path</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1797F\" class=\"uri\">https://www.luogu.com.cn/problem/CF1797F</a></p>\n<p>è€ƒè™‘<strong>å®¹æ–¥</strong>ï¼Œåˆ†åˆ«æ±‚è§£æ»¡è¶³ 1ã€æ»¡è¶³ 2ã€æ»¡è¶³ 12ï¼ˆæ³¨æ„è¦å‡ä¸¤å€ï¼‰å°±èƒ½è®¡ç®—ç­”æ¡ˆ</p>\n<p>å‘ç°é¢˜ç›®æ‰€æ±‚ç‚¹å¯¹å½¢å¼å¾ˆç¬¦åˆ Kruskal é‡æ„æ ‘çš„è¦æ±‚ï¼Œè€ƒè™‘ä»¥å¯¹åº”ç‚¹æƒä¸ºè¾¹æƒï¼Œåˆ†åˆ«å»ºç«‹ minï¼Œmax Kruskal ç‚¹æƒå¤šå‰é‡æ„æ ‘ã€‚</p>\n<details>\n<p><summary>ç‚¹æƒå¤šå‰é‡æ„æ ‘ï¼Ÿ</summary></p>\n<p>åœ¨ç‚¹æƒä¸Šåš Kruskal é‡æ„æ ‘æ—¶ï¼Œå‘ç°è¾¹çš„è™šç‚¹æ˜¯ä¸å¿…è¦çš„ï¼Œå¯ä»¥ç›´æ¥å°†æ›´ä¼˜ç‚¹ä½œä¸ºçˆ¶äº²ã€‚</p>\n<p>å†™çš„æ—¶å€™æœ‰ç‚¹éš¾æƒ³æ¸…æ¥šâ€¦â€¦ å¯ä»¥ç”»ç”»å›¾ï¼Œä»”ç»†ç¡®å®šä¸€ä¸‹ Kruskal é‡æ„æ ‘çš„å…·ä½“æ€§è´¨</p>\n<p>è¿™æ ·åšçš„ä¼˜åŠ¿æ˜¯æ²¡æœ‰è™šç‚¹ï¼Œä¸€äº›é—®é¢˜ä¼šæ–¹ä¾¿ä¸€äº›ï¼›ä½†åŒæ—¶æ”¾å¼ƒäº†äºŒå‰æ ‘çš„ç»“æ„ï¼Œä¸€äº›é¢˜å¯èƒ½æ²¡é‚£ä¹ˆå¥½åšã€‚</p>\n<p>è¿™é“é¢˜åªç”¨ç»å…¸ Kruskal é‡æ„æ ‘ä¹Ÿå¯ä»¥è§£å†³ã€‚</p>\n</details>\n<p>å‘ç° 1 2 å‡å¯ä»¥è½¬åŒ–æˆä¸¤æ£µæ ‘åœ¨ä¸¤æ£µæ ‘ä¸Šçš„ç¥–å­™å…³ç³»è¦æ±‚ï¼Œå¯ä»¥è½»æ¾åœ°åˆ†åˆ«ç»Ÿè®¡æ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„ç‚¹å¯¹æ•°é‡</p>\n<p>è€ƒè™‘æ€ä¹ˆå¤„ç†åŒæ—¶æ»¡è¶³ 12 çš„ï¼Œå‘ç°è¦æ±‚åœ¨ä¸¤æ£µæ ‘ä¸ŠäºŒè€…åº”è¯¥éƒ½å…·æœ‰ç¥–å­™å…³ç³»ï¼Œä¸”æ˜¯ç›¸åçš„ã€‚<del>å¯ä»¥è€ƒè™‘åœ¨ä¸€æ£µæ ‘ä¸Š DFS çš„åŒæ—¶ç”¨ä¸»å¸­æ ‘å­˜å‚¨ç¥–å…ˆï¼Œåœ¨å¦ä¸€é¢—æ ‘ä¸Š ask</del></p>\n<p>è€ƒè™‘ä»æ›´å®¹æ˜“ç”¨ dfn è¡¨ç¤ºçš„å­æ ‘é—®é¢˜æ€è€ƒï¼Œåœ¨ min æ ‘ä¸Šåˆ†é… dfn åï¼Œåœ¨ max æ ‘ä¸Šç”¨ DFS + å›æº¯å¾—åˆ°æ¯ä¸ªç‚¹å®æ—¶ç¥–å…ˆåºåˆ—ï¼Œå­˜åœ¨æ ‘çŠ¶æ•°ç»„é‡Œï¼›ask è¯¥ç‚¹è¢«åˆ†é…çš„ dfn å­æ ‘åŒºé—´å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚</p>\n<p>è€ƒè™‘è¯¢é—®ï¼Œç”±äºæ¯æ¬¡åŠ å…¥çš„éƒ½æ˜¯ç¼–å·æœ€å¤§çš„ç‚¹ï¼Œå¯¹äºæ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„è´¡çŒ®æ˜¯æ˜¾ç„¶çš„ï¼Œè€ŒåŒæ—¶æ»¡è¶³ 12 çš„ç‚¹å°±æ˜¯åœ¨ min æ ‘ä¸Šçš„ç¥–å…ˆï¼Œéƒ½æ˜¯å¥½åšçš„ã€‚</p>\n<p>å®ç°çš„æ—¶å€™ä¸€å®šè¦æŠŠ min / max æ ‘å¯¹åº”çš„æ€§è´¨æ€è€ƒæ¸…æ¥šï¼Œä¸ç„¶ä¼šå¾ˆéº»çƒ¦</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; f1(n + 1), f2(n + 1);\n    std::iota(f1.begin() + 1, f1.end(), 1);\n    std::iota(f2.begin() + 1, f2.end(), 1);\n    std::function&lt;int(int)&gt; find1 = [&amp;](int x) &#123;\n        return x == f1[x] ? x : f1[x] = find1(f1[x]);\n    &#125;;\n    std::function&lt;int(int)&gt; find2 = [&amp;](int x) &#123;\n        return x == f2[x] ? x : f2[x] = find2(f2[x]);\n    &#125;;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1), g2(n + 1), adj1(n + 1), adj2(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        if (x &gt; y)\n            std::swap(x, y);\n        adj1[y].push_back(x);\n        adj2[x].push_back(y);\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        for (auto j : adj1[i]) &#123;\n            int fi = find1(i), fj = find1(j);\n            g1[fi].push_back(fj), f1[fj] = fi;\n        &#125;\n    for (int i = n; i; --i)\n        for (auto j : adj2[i]) &#123;\n            int fi = find2(i), fj = find2(j);\n            g2[fi].push_back(fj), f2[fj] = fi;\n        &#125;\n    std::vector&lt;int&gt; bit(n + 1), dfn(n + 1), rfn(n + 1);\n    auto lowbit = [](int x) &#123;\n        return x &amp; -x;\n    &#125;;\n    auto add = [&amp;](int x, int v) &#123;\n        for (; x &lt;= n; x += lowbit(x))\n            bit[x] += v;\n        return;\n    &#125;;\n    auto ask = [&amp;](int x) &#123;\n        int res = 0;\n        for (; x; x -= lowbit(x))\n            res += bit[x];\n        return res;\n    &#125;;\n    int rt1 = 0, rt2 = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (f1[i] == i)\n            rt1 = i;\n        if (f2[i] == i)\n            rt2 = i;\n    &#125;\n    int q;\n    std::cin &gt;&gt; q;\n    std::vector&lt;int&gt; dep1(n + 1), dep2(n + q + 1);\n    long long res = 0ll;\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now;\n        res += dep1[x];\n        for (auto i : g1[x]) &#123;\n            dep1[i] = dep1[x] + 1;\n            DFS(i);\n        &#125;\n        rfn[x] = now;\n        return;\n    &#125;;\n    DFS(rt1);\n    DFS = [&amp;](int x) &#123;\n        res += dep2[x];\n        res -= 2 * (ask(rfn[x]) - ask(dfn[x] - 1));\n        add(dfn[x], 1);\n        for (auto i : g2[x]) &#123;\n            dep2[i] = dep2[x] + 1;\n            DFS(i);\n        &#125;\n        add(dfn[x], -1);\n        return;\n    &#125;;\n    DFS(rt2);\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    for (int fa; q--; ) &#123;\n        std::cin &gt;&gt; fa;\n        dep2[++n] = dep2[fa] + 1;\n        res += (n - 1) - dep2[n];\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-å›¢é˜Ÿé€‰æ‹”\">D. å›¢é˜Ÿé€‰æ‹”</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6534/problem/4\" class=\"uri\">http://222.180.160.110:61235/contest/6534/problem/4</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œä»ä¸­ä»»é€‰ä¸€äº›äº’ä¸ç›¸äº¤çš„åŒºé—´ï¼Œæ»¡è¶³æ¯ä¸ªåŒºé—´å†…å…ƒç´ çš„ gcd ç›¸åŒã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 10^5,V\\le 10^7\\)</span>ã€‚</p>\n</blockquote>\n<p>æ³¨æ„åˆ°å›ºå®šä¸€ä¸ªå·¦ç«¯ç‚¹åï¼Œç§»åŠ¨å³ç«¯ç‚¹ï¼Œgcd æ¯æ¬¡è‡³å¤šå‡å°åˆ°åŸæ¥çš„ä¸€åŠï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ç§ç±»æœ‰ <span class=\"math inline\">\\(\\log V\\)</span> ç§ã€‚æ•…å…¨åºåˆ—çš„ gcd æ€»æ•°æ˜¯ <span class=\"math inline\">\\(O(n\\log V)\\)</span> çš„ã€‚</p>\n<p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸æ­¤åŸç†ç±»ä¼¼çš„å…¨å±€ç­”æ¡ˆæ±‚æ³•ï¼šå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œå‘å·¦å¤„ç†å‡ºæ¯ä¸€æ®µ <span class=\"math inline\">\\([l,r]\\)</span>ï¼Œæ»¡è¶³ <span class=\"math inline\">\\(\\gcd(a_{l\\cdots i})=\\gcd(a_r\\cdots i)\\)</span>ï¼Œå¹¶è®°å½•è¯¥ <span class=\"math inline\">\\(\\gcd\\)</span>ã€‚è¿™æ ·æ±‚å‡ºæ¥çš„ <span class=\"math inline\">\\((i,l,r)\\)</span> å…±æœ‰ <span class=\"math inline\">\\(O(n\\log V)\\)</span> æ®µã€‚</p>\n<p>å¯¹äºæ¯ä¸ª gcd æœ‰ <span class=\"math inline\">\\(f_{i}=f_{i-1}+\\sum\\limits_{j=l_i}^{r_i} f_{j - 1}\\)</span>ï¼Œå¯ä»¥åšä¸€ä¸ªæ‰«æçº¿ï¼Œå¾—åˆ°å…¨å±€ç­”æ¡ˆï¼›å‘å‰å‘ååˆ†åˆ«åšåˆ° <span class=\"math inline\">\\(i-1,i+1\\)</span>ï¼Œç›¸ä¹˜å°±èƒ½å¾—åˆ° <span class=\"math inline\">\\(i\\)</span> æœªè¢«é€‰å–æ—¶çš„ç­”æ¡ˆ</p>\n<p>è€ƒè™‘æ€ä¹ˆå®Œæˆã€ç›¸ä¹˜ã€è¿™ä¸ªåŠ¨ä½œï¼šæœ€åçš„ <span class=\"math inline\">\\(f\\)</span> åœ¨æ¯ä¸ªå³ç«¯ç‚¹å¤„å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥è½¬åŒ–æˆè‹¥å¹²æ®µ <span class=\"math inline\">\\(f\\)</span>ï¼›åè¿‡æ¥çš„ <span class=\"math inline\">\\(f&#39;\\)</span> äº¦å¯ä»¥è¿™æ ·è½¬åŒ–ã€‚å°† <span class=\"math inline\">\\(f\\)</span> æ•´ä½“åç§»ä¸€ä½ã€<span class=\"math inline\">\\(f&#39;\\)</span> æ•´ä½“å‰ç§»ä¸€ä½ï¼Œå°±å¯ä»¥å¯¹é½ã€‚äºŒè€…çš„ç«¯ç‚¹æ€»æ•°æ˜¯å‡æ‘Šå• log çš„ï¼ŒåŒºé—´æ€»æ•°ä¹Ÿå°±æ˜¯å‡æ‘Šå• log çš„ï¼ˆå½’å¹¶å°±èƒ½å¿«é€Ÿå¯»æ‰¾åˆ°åŒºé—´ï¼‰ï¼Œç”¨å·®åˆ†åšä¸€ä¸ªåŒºé—´åŠ å³å¯ã€‚</p>\n<p>ç”¨äºŒåˆ†å‹‰å¼ºå• log è§£å†³äº†è½¬ç§»ï¼›è¿˜çœ‹åˆ° <span class=\"citation\" data-cites=\"spdarkle\">@spdarkle</span> ç–‘ä¼¼åœ¨ <span class=\"math inline\">\\(1\\sim n\\)</span> ä¸Šç›´æ¥åšçš„<a href=\"http://222.180.160.110:61235/submission/3108272\">åšæ³•</a>ï¼Œå’Œ <span class=\"citation\" data-cites=\"Rosmist\">@Rosmist</span> ç–‘ä¼¼ç›´æ¥åœ¨æ¯ä¸ª <span class=\"math inline\">\\(i\\)</span> ä¸Šåšçš„<a href=\"http://222.180.160.110:61235/submission/3108581\">åšæ³•</a>ã€‚å®˜è§£æ˜¯ä¸ªçœ‹ä¸æ‡‚çš„åšæ³•</p>\n<p>å‘ƒï¼Œå¥½åƒä¸€ä¸å°å¿ƒæ‹¿äº†æœ€ä¼˜è§£ã€‚è€Œä¸”ä¼˜åŠ¿å¾ˆæ˜æ˜¾ï¼ˆæ€ä¹ˆæ€»ç”¨æ—¶æ¯”åˆ«äººä¸€ä¸ªç‚¹è¿˜å°‘ï¼Ÿï¼‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p>\n<p>å¯èƒ½å› ä¸ºå¤§å®¶éƒ½çœ‹ä¸æ‡‚å®˜è§£ï¼Œåšæ³•æ¯”è¾ƒå¤šæ ·ï¼Ÿé™¤äº†æˆ‘ä¹‹å¤–æ¯”è¾ƒå¿«çš„ lwz å’Œ <span class=\"citation\" data-cites=\"GoldSpade\">@GoldSpade</span> éƒ½ç”¨å½’å¹¶å®Œæˆæœ€åä¸€æ­¥ï¼›æˆ‘è¾ƒä»–ä»¬çš„é¢å¤–ä¼˜åŠ¿å¤§æ¦‚æ˜¯ç”¨äºŒåˆ†æ¢æ‰äº†æ ‘çŠ¶æ•°ç»„ï¼Ÿè¿·æƒ‘</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;selection.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;selection.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;ex_selection2.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; st(20, std::vector&lt;int&gt; (n + 1));\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], st[0][i] = a[i];\n    for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)\n        for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)\n            st[j][i] = std::__gcd(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);\n    auto askgcd = [&amp;](int l, int r) &#123;\n        int k = std::__lg(r - l + 1);\n        return std::__gcd(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);\n    &#125;;\n    std::unordered_map&lt;int, int&gt; tab;\n    struct node &#123;\n        int i, l, r;\n        bool operator&lt; (const int q) const &#123;\n            return i &lt; q;\n        &#125;\n        bool operator&lt;= (const int q) const &#123;\n            return i &lt;= q;\n        &#125;\n    &#125;;\n    std::vector&lt;std::vector&lt;node&gt; &gt; p1, p2;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (int to = i; to &gt;= 1; ) &#123;\n            int at = i, g = askgcd(to, i);\n            for (int l = 1, r = to, mid; l &lt;= r; ) &#123;\n                mid = (l + r) &gt;&gt; 1;\n                if (askgcd(mid, i) == g)\n                    at = mid, r = mid - 1;\n                else\n                    l = mid + 1;\n            &#125;\n            if (!tab.count(g)) &#123;\n                tab[g] = (int)p1.size();\n                p1.emplace_back(), p2.emplace_back();\n            &#125;\n            p1[tab[g]].push_back(&#123; i, at, to &#125;);\n            to = at - 1;\n        &#125;\n        for (int to = i; to &lt;= n; ) &#123;\n            int at = i, g = askgcd(i, to);\n            for (int l = to, r = n, mid; l &lt;= r; ) &#123;\n                mid = (l + r) &gt;&gt; 1;\n                if (askgcd(i, mid) == g)\n                    at = mid, l = mid + 1;\n                else\n                    r = mid - 1;\n            &#125;\n            if (!tab.count(g)) &#123;\n                tab[g] = (int)p2.size();\n                p1.emplace_back(), p2.emplace_back();\n            &#125;\n            p2[tab[g]].push_back(&#123; i, to, at &#125;);\n            to = at + 1;\n        &#125;\n    &#125;\n    auto s(0ll);\n    std::vector&lt;int&gt; x1(n + 1), x2(n + 2), pos(2 * n + 3);\n    std::vector&lt;long long&gt; f1(n + 1), f2(n + 2), s1(n + 1), s2(n + 2), diff(n + 1);\n    for (auto [g, id] : tab) &#123;\n        // printf(&quot;g = %d: \\n&quot;, g);\n        int n1 = (int)p1[id].size();\n        x1[0] = 0, f1[0] = s1[0] = 1ll;\n        for (int i = 1; i &lt;= n1; ++i) &#123;\n            auto [x, L, R] = p1[id][i - 1];\n            --L, --R;\n            x1[i] = x, f1[i] = f1[i - 1];\n            int l = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, L) - x1.begin() - 1,\n                r = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, R) - x1.begin() - 1;\n            if (l == r)\n                (f1[i] += f1[l] * (R - L + 1)) %= mod;\n            else &#123;\n                f1[i] += s1[r - 1] + mod - s1[l];\n                f1[i] += f1[r] * (R - x1[r] + 1);\n                f1[i] += f1[l] * (x1[l + 1] - L);\n                f1[i] %= mod;\n            &#125;\n            // printf(&quot;  r = %d, l = [%d, %d]: %lld\\n&quot;, x, L, R, f1[i]);\n            if (i != n1)\n                s1[i] = (s1[i - 1] + f1[i] * (p1[id][i].i - x)) % mod;\n        &#125;\n        (s += f1[n1] - 1) %= mod;\n        int n2 = (int)p2[id].size();\n        x2[n2 + 1] = n + 1, f2[n2 + 1] = s2[n2 + 1] = 1ll;\n        for (int i = n2; i; --i) &#123;\n            auto [x, L, R] = p2[id][i - 1];\n            ++L, ++R;\n            x2[i] = x, f2[i] = f2[i + 1];\n            int l = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, L) - x2.begin(),\n                r = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, R) - x2.begin();\n            if (l == r)\n                (f2[i] += f2[l] * (R - L + 1)) %= mod;\n            else&#123;\n                f2[i] += s2[l + 1] + mod - s2[r];\n                f2[i] += f2[r] * (R - x2[r - 1]);\n                f2[i] += f2[l] * (x2[l] - L + 1);\n                f2[i] %= mod;\n            &#125;\n            // printf(&quot;  l = %d, r = [%d, %d]: %lld\\n&quot;, x, L, R, f2[i]);\n            if (i != 1)\n                s2[i] = (s2[i + 1] + f2[i] * (x - p2[id][i - 2].i)) % mod;\n        &#125;\n        for (int i = 0; i &lt; n1; ++i)\n            x1[i] = x1[i + 1];\n        x1[n1] = n;\n        int t = (x2[1] == 1) + 1;\n        for (int i = 1; i &lt;= n2 + 1; ++i)\n            --x2[i];\n        std::merge(x1.begin(), x1.begin() + n1 + 1, x2.begin() + t, x2.begin() + n2 + 2, pos.begin() + 1);\n        int m = std::unique(pos.begin() + 1, pos.begin() + n1 + n2 + 4 - t) - pos.begin() - 1;\n        for (int i = 1, p1 = 0, p2 = t, la = 0; i &lt;= m; ++i) &#123;\n            for (; p1 + 1 &lt;= n1 &amp;&amp; x1[p1] &lt; pos[i]; ++p1);\n            for (; p2 + 1 &lt;= n2 + 1 &amp;&amp; x2[p2] &lt; pos[i]; ++p2);\n            (diff[la + 1] += f1[p1] * f2[p2] + mod - 1) %= mod;\n            // printf(&quot;  [%d, %d]: %lld, %lld\\n&quot;, la + 1, pos[i], f1[p1], f2[p2]);\n            if (pos[i] + 1 &lt;= n)\n                (diff[pos[i] + 1] += mod - f1[p1] * f2[p2] + 1) %= mod;\n            la = pos[i];\n        &#125;\n    &#125;\n    // std::cout &lt;&lt; s &lt;&lt; &#39;\\n&#39;;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        (diff[i] += diff[i - 1]) %= mod;\n        std::cout &lt;&lt; (s + mod - diff[i]) % mod &lt;&lt; &#39; &#39;;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<p>æˆ‘ä¸€å¼€å§‹å°† <span class=\"math inline\">\\(f\\)</span> å®šä¹‰ä¸ºå•ç‚¹ç­”æ¡ˆè€Œéå‰ç¼€å’Œï¼Œä¼šå¯¼è‡´éœ€è¦çº¿æ®µæ ‘ç»´æŠ¤ç­‰å·®åºåˆ—ï¼Œè¿˜ä¸¢å¤±äº†ç­”æ¡ˆæ®µæ•°ä¸å¤šè¿™ä¸ªæ€§è´¨ï¼Œéå¸¸éº»çƒ¦ã€‚å°† <span class=\"math inline\">\\(f\\)</span> çš„æ„ä¹‰æ›¿æ¢ä¸ºå‰ç¼€å’Œåï¼Œå°±å¯ä»¥å¾ˆè½»æ¾åœ°åšäº†ã€‚</p>\n<hr />\n<h2 id=\"a.-å®‡å®™\">A. å®‡å®™</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6535/problem/1\" class=\"uri\">http://222.180.160.110:61235/contest/6535/problem/1</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œå¯¹äº <span class=\"math inline\">\\(k=1,2,\\cdots,n-1\\)</span>ï¼Œå›ç­”ï¼š</p>\n<ul>\n<li>ä»¤ <span class=\"math inline\">\\(i\\)</span> ä» <span class=\"math inline\">\\(1\\)</span> å¼€å§‹è‡ªå¢ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œéƒ½å¯ä»¥é€‰å– <span class=\"math inline\">\\(k\\)</span> ä¸ªäº’ä¸ç›¸åŒçš„ä¸‹æ ‡ï¼Œå¹¶ä½¿å®ƒä»¬å¯¹åº”çš„å…ƒç´ å¢åŠ  1ã€‚æ­¤æ—¶ï¼Œè‹¥å­˜åœ¨å…ƒç´ ä¸å¤§äº <span class=\"math inline\">\\(i\\)</span>ï¼Œåœæ­¢ã€‚è¾“å‡ºåœæ­¢æ—¶ <span class=\"math inline\">\\(i\\)</span> å¯èƒ½çš„æœ€å¤§å€¼ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n\\le 10^6,V\\le 10^9\\)</span>ã€‚</p>\n</blockquote>\n<p>å‘ç°ä¸å¤§äºè¿™ä¸ª condition æœ‰äº›åäººç±»ï¼Œå…ˆå°† <span class=\"math inline\">\\(a\\)</span> å…¨éƒ¨å‡ 1ï¼Œè½¬åŒ–æˆå°äºæ¥è€ƒè™‘</p>\n<p>è€ƒè™‘èƒ½åšæŒåˆ° <span class=\"math inline\">\\(i\\)</span> çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶ï¼Œå³ <span class=\"math inline\">\\(\\sum\\limits_{a_j&lt;i} i-a_j\\le k\\cdot i\\)</span></p>\n<p>å®¹æ˜“å‘ç°è¯¥æ¡ä»¶åŒæ—¶æ˜¯å……åˆ†çš„ï¼Œå¯ä»¥æœæ‘©å°”æŠ•ç¥¨æ€è€ƒ</p>\n<p>å¯¹ <span class=\"math inline\">\\(a\\)</span> æ’åºï¼Œåœæ­¢æ—¶å‚ä¸è¿ç®—çš„ <span class=\"math inline\">\\(a_j\\)</span> æ˜¯è¶Šæ¥è¶Šå¤šçš„ï¼Œæ•…è®°å½•æœ€åä¸€ä¸ªå‚ä¸è¿ç®—çš„ä¸‹æ ‡ï¼Œé€æ­¥æŒªåŠ¨ï¼ˆå½“å‘ç°è§£å‡ºæ¥çš„ <span class=\"math inline\">\\(i\\)</span> æ¯”ä¸‹ä¸€ä¸ªæ›´å¤§æ—¶å°±éœ€è¦æŒªåŠ¨ï¼‰ï¼ŒåŒæ—¶è§£ä¸ç­‰å¼å³å¯ã€‚</p>\n<p><span class=\"citation\" data-cites=\"Quack\">@Quack</span> äº‘æˆ‘åœ¨åœºä¸Šèƒ½æƒ³å‡ºå®˜è§£å¯¹æˆ‘æ¥è¯´æ˜¯éå¸¸äº†ä¸èµ·çš„ï¼ˆå…¶å®åœºä¸Šå†™æ­£è§£çš„äººå°‘å¾—å‡ºå¥‡ï¼‰ï¼Œæˆ‘ä¹Ÿä¸å¾—ä¸æ‰¿è®¤æˆ‘èƒ½åšå‡ºæ¥ç¡®å®æœ‰ä¸€å®šè¿æ°”æˆåˆ†ï¼Œä¹Ÿèƒ½ä»ä¸­ä¸€çª¥æˆ‘ä»¤äººçœ¼å‰ä¸€é»‘çš„æ•°å­¦ç´ å…»ï¼</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n    std::freopen(&quot;universe.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;universe.out&quot;, &quot;w&quot;, stdout);\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    int n;\n    std::cin &gt;&gt; n, std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], --a[i];\n    std::sort(a.begin() + 1, a.end());\n    int id = 1;\n    long long s = a[1];\n    for (int i = 1; i &lt; n; ++i) &#123;\n        if (id &lt; i + 1)\n            s += a[++id];\n        long long x = s / (id - i);\n        for (; id != n &amp;&amp; x &gt; a[id + 1]; s += a[++id], x = s / (id - i));\n        std::cout &lt;&lt; x &lt;&lt; &#39; &#39;;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b.-è·³è·ƒ\">B. è·³è·ƒ</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6535/problem/2\" class=\"uri\">http://222.180.160.110:61235/contest/6535/problem/2</a></p>\n<blockquote>\n<p>ç»™å®šé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„ 01 åºåˆ—å’Œè·³è·ƒä¸Šé™ <span class=\"math inline\">\\(k\\)</span>ã€‚ç»™å®š <span class=\"math inline\">\\(q\\)</span> ä¸ªè¯¢é—®ï¼Œå›ç­”ï¼š</p>\n<ul>\n<li>ä» <span class=\"math inline\">\\(a\\)</span> è·³åˆ° <span class=\"math inline\">\\(b\\)</span>ï¼Œä¿è¯ <span class=\"math inline\">\\(a,b\\)</span> çš„é¢œè‰²å‡ä¸º 1ï¼Œæ¯æ¬¡ä¸èƒ½è·³è¶…è¿‡ <span class=\"math inline\">\\(k\\)</span> æ ¼æˆ–è·³å‡ºå»ï¼Œåœ¨æœ€å°åŒ–è¸©åˆ° 0 æ•°é‡çš„å‰æä¸‹ï¼Œæœ€å°åŒ–è·³è·ƒæ¬¡æ•°ï¼Œè¾“å‡ºè¿™ä¸¤ä¸ªå€¼ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n,q\\le5\\times10^5\\)</span>ã€‚</p>\n</blockquote>\n<p>å®¹æ˜“å‘ç°åªèƒ½å¾€ä¸€ä¸ªæ–¹å‘è·³ï¼Œé‚£ä¹ˆä¸å¦¨ä»¤ <span class=\"math inline\">\\(a&lt;b\\)</span>ã€‚æœ‰ä¸€ä¸ªè´ªå¿ƒçš„æƒ³æ³•æ˜¯èƒ½å¾€å³å°±å¾€å³ï¼Œæ‰‹ç©å‘ç°<strong>æ˜¯å¯¹çš„</strong>ï¼ˆæˆ‘åœºä¸Šæ‰‹ç©è¿‡ååšå®šåœ°è®¤ä¸ºæ˜¯é”™çš„ï¼›å¯èƒ½å’Œæ²¡æ—¶é—´äº†å…µè’é©¬ä¹±æœ‰å…³ï¼‰ã€‚è¿™æ ·å°±å¾ˆå¥½æƒ³åˆ°ç¬¬äºŒé—®éœ€è¦å€å¢ï¼›ä½†æŠŠä¸¤ä¸ªé—®ç»“åˆèµ·æ¥è€ƒè™‘æ˜¯æœ‰ç‚¹å›°éš¾çš„ï¼Œèµ›æ—¶å°±æ„è¯†åˆ°è¿™ä¸¤é—®çš„è”ç³»æ²¡æœ‰çœ‹èµ·æ¥é‚£ä¹ˆå¤§ï¼Œç”šè‡³å¾ˆå¯èƒ½æ˜¯å‰²è£‚çš„ã€‚</p>\n<p>å•ç‹¬è€ƒè™‘ç¬¬ä¸€é—®ï¼Œå‘ç°å¯¹äºä¸€æ®µé•¿åº¦ä¸º <span class=\"math inline\">\\(len\\)</span> çš„ 0ï¼Œéœ€è¦è¸©åˆ°æ°å¥½ <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {len}k\\right\\rfloor\\)</span> ä¸ª 0ã€‚ç­”æ¡ˆå®¹æ˜“è®¡ç®—ã€‚</p>\n<p>å•ç‹¬è€ƒè™‘ç¬¬äºŒé—®ï¼Œè€ƒè™‘ä¸€ä¸ªç¬¬ä¸€é—®ç­”æ¡ˆå›ºå®šä¸º 0 çš„æƒ…å†µï¼Œä¹Ÿå³æ¯ä¸ª len éƒ½æ¯” <span class=\"math inline\">\\(k\\)</span> å°ã€‚åˆ™é—®é¢˜è½¬åŒ–æˆåœ¨ä¸è¸© 0 çš„æƒ…å†µä¸‹æœ€å°çš„æ­¥æ•°ã€‚å®¹æ˜“ç”¨å€å¢è§£å†³ã€‚</p>\n<p>æœ¬é¢˜æœ€ä»¤äººå°è±¡æ·±åˆ»çš„ç‚¹åœ¨äºäºŒè€…çš„ç»“åˆï¼Œå‘ç°è¿™ <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {len}k\\right\\rfloor\\cdot k\\)</span> ä¸ª 0 æ˜¯æ— è®ºå¦‚ä½•éƒ½ä¼šè¢«ç»è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨åŸå§‹æ•°ç»„é‡Œåˆ æ‰å®ƒä»¬ï¼Œè½¬åŒ–æˆåªè€ƒè™‘ç¬¬äºŒé—®çš„æƒ…å†µ</p>\n<details>\n<p>ï¼Ÿï¼Ÿï¼Ÿ</p>\n<p>æˆ‘å¯¹äºè‡ªå·±è«åå…¶å¦™è·‘å¾—æ¯”åˆ«äººå¿«ä¸€å¤§æˆªè¿™ä»¶äº‹æƒ…å·²ç»å¿«è¦è§æ€ªä¸æ€ªäº†ï¼Œè¿™æ¬¡åˆæ˜¯ä»€ä¹ˆåŸç†ï¼Œæˆ‘é¢„å¤„ç†å†™å¾—æ¯”è¾ƒæ¼‚äº®å—ï¼Ÿï¼Ÿ</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;jump.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;jump.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, k, q, op;\n    std::cin &gt;&gt; n, std::cin &gt;&gt; n &gt;&gt; q &gt;&gt; k &gt;&gt; op;\n    std::vector&lt;int&gt; tmp(n + 1), a(1), s(1), to(n + 2);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        tmp[i] = t - &#39;0&#39;;\n    &#125;\n    tmp.push_back(1), ++n;\n    int cnt = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (tmp[i] == 1) &#123;\n            a.push_back(1), to[i] = (int)a.size() - 1;\n            s.push_back(s.back() + cnt), cnt = 0;\n        &#125;\n        else &#123;\n            ++cnt;\n            if (i == n || tmp[i + 1] == 1) &#123;\n                for (int j = 1; j &lt;= cnt % k; ++j)\n                    a.push_back(0), s.push_back(s.back());\n                cnt /= k;\n            &#125;\n        &#125;\n    &#125;\n    n = (int)a.size() - 1;\n    std::vector&lt;std::vector&lt;int&gt; &gt; f(20, std::vector&lt;int&gt; (n + 1));\n    for (int i = 0; i &lt; 20; ++i)\n        f[i][n] = n;\n    for (int i = n - 1; i; --i) &#123;\n        f[0][i] = std::min(&#123; n, i + k, f[0][i + 1] &#125;);\n        for (; !a[f[0][i]]; --f[0][i]);\n        if (a[i] == 1) &#123;\n            for (int j = 1; j &lt; 20; ++j)\n                f[j][i] = f[j - 1][f[j - 1][i]];\n        &#125;\n    &#125;\n    for (int a, b; q--; ) &#123;\n        std::cin &gt;&gt; a &gt;&gt; b;\n        if (a &gt; b)\n            std::swap(a, b);\n        a = to[a], b = to[b];\n        std::cout &lt;&lt; s[b] - s[a];\n        if (op == 1) &#123;\n            int res = s[b] - s[a];\n            for (int i = 19; ~i; --i)\n                if (f[i][a] &lt; b)\n                    a = f[i][a], res += (1 &lt;&lt; i);\n            std::cout &lt;&lt; &#39; &#39; &lt;&lt; res + 1;\n        &#125;\n        std::cout &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-jongmah\">D. Jongmah</h2>\n<p><a href=\"https://codeforces.com/contest/1110/problem/D\" class=\"uri\">https://codeforces.com/contest/1110/problem/D</a></p>\n<p>å®¹æ˜“å‘ç°å½“è¿ç»­å‡ºç°ä¸‰æ¬¡ <span class=\"math inline\">\\((i-1,i,i+1)\\)</span> æ—¶ï¼Œå¯ä»¥è¢«ä¸‰æ¬¡ç›¸åŒä»£æ›¿ï¼›</p>\n<p>å®¹æ˜“å‘ç°éœ€è¦ä½¿ç”¨ <span class=\"math inline\">\\(f_{i,a,b}\\)</span> æ¥ä»£è¡¨ DP åˆ° <span class=\"math inline\">\\(i\\)</span> æ—¶ï¼Œç”¨äº† <span class=\"math inline\">\\(a\\)</span> ç»„ <span class=\"math inline\">\\((i-1,i,i+1)\\)</span> å’Œ <span class=\"math inline\">\\(b\\)</span> ç»„ <span class=\"math inline\">\\((i,i+1,i+2)\\)</span> æ—¶çš„æœ€å¤§ç»„æ•°ï¼›</p>\n<p>ä½†æ˜¯å¹¶æ²¡æœ‰æƒ³åˆ°è¦å°†äºŒè€…ç»“åˆèµ·æ¥ï¼æ„Ÿè§‰åº”è¯¥æ˜¯èƒ½æ¯”è¾ƒå¿«åšå‡ºæ¥çš„æ°´å¹³ã€‚èƒ½å¯Ÿè§‰åˆ°ä¸å¤ªè®¤çœŸã€‚æ‚”è¿‡ï¼</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 0x3f3f3f3f;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; cnt(m + 1);\n    for (int i = 1, x; i &lt;= n; ++i)\n        std::cin &gt;&gt; x, ++cnt[x];\n    std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(m + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (3, std::vector&lt;int&gt; (3, -inf)));\n    f[0][0][0] = 0ll;\n    for (int i = 1; i &lt;= m; ++i)\n        for (int a = 0; a &lt;= 2; ++a) // i - 1, i, i + 1\n            for (int b = 0; b &lt;= 2; ++b) // i, i + 1, i + 2\n                for (int c = 0; c &lt;= 2; ++c) &#123; // i - 2, i - 1, i\n                    if (a + b + c &gt; cnt[i]) continue;\n                    f[i][a][b] = std::max(f[i][a][b], f[i - 1][c][a] + b + (cnt[i] - a - b - c) / 3);\n                &#125;\n    std::cout &lt;&lt; f[m][0][0] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e.-magic-stones\">E. Magic Stones</h2>\n<p><a href=\"https://codeforces.com/contest/1110/problem/F\" class=\"uri\">https://codeforces.com/contest/1110/problem/F</a></p>\n<p>å®¹æ˜“æƒ³åˆ°è€ƒå¯Ÿå·®åˆ†æ•°ç»„ï¼Œå‘ç°è¿™ä¸ªæ“ä½œå°±æ˜¯äº¤æ¢äº†å·®åˆ†æ•°ç»„çš„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ã€‚æ•…å¯¹äº <span class=\"math inline\">\\(c\\)</span> å’Œ <span class=\"math inline\">\\(t\\)</span> çš„å·®åˆ†æ•°ç»„åˆ†åˆ«æ’åºï¼Œç„¶å check æ˜¯å¦ç›¸ç­‰å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), b(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; b[i];\n    if (a[1] != b[1] || a[n] != b[n]) &#123;\n        std::cout &lt;&lt; &quot;No&quot; &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;int&gt; da(n), db(n);\n    std::adjacent_difference(a.begin() + 1, a.end(), da.begin());\n    std::adjacent_difference(b.begin() + 1, b.end(), db.begin());\n    std::sort(da.begin(), da.end());\n    std::sort(db.begin(), db.end());\n    std::cout &lt;&lt; (da == db ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "å€å¢",
                "æ ‘å½¢ DP",
                "Kruskal é‡æ„æ ‘"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20240106/",
            "url": "https://xsc062.netlify.app/20240106/",
            "title": "æ‚é¢˜å…¨è°ˆ",
            "date_published": "2024-01-06T03:27:39.000Z",
            "content_html": "<p>æƒ³ä¸åˆ°å¥½æ ‡é¢˜äº†ã€‚</p>\n<span id=\"more\"></span>\n<p>æœ‰å¥è¯æ€ä¹ˆè¯´æ¥ç€ï¼Œç½—é©¬ä¸æ˜¯ä¸€å¤©å»ºæˆçš„ï¼Œæ˜¯ä¸€å¤©å¤©å»ºæˆçš„ã€‚</p>\n<p>è¿˜æœ‰ä»€ä¹ˆï¼ŒDo in Rome as the Romansâ€™ doï¼Œè¿˜æœ‰ä¸€å¥ï¼ŒAll roads leads to Romeã€‚</p>\n<hr />\n<h3 id=\"a.-è¿ç»­çš„é›¶-zero\">A. è¿ç»­çš„é›¶ zero</h3>\n<p><a href=\"http://222.180.160.110:61235/contest/4647/problem/1\" class=\"uri\">http://222.180.160.110:61235/contest/4647/problem/1</a></p>\n<p>åšä¸ªå‰ç¼€å’Œï¼Œçœ‹çœ‹ä»»æ„ä¸€ä¸ªé•¿åº¦ä¸º <span class=\"math inline\">\\(k\\)</span> çš„åŒºé—´ä¸­æœ‰å‡ ä¸ª <span class=\"math inline\">\\(1\\)</span>ã€‚å¤æ‚åº¦ <span class=\"math inline\">\\(O(n)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>namespace XSC062 &#123;\nusing namespace fastIO;\nconst int maxn = 5e5 + 5;\nconst int inf = 0x3f3f3f3f;\nint n, m, res = inf;\nint a[maxn], s[maxn];\nint min(int x, int y) &#123;\n    return x &lt; y ? x : y;\n&#125;\nint main() &#123;\n    scanf(&quot;%d %d&quot;, &amp;n, &amp;m);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        scanf(&quot;%1d&quot;, &amp;a[i]);\n        s[i] = s[i - 1] + a[i];\n        if (i &gt;= m)\n            res = min(res, s[i] - s[i - m]);\n    &#125;\n    print(res, &#39;\\n&#39;);\n    return 0;\n&#125;\n&#125; // namespace XSC062</code></pre>\n</details>\n<hr />\n<h3 id=\"b.-åå›æ–‡ä¸²-anti\">B. åå›æ–‡ä¸² anti</h3>\n<p><a href=\"http://222.180.160.110:61235/contest/4647/problem/2\" class=\"uri\">http://222.180.160.110:61235/contest/4647/problem/2</a></p>\n<p>å½“ <span class=\"math inline\">\\(n\\)</span> ä¸ºå¥‡æ—¶ï¼Œä¸­é—´çš„å…ƒç´ ä¸€å®šå’Œè‡ªå·±ç›¸ç­‰ï¼Œæ•…æ— è§£ã€‚</p>\n<p>å½“æ•°é‡æœ€å¤šçš„ä¸€ä¸ªå­—ç¬¦ä¸ªæ•°è¶…è¿‡ <span class=\"math inline\">\\(\\dfrac n2\\)</span> æ—¶ï¼Œç”±é¸½å·¢å¾—æ— è§£ã€‚</p>\n<p>å‰©ä¸‹çš„æƒ…å†µä¸€å®šæœ‰è§£ã€‚</p>\n<details>\n<p><summary>è¯æ˜</summary></p>\n<p>å¯ä»¥æ‰¾åˆ°ä¸€ç§åˆæ³•çš„æ„é€ æ–¹å¼ã€‚æˆ‘ä»¬åˆ—å‡ºä¸€ä¸ªåˆ—æ•°ä¸º <span class=\"math inline\">\\(2\\)</span>ï¼Œè¡Œæ•°ä¸º <span class=\"math inline\">\\(\\dfrac n2\\)</span> çš„è¡¨æ ¼ï¼Œå°†æ‰€æœ‰ç›¸åŒå­—æ¯æ’åˆ—åœ¨ä¸€èµ·ï¼ŒæŒ‰ç…§ä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹çš„æ–¹å¼å°†å­—æ¯å¡«å…¥è¡¨æ ¼ï¼Œæœ€åå°†ç¬¬ <span class=\"math inline\">\\(i\\)</span> è¡Œç¬¬ä¸€åˆ—çš„å­—æ¯å¡«å…¥ <span class=\"math inline\">\\(a_i\\)</span>ï¼Œç¬¬ <span class=\"math inline\">\\(i\\)</span> è¡Œç¬¬äºŒåˆ—çš„å­—æ¯å¡«å…¥ <span class=\"math inline\">\\(a_{n-i+1}\\)</span>ï¼Œå³å¯å®Œæˆæ„é€ ã€‚</p>\n<p>ä¸€ç§å­—æ¯åªåœ¨ç¬¬ä¸€åˆ—æˆ–ç¬¬äºŒåˆ—å‡ºç°å½“ç„¶åˆæ³•ï¼Œå¦‚æœä»ç¬¬ä¸€åˆ—æŒç»­åˆ°ç¬¬äºŒåˆ—ï¼Œå› ä¸ºä»»æ„å­—æ¯å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ <span class=\"math inline\">\\(\\dfrac n2\\)</span> æ¬¡ï¼Œæ‰€ä»¥åŒä¸€è¡Œçš„ä¸¤åˆ—ä¸ä¼šå‡ºç°åŒä¸€ç§å­—æ¯ã€‚</p>\n<p>è¿™å«ä»€ä¹ˆï¼Œæœ‰å­—è¯æ˜ã€‚</p>\n<p><del>æ„Ÿè§‰å¯ä»¥æ‹¿å»å‡ºä¸€é“ç±»ä¼¼äºã€Œæ‰¾åˆ°å­—ç¬¦ä¸²å­—å…¸åºæœ€å°çš„åå›æ–‡ä¸²ã€ä¹‹ç±»çš„å°æ°´é¢˜</del></p>\n</details>\n<p>ç„¶åç°åœ¨æˆ‘ä»¬çŸ¥é“æœ‰è§£äº†ï¼Œæ€ä¹ˆæ‰¾åˆ°æœ€ä¼˜è§£å‘¢ã€‚</p>\n<p>æ¯”å¦‚æœ‰ä¸€ç»„ <span class=\"math inline\">\\((a_i,a_{n-i+1})=(\\texttt a, \\texttt a)\\)</span>ï¼Œè¿˜æœ‰ä¸€ç»„ <span class=\"math inline\">\\((a_j, a_{n-j+1})=(\\texttt b, \\texttt b)\\)</span>ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æŠŠ <span class=\"math inline\">\\(a_i\\)</span> å’Œ <span class=\"math inline\">\\(a_j\\)</span> äº¤æ¢ï¼Œçš†å¤§æ¬¢å–œã€‚</p>\n<p>è¿™å°±è¯´æ˜æˆ‘ä»¬éœ€è¦æŠŠå€¼ä¸ç›¸ç­‰çš„éæ³• <span class=\"math inline\">\\(a_i\\)</span> ä¸ <span class=\"math inline\">\\(a_j\\)</span> é…å¯¹ã€‚</p>\n<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ²¿ç”¨è¯æ˜ä¸­çš„æ„é€ æ–¹å¼ï¼Œåˆ†ç»„é…å¯¹ï¼Œä¸€å®šæœ€ä¼˜ï¼Œæ¯ç»„ä»£ä»·ä¸º <span class=\"math inline\">\\(1\\)</span>ã€‚</p>\n<p>åŒä¸€è¡Œä¸¤ä¸ªå€¼ <span class=\"math inline\">\\(v\\)</span> ç›¸ç­‰ï¼Œå› ä¸ºå·²ç»æœ€ä¼˜äº†ï¼Œæ‰€ä»¥ä¸èƒ½å†åœ¨éæ³•ä¸²ä¸­å¯»æ‰¾ç­”æ¡ˆã€‚åº”è¯¥æ‰¾åˆæ³•å¯¹ä¸­æŸä¸ªå€¼äº¤æ¢ï¼Œæ¯ç»„ä»£ä»·ä¸º <span class=\"math inline\">\\(2\\)</span>ã€‚å…·ä½“å’Œè°äº¤æ¢æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒï¼Œåªè¦æ‰¾åˆ°ä¸€ç»„ <span class=\"math inline\">\\((a_i,a_{n-i+1})\\)</span> æ»¡è¶³ <span class=\"math inline\">\\(a_i\\ne v\\)</span> ä¸” <span class=\"math inline\">\\(a_{n-i+1}\\ne v\\)</span> å°±å¯ä»¥äº†ï¼Œç„¶åæˆ‘ä»¬åˆçŸ¥é“ <span class=\"math inline\">\\(v\\)</span> çš„ä¸ªæ•° <span class=\"math inline\">\\(\\ne \\dfrac n2\\)</span>ï¼Œå‡è®¾ <span class=\"math inline\">\\(\\dfrac n2\\)</span> å¯¹ä¸­æ¯é˜Ÿéƒ½æœ‰è‡³å°‘ä¸€ä¸ª <span class=\"math inline\">\\(v\\)</span>ï¼Œç”±äºå½“å‰è¿™ä¸€å¯¹æœ‰ä¸¤ä¸ªç›¸åŒçš„ <span class=\"math inline\">\\(v\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(v\\)</span> çš„ä¸ªæ•°å°±ä¼šå¤§äº <span class=\"math inline\">\\(\\dfrac n2\\)</span>ï¼ŒçŸ›ç›¾äº†ï¼Œæ‰€ä»¥ä¸€å®šèƒ½æ‰¾åˆ°ã€‚</p>\n<p>å¯¹äºéæ³•æ€»å¯¹æ•°æ˜¯å¥‡æ•°çš„æƒ…å†µï¼Œæˆ‘ä»¬è¦é’¦å®šä¸€ä¸ªéæ³•å¯¹å¼ºåˆ¶è®©å…¶å’Œåˆæ³•å¯¹äº¤æ¢ï¼Œè´ªå¿ƒä¸€ä¸‹å–éæ³•å¯¹æ•°é‡æœ€å¤šçš„ <span class=\"math inline\">\\(v\\)</span> çš„æŸä¸€å¯¹æœ€ä¼˜ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>namespace XSC062 &#123;\nusing namespace fastIO;\nconst int maxm = 35;\nconst int maxn = 2e5 + 5;\nchar s[maxn];\nint cnt[maxm], p[maxn];\nint T, n, tot, res, now;\nint main() &#123;\n    scanf(&quot;%d&quot;, &amp;T);\n    while (T--) &#123;\n        tot = 0;\n        scanf(&quot;%d %s&quot;, &amp;n, s + 1);\n        if (n &amp; 1) &#123;\n            puts(&quot;-1&quot;);\n            continue;\n        &#125;\n        memset(cnt, 0, sizeof (cnt));\n        for (int i = 1; i &lt;= n; ++i)\n            ++cnt[s[i] - &#39;a&#39; + 1];\n        for (int i = 1; i &lt;= 26; ++i) &#123;\n            if (cnt[i] * 2 &gt; n) &#123;\n                puts(&quot;-1&quot;);\n                goto noSol;\n            &#125;\n        &#125;\n        memset(cnt, 0, sizeof (cnt));\n        for (int i = 1; i * 2 &lt;= n; ++i) &#123;\n            if (s[i] == s[n - i + 1])\n                ++cnt[s[i] - &#39;a&#39; + 1], ++tot;\n        &#125;\n        std::sort(cnt + 1, cnt + 27,\n                    std::greater&lt;int&gt;());\n        res = now = 0;\n        if (tot &amp; 1) &#123;\n            res = 1, --cnt[1];\n            std::sort(cnt + 1, cnt + 27,\n                        std::greater&lt;int&gt;());\n        &#125;\n        for (int i = 1; i &lt;= 26; ++i) &#123;\n            while (cnt[i]--) &#123;\n                if (++now &gt; tot / 2) &#123;\n                    if (i == p[now - tot / 2])\n                        res += 2;\n                    else ++res;\n                &#125;\n                else p[now] = i;\n            &#125;\n        &#125;\n        print(res, &#39;\\n&#39;);\n        noSol: ;\n    &#125;\n    return 0;\n&#125;\n&#125; // namespace XSC062</code></pre>\n</details>\n<hr />\n<h3 id=\"c.-é™¤ä¸å‡-divsub\">C. é™¤ä¸å‡ divsub</h3>\n<p><a href=\"http://222.180.160.110:61235/contest/4647/problem/3\" class=\"uri\">http://222.180.160.110:61235/contest/4647/problem/3</a></p>\n<p>å°æ•°å­¦ï¼Œè¿˜å¥½ã€‚</p>\n<p>å‡è®¾ <span class=\"math inline\">\\(n=d\\times k^p\\)</span>ï¼Œå…¶ä¸­ <span class=\"math inline\">\\(k\\nmid d\\)</span>ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ†ä¸¤ç§æƒ…å†µè®¨è®ºã€‚</p>\n<ol type=\"1\">\n<li><p><span class=\"math inline\">\\(p=0\\)</span>ï¼Œå³ <span class=\"math inline\">\\(k\\nmid n\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(n\\bmod k=1\\)</span>ï¼Œå³ <span class=\"math inline\">\\(k\\mid (n-1)\\)</span>ã€‚</p>\nè¿™ä¸ªæ—¶å€™é—® <span class=\"math inline\">\\(k\\)</span> çš„ä¸ªæ•°å°±ç›¸å½“äºæ˜¯åœ¨é—® <span class=\"math inline\">\\(n-1\\)</span> é™¤ <span class=\"math inline\">\\(1\\)</span> ä»¥å¤–çš„å› å­ä¸ªæ•°ã€‚å‡è®¾ <span class=\"math inline\">\\(n-1={x_1}^{p_1}{x_2}^{p_2}\\cdots {x_m}^{p_m}\\)</span>ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º <span class=\"math inline\">\\((\\prod p_i+1)-1\\)</span>ï¼Œå‡å»çš„æ˜¯ <span class=\"math inline\">\\(1\\)</span>ã€‚</li>\n<li><p><span class=\"math inline\">\\(p\\ne 0\\)</span>ï¼Œ<span class=\"math inline\">\\(k\\mid n\\)</span>ã€‚</p>\n<p>è¿™ä¸ªæ—¶å€™å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆå¥½çš„è½¬åŒ–ã€‚å¥½æ¶ˆæ¯æ˜¯ <span class=\"math inline\">\\(n\\)</span> çš„èŒƒå›´æ˜¯ <span class=\"math inline\">\\(10^{12}\\)</span>ï¼Œæ ¹å·æšä¸¾å› æ•°å¤æ‚åº¦è·‘å¾—è¿‡ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æš´åŠ›åˆ¤å®š <span class=\"math inline\">\\(n\\)</span> çš„æ‰€æœ‰å› æ•°æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚</p></li>\n</ol>\n<p>æ—¶é—´å¤æ‚åº¦ï¼Œ<span class=\"math inline\">\\(O(\\sqrt n\\times \\log n)\\)</span>ï¼Œæšä¸¾å› æ•°æ˜¯æ ¹å·ï¼Œç®—æ¬¡æ•°ï¼ˆä¹Ÿå°±æ˜¯ç®— <span class=\"math inline\">\\(d\\)</span>ï¼‰æ˜¯ <span class=\"math inline\">\\(\\log\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#define int long long\nnamespace XSC062 &#123;\nusing namespace fastIO;\nint n, m, res, cnt;\nint main() &#123;\n    read(n), m = n;\n    for (int i = 2; i * i &lt;= n; ++i) &#123;\n        if (n % i == 0) &#123;\n            m = n;\n            while (m % i == 0) m /= i;\n            if (m % i == 1) ++res;\n            if (i * i != n) &#123;\n                m = n;\n                while (m % (n / i) == 0)\n                    m /= (n / i);\n                if (m % (n / i) == 1) ++res;\n            &#125;\n        &#125;\n    &#125;\n    m = n - 1, cnt = 1;\n    for (int i = 2; i * i &lt;= m; ++i) &#123;\n        if (m % i == 0) &#123;\n            int now = 0;\n            while (m % i == 0)\n                ++now, m /= i;\n            cnt *= now + 1;\n        &#125;\n    &#125;\n    if (m != 1) cnt *= 2;\n    print(res + cnt, &#39;\\n&#39;);\n    return 0;\n&#125;\n&#125; // namespace XSC062\n#undef int</code></pre>\n</details>\n<hr />\n<h3 id=\"d.-å›¾ä¹¦ç®¡ç†å‘˜-librarian\">D. å›¾ä¹¦ç®¡ç†å‘˜ librarian</h3>\n<p><a href=\"http://222.180.160.110:61235/contest/4647/problem/4\" class=\"uri\">http://222.180.160.110:61235/contest/4647/problem/4</a></p>\n<p>[SDOI2008] éƒé—·çš„å° Jã€‚</p>\n<p>å…³äºè¿™ä¸ªï¼Œæˆ‘ä»¬å‘ç°è‡ªå·±ä¸ä¼šè€ƒåœºç°å†²ä¸»å¸­æ ‘ã€‚å“ï¼Œæ‰“ CDQ åˆæ€•å†™æŒ‚ã€‚</p>\n<p>æˆ‘ä»¬å‘ç°è¿™é“é¢˜çš„ä¿®æ”¹éƒ½æ˜¯å•ç‚¹çš„ï¼Œè¯¢é—®ä¹Ÿåªå…³äºæŸä¸€ç§é¢œè‰²ï¼Œä¸åŒçš„é¢œè‰²ä¹‹é—´æ²¡æœ‰å½±å“ã€‚</p>\n<p>äºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠæ“ä½œç¦»çº¿ä¸‹æ¥ï¼Œåˆå§‹è§†ä½œå°†æŸé¢œè‰²åœ¨æŸä½ç½®å¢åŠ ï¼Œä¿®æ”¹è§†ä½œå°†æŸé¢œè‰²åœ¨æŸä½ç½®åˆ é™¤ï¼Œå°†å¦ä¸€é¢œè‰²åœ¨è¯¥ä½ç½®å¢åŠ ï¼Œå°†æ‰€æœ‰æ“ä½œæŒ‰é¢œè‰²ç¦»æ•£åŒ–åˆ†ç±»ç„¶å <code>vector</code> ä¸‹æ¥ï¼Œå¯¹äºæ‰€æœ‰é¢œè‰²ä»å‰åˆ°åæ ‘çŠ¶æ•°ç»„åšä¸€éæ“ä½œå°±èƒ½ <span class=\"math inline\">\\(O(n\\log n+q\\log n)\\)</span> è§£å†³ã€‚</p>\n<p>æ ‘çŠ¶æ•°ç»„æ¸…ç©ºæ˜¯è‚¯å®šä¸èƒ½ <code>memset</code> çš„ï¼Œå¤æ‚åº¦ä¸å¯¹ã€‚é‚£ä¹ˆæ€ä¹ˆåŠå‘¢ï¼ŸæŠŠæ‰€æœ‰æ“ä½œæ’¤å›å»å°±å¯ä»¥äº†ã€‚</p>\n<p>é¡ºå¸¦ä¸€ææˆ‘æ˜¯æ´›è°·ä¸Šæœ€ä¼˜è§£ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>namespace XSC062 &#123;\nusing namespace fastIO;\nconst int maxn = 2e5 + 5;\nstruct __ &#123;\n    int ty, l, r, v;\n    __() &#123;&#125;\n    __(int t1, int l1, int r1, int v1 = 0) &#123;\n        if (t1 == 0)\n            ty = 0, l = l1, v = r1;\n        else ty = 1, l = l1, r = r1, v = v1;\n    &#125;\n&#125;;\nchar ty;\nstd::map&lt;int, int&gt; tab;\nstd::vector&lt;__&gt; q[maxn];\nint n, m, tot, x, y, v, id;\nint Bit[maxn], a[maxn], res[maxn];\nint lowbit(int x) &#123; return x &amp; -x; &#125;\nvoid add(int x, int v) &#123;\n    for (; x &lt;= n; x += lowbit(x))\n        Bit[x] += v;\n    return;\n&#125;\nint ask(int x) &#123;\n    int res = 0;\n    for (; x; x -= lowbit(x)) res += Bit[x];\n    return res;\n&#125;\nint main() &#123;\n    read(n), read(m);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(a[i]);\n        if (!tab.count(a[i]))\n            tab[a[i]] = ++tot;\n        a[i] = tab[a[i]];\n        q[a[i]].emplace_back(0, i, 1);\n    &#125;\n    while (m--) &#123;\n        scanf(&quot;%1s&quot;, &amp;ty);\n        if (ty == &#39;C&#39;) &#123;\n            read(x), read(y);\n            if (!tab.count(y))\n                tab[y] = ++tot;\n            y = tab[y];\n            q[a[x]].emplace_back(0, x, -1);\n            q[a[x] = y].emplace_back(0, x, 1);\n        &#125;\n        else &#123;\n            ++id;\n            read(x), read(y), read(v);\n            if (!tab.count(v)) continue;\n            v = tab[v];\n            q[v].emplace_back(1, x, y, id);\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= tot; ++i) &#123;\n        for (auto &amp;j : q[i]) &#123;\n            if (j.ty == 0) add(j.l, j.v);\n            else &#123;\n                res[j.v] =\n                    ask(j.r) - ask(j.l - 1);\n            &#125;\n        &#125;\n        for (auto &amp;j : q[i])\n            if (j.ty == 0) add(j.l, -j.v);\n    &#125;\n    for (int i = 1; i &lt;= id; ++i)\n        print(res[i], &#39;\\n&#39;);\n    return 0;\n&#125;\n&#125; // namespace XSC062</code></pre>\n</details>\n<hr />\n<p>E ä¼šå•ç‹¬å¼€ä¸€ç¯‡ã€‚</p>\n<hr />\n<h3 id=\"f.-æ ‘-tree\">F. æ ‘ tree</h3>\n<p><a href=\"http://222.180.160.110:61235/contest/4647/problem/6\" class=\"uri\">http://222.180.160.110:61235/contest/4647/problem/6</a></p>\n<p>CF916Eã€‚</p>\n<p>å¤§åˆ†è®¨ç»™æˆ‘æ•´ä¸ä¼šäº†ï¼Œæ›´ç»™æˆ‘æ•´ä¸ä¼šçš„æ˜¯ä¸‹æ¥è¿‡åå‘ç°è¿™åªæ˜¯ä¸ªå°åˆ†è®¨ã€‚</p>\n<p>æ›´æ–°å­æ ‘å’Œå­æ ‘æŸ¥è¯¢æˆ‘ä»¬éƒ½ä¼šã€‚æ¢æ ¹ DP æˆ‘ä»¬ä¹Ÿéƒ½å†™è¿‡ï¼Œéƒ½çŸ¥é“æ¢æ ¹å¹¶ä¸ä¼šå¯¹å­æ ‘ç»“æ„äº§ç”Ÿå¤§çš„å½±å“ã€‚æ‰€ä»¥åº”å½“æ˜¯èƒ½æ ¹æ®å·²çŸ¥ä¿¡æ¯æ¨æµ‹å‡ºå­æ ‘åœ¨åŸæ ‘ä¸Šå¯¹åº”çš„ç‚¹é›†çš„ã€‚</p>\n<p>è®° <span class=\"math inline\">\\(r\\)</span> ä¸ºå½“å‰æ ‘æ ¹ï¼Œ<span class=\"math inline\">\\(\\text {LCA}(x,y)\\)</span> ä¸º <span class=\"math inline\">\\(x,y\\)</span> åœ¨ <span class=\"math inline\">\\(1\\)</span> ä¸ºæ ¹æ—¶çš„ LCAï¼Œ<span class=\"math inline\">\\(\\text {LCA}&#39;(x,y)\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(x,y\\)</span> åœ¨ <span class=\"math inline\">\\(r\\)</span> ä¸ºæ ¹æ—¶çš„ LCAã€‚</p>\n<p>é‚£ä¹ˆå¯¹äº <span class=\"math inline\">\\(\\text {LCA}&#39;(x,y)\\)</span>ï¼Œè‚¯å®šæ˜¯è¦è®¨è®º <span class=\"math inline\">\\(x,y\\)</span> å’Œ <span class=\"math inline\">\\(r\\)</span> çš„ä½ç½®å…³ç³»çš„ã€‚</p>\n<ol type=\"1\">\n<li><span class=\"math inline\">\\(\\text {LCA}(x,y)\\)</span> æ˜¯ <span class=\"math inline\">\\(r\\)</span> çš„å­å­™ã€‚æ­¤æ—¶ <span class=\"math inline\">\\(\\text {LCA}&#39;(x,y) = \\text {LCA}(x,y)\\)</span>ã€‚</li>\n<li><span class=\"math inline\">\\(\\text {LCA}(x,y)\\)</span> æ˜¯ <span class=\"math inline\">\\(r\\)</span> çš„ç¥–å…ˆã€‚é‚£ä¹ˆè¯´æ˜è‡³å°‘æœ‰ä¸€ä¸ªç‚¹ä¸æ˜¯ <span class=\"math inline\">\\(r\\)</span> çš„å­å­™ã€‚æ­¤æ—¶ <span class=\"math inline\">\\(\\text {LCA}(x,y)&#39;\\)</span> çš„å€¼ä¸º <span class=\"math inline\">\\(r\\)</span> ä¸ºå¦ä¸€ä¸ªç‚¹çš„ LCAã€‚</li>\n</ol>\n<p>æ•´ç†å¯å¾— <span class=\"math inline\">\\(\\text {LCA}&#39;(x,y)\\)</span> æ˜¯ <span class=\"math inline\">\\(\\text {LCA}(x,y)\\)</span>ã€<span class=\"math inline\">\\(\\text {LCA}(x,r)\\)</span> å’Œ <span class=\"math inline\">\\(\\text {LCA}(y,r)\\)</span> ä¸­çš„æ·±åº¦æœ€å¤§è€…ã€‚</p>\n<p>å¯¹äºä»¥ <span class=\"math inline\">\\(r\\)</span> ä¸ºæ ¹æ—¶çš„å­æ ‘ <span class=\"math inline\">\\(x\\)</span>ï¼š</p>\n<ol type=\"1\">\n<li><span class=\"math inline\">\\(x=r\\)</span>ï¼Œæ­¤æ—¶å­æ ‘ä¸ºæ•´æ£µæ ‘ã€‚</li>\n<li><span class=\"math inline\">\\(\\text {LCA}(x,r)\\ne x\\)</span>ï¼Œå³ <span class=\"math inline\">\\(r\\)</span> ä¸ä¸º <span class=\"math inline\">\\(x\\)</span> çš„å­å­™ï¼Œæ­¤æ—¶å­æ ‘å°±æ˜¯ä»¥ <span class=\"math inline\">\\(1\\)</span> ä¸ºæ ¹æ˜¯çš„å­æ ‘ <span class=\"math inline\">\\(x\\)</span>ã€‚</li>\n<li><span class=\"math inline\">\\(\\text {LCA}(x,y)=x\\)</span>ï¼Œå³ <span class=\"math inline\">\\(r\\)</span> ä¸º <span class=\"math inline\">\\(x\\)</span> çš„å­å­™ï¼Œæ­¤æ—¶å­æ ‘æ˜¯æ•´æ£µæ ‘é™¤å¼€ <span class=\"math inline\">\\(x\\)</span> åŒ…å« <span class=\"math inline\">\\(r\\)</span> çš„å„¿å­åŠå…¶å­å­™ã€‚ä¿®æ”¹å’ŒæŸ¥è¯¢çš„æ—¶å€™å®¹æ–¥ä¸€ä¸‹å°±å¥½ã€‚è¿™ä¸ªæ—¶å€™çš„å­æ ‘å€å¢è·³ä¸€ä¸‹å°±èƒ½æ‰¾åˆ°ã€‚</li>\n</ol>\n<p>ç„¶åå°±æ˜¯å¸¸è§„çº¿æ®µæ ‘ç»´æŠ¤äº†ã€‚æ—¶é—´å¤æ‚åº¦ <span class=\"math inline\">\\(O(n\\log n)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>namespace XSC062 &#123;\nusing namespace fastIO;\nconst int maxm = 35;\nconst int maxn = 1e5 + 5;\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nstruct _ &#123; int l, r, u, d; &#125;;\n_ t[maxn &lt;&lt; 2];\nint f[maxn][maxm];\nstd::vector&lt;int&gt; g[maxn];\nint a[maxn], dfn[maxn], rfn[maxn];\nint n, q, r, ty, x, y, v, si, now;\nint top[maxn], dep[maxn], tab[maxn];\nvoid swap(int &amp;x, int &amp;y) &#123;\n    x ^= y ^= x ^= y;\n    return;\n&#125;\nvoid DFS(int x) &#123;\n    dep[x] = dep[f[x][0]] + 1;\n    dfn[x] = ++now, tab[now] = x;\n    for (auto i : g[x]) &#123;\n        if (i == f[x][0]) continue;\n        f[i][0] = x;\n        for (int j = 1; j &lt;= si; ++j)\n            f[i][j] = f[f[i][j - 1]][j - 1];\n        DFS(i);\n    &#125;\n    rfn[x] = now;\n    return;\n&#125;\nvoid pushup(int p) &#123;\n    t[p].u = t[lt].u + t[rt].u;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    if (t[p].d) &#123;\n        t[lt].d += t[p].d;\n        t[rt].d += t[p].d;\n        t[lt].u += t[p].d *\n                (t[lt].r - t[lt].l + 1);\n        t[rt].u += t[p].d *\n                (t[rt].r - t[rt].l + 1);\n        t[p].d = 0;\n    &#125;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        t[p].u = a[tab[l]];\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    pushup(p);\n    return;\n&#125;\nvoid add(int p, int x, int v) &#123;\n    t[p].u += v;\n    if (t[p].l == t[p].r) return;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid) add(lt, x, v);\n    else add(rt, x, v);\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        t[p].d += v;\n        t[p].u += (t[p].r - t[p].l + 1) * v;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid) add(lt, l, r, v);\n    if (r &gt; mid) add(rt, l, r, v);\n    pushup(p);\n    return;\n&#125;\nint ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].u;\n    pushdown(p);\n    int res = 0,\n        mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid) res = ask(lt, l, r);\n    if (r &gt; mid) res += ask(rt, l, r);\n    return res;\n&#125;\nint LCA(int x, int y) &#123;\n    if (dep[x] &lt; dep[y]) swap(x, y);\n    for (int i = si; ~i; --i) &#123;\n        if (dep[f[x][i]] &gt;= dep[y])\n            x = f[x][i];\n    &#125;\n    if (x == y) return x;\n    for (int i = si; ~i; --i) &#123;\n        if (f[x][i] != f[y][i])\n            x = f[x][i], y = f[y][i];\n    &#125;\n    return f[x][0];\n&#125;\nvoid Add(int x, int v) &#123;\n    int rlca = LCA(r, x);\n    if (x == r) add(1, 1, n, v);\n    else if (rlca != x)\n        add(1, dfn[x], rfn[x], v);\n    else &#123;\n        add(1, 1, n, v);\n        int p = r;\n        for (int i = si; ~i; --i) &#123;\n            if (dep[f[p][i]] &gt;= dep[x] + 1)\n                p = f[p][i];\n        &#125;\n        add(1, dfn[p], rfn[p], -v);\n    &#125;\n    return;\n&#125;\nvoid tAdd(int x, int y, int v) &#123;\n    int llca = LCA(r, x), rlca = LCA(r, y),\n        ulca = LCA(x, y);\n    if (dep[llca] &gt;= dep[rlca] &amp;&amp;\n        dep[llca] &gt;= dep[ulca]) Add(llca, v);\n    else if (dep[rlca] &gt;= dep[llca] &amp;&amp;\n        dep[rlca] &gt;= dep[ulca]) Add(rlca, v);\n    else Add(ulca, v);\n    return;\n&#125;\nint tAsk(int x) &#123;\n    int rlca = LCA(r, x);\n    if (x == r) return t[1].u;\n    if (rlca != x)\n        return ask(1, dfn[x], rfn[x]);\n    int p = r;\n    for (int i = si; ~i; --i) &#123;\n        if (dep[f[p][i]] &gt;= dep[x] + 1)\n            p = f[p][i];\n    &#125;\n    return t[1].u - ask(1, dfn[p], rfn[p]);\n&#125;\nvoid add(int x, int y) &#123;\n    g[x].push_back(y);\n    return;\n&#125;\nint main() &#123;\n    read(n), read(q), r = 1;\n    si = log(n) / log(2.0);\n    for (int i = 1; i &lt;= n; ++i) read(a[i]);\n    for (int i = 1; i &lt; n; ++i) &#123;\n        read(x), read(y);\n        add(x, y), add(y, x);\n    &#125;\n    dep[0] = 1, DFS(1), dep[0] = 0;\n    bld(1, 1, n);\n    while (q--) &#123;\n        read(ty);\n        if (ty == 1) read(r);\n        else if (ty == 2) &#123;\n            read(x), read(y), read(v);\n            tAdd(x, y, v);\n        &#125;\n        else &#123;\n            read(x);\n            print(tAsk(x), &#39;\\n&#39;);\n        &#125;\n    &#125;\n    return 0;\n&#125;\n&#125; // namespace XSC062\n#undef int</code></pre>\n</details>\n",
            "tags": [
                "çº¿æ®µæ ‘",
                "æ ‘çŠ¶æ•°ç»„",
                "LCA",
                "å€å¢",
                "é¸½å·¢åŸç†"
            ]
        }
    ]
}