<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xsc062.netlify.app</id>
    <title> â€¢ Posts by &#34;å€å¢&#34; tag</title>
    <link href="https://xsc062.netlify.app" />
    <updated>2025-09-24T06:27:15.000Z</updated>
    <category term="å¹¶æŸ¥é›†" />
    <category term="æ–œç‡ä¼˜åŒ–" />
    <category term="æ‚¬çº¿æ³•" />
    <category term="å“ˆå¸Œ" />
    <category term="å­—å…¸æ ‘" />
    <category term="DP" />
    <category term="å•è°ƒé˜Ÿåˆ—" />
    <category term="åˆ†æ²»" />
    <category term="äºŒåˆ†å›¾" />
    <category term="CRT / exCRT" />
    <category term="æ’åˆ—ç»„åˆ" />
    <category term="ç½‘ç»œæµ" />
    <category term="è´¹ç”¨æµ" />
    <category term="äºŒåˆ†" />
    <category term="ä¸Šä¸‹ç•Œç½‘ç»œæµ" />
    <category term="å®¹æ–¥åŸç†" />
    <category term="çº¿æ®µæ ‘" />
    <category term="æ ‘çŠ¶æ•°ç»„" />
    <category term="åŒºé—´ DP" />
    <category term="æ„é€ " />
    <category term="æ•°æ®ç»“æ„" />
    <category term="Tarjan" />
    <category term="ä¸‹é¥­" />
    <category term="LCA" />
    <category term="å€å¢" />
    <category term="é¸½å·¢åŸç†" />
    <category term="æ¦‚ç‡æœŸæœ›" />
    <category term="è°ƒå’Œçº§æ•°" />
    <category term="å·®åˆ†" />
    <category term="æ€ç»´" />
    <category term="æ ‘å½¢ DP" />
    <category term="æœ€å°ç”Ÿæˆæ ‘" />
    <category term="SAM" />
    <category term="çŠ¶å‹" />
    <category term="åˆ†å—" />
    <category term="å¯æŒä¹…åŒ–" />
    <category term="ç¬›å¡å°”æ ‘" />
    <category term="é«˜ç»´å‰ç¼€å’Œ" />
    <category term="é—²è¯" />
    <category term="æ¬§æ‹‰å›è·¯" />
    <category term="æ ‘é“¾å‰–åˆ†" />
    <category term="é•¿é“¾å‰–åˆ†" />
    <category term="KMP" />
    <category term="border" />
    <category term="å­—ç¬¦ä¸²" />
    <category term="AC è‡ªåŠ¨æœº" />
    <category term="SA" />
    <category term="æ•°å­¦" />
    <category term="æ ‘ä¸Šå·®åˆ†" />
    <category term="FWT" />
    <category term="å †" />
    <category term="æ ‘çš„é‡å¿ƒ" />
    <category term="äºŒé¡¹å¼å®šç†" />
    <category term="äºŒé¡¹å¼åæ¼”" />
    <category term="è´ªå¿ƒ" />
    <category term="å‡æ‘Š" />
    <category term="è®¡æ•°" />
    <category term="ä¼˜åŒ–å»ºå›¾" />
    <category term="åæ‚”è´ªå¿ƒ" />
    <category term="è°ƒæ•´æ³•" />
    <category term="èƒŒåŒ…" />
    <category term="åšå¼ˆè®º" />
    <category term="DP ä¼˜åŒ–" />
    <category term="è™šæ ‘" />
    <category term="ç‚¹åˆ†æ²»" />
    <category term="WQS äºŒåˆ†" />
    <category term="é—µå¯å¤«æ–¯åŸºå’Œ" />
    <category term="slope trick" />
    <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
    <category term="çŠ¶å‹ DP" />
    <category term="ç»„åˆæ•°å­¦" />
    <category term="æ”¯é…å¯¹" />
    <category term="DDP" />
    <category term="å®¹æ–¥" />
    <category term="Kruskal é‡æ„æ ‘" />
    <category term="é«˜ç²¾åº¦" />
    <category term="æœ€çŸ­è·¯" />
    <category term="æè¶…çº¿æ®µæ ‘" />
    <entry>
        <id>https://xsc062.netlify.app/20250924/</id>
        <title>æœ€çŸ­è·¯ç»ƒä¹ </title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250924/"/>
        <content type="html">&lt;p&gt;æœ€çŸ­è·¯ä¸ºèƒŒæ™¯çš„é¢˜ + åšæ³•æ˜¯æœ€çŸ­è·¯çš„é¢˜&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---minimum-path&#34;&gt;A - Minimum Path&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1473E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1473E&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç»å…¸å¥—è·¯ï¼Œå‘ç°å¯ä»¥æŠŠ max å’Œ min æ¢æˆä»»æ„è·¯å¾„ä¸­çš„è¾¹ï¼Œç„¶å max å’Œ min å°±ä¼šæœ€å°åŒ–è¿™ä¸ªå¼å­&lt;/li&gt;
&lt;li&gt;æ•…å†™ä¸€ä¸ª Dijkstra + DPï¼Œæ±‚è¿™ä¸ªå¼å­çš„æœ€å°å€¼å³å¯&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    std::vector&amp;lt;brr&amp;gt; dis(2, brr(2, arr(n + 1, 1e18))), vis(2, brr(2, arr(n + 1)));
    for (int x, y, w; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w;
        g[x].emplace_back(y, w);
        g[y].emplace_back(x, w);
    &amp;#125;
    dis[0][0][1] = 0;
    std::array&amp;lt;std::array&amp;lt;std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt;, 2&amp;gt;, 2&amp;gt; q;
    q[0][0].emplace(0, 1);
    for (int i = 0; i &amp;lt; 2; ++i) &amp;#123;
        for (int j = 0; j &amp;lt; 2; ++j) &amp;#123;
            for (; !q[i][j].empty(); ) &amp;#123;
                int f = q[i][j].top().second;
                q[i][j].pop();
                if (vis[i][j][f])
                    continue;
                vis[i][j][f] = 1;
                for (auto k : g[f]) &amp;#123;
                    if (dis[i][j][k.first] &amp;gt; dis[i][j][f] + k.second) &amp;#123;
                        dis[i][j][k.first] = dis[i][j][f] + k.second;
                        q[i][j].emplace(-dis[i][j][k.first], k.first);
                    &amp;#125;
                    if (!i &amp;amp;&amp;amp; dis[1][j][k.first] &amp;gt; dis[i][j][f]) &amp;#123;
                        dis[1][j][k.first] = dis[i][j][f];
                        q[1][j].emplace(-dis[1][j][k.first], k.first);
                    &amp;#125;
                    if (!j &amp;amp;&amp;amp; dis[i][1][k.first] &amp;gt; dis[i][j][f] + 2 * k.second) &amp;#123;
                        dis[i][1][k.first] = dis[i][j][f] + 2 * k.second;
                        q[i][1].emplace(-dis[i][1][k.first], k.first);
                    &amp;#125;
                &amp;#125;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    for (int i = 2; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; std::min(&amp;#123; dis[0][0][i], dis[1][1][i] &amp;#125;) &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---train-delay&#34;&gt;B - Train Delay&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://vjudge.net/contest/750645#problem/B&#34; class=&#34;uri&#34;&gt;https://vjudge.net/contest/750645#problem/B&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç®€åŒ–é¢˜ç›®å¾ˆé‡è¦çš„ä¸€ä¸ªè½¬åŒ–æ˜¯&lt;strong&gt;ç”±äº &lt;span class=&#34;math inline&#34;&gt;\(S\le T\)&lt;/span&gt; å¸¦æ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ°ä½å¹³ç­‰ï¼Œè€ƒè™‘æŠŠå‡ºå‘å’Œåˆ°è¾¾åˆ†åˆ«çœ‹ä½œä¸€æ¬¡äº‹ä»¶å¤„ç†ã€‚&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æŒ‰ç…§æ‰€æœ‰äº‹ä»¶çš„å‘ç”Ÿæ—¶åˆ»æ’åºï¼Œæœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºä¸€æ¬¡å‡ºå‘äº‹ä»¶ï¼Œå¯ä»¥å¾—åˆ°åœ¨å…¶ä¹‹å‰è¯¥ç«™ç‚¹æ‰€æœ‰åˆ°è¾¾äº‹ä»¶çš„ &lt;span class=&#34;math inline&#34;&gt;\(\max\{T&amp;#39;\}\)&lt;/span&gt;ï¼Œç”¨ä¹‹æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºä¸€æ¬¡åˆ°è¾¾äº‹ä»¶ï¼Œç”±äºå¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(X\)&lt;/span&gt; å·²ç»ç¡®å®šï¼Œæ›´æ–°è¯¥ç«™ç‚¹å½“å‰æœ€å¤§å€¼å³å¯ã€‚&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; d(m + 1);
    std::cin &amp;gt;&amp;gt; d[1];
    struct event &amp;#123;
        int t, op, id, x;
    &amp;#125;;
    std::vector&amp;lt;event&amp;gt; a;
    std::vector&amp;lt;int&amp;gt; mx(n + 1);
    for (int i = 1, x, y, s, t; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t;
        a.push_back(&amp;#123; s, 0, i, x &amp;#125;);
        a.push_back(&amp;#123; t, 1, i, y &amp;#125;);
    &amp;#125;
    std::sort(a.begin(), a.end(), [&amp;amp;](event &amp;amp;x, event &amp;amp;y) &amp;#123; return x.t == y.t ? x.op &amp;gt; y.op : x.t &amp;lt; y.t; &amp;#125;);
    for (auto [t, op, id, x] : a)
        if (op == 1)
            mx[x] = std::max(mx[x], t + d[id]);
        else if (id != 1)
            d[id] = std::max(mx[x] - t, 0);
    for (int i = 2; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; d[i] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---complete-the-graph&#34;&gt;C - Complete The Graph&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF715B&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF715B&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç¥ä»™äºŒåˆ†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœåˆå§‹æŠŠæ‰€æœ‰ç™½è¾¹ç½®ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œé‚£ä¹ˆä¼šæƒ³åˆ°è°ƒæ•´æ³•æ„é€ &lt;/li&gt;
&lt;li&gt;ä½†æ˜¯ä¸çŸ¥é“åº”è¯¥åœ¨å“ªäº›è¾¹ä¸Šè°ƒæ•´ï¼Œç¡®å®šè°ƒæ•´å¤šå°‘ä¼¼ä¹ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç®€å•çš„åšæ³•&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…&lt;strong&gt;å¹³å‡ç”¨åŠ›&lt;/strong&gt;ï¼Œæ„é€ ä¸€ä¸ª è¾¹1 += 1ï¼Œè¾¹2 += 1ï¼Œè¾¹3 += 1, â€¦, è¾¹cnt0 += 1, è¾¹1 += 1, è¾¹2 += 1, â€¦ çš„æ“ä½œåºåˆ—&lt;/p&gt;
å®¹æ˜“&lt;strong&gt;å‘ç°æ¯æ¬¡æ“ä½œæœ€å¤šè®©å½“å‰æœ€çŸ­è·¯é•¿åº¦å¢åŠ  1&lt;/strong&gt;ï¼Œè€Œä¸”æœ‰å•è°ƒæ€§&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ•…äºŒåˆ†ç­”æ¡ˆå³å¯&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const __int128 inf = 1e18;
const __int128 inff = 1e23;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, s, t, l, cnt = 0;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; l &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t, ++s, ++t;
    std::vector&amp;lt;std::tuple&amp;lt;int, int, long long&amp;gt; &amp;gt; u(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, long long&amp;gt; &amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt;= m; ++i) &amp;#123;
        long long w;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w, ++x, ++y;
        if (w == 0)
            w = -(++cnt);
        g[x].emplace_back(y, w), g[y].emplace_back(x, w);
        u[i] = &amp;#123; x, y, w &amp;#125;;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; vis(n + 1);
    std::vector&amp;lt;__int128&amp;gt; dis(n + 1);
    std::vector&amp;lt;long long&amp;gt; k(cnt + 1);
    __int128 res = -1;
    auto check = [&amp;amp;](__int128 x) &amp;#123;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            k[i] = x / cnt + (i &amp;lt;= x % cnt);
        std::fill(vis.begin() + 1, vis.end(), 0);
        std::fill(dis.begin() + 1, dis.end(), inf);
        std::priority_queue&amp;lt;std::pair&amp;lt;__int128, int&amp;gt; &amp;gt; q;
        dis[s] = 0, q.emplace(0, s);
        for (; !q.empty(); ) &amp;#123;
            int f = q.top().second;
            q.pop();
            if (vis[f])
                continue;
            vis[f] = 1;
            for (auto [v, w] : g[f]) &amp;#123;
                if (w &amp;lt; 0)
                    w = k[-w];
                if (dis[v] &amp;gt; dis[f] + w) &amp;#123;
                    dis[v] = dis[f] + w;
                    q.emplace(-dis[v], v);
                &amp;#125;
            &amp;#125;
        &amp;#125;
        return dis[t] &amp;lt;= l;
    &amp;#125;;
    for (__int128 l = cnt, r = cnt * inf, mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        if (check(mid))
            res = mid, l = mid + 1;
        else
            r = mid - 1;
    &amp;#125;
    if (res == -1)
        std::cout &amp;lt;&amp;lt; &amp;quot;NO\n&amp;quot;;
    else &amp;#123;
        check(res);
        if (dis[t] != l)
            std::cout &amp;lt;&amp;lt; &amp;quot;NO\n&amp;quot;;
        else &amp;#123;
            std::cout &amp;lt;&amp;lt; &amp;quot;YES\n&amp;quot;;
            for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
                auto [x, y, w] = u[i];
                if (w &amp;lt; 0)
                    w = k[-w];
                std::cout &amp;lt;&amp;lt; x - 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; y - 1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; w &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            &amp;#125;
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---é‡åŠ›çƒ&#34;&gt;A - é‡åŠ›çƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7473&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7473&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ç›¸å¯¹å¾ˆå°ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆåŸºäº &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; çš„åšæ³•&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡çƒåœä¸‹çš„ä½ç½®ä¸€å®šæ˜¯æŸä¸ªéšœç¢ç‰©ï¼ˆæˆ–è¾¹ç•Œï¼‰ä¸Š / ä¸‹ / å·¦ / å³çš„æ ¼å­ï¼Œæ•…å¯ä»¥åœ¨è¿™ &lt;span class=&#34;math inline&#34;&gt;\(O(n + m)\)&lt;/span&gt; ä¸ªç‚¹ä¸Šå»ºå›¾&lt;/li&gt;
&lt;li&gt;æ€ä¹ˆåŒæ—¶ç»´æŠ¤ä¸¤ä¸ªçƒçš„ä¿¡æ¯å‘¢ï¼Œå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; è¿˜æ˜¯å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥æŠŠä¸¤ä¸ªçƒå¡ä¸€èµ·ä½œä¸ºä¸€ä¸ªçŠ¶æ€&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(m^2\)&lt;/span&gt; æ¬¡ Dij è¿˜æ˜¯å¤ªæ¿€è¿›äº† è¿›ä¸€æ­¥æ€è€ƒå‘ç°å¯èƒ½çš„ç»ˆç‚¹å…± &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ª å¹¶ä¸”å½¼æ­¤ä¸åŒºåˆ†&lt;/p&gt;
&lt;p&gt;æ•…ä»¥è¿™ &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt; ä¸ªç»ˆç‚¹è·‘å¤šæºæœ€çŸ­è·¯å³å¯&lt;/p&gt;
&lt;p&gt;ä½† 5e6 è·‘ Dij è¿˜æ˜¯å¤ªå‹‰å¼ºäº†ã€‚&lt;strong&gt;å‘ç°è¾¹æƒä¸º 1ï¼Œä¸ºä»€ä¹ˆä¸ BFS å‘¢ ğŸ˜…&lt;/strong&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°èµ·ç‚¹å¯èƒ½ä¸åœ¨æˆ‘ä»¬é™å®šçš„ç‚¹ä¸Šï¼Œä½†å¯ä»¥äººä¸ºé€‰æ‹©ä¸€æ¬¡é‡åŠ›æ–¹å‘ï¼Œç„¶åå°±å›åˆ°åˆšåˆšçš„é—®é¢˜äº†&lt;/p&gt;
&lt;p&gt;æˆ–è€…ç¦»çº¿ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç–‘ä¼¼å¸¸æ•°å¤ªå¤§ï¼Œæ‹¼å°½å…¨åŠ›å‹‰å¼ºå¡è¿‡&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#ifdef ONLINE_JUDGE
inline int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf)
            return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
#else
#define nec getchar
#endif
inline bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF)
            return 0;
        if (ch == &amp;#39;-&amp;#39;)
            f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f)
        x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0) &amp;#123;
        putchar(&amp;#39;-&amp;#39;);
        x = -x;
    &amp;#125;
    if (x &amp;gt;= 10)
        print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x);
    putchar(ch);
    return;
&amp;#125;
const int inf = 0x3f3f3f3f;
const int dir[][2] = &amp;#123;&amp;#123; -1, 0 &amp;#125;, &amp;#123; 1, 0 &amp;#125;, &amp;#123; 0, -1 &amp;#125;, &amp;#123; 0, 1 &amp;#125;&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, q;
    read(n), read(m), read(q);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; pos(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; a(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 1, x, y; i &amp;lt;= m; ++i) &amp;#123;
        read(x), read(y);
        pos[i] = &amp;#123; x, y &amp;#125;, a[x][y] = -1;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(0, i), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(i, n + 1), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(n + 1, i), ++m;
    for (int i = 1; i &amp;lt;= n; ++i)
        pos.emplace_back(i, 0), ++m;
    int cnt = 0;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; u(1);
    for (int i = 1; i &amp;lt;= m; ++i)
        for (auto [fx, fy] : dir) &amp;#123;
            int nx = pos[i].first + fx, ny = pos[i].second + fy;
            if (nx &amp;gt;= 1 &amp;amp;&amp;amp; nx &amp;lt;= n &amp;amp;&amp;amp; ny &amp;gt;= 1 &amp;amp;&amp;amp; ny &amp;lt;= n &amp;amp;&amp;amp; !a[nx][ny])
                a[nx][ny] = ++cnt, u.emplace_back(nx, ny);
        &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; &amp;gt; top(n + 1, std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; (n + 1));
    for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
        for (int i = 1; i &amp;lt;= n; ++i)
            if (a[i][j] != -1) &amp;#123;
                if (i == 1 || a[i - 1][j] == -1)
                    top[i][j][0] = a[i][j];
                else
                    top[i][j][0] = top[i - 1][j][0];
            &amp;#125;
        for (int i = n; i; --i)
            if (a[i][j] != -1) &amp;#123;
                if (i == n || a[i + 1][j] == -1)
                    top[i][j][1] = a[i][j];
                else
                    top[i][j][1] = top[i + 1][j][1];
            &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (int j = 1; j &amp;lt;= n; ++j)
            if (a[i][j] != -1) &amp;#123;
                if (j == 1 || a[i][j - 1] == -1)
                    top[i][j][2] = a[i][j];
                else
                    top[i][j][2] = top[i][j - 1][2];
            &amp;#125;
        for (int j = n; j; --j)
            if (a[i][j] != -1) &amp;#123;
                if (j == n || a[i][j + 1] == -1)
                    top[i][j][3] = a[i][j];
                else
                    top[i][j][3] = top[i][j + 1][3];
            &amp;#125;
    &amp;#125;
    const int N = cnt * cnt;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(N + 1);
    auto encode = [&amp;amp;](int x, int y) &amp;#123;
        return (x - 1) * cnt + y;
    &amp;#125;;
    auto decode = [&amp;amp;](int id) &amp;#123;
        return std::make_pair((id - 1) / cnt + 1, (id - 1) % cnt + 1);
    &amp;#125;;
    for (int i = 1; i &amp;lt;= N; ++i)
        for (int j = 0; j &amp;lt; 4; ++j) &amp;#123;
            auto [a, b] = decode(i);
            g[encode(top[u[a].first][u[a].second][j], top[u[b].first][u[b].second][j])].emplace_back(i);
        &amp;#125;
    std::vector&amp;lt;int&amp;gt; dis(N + 1, inf), vis(N + 1);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            dis[encode(i, i)] = 0, q.push(encode(i, i)), vis[encode(i, i)] = 1;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop();
            for (auto i : g[x])
                if (!vis[i])
                    dis[i] = dis[x] + 1, vis[i] = 1, q.push(i);
        &amp;#125;
    &amp;#125;
    for (int a, b, c, d; q--; ) &amp;#123;
        read(a), read(b), read(c), read(d);
        if (a == c &amp;amp;&amp;amp; b == d)
            print(0, &amp;#39;\n&amp;#39;);
        else &amp;#123;
            int res = inf;
            for (int j = 0; j &amp;lt; 4; ++j)
                res = std::min(res, dis[encode(top[a][b][j], top[c][d][j])] + 1);
            if (res == inf)
                print(-1, &amp;#39;\n&amp;#39;);
            else
                print(res, &amp;#39;\n&amp;#39;);
        &amp;#125;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---çŸ©é˜µæ¸¸æˆ&#34;&gt;B - çŸ©é˜µæ¸¸æˆ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7515&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7515&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æŠŠé—®é¢˜å½¢å¼åŒ–ä¸€ä¸‹ï¼Œç°åœ¨æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\times m\)&lt;/span&gt; ä¸ªæœªçŸ¥æ•°å’Œ &lt;span class=&#34;math inline&#34;&gt;\((n-1)\times (m-1)\)&lt;/span&gt; ä¸ªæ–¹ç¨‹&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥å¯¹è¾¹ä¸Šä¸€åœˆä»»æ„èµ‹å€¼ï¼Œé™åˆ¶æ˜¯å·¦ä¸Šè§’è¿™ &lt;span class=&#34;math inline&#34;&gt;\((n-1)\times (m-1)\)&lt;/span&gt; ä¸ªæœªçŸ¥æ•°å¿…é¡»è½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\([0,10^6]\)&lt;/span&gt; ä¸Š&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æœ‰ä¸€ä¸ªå¾ˆå®¹æ˜“è§‚å¯Ÿåˆ°çš„æ€§è´¨ï¼Œå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œé€‰å–ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼Œå¹¶æŠŠæ£‹ç›˜é»‘ç™½æŸ“è‰²ï¼Œé‚£ä¹ˆæŠŠæ‰€æœ‰é»‘æ ¼ &lt;span class=&#34;math inline&#34;&gt;\(+=v\)&lt;/span&gt;ï¼Œç™½æ ¼ &lt;span class=&#34;math inline&#34;&gt;\(-=v\)&lt;/span&gt;ï¼Œå¯¹åº”çš„ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; æ˜¯ä¸ä¼šå˜çš„ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;strong&gt;è¿™ä¸ªæ“ä½œæ˜¯æ¶‰åŠå…¨å±€çš„ï¼Œå¤ªè‹›åˆ»äº†&lt;/strong&gt;ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´ mild çš„æ„é€ ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å‘ç°åªå¯¹ä¸€è¡Œ / åˆ—é»‘ç™½æŸ“è‰²å¹¶æ“ä½œä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚èƒ½æ„Ÿå—åˆ°&lt;strong&gt;æ“ä½œæ— æ³•å†ç®€åŒ–äº†&lt;/strong&gt;ã€‚è€ƒè™‘ç”¨è¿™ä¸ªç‰ˆæœ¬çš„æ“ä½œ&lt;strong&gt;è°ƒæ•´&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;æ•…å¤§åŠ›ä»¤å‘¨å›´ä¸€åœˆçš„ä¸´æ—¶è§£ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt;ï¼Œä»¤æ¯è¡Œã€åˆ—çš„è°ƒæ•´ delta ä¸º &lt;span class=&#34;math inline&#34;&gt;\(r_i,c_i\)&lt;/span&gt;ï¼Œå¯ä»¥å¾—åˆ°è‹¥å¹²ä¸ªå…³äº &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(10^6\)&lt;/span&gt; çš„çº¦æŸã€‚æœ€åå»ºå‡ºæ¥ä¸€ä¸ªå®Œå…¨äºŒåˆ†å›¾çŠ¶ç‰©ï¼Œè·‘å·®åˆ†çº¦æŸå³å¯ï¼Œå®¹æ˜“å‘ç°å¤æ‚åº¦æ­£ç¡®ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®ç°æŠ€å·§ï¼šè§„åˆ’ä¸€ä¸‹ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; çš„æŸ“è‰²æ–¹å¼ï¼Œä½¿å¾—å®ƒä»¬é”™å¼€ï¼Œå¯ä»¥æŠŠæ‰€æœ‰ä½ç½®éƒ½å†™ä½œ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;_{i,j}+c-r\)&lt;/span&gt; æˆ– &lt;span class=&#34;math inline&#34;&gt;\(a&amp;#39;_{i,j}+r-c\)&lt;/span&gt; çš„å½¢å¼ï¼Œä¾¿äºå·®åˆ†çº¦æŸ&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---tax&#34;&gt;C - Tax&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6822&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6822&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å®¹æ˜“æƒ³åˆ°åˆ†ç±»è®¨è®ºï¼Œå¦‚æœé’¦å®šæ˜¯å…¥è¾¹è´¡çŒ®è¾¹æƒï¼Œé‚£ä¹ˆå‡ºè¾¹è¾¹æƒä¸èƒ½å¤§äºå…¥è¾¹è¾¹æƒï¼›å¦åˆ™ï¼Œå‡ºè¾¹è´¡çŒ®è¾¹æƒã€‚&lt;/li&gt;
&lt;li&gt;è€ƒè™‘æŠŠæ¯ä¸ªç‚¹ä¸Šçš„å‡ºè¾¹æŒ‰è¾¹æƒä»å°åˆ°å¤§æ’åºï¼Œæ˜¾ç„¶éœ€è¦å…¥è¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µå‰ç¼€ï¼Œéœ€è¦å‡ºè¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µåç¼€ï¼Œå°±å¯ä»¥åšä¸€ä¸ªå‰åç¼€ä¼˜åŒ–å»ºå›¾ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    struct edge &amp;#123; int v, w, id, pi, si; &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;edge&amp;gt; &amp;gt; g1(n + 2);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(1);
    int cnt = 0;
    for (int x, y, w; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y &amp;gt;&amp;gt; w;
        g1[x].push_back(&amp;#123; y, w, ++cnt, 0, 0 &amp;#125;);
        g1[y].push_back(&amp;#123; x, w, ++cnt, 0, 0 &amp;#125;);
        g.emplace_back(), g.emplace_back();
    &amp;#125;
    int s = ++cnt, t = ++cnt;
    g1[0].push_back(&amp;#123; 1, 0, s, 0, 0 &amp;#125;), g1[n].push_back(&amp;#123; n + 1, 0, t, 0, 0 &amp;#125;);
    g.emplace_back(), g.emplace_back();
    for (int i = 0; i &amp;lt;= n + 1; ++i)
        if (!g1[i].empty()) &amp;#123;
            std::sort(g1[i].begin(), g1[i].end(), [&amp;amp;](edge &amp;amp;x, edge &amp;amp;y) &amp;#123; return x.w &amp;lt; y.w; &amp;#125;);
            for (int j = 0; j &amp;lt; (int)g1[i].size(); ++j) &amp;#123;
                g1[i][j].pi = ++cnt, g.emplace_back();
                if (j != 0)
                    g[cnt].emplace_back(cnt - 1, 0);
                g[cnt].emplace_back(g1[i][j].id, 0);
            &amp;#125;
            for (int j = (int)g1[i].size() - 1; ~j; --j) &amp;#123;
                g1[i][j].si = ++cnt, g.emplace_back();
                if (j != (int)g1[i].size() - 1)
                    g[cnt].emplace_back(cnt - 1, 0);
                g[cnt].emplace_back(g1[i][j].id, g1[i][j].w);
            &amp;#125;
        &amp;#125;
    for (int i = 0; i &amp;lt;= n + 1; ++i)
        for (auto &amp;amp;[v, w, id, pi, si] : g1[i]) &amp;#123;
            auto to = std::upper_bound(g1[v].begin(), g1[v].end(), w, [&amp;amp;](int x, edge &amp;amp;y) &amp;#123; return x &amp;lt; y.w; &amp;#125;);
            if (to != g1[v].end())
                g[id].emplace_back(to-&amp;gt;si, 0);
            if (to != g1[v].begin())
                g[id].emplace_back((--to)-&amp;gt;pi, w);
        &amp;#125;
    std::vector&amp;lt;int&amp;gt; vis(cnt + 1, 0);
    std::vector&amp;lt;long long&amp;gt; dis(cnt + 1, inf);
    std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; q;
    dis[s] = 0, q.emplace(0, s);
    for (; !q.empty(); ) &amp;#123;
        int f = q.top().second;
        q.pop();
        if (vis[f])
            continue;
        vis[f] = 1;
        for (auto [v, w] : g[f])
            if (dis[v] &amp;gt; dis[f] + w) &amp;#123;
                dis[v] = dis[f] + w;
                q.emplace(-dis[v], v);
            &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; dis[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---travelling-through-the-snow-queens-kingdom&#34;&gt;D - Travelling Through the Snow Queenâ€™s Kingdom&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF685E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF685E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ç›®å‰è§è¿‡çš„æ•°æ®èŒƒå›´æç¤ºæ€§æå¼±ï¼ˆè¯¯å¯¼æ€§æå¼ºï¼‰çš„å¾ªç¯ç»“æ„é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;[BZOJ3620] ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/20240906/#å­—ç¬¦åˆå¹¶&#34;&gt;å­—ç¬¦åˆå¹¶&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;/20250907/#e---subset-product-problem&#34;&gt;[ARC205E] Subset Product Problem&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ­£èµ›å› ä¸ºæœ‰éƒ¨åˆ†åˆ†ï¼Œåº”è¯¥ä¸ä¼šå‡ºç°ä¸æ•¢å†™çš„é—®é¢˜&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘ç¦»çº¿è¯¢é—®ï¼Œé€†åºåŠ è¾¹ï¼›åŸæ–‡æ— è¾¹æƒï¼›è¾¹çš„é€šè¡Œæ—¶åˆ»åªå†³å®šåˆ°è¾¾ç‚¹çš„æ—¶åˆ»ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å€Ÿé‰´ &lt;a href=&#34;/20231113/#b.-å•†äºº&#34;&gt;merchant&lt;/a&gt; ä¸­çš„æ€è·¯ï¼Œåªéœ€è¦æ›´æ–°å½“å‰è¾¹ä¸¤ä¾§ç‚¹ä¸ºèµ·ç‚¹çš„ DP æ•°ç»„ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„è¾¹ä»æŸç§æ„ä¹‰ä¸Šè¯´æ˜¯ã€æœ‰å‘ã€çš„ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m, q;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; q;
    struct query &amp;#123; int r, s, t, id; &amp;#125;;
    std::vector&amp;lt;int&amp;gt; res(q + 1);
    std::vector&amp;lt;std::vector&amp;lt;query&amp;gt; &amp;gt; u(m + 1);
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; e(m + 1);
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cin &amp;gt;&amp;gt; e[i].first &amp;gt;&amp;gt; e[i].second;
    for (int i = 1, l, r, s, t; i &amp;lt;= q; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t;
        u[l].push_back(&amp;#123; r, s, t, i &amp;#125;);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1, std::vector&amp;lt;int&amp;gt; (n + 1, inf));
    for (int i = m; i; --i) &amp;#123;
        auto [x, y] = e[i];
        g[x][y] = g[y][x] = i;
        for (int j = 1; j &amp;lt;= n; ++j)
            g[x][j] = g[y][j] = std::min(g[x][j], g[y][j]);
        for (auto [r, s, t, id] : u[i])
            if (g[s][t] &amp;lt;= r)
                res[id] = 1;
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        std::cout &amp;lt;&amp;lt; (res[i] ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---culture-code&#34;&gt;E - Culture Code&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1197E&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1197E&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å…ˆæŒ‰ &lt;span class=&#34;math inline&#34;&gt;\(out\)&lt;/span&gt; æ’åºï¼Œåšä¸€ä¸ªå‰ç¼€ä¼˜åŒ–å»ºå›¾ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å®¹æ˜“å‘ç°é™¤äº†æœ€å¤–å±‚ï¼Œæ¯ä¸€ä¸ªå¥—å¨ƒéƒ½ä¼šæä¾› &lt;span class=&#34;math inline&#34;&gt;\(in_i-out_i\)&lt;/span&gt; çš„ä»£ä»·ï¼Œè€Œæœ€å¤–å±‚ä¼šæä¾› &lt;span class=&#34;math inline&#34;&gt;\(in_x\)&lt;/span&gt; çš„ä»£ä»·ã€‚&lt;/p&gt;
&lt;del&gt;å¥½åœ¨è¦æ±‚çš„æ˜¯æœ€é•¿è·¯ï¼Œè¿™æ ·å°±å¯ä»¥ Dij äº†&lt;/del&gt;ï¼Œå¹¶ä¸éœ€è¦çœŸæ­£æŠŠå›¾å»ºå‡ºæ¥ï¼Œå‘ç°è¿™ä¸ªå½¢å¼æ›´åºåˆ—ï¼Œç›´æ¥åœ¨åºåˆ—ä¸ŠäºŒåˆ†å‰ç¼€ + DP å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;æ±‚æ–¹æ¡ˆæ˜¯å®¹æ˜“çš„ã€‚æœ€åç»Ÿè®¡ DP å€¼æœ€å¤§ï¼Œ&lt;strong&gt;ä¸”ä¸èƒ½è¢«å…¶ä»–å¥—å¨ƒåŒ…å«çš„å…ƒç´ &lt;/strong&gt;å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;Tipï¼šåœ¨æ±‚è§£è¿‡ç¨‹ä¸­å¹¶ä¸ç”¨è€ƒè™‘å½“å‰å…ƒç´ å’Œå‰ç¼€ min å…ƒç´ é—´èƒ½å¦åŠ å…¥å…¶ä»–å¥—å¨ƒï¼Œå› ä¸ºä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(out&amp;gt;in\)&lt;/span&gt;ï¼Œå¦‚æœå­˜åœ¨è¿™æ ·çš„å¥—å¨ƒï¼Œå…¶ DP å€¼ä¼šæ¯”å‰ç¼€ min æ›´å°ï¼ŒçŸ›ç›¾ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; a(n + 1);
    int mxi = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i].first &amp;gt;&amp;gt; a[i].second;
        mxi = std::max(mxi, a[i].second);
    &amp;#125;
    std::sort(a.begin() + 1, a.end());
    std::vector&amp;lt;long long&amp;gt; g(n + 1), mxg(n + 1), f(n + 1), mx(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int j = std::upper_bound(a.begin() + 1, a.begin() + i, std::make_pair(a[i].second, 0x3f3f3f3f)) - a.begin() - 1;
        if (j == 0)
            f[i] = a[i].second, g[i] = 1ll;
        else
            f[i] = mx[j] + a[i].second, g[i] = mxg[j];
        long long now = f[i] - a[i].first;
        if (now &amp;lt; mx[i - 1])
            mx[i] = now, mxg[i] = g[i];
        else if (now == mx[i - 1])
            mx[i] = now, mxg[i] = (mxg[i - 1] + g[i]) % mod;
        else
            mx[i] = mx[i - 1], mxg[i] = mxg[i - 1];
    &amp;#125;
    auto now = 0x3f3f3f3fll, res = 0ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (a[i].first &amp;lt;= mxi)
            continue;
        if (f[i] &amp;lt; now)
            now = f[i], res = g[i];
        else if (f[i] == now)
            (res += g[i]) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---awesome-arrowland-adventure&#34;&gt;A - Awesome Arrowland Adventure&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6233&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6233&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ²¡ä»€ä¹ˆå¥½è¯´çš„å»ºå›¾ï¼Œæ³¨æ„åªèƒ½é¡ºæ—¶é’ˆè½¬&lt;/li&gt;
&lt;li&gt;ä»£ç ç•¥&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---åœ°é“çº¿è·¯&#34;&gt;B - åœ°é“çº¿è·¯&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6096&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6096&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è€ƒè™‘åšä¸€ä¸ªç¥ç§˜æ‹†ç‚¹ï¼ŒæŠŠæ¯ä¸ªç‚¹é™„ä¸Šçº¿è·¯å’Œè¿è¡Œæ–¹å‘çš„ä¿¡æ¯ï¼ˆæ‰€ä»¥æ˜¯å•å‘çš„ï¼‰&lt;/li&gt;
&lt;li&gt;è®¤ä¸ºè·¯å¾„ä»£ä»·æ˜¯äºŒå…ƒç»„ï¼Œé‚£ä¹ˆåŒæ¡çº¿è·¯ä¸­çš„ç‚¹é€šè¡Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\((0,-1)\)&lt;/span&gt;&lt;/li&gt;
&lt;li&gt;æ¢ä¹˜éœ€è¦ä¼˜åŒ–å»ºå›¾ï¼Œæ¯ä¸ªç‚¹å¯ä»¥èŠ± &lt;span class=&#34;math inline&#34;&gt;\((0,0)\)&lt;/span&gt; çš„ä»£ä»·èµ°åˆ°è¿™ä¸ªç‚¹çš„ã€æ¢ä¹˜ç‚¹ã€ï¼Œå†èŠ± &lt;span class=&#34;math inline&#34;&gt;\((1,0)\)&lt;/span&gt; çš„ä»£ä»·èµ°åˆ°å¦ä¸€ä¸ªåˆ†ç‚¹&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½† &lt;strong&gt;15 å¹´çš„æ—¶å€™ SPFA å·²ç»æ­»äº†&lt;/strong&gt;ï¼Œæ‰€ä»¥éœ€è¦å¥½å¥½è€ƒè™‘æ€ä¹ˆå®ç°æœ€çŸ­è·¯ã€‚&lt;/p&gt;
&lt;p&gt;åˆ†ä¸¤é—®æ˜¯æœ‰æç¤ºæ€§åœ¨çš„ï¼Œå¯ä»¥æƒ³åˆ° 01 BFS è§£å†³ç¬¬ä¸€ä¸ªå…³é”®å­—ï¼Œæ¯”è¾ƒå¯¹çš„æƒ³æ³•æ˜¯&lt;strong&gt;æŠŠæ‰€æœ‰æœ€çŸ­è·¯æ‹¿å‡ºæ¥å½¢æˆ DAGï¼Œåœ¨ DAG ä¸Šå¯¹ç¬¬äºŒå…³é”®å­— DP&lt;/strong&gt;ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; m &amp;gt;&amp;gt; n;
    std::unordered_map&amp;lt;std::string, int&amp;gt; tab;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; l(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::tuple&amp;lt;int, int, int&amp;gt; &amp;gt; &amp;gt; g0(n + 1), g1(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s, tab[s] = i;
    &amp;#125;
    int tot = n;
    for (int i = 1, k; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; k;
        int lp = 0, lq = 0;
        for (std::string s; k--; ) &amp;#123;
            std::cin &amp;gt;&amp;gt; s;
            int p = ++tot, q = ++tot, id = tab[s];
            g0.emplace_back(), g0.emplace_back();
            g1.emplace_back(), g1.emplace_back();
            if (lp) &amp;#123;
                g0[p].emplace_back(lp, 0, 1), g0[lq].emplace_back(q, 0, 1);
                g1[lp].emplace_back(p, 0, 1), g1[q].emplace_back(lq, 0, 1);
            &amp;#125;
            g0[p].emplace_back(id, 0, 0), g0[id].emplace_back(p, 1, 0);
            g1[id].emplace_back(p, 0, 0), g1[p].emplace_back(id, 1, 0);
            g0[q].emplace_back(id, 0, 0), g0[id].emplace_back(q, 1, 0);
            g1[id].emplace_back(q, 0, 0), g1[q].emplace_back(id, 1, 0);
            l[id].push_back(p), l[id].push_back(q);
            lp = p, lq = q;
        &amp;#125;
    &amp;#125;
    int s, t;
    &amp;#123;
        std::string s1, s2;
        std::cin &amp;gt;&amp;gt; s1 &amp;gt;&amp;gt; s2;
        s = ++tot, t = tab[s2];
        g0.emplace_back(), g1.emplace_back();
        int p = tab[s1];
        for (auto i : l[p])
            g0[s].emplace_back(i, 1, 0), g1[i].emplace_back(s, 1, 0);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; dis0(tot + 1, 0x3f3f3f3f), dis1(tot + 1, 0x3f3f3f3f);
    auto BFS = [&amp;amp;](decltype(g0) &amp;amp;g, decltype(dis0) &amp;amp;dis, int s) &amp;#123;
        std::deque&amp;lt;int&amp;gt; q;
        std::vector&amp;lt;int&amp;gt; vis(tot + 1);
        q.push_back(s), dis[s] = 0;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop_front();
            if (vis[x])
                continue;
            vis[x] = 1;
            for (auto [v, w1, w2] : g[x])
                if (dis[x] + w1 &amp;lt; dis[v]) &amp;#123;
                    dis[v] = dis[x] + w1;
                    if (w1 == 0)
                        q.push_front(v);
                    else
                        q.push_back(v);
                &amp;#125;
        &amp;#125;
        return;
    &amp;#125;;
    BFS(g0, dis0, s), BFS(g1, dis1, t);
    std::cout &amp;lt;&amp;lt; dis0[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    std::vector&amp;lt;int&amp;gt; deg(tot + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; g(tot + 1);
    for (int i = 1; i &amp;lt;= tot; ++i)
        for (auto [j, w1, w2] : g0[i])
            if (dis0[i] + dis1[j] + w1 == dis0[t])
                g[i].emplace_back(j, w2), ++deg[j];
    std::queue&amp;lt;int&amp;gt; q;
    for (int i = 1; i &amp;lt;= tot; ++i)
        if (!deg[i])
            q.push(i);
    std::vector&amp;lt;int&amp;gt; f(tot + 1);
    for (; !q.empty(); ) &amp;#123;
        int x = q.front();
        q.pop();
        for (auto [v, w] : g[x]) &amp;#123;
            f[v] = std::max(f[v], f[x] + w);
            if (!--deg[v])
                q.push(v);
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[t] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---droga-do-domu&#34;&gt;C - Droga do domu&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9402&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9402&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¿˜æ˜¯åšä¸€ä¸ªå’Œä¸Šä¸€é¢˜ç±»ä¼¼çš„ä¼˜åŒ–å»ºå›¾&lt;/li&gt;
&lt;li&gt;æ­¤å¤–å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ Dij ä¸Š DP äº†ã€‚&lt;strong&gt;å›¾æ²¡æœ‰ç¯&lt;/strong&gt;ï¼Œç›´æ¥æ‹“æ‰‘å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;å¯ä»¥æ»šåŠ¨ä¼˜åŒ–ç©ºé—´ï¼Œä½†ä¼¼ä¹å¹¶æ— å¿…è¦ã€‚ä»£ç ç•¥ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---tickets-p&#34;&gt;D - Tickets P&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7984&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7984&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ²¡ä»€ä¹ˆå¥½è¯´çš„çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œéš¾ç‚¹åœ¨äºå¦‚ä½•åŒæ—¶è·å– &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;&lt;p&gt;å‘ç°ä»æŸä¸ªç‚¹èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt;ï¼Œæœ‰ä¸€ç§ä¸åŠ£çš„èµ°æ³•ï¼š&lt;/p&gt;
&lt;img src=&#34;image.png&#34; /&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ç»´æŠ¤ä¸€ä¸‹æ¯ä¸ªç‚¹å•ç‹¬èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; çš„æœ€å°ä»£ä»·å’ŒåŒæ—¶èµ°åˆ° &lt;span class=&#34;math inline&#34;&gt;\(1,N\)&lt;/span&gt; çš„æœ€å°ä»£ä»·&lt;/p&gt;
çœ‹åˆ°ä¸€ç§æ›´åŠ å¯¹çš„å†™æ³•æ˜¯&lt;strong&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_v+w(u,v)\)&lt;/span&gt; æ›´æ–° &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt;&lt;/strong&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;é‚£ä¹ˆå¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(1,N\)&lt;/span&gt; å‡ºå‘åšä¸€ä¸ª Dijã€‚ä»£ç ç•¥ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---ç›‘ç‹±&#34;&gt;E - ç›‘ç‹±&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9520&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9520&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;æ³¨æ„è¦èµ°ç®€å•è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨ç»•è·¯è®©é“çš„å¯èƒ½æ€§ã€‚å®¹æ˜“æ¨å‡ºï¼šè‹¥è¾“å…¥åˆæ³•ï¼Œæ€»èƒ½æ‰¾åˆ°ä¸€ç§æ–¹å¼ä½¿å¾—æ¯ä¸ªäººå—åˆ°çš„æŒ‡ä»¤æ˜¯è¿ç»­ç»™å‡ºçš„ã€‚&lt;/p&gt;
&lt;p&gt;P.S. è¿™ä¸ªç»“è®ºæŒªåˆ°å›¾ä¸Šå°±ä¸æˆç«‹äº†ï¼Œå¾ˆå®¹æ˜“ä¸¾å‡ºåä¾‹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;image-1.png&#34; /&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;è‹¥ä¸€ä¸ªäººçš„èµ·ç‚¹ / ç»ˆç‚¹åœ¨å¦ä¸€ä¸ªäººçš„è·¯å¾„ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªäººä¹‹é—´å­˜åœ¨å…ˆåå…³ç³»ã€‚å»ºå›¾åæ£€æŸ¥æ˜¯å¦ä¸º DAG å³å¯ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä½†å»ºå›¾æ˜¾ç„¶æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œå®¹æ˜“æ„é€ å‡ºæ•°æ®ä½¿å¾—è¾¹æ•°æ¥åˆ° &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; çº§åˆ«ã€‚è€ƒè™‘ä¼˜åŒ–å»ºå›¾ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°å¯ä»¥ç”¨ä¸€ä¸ªæ ‘å‰– / å€å¢çš„ç»“æ„æ¥å»ºå›¾ã€‚&lt;/p&gt;
Tipsï¼šè¿™ä¸€ç‚¹åŒæ ·æ˜¯ä¸€ä¸ªæ ‘ä¸Šè·¯å¾„é—®é¢˜ã€‚å‚è§ &lt;a href=&#34;/20231117/#æ ‘ä¸Šé—®é¢˜&#34;&gt;æ ‘ä¸Šé—®é¢˜ï¼Œå€å¢å’Œæ ‘å‰–çš„é€‰æ‹©ï¼Ÿ&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;è¿™é‡Œçš„è·¯å¾„è¦æ±‚ä¸¤ç«¯éƒ½æ˜¯å¼€çš„ï¼Œè¿™å°±å¯¼è‡´å€å¢å†™ç€å¾ˆå›°éš¾ï¼ˆè™½ç„¶æ ‘å‰–å¯èƒ½ä¹Ÿæ˜¯ï¼‰ï¼Œä¸æ’é™¤æˆ‘å†™ä¸‘äº†&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int K = 19;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;01-02.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, m;
        std::cin &amp;gt;&amp;gt; n;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
        std::vector&amp;lt;int&amp;gt; s(n + 1), t(n + 1);
        for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
            g1[x].push_back(y), g1[y].push_back(x);
        &amp;#125;
        std::cin &amp;gt;&amp;gt; m;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(m + 1);
        std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; a(m + 1);
        for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; a[i].first &amp;gt;&amp;gt; a[i].second;
            s[a[i].first] = i;
            t[a[i].second] = i;
        &amp;#125;
        int cnt = m;
        struct node &amp;#123; int fa, i0, i1; &amp;#125;;
        std::vector&amp;lt;std::array&amp;lt;node, K + 1&amp;gt; &amp;gt; p(n + 1);
        std::vector&amp;lt;int&amp;gt; i0(n + 1), i1(n + 1), dep(n + 1), deg(m + 1);
        auto init = [&amp;amp;](void) &amp;#123;
            g.emplace_back(), deg.emplace_back();
            return ++cnt;
        &amp;#125;;
        auto add = [&amp;amp;](int x, int y) &amp;#123;
            g[x].push_back(y), ++deg[y];
            return;
        &amp;#125;;
        for (int i = 1; i &amp;lt;= n; ++i)
            i0[i] = init(), i1[i] = init();
        std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
            if (s[x])
                add(s[x], i1[x]);
            if (t[x])
                add(i0[x], t[x]);
            for (auto i : g1[x])
                if (i != fa) &amp;#123;
                    dep[i] = dep[x] + 1;
                    p[i][0].fa = x;
                    p[i][0].i0 = init(), p[i][0].i1 = init();
                    add(p[i][0].i0, i0[i]), add(i1[i], p[i][0].i1);
                    for (int j = 1; j &amp;lt;= K; ++j) &amp;#123;
                        p[i][j].fa = p[p[i][j - 1].fa][j - 1].fa;
                        if (!p[i][j].fa)
                            break;
                        p[i][j].i0 = init(), p[i][j].i1 = init();
                        add(p[i][j].i0, p[i][j - 1].i0);
                        add(p[i][j].i0, p[p[i][j - 1].fa][j - 1].i0);
                        add(p[i][j - 1].i1, p[i][j].i1);
                        add(p[p[i][j - 1].fa][j - 1].i1, p[i][j].i1);
                    &amp;#125;
                    DFS(i, x);
                &amp;#125;
            return;
        &amp;#125;;
        dep[1] = 1, DFS(1, -1);
        for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
            auto [x, y] = a[i];
            if (x == y)
                continue;
            if (t[x])
                add(i, t[x]);
            if (s[y])
                add(s[y], i);
            if (dep[x] &amp;lt; dep[y])
                std::swap(x, y);
            x = p[x][0].fa;
            if (dep[x] &amp;gt;= dep[y]) &amp;#123;
                for (int j = K; ~j; --j)
                    if (dep[p[x][j].fa] &amp;gt;= dep[y]) &amp;#123;
                        add(i, p[x][j].i0), add(p[x][j].i1, i);
                        x = p[x][j].fa;
                    &amp;#125;
                if (x == y)
                    continue;
                add(i, p[x][0].i0), add(p[x][0].i1, i);
                x = p[x][0].fa;
            &amp;#125;
            y = p[y][0].fa;
            if (x != y) &amp;#123;
                for (int j = K; ~j; --j)
                    if (p[x][j].fa != p[y][j].fa) &amp;#123;
                        add(i, p[x][j].i0), add(i, p[y][j].i0);
                        add(p[x][j].i1, i), add(p[y][j].i1, i);
                        x = p[x][j].fa, y = p[y][j].fa;
                    &amp;#125;
                add(i, p[x][0].i0), add(i, p[y][0].i0);
                add(p[x][0].i1, i), add(p[y][0].i1, i);
                x = p[x][0].fa;
            &amp;#125;
            add(i, i0[x]), add(i1[x], i);
        &amp;#125;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= cnt; ++i)
            if (!deg[i])
                q.push(i);
        int tot = 0;
        for (; !q.empty(); ) &amp;#123;
            int x = q.front();
            q.pop(), ++tot;
            for (auto i : g[x])
                if (!--deg[i])
                    q.push(i);
        &amp;#125;
        std::cout &amp;lt;&amp;lt; (tot == cnt ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="äºŒåˆ†" />
        <category term="å€å¢" />
        <category term="è°ƒæ•´æ³•" />
        <category term="æœ€çŸ­è·¯" />
        <updated>2025-09-24T06:27:15.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250824/</id>
        <title>æ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250824/"/>
        <content type="html">&lt;p&gt;ä¸ä¼šçš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šäº†&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-k-set-tree&#34;&gt;B. K-Set Tree&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1691F&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1691F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(F_i\)&lt;/span&gt; è¡¨ç¤ºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºæ ¹æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å­æ ‘å†…çš„ç­”æ¡ˆã€‚åˆ™ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
F_u=\left(C_{siz_u}^k-\sum C_{siz_v}^k\right)\cdot siz_u+\sum F_v\\
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç›´æ¥æ¢æ ¹æ˜¯å¾ˆå¤æ‚çš„ï¼›æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\sum C_{siz_v}^k\)&lt;/span&gt; è®°ä½œ &lt;span class=&#34;math inline&#34;&gt;\(dp_u\)&lt;/span&gt;ï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(\sum F_v\)&lt;/span&gt; è®°ä½œ &lt;span class=&#34;math inline&#34;&gt;\(f_u\)&lt;/span&gt;ï¼Œé‚£ä¹ˆï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
res=\sum(C_n^k-dp_u)\cdot n+f_u\\
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™æ ·åšæ˜¯ä¸ºäº†æŠŠä¸¤ä¸ªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æœ‰å…³çš„ä¹˜é¡¹æ‹†å¼€æ¥æ¢æ ¹&lt;/strong&gt;ï¼Œå®é™…æ¢æ ¹çš„æ—¶å€™å°±åªç”¨åˆ†åˆ«æ¢ &lt;span class=&#34;math inline&#34;&gt;\(f,dp\)&lt;/span&gt; ä¸¤ä¸ªå€¼ï¼Œä¸ç”¨è€ƒè™‘äºŒæ¬¡é¡¹ç­‰é—®é¢˜ï¼Œè®¡ç®—é‡ä¼šå°‘å¾ˆå¤š&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        if (m &amp;gt; n)
            return 0ll;
        return fac[n] * inv[m] % mod * inv[n - m] % mod;
    &amp;#125;;
    auto res(0ll);
    std::vector&amp;lt;int&amp;gt; siz(n + 1), ss(n + 1);
    std::vector&amp;lt;long long&amp;gt; f(n + 1), dp(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        siz[x] = 1;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                (f[x] += (C(siz[i], k) - dp[i]) * siz[i] + f[i]) %= mod;
                (dp[x] += C(siz[i], k)) %= mod;
                siz[x] += siz[i];
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        (res += (C(n, k) - dp[x]) * n + f[x]) %= mod;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                (f[i] += (C(n - siz[i], k) - (dp[x] - C(siz[i], k))) * (n - siz[i]) + f[x] - f[i] - (C(siz[i], k) - dp[i]) * siz[i]) %= mod;
                (dp[i] += C(n - siz[i], k)) %= mod;
                DFS(i, x);
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; (res + mod) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c.-li-hua-and-path&#34;&gt;C. Li Hua and Path&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/CF1797F&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/CF1797F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘&lt;strong&gt;å®¹æ–¥&lt;/strong&gt;ï¼Œåˆ†åˆ«æ±‚è§£æ»¡è¶³ 1ã€æ»¡è¶³ 2ã€æ»¡è¶³ 12ï¼ˆæ³¨æ„è¦å‡ä¸¤å€ï¼‰å°±èƒ½è®¡ç®—ç­”æ¡ˆ&lt;/p&gt;
&lt;p&gt;å‘ç°é¢˜ç›®æ‰€æ±‚ç‚¹å¯¹å½¢å¼å¾ˆç¬¦åˆ Kruskal é‡æ„æ ‘çš„è¦æ±‚ï¼Œè€ƒè™‘ä»¥å¯¹åº”ç‚¹æƒä¸ºè¾¹æƒï¼Œåˆ†åˆ«å»ºç«‹ minï¼Œmax Kruskal ç‚¹æƒå¤šå‰é‡æ„æ ‘ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;ç‚¹æƒå¤šå‰é‡æ„æ ‘ï¼Ÿ&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ç‚¹æƒä¸Šåš Kruskal é‡æ„æ ‘æ—¶ï¼Œå‘ç°è¾¹çš„è™šç‚¹æ˜¯ä¸å¿…è¦çš„ï¼Œå¯ä»¥ç›´æ¥å°†æ›´ä¼˜ç‚¹ä½œä¸ºçˆ¶äº²ã€‚&lt;/p&gt;
&lt;p&gt;å†™çš„æ—¶å€™æœ‰ç‚¹éš¾æƒ³æ¸…æ¥šâ€¦â€¦ å¯ä»¥ç”»ç”»å›¾ï¼Œä»”ç»†ç¡®å®šä¸€ä¸‹ Kruskal é‡æ„æ ‘çš„å…·ä½“æ€§è´¨&lt;/p&gt;
&lt;p&gt;è¿™æ ·åšçš„ä¼˜åŠ¿æ˜¯æ²¡æœ‰è™šç‚¹ï¼Œä¸€äº›é—®é¢˜ä¼šæ–¹ä¾¿ä¸€äº›ï¼›ä½†åŒæ—¶æ”¾å¼ƒäº†äºŒå‰æ ‘çš„ç»“æ„ï¼Œä¸€äº›é¢˜å¯èƒ½æ²¡é‚£ä¹ˆå¥½åšã€‚&lt;/p&gt;
&lt;p&gt;è¿™é“é¢˜åªç”¨ç»å…¸ Kruskal é‡æ„æ ‘ä¹Ÿå¯ä»¥è§£å†³ã€‚&lt;/p&gt;
&lt;/details&gt;
&lt;p&gt;å‘ç° 1 2 å‡å¯ä»¥è½¬åŒ–æˆä¸¤æ£µæ ‘åœ¨ä¸¤æ£µæ ‘ä¸Šçš„ç¥–å­™å…³ç³»è¦æ±‚ï¼Œå¯ä»¥è½»æ¾åœ°åˆ†åˆ«ç»Ÿè®¡æ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„ç‚¹å¯¹æ•°é‡&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ€ä¹ˆå¤„ç†åŒæ—¶æ»¡è¶³ 12 çš„ï¼Œå‘ç°è¦æ±‚åœ¨ä¸¤æ£µæ ‘ä¸ŠäºŒè€…åº”è¯¥éƒ½å…·æœ‰ç¥–å­™å…³ç³»ï¼Œä¸”æ˜¯ç›¸åçš„ã€‚&lt;del&gt;å¯ä»¥è€ƒè™‘åœ¨ä¸€æ£µæ ‘ä¸Š DFS çš„åŒæ—¶ç”¨ä¸»å¸­æ ‘å­˜å‚¨ç¥–å…ˆï¼Œåœ¨å¦ä¸€é¢—æ ‘ä¸Š ask&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘ä»æ›´å®¹æ˜“ç”¨ dfn è¡¨ç¤ºçš„å­æ ‘é—®é¢˜æ€è€ƒï¼Œåœ¨ min æ ‘ä¸Šåˆ†é… dfn åï¼Œåœ¨ max æ ‘ä¸Šç”¨ DFS + å›æº¯å¾—åˆ°æ¯ä¸ªç‚¹å®æ—¶ç¥–å…ˆåºåˆ—ï¼Œå­˜åœ¨æ ‘çŠ¶æ•°ç»„é‡Œï¼›ask è¯¥ç‚¹è¢«åˆ†é…çš„ dfn å­æ ‘åŒºé—´å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘è¯¢é—®ï¼Œç”±äºæ¯æ¬¡åŠ å…¥çš„éƒ½æ˜¯ç¼–å·æœ€å¤§çš„ç‚¹ï¼Œå¯¹äºæ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„è´¡çŒ®æ˜¯æ˜¾ç„¶çš„ï¼Œè€ŒåŒæ—¶æ»¡è¶³ 12 çš„ç‚¹å°±æ˜¯åœ¨ min æ ‘ä¸Šçš„ç¥–å…ˆï¼Œéƒ½æ˜¯å¥½åšçš„ã€‚&lt;/p&gt;
&lt;p&gt;å®ç°çš„æ—¶å€™ä¸€å®šè¦æŠŠ min / max æ ‘å¯¹åº”çš„æ€§è´¨æ€è€ƒæ¸…æ¥šï¼Œä¸ç„¶ä¼šå¾ˆéº»çƒ¦&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; f1(n + 1), f2(n + 1);
    std::iota(f1.begin() + 1, f1.end(), 1);
    std::iota(f2.begin() + 1, f2.end(), 1);
    std::function&amp;lt;int(int)&amp;gt; find1 = [&amp;amp;](int x) &amp;#123;
        return x == f1[x] ? x : f1[x] = find1(f1[x]);
    &amp;#125;;
    std::function&amp;lt;int(int)&amp;gt; find2 = [&amp;amp;](int x) &amp;#123;
        return x == f2[x] ? x : f2[x] = find2(f2[x]);
    &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1), g2(n + 1), adj1(n + 1), adj2(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        if (x &amp;gt; y)
            std::swap(x, y);
        adj1[y].push_back(x);
        adj2[x].push_back(y);
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (auto j : adj1[i]) &amp;#123;
            int fi = find1(i), fj = find1(j);
            g1[fi].push_back(fj), f1[fj] = fi;
        &amp;#125;
    for (int i = n; i; --i)
        for (auto j : adj2[i]) &amp;#123;
            int fi = find2(i), fj = find2(j);
            g2[fi].push_back(fj), f2[fj] = fi;
        &amp;#125;
    std::vector&amp;lt;int&amp;gt; bit(n + 1), dfn(n + 1), rfn(n + 1);
    auto lowbit = [](int x) &amp;#123;
        return x &amp;amp; -x;
    &amp;#125;;
    auto add = [&amp;amp;](int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            bit[x] += v;
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        int res = 0;
        for (; x; x -= lowbit(x))
            res += bit[x];
        return res;
    &amp;#125;;
    int rt1 = 0, rt2 = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (f1[i] == i)
            rt1 = i;
        if (f2[i] == i)
            rt2 = i;
    &amp;#125;
    int q;
    std::cin &amp;gt;&amp;gt; q;
    std::vector&amp;lt;int&amp;gt; dep1(n + 1), dep2(n + q + 1);
    long long res = 0ll;
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now;
        res += dep1[x];
        for (auto i : g1[x]) &amp;#123;
            dep1[i] = dep1[x] + 1;
            DFS(i);
        &amp;#125;
        rfn[x] = now;
        return;
    &amp;#125;;
    DFS(rt1);
    DFS = [&amp;amp;](int x) &amp;#123;
        res += dep2[x];
        res -= 2 * (ask(rfn[x]) - ask(dfn[x] - 1));
        add(dfn[x], 1);
        for (auto i : g2[x]) &amp;#123;
            dep2[i] = dep2[x] + 1;
            DFS(i);
        &amp;#125;
        add(dfn[x], -1);
        return;
    &amp;#125;;
    DFS(rt2);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    for (int fa; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; fa;
        dep2[++n] = dep2[fa] + 1;
        res += (n - 1) - dep2[n];
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-å›¢é˜Ÿé€‰æ‹”&#34;&gt;D. å›¢é˜Ÿé€‰æ‹”&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6534/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6534/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œä»ä¸­ä»»é€‰ä¸€äº›äº’ä¸ç›¸äº¤çš„åŒºé—´ï¼Œæ»¡è¶³æ¯ä¸ªåŒºé—´å†…å…ƒç´ çš„ gcd ç›¸åŒã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^5,V\le 10^7\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ³¨æ„åˆ°å›ºå®šä¸€ä¸ªå·¦ç«¯ç‚¹åï¼Œç§»åŠ¨å³ç«¯ç‚¹ï¼Œgcd æ¯æ¬¡è‡³å¤šå‡å°åˆ°åŸæ¥çš„ä¸€åŠï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ç§ç±»æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\log V\)&lt;/span&gt; ç§ã€‚æ•…å…¨åºåˆ—çš„ gcd æ€»æ•°æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log V)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆå®¹æ˜“æƒ³åˆ°ä¸æ­¤åŸç†ç±»ä¼¼çš„å…¨å±€ç­”æ¡ˆæ±‚æ³•ï¼šå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œå‘å·¦å¤„ç†å‡ºæ¯ä¸€æ®µ &lt;span class=&#34;math inline&#34;&gt;\([l,r]\)&lt;/span&gt;ï¼Œæ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(\gcd(a_{l\cdots i})=\gcd(a_r\cdots i)\)&lt;/span&gt;ï¼Œå¹¶è®°å½•è¯¥ &lt;span class=&#34;math inline&#34;&gt;\(\gcd\)&lt;/span&gt;ã€‚è¿™æ ·æ±‚å‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\((i,l,r)\)&lt;/span&gt; å…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log V)\)&lt;/span&gt; æ®µã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸ª gcd æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i}=f_{i-1}+\sum\limits_{j=l_i}^{r_i} f_{j - 1}\)&lt;/span&gt;ï¼Œå¯ä»¥åšä¸€ä¸ªæ‰«æçº¿ï¼Œå¾—åˆ°å…¨å±€ç­”æ¡ˆï¼›å‘å‰å‘ååˆ†åˆ«åšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(i-1,i+1\)&lt;/span&gt;ï¼Œç›¸ä¹˜å°±èƒ½å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœªè¢«é€‰å–æ—¶çš„ç­”æ¡ˆ&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ€ä¹ˆå®Œæˆã€ç›¸ä¹˜ã€è¿™ä¸ªåŠ¨ä½œï¼šæœ€åçš„ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; åœ¨æ¯ä¸ªå³ç«¯ç‚¹å¤„å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥è½¬åŒ–æˆè‹¥å¹²æ®µ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt;ï¼›åè¿‡æ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;\)&lt;/span&gt; äº¦å¯ä»¥è¿™æ ·è½¬åŒ–ã€‚å°† &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; æ•´ä½“åç§»ä¸€ä½ã€&lt;span class=&#34;math inline&#34;&gt;\(f&amp;#39;\)&lt;/span&gt; æ•´ä½“å‰ç§»ä¸€ä½ï¼Œå°±å¯ä»¥å¯¹é½ã€‚äºŒè€…çš„ç«¯ç‚¹æ€»æ•°æ˜¯å‡æ‘Šå• log çš„ï¼ŒåŒºé—´æ€»æ•°ä¹Ÿå°±æ˜¯å‡æ‘Šå• log çš„ï¼ˆå½’å¹¶å°±èƒ½å¿«é€Ÿå¯»æ‰¾åˆ°åŒºé—´ï¼‰ï¼Œç”¨å·®åˆ†åšä¸€ä¸ªåŒºé—´åŠ å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨äºŒåˆ†å‹‰å¼ºå• log è§£å†³äº†è½¬ç§»ï¼›è¿˜çœ‹åˆ° &lt;span class=&#34;citation&#34; data-cites=&#34;spdarkle&#34;&gt;@spdarkle&lt;/span&gt; ç–‘ä¼¼åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; ä¸Šç›´æ¥åšçš„&lt;a href=&#34;http://222.180.160.110:61235/submission/3108272&#34;&gt;åšæ³•&lt;/a&gt;ï¼Œå’Œ &lt;span class=&#34;citation&#34; data-cites=&#34;Rosmist&#34;&gt;@Rosmist&lt;/span&gt; ç–‘ä¼¼ç›´æ¥åœ¨æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸Šåšçš„&lt;a href=&#34;http://222.180.160.110:61235/submission/3108581&#34;&gt;åšæ³•&lt;/a&gt;ã€‚å®˜è§£æ˜¯ä¸ªçœ‹ä¸æ‡‚çš„åšæ³•&lt;/p&gt;
&lt;p&gt;å‘ƒï¼Œå¥½åƒä¸€ä¸å°å¿ƒæ‹¿äº†æœ€ä¼˜è§£ã€‚è€Œä¸”ä¼˜åŠ¿å¾ˆæ˜æ˜¾ï¼ˆæ€ä¹ˆæ€»ç”¨æ—¶æ¯”åˆ«äººä¸€ä¸ªç‚¹è¿˜å°‘ï¼Ÿï¼‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¯èƒ½å› ä¸ºå¤§å®¶éƒ½çœ‹ä¸æ‡‚å®˜è§£ï¼Œåšæ³•æ¯”è¾ƒå¤šæ ·ï¼Ÿé™¤äº†æˆ‘ä¹‹å¤–æ¯”è¾ƒå¿«çš„ lwz å’Œ &lt;span class=&#34;citation&#34; data-cites=&#34;GoldSpade&#34;&gt;@GoldSpade&lt;/span&gt; éƒ½ç”¨å½’å¹¶å®Œæˆæœ€åä¸€æ­¥ï¼›æˆ‘è¾ƒä»–ä»¬çš„é¢å¤–ä¼˜åŠ¿å¤§æ¦‚æ˜¯ç”¨äºŒåˆ†æ¢æ‰äº†æ ‘çŠ¶æ•°ç»„ï¼Ÿè¿·æƒ‘&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;selection.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;selection.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;ex_selection2.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; st(20, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], st[0][i] = a[i];
    for (int j = 1; (1 &amp;lt;&amp;lt; j) &amp;lt;= n; ++j)
        for (int i = 1; i + (1 &amp;lt;&amp;lt; j) - 1 &amp;lt;= n; ++i)
            st[j][i] = std::__gcd(st[j - 1][i], st[j - 1][i + (1 &amp;lt;&amp;lt; (j - 1))]);
    auto askgcd = [&amp;amp;](int l, int r) &amp;#123;
        int k = std::__lg(r - l + 1);
        return std::__gcd(st[k][l], st[k][r - (1 &amp;lt;&amp;lt; k) + 1]);
    &amp;#125;;
    std::unordered_map&amp;lt;int, int&amp;gt; tab;
    struct node &amp;#123;
        int i, l, r;
        bool operator&amp;lt; (const int q) const &amp;#123;
            return i &amp;lt; q;
        &amp;#125;
        bool operator&amp;lt;= (const int q) const &amp;#123;
            return i &amp;lt;= q;
        &amp;#125;
    &amp;#125;;
    std::vector&amp;lt;std::vector&amp;lt;node&amp;gt; &amp;gt; p1, p2;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        for (int to = i; to &amp;gt;= 1; ) &amp;#123;
            int at = i, g = askgcd(to, i);
            for (int l = 1, r = to, mid; l &amp;lt;= r; ) &amp;#123;
                mid = (l + r) &amp;gt;&amp;gt; 1;
                if (askgcd(mid, i) == g)
                    at = mid, r = mid - 1;
                else
                    l = mid + 1;
            &amp;#125;
            if (!tab.count(g)) &amp;#123;
                tab[g] = (int)p1.size();
                p1.emplace_back(), p2.emplace_back();
            &amp;#125;
            p1[tab[g]].push_back(&amp;#123; i, at, to &amp;#125;);
            to = at - 1;
        &amp;#125;
        for (int to = i; to &amp;lt;= n; ) &amp;#123;
            int at = i, g = askgcd(i, to);
            for (int l = to, r = n, mid; l &amp;lt;= r; ) &amp;#123;
                mid = (l + r) &amp;gt;&amp;gt; 1;
                if (askgcd(i, mid) == g)
                    at = mid, l = mid + 1;
                else
                    r = mid - 1;
            &amp;#125;
            if (!tab.count(g)) &amp;#123;
                tab[g] = (int)p2.size();
                p1.emplace_back(), p2.emplace_back();
            &amp;#125;
            p2[tab[g]].push_back(&amp;#123; i, to, at &amp;#125;);
            to = at + 1;
        &amp;#125;
    &amp;#125;
    auto s(0ll);
    std::vector&amp;lt;int&amp;gt; x1(n + 1), x2(n + 2), pos(2 * n + 3);
    std::vector&amp;lt;long long&amp;gt; f1(n + 1), f2(n + 2), s1(n + 1), s2(n + 2), diff(n + 1);
    for (auto [g, id] : tab) &amp;#123;
        // printf(&amp;quot;g = %d: \n&amp;quot;, g);
        int n1 = (int)p1[id].size();
        x1[0] = 0, f1[0] = s1[0] = 1ll;
        for (int i = 1; i &amp;lt;= n1; ++i) &amp;#123;
            auto [x, L, R] = p1[id][i - 1];
            --L, --R;
            x1[i] = x, f1[i] = f1[i - 1];
            int l = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, L) - x1.begin() - 1,
                r = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, R) - x1.begin() - 1;
            if (l == r)
                (f1[i] += f1[l] * (R - L + 1)) %= mod;
            else &amp;#123;
                f1[i] += s1[r - 1] + mod - s1[l];
                f1[i] += f1[r] * (R - x1[r] + 1);
                f1[i] += f1[l] * (x1[l + 1] - L);
                f1[i] %= mod;
            &amp;#125;
            // printf(&amp;quot;  r = %d, l = [%d, %d]: %lld\n&amp;quot;, x, L, R, f1[i]);
            if (i != n1)
                s1[i] = (s1[i - 1] + f1[i] * (p1[id][i].i - x)) % mod;
        &amp;#125;
        (s += f1[n1] - 1) %= mod;
        int n2 = (int)p2[id].size();
        x2[n2 + 1] = n + 1, f2[n2 + 1] = s2[n2 + 1] = 1ll;
        for (int i = n2; i; --i) &amp;#123;
            auto [x, L, R] = p2[id][i - 1];
            ++L, ++R;
            x2[i] = x, f2[i] = f2[i + 1];
            int l = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, L) - x2.begin(),
                r = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, R) - x2.begin();
            if (l == r)
                (f2[i] += f2[l] * (R - L + 1)) %= mod;
            else&amp;#123;
                f2[i] += s2[l + 1] + mod - s2[r];
                f2[i] += f2[r] * (R - x2[r - 1]);
                f2[i] += f2[l] * (x2[l] - L + 1);
                f2[i] %= mod;
            &amp;#125;
            // printf(&amp;quot;  l = %d, r = [%d, %d]: %lld\n&amp;quot;, x, L, R, f2[i]);
            if (i != 1)
                s2[i] = (s2[i + 1] + f2[i] * (x - p2[id][i - 2].i)) % mod;
        &amp;#125;
        for (int i = 0; i &amp;lt; n1; ++i)
            x1[i] = x1[i + 1];
        x1[n1] = n;
        int t = (x2[1] == 1) + 1;
        for (int i = 1; i &amp;lt;= n2 + 1; ++i)
            --x2[i];
        std::merge(x1.begin(), x1.begin() + n1 + 1, x2.begin() + t, x2.begin() + n2 + 2, pos.begin() + 1);
        int m = std::unique(pos.begin() + 1, pos.begin() + n1 + n2 + 4 - t) - pos.begin() - 1;
        for (int i = 1, p1 = 0, p2 = t, la = 0; i &amp;lt;= m; ++i) &amp;#123;
            for (; p1 + 1 &amp;lt;= n1 &amp;amp;&amp;amp; x1[p1] &amp;lt; pos[i]; ++p1);
            for (; p2 + 1 &amp;lt;= n2 + 1 &amp;amp;&amp;amp; x2[p2] &amp;lt; pos[i]; ++p2);
            (diff[la + 1] += f1[p1] * f2[p2] + mod - 1) %= mod;
            // printf(&amp;quot;  [%d, %d]: %lld, %lld\n&amp;quot;, la + 1, pos[i], f1[p1], f2[p2]);
            if (pos[i] + 1 &amp;lt;= n)
                (diff[pos[i] + 1] += mod - f1[p1] * f2[p2] + 1) %= mod;
            la = pos[i];
        &amp;#125;
    &amp;#125;
    // std::cout &amp;lt;&amp;lt; s &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        (diff[i] += diff[i - 1]) %= mod;
        std::cout &amp;lt;&amp;lt; (s + mod - diff[i]) % mod &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;æˆ‘ä¸€å¼€å§‹å°† &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å®šä¹‰ä¸ºå•ç‚¹ç­”æ¡ˆè€Œéå‰ç¼€å’Œï¼Œä¼šå¯¼è‡´éœ€è¦çº¿æ®µæ ‘ç»´æŠ¤ç­‰å·®åºåˆ—ï¼Œè¿˜ä¸¢å¤±äº†ç­”æ¡ˆæ®µæ•°ä¸å¤šè¿™ä¸ªæ€§è´¨ï¼Œéå¸¸éº»çƒ¦ã€‚å°† &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; çš„æ„ä¹‰æ›¿æ¢ä¸ºå‰ç¼€å’Œåï¼Œå°±å¯ä»¥å¾ˆè½»æ¾åœ°åšäº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-å®‡å®™&#34;&gt;A. å®‡å®™&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6535/problem/1&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6535/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(a_{1\sim n}\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k=1,2,\cdots,n-1\)&lt;/span&gt;ï¼Œå›ç­”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä» &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; å¼€å§‹è‡ªå¢ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œéƒ½å¯ä»¥é€‰å– &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªäº’ä¸ç›¸åŒçš„ä¸‹æ ‡ï¼Œå¹¶ä½¿å®ƒä»¬å¯¹åº”çš„å…ƒç´ å¢åŠ  1ã€‚æ­¤æ—¶ï¼Œè‹¥å­˜åœ¨å…ƒç´ ä¸å¤§äº &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œåœæ­¢ã€‚è¾“å‡ºåœæ­¢æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯èƒ½çš„æœ€å¤§å€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^6,V\le 10^9\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‘ç°ä¸å¤§äºè¿™ä¸ª condition æœ‰äº›åäººç±»ï¼Œå…ˆå°† &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; å…¨éƒ¨å‡ 1ï¼Œè½¬åŒ–æˆå°äºæ¥è€ƒè™‘&lt;/p&gt;
&lt;p&gt;è€ƒè™‘èƒ½åšæŒåˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{a_j&amp;lt;i} i-a_j\le k\cdot i\)&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°è¯¥æ¡ä»¶åŒæ—¶æ˜¯å……åˆ†çš„ï¼Œå¯ä»¥æœæ‘©å°”æŠ•ç¥¨æ€è€ƒ&lt;/p&gt;
&lt;p&gt;å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æ’åºï¼Œåœæ­¢æ—¶å‚ä¸è¿ç®—çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; æ˜¯è¶Šæ¥è¶Šå¤šçš„ï¼Œæ•…è®°å½•æœ€åä¸€ä¸ªå‚ä¸è¿ç®—çš„ä¸‹æ ‡ï¼Œé€æ­¥æŒªåŠ¨ï¼ˆå½“å‘ç°è§£å‡ºæ¥çš„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¯”ä¸‹ä¸€ä¸ªæ›´å¤§æ—¶å°±éœ€è¦æŒªåŠ¨ï¼‰ï¼ŒåŒæ—¶è§£ä¸ç­‰å¼å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;citation&#34; data-cites=&#34;Quack&#34;&gt;@Quack&lt;/span&gt; äº‘æˆ‘åœ¨åœºä¸Šèƒ½æƒ³å‡ºå®˜è§£å¯¹æˆ‘æ¥è¯´æ˜¯éå¸¸äº†ä¸èµ·çš„ï¼ˆå…¶å®åœºä¸Šå†™æ­£è§£çš„äººå°‘å¾—å‡ºå¥‡ï¼‰ï¼Œæˆ‘ä¹Ÿä¸å¾—ä¸æ‰¿è®¤æˆ‘èƒ½åšå‡ºæ¥ç¡®å®æœ‰ä¸€å®šè¿æ°”æˆåˆ†ï¼Œä¹Ÿèƒ½ä»ä¸­ä¸€çª¥æˆ‘ä»¤äººçœ¼å‰ä¸€é»‘çš„æ•°å­¦ç´ å…»ï¼&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
    std::freopen(&amp;quot;universe.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;universe.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    int n;
    std::cin &amp;gt;&amp;gt; n, std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], --a[i];
    std::sort(a.begin() + 1, a.end());
    int id = 1;
    long long s = a[1];
    for (int i = 1; i &amp;lt; n; ++i) &amp;#123;
        if (id &amp;lt; i + 1)
            s += a[++id];
        long long x = s / (id - i);
        for (; id != n &amp;amp;&amp;amp; x &amp;gt; a[id + 1]; s += a[++id], x = s / (id - i));
        std::cout &amp;lt;&amp;lt; x &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b.-è·³è·ƒ&#34;&gt;B. è·³è·ƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6535/problem/2&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6535/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®šé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„ 01 åºåˆ—å’Œè·³è·ƒä¸Šé™ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ã€‚ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(q\)&lt;/span&gt; ä¸ªè¯¢é—®ï¼Œå›ç­”ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä» &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; è·³åˆ° &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œä¿è¯ &lt;span class=&#34;math inline&#34;&gt;\(a,b\)&lt;/span&gt; çš„é¢œè‰²å‡ä¸º 1ï¼Œæ¯æ¬¡ä¸èƒ½è·³è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ ¼æˆ–è·³å‡ºå»ï¼Œåœ¨æœ€å°åŒ–è¸©åˆ° 0 æ•°é‡çš„å‰æä¸‹ï¼Œæœ€å°åŒ–è·³è·ƒæ¬¡æ•°ï¼Œè¾“å‡ºè¿™ä¸¤ä¸ªå€¼ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n,q\le5\times10^5\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®¹æ˜“å‘ç°åªèƒ½å¾€ä¸€ä¸ªæ–¹å‘è·³ï¼Œé‚£ä¹ˆä¸å¦¨ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a&amp;lt;b\)&lt;/span&gt;ã€‚æœ‰ä¸€ä¸ªè´ªå¿ƒçš„æƒ³æ³•æ˜¯èƒ½å¾€å³å°±å¾€å³ï¼Œæ‰‹ç©å‘ç°&lt;strong&gt;æ˜¯å¯¹çš„&lt;/strong&gt;ï¼ˆæˆ‘åœºä¸Šæ‰‹ç©è¿‡ååšå®šåœ°è®¤ä¸ºæ˜¯é”™çš„ï¼›å¯èƒ½å’Œæ²¡æ—¶é—´äº†å…µè’é©¬ä¹±æœ‰å…³ï¼‰ã€‚è¿™æ ·å°±å¾ˆå¥½æƒ³åˆ°ç¬¬äºŒé—®éœ€è¦å€å¢ï¼›ä½†æŠŠä¸¤ä¸ªé—®ç»“åˆèµ·æ¥è€ƒè™‘æ˜¯æœ‰ç‚¹å›°éš¾çš„ï¼Œèµ›æ—¶å°±æ„è¯†åˆ°è¿™ä¸¤é—®çš„è”ç³»æ²¡æœ‰çœ‹èµ·æ¥é‚£ä¹ˆå¤§ï¼Œç”šè‡³å¾ˆå¯èƒ½æ˜¯å‰²è£‚çš„ã€‚&lt;/p&gt;
&lt;p&gt;å•ç‹¬è€ƒè™‘ç¬¬ä¸€é—®ï¼Œå‘ç°å¯¹äºä¸€æ®µé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; çš„ 0ï¼Œéœ€è¦è¸©åˆ°æ°å¥½ &lt;span class=&#34;math inline&#34;&gt;\(\left\lfloor\dfrac {len}k\right\rfloor\)&lt;/span&gt; ä¸ª 0ã€‚ç­”æ¡ˆå®¹æ˜“è®¡ç®—ã€‚&lt;/p&gt;
&lt;p&gt;å•ç‹¬è€ƒè™‘ç¬¬äºŒé—®ï¼Œè€ƒè™‘ä¸€ä¸ªç¬¬ä¸€é—®ç­”æ¡ˆå›ºå®šä¸º 0 çš„æƒ…å†µï¼Œä¹Ÿå³æ¯ä¸ª len éƒ½æ¯” &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; å°ã€‚åˆ™é—®é¢˜è½¬åŒ–æˆåœ¨ä¸è¸© 0 çš„æƒ…å†µä¸‹æœ€å°çš„æ­¥æ•°ã€‚å®¹æ˜“ç”¨å€å¢è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬é¢˜æœ€ä»¤äººå°è±¡æ·±åˆ»çš„ç‚¹åœ¨äºäºŒè€…çš„ç»“åˆï¼Œå‘ç°è¿™ &lt;span class=&#34;math inline&#34;&gt;\(\left\lfloor\dfrac {len}k\right\rfloor\cdot k\)&lt;/span&gt; ä¸ª 0 æ˜¯æ— è®ºå¦‚ä½•éƒ½ä¼šè¢«ç»è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨åŸå§‹æ•°ç»„é‡Œåˆ æ‰å®ƒä»¬ï¼Œè½¬åŒ–æˆåªè€ƒè™‘ç¬¬äºŒé—®çš„æƒ…å†µ&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;ï¼Ÿï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ‘å¯¹äºè‡ªå·±è«åå…¶å¦™è·‘å¾—æ¯”åˆ«äººå¿«ä¸€å¤§æˆªè¿™ä»¶äº‹æƒ…å·²ç»å¿«è¦è§æ€ªä¸æ€ªäº†ï¼Œè¿™æ¬¡åˆæ˜¯ä»€ä¹ˆåŸç†ï¼Œæˆ‘é¢„å¤„ç†å†™å¾—æ¯”è¾ƒæ¼‚äº®å—ï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;jump.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;jump.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, k, q, op;
    std::cin &amp;gt;&amp;gt; n, std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; q &amp;gt;&amp;gt; k &amp;gt;&amp;gt; op;
    std::vector&amp;lt;int&amp;gt; tmp(n + 1), a(1), s(1), to(n + 2);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t;
        tmp[i] = t - &amp;#39;0&amp;#39;;
    &amp;#125;
    tmp.push_back(1), ++n;
    int cnt = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (tmp[i] == 1) &amp;#123;
            a.push_back(1), to[i] = (int)a.size() - 1;
            s.push_back(s.back() + cnt), cnt = 0;
        &amp;#125;
        else &amp;#123;
            ++cnt;
            if (i == n || tmp[i + 1] == 1) &amp;#123;
                for (int j = 1; j &amp;lt;= cnt % k; ++j)
                    a.push_back(0), s.push_back(s.back());
                cnt /= k;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    n = (int)a.size() - 1;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; f(20, std::vector&amp;lt;int&amp;gt; (n + 1));
    for (int i = 0; i &amp;lt; 20; ++i)
        f[i][n] = n;
    for (int i = n - 1; i; --i) &amp;#123;
        f[0][i] = std::min(&amp;#123; n, i + k, f[0][i + 1] &amp;#125;);
        for (; !a[f[0][i]]; --f[0][i]);
        if (a[i] == 1) &amp;#123;
            for (int j = 1; j &amp;lt; 20; ++j)
                f[j][i] = f[j - 1][f[j - 1][i]];
        &amp;#125;
    &amp;#125;
    for (int a, b; q--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; a &amp;gt;&amp;gt; b;
        if (a &amp;gt; b)
            std::swap(a, b);
        a = to[a], b = to[b];
        std::cout &amp;lt;&amp;lt; s[b] - s[a];
        if (op == 1) &amp;#123;
            int res = s[b] - s[a];
            for (int i = 19; ~i; --i)
                if (f[i][a] &amp;lt; b)
                    a = f[i][a], res += (1 &amp;lt;&amp;lt; i);
            std::cout &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; res + 1;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-jongmah&#34;&gt;D. Jongmah&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/1110/problem/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/1110/problem/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°å½“è¿ç»­å‡ºç°ä¸‰æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\((i-1,i,i+1)\)&lt;/span&gt; æ—¶ï¼Œå¯ä»¥è¢«ä¸‰æ¬¡ç›¸åŒä»£æ›¿ï¼›&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°éœ€è¦ä½¿ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,a,b}\)&lt;/span&gt; æ¥ä»£è¡¨ DP åˆ° &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶ï¼Œç”¨äº† &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; ç»„ &lt;span class=&#34;math inline&#34;&gt;\((i-1,i,i+1)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt; ç»„ &lt;span class=&#34;math inline&#34;&gt;\((i,i+1,i+2)\)&lt;/span&gt; æ—¶çš„æœ€å¤§ç»„æ•°ï¼›&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¹¶æ²¡æœ‰æƒ³åˆ°è¦å°†äºŒè€…ç»“åˆèµ·æ¥ï¼æ„Ÿè§‰åº”è¯¥æ˜¯èƒ½æ¯”è¾ƒå¿«åšå‡ºæ¥çš„æ°´å¹³ã€‚èƒ½å¯Ÿè§‰åˆ°ä¸å¤ªè®¤çœŸã€‚æ‚”è¿‡ï¼&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; cnt(m + 1);
    for (int i = 1, x; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; x, ++cnt[x];
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; &amp;gt; f(m + 1, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (3, std::vector&amp;lt;int&amp;gt; (3, -inf)));
    f[0][0][0] = 0ll;
    for (int i = 1; i &amp;lt;= m; ++i)
        for (int a = 0; a &amp;lt;= 2; ++a) // i - 1, i, i + 1
            for (int b = 0; b &amp;lt;= 2; ++b) // i, i + 1, i + 2
                for (int c = 0; c &amp;lt;= 2; ++c) &amp;#123; // i - 2, i - 1, i
                    if (a + b + c &amp;gt; cnt[i]) continue;
                    f[i][a][b] = std::max(f[i][a][b], f[i - 1][c][a] + b + (cnt[i] - a - b - c) / 3);
                &amp;#125;
    std::cout &amp;lt;&amp;lt; f[m][0][0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e.-magic-stones&#34;&gt;E. Magic Stones&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/contest/1110/problem/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/contest/1110/problem/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®¹æ˜“æƒ³åˆ°è€ƒå¯Ÿå·®åˆ†æ•°ç»„ï¼Œå‘ç°è¿™ä¸ªæ“ä½œå°±æ˜¯äº¤æ¢äº†å·®åˆ†æ•°ç»„çš„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ã€‚æ•…å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„å·®åˆ†æ•°ç»„åˆ†åˆ«æ’åºï¼Œç„¶å check æ˜¯å¦ç›¸ç­‰å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), b(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; b[i];
    if (a[1] != b[1] || a[n] != b[n]) &amp;#123;
        std::cout &amp;lt;&amp;lt; &amp;quot;No&amp;quot; &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; da(n), db(n);
    std::adjacent_difference(a.begin() + 1, a.end(), da.begin());
    std::adjacent_difference(b.begin() + 1, b.end(), db.begin());
    std::sort(da.begin(), da.end());
    std::sort(db.begin(), db.end());
    std::cout &amp;lt;&amp;lt; (da == db ? &amp;quot;Yes&amp;quot; : &amp;quot;No&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="å€å¢" />
        <category term="æ ‘å½¢ DP" />
        <category term="Kruskal é‡æ„æ ‘" />
        <updated>2025-08-24T07:37:55.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20240106/</id>
        <title>æ‚é¢˜å…¨è°ˆ</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20240106/"/>
        <content type="html">&lt;p&gt;æƒ³ä¸åˆ°å¥½æ ‡é¢˜äº†ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;æœ‰å¥è¯æ€ä¹ˆè¯´æ¥ç€ï¼Œç½—é©¬ä¸æ˜¯ä¸€å¤©å»ºæˆçš„ï¼Œæ˜¯ä¸€å¤©å¤©å»ºæˆçš„ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä»€ä¹ˆï¼ŒDo in Rome as the Romansâ€™ doï¼Œè¿˜æœ‰ä¸€å¥ï¼ŒAll roads leads to Romeã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;a.-è¿ç»­çš„é›¶-zero&#34;&gt;A. è¿ç»­çš„é›¶ zero&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/4647/problem/1&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/4647/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;åšä¸ªå‰ç¼€å’Œï¼Œçœ‹çœ‹ä»»æ„ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„åŒºé—´ä¸­æœ‰å‡ ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;namespace XSC062 &amp;#123;
using namespace fastIO;
const int maxn = 5e5 + 5;
const int inf = 0x3f3f3f3f;
int n, m, res = inf;
int a[maxn], s[maxn];
int min(int x, int y) &amp;#123;
    return x &amp;lt; y ? x : y;
&amp;#125;
int main() &amp;#123;
    scanf(&amp;quot;%d %d&amp;quot;, &amp;amp;n, &amp;amp;m);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        scanf(&amp;quot;%1d&amp;quot;, &amp;amp;a[i]);
        s[i] = s[i - 1] + a[i];
        if (i &amp;gt;= m)
            res = min(res, s[i] - s[i - m]);
    &amp;#125;
    print(res, &amp;#39;\n&amp;#39;);
    return 0;
&amp;#125;
&amp;#125; // namespace XSC062&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;b.-åå›æ–‡ä¸²-anti&#34;&gt;B. åå›æ–‡ä¸² anti&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/4647/problem/2&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/4647/problem/2&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å½“ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¥‡æ—¶ï¼Œä¸­é—´çš„å…ƒç´ ä¸€å®šå’Œè‡ªå·±ç›¸ç­‰ï¼Œæ•…æ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;å½“æ•°é‡æœ€å¤šçš„ä¸€ä¸ªå­—ç¬¦ä¸ªæ•°è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac n2\)&lt;/span&gt; æ—¶ï¼Œç”±é¸½å·¢å¾—æ— è§£ã€‚&lt;/p&gt;
&lt;p&gt;å‰©ä¸‹çš„æƒ…å†µä¸€å®šæœ‰è§£ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;&lt;summary&gt;è¯æ˜&lt;/summary&gt;&lt;/p&gt;
&lt;p&gt;å¯ä»¥æ‰¾åˆ°ä¸€ç§åˆæ³•çš„æ„é€ æ–¹å¼ã€‚æˆ‘ä»¬åˆ—å‡ºä¸€ä¸ªåˆ—æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ï¼Œè¡Œæ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac n2\)&lt;/span&gt; çš„è¡¨æ ¼ï¼Œå°†æ‰€æœ‰ç›¸åŒå­—æ¯æ’åˆ—åœ¨ä¸€èµ·ï¼ŒæŒ‰ç…§ä»å·¦åˆ°å³ï¼Œä»ä¸Šåˆ°ä¸‹çš„æ–¹å¼å°†å­—æ¯å¡«å…¥è¡¨æ ¼ï¼Œæœ€åå°†ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¡Œç¬¬ä¸€åˆ—çš„å­—æ¯å¡«å…¥ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è¡Œç¬¬äºŒåˆ—çš„å­—æ¯å¡«å…¥ &lt;span class=&#34;math inline&#34;&gt;\(a_{n-i+1}\)&lt;/span&gt;ï¼Œå³å¯å®Œæˆæ„é€ ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ç§å­—æ¯åªåœ¨ç¬¬ä¸€åˆ—æˆ–ç¬¬äºŒåˆ—å‡ºç°å½“ç„¶åˆæ³•ï¼Œå¦‚æœä»ç¬¬ä¸€åˆ—æŒç»­åˆ°ç¬¬äºŒåˆ—ï¼Œå› ä¸ºä»»æ„å­—æ¯å‡ºç°æ¬¡æ•°ä¸è¶…è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac n2\)&lt;/span&gt; æ¬¡ï¼Œæ‰€ä»¥åŒä¸€è¡Œçš„ä¸¤åˆ—ä¸ä¼šå‡ºç°åŒä¸€ç§å­—æ¯ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å«ä»€ä¹ˆï¼Œæœ‰å­—è¯æ˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;æ„Ÿè§‰å¯ä»¥æ‹¿å»å‡ºä¸€é“ç±»ä¼¼äºã€Œæ‰¾åˆ°å­—ç¬¦ä¸²å­—å…¸åºæœ€å°çš„åå›æ–‡ä¸²ã€ä¹‹ç±»çš„å°æ°´é¢˜&lt;/del&gt;&lt;/p&gt;
&lt;/details&gt;
&lt;p&gt;ç„¶åç°åœ¨æˆ‘ä»¬çŸ¥é“æœ‰è§£äº†ï¼Œæ€ä¹ˆæ‰¾åˆ°æœ€ä¼˜è§£å‘¢ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚æœ‰ä¸€ç»„ &lt;span class=&#34;math inline&#34;&gt;\((a_i,a_{n-i+1})=(\texttt a, \texttt a)\)&lt;/span&gt;ï¼Œè¿˜æœ‰ä¸€ç»„ &lt;span class=&#34;math inline&#34;&gt;\((a_j, a_{n-j+1})=(\texttt b, \texttt b)\)&lt;/span&gt;ï¼Œé‚£æˆ‘ä»¬ç›´æ¥æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; äº¤æ¢ï¼Œçš†å¤§æ¬¢å–œã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±è¯´æ˜æˆ‘ä»¬éœ€è¦æŠŠå€¼ä¸ç›¸ç­‰çš„éæ³• &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt; é…å¯¹ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥æ²¿ç”¨è¯æ˜ä¸­çš„æ„é€ æ–¹å¼ï¼Œåˆ†ç»„é…å¯¹ï¼Œä¸€å®šæœ€ä¼˜ï¼Œæ¯ç»„ä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;åŒä¸€è¡Œä¸¤ä¸ªå€¼ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; ç›¸ç­‰ï¼Œå› ä¸ºå·²ç»æœ€ä¼˜äº†ï¼Œæ‰€ä»¥ä¸èƒ½å†åœ¨éæ³•ä¸²ä¸­å¯»æ‰¾ç­”æ¡ˆã€‚åº”è¯¥æ‰¾åˆæ³•å¯¹ä¸­æŸä¸ªå€¼äº¤æ¢ï¼Œæ¯ç»„ä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\)&lt;/span&gt;ã€‚å…·ä½“å’Œè°äº¤æ¢æˆ‘ä»¬ä¸ç”¨æ‹…å¿ƒï¼Œåªè¦æ‰¾åˆ°ä¸€ç»„ &lt;span class=&#34;math inline&#34;&gt;\((a_i,a_{n-i+1})\)&lt;/span&gt; æ»¡è¶³ &lt;span class=&#34;math inline&#34;&gt;\(a_i\ne v\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(a_{n-i+1}\ne v\)&lt;/span&gt; å°±å¯ä»¥äº†ï¼Œç„¶åæˆ‘ä»¬åˆçŸ¥é“ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ä¸ªæ•° &lt;span class=&#34;math inline&#34;&gt;\(\ne \dfrac n2\)&lt;/span&gt;ï¼Œå‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(\dfrac n2\)&lt;/span&gt; å¯¹ä¸­æ¯é˜Ÿéƒ½æœ‰è‡³å°‘ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼Œç”±äºå½“å‰è¿™ä¸€å¯¹æœ‰ä¸¤ä¸ªç›¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ä¸ªæ•°å°±ä¼šå¤§äº &lt;span class=&#34;math inline&#34;&gt;\(\dfrac n2\)&lt;/span&gt;ï¼ŒçŸ›ç›¾äº†ï¼Œæ‰€ä»¥ä¸€å®šèƒ½æ‰¾åˆ°ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºéæ³•æ€»å¯¹æ•°æ˜¯å¥‡æ•°çš„æƒ…å†µï¼Œæˆ‘ä»¬è¦é’¦å®šä¸€ä¸ªéæ³•å¯¹å¼ºåˆ¶è®©å…¶å’Œåˆæ³•å¯¹äº¤æ¢ï¼Œè´ªå¿ƒä¸€ä¸‹å–éæ³•å¯¹æ•°é‡æœ€å¤šçš„ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æŸä¸€å¯¹æœ€ä¼˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;namespace XSC062 &amp;#123;
using namespace fastIO;
const int maxm = 35;
const int maxn = 2e5 + 5;
char s[maxn];
int cnt[maxm], p[maxn];
int T, n, tot, res, now;
int main() &amp;#123;
    scanf(&amp;quot;%d&amp;quot;, &amp;amp;T);
    while (T--) &amp;#123;
        tot = 0;
        scanf(&amp;quot;%d %s&amp;quot;, &amp;amp;n, s + 1);
        if (n &amp;amp; 1) &amp;#123;
            puts(&amp;quot;-1&amp;quot;);
            continue;
        &amp;#125;
        memset(cnt, 0, sizeof (cnt));
        for (int i = 1; i &amp;lt;= n; ++i)
            ++cnt[s[i] - &amp;#39;a&amp;#39; + 1];
        for (int i = 1; i &amp;lt;= 26; ++i) &amp;#123;
            if (cnt[i] * 2 &amp;gt; n) &amp;#123;
                puts(&amp;quot;-1&amp;quot;);
                goto noSol;
            &amp;#125;
        &amp;#125;
        memset(cnt, 0, sizeof (cnt));
        for (int i = 1; i * 2 &amp;lt;= n; ++i) &amp;#123;
            if (s[i] == s[n - i + 1])
                ++cnt[s[i] - &amp;#39;a&amp;#39; + 1], ++tot;
        &amp;#125;
        std::sort(cnt + 1, cnt + 27,
                    std::greater&amp;lt;int&amp;gt;());
        res = now = 0;
        if (tot &amp;amp; 1) &amp;#123;
            res = 1, --cnt[1];
            std::sort(cnt + 1, cnt + 27,
                        std::greater&amp;lt;int&amp;gt;());
        &amp;#125;
        for (int i = 1; i &amp;lt;= 26; ++i) &amp;#123;
            while (cnt[i]--) &amp;#123;
                if (++now &amp;gt; tot / 2) &amp;#123;
                    if (i == p[now - tot / 2])
                        res += 2;
                    else ++res;
                &amp;#125;
                else p[now] = i;
            &amp;#125;
        &amp;#125;
        print(res, &amp;#39;\n&amp;#39;);
        noSol: ;
    &amp;#125;
    return 0;
&amp;#125;
&amp;#125; // namespace XSC062&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;c.-é™¤ä¸å‡-divsub&#34;&gt;C. é™¤ä¸å‡ divsub&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/4647/problem/3&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/4647/problem/3&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å°æ•°å­¦ï¼Œè¿˜å¥½ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(n=d\times k^p\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(k\nmid d\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæˆ‘ä»¬åˆ†ä¸¤ç§æƒ…å†µè®¨è®ºã€‚&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(p=0\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(k\nmid n\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(n\bmod k=1\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(k\mid (n-1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
è¿™ä¸ªæ—¶å€™é—® &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çš„ä¸ªæ•°å°±ç›¸å½“äºæ˜¯åœ¨é—® &lt;span class=&#34;math inline&#34;&gt;\(n-1\)&lt;/span&gt; é™¤ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä»¥å¤–çš„å› å­ä¸ªæ•°ã€‚å‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(n-1={x_1}^{p_1}{x_2}^{p_2}\cdots {x_m}^{p_m}\)&lt;/span&gt;ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\((\prod p_i+1)-1\)&lt;/span&gt;ï¼Œå‡å»çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(p\ne 0\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(k\mid n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆå¥½çš„è½¬åŒ–ã€‚å¥½æ¶ˆæ¯æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„èŒƒå›´æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(10^{12}\)&lt;/span&gt;ï¼Œæ ¹å·æšä¸¾å› æ•°å¤æ‚åº¦è·‘å¾—è¿‡ã€‚æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥æš´åŠ›åˆ¤å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„æ‰€æœ‰å› æ•°æ˜¯å¦æ»¡è¶³æ¡ä»¶ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ—¶é—´å¤æ‚åº¦ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n\times \log n)\)&lt;/span&gt;ï¼Œæšä¸¾å› æ•°æ˜¯æ ¹å·ï¼Œç®—æ¬¡æ•°ï¼ˆä¹Ÿå°±æ˜¯ç®— &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt;ï¼‰æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#define int long long
namespace XSC062 &amp;#123;
using namespace fastIO;
int n, m, res, cnt;
int main() &amp;#123;
    read(n), m = n;
    for (int i = 2; i * i &amp;lt;= n; ++i) &amp;#123;
        if (n % i == 0) &amp;#123;
            m = n;
            while (m % i == 0) m /= i;
            if (m % i == 1) ++res;
            if (i * i != n) &amp;#123;
                m = n;
                while (m % (n / i) == 0)
                    m /= (n / i);
                if (m % (n / i) == 1) ++res;
            &amp;#125;
        &amp;#125;
    &amp;#125;
    m = n - 1, cnt = 1;
    for (int i = 2; i * i &amp;lt;= m; ++i) &amp;#123;
        if (m % i == 0) &amp;#123;
            int now = 0;
            while (m % i == 0)
                ++now, m /= i;
            cnt *= now + 1;
        &amp;#125;
    &amp;#125;
    if (m != 1) cnt *= 2;
    print(res + cnt, &amp;#39;\n&amp;#39;);
    return 0;
&amp;#125;
&amp;#125; // namespace XSC062
#undef int&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;d.-å›¾ä¹¦ç®¡ç†å‘˜-librarian&#34;&gt;D. å›¾ä¹¦ç®¡ç†å‘˜ librarian&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/4647/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/4647/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;[SDOI2008] éƒé—·çš„å° Jã€‚&lt;/p&gt;
&lt;p&gt;å…³äºè¿™ä¸ªï¼Œæˆ‘ä»¬å‘ç°è‡ªå·±ä¸ä¼šè€ƒåœºç°å†²ä¸»å¸­æ ‘ã€‚å“ï¼Œæ‰“ CDQ åˆæ€•å†™æŒ‚ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‘ç°è¿™é“é¢˜çš„ä¿®æ”¹éƒ½æ˜¯å•ç‚¹çš„ï¼Œè¯¢é—®ä¹Ÿåªå…³äºæŸä¸€ç§é¢œè‰²ï¼Œä¸åŒçš„é¢œè‰²ä¹‹é—´æ²¡æœ‰å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;äºæ˜¯æˆ‘ä»¬å¯ä»¥æŠŠæ“ä½œç¦»çº¿ä¸‹æ¥ï¼Œåˆå§‹è§†ä½œå°†æŸé¢œè‰²åœ¨æŸä½ç½®å¢åŠ ï¼Œä¿®æ”¹è§†ä½œå°†æŸé¢œè‰²åœ¨æŸä½ç½®åˆ é™¤ï¼Œå°†å¦ä¸€é¢œè‰²åœ¨è¯¥ä½ç½®å¢åŠ ï¼Œå°†æ‰€æœ‰æ“ä½œæŒ‰é¢œè‰²ç¦»æ•£åŒ–åˆ†ç±»ç„¶å &lt;code&gt;vector&lt;/code&gt; ä¸‹æ¥ï¼Œå¯¹äºæ‰€æœ‰é¢œè‰²ä»å‰åˆ°åæ ‘çŠ¶æ•°ç»„åšä¸€éæ“ä½œå°±èƒ½ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n+q\log n)\)&lt;/span&gt; è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;æ ‘çŠ¶æ•°ç»„æ¸…ç©ºæ˜¯è‚¯å®šä¸èƒ½ &lt;code&gt;memset&lt;/code&gt; çš„ï¼Œå¤æ‚åº¦ä¸å¯¹ã€‚é‚£ä¹ˆæ€ä¹ˆåŠå‘¢ï¼ŸæŠŠæ‰€æœ‰æ“ä½œæ’¤å›å»å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;p&gt;é¡ºå¸¦ä¸€ææˆ‘æ˜¯æ´›è°·ä¸Šæœ€ä¼˜è§£ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;namespace XSC062 &amp;#123;
using namespace fastIO;
const int maxn = 2e5 + 5;
struct __ &amp;#123;
    int ty, l, r, v;
    __() &amp;#123;&amp;#125;
    __(int t1, int l1, int r1, int v1 = 0) &amp;#123;
        if (t1 == 0)
            ty = 0, l = l1, v = r1;
        else ty = 1, l = l1, r = r1, v = v1;
    &amp;#125;
&amp;#125;;
char ty;
std::map&amp;lt;int, int&amp;gt; tab;
std::vector&amp;lt;__&amp;gt; q[maxn];
int n, m, tot, x, y, v, id;
int Bit[maxn], a[maxn], res[maxn];
int lowbit(int x) &amp;#123; return x &amp;amp; -x; &amp;#125;
void add(int x, int v) &amp;#123;
    for (; x &amp;lt;= n; x += lowbit(x))
        Bit[x] += v;
    return;
&amp;#125;
int ask(int x) &amp;#123;
    int res = 0;
    for (; x; x -= lowbit(x)) res += Bit[x];
    return res;
&amp;#125;
int main() &amp;#123;
    read(n), read(m);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        read(a[i]);
        if (!tab.count(a[i]))
            tab[a[i]] = ++tot;
        a[i] = tab[a[i]];
        q[a[i]].emplace_back(0, i, 1);
    &amp;#125;
    while (m--) &amp;#123;
        scanf(&amp;quot;%1s&amp;quot;, &amp;amp;ty);
        if (ty == &amp;#39;C&amp;#39;) &amp;#123;
            read(x), read(y);
            if (!tab.count(y))
                tab[y] = ++tot;
            y = tab[y];
            q[a[x]].emplace_back(0, x, -1);
            q[a[x] = y].emplace_back(0, x, 1);
        &amp;#125;
        else &amp;#123;
            ++id;
            read(x), read(y), read(v);
            if (!tab.count(v)) continue;
            v = tab[v];
            q[v].emplace_back(1, x, y, id);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= tot; ++i) &amp;#123;
        for (auto &amp;amp;j : q[i]) &amp;#123;
            if (j.ty == 0) add(j.l, j.v);
            else &amp;#123;
                res[j.v] =
                    ask(j.r) - ask(j.l - 1);
            &amp;#125;
        &amp;#125;
        for (auto &amp;amp;j : q[i])
            if (j.ty == 0) add(j.l, -j.v);
    &amp;#125;
    for (int i = 1; i &amp;lt;= id; ++i)
        print(res[i], &amp;#39;\n&amp;#39;);
    return 0;
&amp;#125;
&amp;#125; // namespace XSC062&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;p&gt;E ä¼šå•ç‹¬å¼€ä¸€ç¯‡ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;f.-æ ‘-tree&#34;&gt;F. æ ‘ tree&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/4647/problem/6&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/4647/problem/6&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;CF916Eã€‚&lt;/p&gt;
&lt;p&gt;å¤§åˆ†è®¨ç»™æˆ‘æ•´ä¸ä¼šäº†ï¼Œæ›´ç»™æˆ‘æ•´ä¸ä¼šçš„æ˜¯ä¸‹æ¥è¿‡åå‘ç°è¿™åªæ˜¯ä¸ªå°åˆ†è®¨ã€‚&lt;/p&gt;
&lt;p&gt;æ›´æ–°å­æ ‘å’Œå­æ ‘æŸ¥è¯¢æˆ‘ä»¬éƒ½ä¼šã€‚æ¢æ ¹ DP æˆ‘ä»¬ä¹Ÿéƒ½å†™è¿‡ï¼Œéƒ½çŸ¥é“æ¢æ ¹å¹¶ä¸ä¼šå¯¹å­æ ‘ç»“æ„äº§ç”Ÿå¤§çš„å½±å“ã€‚æ‰€ä»¥åº”å½“æ˜¯èƒ½æ ¹æ®å·²çŸ¥ä¿¡æ¯æ¨æµ‹å‡ºå­æ ‘åœ¨åŸæ ‘ä¸Šå¯¹åº”çš„ç‚¹é›†çš„ã€‚&lt;/p&gt;
&lt;p&gt;è®° &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸ºå½“å‰æ ‘æ ¹ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(x,y)\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºæ ¹æ—¶çš„ LCAï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}&amp;#39;(x,y)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸ºæ ¹æ—¶çš„ LCAã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}&amp;#39;(x,y)\)&lt;/span&gt;ï¼Œè‚¯å®šæ˜¯è¦è®¨è®º &lt;span class=&#34;math inline&#34;&gt;\(x,y\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„ä½ç½®å…³ç³»çš„ã€‚&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(x,y)\)&lt;/span&gt; æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„å­å­™ã€‚æ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}&amp;#39;(x,y) = \text {LCA}(x,y)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(x,y)\)&lt;/span&gt; æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„ç¥–å…ˆã€‚é‚£ä¹ˆè¯´æ˜è‡³å°‘æœ‰ä¸€ä¸ªç‚¹ä¸æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„å­å­™ã€‚æ­¤æ—¶ &lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(x,y)&amp;#39;\)&lt;/span&gt; çš„å€¼ä¸º &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸ºå¦ä¸€ä¸ªç‚¹çš„ LCAã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ•´ç†å¯å¾— &lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}&amp;#39;(x,y)\)&lt;/span&gt; æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(x,y)\)&lt;/span&gt;ã€&lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(x,r)\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(y,r)\)&lt;/span&gt; ä¸­çš„æ·±åº¦æœ€å¤§è€…ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºä»¥ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸ºæ ¹æ—¶çš„å­æ ‘ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(x=r\)&lt;/span&gt;ï¼Œæ­¤æ—¶å­æ ‘ä¸ºæ•´æ£µæ ‘ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(x,r)\ne x\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å­å­™ï¼Œæ­¤æ—¶å­æ ‘å°±æ˜¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; ä¸ºæ ¹æ˜¯çš„å­æ ‘ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(\text {LCA}(x,y)=x\)&lt;/span&gt;ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„å­å­™ï¼Œæ­¤æ—¶å­æ ‘æ˜¯æ•´æ£µæ ‘é™¤å¼€ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; åŒ…å« &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„å„¿å­åŠå…¶å­å­™ã€‚ä¿®æ”¹å’ŒæŸ¥è¯¢çš„æ—¶å€™å®¹æ–¥ä¸€ä¸‹å°±å¥½ã€‚è¿™ä¸ªæ—¶å€™çš„å­æ ‘å€å¢è·³ä¸€ä¸‹å°±èƒ½æ‰¾åˆ°ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç„¶åå°±æ˜¯å¸¸è§„çº¿æ®µæ ‘ç»´æŠ¤äº†ã€‚æ—¶é—´å¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;namespace XSC062 &amp;#123;
using namespace fastIO;
const int maxm = 35;
const int maxn = 1e5 + 5;
#define lt (p &amp;lt;&amp;lt; 1)
#define rt (lt | 1)
struct _ &amp;#123; int l, r, u, d; &amp;#125;;
_ t[maxn &amp;lt;&amp;lt; 2];
int f[maxn][maxm];
std::vector&amp;lt;int&amp;gt; g[maxn];
int a[maxn], dfn[maxn], rfn[maxn];
int n, q, r, ty, x, y, v, si, now;
int top[maxn], dep[maxn], tab[maxn];
void swap(int &amp;amp;x, int &amp;amp;y) &amp;#123;
    x ^= y ^= x ^= y;
    return;
&amp;#125;
void DFS(int x) &amp;#123;
    dep[x] = dep[f[x][0]] + 1;
    dfn[x] = ++now, tab[now] = x;
    for (auto i : g[x]) &amp;#123;
        if (i == f[x][0]) continue;
        f[i][0] = x;
        for (int j = 1; j &amp;lt;= si; ++j)
            f[i][j] = f[f[i][j - 1]][j - 1];
        DFS(i);
    &amp;#125;
    rfn[x] = now;
    return;
&amp;#125;
void pushup(int p) &amp;#123;
    t[p].u = t[lt].u + t[rt].u;
    return;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (t[p].d) &amp;#123;
        t[lt].d += t[p].d;
        t[rt].d += t[p].d;
        t[lt].u += t[p].d *
                (t[lt].r - t[lt].l + 1);
        t[rt].u += t[p].d *
                (t[rt].r - t[rt].l + 1);
        t[p].d = 0;
    &amp;#125;
    return;
&amp;#125;
void bld(int p, int l, int r) &amp;#123;
    t[p].l = l, t[p].r = r;
    if (l == r) &amp;#123;
        t[p].u = a[tab[l]];
        return;
    &amp;#125;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    bld(lt, l, mid), bld(rt, mid + 1, r);
    pushup(p);
    return;
&amp;#125;
void add(int p, int x, int v) &amp;#123;
    t[p].u += v;
    if (t[p].l == t[p].r) return;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid) add(lt, x, v);
    else add(rt, x, v);
    return;
&amp;#125;
void add(int p, int l, int r, int v) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r) &amp;#123;
        t[p].d += v;
        t[p].u += (t[p].r - t[p].l + 1) * v;
        return;
    &amp;#125;
    pushdown(p);
    int mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid) add(lt, l, r, v);
    if (r &amp;gt; mid) add(rt, l, r, v);
    pushup(p);
    return;
&amp;#125;
int ask(int p, int l, int r) &amp;#123;
    if (l &amp;lt;= t[p].l &amp;amp;&amp;amp; t[p].r &amp;lt;= r)
        return t[p].u;
    pushdown(p);
    int res = 0,
        mid = (t[p].l + t[p].r) &amp;gt;&amp;gt; 1;
    if (l &amp;lt;= mid) res = ask(lt, l, r);
    if (r &amp;gt; mid) res += ask(rt, l, r);
    return res;
&amp;#125;
int LCA(int x, int y) &amp;#123;
    if (dep[x] &amp;lt; dep[y]) swap(x, y);
    for (int i = si; ~i; --i) &amp;#123;
        if (dep[f[x][i]] &amp;gt;= dep[y])
            x = f[x][i];
    &amp;#125;
    if (x == y) return x;
    for (int i = si; ~i; --i) &amp;#123;
        if (f[x][i] != f[y][i])
            x = f[x][i], y = f[y][i];
    &amp;#125;
    return f[x][0];
&amp;#125;
void Add(int x, int v) &amp;#123;
    int rlca = LCA(r, x);
    if (x == r) add(1, 1, n, v);
    else if (rlca != x)
        add(1, dfn[x], rfn[x], v);
    else &amp;#123;
        add(1, 1, n, v);
        int p = r;
        for (int i = si; ~i; --i) &amp;#123;
            if (dep[f[p][i]] &amp;gt;= dep[x] + 1)
                p = f[p][i];
        &amp;#125;
        add(1, dfn[p], rfn[p], -v);
    &amp;#125;
    return;
&amp;#125;
void tAdd(int x, int y, int v) &amp;#123;
    int llca = LCA(r, x), rlca = LCA(r, y),
        ulca = LCA(x, y);
    if (dep[llca] &amp;gt;= dep[rlca] &amp;amp;&amp;amp;
        dep[llca] &amp;gt;= dep[ulca]) Add(llca, v);
    else if (dep[rlca] &amp;gt;= dep[llca] &amp;amp;&amp;amp;
        dep[rlca] &amp;gt;= dep[ulca]) Add(rlca, v);
    else Add(ulca, v);
    return;
&amp;#125;
int tAsk(int x) &amp;#123;
    int rlca = LCA(r, x);
    if (x == r) return t[1].u;
    if (rlca != x)
        return ask(1, dfn[x], rfn[x]);
    int p = r;
    for (int i = si; ~i; --i) &amp;#123;
        if (dep[f[p][i]] &amp;gt;= dep[x] + 1)
            p = f[p][i];
    &amp;#125;
    return t[1].u - ask(1, dfn[p], rfn[p]);
&amp;#125;
void add(int x, int y) &amp;#123;
    g[x].push_back(y);
    return;
&amp;#125;
int main() &amp;#123;
    read(n), read(q), r = 1;
    si = log(n) / log(2.0);
    for (int i = 1; i &amp;lt;= n; ++i) read(a[i]);
    for (int i = 1; i &amp;lt; n; ++i) &amp;#123;
        read(x), read(y);
        add(x, y), add(y, x);
    &amp;#125;
    dep[0] = 1, DFS(1), dep[0] = 0;
    bld(1, 1, n);
    while (q--) &amp;#123;
        read(ty);
        if (ty == 1) read(r);
        else if (ty == 2) &amp;#123;
            read(x), read(y), read(v);
            tAdd(x, y, v);
        &amp;#125;
        else &amp;#123;
            read(x);
            print(tAsk(x), &amp;#39;\n&amp;#39;);
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;
&amp;#125; // namespace XSC062
#undef int&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="çº¿æ®µæ ‘" />
        <category term="æ ‘çŠ¶æ•°ç»„" />
        <category term="LCA" />
        <category term="å€å¢" />
        <category term="é¸½å·¢åŸç†" />
        <updated>2024-01-06T03:27:39.000Z</updated>
    </entry>
</feed>
