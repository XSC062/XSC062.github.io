<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xsc062.netlify.app</id>
    <title> â€¢ Posts by &#34;fwt&#34; tag</title>
    <link href="https://xsc062.netlify.app" />
    <updated>2025-03-29T07:00:21.000Z</updated>
    <category term="å¹¶æŸ¥é›†" />
    <category term="æ–œç‡ä¼˜åŒ–" />
    <category term="æ‚¬çº¿æ³•" />
    <category term="å“ˆå¸Œ" />
    <category term="å­—å…¸æ ‘" />
    <category term="DP" />
    <category term="å•è°ƒé˜Ÿåˆ—" />
    <category term="åˆ†æ²»" />
    <category term="è®¡æ•°" />
    <category term="äºŒåˆ†å›¾" />
    <category term="CRT / exCRT" />
    <category term="æ’åˆ—ç»„åˆ" />
    <category term="ç½‘ç»œæµ" />
    <category term="è´¹ç”¨æµ" />
    <category term="äºŒåˆ†" />
    <category term="ä¸Šä¸‹ç•Œç½‘ç»œæµ" />
    <category term="å®¹æ–¥åŸç†" />
    <category term="çº¿æ®µæ ‘" />
    <category term="æ ‘çŠ¶æ•°ç»„" />
    <category term="åŒºé—´ DP" />
    <category term="æ„é€ " />
    <category term="æ•°æ®ç»“æ„" />
    <category term="Tarjan" />
    <category term="ä¸‹é¥­" />
    <category term="LCA" />
    <category term="å€å¢" />
    <category term="é¸½å·¢åŸç†" />
    <category term="æ¦‚ç‡æœŸæœ›" />
    <category term="è°ƒå’Œçº§æ•°" />
    <category term="å·®åˆ†" />
    <category term="æ€ç»´" />
    <category term="æ ‘å½¢ DP" />
    <category term="æœ€å°ç”Ÿæˆæ ‘" />
    <category term="SAM" />
    <category term="çŠ¶å‹" />
    <category term="åˆ†å—" />
    <category term="å¯æŒä¹…åŒ–" />
    <category term="ç¬›å¡å°”æ ‘" />
    <category term="é«˜ç»´å‰ç¼€å’Œ" />
    <category term="é—²è¯" />
    <category term="æ¬§æ‹‰å›è·¯" />
    <category term="æ ‘é“¾å‰–åˆ†" />
    <category term="é•¿é“¾å‰–åˆ†" />
    <category term="KMP" />
    <category term="border" />
    <category term="å­—ç¬¦ä¸²" />
    <category term="AC è‡ªåŠ¨æœº" />
    <category term="SA" />
    <category term="æ•°å­¦" />
    <category term="æ ‘ä¸Šå·®åˆ†" />
    <category term="FWT" />
    <category term="å †" />
    <category term="æ ‘çš„é‡å¿ƒ" />
    <category term="äºŒé¡¹å¼å®šç†" />
    <category term="äºŒé¡¹å¼åæ¼”" />
    <category term="è´ªå¿ƒ" />
    <category term="å‡æ‘Š" />
    <category term="ä¼˜åŒ–å»ºå›¾" />
    <category term="åæ‚”è´ªå¿ƒ" />
    <category term="è°ƒæ•´æ³•" />
    <category term="èƒŒåŒ…" />
    <category term="åšå¼ˆè®º" />
    <category term="DP ä¼˜åŒ–" />
    <category term="è™šæ ‘" />
    <category term="ç‚¹åˆ†æ²»" />
    <category term="WQS äºŒåˆ†" />
    <category term="é—µå¯å¤«æ–¯åŸºå’Œ" />
    <category term="slope trick" />
    <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
    <category term="çŠ¶å‹ DP" />
    <category term="ç»„åˆæ•°å­¦" />
    <category term="æ”¯é…å¯¹" />
    <category term="DDP" />
    <category term="å®¹æ–¥" />
    <category term="Kruskal é‡æ„æ ‘" />
    <category term="é«˜ç²¾åº¦" />
    <category term="æœ€çŸ­è·¯" />
    <category term="æ ‘å¥—æ ‘" />
    <category term="Boruvka" />
    <category term="æ ‘é“¾å‰–åˆ† - æœ€å°ç”Ÿæˆæ ‘" />
    <category term="æè¶…çº¿æ®µæ ‘" />
    <entry>
        <id>https://xsc062.netlify.app/20250329/</id>
        <title>å­¦ä¹ ç¬”è®°ï¼šFWT</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250329/"/>
        <content type="html">&lt;p&gt;æ´»äº†å“¥ä»¬ï¼Œå¤æ´»äº†ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;p&gt;è€ƒè™‘ä»¥ä¸‹é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\forall \,i\in U\)&lt;/span&gt;ï¼Œæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(c_i=\sum\limits_{j\cup k=i}a_j\cdot b_k\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å½“ç„¶è¿™é‡Œå¯ä»¥æŠŠé›†åˆçœ‹æˆäºŒè¿›åˆ¶çŠ¶æ€ï¼Œé‚£ä¹ˆå–å¹¶é›†å°±æ˜¯æŒ‰ä½æˆ–äº†ã€‚&lt;/p&gt;
&lt;p&gt;å’•å’•å’•&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;emiya-å®¶æ˜å¤©çš„é¥­&#34;&gt;Emiya å®¶æ˜å¤©çš„é¥­&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P10242&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P10242&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å†·çŸ¥è¯†ï¼š&lt;em&gt;Emiya å®¶æ˜å¤©çš„é¥­&lt;/em&gt; å’Œ &lt;em&gt;Emiya å®¶ä»Šå¤©çš„é¥­&lt;/em&gt; æ‹¥æœ‰ç›¸åŒçš„éš¾åº¦è¯„çº§ &lt;img src=&#34;/em/kt.gif&#34; alt=&#34;ç£•å¤´&#34; /&gt;&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æš´åŠ›çš„åšæ³•ï¼Œå¦‚æœæˆ‘ä»¬å…ˆé’¦å®šå¿…é¡»åˆ°è¾¾çš„äººï¼ˆè¿™æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(2^n)\)&lt;/span&gt; çš„ï¼‰ï¼Œå†èŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt; çš„æ—¶é—´ä¾æ¬¡åˆ¤å®šæ¯é“èœæ˜¯å¦å¯ä»¥è¢«é€‰æ‹©ï¼Œå°±å¯ä»¥ è§£å†³é—®é¢˜ã€‚ä½†å‘ç°æ—¶é—´æ˜¯ä¸èƒ½æ‰¿å—çš„ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä¼˜åŒ– &lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt; çš„åˆ¤å®šã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å·²çŸ¥äººå‘˜é›†åˆ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œå¯¹äºä¸€é“èœ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œè®¾å®ƒé€‚é…çš„äººå‘˜é›†åˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(T_i\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(s\subseteq T_i\)&lt;/span&gt;ã€‚æ‰€æ±‚å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\max\limits_s\{\sum\limits_{T_i\supseteq s}\sum\limits_{j\in s}a_{i,j}\}\)&lt;/span&gt;ã€‚&lt;span class=&#34;math inline&#34;&gt;\(O(nm)\)&lt;/span&gt; é¢„å¤„ç†å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_j(u)=\sum\limits_{T_i=u}a_{j, i}\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå¾…æ±‚å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\max\limits_{s}\{\sum\limits_{j\in s}\sum\limits_{u\supseteq s}f_j(u)\}\)&lt;/span&gt;ï¼Œå‘ç°è¿™ä¸ªä¸œè¥¿å¯ä»¥ç”¨ FWT æ±‚ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m, k;
    std::cin &amp;gt;&amp;gt; k &amp;gt;&amp;gt; m, n = 1 &amp;lt;&amp;lt; k;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    std::vector&amp;lt;int&amp;gt; t(m + 1);
    std::vector&amp;lt;arr&amp;gt; a(k + 1, arr(m + 1)), f(k + 1, arr(n));
    for (int i = 1; i &amp;lt;= k; ++i)
        for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
            std::cin &amp;gt;&amp;gt; a[i][j];
            if (a[i][j] &amp;gt;= 0)
                t[j] |= 1 &amp;lt;&amp;lt; (i - 1);
        &amp;#125;
    for (int i = 1; i &amp;lt;= k; ++i)
        for (int j = 1; j &amp;lt;= m; ++j)
            if (a[i][j] &amp;gt;= 0)
                f[i][t[j]] += a[i][j];
    &amp;#123;
        std::vector&amp;lt;arr&amp;gt; mT(2, arr(2));
        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 0ll, mT[1][1] = 1ll;
        auto calc = [&amp;amp;](arr a, arr &amp;amp;f, std::vector&amp;lt;arr&amp;gt; &amp;amp;w) &amp;#123;
            f = a;
            for (int len = 2; len &amp;lt;= n; len &amp;lt;&amp;lt;= 1) &amp;#123;
                for (int i = 0; i &amp;lt; n; i += len)
                    for (int p = i, q = i + len / 2; q &amp;lt; i + len; ++p, ++q)
                        std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);
            &amp;#125;
            return;
        &amp;#125;;
        for (int i = 1; i &amp;lt;= k; ++i)
            calc(f[i], f[i], mT);
    &amp;#125;
    long long res = 0ll;
    for (int s = 0; s &amp;lt; n; ++s) &amp;#123;
        long long sum = 0ll;
        for (int i = 1; i &amp;lt;= k; ++i)
            if ((s &amp;gt;&amp;gt; (i - 1)) &amp;amp; 1)
                sum += f[i][s];
        res = std::max(res, sum);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;nim-counting&#34;&gt;Nim Counting&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/abc212/tasks/abc212_h&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/abc212/tasks/abc212_h&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å³ï¼Œä» &lt;span class=&#34;math inline&#34;&gt;\(A_N\)&lt;/span&gt; ä¸­æœ‰æ”¾å›åœ°é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(\le M\)&lt;/span&gt; ä¸ªæ•°ï¼Œé—®å®ƒä»¬å¼‚æˆ–èµ·æ¥ä¸ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, j}\)&lt;/span&gt; è¡¨ç¤ºé€‰äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ¬¡ï¼Œå¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(f_{1,i}=\sum [a_j=i]\)&lt;/span&gt; ä¸ºå…³äº &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; çš„æ¡¶ã€‚æ­¤æ—¶æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}=\sum\limits_{k=1}^n f_{i-1,j\oplus a_k}=\sum\limits_{k=0}^V f_{i-1,j\oplus k}\cdot f_{1,k}\)&lt;/span&gt;ï¼Œå‘ç°æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(f_1\)&lt;/span&gt; è¿™ä¸ªæ¡¶åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; ä¸Šåš &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; æ¬¡ xor-FWT å°±å¯ä»¥å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†å¦‚æœç›´æ¥å· &lt;span class=&#34;math inline&#34;&gt;\(N\)&lt;/span&gt; æ¬¡æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(N\cdot V\log V)\)&lt;/span&gt; çš„ï¼Œä¸å¤ªç¾å¥½ï¼Œä½†æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å®é™…ä¸Šéœ€è¦åšä»€ä¹ˆï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; çš„ FWTã€‚&lt;/li&gt;
&lt;li&gt;æ±‚åˆå§‹æ¡¶ &lt;span class=&#34;math inline&#34;&gt;\(f_1\)&lt;/span&gt; çš„ FWTã€‚&lt;/li&gt;
&lt;li&gt;å¯¹ä½ç›¸ä¹˜å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{i+1}\)&lt;/span&gt; çš„ FWTã€‚&lt;/li&gt;
&lt;li&gt;é€šè¿‡ FWT æ±‚å¾—åŸæœ¬çš„ &lt;span class=&#34;math inline&#34;&gt;\(f_{i+1}\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å½“è¿™ä¸ªæ“ä½œè¢«æ”¾åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(i=1\sim n\)&lt;/span&gt; ä¸Šä¾æ¬¡è¿›è¡Œæ—¶ï¼Œæˆ‘ä»¬å‘ç°ç¬¬ä¸€æ­¥å’Œæœ€åä¸€æ­¥ä¼šç›¸äº’æŠµæ¶ˆï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_1\)&lt;/span&gt; çš„ FWTï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(FWT_{i, j}(f)\)&lt;/span&gt; å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(FWT_{1, j}(f)^i\)&lt;/span&gt;ã€‚å› ä¸ºæˆ‘ä»¬è¦æ±‚çš„æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i, j}f_{i,j}\)&lt;/span&gt; å¯ä»¥é€šè¿‡ç­‰æ¯”æ•°åˆ—æ±‚å’Œæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(FWT_j(s)=\sum f_{i, j}\)&lt;/span&gt;ã€‚ç”±å‰æ–‡æ¨å¯¼å¯çŸ¥ç›´æ¥åšä¸€æ¬¡é€†å˜æ¢æ±‚å¾— &lt;span class=&#34;math inline&#34;&gt;\(s_j\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    struct mint &amp;#123;
        const int mod = 998244353;
        long long x;
        mint(): x(0ll) &amp;#123;&amp;#125;
        mint(long long x1): x((x1 + mod) % mod) &amp;#123;&amp;#125;
        mint&amp;amp; operator= (const mint q) &amp;#123;
            x = q.x;
            return *this;
        &amp;#125;
        bool operator== (const mint q) const &amp;#123;
            return x == q.x;
        &amp;#125;
        mint operator* (const mint q) const &amp;#123;
            return x * q.x % mod;
        &amp;#125;
        mint&amp;amp; operator*= (const mint q) &amp;#123;
            return *this = *this * q;
        &amp;#125;
        mint operator+ (const mint q) &amp;#123;
            return (x + q.x) % mod;
        &amp;#125;
        mint&amp;amp; operator+= (const mint q) &amp;#123;
            return *this = *this + q;
        &amp;#125;
        mint operator- (const mint q) &amp;#123;
            return (x + mod - q.x) % mod;
        &amp;#125;
        mint qkp(int y) &amp;#123;
            mint res(1ll), x(this-&amp;gt;x);
            for (; y; y &amp;gt;&amp;gt;= 1, x *= x)
                if (y &amp;amp; 1)
                    res *= x;
            return res;
        &amp;#125;
        mint inv(void) &amp;#123;
            return qkp(mod - 2);
        &amp;#125;
    &amp;#125;;
    int n, m, k = 16, l = 1 &amp;lt;&amp;lt; k;
    std::cin &amp;gt;&amp;gt; m &amp;gt;&amp;gt; n;
    using arr = std::vector&amp;lt;mint&amp;gt;;
    arr a(n + 1), c(l);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i].x, c[a[i].x] += 1;
    std::vector&amp;lt;arr&amp;gt; mT(2, arr(2)), mI(2, arr(2));
    mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = -1ll;
    mI[0][0] = mI[0][1] = mI[1][0] = mint(2ll).inv(), mI[1][1] = mint(-2ll).inv();
    auto calc = [&amp;amp;](arr a, arr &amp;amp;f, std::vector&amp;lt;arr&amp;gt; &amp;amp;w) &amp;#123;
        f = a;
        for (int len = 2; len &amp;lt;= l; len &amp;lt;&amp;lt;= 1)
            for (int i = 0; i &amp;lt; l; i += len)
                for (int p = i, q = i + len / 2; q &amp;lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);
        return;
    &amp;#125;;
    calc(c, c, mT);
    arr s(l);
    for (int i = 0; i &amp;lt; l; ++i)
        if (c[i] == 1ll)
            s[i] = m;
        else
            s[i] = c[i] * (mint(1ll) - c[i].qkp(m)) * (mint(1ll) - c[i]).inv();
    calc(s, s, mI);
    mint res;
    for (int i = 1; i &amp;lt; l; ++i)
        res += s[i];
    std::cout &amp;lt;&amp;lt; res.x &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;binary-table&#34;&gt;Binary Table&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/662/C&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/662/C&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™ä¸ªé¢˜å’Œ &lt;em&gt;Emiya å®¶ä»Šå¤©çš„é¥­&lt;/em&gt; å¾ˆåƒï¼Œéƒ½æ˜¯æœ‰ä¸€ä¸ªå¾ˆå°çš„ç»´å’Œä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå¤§çš„ç»´ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„æ“ä½œé¡ºåºéƒ½å¯ä»¥ä»»æ„è°ƒæ¢ï¼›æœ´ç´ åœ°ï¼Œæˆ‘ä»¬æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(2^n\)&lt;/span&gt; ç§ç»™è¿™ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; è¡Œåè½¬çš„æƒ…å†µï¼›å†å¯¹äºæ¯ä¸€åˆ—ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; é€‰æ‹©åº”è¯¥åè½¬è¿˜æ˜¯ä¸åè½¬ï¼Œè¿™æ ·æ€»å…±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(2^n\cdot nm)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°æŠŠä¸€åˆ—åˆå§‹çŠ¶æ€å‹æˆä¸€ä¸ªäºŒè¿›åˆ¶æ•° &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æšä¸¾çš„è¡Œåè½¬çŠ¶æ€ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œæ˜¾ç„¶ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(s\oplus a\)&lt;/span&gt; å¯ä»¥å¾—åˆ°å½“å‰çŠ¶æ€ã€‚æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªå» FWT å‘¢ï¼Ÿè¿™å¼•å¯¼æˆ‘ä»¬ä¾ç„¶æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œç”¨ä¸€ä¸ªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(s\oplus a\)&lt;/span&gt; æœ‰å…³çš„é‡è·Ÿä¸€ä¸ªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt; æœ‰å…³çš„é‡ç›¸ä¹˜å¾—åˆ°å…³äº &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;å®¹æ˜“å‘ç°ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{s\oplus a}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(s\oplus a\)&lt;/span&gt; è¿™ä¸ªçŠ¶æ€åè½¬å’Œä¸åè½¬ä¸¤ä¸ªé€‰é¡¹ä¸­å¯ä»¥è·å–çš„æœ€å°‘ 1 çš„ä¸ªæ•°ï¼›å†ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(c_s\)&lt;/span&gt; è¡¨ç¤ºçŠ¶æ€ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„åˆ—çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_s c_s\times f_{s\oplus a}\)&lt;/span&gt; å°±å¯ä»¥å¾—åˆ°æšä¸¾çš„åè½¬æ–¹æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt; çš„ç­”æ¡ˆï¼Œæ±‚æœ€å°å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    struct mint &amp;#123;
        const int mod = 998244353;
        long long x;
        mint(): x(0ll) &amp;#123;&amp;#125;
        mint(long long x1): x((x1 + mod) % mod) &amp;#123;&amp;#125;
        mint&amp;amp; operator= (const mint q) &amp;#123;
            x = q.x;
            return *this;
        &amp;#125;
        bool operator== (const mint q) const &amp;#123;
            return x == q.x;
        &amp;#125;
        mint operator* (const mint q) const &amp;#123;
            return x * q.x % mod;
        &amp;#125;
        mint&amp;amp; operator*= (const mint q) &amp;#123;
            return *this = *this * q;
        &amp;#125;
        mint operator+ (const mint q) &amp;#123;
            return (x + q.x) % mod;
        &amp;#125;
        mint&amp;amp; operator+= (const mint q) &amp;#123;
            return *this = *this + q;
        &amp;#125;
        mint operator- (const mint q) &amp;#123;
            return (x + mod - q.x) % mod;
        &amp;#125;
        mint qkp(int y) &amp;#123;
            mint res(1ll), x(this-&amp;gt;x);
            for (; y; y &amp;gt;&amp;gt;= 1, x *= x)
                if (y &amp;amp; 1)
                    res *= x;
            return res;
        &amp;#125;
        mint inv(void) &amp;#123;
            return qkp(mod - 2);
        &amp;#125;
    &amp;#125;;
    int n, m, l;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m, l = 1 &amp;lt;&amp;lt; n;
    using arr = std::vector&amp;lt;mint&amp;gt;;
    arr c(l), f(l);
    std::vector&amp;lt;std::vector&amp;lt;char&amp;gt; &amp;gt; a(n + 1, std::vector&amp;lt;char&amp;gt; (m + 1));
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 1; j &amp;lt;= m; ++j)
            std::cin &amp;gt;&amp;gt; a[i][j];
    for (int j = 1; j &amp;lt;= m; ++j) &amp;#123;
        int s = 0;
        for (int i = 1; i &amp;lt;= n; ++i)
            s = (s &amp;lt;&amp;lt; 1) + a[i][j] - &amp;#39;0&amp;#39;;
        c[s] += 1;
    &amp;#125;
    for (int i = 0, t; i &amp;lt; l; ++i)
        t = (__builtin_popcount(i)), f[i] = std::min(t, n - t);
    std::vector&amp;lt;arr&amp;gt; mT(2, arr(2)), mI(2, arr(2));
    mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = -1ll;
    mI[0][0] = mI[0][1] = mI[1][0] = mint(2ll).inv(), mI[1][1] = mint(-2ll).inv();
    auto calc = [&amp;amp;](arr a, arr &amp;amp;f, std::vector&amp;lt;arr&amp;gt; &amp;amp;w) &amp;#123;
        f = a;
        for (int len = 2; len &amp;lt;= l; len &amp;lt;&amp;lt;= 1)
            for (int i = 0; i &amp;lt; l; i += len)
                for (int p = i, q = i + len / 2; q &amp;lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);
        return;
    &amp;#125;;
    calc(c, c, mT), calc(f, f, mT);
    arr s(l);
    for (int i = 0; i &amp;lt; l; ++i)
        s[i] = c[i] * f[i];
    calc(s, s, mI);
    int res = 0x3f3f3f3f;
    for (int i = 0; i &amp;lt; l; ++i)
        res = std::min(res, (int)s[i].x);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;hard-nim&#34;&gt;Hard Nim&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://hydro.ac/p/bzoj-P4589&#34; class=&#34;uri&#34;&gt;https://hydro.ac/p/bzoj-P4589&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Nim Counting&lt;/em&gt; ç„¶åç¼äº†ä¸ªç­›å­ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
const int inv2 = 5e8 + 4;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    std::vector&amp;lt;int&amp;gt; p, tag(50001);
    for (int i = 2; i &amp;lt;= 50000; ++i)
        if (!tag[i]) &amp;#123;
            p.push_back(i);
            for (int j = 2 * i; j &amp;lt;= 50000; j += i)
                tag[j] = 1;
        &amp;#125;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        long long res = 1ll;
        for (; y; y &amp;gt;&amp;gt;= 1, (x *= x) %= mod)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    for (int n, m; std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m; ) &amp;#123;
        int k = std::__lg(m) + 1, l = 1 &amp;lt;&amp;lt; k;
        using arr = std::vector&amp;lt;long long&amp;gt;;
        arr c(l);
        for (auto i : p)
            if (i &amp;lt;= m)
                c[i] += 1;
            else
                break;
        std::vector&amp;lt;arr&amp;gt; mT(2, arr(2)), mI(2, arr(2));
        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = mod - 1ll;
        mI[0][0] = mI[0][1] = mI[1][0] = inv2, mI[1][1] = mod - inv2;
        auto calc = [&amp;amp;](arr &amp;amp;f, std::vector&amp;lt;arr&amp;gt; &amp;amp;w) &amp;#123;
            for (int len = 2; len &amp;lt;= l; len &amp;lt;&amp;lt;= 1)
                for (int i = 0; i &amp;lt; l; i += len)
                    for (int p = i, q = i + len / 2; q &amp;lt; i + len; ++p, ++q)
                        std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);
            return;
        &amp;#125;;
        calc(c, mT);
        arr s(l);
        for (int i = 0; i &amp;lt; l; ++i)
            s[i] = qkp(c[i], n);
        calc(s, mI);
        std::cout &amp;lt;&amp;lt; s[0] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å­é›†å·ç§¯&#34;&gt;å­é›†å·ç§¯&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P6097&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P6097&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ˜¯åœ¨è®¸å¤š DP ä¸­éƒ½å¯èƒ½è§åˆ°è¿‡çš„ç»“æ„ï¼Œç›¸ä¿¡å¤§å®¶éƒ½æ·±æœ‰ä½“ä¼šã€‚&lt;/p&gt;
&lt;p&gt;ç­‰ä»·äºæ±‚ &lt;span class=&#34;math inline&#34;&gt;\(c_s=\sum\limits_{i\cap j=\varnothing\land i\cup j=s}a_i\cdot b_j\)&lt;/span&gt;ï¼Œé¦–å…ˆå…³æ³¨ &lt;span class=&#34;math inline&#34;&gt;\(i\cup j=s\)&lt;/span&gt;ï¼Œå¯ä»¥ç”¨ FWT è§£å†³ï¼›å¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(i\cap j = \varnothing\)&lt;/span&gt; å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªå¾ˆèªæ˜çš„åŠæ³•ï¼Œæˆ‘ä»¬å‘ç° &lt;span class=&#34;math inline&#34;&gt;\(i\cap j=\varnothing\land i\cup j = s\iff \operatorname{ctz}(i)+\operatorname{ctz}(j)=\operatorname{ctz}(s)\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(\operatorname{ctz}(i)\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„ä¸ªæ•°ï¼Œå³ &lt;code&gt;popcount(i)&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶åè€…æ˜¯ä¸ªç®€å•çš„åŠ æ³•è¿ç®—ï¼Œè¿™é‡Œåˆæœ‰ä¸€ä¸ªå¾ˆèªæ˜åˆå¾ˆåŸºæœ¬çš„åŠæ³•ï¼Œæˆ‘ä»¬ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(A_{\operatorname{ctz}(i),i}=a_i,B_{\operatorname{ctz}(j),j}=b_j\)&lt;/span&gt;ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±è½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sum\limits_{i}\sum\limits_{j\cup k=s}A_{i,j}\cdot B_{\operatorname{ctz}(s)-i,j}\)&lt;/span&gt;ï¼Œå°±å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt; åœ°è§£å†³é—®é¢˜äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 9;
using arr = std::vector&amp;lt;long long&amp;gt;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    int l = 1 &amp;lt;&amp;lt; n;
    std::vector&amp;lt;arr&amp;gt; a(n + 1, arr(l)), b(n + 1, arr(l)), c(n + 1, arr(l));
    for (int i = 0, x; i &amp;lt; l; ++i)
        std::cin &amp;gt;&amp;gt; x, a[__builtin_popcount(i)][i] = x;
    for (int i = 0, x; i &amp;lt; l; ++i)
        std::cin &amp;gt;&amp;gt; x, b[__builtin_popcount(i)][i] = x;
    std::vector&amp;lt;arr&amp;gt; mT(2, arr(2)), mI(2, arr(2));
    mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;
    mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;
    auto calc = [&amp;amp;](arr &amp;amp;f, std::vector&amp;lt;arr&amp;gt; &amp;amp;w) &amp;#123;
        for (int len = 2; len &amp;lt;= l; len &amp;lt;&amp;lt;= 1)
            for (int i = 0; i &amp;lt; l; i += len)
                for (int p = i, q = i + len / 2; q &amp;lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);
        return;
    &amp;#125;;
    for (int i = 0; i &amp;lt;= n; ++i)
        calc(a[i], mT), calc(b[i], mT);
    for (int i = 0; i &amp;lt;= n; ++i) &amp;#123;
        for (int k = 0; k &amp;lt;= i; ++k)
            for (int j = 0; j &amp;lt; l; ++j)
                (c[i][j] += a[k][j] * b[i - k][j]) %= mod;
        calc(c[i], mI);
    &amp;#125;
    for (int j = 0; j &amp;lt; l; ++j)
        std::cout &amp;lt;&amp;lt; c[__builtin_popcount(j)][j] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
    std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å·åŒºåˆ’åˆ†&#34;&gt;å·åŒºåˆ’åˆ†&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P4221&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P4221&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;äººè¯ï¼šæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªç‚¹åˆ’åˆ†æˆè‹¥å¹²ä¸ªç‚¹é›†ï¼Œä¿è¯æ¯ä¸ªç‚¹é›†çš„å¯¼å‡ºå­å›¾ä¸æ˜¯æ¬§æ‹‰å›è·¯ï¼ˆæ¯ä¸ªç‚¹çš„åº¦æ•°ä¸ºå¶ä¸”å›¾è¿é€šï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæšä¸¾æ¯ä¸€ä¸ªç‚¹é›†åˆ¤å®šæ˜¯å¦åˆæ³•ï¼Œå†ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i}={w_i}^{-p}\times\sum\limits_{j\cup k = i\land j\cap k=\varnothing}f_{j}\times {w_k}^p\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°åé¢é‚£ä¸ª sigma é‡Œé¢æ˜¯ä¸€ä¸ªç®€å•çš„å­é›†å·ç§¯ï¼›ä½†æ˜¯æˆ‘ä»¬å‘ç°å‰é¢æœ‰ä¸€ä¸ªå’Œ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æœ‰å…³çš„å¸¸æ•°ï¼Œå¯¼è‡´æ²¡åŠæ³•ç›´æ¥å· &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æˆ‘ä»¬å‘ç°è¿™ä¸ª DP å…¶å®æ˜¯æœ‰ä¸€å®šéšå«æ¡ä»¶çš„â€”â€”éƒ½æ˜¯æŒ‰ç…§ &lt;span class=&#34;math inline&#34;&gt;\(\text{ctz}\)&lt;/span&gt; ä»å°åˆ°å¤§è½¬ç§»ã€‚è€ƒè™‘å­é›†å·ç§¯çš„ç¬¬ä¸€ç»´ï¼Œå¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(FWT_{f_i}\)&lt;/span&gt; åå…ˆ IFWT å›æ¥ï¼Œä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\({w_i}^{-p}\)&lt;/span&gt;ï¼Œå† FWT å›å»å³å¯ã€‚è€ƒå¯Ÿå­é›†å·ç§¯çš„ç»“æ„ï¼Œå‘ç°è¿™ä¸ªæ˜¯å¯ä»¥æƒ³åŠæ³•å¥—è¿›å»çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¤æ‚åº¦ &lt;a href=&#34;https://atcoder.jp/contests/abc400/tasks/abc400_c&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(O(n^2\cdot 2^n)\)&lt;/span&gt;&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
using arr = std::vector&amp;lt;long long&amp;gt;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m, p;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m &amp;gt;&amp;gt; p;
    int l = 1 &amp;lt;&amp;lt; n;
    auto qkp = [&amp;amp;](long long x, int y = mod - 2) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    arr w(n), inv(l);
    std::vector&amp;lt;arr&amp;gt; f(n + 1, arr(l)), s(n + 1, arr(l));
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n);
    for (int x, y; m--; ) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y, --x, --y;
        g[x].push_back(y);
    &amp;#125;
    auto check = [&amp;amp;](int s) &amp;#123;
        std::vector&amp;lt;int&amp;gt; f(n), deg(n);
        std::iota(f.begin(), f.end(), 0);
        std::function&amp;lt;int(int)&amp;gt; find = [&amp;amp;](int x) &amp;#123;
            return x == f[x] ? x : f[x] = find(f[x]);
        &amp;#125;;
        auto merge = [&amp;amp;](int x, int y) &amp;#123;
            f[find(x)] = find(y);
            return;
        &amp;#125;;
        for (int i = 0; i &amp;lt; n; ++i)
            if ((s &amp;gt;&amp;gt; i) &amp;amp; 1)
                for (auto j : g[i])
                    if ((s &amp;gt;&amp;gt; j) &amp;amp; 1)
                        merge(i, j), ++deg[i], ++deg[j];
        int fa = -1;
        for (int i = 0; i &amp;lt; n; ++i)
            if ((s &amp;gt;&amp;gt; i) &amp;amp; 1) &amp;#123;
                if (deg[i] &amp;amp; 1)
                    return 1;
                if (fa == -1 || fa == find(i))
                    fa = find(i);
                else
                    return 1;
            &amp;#125;
        return 0;
    &amp;#125;;
    for (int i = 0; i &amp;lt; n; ++i)
        std::cin &amp;gt;&amp;gt; w[i];
    for (int i = 0; i &amp;lt; l; ++i) &amp;#123;
        int ctz = __builtin_popcount(i);
        for (int j = 0; j &amp;lt; n; ++j)
            if ((i &amp;gt;&amp;gt; j) &amp;amp; 1) 
                s[ctz][i] += w[j];
        s[ctz][i] = qkp(s[ctz][i], p);
        inv[i] = qkp(s[ctz][i]);
        if (!check(i))
            s[ctz][i] = 0ll;
    &amp;#125;
    std::vector&amp;lt;arr&amp;gt; mT(2, arr(2)), mI(2, arr(2));
    mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;
    mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;
    auto calc = [&amp;amp;](arr &amp;amp;f, std::vector&amp;lt;arr&amp;gt; &amp;amp;w) &amp;#123;
        for (int len = 2; len &amp;lt;= l; len &amp;lt;&amp;lt;= 1)
            for (int i = 0; i &amp;lt; l; i += len)
                for (int p = i, q = i + len / 2; q &amp;lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);
        return;
    &amp;#125;;
    f[0][0] = 1ll;
    for (int i = 0; i &amp;lt;= n; ++i)
        calc(s[i], mT);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        calc(f[i - 1], mT);
        for (int k = 0; k &amp;lt; i; ++k)
            for (int j = 0; j &amp;lt; l; ++j)
                (f[i][j] += f[k][j] * s[i - k][j]) %= mod;
        calc(f[i], mI);
        for (int j = 0; j &amp;lt; l; ++j)
            (f[i][j] *= inv[j]) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n][l - 1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---sum-the-fibonacci&#34;&gt;B - Sum the Fibonacci&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/914/G&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/914/G&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ çš„ &lt;span class=&#34;math inline&#34;&gt;\(cnt\)&lt;/span&gt; æ˜¯å¥½åšçš„â€”â€”åšä¸€æ¬¡å­é›†å·ç§¯å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(cnt_1(a\cup b)\)&lt;/span&gt;ï¼Œåšä¸€æ¬¡ xor-FWT å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(cnt_2(d\oplus e)\)&lt;/span&gt;ï¼Œä¸­é—´çš„ &lt;span class=&#34;math inline&#34;&gt;\(cnt(c)\)&lt;/span&gt; å°±æ˜¯åŸæ ·ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯å¯ä»¥åœ¨ä¸€æ¬¡ and-FWT åæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(cnt,cnt_1,cnt_2\)&lt;/span&gt; ç›´æ¥å·èµ·æ¥â€”â€”ç”±çŸ©é˜µä¹˜æ³•ç»“åˆå¾‹å¾—ï¼ˆå“ˆå“ˆå¤§ç¬‘äº†ï¼‰ã€‚ä½†æ€ä¹ˆæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å¡è¿›å»å‘¢ï¼Ÿå¦‚æœä½ æ‹¥æœ‰å°å­¦ç”Ÿçš„æ•°å­¦æ°´å¹³ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°æƒ³åˆ°ç›´æ¥åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(cnt,cnt_1,cnt_2\)&lt;/span&gt; IFWT åçš„ç»“æœåˆ†åˆ«å¯¹ä½ä¹˜ä¸Š &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; å³å¯ï¼Œå¾ˆå¯æƒœæˆ‘å¹¶æ²¡æœ‰è¿™æ ·çš„æ•°å­¦èƒ½åŠ› &lt;img src=&#34;/em/kt.gif&#34; /&gt;&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int N = 17;
const int mod = 1e9 + 7;
using arr = std::vector&amp;lt;long long&amp;gt;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, l;
    std::cin &amp;gt;&amp;gt; n, l = 1 &amp;lt;&amp;lt; N;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    arr f(l), cnt(l), cnt1(l), cnt2(l);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i], ++cnt[a[i]];
    f[0] = 0ll, f[1] = 1ll;
    for (int i = 2; i &amp;lt; l; ++i)
        f[i] = (f[i - 1] + f[i - 2]) % mod;
    auto qkp = [&amp;amp;](long long x, int y = mod - 2) &amp;#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    const int inv2 = qkp(2ll);
    std::vector&amp;lt;arr&amp;gt; mT(2, arr(2)), mI(2, arr(2));
    auto calc = [&amp;amp;](arr a, arr &amp;amp;f, std::vector&amp;lt;arr&amp;gt; &amp;amp;w) &amp;#123;
        f = a;
        for (int len = 2; len &amp;lt;= l; len &amp;lt;&amp;lt;= 1)
            for (int i = 0; i &amp;lt; l; i += len)
                for (int p = i, q = i + len / 2; q &amp;lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);
        return;
    &amp;#125;;
    &amp;#123; // orFWT
        mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;
        mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;
        std::vector&amp;lt;arr&amp;gt; u(N + 1, arr(l)), d(N + 1, arr(l));
        for (int i = 0; i &amp;lt; l; ++i)
            u[__builtin_popcount(i)][i] = cnt[i];
        for (int i = 0; i &amp;lt;= N; ++i)
            calc(u[i], u[i], mT);
        for (int i = 0; i &amp;lt;= N; ++i) &amp;#123;
            for (int j = 0; j &amp;lt; l; ++j)
                for (int k = 0; k &amp;lt;= i; ++k)
                    (d[i][j] += u[k][j] * u[i - k][j]) %= mod;
            calc(d[i], d[i], mI);
        &amp;#125;
        for (int i = 0; i &amp;lt; l; ++i)
            cnt1[i] = d[__builtin_popcount(i)][i] * f[i] % mod;
    &amp;#125;
    &amp;#123; // xor FWT
        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = mod - 1ll;
        mI[0][0] = mI[0][1] = mI[1][0] = inv2, mI[1][1] = mod - inv2;
        calc(cnt, cnt2, mT);
        for (int i = 0; i &amp;lt; l; ++i)
            (cnt2[i] *= cnt2[i]) %= mod;
        calc(cnt2, cnt2, mI);
        for (int i = 0; i &amp;lt; l; ++i)
            (cnt2[i] *= f[i]) %= mod;
    &amp;#125;
    &amp;#123; // andFWT
        mT[0][0] = 0ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = 1ll;
        mI[0][0] = mod - 1ll, mI[0][1] = 1ll, mI[1][0] = 1ll, mI[1][1] = 0ll;
        for (int i = 0; i &amp;lt; l; ++i) // è¿™ä¸€æ­¥è¦æ”¾åœ¨ FWT ä¹‹å‰ï¼ŒåŸå› æ˜¾ç„¶ ğŸ¤—
            (cnt[i] *= f[i]) %= mod;
        calc(cnt2, cnt2, mT), calc(cnt1, cnt1, mT), calc(cnt, cnt, mT);
        for (int i = 0; i &amp;lt; l; ++i)
            cnt[i] = cnt[i] * cnt1[i] % mod * cnt2[i] % mod % mod;
        calc(cnt, cnt, mI);
    &amp;#125;
    long long res = 0ll;
    for (int i = 0; i &amp;lt; N; ++i)
        (res += cnt[1 &amp;lt;&amp;lt; i] % mod) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="é«˜ç»´å‰ç¼€å’Œ" />
        <category term="FWT" />
        <updated>2025-03-29T07:00:21.000Z</updated>
    </entry>
</feed>
