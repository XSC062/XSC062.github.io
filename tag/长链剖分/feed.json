{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"é•¿é“¾å‰–åˆ†\" tag",
    "description": "",
    "home_page_url": "https://xsc062.netlify.app",
    "items": [
        {
            "id": "https://xsc062.netlify.app/20250803/",
            "url": "https://xsc062.netlify.app/20250803/",
            "title": "æ ‘ DP",
            "date_published": "2025-08-03T03:44:54.000Z",
            "content_html": "<p>æ ‘ä¸Šçš„ DP ä»¥åŠ å’Œæ ‘æœ‰å…³çš„ DP</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a---svjetlo\">A - Svjetlo</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7163\" class=\"uri\">https://www.luogu.com.cn/problem/P7163</a></p>\n<p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œå³ä»¤ <span class=\"math inline\">\\(f_{x,0/1/2}\\)</span> åˆ†åˆ«è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(0/1/2\\)</span> ä¸ªç«¯ç‚¹åœ¨å­æ ‘å†…éƒ¨çš„æƒ…å†µï¼›ç„¶åå°±å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ»¡è¶³å¯¹äºå¼€å…³çŠ¶æ€çš„è¦æ±‚ï¼Ÿ</p>\n<p>è¿˜æ˜¯æƒ³å°‘äº†ã€‚å¦‚æœå†åŠ ä¸€ç»´ï¼Œä»ã€çŠ¶æ€ä¸ºå¼€æˆ–å…³ã€æ€è€ƒå°±ä¼šè½»æ¾å¾ˆå¤šï¼Œä»¤ <span class=\"math inline\">\\(f_{x,0/1/2,0/1}\\)</span> è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(0/1/2\\)</span> ä¸ªç«¯ç‚¹å†å­æ ‘å¤–éƒ¨ï¼Œä¸”å­æ ‘å†…æ“ä½œå®Œå <span class=\"math inline\">\\(x\\)</span> ä¸ºå…³ / å¼€çš„æœ€å°‘æ­¥æ•°ã€‚ç„¶ååˆ†ç±»è®¨è®ºè½¬ç§»æ–¹å¼å³å¯ã€‚</p>\n<p>ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„è®¨è®ºæ–¹å¼æ˜¯ï¼Œå…ˆç¡®å®šæŸç§æƒ…å†µä¸‹ï¼Œè®¿é—® <span class=\"math inline\">\\(u\\)</span> ä¸ <span class=\"math inline\">\\(v\\)</span> çš„æ¬¡æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°å®ƒä»¬åŸæœ¬çš„çŠ¶æ€ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, rt = -1;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        a[i] = t - &#39;0&#39;;\n        if (!a[i])\n            rt = i;\n    &#125;\n    if (rt == -1) &#123;\n        std::cout &lt;&lt; 0 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; tag(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        tag[x] = a[x];\n        for (auto i : g[x])\n            if (i != fa)\n                DFS(i, x), tag[x] &amp;= tag[i];\n        return;\n    &#125;;\n    DFS(rt, -1);\n    std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(n + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (3, std::vector&lt;int&gt; (2, 0x3f3f3f3f)));\n    DFS = [&amp;](int x, int fa) &#123;\n        f[x][0][a[x]] = 0;\n        for (auto i : g[x])\n            if (i != fa &amp;&amp; !tag[i]) &#123;\n                DFS(i, x);\n                auto g = f[x];\n                f[x][0][0] = std::min(g[0][0] + f[i][0][1] + 4, g[0][1] + f[i][0][0] + 2);\n                f[x][0][1] = std::min(g[0][1] + f[i][0][1] + 4, g[0][0] + f[i][0][0] + 2);\n                f[x][1][0] = std::min(&#123; g[1][0] + f[i][0][1] + 4, g[1][1] + f[i][0][0] + 2, g[0][0] + f[i][1][0] + 3, g[0][1] + f[i][1][1] + 1 &#125;);\n                f[x][1][1] = std::min(&#123; g[1][1] + f[i][0][1] + 4, g[1][0] + f[i][0][0] + 2, g[0][1] + f[i][1][0] + 3, g[0][0] + f[i][1][1] + 1 &#125;);\n                f[x][2][0] = std::min(&#123; g[2][0] + f[i][0][1] + 4, g[2][1] + f[i][0][0] + 2, g[1][0] + f[i][1][1], g[1][1] + f[i][1][0] + 2, g[0][0] + f[i][2][1] + 4, g[0][1] + f[i][2][0] + 2 &#125;);\n                f[x][2][1] = std::min(&#123; g[2][1] + f[i][0][1] + 4, g[2][0] + f[i][0][0] + 2, g[1][1] + f[i][1][1], g[1][0] + f[i][1][0] + 2, g[0][1] + f[i][2][1] + 4, g[0][0] + f[i][2][0] + 2 &#125;);\n            &#125;\n        f[x][1][0] = std::min(f[x][1][0], f[x][0][1] + 1);\n        f[x][1][1] = std::min(f[x][1][1], f[x][0][0] + 1);\n        f[x][2][0] = std::min(f[x][2][0], f[x][1][0]);\n        f[x][2][1] = std::min(f[x][2][1], f[x][1][1]);\n        // for (int i = 0; i &lt; 3; ++i)\n        //     for (int j = 0; j &lt; 2; ++j)\n        //         printf(&quot;f[%d][%d][%d] = %d\\n&quot;, x, i, j, f[x][i][j]);\n        return;\n    &#125;;\n    DFS(rt, -1);\n    std::cout &lt;&lt; f[rt][2][1] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---one-to-one\">B - One to One</h2>\n<p><a href=\"https://atcoder.jp/contests/arc140/tasks/arc140_d\" class=\"uri\">https://atcoder.jp/contests/arc140/tasks/arc140_d</a></p>\n<p>è§‚å¯ŸåŸå›¾ä¸Šè¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯æ²¡æœ‰æœªç¡®å®šè¾¹çš„åŸºç¯æ ‘ï¼Œè¦ä¹ˆæ˜¯æœ‰æ°å¥½ä¸€æ¡æœªç¡®å®šè¾¹çš„æ ‘ã€‚ç¼©ç‚¹ï¼Œä»»æ„ä¸ºæœªç¡®å®šè¾¹èµ‹å€¼ï¼Œè€ƒå¯Ÿæœ€åå¾—åˆ°çš„è¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯ä»¥ã€åŸºç¯æ ‘ç‚¹ã€ä¸ºæ ¹çš„æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸åŒ…å«ã€åŸºç¯æ ‘ç‚¹ã€çš„ï¼ˆå†…å‘ï¼‰åŸºç¯æ ‘ã€‚</p>\n<p>è¿™é‡Œè¦ç”¨åˆ°è´¡çŒ®çš„æ€æƒ³ã€‚è€ƒè™‘å°†å…¨å±€åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œä¿è¯æ¯éƒ¨åˆ†çš„å•æ­¥ä»·å€¼æ˜¯å¯ç¡®å®šçš„ã€‚å°†ç¬¬ä¸€æ­¥ï¼Œå³å¯¹æ ‘å’ŒåŸºç¯æ ‘çš„è®¨è®ºæ‹†å¼€ï¼Œå¯¹äºæ ‘ï¼Œå…¶æ•°é‡ç¡®å®šï¼›å¯¹äºåŸºç¯æ ‘ï¼Œå‘ç°ç¯çš„æ•°é‡å³ä¸ºåŸºç¯æ ‘çš„æ•°é‡ï¼Œè¿›ä¸€æ­¥å°†æ‰€æœ‰æ­¥ä¸­çš„ã€ç¯ã€è¿™ä¸€ç±»åˆ†å¼€ï¼Œç»Ÿè®¡æˆç¯çš„æ–¹æ¡ˆæ•°å°±å¯ä»¥å¾—åˆ°åŸºç¯æ ‘çš„è´¡çŒ®ã€‚å…·ä½“åœ°ï¼Œä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> ä¸ºåœ¨å‰ <span class=\"math inline\">\\(i\\)</span> ä¸ªç‚¹ä¸­é€‰æ‹© <span class=\"math inline\">\\(j\\)</span> ä¸ªæˆä¸€ä¸ªç¯çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{i,j}=f_{i-1,j}+f_{i-1,j-1}\\times siz_i\n\\]</span></p>\n<p>æœ€åè®¡ç®—æ¯ä¸ªç¯çš„è´¡çŒ®å³å¯ã€‚æ³¨æ„è¿˜è¦ç®—ä¸Šç¯å†…éƒ¨çš„æ’åˆ—ï¼ˆæ³¨æ„å¾ªç¯ä½ç§»ï¼‰ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), tag(n + 1), s(n + 1, 1), fa(n + 1), siz(n + 1);\n    std::iota(fa.begin() + 1, fa.end(), 1);\n    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;\n        return x == fa[x] ? x : fa[x] = find(fa[x]);\n    &#125;;\n    auto merge = [&amp;](int x, int y) &#123;\n        x = find(x), y = find(y);\n        if (x != y) &#123;\n            tag[y] += tag[x];\n            s[y] += s[x];\n            fa[x] = y;\n        &#125;\n        return;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)  &#123;\n        std::cin &gt;&gt; a[i], fa[i] = i;\n        if (a[i] == -1)\n            tag[i] = 1;\n        else\n            merge(i, a[i]);\n    &#125;\n    int cnt1 = 0, cnt2 = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        cnt1 += (fa[i] == i &amp;&amp; !tag[i]);\n        if (fa[i] == i &amp;&amp; tag[i])\n            siz[++cnt2] = s[i];\n    &#125;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    auto res(cnt1 * qkp(n, cnt2) % mod);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(cnt2 + 1, std::vector&lt;long long&gt; (cnt2 + 1));\n    f[0][0] = 1ll;\n    for (int i = 1; i &lt;= cnt2; ++i) &#123;\n        // printf(&quot;i = %d, siz = %d: \\n&quot;, i, siz[i]);\n        for (int j = 0; j &lt;= i; ++j) &#123;\n            f[i][j] = f[i - 1][j];\n            if (j != 0)\n                (f[i][j] += f[i - 1][j - 1] * siz[i]) %= mod;\n            // printf(&quot;  f[%d][%d] = %lld\\n&quot;, i, j, f[i][j]);\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= cnt2; ++i) &#123;\n        static auto fac(1ll);\n        (res += f[cnt2][i] * fac % mod * qkp(n, cnt2 - i) % mod) %= mod;\n        (fac *= i) %= mod;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---diameter-cuts\">C - Diameter Cuts</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1499/F\" class=\"uri\">https://codeforces.com/problemset/problem/1499/F</a></p>\n<p>ä»¤ <span class=\"math inline\">\\(f_{x,i}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(x\\)</span> ä¸Šçš„æœ€é•¿é“¾é•¿ä¸º <span class=\"math inline\">\\(i\\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªç±»ä¼¼èƒŒåŒ…çš„è¿‡ç¨‹æ±‚ç­”æ¡ˆäº†ã€‚å‘ç°è¿™ä¸ªèƒŒåŒ…æ»¡è¶³å¯ä»¥è¢«ä¼˜åŒ–çš„å½¢å¼ï¼Œæ•…èƒ½åœ¨ <span class=\"math inline\">\\(O(nk)\\)</span> å†…è§£å†³é—®é¢˜ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, k;\n    std::cin &gt;&gt; n &gt;&gt; k, ++k;\n    if (k == 0) &#123;\n        std::cout &lt;&lt; 1 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; h(n + 1);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (k + 1));\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        f[x][1] = 1ll, h[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                std::vector&lt;long long&gt; g(k + 1);\n                g.swap(f[x]);\n                for (int j = std::min(h[x], k); j; --j)\n                    for (int l = std::min(h[i], k - j); ~l; --l)\n                        (f[x][std::max(j, l + 1)] += g[j] * f[i][l] % mod) %= mod;\n                h[x] = std::max(h[x], h[i] + 1);\n            &#125;\n        for (int i = 1; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)\n            (f[x][0] += f[x][i]) %= mod;\n        // for (int i = 0; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)\n        //     printf(&quot;f[%d][%d] = %lld\\n&quot;, x, i, f[x][i]);\n        return;\n    &#125;;\n    DFS(1, -1);\n    auto res(0ll);\n    for (int i = 1; i &lt;= k; ++i)\n        (res += f[1][i]) %= mod;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---leaf-partition\">D - Leaf Partition</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1146/F\" class=\"uri\">https://codeforces.com/problemset/problem/1146/F</a></p>\n<p>å‡è®¾å·²ç»å®Œæˆåˆ†ç»„ï¼Œæ¬²åˆ¤å®šè¿™ç§æ–¹å¼æ˜¯å¦åˆæ³•ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ¯ä¸€ç»„å¶å­å»ºç«‹è™šæ ‘ï¼Œåˆ™è¯¥åˆ†ç»„æ–¹å¼åˆæ³•ï¼Œå½“ä¸”ä»…å½“æ²¡æœ‰ä¸€ä¸ªç‚¹è¢«å¤šä¸ªè™šæ ‘å ç”¨ã€‚ä¹Ÿå³ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ€»çš„è™šæ ‘ä¸Šé€‰å‡ºä¸€äº›ç‚¹ï¼Œè®©å®ƒä»¬å¯ä»¥è¦†ç›–æ‰€æœ‰å¶å­ã€‚</p>\n<p>è™šæ ‘ä¸Š DPï¼Œå®¹æ˜“å‘ç°å½“ä¸”ä»…å½“å­˜åœ¨ <span class=\"math inline\">\\(\\ge 2\\)</span> ä¸ªå„¿å­æƒ³è¦åˆ†è¿›åŒä¸€ä¸ªè™šæ ‘æ—¶ï¼Œ<span class=\"math inline\">\\(i\\)</span> ä¼šè¢«é€‰åˆ°ã€‚æ•…ä»¤ <span class=\"math inline\">\\(f_{i, 0/1/2}\\)</span> è¡¨ç¤ºå½“å‰æœ‰ <span class=\"math inline\">\\(0/1/\\ge 2\\)</span> ä¸ªå„¿å­æƒ³è¦é€‰æ‹© <span class=\"math inline\">\\(i\\)</span> æ—¶çš„æ–¹æ¡ˆæ•°ï¼ŒDP å³å¯ã€‚</p>\n<p>åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç°æ ¹æœ¬ä¸éœ€è¦æ±‚è™šæ ‘ï¼ŒåŸæ ‘ä¸Š DP å°±å¯ä»¥äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; fa(n + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 2; i &lt;= n; ++i)\n        std::cin &gt;&gt; fa[i], g[fa[i]].push_back(i);\n    std::vector&lt;std::array&lt;long long, 3&gt; &gt; f(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        if (g[x].empty())\n            f[x][2] = 1ll;\n        else\n            f[x][0] = 1ll;\n        for (auto i : g[x]) &#123;\n            DFS(i);\n            auto F0 = (f[i][0] + f[i][2]) % mod, F1 = (f[i][1] + f[i][2]) % mod;\n            f[x][2] = (f[x][2] * F0 % mod + f[x][2] * F1 % mod + f[x][1] * F1 % mod) % mod;\n            f[x][1] = (f[x][1] * F0 % mod + f[x][0] * F1 % mod) % mod;\n            (f[x][0] *= F0) %= mod;\n        &#125;\n        // printf(&quot;%d: %lld / %lld / %lld\\n&quot;, x, f[x][0], f[x][1], f[x][2]);\n        return;\n    &#125;;\n    DFS(1);\n    std::cout &lt;&lt; (f[1][0] + f[1][2]) % mod &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---uniformly-branched-trees\">E - Uniformly Branched Trees</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/724/F\" class=\"uri\">https://codeforces.com/problemset/problem/724/F</a></p>\n<p>æ„Ÿè§‰æ˜¯å¾ˆå¸¸è§çš„å¥—è·¯ï¼Œä½†æ˜¯æˆ‘ä¸ä¼š ğŸ˜±</p>\n<p>åœ¨æ‰‹ç©æ ·ä¾‹çš„æ—¶å€™å¯ä»¥æ„Ÿæ€§è®¤çŸ¥åˆ°ï¼Œæ¯ä¸ªæ ‘ä¼šè¢«æ¯ç§ç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µç»Ÿè®¡ä¸€æ¬¡ã€‚ä¸”å¦‚æœå›ºå®šä»¥æŸç§ï¼ˆåŒ–å­¦ç¯å¢ƒï¼‰çš„ç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥é€šè¿‡æŒ‰ siz ä»å°åˆ°å¤§æ’åˆ—å”¯ä¸€æ±‚è§£å‡ºè¯¥æ ‘ã€‚</p>\n<p>å‘ç°ä»¥é‡å¿ƒä¸ºæ ¹ï¼ˆå³é’¦å®šæ ¹ä¸ºé‡å¿ƒï¼‰å¯ä»¥å¸¦æ¥å¾ˆå¤šä¼˜ç¾çš„æ€§è´¨ã€‚å› ä¸º siz æ˜¯å¥½ç¡®å®šçš„ï¼Œä¸”æ˜¯å„¿å­çš„æ’åºä¾æ®ï¼Œæ‰€ä»¥é€‰é‡å¿ƒä¾¿äºç»Ÿè®¡ï¼ŒåŒæ—¶æ»¡è¶³æ¯ç§æ ‘æœ€å¤šè¢«ç»Ÿè®¡ä¸¤æ¬¡ï¼ˆå½“ä¸”ä»…å½“æœ‰ä¸¤ä¸ªé‡å¿ƒï¼‰ã€‚</p>\n<p>å‘ç°è¿™å°±å˜æˆäº†å¤šé‡é›†çš„ç»„åˆæ•°ï¼Œè®¾ <span class=\"math inline\">\\(f_{i,j,k}\\)</span> è¡¨ç¤ºå·²ç»èŠ±è´¹ <span class=\"math inline\">\\(i\\)</span> ä¸ªç‚¹ç»„æˆä¸€ä¸ªå­æ ‘ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹å½“å‰å·²ç»ç¡®è®¤äº† <span class=\"math inline\">\\(j\\)</span> ä¸ªå„¿å­ï¼Œæœ€é å³çš„ä¸€ä¸ª siz <span class=\"math inline\">\\(\\le k\\)</span> çš„æ–¹æ¡ˆæ•°ã€‚å¾—åˆ° <span class=\"math inline\">\\(f_{i,j,k}=\\sum_{x=0} f_{i-x\\cdot k,j-x,k-1}\\cdot \\binom{f_{k,d-1,k}+x-1}{x}\\)</span>ï¼ˆç›¸å½“äºå°† <span class=\"math inline\">\\(x\\)</span> ä¸ªæ— æ ‡å·çš„ä½ç½® / çƒåˆ†é…ç»™ <span class=\"math inline\">\\(f_{k,d-1,k}\\)</span> ä¸ªæœ‰æ ‡å·çš„é€‰é¡¹ / ç›’å­ï¼Œæ’æ¿å³å¯ï¼‰ã€‚</p>\n<p>è‹¥ <span class=\"math inline\">\\(n\\)</span> ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ç›´æ¥è¾“å‡º <span class=\"math inline\">\\(f_{n,d,\\lfloor\\frac n2\\rfloor}\\)</span>ï¼›è‹¥ <span class=\"math inline\">\\(n\\)</span> ä¸ºå¶æ•°ï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸¤ä¸ªé‡å¿ƒï¼Œå³éœ€è¦ç»Ÿè®¡æ‹¥æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸”ä»¥ä¸¤ä¸ªé‡å¿ƒåˆ†åˆ«ä¸ºæ ¹æ—¶é•¿ç›¸ä¸åŒçš„æ ‘ç§ç±»ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¾ç„¶å­˜åœ¨ä¸€æ¡è¾¹ï¼Œå·¦å³ä¸¤è¾¹ siz ç›¸åŒä¸”é•¿ç›¸ä¸åŒã€‚æ•…æ•°é‡ä¸º <span class=\"math inline\">\\(\\binom{f_{\\lfloor \\frac n2\\rfloor, d-1,\\lfloor \\frac n2\\rfloor}}{2}\\)</span>ï¼Œå®¹æ–¥æ‰å³å¯ã€‚</p>\n<p>éœ€è¦ç‰¹åˆ¤ <span class=\"math inline\">\\(n\\le2\\)</span> çš„æƒ…å†µã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, d, mod;\n    std::cin &gt;&gt; n &gt;&gt; d &gt;&gt; mod;\n    if (n &lt;= 2) &#123;\n        std::cout &lt;&lt; 1 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    using arr = std::vector&lt;long long&gt;;\n    using brr = std::vector&lt;arr&gt;;\n    using crr = std::vector&lt;brr&gt;;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    arr inv(d + 1);\n    inv[0] = inv[1] = 1ll;\n    auto fac = 1ll;\n    for (int i = 2; i &lt;= d; ++i) &#123;\n        (fac *= i) %= mod;\n        inv[i] = qkp(fac, mod - 2);\n    &#125;\n    auto C = [&amp;](long long n, int m) &#123;\n        if (m == 0)\n            return 1ll;\n        if (m &gt; n)\n            return 0ll;\n        auto res(1ll);\n        for (auto i = 0; i &lt; m; ++i)\n            (res *= n - i) %= mod;\n        return res * inv[m] % mod;\n    &#125;;\n    crr f(n + 1, brr(d + 1, arr(n / 2 + 1)));\n    f[1][0][0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        for (int j = 0; j &lt;= d &amp;&amp; 1 + j &lt;= i; ++j) &#123;\n            for (int x = 0; x &lt;= j &amp;&amp; x &lt;= i; ++x)\n                f[i][j][1] += f[i - x][j - x][0];\n            f[i][j][1] %= mod;\n            for (int k = 2; k &lt;= n / 2; ++k) &#123;\n                // bool flag = (i == 10 &amp;&amp; j == 3 &amp;&amp; k == 3);\n                for (int x = 0; x &lt;= j &amp;&amp; x * k &lt;= i; ++x) &#123;\n                    f[i][j][k] += f[i - x * k][j - x][k - 1] * C(f[k][d - 1][k - 1] + x - 1, x);\n                    // if (flag)\n                    //     printf(&quot;x = %d, f[%d][%d][%d](%lld) * C(%lld, %d)(%lld)\\n&quot;, x, i - x * k, j - x, k - 1, f[i - x * k][j - x][k - 1], f[k][d - 1][k - 1] + x - 1, x, C(f[k][d - 1][k - 1] + x - 1, x));\n                &#125;\n                f[i][j][k] %= mod;\n            &#125;\n        &#125;\n    // for (int i = 1; i &lt;= n; ++i)\n    //     for (int j = 0; j &lt;= d &amp;&amp; j &lt;= i - 1; ++j, puts(&quot;&quot;))\n    //         for (int k = 0; k &lt;= n / 2; ++k) &#123;\n    //             printf(&quot;f[%d][%d][%d] = %lld\\n&quot;, i, j, k, f[i][j][k]);\n    //         &#125;\n    if (n &amp; 1)\n        std::cout &lt;&lt; f[n][d][n / 2] &lt;&lt; &#39;\\n&#39;;\n    else &#123;\n        auto res(f[n][d][n / 2]);\n        res = (res + mod - C(f[n / 2][d - 1][n / 2 - 1], 2)) % mod;\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a---dominant-indices\">A - Dominant Indices</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1009/F\" class=\"uri\">https://codeforces.com/problemset/problem/1009/F</a></p>\n<p>é•¿å‰–æ¿å­ï¼›éš¾ç‚¹åœ¨äºå¯èƒ½è¦å¤ä¹ ä¸€ä¸‹é•¿å‰–æ€ä¹ˆå†™ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; h(n + 1), son(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        h[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                h[x] = std::max(h[x], h[i] + 1);\n                if (h[i] &gt; h[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::vector&lt;int&gt; _f(2 * n + 1), res(n + 1);\n    auto pos(_f.begin());\n    std::vector&lt;decltype(pos)&gt; f(n + 1);\n    DFS = [&amp;](int x, int fa) &#123;\n        ++f[x][0];\n        if (!son[x]) &#123;\n            res[x] = 0;\n            return;\n        &#125;\n        f[son[x]] = std::next(f[x]);\n        DFS(son[x], x);\n        int mx = -std::max(std::make_pair(f[x][res[son[x]] + 1], -(res[son[x]] + 1)), std::make_pair(1, 0)).second;\n        for (auto i : g[x])\n            if (i != fa &amp;&amp; i != son[x]) &#123;\n                f[i] = pos, pos = std::next(pos, h[i] + 1);\n                DFS(i, x);\n                for (int j = 0; j &lt;= h[i]; ++j) &#123;\n                    f[x][j + 1] += f[i][j];\n                    if (j + 1 != mx &amp;&amp; std::make_pair(f[x][j + 1], -(j + 1)) &gt; std::make_pair(f[x][mx], -mx))\n                        mx = j + 1;\n                &#125;\n            &#125;\n        // printf(&quot;%d: &quot;, x);\n        // for (int i = 0; i &lt;= h[x]; ++i)\n        //     printf(&quot;%d &quot;, f[x][i]);\n        // puts(&quot;&quot;);\n        res[x] = mx;\n        return;\n    &#125;;\n    f[1] = pos, pos = std::next(pos, h[1]);\n    DFS(1, -1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---æ ‘ä¸Šå¼‚æˆ–\">B - æ ‘ä¸Šå¼‚æˆ–</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P9745\" class=\"uri\">https://www.luogu.com.cn/problem/P9745</a></p>\n<p>å’Œ <a href=\"#a---svjetlo\">Svjetlo</a> å¾ˆåƒï¼ŒæŠŠè¿é€šå—çš„å¼‚æˆ–å’Œæ”¾åˆ°çŠ¶æ€é‡Œï¼Œæ‹†ä½åä»¤ <span class=\"math inline\">\\(f_{i,j,0/1}\\)</span> è¡¨ç¤ºç‚¹ <span class=\"math inline\">\\(i\\)</span> æ‰€åœ¨çš„è¿é€šå—åœ¨ç¬¬ <span class=\"math inline\">\\(j\\)</span> ä½å¼‚æˆ–å’Œä¸º <span class=\"math inline\">\\(0/1\\)</span> çš„æƒå€¼ï¼ˆ<strong>ä¸è®¡ <span class=\"math inline\">\\(i\\)</span> æ‰€åœ¨è¿é€šå—</strong>ï¼‰ï¼Œè½¬ç§»å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;long long&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 2, x; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; x;\n        g[x].push_back(i), g[i].push_back(x);\n    &#125;\n    std::vector&lt;long long&gt; dp(n + 1);\n    std::vector&lt;std::array&lt;std::array&lt;long long, 2&gt;, 60&gt; &gt; f(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        for (int i = 0; i &lt; 60; ++i)\n            f[x][i][(a[x] &gt;&gt; i) &amp; 1] = 1ll;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                for (int j = 0; j &lt; 60; ++j) &#123;\n                    auto f1 = f[x][j];\n                    f[x][j][0] = (f1[0] * dp[i] % mod + f1[0] * f[i][j][0] % mod + f1[1] * f[i][j][1] % mod) % mod;\n                    f[x][j][1] = (f1[1] * dp[i] % mod + f1[0] * f[i][j][1] % mod + f1[1] * f[i][j][0] % mod) % mod;\n                &#125;\n            &#125;\n        for (int i = 0; i &lt; 60; ++i)\n            dp[x] += (1ll &lt;&lt; i) % mod * f[x][i][1] % mod;\n        dp[x] %= mod;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::cout &lt;&lt; dp[1] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---ä¸€ä¸ªç½‘çš„è·¯\">C - ä¸€ä¸ªç½‘çš„è·¯</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P8595\" class=\"uri\">https://www.luogu.com.cn/problem/P8595</a></p>\n<p>é¦–å…ˆéœ€è¦æ„è¯†åˆ°ï¼Œæ ‘å’Œé“¾çš„è¾¹æ•°æ˜¯ä¸€æ ·çš„ï¼Œç‚¸æ‰äº†å¤šå°‘æ¡è¾¹ï¼Œåœ¨ä¹‹åå°±ä¼šèŠ±å¤šå°‘ä»£ä»·è¡¥å›æ¥ã€‚æ•…ç‚¸ä¸€ä¸ªç‚¹çš„ä»£ä»·ä¸ºåº¦æ•° +1ã€‚å¯¹äºä¸€ä¸ªç‚¹ <span class=\"math inline\">\\(u\\)</span>ï¼Œåˆ†ä¸ºå››ç§å¯èƒ½æ€§ï¼š</p>\n<ul>\n<li>è¢«ç‚¸äº†ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿é€šå—ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œå„¿å­å…¨éƒ¨è¢«ç‚¸äº†ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 1 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 2 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li>\n</ul>\n<p>åˆ†åˆ«ç”¨ <span class=\"math inline\">\\(f_{u,0/1/2/3}\\)</span> ä»£è¡¨ä¸Šé¢å››ç§å¯èƒ½æ€§ï¼Œè½¬ç§»å³å¯ã€‚</p>\n<p>è´ºäº†ä¸ª freadï¼Œæ“¦è¾¹è·‘è¿‡äº†ã€‚è¿™ä¸ªä¸æ˜¯ <span class=\"math inline\">\\(O(n)\\)</span> çš„å—ï¼Ÿ</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int LEN = (1 &lt;&lt; 20);\n#ifdef ONLINE_JUDGE\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n\n#endif\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nint main() &#123;\n    int n, m;\n    read(n), read(m);\n    int res = (n - 1) - m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int x, y; m--; ) &#123;\n        read(x), read(y);\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; tag(n + 1);\n    std::vector&lt;std::array&lt;int, 4&gt; &gt; f(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        tag[x] = 1;\n        f[x][0] = (fa != -1) + 1;\n        f[x][2] = f[x][3] = 0x3f3f3f3f;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                f[x][3] = std::min(f[x][3] + f[i][0], f[x][2] + std::min(f[i][1], f[i][2]));\n                f[x][2] = std::min(f[x][2] + f[i][0], f[x][1] + std::min(f[i][1], f[i][2]));\n                f[x][1] += f[i][0];\n                f[x][0] += std::min(&#123; f[i][0] - 1, f[i][1], f[i][2], f[i][3] &#125;) + 1;\n            &#125;\n        return;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)\n        if (!tag[i]) &#123;\n            DFS(i, -1);\n            res += *std::min_element(f[i].begin(), f[i].end());\n        &#125;\n    print(res, &#39;\\n&#39;);\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---éšæœºæ ‘\">D - éšæœºæ ‘</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P3830\" class=\"uri\">https://www.luogu.com.cn/problem/P3830</a></p>\n<p>å¯¹äºç¬¬ä¸€é—®ï¼Œä»¤ <span class=\"math inline\">\\(f_x\\)</span> è¡¨ç¤ºå…±æœ‰ <span class=\"math inline\">\\(x\\)</span> ä¸ªå¶å­æ—¶çš„æœŸæœ›æ·±åº¦ï¼Œä¸¤ä¸ªæ–°å¶å­çš„æœŸæœ›æ·±åº¦ä¸º <span class=\"math inline\">\\(f_{x-1}+1\\)</span>ï¼Œdelta ä¸º <span class=\"math inline\">\\(f_{x-1}+2\\)</span>ï¼Œæ•…æœ‰ <span class=\"math inline\">\\(f_x=\\dfrac {(x-1)f_{x-1}+f_{x-1}+2}x\\)</span>ï¼Œé€’æ¨å³å¯ã€‚</p>\n<p>å¯¹äºç¬¬äºŒé—®ï¼Œä»¤ <span class=\"math inline\">\\(f_{x,k}\\)</span> è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(x\\)</span> ä¸ªå¶å­ï¼Œæ·±åº¦ <span class=\"math inline\">\\(\\ge k\\)</span> çš„æ¦‚ç‡ï¼ˆä¸€ç§ç†è§£æ˜¯ä»æ•´æ•°æ¦‚ç‡å…¬å¼çš„è§’åº¦å‡ºå‘ï¼‰ã€‚åˆ™è€ƒè™‘æšä¸¾å·¦ã€å³å¶å­æ•°ï¼Œå¯¹äºå·¦ä¾§å¶å­æ•°ä¸º <span class=\"math inline\">\\(i\\)</span> çš„æƒ…å†µï¼Œ<strong>ä¸ºäº†å»é‡ï¼Œåªé€‰æ‹©æ·±åº¦ä¸º <span class=\"math inline\">\\(k-1\\)</span> çš„å¶å­å±•å¼€</strong>ã€‚åªè€ƒè™‘æŸç§ç»„åˆçš„å‡ºç°æ¦‚ç‡ï¼Œä¸º <span class=\"math inline\">\\(f_{i,k-1}+f_{x-i,k-1}-f_{i,k-1}\\cdot f_{x-i,k-1}\\)</span>ã€‚æ•°å½’å¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»æ„ <span class=\"math inline\">\\(i\\)</span>ï¼Œæ·±åº¦ä¸º <span class=\"math inline\">\\(k-1\\)</span> çš„å¶å­è¢«é€‰ä¸­çš„æ¦‚ç‡å‡ä¸º <span class=\"math inline\">\\(\\dfrac 1{x-1}\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int q, n;\n    std::cin &gt;&gt; q &gt;&gt; n;\n    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(6);\n    if (q == 1) &#123;\n        std::vector&lt;double&gt; f(n + 1);\n        for (int i = 2; i &lt;= n; ++i)\n            f[i] = (f[i - 1] * (i - 1) + f[i - 1] + 2.) / i;\n        std::cout &lt;&lt; f[n] &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    else &#123;\n        std::vector&lt;std::vector&lt;double&gt; &gt; f(n + 1, std::vector&lt;double&gt; (n + 1));\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            f[i][0] = 1.;\n            for (int j = 1; j &lt; i; ++j) &#123;\n                auto s(0.);\n                for (int k = 1; k &lt; i; ++k)\n                    s += f[k][j - 1] + f[i - k][j - 1] - f[k][j - 1] * f[i - k][j - 1];\n                f[i][j] = s / (i - 1);\n            &#125;\n        &#125;\n        auto res(0.);\n        for (int i = 1; i &lt; n; ++i)\n            res += f[n][i];\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---complete-compress\">E - Complete Compress</h2>\n<p><a href=\"https://atcoder.jp/contests/agc034/tasks/agc034_e\" class=\"uri\">https://atcoder.jp/contests/agc034/tasks/agc034_e</a></p>\n<p>å¯¹äºé“¾ï¼Œå‘ç°å¯ä»¥æšä¸¾æœ€åèšé›†çš„ç‚¹ï¼Œç­”æ¡ˆä¸é…å¯¹æ–¹å¼æ— å…³ï¼Œcheck æ˜¯å¦èƒ½é…å¯¹å³å¯ã€‚</p>\n<p>å¦‚æœä¸æ˜¯é“¾ï¼Œåˆ™ç›¸æ¯”é“¾ï¼Œè¿˜å¯ä»¥é€‰æ‹©åŒä¸€å­æ ‘ä¸­ä¸å­˜åœ¨ç¥–å­™å…³ç³»çš„ä¸¤ä¸ªç‚¹ï¼Œå°†å®ƒä»¬éƒ½å‘ LCA ç§»ä¸€æ­¥ã€‚</p>\n<p>æ•…è€Œï¼Œå¯ä»¥åœ¨é“¾çš„åšæ³•ä¸Šæ‰“ä¸€ä¸ªè¡¥ä¸ï¼Œè§‚å¯Ÿåˆ°å…ˆã€å†…éƒ¨æ¶ˆåŒ–ã€ï¼Œå†åœ¨å­æ ‘é—´é…å¯¹ä¸€å®šä¸åŠ£ï¼Œä¸”ç­”æ¡ˆä»ç„¶å’Œé…å¯¹æ–¹å¼æ— å…³ã€‚æ•…ä»¤ <span class=\"math inline\">\\(f_x\\)</span> è¡¨ç¤ºç‚¹ <span class=\"math inline\">\\(x\\)</span> å†…æœ€å¤šæ¶ˆæ‰å¤šå°‘å¯¹ï¼Œå°±å¯ä»¥ check äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;line_02.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        a[i] = t - &#39;0&#39;;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    auto res(inf);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::vector&lt;int&gt; s(n + 1);\n        std::vector&lt;long long&gt; f(n + 1), cnt(n + 1);\n        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n            s[x] = a[x];\n            int son = 0;\n            auto sum(0ll);\n            for (auto i : g[x])\n                if (i != fa) &#123;\n                    DFS(i, x), s[x] += s[i];\n                    sum += cnt[i];\n                    if (cnt[i] &gt; cnt[son])\n                        son = i;\n                &#125;\n            if (son) &#123;\n                if (cnt[son] * 2 &lt;= sum)\n                    f[x] = sum / 2;\n                else\n                    f[x] = sum - cnt[son] + std::min(f[son], (cnt[son] - (sum - cnt[son])) / 2);\n            &#125;\n            cnt[x] = sum;\n            if (x != i)\n                cnt[x] += s[x];\n            return;\n        &#125;;\n        DFS(i, -1);\n        if (cnt[i] % 2 == 0 &amp;&amp; f[i] == cnt[i] / 2)\n            res = std::min(res, cnt[i] / 2);\n    &#125;\n    if (res == inf)\n        std::cout &lt;&lt; -1 &lt;&lt; &#39;\\n&#39;;\n    else\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "DP",
                "æ ‘å½¢ DP",
                "é•¿é“¾å‰–åˆ†"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20241021-1/",
            "url": "https://xsc062.netlify.app/20241021-1/",
            "title": "é•¿é“¾å‰–åˆ† å­¦ä¹ ç¬”è®°",
            "date_published": "2024-10-21T08:33:47.000Z",
            "content_html": "<p><em>åŠç«¯ãªç”Ÿå‘½ã®é–¢æ•°ã‚’ / å°‘ã€…ã“ã“ã‚‰ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰</em></p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"å†…å®¹-æ€§è´¨\">å†…å®¹ &amp; æ€§è´¨</h2>\n<p>æŠŠé‡é“¾å‰–åˆ†é€‰çš„ siz æœ€å¤§çš„å„¿å­æ¢æˆé«˜åº¦æœ€å¤§çš„å„¿å­å°±æ˜¯é•¿å‰–äº†ã€‚åŒæ ·å…·æœ‰ä¸€äº›ç¾å¦™çš„æ€§è´¨ã€‚</p>\n<ul>\n<li><p>ä»»æ„ç‚¹åˆ°æ ¹èŠ‚ç‚¹ç»è¿‡çš„é“¾æ•°æœ€åŠ£ä¸º <span class=\"math inline\">\\(\\sqrt n\\)</span>ã€‚</p>\n<p>è€ƒè™‘æ„é€ ä¸€æ¡ç»è¿‡äº† <span class=\"math inline\">\\(\\sqrt n+1\\)</span> æ¡é“¾çš„è·¯å¾„ï¼Œå‘ç°æ„é€ ä¸å‡ºæ¥ã€‚å¾—è¯ã€‚ï¼ˆï¼Ÿï¼‰</p>\nè¿™ç‚¹ä¹Ÿå†³å®šäº†é•¿å‰–å’Œé‡å‰–èµ°çš„ä¸æ˜¯ä¸€æ¡èµ›é“ï¼Œæ›´å¤šçš„æ˜¯å¤„ç†ä¸€äº›å’Œæ·±åº¦æœ‰å…³çš„åœºæ™¯ä¸‹çš„é—®é¢˜ã€‚ç”¨æ³•æœ‰ç‚¹åƒ dsu on treeã€‚</li>\n<li><p>ä»»æ„ç‚¹ <span class=\"math inline\">\\(x\\)</span> çš„ <span class=\"math inline\">\\(k\\)</span> çº§ç¥–å…ˆ <span class=\"math inline\">\\(fa\\)</span> æ‰€åœ¨é“¾é•¿ <span class=\"math inline\">\\(\\ge k\\)</span>ã€‚</p>\n<p>è€ƒè™‘åè¯ã€‚è‹¥ <span class=\"math inline\">\\(fa\\)</span> æ‰€åœ¨é“¾é•¿åº¦ <span class=\"math inline\">\\(&lt;k\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(fa\\to x\\)</span> æ›´ä¼˜ï¼ŒçŸ›ç›¾ã€‚æ•…åŸå‘½é¢˜æˆç«‹ã€‚</p></li>\n</ul>\n<hr />\n<h2 id=\"æ±‚-k-çº§ç¥–å…ˆ\">æ±‚ k çº§ç¥–å…ˆ</h2>\n<p>é•¿å‰–çš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯ <span class=\"math inline\">\\(O(n\\log n)-O(1)\\)</span> æ±‚ <span class=\"math inline\">\\(k\\)</span> çº§ç¥–å…ˆã€‚å…ˆè€ƒè™‘ç›¸å¯¹æš´åŠ›çš„åšæ³•ï¼Œå¯ä»¥ <span class=\"math inline\">\\(O(n\\sqrt n)\\)</span> é¢„å¤„ç†æ¯ä¸ªç‚¹çš„ <span class=\"math inline\">\\(1\\sim \\sqrt n\\)</span> çº§ç¥–å…ˆç„¶åå—é—´å—å†…éšä¾¿è·³ä¸€è·³å°±æ˜¯ <span class=\"math inline\">\\(O(\\sqrt n)\\)</span> çš„å•æ¬¡æŸ¥è¯¢äº†ã€‚</p>\n<p>æŠŠè¿™ä¸ªæš´åŠ›ç»“åˆã€Œä»»æ„ç‚¹ <span class=\"math inline\">\\(k\\)</span> çº§ç¥–å…ˆæ‰€åœ¨é“¾é•¿ <span class=\"math inline\">\\(\\ge k\\)</span>ã€çš„æ€§è´¨ï¼Œä»¤ <span class=\"math inline\">\\(r=\\dfrac k2\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(x\\)</span> çš„ <span class=\"math inline\">\\(r\\)</span> çº§ç¥–å…ˆæ‰€åœ¨é“¾é•¿ <span class=\"math inline\">\\(\\ge r\\)</span>ã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“ <span class=\"math inline\">\\(r\\)</span> çº§ç¥–å…ˆ <span class=\"math inline\">\\(fa_r\\)</span>ï¼Œé¢„å¤„ç†å‡ºé“¾å†…ç‚¹åºåˆ—ã€é“¾é¡¶å‘ä¸Šçš„é“¾é•¿ä¸ªç¥–å…ˆï¼ˆå‡æ‘Š <span class=\"math inline\">\\(O(n)\\)</span>ï¼‰ï¼Œå°±å¯ä»¥ <span class=\"math inline\">\\(O(1)\\)</span> è®¿é—® <span class=\"math inline\">\\(fa_k\\)</span>ã€‚</p>\n<p>æ€ä¹ˆæ‰¾åˆ° <span class=\"math inline\">\\(fa_r\\)</span> å‘¢ï¼Ÿè¿™çœ‹ä¼¼æ˜¯é€’å½’çš„é—®é¢˜ï¼Œå®é™…ä¸Šå‘ç° <span class=\"math inline\">\\(r\\)</span> çš„å–å€¼åªéœ€ <span class=\"math inline\">\\(\\ge \\dfrac k2\\)</span>ï¼Œå¯¹äº <span class=\"math inline\">\\(1\\sim n\\)</span> çš„æ¯ä¸€ä¸ª <span class=\"math inline\">\\(k\\)</span>ï¼Œæ‰¾åˆ°å…¶æœ€é«˜äºŒè¿›åˆ¶ä½ <span class=\"math inline\">\\(r\\)</span>ï¼ˆæ˜¾ç„¶ <span class=\"math inline\">\\(r\\)</span> çš„å¯èƒ½å–å€¼æœ‰ <span class=\"math inline\">\\(\\log n\\)</span> ç§ï¼‰ï¼Œå¯¹äºæ¯ä¸ªç‚¹ï¼Œé¢„å¤„ç†å‡ºå…¶ <span class=\"math inline\">\\(\\log n\\)</span> ä¸ªä¸åŒçš„ <span class=\"math inline\">\\(r\\)</span> çº§ç¥–å…ˆã€‚è¿™ä¸ªå°±æ˜¯å€å¢äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>for (int i = 1, mx = 0; i &lt;= n; ++i) &#123;\n    if (i &gt;= (1 &lt;&lt; mx) * 2)\n        ++mx;\n    to[i] = mx;\n&#125;\nstd::vector&lt;std::array&lt;int, 21&gt; &gt; fa(n + 1);\nstd::vector&lt;int&gt; h(n + 1, 1), son(n + 1), dep(n + 1);\nh[0] = 0;\nstd::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n    for (auto i : g[x])\n        if (i != fa[x][0]) &#123;\n            fa[i][0] = x;\n            for (int j = 1; j &lt;= 20; ++j)\n                fa[i][j] = fa[fa[i][j - 1]][j - 1];\n            dep[i] = dep[x] + 1;\n            DFS(i);\n            if (h[i] &gt;= h[son[x]])\n                son[x] = i, h[x] = h[i] + 1;\n        &#125;\n    return;\n&#125;;\ndep[1] = 1, DFS(1);\nstd::vector&lt;int&gt; top(n + 1), id(n + 1);\nstd::vector&lt;std::vector&lt;int&gt; &gt; anc(n + 1), des(n + 1, std::vector&lt;int&gt; (1));\nstd::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int toq) &#123;\n    top[x] = toq;\n    if (son[x])\n        DFS1(son[x], toq);\n    for (auto i : g[x])\n        if (i != fa[x][0] &amp;&amp; i != son[x])\n            DFS1(i, i);\n    des[toq].push_back(x);\n    id[x] = (int)des[toq].size() - 1;\n    if (x == toq) &#123;\n        anc[x].push_back(x);\n        for (int j = 1, now = x; j &lt;= id[x]; ++j, now = fa[now][0])\n            anc[x].push_back(fa[now][0]);\n    &#125;\n    return;\n&#125;;\nDFS1(1, 1);\nauto ask = [&amp;](int x, int k) &#123;\n    int x1 = x;\n    if (!k)\n        return x;\n    x = fa[x][to[k]];\n    if (dep[x] - dep[top[x]] &gt;= k - (1 &lt;&lt; to[k]))\n        return des[top[x]][id[x] + k - (1 &lt;&lt; to[k])];\n    return anc[top[x]][k - (1 &lt;&lt; to[k]) - (dep[x] - dep[top[x]])];\n&#125;;</code></pre>\n</details>\n<hr />\n<h2 id=\"ä¼˜åŒ–-dp\">ä¼˜åŒ– DP</h2>\n<blockquote>\n<p>ylyï¼šç®¡å®ƒè¿™é‚£çš„ï¼Œåªè¦æ˜¯æœ‰å…³æ·±åº¦ç›´æ¥ä¸Šé•¿å‰–å°±æ˜¯äº†ã€‚</p>\n</blockquote>\n<p>å’Œ DSU on tree ç±»ä¼¼ï¼Œä¸»è¦åˆ©ç”¨æ¯æ¡é“¾åªä¼šè¢«ç®—ä¸€æ¬¡å®ç° <span class=\"math inline\">\\(O(n)\\)</span> DPã€‚å…·ä½“åœ°ï¼Œå°½å¯èƒ½åœ°ã€ç»§æ‰¿ã€é•¿é“¾çš„ä¿¡æ¯ï¼Œã€çŸ­é“¾ã€åˆ™æš´åŠ›åˆå¹¶ã€‚</p>\n<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬ã€æ·±åº¦ã€è¿™ä¸€ç»´ä¿¡æ¯ä¼šä»¥ã€ä¸ <span class=\"math inline\">\\(u\\)</span> çš„è·ç¦»ã€çš„å½¢å¼ï¼Œç»“åˆæŒ‡é’ˆæ¥ç»´æŠ¤ï¼ˆå› ä¸ºç›´æ¥è®°å½•æ·±åº¦ä¼šæ›´å²ï¼‰ã€‚</p>\n<p>å…·ä½“åœ°ï¼Œç”¨ä¸€ä¸ªå…¨å±€å¤§æ•°ç»„å®¹çº³æ‰€æœ‰ä¿¡æ¯ï¼Œä¸ºæ¯ä¸ªç‚¹åˆ†é…ç›¸åº”çš„æ•°ç»„å¤´æŒ‡é’ˆã€‚æ­£å¸¸æƒ…å†µä¸‹éœ€è¦ç”¨åˆ°çš„å…ƒç´ æœ€å¤šä¸º <span class=\"math inline\">\\(2n\\)</span>ï¼Œä½†å¦‚æœå­˜åœ¨ä¸€äº›è¯¡å¼‚çš„å‰ç§»åç§»æ“ä½œå°±å¦å½“åˆ«è®ºäº†ã€‚</p>\n<hr />\n<h3 id=\"p5904-poi-2014-hot-hotels-åŠ å¼ºç‰ˆ\">P5904 [POI 2014] HOT-Hotels åŠ å¼ºç‰ˆ</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P5904\" class=\"uri\">https://www.luogu.com.cn/problem/P5904</a></p>\n<p>é¦–å…ˆ <del>ä¸éš¾</del> å¾—åˆ° <span class=\"math inline\">\\(O(n^2)\\)</span> åšæ³•ï¼šæ˜¾ç„¶å­˜åœ¨ä¸€ä¸ªç‚¹åˆ°ä¸‰ä¸ªç‚¹è·ç¦»ç›¸ç­‰ã€‚è¿™ä¸ªç‚¹æ—¢å¯èƒ½æ˜¯å®ƒä»¬çš„ LCAï¼Œä¹Ÿå¯èƒ½æ˜¯å…¶ä¸­ä¸€ä¸ªç‚¹çš„å­å­™ï¼Œå¦å¤–ä¸¤ä¸ªç‚¹çš„ LCAã€‚ç»¼ä¸Šï¼Œ<strong>åœ¨ LCA å¤„ç»Ÿè®¡ç­”æ¡ˆæ˜¯å¯è¡Œçš„</strong>ã€‚</p>\n<p>ä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(i\\)</span> å­æ ‘ä¸­è·ç¦» <span class=\"math inline\">\\(i\\)</span> ä¸º <span class=\"math inline\">\\(j\\)</span> çš„ç‚¹æ•°ï¼›<span class=\"math inline\">\\(g_{i,j}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(i\\)</span> å­æ ‘ä¸­è·ç¦» <span class=\"math inline\">\\(i\\)</span> ä¸º <span class=\"math inline\">\\(j\\)</span>ã€æˆ–è€…è· LCA ä¸º <span class=\"math inline\">\\(d\\)</span> ä¸” LCA è·ç¦» <span class=\"math inline\">\\(i\\)</span> ä¸º <span class=\"math inline\">\\(d-j\\)</span> çš„ç‚¹å¯¹æ•°ï¼›éšä¾¿åšå°±å¯ä»¥äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g1[x].push_back(y), g1[y].push_back(x);\n    &#125;\n    auto res(0ll);\n    std::vector&lt;int&gt; h(n + 1);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1), g(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        h[x] = 1;\n        for (auto i : g1[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                h[x] = std::max(h[x], h[i] + 1);\n            &#125;\n        f[x].resize(h[x] + 1), g[x].resize(h[x] + 1);\n        f[x][0] = 1ll;\n        for (auto i : g1[x])\n            if (i != fa) &#123;\n                for (int j = 0; j &lt;= h[i]; ++j) &#123;\n                    if (j &gt;= 1)\n                        res += g[x][j] * f[i][j - 1];\n                    if (j &gt;= 1 &amp;&amp; j + 1 &lt;= h[i])\n                        res += f[x][j] * g[i][j + 1];\n                    if (j &gt;= 1) &#123;\n                        g[x][j] += f[x][j] * f[i][j - 1];\n                        f[x][j] += f[i][j - 1];\n                    &#125;\n                    if (j + 1 &lt;= h[i])\n                        g[x][j] += g[i][j + 1];\n                &#125;\n                std::vector&lt;long long&gt;().swap(f[i]);\n                std::vector&lt;long long&gt;().swap(g[i]);\n            &#125;\n        res += g[x][0];\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<p>ç„¶åå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(u\\)</span>ï¼Œç±»ä¼¼ DSU on treeï¼Œç»§æ‰¿å…¶é•¿å„¿å­çš„æ•°æ®ï¼ˆæ•´ä½“å‰ç§» / åç§»ä¸€ä½ï¼Œä½¿ç”¨æŒ‡é’ˆå®ç°ï¼‰ï¼Œå†æŠŠçŸ­å„¿å­æš´åŠ›åˆå¹¶ä¸Šæ¥ã€‚</p>\n<p>æ¯æ¬¡åˆå¹¶çŸ­å„¿å­ï¼Œæ•°ç»„é•¿ä¸ºçŸ­å„¿å­é“¾é•¿ï¼›<span class=\"math inline\">\\(u\\)</span> å‘ä¸Šåˆå¹¶æ—¶ï¼Œæ•°ç»„é•¿ä¸ºé•¿å„¿å­é“¾é•¿ã€‚æ•…æ‰€æœ‰é“¾è¢«åˆå¹¶æ°å¥½ä¸€æ¬¡ï¼Œå¤æ‚åº¦ <span class=\"math inline\">\\(O(n)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g1[x].push_back(y), g1[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; h(n + 1), son(n + 1);\n    std::vector&lt;long long&gt; df(5 * n + 1), dg(5 * n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        h[x] = 1;\n        for (auto i : g1[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                h[x] = std::max(h[x], h[i] + 1);\n                if (h[i] &gt; h[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    auto pos(dg.begin() + 3 * n);\n    std::vector&lt;decltype(df.begin())&gt; f(n + 1), g(n + 1);\n    auto res(0ll);\n    DFS = [&amp;](int x, int fa) &#123;\n        f[x][0] = 1ll;\n        if (son[x]) &#123;\n            f[son[x]] = std::next(f[x]), g[son[x]] = std::prev(g[x]);\n            DFS(son[x], x);\n        &#125;\n        for (auto i : g1[x])\n            if (i != fa &amp;&amp; i != son[x]) &#123;\n                f[i] = std::next(f[x], h[x] + 1);\n                std::fill(f[i], f[i] + h[i] + 2, 0ll);\n                g[i] = std::next(pos, h[i]), pos = std::next(g[i], h[i]);\n                std::fill(std::prev(g[i]), g[i] + h[i] + 2, 0ll);\n                DFS(i, x);\n                for (int j = 0; j &lt;= h[i]; ++j) &#123;\n                    if (j &gt;= 1)\n                        res += g[x][j] * f[i][j - 1];\n                    if (j &gt;= 1 &amp;&amp; j + 1 &lt;= h[i])\n                        res += f[x][j] * g[i][j + 1];\n                    if (j &gt;= 1) &#123;\n                        g[x][j] += f[x][j] * f[i][j - 1];\n                        f[x][j] += f[i][j - 1];\n                    &#125;\n                    if (j + 1 &lt;= h[i])\n                        g[x][j] += g[i][j + 1];\n                &#125;\n            &#125;\n        res += g[x][0];\n        return;\n    &#125;;\n    f[1] = df.begin(), g[1] = dg.begin() + 2 * n;\n    DFS(1, -1);\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"cf1585g-poachers\">CF1585G Poachers</h3>\n<p><a href=\"https://codeforces.com/problemset/problem/1585/G\" class=\"uri\">https://codeforces.com/problemset/problem/1585/G</a></p>\n<p>å…¬å¹³åšå¼ˆã€‚æˆ‘ä»¬ç°åœ¨è¦ç®—æ¯ä¸ªæ ¹çš„ SG å€¼ã€‚è®¾ <span class=\"math inline\">\\(f_{u,j}\\)</span> è¡¨ç¤ºåœ¨ç‚¹ <span class=\"math inline\">\\(u\\)</span>ï¼Œåˆ äº†è·ç¦»å®ƒä¸º <span class=\"math inline\">\\(j\\)</span> è¿™ä¸€å±‚çš„ SG å€¼ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{u,j}=\n\\begin{cases}\n\\text{mex}\\{f_{v,0}\\}&amp;j=0\\\\\n\\bigoplus f_{v,j-1}&amp;\\text{otherwise}\n\\end{cases}\n\\]</span></p>\n<p>ç„¶åå‘ç°æœ‰æ·±åº¦ç»´ã€‚å¤§åŠ›é•¿å‰–ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 0x3f3f3f3f;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n;\n        std::cin &gt;&gt; n;\n        std::vector&lt;int&gt; rt;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n        for (int i = 1, x; i &lt;= n; ++i) &#123;\n            std::cin &gt;&gt; x;\n            if (x)\n                g[x].push_back(i);\n            else\n                rt.push_back(i);\n        &#125;\n        std::vector&lt;int&gt; h(n + 1), son(n + 1), to(n + 1, inf);\n        std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n            h[x] = 1;\n            for (auto i : g[x]) &#123;\n                DFS(i);\n                h[x] = std::max(h[x], h[i] + 1);\n                to[x] = std::min(to[x], to[i] + 1);\n                if (h[i] &gt; h[son[x]])\n                    son[x] = i;\n            &#125;\n            to[x] = std::min(to[x], h[x]);\n            return;\n        &#125;;\n        for (auto i : rt)\n            DFS(i);\n        std::vector&lt;int&gt; _f(5 * n + 1), top(n + 1);\n        std::vector&lt;decltype(_f.begin())&gt; f(n + 1);\n        std::vector&lt;std::unordered_set&lt;int&gt; &gt; s(n + 1);\n        auto p(_f.begin());\n        DFS = [&amp;](int x) &#123;\n            if (son[x]) &#123;\n                f[son[x]] = std::next(f[x]);\n                top[son[x]] = top[x], DFS(son[x]);\n            &#125;\n            if ((int)g[x].size() == 1) &#123;\n                s[top[x]].insert(f[son[x]][0]);\n                for (int now = f[son[x]][0] + 1; ; ++now)\n                    if (!s[top[x]].count(now)) &#123;\n                        f[x][0] = now;\n                        break;\n                    &#125;\n                return;\n            &#125;\n            for (auto i : g[x])\n                if (i != son[x]) &#123;\n                    f[i] = p, p = std::next(p, h[i] + 1);\n                    top[i] = i, DFS(i);\n                    for (int j = 1; j &lt;= to[i] + 1; ++j)\n                        f[x][j] ^= f[i][j - 1];\n                &#125;\n            std::unordered_set&lt;int&gt;().swap(s[top[x]]);\n            for (int j = 1; j &lt;= to[x]; ++j)\n                s[top[x]].insert(f[x][j]);\n            for (int now = 0; ; ++now)\n                if (!s[top[x]].count(now)) &#123;\n                    f[x][0] = now;\n                    break;\n                &#125;\n            return;\n        &#125;;\n        int res = 0;\n        for (auto i : rt) &#123;\n            f[i] = p, p = std::next(p, h[i] + 1);\n            DFS(i), res ^= f[i][0];\n        &#125;\n        std::cout &lt;&lt; (res ? &quot;YES&quot; : &quot;NO&quot;) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n",
            "tags": [
                "æ ‘é“¾å‰–åˆ†",
                "é•¿é“¾å‰–åˆ†"
            ]
        }
    ]
}