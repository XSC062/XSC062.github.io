<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xsc062.netlify.app</id>
    <title> â€¢ Posts by &#34;é•¿é“¾å‰–åˆ†&#34; tag</title>
    <link href="https://xsc062.netlify.app" />
    <updated>2025-08-03T03:44:54.000Z</updated>
    <category term="å¹¶æŸ¥é›†" />
    <category term="æ–œç‡ä¼˜åŒ–" />
    <category term="æ‚¬çº¿æ³•" />
    <category term="å“ˆå¸Œ" />
    <category term="å­—å…¸æ ‘" />
    <category term="DP" />
    <category term="å•è°ƒé˜Ÿåˆ—" />
    <category term="åˆ†æ²»" />
    <category term="äºŒåˆ†å›¾" />
    <category term="CRT / exCRT" />
    <category term="æ’åˆ—ç»„åˆ" />
    <category term="ç½‘ç»œæµ" />
    <category term="è´¹ç”¨æµ" />
    <category term="äºŒåˆ†" />
    <category term="ä¸Šä¸‹ç•Œç½‘ç»œæµ" />
    <category term="å®¹æ–¥åŸç†" />
    <category term="çº¿æ®µæ ‘" />
    <category term="æ ‘çŠ¶æ•°ç»„" />
    <category term="åŒºé—´ DP" />
    <category term="æ„é€ " />
    <category term="æ•°æ®ç»“æ„" />
    <category term="Tarjan" />
    <category term="ä¸‹é¥­" />
    <category term="LCA" />
    <category term="å€å¢" />
    <category term="é¸½å·¢åŸç†" />
    <category term="æ¦‚ç‡æœŸæœ›" />
    <category term="è°ƒå’Œçº§æ•°" />
    <category term="å·®åˆ†" />
    <category term="æ€ç»´" />
    <category term="æ ‘å½¢ DP" />
    <category term="æœ€å°ç”Ÿæˆæ ‘" />
    <category term="SAM" />
    <category term="çŠ¶å‹" />
    <category term="åˆ†å—" />
    <category term="å¯æŒä¹…åŒ–" />
    <category term="ç¬›å¡å°”æ ‘" />
    <category term="é«˜ç»´å‰ç¼€å’Œ" />
    <category term="é—²è¯" />
    <category term="æ¬§æ‹‰å›è·¯" />
    <category term="æ ‘é“¾å‰–åˆ†" />
    <category term="é•¿é“¾å‰–åˆ†" />
    <category term="KMP" />
    <category term="border" />
    <category term="å­—ç¬¦ä¸²" />
    <category term="AC è‡ªåŠ¨æœº" />
    <category term="SA" />
    <category term="æ•°å­¦" />
    <category term="æ ‘ä¸Šå·®åˆ†" />
    <category term="FWT" />
    <category term="å †" />
    <category term="æ ‘çš„é‡å¿ƒ" />
    <category term="äºŒé¡¹å¼å®šç†" />
    <category term="äºŒé¡¹å¼åæ¼”" />
    <category term="è´ªå¿ƒ" />
    <category term="å‡æ‘Š" />
    <category term="è®¡æ•°" />
    <category term="ä¼˜åŒ–å»ºå›¾" />
    <category term="åæ‚”è´ªå¿ƒ" />
    <category term="è°ƒæ•´æ³•" />
    <category term="èƒŒåŒ…" />
    <category term="åšå¼ˆè®º" />
    <category term="DP ä¼˜åŒ–" />
    <category term="è™šæ ‘" />
    <category term="ç‚¹åˆ†æ²»" />
    <category term="WQS äºŒåˆ†" />
    <category term="é—µå¯å¤«æ–¯åŸºå’Œ" />
    <category term="slope trick" />
    <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
    <category term="çŠ¶å‹ DP" />
    <category term="ç»„åˆæ•°å­¦" />
    <category term="æ”¯é…å¯¹" />
    <category term="DDP" />
    <category term="å®¹æ–¥" />
    <category term="Kruskal é‡æ„æ ‘" />
    <category term="é«˜ç²¾åº¦" />
    <category term="æœ€çŸ­è·¯" />
    <category term="æè¶…çº¿æ®µæ ‘" />
    <entry>
        <id>https://xsc062.netlify.app/20250803/</id>
        <title>æ ‘ DP</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250803/"/>
        <content type="html">&lt;p&gt;æ ‘ä¸Šçš„ DP ä»¥åŠ å’Œæ ‘æœ‰å…³çš„ DP&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---svjetlo&#34;&gt;A - Svjetlo&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P7163&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P7163&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œå³ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,0/1/2}\)&lt;/span&gt; åˆ†åˆ«è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/2\)&lt;/span&gt; ä¸ªç«¯ç‚¹åœ¨å­æ ‘å†…éƒ¨çš„æƒ…å†µï¼›ç„¶åå°±å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ»¡è¶³å¯¹äºå¼€å…³çŠ¶æ€çš„è¦æ±‚ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯æƒ³å°‘äº†ã€‚å¦‚æœå†åŠ ä¸€ç»´ï¼Œä»ã€çŠ¶æ€ä¸ºå¼€æˆ–å…³ã€æ€è€ƒå°±ä¼šè½»æ¾å¾ˆå¤šï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,0/1/2,0/1}\)&lt;/span&gt; è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/2\)&lt;/span&gt; ä¸ªç«¯ç‚¹å†å­æ ‘å¤–éƒ¨ï¼Œä¸”å­æ ‘å†…æ“ä½œå®Œå &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ºå…³ / å¼€çš„æœ€å°‘æ­¥æ•°ã€‚ç„¶ååˆ†ç±»è®¨è®ºè½¬ç§»æ–¹å¼å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„è®¨è®ºæ–¹å¼æ˜¯ï¼Œå…ˆç¡®å®šæŸç§æƒ…å†µä¸‹ï¼Œè®¿é—® &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„æ¬¡æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°å®ƒä»¬åŸæœ¬çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, rt = -1;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t;
        a[i] = t - &amp;#39;0&amp;#39;;
        if (!a[i])
            rt = i;
    &amp;#125;
    if (rt == -1) &amp;#123;
        std::cout &amp;lt;&amp;lt; 0 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        tag[x] = a[x];
        for (auto i : g[x])
            if (i != fa)
                DFS(i, x), tag[x] &amp;amp;= tag[i];
        return;
    &amp;#125;;
    DFS(rt, -1);
    std::vector&amp;lt;std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; (3, std::vector&amp;lt;int&amp;gt; (2, 0x3f3f3f3f)));
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        f[x][0][a[x]] = 0;
        for (auto i : g[x])
            if (i != fa &amp;amp;&amp;amp; !tag[i]) &amp;#123;
                DFS(i, x);
                auto g = f[x];
                f[x][0][0] = std::min(g[0][0] + f[i][0][1] + 4, g[0][1] + f[i][0][0] + 2);
                f[x][0][1] = std::min(g[0][1] + f[i][0][1] + 4, g[0][0] + f[i][0][0] + 2);
                f[x][1][0] = std::min(&amp;#123; g[1][0] + f[i][0][1] + 4, g[1][1] + f[i][0][0] + 2, g[0][0] + f[i][1][0] + 3, g[0][1] + f[i][1][1] + 1 &amp;#125;);
                f[x][1][1] = std::min(&amp;#123; g[1][1] + f[i][0][1] + 4, g[1][0] + f[i][0][0] + 2, g[0][1] + f[i][1][0] + 3, g[0][0] + f[i][1][1] + 1 &amp;#125;);
                f[x][2][0] = std::min(&amp;#123; g[2][0] + f[i][0][1] + 4, g[2][1] + f[i][0][0] + 2, g[1][0] + f[i][1][1], g[1][1] + f[i][1][0] + 2, g[0][0] + f[i][2][1] + 4, g[0][1] + f[i][2][0] + 2 &amp;#125;);
                f[x][2][1] = std::min(&amp;#123; g[2][1] + f[i][0][1] + 4, g[2][0] + f[i][0][0] + 2, g[1][1] + f[i][1][1], g[1][0] + f[i][1][0] + 2, g[0][1] + f[i][2][1] + 4, g[0][0] + f[i][2][0] + 2 &amp;#125;);
            &amp;#125;
        f[x][1][0] = std::min(f[x][1][0], f[x][0][1] + 1);
        f[x][1][1] = std::min(f[x][1][1], f[x][0][0] + 1);
        f[x][2][0] = std::min(f[x][2][0], f[x][1][0]);
        f[x][2][1] = std::min(f[x][2][1], f[x][1][1]);
        // for (int i = 0; i &amp;lt; 3; ++i)
        //     for (int j = 0; j &amp;lt; 2; ++j)
        //         printf(&amp;quot;f[%d][%d][%d] = %d\n&amp;quot;, x, i, j, f[x][i][j]);
        return;
    &amp;#125;;
    DFS(rt, -1);
    std::cout &amp;lt;&amp;lt; f[rt][2][1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---one-to-one&#34;&gt;B - One to One&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc140/tasks/arc140_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc140/tasks/arc140_d&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è§‚å¯ŸåŸå›¾ä¸Šè¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯æ²¡æœ‰æœªç¡®å®šè¾¹çš„åŸºç¯æ ‘ï¼Œè¦ä¹ˆæ˜¯æœ‰æ°å¥½ä¸€æ¡æœªç¡®å®šè¾¹çš„æ ‘ã€‚ç¼©ç‚¹ï¼Œä»»æ„ä¸ºæœªç¡®å®šè¾¹èµ‹å€¼ï¼Œè€ƒå¯Ÿæœ€åå¾—åˆ°çš„è¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯ä»¥ã€åŸºç¯æ ‘ç‚¹ã€ä¸ºæ ¹çš„æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸åŒ…å«ã€åŸºç¯æ ‘ç‚¹ã€çš„ï¼ˆå†…å‘ï¼‰åŸºç¯æ ‘ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè¦ç”¨åˆ°è´¡çŒ®çš„æ€æƒ³ã€‚è€ƒè™‘å°†å…¨å±€åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œä¿è¯æ¯éƒ¨åˆ†çš„å•æ­¥ä»·å€¼æ˜¯å¯ç¡®å®šçš„ã€‚å°†ç¬¬ä¸€æ­¥ï¼Œå³å¯¹æ ‘å’ŒåŸºç¯æ ‘çš„è®¨è®ºæ‹†å¼€ï¼Œå¯¹äºæ ‘ï¼Œå…¶æ•°é‡ç¡®å®šï¼›å¯¹äºåŸºç¯æ ‘ï¼Œå‘ç°ç¯çš„æ•°é‡å³ä¸ºåŸºç¯æ ‘çš„æ•°é‡ï¼Œè¿›ä¸€æ­¥å°†æ‰€æœ‰æ­¥ä¸­çš„ã€ç¯ã€è¿™ä¸€ç±»åˆ†å¼€ï¼Œç»Ÿè®¡æˆç¯çš„æ–¹æ¡ˆæ•°å°±å¯ä»¥å¾—åˆ°åŸºç¯æ ‘çš„è´¡çŒ®ã€‚å…·ä½“åœ°ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; ä¸ºåœ¨å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‚¹ä¸­é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªæˆä¸€ä¸ªç¯çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{i,j}=f_{i-1,j}+f_{i-1,j-1}\times siz_i
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;æœ€åè®¡ç®—æ¯ä¸ªç¯çš„è´¡çŒ®å³å¯ã€‚æ³¨æ„è¿˜è¦ç®—ä¸Šç¯å†…éƒ¨çš„æ’åˆ—ï¼ˆæ³¨æ„å¾ªç¯ä½ç§»ï¼‰ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1), tag(n + 1), s(n + 1, 1), fa(n + 1), siz(n + 1);
    std::iota(fa.begin() + 1, fa.end(), 1);
    std::function&amp;lt;int(int)&amp;gt; find = [&amp;amp;](int x) &amp;#123;
        return x == fa[x] ? x : fa[x] = find(fa[x]);
    &amp;#125;;
    auto merge = [&amp;amp;](int x, int y) &amp;#123;
        x = find(x), y = find(y);
        if (x != y) &amp;#123;
            tag[y] += tag[x];
            s[y] += s[x];
            fa[x] = y;
        &amp;#125;
        return;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)  &amp;#123;
        std::cin &amp;gt;&amp;gt; a[i], fa[i] = i;
        if (a[i] == -1)
            tag[i] = 1;
        else
            merge(i, a[i]);
    &amp;#125;
    int cnt1 = 0, cnt2 = 0;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        cnt1 += (fa[i] == i &amp;amp;&amp;amp; !tag[i]);
        if (fa[i] == i &amp;amp;&amp;amp; tag[i])
            siz[++cnt2] = s[i];
    &amp;#125;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    auto res(cnt1 * qkp(n, cnt2) % mod);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(cnt2 + 1, std::vector&amp;lt;long long&amp;gt; (cnt2 + 1));
    f[0][0] = 1ll;
    for (int i = 1; i &amp;lt;= cnt2; ++i) &amp;#123;
        // printf(&amp;quot;i = %d, siz = %d: \n&amp;quot;, i, siz[i]);
        for (int j = 0; j &amp;lt;= i; ++j) &amp;#123;
            f[i][j] = f[i - 1][j];
            if (j != 0)
                (f[i][j] += f[i - 1][j - 1] * siz[i]) %= mod;
            // printf(&amp;quot;  f[%d][%d] = %lld\n&amp;quot;, i, j, f[i][j]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= cnt2; ++i) &amp;#123;
        static auto fac(1ll);
        (res += f[cnt2][i] * fac % mod * qkp(n, cnt2 - i) % mod) %= mod;
        (fac *= i) %= mod;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---diameter-cuts&#34;&gt;C - Diameter Cuts&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1499/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1499/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,i}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸Šçš„æœ€é•¿é“¾é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªç±»ä¼¼èƒŒåŒ…çš„è¿‡ç¨‹æ±‚ç­”æ¡ˆäº†ã€‚å‘ç°è¿™ä¸ªèƒŒåŒ…æ»¡è¶³å¯ä»¥è¢«ä¼˜åŒ–çš„å½¢å¼ï¼Œæ•…èƒ½åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(O(nk)\)&lt;/span&gt; å†…è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k, ++k;
    if (k == 0) &amp;#123;
        std::cout &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; h(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;long long&amp;gt; (k + 1));
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        f[x][1] = 1ll, h[x] = 1;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                std::vector&amp;lt;long long&amp;gt; g(k + 1);
                g.swap(f[x]);
                for (int j = std::min(h[x], k); j; --j)
                    for (int l = std::min(h[i], k - j); ~l; --l)
                        (f[x][std::max(j, l + 1)] += g[j] * f[i][l] % mod) %= mod;
                h[x] = std::max(h[x], h[i] + 1);
            &amp;#125;
        for (int i = 1; i &amp;lt;= h[x] &amp;amp;&amp;amp; i &amp;lt;= k; ++i)
            (f[x][0] += f[x][i]) %= mod;
        // for (int i = 0; i &amp;lt;= h[x] &amp;amp;&amp;amp; i &amp;lt;= k; ++i)
        //     printf(&amp;quot;f[%d][%d] = %lld\n&amp;quot;, x, i, f[x][i]);
        return;
    &amp;#125;;
    DFS(1, -1);
    auto res(0ll);
    for (int i = 1; i &amp;lt;= k; ++i)
        (res += f[1][i]) %= mod;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---leaf-partition&#34;&gt;D - Leaf Partition&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1146/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1146/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å‡è®¾å·²ç»å®Œæˆåˆ†ç»„ï¼Œæ¬²åˆ¤å®šè¿™ç§æ–¹å¼æ˜¯å¦åˆæ³•ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ¯ä¸€ç»„å¶å­å»ºç«‹è™šæ ‘ï¼Œåˆ™è¯¥åˆ†ç»„æ–¹å¼åˆæ³•ï¼Œå½“ä¸”ä»…å½“æ²¡æœ‰ä¸€ä¸ªç‚¹è¢«å¤šä¸ªè™šæ ‘å ç”¨ã€‚ä¹Ÿå³ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ€»çš„è™šæ ‘ä¸Šé€‰å‡ºä¸€äº›ç‚¹ï¼Œè®©å®ƒä»¬å¯ä»¥è¦†ç›–æ‰€æœ‰å¶å­ã€‚&lt;/p&gt;
&lt;p&gt;è™šæ ‘ä¸Š DPï¼Œå®¹æ˜“å‘ç°å½“ä¸”ä»…å½“å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\ge 2\)&lt;/span&gt; ä¸ªå„¿å­æƒ³è¦åˆ†è¿›åŒä¸€ä¸ªè™šæ ‘æ—¶ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¼šè¢«é€‰åˆ°ã€‚æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i, 0/1/2}\)&lt;/span&gt; è¡¨ç¤ºå½“å‰æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(0/1/\ge 2\)&lt;/span&gt; ä¸ªå„¿å­æƒ³è¦é€‰æ‹© &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶çš„æ–¹æ¡ˆæ•°ï¼ŒDP å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç°æ ¹æœ¬ä¸éœ€è¦æ±‚è™šæ ‘ï¼ŒåŸæ ‘ä¸Š DP å°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; fa(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 2; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; fa[i], g[fa[i]].push_back(i);
    std::vector&amp;lt;std::array&amp;lt;long long, 3&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        if (g[x].empty())
            f[x][2] = 1ll;
        else
            f[x][0] = 1ll;
        for (auto i : g[x]) &amp;#123;
            DFS(i);
            auto F0 = (f[i][0] + f[i][2]) % mod, F1 = (f[i][1] + f[i][2]) % mod;
            f[x][2] = (f[x][2] * F0 % mod + f[x][2] * F1 % mod + f[x][1] * F1 % mod) % mod;
            f[x][1] = (f[x][1] * F0 % mod + f[x][0] * F1 % mod) % mod;
            (f[x][0] *= F0) %= mod;
        &amp;#125;
        // printf(&amp;quot;%d: %lld / %lld / %lld\n&amp;quot;, x, f[x][0], f[x][1], f[x][2]);
        return;
    &amp;#125;;
    DFS(1);
    std::cout &amp;lt;&amp;lt; (f[1][0] + f[1][2]) % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---uniformly-branched-trees&#34;&gt;E - Uniformly Branched Trees&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/724/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/724/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ„Ÿè§‰æ˜¯å¾ˆå¸¸è§çš„å¥—è·¯ï¼Œä½†æ˜¯æˆ‘ä¸ä¼š ğŸ˜±&lt;/p&gt;
&lt;p&gt;åœ¨æ‰‹ç©æ ·ä¾‹çš„æ—¶å€™å¯ä»¥æ„Ÿæ€§è®¤çŸ¥åˆ°ï¼Œæ¯ä¸ªæ ‘ä¼šè¢«æ¯ç§ç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µç»Ÿè®¡ä¸€æ¬¡ã€‚ä¸”å¦‚æœå›ºå®šä»¥æŸç§ï¼ˆåŒ–å­¦ç¯å¢ƒï¼‰çš„ç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥é€šè¿‡æŒ‰ siz ä»å°åˆ°å¤§æ’åˆ—å”¯ä¸€æ±‚è§£å‡ºè¯¥æ ‘ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°ä»¥é‡å¿ƒä¸ºæ ¹ï¼ˆå³é’¦å®šæ ¹ä¸ºé‡å¿ƒï¼‰å¯ä»¥å¸¦æ¥å¾ˆå¤šä¼˜ç¾çš„æ€§è´¨ã€‚å› ä¸º siz æ˜¯å¥½ç¡®å®šçš„ï¼Œä¸”æ˜¯å„¿å­çš„æ’åºä¾æ®ï¼Œæ‰€ä»¥é€‰é‡å¿ƒä¾¿äºç»Ÿè®¡ï¼ŒåŒæ—¶æ»¡è¶³æ¯ç§æ ‘æœ€å¤šè¢«ç»Ÿè®¡ä¸¤æ¬¡ï¼ˆå½“ä¸”ä»…å½“æœ‰ä¸¤ä¸ªé‡å¿ƒï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å‘ç°è¿™å°±å˜æˆäº†å¤šé‡é›†çš„ç»„åˆæ•°ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,k}\)&lt;/span&gt; è¡¨ç¤ºå·²ç»èŠ±è´¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªç‚¹ç»„æˆä¸€ä¸ªå­æ ‘ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹å½“å‰å·²ç»ç¡®è®¤äº† &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä¸ªå„¿å­ï¼Œæœ€é å³çš„ä¸€ä¸ª siz &lt;span class=&#34;math inline&#34;&gt;\(\le k\)&lt;/span&gt; çš„æ–¹æ¡ˆæ•°ã€‚å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,k}=\sum_{x=0} f_{i-x\cdot k,j-x,k-1}\cdot \binom{f_{k,d-1,k}+x-1}{x}\)&lt;/span&gt;ï¼ˆç›¸å½“äºå°† &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªæ— æ ‡å·çš„ä½ç½® / çƒåˆ†é…ç»™ &lt;span class=&#34;math inline&#34;&gt;\(f_{k,d-1,k}\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·çš„é€‰é¡¹ / ç›’å­ï¼Œæ’æ¿å³å¯ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ç›´æ¥è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(f_{n,d,\lfloor\frac n2\rfloor}\)&lt;/span&gt;ï¼›è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ºå¶æ•°ï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸¤ä¸ªé‡å¿ƒï¼Œå³éœ€è¦ç»Ÿè®¡æ‹¥æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸”ä»¥ä¸¤ä¸ªé‡å¿ƒåˆ†åˆ«ä¸ºæ ¹æ—¶é•¿ç›¸ä¸åŒçš„æ ‘ç§ç±»ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¾ç„¶å­˜åœ¨ä¸€æ¡è¾¹ï¼Œå·¦å³ä¸¤è¾¹ siz ç›¸åŒä¸”é•¿ç›¸ä¸åŒã€‚æ•…æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\binom{f_{\lfloor \frac n2\rfloor, d-1,\lfloor \frac n2\rfloor}}{2}\)&lt;/span&gt;ï¼Œå®¹æ–¥æ‰å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦ç‰¹åˆ¤ &lt;span class=&#34;math inline&#34;&gt;\(n\le2\)&lt;/span&gt; çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, d, mod;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; d &amp;gt;&amp;gt; mod;
    if (n &amp;lt;= 2) &amp;#123;
        std::cout &amp;lt;&amp;lt; 1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        return 0;
    &amp;#125;
    using arr = std::vector&amp;lt;long long&amp;gt;;
    using brr = std::vector&amp;lt;arr&amp;gt;;
    using crr = std::vector&amp;lt;brr&amp;gt;;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    arr inv(d + 1);
    inv[0] = inv[1] = 1ll;
    auto fac = 1ll;
    for (int i = 2; i &amp;lt;= d; ++i) &amp;#123;
        (fac *= i) %= mod;
        inv[i] = qkp(fac, mod - 2);
    &amp;#125;
    auto C = [&amp;amp;](long long n, int m) &amp;#123;
        if (m == 0)
            return 1ll;
        if (m &amp;gt; n)
            return 0ll;
        auto res(1ll);
        for (auto i = 0; i &amp;lt; m; ++i)
            (res *= n - i) %= mod;
        return res * inv[m] % mod;
    &amp;#125;;
    crr f(n + 1, brr(d + 1, arr(n / 2 + 1)));
    f[1][0][0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int j = 0; j &amp;lt;= d &amp;amp;&amp;amp; 1 + j &amp;lt;= i; ++j) &amp;#123;
            for (int x = 0; x &amp;lt;= j &amp;amp;&amp;amp; x &amp;lt;= i; ++x)
                f[i][j][1] += f[i - x][j - x][0];
            f[i][j][1] %= mod;
            for (int k = 2; k &amp;lt;= n / 2; ++k) &amp;#123;
                // bool flag = (i == 10 &amp;amp;&amp;amp; j == 3 &amp;amp;&amp;amp; k == 3);
                for (int x = 0; x &amp;lt;= j &amp;amp;&amp;amp; x * k &amp;lt;= i; ++x) &amp;#123;
                    f[i][j][k] += f[i - x * k][j - x][k - 1] * C(f[k][d - 1][k - 1] + x - 1, x);
                    // if (flag)
                    //     printf(&amp;quot;x = %d, f[%d][%d][%d](%lld) * C(%lld, %d)(%lld)\n&amp;quot;, x, i - x * k, j - x, k - 1, f[i - x * k][j - x][k - 1], f[k][d - 1][k - 1] + x - 1, x, C(f[k][d - 1][k - 1] + x - 1, x));
                &amp;#125;
                f[i][j][k] %= mod;
            &amp;#125;
        &amp;#125;
    // for (int i = 1; i &amp;lt;= n; ++i)
    //     for (int j = 0; j &amp;lt;= d &amp;amp;&amp;amp; j &amp;lt;= i - 1; ++j, puts(&amp;quot;&amp;quot;))
    //         for (int k = 0; k &amp;lt;= n / 2; ++k) &amp;#123;
    //             printf(&amp;quot;f[%d][%d][%d] = %lld\n&amp;quot;, i, j, k, f[i][j][k]);
    //         &amp;#125;
    if (n &amp;amp; 1)
        std::cout &amp;lt;&amp;lt; f[n][d][n / 2] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    else &amp;#123;
        auto res(f[n][d][n / 2]);
        res = (res + mod - C(f[n / 2][d - 1][n / 2 - 1], 2)) % mod;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---dominant-indices&#34;&gt;A - Dominant Indices&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1009/F&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1009/F&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é•¿å‰–æ¿å­ï¼›éš¾ç‚¹åœ¨äºå¯èƒ½è¦å¤ä¹ ä¸€ä¸‹é•¿å‰–æ€ä¹ˆå†™ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; h(n + 1), son(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        h[x] = 1;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                h[x] = std::max(h[x], h[i] + 1);
                if (h[i] &amp;gt; h[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::vector&amp;lt;int&amp;gt; _f(2 * n + 1), res(n + 1);
    auto pos(_f.begin());
    std::vector&amp;lt;decltype(pos)&amp;gt; f(n + 1);
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        ++f[x][0];
        if (!son[x]) &amp;#123;
            res[x] = 0;
            return;
        &amp;#125;
        f[son[x]] = std::next(f[x]);
        DFS(son[x], x);
        int mx = -std::max(std::make_pair(f[x][res[son[x]] + 1], -(res[son[x]] + 1)), std::make_pair(1, 0)).second;
        for (auto i : g[x])
            if (i != fa &amp;amp;&amp;amp; i != son[x]) &amp;#123;
                f[i] = pos, pos = std::next(pos, h[i] + 1);
                DFS(i, x);
                for (int j = 0; j &amp;lt;= h[i]; ++j) &amp;#123;
                    f[x][j + 1] += f[i][j];
                    if (j + 1 != mx &amp;amp;&amp;amp; std::make_pair(f[x][j + 1], -(j + 1)) &amp;gt; std::make_pair(f[x][mx], -mx))
                        mx = j + 1;
                &amp;#125;
            &amp;#125;
        // printf(&amp;quot;%d: &amp;quot;, x);
        // for (int i = 0; i &amp;lt;= h[x]; ++i)
        //     printf(&amp;quot;%d &amp;quot;, f[x][i]);
        // puts(&amp;quot;&amp;quot;);
        res[x] = mx;
        return;
    &amp;#125;;
    f[1] = pos, pos = std::next(pos, h[1]);
    DFS(1, -1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---æ ‘ä¸Šå¼‚æˆ–&#34;&gt;B - æ ‘ä¸Šå¼‚æˆ–&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P9745&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P9745&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å’Œ &lt;a href=&#34;#a---svjetlo&#34;&gt;Svjetlo&lt;/a&gt; å¾ˆåƒï¼ŒæŠŠè¿é€šå—çš„å¼‚æˆ–å’Œæ”¾åˆ°çŠ¶æ€é‡Œï¼Œæ‹†ä½åä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j,0/1}\)&lt;/span&gt; è¡¨ç¤ºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰€åœ¨çš„è¿é€šå—åœ¨ç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; ä½å¼‚æˆ–å’Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(0/1\)&lt;/span&gt; çš„æƒå€¼ï¼ˆ&lt;strong&gt;ä¸è®¡ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ‰€åœ¨è¿é€šå—&lt;/strong&gt;ï¼‰ï¼Œè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 2, x; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x;
        g[x].push_back(i), g[i].push_back(x);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; dp(n + 1);
    std::vector&amp;lt;std::array&amp;lt;std::array&amp;lt;long long, 2&amp;gt;, 60&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        for (int i = 0; i &amp;lt; 60; ++i)
            f[x][i][(a[x] &amp;gt;&amp;gt; i) &amp;amp; 1] = 1ll;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                for (int j = 0; j &amp;lt; 60; ++j) &amp;#123;
                    auto f1 = f[x][j];
                    f[x][j][0] = (f1[0] * dp[i] % mod + f1[0] * f[i][j][0] % mod + f1[1] * f[i][j][1] % mod) % mod;
                    f[x][j][1] = (f1[1] * dp[i] % mod + f1[0] * f[i][j][1] % mod + f1[1] * f[i][j][0] % mod) % mod;
                &amp;#125;
            &amp;#125;
        for (int i = 0; i &amp;lt; 60; ++i)
            dp[x] += (1ll &amp;lt;&amp;lt; i) % mod * f[x][i][1] % mod;
        dp[x] %= mod;
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; dp[1] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---ä¸€ä¸ªç½‘çš„è·¯&#34;&gt;C - ä¸€ä¸ªç½‘çš„è·¯&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P8595&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P8595&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦æ„è¯†åˆ°ï¼Œæ ‘å’Œé“¾çš„è¾¹æ•°æ˜¯ä¸€æ ·çš„ï¼Œç‚¸æ‰äº†å¤šå°‘æ¡è¾¹ï¼Œåœ¨ä¹‹åå°±ä¼šèŠ±å¤šå°‘ä»£ä»·è¡¥å›æ¥ã€‚æ•…ç‚¸ä¸€ä¸ªç‚¹çš„ä»£ä»·ä¸ºåº¦æ•° +1ã€‚å¯¹äºä¸€ä¸ªç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œåˆ†ä¸ºå››ç§å¯èƒ½æ€§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¢«ç‚¸äº†ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿é€šå—ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œå„¿å­å…¨éƒ¨è¢«ç‚¸äº†ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œæœ‰ 1 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚&lt;/li&gt;
&lt;li&gt;æ²¡è¢«ç‚¸ï¼Œæœ‰ 2 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åˆ†åˆ«ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,0/1/2/3}\)&lt;/span&gt; ä»£è¡¨ä¸Šé¢å››ç§å¯èƒ½æ€§ï¼Œè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;è´ºäº†ä¸ª freadï¼Œæ“¦è¾¹è·‘è¿‡äº†ã€‚è¿™ä¸ªä¸æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„å—ï¼Ÿ&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
#ifdef ONLINE_JUDGE
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
#else
#define nec getchar

#endif
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
int main() &amp;#123;
    int n, m;
    read(n), read(m);
    int res = (n - 1) - m;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int x, y; m--; ) &amp;#123;
        read(x), read(y);
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tag(n + 1);
    std::vector&amp;lt;std::array&amp;lt;int, 4&amp;gt; &amp;gt; f(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        tag[x] = 1;
        f[x][0] = (fa != -1) + 1;
        f[x][2] = f[x][3] = 0x3f3f3f3f;
        for (auto i : g[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                f[x][3] = std::min(f[x][3] + f[i][0], f[x][2] + std::min(f[i][1], f[i][2]));
                f[x][2] = std::min(f[x][2] + f[i][0], f[x][1] + std::min(f[i][1], f[i][2]));
                f[x][1] += f[i][0];
                f[x][0] += std::min(&amp;#123; f[i][0] - 1, f[i][1], f[i][2], f[i][3] &amp;#125;) + 1;
            &amp;#125;
        return;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        if (!tag[i]) &amp;#123;
            DFS(i, -1);
            res += *std::min_element(f[i].begin(), f[i].end());
        &amp;#125;
    print(res, &amp;#39;\n&amp;#39;);
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---éšæœºæ ‘&#34;&gt;D - éšæœºæ ‘&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3830&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3830&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºç¬¬ä¸€é—®ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_x\)&lt;/span&gt; è¡¨ç¤ºå…±æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªå¶å­æ—¶çš„æœŸæœ›æ·±åº¦ï¼Œä¸¤ä¸ªæ–°å¶å­çš„æœŸæœ›æ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{x-1}+1\)&lt;/span&gt;ï¼Œdelta ä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{x-1}+2\)&lt;/span&gt;ï¼Œæ•…æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(f_x=\dfrac {(x-1)f_{x-1}+f_{x-1}+2}x\)&lt;/span&gt;ï¼Œé€’æ¨å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºç¬¬äºŒé—®ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{x,k}\)&lt;/span&gt; è¡¨ç¤ºæœ‰ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ä¸ªå¶å­ï¼Œæ·±åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt; çš„æ¦‚ç‡ï¼ˆä¸€ç§ç†è§£æ˜¯ä»æ•´æ•°æ¦‚ç‡å…¬å¼çš„è§’åº¦å‡ºå‘ï¼‰ã€‚åˆ™è€ƒè™‘æšä¸¾å·¦ã€å³å¶å­æ•°ï¼Œå¯¹äºå·¦ä¾§å¶å­æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æƒ…å†µï¼Œ&lt;strong&gt;ä¸ºäº†å»é‡ï¼Œåªé€‰æ‹©æ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„å¶å­å±•å¼€&lt;/strong&gt;ã€‚åªè€ƒè™‘æŸç§ç»„åˆçš„å‡ºç°æ¦‚ç‡ï¼Œä¸º &lt;span class=&#34;math inline&#34;&gt;\(f_{i,k-1}+f_{x-i,k-1}-f_{i,k-1}\cdot f_{x-i,k-1}\)&lt;/span&gt;ã€‚æ•°å½’å¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»æ„ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œæ·±åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; çš„å¶å­è¢«é€‰ä¸­çš„æ¦‚ç‡å‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\dfrac 1{x-1}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int q, n;
    std::cin &amp;gt;&amp;gt; q &amp;gt;&amp;gt; n;
    std::cout &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6);
    if (q == 1) &amp;#123;
        std::vector&amp;lt;double&amp;gt; f(n + 1);
        for (int i = 2; i &amp;lt;= n; ++i)
            f[i] = (f[i - 1] * (i - 1) + f[i - 1] + 2.) / i;
        std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    else &amp;#123;
        std::vector&amp;lt;std::vector&amp;lt;double&amp;gt; &amp;gt; f(n + 1, std::vector&amp;lt;double&amp;gt; (n + 1));
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            f[i][0] = 1.;
            for (int j = 1; j &amp;lt; i; ++j) &amp;#123;
                auto s(0.);
                for (int k = 1; k &amp;lt; i; ++k)
                    s += f[k][j - 1] + f[i - k][j - 1] - f[k][j - 1] * f[i - k][j - 1];
                f[i][j] = s / (i - 1);
            &amp;#125;
        &amp;#125;
        auto res(0.);
        for (int i = 1; i &amp;lt; n; ++i)
            res += f[n][i];
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;e---complete-compress&#34;&gt;E - Complete Compress&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/agc034/tasks/agc034_e&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/agc034/tasks/agc034_e&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¯¹äºé“¾ï¼Œå‘ç°å¯ä»¥æšä¸¾æœ€åèšé›†çš„ç‚¹ï¼Œç­”æ¡ˆä¸é…å¯¹æ–¹å¼æ— å…³ï¼Œcheck æ˜¯å¦èƒ½é…å¯¹å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸æ˜¯é“¾ï¼Œåˆ™ç›¸æ¯”é“¾ï¼Œè¿˜å¯ä»¥é€‰æ‹©åŒä¸€å­æ ‘ä¸­ä¸å­˜åœ¨ç¥–å­™å…³ç³»çš„ä¸¤ä¸ªç‚¹ï¼Œå°†å®ƒä»¬éƒ½å‘ LCA ç§»ä¸€æ­¥ã€‚&lt;/p&gt;
&lt;p&gt;æ•…è€Œï¼Œå¯ä»¥åœ¨é“¾çš„åšæ³•ä¸Šæ‰“ä¸€ä¸ªè¡¥ä¸ï¼Œè§‚å¯Ÿåˆ°å…ˆã€å†…éƒ¨æ¶ˆåŒ–ã€ï¼Œå†åœ¨å­æ ‘é—´é…å¯¹ä¸€å®šä¸åŠ£ï¼Œä¸”ç­”æ¡ˆä»ç„¶å’Œé…å¯¹æ–¹å¼æ— å…³ã€‚æ•…ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_x\)&lt;/span&gt; è¡¨ç¤ºç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; å†…æœ€å¤šæ¶ˆæ‰å¤šå°‘å¯¹ï¼Œå°±å¯ä»¥ check äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const long long inf = 1e18;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;line_02.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; t;
        a[i] = t - &amp;#39;0&amp;#39;;
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    auto res(inf);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::vector&amp;lt;int&amp;gt; s(n + 1);
        std::vector&amp;lt;long long&amp;gt; f(n + 1), cnt(n + 1);
        std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
            s[x] = a[x];
            int son = 0;
            auto sum(0ll);
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    DFS(i, x), s[x] += s[i];
                    sum += cnt[i];
                    if (cnt[i] &amp;gt; cnt[son])
                        son = i;
                &amp;#125;
            if (son) &amp;#123;
                if (cnt[son] * 2 &amp;lt;= sum)
                    f[x] = sum / 2;
                else
                    f[x] = sum - cnt[son] + std::min(f[son], (cnt[son] - (sum - cnt[son])) / 2);
            &amp;#125;
            cnt[x] = sum;
            if (x != i)
                cnt[x] += s[x];
            return;
        &amp;#125;;
        DFS(i, -1);
        if (cnt[i] % 2 == 0 &amp;amp;&amp;amp; f[i] == cnt[i] / 2)
            res = std::min(res, cnt[i] / 2);
    &amp;#125;
    if (res == inf)
        std::cout &amp;lt;&amp;lt; -1 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    else
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
</content>
        <category term="DP" />
        <category term="æ ‘å½¢ DP" />
        <category term="é•¿é“¾å‰–åˆ†" />
        <updated>2025-08-03T03:44:54.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20241021-1/</id>
        <title>é•¿é“¾å‰–åˆ† å­¦ä¹ ç¬”è®°</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20241021-1/"/>
        <content type="html">&lt;p&gt;&lt;em&gt;åŠç«¯ãªç”Ÿå‘½ã®é–¢æ•°ã‚’ / å°‘ã€…ã“ã“ã‚‰ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰&lt;/em&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å†…å®¹-æ€§è´¨&#34;&gt;å†…å®¹ &amp;amp; æ€§è´¨&lt;/h2&gt;
&lt;p&gt;æŠŠé‡é“¾å‰–åˆ†é€‰çš„ siz æœ€å¤§çš„å„¿å­æ¢æˆé«˜åº¦æœ€å¤§çš„å„¿å­å°±æ˜¯é•¿å‰–äº†ã€‚åŒæ ·å…·æœ‰ä¸€äº›ç¾å¦™çš„æ€§è´¨ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;ä»»æ„ç‚¹åˆ°æ ¹èŠ‚ç‚¹ç»è¿‡çš„é“¾æ•°æœ€åŠ£ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\sqrt n\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘æ„é€ ä¸€æ¡ç»è¿‡äº† &lt;span class=&#34;math inline&#34;&gt;\(\sqrt n+1\)&lt;/span&gt; æ¡é“¾çš„è·¯å¾„ï¼Œå‘ç°æ„é€ ä¸å‡ºæ¥ã€‚å¾—è¯ã€‚ï¼ˆï¼Ÿï¼‰&lt;/p&gt;
è¿™ç‚¹ä¹Ÿå†³å®šäº†é•¿å‰–å’Œé‡å‰–èµ°çš„ä¸æ˜¯ä¸€æ¡èµ›é“ï¼Œæ›´å¤šçš„æ˜¯å¤„ç†ä¸€äº›å’Œæ·±åº¦æœ‰å…³çš„åœºæ™¯ä¸‹çš„é—®é¢˜ã€‚ç”¨æ³•æœ‰ç‚¹åƒ dsu on treeã€‚&lt;/li&gt;
&lt;li&gt;&lt;p&gt;ä»»æ„ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çº§ç¥–å…ˆ &lt;span class=&#34;math inline&#34;&gt;\(fa\)&lt;/span&gt; æ‰€åœ¨é“¾é•¿ &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åè¯ã€‚è‹¥ &lt;span class=&#34;math inline&#34;&gt;\(fa\)&lt;/span&gt; æ‰€åœ¨é“¾é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(&amp;lt;k\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(fa\to x\)&lt;/span&gt; æ›´ä¼˜ï¼ŒçŸ›ç›¾ã€‚æ•…åŸå‘½é¢˜æˆç«‹ã€‚&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;æ±‚-k-çº§ç¥–å…ˆ&#34;&gt;æ±‚ k çº§ç¥–å…ˆ&lt;/h2&gt;
&lt;p&gt;é•¿å‰–çš„ä¸€ä¸ªå…¸å‹åº”ç”¨æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)-O(1)\)&lt;/span&gt; æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çº§ç¥–å…ˆã€‚å…ˆè€ƒè™‘ç›¸å¯¹æš´åŠ›çš„åšæ³•ï¼Œå¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(n\sqrt n)\)&lt;/span&gt; é¢„å¤„ç†æ¯ä¸ªç‚¹çš„ &lt;span class=&#34;math inline&#34;&gt;\(1\sim \sqrt n\)&lt;/span&gt; çº§ç¥–å…ˆç„¶åå—é—´å—å†…éšä¾¿è·³ä¸€è·³å°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(\sqrt n)\)&lt;/span&gt; çš„å•æ¬¡æŸ¥è¯¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;æŠŠè¿™ä¸ªæš´åŠ›ç»“åˆã€Œä»»æ„ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; çº§ç¥–å…ˆæ‰€åœ¨é“¾é•¿ &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt;ã€çš„æ€§è´¨ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(r=\dfrac k2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; çš„ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çº§ç¥–å…ˆæ‰€åœ¨é“¾é•¿ &lt;span class=&#34;math inline&#34;&gt;\(\ge r\)&lt;/span&gt;ã€‚å‡è®¾æˆ‘ä»¬ç°åœ¨å·²ç»çŸ¥é“ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çº§ç¥–å…ˆ &lt;span class=&#34;math inline&#34;&gt;\(fa_r\)&lt;/span&gt;ï¼Œé¢„å¤„ç†å‡ºé“¾å†…ç‚¹åºåˆ—ã€é“¾é¡¶å‘ä¸Šçš„é“¾é•¿ä¸ªç¥–å…ˆï¼ˆå‡æ‘Š &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ï¼‰ï¼Œå°±å¯ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt; è®¿é—® &lt;span class=&#34;math inline&#34;&gt;\(fa_k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€ä¹ˆæ‰¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(fa_r\)&lt;/span&gt; å‘¢ï¼Ÿè¿™çœ‹ä¼¼æ˜¯é€’å½’çš„é—®é¢˜ï¼Œå®é™…ä¸Šå‘ç° &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„å–å€¼åªéœ€ &lt;span class=&#34;math inline&#34;&gt;\(\ge \dfrac k2\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; çš„æ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œæ‰¾åˆ°å…¶æœ€é«˜äºŒè¿›åˆ¶ä½ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt;ï¼ˆæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çš„å¯èƒ½å–å€¼æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\log n\)&lt;/span&gt; ç§ï¼‰ï¼Œå¯¹äºæ¯ä¸ªç‚¹ï¼Œé¢„å¤„ç†å‡ºå…¶ &lt;span class=&#34;math inline&#34;&gt;\(\log n\)&lt;/span&gt; ä¸ªä¸åŒçš„ &lt;span class=&#34;math inline&#34;&gt;\(r\)&lt;/span&gt; çº§ç¥–å…ˆã€‚è¿™ä¸ªå°±æ˜¯å€å¢äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;for (int i = 1, mx = 0; i &amp;lt;= n; ++i) &amp;#123;
    if (i &amp;gt;= (1 &amp;lt;&amp;lt; mx) * 2)
        ++mx;
    to[i] = mx;
&amp;#125;
std::vector&amp;lt;std::array&amp;lt;int, 21&amp;gt; &amp;gt; fa(n + 1);
std::vector&amp;lt;int&amp;gt; h(n + 1, 1), son(n + 1), dep(n + 1);
h[0] = 0;
std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
    for (auto i : g[x])
        if (i != fa[x][0]) &amp;#123;
            fa[i][0] = x;
            for (int j = 1; j &amp;lt;= 20; ++j)
                fa[i][j] = fa[fa[i][j - 1]][j - 1];
            dep[i] = dep[x] + 1;
            DFS(i);
            if (h[i] &amp;gt;= h[son[x]])
                son[x] = i, h[x] = h[i] + 1;
        &amp;#125;
    return;
&amp;#125;;
dep[1] = 1, DFS(1);
std::vector&amp;lt;int&amp;gt; top(n + 1), id(n + 1);
std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; anc(n + 1), des(n + 1, std::vector&amp;lt;int&amp;gt; (1));
std::function&amp;lt;void(int, int)&amp;gt; DFS1 = [&amp;amp;](int x, int toq) &amp;#123;
    top[x] = toq;
    if (son[x])
        DFS1(son[x], toq);
    for (auto i : g[x])
        if (i != fa[x][0] &amp;amp;&amp;amp; i != son[x])
            DFS1(i, i);
    des[toq].push_back(x);
    id[x] = (int)des[toq].size() - 1;
    if (x == toq) &amp;#123;
        anc[x].push_back(x);
        for (int j = 1, now = x; j &amp;lt;= id[x]; ++j, now = fa[now][0])
            anc[x].push_back(fa[now][0]);
    &amp;#125;
    return;
&amp;#125;;
DFS1(1, 1);
auto ask = [&amp;amp;](int x, int k) &amp;#123;
    int x1 = x;
    if (!k)
        return x;
    x = fa[x][to[k]];
    if (dep[x] - dep[top[x]] &amp;gt;= k - (1 &amp;lt;&amp;lt; to[k]))
        return des[top[x]][id[x] + k - (1 &amp;lt;&amp;lt; to[k])];
    return anc[top[x]][k - (1 &amp;lt;&amp;lt; to[k]) - (dep[x] - dep[top[x]])];
&amp;#125;;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ä¼˜åŒ–-dp&#34;&gt;ä¼˜åŒ– DP&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ylyï¼šç®¡å®ƒè¿™é‚£çš„ï¼Œåªè¦æ˜¯æœ‰å…³æ·±åº¦ç›´æ¥ä¸Šé•¿å‰–å°±æ˜¯äº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å’Œ DSU on tree ç±»ä¼¼ï¼Œä¸»è¦åˆ©ç”¨æ¯æ¡é“¾åªä¼šè¢«ç®—ä¸€æ¬¡å®ç° &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; DPã€‚å…·ä½“åœ°ï¼Œå°½å¯èƒ½åœ°ã€ç»§æ‰¿ã€é•¿é“¾çš„ä¿¡æ¯ï¼Œã€çŸ­é“¾ã€åˆ™æš´åŠ›åˆå¹¶ã€‚&lt;/p&gt;
&lt;p&gt;å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸€èˆ¬ã€æ·±åº¦ã€è¿™ä¸€ç»´ä¿¡æ¯ä¼šä»¥ã€ä¸ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„è·ç¦»ã€çš„å½¢å¼ï¼Œç»“åˆæŒ‡é’ˆæ¥ç»´æŠ¤ï¼ˆå› ä¸ºç›´æ¥è®°å½•æ·±åº¦ä¼šæ›´å²ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å…·ä½“åœ°ï¼Œç”¨ä¸€ä¸ªå…¨å±€å¤§æ•°ç»„å®¹çº³æ‰€æœ‰ä¿¡æ¯ï¼Œä¸ºæ¯ä¸ªç‚¹åˆ†é…ç›¸åº”çš„æ•°ç»„å¤´æŒ‡é’ˆã€‚æ­£å¸¸æƒ…å†µä¸‹éœ€è¦ç”¨åˆ°çš„å…ƒç´ æœ€å¤šä¸º &lt;span class=&#34;math inline&#34;&gt;\(2n\)&lt;/span&gt;ï¼Œä½†å¦‚æœå­˜åœ¨ä¸€äº›è¯¡å¼‚çš„å‰ç§»åç§»æ“ä½œå°±å¦å½“åˆ«è®ºäº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;p5904-poi-2014-hot-hotels-åŠ å¼ºç‰ˆ&#34;&gt;P5904 [POI 2014] HOT-Hotels åŠ å¼ºç‰ˆ&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5904&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5904&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆ &lt;del&gt;ä¸éš¾&lt;/del&gt; å¾—åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt; åšæ³•ï¼šæ˜¾ç„¶å­˜åœ¨ä¸€ä¸ªç‚¹åˆ°ä¸‰ä¸ªç‚¹è·ç¦»ç›¸ç­‰ã€‚è¿™ä¸ªç‚¹æ—¢å¯èƒ½æ˜¯å®ƒä»¬çš„ LCAï¼Œä¹Ÿå¯èƒ½æ˜¯å…¶ä¸­ä¸€ä¸ªç‚¹çš„å­å­™ï¼Œå¦å¤–ä¸¤ä¸ªç‚¹çš„ LCAã€‚ç»¼ä¸Šï¼Œ&lt;strong&gt;åœ¨ LCA å¤„ç»Ÿè®¡ç­”æ¡ˆæ˜¯å¯è¡Œçš„&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{i,j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å­æ ‘ä¸­è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; çš„ç‚¹æ•°ï¼›&lt;span class=&#34;math inline&#34;&gt;\(g_{i,j}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å­æ ‘ä¸­è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ã€æˆ–è€…è· LCA ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d\)&lt;/span&gt; ä¸” LCA è·ç¦» &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸º &lt;span class=&#34;math inline&#34;&gt;\(d-j\)&lt;/span&gt; çš„ç‚¹å¯¹æ•°ï¼›éšä¾¿åšå°±å¯ä»¥äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g1[x].push_back(y), g1[y].push_back(x);
    &amp;#125;
    auto res(0ll);
    std::vector&amp;lt;int&amp;gt; h(n + 1);
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; f(n + 1), g(n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        h[x] = 1;
        for (auto i : g1[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                h[x] = std::max(h[x], h[i] + 1);
            &amp;#125;
        f[x].resize(h[x] + 1), g[x].resize(h[x] + 1);
        f[x][0] = 1ll;
        for (auto i : g1[x])
            if (i != fa) &amp;#123;
                for (int j = 0; j &amp;lt;= h[i]; ++j) &amp;#123;
                    if (j &amp;gt;= 1)
                        res += g[x][j] * f[i][j - 1];
                    if (j &amp;gt;= 1 &amp;amp;&amp;amp; j + 1 &amp;lt;= h[i])
                        res += f[x][j] * g[i][j + 1];
                    if (j &amp;gt;= 1) &amp;#123;
                        g[x][j] += f[x][j] * f[i][j - 1];
                        f[x][j] += f[i][j - 1];
                    &amp;#125;
                    if (j + 1 &amp;lt;= h[i])
                        g[x][j] += g[i][j + 1];
                &amp;#125;
                std::vector&amp;lt;long long&amp;gt;().swap(f[i]);
                std::vector&amp;lt;long long&amp;gt;().swap(g[i]);
            &amp;#125;
        res += g[x][0];
        return;
    &amp;#125;;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;ç„¶åå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œç±»ä¼¼ DSU on treeï¼Œç»§æ‰¿å…¶é•¿å„¿å­çš„æ•°æ®ï¼ˆæ•´ä½“å‰ç§» / åç§»ä¸€ä½ï¼Œä½¿ç”¨æŒ‡é’ˆå®ç°ï¼‰ï¼Œå†æŠŠçŸ­å„¿å­æš´åŠ›åˆå¹¶ä¸Šæ¥ã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡åˆå¹¶çŸ­å„¿å­ï¼Œæ•°ç»„é•¿ä¸ºçŸ­å„¿å­é“¾é•¿ï¼›&lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å‘ä¸Šåˆå¹¶æ—¶ï¼Œæ•°ç»„é•¿ä¸ºé•¿å„¿å­é“¾é•¿ã€‚æ•…æ‰€æœ‰é“¾è¢«åˆå¹¶æ°å¥½ä¸€æ¬¡ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g1[x].push_back(y), g1[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; h(n + 1), son(n + 1);
    std::vector&amp;lt;long long&amp;gt; df(5 * n + 1), dg(5 * n + 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
        h[x] = 1;
        for (auto i : g1[x])
            if (i != fa) &amp;#123;
                DFS(i, x);
                h[x] = std::max(h[x], h[i] + 1);
                if (h[i] &amp;gt; h[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1, -1);
    auto pos(dg.begin() + 3 * n);
    std::vector&amp;lt;decltype(df.begin())&amp;gt; f(n + 1), g(n + 1);
    auto res(0ll);
    DFS = [&amp;amp;](int x, int fa) &amp;#123;
        f[x][0] = 1ll;
        if (son[x]) &amp;#123;
            f[son[x]] = std::next(f[x]), g[son[x]] = std::prev(g[x]);
            DFS(son[x], x);
        &amp;#125;
        for (auto i : g1[x])
            if (i != fa &amp;amp;&amp;amp; i != son[x]) &amp;#123;
                f[i] = std::next(f[x], h[x] + 1);
                std::fill(f[i], f[i] + h[i] + 2, 0ll);
                g[i] = std::next(pos, h[i]), pos = std::next(g[i], h[i]);
                std::fill(std::prev(g[i]), g[i] + h[i] + 2, 0ll);
                DFS(i, x);
                for (int j = 0; j &amp;lt;= h[i]; ++j) &amp;#123;
                    if (j &amp;gt;= 1)
                        res += g[x][j] * f[i][j - 1];
                    if (j &amp;gt;= 1 &amp;amp;&amp;amp; j + 1 &amp;lt;= h[i])
                        res += f[x][j] * g[i][j + 1];
                    if (j &amp;gt;= 1) &amp;#123;
                        g[x][j] += f[x][j] * f[i][j - 1];
                        f[x][j] += f[i][j - 1];
                    &amp;#125;
                    if (j + 1 &amp;lt;= h[i])
                        g[x][j] += g[i][j + 1];
                &amp;#125;
            &amp;#125;
        res += g[x][0];
        return;
    &amp;#125;;
    f[1] = df.begin(), g[1] = dg.begin() + 2 * n;
    DFS(1, -1);
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;cf1585g-poachers&#34;&gt;CF1585G Poachers&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1585/G&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1585/G&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…¬å¹³åšå¼ˆã€‚æˆ‘ä»¬ç°åœ¨è¦ç®—æ¯ä¸ªæ ¹çš„ SG å€¼ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(f_{u,j}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œåˆ äº†è·ç¦»å®ƒä¸º &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt; è¿™ä¸€å±‚çš„ SG å€¼ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{u,j}=
\begin{cases}
\text{mex}\{f_{v,0}\}&amp;amp;j=0\\
\bigoplus f_{v,j-1}&amp;amp;\text{otherwise}
\end{cases}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå‘ç°æœ‰æ·±åº¦ç»´ã€‚å¤§åŠ›é•¿å‰–ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int inf = 0x3f3f3f3f;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n;
        std::cin &amp;gt;&amp;gt; n;
        std::vector&amp;lt;int&amp;gt; rt;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
        for (int i = 1, x; i &amp;lt;= n; ++i) &amp;#123;
            std::cin &amp;gt;&amp;gt; x;
            if (x)
                g[x].push_back(i);
            else
                rt.push_back(i);
        &amp;#125;
        std::vector&amp;lt;int&amp;gt; h(n + 1), son(n + 1), to(n + 1, inf);
        std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
            h[x] = 1;
            for (auto i : g[x]) &amp;#123;
                DFS(i);
                h[x] = std::max(h[x], h[i] + 1);
                to[x] = std::min(to[x], to[i] + 1);
                if (h[i] &amp;gt; h[son[x]])
                    son[x] = i;
            &amp;#125;
            to[x] = std::min(to[x], h[x]);
            return;
        &amp;#125;;
        for (auto i : rt)
            DFS(i);
        std::vector&amp;lt;int&amp;gt; _f(5 * n + 1), top(n + 1);
        std::vector&amp;lt;decltype(_f.begin())&amp;gt; f(n + 1);
        std::vector&amp;lt;std::unordered_set&amp;lt;int&amp;gt; &amp;gt; s(n + 1);
        auto p(_f.begin());
        DFS = [&amp;amp;](int x) &amp;#123;
            if (son[x]) &amp;#123;
                f[son[x]] = std::next(f[x]);
                top[son[x]] = top[x], DFS(son[x]);
            &amp;#125;
            if ((int)g[x].size() == 1) &amp;#123;
                s[top[x]].insert(f[son[x]][0]);
                for (int now = f[son[x]][0] + 1; ; ++now)
                    if (!s[top[x]].count(now)) &amp;#123;
                        f[x][0] = now;
                        break;
                    &amp;#125;
                return;
            &amp;#125;
            for (auto i : g[x])
                if (i != son[x]) &amp;#123;
                    f[i] = p, p = std::next(p, h[i] + 1);
                    top[i] = i, DFS(i);
                    for (int j = 1; j &amp;lt;= to[i] + 1; ++j)
                        f[x][j] ^= f[i][j - 1];
                &amp;#125;
            std::unordered_set&amp;lt;int&amp;gt;().swap(s[top[x]]);
            for (int j = 1; j &amp;lt;= to[x]; ++j)
                s[top[x]].insert(f[x][j]);
            for (int now = 0; ; ++now)
                if (!s[top[x]].count(now)) &amp;#123;
                    f[x][0] = now;
                    break;
                &amp;#125;
            return;
        &amp;#125;;
        int res = 0;
        for (auto i : rt) &amp;#123;
            f[i] = p, p = std::next(p, h[i] + 1);
            DFS(i), res ^= f[i][0];
        &amp;#125;
        std::cout &amp;lt;&amp;lt; (res ? &amp;quot;YES&amp;quot; : &amp;quot;NO&amp;quot;) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
</content>
        <category term="æ ‘é“¾å‰–åˆ†" />
        <category term="é•¿é“¾å‰–åˆ†" />
        <updated>2024-10-21T08:33:47.000Z</updated>
    </entry>
</feed>
