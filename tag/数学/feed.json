{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"æ•°å­¦\" tag",
    "description": "",
    "home_page_url": "https://xsc062.netlify.app",
    "items": [
        {
            "id": "https://xsc062.netlify.app/20250419/",
            "url": "https://xsc062.netlify.app/20250419/",
            "title": "æ‚é¢˜é€‰è°ˆï¼šç½‘æ ¼å›¾è·¯å¾„è®¡æ•°",
            "date_published": "2025-04-19T02:03:57.000Z",
            "content_html": "<figure>\n<img src=\"/20250419/neko.jpeg\" alt=\"çŒ«\" style=\"width: 75px\">\n<figcaption>\nçŒ«\n</figcaption>\n</figure>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"ç‚¹åˆ°ç‚¹çš„æ–¹æ¡ˆæ•°\">ç‚¹åˆ°ç‚¹çš„æ–¹æ¡ˆæ•°</h2>\n<p>ä» <span class=\"math inline\">\\((x_1,y_1)\\)</span> åªèƒ½å‘å³ã€å‘ä¸‹èµ°åˆ° <span class=\"math inline\">\\((x_2,y_2)\\)</span> çš„æ–¹æ¡ˆæ•°ï¼š<span class=\"math inline\">\\(C_{x_2-x_1+y_2-y_1}^{x_2-x_1}\\)</span>ã€‚å°±æ˜¯è¯´ï¼Œå› ä¸ºå¿…é¡»å‘ä¸‹èµ° <span class=\"math inline\">\\(x_2-x_1\\)</span> æ­¥ï¼Œåˆå¿…é¡»å‘å³èµ° <span class=\"math inline\">\\(y_2-y_1\\)</span> æ­¥ï¼›ä½†é¡ºåºæ˜¯å¯ä»¥ä»»æ„æ‰“ä¹±çš„ã€‚</p>\n<hr />\n<h3 id=\"a---gerald-and-giant-chess\">A - Gerald and Giant Chess</h3>\n<p><a href=\"https://codeforces.com/problemset/problem/560/E\" class=\"uri\">https://codeforces.com/problemset/problem/560/E</a></p>\n<p>æŠŠä¸èƒ½èµ°çš„ç‚¹æŒ‰ <span class=\"math inline\">\\(x\\)</span> ä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œ<span class=\"math inline\">\\(y\\)</span> ä¸ºç¬¬äºŒå…³é”®å­—æ’åºï¼Œå°±å¯ä»¥å¾—åˆ°å®ƒä»¬æŒ‰å¤§è‡´æ‹“æ‰‘åºæ’åˆ—çš„ç»“æœã€‚</p>\n<p>ä»¤ <span class=\"math inline\">\\(f_i\\)</span> è¡¨ç¤ºä¸ç»è¿‡ <span class=\"math inline\">\\(1\\sim i-1\\)</span> çš„éæ³•ç‚¹èµ°åˆ°ç¬¬ <span class=\"math inline\">\\(i\\)</span> ä¸ªéæ³•ç‚¹çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥å¾—åˆ° <span class=\"math inline\">\\(f_i=C_{x_i+y_i,x_i}-\\sum_{j=1}^{i-1} f_j\\times C_{x_i-x_j+y_i-y_j}^{x_i-x_j}\\)</span>ã€‚å¯ä»¥å‘ç°åé¢å‡å»çš„æ–¹æ¡ˆï¼Œå› ä¸ºç¢°åˆ°çš„ç¬¬ä¸€ä¸ªéæ³•ç‚¹ä¸åŒï¼Œæ‰€ä»¥æ˜¯ä¸¤ä¸¤ä¸åŒçš„ã€‚</p>\n<p>è®© <span class=\"math inline\">\\((h,w)\\)</span> æˆä¸ºç¬¬ <span class=\"math inline\">\\((n+1)\\)</span> ä¸ªéæ³•ç‚¹ï¼Œ<span class=\"math inline\">\\(f_{n+1}\\)</span> å°±æ˜¯ç­”æ¡ˆã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int h, w, n;\n    std::cin &gt;&gt; h &gt;&gt; w &gt;&gt; n, --h, --w;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; a(n + 2);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i].first &gt;&gt; a[i].second;\n        --a[i].first, --a[i].second;\n    &#125;\n    a[n + 1] = &#123; h, w &#125;;\n    std::sort(a.begin() + 1, a.end());\n    std::vector&lt;long long&gt; fac(h + w + 1), inv(h + w + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= h + w; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [](long long x, int y) &#123;\n        auto res = 1ll;\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[h + w] = qkp(fac[h + w], mod - 2);\n    for (int i = h + w - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        return fac[n] * inv[n - m] % mod * inv[m] % mod;\n    &#125;;\n    std::vector&lt;long long&gt; f(n + 2);\n    for (int i = 1; i &lt;= n + 1; ++i) &#123;\n        f[i] = C(a[i].first + a[i].second, a[i].first);\n        for (int j = 1; j &lt; i; ++j)\n            if (a[j].second &lt;= a[i].second)\n                (f[i] += mod - f[j] * C(a[i].first - a[j].first + a[i].second - a[j].second, a[i].first - a[j].first) % mod) %= mod;\n        // printf(&quot;f[(%d, %d)] = %lld\\n&quot;, a[i].first, a[i].second, f[i]);\n    &#125;\n    std::cout &lt;&lt; f[n + 1] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"b---bbq-hard\">B - BBQ Hard</h3>\n<p><a href=\"https://atcoder.jp/contests/agc001/tasks/agc001_e\" class=\"uri\">https://atcoder.jp/contests/agc001/tasks/agc001_e</a></p>\n<p>ä¸ä»…ä»…å¯ä»¥åœ¨å…³é”®ç‚¹ä¸Š DPï¼Œä¹Ÿå¯ä»¥åœ¨ç½‘æ ¼ä¸Šç›´æ¥ DPã€‚</p>\n<p><span class=\"math inline\">\\(A_i+B_i+A_j+B_j\\)</span> å°±æ˜¯ <span class=\"math inline\">\\(A_i+B_i-(-A_j)-(-B_j)\\)</span>ã€‚æŠŠæ£‹ç›˜æ‰©å¤§åˆ° <span class=\"math inline\">\\(-2000\\to 2000\\)</span> å°±å¯ä»¥äº†ã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºå¯ä»¥åˆ°è¾¾ <span class=\"math inline\">\\((i,j)\\)</span> çš„æ‰€æœ‰å‘å‡ºå…³é”®ç‚¹ <span class=\"math inline\">\\((-A_j,-B_j)\\)</span> å¸¦æ¥çš„è´¡çŒ®ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(f_{i,j}=f_{i-1,j}+f_{i,j-1}\\)</span>ã€‚æšä¸¾æ‰€æœ‰æ¥æ”¶å…³é”®ç‚¹ <span class=\"math inline\">\\((A_i,B_i)\\)</span>ï¼Œ<span class=\"math inline\">\\(\\sum f_{A_i,B_i}\\)</span> å°±æ˜¯ç­”æ¡ˆçš„ä¸¤å€ï¼Œå†å‡å»å¯¹è§’çº¿ï¼Œä¹Ÿå°±æ˜¯ <span class=\"math inline\">\\(\\sum (-A_i,B_i)\\to (A_i,B_i)\\)</span> åçš„å€¼ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int N = 2000;\nconst int mod = 1e9 + 7;\nconst int inv2 = 500000004;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;long long&gt; fac(4 * N + 1), inv(4 * N + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= 4 * N; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[4 * N] = qkp(fac[4 * N], mod - 2);\n    for (int i = 4 * N - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; a(n + 1);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(2 * N + 1, std::vector&lt;long long&gt; (2 * N + 1));\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i].first &gt;&gt; a[i].second;\n        ++f[N - a[i].first][N - a[i].second];\n    &#125;\n    for (int i = 0; i &lt;= 2 * N; ++i)\n        for (int j = 0; j &lt;= 2 * N; ++j) &#123;\n            if (i &gt;= 1)\n                (f[i][j] += f[i - 1][j]) %= mod;\n            if (j &gt;= 1)\n                (f[i][j] += f[i][j - 1]) %= mod;\n            // printf(&quot;f(%2d, %2d) = %lld\\n&quot;, i - N, j - N, f[i][j]);\n        &#125;\n    long long res = 0ll;\n    auto C = [&amp;](int n, int m) &#123;\n        return fac[n] * inv[n - m] % mod * inv[m] % mod;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        (res += f[a[i].first + N][a[i].second + N]) %= mod;\n        (res += mod - C(a[i].first * 2 + a[i].second * 2, 2 * a[i].first)) %= mod;\n    &#125;\n    std::cout &lt;&lt; res * inv2 % mod &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"c---iroha-and-a-grid\">C - Iroha and a Grid</h3>\n<p><a href=\"https://atcoder.jp/contests/arc058/tasks/arc058_b\" class=\"uri\">https://atcoder.jp/contests/arc058/tasks/arc058_b</a></p>\n<p>å…ˆæŠŠç»¿è‰²éƒ¨åˆ†çš„ç­”æ¡ˆè®¡ç®—å‡ºæ¥ï¼š</p>\n<figure>\n<img src=\"1.png\" alt=\"ç½‘æ ¼\" /><figcaption>ç½‘æ ¼</figcaption>\n</figure>\n<p>å¦‚æœæŠŠç»¿è‰²çš„æ¯ä¸€ä¸ªæ ¼å­åˆ°ç»ˆç‚¹çš„æ–¹æ¡ˆæ•°æ±‚å’Œï¼Œå°±ä¼šç®—é‡ï¼Œå› ä¸ºä¸Šé¢çš„ç»¿è‰²ç‚¹å¯ä»¥èµ°åˆ°ä¸‹é¢çš„ç»¿è‰²ç‚¹ã€‚</p>\n<p>è®©ç»¿è‰²ç‚¹ç¬¬ä¸€æ­¥åªèƒ½å¾€å³èµ°åˆ°é»„è‰²ç‚¹ï¼Œç”¨è¿™æ ·çš„æ–¹æ¡ˆä¸ºé»„è‰²ç‚¹èµ‹åˆå€¼ï¼Œå†è®©é»„è‰²ç‚¹è‡ªç”±èµ°å°±å¯ä»¥å¾—åˆ°ç­”æ¡ˆäº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int h, w, a, b;\n    std::cin &gt;&gt; h &gt;&gt; w &gt;&gt; a &gt;&gt; b;\n    std::vector&lt;long long&gt; fac(h + w + 1), inv(h + w + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= h + w; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[h + w] = qkp(fac[h + w], mod - 2);\n    for (int i = h + w - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        return fac[n] * inv[n - m] % mod * inv[m] % mod;\n    &#125;;\n    auto res = 0ll;\n    for (int i = 1; i &lt;= h - a; ++i) &#123;\n        // (i, B)\n        auto f(C(i + b - 2, i - 1));\n        // printf(&quot;(%d, %d): %lld\\n&quot;, i, b, f);\n        // (i, B + 1)\n        (res += f * C(h - i + w - (b + 1), h - i) % mod) %= mod;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"ç‚¹åˆ°çŸ©å½¢çš„æ–¹æ¡ˆæ•°\">ç‚¹åˆ°çŸ©å½¢çš„æ–¹æ¡ˆæ•°</h2>\n<p>ä» <span class=\"math inline\">\\((x_0,y_0)\\)</span> èµ°åˆ°çŸ©å½¢ <span class=\"math inline\">\\((x_1,y_1,x_2,y_2)\\)</span> çš„æ–¹æ¡ˆæ•°ï¼š</p>\n<p><span class=\"math display\">\\[\n\\sum\\limits_{i\\in [x_1,x_2],j\\in [y_1,y_2]} G(x_0,y_0, i, j) = G(x_0,y_0,x_2 + 1,y_2 + 1)-G(x_0,y_0,x_2+1,y_1)-G(x_0,y_0,x_1,y_2+1)+G(x_0,y_0,x_1,y_1)\n\\]</span></p>\n<p>è¯æ˜ï¼š<span class=\"math inline\">\\(G(x_0,y_0,x_2+1,y_2+1)=\\sum\\limits_i G(x_0,y_0,i,y_2)=\\sum\\limits_{i,j} G(x_0,y_0,i,j)\\)</span>ï¼Œç±»ä¼¼çš„ï¼ŒæŠŠåé¢å‡ é¡¹å±•å¼€ï¼Œå¯ä»¥å¾—åˆ°å‰ç¼€å’Œçš„ç»“æ„ã€‚</p>\n<p>ç°åœ¨ï¼ŒçŸ©å½¢å°±å¯ä»¥è¢«æ¦‚æ‹¬æˆ 4 ä¸ªç‚¹äº†ã€‚</p>\n<hr />\n<h2 id=\"çŸ©å½¢åˆ°çŸ©å½¢çš„æ–¹æ¡ˆæ•°\">çŸ©å½¢åˆ°çŸ©å½¢çš„æ–¹æ¡ˆæ•°</h2>\n<p>æšä¸¾ç¬¬ä¸€ä¸ªçŸ©å½¢é‡Œçš„æ‰€æœ‰ç‚¹ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾—åˆ°å…³äºç¬¬äºŒä¸ªçŸ©å½¢é‡Œå››ä¸ªç‚¹çš„è¡¨è¾¾å¼ã€‚åè¿‡æ¥æŠŠç¬¬ä¸€ä¸ªçŸ©å½¢æ¦‚æ‹¬ä¸º 4 ä¸ªç‚¹å°±å¯ä»¥å¿«é€Ÿæ±‚è§£äº†ã€‚</p>\n<p>å…·ä½“ä¸€ç‚¹ï¼Œç¬¬ä¸€ä¸ªçŸ©å½¢ <span class=\"math inline\">\\((x_1,y_1,x_2,y_2)\\)</span> å¯ä»¥è¢«æ¦‚æ‹¬ä¸º <span class=\"math inline\">\\((x_1-1,y_1-1)\\)</span>ï¼Œ<span class=\"math inline\">\\((x_1-1,y_2)\\)</span>ï¼Œ<span class=\"math inline\">\\((x_2,y_1-1)\\)</span>ï¼Œ<span class=\"math inline\">\\((x_2,y_2)\\)</span>ã€‚æ³¨æ„æ–¹å‘é¢ å€’å¯¼è‡´ç¬¦å·å‘ç”Ÿå˜åŒ–ã€‚æ­¤æ—¶å¯¹ <span class=\"math inline\">\\(4\\times 4=16\\)</span> ä¸ª <span class=\"math inline\">\\(G\\)</span> æŒ‰å¯¹åº”çš„ <span class=\"math inline\">\\(-1/1\\)</span> ç³»æ•°æ±‚å’Œå°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚</p>\n<hr />\n<h3 id=\"d---sightseeing-plan\">D - Sightseeing Plan</h3>\n<p><a href=\"https://atcoder.jp/contests/agc018/tasks/agc018_e\" class=\"uri\">https://atcoder.jp/contests/agc018/tasks/agc018_e</a></p>\n<ol type=\"1\">\n<li>æ’ç­‰å¼ï¼š<span class=\"math inline\">\\(\\sum\\limits_{i\\in [x_1,x_2]}G_(x_1,y_1,i,y_2-1)=G(x_1,y_1,x_2,y_2)\\)</span>ï¼Œæ”¾åœ¨ç½‘æ ¼å›¾ä¸Šå°±æ˜¯å¼ºåˆ¶èµ°åˆ° <span class=\"math inline\">\\((i,y_2-1)\\)</span>ï¼Œå†å¼ºåˆ¶å‘å³èµ°ä¸€æ­¥ï¼Œç„¶åå‘ä¸Šèµ°åˆ° <span class=\"math inline\">\\((x_2,y_2)\\)</span>ã€‚å’Œä¸Šä¸€é¢˜ç±»ä¼¼çš„ï¼Œå¯ä»¥å‘ç°ä¸é‡ä¸æ¼ã€‚</li>\n<li>ä¸‰ä¸ªçŸ©å½¢ï¼Œ<span class=\"math inline\">\\(M_1\\)</span> ç»è¿‡ <span class=\"math inline\">\\(M_2\\)</span> åˆ°è¾¾ <span class=\"math inline\">\\(M_3\\)</span> çš„è·¯å¾„æ•°é‡ï¼šç»è¿‡ <span class=\"math inline\">\\(M_2\\)</span> æ—¶ï¼Œæ ¹æ®é™åˆ¶ï¼Œåªå¯èƒ½ä»ä¸‹é¢æˆ–å·¦è¾¹è¿›å…¥ã€‚æšä¸¾è¿›å…¥çš„ç‚¹ <span class=\"math inline\">\\((x_0,y_0)\\)</span>ï¼ˆæ•°é‡ä¸º <span class=\"math inline\">\\(O(n)\\)</span>ï¼‰ï¼Œå†è®¡ç®— <span class=\"math inline\">\\(G(x_0,y_0,M_3)\\)</span> å°±èƒ½å¾—åˆ°ä¸é‡ä¸æ¼çš„ç­”æ¡ˆã€‚</li>\n<li>åŸé—®é¢˜ï¼šè¦æ±‚ <span class=\"math inline\">\\(M_2\\)</span> å†…éƒ¨è·¯å¾„ä¸Šç‚¹çš„è´¡çŒ®å’Œï¼Œè¿™ä¸ªå…¶å®å°±æ˜¯ <span class=\"math inline\">\\(M_2\\)</span> å†…éƒ¨è·¯å¾„é•¿åº¦ã€‚è‹¥ä» <span class=\"math inline\">\\((x_1,y_1)\\)</span> è¿›å…¥ï¼Œå†ä» <span class=\"math inline\">\\((x_2,y_2)\\)</span> ç¦»å¼€ï¼Œé•¿åº¦å°±æ˜¯ <span class=\"math inline\">\\(x_2-x_1+y_2-y_1+1\\)</span>ã€‚æ‹†æˆ <span class=\"math inline\">\\((x_2+y_2+1)\\)</span> å’Œ <span class=\"math inline\">\\(-(x_1+y_1)\\)</span> åå‘ç°ä¸€æ¬¡è¿›å…¥å’Œä¸€æ¬¡ç¦»å¼€çš„è´¡çŒ®æ˜¯ç‹¬ç«‹çš„ã€‚åˆ†åˆ«æšä¸¾è¿›å…¥ç‚¹å’Œç¦»å¼€ç‚¹è®¡ç®—è´¡çŒ®å°±å¯ä»¥äº†ã€‚</li>\n</ol>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int N = 2e6;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int x1, x2, x3, x4, x5, x6, y1, y2, y3, y4, y5, y6;\n    std::cin &gt;&gt; x1 &gt;&gt; x2 &gt;&gt; x3 &gt;&gt; x4 &gt;&gt; x5 &gt;&gt; x6;\n    std::cin &gt;&gt; y1 &gt;&gt; y2 &gt;&gt; y3 &gt;&gt; y4 &gt;&gt; y5 &gt;&gt; y6;\n    std::vector&lt;long long&gt; fac(N + 1), inv(N + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= N; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[N] = qkp(fac[N], mod - 2);\n    for (int i = N - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        return fac[n] * inv[n - m] % mod * inv[m] % mod;\n    &#125;;\n    std::vector&lt;std::tuple&lt;int, int, int&gt; &gt; f(4), g(4);\n    f[0] = &#123; x1 - 1, y1 - 1, 1 &#125;, f[1] = &#123; x1 - 1, y2, mod - 1 &#125;, f[2] = &#123; x2, y1 - 1, mod - 1 &#125;, f[3] = &#123; x2, y2, 1 &#125;;\n    g[0] = &#123; x5, y5, 1 &#125;, g[1] = &#123; x5, y6 + 1, mod - 1 &#125;, g[2] = &#123; x6 + 1, y5, mod - 1 &#125;, g[3] = &#123; x6 + 1, y6 + 1, 1 &#125;; \n    auto G = [&amp;](int x1, int y1, int x2, int y2) &#123;\n        auto a(std::abs(x1 - x2)), b(std::abs(y1 - y2));\n        return C(a + b, a);\n    &#125;;\n    auto res = 0ll;\n    for (auto [x1, y1, k1] : f)\n        for (auto [x2, y2, k2] : g) &#123;\n            auto t(0ll);\n            for (int x = x3; x &lt;= x4; ++x) &#123;\n                (t += G(x1, y1, x, y4) * G(x, y4 + 1, x2, y2) % mod * (x + y4 + 1) % mod) %= mod;\n                (t += mod - G(x1, y1, x, y3 - 1) * G(x, y3, x2, y2) % mod * (x + y3) % mod) %= mod;\n            &#125;\n            for (int y = y3; y &lt;= y4; ++y) &#123;\n                (t += G(x1, y1, x4, y) * G(x4 + 1, y, x2, y2) % mod * (x4 + y + 1) % mod) %= mod;\n                (t += mod - G(x1, y1, x3 - 1, y) * G(x3, y, x2, y2) % mod * (x3 + y) % mod) %= mod;\n            &#125;\n            // printf(&quot;(%d, %d, %d), (%d, %d, %d): %lld\\n&quot;, x1, y1, k1, x2, y2, k2, t * k1 % mod * k2 % mod);\n            (res += t * k1 % mod * k2 % mod) %= mod;\n        &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"ä¸ç»è¿‡-yxc-çš„æ–¹æ¡ˆæ•°\">ä¸ç»è¿‡ <span class=\"math inline\">\\(y=x+c\\)</span> çš„æ–¹æ¡ˆæ•°</h2>\n<p>Catalan æ•°çš„ä¸€ç§æ¨å¯¼æ–¹å¼æ˜¯ï¼Œåœ¨ <span class=\"math inline\">\\(n\\times n\\)</span> çš„ç½‘æ ¼ä¸Šï¼Œè¦æ±‚ä¸èƒ½è¶Šè¿‡ <span class=\"math inline\">\\(y=x\\)</span> çš„æ–¹æ¡ˆæ•°ã€‚å¯ä»¥ç”¨æ€»æ–¹æ¡ˆæ•°å‡å»è¶Šè¿‡çš„æ–¹æ¡ˆæ•°ã€‚</p>\n<p>æ€ä¹ˆè®¡ç®—éæ³•çš„æ–¹æ¡ˆå‘¢ï¼Ÿè¶Šè¿‡ <span class=\"math inline\">\\(y=x\\)</span> çš„è·¯å¾„å¿…å®šå­˜åœ¨ä¸€ä¸ªç‚¹ç»è¿‡ <span class=\"math inline\">\\(y=x+1\\)</span>ï¼ŒåŸé—®é¢˜è½¬åŒ–ä¸ºä¸èƒ½ç¢°åˆ° <span class=\"math inline\">\\(y=x+1\\)</span> çš„æ–¹æ¡ˆæ•°ã€‚</p>\n<p>æŠŠç»ˆç‚¹ <span class=\"math inline\">\\((n, n)\\)</span> ç¿»æŠ˜åˆ° <span class=\"math inline\">\\(y=x+1\\)</span> ä¸Šæ–¹ï¼Œå¾—åˆ° <span class=\"math inline\">\\((n-1, n + 1)\\)</span>ï¼›å¯¹äºä»»æ„åˆ°è¾¾ <span class=\"math inline\">\\((n-1,n+1)\\)</span> çš„è·¯å¾„ï¼Œä¸€å®šä¼šæ¥è§¦ <span class=\"math inline\">\\(y=x+1\\)</span> è‡³å°‘ä¸€æ¬¡ï¼›å°†ç¬¬ä¸€æ¬¡æ¥è§¦ä»¥åçš„è·¯å¾„ç¿»æŠ˜åˆ° <span class=\"math inline\">\\(y=x+1\\)</span> ä¸‹æ–¹ï¼Œåˆ™ä¸€å®šå’ŒåŸå›¾ä¸­çš„éæ³•è·¯å¾„ä¸€ä¸€å¯¹åº”ã€‚</p>\n<p><img src=\"4.png\" /></p>\n<p>å°±å¯ä»¥å¾—åˆ° <span class=\"math inline\">\\(C_{2n}^n-C_{2n}^{n-1}\\)</span>ã€‚</p>\n<p>å¦‚æœé—®é¢˜å˜å¾—æ›´åŠ ä¸€èˆ¬ï¼Œæ±‚è§£åˆ°è¾¾ <span class=\"math inline\">\\((n, m)\\)</span> ä¸èƒ½ç¢°åˆ° <span class=\"math inline\">\\(y=x+c\\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œè¿˜æ˜¯å¯ä»¥æŠŠ <span class=\"math inline\">\\((n,m)\\)</span> ç¿»æŠ˜åˆ° <span class=\"math inline\">\\((m-c,n+c)\\)</span>ï¼Œç­”æ¡ˆæ˜¯ <span class=\"math inline\">\\(C_{n+m}^n-C_{n+m}^{m-c}\\)</span>ã€‚</p>\n<hr />\n<h2 id=\"ä¸ç»è¿‡-yx-l-å’Œ-yxr-çš„æ–¹æ¡ˆæ•°\">ä¸ç»è¿‡ <span class=\"math inline\">\\(y=x-l\\)</span> å’Œ <span class=\"math inline\">\\(y=x+r\\)</span> çš„æ–¹æ¡ˆæ•°</h2>\n<p>ç°åœ¨æœ‰ <span class=\"math inline\">\\(y=x-l\\)</span> å’Œ <span class=\"math inline\">\\(y=x+r\\)</span> ä¸¤æ¡çº¿ä½œä¸ºé™åˆ¶ï¼Œç°åœ¨çš„ç¿»æŠ˜æ„ä¹‰å°±ä¼šæœ‰ä¸€ç‚¹æ”¹å˜ã€‚</p>\n<p><img src=\"5.png\" /></p>\n<p>æ¯”å¦‚å›¾ä¸­çš„ <span class=\"math inline\">\\(A&#39;\\)</span>ï¼Œæ˜¯ <span class=\"math inline\">\\(A\\)</span> æ²¿ç€ <span class=\"math inline\">\\(y=x-l\\)</span> ç¿»æŠ˜ä¸€æ¬¡åçš„ç»“æœã€‚è¿˜æ˜¯æŒ‰ç…§ä¹‹å‰çš„æ–¹å¼æ¥ç†è§£ï¼Œé‚£ä¹ˆèµ°åˆ° <span class=\"math inline\">\\(A&#39;\\)</span> çš„è·¯å¾„ä»£è¡¨è‡³å°‘ç»è¿‡ä¸€æ¬¡ <span class=\"math inline\">\\(y=x-l\\)</span> çš„æ–¹æ¡ˆã€‚<span class=\"math inline\">\\(A&#39;&#39;\\)</span> æ˜¯ <span class=\"math inline\">\\(A&#39;\\)</span> æ²¿ç€ <span class=\"math inline\">\\(y=x+r\\)</span> ç¿»æŠ˜ä¸€æ¬¡ä¹‹åå¾—åˆ°çš„ç»“æœï¼Œèµ°åˆ° <span class=\"math inline\">\\(A&#39;&#39;\\)</span> çš„è·¯å¾„å°±ä»£è¡¨è‡³å°‘å…ˆç¢°åˆ°ä¸€æ¬¡ <span class=\"math inline\">\\(y=x-l\\)</span>ï¼Œå†ç¢°åˆ°ä¸€æ¬¡ <span class=\"math inline\">\\(y=x+r\\)</span> çš„æ–¹æ¡ˆæ•°ã€‚</p>\n<p>å¦‚æœæŠŠç›¸é‚»å¤šæ¬¡ç¢°åˆ° <span class=\"math inline\">\\(y=x-l\\)</span> æˆ– <span class=\"math inline\">\\(y=x+r\\)</span> åˆå¹¶ä¸ºä¸€æ¬¡ï¼Œæœ€ç»ˆçš„éæ³•è·¯å¾„å°±æ˜¯ <code>LRLRLR...</code> æˆ–è€… <code>RLRLRL...</code> çš„å½¢å¼ã€‚å› ä¸ºå¯ä»¥è®¡ç®—çš„æ˜¯ã€Œè‡³å°‘ã€çš„å½¢å¼ï¼Œç”¨å®¹æ–¥åŸç†å¾—åˆ°ï¼Œç­”æ¡ˆæ˜¯ <span class=\"math inline\">\\(f_{\\varnothing}-(f_{\\texttt L} + f_{\\texttt R}) + (f_{\\texttt {LR}} + f_{\\texttt {RL}}) - \\cdots\\)</span>ã€‚å¯¹åº”è®¡ç®—æ¯ä¸ªç¿»æŠ˜å¯¹åº”ç»ˆç‚¹å’Œç­”æ¡ˆå°±å¯ä»¥äº†ã€‚æœ€åçš„ç­”æ¡ˆæ˜¯ <span class=\"math inline\">\\(C_{n+m}^n-C_{n+m}^{n+l}-C_{n+m}^{n + r}+C_{n+m}^{n+l-r}+C_{n+m}^{n+r-l}-\\cdots\\)</span>ï¼Œå¯ä»¥ç®€åŒ–æˆ <span class=\"math inline\">\\(\\sum\\limits_{k\\in \\mathbb{Z}} C_{n+m}^{n-k\\cdot (r-l)}-C_{n+m}^{n-k\\cdot (r-l)+r}\\)</span>ã€‚</p>\n<hr />\n<h3 id=\"e---éª—æˆ‘å‘¢\">E - éª—æˆ‘å‘¢</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P3266\" class=\"uri\">https://www.luogu.com.cn/problem/P3266</a></p>\n<p>æ¯è¡Œå†…éƒ¨é€’å¢ï¼Œè€Œä¸”é€‰é¡¹åªæœ‰ <span class=\"math inline\">\\([0,m]\\)</span>ï¼Œé‚£ä¹ˆæ¯è¡Œå°±ä¼šåˆšå¥½åœ¨ <span class=\"math inline\">\\([0,m]\\)</span> é‡Œé¢è·³è¿‡ä¸€ä¸ªæ•°ã€‚</p>\n<p>å¦‚æœç¬¬ <span class=\"math inline\">\\(i\\)</span> è¡Œè·³è¿‡çš„æ•°æ˜¯ <span class=\"math inline\">\\(j\\)</span>ï¼Œé‚£ä¹ˆç”»ä¸€ç”»å›¾å°±å¯ä»¥å‘ç°ç¬¬ <span class=\"math inline\">\\(i+1\\)</span> å¯èƒ½è·³è¿‡çš„æ•°æ˜¯ <span class=\"math inline\">\\([j-1,m]\\)</span>ï¼›åè¿‡æ¥ï¼Œç¬¬ <span class=\"math inline\">\\(i-1\\)</span> è¡Œå¯èƒ½è·³è¿‡çš„æ•°å°±æ˜¯ <span class=\"math inline\">\\([0,j+1]\\)</span>ã€‚</p>\n<p>å¦‚æœè®© <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºç¡®å®šäº†ç¬¬ <span class=\"math inline\">\\(1\\to i\\)</span> è¡Œï¼Œå…¶ä¸­ç¬¬ <span class=\"math inline\">\\(i\\)</span> è¡Œè·³è¿‡ <span class=\"math inline\">\\(j\\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥å¾—åˆ° <span class=\"math inline\">\\(f_{i,j}=\\sum\\limits_{k=0}^{j+1} f_{i-1,k}\\)</span>ã€‚å‰ç¼€å’Œå¾—åˆ° <span class=\"math inline\">\\(f_{i,j}=f_{i,j-1}+f_{i-1,j+1}\\)</span>ã€‚æ³¨æ„è¾¹ç•Œï¼š<span class=\"math inline\">\\(f_{0,j}=1\\)</span>ï¼›<span class=\"math inline\">\\(f_{i,0}=f_{i-1,0}+f_{i-1,1}\\)</span>ï¼›<span class=\"math inline\">\\(f_{i,m}=f_{i,m-1}\\)</span>ã€‚</p>\n<p>ä¸ºäº†å¾—åˆ°ç­”æ¡ˆï¼Œè®© <span class=\"math inline\">\\(g_{i,j}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(i\\times j\\)</span> çŸ©é˜µçš„æ–¹æ¡ˆæ•°ï¼ˆè¿™æ ·å°±æœ‰æœºä¼šé€šè¿‡æ‰‹æ®µä¼˜åŒ–äº†ï¼‰ï¼š</p>\n<p><span class=\"math display\">\\[\n\\begin{aligned}\ng_{i,j}&amp;=\\sum_{k=0}^j f_{i,k}\\\\\n&amp;= f_{i-1,0}+f_{i-1,1}+\\sum_{k=1}^j f_{i,k-1}+f_{i-1,k+1}\\\\\n&amp;= g_{i,j-1}+g_{i-1,j+1}\n\\end{aligned}\n\\]</span></p>\n<p>è¾¹ç•Œæƒ…å†µå‘¢ï¼Œ <span class=\"math inline\">\\(g_{i, 0} = f_{i,0} = f_{i-1, 0} + f_{i - 1, 1} = g_{i-1,1}\\)</span>ï¼›<span class=\"math inline\">\\(g_{i,m}=g_{i, m - 1} + f_{i,m}=g_{i-1,m}+g_{i,m-1}\\)</span>ã€‚ <span class=\"math inline\">\\(g_{i,m+1}=g_{i,m}\\)</span> é¿å…è¾¹ç•Œã€‚</p>\n<p>é‚£ä¹ˆåœ¨ç½‘æ ¼å›¾ä¸Šè½¬ç§»å¦‚ä¸‹ï¼š</p>\n<p><img src=\"2.png\" /></p>\n<p>è€ƒè™‘å°†è¿™ä¸ªå›¾å½¢æ‹‰æ­£ï¼Œä»¤ <span class=\"math inline\">\\((i+i,j)\\gets g_{i,j}\\)</span> å¾—åˆ°ï¼š</p>\n<p><img src=\"3.png\" /></p>\n<p>é—®é¢˜å°±è½¬åŒ–ä¸ºï¼Œä» <span class=\"math inline\">\\((0, 0)\\)</span> èµ°åˆ° <span class=\"math inline\">\\((m+n+1,n)\\)</span> ä¸”ä¸èƒ½è§¦ç¢° <span class=\"math inline\">\\(y=x+1\\)</span> å’Œ <span class=\"math inline\">\\(y=x-m-2\\)</span> ä¸¤æ¡ç›´çº¿çš„æ–¹æ¡ˆæ•°ã€‚</p>\n<details>\n</details>\n<hr />\n<h2 id=\"ä¸ç»è¿‡ä¸€èˆ¬è¿‡åŸç‚¹ç›´çº¿çš„æ–¹æ¡ˆæ•°\">ä¸ç»è¿‡ä¸€èˆ¬è¿‡åŸç‚¹ç›´çº¿çš„æ–¹æ¡ˆæ•°</h2>\n<ol type=\"1\">\n<li><p>ç±»å‹ä¸€ï¼š<span class=\"math inline\">\\((0,0)\\to (n,m)\\)</span>ï¼Œä¸ç»è¿‡ <span class=\"math inline\">\\(y=\\dfrac mnx\\)</span> çš„æ–¹æ¡ˆï¼Œå…¶ä¸­è¦æ±‚ <span class=\"math inline\">\\((m,n)=1\\)</span>ã€‚</p>\n<p>æ–¹æ¡ˆä¸º <span class=\"math inline\">\\(\\dfrac {C_{n+m}^n}{n+m}\\)</span>ã€‚</p></li>\n</ol>\n",
            "tags": [
                "æ’åˆ—ç»„åˆ",
                "å®¹æ–¥åŸç†",
                "æ•°å­¦"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250216/",
            "url": "https://xsc062.netlify.app/20250216/",
            "title": "æ‚é¢˜é€‰è°ˆï¼šPublic Round 15",
            "date_published": "2025-02-16T11:44:38.000Z",
            "content_html": "<p><a href=\"https://pjudge.ac/contest/1914\">PR #15</a> å‰ä¸¤é¢˜é¢˜è§£ã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"æœ€å°è¡¨ç¤ºæ³•\">æœ€å°è¡¨ç¤ºæ³•</h2>\n<p><a href=\"https://pjudge.ac/contest/1914/problem/21888\" class=\"uri\">https://pjudge.ac/contest/1914/problem/21888</a></p>\n<p>é¦–å…ˆä¸å¦¨å‡è®¾æ¯ä¸ª <span class=\"math inline\">\\(f\\)</span> åœ¨å€¼åŸŸå†…ç­‰æ¦‚ç‡å–å€¼ä»¥ç®€åŒ–é—®é¢˜ã€‚é‚£ä¹ˆæ‰‹ç©ä¸€ä¸‹å¯ä»¥è½»æ¾åœ°å¾—åˆ°è§„å¾‹ï¼šä¸å¦¨å°† <span class=\"math inline\">\\(\\{s\\}\\)</span> å¾ªç¯å³ç§»ä¸€ä½çš„ç»“æœè®°ä¸º <span class=\"math inline\">\\(\\{t\\}\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(res=\\sum\\frac 1{\\max(|s_i|,|t_i|)}\\)</span>ã€‚</p>\n<p>è¿™çœ‹èµ·æ¥ä»¤äººç–‘æƒ‘ï¼šå¯¹äºä¸åŒçš„ <span class=\"math inline\">\\(i\\)</span>ï¼Œ<span class=\"math inline\">\\([f(s_i)=f(t_i)]\\)</span> çš„æœŸæœ›ä¼¼ä¹æ˜¯å½¼æ­¤ç‹¬ç«‹çš„ï¼Œååˆ†å¥‡æ€ªã€‚è¿™å…¶å®ä¸è¡¨è¾¾å¼çš„æ¥æºæœ‰å…³ï¼Œè®° <span class=\"math inline\">\\(g(s_i, j)\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(f(s_i)=j\\)</span> çš„æ¦‚ç‡ï¼Œé‚£ä¹ˆä¸Šè¿°ç­‰å¼å¯ä»¥è½¬å†™ä¸º <span class=\"math inline\">\\(res=\\sum\\limits_i\\sum\\limits_jg({s_i},j)\\times g(t_i,j)\\)</span>ã€‚</p>\n<p>é‚£ä¹ˆå°†æœ€å°è¡¨ç¤ºæ³•å¸¦æ¥çš„åå·®çº³å…¥è€ƒè™‘èŒƒå›´ï¼Œæˆ‘ä»¬å‘ç° <span class=\"math inline\">\\(g(s,j)\\)</span> å¯¹äºä¸åŒçš„ <span class=\"math inline\">\\(j\\)</span> å¹¶ä¸æ°¸è¿œç›¸ç­‰ã€‚å…·ä½“åœ°ï¼Œå½“ <span class=\"math inline\">\\(s\\)</span> å…·æœ‰å¾ªç¯èŠ‚æ—¶ï¼Œæœ€å°å¾ªç¯èŠ‚çš„ç¬¬ä¸€å¤„ç»“å°¾ä¼šäº«æœ‰æ›´å¤§çš„å–å¾—æ¦‚ç‡ã€‚</p>\n<p>æšä¸¾ <span class=\"math inline\">\\(s_i\\)</span> çš„å› æ•°ä½œä¸ºæœ€å°å¾ªç¯èŠ‚é•¿åº¦çš„æƒ…å†µï¼Œæ˜¾ç„¶ï¼Œå¯¹äºæœ€å°å¾ªç¯èŠ‚ä¸º <span class=\"math inline\">\\(j\\)</span> çš„æƒ…å†µï¼ˆè¯¥æƒ…å†µå‡ºç°çš„æ¦‚ç‡ï¼Œå®¹æ–¥å¾—åˆ° <span class=\"math inline\">\\(p_j=26^j-\\sum_{k\\mid j}p_k\\)</span>ï¼‰ï¼Œ<span class=\"math inline\">\\(f(s_i)\\)</span> çš„å–å€¼åœ¨ <span class=\"math inline\">\\(1\\sim j\\)</span> ä¸Šç­‰æ¦‚ç‡åˆ†å¸ƒï¼Œå·®åˆ†å³å¯ç»Ÿè®¡æ¯ä¸ªå€¼åœ¨ä¸åŒå¾ªç¯èŠ‚é•¿åº¦ä¸‹è¢«å–åˆ°çš„æ¦‚ç‡å’Œã€‚</p>\n<p>ç”¨åŸƒç­›è§£å†³æ¯ä¸ªæ•°çš„å› æ•°å’Œ <span class=\"math inline\">\\(p\\)</span> å€¼ï¼Œé‚£ä¹ˆæ­¤æ—¶å¤æ‚åº¦ç“¶é¢ˆåœ¨äº <span class=\"math inline\">\\(g(s_i, j)\\)</span> å’Œ <span class=\"math inline\">\\(\\sum\\limits_i\\sum\\limits_jg({s_i},j)\\times g(t_i,j)\\)</span> çš„æ±‚è§£ã€‚å®¹æ˜“å‘ç°åªæœ‰æ¯ä¸ª <span class=\"math inline\">\\(g(s_i,j),j\\mid |s_i|\\)</span> çš„å€¼æ˜¯æœ‰æ•ˆçš„ï¼ˆå…¶ä»–çš„å’Œå®ƒä»¬å€¼éƒ½ç›¸åŒï¼‰ï¼Œè€ƒè™‘åªæ±‚è§£å’Œåˆ©ç”¨è¿™äº›å€¼ï¼Œç±» <code>std::merge</code>ï¼ˆå³å½’å¹¶æ’åºï¼‰åœ°æ±‚è§£ç­”æ¡ˆã€‚</p>\n<p>æ³¨æ„ç‰¹åˆ¤ <span class=\"math inline\">\\(n=1\\)</span>ã€‚ä¼šå¾—åˆ°é”™è¯¯ç­”æ¡ˆçš„åŸå› æ˜¯æ­¤æ—¶å­˜åœ¨ <span class=\"math inline\">\\(s_i=t_i\\)</span>ï¼Œä¸æ»¡è¶³åŸºæœ¬è¦æ±‚ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int lim = 1e5;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    if (n == 1) &#123;\n        std::cout &lt;&lt; 1 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    auto qkp = [](long long x, int y) &#123;\n        long long res = 1ll;\n        for (; y; y &gt;&gt;= 1, (x *= x) %= mod)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    auto inv = [&amp;](int x) &#123;\n        return qkp(x, mod - 2);\n    &#125;;\n    std::vector&lt;long long&gt; f(lim + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; fac(lim + 1);\n    for (int i = 1; i &lt;= lim; ++i) &#123;\n        static long long now = 26;\n        (f[i] += now) %= mod;\n        fac[i].push_back(i);\n        for (int j = 2 * i; j &lt;= lim; j += i)\n            (f[j] += mod - f[i]) %= mod, fac[j].push_back(i);\n        (now *= 26) %= mod;\n    &#125;\n    for (int i = 1; i &lt;= lim; ++i)\n        (f[i] *= inv(i)) %= mod;\n    std::vector&lt;int&gt; a(n + 1);\n    struct _ &#123; int l, r; long long f; &#125;;\n    std::vector&lt;std::vector&lt;_&gt; &gt; g(lim + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        if (g[a[i]].empty()) &#123;\n            g[a[i]].resize(fac[a[i]].size());\n            for (int j = 0; j &lt; (int)fac[a[i]].size(); ++j) &#123;\n                g[a[i]][j].l = (j ? g[a[i]][j - 1].r + 1 : 1);\n                g[a[i]][j].r = fac[a[i]][j];\n                (g[a[i]][0].f += f[fac[a[i]][j]]) %= mod;\n                if (j != (int)fac[a[i]].size() - 1)\n                    (g[a[i]][j + 1].f += mod - f[fac[a[i]][j]]) %= mod;\n            &#125;\n            for (int j = 1; j &lt; (int)fac[a[i]].size(); ++j)\n                (g[a[i]][j].f += g[a[i]][j - 1].f) %= mod;\n            int getinv = inv(qkp(26, a[i]));\n            for (int j = 0; j &lt; (int)fac[a[i]].size(); ++j)\n                (g[a[i]][j].f *= getinv) %= mod;\n        &#125;\n    &#125;\n    std::vector&lt;int&gt; b(n + 1);\n    std::rotate_copy(a.begin() + 1, --a.end(), a.end(), b.begin() + 1);\n    long long res = 0ll;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (int j = 0, k = 0, now = 0;\n            j &lt; (int)fac[a[i]].size() &amp;&amp; k &lt; (int)fac[b[i]].size(); )\n            if (g[a[i]][j].r &lt; g[b[i]][k].r) &#123;\n                (res += g[a[i]][j].f * g[b[i]][k].f % mod\n                    * (g[a[i]][j].r - now) % mod) %= mod;\n                now = g[a[i]][j].r, ++j;\n            &#125;\n            else if (g[a[i]][j].r == g[b[i]][k].r) &#123;\n                (res += g[a[i]][j].f * g[b[i]][k].f % mod\n                    * (g[a[i]][j].r - now) % mod) %= mod;\n                now = g[a[i]][j].r, ++j, ++k;\n            &#125;\n            else &#123;\n                (res += g[a[i]][j].f * g[b[i]][k].f % mod\n                    * (g[b[i]][k].r - now) % mod) %= mod;\n                now = g[b[i]][k].r, ++k;\n            &#125;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"äºŒå‰æœç´¢æ ‘\">äºŒå‰æœç´¢æ ‘</h2>\n<p><a href=\"https://pjudge.ac/contest/1914/problem/21889\" class=\"uri\">https://pjudge.ac/contest/1914/problem/21889</a></p>\n<p>å½“æˆ‘ä»¬å¤„ç†é“¾çš„éƒ¨åˆ†åˆ†æ—¶ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨å·®åˆ†è§£å†³é—®é¢˜ã€‚æŠŠæ›´æ–° <span class=\"math inline\">\\([l, r]\\)</span> çœ‹ä½œåœ¨å·®åˆ†æ•°ç»„ <span class=\"math inline\">\\(l\\)</span> å¤„æ’å…¥ï¼Œåœ¨ <span class=\"math inline\">\\(r+1\\)</span> å¤„åˆ é™¤ï¼Œç¦»çº¿ä¸‹æ¥å†ä»å·¦åˆ°å³æ‰«ä¸€éæ“ä½œï¼Œè€ƒè™‘å¦‚ä½•è§£å†³æŸ¥è¯¢é—®é¢˜ã€‚</p>\n<p>è€ƒè™‘å¦‚ä½•è·å– <span class=\"math inline\">\\(i\\)</span> æ ‘ä¸Š <span class=\"math inline\">\\(t_0\\)</span> æ—¶åˆ»ç‚¹ <span class=\"math inline\">\\(x\\)</span> çš„æ‰€æœ‰ç¥–å…ˆã€‚æ ¹æ®å‰é¢çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥è·å– <span class=\"math inline\">\\(i\\)</span> æ ‘ä¸Šå­˜åœ¨è¿‡çš„æ‰€æœ‰å…ƒç´ ã€‚</p>\n<p>å¯¹äºæ¯” <span class=\"math inline\">\\(x\\)</span> å¤§çš„å…ƒç´ ï¼Œè€ƒè™‘ç¥–å…ˆ <span class=\"math inline\">\\(p_a\\)</span> å’Œéç¥–å…ˆ <span class=\"math inline\">\\(p\\)</span> æœ‰ä»€ä¹ˆåŒºåˆ«ã€‚æ ¹æ® BST çš„æ€§è´¨æ˜“å¾—ï¼Œå¯¹äºæœ€ä½çš„å³ä¾§ç¥–å…ˆ <span class=\"math inline\">\\({p_a}_0\\)</span>ï¼Œå…¶æ˜¯ <span class=\"math inline\">\\(\\ge x\\)</span> çš„æœ€å°çš„å…ƒç´ ï¼ˆå½“ç„¶å…¶åŠ å…¥æ—¶åˆ» <span class=\"math inline\">\\(t_a&lt;t_0\\)</span>ï¼‰ï¼›é‚£ä¹ˆåŒç†å¯ä»¥æ‰¾åˆ° <span class=\"math inline\">\\({p_a}_0\\)</span> å³ä¾§æœ€ä½çš„ç¥–å…ˆï¼ˆå…¶å·¦ä¾§çš„ç¥–å…ˆæ˜¾ç„¶ä¹Ÿ <span class=\"math inline\">\\(x\\)</span> å·¦ä¾§ï¼‰ï¼Œè¯¥ç¥–å…ˆæ»¡è¶³ <span class=\"math inline\">\\(t&lt;t_a\\)</span>ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±ä»å·¦å³ä¸¤è¾¹åˆ†åˆ«å¾—åˆ° <span class=\"math inline\">\\(x\\)</span> çš„æ‰€æœ‰ç¥–å…ˆã€‚å®¹æ˜“è¯æ˜è¯¥è¿‡ç¨‹å¯¹äºä¸åœ¨æ ‘ä¸Šçš„ <span class=\"math inline\">\\(x\\)</span> ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</p>\n<p>å…·ä½“åœ°ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œèƒ½å¤Ÿæ±‚å‡º <span class=\"math inline\">\\(\\ge x\\)</span> çš„å…ƒç´ ä¸­ï¼Œä»¥ <span class=\"math inline\">\\(t_0\\)</span> ä¸ºèµ·ç‚¹çš„å‰ç¼€æœ€å°å€¼åºåˆ—çš„åŒºé—´å’Œã€‚</p>\n<p>æ¬¸ â˜ğŸ¤“ è¿™æ˜¯ä»€ä¹ˆï¼Ÿ<a href=\"/20250217\">æ¥¼æˆ¿é‡å»º</a>ï¼ç§’ä¸€ä¸‹ï¼</p>\n<p>è¿›ä¸€æ­¥åœ°ï¼Œæœ¬é¢˜éœ€è¦å®Œæˆå¯¹äº <span class=\"math inline\">\\(t_0\\)</span> ä¸ºåºåˆ—å¤´çš„æŸ¥è¯¢ã€‚å†æ¬¡åˆ©ç”¨æ€§è´¨ï¼Œæ¯æ¬¡ <span class=\"math inline\">\\(O(\\log V)\\)</span> åœ°åˆå¹¶ç­”æ¡ˆã€‚</p>\n<p>å¥½çš„é‚£ä¹ˆæ€ä¹ˆæŠŠé“¾æåˆ°æ ‘ä¸Šå‘¢ï¼ŸæŠŠå·®åˆ†æ”¾åˆ°æ ‘ä¸Šï¼Œå†™ä¸ªçº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚</p>\n<p><strong>æ³¨æ„ç”±äºè¿™é¢˜ç»†èŠ‚å¤ªå¤šäº†ï¼Œæ‰€ä»¥ä½ å¯èƒ½éœ€è¦èˆå¼ƒä¸å¿…è¦çš„æ—¶ç©ºä¼˜åŒ–æ¢å–ä»£ç ç®€æ´åº¦ä»¥æ–¹ä¾¿è°ƒè¯•ã€‚</strong></p>\n<details>\n<pre data-line=\"12\" class=\"cpp language-cpp\"><code data-line=\"12\" class=\"cpp language-cpp\">#include &lt;bits/stdc++.h&gt;\nconst int lim = 2e5;\nconst int maxn = 2e7 + 5;\nconst int inf = 0x3f3f3f3f;\nstruct &#123;\n    int l, r, rv;\n    long long u;\n&#125; t[maxn];\nstd::vector&lt;int> tr;\n#define lt t[p].l\n#define rt t[p].r\nint newnode(void) &#123;         // æˆ‘çŸ¥é“ä½ è¦è¯´ä»€ä¹ˆï¼Œä½†è¿™å±äºã€Œå¿…è¦çš„ã€ç©ºé—´ä¼˜åŒ– ğŸ˜¥\n    static int tot = 0;\n    if (tr.empty())\n        return ++tot;\n    auto p(tr.back());\n    t[p].l = t[p].r = 0;\n    tr.pop_back();\n    return p;\n&#125;\nlong long askv(int p, int l, int r, int v) &#123;\n    if (l == r)\n        return t[p].rv < v ? t[p].u : 0;\n    int mid = (l + r) >> 1;\n    if (v > t[lt].rv)\n        return t[p].u - t[lt].u + askv(lt, l, mid, v);\n    return askv(rt, mid + 1, r, v);\n&#125;\nvoid pushup(int p, int l, int r) &#123;\n    t[p].rv = std::min(t[lt].rv, t[rt].rv);\n    int mid = (l + r) >> 1;\n    t[p].u = t[lt].u + askv(rt, mid + 1, r, t[lt].rv);\n    return;\n&#125;\nvoid upd(int &p, int l, int r, int x, int v, int u) &#123;\n    if (!p)\n        p = newnode();\n    if (l == r) &#123;\n        t[p].rv = v, t[p].u = u;\n        return;\n    &#125;\n    int mid = (l + r) >> 1;\n    if (x <= mid)\n        upd(lt, l, mid, x, v, u);\n    else\n        upd(rt, mid + 1, r, x, v, u);\n    pushup(p, l, r);\n    return;\n&#125;\nvoid merge(int &p, int q, int l, int r) &#123;\n    if (!p || !q) &#123;\n        p += q;\n        return;\n    &#125;\n    if (l == r) &#123;\n        t[p].rv = std::min(t[p].rv, t[q].rv);\n        t[p].u = std::max(t[p].u, t[q].u);\n        return;\n    &#125;\n    int mid = (l + r) >> 1;\n    merge(t[p].l, t[q].l, l, mid), merge(t[p].r, t[q].r, mid + 1, r);\n    pushup(p, l, r), tr.push_back(q);\n    return;\n&#125;\nint qv = inf;\nlong long ask(int p, int l, int r, int ql, int qr) &#123;\n    if (ql <= l && r <= qr) &#123;\n        auto s(askv(p, l, r, qv));\n        qv = std::min(qv, t[p].rv);\n        return s;\n    &#125;\n    int mid = (l + r) >> 1;\n    long long res = 0ll;\n    if (ql <= mid)\n        res = ask(lt, l, mid, ql, qr);\n    if (qr > mid)\n        res += ask(rt, mid + 1, r, ql, qr);\n    return res;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(\"ex_problem4.in\", \"r\", stdin);\n    std::freopen(\".out\", \"w\", stdout);\n#endif\n    int n, m;\n    std::cin >> n >> m;\n    std::vector&lt;std::vector&lt;int> > g(n + 1);\n    for (int i = 1, x, y; i < n; ++i) &#123;\n        std::cin >> x >> y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int> top(n + 1), fa(n + 1), siz(n + 1), son(n + 1), dep(n + 1);\n    std::function&lt;void(int, int)> DFS = [&](int x, int faa) &#123;\n        siz[x] = 1;\n        for (auto i : g[x])\n            if (i != faa) &#123;\n                fa[i] = x, dep[i] = dep[x] + 1;\n                DFS(i, x), siz[x] += siz[i];\n                if (siz[i] > siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    DFS = [&](int x, int topp) &#123;\n        top[x] = topp;\n        if (son[x])\n            DFS(son[x], topp);\n        for (auto i : g[x])\n            if (i != fa[x] && i != son[x])\n                DFS(i, i);\n        return;\n    &#125;;\n    DFS(1, 1);\n    auto getLCA = [&](int x, int y) &#123;\n        for (; top[x] != top[y]; x = fa[top[x]])\n            if (dep[top[y]] > dep[top[x]])\n                std::swap(x, y);\n        return (dep[x] < dep[y] ? x : y);\n    &#125;;\n    std::vector&lt;std::vector&lt;int> > d(n + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int> > > u(n + 1);\n    std::vector&lt;std::vector&lt;std::tuple&lt;int, int, int> > > q(n + 1);\n    int cnt = 0;\n    for (int i = 1; i <= m; ++i) &#123;\n        int op;\n        std::cin >> op;\n        if (op == 0) &#123;\n            int x, v;\n            std::cin >> x >> v;\n            q[x].emplace_back(++cnt, i, v);\n        &#125; else &#123;\n            int x, y, v;\n            std::cin >> x >> y >> v;\n            int faa = getLCA(x, y);\n            u[x].emplace_back(i, v), u[y].emplace_back(i, v);\n            if (fa[faa])\n                d[fa[faa]].emplace_back(v);\n        &#125;\n    &#125;\n    std::vector&lt;long long> res(cnt + 1);\n    std::vector&lt;std::vector&lt;int> > rt(2, std::vector&lt;int> (n + 1));\n    t[0].rv = inf;\n    DFS = [&](int x, int fa) &#123;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                merge(rt[0][x], rt[0][i], 1, lim);\n                merge(rt[1][x], rt[1][i], 1, lim);\n            &#125;\n        for (auto [t, v] : u[x]) &#123;\n            upd(rt[0][x], 1, lim, v, t, v);\n            upd(rt[1][x], 1, lim, lim - v + 1, t, v);\n        &#125;\n        for (auto v : d[x]) &#123;\n            upd(rt[0][x], 1, lim, v, inf, 0);\n            upd(rt[1][x], 1, lim, lim - v + 1, inf, 0);\n        &#125;\n        for (auto [id, t, v] : q[x]) &#123;\n            qv = t, res[id] = ask(rt[0][x], 1, lim, v, lim);\n            qv = t, res[id] += ask(rt[1][x], 1, lim, lim - v + 1, lim);\n            qv = t, res[id] -= ask(rt[0][x], 1, lim, v, v);\n        &#125;\n    &#125;;\n    DFS(1, -1);\n    for (int i = 1; i <= cnt; ++i)\n        std::cout << res[i] << '\\n';\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "çº¿æ®µæ ‘",
                "æ•°å­¦",
                "æ ‘ä¸Šå·®åˆ†"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20240111/",
            "url": "https://xsc062.netlify.app/20240111/",
            "title": "è§£é¢˜æŠ¥å‘Šï¼šGame with Probability Problem",
            "date_published": "2024-01-11T03:25:19.000Z",
            "content_html": "<p><a href=\"https://www.becoder.com.cn/contest/4665/problem/2\">SP4060 Game with Probability Problem</a>ã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<p>è®¾ <span class=\"math inline\">\\(f_i,g_i\\)</span> åˆ†åˆ«è¡¨ç¤ºè¿˜å‰© <span class=\"math inline\">\\(i\\)</span> ä¸ªçš„æ—¶å€™è½®åˆ° Alice å’Œ Bob æ—¶ <strong>Alice</strong> åˆ†åˆ«çš„èƒœç‡ã€‚</p>\n<p>æ¦‚ç‡ç»å…¸å€’æ¨ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ <span class=\"math inline\">\\(f_0=0,g_0=1\\)</span>ã€‚</p>\n<p>ç„¶åå°±æ˜¯ä¸€ä¸ªåˆ†è®¨ï¼Œè®¨è®ºè¿™ä¸ªäººæƒ³è¦æ­£é¢è¿˜æ˜¯åé¢ã€‚å¾ˆæ˜¾ç„¶ï¼Œå¯¹äºåŒæ ·çš„å‰©ä½™æ£‹å­æ•°ï¼Œä¸¤ä¸ªäººå…ˆæ‰‹çš„æƒ…å†µå¯¹äºè¿™é¢—æ£‹å­çš„å–œçˆ±ç¨‹åº¦æ˜¯ä¸€æ ·çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè¦ä¹ˆéƒ½æƒ³è¦ï¼Œè¦ä¹ˆéƒ½ä¸æƒ³è¦ã€‚</p>\n<p>ä»€ä¹ˆæ—¶å€™æƒ³è¦å‘¢ï¼Ÿæ‹¿æ‰è¿‡åè‡ªå·±èƒœç‡æ›´å¤§ï¼Œä¹Ÿå°±æ˜¯ <span class=\"math inline\">\\(g_{i-1}&gt;f_{i-1}\\)</span>ã€‚æ­¤æ—¶æœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_i=(1-p)\\times g_i+p\\times g_{i-1}\\\\\ng_i=(1-q)\\times f_i+q\\times f_{i-1}\n\\]</span></p>\n<p>å‘ç°æ˜¯äº’ç›¸å½±å“çš„ï¼Œè¿™ä¸ªæ—¶å€™å…ˆä¸è¦ç€æ€¥æ€€ç–‘è‡ªå·±æ¨é”™äº†ï¼Œå› ä¸ºæˆ‘ä»¬è¿™é‡Œæœ‰ä¸¤ä¸ªæœªçŸ¥æ•°ï¼Œåˆåˆšå¥½æœ‰ä¸¤ä¸ªæ–¹ç¨‹ï¼Œæš´è§£ä¸€ä¸‹å°±æœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_i=\\dfrac {(1-p)\\times q\\times f_{i-1}+p\\times g_{i-1}}{1-(1-p)(1-q)}\\\\\ng_i=\\dfrac {(1-q)\\times p\\times g_{i-1}+q\\times f_{i-1}}{1-(1-p)(1-q)}\n\\]</span></p>\n<p>ç„¶å <span class=\"math inline\">\\(g_{i-1}&lt;f_{i-1}\\)</span> çš„æƒ…å†µä¹Ÿå·®ä¸å¤šï¼ŒæŠŠæ‹¿çš„æ¦‚ç‡å’Œä¸æ‹¿çš„æ¦‚ç‡æ¢ä¸€ä¸‹ï¼š</p>\n<p><span class=\"math display\">\\[\nf_i=p\\times g_i+(1-p)\\times g_{i-1}\\\\\ng_i=q\\times f_i+(1-q)\\times f_{i-1}\n\\]</span></p>\n<p>è§£æ–¹ç¨‹ç»„æœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_i=\\dfrac {(1-q)\\times p\\times f_{i-1}+(1-p)\\times g_{i-1}}{1-p\\times q}\\\\\ng_i=\\dfrac {(1-p)\\times q\\times g_{i-1}+(1-q)\\times f_{i-1}}{1-p\\times q}\n\\]</span></p>\n<p>ç„¶åå°±å¯ä»¥å¼€å§‹ DP äº†ã€‚æœ€åçš„ç­”æ¡ˆå°±æ˜¯ <span class=\"math inline\">\\(f_{\\min(n,1000)}\\)</span>ã€‚</p>\n<p>è¿˜æœ‰ä¸ªé—®é¢˜å°±æ˜¯ <span class=\"math inline\">\\(n\\)</span> ç‰¹åˆ«å¤§ç„¶åè¿™ä¸ªçœ‹èµ·æ¥ä¹Ÿä¸å¤ªèƒ½çŸ©ä¹˜ï¼Œä½†æ˜¯è¿™ä¸ª DP å¼æœ‰ä¸ªå¥½å¤„æ˜¯å®ƒçš„å¢é•¿è¶‹åŠ¿æ˜¯æŒ‡æ•°çº§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ DP åˆ° <span class=\"math inline\">\\(1000\\)</span> å°±å¯ä»¥äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nnamespace XSC062 &#123;\nconst int maxn = 1e3 + 5;\nusing db = double;\ndb p, q;\nint T, n;\ndb f[maxn], g[maxn];\nint min(int x, int y) &#123;\n    return x &lt; y ? x : y;\n&#125;\nint main() &#123;\n    scanf(&quot;%d&quot;, &amp;T);\n    while (T--) &#123;\n        scanf(&quot;%d %lf %lf&quot;, &amp;n, &amp;p, &amp;q);\n        f[0] = .0, g[0] = 1.0;\n        for (int i = 1; i &lt;= n &amp;&amp; i &lt;= 1000; ++i) &#123;\n            if (g[i - 1] &gt; f[i - 1]) &#123;\n                f[i] = ((1 - p) * q * f[i - 1] + p * g[i - 1]) / (1 - (1 - p) * (1 - q));\n                g[i] = ((1 - q) * p * g[i - 1] + q * f[i - 1]) / (1 - (1 - p) * (1 - q));\n            &#125;\n            else &#123;\n                f[i] = ((1 - q) * p * f[i - 1] + (1 - p) * g[i - 1]) / (1 - p * q);\n                g[i] = ((1 - p) * q * g[i - 1] + (1 - q) * f[i - 1]) / (1 - p * q);\n            &#125;\n        &#125;\n        printf(&quot;%.6lf\\n&quot;, f[min(n, 1000)]);\n    &#125;\n    return 0;\n&#125;\n&#125; // namespace XSC062\nint main() &#123;\n    XSC062::main();\n    return 0;\n&#125;\n</code></pre>\n</details>\n",
            "tags": [
                "DP",
                "æ•°å­¦"
            ]
        }
    ]
}