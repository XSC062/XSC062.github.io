<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://xsc062.netlify.app</id>
    <title> â€¢ Posts by &#34;å­—ç¬¦ä¸²&#34; tag</title>
    <link href="https://xsc062.netlify.app" />
    <updated>2025-08-09T04:33:17.000Z</updated>
    <category term="å¹¶æŸ¥é›†" />
    <category term="æ–œç‡ä¼˜åŒ–" />
    <category term="æ‚¬çº¿æ³•" />
    <category term="å“ˆå¸Œ" />
    <category term="å­—å…¸æ ‘" />
    <category term="DP" />
    <category term="å•è°ƒé˜Ÿåˆ—" />
    <category term="åˆ†æ²»" />
    <category term="äºŒåˆ†å›¾" />
    <category term="CRT / exCRT" />
    <category term="æ’åˆ—ç»„åˆ" />
    <category term="ç½‘ç»œæµ" />
    <category term="è´¹ç”¨æµ" />
    <category term="äºŒåˆ†" />
    <category term="ä¸Šä¸‹ç•Œç½‘ç»œæµ" />
    <category term="å®¹æ–¥åŸç†" />
    <category term="çº¿æ®µæ ‘" />
    <category term="æ ‘çŠ¶æ•°ç»„" />
    <category term="åŒºé—´ DP" />
    <category term="æ„é€ " />
    <category term="Tarjan" />
    <category term="æ•°æ®ç»“æ„" />
    <category term="ä¸‹é¥­" />
    <category term="LCA" />
    <category term="å€å¢" />
    <category term="é¸½å·¢åŸç†" />
    <category term="æ¦‚ç‡æœŸæœ›" />
    <category term="è°ƒå’Œçº§æ•°" />
    <category term="å·®åˆ†" />
    <category term="æ€ç»´" />
    <category term="æ ‘å½¢ DP" />
    <category term="æœ€å°ç”Ÿæˆæ ‘" />
    <category term="SAM" />
    <category term="çŠ¶å‹" />
    <category term="åˆ†å—" />
    <category term="å¯æŒä¹…åŒ–" />
    <category term="ç¬›å¡å°”æ ‘" />
    <category term="é«˜ç»´å‰ç¼€å’Œ" />
    <category term="é—²è¯" />
    <category term="æ¬§æ‹‰å›è·¯" />
    <category term="æ ‘é“¾å‰–åˆ†" />
    <category term="é•¿é“¾å‰–åˆ†" />
    <category term="KMP" />
    <category term="border" />
    <category term="å­—ç¬¦ä¸²" />
    <category term="AC è‡ªåŠ¨æœº" />
    <category term="SA" />
    <category term="æ•°å­¦" />
    <category term="æ ‘ä¸Šå·®åˆ†" />
    <category term="FWT" />
    <category term="å †" />
    <category term="æ ‘çš„é‡å¿ƒ" />
    <category term="äºŒé¡¹å¼å®šç†" />
    <category term="äºŒé¡¹å¼åæ¼”" />
    <category term="è´ªå¿ƒ" />
    <category term="å‡æ‘Š" />
    <category term="è®¡æ•°" />
    <category term="ä¼˜åŒ–å»ºå›¾" />
    <category term="åæ‚”è´ªå¿ƒ" />
    <category term="è°ƒæ•´æ³•" />
    <category term="èƒŒåŒ…" />
    <category term="åšå¼ˆè®º" />
    <category term="DP ä¼˜åŒ–" />
    <category term="è™šæ ‘" />
    <category term="ç‚¹åˆ†æ²»" />
    <category term="WQS äºŒåˆ†" />
    <category term="é—µå¯å¤«æ–¯åŸºå’Œ" />
    <category term="slope trick" />
    <category term="å››è¾¹å½¢ä¸ç­‰å¼" />
    <category term="æš´åŠ›" />
    <category term="çŠ¶å‹ DP" />
    <category term="ç»„åˆæ•°å­¦" />
    <category term="æ”¯é…å¯¹" />
    <category term="DDP" />
    <category term="å¹³è¡¡æ ‘" />
    <category term="å®¹æ–¥" />
    <category term="çŒ«æ ‘" />
    <category term="Kruskal é‡æ„æ ‘" />
    <category term="æè¶…çº¿æ®µæ ‘" />
    <entry>
        <id>https://xsc062.netlify.app/20250809/</id>
        <title>è¿‘æœŸæ‚é¢˜</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250809/"/>
        <content type="html">&lt;p&gt;è¿™æ®µæ—¶é—´æ¯”èµ›çš„ä¸€äº›é¢˜ å’Œ nKessiã€duanyu è®²çš„é¢˜ç›®ã€‚å¤ªåè®¡æ•°ã€æ•°å­¦çš„åŸºæœ¬ä¸Šæ²¡åŠæ³•åšäº†ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a.-å‡ºå…³&#34;&gt;A. å‡ºå…³&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6462/problem/1&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6462/problem/1&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œå¯¹äºä¸€ä¸ªç©ºä¸²ï¼Œä»»æ„åˆ©ç”¨ä¸‹åˆ—ä¸‰ç§æ“ä½œï¼Œä½¿å…¶å˜ä¸º &lt;span class=&#34;math inline&#34;&gt;\(s\)&lt;/span&gt;ï¼Œæ±‚æœ€å°ä»£ä»·ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;åœ¨æœ«å°¾æ·»åŠ å­—ç¬¦ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_{0,c}\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;å¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²å¹¶ç²˜è´´åœ¨æœ«å°¾ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_1\)&lt;/span&gt;ï¼›&lt;/li&gt;
&lt;li&gt;åˆ é™¤æœ«å°¾å­—ç¬¦ï¼Œä»£ä»·ä¸º &lt;span class=&#34;math inline&#34;&gt;\(t_2\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(|s|\le 10^6\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯ä»¥é¢„å¤„ç†å‡ºå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»“å°¾ï¼Œæœ€å¤šå¯ä»¥å¤åˆ¶åˆ°å“ªä¸ªåœ°æ–¹ï¼Œå‘ç°è¦æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(z_i=lcp(s_{1\dots n},s_{i+1\dots n})\)&lt;/span&gt;ã€‚é‚£ä¹ˆä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æœ€è¿œè½¬ç§»ç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(r_i=i+z_{i+1}\)&lt;/span&gt;ï¼Œç”¨å•è°ƒé˜Ÿåˆ—å°±èƒ½ç»´æŠ¤ï¼Œä¼š exkmp å°±èƒ½çº¿æ€§ï¼›&lt;/p&gt;
&lt;p&gt;å¦åˆ™å¯ä»¥äºŒåˆ† + å“ˆå¸Œå¤šä¸ª logï¼Œåé¢ä¹Ÿæœ‰ç†ç”±å·æ‡’ç”¨ä¼˜å…ˆé˜Ÿåˆ—äº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int p = 31;
const int mod = 998244353;
int main() &amp;#123;
    std::freopen(&amp;quot;laozi.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;laozi.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    int n = (int)s.length(), t1, t2;
    std::vector&amp;lt;long long&amp;gt; h(n + 1), base(n + 1);
    std::vector&amp;lt;int&amp;gt; a(n + 1), t0(27), z(n + 1), r(n + 1);
    base[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        a[i] = s[i - 1] - &amp;#39;a&amp;#39; + 1;
        h[i] = (h[i - 1] * p + a[i]) % mod;
        base[i] = base[i - 1] * p % mod;
    &amp;#125;
    auto gethash = [&amp;amp;](int l, int r) &amp;#123;
        return (h[r] - h[l - 1] * base[r - l + 1] % mod + mod) % mod;
    &amp;#125;;
    for (int i = 1; i &amp;lt;= n; ++i)
        for (int l = 1, r = std::min(i - 1, n - i + 1), mid; l &amp;lt;= r; ) &amp;#123;
            mid = (l + r) &amp;gt;&amp;gt; 1;
            if (gethash(1, mid) == gethash(i, i + mid - 1))
                z[i] = mid, l = mid + 1;
            else
                r = mid - 1;
        &amp;#125;
    for (int i = 1; i &amp;lt; n; ++i)
        r[i] = i + std::min(i, z[i + 1]);
    for (int i = 1; i &amp;lt;= 26; ++i)
        std::cin &amp;gt;&amp;gt; t0[i];
    std::cin &amp;gt;&amp;gt; t1 &amp;gt;&amp;gt; t2;
    std::vector&amp;lt;long long&amp;gt; f(n + 1);
    std::priority_queue&amp;lt;std::pair&amp;lt;long long, int&amp;gt; &amp;gt; q;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        f[i] = f[i - 1] + t0[a[i]];
        for (; !q.empty() &amp;amp;&amp;amp; r[q.top().second] &amp;lt; i; q.pop());
        if (!q.empty())
            f[i] = std::min(f[i], t1 - q.top().first - (long long)t2 * i);
        if (i != n)
            q.emplace(-(f[i] + 2ll * t2 * i), i);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; f[n] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d.-éæ”»&#34;&gt;D. éæ”»&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://222.180.160.110:61235/contest/6462/problem/4&#34; class=&#34;uri&#34;&gt;http://222.180.160.110:61235/contest/6462/problem/4&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œå¯¹äºä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; çš„æ’åˆ—ï¼Œä½¿ç”¨æœ€å°çš„äº¤æ¢æ¬¡æ•°ä½¿å¾—å…¶å•å¢ã€‚åœ¨è¯¥å‰æä¸‹ï¼Œå®šä¹‰ä»£ä»·ä¸ºæ¯æ¬¡äº¤æ¢çš„ä¸¤ä¸ªæ•°ä¹‹ç§¯ã€‚å¯¹äºæ‰€æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n!\)&lt;/span&gt; ä¸ªæ’åˆ—ï¼Œè®¡ç®—æœ€å°ä»£ä»·ä¹‹å’Œã€‚&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math inline&#34;&gt;\(n\le 10^7\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è½¬åŒ–æˆï¼ŒæŠŠ &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; åˆ†æˆæ— æ ‡å·çš„è‹¥å¹²ç»„ï¼Œæ¯ç»„çš„ä»£ä»·æ˜¯ æœ€å°å€¼ &lt;span class=&#34;math inline&#34;&gt;\(\times\)&lt;/span&gt; å…¶ä»–å…ƒç´ çš„å’Œï¼Œè¿˜æœ‰ä¸€ä¸ªé¡¹é“¾é—®é¢˜çš„ç³»æ•°ï¼Œå‘ç°ç»„é—´çš„ç¬¦å·æ˜¯æ±‚å’Œï¼Œè€ƒè™‘è®¡ç®—è´¡çŒ®ã€‚&lt;/p&gt;
&lt;p&gt;æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(i,j\)&lt;/span&gt; å¹¶é’¦å®šä¸¤ä¸ªåŒå±ä¸€ä¸ªç¯ï¼Œä¸” &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ºæœ€å°å€¼ï¼Œæšä¸¾ç¯å¤§å° &lt;span class=&#34;math inline&#34;&gt;\(s+2\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
\begin{aligned}
res&amp;amp;=\sum_{i=1}^{n-1}\sum_{j=i+1}^n i\cdot j \cdot \sum_{s=0}^{n-i-1}\binom{n-i-1}s \cdot (s+1)!\cdot (n-s-2)!\\
&amp;amp;=\sum_{i=1}^{n-1}i\cdot \dfrac {(i+n+1)(n-i)}2 \cdot \sum_{s=0}^{n-i-1}\binom{n-i-1}s\cdot (s+1)!\cdot (n-s-2)!\\
&amp;amp;=\frac 12\times\sum_{i=1}^{n-1}i\cdot (i+n+1)\cdot (n-i)!\cdot\sum_{s=0}^{n-i-1}\dfrac {(s + 1)\cdot (n-s-2)!}{(n-i-1-s)!}\\
\end{aligned}
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(T=n-i-1\)&lt;/span&gt;ï¼Œå‘ç°æˆ‘ä»¬éœ€è¦å¿«é€Ÿè®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(f_T=\sum\limits_{i=0}^T \dfrac{(i+1)\cdot (n-i-2)!}{(T-i)!}\)&lt;/span&gt;ã€‚è®° &lt;span class=&#34;math inline&#34;&gt;\(m=n-2\)&lt;/span&gt;ï¼Œå˜å½¢å¾— &lt;span class=&#34;math inline&#34;&gt;\(f_T=(m-T)!\cdot \sum\limits_{i=0}^{T} (i+1) \binom{m-i}{m-T}\)&lt;/span&gt;ï¼Œå‘ç°ä¼¼ä¹å¯ä»¥ç®€åŒ–ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(k=m-T,t=T+1\)&lt;/span&gt;ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_T=\sum\limits_{i=1}^T i\cdot \binom {k+t-i}k\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæ˜¯ç»å…¸çš„ç»„åˆæ„ä¹‰ä¿å¹³å®‰ç¯èŠ‚ï¼Œå³ä» &lt;span class=&#34;math inline&#34;&gt;\(k+t\)&lt;/span&gt; ä¸ªæœ‰æ ‡å·å°çƒä¸­é€‰æ‹©ä¸€æ¡åˆ†ç•Œçº¿ï¼Œåˆ†ç•Œçº¿å·¦è¾¹é€‰ä¸€ä¸ªçƒã€å³è¾¹é€‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªçƒçš„æ–¹æ¡ˆæ•°ã€‚å‘ç°åˆ†ç•Œçº¿çš„å­˜åœ¨å¾ˆè¯¡å¼‚ï¼Œæ•…ç”¨åˆ†ç•Œçº¿åæ–¹çš„ç¬¬ä¸€ä¸ªçƒä»£æ›¿ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t+1\)&lt;/span&gt; å¤„æ–°å»ºä¸€ä¸ªè™šçƒï¼Œè§„å®šåœ¨å‰ &lt;span class=&#34;math inline&#34;&gt;\(t+1\)&lt;/span&gt; ä¸ªçƒä¸­é€‰ä¸¤ä¸ªçƒï¼Œå¹¶ä»¤åä¸€ä¸ªä¸ºåˆ†ç•Œçº¿ï¼Œä¸”ä»¤å‰ &lt;span class=&#34;math inline&#34;&gt;\(t+1\)&lt;/span&gt; ä¸ªä¸­çš„å…¶ä»–çƒä¸ºå®çƒï¼Œå°±èƒ½å»ºç«‹åŒå°„ã€‚åœ¨åˆ†ç•Œçº¿åå†é€‰ &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; ä¸ªçƒï¼Œå®¹æ˜“å‘ç°ç›´æ¥åœ¨èŒƒå›´å†…é€‰ &lt;span class=&#34;math inline&#34;&gt;\(k+2\)&lt;/span&gt; ä¸ªçƒå°±èƒ½æ»¡è¶³æ¡ä»¶ï¼Œæ•… &lt;span class=&#34;math inline&#34;&gt;\(f_T=(n-T-2)!\cdot \binom{t+k+1}{k+2}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 1e9 + 7;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
    std::freopen(&amp;quot;mozi.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;mozi.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;long long&amp;gt; fac(n + 1), inv(n + 1), f(n + 1);
    fac[0] = inv[0] = 1ll;
    for (int i = 1; i &amp;lt;= n; ++i)
        fac[i] = fac[i - 1] * i % mod;
    auto qkp = [&amp;amp;](long long x, int y) &amp;#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &amp;gt;&amp;gt;= 1)
            if (y &amp;amp; 1)
                (res *= x) %= mod;
        return res;
    &amp;#125;;
    inv[n] = qkp(fac[n], mod - 2);
    for (int i = n - 1; i; --i)
        inv[i] = inv[i + 1] * (i + 1) % mod;
    auto C = [&amp;amp;](int n, int m) &amp;#123;
        return fac[n] * inv[n - m] % mod * inv[m] % mod;
    &amp;#125;;
    int m = n - 2;
    for (int T = 0; T &amp;lt;= n - 2; ++T) &amp;#123;
        int k = m - T, t = T + 1;
        f[T] = C(t + k + 1, k + 2) * fac[m - T] % mod;
    &amp;#125;
    auto res = 0ll;
    for (int i = 1; i &amp;lt;= n - 1; ++i)
        (res += (long long)i * (i + n + 1) % mod * fac[n - i] % mod * f[n - i - 1] % mod) %= mod;
    std::cout &amp;lt;&amp;lt; res * inv[2] % mod &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---destruction-of-walls&#34;&gt;C - Destruction of Walls&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc203/tasks/arc203_c&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc203/tasks/arc203_c&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---insert-xor&#34;&gt;D - Insert XOR&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://atcoder.jp/contests/arc203/tasks/arc203_d&#34; class=&#34;uri&#34;&gt;https://atcoder.jp/contests/arc203/tasks/arc203_d&lt;/a&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;a---è®°å¿†&#34;&gt;A - è®°å¿†&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://ac.nowcoder.com/acm/problem/274793&#34; class=&#34;uri&#34;&gt;https://ac.nowcoder.com/acm/problem/274793&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;éœ€è¦æ„è¯†åˆ°é—®é¢˜æ˜¯é™æ€çš„ï¼Œå¹¶ä¸”ä¸èƒ½ç”¨çº¿æ®µæ ‘ä¹‹ç±»ç»´æŠ¤ï¼›æ•…è€ƒè™‘ç¦»çº¿ä¸‹æ¥ï¼Œæƒ³åŠæ³•åœ¨ LCA å¤„ç»Ÿè®¡ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªæ—¶å€™å‘ç°éœ€è¦åˆå¹¶å­æ ‘çŠ¶æ€ã€æ•´ä½“å¼‚æˆ–ã€æ•´ä½“ +1ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° Trieã€‚æŠŠ &lt;span class=&#34;math inline&#34;&gt;\(u\to\)&lt;/span&gt; LCA çš„ç­”æ¡ˆä¿å­˜åœ¨ LCA å¤„ï¼Œç„¶åå†ç”¨ DFS + å›æº¯ç»Ÿè®¡ LCA &lt;span class=&#34;math inline&#34;&gt;\(\to v\)&lt;/span&gt; çš„ç­”æ¡ˆã€‚æƒ³äº†åŠå¤©æ²¡æƒ³åˆ°æŠŠä¸Šä¸‹æ‹†å¼€æ¥åšä¹Ÿæ˜¯ç¥äº† ğŸ˜…&lt;/p&gt;
&lt;p&gt;å¯èƒ½æ¯”è¾ƒè€ƒéªŒå¯¹å­—å…¸æ ‘çš„ç†è§£ï¼Ÿåšä¸ªæ¯”å–»ï¼Œå­—å…¸æ ‘çš„ id å°±ç›¸å½“äºå¯¹è¿™ä¸ªç‚¹ä¸Šä¿¡æ¯çš„ã€å¼•ç”¨ã€ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å­—å…¸æ ‘åˆå¹¶çš„æ—¶å€™å¯ä»¥è€ƒè™‘å›æ”¶åºŸå¼ƒç‚¹ï¼Œä¸ç„¶å¯èƒ½æœ‰ç‚¹å¡ã€‚&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int X = 50;
const int maxn = 2e7 + 5;
long long d[maxn];
int tot, T[maxn][2], f[maxn], fa[maxn];
#define lc(p) T[p][0]
#define rc(p) T[p][1]
int find(int x) &amp;#123; return x == f[x] ? x : f[x] = find(f[x]); &amp;#125;
int newnode(void) &amp;#123;
    int p = ++tot;
    assert(p &amp;lt; maxn);
    d[p] = lc(p) = rc(p) = 0, f[p] = p;
    return p;
&amp;#125;
void pushdown(int p) &amp;#123;
    if (d[p]) &amp;#123;
        if (d[p] &amp;amp; 1)
            std::swap(lc(p), rc(p));
        d[p] &amp;gt;&amp;gt;= 1;
        if (lc(p))
            d[lc(p)] ^= d[p];
        if (rc(p))
            d[rc(p)] ^= d[p];
        d[p] = 0;
    &amp;#125;
    return;
&amp;#125;
int ins(int p, long long x) &amp;#123;
    for (int i = 0; i &amp;lt; X; ++i) &amp;#123;
        pushdown(p);
        if (!T[p][(x &amp;gt;&amp;gt; i) &amp;amp; 1]) &amp;#123;
            T[p][(x &amp;gt;&amp;gt; i) &amp;amp; 1] = newnode();
            fa[T[p][(x &amp;gt;&amp;gt; i) &amp;amp; 1]] = p;
        &amp;#125;
        p = T[p][(x &amp;gt;&amp;gt; i) &amp;amp; 1];
    &amp;#125;
    return p;
&amp;#125;
void merge(int &amp;amp;p, int q) &amp;#123;
    if (!q)
        return;
    if (!p) &amp;#123;
        p = q;
        return;
    &amp;#125;
    pushdown(p), pushdown(q);
    fa[lc(q)] = p, fa[rc(q)] = p;
    merge(lc(p), lc(q)), merge(rc(p), rc(q));
    assert(f[p] == p), assert(f[q] == q), f[q] = p;
    return;
&amp;#125;
long long ask(int p) &amp;#123;
    std::vector&amp;lt;int&amp;gt; st;
    for (int i = 0, j = p; i &amp;lt; X; ++i)
        st.push_back(fa[j]), j = fa[j];
    for (int i = 0; i &amp;lt; X; ++i)
        pushdown(st.back()), st.pop_back();
    long long x = 0;
    for (int i = 0; i &amp;lt; X; ++i) &amp;#123;
        x = x * 2 + (p == rc(fa[p]));
        p = fa[p];
    &amp;#125;
    return x;
&amp;#125;
void add(int p) &amp;#123;
    for (int i = 0; p &amp;amp;&amp;amp; i &amp;lt; X; ++i) &amp;#123;
        pushdown(p);
        std::swap(lc(p), rc(p));
        p = lc(p);
    &amp;#125;
    return;
&amp;#125;
void del(int p) &amp;#123;
    for (int i = 0; p &amp;amp;&amp;amp; i &amp;lt; X; ++i) &amp;#123;
        pushdown(p);
        std::swap(lc(p), rc(p));
        p = rc(p);
    &amp;#125;
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; siz(n + 1), son(n + 1), top(n + 1), fa(n + 1), dep(n + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        siz[x] = 1;
        for (auto i : g[x])
            if (i != fa[x]) &amp;#123;
                dep[i] = dep[x] + 1;
                fa[i] = x, DFS(i);
                siz[x] += siz[i];
                if (siz[i] &amp;gt; siz[son[x]])
                    son[x] = i;
            &amp;#125;
        return;
    &amp;#125;;
    DFS(1);
    DFS = [&amp;amp;](int x) &amp;#123;
        if (son[x])
            top[son[x]] = top[x], DFS(son[x]);
        for (auto i : g[x])
            if (i != son[x] &amp;amp;&amp;amp; i != fa[x])
                top[i] = i, DFS(i);
        return;
    &amp;#125;;
    top[1] = 1, DFS(1);
    auto askLCA = [&amp;amp;](int x, int y) &amp;#123;
        for (; top[x] != top[y]; x = fa[top[x]])
            if (dep[top[x]] &amp;lt; dep[top[y]])
                std::swap(x, y);
        return dep[x] &amp;lt; dep[y] ? x : y;
    &amp;#125;;
    struct node &amp;#123; long long x; int u, v; &amp;#125;;
    std::vector&amp;lt;node&amp;gt; q(m + 1);
    std::vector&amp;lt;int&amp;gt; id(m + 1);
    std::vector&amp;lt;long long&amp;gt; res(m + 1), ans(m + 1);
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; up(n + 1), dn(n + 1), ed(n + 1);
    for (int i = 1, x, u, v; i &amp;lt;= m; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; u &amp;gt;&amp;gt; v;
        q[i] = &amp;#123; x, u, v &amp;#125;;
        up[u].push_back(i), dn[askLCA(u, v)].push_back(i), ed[v].push_back(i);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; rt(n + 1);
    DFS = [&amp;amp;](int x) &amp;#123;
        rt[x] = newnode();
        for (auto i : g[x])
            if (i != fa[x]) &amp;#123;
                DFS(i);
                merge(rt[x], rt[i]);
            &amp;#125;
        add(rt[x]);
        for (auto i : up[x])
            id[i] = ins(rt[x], q[i].x);
        d[rt[x]] ^= a[x];
        for (auto i : dn[x])
            res[i] = ask(find(id[i]));
        return;
    &amp;#125;;
    DFS(1);
    tot = 0, rt[0] = newnode();
    std::fill(id.begin() + 1, id.end(), 0);
    DFS = [&amp;amp;](int x) &amp;#123;
        d[rt[0]] ^= a[x];
        for (auto i : dn[x])
            id[i] = ins(rt[0], res[i]);
        for (auto i : ed[x])
            ans[i] = ask(id[i]);
        add(rt[0]);
        for (auto i : g[x])
            if (i != fa[x])
                DFS(i);
        del(rt[0]);
        d[rt[0]] ^= a[x];
        return;
    &amp;#125;;
    DFS(1);
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; ans[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;b---ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ-2-meetings-2&#34;&gt;B - ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ 2 (Meetings 2)&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/AT_joisc2021_j&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/AT_joisc2021_j&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å®šä¹‰æ‰€æ±‚ç‚¹ä¸ºã€å±€éƒ¨é‡å¿ƒã€ï¼›ç±»ä¼¼æ ‘çš„é‡å¿ƒï¼Œå®¹æ˜“å‘ç°å½“å…³é”®ç‚¹æ•°é‡ä¸ºå¥‡æ—¶ï¼Œåªå­˜åœ¨ä¸€ä¸ªå±€éƒ¨é‡å¿ƒï¼›å¦åˆ™ï¼Œå±€éƒ¨é‡å¿ƒç»„æˆä¸€æ¡é“¾ã€‚&lt;/p&gt;
&lt;p&gt;å³å¯¹äºæ¯ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt;ï¼Œéœ€è¦æ‰¾åˆ°ä¸€æ¡æœ€é•¿é“¾ï¼Œä½¿å¾—å…¶ä¸¤ç«¯å­˜åœ¨å¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„å­æ ‘ï¼ˆå®¹æ˜“å‘ç°å–åç¼€ max å³å¯å¾—åˆ°çœŸå®ç­”æ¡ˆï¼‰ã€‚ä½¿ç”¨ç‚¹åˆ†æ²»ï¼Œç²¾ç»†å®ç°å®¹æ˜“åšåˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
    for (int i = 1, x, y; i &amp;lt; n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; mx(n + 1), siz(n + 1), p, tag(n + 1), res(n + 1, 1);
    std::function&amp;lt;void(int, int)&amp;gt; DFS1 = [&amp;amp;](int x, int fa) &amp;#123;
        p.push_back(x);
        siz[x] = 1, mx[x] = 0;
        for (auto i : g[x])
            if (!tag[i] &amp;amp;&amp;amp; i != fa) &amp;#123;
                DFS1(i, x);
                siz[x] += siz[i];
                mx[x] = std::max(mx[x], siz[i]);
            &amp;#125;
        return;
    &amp;#125;;
    auto findrt = [&amp;amp;](int x) &amp;#123;
        p.clear(), DFS1(x, -1);
        int n = (int)p.size();
        for (auto i : p)
            if (mx[i] &amp;lt;= n / 2 &amp;amp;&amp;amp; n - siz[i] &amp;lt;= n / 2)
                return i;
        assert(0);
        return -1;
    &amp;#125;;
    struct node &amp;#123;
        int u1, u2, id1, id2;
        node(): u1(0), u2(0), id1(0), id2(0) &amp;#123;&amp;#125;
        void upd(int u, int id) &amp;#123;
            if (id1 == id)
                u1 = std::max(u1, u);
            else if (u &amp;gt;= u1)
                u2 = u1, id2 = id1, u1 = u, id1 = id;
            else if (u &amp;gt;= u2)
                u2 = u, id2 = id;
            return;
        &amp;#125;
    &amp;#125;;
    std::vector&amp;lt;node&amp;gt; s(n + 1);
    std::function&amp;lt;void(int, int, int, int)&amp;gt; DFS2 = [&amp;amp;](int x, int fa, int dep, int anc) &amp;#123;
        s[siz[x]].upd(dep, anc);
        for (auto i : g[x])
            if (!tag[i] &amp;amp;&amp;amp; i != fa)
                DFS2(i, x, dep + 1, anc);
        return;
    &amp;#125;;
    std::function&amp;lt;void(int, int, int, int)&amp;gt; DFS3 = [&amp;amp;](int x, int fa, int dep, int anc) &amp;#123;
        int v = ((s[siz[x]].id1 == anc) ? s[siz[x]].u2 : s[siz[x]].u1);
        res[2 * siz[x]] = std::max(res[2 * siz[x]], dep + 1 + v);
        for (auto i : g[x])
            if (!tag[i] &amp;amp;&amp;amp; i != fa)
                DFS3(i, x, dep + 1, anc);
        return;
    &amp;#125;;
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        x = findrt(x), p.clear(), DFS1(x, -1);
        // printf(&amp;quot;rt = %d\n&amp;quot;, x);
        for (auto i : g[x])
            if (!tag[i])
                DFS2(i, x, 1, i);
        for (int i = siz[x] - 1; i; --i) &amp;#123;
            s[i].upd(s[i + 1].u1, s[i + 1].id1);
            s[i].upd(s[i + 1].u2, s[i + 1].id2);
        &amp;#125;
        for (auto i : g[x])
            if (!tag[i])
                DFS3(i, x, 1, i);
        tag[x] = 1;
        for (int i = 1; i &amp;lt; siz[x]; ++i)
            s[i] = node();
        for (auto i : g[x])
            if (!tag[i])
                DFS(i);
        return;
    &amp;#125;;
    DFS(1);
    for (int i = (n &amp;gt;&amp;gt; 1) * 2; i; --i)
        if (i + 2 &amp;lt;= n)
            res[i] = std::max(res[i], res[i + 2]);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;c---the-closest-pair&#34;&gt;C - The Closest Pair&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://ac.nowcoder.com/acm/problem/262593&#34; class=&#34;uri&#34;&gt;https://ac.nowcoder.com/acm/problem/262593&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å¸¸è§„æ–¹æ³•&lt;/strong&gt;ï¼šè€ƒè™‘&lt;strong&gt;æ”¯é…å¯¹&lt;/strong&gt;ï¼Œå¯¹äºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_i\)&lt;/span&gt;ï¼Œæ‰¾åˆ°æ‰€æœ‰åˆæ³•çš„ &lt;span class=&#34;math inline&#34;&gt;\(a_j\)&lt;/span&gt;ã€‚å®¹æ˜“æƒ³åˆ°æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(a_i\div a_j\)&lt;/span&gt; æ¥åšï¼›å‡è®¾å­˜åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(a_k\div a_i=a_j\div a_i\)&lt;/span&gt; ä¸” &lt;span class=&#34;math inline&#34;&gt;\(k&amp;gt;j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸å¦¨è®¾ &lt;span class=&#34;math inline&#34;&gt;\(a_j=K\cdot a_i+p,a_k=K\cdot a_i+q\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((a_i,a_j),(a_i,a_k)\)&lt;/span&gt; å‡åˆæ³•å½“ä¸”ä»…å½“ä¸‹åˆ—æ¡ä»¶å…¨éƒ¨æˆç«‹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_j\bmod a_i&amp;gt;a_k\bmod a_i\)&lt;/span&gt;ï¼› åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(a_j&amp;gt;a_k\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(a_j\bmod a_k&amp;gt;a_k\bmod a_i\)&lt;/span&gt;ï¼›åˆ &lt;span class=&#34;math inline&#34;&gt;\(p-q\ge a_j\bmod a_k\)&lt;/span&gt;ï¼ˆ&lt;strong&gt;å¤ªç‰›äº†è¿™ä¸€æ­¥&lt;/strong&gt;ï¼‰ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(p-q&amp;gt;q\iff p&amp;gt;2q\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¯å¾—åªå…³å¿ƒåŒä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(a_j\div a_i\)&lt;/span&gt; æ—¶çš„æ”¯é…å¯¹æ•°é‡ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\log n\)&lt;/span&gt; çº§åˆ«ï¼›æ€»å¯¹æ•° &lt;span class=&#34;math inline&#34;&gt;\(O(n\log n\ln n)\)&lt;/span&gt;ã€‚ç¦»çº¿ä¸‹æ¥æ‰«æçº¿å°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å¯¹ç€ å•ç‚¹ä¿®æ”¹ åŒºé—´æœ€å€¼ æƒ³äº† 1h çš„å• log åšæ³• ğŸ˜° æœç„¶å°è„‘æ‰çº¿å¤ªå¯æ€•äº†ï¼Œç¬¬äºŒå¤©æ—©ä¸Šé‡ç½®å¤§è„‘ 1s å‘ç°è‡ªå·±æ˜¯æ–¯æ³¢ ğŸ˜“&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int LEN = (1 &amp;lt;&amp;lt; 20);
int nec(void) &amp;#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &amp;#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &amp;#125;
    return *p++;
&amp;#125;
bool read(int &amp;amp;x) &amp;#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &amp;lt; &amp;#39;0&amp;#39; || ch &amp;gt; &amp;#39;9&amp;#39;) &amp;#123;
        if (ch == EOF) return 0;
        if (ch == &amp;#39;-&amp;#39;) f = 1;
        ch = nec();
    &amp;#125;
    while (ch &amp;gt;= &amp;#39;0&amp;#39; &amp;amp;&amp;amp; ch &amp;lt;= &amp;#39;9&amp;#39;) &amp;#123;
        x = x * 10 + ch - &amp;#39;0&amp;#39;;
        ch = nec();
    &amp;#125;
    if (f) x = -x;
    return 1;
&amp;#125;
void print(int x) &amp;#123;
    if (x &amp;lt; 0)
        putchar(&amp;#39;-&amp;#39;), x = -x;
    if (x &amp;gt;= 10) print(x / 10);
    putchar(x % 10 + &amp;#39;0&amp;#39;);
    return;
&amp;#125;
void print(int x, char ch) &amp;#123;
    print(x), putchar(ch);
    return;
&amp;#125;
const int maxn = 4e6 + 5;
struct &amp;#123; int l, r, u[2]; &amp;#125; t[maxn];
#define lt (t[p].l)
#define rt (t[p].r)
int tot[2];
void add(int &amp;amp;p, int l, int r, int x, int v, int i) &amp;#123;
    if (!p)
        p = ++tot[i], t[p].u[0] = -1, t[p].u[1] = 0x3f3f3f3f;
    if (i == 0)
        t[p].u[0] = std::max(t[p].u[0], v);
    else
        t[p].u[1] = std::min(t[p].u[1], v);
    if (l == r)
        return;
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (x &amp;lt;= mid)
        add(lt, l, mid, x, v, i);
    else
        add(rt, mid + 1, r, x, v, i);
    return;
&amp;#125;
int ask(int p, int l, int r, int ql, int qr, int i) &amp;#123;
    if (!p || (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr))
        return t[p].u[i];
    int mid = (l + r) &amp;gt;&amp;gt; 1;
    if (qr &amp;lt;= mid)
        return ask(lt, l, mid, ql, qr, i);
    if (ql &amp;gt; mid)
        return ask(rt, mid + 1, r, ql, qr, i);
    if (i == 0)
        return std::max(ask(lt, l, mid, ql, qr, 0), ask(rt, mid + 1, r, ql, qr, 0));
    return std::min(ask(lt, l, mid, ql, qr, 1), ask(rt, mid + 1, r, ql, qr, 1));
&amp;#125;
#undef lt
#undef rt
int main() &amp;#123;
#ifndef ONLINE_JUDGE
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    const int m = 1e6;
    int rt[2] = &amp;#123; 0 &amp;#125;, n;
    t[0].u[0] = -1, t[0].u[1] = 0x3f3f3f3f;
    read(n);
    std::vector&amp;lt;int&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        read(a[i]);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        if (i != 1) &amp;#123;
            for (int K = a[i]; K &amp;lt;= m; K += a[i]) &amp;#123;
                for (int mx = std::min(a[i] - 1, m - K); ; ) &amp;#123;
                    int k = ask(rt[0], 1, m, K, K + mx, 0);
                    if (k == -1)
                        break;
                    t[i].emplace_back(k, a[k] - K);
                    if (k == 1 || !(a[k] - K))
                        break;
                    mx = (a[k] - K - 1) / 2;
                &amp;#125;
            &amp;#125;
        &amp;#125;
        add(rt[0], 1, m, a[i], i, 0);
    &amp;#125;
    for (int i = n; i; --i) &amp;#123;
        if (i != n)
            for (int K = a[i]; K &amp;lt;= m; K += a[i])
                for (int mx = std::min(a[i] - 1, m - K); ; ) &amp;#123;
                    int k = ask(rt[1], 1, m, K, K + mx, 1);
                    if (k == 0x3f3f3f3f)
                        break;
                    t[k].emplace_back(i, a[k] - K);
                    if (k == n || !(a[k] - K))
                        break;
                    mx = (a[k] - K - 1) / 2;
                &amp;#125;
        add(rt[1], 1, m, a[i], i, 1);
    &amp;#125;
    int q;
    read(q);
    std::vector&amp;lt;int&amp;gt; res(q + 1);
    std::vector&amp;lt;std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;gt; u(n + 1);
    for (int i = 1, l, r; i &amp;lt;= q; ++i) &amp;#123;
        read(l), read(r);
        if (l &amp;gt; r)
            std::swap(l, r);
        u[r].emplace_back(l, i);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; bit(n + 1, 0x3f3f3f3f);
    auto lowbit = [&amp;amp;](int x) &amp;#123; return x &amp;amp; -x; &amp;#125;;
    auto add = [&amp;amp;](int x, int v) &amp;#123;
        for (; x &amp;lt;= n; x += lowbit(x))
            bit[x] = std::min(bit[x], v);
        return;
    &amp;#125;;
    auto ask = [&amp;amp;](int x) &amp;#123;
        auto res = 0x3f3f3f3f;
        for (; x; x -= lowbit(x))
            res = std::min(res, bit[x]);
        return res;
    &amp;#125;;
    for (int r = 1; r &amp;lt;= n; ++r) &amp;#123;
        for (auto [l, v] : t[r])
            add(n - l + 1, v);
        for (auto [l, i] : u[r])
            res[i] = ask(n - l + 1);
    &amp;#125;
    for (int i = 1; i &amp;lt;= q; ++i)
        print(res[i], &amp;#39;\n&amp;#39;);
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;æ±‚æ”¯é…å¯¹çš„è¿‡ç¨‹ä¹Ÿè¦å¸¦ logï¼ˆçº¿æ®µæ ‘ï¼‰ï¼Œå†åŠ ä¸Šæ‰«æçº¿çš„ 3logï¼Œæ€»å…±æ˜¯å¸¸æ•°æ¯”è¾ƒå¤§çš„ 3logï¼ˆå¡äº†ä¸€ä¸ªä¸Šåˆçš„å¸¸ä¹Ÿæ˜¯æœ‰äº†ï¼‰ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è®²è§£å¦ä¸€ç§å¥‡æŠ€æ·«å·§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æš´åŠ›åˆ†æ²»&lt;/strong&gt;ï¼šæ³¨æ„åˆ°å¯¹äºæ¯”è¾ƒé•¿ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(len&amp;gt; B\)&lt;/span&gt;ï¼‰çš„åŒºé—´ï¼Œç­”æ¡ˆæ¯”è¾ƒå°ï¼›æ•…è€ƒè™‘åˆ†æ²»ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºé•¿è¯¢é—®ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(len&amp;gt;B\)&lt;/span&gt;ï¼‰ï¼Œä»å°åˆ°å¤§æšä¸¾ç­”æ¡ˆå¹¶ checkï¼›é¢„å¤„ç†æŸä¸ªèŒƒå›´ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(V\)&lt;/span&gt;ï¼‰å†…çš„ &lt;span class=&#34;math inline&#34;&gt;\(res\)&lt;/span&gt; å‡ºç°çš„æ‰€æœ‰ä½ç½®ï¼Œå¹³è¡¡çš„æ—¶å€™è¿˜è¦ç®—ä¸Šè°ƒå’Œçº§æ•°å’Œ bitã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºçŸ­è¯¢é—®ï¼ˆ&lt;span class=&#34;math inline&#34;&gt;\(len\le B\)&lt;/span&gt;ï¼‰ï¼Œå‘ç°æ¯æ¬¡åŒºé—´å†…æš´åŠ›æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(B^2q)\)&lt;/span&gt; çš„ï¼›æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥ï¼Œç²¾ç»†å®ç°ï¼Œåˆ©ç”¨è¯¢é—®çš„å…¬å…±éƒ¨åˆ†ä½¿å¾—&lt;strong&gt;æ¯ä¸€å¯¹æ•°åªè¢«æšä¸¾ä¸€æ¬¡&lt;/strong&gt;å°±èƒ½è¾¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(B^2 + Bq)\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€ä¼˜è§£å– &lt;span class=&#34;math inline&#34;&gt;\(B=333,V=483\)&lt;/span&gt;ï¼Œä¸è‡ªå·±å®ç°ä¸€éäº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;d---ä»™äººæŒ&#34;&gt;D - ä»™äººæŒ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3687&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3687&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æŠŠè¾¹åŒä»å›¾ä¸­åˆ é™¤ã€é—®é¢˜è½¬åŒ–ä¸ºæ ‘ä¸Š&lt;strong&gt;è¾¹&lt;/strong&gt;ä¸äº¤çš„é“¾è¦†ç›–ï¼Œä½¿å¾—&lt;strong&gt;æ‰€æœ‰é“¾é•¿ &lt;span class=&#34;math inline&#34;&gt;\(\ge 2\)&lt;/span&gt;&lt;/strong&gt; çš„æ–¹æ¡ˆæ•°ã€‚å‘ç°ç”±äº&lt;strong&gt;è¾¹å¯ä»¥ä¸è¢«è¦†ç›–&lt;/strong&gt;ï¼Œå¸¸è§„ DP ä¼šä½¿å¾—åœ¨çˆ¶èŠ‚ç‚¹å¤„åˆå¹¶æ—¶éœ€è¦é¢å¤–çš„æ•°é‡ç»´ï¼Œå‚è€ƒæ ‘ä¸ŠèƒŒåŒ…ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(n^2)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ€è€ƒæ—¶ä¼šæ³¨æ„åˆ°ä¸¤ä¸ªé™åˆ¶å¯ä»¥æŠµæ¶ˆâ€”â€”å¦‚æœè®¤ä¸ºé•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„é“¾å°±æ˜¯ä¸è¢«è¦†ç›–çš„è¾¹ï¼Œè¦†ç›–æ‰€æœ‰æ ‘è¾¹ï¼Œæ˜¾ç„¶å¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚æ­¤æ—¶åˆå¹¶æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œæ³¨æ„åˆ°æ¯ä¸ªå„¿å­çš„ç³»æ•°ä¸€å®šéƒ½å‚ä¸ã€åˆ†æ­¥ã€ï¼Œåªéœ€è¦æ±‚å‡ºã€åˆ†ç±»ã€çš„ç³»æ•°ã€‚è¿™ä¸ªå¯ä»¥é¢„å¤„ç†ï¼ˆå’Œ &lt;a href=&#34;/20250407/#a.-äºŒåˆ†å›¾æŸ“è‰²&#34;&gt;äºŒåˆ†å›¾æŸ“è‰²&lt;/a&gt; è¿™ä¸ªé¢˜æœ‰ç‚¹åƒï¼‰ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_i\)&lt;/span&gt; è¡¨ç¤ºä¸€ä¸ªç‚¹åº¦æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ—¶çš„ç­”æ¡ˆï¼Œå‚è€ƒé”™æ’çš„æ€è·¯ï¼Œåˆ™ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å¯ä»¥ä¸å‚ä¸é…å¯¹ï¼Œä¹Ÿå¯ä»¥ä¹±é€‰ä¸€ä¸ªç‚¹é…å¯¹ï¼Œå¦‚æœé€‰ä¸­äº†å·²é…å¯¹çš„ç‚¹å°±ä»¤å…¶å’Œ &lt;span class=&#34;math inline&#34;&gt;\(i-1\)&lt;/span&gt; äº¤æ¢ï¼Œå¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚åˆ™ &lt;span class=&#34;math inline&#34;&gt;\(f_i=f_{i-1}+(n-1)f_{i-2}\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦ check åŸå›¾æ˜¯å¦ä¸ºä»™äººæŒï¼Œé¡ºå¸¦å›å¿†ä¸€ä¸‹è¿é€šæ€§çš„çŸ¥è¯†â€”â€”åœ¨ DFS æ ‘ä¸Šå·®åˆ†ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰è¾¹è¢«è¦†ç›–ä¸¤æ¬¡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int mod = 998244353;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
    const auto stime = std::chrono::steady_clock::now();
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n, m;
        std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g1(n + 1);
        for (int x, y; m--; ) &amp;#123;
            std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; y;
            g1[x].push_back(y), g1[y].push_back(x);
        &amp;#125;
        bool flag = 1;
        int now = 0, cnt = 0;
        std::vector&amp;lt;int&amp;gt; st, dfn(n + 1), low(n + 1), col(n + 1), diff(n + 1);
        std::function&amp;lt;void(int, int)&amp;gt; DFS = [&amp;amp;](int x, int fa) &amp;#123;
            st.push_back(x);
            dfn[x] = low[x] = ++now;
            for (auto i : g1[x])
                if (!dfn[i]) &amp;#123;
                    // printf(&amp;quot;x = %d, %d -&amp;gt; %d\n&amp;quot;, x, x, i);
                    DFS(i, x);
                    diff[x] += diff[i];
                    // printf(&amp;quot;x = %d, diff[%d] += diff[%d]\n&amp;quot;, x, x, i);
                    low[x] = std::min(low[x], low[i]);
                &amp;#125;
                else if (i != fa &amp;amp;&amp;amp; dfn[i] &amp;lt; dfn[x]) &amp;#123;
                    low[x] = std::min(low[x], dfn[i]);
                    ++diff[x], --diff[i];
                    // printf(&amp;quot;x = %d, ++diff[%d], --diff[%d]\n&amp;quot;, x, x, i);
                &amp;#125;
            if (diff[x] &amp;gt;= 2)
                flag = 0;
            // printf(&amp;quot;x = %d, diff[%d] = %d\n&amp;quot;, x, x, diff[x]);
            if (low[x] == dfn[x]) &amp;#123;
                ++cnt;
                for (int p = -1; p != x; ) &amp;#123;
                    p = st.back(), st.pop_back();
                    col[p] = cnt;
                &amp;#125;
            &amp;#125;
            return;
        &amp;#125;;
        DFS(1, -1);
        if (!flag) &amp;#123;
            std::cout &amp;lt;&amp;lt; 0 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            continue;
        &amp;#125;
        std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(n + 1);
        for (int i = 1; i &amp;lt;= n; ++i)
            for (auto j : g1[i])
                if (col[i] != col[j])
                    g[i].push_back(j);
        std::vector&amp;lt;long long&amp;gt; f(n + 1), dp(n + 1);
        dp[0] = 1ll, dp[1] = 1ll;
        for (int i = 2; i &amp;lt;= n; ++i)
            dp[i] = (dp[i - 1] + (i - 1) * dp[i - 2]) % mod;
        std::vector&amp;lt;int&amp;gt; tag(n + 1);
        DFS = [&amp;amp;](int x, int fa) &amp;#123;
            f[x] = 1ll, tag[x] = 1;
            for (auto i : g[x])
                if (i != fa) &amp;#123;
                    DFS(i, x);
                    (f[x] *= f[i]) %= mod;
                &amp;#125;
            (f[x] *= dp[(int)g[x].size()]) %= mod;
            return;
        &amp;#125;;
        auto res(1ll);
        for (int i = 1; i &amp;lt;= n; ++i)
            if (!tag[i])
                DFS(i, -1), (res *= f[i]) %= mod;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
#ifndef ONLINE_JUDGE
    std::cerr &amp;lt;&amp;lt; std::fixed &amp;lt;&amp;lt; std::setprecision(6) &amp;lt;&amp;lt; std::chrono::duration&amp;lt;double&amp;gt; (std::chrono::steady_clock::now() - stime).count() &amp;lt;&amp;lt; &amp;quot;s\n&amp;quot;;
#endif
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;p&gt;E. Many Minimizations æ˜¯æ•°å­¦é¢˜ï¼Œè·³äº†ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;æ— åé¢˜&#34;&gt;æ— åé¢˜&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;èƒŒæ™¯ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(n,k\)&lt;/span&gt;ï¼Œå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(\forall\, 1\le i\le n\)&lt;/span&gt;ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(a_i=i\bmod k\)&lt;/span&gt;ï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ä¸ªæœ¬è´¨ä¸åŒçš„å­åºåˆ—ï¼Ÿå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(k=1,2,\cdots,n\)&lt;/span&gt; åˆ†åˆ«æ±‚å‡ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;maimai&#34;&gt;maimai&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://ac.nowcoder.com/acm/contest/66112/F&#34; class=&#34;uri&#34;&gt;https://ac.nowcoder.com/acm/contest/66112/F&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="å­—å…¸æ ‘" />
        <category term="å­—ç¬¦ä¸²" />
        <category term="ç»„åˆæ•°å­¦" />
        <category term="æ”¯é…å¯¹" />
        <updated>2025-08-09T04:33:17.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250202/</id>
        <title>å­¦ä¹ ç¬”è®°ï¼šåç¼€æ•°ç»„</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250202/"/>
        <content type="html">&lt;p&gt;éå¸¸åçŸ¥åè§‰åœ°æ„è¯†åˆ° SA(Suffix Array) å’Œ SAM(Suffix Automaton) çš„ A ä¸æ˜¯åŒä¸€ä¸ª A &lt;img src=&#34;/em/fad.gif&#34; /&gt;&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å®šä¹‰&#34;&gt;å®šä¹‰&lt;/h2&gt;
&lt;p&gt;æ˜¾è€Œæ˜“è§ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; çš„å­—ç¬¦ä¸²ä¸­æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; ä¸ªé•¿åº¦åˆ†åˆ«ä¸º &lt;span class=&#34;math inline&#34;&gt;\(1\sim n\)&lt;/span&gt; çš„åç¼€ï¼Œå¦‚æœæˆ‘ä»¬å¯¹å…¶æŒ‰å­—å…¸åºæ’åºï¼Œåˆ†åˆ«å­˜å‚¨ä¸‹æ’å &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„åç¼€ &lt;span class=&#34;math inline&#34;&gt;\(sa_i\)&lt;/span&gt; å’Œæ¯ä¸ªåç¼€ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; çš„æ’å &lt;span class=&#34;math inline&#34;&gt;\(rk_i\)&lt;/span&gt;ã€‚è™½ç„¶çœ‹ç€æŒºæ²¡å¤´æ²¡å°¾çš„ï¼Œä½†æ˜¯å¾ˆæœ‰ç”¨ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ±‚è§£&#34;&gt;æ±‚è§£&lt;/h2&gt;
&lt;h3 id=&#34;å“ˆå¸Œ-æ’åº&#34;&gt;å“ˆå¸Œ + æ’åº&lt;/h3&gt;
&lt;p&gt;ç›´æ¥æŠŠæ‰€æœ‰åç¼€æ‹¿æ¥æ’åºçš„è¯ï¼Œå­—ç¬¦ä¸²æ¯”è¾ƒæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ã€‚å¦‚æœæˆ‘ä»¬ç”¨å“ˆå¸Œ + äºŒåˆ†ä¼˜åŒ–æ¯”è¾ƒè¿‡ç¨‹ï¼Œå°±å¯ä»¥æŠŠæ•´ä¸ªæ’åºä¼˜åŒ–åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2 n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å€å¢&#34;&gt;å€å¢&lt;/h3&gt;
&lt;p&gt;å…ˆå¯¹æ‰€æœ‰åç¼€æŒ‰ &lt;strong&gt;ç¬¬ä¸€ä¸ªå­—ç¬¦&lt;/strong&gt; æ’åºï¼Œè®°æ’åºåæ’ååºåˆ—ä¸º &lt;span class=&#34;math inline&#34;&gt;\(a\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ€ä¹ˆæŒ‰ &lt;strong&gt;å‰ä¸¤ä¸ªå­—ç¬¦&lt;/strong&gt; æ’åºå‘¢ï¼Ÿå¯¹äºç¬¬ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ç»„å­—ç¬¦ï¼Œæˆ‘ä»¬ç”¨ &lt;span class=&#34;math inline&#34;&gt;\((a_i,a_{i+1})\)&lt;/span&gt; åŒå…³é”®å­—æ’åºå³å¯ã€‚è®°æ­¤æ—¶æ’ååºåˆ—ä¸º &lt;span class=&#34;math inline&#34;&gt;\(b\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå¦‚æœéœ€è¦æŒ‰ç…§å‰å››ä¸ªå­—ç¬¦æ’åºï¼Œç”¨ &lt;span class=&#34;math inline&#34;&gt;\((b_i,b_{i+2})\)&lt;/span&gt; è¿›è¡ŒåŒå…³é”®å­—æ’åºå³å¯ã€‚æ€»å…±éœ€è¦è¿›è¡Œ &lt;span class=&#34;math inline&#34;&gt;\(\log n\)&lt;/span&gt; æ¬¡æ’åºã€‚å¤æ‚åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(n\log^2n)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æˆ‘ä»¬æ³¨æ„åˆ°æ’åæ•°ç»„çš„å€¼åŸŸä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç”¨æ¡¶æ’å°±èƒ½å°‘ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å®ç°&#34;&gt;å®ç°&lt;/h2&gt;
&lt;p&gt;å“ˆå¸Œå¾ˆå¥½å®ç°ï¼Œè¿™é‡Œå°±æŒ‰ä¸‹ä¸è¡¨ï¼Œä¸»è¦è®²è§£å€å¢æ³•çš„å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;æè¿°èµ·æ¥å¾ˆç®€å•ï¼Œå®ç°èµ·æ¥å¾ˆè¦å‘½ã€‚OI wiki ä¸Šçš„å®ç°ç®—æ˜¯ç›¸å¯¹å¥½ç†è§£çš„ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆäº†è§£åŒå…³é”®å­—æ¡¶æ’çš„æ–¹æ³•ï¼Œé¦–å…ˆç”¨å•å…³é”®å­—æ¡¶æ’å®Œæˆå¯¹ &lt;strong&gt;ç¬¬äºŒå…³é”®å­—&lt;/strong&gt; çš„æ’åºï¼›å¯¹äºç¬¬ä¸€å…³é”®å­—ï¼Œä»¤æ¡¶ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; è®°å½•å‰ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; ä¸ªå…ƒç´ çš„æ•°é‡ï¼›éå†æ’åºåçš„ç¬¬äºŒå…³é”®å­—æ•°ç»„ï¼Œå°†å…ƒç´ æ”¾åˆ°æ¡¶ä¸­è®°å½•æ•°å€¼å¯¹åº”çš„ä¸‹æ ‡ä¸­ï¼Œå¹¶å°†æ¡¶ä¸­æ•°å€¼ &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ã€‚å®é™…ä¸Šæ¡¶ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt; å……å½“è®¡ç®—ä¸‹æ ‡èŒƒå›´çš„ä½œç”¨ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\((c_{i-1},c_i]\)&lt;/span&gt; å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; åˆ†å¸ƒçš„èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¾ç„¶ï¼Œå½“ä¸”ä»…å½“æ’åç§ç±»ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œå³æ²¡æœ‰å¹¶åˆ—æ’åæ—¶ï¼Œæ’åºå®Œæˆã€‚è®¾æœ¬è½®åŒºé—´é•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(w\)&lt;/span&gt;ï¼Œå¯¹äºä¸€è½®æ“ä½œï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;è®¡ç®—æ¯ä¸ªåŒºé—´æŒ‰ååŠæ®µ &lt;span class=&#34;math inline&#34;&gt;\(\frac w2\)&lt;/span&gt; é•¿åº¦å­—ç¬¦æ’åºçš„ç»“æœï¼š&lt;span class=&#34;math inline&#34;&gt;\((n-w,n]\)&lt;/span&gt; å¼€å¤´çš„åŒºé—´ååŠæ®µå‡ä¸ºç©ºï¼Œç›´æ¥æ”¾åœ¨åºåˆ—é¦–ç«¯ï¼›æ¥ç€æŒ‰ç…§ä¸Šä¸€è½® &lt;span class=&#34;math inline&#34;&gt;\(sa\)&lt;/span&gt; ç»“æœï¼ŒæŠŠèƒ½å¤Ÿä½œä¸ºååŠæ®µçš„å…ƒç´ ä¾æ¬¡æ”¾å…¥ã€‚&lt;/li&gt;
&lt;li&gt;ä¾ç…§ä¸Šä¸€è½®çš„ &lt;span class=&#34;math inline&#34;&gt;\(rk\)&lt;/span&gt; ä½œä¸ºå‰åŠæ®µæ’åï¼Œè¿›è¡ŒåŒå…³é”®å­—æ¡¶æ’ã€‚&lt;/li&gt;
&lt;li&gt;ä¾ç…§ &lt;span class=&#34;math inline&#34;&gt;\(sa\)&lt;/span&gt; å’Œç¬¬äºŒå…³é”®å­—ï¼ˆå¤„ç†å¹¶åˆ—ï¼‰ï¼Œæ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(rk\)&lt;/span&gt;ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;std::vector&amp;lt;int&amp;gt; la(n + 2);
std::copy(s.begin(), s.end(), rk.begin());
int m = 128;
&amp;#123;
    std::vector&amp;lt;int&amp;gt; c(m + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        ++c[rk[i]];
    std::partial_sum(c.begin(), c.end(), c.begin());
    for (int i = n; i; --i)
        sa[c[rk[i]]--] = i;
&amp;#125; 
for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
    std::vector&amp;lt;int&amp;gt; id(1);
    for (int i = n - w + 1; i &amp;lt;= n; ++i)
        id.push_back(i);
    for (int i = 1; i &amp;lt;= n; ++i)
        if (sa[i] &amp;gt; w)
            id.push_back(sa[i] - w);
    std::vector&amp;lt;int&amp;gt; c(m + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        ++c[rk[i]];
    std::partial_sum(c.begin(), c.end(), c.begin());
    for (int i = n; i; --i)
        sa[c[rk[id[i]]]--] = id[i];
    p = 0;
    std::copy(rk.begin(), rk.end(), la.begin());
    for (int i = 1; i &amp;lt;= n; ++i)
        if (la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
            rk[sa[i]] = p;
        else
            rk[sa[i]] = ++p;
    if (p == n)
        break;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;çº¯-sa-çš„åº”ç”¨&#34;&gt;çº¯ SA çš„åº”ç”¨&lt;/h2&gt;
&lt;h3 id=&#34;æœ€å°è¡¨ç¤ºæ³•&#34;&gt;æœ€å°è¡¨ç¤ºæ³•&lt;/h3&gt;
&lt;p&gt;æ¨¡æ¿ï¼š&lt;a href=&#34;https://www.luogu.com.cn/problem/P1368&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P1368&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå¾ªç¯ä½ç§»ç›¸å…³è¦æ±‚ï¼Œé¦–å…ˆè€ƒè™‘å°†å­—ç¬¦ä¸²é‡å¤ä¸€éã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(ss\)&lt;/span&gt; ä¸­æ‰¾åˆ°æ’åç¬¬ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(sa_i\le n\)&lt;/span&gt; å³ä¸ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; s(2 * n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; s[i], s[n + i] = s[i];
    std::vector&amp;lt;int&amp;gt; sa(2 * n + 1), rk(s);
    &amp;#123;
        int m = 29;
        &amp;#123;
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= 2 * n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = 2 * n; i; --i)
                sa[c[rk[i]]--] = i;
        &amp;#125;
        for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
            std::vector&amp;lt;int&amp;gt; id(1);
            for (int i = 2 * n - w + 1; i &amp;lt;= 2 * n; ++i)
                id.push_back(i);
            for (int i = 1; i &amp;lt;= 2 * n; ++i)
                if (sa[i] &amp;gt; w)
                    id.push_back(sa[i] - w);
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= 2 * n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = 2 * n; i; --i)
                sa[c[rk[id[i]]]--] = id[i];
            auto la(rk);
            p = 0;
            for (int i = 1; i &amp;lt;= 2 * n; ++i)
                if (i != 1 &amp;amp;&amp;amp; la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
                    rk[sa[i]] = p;
                else
                    rk[sa[i]] = ++p;
            if (p == 2 * n)
                break;
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= 2 * n; ++i)
        if (sa[i] &amp;lt;= n) &amp;#123;
            for (int j = sa[i]; j &amp;lt; n + sa[i]; ++j)
                std::cout &amp;lt;&amp;lt; s[j] &amp;lt;&amp;lt; &amp;#39; &amp;#39;;
            std::cout &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
            break;
        &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;å­—ç¬¦ä¸²åŒ¹é…&#34;&gt;å­—ç¬¦ä¸²åŒ¹é…&lt;/h3&gt;
&lt;p&gt;äºŒåˆ†ï¼Œå¤æ‚åº¦ &lt;span class=&#34;math inline&#34;&gt;\(O(|S|\log |T|)\)&lt;/span&gt;ã€‚æ±‚å‡ºç°æ¬¡æ•°åˆ™äºŒåˆ†å·¦å³è¾¹ç•Œã€‚&lt;/p&gt;
&lt;p&gt;å¤ªéº»çƒ¦äº†ä¸”æ²¡æœ‰å®é™…åº”ç”¨ä»·å€¼ï¼Œä»£ç ç•¥ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;height-æ•°ç»„&#34;&gt;height æ•°ç»„&lt;/h2&gt;
&lt;p&gt;å®šä¹‰ &lt;span class=&#34;math inline&#34;&gt;\(h_i=\text {lcp}(sa_i, sa_i-1)\)&lt;/span&gt;ï¼Œç‰¹åˆ«åœ°ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(h_1=0\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ‰å¼•ç†ï¼š&lt;span class=&#34;math inline&#34;&gt;\(h_{rk_i}\ge h_{rk_{i-1}}-1\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å‡è®¾å·²ç»æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(h_{rk_{i-1}}\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå¯ä»¥ä» &lt;span class=&#34;math inline&#34;&gt;\(h_{rk_{i-1}}-1\)&lt;/span&gt; å‡ºå‘æš´åŠ›çœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯å¦ç›¸ç­‰å¾—åˆ°ç­”æ¡ˆã€‚é‚£ä¹ˆæˆ‘ä»¬ä¼šå‘ç°ä»å‰å¾€å &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; å€¼æ¯æ¬¡æœ€å¤š &lt;span class=&#34;math inline&#34;&gt;\(-1\)&lt;/span&gt;ï¼Œæ‰€ä»¥å¤æ‚åº¦æ‘Šä¸‹æ¥æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(n)\)&lt;/span&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;&lt;mark&gt;è®°ä½è®°ä½ä¸€å®šæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(rk_{i-1}\)&lt;/span&gt; è€Œä¸æ˜¯ä¸‹æ„è¯†çš„ &lt;span class=&#34;math inline&#34;&gt;\(rk_i-1\)&lt;/span&gt;ï¼ï¼ï¼&lt;/mark&gt;æ‰€ä»¥ä¸ºäº†ä¿è¯æ±‚è§£é¡ºåºå¾ªç¯æšä¸¾çš„ä¸€å®šæ˜¯ä¸‹æ ‡è€Œéæ’åã€‚ä½†æ˜¯æ³¨æ„å®šä¹‰å´æ˜¯å’Œ &lt;span class=&#34;math inline&#34;&gt;\(rk_i-1\)&lt;/span&gt; çš„ lcpï¼ï¼ï¼æ‰€ä»¥æ±‚ height çš„å†™æ³•æ˜¯ç›¸å¯¹å›ºå®šçš„ï¼Œä¸èƒ½è§‰å¾—å¥½åƒæ˜¯å¯¹çš„å°±éšä¾¿ä¹±æ”¹ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;height-æ•°ç»„çš„åº”ç”¨&#34;&gt;height æ•°ç»„çš„åº”ç”¨&lt;/h2&gt;
&lt;p&gt;ç›¸å½“äºèƒŒæ¿å­ï¼Œå› ä¸ºåº”ç”¨å¤ªå¤šä¸”å½¢å¼å¤§å¤šå›ºå®šã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ±‚ä»»æ„ä¸¤ä¸ªåç¼€çš„-lcp&#34;&gt;æ±‚ä»»æ„ä¸¤ä¸ªåç¼€çš„ lcp&lt;/h3&gt;
&lt;p&gt;æ˜“å¾— &lt;span class=&#34;math inline&#34;&gt;\(\text{lcp}(sa_i, sa_j)=\min\{h_{i+1}, \cdots, h_j\}\)&lt;/span&gt;ã€‚&lt;strong&gt;æ•…åº”å°†ä¸€äº›å¤æ‚ lcp é—®é¢˜çš„è§£å†³æ–¹å¼å’Œ RMQ è”ç³»èµ·æ¥&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;å­ä¸²å¤§å°å…³ç³»&#34;&gt;å­ä¸²å¤§å°å…³ç³»&lt;/h3&gt;
&lt;p&gt;å³æ¯”è¾ƒ &lt;span class=&#34;math inline&#34;&gt;\(S_{l_1, r_1}\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(S_{l_2, r_2}\)&lt;/span&gt; çš„å¤§å°å…³ç³»ã€‚æ¯”è¾ƒå¯¼è‡´ lcp ä¸èƒ½ç»§ç»­å»¶ä¼¸çš„å…ƒç´ å¤§å°å³å¯ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æœ¬è´¨ä¸åŒå­ä¸²æ•°é‡&#34;&gt;æœ¬è´¨ä¸åŒå­ä¸²æ•°é‡&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;å­ä¸²ç­‰ä»·äºã€Œåç¼€çš„å‰ç¼€ã€&lt;/strong&gt;ã€‚æŒ‰é¡ºåºæšä¸¾æ¯ä¸ªåç¼€ï¼Œå‡å»å’Œå·²æšä¸¾çš„æ‰€æœ‰åç¼€çš„ lcp å³å¯ã€‚é‰´äº &lt;span class=&#34;math inline&#34;&gt;\(\min\{h_{j+1},\cdots,h_i\}\)&lt;/span&gt; å•è°ƒä¸å‡ï¼Œç›´æ¥å‡å» &lt;span class=&#34;math inline&#34;&gt;\(h_i\)&lt;/span&gt; å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åç­”æ¡ˆå³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(\frac {n(n-1)}2 - \sum\limits_{i=2}^nh_i\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;è‡³å°‘å‡ºç°-k-æ¬¡å­ä¸²çš„æœ€å¤§é•¿åº¦&#34;&gt;è‡³å°‘å‡ºç° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡å­ä¸²çš„æœ€å¤§é•¿åº¦&lt;/h3&gt;
&lt;p&gt;æ¨¡æ¿ï¼š&lt;a href=&#34;https://www.luogu.com.cn/problem/P2852&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P2852&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‡ºç° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(\iff\)&lt;/span&gt; åœ¨åç¼€æ•°ç»„ä¸­è¿ç»­å‡ºç° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡ &lt;span class=&#34;math inline&#34;&gt;\(\iff\)&lt;/span&gt; æ˜¯ä»»æ„è¿ç»­ &lt;span class=&#34;math inline&#34;&gt;\(k-1\)&lt;/span&gt; ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; çš„æœ€å°å€¼ï¼Œéœ€è¦æœ€å¤§åŒ–è¯¥æœ€å°å€¼ï¼Œè€ƒè™‘æ»‘åŠ¨çª—å£ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;P2852_7.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, k;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; k, --k;
    std::vector&amp;lt;int&amp;gt; s(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; s[i];
    std::vector&amp;lt;int&amp;gt; sa(n + 1), rk(s), h(n + 1);
    &amp;#123;
        int m = 1000001;
        &amp;#123;
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n; i; --i)
                sa[c[rk[i]]--] = i;
        &amp;#125;
        for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
            std::vector&amp;lt;int&amp;gt; id(1);
            for (int i = n - w + 1; i &amp;lt;= n; ++i)
                id.push_back(i);
            for (int i = 1; i &amp;lt;= n; ++i)
                if (sa[i] &amp;gt; w)
                    id.push_back(sa[i] - w);
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n; i; --i)
                sa[c[rk[id[i]]]--] = id[i];
            auto la(rk);
            p = 0;
            for (int i = 1; i &amp;lt;= n; ++i)
                if (i != 1 &amp;amp;&amp;amp; la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
                    rk[sa[i]] = p;
                else
                    rk[sa[i]] = ++p;
            if (p == n)
                break;
        &amp;#125;
        for (int i = 1, to = 0; i &amp;lt;= n; ++i)
            if (rk[i]) &amp;#123;
                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);
                h[rk[i]] = to;
            &amp;#125;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; q(n + 1);
    int res = 0;
    for (int i = 1, l = 1, r = 0; i &amp;lt;= n; ++i) &amp;#123;
        // printf(&amp;quot;%d\n&amp;quot;, h[i]);
        for (; l &amp;lt;= r &amp;amp;&amp;amp; i - q[l] &amp;gt;= k; ++l);
        for (; l &amp;lt;= r &amp;amp;&amp;amp; h[i] &amp;lt;= h[q[r]]; --r);
        q[++r] = i;
        if (i &amp;gt;= k)
            res = std::max(res, h[q[l]]);
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æœ€é•¿ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²&#34;&gt;æœ€é•¿ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²&lt;/h3&gt;
&lt;p&gt;&lt;del&gt;bbï¼šå®šå¼å¤ªå¤šå¤ªæ‚ä»¥è‡³äºè®©äººæ€€ç–‘æŸäº›å®šå¼æ˜¯å¦å­˜åœ¨åº”ç”¨åœºæ™¯&lt;/del&gt; &lt;img src=&#34;/em/kt.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å‘ç°æ»¡è¶³å•è°ƒæ€§ï¼ŒäºŒåˆ†å­ä¸²é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt;ï¼Œé‚£ä¹ˆæ˜¾ç„¶ &lt;span class=&#34;math inline&#34;&gt;\(\text {lcp}\ge len\)&lt;/span&gt;ï¼›å°† &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; åˆ’åˆ†ä¸ºè¿ç»­ &lt;span class=&#34;math inline&#34;&gt;\(\ge len\)&lt;/span&gt; çš„æ®µï¼Œåœ¨æ¯æ®µå†…æ‰¾åˆ°ä¸‹æ ‡æå·®ä¸ &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; æ¯”è¾ƒå³å¯ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥ç”¨äºåˆ¤å®šæ˜¯å¦å­˜åœ¨ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;ç”šè‡³å¯ä»¥è€ƒè™‘é™åˆ¶è‡³å°‘å‡ºç°æ¬¡æ•°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt;ï¼Œé‚£å¤§æ¦‚å¤šä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ï¼Œçœ‹çœ‹ä¸€æ®µé‡Œæœ‰æ²¡æœ‰ &lt;span class=&#34;math inline&#34;&gt;\(\ge k\)&lt;/span&gt; ä¸ªç›¸äº’ç›¸å·® &lt;span class=&#34;math inline&#34;&gt;\(\ge len\)&lt;/span&gt; çš„ã€‚æ’åºè´ªå¿ƒæ±‚è§£ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆä¸Šé¢çš„è‡³å°‘å‡ºç° &lt;span class=&#34;math inline&#34;&gt;\(k\)&lt;/span&gt; æ¬¡å­ä¸²ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥è§£ï¼Œä½†æ˜¯å¤šä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt; æ²¡å¿…è¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå¯ä»¥é™åˆ¶å¤šæ¬¡å‡ºç°ä½†é•¿åº¦è‡³å°‘ä¸º &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt;ï¼Œé‚£ç”šè‡³å°‘äº†äºŒåˆ†çš„ &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ï¼Œç›´æ¥è·‘ä¸€é check å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ï¼Ÿï¼Ÿï¼Ÿåˆ°åº•ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤šå¥‡æ€ªçš„å®šå¼ï¼Œæ˜¯å› ä¸ºçœŸçš„æœ‰é¢˜è¿™ä¹ˆå‡ºå—ï¼Ÿï¼Ÿï¼Ÿ&lt;/del&gt; &lt;img src=&#34;/em/oh.gif&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;æœ€é•¿å…¬å…±å­ä¸²é—®é¢˜&#34;&gt;æœ€é•¿å…¬å…±å­ä¸²é—®é¢˜&lt;/h3&gt;
&lt;p&gt;æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„æœ€é•¿å…¬å…±å­ä¸²ï¼ˆæ³¨æ„ä¸æ˜¯ LCSï¼‰ã€‚è®¾ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; é•¿ä¸º &lt;span class=&#34;math inline&#34;&gt;\(m\)&lt;/span&gt;ï¼Œé‚£ä¹ˆå°† &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; æ‹¼æ¥ï¼Œç­”æ¡ˆå°±æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\max \{\text{lcp}(i,j)\},i\le n&amp;lt;j\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä½†è¿™é‡Œä¸ç›´æ¥æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; å’Œ &lt;span class=&#34;math inline&#34;&gt;\(j\)&lt;/span&gt;ï¼Œè¿˜æ˜¯ç…§ä¾‹å…ˆä» &lt;span class=&#34;math inline&#34;&gt;\(h\)&lt;/span&gt; ä¸‹æ‰‹å†å¡æ¡ä»¶ï¼Œè‹¥ &lt;span class=&#34;math inline&#34;&gt;\(sa_{i-1}\le n&amp;lt;sa_{i}\)&lt;/span&gt;ï¼ˆæˆ–è€…åè¿‡æ¥ï¼‰ï¼Œå°±å¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(h_i\)&lt;/span&gt; æ›´æ–°ç­”æ¡ˆã€‚å®¹æ˜“è¯æ˜è¿™æ ·æ€»å¯ä»¥æ‰¾åˆ°æœ€å¤§å€¼ã€‚&lt;/p&gt;
&lt;h4 id=&#34;eg1.-æ‰¾ç›¸åŒå­—ç¬¦&#34;&gt;eg1. æ‰¾ç›¸åŒå­—ç¬¦&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P3181&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P3181&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¦æ±‚æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º &lt;span class=&#34;math inline&#34;&gt;\(\text{lcp}(i,j),i\le n&amp;lt;j\)&lt;/span&gt;ã€‚ï¼ˆæˆ‘å·²ç»å¸®ä½ ä»¬è¯•è¿‡äº†å®¹æ–¥æ¯”ç›´æ¥åšæ›´éº»çƒ¦ï¼‰ï¼Œè€ƒè™‘ç”¨å•è°ƒæ ˆç»´æŠ¤å·¦ / å³ä¾§åŒºé—´ lcp æ±‚è§£å³ / å·¦ä¾§ç­”æ¡ˆã€‚å…³äºå•è°ƒæ ˆçš„æè¿°å¯è§ &lt;a href=&#34;#ç»“åˆå•è°ƒæ ˆ&#34;&gt;æœ¬é¡µåéƒ¨å†…å®¹&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, n1;
    std::string s, t;
    std::cin &amp;gt;&amp;gt; s &amp;gt;&amp;gt; t;
    n = (int)s.length(), n1 = n + (int)t.length() + 1;
    s = &amp;quot;#&amp;quot; + s + &amp;quot;$&amp;quot; + t;
    std::vector&amp;lt;int&amp;gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);
    &amp;#123;
        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);
        int m = 128;
        &amp;#123;
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n1; i; --i)
                sa[c[rk[i]]--] = i;
        &amp;#125;
        for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
            std::vector&amp;lt;int&amp;gt; id(w + 1);
            std::iota(id.begin() + 1, id.end(), n1 - w + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                if (sa[i] &amp;gt; w)
                    id.push_back(sa[i] - w);
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n1; i; --i)
                sa[c[rk[id[i]]]--] = id[i];
            p = 0;
            auto la(rk);
            for (int i = 1; i &amp;lt;= n1; ++i)
                if (i != 1 &amp;amp;&amp;amp; la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
                    rk[sa[i]] = p;
                else
                    rk[sa[i]] = ++p;
            if (p == n1)
                break;
        &amp;#125;
        for (int i = 1, to = 0; i &amp;lt;= n1; ++i) &amp;#123;
            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);
            h[rk[i]] = to;
        &amp;#125;
    &amp;#125;
    std::vector&amp;lt;std::pair&amp;lt;int, long long&amp;gt; &amp;gt; q1, q2;
    std::vector&amp;lt;int&amp;gt; tot1(n1 + 1), tot2(n1 + 1);
    for (int i = 1; i &amp;lt;= n1; ++i) &amp;#123;
        tot1[i] = tot1[i - 1] + (sa[i] &amp;lt;= n);
        tot2[i] = tot2[i - 1] + (sa[i] &amp;gt; n + 1);
    &amp;#125;
    long long res = 0ll;
    q1.emplace_back(1, 0ll), q2.emplace_back(1, 0ll);
    for (int i = 1; i &amp;lt;= n1; ++i) &amp;#123;
        for (; !q1.empty() &amp;amp;&amp;amp; h[i] &amp;lt; h[q1.back().first]; q1.pop_back());
        q1.emplace_back(i, (tot1[i - 1] - tot1[q1.back().first - 1]) * h[i] + q1.back().second);
        if (sa[i] &amp;gt; n + 1)
            res += q1.back().second;
        for (; !q2.empty() &amp;amp;&amp;amp; h[i] &amp;lt; h[q2.back().first]; q2.pop_back());
        q2.emplace_back(i, (tot2[i - 1] - tot2[q2.back().first - 1]) * h[i] + q2.back().second);
        if (sa[i] &amp;lt;= n)
            res += q2.back().second;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;h4 id=&#34;eg2.-å…¬å…±ä¸²&#34;&gt;eg2. å…¬å…±ä¸²&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5546&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5546&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¦æ±‚å¤šä¸²æœ€é•¿å…¬å…±å­ä¸²ï¼Œä»ç„¶è€ƒè™‘å°†å¤šä¸ªä¸²æ‹¼åœ¨ä¸€èµ·ã€‚ä»¿ç…§å‰é¢äºŒåˆ†çš„æ–¹å¼å¤„ç†ï¼Œé—®é¢˜è½¬åŒ–ä¸ºæ‰¾åˆ°æœ€é•¿çš„ &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt;ï¼Œä½¿å¾—å­˜åœ¨ä¸€æ®µæœ€å°å€¼ &lt;span class=&#34;math inline&#34;&gt;\(\ge len\)&lt;/span&gt; çš„åŒºé—´ï¼Œå…¶è¦†ç›–äº† &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ®µä¸²ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, l = 0, r = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::string s;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; lim(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t;
        lim[i] = &amp;#123; (int)s.length() + 1, s.length() + t.length() &amp;#125;;
        s += &amp;quot;#&amp;quot; + t;
        r = std::max(r, (int)t.length());
        // printf(&amp;quot;[%d, %d]\n&amp;quot;, lim[i].first, lim[i].second);
    &amp;#125;
    int n1 = lim.back().second;
    std::vector&amp;lt;int&amp;gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);
    &amp;#123;
        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);
        int m = 128;
        &amp;#123;
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n1; i; --i)
                sa[c[rk[i]]--] = i;
        &amp;#125;
        for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
            std::vector&amp;lt;int&amp;gt; id(w + 1);
            std::iota(id.begin() + 1, id.end(), n1 - w + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                if (sa[i] &amp;gt; w)
                    id.push_back(sa[i] - w);
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n1; i; --i)
                sa[c[rk[id[i]]]--] = id[i];
            p = 0;
            auto la(rk);
            for (int i = 1; i &amp;lt;= n1; ++i)
                if (i != 1 &amp;amp;&amp;amp; la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
                    rk[sa[i]] = p;
                else
                    rk[sa[i]] = ++p;
            if (p == n1)
                break;
        &amp;#125;
        for (int i = 1, to = 0; i &amp;lt;= n1; ++i) &amp;#123;
            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);
            h[rk[i]] = to;
        &amp;#125;
    &amp;#125;
    // for (int i = 1; i &amp;lt;= n1; ++i)
    //     printf(&amp;quot;h[%d] = %d\n&amp;quot;, sa[i], h[i]);
    int res = 0;
    auto check = [&amp;amp;](int len) &amp;#123;
        // printf(&amp;quot;check %d: \n&amp;quot;, len);
        std::vector&amp;lt;int&amp;gt; cnt(n + 1);
        for (int i = 1; i &amp;lt;= n1; ++i) &amp;#123;
            if (h[i] &amp;lt; len) &amp;#123;
                if (*std::min_element(cnt.begin() + 1, cnt.end()))
                    return 1;
                cnt.assign(n + 1, 0);
            &amp;#125;
            else
                for (int j = 1; j &amp;lt;= n; ++j) &amp;#123;
                    if (lim[j].first &amp;lt;= sa[i - 1] &amp;amp;&amp;amp; sa[i - 1] &amp;lt;= lim[j].second)
                        cnt[j] = 1;
                    if (lim[j].first &amp;lt;= sa[i] &amp;amp;&amp;amp; sa[i] &amp;lt;= lim[j].second)
                        cnt[j] = 1;
                &amp;#125;
        &amp;#125;
        // printf(&amp;quot;\n%d\n&amp;quot;, *std::min_element(cnt.begin() + 1, cnt.end()));
        return *std::min_element(cnt.begin() + 1, cnt.end());
    &amp;#125;;
    for (int mid; l &amp;lt;= r; ) &amp;#123;
        mid = (l + r) &amp;gt;&amp;gt; 1;
        if (check(mid))
            l = mid + 1, res = mid;
        else
            r = mid - 1;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;p&gt;ä½†æ˜¯çœ‹äº†é¢˜è§£å‘ç°å±…ç„¶è¿˜æœ‰çº¿æ€§åšæ³•ï¼ˆå½“ç„¶ä¸çœ‹å»º SA çš„ &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ï¼‰ï¼Œå¯¹äºè¦†ç›–å…¨éƒ¨ &lt;span class=&#34;math inline&#34;&gt;\(n\)&lt;/span&gt; æ®µä¸²æ‰¾åŒºé—´æœ€å°å€¼ï¼Œå‘ç°éœ€è¦æœ€å°åŒ–åŒºé—´ï¼Œè€ƒè™‘åŒæŒ‡é’ˆã€‚&lt;/p&gt;
&lt;p&gt;åŒºé—´æœ€å°å€¼ç”¨å•è°ƒé˜Ÿåˆ—æ±‚è§£ï¼Œç»†æƒ³å¯èƒ½ä¼šè§‰å¾—ä¸å¤ªå¯¹åŠ²ï¼Œä½†æ˜¯å®¹æ˜“è¯æ˜ç­”æ¡ˆä¸å¤§äºé˜Ÿé¦–ä¸”ä¸å°äºæœ€å¤§é˜Ÿé¦–ï¼Œæ‰€ä»¥æœ€å¤§é˜Ÿé¦–å°±æ˜¯ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, l = 0, r = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::string s;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; lim(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t;
        lim[i] = &amp;#123; (int)s.length() + 1, s.length() + t.length() &amp;#125;;
        s += (char)(&amp;#39;A&amp;#39; + i - 1) + t;
        r = std::max(r, (int)t.length());
    &amp;#125;
    int n1 = lim.back().second;
    std::vector&amp;lt;int&amp;gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);
    &amp;#123;
        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);
        int m = 128;
        &amp;#123;
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n1; i; --i)
                sa[c[rk[i]]--] = i;
        &amp;#125;
        for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
            std::vector&amp;lt;int&amp;gt; id(w + 1);
            std::iota(id.begin() + 1, id.end(), n1 - w + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                if (sa[i] &amp;gt; w)
                    id.push_back(sa[i] - w);
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n1; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n1; i; --i)
                sa[c[rk[id[i]]]--] = id[i];
            p = 0;
            auto la(rk);
            for (int i = 1; i &amp;lt;= n1; ++i)
                if (i != 1 &amp;amp;&amp;amp; la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
                    rk[sa[i]] = p;
                else
                    rk[sa[i]] = ++p;
            if (p == n1)
                break;
        &amp;#125;
        for (int i = 1, to = 0; i &amp;lt;= n1; ++i) &amp;#123;
            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);
            h[rk[i]] = to;
        &amp;#125;
    &amp;#125;
    int res = 0;
    std::vector&amp;lt;int&amp;gt; q(n1 + 1), cnt(n + 1);
    // for (int i = 1; i &amp;lt;= n1; ++i)
    //     printf(&amp;quot;%d: %d\n&amp;quot;, sa[i], h[i]);
    for (int l = 1, r = 0, ql = 1, qr = 0; l &amp;lt;= n1; ++l) &amp;#123;
        for (; r &amp;lt; n1 &amp;amp;&amp;amp; !*std::min_element(cnt.begin() + 1, cnt.end()); ) &amp;#123;
            ++r;
            for (int i = 1; i &amp;lt;= n; ++i)
                if (lim[i].first &amp;lt;= sa[r] &amp;amp;&amp;amp; sa[r] &amp;lt;= lim[i].second) &amp;#123;
                    ++cnt[i];
                    break;
                &amp;#125;
            for (; ql &amp;lt;= qr &amp;amp;&amp;amp; h[r] &amp;lt;= h[q[qr]]; --qr);
            q[++qr] = r;
        &amp;#125;
        if (*std::min_element(cnt.begin() + 1, cnt.end())) &amp;#123;
            // printf(&amp;quot;[%d, %d]: %d\n&amp;quot;, l, r, h[q[ql]]);
            res = std::max(res, h[q[ql]]);
        &amp;#125;
        for (; ql &amp;lt;= qr &amp;amp;&amp;amp; q[ql] &amp;lt;= l; ++ql);
        if (l != 1) &amp;#123;
            for (int i = 1; i &amp;lt;= n; ++i)
                if (lim[i].first &amp;lt;= sa[l - 1] &amp;amp;&amp;amp; sa[l - 1] &amp;lt;= lim[i].second) &amp;#123;
                    --cnt[i];
                    break;
                &amp;#125;
        &amp;#125;
    &amp;#125;
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;texttt-aa-å¼å­ä¸²å¤„ç†&#34;&gt;&lt;span class=&#34;math inline&#34;&gt;\(\texttt {AA}\)&lt;/span&gt; å¼å­ä¸²å¤„ç†&lt;/h3&gt;
&lt;p&gt;å³å¯¹äºè¿ç»­ç›¸åŒå­ä¸²é—®é¢˜çš„å¤„ç†ï¼Œæœ‰ä¸€ä¸ªå®šçš„æ€è·¯ï¼Œç”±ä¾‹é¢˜åˆ†æã€‚&lt;/p&gt;
&lt;h4 id=&#34;eg1.-ä¼˜ç§€çš„æ‹†åˆ†&#34;&gt;eg1. ä¼˜ç§€çš„æ‹†åˆ†&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P1117&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P1117&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æ˜¯ä»ä¸­é—´åˆ†å¼€ï¼ŒæŒ‰å‰ååˆ†åˆ«å¤„ç†ã€‚è¿™é‡Œæœ‰ä¸ª trickï¼Œæˆ‘ä»¬æšä¸¾ &lt;span class=&#34;math inline&#34;&gt;\(\texttt B\)&lt;/span&gt; çš„é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt;ï¼Œåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­æ¯éš” &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; æ‰“ä¸€ä¸ªæ ‡è®°ã€‚é‚£ä¹ˆæ˜¾ç„¶ï¼Œä»»æ„ä¸€ä¸ªé•¿åº¦ä¸º &lt;span class=&#34;math inline&#34;&gt;\(2\times len\)&lt;/span&gt; çš„å­ä¸²éƒ½ä¼šç»è¿‡æ°å¥½ä¸¤ä¸ªæ ‡è®°ï¼ˆå……åˆ†çš„ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ç­›é€‰å‡ºæ‰€æœ‰å¯èƒ½çš„ä¸²ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æšä¸¾æ‰€æœ‰è¿ç»­ä¸¤ä¸ªæ ‡è®°ï¼ˆæ€»å¤æ‚åº¦ä¸ºè°ƒå’Œçº§æ•°ï¼‰ï¼Œæ±‚å®ƒä»¬å¯¹åº”åç¼€çš„ lcp å’Œå¯¹åº”å‰ç¼€çš„ lcsï¼ˆç¿»è½¬æ±‚ SA å³å¯ï¼‰ï¼Œå¦‚æœäºŒè€…åŠ èµ·æ¥ &lt;span class=&#34;math inline&#34;&gt;\(\ge len\)&lt;/span&gt; å°±è¯´æ˜å­˜åœ¨è¿™æ ·çš„ &lt;span class=&#34;math inline&#34;&gt;\(\texttt {AA}\)&lt;/span&gt;ã€‚åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\text {lcs}+\text {lcp}\)&lt;/span&gt; ä¸­ä»»å– &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; é•¿åº¦å³ä¸ºä¸€å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(\texttt {AA}\)&lt;/span&gt;ã€‚ç”¨å·®åˆ†ç»™å¯èƒ½çš„èµ·ç‚¹å’Œç»ˆç‚¹åŒºé—´åŠ å³å¯ã€‚&lt;/p&gt;
&lt;p&gt;å°ç»†èŠ‚ï¼šlcp å’Œ lcs å‡éœ€è¦å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; å– &lt;span class=&#34;math inline&#34;&gt;\(\min\)&lt;/span&gt;ï¼Œå¦åˆ™å–åˆ°çš„ä¸²å¯èƒ½ä¸ä¼šç»è¿‡å½“å‰é€‰ä¸­çš„ä¸¤ä¸ªæ ‡è®°ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
class SA &amp;#123;
public:
    std::vector&amp;lt;int&amp;gt; sa, rk, h;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt;  &amp;gt; st;
    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&amp;lt;int&amp;gt; (n + 1)) &amp;#123;
        std::vector&amp;lt;int&amp;gt; la(n + 2);
        std::copy(s.begin(), s.end(), rk.begin());
        int m = 128;
        &amp;#123;
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n; i; --i)
                sa[c[rk[i]]--] = i;
        &amp;#125;
        for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
            std::vector&amp;lt;int&amp;gt; id(1);
            for (int i = n - w + 1; i &amp;lt;= n; ++i)
                id.push_back(i);
            for (int i = 1; i &amp;lt;= n; ++i)
                if (sa[i] &amp;gt; w)
                    id.push_back(sa[i] - w);
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n; i; --i)
                sa[c[rk[id[i]]]--] = id[i];
            p = 0;
            std::copy(rk.begin(), rk.end(), la.begin());
            for (int i = 1; i &amp;lt;= n; ++i)
                if (la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
                    rk[sa[i]] = p;
                else
                    rk[sa[i]] = ++p;
            if (p == n)
                break;
        &amp;#125;
        for (int i = 1, to = 0; i &amp;lt;= n; ++i)
            if (rk[i]) &amp;#123;
                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);
                h[rk[i]] = to;
            &amp;#125;
        for (int i = 1; i &amp;lt;= n; ++i)
            st[0][i] = h[i];
        for (int j = 1; (1 &amp;lt;&amp;lt; j) &amp;lt;= n; ++j)
            for (int i = 1; i + (1 &amp;lt;&amp;lt; j) - 1 &amp;lt;= n; ++i)
                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &amp;lt;&amp;lt; (j - 1))]);
        rk.emplace_back();
        return;
    &amp;#125;
private:
    int ask(int l, int r) &amp;#123;
        // fprintf(stderr, &amp;quot;l = %d, r = %d\n&amp;quot;, l, r);
        int k = std::__lg(r - l + 1);
        return std::min(st[k][l], st[k][r - (1 &amp;lt;&amp;lt; k) + 1]);
    &amp;#125;
public:
    int lcp(int l, int r) &amp;#123;
        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));
    &amp;#125;
&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s;
        int n = (int)s.length();
        s = &amp;quot;#&amp;quot; + s;
        SA p(n, s);
        std::reverse(s.begin() + 1, s.end());
        SA q(n, s);
        std::vector&amp;lt;int&amp;gt; f(n + 2), g(n + 2);
        for (int len = 1; len &amp;lt;= n / 2; ++len)
            for (int i = len; i + len &amp;lt;= n; i += len) &amp;#123;
                int l = i, r = i + len, lcp = std::min(len, p.lcp(l, r)), lcs = std::min(len - 1, q.lcp(n - l + 2, n - r + 2));
                if (lcp + lcs &amp;gt;= len) &amp;#123;
                    int t = lcp + lcs - len + 1;
                    // fprintf(stderr, &amp;quot;(%d, %d), %d, %d\n&amp;quot;, l, r, lcp, lcs);
                    ++g[l - lcs], --g[l - lcs + t], ++f[r + lcp - t], --f[r + lcp];
                &amp;#125;
            &amp;#125;
        std::partial_sum(f.begin(), f.end(), f.begin());
        std::partial_sum(g.begin(), g.end(), g.begin());
        long long res = 0ll;
        for (int i = 1; i &amp;lt; n; ++i)
            res += (long long)f[i] * g[i + 1];
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;eg2.-tandem&#34;&gt;eg2. tandem&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.codechef.com/problems/TANDEM&#34; class=&#34;uri&#34;&gt;https://www.codechef.com/problems/TANDEM&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°å¤šäº†ä¸€ä¸ªé™åˆ¶ï¼Œå‰ä¸€ä¸ªå¥½å¤„ç†ï¼Œæ‰¾åˆ°ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(3\)&lt;/span&gt; ä¸ªæ ‡è®°çš„ä¸²å³å¯ã€‚å¯¹äºåä¸€ä¸ªé™åˆ¶ï¼Œç”»å›¾å¯ä»¥å‘ç°å¯¹äº interesting onesï¼Œæ¯æ¬¡åªä¼šå‡ºç°æœ€å¤šä¸€ä¸ªï¼›å½“ä¸”ä»…å½“ &lt;span class=&#34;math inline&#34;&gt;\(\text {lcp}&amp;gt;len\)&lt;/span&gt; æ—¶ä¸å­˜åœ¨ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº uninteresting onesï¼Œç”¨æ¯æ¬¡èƒ½æä¾›çš„æ€»æ•°å‡å» interesting ones çš„æ•°é‡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
class SA &amp;#123;
public:
    std::vector&amp;lt;int&amp;gt; sa, rk, h;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt;  &amp;gt; st;
    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&amp;lt;int&amp;gt; (n + 1)) &amp;#123;
        std::vector&amp;lt;int&amp;gt; la(n + 2);
        std::copy(s.begin(), s.end(), rk.begin());
        int m = 128;
        &amp;#123;
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n; i; --i)
                sa[c[rk[i]]--] = i;
        &amp;#125;
        for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
            std::vector&amp;lt;int&amp;gt; id(1);
            for (int i = n - w + 1; i &amp;lt;= n; ++i)
                id.push_back(i);
            for (int i = 1; i &amp;lt;= n; ++i)
                if (sa[i] &amp;gt; w)
                    id.push_back(sa[i] - w);
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n; i; --i)
                sa[c[rk[id[i]]]--] = id[i];
            p = 0;
            std::copy(rk.begin(), rk.end(), la.begin());
            for (int i = 1; i &amp;lt;= n; ++i)
                if (la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
                    rk[sa[i]] = p;
                else
                    rk[sa[i]] = ++p;
            if (p == n)
                break;
        &amp;#125;
        for (int i = 1, to = 0; i &amp;lt;= n; ++i)
            if (rk[i]) &amp;#123;
                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);
                h[rk[i]] = to;
            &amp;#125;
        for (int i = 1; i &amp;lt;= n; ++i)
            st[0][i] = h[i];
        for (int j = 1; (1 &amp;lt;&amp;lt; j) &amp;lt;= n; ++j)
            for (int i = 1; i + (1 &amp;lt;&amp;lt; j) - 1 &amp;lt;= n; ++i)
                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &amp;lt;&amp;lt; (j - 1))]);
        rk.emplace_back();
        return;
    &amp;#125;
private:
    int ask(int l, int r) &amp;#123;
        // fprintf(stderr, &amp;quot;l = %d, r = %d\n&amp;quot;, l, r);
        int k = std::__lg(r - l + 1);
        return std::min(st[k][l], st[k][r - (1 &amp;lt;&amp;lt; k) + 1]);
    &amp;#125;
public:
    int lcp(int l, int r) &amp;#123;
        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));
    &amp;#125;
&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    int n = (int)s.length();
    s = &amp;quot;#&amp;quot; + s;
    SA p(n, s);
    std::reverse(s.begin() + 1, s.end());
    SA q(n, s);
    std::reverse(s.begin() + 1, s.end());
    long long res1 = 0ll, res2 = 0ll;
    for (int len = 1; len &amp;lt;= n; ++len)
        for (int i = len, j = 2 * len, k = 3 * len; k &amp;lt;= n; i += len, j += len, k += len) &amp;#123;
            int lcp = std::min(p.lcp(i, j), p.lcp(j, k)), lcs = std::min(&amp;#123; len - 1, q.lcp(n - i + 2, n - j + 2), q.lcp(n - j + 2, n - k + 2) &amp;#125;);
            if (std::min(len, lcp) + lcs &amp;gt;= len) &amp;#123;
                // printf(&amp;quot;(%d, %d, %d), %d, %d, %d\n&amp;quot;, i, j, k, lcs, lcp, len);
                int t = (lcp &amp;lt;= len);
                res1 += t, res2 += std::min(len, lcp) + lcs - len + 1 - t;
            &amp;#125;
            // else
            //     printf(&amp;quot;# (%d, %d, %d), %d, %d, %d\n&amp;quot;, i, j, k, lcs, lcp, len);
        &amp;#125;
    std::cout &amp;lt;&amp;lt; res1 &amp;lt;&amp;lt; &amp;#39; &amp;#39; &amp;lt;&amp;lt; res2 &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h4 id=&#34;eg3.-repeats&#34;&gt;eg3. repeats&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.spoj.com/problems/REPEATS/&#34; class=&#34;uri&#34;&gt;https://www.spoj.com/problems/REPEATS/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é‡å¤æ¬¡æ•°æœ€å¤šï¼Œåªéœ€ç»è¿‡æ ‡è®°ç‚¹æœ€å¤šã€‚æ˜¾ç„¶ç»è¿‡æ ‡è®°ç‚¹çš„æ•°é‡å°±æ˜¯è¯¥å­—ç¬¦ä¸²é•¿é™¤ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; å‘ä¸‹å–æ•´å°±å¯ä»¥å¾—åˆ°é‡å¤æ¬¡æ•°å‡ &lt;span class=&#34;math inline&#34;&gt;\(1\)&lt;/span&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;é€‰æ‹©ä¸¤ä¸ªè¿ç»­æ ‡è®°ç‚¹ï¼Œå¯¹äº lcp å’Œ lcsï¼ˆæ˜¾ç„¶æ­¤æ—¶ä¸éœ€è¦å¯¹ &lt;span class=&#34;math inline&#34;&gt;\(len\)&lt;/span&gt; å– &lt;span class=&#34;math inline&#34;&gt;\(\min\)&lt;/span&gt;ï¼‰ï¼Œè®¡ç®— &lt;span class=&#34;math inline&#34;&gt;\(\dfrac {\text{lcp}+\text{lcs}}{len}+1\)&lt;/span&gt; å–æœ€å¤§å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
class SA &amp;#123;
public:
    std::vector&amp;lt;int&amp;gt; sa, rk, h;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt;  &amp;gt; st;
    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&amp;lt;int&amp;gt; (n + 1)) &amp;#123;
        std::vector&amp;lt;int&amp;gt; la(n + 2);
        std::copy(s.begin(), s.end(), rk.begin());
        int m = 128;
        &amp;#123;
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n; i; --i)
                sa[c[rk[i]]--] = i;
        &amp;#125;
        for (int w = 1, p; ; w &amp;lt;&amp;lt;= 1, m = p) &amp;#123;
            std::vector&amp;lt;int&amp;gt; id(1);
            for (int i = n - w + 1; i &amp;lt;= n; ++i)
                id.push_back(i);
            for (int i = 1; i &amp;lt;= n; ++i)
                if (sa[i] &amp;gt; w)
                    id.push_back(sa[i] - w);
            std::vector&amp;lt;int&amp;gt; c(m + 1);
            for (int i = 1; i &amp;lt;= n; ++i)
                ++c[rk[i]];
            std::partial_sum(c.begin(), c.end(), c.begin());
            for (int i = n; i; --i)
                sa[c[rk[id[i]]]--] = id[i];
            p = 0;
            std::copy(rk.begin(), rk.end(), la.begin());
            for (int i = 1; i &amp;lt;= n; ++i)
                if (la[sa[i]] == la[sa[i - 1]] &amp;amp;&amp;amp; la[sa[i] + w] == la[sa[i - 1] + w])
                    rk[sa[i]] = p;
                else
                    rk[sa[i]] = ++p;
            if (p == n)
                break;
        &amp;#125;
        for (int i = 1, to = 0; i &amp;lt;= n; ++i)
            if (rk[i]) &amp;#123;
                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);
                h[rk[i]] = to;
            &amp;#125;
        for (int i = 1; i &amp;lt;= n; ++i)
            st[0][i] = h[i];
        for (int j = 1; (1 &amp;lt;&amp;lt; j) &amp;lt;= n; ++j)
            for (int i = 1; i + (1 &amp;lt;&amp;lt; j) - 1 &amp;lt;= n; ++i)
                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &amp;lt;&amp;lt; (j - 1))]);
        rk.emplace_back();
        return;
    &amp;#125;
private:
    int ask(int l, int r) &amp;#123;
        // fprintf(stderr, &amp;quot;l = %d, r = %d\n&amp;quot;, l, r);
        int k = std::__lg(r - l + 1);
        return std::min(st[k][l], st[k][r - (1 &amp;lt;&amp;lt; k) + 1]);
    &amp;#125;
public:
    int lcp(int l, int r) &amp;#123;
        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));
    &amp;#125;
&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int T;
    for (std::cin &amp;gt;&amp;gt; T; T--; ) &amp;#123;
        int n;
        std::cin &amp;gt;&amp;gt; n;
        std::string s = &amp;quot;#&amp;quot;;
        for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
            char t;
            std::cin &amp;gt;&amp;gt; t;
            s.push_back(t);
        &amp;#125;
        SA p(n, s);
        std::reverse(s.begin() + 1, s.end());
        SA q(n, s);
        int res = 0;
        for (int len = 1; len &amp;lt;= n; ++len)
            for (int i = len, j = 2 * len; j &amp;lt;= n; i += len, j += len) &amp;#123;
                int lcp = p.lcp(i, j), lcs = q.lcp(n - i + 2, n - j + 2);
                if (lcp + lcs &amp;gt;= len)
                    res = std::max(res, (lcp + lcs) / len + 1);
            &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ç»“åˆå¹¶æŸ¥é›†&#34;&gt;ç»“åˆå¹¶æŸ¥é›†&lt;/h3&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;ç»“åˆå•è°ƒæ ˆ&#34;&gt;ç»“åˆå•è°ƒæ ˆ&lt;/h3&gt;
</content>
        <category term="å­—ç¬¦ä¸²" />
        <category term="SA" />
        <updated>2025-02-02T00:27:44.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250121/</id>
        <title>æŠ€å·§ï¼šå­—ç¬¦ä¸²æ‹†åˆ†</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250121/"/>
        <content type="html">&lt;p&gt;ç¥åˆ˜å®¶åœ¨èµ°å‰ä½“è‚²è¯¾ä¸Šé—®æˆ‘å¬æ²¡å¬è¿‡ &lt;em&gt;Die For You - The Weekend&lt;/em&gt;ã€‚æˆ‘è®©ä»–å“¼ä¸€æ®µï¼Œåˆ˜å®¶ä¾¿å±•ç¤ºäº†è‡ªå·±çš„å¤©ç±ä¹‹éŸ³ï¼Œæˆ‘ç†æ‰€å½“ç„¶åœ°è¿æ—‹å¾‹éƒ½æ²¡è¾¨è®¤å‡ºæ¥ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;hr /&gt;
&lt;p&gt;æœ‰çš„æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªå®Œæ•´çš„åŒ¹é…ä¸²ï¼Œæˆ‘ä»¬éœ€è¦ã€Œæšä¸¾æ–­ç‚¹ã€ï¼Œåˆ†ä¸ºå‰åŠæ®µå’ŒååŠæ®µåˆ†åˆ«å’Œæ¨¡å¼ä¸²åŒ¹é…è§£å†³é—®é¢˜ã€‚å½“ç„¶è¿™æ ·çš„æŠ€å·§ä¸æ­¢å±€é™äºå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„å­¦ä¹ ä¸­åœ¨è¯¸å¦‚åŠ¨æ€è§„åˆ’ç­‰é¢˜ç›®ä¸­é‡åˆ°äº†ç›¸ä¼¼çš„æƒ…æ™¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å­—ç¬¦ä¸²é¢˜ç›®ä¸­ï¼Œä¸€ä¸ªå…¸å‹çš„æ ‡å¿—æ˜¯ã€Œæ¨¡å¼ä¸²çš„æ‹¼æ¥ã€ï¼Œå°†ä¸¤æˆªæ¨¡å¼ä¸²æ‹¼æ¥åˆ°ä¸€èµ·ï¼Œå½¢æˆçš„æ–°æ¨¡å¼ä¸²å¹¶ä¸åˆ©å¥½æˆ‘ä»¬çš„å¤„ç†ï¼Œæˆ‘ä»¬éœ€è¦å°½é‡åˆ©ç”¨å·²çŸ¥çš„æ¨¡å¼ä¸²ã€‚å½“ç„¶æˆ‘ä»¬ä¸ä¼šå°†æ–°æ¨¡å¼ä¸²é‡æ–°æ‹†æˆä¸¤åŠï¼Œè€Œæ˜¯è€ƒè™‘è½¬æ¢ï¼Œæšä¸¾åŒ¹é…ä¸²çš„æ–­ç‚¹ï¼Œå°†å‰åŠæ®µçš„åç¼€å’ŒååŠæ®µçš„å‰ç¼€åˆ†åˆ«åŒ¹é…ã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ä¸€ä¸ªæ¨¡æ¿cf1202e-you-are-given-some-strings&#34;&gt;ä¸€ä¸ªæ¨¡æ¿ï¼šCF1202E You Are Given Some Stringsâ€¦&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1202/E&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1202/E&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è™½ç„¶å¯¹äºæ¯ç§ä¸åŒæ‹¼æ¥éœ€è¦æ±‚è§£åˆ†åˆ«çš„å‡ºç°æ¬¡æ•°ï¼Œä½†æ˜¯æ³¨æ„åˆ°æœ€ååªéœ€è¦è¾“å‡º &lt;span class=&#34;math inline&#34;&gt;\(f\)&lt;/span&gt; çš„æ€»å’Œï¼Œæ‰€ä»¥å°±å¯ä»¥ä¸å†é¡¾åŠä¸åŒæ‹¼æ¥æ–¹å¼é—´çš„åŒºåˆ«ã€‚&lt;/p&gt;
&lt;p&gt;æšä¸¾åŒ¹é…ä¸²çš„æ–­ç‚¹ã€‚ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•æ˜¯å°†å‰åç¼€ä¸ AC è‡ªåŠ¨æœºåŒ¹é…ï¼Œä½†å¦‚æœé€ä¸ªæ”¾è¿›å»æ˜¾ç„¶å¤æ‚åº¦èµ·é£ã€‚è¿™é‡Œå°±åˆæœ‰ä¸€ä¸ªå®ç°å°æŠ€å·§ï¼Œæˆ‘ä»¬åœ¨åŸä¸²çš„ AC è‡ªåŠ¨æœºä¸ŠæŠŠåŸä¸²è¿‡ä¸€éï¼Œæ¯ä¸ªä½ç½®æ‰€åœ¨çš„çŠ¶æ€å°±æ˜¯è¿™ä¸ªä½ç½®å¯¹åº”åç¼€å¯èƒ½å¤„åœ¨çš„åç¼€ã€‚&lt;/p&gt;
&lt;p&gt;è®°å½•æ¯ä¸ªçŠ¶æ€å¯èƒ½å¤„åœ¨çš„æ¨¡å¼ä¸²æœ«å°¾ä¸ªæ•°ï¼Œè¿™ä¸€ç‚¹ç›´æ¥åœ¨ fail æ ‘ä¸Šä»ä¸Šåˆ°ä¸‹è½¬ç§»å³å¯ã€‚åä¸²åŒç†ã€‚&lt;/p&gt;
&lt;p&gt;äºŒè€…ç›¸ä¹˜å³ä¸ºç­”æ¡ˆã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
struct &amp;#123;
    int T[maxn][26], tot, cnt[maxn], fail[maxn], deg[maxn];
    void ins(std::string &amp;amp;t) &amp;#123;
        int p = 0;
        for (auto i : t) &amp;#123;
            if (!T[p][i - &amp;#39;a&amp;#39;])
                T[p][i - &amp;#39;a&amp;#39;] = ++tot;
            p = T[p][i - &amp;#39;a&amp;#39;];
        &amp;#125;
        ++cnt[p];
        return;
    &amp;#125;
    void bld(void) &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], cnt[v] += cnt[fail[v]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
        return;
    &amp;#125;
&amp;#125; p, q;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    int n;
    std::cin &amp;gt;&amp;gt; n;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t;
        p.ins(t);
        std::reverse(t.begin(), t.end());
        q.ins(t);
    &amp;#125;
    p.bld(), q.bld();
    int len = s.length();
    std::vector&amp;lt;std::array&amp;lt;int, 2&amp;gt; &amp;gt; f(len + 1);
    &amp;#123;
        int u = 0;
        for (int i = 1; i &amp;lt;= len; ++i) &amp;#123;
            u = p.T[u][s[i - 1] - &amp;#39;a&amp;#39;];
            f[i][0] = p.cnt[u];
        &amp;#125;
    &amp;#125;
    &amp;#123;
        int u = 0;
        for (int i = len; i; --i) &amp;#123;
            u = q.T[u][s[i - 1] - &amp;#39;a&amp;#39;];
            f[i][1] = q.cnt[u];
        &amp;#125;
    &amp;#125;
    long long res = 0ll;
    for (int i = 1; i &amp;lt; len; ++i)
        res += (long long)f[i][0] * f[i + 1][1];
    std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å˜å¼ä¼˜ç§€çš„æ‹†åˆ†&#34;&gt;å˜å¼ï¼šä¼˜ç§€çš„æ‹†åˆ†&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P1117&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P1117&lt;/a&gt;&lt;/p&gt;
</content>
        <category term="å­—ç¬¦ä¸²" />
        <updated>2025-01-21T03:47:06.000Z</updated>
    </entry>
    <entry>
        <id>https://xsc062.netlify.app/20250120/</id>
        <title>å­¦ä¹ ç¬”è®°ï¼šAC è‡ªåŠ¨æœº</title>
        <link rel="alternate" href="https://xsc062.netlify.app/20250120/"/>
        <content type="html">&lt;p&gt;è€³æœºå£°éŸ³ç–‘ä¼¼æœ‰ç‚¹å°äº†ï¼Œç”¨å¿ƒæ—·ç¥æ€¡çš„è¯æ¥è¯´å¤§è‡´ä¼šæ˜¯ã€Œæ¯”æœè‡â†‘å—¡å—¡å£°è¿˜å°ã€ã€‚&lt;/p&gt;
&lt;span id=&#34;more&#34;&gt;&lt;/span&gt;
&lt;p&gt;ï¼Ÿå§æ§½è€³æœºä¸Šå±…ç„¶å¯ä»¥è°ƒéŸ³é‡ &lt;img src=&#34;/em/oh.gif&#34; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å‰ç½®çŸ¥è¯†&#34;&gt;å‰ç½®çŸ¥è¯†&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆå¯èƒ½éœ€è¦çŸ¥é“ä¸“æœ‰åè¯ã€Œè‡ªåŠ¨æœºã€çš„å«ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;å¤§è‡´å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œä¸€ä¸ª DAGï¼Œå…¶ä¸­ç‚¹è¡¨ç¤ºçŠ¶æ€ï¼Œè¾¹è¡¨ç¤ºè½¬ç§»ã€‚ç»™è¿›å»ä¸€ä¸ªå­—ç¬¦ä¸²ä¹‹ç±»ï¼Œå°±å¯ä»¥åœ¨ DAG ä¸Šæ¸¸èµ°ï¼Œæ ¹æ®æœ€åæ‰€å¤„ç»“ç‚¹ï¼Œå¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ç›¸å…³ç‰¹å¾ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªå®šä¹‰è®©æˆ‘ä»¬æƒ³åˆ°äº† Trieã€‚äº‹å®ä¸Šï¼ŒTrie å°±æ˜¯ä¸€ç§ç›¸å½“åŸºç¡€çš„è‡ªåŠ¨æœºã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¤ä¹  KMP ç›¸å…³æ¦‚å¿µã€‚&lt;/p&gt;
&lt;p&gt;å‡æƒ³ä¸€ä¸ªåœºæ™¯ï¼šä½ éœ€è¦æ±‚å¾— &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æ‹¥æœ‰ä¸€å®šé¢˜ç›®ç»éªŒçš„ä½ ï¼Œä¼šä½¿ç”¨ KMP æ±‚å‡º &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; çš„ &lt;code&gt;next&lt;/code&gt; æ•°ç»„ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸Šè¿›è¡ŒåŒ¹é…ï¼Œå¤±é…æˆ–å®Œå…¨åŒ¹é…æ—¶å›åˆ° &lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; åœ¨è¯¥å¤„çš„ &lt;code&gt;next&lt;/code&gt;ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸Šçš„æŒ‡é’ˆå§‹ç»ˆå‘å³ï¼Œ&lt;span class=&#34;math inline&#34;&gt;\(T\)&lt;/span&gt; ä¸Šçš„æŒ‡é’ˆå¦‚æœå‘å³ï¼Œæ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä½ï¼›å¦‚æœå‘å·¦ï¼Œæœ€å·¦ç§»åˆ°å¼€å¤´ï¼Œå‡æ‘Šä¸‹æ¥å¤æ‚åº¦å³ä¸º &lt;span class=&#34;math inline&#34;&gt;\(O(|S| + |T|)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å‡å¦‚åœºæ™¯å˜å¾—æ›´å¤æ‚ï¼šç»™å®š &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt;ï¼Œä½ éœ€è¦æ±‚å‡ºæ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¯¹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(T_j\)&lt;/span&gt; è¿›è¡Œä¸€æ¬¡ KMPï¼Œå¤æ‚åº¦å°†ä¼šä¸Šå‡åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(m|S|)\)&lt;/span&gt;ï¼Œéš¾ä»¥æ‰¿å—ã€‚æœ‰æ²¡æœ‰ä¼˜åŒ–çš„æ–¹æ³•å‘¢ï¼Ÿ&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºçš„å»ºç«‹&#34;&gt;AC è‡ªåŠ¨æœºçš„å»ºç«‹&lt;/h2&gt;
&lt;p&gt;ç»“åˆä¸Šé¢çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¸‹æ„è¯†æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½å°† &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt; å»ºæˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œä»¤ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; åœ¨å…¶ä¸Šè¿›è¡Œ KMP å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å°† &lt;span class=&#34;math inline&#34;&gt;\(\{T_m\}\)&lt;/span&gt; å…¨éƒ¨åŠ å…¥ Trieï¼Œç”±äº &lt;code&gt;next&lt;/code&gt; åªä¼šç”±æ›´æ·±çš„ç‚¹æŒ‡å‘æ›´æµ…çš„ç‚¹ï¼Œä¼¼ä¹ä»ç›´è§‰ä¸Šæ˜¯æœ‰è§„åˆ™çš„ã€‚ä½†éšä¹‹è€Œæ¥çš„æ˜¯ä¸€ä¸ªé—®é¢˜ï¼šç‚¹ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;next&lt;/code&gt; ä¸ä¸€å®šåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(\text{root}\to u\)&lt;/span&gt; çš„é“¾ä¸Šï¼ˆç”±äº Trie çš„æ€§è´¨ï¼Œå¯çŸ¥æŒ‡å‘çš„ç‚¹æ˜¯å”¯ä¸€çš„ï¼‰ã€‚é‰´äºè¿™ä¸€ç‚¹ä¸åŒï¼Œæˆ‘ä»¬ç»“åˆå…¶ã€Œå¤±é…æŒ‡é’ˆã€çš„å®šä¹‰ï¼Œå°† &lt;code&gt;next&lt;/code&gt; åœ¨ Trie ä¸Šçš„åŒåˆ†å¼‚æ„ä½“å”¤ä¸º &lt;code&gt;fail&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒå¯Ÿ Trie ä¸Šè¯¥ &lt;code&gt;fail&lt;/code&gt; è¾¹çš„æ€§è´¨ã€‚ç°æ¬²æ±‚è§£ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; æŒ‡å‘çš„ &lt;span class=&#34;math inline&#34;&gt;\(c\)&lt;/span&gt;ï¼Œç»“åˆ KMP ä¸­ &lt;code&gt;next&lt;/code&gt; çš„æ€§è´¨ï¼Œå‡è®¾ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„çˆ¶èŠ‚ç‚¹çš„ &lt;code&gt;fail&lt;/code&gt; è¾¹æŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt;ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„å€¼ä¸ºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt; ä¸Šæœ‰è¾¹æƒç›¸åŒçš„è¾¹ï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; å°±æ˜¯è¯¥è¾¹æŒ‡å‘çš„ç‚¹ã€‚&lt;/li&gt;
&lt;li&gt;å¦åˆ™ï¼Œå‰å¾€ &lt;span class=&#34;math inline&#34;&gt;\(v&amp;#39;\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt;ï¼Œé‡å¤ä»¥ä¸Šåˆ¤å®šã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é‚£ä¹ˆå°±å®Œæˆäº†å¤±é…çš„å¤„ç†ã€‚ç›¸åº”åœ°ï¼Œå®Œå…¨åŒ¹é…æ—¶çš„è·³è½¬åº”å¦‚ä½•å¤„ç†ï¼Ÿç›´æ¥å°† &lt;code&gt;fail&lt;/code&gt; çš„å„¿å­å…¨éƒ¨æ¥åˆ° &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä¸‹é¢å³å¯ã€‚å¦‚æœ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; å’Œ &lt;code&gt;fail&lt;/code&gt; å…·æœ‰åŒä¸€ä¸ªè¾¹æƒçš„è¾¹æ—¶ï¼Œä¿ç•™ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„è¿™æ¡è¾¹ &lt;span class=&#34;math inline&#34;&gt;\(u\to v\)&lt;/span&gt;ï¼Œå› ä¸º &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; å¿…å®šæŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; çš„å¯¹åº”å„¿å­ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¤ç‚¹ç»“åˆï¼Œæˆ‘ä»¬å‘ç°ä»å®ç°ä¸Šï¼Œå¯ä»¥ç›´æ¥ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; æŒ‡å‘ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ &lt;code&gt;fail&lt;/code&gt; çš„å¯¹åº”å„¿å­ï¼ˆé‚£ä¹ˆæ—¶é—´å¤æ‚åº¦æ˜¾è€Œæ˜“è§æ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(O(26\sum |T|)\)&lt;/span&gt; çš„ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åŒ¹é…æ—¶ï¼Œå¯¹äºæ¯ä¸ªç‚¹å’Œå…¶è¿”å›åˆ°æ ¹çš„ &lt;code&gt;fail&lt;/code&gt; é“¾ï¼Œå…¨éƒ¨æ ‡è®°ã€‚åˆ™ä¸€ä¸ªæ¨¡å¼ä¸²åŒ¹é…çš„æ¬¡æ•°å³ä¸ºè¢«æ‰“æ ‡è®°çš„æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆå¯ä»¥å‘ç° AC è‡ªåŠ¨æœºçš„æœ¬è´¨å°±æ˜¯æ·»åŠ äº† &lt;code&gt;fail&lt;/code&gt; è¾¹çš„ Trieã€‚&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;é‚£ä¹ˆæ ¹æ®ä¸Šè¿°è¦æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§æ·±åº¦é¡ºåºæ±‚å¾— &lt;code&gt;fail&lt;/code&gt;ï¼Œè€ƒè™‘ BFSã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å“¦å“¦å¥½ç¥å¥‡å¤æ´»ä¹‹åè®°å¾—å•¥æ˜¯ KMP ä½†å¿˜äº†å•¥æ˜¯ C++ äº†ã€‚ç”šè‡³èŠ±äº†ä¸€ç‚¹æ—¶é—´å­¦ä¹ æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Ÿï¼Ÿï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¤§å®¶å†™ AC è‡ªåŠ¨æœº Trie æ ¹èŠ‚ç‚¹ä¸‹æ ‡ä¸€å®šè¦è®¾æˆ 0 å•Š &lt;img src=&#34;/em/ll.gif&#34; /&gt; è®¾æˆ 1 è¢«å„ç§ç»†èŠ‚å‘æƒ¨äº† &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, cnt[maxn], fail[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    &amp;#123;
        int p = 0;
        for (auto i : s) &amp;#123;
            p = T[p][i - &amp;#39;a&amp;#39;];
            for (int fa = p; fa; fa = fail[fa])
                ++cnt[fa];
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; cnt[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;p&gt;è‚‰çœ¼å¯è§è¯¥æŸ¥è¯¢æ–¹å¼æ˜¯æå…¶ä½æ•ˆçš„ï¼Œæ•…è€ƒè™‘ä¼˜åŒ–è·³ &lt;code&gt;fail&lt;/code&gt; æ‰“æ ‡è®°çš„è¿‡ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;æ—¢ç„¶è‡ªåŠ¨æœºç»“æ„ä¸å˜ï¼Œä¸å¦‚å°†è·³ &lt;code&gt;fail&lt;/code&gt; çš„æ­¥éª¤æ”¾åœ¨æœ€åç»Ÿä¸€è¿›è¡Œã€‚å®¹æ˜“åœ¨å‘ç° &lt;code&gt;fail&lt;/code&gt; æ ‘ä¸Šè¿›è¡Œæ‹“æ‰‘æ’åºè½¬ç§»å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, cnt[maxn], fail[maxn], deg[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::string s;
    std::cin &amp;gt;&amp;gt; s;
    &amp;#123;
        int p = 0;
        for (auto i : s)
            p = T[p][i - &amp;#39;a&amp;#39;], ++cnt[p];
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 1; i &amp;lt;= tot; ++i)
            if (!deg[i])
                q.push(i);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            cnt[fail[u]] += cnt[u];
            if (!--deg[fail[u]])
                q.push(fail[u]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cout &amp;lt;&amp;lt; cnt[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«&#34;&gt;AC è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“å…¶æœ€å…¸å‹çš„ç‰¹å¾æ˜¯ &lt;strong&gt;å¤šæ¨¡å¼ä¸²&lt;/strong&gt;ã€&lt;strong&gt;é™æ€ / ç¦»çº¿&lt;/strong&gt;ã€‚å½“ç¢°åˆ°ç±»ä¼¼ç‰¹ç‚¹æ—¶ï¼Œå¤§æ¦‚ç‡å°±æ˜¯ AC è‡ªåŠ¨æœºã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ï¼Œå¯ä»¥è®¾ç½®çš„éš¾ç‚¹æœ‰ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;å­—ç¬¦ä¸²éš¾ç‚¹ï¼Œå’Œå…¶ä»–å­—ç¬¦ä¸²é¢˜å¯è®¾ç½®çš„éš¾ç‚¹ç›¸åŒã€‚&lt;/li&gt;
&lt;li&gt;fail æ ‘ç»´æŠ¤ï¼Œå¯èƒ½ç»“åˆæ•°æ®ç»“æ„ã€æ‹“æ‰‘æ’åºã€æ ‘å½¢ DP ç­‰è€ƒå¯Ÿã€‚&lt;/li&gt;
&lt;li&gt;DP çš„è®¾è®¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡&#34;&gt;å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡&lt;/h2&gt;
&lt;h3 id=&#34;eg.-indie-album&#34;&gt;eg. Indie Album&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/1207/G&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/1207/G&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¢˜ç›®çš„ã€Œå¯æŒä¹…åŒ–ã€è¯•å›¾è¯¯å¯¼æˆ‘ä»¬ç”¨æ“ä½œä¸²å»ºç«‹è‡ªåŠ¨æœºï¼Œä½†è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æ±‚ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; çš„å‡ºç°æ¬¡æ•°ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¿è¯ç­”æ¡ˆå¯æ±‚æˆ‘ä»¬ä»ç„¶åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; ä¸Šå»ºç«‹ ACAMã€‚å®¹æ˜“å‘ç°æ“ä½œä¸²ä»¥ Trie å½¢å¼ç»™å‡ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éå† Trie æ—¶åŒæ—¶å®Œæˆæ¸¸èµ°ï¼Œé€šè¿‡å›æº¯å®Œæˆè¯¢é—®ã€‚&lt;/p&gt;
&lt;p&gt;å‡è®¾å½“å‰ DFS ä¸­ï¼Œéå†åˆ° Trie æ ‘ä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç‚¹å’Œè‡ªåŠ¨æœºä¸­çš„ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çŠ¶æ€ï¼Œé‚£ä¹ˆå¯¹äº &lt;span class=&#34;math inline&#34;&gt;\(x\)&lt;/span&gt; ç‚¹æ‰€å¯¹åº”çš„ä¸€ä¸ªè¯¢é—®ä¸² &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt;ï¼Œç›¸å½“äºè¯¢é—®ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€æœ‰å¤šå°‘ä¸ªåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(t\)&lt;/span&gt; å¼•å¯¼çš„ fail æ ‘å­æ ‘ä¸­ã€‚æˆ‘ä»¬æ±‚å‡º fail æ ‘çš„ dfnï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç®€å•ç»Ÿè®¡å³å¯ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 4e5 + 5;
std::vector&amp;lt;int&amp;gt; g[maxn], q[maxn];
int fail[maxn], T[maxn][26], tot, bit[maxn], to[maxn][26], cnt[maxn];
int ins(std::string s) &amp;#123;
    int p = 0;
    for (auto i : s) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int lowbit(int x) &amp;#123;
    return x &amp;amp; -x;
&amp;#125;
void add(int x, int v) &amp;#123;
    for (; x &amp;lt;= tot + 1; x += lowbit(x))
        bit[x] += v;
    return;
&amp;#125;
int ask(int x) &amp;#123;
    int res = 0;
    for (; x; x -= lowbit(x))
        res += bit[x];
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, now = 0;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; id(n + 1);
    for (int i = 1, op; i &amp;lt;= n; ++i) &amp;#123;
        char t;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            std::cin &amp;gt;&amp;gt; t;
            if (!to[0][t - &amp;#39;a&amp;#39;])
                to[0][t - &amp;#39;a&amp;#39;] = ++now;
            ++cnt[to[0][t - &amp;#39;a&amp;#39;]], id[i] = to[0][t - &amp;#39;a&amp;#39;];
        &amp;#125;
        else &amp;#123;
            int j; 
            std::cin &amp;gt;&amp;gt; j &amp;gt;&amp;gt; t;
            if (!to[id[j]][t - &amp;#39;a&amp;#39;])
                to[id[j]][t - &amp;#39;a&amp;#39;] = ++now;
            ++cnt[to[id[j]][t - &amp;#39;a&amp;#39;]], id[i] = to[id[j]][t - &amp;#39;a&amp;#39;];
        &amp;#125;
    &amp;#125;
    int m;
    std::cin &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; tail(m + 1), res(m + 1);
    for (int i = 1, x; i &amp;lt;= m; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; x &amp;gt;&amp;gt; t, tail[i] = ins(t);
        q[id[x]].push_back(i);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]), g[0].push_back(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v), g[fail[v]].push_back(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; dfn(tot + 1), rfn(tot + 1);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        dfn[x] = ++now;
        // printf(&amp;quot;%d &amp;quot;, x);
        for (auto i : g[x])
            DFS(i);
        rfn[x] = now;
        return;
    &amp;#125;;
    DFS(0);
    std::function&amp;lt;void(int, int)&amp;gt; DFS1 = [&amp;amp;](int x, int u) &amp;#123;
        add(dfn[u], 1);
        for (auto i : q[x])
            res[i] += ask(rfn[tail[i]]) - ask(dfn[tail[i]] - 1);
        for (int i = 0; i &amp;lt; 26; ++i)
            if (to[x][i])
                DFS1(to[x][i], T[u][i]);
        add(dfn[u], -1);
        return;
    &amp;#125;;
    DFS1(0, 0);
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; res[i] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;fail-æ ‘çš„ç»´æŠ¤&#34;&gt;fail æ ‘çš„ç»´æŠ¤&lt;/h2&gt;
&lt;h3 id=&#34;eg.-divljak&#34;&gt;eg. Divljak&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P5840&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P5840&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&#34;æ³•ä¸€æŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿&#34;&gt;æ³•ä¸€ï¼šæŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿&lt;/h4&gt;
&lt;p&gt;é—®é¢˜ç›¸å½“äºå°†æ¨¡å¼ä¸² &lt;span class=&#34;math inline&#34;&gt;\(T:\{P\}\)&lt;/span&gt; åŠ¨æ€åŒ–ï¼Œä½†æˆ‘ä»¬ä»å¯ä»¥æ— è„‘ç¦»çº¿ä¸‹æ¥è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘åŸæœ¬çš„ç­”æ¡ˆè®¡ç®—è¿‡ç¨‹ï¼Œå³åœ¨ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€åŠå…¶ fail é“¾ä¸Šæ‰“æ ‡è®°ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ç¦»çº¿å¹¶åŒºåˆ†æ ‡è®°çš„æ¥æºï¼ˆå¹¶ä¸”æ ‡è®°ç±»å‹ä¸ºå¸ƒå°”å€¼ï¼‰ï¼Œä¸‹æ„è¯†æƒ³åˆ°ä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹æ¯ä¸ªçŠ¶æ€å»ºç«‹åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œæœ€åæ‹“æ‰‘æ’åºæ—¶ä½¿ç”¨çº¿æ®µæ ‘åˆå¹¶å¤„ç†ä¿¡æ¯ã€‚å®¹æ˜“è¯æ˜æ—¶é—´å¤æ‚åº¦ç›¸è¾ƒåŸæ¥å¤šäº†ä¸€ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(\log\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;del&gt;ç†è®ºå¯è¡Œï¼Œå¼€å§‹å®è·µ&lt;/del&gt; å‡ºé¢˜äººä¼¼ä¹ä¸æ˜¯å¾ˆå–œæ¬¢çº¿æ®µæ ‘é€‰æ‰‹æ‰€ä»¥å†³å®šå‰¥å¤ºä½ çš„ Memory Limitã€‚æƒ³è¦ç”¨è¿™ç§åšæ³•é€šè¿‡æœ¬é¢˜å¯è§ &lt;a href=&#34;https://www.luogu.com.cn/article/jaxk3sno&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/article/jaxk3sno&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ³•äºŒè½¬è€Œå¤„ç†é™æ€é—®é¢˜&#34;&gt;æ³•äºŒï¼šè½¬è€Œå¤„ç†é™æ€é—®é¢˜&lt;/h4&gt;
&lt;p&gt;æ³¨æ„åˆ°é¢˜ç›®ä¸­çš„é™æ€çš„ &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt; æ¯”èµ· &lt;span class=&#34;math inline&#34;&gt;\(T:\{P\}\)&lt;/span&gt; æ›´é€‚åˆç”¨æ¥åšæ¨¡å¼ä¸²ï¼Œæˆ‘ä»¬åœ¨ &lt;span class=&#34;math inline&#34;&gt;\(S_x\)&lt;/span&gt; ä¸Šæ„å»º AC è‡ªåŠ¨æœºï¼Œè€ƒè™‘åœ¨çº¿è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æ¯æ¬¡ &lt;code&gt;1&lt;/code&gt; æ“ä½œæ—¶ï¼Œæ›´æ–°æ¨¡å¼ä¸²ä¿¡æ¯ã€‚å¯¹äºé€”å¾„çš„æ‰€æœ‰çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(\{u\}\)&lt;/span&gt;ï¼Œè€ƒè™‘æ›´æ–°å…¶æ‰€åœ¨ fail é“¾ä¸Šçš„ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦ä¿®æ”¹æ•´æ¡ fail é“¾ä¸Šçš„ä¿¡æ¯ï¼Œè¯¢é—®åˆ™æ˜¯è¯¢é—®å•ç‚¹ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨æ ‘ä¸Šå·®åˆ†ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ here comes a problemï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸€æ•´ä¸ªä¸²åªèƒ½åœ¨æ•´ä¸ªæ ‘ä¸Šæ¯ä¸ªç‚¹ä¸Šæ›´æ–°ä¸€æ¬¡ã€‚æ€ä¹ˆæ¶ˆå»ç›¸åŒçš„å½±å“å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå®ç°ä¸Šæˆ‘ä»¬å°†ç»è¿‡çš„ç‚¹æŒ‰ fail æ ‘ä¸Š dfn æ’åºï¼Œå¹¶ä¸”å¯¹äºåºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ç‚¹åœ¨å…¶ LCA ä¸Šå‡å»ä¸€æ¬¡æ ‡è®°ã€‚ä¸ºä»€ä¹ˆè¿™æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿå‚è€ƒè™šæ ‘ï¼Œæˆ‘ä»¬åªéœ€è¦è®©åºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ä¸ªç‚¹å°½é‡è¿‘å°±å¯ä»¥ä¿è¯é‡å¤çš„è¢«åˆ é™¤å®Œæ¯•ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e6 + 5;
int tot, bit[maxn], T[maxn][26], fail[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
int lowbit(int x) &amp;#123;
    return x &amp;amp; -x;
&amp;#125;
void add(int x, int v) &amp;#123;
    // printf(&amp;quot;add (%d, %d)\n&amp;quot;, x, v);
    for (; x &amp;lt;= tot + 1; x += lowbit(x))
        bit[x] += v;
    return;
&amp;#125;
int ask(int x) &amp;#123;
    int res = 0, to = x;
    for (; x; x -= lowbit(x))
        res += bit[x];
    // printf(&amp;quot;ask(%d) = %d\n&amp;quot;, to, res);
    return res;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, q;
    std::cin &amp;gt;&amp;gt; n;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t, tail[i] = ins(t);
    &amp;#125;
    std::vector&amp;lt;std::vector&amp;lt;int&amp;gt; &amp;gt; g(tot + 2);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
        for (int i = 1; i &amp;lt;= tot; ++i)
            g[fail[i] + 1].push_back(i + 1);
    &amp;#125;
    std::vector&amp;lt;std::array&amp;lt;int, 22&amp;gt; &amp;gt; f(tot + 2);
    std::vector&amp;lt;int&amp;gt; dep(tot + 2), dfn(tot + 2), siz(tot + 2);
    std::function&amp;lt;void(int)&amp;gt; DFS = [&amp;amp;](int x) &amp;#123;
        static int now = 0;
        siz[x] = 1, dfn[x] = ++now;
        // printf(&amp;quot;%d\n&amp;quot;, x);
        for (auto i : g[x]) &amp;#123;
            dep[i] = dep[x] + 1;
            f[i][0] = x;
            for (int j = 1; j &amp;lt;= 21; ++j)
                f[i][j] = f[f[i][j - 1]][j - 1];
            DFS(i), siz[x] += siz[i];
        &amp;#125;
        return;
    &amp;#125;;
    dep[1] = 1, DFS(1);
    auto askLCA = [&amp;amp;](int x, int y) &amp;#123;
        if (x == y)
            return x;
        if (dep[x] &amp;lt; dep[y])
            std::swap(x, y);
        for (int i = 21; ~i; --i)
            if (dep[f[x][i]] &amp;gt;= dep[y])
                x = f[x][i];
        if (x == y)
            return x;
        for (int i = 21; ~i; --i)
            if (f[x][i] != f[y][i])
                x = f[x][i], y = f[y][i];
        return f[x][0];
    &amp;#125;;
    std::cin &amp;gt;&amp;gt; q;
    for (; q--; ) &amp;#123;
        int op;
        std::cin &amp;gt;&amp;gt; op;
        if (op == 1) &amp;#123;
            std::string s;
            std::cin &amp;gt;&amp;gt; s;
            int p = 0, len = (int)s.length();
            std::vector&amp;lt;int&amp;gt; id(len + 1);
            for (int i = 1; i &amp;lt;= len; ++i)
                p = T[p][s[i - 1] - &amp;#39;a&amp;#39;], id[i] = p + 1;
            std::sort(id.begin() + 1, id.end(), [&amp;amp;](int x, int y) &amp;#123; return dfn[x] &amp;lt; dfn[y]; &amp;#125;);
            // for (int i = 1; i &amp;lt;= len; ++i)
            //     printf(&amp;quot;%d &amp;quot;, id[i]);
            // puts(&amp;quot;&amp;quot;);
            for (int i = 1; i &amp;lt;= len; ++i) &amp;#123;
                // printf(&amp;quot;%d %d %d\n&amp;quot;, i, id[i], dfn[id[i]]);
                // assert(0);
                add(dfn[id[i]], 1);
                if (i != 1)
                    add(dfn[askLCA(id[i], id[i - 1])], -1);
            &amp;#125;
        &amp;#125;
        else &amp;#123;
            int x;
            std::cin &amp;gt;&amp;gt; x;
            x = tail[x] + 1;
            std::cout &amp;lt;&amp;lt; ask(dfn[x] + siz[x] - 1) - ask(dfn[x] - 1) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
        &amp;#125;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h2 id=&#34;ac-è‡ªåŠ¨æœºä¸Šçš„-dp&#34;&gt;AC è‡ªåŠ¨æœºä¸Šçš„ DP&lt;/h2&gt;
&lt;p&gt;é‰´äº AC è‡ªåŠ¨æœºçš„ä¼˜ç§€ç»“æ„ä¸æ€§è´¨ï¼Œå¹¶ä¸ç»å¸¸ä½œä¸ºå­—ç¬¦ä¸²åŒ¹é…å·¥å…·å‡ºç°ï¼Œå…¶ä¸€ä¸ªåº”ç”¨æ˜¯ä½œä¸º DP çš„è½½ä½“ã€‚&lt;/p&gt;
&lt;h3 id=&#34;eg1.-l-è¯­è¨€&#34;&gt;eg1. L è¯­è¨€&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www.luogu.com.cn/problem/P2292&#34; class=&#34;uri&#34;&gt;https://www.luogu.com.cn/problem/P2292&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æƒ³åˆ°è¦åœ¨è‡ªåŠ¨æœºä¸ŠåŒ¹é…ï¼Œä½†æ­¤æ—¶ &lt;code&gt;fail&lt;/code&gt; ä½œä¸ºã€Œæ–­å¥ã€çš„å”¯ä¸€æ‰‹æ®µï¼ˆæ–­å¥çš„ä½ç½®åœ¨é“¾ä¸Šå½“å‰ç‚¹æ·±åº¦ - &lt;code&gt;fail&lt;/code&gt; æ·±åº¦å¤„ï¼‰ï¼Œä¸å†ä»…å½“å¤±é…æ—¶æ‰èƒ½ç»è¿‡ã€‚æˆ‘ä»¬è€ƒè™‘æœ´ç´ çš„ DPï¼šåœ¨ç»è¿‡çš„æ¯ä¸ªçŠ¶æ€è€ƒè™‘æ–­å¥ï¼Œé‚£ä¹ˆè¿™è¦æ±‚æ–­å¥å¤„æ˜¯ä¸€ä¸ªå•è¯çš„ç»“å°¾ï¼Œé‚£ä¹ˆæ­¤æ—¶ &lt;code&gt;fail&lt;/code&gt; æœ€é•¿åŒ¹é…é•¿åº¦å³å¯è¢«æ›´æ–°ã€‚æœ€åéå†æ‰€æœ‰å•è¯çš„æœ«ç»“ç‚¹ï¼Œå–æœ€å¤§ç­”æ¡ˆã€‚è¿™é‡Œçš„ &lt;code&gt;fail&lt;/code&gt; å…¶å®æ˜¯ &lt;code&gt;fail&lt;/code&gt; é“¾ä¸Šä»»æ„ä¸€ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¤æ‚åº¦ã€‚å®¹æ˜“å‘ç°å¯¹äºæ¯ä¸€ä¸ªç‚¹æˆ‘ä»¬è·³äº†å…¶æ•´æ¡ fail é“¾ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±æ˜¯æœ€åŠ£ &lt;span class=&#34;math inline&#34;&gt;\(n^2\)&lt;/span&gt; çš„ã€‚è€ƒè™‘ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹è‡³ &lt;span class=&#34;math inline&#34;&gt;\(O(1)\)&lt;/span&gt;ã€‚&lt;/p&gt;
&lt;p&gt;é¢˜ç›®é‡Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¡ä»¶è¿˜æ²¡æœ‰ç”¨åˆ°ï¼šå•ä¸ªå•è¯é•¿åº¦ &lt;span class=&#34;math inline&#34;&gt;\(\le 20\)&lt;/span&gt;ï¼Œè¿™è®©æˆ‘ä»¬æƒ³åˆ°çŠ¶æ€å‹ç¼©ã€‚å¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼Œè®°å½•å…¶æ–­å‡ºæ¥å•è¯çš„å¯èƒ½é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ DAG ä¸Šæ¸¸èµ°çš„æ—¶å€™è®°å½•ç›®å‰å¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ï¼Œå¦‚æœå…¶å’Œå½“å‰å¯æ–­å‡ºæ¥çš„é•¿åº¦ä¹‹äº¤ä¸ä¸ºç©ºï¼Œå°±å¯ä»¥å°†æ­¤å¤„åŠ å…¥ã€Œå¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ã€å¹¶æ›´æ–°ç­”æ¡ˆã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
int T[maxn][26], tot, fail[maxn], len[maxn], dep[maxn], tag[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot, dep[tot] = dep[p] + 1;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    ++tag[p];
    return p;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; t[i], tail[i] = ins(t[i]);
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            len[u] = len[fail[u]];
            if (tag[u])
                len[u] |= (1 &amp;lt;&amp;lt; dep[u]);
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    for (; m--; ) &amp;#123;
        std::string s;
        std::cin &amp;gt;&amp;gt; s;
        int p = 0, q = 1, res = 0;
        for (int i = 0; i &amp;lt; (int)s.length(); ++i) &amp;#123;
            p = T[p][s[i] - &amp;#39;a&amp;#39;], q &amp;lt;&amp;lt;= 1;
            if (len[p] &amp;amp; q)
                q |= 1, res = i + 1;
        &amp;#125;
        std::cout &amp;lt;&amp;lt; res &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    &amp;#125;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg2.-popcount-words&#34;&gt;eg2. Popcount Words&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/gym/103409/problem/H&#34; class=&#34;uri&#34;&gt;https://codeforces.com/gym/103409/problem/H&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;å’‹ä¸Šå¼ºåº¦äº†å•Šã€‚&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;å…ˆæŠŠæ•´ä¸ªåºåˆ—å†™å‡ºæ¥ï¼Œå³ &lt;span class=&#34;math inline&#34;&gt;\(w=\texttt{01101001100101}\cdots\)&lt;/span&gt;ï¼Œå°è¯•è¿›ä¸€æ­¥æ¢ç©¶å½¢å¼åŒ–çš„è§„å¾‹ï¼Œå¯ä»¥å¾—åˆ°ï¼š&lt;/p&gt;
&lt;ol type=&#34;1&#34;&gt;
&lt;li&gt;&lt;span class=&#34;math inline&#34;&gt;\(w_{[0, 2^n), 0}=w_{[0, 2^{n-1}),0}+w_{[0, 2^n), 1}\)&lt;/span&gt;ï¼Œå…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(w_{[l, r], 0/1}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\([l, r]\)&lt;/span&gt; å†…ï¼ŒåŸä¸² / å–åçš„å€¼ã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºä¸ä»¥ &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å¤´çš„æ•´æ®µï¼Œå¯ä»¥ä»ä¸Šè¿°è§„åˆ™è½¬åŒ–ä¸º &lt;span class=&#34;math inline&#34;&gt;\(0\)&lt;/span&gt; å¼€å¤´çš„æ•´æ®µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¥ç€ä¸éš¾æƒ³åˆ°ä¸€ç§ç±»ä¼¼çº¿æ®µæ ‘çš„æ–¹å¼ï¼Œå°†å¾…æ±‚çš„ &lt;span class=&#34;math inline&#34;&gt;\(w_{[l, r], 0}\)&lt;/span&gt; åˆ†åˆ° &lt;span class=&#34;math inline&#34;&gt;\(O(\log V)\)&lt;/span&gt; ä¸ªæ•´æ®µä¸Šï¼Œé‚£ä¹ˆ &lt;span class=&#34;math inline&#34;&gt;\(S\)&lt;/span&gt; å°±å¯ä»¥è¢« &lt;span class=&#34;math inline&#34;&gt;\(O(n\log V)\)&lt;/span&gt; ä¸ªæ•´æ®µï¼ˆä¹Ÿæ˜¯ &lt;span class=&#34;math inline&#34;&gt;\(\log V\)&lt;/span&gt; ä¸ªæœ¬è´¨ä¸åŒæ•´æ®µï¼‰æè¿°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯¹ &lt;span class=&#34;math inline&#34;&gt;\({p_m}\)&lt;/span&gt; å»ºç«‹ AC è‡ªåŠ¨æœºï¼Œéœ€è¦çŸ¥é“è¿™ &lt;span class=&#34;math inline&#34;&gt;\(\log V\)&lt;/span&gt; ä¸ªæ•´æ®µåœ¨æ¯ä¸ªç‚¹ä¸Šçš„å‡ºç°æ¬¡æ•°ã€‚å¯¹äºè‡ªåŠ¨æœºä¸Šä»»æ„çŠ¶æ€ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt;ï¼Œè®¾ &lt;span class=&#34;math inline&#34;&gt;\(to_{u, n, 0/1}\)&lt;/span&gt; è¡¨ç¤º &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ç»è¿‡ &lt;span class=&#34;math inline&#34;&gt;\(w_{[0, 2^n), 0/1}\)&lt;/span&gt; ååˆ°è¾¾çš„ç‚¹ï¼Œåˆ™å¯å€å¢ï¼ˆå˜¶ï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯åº”è¯¥åè¿‡æ¥å«åˆ†æ²»å•Šï¼‰ç®€å•è§£å†³ã€‚&lt;/p&gt;
&lt;p&gt;é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç”¨ &lt;span class=&#34;math inline&#34;&gt;\(to\)&lt;/span&gt; æ¥è¿›è¡Œå¿«é€Ÿæ¸¸èµ°äº†ã€‚é¡ºä¾¿æ‰“ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(cnt\)&lt;/span&gt; è®°å½•ä¸€ä¸‹æ¯ä¸ª &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; ä½œä¸ºä¸åŒæ•´æ®µçš„å¼€å¤´è¢«ç»è¿‡çš„æ¬¡æ•°ã€‚ç„¶ååšä¸€ä¸ª DPï¼Œç±»ä¼¼äºçº¿æ®µæ ‘ä¸Š &lt;code&gt;pushdown&lt;/code&gt; çš„æ“ä½œæŠŠæ‰€æœ‰æ•´æ®µä¸‹æ”¾åˆ°å•ç‚¹ä¸Šçš„å•ä¸ªå­—ç¬¦ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€è¯´ä¸€ç”¨ DP æ¥å¤„ç†è¿™ä¸ªä¸œè¥¿è¿˜æŒºéš¾æƒ³çš„ã€‚å¯èƒ½ä¹Ÿæ˜¯åŸºäºå‰é¢çš„å€å¢å§ã€‚æœ€åæ‹“æ‰‘æ’åºå°±è¡Œäº†ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;p&gt;å¤§å®¶æ•°ç»„ä¸€å®šè¦ç”¨ C-style array å•Šï¼Œ&lt;code&gt;std::vector&amp;lt;&amp;gt;&lt;/code&gt; è®¡ç®—çš„æ˜¯ç”³è¯·ç©ºé—´åŒ… MLE çš„ &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;p&gt;å¤§å®¶å¤§æ•°ç»„ä¸€å®šè¦å†…å­˜è¿ç»­è®¿é—®ä¼˜åŒ–å•Šï¼ŒTLE &lt;span class=&#34;math inline&#34;&gt;\(\to\)&lt;/span&gt; 100ms æ³ªç›®äº† &lt;img src=&#34;/em/ll.gif&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 5e5 + 5;
long long sum[maxn], f[2][30][maxn];
int cnt[2][30][maxn], to[2][30][maxn];
int T[maxn][2], tot, fail[maxn], deg[maxn];
int ins(std::string &amp;amp;t) &amp;#123;
    int p = 0;
    for (auto i : t) &amp;#123;
        if (!T[p][i - &amp;#39;0&amp;#39;])
            T[p][i - &amp;#39;0&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;0&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
void ask(std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; &amp;amp;s, int ql, int qr, int l = 0, int r = (1 &amp;lt;&amp;lt; 30) - 1, int len = 30, int v = 0) &amp;#123;
    if (ql &amp;lt;= l &amp;amp;&amp;amp; r &amp;lt;= qr) &amp;#123;
        s.emplace_back(len, v);
        return;
    &amp;#125;
    int mid = l + (r - l) / 2;
    if (ql &amp;lt;= mid)
        ask(s, ql, qr, l, mid, len - 1, v);
    if (qr &amp;gt; mid)
        ask(s, ql, qr, mid + 1, r, len - 1, v ^ 1);
    return;
&amp;#125;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n, m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;std::pair&amp;lt;int, int&amp;gt; &amp;gt; s;
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        int l, r;
        std::cin &amp;gt;&amp;gt; l &amp;gt;&amp;gt; r;
        ask(s, l, r);
    &amp;#125;
    std::vector&amp;lt;int&amp;gt; tail(m + 1);
    for (int i = 1; i &amp;lt;= m; ++i) &amp;#123;
        std::string t;
        std::cin &amp;gt;&amp;gt; t;
        tail[i] = ins(t);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 2; ++i)
            if (T[0][i])
                q.push(T[0][i]);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 2; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    for (int i = 0; i &amp;lt;= tot; ++i)
        to[0][0][i] = T[i][0], to[1][0][i] = T[i][1];
    for (int j = 1; j &amp;lt; 30; ++j)
        for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
            to[0][j][i] = to[1][j - 1][to[0][j - 1][i]];
            to[1][j][i] = to[0][j - 1][to[1][j - 1][i]];
        &amp;#125;
    &amp;#123;
        int p = 0;
        for (auto [n, i] : s) &amp;#123;
            // printf(&amp;quot;# %d %d\n&amp;quot;, n, i);
            ++cnt[i][n][p], p = to[i][n][p];
        &amp;#125;
    &amp;#125;
    for (int j = 29; ~j; --j)
        for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
            if (j != 29) &amp;#123;
                f[0][j][i] += f[0][j + 1][i];
                f[1][j][i] += f[1][j + 1][i];
                f[0][j][to[1][j][i]] += f[1][j + 1][i];
                f[1][j][to[0][j][i]] += f[0][j + 1][i];
            &amp;#125;
            f[1][j][i] += cnt[1][j][i];
            f[0][j][i] += cnt[0][j][i];
        &amp;#125;
    for (int i = 0; i &amp;lt;= tot; ++i) &amp;#123;
        sum[T[i][0]] += f[0][0][i], sum[T[i][1]] += f[1][0][i];
        // printf(&amp;quot;%d %d\n&amp;quot;, f[i][0][0], f[i][0][1]);
    &amp;#125;
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt;= tot; ++i)
            if (!deg[i])
                q.push(i);
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            sum[fail[u]] += sum[u];
            if (!--deg[fail[u]])
                q.push(fail[u]);
        &amp;#125;
    &amp;#125;
    for (int i = 1; i &amp;lt;= m; ++i)
        std::cout &amp;lt;&amp;lt; sum[tail[i]] &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg3.-legen&#34;&gt;eg3. Legenâ€¦&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://codeforces.com/problemset/problem/696/D&#34; class=&#34;uri&#34;&gt;https://codeforces.com/problemset/problem/696/D&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å…ˆåœ¨ fail æ ‘ä¸ŠæŠŠæ¯ä¸ªçŠ¶æ€çš„å®é™…ä»·å€¼è®¡ç®—å‡ºæ¥ã€‚æˆ‘ä»¬å‘ç°åŒ¹é…ä¸²æ˜¯æœªçŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦ä¸»åŠ¨å†³å®šæ¸¸èµ°è·¯å¾„ã€‚æ³¨æ„åˆ° &lt;span class=&#34;math inline&#34;&gt;\(l=10^{14}\)&lt;/span&gt;ï¼Œè€ƒè™‘çŸ©é˜µã€‚&lt;/p&gt;
&lt;p&gt;ä»¤ &lt;span class=&#34;math inline&#34;&gt;\(f_{u, i}\)&lt;/span&gt; è¡¨ç¤ºåœ¨ &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çŠ¶æ€æ—¶å·²ç»èµ°äº† &lt;span class=&#34;math inline&#34;&gt;\(i\)&lt;/span&gt; æ­¥ï¼Œå¯ä»¥å¾—åˆ°çš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[
f_{v,i+1}=f_{u,i}+s_v.
\]&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;å…¶ä¸­ &lt;span class=&#34;math inline&#34;&gt;\(v\)&lt;/span&gt; æ˜¯è‡ªåŠ¨æœºä¸Š &lt;span class=&#34;math inline&#34;&gt;\(u\)&lt;/span&gt; çš„ä»»æ„å‡ºè¾¹ã€‚å›¾çš„å¤§å°ä¸º &lt;span class=&#34;math inline&#34;&gt;\(200\)&lt;/span&gt;ï¼Œå¯ä»¥æ”¾åˆ° &lt;span class=&#34;math inline&#34;&gt;\(+\max\)&lt;/span&gt; çŸ©é˜µé‡ŒåŠ é€Ÿè½¬ç§»ã€‚&lt;/p&gt;
&lt;details&gt;
&lt;pre class=&#34;cpp&#34;&gt;&lt;code&gt;#include &amp;lt;bits/stdc++.h&amp;gt;
const int maxn = 2e5 + 5;
const long long inf = 1e18;
int fail[maxn], T[maxn][26], tot;
int ins(std::string s) &amp;#123;
    int p = 0;
    for (auto i : s) &amp;#123;
        if (!T[p][i - &amp;#39;a&amp;#39;])
            T[p][i - &amp;#39;a&amp;#39;] = ++tot;
        p = T[p][i - &amp;#39;a&amp;#39;];
    &amp;#125;
    return p;
&amp;#125;
struct matrix &amp;#123;
    int n, m;
    std::vector&amp;lt;std::vector&amp;lt;long long&amp;gt; &amp;gt; a;
    matrix(int n1, int m1, long long v = -inf, bool op = 0): n(n1), m(m1), a(n + 1, std::vector&amp;lt;long long&amp;gt; (m + 1, v)) &amp;#123;
        if (op)
            for (int i = 0; i &amp;lt;= n; ++i)
                a[i][i] = 0;
        return;
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; &amp;amp;operator[] (int i) &amp;#123;
        return a[i];
    &amp;#125;
    matrix operator* (matrix &amp;amp;q) const &amp;#123;
        matrix res(n, q.m);
        for (int k = 0; k &amp;lt;= m; ++k)
            for (int i = 0; i &amp;lt;= n; ++i)
                for (int j = 0; j &amp;lt;= q.m; ++j)
                    res[i][j] = std::max(res[i][j], a[i][k] + q[k][j]);
        return res;
    &amp;#125;
    matrix&amp;amp; operator*= (matrix q) &amp;#123;
        return *this = *this * q;
    &amp;#125;
    matrix operator^ (long long q) &amp;#123;
        matrix res(n, n, -inf, 1), x(*this);
        for (; q; q &amp;gt;&amp;gt;= 1, x *= x)
            if (q &amp;amp; 1)
                res *= x;
        return res;
    &amp;#125;
&amp;#125;;
int main() &amp;#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&amp;quot;.in&amp;quot;, &amp;quot;r&amp;quot;, stdin);
    std::freopen(&amp;quot;.out&amp;quot;, &amp;quot;w&amp;quot;, stdout);
#endif
    int n;
    long long m;
    std::cin &amp;gt;&amp;gt; n &amp;gt;&amp;gt; m;
    std::vector&amp;lt;long long&amp;gt; a(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        std::cin &amp;gt;&amp;gt; a[i];
    std::vector&amp;lt;int&amp;gt; tail(n + 1);
    std::vector&amp;lt;std::string&amp;gt; t(n + 1);
    for (int i = 1; i &amp;lt;= n; ++i) &amp;#123;
        std::cin &amp;gt;&amp;gt; t[i];
        tail[i] = ins(t[i]);
    &amp;#125;
    std::vector&amp;lt;long long&amp;gt; s(tot + 1);
    for (int i = 1; i &amp;lt;= n; ++i)
        s[tail[i]] += a[i];
    &amp;#123;
        std::queue&amp;lt;int&amp;gt; q;
        for (int i = 0; i &amp;lt; 26; ++i)
            if (T[0][i])
                q.push(T[0][i]); 
        for (; !q.empty(); ) &amp;#123;
            int u = q.front();
            q.pop();
            for (int i = 0; i &amp;lt; 26; ++i)
                if (T[u][i]) &amp;#123;
                    int v = T[u][i];
                    fail[v] = T[fail[u]][i], s[v] += s[fail[v]];
                    q.push(v);
                &amp;#125;
                else
                    T[u][i] = T[fail[u]][i];
        &amp;#125;
    &amp;#125;
    matrix f(0, tot), op(tot, tot);
    f[0][0] = 0;
    for (int i = 0; i &amp;lt;= tot; ++i)
        for (int j = 0; j &amp;lt; 26; ++j)
            op[i][T[i][j]] = s[T[i][j]];
    f *= (op * m);
    std::cout &amp;lt;&amp;lt; *std::max_element(f[0].begin(), f[0].end()) &amp;lt;&amp;lt; &amp;#39;\n&amp;#39;;
    return 0;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/details&gt;
&lt;hr /&gt;
&lt;h3 id=&#34;eg4.-you-are-given-some-strings&#34;&gt;eg4. You Are Given Some Stringsâ€¦&lt;/h3&gt;
&lt;p&gt;goto &lt;a href=&#34;/20250121/#%E4%B8%80%E4%B8%AA%E6%A8%A1%E6%9D%BFcf1202e-you-are-given-some-strings...&#34;&gt;link&lt;/a&gt;.&lt;/p&gt;
</content>
        <category term="DP" />
        <category term="å­—ç¬¦ä¸²" />
        <category term="AC è‡ªåŠ¨æœº" />
        <updated>2025-01-20T03:21:15.000Z</updated>
    </entry>
</feed>
