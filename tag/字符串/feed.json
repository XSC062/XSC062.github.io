{
    "version": "https://jsonfeed.org/version/1",
    "title": "null â€¢ All posts by \"å­—ç¬¦ä¸²\" tag",
    "description": "",
    "home_page_url": "https://xsc062.netlify.app",
    "items": [
        {
            "id": "https://xsc062.netlify.app/20250809/",
            "url": "https://xsc062.netlify.app/20250809/",
            "title": "è¿‘æœŸæ‚é¢˜",
            "date_published": "2025-08-09T04:33:17.000Z",
            "content_html": "<p>è¿™æ®µæ—¶é—´æ¯”èµ›çš„ä¸€äº›é¢˜ å’Œ nKessiã€duanyu è®²çš„é¢˜ç›®ã€‚å¤ªåè®¡æ•°ã€æ•°å­¦çš„åŸºæœ¬ä¸Šæ²¡åŠæ³•åšäº†ã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a.-å‡ºå…³\">A. å‡ºå…³</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6462/problem/1\" class=\"uri\">http://222.180.160.110:61235/contest/6462/problem/1</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(s\\)</span>ï¼Œå¯¹äºä¸€ä¸ªç©ºä¸²ï¼Œä»»æ„åˆ©ç”¨ä¸‹åˆ—ä¸‰ç§æ“ä½œï¼Œä½¿å…¶å˜ä¸º <span class=\"math inline\">\\(s\\)</span>ï¼Œæ±‚æœ€å°ä»£ä»·ï¼š</p>\n<ol type=\"1\">\n<li>åœ¨æœ«å°¾æ·»åŠ å­—ç¬¦ <span class=\"math inline\">\\(c\\)</span>ï¼Œä»£ä»·ä¸º <span class=\"math inline\">\\(t_{0,c}\\)</span>ï¼›</li>\n<li>å¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²å¹¶ç²˜è´´åœ¨æœ«å°¾ï¼Œä»£ä»·ä¸º <span class=\"math inline\">\\(t_1\\)</span>ï¼›</li>\n<li>åˆ é™¤æœ«å°¾å­—ç¬¦ï¼Œä»£ä»·ä¸º <span class=\"math inline\">\\(t_2\\)</span>ã€‚</li>\n</ol>\n<p><span class=\"math inline\">\\(|s|\\le 10^6\\)</span>ã€‚</p>\n</blockquote>\n<p>å¯ä»¥é¢„å¤„ç†å‡ºå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span> ç»“å°¾ï¼Œæœ€å¤šå¯ä»¥å¤åˆ¶åˆ°å“ªä¸ªåœ°æ–¹ï¼Œå‘ç°è¦æ±‚ <span class=\"math inline\">\\(z_i=lcp(s_{1\\dots n},s_{i+1\\dots n})\\)</span>ã€‚é‚£ä¹ˆä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span> çš„æœ€è¿œè½¬ç§»ç‚¹ <span class=\"math inline\">\\(r_i=i+z_{i+1}\\)</span>ï¼Œç”¨å•è°ƒé˜Ÿåˆ—å°±èƒ½ç»´æŠ¤ï¼Œä¼š exkmp å°±èƒ½çº¿æ€§ï¼›</p>\n<p>å¦åˆ™å¯ä»¥äºŒåˆ† + å“ˆå¸Œå¤šä¸ª logï¼Œåé¢ä¹Ÿæœ‰ç†ç”±å·æ‡’ç”¨ä¼˜å…ˆé˜Ÿåˆ—äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int p = 31;\nconst int mod = 998244353;\nint main() &#123;\n    std::freopen(&quot;laozi.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;laozi.out&quot;, &quot;w&quot;, stdout);\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::string s;\n    std::cin &gt;&gt; s;\n    int n = (int)s.length(), t1, t2;\n    std::vector&lt;long long&gt; h(n + 1), base(n + 1);\n    std::vector&lt;int&gt; a(n + 1), t0(27), z(n + 1), r(n + 1);\n    base[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        a[i] = s[i - 1] - &#39;a&#39; + 1;\n        h[i] = (h[i - 1] * p + a[i]) % mod;\n        base[i] = base[i - 1] * p % mod;\n    &#125;\n    auto gethash = [&amp;](int l, int r) &#123;\n        return (h[r] - h[l - 1] * base[r - l + 1] % mod + mod) % mod;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)\n        for (int l = 1, r = std::min(i - 1, n - i + 1), mid; l &lt;= r; ) &#123;\n            mid = (l + r) &gt;&gt; 1;\n            if (gethash(1, mid) == gethash(i, i + mid - 1))\n                z[i] = mid, l = mid + 1;\n            else\n                r = mid - 1;\n        &#125;\n    for (int i = 1; i &lt; n; ++i)\n        r[i] = i + std::min(i, z[i + 1]);\n    for (int i = 1; i &lt;= 26; ++i)\n        std::cin &gt;&gt; t0[i];\n    std::cin &gt;&gt; t1 &gt;&gt; t2;\n    std::vector&lt;long long&gt; f(n + 1);\n    std::priority_queue&lt;std::pair&lt;long long, int&gt; &gt; q;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        f[i] = f[i - 1] + t0[a[i]];\n        for (; !q.empty() &amp;&amp; r[q.top().second] &lt; i; q.pop());\n        if (!q.empty())\n            f[i] = std::min(f[i], t1 - q.top().first - (long long)t2 * i);\n        if (i != n)\n            q.emplace(-(f[i] + 2ll * t2 * i), i);\n    &#125;\n    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-éæ”»\">D. éæ”»</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6462/problem/4\" class=\"uri\">http://222.180.160.110:61235/contest/6462/problem/4</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(n\\)</span>ï¼Œå¯¹äºä¸€ä¸ª <span class=\"math inline\">\\(1\\sim n\\)</span> çš„æ’åˆ—ï¼Œä½¿ç”¨æœ€å°çš„äº¤æ¢æ¬¡æ•°ä½¿å¾—å…¶å•å¢ã€‚åœ¨è¯¥å‰æä¸‹ï¼Œå®šä¹‰ä»£ä»·ä¸ºæ¯æ¬¡äº¤æ¢çš„ä¸¤ä¸ªæ•°ä¹‹ç§¯ã€‚å¯¹äºæ‰€æœ‰ <span class=\"math inline\">\\(n!\\)</span> ä¸ªæ’åˆ—ï¼Œè®¡ç®—æœ€å°ä»£ä»·ä¹‹å’Œã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 10^7\\)</span>ã€‚</p>\n</blockquote>\n<p>è½¬åŒ–æˆï¼ŒæŠŠ <span class=\"math inline\">\\(1\\sim n\\)</span> åˆ†æˆæ— æ ‡å·çš„è‹¥å¹²ç»„ï¼Œæ¯ç»„çš„ä»£ä»·æ˜¯ æœ€å°å€¼ <span class=\"math inline\">\\(\\times\\)</span> å…¶ä»–å…ƒç´ çš„å’Œï¼Œè¿˜æœ‰ä¸€ä¸ªé¡¹é“¾é—®é¢˜çš„ç³»æ•°ï¼Œå‘ç°ç»„é—´çš„ç¬¦å·æ˜¯æ±‚å’Œï¼Œè€ƒè™‘è®¡ç®—è´¡çŒ®ã€‚</p>\n<p>æšä¸¾ <span class=\"math inline\">\\(i,j\\)</span> å¹¶é’¦å®šä¸¤ä¸ªåŒå±ä¸€ä¸ªç¯ï¼Œä¸” <span class=\"math inline\">\\(i\\)</span> ä¸ºæœ€å°å€¼ï¼Œæšä¸¾ç¯å¤§å° <span class=\"math inline\">\\(s+2\\)</span>ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\n\\begin{aligned}\nres&amp;=\\sum_{i=1}^{n-1}\\sum_{j=i+1}^n i\\cdot j \\cdot \\sum_{s=0}^{n-i-1}\\binom{n-i-1}s \\cdot (s+1)!\\cdot (n-s-2)!\\\\\n&amp;=\\sum_{i=1}^{n-1}i\\cdot \\dfrac {(i+n+1)(n-i)}2 \\cdot \\sum_{s=0}^{n-i-1}\\binom{n-i-1}s\\cdot (s+1)!\\cdot (n-s-2)!\\\\\n&amp;=\\frac 12\\times\\sum_{i=1}^{n-1}i\\cdot (i+n+1)\\cdot (n-i)!\\cdot\\sum_{s=0}^{n-i-1}\\dfrac {(s + 1)\\cdot (n-s-2)!}{(n-i-1-s)!}\\\\\n\\end{aligned}\n\\]</span></p>\n<p>ä»¤ <span class=\"math inline\">\\(T=n-i-1\\)</span>ï¼Œå‘ç°æˆ‘ä»¬éœ€è¦å¿«é€Ÿè®¡ç®— <span class=\"math inline\">\\(f_T=\\sum\\limits_{i=0}^T \\dfrac{(i+1)\\cdot (n-i-2)!}{(T-i)!}\\)</span>ã€‚è®° <span class=\"math inline\">\\(m=n-2\\)</span>ï¼Œå˜å½¢å¾— <span class=\"math inline\">\\(f_T=(m-T)!\\cdot \\sum\\limits_{i=0}^{T} (i+1) \\binom{m-i}{m-T}\\)</span>ï¼Œå‘ç°ä¼¼ä¹å¯ä»¥ç®€åŒ–ï¼Œä»¤ <span class=\"math inline\">\\(k=m-T,t=T+1\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(f_T=\\sum\\limits_{i=1}^T i\\cdot \\binom {k+t-i}k\\)</span>ã€‚</p>\n<p>ç„¶åæ˜¯ç»å…¸çš„ç»„åˆæ„ä¹‰ä¿å¹³å®‰ç¯èŠ‚ï¼Œå³ä» <span class=\"math inline\">\\(k+t\\)</span> ä¸ªæœ‰æ ‡å·å°çƒä¸­é€‰æ‹©ä¸€æ¡åˆ†ç•Œçº¿ï¼Œåˆ†ç•Œçº¿å·¦è¾¹é€‰ä¸€ä¸ªçƒã€å³è¾¹é€‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªçƒçš„æ–¹æ¡ˆæ•°ã€‚å‘ç°åˆ†ç•Œçº¿çš„å­˜åœ¨å¾ˆè¯¡å¼‚ï¼Œæ•…ç”¨åˆ†ç•Œçº¿åæ–¹çš„ç¬¬ä¸€ä¸ªçƒä»£æ›¿ï¼Œåœ¨ <span class=\"math inline\">\\(t+1\\)</span> å¤„æ–°å»ºä¸€ä¸ªè™šçƒï¼Œè§„å®šåœ¨å‰ <span class=\"math inline\">\\(t+1\\)</span> ä¸ªçƒä¸­é€‰ä¸¤ä¸ªçƒï¼Œå¹¶ä»¤åä¸€ä¸ªä¸ºåˆ†ç•Œçº¿ï¼Œä¸”ä»¤å‰ <span class=\"math inline\">\\(t+1\\)</span> ä¸ªä¸­çš„å…¶ä»–çƒä¸ºå®çƒï¼Œå°±èƒ½å»ºç«‹åŒå°„ã€‚åœ¨åˆ†ç•Œçº¿åå†é€‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªçƒï¼Œå®¹æ˜“å‘ç°ç›´æ¥åœ¨èŒƒå›´å†…é€‰ <span class=\"math inline\">\\(k+2\\)</span> ä¸ªçƒå°±èƒ½æ»¡è¶³æ¡ä»¶ï¼Œæ•… <span class=\"math inline\">\\(f_T=(n-T-2)!\\cdot \\binom{t+k+1}{k+2}\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;mozi.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;mozi.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1), f(n + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[n] = qkp(fac[n], mod - 2);\n    for (int i = n - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        return fac[n] * inv[n - m] % mod * inv[m] % mod;\n    &#125;;\n    int m = n - 2;\n    for (int T = 0; T &lt;= n - 2; ++T) &#123;\n        int k = m - T, t = T + 1;\n        f[T] = C(t + k + 1, k + 2) * fac[m - T] % mod;\n    &#125;\n    auto res = 0ll;\n    for (int i = 1; i &lt;= n - 1; ++i)\n        (res += (long long)i * (i + n + 1) % mod * fac[n - i] % mod * f[n - i - 1] % mod) %= mod;\n    std::cout &lt;&lt; res * inv[2] % mod &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---destruction-of-walls\">C - Destruction of Walls</h2>\n<p><a href=\"https://atcoder.jp/contests/arc203/tasks/arc203_c\" class=\"uri\">https://atcoder.jp/contests/arc203/tasks/arc203_c</a></p>\n<hr />\n<h2 id=\"d---insert-xor\">D - Insert XOR</h2>\n<p><a href=\"https://atcoder.jp/contests/arc203/tasks/arc203_d\" class=\"uri\">https://atcoder.jp/contests/arc203/tasks/arc203_d</a></p>\n<hr />\n<h2 id=\"a---è®°å¿†\">A - è®°å¿†</h2>\n<p><a href=\"https://ac.nowcoder.com/acm/problem/274793\" class=\"uri\">https://ac.nowcoder.com/acm/problem/274793</a></p>\n<p>éœ€è¦æ„è¯†åˆ°é—®é¢˜æ˜¯é™æ€çš„ï¼Œå¹¶ä¸”ä¸èƒ½ç”¨çº¿æ®µæ ‘ä¹‹ç±»ç»´æŠ¤ï¼›æ•…è€ƒè™‘ç¦»çº¿ä¸‹æ¥ï¼Œæƒ³åŠæ³•åœ¨ LCA å¤„ç»Ÿè®¡ç­”æ¡ˆã€‚</p>\n<p>è¿™ä¸ªæ—¶å€™å‘ç°éœ€è¦åˆå¹¶å­æ ‘çŠ¶æ€ã€æ•´ä½“å¼‚æˆ–ã€æ•´ä½“ +1ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° Trieã€‚æŠŠ <span class=\"math inline\">\\(u\\to\\)</span> LCA çš„ç­”æ¡ˆä¿å­˜åœ¨ LCA å¤„ï¼Œç„¶åå†ç”¨ DFS + å›æº¯ç»Ÿè®¡ LCA <span class=\"math inline\">\\(\\to v\\)</span> çš„ç­”æ¡ˆã€‚æƒ³äº†åŠå¤©æ²¡æƒ³åˆ°æŠŠä¸Šä¸‹æ‹†å¼€æ¥åšä¹Ÿæ˜¯ç¥äº† ğŸ˜…</p>\n<p>å¯èƒ½æ¯”è¾ƒè€ƒéªŒå¯¹å­—å…¸æ ‘çš„ç†è§£ï¼Ÿåšä¸ªæ¯”å–»ï¼Œå­—å…¸æ ‘çš„ id å°±ç›¸å½“äºå¯¹è¿™ä¸ªç‚¹ä¸Šä¿¡æ¯çš„ã€å¼•ç”¨ã€ã€‚</p>\n<details>\n<p>å­—å…¸æ ‘åˆå¹¶çš„æ—¶å€™å¯ä»¥è€ƒè™‘å›æ”¶åºŸå¼ƒç‚¹ï¼Œä¸ç„¶å¯èƒ½æœ‰ç‚¹å¡ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int X = 50;\nconst int maxn = 2e7 + 5;\nlong long d[maxn];\nint tot, T[maxn][2], f[maxn], fa[maxn];\n#define lc(p) T[p][0]\n#define rc(p) T[p][1]\nint find(int x) &#123; return x == f[x] ? x : f[x] = find(f[x]); &#125;\nint newnode(void) &#123;\n    int p = ++tot;\n    assert(p &lt; maxn);\n    d[p] = lc(p) = rc(p) = 0, f[p] = p;\n    return p;\n&#125;\nvoid pushdown(int p) &#123;\n    if (d[p]) &#123;\n        if (d[p] &amp; 1)\n            std::swap(lc(p), rc(p));\n        d[p] &gt;&gt;= 1;\n        if (lc(p))\n            d[lc(p)] ^= d[p];\n        if (rc(p))\n            d[rc(p)] ^= d[p];\n        d[p] = 0;\n    &#125;\n    return;\n&#125;\nint ins(int p, long long x) &#123;\n    for (int i = 0; i &lt; X; ++i) &#123;\n        pushdown(p);\n        if (!T[p][(x &gt;&gt; i) &amp; 1]) &#123;\n            T[p][(x &gt;&gt; i) &amp; 1] = newnode();\n            fa[T[p][(x &gt;&gt; i) &amp; 1]] = p;\n        &#125;\n        p = T[p][(x &gt;&gt; i) &amp; 1];\n    &#125;\n    return p;\n&#125;\nvoid merge(int &amp;p, int q) &#123;\n    if (!q)\n        return;\n    if (!p) &#123;\n        p = q;\n        return;\n    &#125;\n    pushdown(p), pushdown(q);\n    fa[lc(q)] = p, fa[rc(q)] = p;\n    merge(lc(p), lc(q)), merge(rc(p), rc(q));\n    assert(f[p] == p), assert(f[q] == q), f[q] = p;\n    return;\n&#125;\nlong long ask(int p) &#123;\n    std::vector&lt;int&gt; st;\n    for (int i = 0, j = p; i &lt; X; ++i)\n        st.push_back(fa[j]), j = fa[j];\n    for (int i = 0; i &lt; X; ++i)\n        pushdown(st.back()), st.pop_back();\n    long long x = 0;\n    for (int i = 0; i &lt; X; ++i) &#123;\n        x = x * 2 + (p == rc(fa[p]));\n        p = fa[p];\n    &#125;\n    return x;\n&#125;\nvoid add(int p) &#123;\n    for (int i = 0; p &amp;&amp; i &lt; X; ++i) &#123;\n        pushdown(p);\n        std::swap(lc(p), rc(p));\n        p = lc(p);\n    &#125;\n    return;\n&#125;\nvoid del(int p) &#123;\n    for (int i = 0; p &amp;&amp; i &lt; X; ++i) &#123;\n        pushdown(p);\n        std::swap(lc(p), rc(p));\n        p = rc(p);\n    &#125;\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1), top(n + 1), fa(n + 1), dep(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g[x])\n            if (i != fa[x]) &#123;\n                dep[i] = dep[x] + 1;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1);\n    DFS = [&amp;](int x) &#123;\n        if (son[x])\n            top[son[x]] = top[x], DFS(son[x]);\n        for (auto i : g[x])\n            if (i != son[x] &amp;&amp; i != fa[x])\n                top[i] = i, DFS(i);\n        return;\n    &#125;;\n    top[1] = 1, DFS(1);\n    auto askLCA = [&amp;](int x, int y) &#123;\n        for (; top[x] != top[y]; x = fa[top[x]])\n            if (dep[top[x]] &lt; dep[top[y]])\n                std::swap(x, y);\n        return dep[x] &lt; dep[y] ? x : y;\n    &#125;;\n    struct node &#123; long long x; int u, v; &#125;;\n    std::vector&lt;node&gt; q(m + 1);\n    std::vector&lt;int&gt; id(m + 1);\n    std::vector&lt;long long&gt; res(m + 1), ans(m + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; up(n + 1), dn(n + 1), ed(n + 1);\n    for (int i = 1, x, u, v; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; u &gt;&gt; v;\n        q[i] = &#123; x, u, v &#125;;\n        up[u].push_back(i), dn[askLCA(u, v)].push_back(i), ed[v].push_back(i);\n    &#125;\n    std::vector&lt;int&gt; rt(n + 1);\n    DFS = [&amp;](int x) &#123;\n        rt[x] = newnode();\n        for (auto i : g[x])\n            if (i != fa[x]) &#123;\n                DFS(i);\n                merge(rt[x], rt[i]);\n            &#125;\n        add(rt[x]);\n        for (auto i : up[x])\n            id[i] = ins(rt[x], q[i].x);\n        d[rt[x]] ^= a[x];\n        for (auto i : dn[x])\n            res[i] = ask(find(id[i]));\n        return;\n    &#125;;\n    DFS(1);\n    tot = 0, rt[0] = newnode();\n    std::fill(id.begin() + 1, id.end(), 0);\n    DFS = [&amp;](int x) &#123;\n        d[rt[0]] ^= a[x];\n        for (auto i : dn[x])\n            id[i] = ins(rt[0], res[i]);\n        for (auto i : ed[x])\n            ans[i] = ask(id[i]);\n        add(rt[0]);\n        for (auto i : g[x])\n            if (i != fa[x])\n                DFS(i);\n        del(rt[0]);\n        d[rt[0]] ^= a[x];\n        return;\n    &#125;;\n    DFS(1);\n    for (int i = 1; i &lt;= m; ++i)\n        std::cout &lt;&lt; ans[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ-2-meetings-2\">B - ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ 2 (Meetings 2)</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/AT_joisc2021_j\" class=\"uri\">https://www.luogu.com.cn/problem/AT_joisc2021_j</a></p>\n<p>å®šä¹‰æ‰€æ±‚ç‚¹ä¸ºã€å±€éƒ¨é‡å¿ƒã€ï¼›ç±»ä¼¼æ ‘çš„é‡å¿ƒï¼Œå®¹æ˜“å‘ç°å½“å…³é”®ç‚¹æ•°é‡ä¸ºå¥‡æ—¶ï¼Œåªå­˜åœ¨ä¸€ä¸ªå±€éƒ¨é‡å¿ƒï¼›å¦åˆ™ï¼Œå±€éƒ¨é‡å¿ƒç»„æˆä¸€æ¡é“¾ã€‚</p>\n<p>å³å¯¹äºæ¯ä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œéœ€è¦æ‰¾åˆ°ä¸€æ¡æœ€é•¿é“¾ï¼Œä½¿å¾—å…¶ä¸¤ç«¯å­˜åœ¨å¤§å°ä¸º <span class=\"math inline\">\\(i\\)</span> çš„å­æ ‘ï¼ˆå®¹æ˜“å‘ç°å–åç¼€ max å³å¯å¾—åˆ°çœŸå®ç­”æ¡ˆï¼‰ã€‚ä½¿ç”¨ç‚¹åˆ†æ²»ï¼Œç²¾ç»†å®ç°å®¹æ˜“åšåˆ° <span class=\"math inline\">\\(O(n\\log n)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; mx(n + 1), siz(n + 1), p, tag(n + 1), res(n + 1, 1);\n    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int fa) &#123;\n        p.push_back(x);\n        siz[x] = 1, mx[x] = 0;\n        for (auto i : g[x])\n            if (!tag[i] &amp;&amp; i != fa) &#123;\n                DFS1(i, x);\n                siz[x] += siz[i];\n                mx[x] = std::max(mx[x], siz[i]);\n            &#125;\n        return;\n    &#125;;\n    auto findrt = [&amp;](int x) &#123;\n        p.clear(), DFS1(x, -1);\n        int n = (int)p.size();\n        for (auto i : p)\n            if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)\n                return i;\n        assert(0);\n        return -1;\n    &#125;;\n    struct node &#123;\n        int u1, u2, id1, id2;\n        node(): u1(0), u2(0), id1(0), id2(0) &#123;&#125;\n        void upd(int u, int id) &#123;\n            if (id1 == id)\n                u1 = std::max(u1, u);\n            else if (u &gt;= u1)\n                u2 = u1, id2 = id1, u1 = u, id1 = id;\n            else if (u &gt;= u2)\n                u2 = u, id2 = id;\n            return;\n        &#125;\n    &#125;;\n    std::vector&lt;node&gt; s(n + 1);\n    std::function&lt;void(int, int, int, int)&gt; DFS2 = [&amp;](int x, int fa, int dep, int anc) &#123;\n        s[siz[x]].upd(dep, anc);\n        for (auto i : g[x])\n            if (!tag[i] &amp;&amp; i != fa)\n                DFS2(i, x, dep + 1, anc);\n        return;\n    &#125;;\n    std::function&lt;void(int, int, int, int)&gt; DFS3 = [&amp;](int x, int fa, int dep, int anc) &#123;\n        int v = ((s[siz[x]].id1 == anc) ? s[siz[x]].u2 : s[siz[x]].u1);\n        res[2 * siz[x]] = std::max(res[2 * siz[x]], dep + 1 + v);\n        for (auto i : g[x])\n            if (!tag[i] &amp;&amp; i != fa)\n                DFS3(i, x, dep + 1, anc);\n        return;\n    &#125;;\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        x = findrt(x), p.clear(), DFS1(x, -1);\n        // printf(&quot;rt = %d\\n&quot;, x);\n        for (auto i : g[x])\n            if (!tag[i])\n                DFS2(i, x, 1, i);\n        for (int i = siz[x] - 1; i; --i) &#123;\n            s[i].upd(s[i + 1].u1, s[i + 1].id1);\n            s[i].upd(s[i + 1].u2, s[i + 1].id2);\n        &#125;\n        for (auto i : g[x])\n            if (!tag[i])\n                DFS3(i, x, 1, i);\n        tag[x] = 1;\n        for (int i = 1; i &lt; siz[x]; ++i)\n            s[i] = node();\n        for (auto i : g[x])\n            if (!tag[i])\n                DFS(i);\n        return;\n    &#125;;\n    DFS(1);\n    for (int i = (n &gt;&gt; 1) * 2; i; --i)\n        if (i + 2 &lt;= n)\n            res[i] = std::max(res[i], res[i + 2]);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---the-closest-pair\">C - The Closest Pair</h2>\n<p><a href=\"https://ac.nowcoder.com/acm/problem/262593\" class=\"uri\">https://ac.nowcoder.com/acm/problem/262593</a></p>\n<p><strong>å¸¸è§„æ–¹æ³•</strong>ï¼šè€ƒè™‘<strong>æ”¯é…å¯¹</strong>ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(a_i\\)</span>ï¼Œæ‰¾åˆ°æ‰€æœ‰åˆæ³•çš„ <span class=\"math inline\">\\(a_j\\)</span>ã€‚å®¹æ˜“æƒ³åˆ°æšä¸¾ <span class=\"math inline\">\\(a_i\\div a_j\\)</span> æ¥åšï¼›å‡è®¾å­˜åœ¨ <span class=\"math inline\">\\(a_k\\div a_i=a_j\\div a_i\\)</span> ä¸” <span class=\"math inline\">\\(k&gt;j\\)</span>ã€‚</p>\n<p>ä¸å¦¨è®¾ <span class=\"math inline\">\\(a_j=K\\cdot a_i+p,a_k=K\\cdot a_i+q\\)</span>ï¼Œ<span class=\"math inline\">\\((a_i,a_j),(a_i,a_k)\\)</span> å‡åˆæ³•å½“ä¸”ä»…å½“ä¸‹åˆ—æ¡ä»¶å…¨éƒ¨æˆç«‹ï¼š</p>\n<ul>\n<li><span class=\"math inline\">\\(a_j\\bmod a_i&gt;a_k\\bmod a_i\\)</span>ï¼› åˆ™ <span class=\"math inline\">\\(a_j&gt;a_k\\)</span>ã€‚</li>\n<li><span class=\"math inline\">\\(a_j\\bmod a_k&gt;a_k\\bmod a_i\\)</span>ï¼›åˆ <span class=\"math inline\">\\(p-q\\ge a_j\\bmod a_k\\)</span>ï¼ˆ<strong>å¤ªç‰›äº†è¿™ä¸€æ­¥</strong>ï¼‰ï¼Œå³ <span class=\"math inline\">\\(p-q&gt;q\\iff p&gt;2q\\)</span>ã€‚</li>\n</ul>\n<p>è¯å¾—åªå…³å¿ƒåŒä¸€ä¸ª <span class=\"math inline\">\\(a_j\\div a_i\\)</span> æ—¶çš„æ”¯é…å¯¹æ•°é‡ä¸º <span class=\"math inline\">\\(\\log n\\)</span> çº§åˆ«ï¼›æ€»å¯¹æ•° <span class=\"math inline\">\\(O(n\\log n\\ln n)\\)</span>ã€‚ç¦»çº¿ä¸‹æ¥æ‰«æçº¿å°±è¡Œäº†ã€‚</p>\n<details>\n<p>å¯¹ç€ å•ç‚¹ä¿®æ”¹ åŒºé—´æœ€å€¼ æƒ³äº† 1h çš„å• log åšæ³• ğŸ˜° æœç„¶å°è„‘æ‰çº¿å¤ªå¯æ€•äº†ï¼Œç¬¬äºŒå¤©æ—©ä¸Šé‡ç½®å¤§è„‘ 1s å‘ç°è‡ªå·±æ˜¯æ–¯æ³¢ ğŸ˜“</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int LEN = (1 &lt;&lt; 20);\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nconst int maxn = 4e6 + 5;\nstruct &#123; int l, r, u[2]; &#125; t[maxn];\n#define lt (t[p].l)\n#define rt (t[p].r)\nint tot[2];\nvoid add(int &amp;p, int l, int r, int x, int v, int i) &#123;\n    if (!p)\n        p = ++tot[i], t[p].u[0] = -1, t[p].u[1] = 0x3f3f3f3f;\n    if (i == 0)\n        t[p].u[0] = std::max(t[p].u[0], v);\n    else\n        t[p].u[1] = std::min(t[p].u[1], v);\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, l, mid, x, v, i);\n    else\n        add(rt, mid + 1, r, x, v, i);\n    return;\n&#125;\nint ask(int p, int l, int r, int ql, int qr, int i) &#123;\n    if (!p || (ql &lt;= l &amp;&amp; r &lt;= qr))\n        return t[p].u[i];\n    int mid = (l + r) &gt;&gt; 1;\n    if (qr &lt;= mid)\n        return ask(lt, l, mid, ql, qr, i);\n    if (ql &gt; mid)\n        return ask(rt, mid + 1, r, ql, qr, i);\n    if (i == 0)\n        return std::max(ask(lt, l, mid, ql, qr, 0), ask(rt, mid + 1, r, ql, qr, 0));\n    return std::min(ask(lt, l, mid, ql, qr, 1), ask(rt, mid + 1, r, ql, qr, 1));\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifndef ONLINE_JUDGE\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    const int m = 1e6;\n    int rt[2] = &#123; 0 &#125;, n;\n    t[0].u[0] = -1, t[0].u[1] = 0x3f3f3f3f;\n    read(n);\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        read(a[i]);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; t(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (i != 1) &#123;\n            for (int K = a[i]; K &lt;= m; K += a[i]) &#123;\n                for (int mx = std::min(a[i] - 1, m - K); ; ) &#123;\n                    int k = ask(rt[0], 1, m, K, K + mx, 0);\n                    if (k == -1)\n                        break;\n                    t[i].emplace_back(k, a[k] - K);\n                    if (k == 1 || !(a[k] - K))\n                        break;\n                    mx = (a[k] - K - 1) / 2;\n                &#125;\n            &#125;\n        &#125;\n        add(rt[0], 1, m, a[i], i, 0);\n    &#125;\n    for (int i = n; i; --i) &#123;\n        if (i != n)\n            for (int K = a[i]; K &lt;= m; K += a[i])\n                for (int mx = std::min(a[i] - 1, m - K); ; ) &#123;\n                    int k = ask(rt[1], 1, m, K, K + mx, 1);\n                    if (k == 0x3f3f3f3f)\n                        break;\n                    t[k].emplace_back(i, a[k] - K);\n                    if (k == n || !(a[k] - K))\n                        break;\n                    mx = (a[k] - K - 1) / 2;\n                &#125;\n        add(rt[1], 1, m, a[i], i, 1);\n    &#125;\n    int q;\n    read(q);\n    std::vector&lt;int&gt; res(q + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; u(n + 1);\n    for (int i = 1, l, r; i &lt;= q; ++i) &#123;\n        read(l), read(r);\n        if (l &gt; r)\n            std::swap(l, r);\n        u[r].emplace_back(l, i);\n    &#125;\n    std::vector&lt;int&gt; bit(n + 1, 0x3f3f3f3f);\n    auto lowbit = [&amp;](int x) &#123; return x &amp; -x; &#125;;\n    auto add = [&amp;](int x, int v) &#123;\n        for (; x &lt;= n; x += lowbit(x))\n            bit[x] = std::min(bit[x], v);\n        return;\n    &#125;;\n    auto ask = [&amp;](int x) &#123;\n        auto res = 0x3f3f3f3f;\n        for (; x; x -= lowbit(x))\n            res = std::min(res, bit[x]);\n        return res;\n    &#125;;\n    for (int r = 1; r &lt;= n; ++r) &#123;\n        for (auto [l, v] : t[r])\n            add(n - l + 1, v);\n        for (auto [l, i] : u[r])\n            res[i] = ask(n - l + 1);\n    &#125;\n    for (int i = 1; i &lt;= q; ++i)\n        print(res[i], &#39;\\n&#39;);\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<p>æ±‚æ”¯é…å¯¹çš„è¿‡ç¨‹ä¹Ÿè¦å¸¦ logï¼ˆçº¿æ®µæ ‘ï¼‰ï¼Œå†åŠ ä¸Šæ‰«æçº¿çš„ 3logï¼Œæ€»å…±æ˜¯å¸¸æ•°æ¯”è¾ƒå¤§çš„ 3logï¼ˆå¡äº†ä¸€ä¸ªä¸Šåˆçš„å¸¸ä¹Ÿæ˜¯æœ‰äº†ï¼‰ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è®²è§£å¦ä¸€ç§å¥‡æŠ€æ·«å·§ã€‚</p>\n<p><strong>æš´åŠ›åˆ†æ²»</strong>ï¼šæ³¨æ„åˆ°å¯¹äºæ¯”è¾ƒé•¿ï¼ˆ<span class=\"math inline\">\\(len&gt; B\\)</span>ï¼‰çš„åŒºé—´ï¼Œç­”æ¡ˆæ¯”è¾ƒå°ï¼›æ•…è€ƒè™‘åˆ†æ²»ã€‚</p>\n<ul>\n<li>å¯¹äºé•¿è¯¢é—®ï¼ˆ<span class=\"math inline\">\\(len&gt;B\\)</span>ï¼‰ï¼Œä»å°åˆ°å¤§æšä¸¾ç­”æ¡ˆå¹¶ checkï¼›é¢„å¤„ç†æŸä¸ªèŒƒå›´ï¼ˆ<span class=\"math inline\">\\(V\\)</span>ï¼‰å†…çš„ <span class=\"math inline\">\\(res\\)</span> å‡ºç°çš„æ‰€æœ‰ä½ç½®ï¼Œå¹³è¡¡çš„æ—¶å€™è¿˜è¦ç®—ä¸Šè°ƒå’Œçº§æ•°å’Œ bitã€‚</li>\n<li>å¯¹äºçŸ­è¯¢é—®ï¼ˆ<span class=\"math inline\">\\(len\\le B\\)</span>ï¼‰ï¼Œå‘ç°æ¯æ¬¡åŒºé—´å†…æš´åŠ›æ˜¯ <span class=\"math inline\">\\(O(B^2q)\\)</span> çš„ï¼›æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥ï¼Œç²¾ç»†å®ç°ï¼Œåˆ©ç”¨è¯¢é—®çš„å…¬å…±éƒ¨åˆ†ä½¿å¾—<strong>æ¯ä¸€å¯¹æ•°åªè¢«æšä¸¾ä¸€æ¬¡</strong>å°±èƒ½è¾¾åˆ° <span class=\"math inline\">\\(O(B^2 + Bq)\\)</span>ã€‚</li>\n</ul>\n<p>æœ€ä¼˜è§£å– <span class=\"math inline\">\\(B=333,V=483\\)</span>ï¼Œä¸è‡ªå·±å®ç°ä¸€éäº†ã€‚</p>\n<hr />\n<h2 id=\"d---ä»™äººæŒ\">D - ä»™äººæŒ</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P3687\" class=\"uri\">https://www.luogu.com.cn/problem/P3687</a></p>\n<p>æŠŠè¾¹åŒä»å›¾ä¸­åˆ é™¤ã€é—®é¢˜è½¬åŒ–ä¸ºæ ‘ä¸Š<strong>è¾¹</strong>ä¸äº¤çš„é“¾è¦†ç›–ï¼Œä½¿å¾—<strong>æ‰€æœ‰é“¾é•¿ <span class=\"math inline\">\\(\\ge 2\\)</span></strong> çš„æ–¹æ¡ˆæ•°ã€‚å‘ç°ç”±äº<strong>è¾¹å¯ä»¥ä¸è¢«è¦†ç›–</strong>ï¼Œå¸¸è§„ DP ä¼šä½¿å¾—åœ¨çˆ¶èŠ‚ç‚¹å¤„åˆå¹¶æ—¶éœ€è¦é¢å¤–çš„æ•°é‡ç»´ï¼Œå‚è€ƒæ ‘ä¸ŠèƒŒåŒ…ï¼Œå¤æ‚åº¦ <span class=\"math inline\">\\(O(n^2)\\)</span>ã€‚</p>\n<p>æ€è€ƒæ—¶ä¼šæ³¨æ„åˆ°ä¸¤ä¸ªé™åˆ¶å¯ä»¥æŠµæ¶ˆâ€”â€”å¦‚æœè®¤ä¸ºé•¿ä¸º <span class=\"math inline\">\\(1\\)</span> çš„é“¾å°±æ˜¯ä¸è¢«è¦†ç›–çš„è¾¹ï¼Œè¦†ç›–æ‰€æœ‰æ ‘è¾¹ï¼Œæ˜¾ç„¶å¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚æ­¤æ—¶åˆå¹¶æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œæ³¨æ„åˆ°æ¯ä¸ªå„¿å­çš„ç³»æ•°ä¸€å®šéƒ½å‚ä¸ã€åˆ†æ­¥ã€ï¼Œåªéœ€è¦æ±‚å‡ºã€åˆ†ç±»ã€çš„ç³»æ•°ã€‚è¿™ä¸ªå¯ä»¥é¢„å¤„ç†ï¼ˆå’Œ <a href=\"/20250407/#a.-äºŒåˆ†å›¾æŸ“è‰²\">äºŒåˆ†å›¾æŸ“è‰²</a> è¿™ä¸ªé¢˜æœ‰ç‚¹åƒï¼‰ï¼Œä»¤ <span class=\"math inline\">\\(f_i\\)</span> è¡¨ç¤ºä¸€ä¸ªç‚¹åº¦æ•°ä¸º <span class=\"math inline\">\\(i\\)</span> æ—¶çš„ç­”æ¡ˆï¼Œå‚è€ƒé”™æ’çš„æ€è·¯ï¼Œåˆ™ <span class=\"math inline\">\\(i\\)</span> å¯ä»¥ä¸å‚ä¸é…å¯¹ï¼Œä¹Ÿå¯ä»¥ä¹±é€‰ä¸€ä¸ªç‚¹é…å¯¹ï¼Œå¦‚æœé€‰ä¸­äº†å·²é…å¯¹çš„ç‚¹å°±ä»¤å…¶å’Œ <span class=\"math inline\">\\(i-1\\)</span> äº¤æ¢ï¼Œå¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚åˆ™ <span class=\"math inline\">\\(f_i=f_{i-1}+(n-1)f_{i-2}\\)</span>ã€‚</p>\n<p>é¦–å…ˆéœ€è¦ check åŸå›¾æ˜¯å¦ä¸ºä»™äººæŒï¼Œé¡ºå¸¦å›å¿†ä¸€ä¸‹è¿é€šæ€§çš„çŸ¥è¯†â€”â€”åœ¨ DFS æ ‘ä¸Šå·®åˆ†ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰è¾¹è¢«è¦†ç›–ä¸¤æ¬¡å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n, m;\n        std::cin &gt;&gt; n &gt;&gt; m;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n        for (int x, y; m--; ) &#123;\n            std::cin &gt;&gt; x &gt;&gt; y;\n            g1[x].push_back(y), g1[y].push_back(x);\n        &#125;\n        bool flag = 1;\n        int now = 0, cnt = 0;\n        std::vector&lt;int&gt; st, dfn(n + 1), low(n + 1), col(n + 1), diff(n + 1);\n        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n            st.push_back(x);\n            dfn[x] = low[x] = ++now;\n            for (auto i : g1[x])\n                if (!dfn[i]) &#123;\n                    // printf(&quot;x = %d, %d -&gt; %d\\n&quot;, x, x, i);\n                    DFS(i, x);\n                    diff[x] += diff[i];\n                    // printf(&quot;x = %d, diff[%d] += diff[%d]\\n&quot;, x, x, i);\n                    low[x] = std::min(low[x], low[i]);\n                &#125;\n                else if (i != fa &amp;&amp; dfn[i] &lt; dfn[x]) &#123;\n                    low[x] = std::min(low[x], dfn[i]);\n                    ++diff[x], --diff[i];\n                    // printf(&quot;x = %d, ++diff[%d], --diff[%d]\\n&quot;, x, x, i);\n                &#125;\n            if (diff[x] &gt;= 2)\n                flag = 0;\n            // printf(&quot;x = %d, diff[%d] = %d\\n&quot;, x, x, diff[x]);\n            if (low[x] == dfn[x]) &#123;\n                ++cnt;\n                for (int p = -1; p != x; ) &#123;\n                    p = st.back(), st.pop_back();\n                    col[p] = cnt;\n                &#125;\n            &#125;\n            return;\n        &#125;;\n        DFS(1, -1);\n        if (!flag) &#123;\n            std::cout &lt;&lt; 0 &lt;&lt; &#39;\\n&#39;;\n            continue;\n        &#125;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n        for (int i = 1; i &lt;= n; ++i)\n            for (auto j : g1[i])\n                if (col[i] != col[j])\n                    g[i].push_back(j);\n        std::vector&lt;long long&gt; f(n + 1), dp(n + 1);\n        dp[0] = 1ll, dp[1] = 1ll;\n        for (int i = 2; i &lt;= n; ++i)\n            dp[i] = (dp[i - 1] + (i - 1) * dp[i - 2]) % mod;\n        std::vector&lt;int&gt; tag(n + 1);\n        DFS = [&amp;](int x, int fa) &#123;\n            f[x] = 1ll, tag[x] = 1;\n            for (auto i : g[x])\n                if (i != fa) &#123;\n                    DFS(i, x);\n                    (f[x] *= f[i]) %= mod;\n                &#125;\n            (f[x] *= dp[(int)g[x].size()]) %= mod;\n            return;\n        &#125;;\n        auto res(1ll);\n        for (int i = 1; i &lt;= n; ++i)\n            if (!tag[i])\n                DFS(i, -1), (res *= f[i]) %= mod;\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<p>E. Many Minimizations æ˜¯æ•°å­¦é¢˜ï¼Œè·³äº†ã€‚</p>\n<hr />\n<hr />\n<h2 id=\"æ— åé¢˜\">æ— åé¢˜</h2>\n<blockquote>\n<p>èƒŒæ™¯ï¼šç»™å®š <span class=\"math inline\">\\(n,k\\)</span>ï¼Œå¯¹äº <span class=\"math inline\">\\(\\forall\\, 1\\le i\\le n\\)</span>ï¼Œä»¤ <span class=\"math inline\">\\(a_i=i\\bmod k\\)</span>ï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ä¸ªæœ¬è´¨ä¸åŒçš„å­åºåˆ—ï¼Ÿå¯¹äº <span class=\"math inline\">\\(k=1,2,\\cdots,n\\)</span> åˆ†åˆ«æ±‚å‡ºç­”æ¡ˆã€‚</p>\n</blockquote>\n<hr />\n<h2 id=\"maimai\">maimai</h2>\n<p><a href=\"https://ac.nowcoder.com/acm/contest/66112/F\" class=\"uri\">https://ac.nowcoder.com/acm/contest/66112/F</a></p>\n",
            "tags": [
                "å­—å…¸æ ‘",
                "å­—ç¬¦ä¸²",
                "ç»„åˆæ•°å­¦",
                "æ”¯é…å¯¹"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250202/",
            "url": "https://xsc062.netlify.app/20250202/",
            "title": "å­¦ä¹ ç¬”è®°ï¼šåç¼€æ•°ç»„",
            "date_published": "2025-02-02T00:27:44.000Z",
            "content_html": "<p>éå¸¸åçŸ¥åè§‰åœ°æ„è¯†åˆ° SA(Suffix Array) å’Œ SAM(Suffix Automaton) çš„ A ä¸æ˜¯åŒä¸€ä¸ª A <img src=\"/em/fad.gif\" /></p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"å®šä¹‰\">å®šä¹‰</h2>\n<ul>\n<li>ä¸€ä¸ªé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„å­—ç¬¦ä¸²ä¸­æœ‰ <span class=\"math inline\">\\(n\\)</span> ä¸ªé•¿åº¦åˆ†åˆ«ä¸º <span class=\"math inline\">\\(1\\sim n\\)</span> çš„åç¼€</li>\n<li>å¯¹å…¶æŒ‰å­—å…¸åºæ’åºï¼Œåˆ†åˆ«å­˜å‚¨ä¸‹æ’åä¸º <span class=\"math inline\">\\(i\\)</span> çš„åç¼€ç¼–å· <span class=\"math inline\">\\(sa_i\\)</span> å’Œæ¯ä¸ªåç¼€ <span class=\"math inline\">\\(i\\)</span> çš„æ’å <span class=\"math inline\">\\(rk_i\\)</span>ã€‚</li>\n<li>è¿™æ ·ç›¸å½“äºæ„é€ äº†æœ‰åºçš„ã€å‰ç¼€çš„åç¼€ã€ï¼Œæ‰€ä»¥ä¼šæœ‰å¾ˆå¤šå­—ç¬¦ä¸²åŠŸèƒ½ã€‚</li>\n</ul>\n<h2 id=\"æ±‚è§£\">æ±‚è§£</h2>\n<h3 id=\"å“ˆå¸Œ-æ’åº\">å“ˆå¸Œ + æ’åº</h3>\n<ul>\n<li>ç›´æ¥æŠŠæ‰€æœ‰åç¼€æ‹¿æ¥æ’åºçš„è¯ï¼Œå­—ç¬¦ä¸²æ¯”è¾ƒæ˜¯ <span class=\"math inline\">\\(O(n)\\)</span> çš„ã€‚</li>\n<li>ç”¨å“ˆå¸Œ + äºŒåˆ†ä¼˜åŒ–æ¯”è¾ƒè¿‡ç¨‹ï¼Œå°±å¯ä»¥æŠŠæ•´ä¸ªæ’åºä¼˜åŒ–åˆ° <span class=\"math inline\">\\(O(n\\log^2 n)\\)</span>ã€‚</li>\n</ul>\n<h3 id=\"å€å¢\">å€å¢</h3>\n<ul>\n<li>é¦–å…ˆï¼ŒæŠŠåç¼€æŒ‰ç…§ <span class=\"math inline\">\\(s_i\\)</span>ï¼Œå³<strong>ç¬¬ä¸€ä¸ªå­—ç¬¦</strong>æ’åºï¼›è®°æ’åºåæ’ååºåˆ—ä¸º <span class=\"math inline\">\\(a\\)</span>ã€‚</li>\n<li>ç›¸ä¼¼åœ°ï¼Œå¯¹äºç¬¬ <span class=\"math inline\">\\(i\\)</span> ä¸ªåç¼€ï¼Œæˆ‘ä»¬ç”¨ <span class=\"math inline\">\\((a_i,a_{i+1})\\)</span> åŒå…³é”®å­—æ’åºï¼Œå³å¯æŒ‰ç…§åç¼€çš„<strong>å‰ä¸¤ä¸ªå­—ç¬¦</strong>æ’åºï¼›è®°æ­¤æ—¶æ’ååºåˆ—ä¸º <span class=\"math inline\">\\(b\\)</span>ã€‚</li>\n<li>è¿›ä¸€æ­¥åœ°ï¼Œç”¨ <span class=\"math inline\">\\((b_i,b_{i+2})\\)</span> è¿›è¡ŒåŒå…³é”®å­—æ’åºï¼Œå³å¯å®ç°æŒ‰åç¼€çš„<strong>å‰å››ä¸ªå­—ç¬¦</strong>æ’åºã€‚</li>\n<li>è¿›è¡Œ <span class=\"math inline\">\\(\\log n\\)</span> æ¬¡åŒå…³é”®å­—æ’åºåï¼Œå°±èƒ½å®Œæˆå¯¹æ•´ä¸ªåç¼€çš„æ­£ç¡®æ’åºã€‚</li>\n<li>ç”±äºæŠŠå­—ç¬¦ä¸²æ’åºå‹ç¼©æˆäº†å€¼åŸŸå¾ˆå°çš„æ•´æ•°æ’åºï¼Œç”¨æ¡¶æ’å°±å¯ä»¥å‡ä¸€ä¸ª <span class=\"math inline\">\\(\\log\\)</span>ï¼Œå®ç° <span class=\"math inline\">\\(O(n\\log n)\\)</span> æ±‚ SAã€‚</li>\n</ul>\n<h2 id=\"å®ç°\">å®ç°</h2>\n<ul>\n<li>å“ˆå¸Œå¾ˆå¥½å®ç°ï¼Œè¿™é‡ŒæŒ‰ä¸‹ä¸è¡¨ã€‚ä¸»è¦è®²è§£å€å¢æ³•çš„å®ç°ã€‚</li>\n<li><p>é¦–å…ˆäº†è§£åŒå…³é”®å­—æ¡¶æ’çš„æ–¹æ³•ï¼š</p>\n<p>è®¡ç®—å‡º<strong>ç¬¬ä¸€å…³é”®å­—</strong>çš„æ¡¶åºåˆ—ï¼Œä»¤æ¡¶ <span class=\"math inline\">\\(c_i\\)</span> è®°å½•<strong>å‰</strong> <span class=\"math inline\">\\(i\\)</span> ä¸ªå…ƒç´ çš„æ•°é‡ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯è®©æ¡¶ <span class=\"math inline\">\\(c\\)</span> å……å½“è®¡ç®—ä¸‹æ ‡èŒƒå›´çš„ä½œç”¨ï¼Œ<span class=\"math inline\">\\((c_{i-1},c_i]\\)</span> å³ä¸º <span class=\"math inline\">\\(i\\)</span> åˆ†å¸ƒçš„èŒƒå›´ã€‚</p>\n<p>éå†<strong>æ’åºåçš„ç¬¬äºŒå…³é”®å­—æ•°ç»„</strong>ï¼ˆåœ¨ SA ä¸­ï¼Œæ’åºåœ¨ä¸Šä¸€è½®å®Œæˆï¼‰ï¼Œå°†å…ƒç´ æ”¾åˆ°ç¬¬ä¸€å…³é”®å­—åœ¨ <span class=\"math inline\">\\(c\\)</span> ä¸­è®°å½•çš„ä¸‹æ ‡ä¸­ï¼Œå¹¶å°† <span class=\"math inline\">\\(c\\)</span> ä¸­æ•°å€¼ <span class=\"math inline\">\\(-1\\)</span>ã€‚</p>\n<p>æ˜¾ç„¶å½“æ’åç§ç±»ä¸º <span class=\"math inline\">\\(n\\)</span>ï¼Œå³æ²¡æœ‰å¹¶åˆ—æ’åæ—¶ï¼Œæ’åºå®Œæˆã€‚</p></li>\n<li><p>è®¾æœ¬è½®åŒºé—´é•¿åº¦ä¸º <span class=\"math inline\">\\(2w\\)</span>ï¼Œå¯¹äºä¸€è½®æ“ä½œï¼š</p>\n<ol type=\"1\">\n<li>è®¡ç®—æ¯ä¸ªåŒºé—´æŒ‰å <span class=\"math inline\">\\(w\\)</span> é•¿åº¦å­—ç¬¦æ’åºçš„ç»“æœï¼š<span class=\"math inline\">\\((n-w,n]\\)</span> å¼€å¤´çš„åŒºé—´ååŠæ®µå‡ä¸ºç©ºï¼Œç›´æ¥æ”¾åœ¨åºåˆ—é¦–ç«¯ï¼›æ¥ç€æŒ‰ç…§ä¸Šä¸€è½® <span class=\"math inline\">\\(sa\\)</span> ç»“æœï¼ŒæŠŠèƒ½å¤Ÿä½œä¸ºååŠæ®µçš„å…ƒç´ ä¾æ¬¡æ”¾å…¥ã€‚</li>\n<li>ä¾ç…§ä¸Šä¸€è½®çš„ <span class=\"math inline\">\\(rk\\)</span> ä½œä¸ºç¬¬äºŒå…³é”®å­—æ’åï¼Œè¿›è¡ŒåŒå…³é”®å­—æ¡¶æ’ã€‚</li>\n<li>ä¾ç…§å¾—åˆ°çš„ <span class=\"math inline\">\\(sa\\)</span> å’Œç¬¬äºŒå…³é”®å­—çš„æ’åï¼Œå¤„ç†å¹¶åˆ—ï¼Œæ±‚å‡ºè¿™ä¸€è½®çš„ <span class=\"math inline\">\\(rk\\)</span>ã€‚</li>\n</ol></li>\n</ul>\n<details>\n<p>å€’ç€å†™æ˜¯ä¸ºäº†ä¿è¯æ‰€è°“ç¨³å®šæ€§ã€‚ç„¶è€Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ‰€è°“ã€‚</p>\n<pre class=\"cpp\"><code>std::vector&lt;int&gt; sa(n + 1), rk(2 * n + 1);\n&#123;\n    int m = 128;\n    std::vector&lt;int&gt; c(std::max(n, m) + 1), id, la(2 * n + 1);\n    std::copy(s.begin() + 1, s.end(), rk.begin() + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        ++c[rk[i]];\n    std::partial_sum(c.begin() + 1, c.begin() + m + 1, c.begin() + 1);\n    for (int i = n; i; --i)\n        sa[c[rk[i]]--] = i;\n    for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n        id.clear(), id.push_back(-1);\n        for (int i = n - w + 1; i &lt;= n; ++i)\n            id.push_back(i);\n        for (int i = 1; i &lt;= n; ++i)\n            if (sa[i] &gt; w)\n                id.push_back(sa[i] - w);\n        std::fill(c.begin() + 1, c.begin() + m + 1, 0);\n        for (int i = 1; i &lt;= n; ++i)\n            ++c[rk[i]];\n        std::partial_sum(c.begin() + 1, c.begin() + m + 1, c.begin() + 1);\n        for (int i = n; i; --i)\n            sa[c[rk[id[i]]]--] = id[i];\n        p = 0;\n        std::copy(rk.begin() + 1, rk.end(), la.begin() + 1);\n        for (int i = 1; i &lt;= n; ++i)\n            if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                rk[sa[i]] = p;\n            else\n                rk[sa[i]] = ++p;\n        if (p == n)\n            break;\n    &#125;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"çº¯-sa-çš„åº”ç”¨\">çº¯ SA çš„åº”ç”¨</h2>\n<h3 id=\"æœ€å°è¡¨ç¤ºæ³•\">æœ€å°è¡¨ç¤ºæ³•</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P1368\" class=\"uri\">https://www.luogu.com.cn/problem/P1368</a>ã€‚</p>\n<ul>\n<li>å¯¹äºå¾ªç¯ä½ç§»ç›¸å…³è¦æ±‚ï¼Œé¦–å…ˆè€ƒè™‘å°† <span class=\"math inline\">\\(\\texttt s\\)</span> é‡å¤ä¸€éã€‚</li>\n<li>åœ¨ <span class=\"math inline\">\\(\\texttt {ss}\\)</span> ä¸­æ‰¾åˆ°ç¬¬ä¸€ä¸ª <span class=\"math inline\">\\(sa_i\\le n\\)</span> å³ä¸ºç­”æ¡ˆã€‚</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; s(2 * n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; s[i], s[n + i] = s[i];\n    std::vector&lt;int&gt; sa(2 * n + 1), rk(s);\n    &#123;\n        int m = 29;\n        &#123;\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= 2 * n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = 2 * n; i; --i)\n                sa[c[rk[i]]--] = i;\n        &#125;\n        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n            std::vector&lt;int&gt; id(1);\n            for (int i = 2 * n - w + 1; i &lt;= 2 * n; ++i)\n                id.push_back(i);\n            for (int i = 1; i &lt;= 2 * n; ++i)\n                if (sa[i] &gt; w)\n                    id.push_back(sa[i] - w);\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= 2 * n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = 2 * n; i; --i)\n                sa[c[rk[id[i]]]--] = id[i];\n            auto la(rk);\n            p = 0;\n            for (int i = 1; i &lt;= 2 * n; ++i)\n                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                    rk[sa[i]] = p;\n                else\n                    rk[sa[i]] = ++p;\n            if (p == 2 * n)\n                break;\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= 2 * n; ++i)\n        if (sa[i] &lt;= n) &#123;\n            for (int j = sa[i]; j &lt; n + sa[i]; ++j)\n                std::cout &lt;&lt; s[j] &lt;&lt; &#39; &#39;;\n            std::cout &lt;&lt; &#39;\\n&#39;;\n            break;\n        &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"å­—ç¬¦ä¸²åŒ¹é…\">å­—ç¬¦ä¸²åŒ¹é…</h3>\n<ul>\n<li>äºŒåˆ†ï¼Œå¤æ‚åº¦ <span class=\"math inline\">\\(O(|S|\\log |T|)\\)</span>ã€‚æ±‚å‡ºç°æ¬¡æ•°åˆ™äºŒåˆ†å·¦å³è¾¹ç•Œã€‚</li>\n<li>å¤ªéº»çƒ¦äº†ä¸”æ²¡æœ‰å®é™…åº”ç”¨ä»·å€¼ï¼Œä»£ç ç•¥ã€‚</li>\n</ul>\n<hr />\n<h2 id=\"height-æ•°ç»„\">height æ•°ç»„</h2>\n<p>å®šä¹‰ <span class=\"math inline\">\\(h_i=\\text {lcp}(sa_i, sa_i-1)\\)</span>ï¼Œç‰¹åˆ«åœ°ï¼Œ<span class=\"math inline\">\\(h_1=0\\)</span>ã€‚</p>\n<blockquote>\n<p>æœ‰å¼•ç†ï¼š<span class=\"math inline\">\\(h_{rk_i}\\ge h_{rk_{i-1}}-1\\)</span>ã€‚</p>\n</blockquote>\n<p>å‡è®¾å·²ç»æ±‚å‡º <span class=\"math inline\">\\(h_{rk_{i-1}}\\)</span>ï¼Œé‚£ä¹ˆå¯ä»¥ä» <span class=\"math inline\">\\(h_{rk_{i-1}}-1\\)</span> å‡ºå‘æš´åŠ›çœ‹ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯å¦ç›¸ç­‰å¾—åˆ°ç­”æ¡ˆã€‚é‚£ä¹ˆæˆ‘ä»¬ä¼šå‘ç°ä»å‰å¾€å <span class=\"math inline\">\\(h\\)</span> å€¼æ¯æ¬¡æœ€å¤š <span class=\"math inline\">\\(-1\\)</span>ï¼Œæ‰€ä»¥å¤æ‚åº¦æ‘Šä¸‹æ¥æ˜¯ <span class=\"math inline\">\\(O(n)\\)</span> çš„ã€‚</p>\n<p><mark>è®°ä½è®°ä½ä¸€å®šæ˜¯ <span class=\"math inline\">\\(rk_{i-1}\\)</span> è€Œä¸æ˜¯ä¸‹æ„è¯†çš„ <span class=\"math inline\">\\(rk_i-1\\)</span>ï¼ï¼ï¼</mark>æ‰€ä»¥ä¸ºäº†ä¿è¯æ±‚è§£é¡ºåºå¾ªç¯æšä¸¾çš„ä¸€å®šæ˜¯ä¸‹æ ‡è€Œéæ’åã€‚ä½†æ˜¯æ³¨æ„å®šä¹‰å´æ˜¯å’Œ <span class=\"math inline\">\\(rk_i-1\\)</span> çš„ lcpï¼ï¼ï¼æ‰€ä»¥æ±‚ height çš„å†™æ³•æ˜¯ç›¸å¯¹å›ºå®šçš„ï¼Œä¸èƒ½è§‰å¾—å¥½åƒæ˜¯å¯¹çš„å°±éšä¾¿ä¹±æ”¹ã€‚</p>\n<hr />\n<h2 id=\"height-æ•°ç»„çš„åº”ç”¨\">height æ•°ç»„çš„åº”ç”¨</h2>\n<p>ç›¸å½“äºèƒŒæ¿å­ï¼Œå› ä¸ºåº”ç”¨å¤ªå¤šä¸”å½¢å¼å¤§å¤šå›ºå®šã€‚</p>\n<h3 id=\"æ±‚ä»»æ„ä¸¤ä¸ªåç¼€çš„-lcp\">æ±‚ä»»æ„ä¸¤ä¸ªåç¼€çš„ lcp</h3>\n<p>æ˜“å¾— <span class=\"math inline\">\\(\\text{lcp}(sa_i, sa_j)=\\min\\{h_{i+1}, \\cdots, h_j\\}\\)</span>ã€‚<strong>æ•…åº”å°†ä¸€äº›å¤æ‚ lcp é—®é¢˜çš„è§£å†³æ–¹å¼å’Œ RMQ è”ç³»èµ·æ¥</strong>ã€‚</p>\n<hr />\n<h3 id=\"å­ä¸²å¤§å°å…³ç³»\">å­ä¸²å¤§å°å…³ç³»</h3>\n<p>å³æ¯”è¾ƒ <span class=\"math inline\">\\(S_{l_1, r_1}\\)</span> å’Œ <span class=\"math inline\">\\(S_{l_2, r_2}\\)</span> çš„å¤§å°å…³ç³»ã€‚æ¯”è¾ƒå¯¼è‡´ lcp ä¸èƒ½ç»§ç»­å»¶ä¼¸çš„å…ƒç´ å¤§å°å³å¯ã€‚</p>\n<hr />\n<h3 id=\"æœ¬è´¨ä¸åŒå­ä¸²æ•°é‡\">æœ¬è´¨ä¸åŒå­ä¸²æ•°é‡</h3>\n<p><strong>å­ä¸²ç­‰ä»·äºã€Œåç¼€çš„å‰ç¼€ã€</strong>ã€‚æŒ‰é¡ºåºæšä¸¾æ¯ä¸ªåç¼€ï¼Œå‡å»å’Œå·²æšä¸¾çš„æ‰€æœ‰åç¼€çš„ lcp å³å¯ã€‚é‰´äº <span class=\"math inline\">\\(\\min\\{h_{j+1},\\cdots,h_i\\}\\)</span> å•è°ƒä¸å‡ï¼Œç›´æ¥å‡å» <span class=\"math inline\">\\(h_i\\)</span> å³å¯ã€‚</p>\n<p>æœ€åç­”æ¡ˆå³ä¸º <span class=\"math inline\">\\(\\frac {n(n-1)}2 - \\sum\\limits_{i=2}^nh_i\\)</span>ã€‚</p>\n<hr />\n<h3 id=\"è‡³å°‘å‡ºç°-k-æ¬¡å­ä¸²çš„æœ€å¤§é•¿åº¦\">è‡³å°‘å‡ºç° <span class=\"math inline\">\\(k\\)</span> æ¬¡å­ä¸²çš„æœ€å¤§é•¿åº¦</h3>\n<p>æ¨¡æ¿ï¼š<a href=\"https://www.luogu.com.cn/problem/P2852\" class=\"uri\">https://www.luogu.com.cn/problem/P2852</a>ã€‚</p>\n<p>å‡ºç° <span class=\"math inline\">\\(k\\)</span> æ¬¡ <span class=\"math inline\">\\(\\iff\\)</span> åœ¨åç¼€æ•°ç»„ä¸­è¿ç»­å‡ºç° <span class=\"math inline\">\\(k\\)</span> æ¬¡ <span class=\"math inline\">\\(\\iff\\)</span> æ˜¯ä»»æ„è¿ç»­ <span class=\"math inline\">\\(k-1\\)</span> ä¸ª <span class=\"math inline\">\\(h\\)</span> çš„æœ€å°å€¼ï¼Œéœ€è¦æœ€å¤§åŒ–è¯¥æœ€å°å€¼ï¼Œè€ƒè™‘æ»‘åŠ¨çª—å£ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;P2852_7.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, k;\n    std::cin &gt;&gt; n &gt;&gt; k, --k;\n    std::vector&lt;int&gt; s(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; s[i];\n    std::vector&lt;int&gt; sa(n + 1), rk(s), h(n + 1);\n    &#123;\n        int m = 1000001;\n        &#123;\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n; i; --i)\n                sa[c[rk[i]]--] = i;\n        &#125;\n        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n            std::vector&lt;int&gt; id(1);\n            for (int i = n - w + 1; i &lt;= n; ++i)\n                id.push_back(i);\n            for (int i = 1; i &lt;= n; ++i)\n                if (sa[i] &gt; w)\n                    id.push_back(sa[i] - w);\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n; i; --i)\n                sa[c[rk[id[i]]]--] = id[i];\n            auto la(rk);\n            p = 0;\n            for (int i = 1; i &lt;= n; ++i)\n                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                    rk[sa[i]] = p;\n                else\n                    rk[sa[i]] = ++p;\n            if (p == n)\n                break;\n        &#125;\n        for (int i = 1, to = 0; i &lt;= n; ++i)\n            if (rk[i]) &#123;\n                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);\n                h[rk[i]] = to;\n            &#125;\n    &#125;\n    std::vector&lt;int&gt; q(n + 1);\n    int res = 0;\n    for (int i = 1, l = 1, r = 0; i &lt;= n; ++i) &#123;\n        // printf(&quot;%d\\n&quot;, h[i]);\n        for (; l &lt;= r &amp;&amp; i - q[l] &gt;= k; ++l);\n        for (; l &lt;= r &amp;&amp; h[i] &lt;= h[q[r]]; --r);\n        q[++r] = i;\n        if (i &gt;= k)\n            res = std::max(res, h[q[l]]);\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"æœ€é•¿ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²\">æœ€é•¿ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²</h3>\n<p><del>bbï¼šå®šå¼å¤ªå¤šå¤ªæ‚ä»¥è‡³äºè®©äººæ€€ç–‘æŸäº›å®šå¼æ˜¯å¦å­˜åœ¨åº”ç”¨åœºæ™¯</del> <img src=\"/em/kt.gif\" /></p>\n<p>å‘ç°æ»¡è¶³å•è°ƒæ€§ï¼ŒäºŒåˆ†å­ä¸²é•¿åº¦ <span class=\"math inline\">\\(len\\)</span>ï¼Œé‚£ä¹ˆæ˜¾ç„¶ <span class=\"math inline\">\\(\\text {lcp}\\ge len\\)</span>ï¼›å°† <span class=\"math inline\">\\(h\\)</span> åˆ’åˆ†ä¸ºè¿ç»­ <span class=\"math inline\">\\(\\ge len\\)</span> çš„æ®µï¼Œåœ¨æ¯æ®µå†…æ‰¾åˆ°ä¸‹æ ‡æå·®ä¸ <span class=\"math inline\">\\(len\\)</span> æ¯”è¾ƒå³å¯ã€‚</p>\n<p>ä¹Ÿå¯ä»¥ç”¨äºåˆ¤å®šæ˜¯å¦å­˜åœ¨ä¸é‡å å¤šæ¬¡å‡ºç°å­ä¸²ã€‚</p>\n<p>ç”šè‡³å¯ä»¥è€ƒè™‘é™åˆ¶è‡³å°‘å‡ºç°æ¬¡æ•°ä¸º <span class=\"math inline\">\\(k\\)</span>ï¼Œé‚£å¤§æ¦‚å¤šä¸ª <span class=\"math inline\">\\(\\log\\)</span>ï¼Œçœ‹çœ‹ä¸€æ®µé‡Œæœ‰æ²¡æœ‰ <span class=\"math inline\">\\(\\ge k\\)</span> ä¸ªç›¸äº’ç›¸å·® <span class=\"math inline\">\\(\\ge len\\)</span> çš„ã€‚æ’åºè´ªå¿ƒæ±‚è§£ã€‚</p>\n<p>é‚£ä¹ˆä¸Šé¢çš„è‡³å°‘å‡ºç° <span class=\"math inline\">\\(k\\)</span> æ¬¡å­ä¸²ä¹Ÿå¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•æ¥è§£ï¼Œä½†æ˜¯å¤šä¸ª <span class=\"math inline\">\\(\\log\\)</span> æ²¡å¿…è¦ã€‚</p>\n<p>ä¹Ÿå¯ä»¥é™åˆ¶å¤šæ¬¡å‡ºç°ä½†é•¿åº¦è‡³å°‘ä¸º <span class=\"math inline\">\\(len\\)</span>ï¼Œé‚£ç”šè‡³å°‘äº†äºŒåˆ†çš„ <span class=\"math inline\">\\(\\log\\)</span>ï¼Œç›´æ¥è·‘ä¸€é check å³å¯ã€‚</p>\n<p><del>ï¼Ÿï¼Ÿï¼Ÿåˆ°åº•ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ä¹ˆå¤šå¥‡æ€ªçš„å®šå¼ï¼Œæ˜¯å› ä¸ºçœŸçš„æœ‰é¢˜è¿™ä¹ˆå‡ºå—ï¼Ÿï¼Ÿï¼Ÿ</del> <img src=\"/em/oh.gif\" /></p>\n<hr />\n<h3 id=\"æœ€é•¿å…¬å…±å­ä¸²é—®é¢˜\">æœ€é•¿å…¬å…±å­ä¸²é—®é¢˜</h3>\n<p>æ±‚ <span class=\"math inline\">\\(S\\)</span> å’Œ <span class=\"math inline\">\\(T\\)</span> çš„æœ€é•¿å…¬å…±å­ä¸²ï¼ˆæ³¨æ„ä¸æ˜¯ LCSï¼‰ã€‚è®¾ <span class=\"math inline\">\\(S\\)</span> é•¿ä¸º <span class=\"math inline\">\\(n\\)</span>ï¼Œ<span class=\"math inline\">\\(T\\)</span> é•¿ä¸º <span class=\"math inline\">\\(m\\)</span>ï¼Œé‚£ä¹ˆå°† <span class=\"math inline\">\\(S\\)</span> ä¸ <span class=\"math inline\">\\(T\\)</span> æ‹¼æ¥ï¼Œç­”æ¡ˆå°±æ˜¯ <span class=\"math inline\">\\(\\max \\{\\text{lcp}(i,j)\\},i\\le n&lt;j\\)</span>ã€‚</p>\n<p>ä½†è¿™é‡Œä¸ç›´æ¥æšä¸¾ <span class=\"math inline\">\\(i\\)</span> å’Œ <span class=\"math inline\">\\(j\\)</span>ï¼Œè¿˜æ˜¯ç…§ä¾‹å…ˆä» <span class=\"math inline\">\\(h\\)</span> ä¸‹æ‰‹å†å¡æ¡ä»¶ï¼Œè‹¥ <span class=\"math inline\">\\(sa_{i-1}\\le n&lt;sa_{i}\\)</span>ï¼ˆæˆ–è€…åè¿‡æ¥ï¼‰ï¼Œå°±å¯ä»¥ç”¨ <span class=\"math inline\">\\(h_i\\)</span> æ›´æ–°ç­”æ¡ˆã€‚å®¹æ˜“è¯æ˜è¿™æ ·æ€»å¯ä»¥æ‰¾åˆ°æœ€å¤§å€¼ã€‚</p>\n<h4 id=\"eg1.-æ‰¾ç›¸åŒå­—ç¬¦\">eg1. æ‰¾ç›¸åŒå­—ç¬¦</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P3181\" class=\"uri\">https://www.luogu.com.cn/problem/P3181</a></p>\n<p>è¦æ±‚æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º <span class=\"math inline\">\\(\\text{lcp}(i,j),i\\le n&lt;j\\)</span>ã€‚ï¼ˆæˆ‘å·²ç»å¸®ä½ ä»¬è¯•è¿‡äº†å®¹æ–¥æ¯”ç›´æ¥åšæ›´éº»çƒ¦ï¼‰ï¼Œè€ƒè™‘ç”¨å•è°ƒæ ˆç»´æŠ¤å·¦ / å³ä¾§åŒºé—´ lcp æ±‚è§£å³ / å·¦ä¾§ç­”æ¡ˆã€‚å…³äºå•è°ƒæ ˆçš„æè¿°å¯è§ <a href=\"#ç»“åˆå•è°ƒæ ˆ\">æœ¬é¡µåéƒ¨å†…å®¹</a>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, n1;\n    std::string s, t;\n    std::cin &gt;&gt; s &gt;&gt; t;\n    n = (int)s.length(), n1 = n + (int)t.length() + 1;\n    s = &quot;#&quot; + s + &quot;$&quot; + t;\n    std::vector&lt;int&gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);\n    &#123;\n        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);\n        int m = 128;\n        &#123;\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n1; i; --i)\n                sa[c[rk[i]]--] = i;\n        &#125;\n        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n            std::vector&lt;int&gt; id(w + 1);\n            std::iota(id.begin() + 1, id.end(), n1 - w + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                if (sa[i] &gt; w)\n                    id.push_back(sa[i] - w);\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n1; i; --i)\n                sa[c[rk[id[i]]]--] = id[i];\n            p = 0;\n            auto la(rk);\n            for (int i = 1; i &lt;= n1; ++i)\n                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                    rk[sa[i]] = p;\n                else\n                    rk[sa[i]] = ++p;\n            if (p == n1)\n                break;\n        &#125;\n        for (int i = 1, to = 0; i &lt;= n1; ++i) &#123;\n            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);\n            h[rk[i]] = to;\n        &#125;\n    &#125;\n    std::vector&lt;std::pair&lt;int, long long&gt; &gt; q1, q2;\n    std::vector&lt;int&gt; tot1(n1 + 1), tot2(n1 + 1);\n    for (int i = 1; i &lt;= n1; ++i) &#123;\n        tot1[i] = tot1[i - 1] + (sa[i] &lt;= n);\n        tot2[i] = tot2[i - 1] + (sa[i] &gt; n + 1);\n    &#125;\n    long long res = 0ll;\n    q1.emplace_back(1, 0ll), q2.emplace_back(1, 0ll);\n    for (int i = 1; i &lt;= n1; ++i) &#123;\n        for (; !q1.empty() &amp;&amp; h[i] &lt; h[q1.back().first]; q1.pop_back());\n        q1.emplace_back(i, (tot1[i - 1] - tot1[q1.back().first - 1]) * h[i] + q1.back().second);\n        if (sa[i] &gt; n + 1)\n            res += q1.back().second;\n        for (; !q2.empty() &amp;&amp; h[i] &lt; h[q2.back().first]; q2.pop_back());\n        q2.emplace_back(i, (tot2[i - 1] - tot2[q2.back().first - 1]) * h[i] + q2.back().second);\n        if (sa[i] &lt;= n)\n            res += q2.back().second;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<h4 id=\"eg2.-å…¬å…±ä¸²\">eg2. å…¬å…±ä¸²</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P5546\" class=\"uri\">https://www.luogu.com.cn/problem/P5546</a></p>\n<p>è¦æ±‚å¤šä¸²æœ€é•¿å…¬å…±å­ä¸²ï¼Œä»ç„¶è€ƒè™‘å°†å¤šä¸ªä¸²æ‹¼åœ¨ä¸€èµ·ã€‚ä»¿ç…§å‰é¢äºŒåˆ†çš„æ–¹å¼å¤„ç†ï¼Œé—®é¢˜è½¬åŒ–ä¸ºæ‰¾åˆ°æœ€é•¿çš„ <span class=\"math inline\">\\(len\\)</span>ï¼Œä½¿å¾—å­˜åœ¨ä¸€æ®µæœ€å°å€¼ <span class=\"math inline\">\\(\\ge len\\)</span> çš„åŒºé—´ï¼Œå…¶è¦†ç›–äº† <span class=\"math inline\">\\(n\\)</span> æ®µä¸²ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, l = 0, r = 0;\n    std::cin &gt;&gt; n;\n    std::string s;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; lim(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::string t;\n        std::cin &gt;&gt; t;\n        lim[i] = &#123; (int)s.length() + 1, s.length() + t.length() &#125;;\n        s += &quot;#&quot; + t;\n        r = std::max(r, (int)t.length());\n        // printf(&quot;[%d, %d]\\n&quot;, lim[i].first, lim[i].second);\n    &#125;\n    int n1 = lim.back().second;\n    std::vector&lt;int&gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);\n    &#123;\n        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);\n        int m = 128;\n        &#123;\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n1; i; --i)\n                sa[c[rk[i]]--] = i;\n        &#125;\n        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n            std::vector&lt;int&gt; id(w + 1);\n            std::iota(id.begin() + 1, id.end(), n1 - w + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                if (sa[i] &gt; w)\n                    id.push_back(sa[i] - w);\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n1; i; --i)\n                sa[c[rk[id[i]]]--] = id[i];\n            p = 0;\n            auto la(rk);\n            for (int i = 1; i &lt;= n1; ++i)\n                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                    rk[sa[i]] = p;\n                else\n                    rk[sa[i]] = ++p;\n            if (p == n1)\n                break;\n        &#125;\n        for (int i = 1, to = 0; i &lt;= n1; ++i) &#123;\n            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);\n            h[rk[i]] = to;\n        &#125;\n    &#125;\n    // for (int i = 1; i &lt;= n1; ++i)\n    //     printf(&quot;h[%d] = %d\\n&quot;, sa[i], h[i]);\n    int res = 0;\n    auto check = [&amp;](int len) &#123;\n        // printf(&quot;check %d: \\n&quot;, len);\n        std::vector&lt;int&gt; cnt(n + 1);\n        for (int i = 1; i &lt;= n1; ++i) &#123;\n            if (h[i] &lt; len) &#123;\n                if (*std::min_element(cnt.begin() + 1, cnt.end()))\n                    return 1;\n                cnt.assign(n + 1, 0);\n            &#125;\n            else\n                for (int j = 1; j &lt;= n; ++j) &#123;\n                    if (lim[j].first &lt;= sa[i - 1] &amp;&amp; sa[i - 1] &lt;= lim[j].second)\n                        cnt[j] = 1;\n                    if (lim[j].first &lt;= sa[i] &amp;&amp; sa[i] &lt;= lim[j].second)\n                        cnt[j] = 1;\n                &#125;\n        &#125;\n        // printf(&quot;\\n%d\\n&quot;, *std::min_element(cnt.begin() + 1, cnt.end()));\n        return *std::min_element(cnt.begin() + 1, cnt.end());\n    &#125;;\n    for (int mid; l &lt;= r; ) &#123;\n        mid = (l + r) &gt;&gt; 1;\n        if (check(mid))\n            l = mid + 1, res = mid;\n        else\n            r = mid - 1;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<p>ä½†æ˜¯çœ‹äº†é¢˜è§£å‘ç°å±…ç„¶è¿˜æœ‰çº¿æ€§åšæ³•ï¼ˆå½“ç„¶ä¸çœ‹å»º SA çš„ <span class=\"math inline\">\\(\\log\\)</span>ï¼‰ï¼Œå¯¹äºè¦†ç›–å…¨éƒ¨ <span class=\"math inline\">\\(n\\)</span> æ®µä¸²æ‰¾åŒºé—´æœ€å°å€¼ï¼Œå‘ç°éœ€è¦æœ€å°åŒ–åŒºé—´ï¼Œè€ƒè™‘åŒæŒ‡é’ˆã€‚</p>\n<p>åŒºé—´æœ€å°å€¼ç”¨å•è°ƒé˜Ÿåˆ—æ±‚è§£ï¼Œç»†æƒ³å¯èƒ½ä¼šè§‰å¾—ä¸å¤ªå¯¹åŠ²ï¼Œä½†æ˜¯å®¹æ˜“è¯æ˜ç­”æ¡ˆä¸å¤§äºé˜Ÿé¦–ä¸”ä¸å°äºæœ€å¤§é˜Ÿé¦–ï¼Œæ‰€ä»¥æœ€å¤§é˜Ÿé¦–å°±æ˜¯ç­”æ¡ˆã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, l = 0, r = 0;\n    std::cin &gt;&gt; n;\n    std::string s;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; lim(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::string t;\n        std::cin &gt;&gt; t;\n        lim[i] = &#123; (int)s.length() + 1, s.length() + t.length() &#125;;\n        s += (char)(&#39;A&#39; + i - 1) + t;\n        r = std::max(r, (int)t.length());\n    &#125;\n    int n1 = lim.back().second;\n    std::vector&lt;int&gt; sa(n1 + 1), rk(n1 + 1), h(n1 + 1);\n    &#123;\n        std::copy(s.begin() + 1, s.end(), rk.begin() + 1);\n        int m = 128;\n        &#123;\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n1; i; --i)\n                sa[c[rk[i]]--] = i;\n        &#125;\n        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n            std::vector&lt;int&gt; id(w + 1);\n            std::iota(id.begin() + 1, id.end(), n1 - w + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                if (sa[i] &gt; w)\n                    id.push_back(sa[i] - w);\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n1; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n1; i; --i)\n                sa[c[rk[id[i]]]--] = id[i];\n            p = 0;\n            auto la(rk);\n            for (int i = 1; i &lt;= n1; ++i)\n                if (i != 1 &amp;&amp; la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                    rk[sa[i]] = p;\n                else\n                    rk[sa[i]] = ++p;\n            if (p == n1)\n                break;\n        &#125;\n        for (int i = 1, to = 0; i &lt;= n1; ++i) &#123;\n            for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);\n            h[rk[i]] = to;\n        &#125;\n    &#125;\n    int res = 0;\n    std::vector&lt;int&gt; q(n1 + 1), cnt(n + 1);\n    // for (int i = 1; i &lt;= n1; ++i)\n    //     printf(&quot;%d: %d\\n&quot;, sa[i], h[i]);\n    for (int l = 1, r = 0, ql = 1, qr = 0; l &lt;= n1; ++l) &#123;\n        for (; r &lt; n1 &amp;&amp; !*std::min_element(cnt.begin() + 1, cnt.end()); ) &#123;\n            ++r;\n            for (int i = 1; i &lt;= n; ++i)\n                if (lim[i].first &lt;= sa[r] &amp;&amp; sa[r] &lt;= lim[i].second) &#123;\n                    ++cnt[i];\n                    break;\n                &#125;\n            for (; ql &lt;= qr &amp;&amp; h[r] &lt;= h[q[qr]]; --qr);\n            q[++qr] = r;\n        &#125;\n        if (*std::min_element(cnt.begin() + 1, cnt.end())) &#123;\n            // printf(&quot;[%d, %d]: %d\\n&quot;, l, r, h[q[ql]]);\n            res = std::max(res, h[q[ql]]);\n        &#125;\n        for (; ql &lt;= qr &amp;&amp; q[ql] &lt;= l; ++ql);\n        if (l != 1) &#123;\n            for (int i = 1; i &lt;= n; ++i)\n                if (lim[i].first &lt;= sa[l - 1] &amp;&amp; sa[l - 1] &lt;= lim[i].second) &#123;\n                    --cnt[i];\n                    break;\n                &#125;\n        &#125;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"texttt-aa-å¼å­ä¸²å¤„ç†\"><span class=\"math inline\">\\(\\texttt {AA}\\)</span> å¼å­ä¸²å¤„ç†</h3>\n<p>å³å¯¹äºè¿ç»­ç›¸åŒå­ä¸²é—®é¢˜çš„å¤„ç†ï¼Œæœ‰ä¸€ä¸ªå®šçš„æ€è·¯ï¼Œç”±ä¾‹é¢˜åˆ†æã€‚</p>\n<h4 id=\"eg1.-ä¼˜ç§€çš„æ‹†åˆ†\">eg1. ä¼˜ç§€çš„æ‹†åˆ†</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P1117\" class=\"uri\">https://www.luogu.com.cn/problem/P1117</a></p>\n<p>è¿˜æ˜¯ä»ä¸­é—´åˆ†å¼€ï¼ŒæŒ‰å‰ååˆ†åˆ«å¤„ç†ã€‚è¿™é‡Œæœ‰ä¸ª trickï¼Œæˆ‘ä»¬æšä¸¾ <span class=\"math inline\">\\(\\texttt B\\)</span> çš„é•¿åº¦ <span class=\"math inline\">\\(len\\)</span>ï¼Œåœ¨ <span class=\"math inline\">\\(S\\)</span> ä¸­æ¯éš” <span class=\"math inline\">\\(len\\)</span> æ‰“ä¸€ä¸ªæ ‡è®°ã€‚é‚£ä¹ˆæ˜¾ç„¶ï¼Œä»»æ„ä¸€ä¸ªé•¿åº¦ä¸º <span class=\"math inline\">\\(2\\times len\\)</span> çš„å­ä¸²éƒ½ä¼šç»è¿‡æ°å¥½ä¸¤ä¸ªæ ‡è®°ï¼ˆå……åˆ†çš„ï¼‰ï¼Œè¿™æ ·å°±å¯ä»¥ç­›é€‰å‡ºæ‰€æœ‰å¯èƒ½çš„ä¸²ã€‚</p>\n<p>æˆ‘ä»¬æšä¸¾æ‰€æœ‰è¿ç»­ä¸¤ä¸ªæ ‡è®°ï¼ˆæ€»å¤æ‚åº¦ä¸ºè°ƒå’Œçº§æ•°ï¼‰ï¼Œæ±‚å®ƒä»¬å¯¹åº”åç¼€çš„ lcp å’Œå¯¹åº”å‰ç¼€çš„ lcsï¼ˆç¿»è½¬æ±‚ SA å³å¯ï¼‰ï¼Œå¦‚æœäºŒè€…åŠ èµ·æ¥ <span class=\"math inline\">\\(\\ge len\\)</span> å°±è¯´æ˜å­˜åœ¨è¿™æ ·çš„ <span class=\"math inline\">\\(\\texttt {AA}\\)</span>ã€‚åœ¨ <span class=\"math inline\">\\(\\text {lcs}+\\text {lcp}\\)</span> ä¸­ä»»å– <span class=\"math inline\">\\(len\\)</span> é•¿åº¦å³ä¸ºä¸€å¯¹ <span class=\"math inline\">\\(\\texttt {AA}\\)</span>ã€‚ç”¨å·®åˆ†ç»™å¯èƒ½çš„èµ·ç‚¹å’Œç»ˆç‚¹åŒºé—´åŠ å³å¯ã€‚</p>\n<p>å°ç»†èŠ‚ï¼šlcp å’Œ lcs å‡éœ€è¦å¯¹ <span class=\"math inline\">\\(len\\)</span> å– <span class=\"math inline\">\\(\\min\\)</span>ï¼Œå¦åˆ™å–åˆ°çš„ä¸²å¯èƒ½ä¸ä¼šç»è¿‡å½“å‰é€‰ä¸­çš„ä¸¤ä¸ªæ ‡è®°ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nclass SA &#123;\npublic:\n    std::vector&lt;int&gt; sa, rk, h;\n    std::vector&lt;std::vector&lt;int&gt;  &gt; st;\n    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&lt;int&gt; (n + 1)) &#123;\n        std::vector&lt;int&gt; la(n + 2);\n        std::copy(s.begin(), s.end(), rk.begin());\n        int m = 128;\n        &#123;\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n; i; --i)\n                sa[c[rk[i]]--] = i;\n        &#125;\n        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n            std::vector&lt;int&gt; id(1);\n            for (int i = n - w + 1; i &lt;= n; ++i)\n                id.push_back(i);\n            for (int i = 1; i &lt;= n; ++i)\n                if (sa[i] &gt; w)\n                    id.push_back(sa[i] - w);\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n; i; --i)\n                sa[c[rk[id[i]]]--] = id[i];\n            p = 0;\n            std::copy(rk.begin(), rk.end(), la.begin());\n            for (int i = 1; i &lt;= n; ++i)\n                if (la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                    rk[sa[i]] = p;\n                else\n                    rk[sa[i]] = ++p;\n            if (p == n)\n                break;\n        &#125;\n        for (int i = 1, to = 0; i &lt;= n; ++i)\n            if (rk[i]) &#123;\n                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);\n                h[rk[i]] = to;\n            &#125;\n        for (int i = 1; i &lt;= n; ++i)\n            st[0][i] = h[i];\n        for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)\n            for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)\n                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);\n        rk.emplace_back();\n        return;\n    &#125;\nprivate:\n    int ask(int l, int r) &#123;\n        // fprintf(stderr, &quot;l = %d, r = %d\\n&quot;, l, r);\n        int k = std::__lg(r - l + 1);\n        return std::min(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);\n    &#125;\npublic:\n    int lcp(int l, int r) &#123;\n        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));\n    &#125;\n&#125;;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        std::string s;\n        std::cin &gt;&gt; s;\n        int n = (int)s.length();\n        s = &quot;#&quot; + s;\n        SA p(n, s);\n        std::reverse(s.begin() + 1, s.end());\n        SA q(n, s);\n        std::vector&lt;int&gt; f(n + 2), g(n + 2);\n        for (int len = 1; len &lt;= n / 2; ++len)\n            for (int i = len; i + len &lt;= n; i += len) &#123;\n                int l = i, r = i + len, lcp = std::min(len, p.lcp(l, r)), lcs = std::min(len - 1, q.lcp(n - l + 2, n - r + 2));\n                if (lcp + lcs &gt;= len) &#123;\n                    int t = lcp + lcs - len + 1;\n                    // fprintf(stderr, &quot;(%d, %d), %d, %d\\n&quot;, l, r, lcp, lcs);\n                    ++g[l - lcs], --g[l - lcs + t], ++f[r + lcp - t], --f[r + lcp];\n                &#125;\n            &#125;\n        std::partial_sum(f.begin(), f.end(), f.begin());\n        std::partial_sum(g.begin(), g.end(), g.begin());\n        long long res = 0ll;\n        for (int i = 1; i &lt; n; ++i)\n            res += (long long)f[i] * g[i + 1];\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"eg2.-tandem\">eg2. tandem</h4>\n<p><a href=\"https://www.codechef.com/problems/TANDEM\" class=\"uri\">https://www.codechef.com/problems/TANDEM</a></p>\n<p>æ³¨æ„åˆ°å¤šäº†ä¸€ä¸ªé™åˆ¶ï¼Œå‰ä¸€ä¸ªå¥½å¤„ç†ï¼Œæ‰¾åˆ°ç»è¿‡ <span class=\"math inline\">\\(3\\)</span> ä¸ªæ ‡è®°çš„ä¸²å³å¯ã€‚å¯¹äºåä¸€ä¸ªé™åˆ¶ï¼Œç”»å›¾å¯ä»¥å‘ç°å¯¹äº interesting onesï¼Œæ¯æ¬¡åªä¼šå‡ºç°æœ€å¤šä¸€ä¸ªï¼›å½“ä¸”ä»…å½“ <span class=\"math inline\">\\(\\text {lcp}&gt;len\\)</span> æ—¶ä¸å­˜åœ¨ã€‚</p>\n<p>å¯¹äº uninteresting onesï¼Œç”¨æ¯æ¬¡èƒ½æä¾›çš„æ€»æ•°å‡å» interesting ones çš„æ•°é‡å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nclass SA &#123;\npublic:\n    std::vector&lt;int&gt; sa, rk, h;\n    std::vector&lt;std::vector&lt;int&gt;  &gt; st;\n    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&lt;int&gt; (n + 1)) &#123;\n        std::vector&lt;int&gt; la(n + 2);\n        std::copy(s.begin(), s.end(), rk.begin());\n        int m = 128;\n        &#123;\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n; i; --i)\n                sa[c[rk[i]]--] = i;\n        &#125;\n        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n            std::vector&lt;int&gt; id(1);\n            for (int i = n - w + 1; i &lt;= n; ++i)\n                id.push_back(i);\n            for (int i = 1; i &lt;= n; ++i)\n                if (sa[i] &gt; w)\n                    id.push_back(sa[i] - w);\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n; i; --i)\n                sa[c[rk[id[i]]]--] = id[i];\n            p = 0;\n            std::copy(rk.begin(), rk.end(), la.begin());\n            for (int i = 1; i &lt;= n; ++i)\n                if (la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                    rk[sa[i]] = p;\n                else\n                    rk[sa[i]] = ++p;\n            if (p == n)\n                break;\n        &#125;\n        for (int i = 1, to = 0; i &lt;= n; ++i)\n            if (rk[i]) &#123;\n                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);\n                h[rk[i]] = to;\n            &#125;\n        for (int i = 1; i &lt;= n; ++i)\n            st[0][i] = h[i];\n        for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)\n            for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)\n                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);\n        rk.emplace_back();\n        return;\n    &#125;\nprivate:\n    int ask(int l, int r) &#123;\n        // fprintf(stderr, &quot;l = %d, r = %d\\n&quot;, l, r);\n        int k = std::__lg(r - l + 1);\n        return std::min(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);\n    &#125;\npublic:\n    int lcp(int l, int r) &#123;\n        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));\n    &#125;\n&#125;;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    std::string s;\n    std::cin &gt;&gt; s;\n    int n = (int)s.length();\n    s = &quot;#&quot; + s;\n    SA p(n, s);\n    std::reverse(s.begin() + 1, s.end());\n    SA q(n, s);\n    std::reverse(s.begin() + 1, s.end());\n    long long res1 = 0ll, res2 = 0ll;\n    for (int len = 1; len &lt;= n; ++len)\n        for (int i = len, j = 2 * len, k = 3 * len; k &lt;= n; i += len, j += len, k += len) &#123;\n            int lcp = std::min(p.lcp(i, j), p.lcp(j, k)), lcs = std::min(&#123; len - 1, q.lcp(n - i + 2, n - j + 2), q.lcp(n - j + 2, n - k + 2) &#125;);\n            if (std::min(len, lcp) + lcs &gt;= len) &#123;\n                // printf(&quot;(%d, %d, %d), %d, %d, %d\\n&quot;, i, j, k, lcs, lcp, len);\n                int t = (lcp &lt;= len);\n                res1 += t, res2 += std::min(len, lcp) + lcs - len + 1 - t;\n            &#125;\n            // else\n            //     printf(&quot;# (%d, %d, %d), %d, %d, %d\\n&quot;, i, j, k, lcs, lcp, len);\n        &#125;\n    std::cout &lt;&lt; res1 &lt;&lt; &#39; &#39; &lt;&lt; res2 &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"eg3.-repeats\">eg3. repeats</h4>\n<p><a href=\"https://www.spoj.com/problems/REPEATS/\" class=\"uri\">https://www.spoj.com/problems/REPEATS/</a></p>\n<p>é‡å¤æ¬¡æ•°æœ€å¤šï¼Œåªéœ€ç»è¿‡æ ‡è®°ç‚¹æœ€å¤šã€‚æ˜¾ç„¶ç»è¿‡æ ‡è®°ç‚¹çš„æ•°é‡å°±æ˜¯è¯¥å­—ç¬¦ä¸²é•¿é™¤ä»¥ <span class=\"math inline\">\\(len\\)</span> å‘ä¸‹å–æ•´å°±å¯ä»¥å¾—åˆ°é‡å¤æ¬¡æ•°å‡ <span class=\"math inline\">\\(1\\)</span> çš„å€¼ã€‚</p>\n<p>é€‰æ‹©ä¸¤ä¸ªè¿ç»­æ ‡è®°ç‚¹ï¼Œå¯¹äº lcp å’Œ lcsï¼ˆæ˜¾ç„¶æ­¤æ—¶ä¸éœ€è¦å¯¹ <span class=\"math inline\">\\(len\\)</span> å– <span class=\"math inline\">\\(\\min\\)</span>ï¼‰ï¼Œè®¡ç®— <span class=\"math inline\">\\(\\dfrac {\\text{lcp}+\\text{lcs}}{len}+1\\)</span> å–æœ€å¤§å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nclass SA &#123;\npublic:\n    std::vector&lt;int&gt; sa, rk, h;\n    std::vector&lt;std::vector&lt;int&gt;  &gt; st;\n    SA(int n, std::string s): sa(n + 1), rk(n + 2), h(n + 1), st(20, std::vector&lt;int&gt; (n + 1)) &#123;\n        std::vector&lt;int&gt; la(n + 2);\n        std::copy(s.begin(), s.end(), rk.begin());\n        int m = 128;\n        &#123;\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n; i; --i)\n                sa[c[rk[i]]--] = i;\n        &#125;\n        for (int w = 1, p; ; w &lt;&lt;= 1, m = p) &#123;\n            std::vector&lt;int&gt; id(1);\n            for (int i = n - w + 1; i &lt;= n; ++i)\n                id.push_back(i);\n            for (int i = 1; i &lt;= n; ++i)\n                if (sa[i] &gt; w)\n                    id.push_back(sa[i] - w);\n            std::vector&lt;int&gt; c(m + 1);\n            for (int i = 1; i &lt;= n; ++i)\n                ++c[rk[i]];\n            std::partial_sum(c.begin(), c.end(), c.begin());\n            for (int i = n; i; --i)\n                sa[c[rk[id[i]]]--] = id[i];\n            p = 0;\n            std::copy(rk.begin(), rk.end(), la.begin());\n            for (int i = 1; i &lt;= n; ++i)\n                if (la[sa[i]] == la[sa[i - 1]] &amp;&amp; la[sa[i] + w] == la[sa[i - 1] + w])\n                    rk[sa[i]] = p;\n                else\n                    rk[sa[i]] = ++p;\n            if (p == n)\n                break;\n        &#125;\n        for (int i = 1, to = 0; i &lt;= n; ++i)\n            if (rk[i]) &#123;\n                for (to = std::max(to - 1, 0); s[i + to] == s[sa[rk[i] - 1] + to]; ++to);\n                h[rk[i]] = to;\n            &#125;\n        for (int i = 1; i &lt;= n; ++i)\n            st[0][i] = h[i];\n        for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)\n            for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)\n                st[j][i] = std::min(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);\n        rk.emplace_back();\n        return;\n    &#125;\nprivate:\n    int ask(int l, int r) &#123;\n        // fprintf(stderr, &quot;l = %d, r = %d\\n&quot;, l, r);\n        int k = std::__lg(r - l + 1);\n        return std::min(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);\n    &#125;\npublic:\n    int lcp(int l, int r) &#123;\n        return ask(std::min(rk[l], rk[r]) + 1, std::max(rk[l], rk[r]));\n    &#125;\n&#125;;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n;\n        std::cin &gt;&gt; n;\n        std::string s = &quot;#&quot;;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            char t;\n            std::cin &gt;&gt; t;\n            s.push_back(t);\n        &#125;\n        SA p(n, s);\n        std::reverse(s.begin() + 1, s.end());\n        SA q(n, s);\n        int res = 0;\n        for (int len = 1; len &lt;= n; ++len)\n            for (int i = len, j = 2 * len; j &lt;= n; i += len, j += len) &#123;\n                int lcp = p.lcp(i, j), lcs = q.lcp(n - i + 2, n - j + 2);\n                if (lcp + lcs &gt;= len)\n                    res = std::max(res, (lcp + lcs) / len + 1);\n            &#125;\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"ç»“åˆå¹¶æŸ¥é›†\">ç»“åˆå¹¶æŸ¥é›†</h3>\n<hr />\n<h3 id=\"ç»“åˆå•è°ƒæ ˆ\">ç»“åˆå•è°ƒæ ˆ</h3>\n",
            "tags": [
                "å­—ç¬¦ä¸²",
                "SA"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250121/",
            "url": "https://xsc062.netlify.app/20250121/",
            "title": "æŠ€å·§ï¼šå­—ç¬¦ä¸²æ‹†åˆ†",
            "date_published": "2025-01-21T03:47:06.000Z",
            "content_html": "<p>ç¥åˆ˜å®¶åœ¨èµ°å‰ä½“è‚²è¯¾ä¸Šé—®æˆ‘å¬æ²¡å¬è¿‡ <em>Die For You - The Weekend</em>ã€‚æˆ‘è®©ä»–å“¼ä¸€æ®µï¼Œåˆ˜å®¶ä¾¿å±•ç¤ºäº†è‡ªå·±çš„å¤©ç±ä¹‹éŸ³ï¼Œæˆ‘ç†æ‰€å½“ç„¶åœ°è¿æ—‹å¾‹éƒ½æ²¡è¾¨è®¤å‡ºæ¥ã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<p>æœ‰çš„æ—¶å€™ï¼Œå¯¹äºä¸€ä¸ªå®Œæ•´çš„åŒ¹é…ä¸²ï¼Œæˆ‘ä»¬éœ€è¦ã€Œæšä¸¾æ–­ç‚¹ã€ï¼Œåˆ†ä¸ºå‰åŠæ®µå’ŒååŠæ®µåˆ†åˆ«å’Œæ¨¡å¼ä¸²åŒ¹é…è§£å†³é—®é¢˜ã€‚å½“ç„¶è¿™æ ·çš„æŠ€å·§ä¸æ­¢å±€é™äºå­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„å­¦ä¹ ä¸­åœ¨è¯¸å¦‚åŠ¨æ€è§„åˆ’ç­‰é¢˜ç›®ä¸­é‡åˆ°äº†ç›¸ä¼¼çš„æƒ…æ™¯ã€‚</p>\n<p>åœ¨å­—ç¬¦ä¸²é¢˜ç›®ä¸­ï¼Œä¸€ä¸ªå…¸å‹çš„æ ‡å¿—æ˜¯ã€Œæ¨¡å¼ä¸²çš„æ‹¼æ¥ã€ï¼Œå°†ä¸¤æˆªæ¨¡å¼ä¸²æ‹¼æ¥åˆ°ä¸€èµ·ï¼Œå½¢æˆçš„æ–°æ¨¡å¼ä¸²å¹¶ä¸åˆ©å¥½æˆ‘ä»¬çš„å¤„ç†ï¼Œæˆ‘ä»¬éœ€è¦å°½é‡åˆ©ç”¨å·²çŸ¥çš„æ¨¡å¼ä¸²ã€‚å½“ç„¶æˆ‘ä»¬ä¸ä¼šå°†æ–°æ¨¡å¼ä¸²é‡æ–°æ‹†æˆä¸¤åŠï¼Œè€Œæ˜¯è€ƒè™‘è½¬æ¢ï¼Œæšä¸¾åŒ¹é…ä¸²çš„æ–­ç‚¹ï¼Œå°†å‰åŠæ®µçš„åç¼€å’ŒååŠæ®µçš„å‰ç¼€åˆ†åˆ«åŒ¹é…ã€‚</p>\n<hr />\n<h2 id=\"ä¸€ä¸ªæ¨¡æ¿cf1202e-you-are-given-some-strings\">ä¸€ä¸ªæ¨¡æ¿ï¼šCF1202E You Are Given Some Stringsâ€¦</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1202/E\" class=\"uri\">https://codeforces.com/problemset/problem/1202/E</a></p>\n<p>è™½ç„¶å¯¹äºæ¯ç§ä¸åŒæ‹¼æ¥éœ€è¦æ±‚è§£åˆ†åˆ«çš„å‡ºç°æ¬¡æ•°ï¼Œä½†æ˜¯æ³¨æ„åˆ°æœ€ååªéœ€è¦è¾“å‡º <span class=\"math inline\">\\(f\\)</span> çš„æ€»å’Œï¼Œæ‰€ä»¥å°±å¯ä»¥ä¸å†é¡¾åŠä¸åŒæ‹¼æ¥æ–¹å¼é—´çš„åŒºåˆ«ã€‚</p>\n<p>æšä¸¾åŒ¹é…ä¸²çš„æ–­ç‚¹ã€‚ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•æ˜¯å°†å‰åç¼€ä¸ AC è‡ªåŠ¨æœºåŒ¹é…ï¼Œä½†å¦‚æœé€ä¸ªæ”¾è¿›å»æ˜¾ç„¶å¤æ‚åº¦èµ·é£ã€‚è¿™é‡Œå°±åˆæœ‰ä¸€ä¸ªå®ç°å°æŠ€å·§ï¼Œæˆ‘ä»¬åœ¨åŸä¸²çš„ AC è‡ªåŠ¨æœºä¸ŠæŠŠåŸä¸²è¿‡ä¸€éï¼Œæ¯ä¸ªä½ç½®æ‰€åœ¨çš„çŠ¶æ€å°±æ˜¯è¿™ä¸ªä½ç½®å¯¹åº”åç¼€å¯èƒ½å¤„åœ¨çš„åç¼€ã€‚</p>\n<p>è®°å½•æ¯ä¸ªçŠ¶æ€å¯èƒ½å¤„åœ¨çš„æ¨¡å¼ä¸²æœ«å°¾ä¸ªæ•°ï¼Œè¿™ä¸€ç‚¹ç›´æ¥åœ¨ fail æ ‘ä¸Šä»ä¸Šåˆ°ä¸‹è½¬ç§»å³å¯ã€‚åä¸²åŒç†ã€‚</p>\n<p>äºŒè€…ç›¸ä¹˜å³ä¸ºç­”æ¡ˆã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e5 + 5;\nstruct &#123;\n    int T[maxn][26], tot, cnt[maxn], fail[maxn], deg[maxn];\n    void ins(std::string &amp;t) &#123;\n        int p = 0;\n        for (auto i : t) &#123;\n            if (!T[p][i - &#39;a&#39;])\n                T[p][i - &#39;a&#39;] = ++tot;\n            p = T[p][i - &#39;a&#39;];\n        &#125;\n        ++cnt[p];\n        return;\n    &#125;\n    void bld(void) &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 26; ++i)\n            if (T[0][i])\n                q.push(T[0][i]);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            for (int i = 0; i &lt; 26; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i], cnt[v] += cnt[fail[v]];\n                    q.push(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n        return;\n    &#125;\n&#125; p, q;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    std::string s;\n    std::cin &gt;&gt; s;\n    int n;\n    std::cin &gt;&gt; n;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::string t;\n        std::cin &gt;&gt; t;\n        p.ins(t);\n        std::reverse(t.begin(), t.end());\n        q.ins(t);\n    &#125;\n    p.bld(), q.bld();\n    int len = s.length();\n    std::vector&lt;std::array&lt;int, 2&gt; &gt; f(len + 1);\n    &#123;\n        int u = 0;\n        for (int i = 1; i &lt;= len; ++i) &#123;\n            u = p.T[u][s[i - 1] - &#39;a&#39;];\n            f[i][0] = p.cnt[u];\n        &#125;\n    &#125;\n    &#123;\n        int u = 0;\n        for (int i = len; i; --i) &#123;\n            u = q.T[u][s[i - 1] - &#39;a&#39;];\n            f[i][1] = q.cnt[u];\n        &#125;\n    &#125;\n    long long res = 0ll;\n    for (int i = 1; i &lt; len; ++i)\n        res += (long long)f[i][0] * f[i + 1][1];\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"å˜å¼ä¼˜ç§€çš„æ‹†åˆ†\">å˜å¼ï¼šä¼˜ç§€çš„æ‹†åˆ†</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P1117\" class=\"uri\">https://www.luogu.com.cn/problem/P1117</a></p>\n",
            "tags": [
                "å­—ç¬¦ä¸²"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250120/",
            "url": "https://xsc062.netlify.app/20250120/",
            "title": "å­¦ä¹ ç¬”è®°ï¼šAC è‡ªåŠ¨æœº",
            "date_published": "2025-01-20T03:21:15.000Z",
            "content_html": "<p>è€³æœºå£°éŸ³ç–‘ä¼¼æœ‰ç‚¹å°äº†ï¼Œç”¨å¿ƒæ—·ç¥æ€¡çš„è¯æ¥è¯´å¤§è‡´ä¼šæ˜¯ã€Œæ¯”æœè‡â†‘å—¡å—¡å£°è¿˜å°ã€ã€‚</p>\n<span id=\"more\"></span>\n<p>ï¼Ÿå§æ§½è€³æœºä¸Šå±…ç„¶å¯ä»¥è°ƒéŸ³é‡ <img src=\"/em/oh.gif\" /></p>\n<hr />\n<h2 id=\"å‰ç½®çŸ¥è¯†\">å‰ç½®çŸ¥è¯†</h2>\n<p>é¦–å…ˆå¯èƒ½éœ€è¦çŸ¥é“ä¸“æœ‰åè¯ã€Œè‡ªåŠ¨æœºã€çš„å«ä¹‰ã€‚</p>\n<p>å¤§è‡´å¯ä»¥ç®€å•ç†è§£ä¸ºï¼Œä¸€ä¸ª DAGï¼Œå…¶ä¸­ç‚¹è¡¨ç¤ºçŠ¶æ€ï¼Œè¾¹è¡¨ç¤ºè½¬ç§»ã€‚ç»™è¿›å»ä¸€ä¸ªå­—ç¬¦ä¸²ä¹‹ç±»ï¼Œå°±å¯ä»¥åœ¨ DAG ä¸Šæ¸¸èµ°ï¼Œæ ¹æ®æœ€åæ‰€å¤„ç»“ç‚¹ï¼Œå¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ç›¸å…³ç‰¹å¾ã€‚</p>\n<p>è¿™ä¸ªå®šä¹‰è®©æˆ‘ä»¬æƒ³åˆ°äº† Trieã€‚äº‹å®ä¸Šï¼ŒTrie å°±æ˜¯ä¸€ç§ç›¸å½“åŸºç¡€çš„è‡ªåŠ¨æœºã€‚</p>\n<hr />\n<p>æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬å¤ä¹  KMP ç›¸å…³æ¦‚å¿µã€‚</p>\n<p>å‡æƒ³ä¸€ä¸ªåœºæ™¯ï¼šä½ éœ€è¦æ±‚å¾— <span class=\"math inline\">\\(T\\)</span> åœ¨ <span class=\"math inline\">\\(S\\)</span> ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚</p>\n<p>æ‹¥æœ‰ä¸€å®šé¢˜ç›®ç»éªŒçš„ä½ ï¼Œä¼šä½¿ç”¨ KMP æ±‚å‡º <span class=\"math inline\">\\(T\\)</span> çš„ <code>next</code> æ•°ç»„ï¼Œä»¤ <span class=\"math inline\">\\(T\\)</span> åœ¨ <span class=\"math inline\">\\(S\\)</span> ä¸Šè¿›è¡ŒåŒ¹é…ï¼Œå¤±é…æˆ–å®Œå…¨åŒ¹é…æ—¶å›åˆ° <span class=\"math inline\">\\(T\\)</span> åœ¨è¯¥å¤„çš„ <code>next</code>ï¼Œ<span class=\"math inline\">\\(S\\)</span> ä¸Šçš„æŒ‡é’ˆå§‹ç»ˆå‘å³ï¼Œ<span class=\"math inline\">\\(T\\)</span> ä¸Šçš„æŒ‡é’ˆå¦‚æœå‘å³ï¼Œæ¯æ¬¡åªèƒ½ç§»åŠ¨ä¸€ä½ï¼›å¦‚æœå‘å·¦ï¼Œæœ€å·¦ç§»åˆ°å¼€å¤´ï¼Œå‡æ‘Šä¸‹æ¥å¤æ‚åº¦å³ä¸º <span class=\"math inline\">\\(O(|S| + |T|)\\)</span>ã€‚</p>\n<p>å‡å¦‚åœºæ™¯å˜å¾—æ›´å¤æ‚ï¼šç»™å®š <span class=\"math inline\">\\(\\{T_m\\}\\)</span>ï¼Œä½ éœ€è¦æ±‚å‡ºæ¯ä¸ª <span class=\"math inline\">\\(T_j\\)</span> åœ¨ <span class=\"math inline\">\\(S\\)</span> ä¸­çš„å‡ºç°æ¬¡æ•°ã€‚</p>\n<p>é‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¯¹æ¯ä¸ª <span class=\"math inline\">\\(T_j\\)</span> è¿›è¡Œä¸€æ¬¡ KMPï¼Œå¤æ‚åº¦å°†ä¼šä¸Šå‡åˆ° <span class=\"math inline\">\\(O(m|S|)\\)</span>ï¼Œéš¾ä»¥æ‰¿å—ã€‚æœ‰æ²¡æœ‰ä¼˜åŒ–çš„æ–¹æ³•å‘¢ï¼Ÿ</p>\n<hr />\n<h2 id=\"ac-è‡ªåŠ¨æœºçš„å»ºç«‹\">AC è‡ªåŠ¨æœºçš„å»ºç«‹</h2>\n<p>ç»“åˆä¸Šé¢çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬ä¸‹æ„è¯†æƒ³åˆ°ï¼Œèƒ½ä¸èƒ½å°† <span class=\"math inline\">\\(\\{T_m\\}\\)</span> å»ºæˆä¸€ä¸ªæ ‘çŠ¶ç»“æ„ï¼Œä»¤ <span class=\"math inline\">\\(S\\)</span> åœ¨å…¶ä¸Šè¿›è¡Œ KMP å‘¢ï¼Ÿ</p>\n<p>å°† <span class=\"math inline\">\\(\\{T_m\\}\\)</span> å…¨éƒ¨åŠ å…¥ Trieï¼Œç”±äº <code>next</code> åªä¼šç”±æ›´æ·±çš„ç‚¹æŒ‡å‘æ›´æµ…çš„ç‚¹ï¼Œä¼¼ä¹ä»ç›´è§‰ä¸Šæ˜¯æœ‰è§„åˆ™çš„ã€‚ä½†éšä¹‹è€Œæ¥çš„æ˜¯ä¸€ä¸ªé—®é¢˜ï¼šç‚¹ <span class=\"math inline\">\\(u\\)</span> çš„ <code>next</code> ä¸ä¸€å®šåœ¨ <span class=\"math inline\">\\(\\text{root}\\to u\\)</span> çš„é“¾ä¸Šï¼ˆç”±äº Trie çš„æ€§è´¨ï¼Œå¯çŸ¥æŒ‡å‘çš„ç‚¹æ˜¯å”¯ä¸€çš„ï¼‰ã€‚é‰´äºè¿™ä¸€ç‚¹ä¸åŒï¼Œæˆ‘ä»¬ç»“åˆå…¶ã€Œå¤±é…æŒ‡é’ˆã€çš„å®šä¹‰ï¼Œå°† <code>next</code> åœ¨ Trie ä¸Šçš„åŒåˆ†å¼‚æ„ä½“å”¤ä¸º <code>fail</code>ã€‚</p>\n<p>è€ƒå¯Ÿ Trie ä¸Šè¯¥ <code>fail</code> è¾¹çš„æ€§è´¨ã€‚ç°æ¬²æ±‚è§£ <span class=\"math inline\">\\(u\\)</span> çš„ <code>fail</code> æŒ‡å‘çš„ <span class=\"math inline\">\\(c\\)</span>ï¼Œç»“åˆ KMP ä¸­ <code>next</code> çš„æ€§è´¨ï¼Œå‡è®¾ <span class=\"math inline\">\\(u\\)</span> çš„çˆ¶èŠ‚ç‚¹çš„ <code>fail</code> è¾¹æŒ‡å‘ <span class=\"math inline\">\\(v&#39;\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(v\\)</span> çš„å€¼ä¸ºï¼š</p>\n<ul>\n<li><span class=\"math inline\">\\(v&#39;\\)</span> ä¸Šæœ‰è¾¹æƒç›¸åŒçš„è¾¹ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(v\\)</span> å°±æ˜¯è¯¥è¾¹æŒ‡å‘çš„ç‚¹ã€‚</li>\n<li>å¦åˆ™ï¼Œå‰å¾€ <span class=\"math inline\">\\(v&#39;\\)</span> çš„ <code>fail</code>ï¼Œé‡å¤ä»¥ä¸Šåˆ¤å®šã€‚</li>\n</ul>\n<p>é‚£ä¹ˆå°±å®Œæˆäº†å¤±é…çš„å¤„ç†ã€‚ç›¸åº”åœ°ï¼Œå®Œå…¨åŒ¹é…æ—¶çš„è·³è½¬åº”å¦‚ä½•å¤„ç†ï¼Ÿç›´æ¥å°† <code>fail</code> çš„å„¿å­å…¨éƒ¨æ¥åˆ° <span class=\"math inline\">\\(u\\)</span> ä¸‹é¢å³å¯ã€‚å¦‚æœ <span class=\"math inline\">\\(u\\)</span> å’Œ <code>fail</code> å…·æœ‰åŒä¸€ä¸ªè¾¹æƒçš„è¾¹æ—¶ï¼Œä¿ç•™ <span class=\"math inline\">\\(u\\)</span> çš„è¿™æ¡è¾¹ <span class=\"math inline\">\\(u\\to v\\)</span>ï¼Œå› ä¸º <span class=\"math inline\">\\(v\\)</span> çš„ <code>fail</code> å¿…å®šæŒ‡å‘ <span class=\"math inline\">\\(u\\)</span> çš„ <code>fail</code> çš„å¯¹åº”å„¿å­ã€‚</p>\n<p>ä¸¤ç‚¹ç»“åˆï¼Œæˆ‘ä»¬å‘ç°ä»å®ç°ä¸Šï¼Œå¯ä»¥ç›´æ¥ä»¤ <span class=\"math inline\">\\(v\\)</span> çš„ <code>fail</code> æŒ‡å‘ <span class=\"math inline\">\\(u\\)</span> çš„ <code>fail</code> çš„å¯¹åº”å„¿å­ï¼ˆé‚£ä¹ˆæ—¶é—´å¤æ‚åº¦æ˜¾è€Œæ˜“è§æ˜¯ <span class=\"math inline\">\\(O(26\\sum |T|)\\)</span> çš„ï¼‰ã€‚</p>\n<p>åŒ¹é…æ—¶ï¼Œå¯¹äºæ¯ä¸ªç‚¹å’Œå…¶è¿”å›åˆ°æ ¹çš„ <code>fail</code> é“¾ï¼Œå…¨éƒ¨æ ‡è®°ã€‚åˆ™ä¸€ä¸ªæ¨¡å¼ä¸²åŒ¹é…çš„æ¬¡æ•°å³ä¸ºè¢«æ‰“æ ‡è®°çš„æ¬¡æ•°ã€‚</p>\n<p>é‚£ä¹ˆå¯ä»¥å‘ç° AC è‡ªåŠ¨æœºçš„æœ¬è´¨å°±æ˜¯æ·»åŠ äº† <code>fail</code> è¾¹çš„ Trieã€‚</p>\n<hr />\n<p>é‚£ä¹ˆæ ¹æ®ä¸Šè¿°è¦æ±‚ï¼Œæˆ‘ä»¬éœ€è¦æŒ‰ç…§æ·±åº¦é¡ºåºæ±‚å¾— <code>fail</code>ï¼Œè€ƒè™‘ BFSã€‚</p>\n<details>\n<p>å“¦å“¦å¥½ç¥å¥‡å¤æ´»ä¹‹åè®°å¾—å•¥æ˜¯ KMP ä½†å¿˜äº†å•¥æ˜¯ C++ äº†ã€‚ç”šè‡³èŠ±äº†ä¸€ç‚¹æ—¶é—´å­¦ä¹ æ€ä¹ˆåˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Ÿï¼Ÿï¼Ÿ</p>\n<p>å¤§å®¶å†™ AC è‡ªåŠ¨æœº Trie æ ¹èŠ‚ç‚¹ä¸‹æ ‡ä¸€å®šè¦è®¾æˆ 0 å•Š <img src=\"/em/ll.gif\" /> è®¾æˆ 1 è¢«å„ç§ç»†èŠ‚å‘æƒ¨äº† <img src=\"/em/ll.gif\" /></p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e5 + 5;\nint T[maxn][26], tot, cnt[maxn], fail[maxn];\nint ins(std::string &amp;t) &#123;\n    int p = 0;\n    for (auto i : t) &#123;\n        if (!T[p][i - &#39;a&#39;])\n            T[p][i - &#39;a&#39;] = ++tot;\n        p = T[p][i - &#39;a&#39;];\n    &#125;\n    return p;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; tail(n + 1);\n    std::vector&lt;std::string&gt; t(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; t[i], tail[i] = ins(t[i]);\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 26; ++i)\n            if (T[0][i])\n                q.push(T[0][i]);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            for (int i = 0; i &lt; 26; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i];\n                    q.push(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n    &#125;\n    std::string s;\n    std::cin &gt;&gt; s;\n    &#123;\n        int p = 0;\n        for (auto i : s) &#123;\n            p = T[p][i - &#39;a&#39;];\n            for (int fa = p; fa; fa = fail[fa])\n                ++cnt[fa];\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        std::cout &lt;&lt; cnt[tail[i]] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<p>è‚‰çœ¼å¯è§è¯¥æŸ¥è¯¢æ–¹å¼æ˜¯æå…¶ä½æ•ˆçš„ï¼Œæ•…è€ƒè™‘ä¼˜åŒ–è·³ <code>fail</code> æ‰“æ ‡è®°çš„è¿‡ç¨‹ã€‚</p>\n<p>æ—¢ç„¶è‡ªåŠ¨æœºç»“æ„ä¸å˜ï¼Œä¸å¦‚å°†è·³ <code>fail</code> çš„æ­¥éª¤æ”¾åœ¨æœ€åç»Ÿä¸€è¿›è¡Œã€‚å®¹æ˜“åœ¨å‘ç° <code>fail</code> æ ‘ä¸Šè¿›è¡Œæ‹“æ‰‘æ’åºè½¬ç§»å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e5 + 5;\nint T[maxn][26], tot, cnt[maxn], fail[maxn], deg[maxn];\nint ins(std::string &amp;t) &#123;\n    int p = 0;\n    for (auto i : t) &#123;\n        if (!T[p][i - &#39;a&#39;])\n            T[p][i - &#39;a&#39;] = ++tot;\n        p = T[p][i - &#39;a&#39;];\n    &#125;\n    return p;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; tail(n + 1);\n    std::vector&lt;std::string&gt; t(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; t[i], tail[i] = ins(t[i]);\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 26; ++i)\n            if (T[0][i])\n                q.push(T[0][i]);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            for (int i = 0; i &lt; 26; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];\n                    q.push(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n    &#125;\n    std::string s;\n    std::cin &gt;&gt; s;\n    &#123;\n        int p = 0;\n        for (auto i : s)\n            p = T[p][i - &#39;a&#39;], ++cnt[p];\n    &#125;\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 1; i &lt;= tot; ++i)\n            if (!deg[i])\n                q.push(i);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            cnt[fail[u]] += cnt[u];\n            if (!--deg[fail[u]])\n                q.push(fail[u]);\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        std::cout &lt;&lt; cnt[tail[i]] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"ac-è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«\">AC è‡ªåŠ¨æœºçš„åº”ç”¨ä¸è¯†åˆ«</h2>\n<p>æˆ‘ä»¬çŸ¥é“å…¶æœ€å…¸å‹çš„ç‰¹å¾æ˜¯ <strong>å¤šæ¨¡å¼ä¸²</strong>ã€<strong>é™æ€ / ç¦»çº¿</strong>ã€‚å½“ç¢°åˆ°ç±»ä¼¼ç‰¹ç‚¹æ—¶ï¼Œå¤§æ¦‚ç‡å°±æ˜¯ AC è‡ªåŠ¨æœºã€‚</p>\n<p>å…¶ä¸­ï¼Œå¯ä»¥è®¾ç½®çš„éš¾ç‚¹æœ‰ï¼š</p>\n<ol type=\"1\">\n<li>å­—ç¬¦ä¸²éš¾ç‚¹ï¼Œå’Œå…¶ä»–å­—ç¬¦ä¸²é¢˜å¯è®¾ç½®çš„éš¾ç‚¹ç›¸åŒã€‚</li>\n<li>fail æ ‘ç»´æŠ¤ï¼Œå¯èƒ½ç»“åˆæ•°æ®ç»“æ„ã€æ‹“æ‰‘æ’åºã€æ ‘å½¢ DP ç­‰è€ƒå¯Ÿã€‚</li>\n<li>DP çš„è®¾è®¡ã€‚</li>\n</ol>\n<hr />\n<h2 id=\"å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡\">å­—ç¬¦ä¸²éš¾ç‚¹è®¾è®¡</h2>\n<h3 id=\"eg.-indie-album\">eg. Indie Album</h3>\n<p><a href=\"https://codeforces.com/problemset/problem/1207/G\" class=\"uri\">https://codeforces.com/problemset/problem/1207/G</a></p>\n<p>é¢˜ç›®çš„ã€Œå¯æŒä¹…åŒ–ã€è¯•å›¾è¯¯å¯¼æˆ‘ä»¬ç”¨æ“ä½œä¸²å»ºç«‹è‡ªåŠ¨æœºï¼Œä½†è¿™æ ·å°±ä¼šæœ‰ä¸€ä¸ªæ¯”è¾ƒä¸¥é‡çš„é—®é¢˜ï¼Œæˆ‘ä»¬æ²¡åŠæ³•æ±‚ <span class=\"math inline\">\\(t\\)</span> çš„å‡ºç°æ¬¡æ•°ã€‚</p>\n<p>ä¸ºäº†ä¿è¯ç­”æ¡ˆå¯æ±‚æˆ‘ä»¬ä»ç„¶åœ¨ <span class=\"math inline\">\\(t\\)</span> ä¸Šå»ºç«‹ ACAMã€‚å®¹æ˜“å‘ç°æ“ä½œä¸²ä»¥ Trie å½¢å¼ç»™å‡ºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨éå† Trie æ—¶åŒæ—¶å®Œæˆæ¸¸èµ°ï¼Œé€šè¿‡å›æº¯å®Œæˆè¯¢é—®ã€‚</p>\n<p>å‡è®¾å½“å‰ DFS ä¸­ï¼Œéå†åˆ° Trie æ ‘ä¸­çš„ <span class=\"math inline\">\\(x\\)</span> ç‚¹å’Œè‡ªåŠ¨æœºä¸­çš„ <span class=\"math inline\">\\(u\\)</span> çŠ¶æ€ï¼Œé‚£ä¹ˆå¯¹äº <span class=\"math inline\">\\(x\\)</span> ç‚¹æ‰€å¯¹åº”çš„ä¸€ä¸ªè¯¢é—®ä¸² <span class=\"math inline\">\\(t\\)</span>ï¼Œç›¸å½“äºè¯¢é—®ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€æœ‰å¤šå°‘ä¸ªåœ¨ <span class=\"math inline\">\\(t\\)</span> å¼•å¯¼çš„ fail æ ‘å­æ ‘ä¸­ã€‚æˆ‘ä»¬æ±‚å‡º fail æ ‘çš„ dfnï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç®€å•ç»Ÿè®¡å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 4e5 + 5;\nstd::vector&lt;int&gt; g[maxn], q[maxn];\nint fail[maxn], T[maxn][26], tot, bit[maxn], to[maxn][26], cnt[maxn];\nint ins(std::string s) &#123;\n    int p = 0;\n    for (auto i : s) &#123;\n        if (!T[p][i - &#39;a&#39;])\n            T[p][i - &#39;a&#39;] = ++tot;\n        p = T[p][i - &#39;a&#39;];\n    &#125;\n    return p;\n&#125;\nint lowbit(int x) &#123;\n    return x &amp; -x;\n&#125;\nvoid add(int x, int v) &#123;\n    for (; x &lt;= tot + 1; x += lowbit(x))\n        bit[x] += v;\n    return;\n&#125;\nint ask(int x) &#123;\n    int res = 0;\n    for (; x; x -= lowbit(x))\n        res += bit[x];\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, now = 0;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; id(n + 1);\n    for (int i = 1, op; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; op;\n        if (op == 1) &#123;\n            std::cin &gt;&gt; t;\n            if (!to[0][t - &#39;a&#39;])\n                to[0][t - &#39;a&#39;] = ++now;\n            ++cnt[to[0][t - &#39;a&#39;]], id[i] = to[0][t - &#39;a&#39;];\n        &#125;\n        else &#123;\n            int j; \n            std::cin &gt;&gt; j &gt;&gt; t;\n            if (!to[id[j]][t - &#39;a&#39;])\n                to[id[j]][t - &#39;a&#39;] = ++now;\n            ++cnt[to[id[j]][t - &#39;a&#39;]], id[i] = to[id[j]][t - &#39;a&#39;];\n        &#125;\n    &#125;\n    int m;\n    std::cin &gt;&gt; m;\n    std::vector&lt;int&gt; tail(m + 1), res(m + 1);\n    for (int i = 1, x; i &lt;= m; ++i) &#123;\n        std::string t;\n        std::cin &gt;&gt; x &gt;&gt; t, tail[i] = ins(t);\n        q[id[x]].push_back(i);\n    &#125;\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 26; ++i)\n            if (T[0][i])\n                q.push(T[0][i]), g[0].push_back(T[0][i]);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            for (int i = 0; i &lt; 26; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i];\n                    q.push(v), g[fail[v]].push_back(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n    &#125;\n    std::vector&lt;int&gt; dfn(tot + 1), rfn(tot + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now;\n        // printf(&quot;%d &quot;, x);\n        for (auto i : g[x])\n            DFS(i);\n        rfn[x] = now;\n        return;\n    &#125;;\n    DFS(0);\n    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int u) &#123;\n        add(dfn[u], 1);\n        for (auto i : q[x])\n            res[i] += ask(rfn[tail[i]]) - ask(dfn[tail[i]] - 1);\n        for (int i = 0; i &lt; 26; ++i)\n            if (to[x][i])\n                DFS1(to[x][i], T[u][i]);\n        add(dfn[u], -1);\n        return;\n    &#125;;\n    DFS1(0, 0);\n    for (int i = 1; i &lt;= m; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"fail-æ ‘çš„ç»´æŠ¤\">fail æ ‘çš„ç»´æŠ¤</h2>\n<h3 id=\"eg.-divljak\">eg. Divljak</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P5840\" class=\"uri\">https://www.luogu.com.cn/problem/P5840</a></p>\n<h4 id=\"æ³•ä¸€æŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿\">æ³•ä¸€ï¼šæŠŠåŠ¨æ€é—®é¢˜ç¦»çº¿</h4>\n<p>é—®é¢˜ç›¸å½“äºå°†æ¨¡å¼ä¸² <span class=\"math inline\">\\(T:\\{P\\}\\)</span> åŠ¨æ€åŒ–ï¼Œä½†æˆ‘ä»¬ä»å¯ä»¥æ— è„‘ç¦»çº¿ä¸‹æ¥è§£å†³é—®é¢˜ã€‚</p>\n<p>è€ƒè™‘åŸæœ¬çš„ç­”æ¡ˆè®¡ç®—è¿‡ç¨‹ï¼Œå³åœ¨ç»è¿‡çš„æ‰€æœ‰çŠ¶æ€åŠå…¶ fail é“¾ä¸Šæ‰“æ ‡è®°ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦ç¦»çº¿å¹¶åŒºåˆ†æ ‡è®°çš„æ¥æºï¼ˆå¹¶ä¸”æ ‡è®°ç±»å‹ä¸ºå¸ƒå°”å€¼ï¼‰ï¼Œä¸‹æ„è¯†æƒ³åˆ°ä½¿ç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚</p>\n<p>æˆ‘ä»¬å¯¹æ¯ä¸ªçŠ¶æ€å»ºç«‹åŠ¨æ€å¼€ç‚¹çº¿æ®µæ ‘ï¼Œæœ€åæ‹“æ‰‘æ’åºæ—¶ä½¿ç”¨çº¿æ®µæ ‘åˆå¹¶å¤„ç†ä¿¡æ¯ã€‚å®¹æ˜“è¯æ˜æ—¶é—´å¤æ‚åº¦ç›¸è¾ƒåŸæ¥å¤šäº†ä¸€ä¸ª <span class=\"math inline\">\\(\\log\\)</span>ã€‚</p>\n<p><del>ç†è®ºå¯è¡Œï¼Œå¼€å§‹å®è·µ</del> å‡ºé¢˜äººä¼¼ä¹ä¸æ˜¯å¾ˆå–œæ¬¢çº¿æ®µæ ‘é€‰æ‰‹æ‰€ä»¥å†³å®šå‰¥å¤ºä½ çš„ Memory Limitã€‚æƒ³è¦ç”¨è¿™ç§åšæ³•é€šè¿‡æœ¬é¢˜å¯è§ <a href=\"https://www.luogu.com.cn/article/jaxk3sno\" class=\"uri\">https://www.luogu.com.cn/article/jaxk3sno</a>ã€‚</p>\n<h4 id=\"æ³•äºŒè½¬è€Œå¤„ç†é™æ€é—®é¢˜\">æ³•äºŒï¼šè½¬è€Œå¤„ç†é™æ€é—®é¢˜</h4>\n<p>æ³¨æ„åˆ°é¢˜ç›®ä¸­çš„é™æ€çš„ <span class=\"math inline\">\\(S_x\\)</span> æ¯”èµ· <span class=\"math inline\">\\(T:\\{P\\}\\)</span> æ›´é€‚åˆç”¨æ¥åšæ¨¡å¼ä¸²ï¼Œæˆ‘ä»¬åœ¨ <span class=\"math inline\">\\(S_x\\)</span> ä¸Šæ„å»º AC è‡ªåŠ¨æœºï¼Œè€ƒè™‘åœ¨çº¿è§£å†³é—®é¢˜ã€‚</p>\n<p>åœ¨æ¯æ¬¡ <code>1</code> æ“ä½œæ—¶ï¼Œæ›´æ–°æ¨¡å¼ä¸²ä¿¡æ¯ã€‚å¯¹äºé€”å¾„çš„æ‰€æœ‰çŠ¶æ€ <span class=\"math inline\">\\(\\{u\\}\\)</span>ï¼Œè€ƒè™‘æ›´æ–°å…¶æ‰€åœ¨ fail é“¾ä¸Šçš„ä¿¡æ¯ã€‚</p>\n<p>æ³¨æ„åˆ°æˆ‘ä»¬éœ€è¦ä¿®æ”¹æ•´æ¡ fail é“¾ä¸Šçš„ä¿¡æ¯ï¼Œè¯¢é—®åˆ™æ˜¯è¯¢é—®å•ç‚¹ã€‚è¿™ä¸ªæ—¶å€™å¯ä»¥è€ƒè™‘ä½¿ç”¨æ ‘ä¸Šå·®åˆ†ã€‚</p>\n<p>ä½†æ˜¯ here comes a problemï¼Œæˆ‘ä»¬å¯¹äºè¿™ä¸€æ•´ä¸ªä¸²åªèƒ½åœ¨æ•´ä¸ªæ ‘ä¸Šæ¯ä¸ªç‚¹ä¸Šæ›´æ–°ä¸€æ¬¡ã€‚æ€ä¹ˆæ¶ˆå»ç›¸åŒçš„å½±å“å‘¢ï¼Ÿ</p>\n<p>è¿™é‡Œå®ç°ä¸Šæˆ‘ä»¬å°†ç»è¿‡çš„ç‚¹æŒ‰ fail æ ‘ä¸Š dfn æ’åºï¼Œå¹¶ä¸”å¯¹äºåºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ç‚¹åœ¨å…¶ LCA ä¸Šå‡å»ä¸€æ¬¡æ ‡è®°ã€‚ä¸ºä»€ä¹ˆè¿™æ˜¯æ­£ç¡®çš„å‘¢ï¼Ÿå‚è€ƒè™šæ ‘ï¼Œæˆ‘ä»¬åªéœ€è¦è®©åºåˆ—ä¸­ç›¸é‚»çš„ä¸¤ä¸ªç‚¹å°½é‡è¿‘å°±å¯ä»¥ä¿è¯é‡å¤çš„è¢«åˆ é™¤å®Œæ¯•ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e6 + 5;\nint tot, bit[maxn], T[maxn][26], fail[maxn];\nint ins(std::string &amp;t) &#123;\n    int p = 0;\n    for (auto i : t) &#123;\n        if (!T[p][i - &#39;a&#39;])\n            T[p][i - &#39;a&#39;] = ++tot;\n        p = T[p][i - &#39;a&#39;];\n    &#125;\n    return p;\n&#125;\nint lowbit(int x) &#123;\n    return x &amp; -x;\n&#125;\nvoid add(int x, int v) &#123;\n    // printf(&quot;add (%d, %d)\\n&quot;, x, v);\n    for (; x &lt;= tot + 1; x += lowbit(x))\n        bit[x] += v;\n    return;\n&#125;\nint ask(int x) &#123;\n    int res = 0, to = x;\n    for (; x; x -= lowbit(x))\n        res += bit[x];\n    // printf(&quot;ask(%d) = %d\\n&quot;, to, res);\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, q;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; tail(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::string t;\n        std::cin &gt;&gt; t, tail[i] = ins(t);\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(tot + 2);\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 26; ++i)\n            if (T[0][i])\n                q.push(T[0][i]);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            for (int i = 0; i &lt; 26; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i];\n                    q.push(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n        for (int i = 1; i &lt;= tot; ++i)\n            g[fail[i] + 1].push_back(i + 1);\n    &#125;\n    std::vector&lt;std::array&lt;int, 22&gt; &gt; f(tot + 2);\n    std::vector&lt;int&gt; dep(tot + 2), dfn(tot + 2), siz(tot + 2);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        siz[x] = 1, dfn[x] = ++now;\n        // printf(&quot;%d\\n&quot;, x);\n        for (auto i : g[x]) &#123;\n            dep[i] = dep[x] + 1;\n            f[i][0] = x;\n            for (int j = 1; j &lt;= 21; ++j)\n                f[i][j] = f[f[i][j - 1]][j - 1];\n            DFS(i), siz[x] += siz[i];\n        &#125;\n        return;\n    &#125;;\n    dep[1] = 1, DFS(1);\n    auto askLCA = [&amp;](int x, int y) &#123;\n        if (x == y)\n            return x;\n        if (dep[x] &lt; dep[y])\n            std::swap(x, y);\n        for (int i = 21; ~i; --i)\n            if (dep[f[x][i]] &gt;= dep[y])\n                x = f[x][i];\n        if (x == y)\n            return x;\n        for (int i = 21; ~i; --i)\n            if (f[x][i] != f[y][i])\n                x = f[x][i], y = f[y][i];\n        return f[x][0];\n    &#125;;\n    std::cin &gt;&gt; q;\n    for (; q--; ) &#123;\n        int op;\n        std::cin &gt;&gt; op;\n        if (op == 1) &#123;\n            std::string s;\n            std::cin &gt;&gt; s;\n            int p = 0, len = (int)s.length();\n            std::vector&lt;int&gt; id(len + 1);\n            for (int i = 1; i &lt;= len; ++i)\n                p = T[p][s[i - 1] - &#39;a&#39;], id[i] = p + 1;\n            std::sort(id.begin() + 1, id.end(), [&amp;](int x, int y) &#123; return dfn[x] &lt; dfn[y]; &#125;);\n            // for (int i = 1; i &lt;= len; ++i)\n            //     printf(&quot;%d &quot;, id[i]);\n            // puts(&quot;&quot;);\n            for (int i = 1; i &lt;= len; ++i) &#123;\n                // printf(&quot;%d %d %d\\n&quot;, i, id[i], dfn[id[i]]);\n                // assert(0);\n                add(dfn[id[i]], 1);\n                if (i != 1)\n                    add(dfn[askLCA(id[i], id[i - 1])], -1);\n            &#125;\n        &#125;\n        else &#123;\n            int x;\n            std::cin &gt;&gt; x;\n            x = tail[x] + 1;\n            std::cout &lt;&lt; ask(dfn[x] + siz[x] - 1) - ask(dfn[x] - 1) &lt;&lt; &#39;\\n&#39;;\n        &#125;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"ac-è‡ªåŠ¨æœºä¸Šçš„-dp\">AC è‡ªåŠ¨æœºä¸Šçš„ DP</h2>\n<p>é‰´äº AC è‡ªåŠ¨æœºçš„ä¼˜ç§€ç»“æ„ä¸æ€§è´¨ï¼Œå¹¶ä¸ç»å¸¸ä½œä¸ºå­—ç¬¦ä¸²åŒ¹é…å·¥å…·å‡ºç°ï¼Œå…¶ä¸€ä¸ªåº”ç”¨æ˜¯ä½œä¸º DP çš„è½½ä½“ã€‚</p>\n<h3 id=\"eg1.-l-è¯­è¨€\">eg1. L è¯­è¨€</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P2292\" class=\"uri\">https://www.luogu.com.cn/problem/P2292</a></p>\n<p>æˆ‘ä»¬æƒ³åˆ°è¦åœ¨è‡ªåŠ¨æœºä¸ŠåŒ¹é…ï¼Œä½†æ­¤æ—¶ <code>fail</code> ä½œä¸ºã€Œæ–­å¥ã€çš„å”¯ä¸€æ‰‹æ®µï¼ˆæ–­å¥çš„ä½ç½®åœ¨é“¾ä¸Šå½“å‰ç‚¹æ·±åº¦ - <code>fail</code> æ·±åº¦å¤„ï¼‰ï¼Œä¸å†ä»…å½“å¤±é…æ—¶æ‰èƒ½ç»è¿‡ã€‚æˆ‘ä»¬è€ƒè™‘æœ´ç´ çš„ DPï¼šåœ¨ç»è¿‡çš„æ¯ä¸ªçŠ¶æ€è€ƒè™‘æ–­å¥ï¼Œé‚£ä¹ˆè¿™è¦æ±‚æ–­å¥å¤„æ˜¯ä¸€ä¸ªå•è¯çš„ç»“å°¾ï¼Œé‚£ä¹ˆæ­¤æ—¶ <code>fail</code> æœ€é•¿åŒ¹é…é•¿åº¦å³å¯è¢«æ›´æ–°ã€‚æœ€åéå†æ‰€æœ‰å•è¯çš„æœ«ç»“ç‚¹ï¼Œå–æœ€å¤§ç­”æ¡ˆã€‚è¿™é‡Œçš„ <code>fail</code> å…¶å®æ˜¯ <code>fail</code> é“¾ä¸Šä»»æ„ä¸€ç‚¹ã€‚</p>\n<p>è€ƒè™‘å¤æ‚åº¦ã€‚å®¹æ˜“å‘ç°å¯¹äºæ¯ä¸€ä¸ªç‚¹æˆ‘ä»¬è·³äº†å…¶æ•´æ¡ fail é“¾ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±æ˜¯æœ€åŠ£ <span class=\"math inline\">\\(n^2\\)</span> çš„ã€‚è€ƒè™‘ä¼˜åŒ–è¿™ä¸ªè¿‡ç¨‹è‡³ <span class=\"math inline\">\\(O(1)\\)</span>ã€‚</p>\n<p>é¢˜ç›®é‡Œæœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ¡ä»¶è¿˜æ²¡æœ‰ç”¨åˆ°ï¼šå•ä¸ªå•è¯é•¿åº¦ <span class=\"math inline\">\\(\\le 20\\)</span>ï¼Œè¿™è®©æˆ‘ä»¬æƒ³åˆ°çŠ¶æ€å‹ç¼©ã€‚å¯¹äºæ¯ä¸€ä¸ªçŠ¶æ€ï¼Œè®°å½•å…¶æ–­å‡ºæ¥å•è¯çš„å¯èƒ½é•¿åº¦ã€‚</p>\n<p>æˆ‘ä»¬åœ¨ DAG ä¸Šæ¸¸èµ°çš„æ—¶å€™è®°å½•ç›®å‰å¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ï¼Œå¦‚æœå…¶å’Œå½“å‰å¯æ–­å‡ºæ¥çš„é•¿åº¦ä¹‹äº¤ä¸ä¸ºç©ºï¼Œå°±å¯ä»¥å°†æ­¤å¤„åŠ å…¥ã€Œå¯ä»¥æ–­çš„æ‰€æœ‰ä½ç½®ã€å¹¶æ›´æ–°ç­”æ¡ˆã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e5 + 5;\nint T[maxn][26], tot, fail[maxn], len[maxn], dep[maxn], tag[maxn];\nint ins(std::string &amp;t) &#123;\n    int p = 0;\n    for (auto i : t) &#123;\n        if (!T[p][i - &#39;a&#39;])\n            T[p][i - &#39;a&#39;] = ++tot, dep[tot] = dep[p] + 1;\n        p = T[p][i - &#39;a&#39;];\n    &#125;\n    ++tag[p];\n    return p;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; tail(n + 1);\n    std::vector&lt;std::string&gt; t(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; t[i], tail[i] = ins(t[i]);\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 26; ++i)\n            if (T[0][i])\n                q.push(T[0][i]);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            len[u] = len[fail[u]];\n            if (tag[u])\n                len[u] |= (1 &lt;&lt; dep[u]);\n            for (int i = 0; i &lt; 26; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i];\n                    q.push(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n    &#125;\n    for (; m--; ) &#123;\n        std::string s;\n        std::cin &gt;&gt; s;\n        int p = 0, q = 1, res = 0;\n        for (int i = 0; i &lt; (int)s.length(); ++i) &#123;\n            p = T[p][s[i] - &#39;a&#39;], q &lt;&lt;= 1;\n            if (len[p] &amp; q)\n                q |= 1, res = i + 1;\n        &#125;\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"eg2.-popcount-words\">eg2. Popcount Words</h3>\n<p><a href=\"https://codeforces.com/gym/103409/problem/H\" class=\"uri\">https://codeforces.com/gym/103409/problem/H</a></p>\n<p><del>å’‹ä¸Šå¼ºåº¦äº†å•Šã€‚</del></p>\n<p>å…ˆæŠŠæ•´ä¸ªåºåˆ—å†™å‡ºæ¥ï¼Œå³ <span class=\"math inline\">\\(w=\\texttt{01101001100101}\\cdots\\)</span>ï¼Œå°è¯•è¿›ä¸€æ­¥æ¢ç©¶å½¢å¼åŒ–çš„è§„å¾‹ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>\n<ol type=\"1\">\n<li><span class=\"math inline\">\\(w_{[0, 2^n), 0}=w_{[0, 2^{n-1}),0}+w_{[0, 2^n), 1}\\)</span>ï¼Œå…¶ä¸­ <span class=\"math inline\">\\(w_{[l, r], 0/1}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\([l, r]\\)</span> å†…ï¼ŒåŸä¸² / å–åçš„å€¼ã€‚</li>\n<li>å¯¹äºä¸ä»¥ <span class=\"math inline\">\\(0\\)</span> å¼€å¤´çš„æ•´æ®µï¼Œå¯ä»¥ä»ä¸Šè¿°è§„åˆ™è½¬åŒ–ä¸º <span class=\"math inline\">\\(0\\)</span> å¼€å¤´çš„æ•´æ®µã€‚</li>\n</ol>\n<p>æ¥ç€ä¸éš¾æƒ³åˆ°ä¸€ç§ç±»ä¼¼çº¿æ®µæ ‘çš„æ–¹å¼ï¼Œå°†å¾…æ±‚çš„ <span class=\"math inline\">\\(w_{[l, r], 0}\\)</span> åˆ†åˆ° <span class=\"math inline\">\\(O(\\log V)\\)</span> ä¸ªæ•´æ®µä¸Šï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(S\\)</span> å°±å¯ä»¥è¢« <span class=\"math inline\">\\(O(n\\log V)\\)</span> ä¸ªæ•´æ®µï¼ˆä¹Ÿæ˜¯ <span class=\"math inline\">\\(\\log V\\)</span> ä¸ªæœ¬è´¨ä¸åŒæ•´æ®µï¼‰æè¿°ã€‚</p>\n<p>æˆ‘ä»¬å¯¹ <span class=\"math inline\">\\({p_m}\\)</span> å»ºç«‹ AC è‡ªåŠ¨æœºï¼Œéœ€è¦çŸ¥é“è¿™ <span class=\"math inline\">\\(\\log V\\)</span> ä¸ªæ•´æ®µåœ¨æ¯ä¸ªç‚¹ä¸Šçš„å‡ºç°æ¬¡æ•°ã€‚å¯¹äºè‡ªåŠ¨æœºä¸Šä»»æ„çŠ¶æ€ <span class=\"math inline\">\\(u\\)</span>ï¼Œè®¾ <span class=\"math inline\">\\(to_{u, n, 0/1}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(u\\)</span> ç»è¿‡ <span class=\"math inline\">\\(w_{[0, 2^n), 0/1}\\)</span> ååˆ°è¾¾çš„ç‚¹ï¼Œåˆ™å¯å€å¢ï¼ˆå˜¶ï¼Œè¿™é‡Œæ˜¯ä¸æ˜¯åº”è¯¥åè¿‡æ¥å«åˆ†æ²»å•Šï¼‰ç®€å•è§£å†³ã€‚</p>\n<p>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥ç”¨ <span class=\"math inline\">\\(to\\)</span> æ¥è¿›è¡Œå¿«é€Ÿæ¸¸èµ°äº†ã€‚é¡ºä¾¿æ‰“ä¸ª <span class=\"math inline\">\\(cnt\\)</span> è®°å½•ä¸€ä¸‹æ¯ä¸ª <span class=\"math inline\">\\(u\\)</span> ä½œä¸ºä¸åŒæ•´æ®µçš„å¼€å¤´è¢«ç»è¿‡çš„æ¬¡æ•°ã€‚ç„¶ååšä¸€ä¸ª DPï¼Œç±»ä¼¼äºçº¿æ®µæ ‘ä¸Š <code>pushdown</code> çš„æ“ä½œæŠŠæ‰€æœ‰æ•´æ®µä¸‹æ”¾åˆ°å•ç‚¹ä¸Šçš„å•ä¸ªå­—ç¬¦ã€‚</p>\n<p>æœ‰ä¸€è¯´ä¸€ç”¨ DP æ¥å¤„ç†è¿™ä¸ªä¸œè¥¿è¿˜æŒºéš¾æƒ³çš„ã€‚å¯èƒ½ä¹Ÿæ˜¯åŸºäºå‰é¢çš„å€å¢å§ã€‚æœ€åæ‹“æ‰‘æ’åºå°±è¡Œäº†ã€‚</p>\n<details>\n<p>å¤§å®¶æ•°ç»„ä¸€å®šè¦ç”¨ C-style array å•Šï¼Œ<code>std::vector&lt;&gt;</code> è®¡ç®—çš„æ˜¯ç”³è¯·ç©ºé—´åŒ… MLE çš„ <img src=\"/em/ll.gif\" /></p>\n<p>å¤§å®¶å¤§æ•°ç»„ä¸€å®šè¦å†…å­˜è¿ç»­è®¿é—®ä¼˜åŒ–å•Šï¼ŒTLE <span class=\"math inline\">\\(\\to\\)</span> 100ms æ³ªç›®äº† <img src=\"/em/ll.gif\" /></p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 5e5 + 5;\nlong long sum[maxn], f[2][30][maxn];\nint cnt[2][30][maxn], to[2][30][maxn];\nint T[maxn][2], tot, fail[maxn], deg[maxn];\nint ins(std::string &amp;t) &#123;\n    int p = 0;\n    for (auto i : t) &#123;\n        if (!T[p][i - &#39;0&#39;])\n            T[p][i - &#39;0&#39;] = ++tot;\n        p = T[p][i - &#39;0&#39;];\n    &#125;\n    return p;\n&#125;\nvoid ask(std::vector&lt;std::pair&lt;int, int&gt; &gt; &amp;s, int ql, int qr, int l = 0, int r = (1 &lt;&lt; 30) - 1, int len = 30, int v = 0) &#123;\n    if (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;\n        s.emplace_back(len, v);\n        return;\n    &#125;\n    int mid = l + (r - l) / 2;\n    if (ql &lt;= mid)\n        ask(s, ql, qr, l, mid, len - 1, v);\n    if (qr &gt; mid)\n        ask(s, ql, qr, mid + 1, r, len - 1, v ^ 1);\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; s;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        int l, r;\n        std::cin &gt;&gt; l &gt;&gt; r;\n        ask(s, l, r);\n    &#125;\n    std::vector&lt;int&gt; tail(m + 1);\n    for (int i = 1; i &lt;= m; ++i) &#123;\n        std::string t;\n        std::cin &gt;&gt; t;\n        tail[i] = ins(t);\n    &#125;\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 2; ++i)\n            if (T[0][i])\n                q.push(T[0][i]);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            for (int i = 0; i &lt; 2; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i], ++deg[T[fail[u]][i]];\n                    q.push(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n    &#125;\n    for (int i = 0; i &lt;= tot; ++i)\n        to[0][0][i] = T[i][0], to[1][0][i] = T[i][1];\n    for (int j = 1; j &lt; 30; ++j)\n        for (int i = 0; i &lt;= tot; ++i) &#123;\n            to[0][j][i] = to[1][j - 1][to[0][j - 1][i]];\n            to[1][j][i] = to[0][j - 1][to[1][j - 1][i]];\n        &#125;\n    &#123;\n        int p = 0;\n        for (auto [n, i] : s) &#123;\n            // printf(&quot;# %d %d\\n&quot;, n, i);\n            ++cnt[i][n][p], p = to[i][n][p];\n        &#125;\n    &#125;\n    for (int j = 29; ~j; --j)\n        for (int i = 0; i &lt;= tot; ++i) &#123;\n            if (j != 29) &#123;\n                f[0][j][i] += f[0][j + 1][i];\n                f[1][j][i] += f[1][j + 1][i];\n                f[0][j][to[1][j][i]] += f[1][j + 1][i];\n                f[1][j][to[0][j][i]] += f[0][j + 1][i];\n            &#125;\n            f[1][j][i] += cnt[1][j][i];\n            f[0][j][i] += cnt[0][j][i];\n        &#125;\n    for (int i = 0; i &lt;= tot; ++i) &#123;\n        sum[T[i][0]] += f[0][0][i], sum[T[i][1]] += f[1][0][i];\n        // printf(&quot;%d %d\\n&quot;, f[i][0][0], f[i][0][1]);\n    &#125;\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt;= tot; ++i)\n            if (!deg[i])\n                q.push(i);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            sum[fail[u]] += sum[u];\n            if (!--deg[fail[u]])\n                q.push(fail[u]);\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= m; ++i)\n        std::cout &lt;&lt; sum[tail[i]] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"eg3.-legen\">eg3. Legenâ€¦</h3>\n<p><a href=\"https://codeforces.com/problemset/problem/696/D\" class=\"uri\">https://codeforces.com/problemset/problem/696/D</a></p>\n<p>å…ˆåœ¨ fail æ ‘ä¸ŠæŠŠæ¯ä¸ªçŠ¶æ€çš„å®é™…ä»·å€¼è®¡ç®—å‡ºæ¥ã€‚æˆ‘ä»¬å‘ç°åŒ¹é…ä¸²æ˜¯æœªçŸ¥çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬éœ€è¦ä¸»åŠ¨å†³å®šæ¸¸èµ°è·¯å¾„ã€‚æ³¨æ„åˆ° <span class=\"math inline\">\\(l=10^{14}\\)</span>ï¼Œè€ƒè™‘çŸ©é˜µã€‚</p>\n<p>ä»¤ <span class=\"math inline\">\\(f_{u, i}\\)</span> è¡¨ç¤ºåœ¨ <span class=\"math inline\">\\(u\\)</span> çŠ¶æ€æ—¶å·²ç»èµ°äº† <span class=\"math inline\">\\(i\\)</span> æ­¥ï¼Œå¯ä»¥å¾—åˆ°çš„æœ€å¤§ä»·å€¼ã€‚é‚£ä¹ˆæ˜¾ç„¶æœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{v,i+1}=f_{u,i}+s_v.\n\\]</span></p>\n<p>å…¶ä¸­ <span class=\"math inline\">\\(v\\)</span> æ˜¯è‡ªåŠ¨æœºä¸Š <span class=\"math inline\">\\(u\\)</span> çš„ä»»æ„å‡ºè¾¹ã€‚å›¾çš„å¤§å°ä¸º <span class=\"math inline\">\\(200\\)</span>ï¼Œå¯ä»¥æ”¾åˆ° <span class=\"math inline\">\\(+\\max\\)</span> çŸ©é˜µé‡ŒåŠ é€Ÿè½¬ç§»ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e5 + 5;\nconst long long inf = 1e18;\nint fail[maxn], T[maxn][26], tot;\nint ins(std::string s) &#123;\n    int p = 0;\n    for (auto i : s) &#123;\n        if (!T[p][i - &#39;a&#39;])\n            T[p][i - &#39;a&#39;] = ++tot;\n        p = T[p][i - &#39;a&#39;];\n    &#125;\n    return p;\n&#125;\nstruct matrix &#123;\n    int n, m;\n    std::vector&lt;std::vector&lt;long long&gt; &gt; a;\n    matrix(int n1, int m1, long long v = -inf, bool op = 0): n(n1), m(m1), a(n + 1, std::vector&lt;long long&gt; (m + 1, v)) &#123;\n        if (op)\n            for (int i = 0; i &lt;= n; ++i)\n                a[i][i] = 0;\n        return;\n    &#125;\n    std::vector&lt;long long&gt; &amp;operator[] (int i) &#123;\n        return a[i];\n    &#125;\n    matrix operator* (matrix &amp;q) const &#123;\n        matrix res(n, q.m);\n        for (int k = 0; k &lt;= m; ++k)\n            for (int i = 0; i &lt;= n; ++i)\n                for (int j = 0; j &lt;= q.m; ++j)\n                    res[i][j] = std::max(res[i][j], a[i][k] + q[k][j]);\n        return res;\n    &#125;\n    matrix&amp; operator*= (matrix q) &#123;\n        return *this = *this * q;\n    &#125;\n    matrix operator^ (long long q) &#123;\n        matrix res(n, n, -inf, 1), x(*this);\n        for (; q; q &gt;&gt;= 1, x *= x)\n            if (q &amp; 1)\n                res *= x;\n        return res;\n    &#125;\n&#125;;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    long long m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;long long&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;int&gt; tail(n + 1);\n    std::vector&lt;std::string&gt; t(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; t[i];\n        tail[i] = ins(t[i]);\n    &#125;\n    std::vector&lt;long long&gt; s(tot + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        s[tail[i]] += a[i];\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 26; ++i)\n            if (T[0][i])\n                q.push(T[0][i]); \n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            for (int i = 0; i &lt; 26; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i], s[v] += s[fail[v]];\n                    q.push(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n    &#125;\n    matrix f(0, tot), op(tot, tot);\n    f[0][0] = 0;\n    for (int i = 0; i &lt;= tot; ++i)\n        for (int j = 0; j &lt; 26; ++j)\n            op[i][T[i][j]] = s[T[i][j]];\n    f *= (op * m);\n    std::cout &lt;&lt; *std::max_element(f[0].begin(), f[0].end()) &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;\n</code></pre>\n</details>\n<hr />\n<h3 id=\"eg4.-you-are-given-some-strings\">eg4. You Are Given Some Stringsâ€¦</h3>\n<p>goto <a href=\"/20250121/#%E4%B8%80%E4%B8%AA%E6%A8%A1%E6%9D%BFcf1202e-you-are-given-some-strings...\">link</a>.</p>\n",
            "tags": [
                "DP",
                "å­—ç¬¦ä¸²",
                "AC è‡ªåŠ¨æœº"
            ]
        }
    ]
}