{
    "version": "https://jsonfeed.org/version/1",
    "title": "null",
    "description": "",
    "home_page_url": "https://xsc062.netlify.app",
    "items": [
        {
            "id": "https://xsc062.netlify.app/20250929/",
            "url": "https://xsc062.netlify.app/20250929/",
            "title": "ç”Ÿæˆæ ‘ç»ƒä¹ ",
            "date_published": "2025-09-29T08:55:28.000Z",
            "content_html": "\n",
            "tags": []
        },
        {
            "id": "https://xsc062.netlify.app/20250924/",
            "url": "https://xsc062.netlify.app/20250924/",
            "title": "æœ€çŸ­è·¯ç»ƒä¹ ",
            "date_published": "2025-09-24T06:27:15.000Z",
            "content_html": "<p>æœ€çŸ­è·¯ä¸ºèƒŒæ™¯çš„é¢˜ + åšæ³•æ˜¯æœ€çŸ­è·¯çš„é¢˜</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a---minimum-path\">A - Minimum Path</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1473E\" class=\"uri\">https://www.luogu.com.cn/problem/CF1473E</a></p>\n<ul>\n<li>ç»å…¸å¥—è·¯ï¼Œå‘ç°å¯ä»¥æŠŠ max å’Œ min æ¢æˆä»»æ„è·¯å¾„ä¸­çš„è¾¹ï¼Œç„¶å max å’Œ min å°±ä¼šæœ€å°åŒ–è¿™ä¸ªå¼å­</li>\n<li>æ•…å†™ä¸€ä¸ª Dijkstra + DPï¼Œæ±‚è¿™ä¸ªå¼å­çš„æœ€å°å€¼å³å¯</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    using arr = std::vector&lt;long long&gt;;\n    using brr = std::vector&lt;arr&gt;;\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);\n    std::vector&lt;brr&gt; dis(2, brr(2, arr(n + 1, 1e18))), vis(2, brr(2, arr(n + 1)));\n    for (int x, y, w; m--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;\n        g[x].emplace_back(y, w);\n        g[y].emplace_back(x, w);\n    &#125;\n    dis[0][0][1] = 0;\n    std::array&lt;std::array&lt;std::priority_queue&lt;std::pair&lt;long long, int&gt; &gt;, 2&gt;, 2&gt; q;\n    q[0][0].emplace(0, 1);\n    for (int i = 0; i &lt; 2; ++i) &#123;\n        for (int j = 0; j &lt; 2; ++j) &#123;\n            for (; !q[i][j].empty(); ) &#123;\n                int f = q[i][j].top().second;\n                q[i][j].pop();\n                if (vis[i][j][f])\n                    continue;\n                vis[i][j][f] = 1;\n                for (auto k : g[f]) &#123;\n                    if (dis[i][j][k.first] &gt; dis[i][j][f] + k.second) &#123;\n                        dis[i][j][k.first] = dis[i][j][f] + k.second;\n                        q[i][j].emplace(-dis[i][j][k.first], k.first);\n                    &#125;\n                    if (!i &amp;&amp; dis[1][j][k.first] &gt; dis[i][j][f]) &#123;\n                        dis[1][j][k.first] = dis[i][j][f];\n                        q[1][j].emplace(-dis[1][j][k.first], k.first);\n                    &#125;\n                    if (!j &amp;&amp; dis[i][1][k.first] &gt; dis[i][j][f] + 2 * k.second) &#123;\n                        dis[i][1][k.first] = dis[i][j][f] + 2 * k.second;\n                        q[i][1].emplace(-dis[i][1][k.first], k.first);\n                    &#125;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n    for (int i = 2; i &lt;= n; ++i)\n        std::cout &lt;&lt; std::min(&#123; dis[0][0][i], dis[1][1][i] &#125;) &lt;&lt; &#39; &#39;;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---train-delay\">B - Train Delay</h2>\n<p><a href=\"https://vjudge.net/contest/750645#problem/B\" class=\"uri\">https://vjudge.net/contest/750645#problem/B</a></p>\n<ul>\n<li>ç®€åŒ–é¢˜ç›®å¾ˆé‡è¦çš„ä¸€ä¸ªè½¬åŒ–æ˜¯<strong>ç”±äº <span class=\"math inline\">\\(S\\le T\\)</span> å¸¦æ¥çš„ <span class=\"math inline\">\\(S\\)</span> å’Œ <span class=\"math inline\">\\(T\\)</span> åœ°ä½å¹³ç­‰ï¼Œè€ƒè™‘æŠŠå‡ºå‘å’Œåˆ°è¾¾åˆ†åˆ«çœ‹ä½œä¸€æ¬¡äº‹ä»¶å¤„ç†ã€‚</strong></li>\n<li><p>æŒ‰ç…§æ‰€æœ‰äº‹ä»¶çš„å‘ç”Ÿæ—¶åˆ»æ’åºï¼Œæœ‰ï¼š</p>\n<ul>\n<li>å¯¹äºä¸€æ¬¡å‡ºå‘äº‹ä»¶ï¼Œå¯ä»¥å¾—åˆ°åœ¨å…¶ä¹‹å‰è¯¥ç«™ç‚¹æ‰€æœ‰åˆ°è¾¾äº‹ä»¶çš„ <span class=\"math inline\">\\(\\max\\{T&#39;\\}\\)</span>ï¼Œç”¨ä¹‹æ›´æ–° <span class=\"math inline\">\\(X\\)</span> å³å¯ã€‚</li>\n<li>å¯¹äºä¸€æ¬¡åˆ°è¾¾äº‹ä»¶ï¼Œç”±äºå¯¹åº”çš„ <span class=\"math inline\">\\(X\\)</span> å·²ç»ç¡®å®šï¼Œæ›´æ–°è¯¥ç«™ç‚¹å½“å‰æœ€å¤§å€¼å³å¯ã€‚</li>\n</ul></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; d(m + 1);\n    std::cin &gt;&gt; d[1];\n    struct event &#123;\n        int t, op, id, x;\n    &#125;;\n    std::vector&lt;event&gt; a;\n    std::vector&lt;int&gt; mx(n + 1);\n    for (int i = 1, x, y, s, t; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; s &gt;&gt; t;\n        a.push_back(&#123; s, 0, i, x &#125;);\n        a.push_back(&#123; t, 1, i, y &#125;);\n    &#125;\n    std::sort(a.begin(), a.end(), [&amp;](event &amp;x, event &amp;y) &#123; return x.t == y.t ? x.op &gt; y.op : x.t &lt; y.t; &#125;);\n    for (auto [t, op, id, x] : a)\n        if (op == 1)\n            mx[x] = std::max(mx[x], t + d[id]);\n        else if (id != 1)\n            d[id] = std::max(mx[x] - t, 0);\n    for (int i = 2; i &lt;= m; ++i)\n        std::cout &lt;&lt; d[i] &lt;&lt; &#39; &#39;;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---complete-the-graph\">C - Complete The Graph</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF715B\" class=\"uri\">https://www.luogu.com.cn/problem/CF715B</a></p>\n<p>ç¥ä»™äºŒåˆ†</p>\n<ul>\n<li>å¦‚æœåˆå§‹æŠŠæ‰€æœ‰ç™½è¾¹ç½®ä¸º <span class=\"math inline\">\\(1\\)</span>ï¼Œé‚£ä¹ˆä¼šæƒ³åˆ°è°ƒæ•´æ³•æ„é€ </li>\n<li>ä½†æ˜¯ä¸çŸ¥é“åº”è¯¥åœ¨å“ªäº›è¾¹ä¸Šè°ƒæ•´ï¼Œç¡®å®šè°ƒæ•´å¤šå°‘ä¼¼ä¹ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç®€å•çš„åšæ³•</li>\n<li><p>æ•…<strong>å¹³å‡ç”¨åŠ›</strong>ï¼Œæ„é€ ä¸€ä¸ª è¾¹1 += 1ï¼Œè¾¹2 += 1ï¼Œè¾¹3 += 1, â€¦, è¾¹cnt0 += 1, è¾¹1 += 1, è¾¹2 += 1, â€¦ çš„æ“ä½œåºåˆ—</p>\nå®¹æ˜“<strong>å‘ç°æ¯æ¬¡æ“ä½œæœ€å¤šè®©å½“å‰æœ€çŸ­è·¯é•¿åº¦å¢åŠ  1</strong>ï¼Œè€Œä¸”æœ‰å•è°ƒæ€§</li>\n<li><p>æ•…äºŒåˆ†ç­”æ¡ˆå³å¯</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst __int128 inf = 1e18;\nconst __int128 inff = 1e23;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m, s, t, l, cnt = 0;\n    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; l &gt;&gt; s &gt;&gt; t, ++s, ++t;\n    std::vector&lt;std::tuple&lt;int, int, long long&gt; &gt; u(m + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, long long&gt; &gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt;= m; ++i) &#123;\n        long long w;\n        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w, ++x, ++y;\n        if (w == 0)\n            w = -(++cnt);\n        g[x].emplace_back(y, w), g[y].emplace_back(x, w);\n        u[i] = &#123; x, y, w &#125;;\n    &#125;\n    std::vector&lt;int&gt; vis(n + 1);\n    std::vector&lt;__int128&gt; dis(n + 1);\n    std::vector&lt;long long&gt; k(cnt + 1);\n    __int128 res = -1;\n    auto check = [&amp;](__int128 x) &#123;\n        for (int i = 1; i &lt;= cnt; ++i)\n            k[i] = x / cnt + (i &lt;= x % cnt);\n        std::fill(vis.begin() + 1, vis.end(), 0);\n        std::fill(dis.begin() + 1, dis.end(), inf);\n        std::priority_queue&lt;std::pair&lt;__int128, int&gt; &gt; q;\n        dis[s] = 0, q.emplace(0, s);\n        for (; !q.empty(); ) &#123;\n            int f = q.top().second;\n            q.pop();\n            if (vis[f])\n                continue;\n            vis[f] = 1;\n            for (auto [v, w] : g[f]) &#123;\n                if (w &lt; 0)\n                    w = k[-w];\n                if (dis[v] &gt; dis[f] + w) &#123;\n                    dis[v] = dis[f] + w;\n                    q.emplace(-dis[v], v);\n                &#125;\n            &#125;\n        &#125;\n        return dis[t] &lt;= l;\n    &#125;;\n    for (__int128 l = cnt, r = cnt * inf, mid; l &lt;= r; ) &#123;\n        mid = (l + r) &gt;&gt; 1;\n        if (check(mid))\n            res = mid, l = mid + 1;\n        else\n            r = mid - 1;\n    &#125;\n    if (res == -1)\n        std::cout &lt;&lt; &quot;NO\\n&quot;;\n    else &#123;\n        check(res);\n        if (dis[t] != l)\n            std::cout &lt;&lt; &quot;NO\\n&quot;;\n        else &#123;\n            std::cout &lt;&lt; &quot;YES\\n&quot;;\n            for (int i = 1; i &lt;= m; ++i) &#123;\n                auto [x, y, w] = u[i];\n                if (w &lt; 0)\n                    w = k[-w];\n                std::cout &lt;&lt; x - 1 &lt;&lt; &#39; &#39; &lt;&lt; y - 1 &lt;&lt; &#39; &#39; &lt;&lt; w &lt;&lt; &#39;\\n&#39;;\n            &#125;\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a---é‡åŠ›çƒ\">A - é‡åŠ›çƒ</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7473\" class=\"uri\">https://www.luogu.com.cn/problem/P7473</a></p>\n<ul>\n<li><span class=\"math inline\">\\(m\\)</span> ç›¸å¯¹å¾ˆå°ï¼Œçœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆåŸºäº <span class=\"math inline\">\\(m\\)</span> çš„åšæ³•</li>\n<li>æ¯æ¬¡çƒåœä¸‹çš„ä½ç½®ä¸€å®šæ˜¯æŸä¸ªéšœç¢ç‰©ï¼ˆæˆ–è¾¹ç•Œï¼‰ä¸Š / ä¸‹ / å·¦ / å³çš„æ ¼å­ï¼Œæ•…å¯ä»¥åœ¨è¿™ <span class=\"math inline\">\\(O(n + m)\\)</span> ä¸ªç‚¹ä¸Šå»ºå›¾</li>\n<li>æ€ä¹ˆåŒæ—¶ç»´æŠ¤ä¸¤ä¸ªçƒçš„ä¿¡æ¯å‘¢ï¼Œå‘ç° <span class=\"math inline\">\\(m\\)</span> è¿˜æ˜¯å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥æŠŠä¸¤ä¸ªçƒå¡ä¸€èµ·ä½œä¸ºä¸€ä¸ªçŠ¶æ€</li>\n<li><p><span class=\"math inline\">\\(m^2\\)</span> æ¬¡ Dij è¿˜æ˜¯å¤ªæ¿€è¿›äº† è¿›ä¸€æ­¥æ€è€ƒå‘ç°å¯èƒ½çš„ç»ˆç‚¹å…± <span class=\"math inline\">\\(m\\)</span> ä¸ª å¹¶ä¸”å½¼æ­¤ä¸åŒºåˆ†</p>\n<p>æ•…ä»¥è¿™ <span class=\"math inline\">\\(m\\)</span> ä¸ªç»ˆç‚¹è·‘å¤šæºæœ€çŸ­è·¯å³å¯</p>\n<p>ä½† 5e6 è·‘ Dij è¿˜æ˜¯å¤ªå‹‰å¼ºäº†ã€‚<strong>å‘ç°è¾¹æƒä¸º 1ï¼Œä¸ºä»€ä¹ˆä¸ BFS å‘¢ ğŸ˜…</strong></p></li>\n<li><p>å‘ç°èµ·ç‚¹å¯èƒ½ä¸åœ¨æˆ‘ä»¬é™å®šçš„ç‚¹ä¸Šï¼Œä½†å¯ä»¥äººä¸ºé€‰æ‹©ä¸€æ¬¡é‡åŠ›æ–¹å‘ï¼Œç„¶åå°±å›åˆ°åˆšåˆšçš„é—®é¢˜äº†</p>\n<p>æˆ–è€…ç¦»çº¿ä¹Ÿæ˜¯ä¸€ç§æ–¹æ³•</p></li>\n</ul>\n<p>ç–‘ä¼¼å¸¸æ•°å¤ªå¤§ï¼Œæ‹¼å°½å…¨åŠ›å‹‰å¼ºå¡è¿‡</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int LEN = (1 &lt;&lt; 20);\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf)\n            return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF)\n            return 0;\n        if (ch == &#39;-&#39;)\n            f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f)\n        x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0) &#123;\n        putchar(&#39;-&#39;);\n        x = -x;\n    &#125;\n    if (x &gt;= 10)\n        print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x);\n    putchar(ch);\n    return;\n&#125;\nconst int inf = 0x3f3f3f3f;\nconst int dir[][2] = &#123;&#123; -1, 0 &#125;, &#123; 1, 0 &#125;, &#123; 0, -1 &#125;, &#123; 0, 1 &#125;&#125;;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m, q;\n    read(n), read(m), read(q);\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; pos(m + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; a(n + 1, std::vector&lt;int&gt; (n + 1));\n    for (int i = 1, x, y; i &lt;= m; ++i) &#123;\n        read(x), read(y);\n        pos[i] = &#123; x, y &#125;, a[x][y] = -1;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        pos.emplace_back(0, i), ++m;\n    for (int i = 1; i &lt;= n; ++i)\n        pos.emplace_back(i, n + 1), ++m;\n    for (int i = 1; i &lt;= n; ++i)\n        pos.emplace_back(n + 1, i), ++m;\n    for (int i = 1; i &lt;= n; ++i)\n        pos.emplace_back(i, 0), ++m;\n    int cnt = 0;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; u(1);\n    for (int i = 1; i &lt;= m; ++i)\n        for (auto [fx, fy] : dir) &#123;\n            int nx = pos[i].first + fx, ny = pos[i].second + fy;\n            if (nx &gt;= 1 &amp;&amp; nx &lt;= n &amp;&amp; ny &gt;= 1 &amp;&amp; ny &lt;= n &amp;&amp; !a[nx][ny])\n                a[nx][ny] = ++cnt, u.emplace_back(nx, ny);\n        &#125;\n    std::vector&lt;std::vector&lt;std::array&lt;int, 4&gt; &gt; &gt; top(n + 1, std::vector&lt;std::array&lt;int, 4&gt; &gt; (n + 1));\n    for (int j = 1; j &lt;= n; ++j) &#123;\n        for (int i = 1; i &lt;= n; ++i)\n            if (a[i][j] != -1) &#123;\n                if (i == 1 || a[i - 1][j] == -1)\n                    top[i][j][0] = a[i][j];\n                else\n                    top[i][j][0] = top[i - 1][j][0];\n            &#125;\n        for (int i = n; i; --i)\n            if (a[i][j] != -1) &#123;\n                if (i == n || a[i + 1][j] == -1)\n                    top[i][j][1] = a[i][j];\n                else\n                    top[i][j][1] = top[i + 1][j][1];\n            &#125;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (int j = 1; j &lt;= n; ++j)\n            if (a[i][j] != -1) &#123;\n                if (j == 1 || a[i][j - 1] == -1)\n                    top[i][j][2] = a[i][j];\n                else\n                    top[i][j][2] = top[i][j - 1][2];\n            &#125;\n        for (int j = n; j; --j)\n            if (a[i][j] != -1) &#123;\n                if (j == n || a[i][j + 1] == -1)\n                    top[i][j][3] = a[i][j];\n                else\n                    top[i][j][3] = top[i][j + 1][3];\n            &#125;\n    &#125;\n    const int N = cnt * cnt;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(N + 1);\n    auto encode = [&amp;](int x, int y) &#123;\n        return (x - 1) * cnt + y;\n    &#125;;\n    auto decode = [&amp;](int id) &#123;\n        return std::make_pair((id - 1) / cnt + 1, (id - 1) % cnt + 1);\n    &#125;;\n    for (int i = 1; i &lt;= N; ++i)\n        for (int j = 0; j &lt; 4; ++j) &#123;\n            auto [a, b] = decode(i);\n            g[encode(top[u[a].first][u[a].second][j], top[u[b].first][u[b].second][j])].emplace_back(i);\n        &#125;\n    std::vector&lt;int&gt; dis(N + 1, inf), vis(N + 1);\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 1; i &lt;= cnt; ++i)\n            dis[encode(i, i)] = 0, q.push(encode(i, i)), vis[encode(i, i)] = 1;\n        for (; !q.empty(); ) &#123;\n            int x = q.front();\n            q.pop();\n            for (auto i : g[x])\n                if (!vis[i])\n                    dis[i] = dis[x] + 1, vis[i] = 1, q.push(i);\n        &#125;\n    &#125;\n    for (int a, b, c, d; q--; ) &#123;\n        read(a), read(b), read(c), read(d);\n        if (a == c &amp;&amp; b == d)\n            print(0, &#39;\\n&#39;);\n        else &#123;\n            int res = inf;\n            for (int j = 0; j &lt; 4; ++j)\n                res = std::min(res, dis[encode(top[a][b][j], top[c][d][j])] + 1);\n            if (res == inf)\n                print(-1, &#39;\\n&#39;);\n            else\n                print(res, &#39;\\n&#39;);\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---çŸ©é˜µæ¸¸æˆ\">B - çŸ©é˜µæ¸¸æˆ</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7515\" class=\"uri\">https://www.luogu.com.cn/problem/P7515</a></p>\n<ul>\n<li><p>æŠŠé—®é¢˜å½¢å¼åŒ–ä¸€ä¸‹ï¼Œç°åœ¨æœ‰ <span class=\"math inline\">\\(n\\times m\\)</span> ä¸ªæœªçŸ¥æ•°å’Œ <span class=\"math inline\">\\((n-1)\\times (m-1)\\)</span> ä¸ªæ–¹ç¨‹</p>\n<p>é‚£ä¹ˆå¯ä»¥å¯¹è¾¹ä¸Šä¸€åœˆä»»æ„èµ‹å€¼ï¼Œé™åˆ¶æ˜¯å·¦ä¸Šè§’è¿™ <span class=\"math inline\">\\((n-1)\\times (m-1)\\)</span> ä¸ªæœªçŸ¥æ•°å¿…é¡»è½åœ¨ <span class=\"math inline\">\\([0,10^6]\\)</span> ä¸Š</p></li>\n<li>æœ‰ä¸€ä¸ªå¾ˆå®¹æ˜“è§‚å¯Ÿåˆ°çš„æ€§è´¨ï¼Œå¯¹äºä¸€ä¸ª <span class=\"math inline\">\\(a\\)</span>ï¼Œé€‰å–ä¸€ä¸ª <span class=\"math inline\">\\(v\\)</span>ï¼Œå¹¶æŠŠæ£‹ç›˜é»‘ç™½æŸ“è‰²ï¼Œé‚£ä¹ˆæŠŠæ‰€æœ‰é»‘æ ¼ <span class=\"math inline\">\\(+=v\\)</span>ï¼Œç™½æ ¼ <span class=\"math inline\">\\(-=v\\)</span>ï¼Œå¯¹åº”çš„ <span class=\"math inline\">\\(b\\)</span> æ˜¯ä¸ä¼šå˜çš„ã€‚</li>\n<li><p><strong>è¿™ä¸ªæ“ä½œæ˜¯æ¶‰åŠå…¨å±€çš„ï¼Œå¤ªè‹›åˆ»äº†</strong>ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆæ›´ mild çš„æ„é€ ï¼Ÿ</p>\n<p>å‘ç°åªå¯¹ä¸€è¡Œ / åˆ—é»‘ç™½æŸ“è‰²å¹¶æ“ä½œä¹Ÿå¯ä»¥å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚èƒ½æ„Ÿå—åˆ°<strong>æ“ä½œæ— æ³•å†ç®€åŒ–äº†</strong>ã€‚è€ƒè™‘ç”¨è¿™ä¸ªç‰ˆæœ¬çš„æ“ä½œ<strong>è°ƒæ•´</strong>ã€‚</p></li>\n<li>æ•…å¤§åŠ›ä»¤å‘¨å›´ä¸€åœˆçš„ä¸´æ—¶è§£ <span class=\"math inline\">\\(a&#39;\\)</span> ä¸º <span class=\"math inline\">\\(0\\)</span>ï¼Œä»¤æ¯è¡Œã€åˆ—çš„è°ƒæ•´ delta ä¸º <span class=\"math inline\">\\(r_i,c_i\\)</span>ï¼Œå¯ä»¥å¾—åˆ°è‹¥å¹²ä¸ªå…³äº <span class=\"math inline\">\\(0\\)</span> å’Œ <span class=\"math inline\">\\(10^6\\)</span> çš„çº¦æŸã€‚æœ€åå»ºå‡ºæ¥ä¸€ä¸ªå®Œå…¨äºŒåˆ†å›¾çŠ¶ç‰©ï¼Œè·‘å·®åˆ†çº¦æŸå³å¯ï¼Œå®¹æ˜“å‘ç°å¤æ‚åº¦æ­£ç¡®ã€‚</li>\n<li><p>å®ç°æŠ€å·§ï¼šè§„åˆ’ä¸€ä¸‹ <span class=\"math inline\">\\(r\\)</span> å’Œ <span class=\"math inline\">\\(c\\)</span> çš„æŸ“è‰²æ–¹å¼ï¼Œä½¿å¾—å®ƒä»¬é”™å¼€ï¼Œå¯ä»¥æŠŠæ‰€æœ‰ä½ç½®éƒ½å†™ä½œ <span class=\"math inline\">\\(a&#39;_{i,j}+c-r\\)</span> æˆ– <span class=\"math inline\">\\(a&#39;_{i,j}+r-c\\)</span> çš„å½¢å¼ï¼Œä¾¿äºå·®åˆ†çº¦æŸ</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code></code></pre>\n</details>\n<hr />\n<h2 id=\"c---tax\">C - Tax</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P6822\" class=\"uri\">https://www.luogu.com.cn/problem/P6822</a></p>\n<ul>\n<li>å®¹æ˜“æƒ³åˆ°åˆ†ç±»è®¨è®ºï¼Œå¦‚æœé’¦å®šæ˜¯å…¥è¾¹è´¡çŒ®è¾¹æƒï¼Œé‚£ä¹ˆå‡ºè¾¹è¾¹æƒä¸èƒ½å¤§äºå…¥è¾¹è¾¹æƒï¼›å¦åˆ™ï¼Œå‡ºè¾¹è´¡çŒ®è¾¹æƒã€‚</li>\n<li>è€ƒè™‘æŠŠæ¯ä¸ªç‚¹ä¸Šçš„å‡ºè¾¹æŒ‰è¾¹æƒä»å°åˆ°å¤§æ’åºï¼Œæ˜¾ç„¶éœ€è¦å…¥è¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µå‰ç¼€ï¼Œéœ€è¦å‡ºè¾¹è´¡çŒ®çš„æ˜¯ä¸€æ®µåç¼€ï¼Œå°±å¯ä»¥åšä¸€ä¸ªå‰åç¼€ä¼˜åŒ–å»ºå›¾ã€‚</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    struct edge &#123; int v, w, id, pi, si; &#125;;\n    std::vector&lt;std::vector&lt;edge&gt; &gt; g1(n + 2);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(1);\n    int cnt = 0;\n    for (int x, y, w; m--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; w;\n        g1[x].push_back(&#123; y, w, ++cnt, 0, 0 &#125;);\n        g1[y].push_back(&#123; x, w, ++cnt, 0, 0 &#125;);\n        g.emplace_back(), g.emplace_back();\n    &#125;\n    int s = ++cnt, t = ++cnt;\n    g1[0].push_back(&#123; 1, 0, s, 0, 0 &#125;), g1[n].push_back(&#123; n + 1, 0, t, 0, 0 &#125;);\n    g.emplace_back(), g.emplace_back();\n    for (int i = 0; i &lt;= n + 1; ++i)\n        if (!g1[i].empty()) &#123;\n            std::sort(g1[i].begin(), g1[i].end(), [&amp;](edge &amp;x, edge &amp;y) &#123; return x.w &lt; y.w; &#125;);\n            for (int j = 0; j &lt; (int)g1[i].size(); ++j) &#123;\n                g1[i][j].pi = ++cnt, g.emplace_back();\n                if (j != 0)\n                    g[cnt].emplace_back(cnt - 1, 0);\n                g[cnt].emplace_back(g1[i][j].id, 0);\n            &#125;\n            for (int j = (int)g1[i].size() - 1; ~j; --j) &#123;\n                g1[i][j].si = ++cnt, g.emplace_back();\n                if (j != (int)g1[i].size() - 1)\n                    g[cnt].emplace_back(cnt - 1, 0);\n                g[cnt].emplace_back(g1[i][j].id, g1[i][j].w);\n            &#125;\n        &#125;\n    for (int i = 0; i &lt;= n + 1; ++i)\n        for (auto &amp;[v, w, id, pi, si] : g1[i]) &#123;\n            auto to = std::upper_bound(g1[v].begin(), g1[v].end(), w, [&amp;](int x, edge &amp;y) &#123; return x &lt; y.w; &#125;);\n            if (to != g1[v].end())\n                g[id].emplace_back(to-&gt;si, 0);\n            if (to != g1[v].begin())\n                g[id].emplace_back((--to)-&gt;pi, w);\n        &#125;\n    std::vector&lt;int&gt; vis(cnt + 1, 0);\n    std::vector&lt;long long&gt; dis(cnt + 1, inf);\n    std::priority_queue&lt;std::pair&lt;long long, int&gt; &gt; q;\n    dis[s] = 0, q.emplace(0, s);\n    for (; !q.empty(); ) &#123;\n        int f = q.top().second;\n        q.pop();\n        if (vis[f])\n            continue;\n        vis[f] = 1;\n        for (auto [v, w] : g[f])\n            if (dis[v] &gt; dis[f] + w) &#123;\n                dis[v] = dis[f] + w;\n                q.emplace(-dis[v], v);\n            &#125;\n    &#125;\n    std::cout &lt;&lt; dis[t] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---travelling-through-the-snow-queens-kingdom\">D - Travelling Through the Snow Queenâ€™s Kingdom</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF685E\" class=\"uri\">https://www.luogu.com.cn/problem/CF685E</a></p>\n<p>ç›®å‰è§è¿‡çš„æ•°æ®èŒƒå›´æç¤ºæ€§æå¼±ï¼ˆè¯¯å¯¼æ€§æå¼ºï¼‰çš„å¾ªç¯ç»“æ„é¢˜ï¼š</p>\n<ul>\n<li>[BZOJ3620] ä¼¼ä¹åœ¨æ¢¦ä¸­è§è¿‡çš„æ ·å­</li>\n<li><a href=\"/20240906/#å­—ç¬¦åˆå¹¶\">å­—ç¬¦åˆå¹¶</a></li>\n<li><a href=\"/20250907/#e---subset-product-problem\">[ARC205E] Subset Product Problem</a></li>\n</ul>\n<p>æ­£èµ›å› ä¸ºæœ‰éƒ¨åˆ†åˆ†ï¼Œåº”è¯¥ä¸ä¼šå‡ºç°ä¸æ•¢å†™çš„é—®é¢˜</p>\n<ul>\n<li>è€ƒè™‘ç¦»çº¿è¯¢é—®ï¼Œé€†åºåŠ è¾¹ï¼›åŸæ–‡æ— è¾¹æƒï¼›è¾¹çš„é€šè¡Œæ—¶åˆ»åªå†³å®šåˆ°è¾¾ç‚¹çš„æ—¶åˆ»ã€‚</li>\n<li><p>å€Ÿé‰´ <a href=\"/20231113/#b.-å•†äºº\">merchant</a> ä¸­çš„æ€è·¯ï¼Œåªéœ€è¦æ›´æ–°å½“å‰è¾¹ä¸¤ä¾§ç‚¹ä¸ºèµ·ç‚¹çš„ DP æ•°ç»„ã€‚</p>\n<p>éœ€è¦æ³¨æ„è¾¹ä»æŸç§æ„ä¹‰ä¸Šè¯´æ˜¯ã€æœ‰å‘ã€çš„ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 0x3f3f3f3f;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m, q;\n    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;\n    struct query &#123; int r, s, t, id; &#125;;\n    std::vector&lt;int&gt; res(q + 1);\n    std::vector&lt;std::vector&lt;query&gt; &gt; u(m + 1);\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; e(m + 1);\n    for (int i = 1; i &lt;= m; ++i)\n        std::cin &gt;&gt; e[i].first &gt;&gt; e[i].second;\n    for (int i = 1, l, r, s, t; i &lt;= q; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; s &gt;&gt; t;\n        u[l].push_back(&#123; r, s, t, i &#125;);\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1, std::vector&lt;int&gt; (n + 1, inf));\n    for (int i = m; i; --i) &#123;\n        auto [x, y] = e[i];\n        g[x][y] = g[y][x] = i;\n        for (int j = 1; j &lt;= n; ++j)\n            g[x][j] = g[y][j] = std::min(g[x][j], g[y][j]);\n        for (auto [r, s, t, id] : u[i])\n            if (g[s][t] &lt;= r)\n                res[id] = 1;\n    &#125;\n    for (int i = 1; i &lt;= q; ++i)\n        std::cout &lt;&lt; (res[i] ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---culture-code\">E - Culture Code</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1197E\" class=\"uri\">https://www.luogu.com.cn/problem/CF1197E</a></p>\n<ul>\n<li>å…ˆæŒ‰ <span class=\"math inline\">\\(out\\)</span> æ’åºï¼Œåšä¸€ä¸ªå‰ç¼€ä¼˜åŒ–å»ºå›¾ã€‚</li>\n<li><p>å®¹æ˜“å‘ç°é™¤äº†æœ€å¤–å±‚ï¼Œæ¯ä¸€ä¸ªå¥—å¨ƒéƒ½ä¼šæä¾› <span class=\"math inline\">\\(in_i-out_i\\)</span> çš„ä»£ä»·ï¼Œè€Œæœ€å¤–å±‚ä¼šæä¾› <span class=\"math inline\">\\(in_x\\)</span> çš„ä»£ä»·ã€‚</p>\n<del>å¥½åœ¨è¦æ±‚çš„æ˜¯æœ€é•¿è·¯ï¼Œè¿™æ ·å°±å¯ä»¥ Dij äº†</del>ï¼Œå¹¶ä¸éœ€è¦çœŸæ­£æŠŠå›¾å»ºå‡ºæ¥ï¼Œå‘ç°è¿™ä¸ªå½¢å¼æ›´åºåˆ—ï¼Œç›´æ¥åœ¨åºåˆ—ä¸ŠäºŒåˆ†å‰ç¼€ + DP å³å¯ã€‚</li>\n<li><p>æ±‚æ–¹æ¡ˆæ˜¯å®¹æ˜“çš„ã€‚æœ€åç»Ÿè®¡ DP å€¼æœ€å¤§ï¼Œ<strong>ä¸”ä¸èƒ½è¢«å…¶ä»–å¥—å¨ƒåŒ…å«çš„å…ƒç´ </strong>å³å¯ã€‚</p>\n<p>Tipï¼šåœ¨æ±‚è§£è¿‡ç¨‹ä¸­å¹¶ä¸ç”¨è€ƒè™‘å½“å‰å…ƒç´ å’Œå‰ç¼€ min å…ƒç´ é—´èƒ½å¦åŠ å…¥å…¶ä»–å¥—å¨ƒï¼Œå› ä¸ºä¿è¯ <span class=\"math inline\">\\(out&gt;in\\)</span>ï¼Œå¦‚æœå­˜åœ¨è¿™æ ·çš„å¥—å¨ƒï¼Œå…¶ DP å€¼ä¼šæ¯”å‰ç¼€ min æ›´å°ï¼ŒçŸ›ç›¾ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; a(n + 1);\n    int mxi = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i].first &gt;&gt; a[i].second;\n        mxi = std::max(mxi, a[i].second);\n    &#125;\n    std::sort(a.begin() + 1, a.end());\n    std::vector&lt;long long&gt; g(n + 1), mxg(n + 1), f(n + 1), mx(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        int j = std::upper_bound(a.begin() + 1, a.begin() + i, std::make_pair(a[i].second, 0x3f3f3f3f)) - a.begin() - 1;\n        if (j == 0)\n            f[i] = a[i].second, g[i] = 1ll;\n        else\n            f[i] = mx[j] + a[i].second, g[i] = mxg[j];\n        long long now = f[i] - a[i].first;\n        if (now &lt; mx[i - 1])\n            mx[i] = now, mxg[i] = g[i];\n        else if (now == mx[i - 1])\n            mx[i] = now, mxg[i] = (mxg[i - 1] + g[i]) % mod;\n        else\n            mx[i] = mx[i - 1], mxg[i] = mxg[i - 1];\n    &#125;\n    auto now = 0x3f3f3f3fll, res = 0ll;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (a[i].first &lt;= mxi)\n            continue;\n        if (f[i] &lt; now)\n            now = f[i], res = g[i];\n        else if (f[i] == now)\n            (res += g[i]) %= mod;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a---awesome-arrowland-adventure\">A - Awesome Arrowland Adventure</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P6233\" class=\"uri\">https://www.luogu.com.cn/problem/P6233</a></p>\n<ul>\n<li>æ²¡ä»€ä¹ˆå¥½è¯´çš„å»ºå›¾ï¼Œæ³¨æ„åªèƒ½é¡ºæ—¶é’ˆè½¬</li>\n<li>ä»£ç ç•¥</li>\n</ul>\n<hr />\n<h2 id=\"b---åœ°é“çº¿è·¯\">B - åœ°é“çº¿è·¯</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P6096\" class=\"uri\">https://www.luogu.com.cn/problem/P6096</a></p>\n<ul>\n<li>è€ƒè™‘åšä¸€ä¸ªç¥ç§˜æ‹†ç‚¹ï¼ŒæŠŠæ¯ä¸ªç‚¹é™„ä¸Šçº¿è·¯å’Œè¿è¡Œæ–¹å‘çš„ä¿¡æ¯ï¼ˆæ‰€ä»¥æ˜¯å•å‘çš„ï¼‰</li>\n<li>è®¤ä¸ºè·¯å¾„ä»£ä»·æ˜¯äºŒå…ƒç»„ï¼Œé‚£ä¹ˆåŒæ¡çº¿è·¯ä¸­çš„ç‚¹é€šè¡Œä»£ä»·ä¸º <span class=\"math inline\">\\((0,-1)\\)</span></li>\n<li>æ¢ä¹˜éœ€è¦ä¼˜åŒ–å»ºå›¾ï¼Œæ¯ä¸ªç‚¹å¯ä»¥èŠ± <span class=\"math inline\">\\((0,0)\\)</span> çš„ä»£ä»·èµ°åˆ°è¿™ä¸ªç‚¹çš„ã€æ¢ä¹˜ç‚¹ã€ï¼Œå†èŠ± <span class=\"math inline\">\\((1,0)\\)</span> çš„ä»£ä»·èµ°åˆ°å¦ä¸€ä¸ªåˆ†ç‚¹</li>\n<li><p>ä½† <strong>15 å¹´çš„æ—¶å€™ SPFA å·²ç»æ­»äº†</strong>ï¼Œæ‰€ä»¥éœ€è¦å¥½å¥½è€ƒè™‘æ€ä¹ˆå®ç°æœ€çŸ­è·¯ã€‚</p>\n<p>åˆ†ä¸¤é—®æ˜¯æœ‰æç¤ºæ€§åœ¨çš„ï¼Œå¯ä»¥æƒ³åˆ° 01 BFS è§£å†³ç¬¬ä¸€ä¸ªå…³é”®å­—ï¼Œæ¯”è¾ƒå¯¹çš„æƒ³æ³•æ˜¯<strong>æŠŠæ‰€æœ‰æœ€çŸ­è·¯æ‹¿å‡ºæ¥å½¢æˆ DAGï¼Œåœ¨ DAG ä¸Šå¯¹ç¬¬äºŒå…³é”®å­— DP</strong>ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; m &gt;&gt; n;\n    std::unordered_map&lt;std::string, int&gt; tab;\n    std::vector&lt;std::vector&lt;int&gt; &gt; l(n + 1);\n    std::vector&lt;std::vector&lt;std::tuple&lt;int, int, int&gt; &gt; &gt; g0(n + 1), g1(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::string s;\n        std::cin &gt;&gt; s, tab[s] = i;\n    &#125;\n    int tot = n;\n    for (int i = 1, k; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; k;\n        int lp = 0, lq = 0;\n        for (std::string s; k--; ) &#123;\n            std::cin &gt;&gt; s;\n            int p = ++tot, q = ++tot, id = tab[s];\n            g0.emplace_back(), g0.emplace_back();\n            g1.emplace_back(), g1.emplace_back();\n            if (lp) &#123;\n                g0[p].emplace_back(lp, 0, 1), g0[lq].emplace_back(q, 0, 1);\n                g1[lp].emplace_back(p, 0, 1), g1[q].emplace_back(lq, 0, 1);\n            &#125;\n            g0[p].emplace_back(id, 0, 0), g0[id].emplace_back(p, 1, 0);\n            g1[id].emplace_back(p, 0, 0), g1[p].emplace_back(id, 1, 0);\n            g0[q].emplace_back(id, 0, 0), g0[id].emplace_back(q, 1, 0);\n            g1[id].emplace_back(q, 0, 0), g1[q].emplace_back(id, 1, 0);\n            l[id].push_back(p), l[id].push_back(q);\n            lp = p, lq = q;\n        &#125;\n    &#125;\n    int s, t;\n    &#123;\n        std::string s1, s2;\n        std::cin &gt;&gt; s1 &gt;&gt; s2;\n        s = ++tot, t = tab[s2];\n        g0.emplace_back(), g1.emplace_back();\n        int p = tab[s1];\n        for (auto i : l[p])\n            g0[s].emplace_back(i, 1, 0), g1[i].emplace_back(s, 1, 0);\n    &#125;\n    std::vector&lt;int&gt; dis0(tot + 1, 0x3f3f3f3f), dis1(tot + 1, 0x3f3f3f3f);\n    auto BFS = [&amp;](decltype(g0) &amp;g, decltype(dis0) &amp;dis, int s) &#123;\n        std::deque&lt;int&gt; q;\n        std::vector&lt;int&gt; vis(tot + 1);\n        q.push_back(s), dis[s] = 0;\n        for (; !q.empty(); ) &#123;\n            int x = q.front();\n            q.pop_front();\n            if (vis[x])\n                continue;\n            vis[x] = 1;\n            for (auto [v, w1, w2] : g[x])\n                if (dis[x] + w1 &lt; dis[v]) &#123;\n                    dis[v] = dis[x] + w1;\n                    if (w1 == 0)\n                        q.push_front(v);\n                    else\n                        q.push_back(v);\n                &#125;\n        &#125;\n        return;\n    &#125;;\n    BFS(g0, dis0, s), BFS(g1, dis1, t);\n    std::cout &lt;&lt; dis0[t] &lt;&lt; &#39;\\n&#39;;\n    std::vector&lt;int&gt; deg(tot + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(tot + 1);\n    for (int i = 1; i &lt;= tot; ++i)\n        for (auto [j, w1, w2] : g0[i])\n            if (dis0[i] + dis1[j] + w1 == dis0[t])\n                g[i].emplace_back(j, w2), ++deg[j];\n    std::queue&lt;int&gt; q;\n    for (int i = 1; i &lt;= tot; ++i)\n        if (!deg[i])\n            q.push(i);\n    std::vector&lt;int&gt; f(tot + 1);\n    for (; !q.empty(); ) &#123;\n        int x = q.front();\n        q.pop();\n        for (auto [v, w] : g[x]) &#123;\n            f[v] = std::max(f[v], f[x] + w);\n            if (!--deg[v])\n                q.push(v);\n        &#125;\n    &#125;\n    std::cout &lt;&lt; f[t] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---droga-do-domu\">C - Droga do domu</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P9402\" class=\"uri\">https://www.luogu.com.cn/problem/P9402</a></p>\n<ul>\n<li>è¿˜æ˜¯åšä¸€ä¸ªå’Œä¸Šä¸€é¢˜ç±»ä¼¼çš„ä¼˜åŒ–å»ºå›¾</li>\n<li>æ­¤å¤–å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ Dij ä¸Š DP äº†ã€‚<strong>å›¾æ²¡æœ‰ç¯</strong>ï¼Œç›´æ¥æ‹“æ‰‘å³å¯ã€‚</li>\n<li>å¯ä»¥æ»šåŠ¨ä¼˜åŒ–ç©ºé—´ï¼Œä½†ä¼¼ä¹å¹¶æ— å¿…è¦ã€‚ä»£ç ç•¥ã€‚</li>\n</ul>\n<hr />\n<h2 id=\"d---tickets-p\">D - Tickets P</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7984\" class=\"uri\">https://www.luogu.com.cn/problem/P7984</a></p>\n<ul>\n<li>æ²¡ä»€ä¹ˆå¥½è¯´çš„çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾ï¼Œéš¾ç‚¹åœ¨äºå¦‚ä½•åŒæ—¶è·å– <span class=\"math inline\">\\(1\\)</span> å’Œ <span class=\"math inline\">\\(N\\)</span> çš„ä¿¡æ¯</li>\n<li><p>å‘ç°ä»æŸä¸ªç‚¹èµ°åˆ° <span class=\"math inline\">\\(1\\)</span> å’Œ <span class=\"math inline\">\\(N\\)</span>ï¼Œæœ‰ä¸€ç§ä¸åŠ£çš„èµ°æ³•ï¼š</p>\n<img src=\"image.png\" /></li>\n<li><p>ç»´æŠ¤ä¸€ä¸‹æ¯ä¸ªç‚¹å•ç‹¬èµ°åˆ° <span class=\"math inline\">\\(1\\)</span>ï¼Œ<span class=\"math inline\">\\(N\\)</span> çš„æœ€å°ä»£ä»·å’ŒåŒæ—¶èµ°åˆ° <span class=\"math inline\">\\(1,N\\)</span> çš„æœ€å°ä»£ä»·</p>\nçœ‹åˆ°ä¸€ç§æ›´åŠ å¯¹çš„å†™æ³•æ˜¯<strong>ä»¤ <span class=\"math inline\">\\(f_u\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(v\\)</span> çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆå¯ä»¥ç”¨ <span class=\"math inline\">\\(f_v+w(u,v)\\)</span> æ›´æ–° <span class=\"math inline\">\\(f_u\\)</span></strong>ã€‚</li>\n<li><p>é‚£ä¹ˆå¯ä»¥ä» <span class=\"math inline\">\\(1,N\\)</span> å‡ºå‘åšä¸€ä¸ª Dijã€‚ä»£ç ç•¥ã€‚</p></li>\n</ul>\n<hr />\n<h2 id=\"e---ç›‘ç‹±\">E - ç›‘ç‹±</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P9520\" class=\"uri\">https://www.luogu.com.cn/problem/P9520</a></p>\n<ul>\n<li><p>æ³¨æ„è¦èµ°ç®€å•è·¯å¾„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨ç»•è·¯è®©é“çš„å¯èƒ½æ€§ã€‚å®¹æ˜“æ¨å‡ºï¼šè‹¥è¾“å…¥åˆæ³•ï¼Œæ€»èƒ½æ‰¾åˆ°ä¸€ç§æ–¹å¼ä½¿å¾—æ¯ä¸ªäººå—åˆ°çš„æŒ‡ä»¤æ˜¯è¿ç»­ç»™å‡ºçš„ã€‚</p>\n<p>P.S. è¿™ä¸ªç»“è®ºæŒªåˆ°å›¾ä¸Šå°±ä¸æˆç«‹äº†ï¼Œå¾ˆå®¹æ˜“ä¸¾å‡ºåä¾‹ã€‚</p>\n<p><img src=\"image-1.png\" /></p></li>\n<li>è‹¥ä¸€ä¸ªäººçš„èµ·ç‚¹ / ç»ˆç‚¹åœ¨å¦ä¸€ä¸ªäººçš„è·¯å¾„ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªäººä¹‹é—´å­˜åœ¨å…ˆåå…³ç³»ã€‚å»ºå›¾åæ£€æŸ¥æ˜¯å¦ä¸º DAG å³å¯ã€‚</li>\n<li><p>ä½†å»ºå›¾æ˜¾ç„¶æ˜¯æ¯”è¾ƒå›°éš¾çš„ï¼Œå®¹æ˜“æ„é€ å‡ºæ•°æ®ä½¿å¾—è¾¹æ•°æ¥åˆ° <span class=\"math inline\">\\(n^2\\)</span> çº§åˆ«ã€‚è€ƒè™‘ä¼˜åŒ–å»ºå›¾ã€‚</p>\n<p>å‘ç°å¯ä»¥ç”¨ä¸€ä¸ªæ ‘å‰– / å€å¢çš„ç»“æ„æ¥å»ºå›¾ã€‚</p>\nTipsï¼šè¿™ä¸€ç‚¹åŒæ ·æ˜¯ä¸€ä¸ªæ ‘ä¸Šè·¯å¾„é—®é¢˜ã€‚å‚è§ <a href=\"/20231117/#æ ‘ä¸Šé—®é¢˜\">æ ‘ä¸Šé—®é¢˜ï¼Œå€å¢å’Œæ ‘å‰–çš„é€‰æ‹©ï¼Ÿ</a></li>\n<li><p>è¿™é‡Œçš„è·¯å¾„è¦æ±‚ä¸¤ç«¯éƒ½æ˜¯å¼€çš„ï¼Œè¿™å°±å¯¼è‡´å€å¢å†™ç€å¾ˆå›°éš¾ï¼ˆè™½ç„¶æ ‘å‰–å¯èƒ½ä¹Ÿæ˜¯ï¼‰ï¼Œä¸æ’é™¤æˆ‘å†™ä¸‘äº†</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int K = 19;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;01-02.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n, m;\n        std::cin &gt;&gt; n;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n        std::vector&lt;int&gt; s(n + 1), t(n + 1);\n        for (int i = 1, x, y; i &lt; n; ++i) &#123;\n            std::cin &gt;&gt; x &gt;&gt; y;\n            g1[x].push_back(y), g1[y].push_back(x);\n        &#125;\n        std::cin &gt;&gt; m;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g(m + 1);\n        std::vector&lt;std::pair&lt;int, int&gt; &gt; a(m + 1);\n        for (int i = 1; i &lt;= m; ++i) &#123;\n            std::cin &gt;&gt; a[i].first &gt;&gt; a[i].second;\n            s[a[i].first] = i;\n            t[a[i].second] = i;\n        &#125;\n        int cnt = m;\n        struct node &#123; int fa, i0, i1; &#125;;\n        std::vector&lt;std::array&lt;node, K + 1&gt; &gt; p(n + 1);\n        std::vector&lt;int&gt; i0(n + 1), i1(n + 1), dep(n + 1), deg(m + 1);\n        auto init = [&amp;](void) &#123;\n            g.emplace_back(), deg.emplace_back();\n            return ++cnt;\n        &#125;;\n        auto add = [&amp;](int x, int y) &#123;\n            g[x].push_back(y), ++deg[y];\n            return;\n        &#125;;\n        for (int i = 1; i &lt;= n; ++i)\n            i0[i] = init(), i1[i] = init();\n        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n            if (s[x])\n                add(s[x], i1[x]);\n            if (t[x])\n                add(i0[x], t[x]);\n            for (auto i : g1[x])\n                if (i != fa) &#123;\n                    dep[i] = dep[x] + 1;\n                    p[i][0].fa = x;\n                    p[i][0].i0 = init(), p[i][0].i1 = init();\n                    add(p[i][0].i0, i0[i]), add(i1[i], p[i][0].i1);\n                    for (int j = 1; j &lt;= K; ++j) &#123;\n                        p[i][j].fa = p[p[i][j - 1].fa][j - 1].fa;\n                        if (!p[i][j].fa)\n                            break;\n                        p[i][j].i0 = init(), p[i][j].i1 = init();\n                        add(p[i][j].i0, p[i][j - 1].i0);\n                        add(p[i][j].i0, p[p[i][j - 1].fa][j - 1].i0);\n                        add(p[i][j - 1].i1, p[i][j].i1);\n                        add(p[p[i][j - 1].fa][j - 1].i1, p[i][j].i1);\n                    &#125;\n                    DFS(i, x);\n                &#125;\n            return;\n        &#125;;\n        dep[1] = 1, DFS(1, -1);\n        for (int i = 1; i &lt;= m; ++i) &#123;\n            auto [x, y] = a[i];\n            if (x == y)\n                continue;\n            if (t[x])\n                add(i, t[x]);\n            if (s[y])\n                add(s[y], i);\n            if (dep[x] &lt; dep[y])\n                std::swap(x, y);\n            x = p[x][0].fa;\n            if (dep[x] &gt;= dep[y]) &#123;\n                for (int j = K; ~j; --j)\n                    if (dep[p[x][j].fa] &gt;= dep[y]) &#123;\n                        add(i, p[x][j].i0), add(p[x][j].i1, i);\n                        x = p[x][j].fa;\n                    &#125;\n                if (x == y)\n                    continue;\n                add(i, p[x][0].i0), add(p[x][0].i1, i);\n                x = p[x][0].fa;\n            &#125;\n            y = p[y][0].fa;\n            if (x != y) &#123;\n                for (int j = K; ~j; --j)\n                    if (p[x][j].fa != p[y][j].fa) &#123;\n                        add(i, p[x][j].i0), add(i, p[y][j].i0);\n                        add(p[x][j].i1, i), add(p[y][j].i1, i);\n                        x = p[x][j].fa, y = p[y][j].fa;\n                    &#125;\n                add(i, p[x][0].i0), add(i, p[y][0].i0);\n                add(p[x][0].i1, i), add(p[y][0].i1, i);\n                x = p[x][0].fa;\n            &#125;\n            add(i, i0[x]), add(i1[x], i);\n        &#125;\n        std::queue&lt;int&gt; q;\n        for (int i = 1; i &lt;= cnt; ++i)\n            if (!deg[i])\n                q.push(i);\n        int tot = 0;\n        for (; !q.empty(); ) &#123;\n            int x = q.front();\n            q.pop(), ++tot;\n            for (auto i : g[x])\n                if (!--deg[i])\n                    q.push(i);\n        &#125;\n        std::cout &lt;&lt; (tot == cnt ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "DP",
                "äºŒåˆ†",
                "å€å¢",
                "è°ƒæ•´æ³•",
                "æœ€çŸ­è·¯"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250922/",
            "url": "https://xsc062.netlify.app/20250922/",
            "title": "æ‚é¢˜",
            "date_published": "2025-09-22T10:37:38.000Z",
            "content_html": "<p>æœ€è¿‘çš„å‡ åœº abc, arc, cf, æ¨¡æ‹Ÿèµ›é¢˜</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"g---set-list\">G - Set list</h2>\n<p><a href=\"https://atcoder.jp/contests/abc424/tasks/abc424_g\" class=\"uri\">https://atcoder.jp/contests/abc424/tasks/abc424_g</a></p>\n<hr />\n<h2 id=\"b---slime-swap\">B - Slime Swap</h2>\n<p><a href=\"https://atcoder.jp/contests/arc206/tasks/arc206_b\" class=\"uri\">https://atcoder.jp/contests/arc206/tasks/arc206_b</a></p>\n<hr />\n<h2 id=\"d---lis-lds\">D - LIS âˆ© LDS</h2>\n<p><a href=\"https://atcoder.jp/contests/arc206/tasks/arc206_d\" class=\"uri\">https://atcoder.jp/contests/arc206/tasks/arc206_d</a></p>\n<hr />\n<h2 id=\"bubble-sort\">#3761. Bubble Sort</h2>\n<p><a href=\"http://poj.org/problem?id=3761\" class=\"uri\">http://poj.org/problem?id=3761</a></p>\n<hr />\n<h2 id=\"f.-bubble-sort\">F. Bubble Sort</h2>\n<p><a href=\"https://codeforces.com/contest/2146/problem/F\" class=\"uri\">https://codeforces.com/contest/2146/problem/F</a></p>\n<hr />\n<h2 id=\"e.-limited-edition-shop\">E. Limited Edition Shop</h2>\n<p><a href=\"https://codeforces.com/contest/2151/problem/E\" class=\"uri\">https://codeforces.com/contest/2151/problem/E</a></p>\n<ul>\n<li>æ„é€ å‡ ä¸ª <span class=\"math inline\">\\(n=2,3\\)</span> çš„ä¾‹å­æ‰‹ç©ä¸€ä¸‹ï¼Œä¼šå‘ç°å¯¹äº <span class=\"math inline\">\\(a,b\\)</span> ä¸¤ä¸ªå…ƒç´ ï¼Œå¦‚æœåœ¨ A é‡Œçš„ç›¸å¯¹é¡ºåºæ˜¯ abï¼Œåœ¨ B é‡Œçš„ç›¸å¯¹é¡ºåºæ˜¯ baï¼Œé‚£ä¹ˆè¦é€‰ b å°±å¿…é¡»é€‰ aã€‚</li>\n<li>é‚£ä¹ˆä¼šæƒ³åˆ°æŠŠ A å˜æˆ <span class=\"math inline\">\\(1\\sim n\\)</span>ï¼Œé‚£ä¹ˆå¯¹äº B ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœå…¶åæ–¹æœ‰æ›´å°çš„å…ƒç´ ï¼Œé‚£ä¹ˆå¿…é¡»é€‰äº†å®ƒæ‰èƒ½é€‰è¿™ä¸ªæ•°ã€‚</li>\n<li>è€ƒè™‘åœ¨ B ä¸­ DP æœ€åé€‰å‡ºæ¥çš„é›†åˆï¼Œé‚£ä¹ˆå¯¹äºå½“å‰çš„ <span class=\"math inline\">\\(x\\)</span>ï¼Œ<strong>è‹¥ä¸é€‰ï¼Œåˆ™ä¸å…è®¸ã€å·²é€‰é›†åˆã€ä¸­å­˜åœ¨ <span class=\"math inline\">\\(&gt;x\\)</span> çš„æ•°ã€‚</strong></li>\n<li><p>æ•…ä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤º DP åˆ° <span class=\"math inline\">\\(i\\)</span>ï¼Œå½“å‰å·²é€‰é›†åˆæœ€å¤§å€¼ä¸º <span class=\"math inline\">\\(j\\)</span> çš„æœ€å¤§é›†åˆå¤§å°ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{i,B_i}\\gets f_{i-1,j}+v, j&lt;B_i\\\\\nf_{i,j}\\gets f_{i-1, j}+v, j &gt; B_i\\\\\nf_{i,j}\\gets f_{i-1,j}, j &lt; B_i\n\\]</span></p></li>\n<li><p>æ˜¾ç„¶å¯ä»¥çº¿æ®µæ ‘ä¼˜åŒ–è½¬ç§»</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e5 + 5;\nconst long long inf = 1e18;\nstruct &#123;\n    int l, r;\n    long long u, d;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid pushval(int p, long long v) &#123;\n    t[p].d += v, t[p].u += v;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    pushval(lt, t[p].d), pushval(rt, t[p].d);\n    t[p].d = 0ll;\n    return;\n&#125;\nvoid pushup(int p) &#123;\n    t[p].u = std::max(t[lt].u, t[rt].u);\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    t[p].u = -inf, t[p].d = 0ll;\n    if (l == r)\n        return;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid upd(int p, int x, long long v) &#123;\n    t[p].u = std::max(t[p].u, v);\n    if (t[p].l == t[p].r)\n        return;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        upd(lt, x, v);\n    else\n        upd(rt, x, v);\n    return;\n&#125;\nvoid add(int p, int l, int r, long long v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        pushval(p, v);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    pushup(p);\n    return;\n&#125;\nlong long ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].u;\n    pushdown(p);\n    long long res = -inf;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        res = ask(lt, l, r);\n    if (r &gt; mid)\n        res = std::max(res, ask(rt, l, r));\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n;\n        std::cin &gt;&gt; n;\n        std::vector&lt;int&gt; w(n + 1), k(n + 1), a(n + 1), b(n + 1), tab(n + 1);\n        for (int i = 1; i &lt;= n; ++i)\n            std::cin &gt;&gt; w[i];\n        for (int i = 1; i &lt;= n; ++i)\n            std::cin &gt;&gt; a[i], tab[a[i]] = i;\n        for (int i = 1; i &lt;= n; ++i)\n            k[i] = w[a[i]];\n        for (int i = 1; i &lt;= n; ++i)\n            std::cin &gt;&gt; b[i], b[i] = tab[b[i]];\n        bld(1, 0, n), upd(1, 0, 0);\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            if (b[i] != n)\n                add(1, b[i] + 1, n, k[b[i]]);\n            upd(1, b[i], ask(1, 0, b[i] - 1) + k[b[i]]);\n        &#125;\n        std::cout &lt;&lt; t[1].u &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a.-å°çŒªç›–æˆ¿å­\">A. å°çŒªç›–æˆ¿å­</h2>\n<p><a href=\"http://222.180.160.110:61235/problem/51898\" class=\"uri\">http://222.180.160.110:61235/problem/51898</a></p>\n<blockquote>\n<p>ç»™å®šä¸€ä¸ª <span class=\"math inline\">\\(n\\times m\\)</span> çš„ 01 çŸ©é˜µï¼Œæ¯ä¸€è¡Œæœ‰ 2 ä¸ª 1 æˆ–æ²¡æœ‰ 1ã€‚ç°éœ€é€‰æ‹©ä¸¤ä¸ª<strong>ç›¸é‚»çš„</strong>è¡ŒåŒºé—´ï¼Œå¹¶ä¸º<strong>èŒƒå›´å†…çš„ç©ºè¡Œ</strong>é€‰æ‹©ä¸¤ä¸ªä½ç½®æ”¹ä¸º 1ï¼Œä½¿å¾—è¿™ä¸¤ä¸ªåŒºé—´æ˜¯å…¨ç­‰çš„ã€‚</p>\n<p>æ±‚å¯èƒ½çš„æ–¹æ¡ˆã€‚å½“ç©ºè¡Œçš„æ¶‚è‰²æ–¹å¼ä¸åŒæˆ–é€‰æ‹©èŒƒå›´ä¸åŒçœ‹ä½œä¸åŒçš„æ–¹æ¡ˆã€‚å¯¹ <span class=\"math inline\">\\(998244353\\)</span> å–æ¨¡ã€‚</p>\n<p><span class=\"math inline\">\\(n,m\\le 5000\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>ç¬¬ä¸€ååº”æ˜¯æšä¸¾åˆ†ç•Œçº¿ + ä¸Šç«¯ç‚¹ï¼Œå‘ç°æ²¡æœ‰åŠæ³•åšï¼šå½“ä¸Šç«¯ç‚¹ç§»åŠ¨çš„æ—¶å€™ï¼Œä¸‹éƒ¨çŸ©å½¢ä¼šæ•´ä½“å¹³ç§»ã€‚</li>\n<li><strong>è¿›ä¸€æ­¥è€ƒè™‘å¯¼è‡´è¿™ä¸ªé—®é¢˜çš„åŸå› </strong>ï¼Œæ„Ÿå—åˆ°ä¸€ä¸ªå› ç´ æ˜¯é•¿åº¦åœ¨å˜ã€‚</li>\n<li>æ•…å›ºå®šé•¿åº¦æšä¸¾ï¼Œå‰ç¼€å’Œç»Ÿè®¡ <span class=\"math inline\">\\(\\dfrac {m(m-1)}2\\)</span> çš„å¹‚æ¬¡å³å¯ã€‚</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n    std::freopen(&quot;piggy.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;piggy.out&quot;, &quot;w&quot;, stdout);\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    const auto stime = std::chrono::steady_clock::now();\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;std::array&lt;int, 2&gt; &gt; a(n + 1);\n    std::vector&lt;long long&gt; ps(n + 1);\n    const int s = m * (m - 1) / 2;\n    ps[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i][0] &gt;&gt; a[i][1];\n        ps[i] = ps[i - 1] * s % mod;\n    &#125;\n    auto res = 0ll;\n    for (int i = 1; i &lt;= n / 2; ++i) &#123;\n        std::vector&lt;int&gt; cnt0(n + 1), cnts(n + 1);\n        for (int u = 1; u &lt;= n - i; ++u) &#123;\n            int d = u + i;\n            if (!a[u][0] &amp;&amp; !a[d][0])\n                cnts[u] = 1;\n            else if (a[u][0] &amp;&amp; a[d][0] &amp;&amp; (a[u][0] != a[d][0] || a[u][1] != a[d][1]))\n                cnt0[u] = 1;\n            cnts[u] += cnts[u - 1], cnt0[u] += cnt0[u - 1];\n        &#125;\n        for (int u = 1; u &lt;= n - 2 * i + 1; ++u) &#123;\n            int ss = cnts[u + i - 1] - cnts[u - 1], s0 = cnt0[u + i - 1] - cnt0[u - 1];\n            if (!s0)\n                (res += ps[ss] % mod) %= mod;\n        &#125;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b.-æ¢ä¹˜æ—…è¡Œ\">B. æ¢ä¹˜æ—…è¡Œ</h2>\n<p><a href=\"http://222.180.160.110:61235/problem/51900\" class=\"uri\">http://222.180.160.110:61235/problem/51900</a></p>\n<ul>\n<li>æ‰‹ç©å¯ä»¥å‘ç°ã€ç¯ã€åœ¨é¢˜ç›®ä¸­æ˜¯ä¸€ä¸ªå¾ˆé‡è¦çš„ä¸œè¥¿</li>\n<li>é‡è¦æ€§è´¨ï¼šè€ƒè™‘ä¸€ä¸ªç¯ç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„ç‚¹ï¼Œä¸€å®šä¼šä»è¿™ä¸ªç‚¹å‡ºå‘æŠŠè¿™ä¸ªç¯è®¿é—®ä¸€éï¼Œåè¯æ³•æ˜“è¯ã€‚</li>\n<li><p>æ•…å¯ä»¥æŠŠæ¯ä¸ªç¯ç»™ã€åˆ é™¤ã€ã€‚å¯ä»¥ç”¨ä¸‹å›¾æ¦‚æ‹¬æ‰€æœ‰æƒ…å†µã€‚</p>\n<p><img src=\"image.png\" /></p>\n<p>å‡è®¾å½“å‰ä»¥ <span class=\"math inline\">\\(s\\)</span> ä¸ºèµ·ç‚¹ï¼Œç»ˆç‚¹ä¸º <span class=\"math inline\">\\(t\\)</span>ï¼Œä¸”ä¹‹å‰å·²ç»åœ¨ä»¥ <span class=\"math inline\">\\(s&#39;\\)</span> ä¸ºèµ·ç‚¹æ—¶è®¿é—®è¿‡äº†ä¸€éƒ¨åˆ†è·¯å¾„ä¸Šçš„ç‚¹ã€‚</p>\n<p>é‚£ä¹ˆæ­¤æ—¶ <span class=\"math inline\">\\(m\\to t\\)</span> æ˜¯æœ‰ç­”æ¡ˆçš„ï¼Œè€Œ <span class=\"math inline\">\\(s\\to m\\)</span> éƒ½å¯ä»¥ç»§æ‰¿ <span class=\"math inline\">\\(m\\)</span> çš„ç­”æ¡ˆã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::freopen(&quot;travel.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;travel.out&quot;, &quot;w&quot;, stdout);\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    std::vector&lt;std::vector&lt;int&gt;::iterator&gt; it(n + 1);\n    for (int i = 1, k; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; k;\n        for (int x; k--; )\n            std::cin &gt;&gt; x, g[i].push_back(x);\n        it[i] = g[i].begin();\n    &#125;\n    std::vector&lt;int&gt; res(n + 1), inq(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        if (!res[i]) &#123;\n            std::stack&lt;int&gt; st;\n            for (int x = i; ; ) &#123;\n                if (it[x] == g[x].end() || res[x]) &#123;\n                    if (!res[x])\n                        res[x] = x;\n                    res[i] = res[x];\n                    for (; !st.empty(); st.pop())\n                        res[st.top()] = res[x], inq[st.top()] = 0;\n                    break;\n                &#125;\n                st.push(x), inq[x] = 1, x = *it[x];\n                if (inq[x])\n                    for (int p = -1; p != x; ) &#123;\n                        p = st.top(), st.pop();\n                        inq[p] = 0, ++it[p];\n                    &#125;\n            &#125;\n        &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": []
        },
        {
            "id": "https://xsc062.netlify.app/20250921/",
            "url": "https://xsc062.netlify.app/20250921/",
            "title": "çº¿æ®µæ ‘æ‚é¢˜",
            "date_published": "2025-09-21T08:44:54.000Z",
            "content_html": "<p>ä¿¡æ¯è½¬åŒ–ä¸ºä¸»</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"b---into-blocks-hard-version\">B - Into Blocks (hard version)</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1209G2\" class=\"uri\">https://www.luogu.com.cn/problem/CF1209G2</a></p>\n<ul>\n<li>trickï¼šè€ƒå¯Ÿæ¯ä¸ªé¢œè‰²å‡ºç°çš„åŒºé—´ <span class=\"math inline\">\\([s_{col},t_{col}]\\)</span>ï¼Œå¯¹æ¯ä¸ª <span class=\"math inline\">\\([s_{col},t_{col})\\)</span> æ‰“æ ‡è®°ï¼Œåˆ™æ²¡æœ‰è¢«æ‰“è¿‡æ ‡è®°çš„ç‚¹åèƒ½å¤Ÿè¿›è¡Œä¸€æ¬¡åˆ†æ®µã€‚</li>\n<li><p>å¯¹äºæ¯ä¸€æ®µï¼Œå…¶ä»£ä»·ä¸ºæ®µé•¿åº¦ - ä¼—æ•°å‡ºç°æ¬¡æ•°ã€‚</p>\nè¿™ä¸ªä¼—æ•°ä¹ä¸€çœ‹æœ‰ç‚¹å“äººï¼Œå®é™…ä¸Šå‘ç°ç”±äºæ¯ä¸ªå…ƒç´ å‡ºç°çš„æ‰€æœ‰ä½ç½®éƒ½åœ¨è¿™ä¸ªæ®µé‡Œï¼Œæ‰€ä»¥å¯ä»¥è®°å½•æ¯ä¸ªå…ƒç´ çš„ä¸ªæ•°ï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ åªé’¦å®šå…¶ä¸­ä¸€ä¸ªä½ç½®æ¥è®°å½•å³å¯å¿«é€Ÿç»´æŠ¤ã€‚</li>\n<li>å‘ç°çº¿æ®µæ ‘èƒ½å¤Ÿæ¯”è¾ƒå®¹æ˜“åœ°ç»´æŠ¤å…¨å±€æŸ¥è¯¢ï¼šç»´æŠ¤ <span class=\"math inline\">\\(0\\)</span> ä½ç½®æ˜¯ç»å…¸ trickï¼›ä¸”å®¹æ˜“å‘ç°ã€æ®µé•¿ã€ä¹‹å’Œä¸º <span class=\"math inline\">\\(n\\)</span>ï¼Œæ•…åªéœ€ç»´æŠ¤ä¼—æ•°ã€‚</li>\n<li><p>å®ç°æŠ€å·§ï¼šå•ç‚¹æœ¬èº«å°±æ˜¯è‡ªå·±çš„æœ€å°å€¼ï¼Œä»è¿™ä¸€ç‚¹å‡ºå‘å¯ä»¥è§„é¿å¾ˆå¤šè¾¹ç•Œæƒ…å†µã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int lim = 2e5;\nconst int maxn = 2e5 + 5;\nstruct node &#123;\n    int l, r, u, d;\n    int lu, ru, mn, mx;\n    node operator+ (const node &amp;q) const &#123;\n        node res;\n        res.d = 0;\n        res.l = l, res.r = q.r;\n        res.mx = std::max(mx, q.mx);\n        res.mn = std::min(mn, q.mn);\n        if (mn &lt; q.mn) &#123;\n            res.mn = mn, res.u = u;\n            res.lu = lu, res.ru = std::max(q.mx, ru);\n        &#125;\n        else if (q.mn &lt; mn) &#123;\n            res.mn = q.mn, res.u = q.u;\n            res.lu = std::max(mx, q.lu), res.ru = q.ru;\n        &#125;\n        else &#123;\n            res.lu = lu, res.ru = q.ru;\n            res.u = u + q.u + std::max(ru, q.lu);\n        &#125;\n        return res;\n    &#125;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid pushval(int p, int d) &#123;\n    t[p].mn += d, t[p].d += d;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    pushval(lt, t[p].d), pushval(rt, t[p].d);\n    t[p].d = 0;\n    return;\n&#125;\nvoid upd(int p, int x, int v) &#123;\n    if (t[p].l == t[p].r) &#123;\n        t[p].u = t[p].mx = v;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        upd(lt, x, v);\n    else\n        upd(rt, x, v);\n    t[p] = t[lt] + t[rt];\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        pushval(p, v);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    t[p] = t[lt] + t[rt];\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, q;\n    std::cin &gt;&gt; n &gt;&gt; q;\n    std::vector&lt;int&gt; a(n + 1);\n    std::vector&lt;std::set&lt;int&gt; &gt; st(lim + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        st[a[i]].emplace(i);\n    &#125;\n    bld(1, 1, n);\n    for (int i = 1; i &lt;= lim; ++i)\n        if (!st[i].empty()) &#123;\n            int s = *st[i].begin(), t = *--st[i].end();\n            if (s &lt;= t - 1)\n                add(1, s, t - 1, 1);\n            upd(1, s, (int)st[i].size());\n        &#125;\n    std::cout &lt;&lt; n - ::t[1].u - ::t[1].lu - ::t[1].ru  &lt;&lt; &#39;\\n&#39;;\n    auto work = [&amp;](int v, int k) &#123;\n        if (st[v].empty())\n            return;\n        int s = *st[v].begin(), t = *--st[v].end();\n        if (s &lt;= t - 1)\n            add(1, s, t - 1, k);\n        upd(1, s, k == 1 ? (int)st[v].size() : 0);\n        return;\n    &#125;;\n    for (int i, x; q--; ) &#123;\n        std::cin &gt;&gt; i &gt;&gt; x;\n        work(a[i], -1), st[a[i]].erase(i), work(a[i], 1);\n        a[i] = x;\n        work(a[i], -1), st[a[i]].insert(i), work(a[i], 1);\n        std::cout &lt;&lt; n - ::t[1].u - ::t[1].lu - ::t[1].ru  &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---seats-æ’åº§ä½\">C - seats æ’åº§ä½</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P4898\" class=\"uri\">https://www.luogu.com.cn/problem/P4898</a></p>\n<p>å¾ˆæœ‰ä»·å€¼çš„ä¸€ä¸ªé¢˜</p>\n<ul>\n<li><p>å¯¹äºä¸€ä¸ªå›ºå®šçš„ <span class=\"math inline\">\\(k\\)</span>ï¼Œè€ƒè™‘æ€ä¹ˆåˆ»ç”»åˆæ³•çŸ©å½¢</p>\n<p>å‘ç°ã€å‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªå…ƒç´ æ„æˆçŸ©å½¢ã€æ¯”ã€å¤§å°ä¸º <span class=\"math inline\">\\(k\\)</span> çš„çŸ©å½¢åŒ…å«å‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªå…ƒç´ ã€æ›´åˆç†</p></li>\n<li><p>è€ƒè™‘å‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªå…ƒç´ åœ¨æ»¡è¶³ä»€ä¹ˆæ¡ä»¶æ—¶æ„æˆçŸ©å½¢</p>\n<p>æˆ‘æœ€å¼€å§‹çš„æƒ³æ³•æ˜¯ã€è®°å½•è¿™ <span class=\"math inline\">\\(k\\)</span> ä¸ªå…ƒç´ å æ®çš„æœ€å¤§ã€æœ€å°ã€æœ€å·¦ã€æœ€å³ï¼Œå¦‚æœä¹˜èµ·æ¥ä¸º <span class=\"math inline\">\\(k\\)</span>ï¼Œé‚£ä¹ˆåˆæ³•ã€</p>\n<p>ä½†ä¼šå‘ç°è¿™ä¸ªè½¬åŒ–æ˜¯ä¸å¥½åšçš„ï¼Œæˆ–è€…è¯´å°±åˆå¾€ä¸Šé¢é‚£ä¸ªé”™è¯¯çš„åˆ¤å®šè½¬åŒ–ï¼ˆå¤§å°ä¸º <span class=\"math inline\">\\(k\\)</span> çš„çŸ©å½¢åŒ…å«å‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªå…ƒç´ ï¼‰é äº†ã€‚ä¸¤ä¸ªéƒ½æœ‰ä¸€ä¸ªå…±åŒçš„é—®é¢˜ï¼Œå°±æ˜¯è¿‡äºä¾èµ–è¿™ä¸ª <span class=\"math inline\">\\(k\\)</span>ï¼Œé™åˆ¶å¤ªå…·ä½“äº†ï¼Œå¯¼è‡´ä¸èƒ½å¾ˆå¥½åœ°åº”ç”¨åˆ°æ¯ä¸ª <span class=\"math inline\">\\(k\\)</span></p>\n<p>ç°åœ¨è¿™ä¸ªåˆ¤å®šçš„è½¬åŒ–æ¯”è¾ƒåˆç†çš„åœ°æ–¹å°±åœ¨äºï¼Œå¯¹çŸ©å½¢æœ¬èº«ä¸å­˜åœ¨çº¦æŸï¼Œåªæ˜¯è¦æ±‚æ„æˆçŸ©å½¢ã€‚è¿™æ ·å°±å…è®¸ç›´æ¥ä»å›¾å½¢å‡ºå‘ï¼Œ<strong>æ›´å¤šåœ°è€ƒè™‘æ€æ ·ç”¨å•ç‚¹ä¿¡æ¯åˆå¹¶å‡ºçŸ©å½¢ä¸å¦</strong></p></li>\n<li><p>æŠŠ <span class=\"math inline\">\\([0,k)\\)</span> æŸ“æˆé»‘è‰²ï¼Œå…¶ä»–ä¸ºç™½è‰²ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªç²—æš´ä½†ç®€å•çš„æ–¹æ³•æ¥åˆ»ç”»ã€çŸ©å½¢ã€è¿™ä¸ªè¦æ±‚ï¼š</p>\n<blockquote>\n<p>å›¾å½¢å­˜åœ¨å››ä¸ªã€è§’ã€ã€‚</p>\n</blockquote>\n<p>å†åˆ»ç”»ä¸€ä¸‹ã€è§’ã€ï¼šé»‘ç‚¹å·¦ä¸Š / å·¦ä¸‹ / å³ä¸Š / å³ä¸‹ä¸¤ä¸ªç‚¹éƒ½ä¸ºç™½ã€‚</p>\n<p><strong>å½“ç„¶è¿™æ ·æ˜¯å¾ˆè’è°¬çš„ï¼Œå› ä¸ºä¸‹å›¾æ˜¾ç„¶ä¸åªæœ‰å››ä¸ªè§’ã€‚</strong></p>\n<p><img src=\"image-1.png\" /></p>\n<p>æ‰€ä»¥æˆ‘ä»¬ä¸å¾—ä¸æŠŠä¸€ä¸ªå‡¹è§’ä¹Ÿç®—ä½œè§’ï¼Œä¸éš¾å‘ç°æŠŠä¸Šæ–¹å‡¸è§’çš„å®šä¹‰ä¸­çš„ä¸»ä½“æ¢æˆç™½ç‚¹å³å¯å®šä¹‰å‡¹è§’ã€‚</p></li>\n<li><p>ä¼˜åŒ–ï¼šç®—è´¡çŒ®</p>\n<p>ç»´æŠ¤å½“å‰æ—¶åˆ»ï¼Œæ‰€æœ‰ <span class=\"math inline\">\\(4nm\\)</span> ä¸ªè§’åœ¨ <span class=\"math inline\">\\(k\\)</span> å¤„æ˜¯å¦å­˜åœ¨</p>\n<p>æ­¤æ—¶è¦ç”¨ä¸€ä¸ªç±»ä¼¼ç»´æŠ¤ <span class=\"math inline\">\\(0\\)</span> ä¸ªæ•°çš„æ–¹æ³•æ¥ç»´æŠ¤æœ‰ <span class=\"math inline\">\\(4\\)</span> ä¸ªè§’ä¸ªæ•°çš„ <span class=\"math inline\">\\(k\\)</span> ä¸ªæ•°ã€‚</p></li>\n<li><p>è€ƒè™‘è¿™ä¹ˆä¸€ä¸ªå¯èƒ½çš„è§’ï¼š</p>\n<p><img src=\"image.png\" /></p>\n<p>å…¶å­˜åœ¨å½“ä¸”ä»…å½“ <span class=\"math inline\">\\(A\\)</span> ä¸ºé»‘ï¼Œ<span class=\"math inline\">\\(B,C\\)</span> ä¸ºç™½ï¼ˆå‡¸è§’ï¼‰ï¼Œæˆ– <span class=\"math inline\">\\(A\\)</span> ä¸ºç™½ï¼Œ<span class=\"math inline\">\\(B,C\\)</span> ä¸ºé»‘ï¼ˆå‡¹è§’ï¼‰ã€‚</p>\n<p>è€ƒå¯Ÿ <span class=\"math inline\">\\(A,B,C\\)</span> ç¬¬ä¸€æ¬¡å˜é»‘çš„æ—¶é—´ <span class=\"math inline\">\\(k_A,k_B,k_C\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(A\\)</span> èƒ½å¤Ÿå¯¹æ‰€æœ‰ <span class=\"math inline\">\\(k\\in[k_A,\\min\\{k_B,k_C\\})\\)</span> å’Œ <span class=\"math inline\">\\(k\\in[\\max\\{k_B,k_C\\},k_A)\\)</span> é€ æˆè´¡çŒ®ã€‚</p></li>\n<li>æ¯æ¬¡ä¿®æ”¹åªä¼šåš <span class=\"math inline\">\\(O(1)\\)</span> æ¬¡åŒºé—´åŠ ï¼Œæ˜¯å¯ç»´æŠ¤çš„ã€‚æ³¨æ„ä¸¤ä¸ªè¢«äº¤æ¢çš„ç‚¹å¯èƒ½ä¼šæœ‰å…¬å…±çš„ç›¸é‚»ç‚¹ï¼Œéœ€è¦ç‰¹åˆ«å¤„ç†ä¸€ä¸‹ã€‚</li>\n<li><p>è¿™ä¸ªä¸œè¥¿æœ¬è´¨ä¸Šå¯ä»¥çœ‹ä½œä¸€ä¸ª 2â¨‰2 çš„<a href=\"https://blog.csdn.net/asplh/article/details/136652197\">Soble ç®—å­</a>ï¼Œæ‰€ä»¥å¯ä»¥æŠ å‡ºæ¥ä¸€èˆ¬å®šä¹‰ä¸Šçš„è§’</p></li>\n</ul>\n<details>\n<p>non-interactive version:</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int dir[][2] = &#123; &#123; 0, -1 &#125;, &#123; 0, 1 &#125;, &#123; -1, 0 &#125;, &#123; 1, 0 &#125; &#125;;\nconst int maxn = 1e6 + 5;\nstruct node &#123;\n    int l, r, u, d, mn;\n    node operator+ (const node &amp;q) const &#123;\n        node res;\n        res.l = l, res.r = q.r, res.d = 0;\n        res.mn = std::min(mn, q.mn), res.u = 0;\n        if (mn == res.mn)\n            res.u = u;\n        if (q.mn == res.mn)\n            res.u += q.u;\n        return res;\n    &#125;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r, t[p].u = r - l + 1;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid pushval(int p, int v) &#123;\n    t[p].mn += v, t[p].d += v;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    pushval(lt, t[p].d), pushval(rt, t[p].d);\n    t[p].d = 0;\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        pushval(p, v);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    t[p] = t[lt] + t[rt];\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m, q;\n    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;\n    const int N = n * m;\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; pos(N + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; id(n + 2, std::vector&lt;int&gt; (m + 2, N + 1));\n    for (int i = 1, x, y; i &lt;= N; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y, ++x, ++y;\n        id[x][y] = i, pos[i] = &#123; x, y &#125;;\n    &#125;\n    bld(1, 1, N);\n    auto work = [&amp;](int x, int y, int k) &#123;\n        for (int i = 0; i &lt; 2; ++i)\n            for (int j = 2; j &lt; 4; ++j) &#123;\n                int x1 = x + dir[j][0], y1 = y + dir[i][1];\n                if (id[x][y] &lt; std::min(id[x1][y], id[x][y1]))\n                    add(1, id[x][y], std::min(id[x1][y], id[x][y1]) - 1, k);\n                if (std::max(id[x1][y], id[x][y1]) &lt; id[x][y])\n                    add(1, std::max(id[x1][y], id[x][y1]), id[x][y] - 1, k);\n            &#125;\n        return;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)\n        for (int j = 1; j &lt;= m; ++j)\n            work(i, j, 1);\n    for (int i1, i2; q--; ) &#123;\n        std::cin &gt;&gt; i1 &gt;&gt; i2, ++i1, ++i2;\n        auto [x1, y1] = pos[i1];\n        auto [x2, y2] = pos[i2];\n        std::set&lt;std::pair&lt;int, int&gt; &gt; st;\n        st.emplace(x1, y1);\n        for (auto [fx, fy] : dir) &#123;\n            int x = x1 + fx, y = y1 + fy;\n            if (x &gt;= 1 &amp;&amp; x &lt;= n &amp;&amp; y &gt;= 1 &amp;&amp; y &lt;= m)\n                st.emplace(x, y);\n        &#125;\n        st.emplace(x2, y2);\n        for (auto [fx, fy] : dir) &#123;\n            int x = x2 + fx, y = y2 + fy;\n            if (x &gt;= 1 &amp;&amp; x &lt;= n &amp;&amp; y &gt;= 1 &amp;&amp; y &lt;= m)\n                st.emplace(x, y);\n        &#125;\n        for (auto [x, y] : st)\n            work(x, y, -1);\n        std::swap(id[x1][y1], id[x2][y2]), std::swap(pos[i1], pos[i2]);\n        for (auto [x, y] : st)\n            work(x, y, 1);\n        std::cout &lt;&lt; t[1].u &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n<p>interactive version:</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\n#ifdef ONLINE_JUDGE\n#include &quot;seats.h&quot;\n#endif\nconst int dir[][2] = &#123; &#123; 0, -1 &#125;, &#123; 0, 1 &#125;, &#123; -1, 0 &#125;, &#123; 1, 0 &#125; &#125;;\nconst int maxn = 1e6 + 5;\nstruct node &#123;\n    int l, r, u, d, mn;\n    node operator+ (const node &amp;q) const &#123;\n        node res;\n        res.l = l, res.r = q.r, res.d = 0;\n        res.mn = std::min(mn, q.mn), res.u = 0;\n        if (mn == res.mn)\n            res.u = u;\n        if (q.mn == res.mn)\n            res.u += q.u;\n        return res;\n    &#125;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r, t[p].u = r - l + 1;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid pushval(int p, int v) &#123;\n    t[p].mn += v, t[p].d += v;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    pushval(lt, t[p].d), pushval(rt, t[p].d);\n    t[p].d = 0;\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        pushval(p, v);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    t[p] = t[lt] + t[rt];\n    return;\n&#125;\nint n, m, N;\nstd::vector&lt;std::pair&lt;int, int&gt; &gt; pos;\nstd::vector&lt;std::vector&lt;int&gt; &gt; id(n + 2, std::vector&lt;int&gt; (m + 2, N + 1));\nvoid work(int x, int y, int k) &#123;\n    for (int i = 0; i &lt; 2; ++i)\n        for (int j = 2; j &lt; 4; ++j) &#123;\n            int x1 = x + dir[j][0], y1 = y + dir[i][1];\n            if (id[x][y] &lt; std::min(id[x1][y], id[x][y1]))\n                add(1, id[x][y], std::min(id[x1][y], id[x][y1]) - 1, k);\n            if (std::max(id[x1][y], id[x][y1]) &lt; id[x][y])\n                add(1, std::max(id[x1][y], id[x][y1]), id[x][y] - 1, k);\n        &#125;\n    return;\n&#125;;\nvoid give_initial_chart(int n, int m, std::vector&lt;int&gt; R, std::vector&lt;int&gt; C) &#123;\n    ::n = n, ::m = m, N = n * m;\n    pos.resize(N + 1);\n    id.assign(n + 2, std::vector&lt;int&gt; (m + 2, N + 1));\n    for (int i = 0; i &lt; N; ++i) &#123;\n        int x = R[i] + 1, y = C[i] + 1;\n        id[x][y] = i + 1, pos[i + 1] = &#123; x, y &#125;;\n    &#125;\n    bld(1, 1, N);\n    for (int i = 1; i &lt;= n; ++i)\n        for (int j = 1; j &lt;= m; ++j)\n            work(i, j, 1);\n    return;\n&#125;\nint swap_seats(int i1, int i2) &#123;\n    ++i1, ++i2;\n    auto [x1, y1] = pos[i1];\n    auto [x2, y2] = pos[i2];\n    std::set&lt;std::pair&lt;int, int&gt; &gt; st;\n    st.emplace(x1, y1);\n    for (auto [fx, fy] : dir) &#123;\n        int x = x1 + fx, y = y1 + fy;\n        if (x &gt;= 1 &amp;&amp; x &lt;= n &amp;&amp; y &gt;= 1 &amp;&amp; y &lt;= m)\n            st.emplace(x, y);\n    &#125;\n    st.emplace(x2, y2);\n    for (auto [fx, fy] : dir) &#123;\n        int x = x2 + fx, y = y2 + fy;\n        if (x &gt;= 1 &amp;&amp; x &lt;= n &amp;&amp; y &gt;= 1 &amp;&amp; y &lt;= m)\n            st.emplace(x, y);\n    &#125;\n    for (auto [x, y] : st)\n        work(x, y, -1);\n    std::swap(id[x1][y1], id[x2][y2]), std::swap(pos[i1], pos[i2]);\n    for (auto [x, y] : st)\n        work(x, y, 1);\n    return t[1].u;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---å•æ—‹\">D - å•æ—‹</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P3721\" class=\"uri\">https://www.luogu.com.cn/problem/P3721</a></p>\n<ul>\n<li>å‘ç°ä»»æ„æ—¶åˆ»å‚ä¸æ—‹è½¬çš„éƒ½æ˜¯æœ€å€¼ï¼Œç®€å•åˆ†æå¯ä»¥å‘ç°åšçš„è¿™ä»¶äº‹æƒ…æ˜¯æŠŠæœ€å€¼ç§»åˆ°æ ¹ï¼Œå…¶ä»–ç‚¹ç›¸å¯¹å…³ç³»ä¸å˜ï¼Œè½¬åŒ–ä¸ºç»´æŠ¤æ·±åº¦</li>\n<li>è€ƒè™‘æ–°åŠ å…¥ç‚¹ï¼Œå¯ä»¥åˆ©ç”¨ BST çš„æ€§è´¨ï¼Œç›´æ¥æŸ¥è¯¢ <span class=\"math inline\">\\(x\\)</span> çš„å‰é©±ã€åç»§ï¼Œåˆ™äºŒè€…å­˜åœ¨ç¥–å­™å…³ç³»ï¼ŒæŠŠ <span class=\"math inline\">\\(x\\)</span> æ¥åœ¨çŸ®çš„ä¸‹é¢å³å¯</li>\n<li>è€ƒè™‘åšä¸€ä¸ªå…ˆåˆ å†åŠ çš„è¿‡ç¨‹ï¼Œåˆ ä¼šå½±å“å„¿å­çš„æ·±åº¦ï¼ˆæ˜¾ç„¶åªæœ‰ä¸€ä¾§å„¿å­ï¼‰ï¼ŒåŠ ä¼šå½±å“å…¨æ ‘æ·±åº¦</li>\n</ul>\n<hr />\n<h2 id=\"e---nekameleoni\">E - NEKAMELEONI</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7230\" class=\"uri\">https://www.luogu.com.cn/problem/P7230</a></p>\n",
            "tags": [
                "çº¿æ®µæ ‘"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250911/",
            "url": "https://xsc062.netlify.app/20250911/",
            "title": "å‰å¸æœº + å†å²å’Œç»ƒä¹ ",
            "date_published": "2025-09-11T09:27:05.000Z",
            "content_html": "<p>å¹¶éæ‰€æœ‰å†å²å’Œéƒ½æ˜¯å‰å¸æœº</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a---just-another-game-of-stones\">A - Just Another Game of Stones</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P9631\" class=\"uri\">https://www.luogu.com.cn/problem/P9631</a></p>\n<ul>\n<li>å‘ç°å¦‚æœé€‰å®šäº†è¿™ä¸€æ­¥å–çš„ä½ç½® <span class=\"math inline\">\\(i\\)</span>ï¼Œé‚£ä¹ˆè¦æ‹¿çš„çŸ³å­æ˜¯å®šå€¼ <span class=\"math inline\">\\(a_i-a_i\\oplus s\\)</span>ï¼Œå½“ <span class=\"math inline\">\\(a_i\\le a_i\\oplus s\\)</span> æ—¶ä¸åˆæ³•ã€‚</li>\n<li><p>å¯ä»¥ç”¨å‰å¸æœºç»´æŠ¤ä¿®æ”¹å’ŒåŒºé—´å¼‚æˆ–å’Œï¼Œé‚£ä¹ˆè¯¢é—®éœ€è¦è½¬åŒ–ã€‚</p>\nç­”æ¡ˆä¸º <span class=\"math inline\">\\(a_i&gt;a_i\\oplus s\\)</span> çš„æ¬¡æ•°ï¼Œç»“åˆ<strong>å¼‚æˆ–æ˜¯ä¸å¸¦è¿›ä½çš„åŒºé—´åŠ </strong>çš„è§‚ç‚¹ï¼Œè€ƒå¯Ÿã€åŠ æ•°ã€<span class=\"math inline\">\\(s\\)</span> çš„æœ€é«˜ä½ï¼Œå½“ä¸”ä»…å½“ <span class=\"math inline\">\\(a_i\\)</span> åœ¨è¿™ä¸€ä½ä¸º <span class=\"math inline\">\\(1\\)</span> æ—¶æœ‰è´¡çŒ®ã€‚</li>\n<li><p>æ•…å†ç»´æŠ¤ä¸€ä¸‹æ¯ä¸€ä½ä¸º <span class=\"math inline\">\\(1\\)</span> çš„ä¸ªæ•°å³å¯ã€‚å¤æ‚åº¦ <span class=\"math inline\">\\(O(q\\log n\\log V)\\)</span>ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 1 &lt;&lt; 30;\nconst int maxn = 2e5 + 5;\nstruct &#123;\n    std::array&lt;int, 30&gt; u;\n    int l, r, cnt, mn, se, d, s;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nint a[maxn];\nvoid pushup(int p) &#123;\n    if (t[lt].mn == t[rt].mn) &#123;\n        t[p].mn = t[lt].mn, t[p].cnt = t[lt].cnt + t[rt].cnt;\n        t[p].se = std::min(t[lt].se, t[rt].se);\n    &#125;\n    else if (t[lt].mn &lt; t[rt].mn) &#123;\n        t[p].mn = t[lt].mn, t[p].cnt = t[lt].cnt;\n        t[p].se = std::min(t[lt].se, t[rt].mn);\n    &#125;\n    else &#123;\n        t[p].mn = t[rt].mn, t[p].cnt = t[rt].cnt;\n        t[p].se = std::min(t[lt].mn, t[rt].se);\n    &#125;\n    t[p].s = t[lt].s ^ t[rt].s;\n    for (int i = 0; i &lt; 30; ++i)\n        t[p].u[i] = t[lt].u[i] + t[rt].u[i];\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].d = -inf;\n    t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        for (int i = 0; i &lt; 30; ++i)\n            t[p].u[i] = (a[l] &gt;&gt; i) &amp; 1;\n        t[p].s = t[p].mn = a[l], t[p].cnt = 1, t[p].se = inf;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    pushup(p);\n    return;\n&#125;\nvoid pushval(int p, int v) &#123;\n    if (v &gt; t[p].mn) &#123;\n        for (int i = 0; i &lt; 30; ++i) &#123;\n            if ((t[p].mn &gt;&gt; i) &amp; 1)\n                t[p].u[i] -= t[p].cnt;\n            if ((v &gt;&gt; i) &amp; 1)\n                t[p].u[i] += t[p].cnt;\n        &#125;\n        if (t[p].cnt &amp; 1)\n            t[p].s ^= t[p].mn ^ v;\n        t[p].mn = t[p].d = v;\n    &#125;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    if (t[p].d != -inf) &#123;\n        pushval(lt, t[p].d), pushval(rt, t[p].d);\n        t[p].d = -inf;\n    &#125;\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (t[p].mn &gt;= v)\n        return;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r &amp;&amp; v &lt; t[p].se) &#123;\n        pushval(p, v);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    pushup(p);\n    return;\n&#125;\nint askt(int p, int l, int r, int i) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].u[i];\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1, res = 0;\n    if (l &lt;= mid)\n        res = askt(lt, l, r, i);\n    if (r &gt; mid)\n        res += askt(rt, l, r, i);\n    return res;\n&#125;\nint asks(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].s;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1, res = 0;\n    if (l &lt;= mid)\n        res = asks(lt, l, r);\n    if (r &gt; mid)\n        res ^= asks(rt, l, r);\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    bld(1, 1, n);\n    for (int op, l, r, v; m--; ) &#123;\n        std::cin &gt;&gt; op &gt;&gt; l &gt;&gt; r &gt;&gt; v;\n        if (op == 1)\n            add(1, l, r, v);\n        else &#123;\n            int s = asks(1, l, r) ^ v;\n            if (s == 0) &#123;\n                std::cout &lt;&lt; 0 &lt;&lt; &#39;\\n&#39;;\n                continue;\n            &#125;\n            int t = std::__lg(s);\n            std::cout &lt;&lt; askt(1, l, r, t) + ((v &gt;&gt; t) &amp; 1) &lt;&lt; &#39;\\n&#39;;\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---prof.-pangs-sequence-c---test_90\">B - Prof.Â Pangâ€™s sequence / C - TEST_90</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P10822\" class=\"uri\">https://www.luogu.com.cn/problem/P10822</a> / <a href=\"https://www.luogu.com.cn/problem/P9990\" class=\"uri\">https://www.luogu.com.cn/problem/P9990</a></p>\n<ul>\n<li>å†å²å’Œç»´æŠ¤å­åŒºé—´é—®é¢˜æ˜¯ä¸€ä¸ªå›ºå®šçš„ trickï¼Œåªéœ€è¦å¯¹äºæ¯ä¸€ä¸ª <span class=\"math inline\">\\(r\\)</span>ï¼Œç»™åˆæ³•çš„ <span class=\"math inline\">\\(l\\)</span> åŠ ä¸€ã€‚</li>\n<li>ç¦»çº¿æ‰«æçº¿ï¼Œå¯¹äºå½“å‰å³ç«¯ç‚¹ <span class=\"math inline\">\\(r\\)</span>ï¼Œè®°å½•æ¯ç§æ•°æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® <span class=\"math inline\">\\(pos\\)</span>ã€‚ä»¤ <span class=\"math inline\">\\(r\\)</span> çš„é¢œè‰²ä¸º <code>1</code>ï¼Œä»å³åˆ°å·¦ï¼Œæ¯ç¢°åˆ°ä¸€ä¸ªæ–°çš„ <span class=\"math inline\">\\(pos\\)</span> å°±åˆ‡æ¢é¢œè‰²</li>\n<li>æ˜¾ç„¶å¯¹äºå½“å‰ <span class=\"math inline\">\\(r\\)</span>ï¼Œåº”è¯¥è¢«åŠ ä¸€çš„ <span class=\"math inline\">\\(l\\)</span> å°±æ˜¯é¢œè‰²ä¸º <code>1</code> çš„è¿™äº›ä½ç½®ã€‚</li>\n<li>è€ƒè™‘æ›´å¿«åœ°ç»´æŠ¤è¿™ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯åœ¨ <span class=\"math inline\">\\(r\\)</span> çš„é¢œè‰²å’Œ <span class=\"math inline\">\\(r-1\\)</span> ä¸åŒæ—¶å°±å¯ä»¥å¯¹ <span class=\"math inline\">\\([1,r)\\)</span> åšä¸€æ¬¡ flipï¼Œæ˜¯å¯è¡Œçš„</li>\n<li>åœ¨æ¯ä¸ª <span class=\"math inline\">\\(r\\)</span> å¤„æŸ¥è¯¢ <span class=\"math inline\">\\([l,r]\\)</span> çš„åŒºé—´å’Œå³å¯ã€‚</li>\n<li>åæ§½ï¼šå¹¶éæ‰€æœ‰å†å²å’Œéƒ½æ˜¯å‰å¸æœº</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 5e5 + 5;\nstruct &#123;\n    long long s;\n    int l, r, d0, d1, df, ds, u0, u1;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid pushup(int p) &#123;\n    t[p].u0 = t[lt].u0 + t[rt].u0;\n    t[p].u1 = t[lt].u1 + t[rt].u1;\n    return;\n&#125;\nvoid pushval(int p, long long v0, long long v1, bool f) &#123;\n    if (f) &#123;\n        t[p].df ^= 1;\n        std::swap(t[p].u0, t[p].u1);\n        std::swap(t[p].d0, t[p].d1);\n    &#125;\n    t[p].d0 += v0, t[p].d1 += v1;\n    t[p].s += t[p].u0 * v0 + t[p].u1 * v1;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    pushval(lt, t[p].d0, t[p].d1, t[p].df);\n    pushval(rt, t[p].d0, t[p].d1, t[p].df);\n    t[p].d0 = t[p].d1 = t[p].df = 0;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    t[p].u0 = r - l + 1;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid flip(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        pushval(p, 0, 0, 1);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        flip(lt, l, r);\n    if (r &gt; mid)\n        flip(rt, l, r);\n    pushup(p);\n    return;\n&#125;\nlong long ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].s;\n    pushdown(p);\n    auto res(0ll);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        res = ask(lt, l, r);\n    if (r &gt; mid)\n        res += ask(rt, l, r);\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), la(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    int m;\n    std::cin &gt;&gt; m;\n    std::vector&lt;long long&gt; res(m + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; u(n + 1);\n    for (int i = 1, l, r; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r;\n        u[r].emplace_back(l, i);\n    &#125;\n    bld(1, 1, n);\n    for (int r = 1; r &lt;= n; ++r) &#123;\n        flip(1, la[a[r]] + 1, r);\n        pushval(1, 0, 1, 0);\n        for (auto [l, id] : u[r])\n            res[id] = ask(1, l, r);\n        la[a[r]] = r;\n    &#125;\n    for (int i = 1; i &lt;= m; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---stations\">D - Stations</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1572F\" class=\"uri\">https://www.luogu.com.cn/problem/CF1572F</a></p>\n<ul>\n<li>ä¸å¤ªèƒ½ç›´æ¥ç»´æŠ¤ <span class=\"math inline\">\\(b\\)</span>ï¼Œä½†å‘ç°å¦‚æœç»´æŠ¤æ¯ä¸ª <span class=\"math inline\">\\(i\\)</span> æœ€è¿œèƒ½åˆ°è¾¾çš„ç‚¹ï¼Œå‘ç°æ¯æ¬¡æ›´æ–° <span class=\"math inline\">\\(j\\)</span> ä¼šæŠŠ <span class=\"math inline\">\\(j\\)</span> å·¦è¾¹çš„æ‰€æœ‰ç‚¹å€¼å’Œ <span class=\"math inline\">\\(j-1\\)</span> å– minã€‚</li>\n<li>å‘ç°å‰å¸æœºèƒ½å¤Ÿåœ¨å– min çš„åŒæ—¶åœ¨å¦ä¸€ä¸ªæ ‘çŠ¶æ ‘ç»„é‡Œç»´æŠ¤å·®åˆ†</li>\n<li>éœ€è¦æ³¨æ„æ›´æ–°çš„æ—¶æœºï¼Œåº”è¯¥æ˜¯æ¯æ¬¡çº¿æ®µæ ‘æ›´æ–°å‡½æ•°è®¿é—®åˆ°å®Œæ•´èŠ‚ç‚¹æ—¶ã€‚</li>\n<li>å¤æ‚åº¦ <span class=\"math inline\">\\(O(q\\log^2n)\\)</span>ã€‚ä½†çœŸçš„å—ï¼Ÿå•ç‚¹ä¿®æ”¹ä¼¼ä¹å¯¹åŠ¿èƒ½æœ‰å½±å“ï¼Ÿç„¶è€Œå¹¶ä¸ä¼šç›¸å…³åˆ†æã€‚</li>\n</ul>\n<p>çœ‹èµ·æ¥æœ‰ç‚¹æ¿€è¿›äº†ï¼Œæ²¡æƒ³åˆ°ç¡®å®æ˜¯æ­£è§£ã€‚</p>\n<details>\n<p>å¯ä»¥å‘ç°æ ‘çŠ¶æ•°ç»„åœ¨æ—¶é—´ä¸Šç¡®å®æ˜¯æœ‰ä¼˜åŠ¿çš„</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e5 + 5;\nconst int inf = 0x3f3f3f3f;\nstruct &#123;\n    int l, r, mx, se, d, cnt;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nint n;\nlong long bit[maxn][2];\nint lowbit(int x) &#123; return x &amp; -x; &#125;\nvoid add(int x, long long v) &#123;\n    for (int i = x; i &lt;= n; i += lowbit(i))\n        bit[i][0] += v, bit[i][1] += v * (x - 1);\n    return;\n&#125;\nlong long ask(int x) &#123;\n    auto res = 0ll;\n    for (int i = x; i; i -= lowbit(i))\n        res += bit[i][0] * x - bit[i][1];\n    return res;\n&#125;\nvoid pushup(int p) &#123;\n    if (t[lt].mx == t[rt].mx) &#123;\n        t[p].mx = t[lt].mx, t[p].cnt = t[lt].cnt + t[rt].cnt;\n        t[p].se = std::max(t[lt].se, t[rt].se);\n    &#125;\n    else if (t[lt].mx &gt; t[rt].mx) &#123;\n        t[p].mx = t[lt].mx, t[p].cnt = t[lt].cnt;\n        t[p].se = std::max(t[lt].se, t[rt].mx);\n    &#125;\n    else &#123;\n        t[p].mx = t[rt].mx, t[p].cnt = t[rt].cnt;\n        t[p].se = std::max(t[lt].mx, t[rt].se);\n    &#125;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].d = inf;\n    t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        add(l, 1), add(l + 1, -1);\n        t[p].mx = l, t[p].se = -1, t[p].cnt = 1;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    pushup(p);\n    return;\n&#125;\nvoid pushval(int p, int v) &#123;\n    if (v &lt;= t[p].mx)\n        t[p].mx = t[p].d = v;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    if (t[p].d != inf) &#123;\n        pushval(lt, t[p].d), pushval(rt, t[p].d);\n        t[p].d = inf;\n    &#125;\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (t[p].mx &lt;= v)\n        return;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r &amp;&amp; v &gt; t[p].se) &#123;\n        add(t[p].mx + 1, t[p].cnt);\n        add(v + 1, -t[p].cnt);\n        pushval(p, v);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    pushup(p);\n    return;\n&#125;\nvoid upd(int p, int x, int v) &#123;\n    if (t[p].l == t[p].r) &#123;\n        add(t[p].mx + 1, 1), add(v + 1, -1);\n        t[p].mx = v;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        upd(lt, x, v);\n    else\n        upd(rt, x, v);\n    pushup(p);\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    bld(1, 1, n);\n    for (int op; m--; ) &#123;\n        std::cin &gt;&gt; op;\n        if (op == 1) &#123;\n            int x, v;\n            std::cin &gt;&gt; x &gt;&gt; v;\n            if (x != 1)\n                add(1, 1, x - 1, x - 1);\n            upd(1, x, v);\n            // for (int i = 1; i &lt;= n; ++i)\n            //     std::cout &lt;&lt; ask(i) - ask(i - 1) &lt;&lt; &#39; &#39;;\n            // std::cout &lt;&lt; &#39;\\n&#39;;\n        &#125;\n        else &#123;\n            int l, r;\n            std::cin &gt;&gt; l &gt;&gt; r;\n            std::cout &lt;&lt; ask(r) - ask(l - 1) &lt;&lt; &#39;\\n&#39;;\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---luotianyi-and-the-function\">E - LuoTianyi and the Function</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1824/D\" class=\"uri\">https://codeforces.com/problemset/problem/1824/D</a></p>\n<ul>\n<li>ç”±äº <span class=\"math inline\">\\(j\\)</span> å’Œå‡½æ•°å…³è”æ›´å¼ºï¼Œè€ƒè™‘æŠŠ <span class=\"math inline\">\\(j\\)</span> è¿™ä¸€ç»´æ‰«æçº¿ + å·®åˆ†æ‰</li>\n<li>ç»å…¸å¥—è·¯ï¼Œç»´æŠ¤æ¯ä¸ª <span class=\"math inline\">\\(x\\)</span> ä»å³å‘å·¦ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® <span class=\"math inline\">\\(pos_x\\)</span></li>\n<li>æ¯æ¬¡ <span class=\"math inline\">\\(j\\)</span> ç§»åŠ¨ä¸€ä¸‹ï¼Œä¼šæ›´æ–°ä¸€æ®µåŒºé—´ï¼ˆå¯èƒ½ä¸å­˜åœ¨ï¼‰çš„ <span class=\"math inline\">\\(g\\)</span> å€¼ï¼Œå®ƒä»¬åŸæœ¬ä¸º <span class=\"math inline\">\\(pos_{a_j}\\)</span>ï¼Œéœ€è¦è¢«æ›´æ–°ä¸ºä¸‹ä¸€ä¸ª <span class=\"math inline\">\\(pos\\)</span>ã€‚</li>\n<li>è®°å½•å€¼ä¸º <span class=\"math inline\">\\(pos_x\\)</span> çš„åŒºé—´ï¼ŒåšåŒºé—´èµ‹å€¼å†å²å’Œå³å¯ã€‚</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e6 + 5;\nstruct &#123;\n    int l, r;\n    long long d1, d2, d3, u, s;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid pushup(int p) &#123;\n    t[p].u = t[lt].u + t[rt].u;\n    t[p].s = t[lt].s + t[rt].s;\n    return;\n&#125;\nvoid pushval(int p, long long d1, long long d2, long long d3) &#123;\n    t[p].s += t[p].u * d2 + d3 * (t[p].r - t[p].l + 1);\n    t[p].d3 += d3;\n    if (t[p].d1)\n        t[p].d3 += t[p].d1 * d2;\n    else\n        t[p].d2 += d2;\n    if (d1) &#123;\n        t[p].u = d1 * (t[p].r - t[p].l + 1);\n        t[p].d1 = d1;\n    &#125;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    pushval(lt, t[p].d1, t[p].d2, t[p].d3);\n    pushval(rt, t[p].d1, t[p].d2, t[p].d3);\n    t[p].d1 = t[p].d2 = t[p].d3 = 0ll;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    if (l == r)\n        return;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid upd(int p, int l, int r, long long v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        pushval(p, v, 0ll, 0ll);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        upd(lt, l, r, v);\n    if (r &gt; mid)\n        upd(rt, l, r, v);\n    pushup(p);\n    return;\n&#125;\nlong long ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].s;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    auto res = 0ll;\n    if (l &lt;= mid)\n        res = ask(lt, l, r);\n    if (r &gt; mid)\n        res += ask(rt, l, r);\n    return res;\n&#125;\nsigned main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, q;\n    std::cin &gt;&gt; n &gt;&gt; q;\n    std::vector&lt;int&gt; a(n + 1), la(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    struct query &#123; int l, r, id, k; &#125;;\n    std::vector&lt;long long&gt; res(q + 1);\n    std::vector&lt;std::vector&lt;query&gt; &gt; u(n + 1);\n    for (int i = 1, l, r, x, y; i &lt;= q; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r &gt;&gt; x &gt;&gt; y;\n        if (x != 1)\n            u[x - 1].push_back(&#123; l, r, i, -1 &#125;);\n        u[y].push_back(&#123; l, r, i, 1 &#125;);\n    &#125;\n    bld(1, 1, n);\n    std::vector&lt;int&gt; pre(n + 2), nex(n + 2), l(n + 2);\n    pre[n + 1] = 0, nex[0] = n + 1;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        int p = la[a[i]];\n        nex[pre[n + 1]] = i, pre[i] = pre[n + 1], pre[n + 1] = i, nex[i] = n + 1;\n        l[i] = i;\n        if (p != 0) &#123;\n            upd(1, l[p], p, nex[p]);\n            l[nex[p]] = l[p];\n            pre[nex[p]] = pre[p], nex[pre[p]] = nex[p];\n        &#125;\n        upd(1, i, i, i);\n        pushval(1, 0, 1, 0);\n        for (auto [l, r, id, k] : u[i])\n            res[id] += k * ask(1, l, r);\n        la[a[i]] = i;\n    &#125;\n    for (int i = 1; i &lt;= q; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"f---yunlis-subarray-queries-extreme-version\">F - Yunliâ€™s Subarray Queries (extreme version)</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/2009/G3\" class=\"uri\">https://codeforces.com/problemset/problem/2009/G3</a></p>\n<ul>\n<li>è€ƒè™‘å¯¹ <span class=\"math inline\">\\(\\forall i\\)</span>ï¼Œä»¤ <span class=\"math inline\">\\(a_i\\gets a_i-i\\)</span>ï¼Œé‚£ä¹ˆèƒ½å¤Ÿå‚ä¸åŒä¸€ä¸ªè¿ç»­å­æ®µçš„å…ƒç´ å€¼åº”ç›¸åŒ</li>\n<li><p>æ˜¾ç„¶å¯¹äºä»»æ„ä¸€ä¸ªé•¿åº¦ä¸º <span class=\"math inline\">\\(k\\)</span> çš„å­æ®µï¼Œå…¶ç­”æ¡ˆä¸º <span class=\"math inline\">\\(k\\)</span> å‡å»ä¼—æ•°å‡ºç°æ¬¡æ•°ï¼ˆ<span class=\"math inline\">\\([l, r]\\)</span> å¤„ç­”æ¡ˆè®°ä¸º <span class=\"math inline\">\\(g_r\\)</span>ï¼‰</p>\nè¿™ä¸€ç‚¹å¯ä»¥ç”¨ç±»ä¼¼è«é˜Ÿçš„æ–¹æ³•æ¥åš</li>\n<li><p>é‚£ä¹ˆå¯¹äºæ›´é•¿çš„å­æ®µ <span class=\"math inline\">\\([l, r]\\)</span>ï¼Œå…¶ <span class=\"math inline\">\\(f\\)</span> å°±æ˜¯ <span class=\"math inline\">\\(\\min\\limits_{l+k-1\\le i\\le r}\\{g_i\\}\\)</span></p>\nåŸé—®é¢˜ä¸­çš„ä¸€æ¬¡ <span class=\"math inline\">\\([l, r]\\)</span> çš„è¯¢é—®å°±å¯ä»¥è½¬åŒ–ä¸º <span class=\"math inline\">\\(\\sum\\limits_{i=l+k-1}^r\\sum\\limits_{j=i}^r\\min\\{ g_{i\\sim j}\\}\\)</span></li>\n<li><p>è¿™é‡Œæœ‰ä¸€ä¸ª trickï¼šæ‰«æçº¿æ—¶å¯ä»¥ç”¨å•è°ƒæ ˆçš„æƒ³æ³•æ¥ç»´æŠ¤æœ€å°å€¼æ“ä½œï¼Œé‚£ä¹ˆå°±æŠŠæœ€å€¼æ“ä½œè½¬åŒ–ä¸ºä¸€èˆ¬çš„åŒºé—´åŠ å†å²å’Œäº†ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e6 + 5;\nstruct &#123;\n    int l, r;\n    long long d1, d2, d3, u, s;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid pushup(int p) &#123;\n    t[p].u = t[lt].u + t[rt].u;\n    t[p].s = t[lt].s + t[rt].s;\n    return;\n&#125;\nvoid pushval(int p, long long d1, long long d2, long long d3) &#123;\n    t[p].s += t[p].u * d2 + d3 * (t[p].r - t[p].l + 1);\n    t[p].d3 += d3 + t[p].d1 * d2;\n    t[p].d2 += d2;\n    t[p].u += d1 * (t[p].r - t[p].l + 1);\n    t[p].d1 += d1;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    pushval(lt, t[p].d1, t[p].d2, t[p].d3);\n    pushval(rt, t[p].d1, t[p].d2, t[p].d3);\n    t[p].d1 = t[p].d2 = t[p].d3 = 0ll;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    t[p].u = t[p].s = 0ll;\n    t[p].d1 = t[p].d2 = t[p].d3 = 0;\n    if (l == r)\n        return;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid add(int p, int l, int r, long long v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        pushval(p, v, 0ll, 0ll);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    pushup(p);\n    return;\n&#125;\nlong long ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].s;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    auto res = 0ll;\n    if (l &lt;= mid)\n        res = ask(lt, l, r);\n    if (r &gt; mid)\n        res += ask(rt, l, r);\n    return res;\n&#125;\nsigned main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n, k, q;\n        std::cin &gt;&gt; n &gt;&gt; k &gt;&gt; q;\n        std::vector&lt;int&gt; a(n + 1);\n        for (int i = 1; i &lt;= n; ++i)\n            std::cin &gt;&gt; a[i], a[i] -= i;\n        bld(1, 1, n);\n        std::vector&lt;int&gt; g(n + 1);\n        std::unordered_map&lt;int, int&gt; cnt;\n        std::multiset&lt;int&gt; t;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            if (i &gt; k) &#123;\n                t.erase(t.find(cnt[a[i - k]]));\n                if (--cnt[a[i - k]])\n                    t.insert(cnt[a[i - k]]);\n            &#125;\n            if (cnt[a[i]])\n                t.erase(t.find(cnt[a[i]]));\n            t.insert(++cnt[a[i]]);\n            if (i &gt;= k)\n                g[i] = k - *--t.end();\n        &#125;\n        std::vector&lt;long long&gt; res(q + 1);\n        std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; u(n + 1);\n        for (int i = 1, l, r; i &lt;= q; ++i) &#123;\n            std::cin &gt;&gt; l &gt;&gt; r;\n            u[r].emplace_back(l + k - 1, i);\n        &#125;\n        std::stack&lt;std::pair&lt;int, int&gt; &gt; st;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            std::pair&lt;int, int&gt; now(g[i], i);\n            add(1, i, i, g[i]);\n            for (; !st.empty() &amp;&amp; st.top() &gt; now; st.pop()) &#123;\n                auto [v, p] = st.top();\n                add(1, p, now.second - 1, g[i] - v);\n                now.second = p;\n            &#125;\n            st.push(now);\n            pushval(1, 0ll, 1ll, 0ll);\n            for (auto [l, id] : u[i])\n                res[id] = ask(1, l, i);\n        &#125;\n        for (int i = 1; i &lt;= q; ++i)\n            std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "çº¿æ®µæ ‘"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250909/",
            "url": "https://xsc062.netlify.app/20250909/",
            "title": "å‰å¸æœºçº¿æ®µæ ‘",
            "date_published": "2025-09-09T14:24:31.000Z",
            "content_html": "<p>åŠ¿èƒ½ï¼Œä½†ä»…é™äºåŠ¿èƒ½å—ï¼Ÿ</p>\n<span id=\"more\"></span>\n<hr />\n<p>éœ€è¦çŸ¥é“çº¿æ®µæ ‘å¹¶éä¸‡èƒ½ï¼Œå¾ˆå¤šçœ‹èµ·æ¥å…¼å®¹çš„æ“ä½œå…¶å®æ˜¯ä¸å…¼å®¹çš„ã€‚ä¸¾ä¾‹ï¼š</p>\n<ul>\n<li><p>åŒºé—´å– min, maxã€åŒºé—´æŸ¥è¯¢ min, max</p>\n<p>å‘ç°åœ¨æ¶‰åŠæœ€å€¼æ“ä½œçš„æ—¶å€™ï¼ŒæŠŠåŒºé—´å…ƒç´ å€¼çœ‹ä½œåˆ†æ®µå‡½æ•°å’Œå–æœ€å€¼çš„æ€§è´¨æ˜¯æ¯”è¾ƒè´´çš„ã€‚</p>\né‚£ä¹ˆç›¸å½“äºæŠŠæ‰€æœ‰å¤§äº / å°äº <span class=\"math inline\">\\(v\\)</span> çš„éƒ¨åˆ†æ¨å¹³ã€‚æŸ¥è¯¢æ˜¯å¥½åšçš„ã€‚</li>\n<li><p>åŒºé—´åŠ ã€åŒºé—´æŸ¥è¯¢ min, max</p>\nç›¸å½“äºç«–ç›´æ–¹å‘å¹³ç§»ã€‚</li>\n<li><p>åŒºé—´åŠ ç­‰å·®æ•°åˆ—ã€åŒºé—´æŸ¥è¯¢ min, max</p>\nå‘ç°æ˜¯å’Œå¦ä¸€ä¸ªå›ºå®šçš„ä¸€æ¬¡å‡½æ•°åšçº¿æ€§åŠ ï¼›å‘ç°æ˜¯ä¸å¯åšçš„ã€‚</li>\n<li><p>åŒºé—´å– minã€åŒºé—´æ±‚å’Œ</p>\n<p>ä¹Ÿå³æŠŠæ‰€æœ‰å¤§äº / å°äº <span class=\"math inline\">\\(v\\)</span> çš„éƒ¨åˆ†æ¨å¹³ï¼Œè¿˜è¦æ±‚ç‚¹å€¼ä¹‹å’Œã€‚</p>\n<p>çœ‹èµ·æ¥ä¸å¯åšï¼Œå› ä¸ºæ±‚å’Œæ²¡åŠæ³•ç”¨è¿™æ ·çš„è¯­è¨€ä½“ç³»ç®€å•é˜é‡Šï¼Œåªèƒ½è€ƒè™‘è„±ç¦»è¿™ä¸ªè¯­è¨€ä½“ç³»ï¼ŒçœŸçš„å»æ‰¾åˆ°è¿™æ ·çš„å‡¸èµ·ã€‚è¿™æ ·çœ‹èµ·æ¥æ˜¯ç‰¹åˆ«æ…¢çš„ã€‚</p></li>\n</ul>\n<p>ä½†å®é™…ä¸Šæœ€åä¸€æ¡æ˜¯å¯åšçš„ï¼Œå‰å¦‚ä¸€å‘æ˜äº†ä¸€ç§ç‰¹å®šçš„æ–¹æ³•ï¼Œå¹¶è¯æ˜äº†åœ¨ä»…æœ‰åŒºé—´å– min / max + åŒºé—´æ±‚å’Œæ“ä½œæ—¶ï¼Œå¤æ‚åº¦æ˜¯ <span class=\"math inline\">\\(O(q\\log n)\\)</span> çš„ï¼›å¦‚æœå†å¢åŠ å…¶ä»–ä»»ä½•åŒºé—´æ“ä½œï¼Œå¤æ‚åº¦æ˜¯ <span class=\"math inline\">\\(O(q\\log^2 n)\\)</span> çš„ã€‚</p>\n<hr />\n<h2 id=\"åŒºé—´å–-min-åŒºé—´æ±‚å’Œ\">åŒºé—´å– min / åŒºé—´æ±‚å’Œ</h2>\n<p>ä¾‹ï¼š<a href=\"https://acm.hdu.edu.cn/showproblem.php?pid=5306\">Gorgeous Sequence</a></p>\n<p>è®°å½•æœ€å¤§å€¼ <span class=\"math inline\">\\(mx\\)</span>ã€æ¬¡å¤§å€¼ <span class=\"math inline\">\\(se\\)</span>ã€æœ€å¤§å€¼å‡ºç°æ¬¡æ•° <span class=\"math inline\">\\(cnt\\)</span>ã€‚å½“ <span class=\"math inline\">\\(v\\in(se,mx)\\)</span> æ—¶ï¼Œå‘ç°åªæœ‰ <span class=\"math inline\">\\(mx\\)</span> éœ€è¦è¢«æ›´æ–°ã€‚æ­¤æ—¶ <span class=\"math inline\">\\(s\\gets s-(mx-v)\\cdot cnt\\)</span>ã€‚</p>\n<p>å¦åˆ™ï¼Œ<span class=\"math inline\">\\(se\\)</span> ä¹Ÿéœ€è¦è¢«æ›´æ–°ï¼Œæš´åŠ›é€’å½’ç›´åˆ°æ»¡è¶³ä¸Šä¸€æ¡ååœæ­¢ã€‚å¤æ‚åº¦ <span class=\"math inline\">\\(O(q\\log n)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e6 + 5;\nconst int inf = 0x3f3f3f3f;\nstruct &#123;\n    long long s;\n    int l, r, mx, se, d, cnt;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nint a[maxn];\nvoid pushup(int p) &#123;\n    if (t[lt].mx == t[rt].mx) &#123;\n        t[p].mx = t[lt].mx, t[p].cnt = t[lt].cnt + t[rt].cnt;\n        t[p].se = std::max(t[lt].se, t[rt].se);\n    &#125;\n    else if (t[lt].mx &gt; t[rt].mx) &#123;\n        t[p].mx = t[lt].mx, t[p].cnt = t[lt].cnt;\n        t[p].se = std::max(t[lt].se, t[rt].mx);\n    &#125;\n    else &#123;\n        t[p].mx = t[rt].mx, t[p].cnt = t[rt].cnt;\n        t[p].se = std::max(t[lt].mx, t[rt].se);\n    &#125;\n    t[p].s = t[lt].s + t[rt].s;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].d = inf;\n    t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        t[p].s = t[p].mx = a[l], t[p].cnt = 1, t[p].se = 0;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    pushup(p);\n    return;\n&#125;\nvoid pushval(int p, int v) &#123;\n    if (v &lt;= t[p].mx) &#123;\n        t[p].s -= (long long)(t[p].mx - v) * t[p].cnt;\n        t[p].mx = t[p].d = v;\n    &#125;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    if (t[p].d != inf) &#123;\n        pushval(lt, t[p].d), pushval(rt, t[p].d);\n        t[p].d = inf;\n    &#125;\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (t[p].mx &lt;= v)\n        return;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r &amp;&amp; v &gt; t[p].se) &#123;\n        pushval(p, v);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    pushup(p);\n    return;\n&#125;\nint askmx(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].mx;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1, res = 0;\n    if (l &lt;= mid)\n        res = askmx(lt, l, r);\n    if (r &gt; mid)\n        res = std::max(res, askmx(rt, l, r));\n    return res;\n&#125;\nlong long asks(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].s;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    auto res = 0ll;\n    if (l &lt;= mid)\n        res = asks(lt, l, r);\n    if (r &gt; mid)\n        res += asks(rt, l, r);\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n, m;\n        std::cin &gt;&gt; n &gt;&gt; m;\n        for (int i = 1; i &lt;= n; ++i)\n            std::cin &gt;&gt; a[i];\n        bld(1, 1, n);\n        for (int op, l, r; m--; ) &#123;\n            std::cin &gt;&gt; op &gt;&gt; l &gt;&gt; r;\n            if (op == 0) &#123;\n                int v;\n                std::cin &gt;&gt; v;\n                add(1, l, r, v);\n            &#125;\n            else if (op == 1)\n                std::cout &lt;&lt; askmx(1, l, r) &lt;&lt; &#39;\\n&#39;;\n            else\n                std::cout &lt;&lt; asks(1, l, r) &lt;&lt; &#39;\\n&#39;;\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"åŒºé—´å–-minåŒºé—´æ“ä½œåŒºé—´æ±‚å’Œ\">åŒºé—´å– minã€åŒºé—´æ“ä½œã€åŒºé—´æ±‚å’Œ</h2>\n<p>ä¾‹ï¼š<a href=\"https://loj.ac/p/6565\">æœ€å‡å¥³é€‰æ‰‹</a></p>\n<p>å¯ä»¥ç”¨ç›¸ä¼¼çš„æ–¹æ³•æ¥ç»´æŠ¤ï¼›</p>\n",
            "tags": [
                "çº¿æ®µæ ‘"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250907/",
            "url": "https://xsc062.netlify.app/20250907/",
            "title": "è¿‘æœŸæ‚é¢˜",
            "date_published": "2025-09-07T08:13:09.000Z",
            "content_html": "<p>çªå›´</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"e---colinear\">E - Colinear</h2>\n<p><a href=\"https://atcoder.jp/contests/abc422/tasks/abc422_e\" class=\"uri\">https://atcoder.jp/contests/abc422/tasks/abc422_e</a></p>\n<p>çœ‹åˆ°é¢˜ç›®ä¼šæœ‰ä¸€ä¸ªä¹±æçš„æƒ³æ³•ï¼šéšæœºå–ä¸€å¯¹ç‚¹ï¼Œé‚£ä¹ˆæ˜¯æœ‰ <span class=\"math inline\">\\(\\dfrac 14\\)</span> çš„æ¦‚ç‡éƒ½åœ¨ç›´çº¿ä¸Šçš„ã€‚å¸¦è¿›å»æš´åŠ› check ä¸€ä¸‹ï¼Œå¤šæ¥å‡ æ¬¡æ­£ç¡®ç‡å°±æ¯”è¾ƒé«˜ã€‚</p>\n<p>ä»€ä¹ˆï¼Œè¿™æ˜¯æ­£è§£ï¼Ÿabc çš„é£æ ¼çœŸæ˜¯è¶Šæ¥è¶Šå¥‡æ€ªäº†ã€‚</p>\n<hr />\n<h2 id=\"f---eat-and-ride\">F - Eat and Ride</h2>\n<p><a href=\"https://atcoder.jp/contests/abc422/tasks/abc422_f\" class=\"uri\">https://atcoder.jp/contests/abc422/tasks/abc422_f</a></p>\n<p>è€ƒè™‘ä¸€ä¸ªè´¹ç”¨æå‰è®¡ç®—çš„åˆ†å±‚å›¾ï¼Œå°±å¯ä»¥è·‘ Dij äº†ã€‚</p>\n<p>å®˜è§£ç»™å‡ºäº†ä¸€ä¸ªä¼˜åŒ–ï¼š<strong>æœç´¢å®é™…ä¸Šæ˜¯åœ¨ç»™è¾¹å®šå‘ï¼›è¿™æ ·å›¾å°±è½¬åŒ–ä¸º DAG</strong>ï¼ˆå®é™…ä¸Šåå‘è¾¹å¹¶ä¸ä¼šäº§ç”Ÿæœ‰æ•ˆæ›´æ–°ï¼Œæ•…ç›´æ¥æœ´ç´ è½¬ç§»å³å¯ï¼‰ã€‚</p>\n<hr />\n<h2 id=\"b---triangle-toggle\">B - Triangle Toggle</h2>\n<p><a href=\"https://atcoder.jp/contests/arc205/tasks/arc205_b\" class=\"uri\">https://atcoder.jp/contests/arc205/tasks/arc205_b</a></p>\n<p>ç°åœºæ˜¯æ‰“è¡¨æ‰¾è§„å¾‹åšå‡ºæ¥çš„ ğŸ˜…</p>\n<p>å‘ç°è¿™æ ·ä¸€æ¬¡æ“ä½œä¹‹åæ¯ä¸ªç‚¹ä¸Šé»‘è¾¹çš„å¥‡å¶æ€§æ˜¯ä¸ä¼šå˜çš„ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€ä¸ªä¸Šç•Œï¼Œéš¾ç‚¹åœ¨äºæ˜¯å¦å¯ä»¥è¾¾åˆ°è¿™ä¸ªä¸Šç•Œã€‚</p>\n<p>å‘ç°åªè¦å­˜åœ¨ä¸€ä¸ªç‚¹ä¸Šè¿æœ‰ä¸¤æ¡ç™½è¾¹ï¼Œå°±å¯ä»¥æŠŠ 001 åè½¬ä¸º 110ï¼Œä¸€æ¬¡æ“ä½œè‡³å°‘å¯ä»¥æ–°å¢ä¸€æ¡é»‘è¾¹ã€‚æ•…æ˜¯å¯ä»¥è¾¾åˆ°çš„ã€‚</p>\n<hr />\n<h2 id=\"d---non-ancestor-matching\">D - Non-Ancestor Matching</h2>\n<p><a href=\"https://atcoder.jp/contests/arc205/tasks/arc205_d\" class=\"uri\">https://atcoder.jp/contests/arc205/tasks/arc205_d</a></p>\n<p>æ²¡å•¥å¥½è¯´çš„æ‘©å°”æŠ•ç¥¨ï¼Œæœ‰ä¸€ä¸ªéå¸¸ç®€å•çš„ä¼˜å…ˆé˜Ÿåˆ—åšæ³•</p>\n<p>ä½† Rosmist æ‰“äº†å¦ä¸€ä¸ªçœ‹èµ·æ¥æœ‰ç‚¹ç„å­¦çš„ä¸œè¥¿ï¼šå¯ä»¥æ„Ÿå—åˆ°æ¯æ¬¡åªå‘æœ€å¤§çš„å­æ ‘é€’å½’æ˜¯åˆç†çš„ï¼Œå°è¯•è¯æ˜ä¸€ä¸‹å‘ç°ç¡®å®æ¯”è¾ƒæ˜¾ç„¶</p>\n<hr />\n<h2 id=\"e---subset-product-problem\">E - Subset Product Problem</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/AT_arc205_e\" class=\"uri\">https://www.luogu.com.cn/problem/AT_arc205_e</a></p>\n<p>å¥‡æ€ªé¢˜ç›®</p>\n<p>é«˜ç»´å‰ç¼€å’Œ + åˆ†å—å…¶å®ä¸ç®—ç‰¹åˆ«ç½•è§çš„ trick</p>\n<p>ç”¨ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºå‰ <span class=\"math inline\">\\(10\\)</span> ä½ä¸º <span class=\"math inline\">\\(i\\)</span>ï¼Œå <span class=\"math inline\">\\(10\\)</span> ä½çš„é«˜ç»´å‰ç¼€å’Œ</p>\n<p>æ¯æ¬¡æŸ¥è¯¢ / æ›´æ–°éƒ½æ˜¯ <span class=\"math inline\">\\(O(2^{10})\\)</span> çš„ï¼Œå¯ä»¥æ¥å—ï¼ˆå—ï¼‰</p>\n<p>ç„¶åè¿˜æœ‰ä¸€ä¸ªç§‘ç ”æ€§çš„åšæ³• è§ <a href=\"https://www.luogu.com.cn/article/1uyz0hn2\" class=\"uri\">https://www.luogu.com.cn/article/1uyz0hn2</a></p>\n<hr />\n<h2 id=\"c.-by-the-assignment\">C. By the Assignment</h2>\n<p><a href=\"https://codeforces.com/contest/2135/problem/C\" class=\"uri\">https://codeforces.com/contest/2135/problem/C</a></p>\n",
            "tags": []
        },
        {
            "id": "https://xsc062.netlify.app/20250906/",
            "url": "https://xsc062.netlify.app/20250906/",
            "title": "å­¦ä¹ ç¬”è®°ï¼šå‹ä½é«˜ç²¾",
            "date_published": "2025-09-06T07:02:56.000Z",
            "content_html": "<p>æŠŠ ddxrS å“åˆ°äº†ï¼Œå‘å‡ºæƒŠä¸–ç–‘é—®ï¼šã€ä¸ºä»€ä¹ˆé«˜äºŒæœºæˆ¿æ­£åœ¨æ¿€çƒˆåœ°è®¨è®ºæ€ä¹ˆå†™é«˜ç²¾åº¦ï¼Ÿã€</p>\n<span id=\"more\"></span>\n<hr />\n<p>è€ƒè™‘ 10-base é«˜ç²¾åº¦ï¼Œå•æ¬¡è¿ç®—å¤æ‚åº¦ä¸º <span class=\"math inline\">\\(O(\\log_{10}V)\\)</span>ã€‚ä½¿ç”¨ 10-base çš„ä¸»è¦åŸå› æ˜¯ <code>std::to_string</code> å¾ˆæ–¹ä¾¿ã€è¾“å‡ºä¹Ÿå¾ˆç®€å•ã€‚</p>\n<p>ä½†æ•ˆç‡å¤ªä½ã€‚å®é™…ä¸Šï¼Œä¸€èˆ¬æ‰“é«˜ç²¾åº¦éƒ½æ˜¯ 1e4-baseï¼Œæˆ–æ›´æ¿€è¿›åœ°ï¼Œ1e9-baseã€‚</p>\n<p>æ³¨æ„é«˜ç²¾ä¹˜ä½ç²¾æ˜¯ <span class=\"math inline\">\\(O(len)\\)</span> è€Œé <span class=\"math inline\">\\(O(len^2)\\)</span>ã€‚</p>\n<p>éœ€è¦è€ƒè™‘è¾“å‡ºã€‚ç”±äºç”¨çš„æ˜¯ 10-power ä½œä¸º baseï¼Œæ‰€ä»¥åªéœ€è¦æŠŠæ¯å››ä½ç›´æ¥è¾“å‡ºå³å¯ã€‚æ³¨æ„é™¤é¦–ä½å¤–éœ€è¦è¡¥å‰å¯¼ 0 ç›´åˆ°å››ä½ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>struct BI &#123;\n    std::vector&lt;int&gt; s;\n    BI() &#123;&#125;\n    BI(int x) &#123;\n        for (; x; s.push_back(x % 10000), x /= 10000);\n        return;\n    &#125;\n    BI&amp; operator= (int q) &#123;\n        return *this = (BI)q;\n    &#125;\n    bool operator&gt; (const BI &amp;q) &#123;\n        if (s.size() != q.s.size())\n            return s.size() &gt; q.s.size();\n        for (int i = (int)s.size() - 1; ~i; --i)\n            if (s[i] != q.s[i])\n                return s[i] &gt; q.s[i];\n        return 0;\n    &#125;\n    BI operator* (int q) const &#123;\n        int lx = s.size();\n        std::vector&lt;long long&gt; res(lx + 3);\n        for (int i = 0; i &lt; lx; ++i)\n            res[i] = (long long)s[i] * q;\n        BI p;\n        for (int j = 0; j &lt; lx + 2; ++j)\n            res[j + 1] += res[j] / 10000, res[j] %= 10000;\n        int len = lx + 2;\n        for (; ~len &amp;&amp; !res[len]; --len);\n        for (int j = 0; j &lt;= len; ++j)\n            p.s.push_back(res[j]);\n        return p;\n    &#125;\n    void out(void) &#123;\n        for (int i = (int)s.size() - 1; ~i; --i) &#123;\n            auto p = std::to_string(s[i]);\n            if (i != (int)s.size() - 1)\n                for (; (int)p.size() &lt; 4; p = &quot;0&quot; + p);\n            std::cout &lt;&lt; p;\n        &#125;\n        std::cout &lt;&lt; &#39;\\n&#39;;\n        return;\n    &#125;\n&#125;;</code></pre>\n</details>\n",
            "tags": [
                "é«˜ç²¾åº¦"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250824/",
            "url": "https://xsc062.netlify.app/20250824/",
            "title": "æ‚é¢˜",
            "date_published": "2025-08-24T07:37:55.000Z",
            "content_html": "<p>ä¸ä¼šçš„ä¸œè¥¿è¶Šæ¥è¶Šå¤šäº†</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"b.-k-set-tree\">B. K-Set Tree</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1691F\" class=\"uri\">https://www.luogu.com.cn/problem/CF1691F</a></p>\n<p>ä»¤ <span class=\"math inline\">\\(F_i\\)</span> è¡¨ç¤ºä»¥ <span class=\"math inline\">\\(1\\)</span> ä¸ºæ ¹æ—¶ï¼Œ<span class=\"math inline\">\\(S\\)</span> åœ¨ <span class=\"math inline\">\\(i\\)</span> å­æ ‘å†…çš„ç­”æ¡ˆã€‚åˆ™ï¼š</p>\n<p><span class=\"math display\">\\[\nF_u=\\left(C_{siz_u}^k-\\sum C_{siz_v}^k\\right)\\cdot siz_u+\\sum F_v\\\\\n\\]</span></p>\n<p>ç›´æ¥æ¢æ ¹æ˜¯å¾ˆå¤æ‚çš„ï¼›æŠŠ <span class=\"math inline\">\\(\\sum C_{siz_v}^k\\)</span> è®°ä½œ <span class=\"math inline\">\\(dp_u\\)</span>ï¼ŒæŠŠ <span class=\"math inline\">\\(\\sum F_v\\)</span> è®°ä½œ <span class=\"math inline\">\\(f_u\\)</span>ï¼Œé‚£ä¹ˆï¼š</p>\n<p><span class=\"math display\">\\[\nres=\\sum(C_n^k-dp_u)\\cdot n+f_u\\\\\n\\]</span></p>\n<p><strong>è¿™æ ·åšæ˜¯ä¸ºäº†æŠŠä¸¤ä¸ªå’Œ <span class=\"math inline\">\\(v\\)</span> æœ‰å…³çš„ä¹˜é¡¹æ‹†å¼€æ¥æ¢æ ¹</strong>ï¼Œå®é™…æ¢æ ¹çš„æ—¶å€™å°±åªç”¨åˆ†åˆ«æ¢ <span class=\"math inline\">\\(f,dp\\)</span> ä¸¤ä¸ªå€¼ï¼Œä¸ç”¨è€ƒè™‘äºŒæ¬¡é¡¹ç­‰é—®é¢˜ï¼Œè®¡ç®—é‡ä¼šå°‘å¾ˆå¤š</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, k;\n    std::cin &gt;&gt; n &gt;&gt; k;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[n] = qkp(fac[n], mod - 2);\n    for (int i = n - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        if (m &gt; n)\n            return 0ll;\n        return fac[n] * inv[m] % mod * inv[n - m] % mod;\n    &#125;;\n    auto res(0ll);\n    std::vector&lt;int&gt; siz(n + 1), ss(n + 1);\n    std::vector&lt;long long&gt; f(n + 1), dp(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        siz[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                (f[x] += (C(siz[i], k) - dp[i]) * siz[i] + f[i]) %= mod;\n                (dp[x] += C(siz[i], k)) %= mod;\n                siz[x] += siz[i];\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    DFS = [&amp;](int x, int fa) &#123;\n        (res += (C(n, k) - dp[x]) * n + f[x]) %= mod;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                (f[i] += (C(n - siz[i], k) - (dp[x] - C(siz[i], k))) * (n - siz[i]) + f[x] - f[i] - (C(siz[i], k) - dp[i]) * siz[i]) %= mod;\n                (dp[i] += C(n - siz[i], k)) %= mod;\n                DFS(i, x);\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::cout &lt;&lt; (res + mod) % mod &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c.-li-hua-and-path\">C. Li Hua and Path</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1797F\" class=\"uri\">https://www.luogu.com.cn/problem/CF1797F</a></p>\n<p>è€ƒè™‘<strong>å®¹æ–¥</strong>ï¼Œåˆ†åˆ«æ±‚è§£æ»¡è¶³ 1ã€æ»¡è¶³ 2ã€æ»¡è¶³ 12ï¼ˆæ³¨æ„è¦å‡ä¸¤å€ï¼‰å°±èƒ½è®¡ç®—ç­”æ¡ˆ</p>\n<p>å‘ç°é¢˜ç›®æ‰€æ±‚ç‚¹å¯¹å½¢å¼å¾ˆç¬¦åˆ Kruskal é‡æ„æ ‘çš„è¦æ±‚ï¼Œè€ƒè™‘ä»¥å¯¹åº”ç‚¹æƒä¸ºè¾¹æƒï¼Œåˆ†åˆ«å»ºç«‹ minï¼Œmax Kruskal ç‚¹æƒå¤šå‰é‡æ„æ ‘ã€‚</p>\n<details>\n<p><summary>ç‚¹æƒå¤šå‰é‡æ„æ ‘ï¼Ÿ</summary></p>\n<p>åœ¨ç‚¹æƒä¸Šåš Kruskal é‡æ„æ ‘æ—¶ï¼Œå‘ç°è¾¹çš„è™šç‚¹æ˜¯ä¸å¿…è¦çš„ï¼Œå¯ä»¥ç›´æ¥å°†æ›´ä¼˜ç‚¹ä½œä¸ºçˆ¶äº²ã€‚</p>\n<p>å†™çš„æ—¶å€™æœ‰ç‚¹éš¾æƒ³æ¸…æ¥šâ€¦â€¦ å¯ä»¥ç”»ç”»å›¾ï¼Œä»”ç»†ç¡®å®šä¸€ä¸‹ Kruskal é‡æ„æ ‘çš„å…·ä½“æ€§è´¨</p>\n<p>è¿™æ ·åšçš„ä¼˜åŠ¿æ˜¯æ²¡æœ‰è™šç‚¹ï¼Œä¸€äº›é—®é¢˜ä¼šæ–¹ä¾¿ä¸€äº›ï¼›ä½†åŒæ—¶æ”¾å¼ƒäº†äºŒå‰æ ‘çš„ç»“æ„ï¼Œä¸€äº›é¢˜å¯èƒ½æ²¡é‚£ä¹ˆå¥½åšã€‚</p>\n<p>è¿™é“é¢˜åªç”¨ç»å…¸ Kruskal é‡æ„æ ‘ä¹Ÿå¯ä»¥è§£å†³ã€‚</p>\n</details>\n<p>å‘ç° 1 2 å‡å¯ä»¥è½¬åŒ–æˆä¸¤æ£µæ ‘åœ¨ä¸¤æ£µæ ‘ä¸Šçš„ç¥–å­™å…³ç³»è¦æ±‚ï¼Œå¯ä»¥è½»æ¾åœ°åˆ†åˆ«ç»Ÿè®¡æ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„ç‚¹å¯¹æ•°é‡</p>\n<p>è€ƒè™‘æ€ä¹ˆå¤„ç†åŒæ—¶æ»¡è¶³ 12 çš„ï¼Œå‘ç°è¦æ±‚åœ¨ä¸¤æ£µæ ‘ä¸ŠäºŒè€…åº”è¯¥éƒ½å…·æœ‰ç¥–å­™å…³ç³»ï¼Œä¸”æ˜¯ç›¸åçš„ã€‚<del>å¯ä»¥è€ƒè™‘åœ¨ä¸€æ£µæ ‘ä¸Š DFS çš„åŒæ—¶ç”¨ä¸»å¸­æ ‘å­˜å‚¨ç¥–å…ˆï¼Œåœ¨å¦ä¸€é¢—æ ‘ä¸Š ask</del></p>\n<p>è€ƒè™‘ä»æ›´å®¹æ˜“ç”¨ dfn è¡¨ç¤ºçš„å­æ ‘é—®é¢˜æ€è€ƒï¼Œåœ¨ min æ ‘ä¸Šåˆ†é… dfn åï¼Œåœ¨ max æ ‘ä¸Šç”¨ DFS + å›æº¯å¾—åˆ°æ¯ä¸ªç‚¹å®æ—¶ç¥–å…ˆåºåˆ—ï¼Œå­˜åœ¨æ ‘çŠ¶æ•°ç»„é‡Œï¼›ask è¯¥ç‚¹è¢«åˆ†é…çš„ dfn å­æ ‘åŒºé—´å°±èƒ½å¾—åˆ°ç­”æ¡ˆã€‚</p>\n<p>è€ƒè™‘è¯¢é—®ï¼Œç”±äºæ¯æ¬¡åŠ å…¥çš„éƒ½æ˜¯ç¼–å·æœ€å¤§çš„ç‚¹ï¼Œå¯¹äºæ»¡è¶³ 1ã€æ»¡è¶³ 2 çš„è´¡çŒ®æ˜¯æ˜¾ç„¶çš„ï¼Œè€ŒåŒæ—¶æ»¡è¶³ 12 çš„ç‚¹å°±æ˜¯åœ¨ min æ ‘ä¸Šçš„ç¥–å…ˆï¼Œéƒ½æ˜¯å¥½åšçš„ã€‚</p>\n<p>å®ç°çš„æ—¶å€™ä¸€å®šè¦æŠŠ min / max æ ‘å¯¹åº”çš„æ€§è´¨æ€è€ƒæ¸…æ¥šï¼Œä¸ç„¶ä¼šå¾ˆéº»çƒ¦</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; f1(n + 1), f2(n + 1);\n    std::iota(f1.begin() + 1, f1.end(), 1);\n    std::iota(f2.begin() + 1, f2.end(), 1);\n    std::function&lt;int(int)&gt; find1 = [&amp;](int x) &#123;\n        return x == f1[x] ? x : f1[x] = find1(f1[x]);\n    &#125;;\n    std::function&lt;int(int)&gt; find2 = [&amp;](int x) &#123;\n        return x == f2[x] ? x : f2[x] = find2(f2[x]);\n    &#125;;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1), g2(n + 1), adj1(n + 1), adj2(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        if (x &gt; y)\n            std::swap(x, y);\n        adj1[y].push_back(x);\n        adj2[x].push_back(y);\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        for (auto j : adj1[i]) &#123;\n            int fi = find1(i), fj = find1(j);\n            g1[fi].push_back(fj), f1[fj] = fi;\n        &#125;\n    for (int i = n; i; --i)\n        for (auto j : adj2[i]) &#123;\n            int fi = find2(i), fj = find2(j);\n            g2[fi].push_back(fj), f2[fj] = fi;\n        &#125;\n    std::vector&lt;int&gt; bit(n + 1), dfn(n + 1), rfn(n + 1);\n    auto lowbit = [](int x) &#123;\n        return x &amp; -x;\n    &#125;;\n    auto add = [&amp;](int x, int v) &#123;\n        for (; x &lt;= n; x += lowbit(x))\n            bit[x] += v;\n        return;\n    &#125;;\n    auto ask = [&amp;](int x) &#123;\n        int res = 0;\n        for (; x; x -= lowbit(x))\n            res += bit[x];\n        return res;\n    &#125;;\n    int rt1 = 0, rt2 = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (f1[i] == i)\n            rt1 = i;\n        if (f2[i] == i)\n            rt2 = i;\n    &#125;\n    int q;\n    std::cin &gt;&gt; q;\n    std::vector&lt;int&gt; dep1(n + 1), dep2(n + q + 1);\n    long long res = 0ll;\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now;\n        res += dep1[x];\n        for (auto i : g1[x]) &#123;\n            dep1[i] = dep1[x] + 1;\n            DFS(i);\n        &#125;\n        rfn[x] = now;\n        return;\n    &#125;;\n    DFS(rt1);\n    DFS = [&amp;](int x) &#123;\n        res += dep2[x];\n        res -= 2 * (ask(rfn[x]) - ask(dfn[x] - 1));\n        add(dfn[x], 1);\n        for (auto i : g2[x]) &#123;\n            dep2[i] = dep2[x] + 1;\n            DFS(i);\n        &#125;\n        add(dfn[x], -1);\n        return;\n    &#125;;\n    DFS(rt2);\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    for (int fa; q--; ) &#123;\n        std::cin &gt;&gt; fa;\n        dep2[++n] = dep2[fa] + 1;\n        res += (n - 1) - dep2[n];\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-å›¢é˜Ÿé€‰æ‹”\">D. å›¢é˜Ÿé€‰æ‹”</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6534/problem/4\" class=\"uri\">http://222.180.160.110:61235/contest/6534/problem/4</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œä»ä¸­ä»»é€‰ä¸€äº›äº’ä¸ç›¸äº¤çš„åŒºé—´ï¼Œæ»¡è¶³æ¯ä¸ªåŒºé—´å†…å…ƒç´ çš„ gcd ç›¸åŒã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 10^5,V\\le 10^7\\)</span>ã€‚</p>\n</blockquote>\n<p>æ³¨æ„åˆ°å›ºå®šä¸€ä¸ªå·¦ç«¯ç‚¹åï¼Œç§»åŠ¨å³ç«¯ç‚¹ï¼Œgcd æ¯æ¬¡è‡³å¤šå‡å°åˆ°åŸæ¥çš„ä¸€åŠï¼›ä¹Ÿå°±æ˜¯è¯´ï¼Œå…¶ç§ç±»æœ‰ <span class=\"math inline\">\\(\\log V\\)</span> ç§ã€‚æ•…å…¨åºåˆ—çš„ gcd æ€»æ•°æ˜¯ <span class=\"math inline\">\\(O(n\\log V)\\)</span> çš„ã€‚</p>\n<p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸æ­¤åŸç†ç±»ä¼¼çš„å…¨å±€ç­”æ¡ˆæ±‚æ³•ï¼šå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œå‘å·¦å¤„ç†å‡ºæ¯ä¸€æ®µ <span class=\"math inline\">\\([l,r]\\)</span>ï¼Œæ»¡è¶³ <span class=\"math inline\">\\(\\gcd(a_{l\\cdots i})=\\gcd(a_r\\cdots i)\\)</span>ï¼Œå¹¶è®°å½•è¯¥ <span class=\"math inline\">\\(\\gcd\\)</span>ã€‚è¿™æ ·æ±‚å‡ºæ¥çš„ <span class=\"math inline\">\\((i,l,r)\\)</span> å…±æœ‰ <span class=\"math inline\">\\(O(n\\log V)\\)</span> æ®µã€‚</p>\n<p>å¯¹äºæ¯ä¸ª gcd æœ‰ <span class=\"math inline\">\\(f_{i}=f_{i-1}+\\sum\\limits_{j=l_i}^{r_i} f_{j - 1}\\)</span>ï¼Œå¯ä»¥åšä¸€ä¸ªæ‰«æçº¿ï¼Œå¾—åˆ°å…¨å±€ç­”æ¡ˆï¼›å‘å‰å‘ååˆ†åˆ«åšåˆ° <span class=\"math inline\">\\(i-1,i+1\\)</span>ï¼Œç›¸ä¹˜å°±èƒ½å¾—åˆ° <span class=\"math inline\">\\(i\\)</span> æœªè¢«é€‰å–æ—¶çš„ç­”æ¡ˆ</p>\n<p>è€ƒè™‘æ€ä¹ˆå®Œæˆã€ç›¸ä¹˜ã€è¿™ä¸ªåŠ¨ä½œï¼šæœ€åçš„ <span class=\"math inline\">\\(f\\)</span> åœ¨æ¯ä¸ªå³ç«¯ç‚¹å¤„å‘ç”Ÿå˜åŒ–ï¼Œå¯ä»¥è½¬åŒ–æˆè‹¥å¹²æ®µ <span class=\"math inline\">\\(f\\)</span>ï¼›åè¿‡æ¥çš„ <span class=\"math inline\">\\(f&#39;\\)</span> äº¦å¯ä»¥è¿™æ ·è½¬åŒ–ã€‚å°† <span class=\"math inline\">\\(f\\)</span> æ•´ä½“åç§»ä¸€ä½ã€<span class=\"math inline\">\\(f&#39;\\)</span> æ•´ä½“å‰ç§»ä¸€ä½ï¼Œå°±å¯ä»¥å¯¹é½ã€‚äºŒè€…çš„ç«¯ç‚¹æ€»æ•°æ˜¯å‡æ‘Šå• log çš„ï¼ŒåŒºé—´æ€»æ•°ä¹Ÿå°±æ˜¯å‡æ‘Šå• log çš„ï¼ˆå½’å¹¶å°±èƒ½å¿«é€Ÿå¯»æ‰¾åˆ°åŒºé—´ï¼‰ï¼Œç”¨å·®åˆ†åšä¸€ä¸ªåŒºé—´åŠ å³å¯ã€‚</p>\n<p>ç”¨äºŒåˆ†å‹‰å¼ºå• log è§£å†³äº†è½¬ç§»ï¼›è¿˜çœ‹åˆ° <span class=\"citation\" data-cites=\"spdarkle\">@spdarkle</span> ç–‘ä¼¼åœ¨ <span class=\"math inline\">\\(1\\sim n\\)</span> ä¸Šç›´æ¥åšçš„<a href=\"http://222.180.160.110:61235/submission/3108272\">åšæ³•</a>ï¼Œå’Œ <span class=\"citation\" data-cites=\"Rosmist\">@Rosmist</span> ç–‘ä¼¼ç›´æ¥åœ¨æ¯ä¸ª <span class=\"math inline\">\\(i\\)</span> ä¸Šåšçš„<a href=\"http://222.180.160.110:61235/submission/3108581\">åšæ³•</a>ã€‚å®˜è§£æ˜¯ä¸ªçœ‹ä¸æ‡‚çš„åšæ³•</p>\n<p>å‘ƒï¼Œå¥½åƒä¸€ä¸å°å¿ƒæ‹¿äº†æœ€ä¼˜è§£ã€‚è€Œä¸”ä¼˜åŠ¿å¾ˆæ˜æ˜¾ï¼ˆæ€ä¹ˆæ€»ç”¨æ—¶æ¯”åˆ«äººä¸€ä¸ªç‚¹è¿˜å°‘ï¼Ÿï¼‰ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆï¼Ÿ</p>\n<p>å¯èƒ½å› ä¸ºå¤§å®¶éƒ½çœ‹ä¸æ‡‚å®˜è§£ï¼Œåšæ³•æ¯”è¾ƒå¤šæ ·ï¼Ÿé™¤äº†æˆ‘ä¹‹å¤–æ¯”è¾ƒå¿«çš„ lwz å’Œ <span class=\"citation\" data-cites=\"GoldSpade\">@GoldSpade</span> éƒ½ç”¨å½’å¹¶å®Œæˆæœ€åä¸€æ­¥ï¼›æˆ‘è¾ƒä»–ä»¬çš„é¢å¤–ä¼˜åŠ¿å¤§æ¦‚æ˜¯ç”¨äºŒåˆ†æ¢æ‰äº†æ ‘çŠ¶æ•°ç»„ï¼Ÿè¿·æƒ‘</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;selection.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;selection.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;ex_selection2.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; st(20, std::vector&lt;int&gt; (n + 1));\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], st[0][i] = a[i];\n    for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)\n        for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)\n            st[j][i] = std::__gcd(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);\n    auto askgcd = [&amp;](int l, int r) &#123;\n        int k = std::__lg(r - l + 1);\n        return std::__gcd(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);\n    &#125;;\n    std::unordered_map&lt;int, int&gt; tab;\n    struct node &#123;\n        int i, l, r;\n        bool operator&lt; (const int q) const &#123;\n            return i &lt; q;\n        &#125;\n        bool operator&lt;= (const int q) const &#123;\n            return i &lt;= q;\n        &#125;\n    &#125;;\n    std::vector&lt;std::vector&lt;node&gt; &gt; p1, p2;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (int to = i; to &gt;= 1; ) &#123;\n            int at = i, g = askgcd(to, i);\n            for (int l = 1, r = to, mid; l &lt;= r; ) &#123;\n                mid = (l + r) &gt;&gt; 1;\n                if (askgcd(mid, i) == g)\n                    at = mid, r = mid - 1;\n                else\n                    l = mid + 1;\n            &#125;\n            if (!tab.count(g)) &#123;\n                tab[g] = (int)p1.size();\n                p1.emplace_back(), p2.emplace_back();\n            &#125;\n            p1[tab[g]].push_back(&#123; i, at, to &#125;);\n            to = at - 1;\n        &#125;\n        for (int to = i; to &lt;= n; ) &#123;\n            int at = i, g = askgcd(i, to);\n            for (int l = to, r = n, mid; l &lt;= r; ) &#123;\n                mid = (l + r) &gt;&gt; 1;\n                if (askgcd(i, mid) == g)\n                    at = mid, l = mid + 1;\n                else\n                    r = mid - 1;\n            &#125;\n            if (!tab.count(g)) &#123;\n                tab[g] = (int)p2.size();\n                p1.emplace_back(), p2.emplace_back();\n            &#125;\n            p2[tab[g]].push_back(&#123; i, to, at &#125;);\n            to = at + 1;\n        &#125;\n    &#125;\n    auto s(0ll);\n    std::vector&lt;int&gt; x1(n + 1), x2(n + 2), pos(2 * n + 3);\n    std::vector&lt;long long&gt; f1(n + 1), f2(n + 2), s1(n + 1), s2(n + 2), diff(n + 1);\n    for (auto [g, id] : tab) &#123;\n        // printf(&quot;g = %d: \\n&quot;, g);\n        int n1 = (int)p1[id].size();\n        x1[0] = 0, f1[0] = s1[0] = 1ll;\n        for (int i = 1; i &lt;= n1; ++i) &#123;\n            auto [x, L, R] = p1[id][i - 1];\n            --L, --R;\n            x1[i] = x, f1[i] = f1[i - 1];\n            int l = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, L) - x1.begin() - 1,\n                r = std::upper_bound(x1.begin() + 1, x1.begin() + i + 1, R) - x1.begin() - 1;\n            if (l == r)\n                (f1[i] += f1[l] * (R - L + 1)) %= mod;\n            else &#123;\n                f1[i] += s1[r - 1] + mod - s1[l];\n                f1[i] += f1[r] * (R - x1[r] + 1);\n                f1[i] += f1[l] * (x1[l + 1] - L);\n                f1[i] %= mod;\n            &#125;\n            // printf(&quot;  r = %d, l = [%d, %d]: %lld\\n&quot;, x, L, R, f1[i]);\n            if (i != n1)\n                s1[i] = (s1[i - 1] + f1[i] * (p1[id][i].i - x)) % mod;\n        &#125;\n        (s += f1[n1] - 1) %= mod;\n        int n2 = (int)p2[id].size();\n        x2[n2 + 1] = n + 1, f2[n2 + 1] = s2[n2 + 1] = 1ll;\n        for (int i = n2; i; --i) &#123;\n            auto [x, L, R] = p2[id][i - 1];\n            ++L, ++R;\n            x2[i] = x, f2[i] = f2[i + 1];\n            int l = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, L) - x2.begin(),\n                r = std::lower_bound(x2.begin() + i, x2.begin() + n2 + 1, R) - x2.begin();\n            if (l == r)\n                (f2[i] += f2[l] * (R - L + 1)) %= mod;\n            else&#123;\n                f2[i] += s2[l + 1] + mod - s2[r];\n                f2[i] += f2[r] * (R - x2[r - 1]);\n                f2[i] += f2[l] * (x2[l] - L + 1);\n                f2[i] %= mod;\n            &#125;\n            // printf(&quot;  l = %d, r = [%d, %d]: %lld\\n&quot;, x, L, R, f2[i]);\n            if (i != 1)\n                s2[i] = (s2[i + 1] + f2[i] * (x - p2[id][i - 2].i)) % mod;\n        &#125;\n        for (int i = 0; i &lt; n1; ++i)\n            x1[i] = x1[i + 1];\n        x1[n1] = n;\n        int t = (x2[1] == 1) + 1;\n        for (int i = 1; i &lt;= n2 + 1; ++i)\n            --x2[i];\n        std::merge(x1.begin(), x1.begin() + n1 + 1, x2.begin() + t, x2.begin() + n2 + 2, pos.begin() + 1);\n        int m = std::unique(pos.begin() + 1, pos.begin() + n1 + n2 + 4 - t) - pos.begin() - 1;\n        for (int i = 1, p1 = 0, p2 = t, la = 0; i &lt;= m; ++i) &#123;\n            for (; p1 + 1 &lt;= n1 &amp;&amp; x1[p1] &lt; pos[i]; ++p1);\n            for (; p2 + 1 &lt;= n2 + 1 &amp;&amp; x2[p2] &lt; pos[i]; ++p2);\n            (diff[la + 1] += f1[p1] * f2[p2] + mod - 1) %= mod;\n            // printf(&quot;  [%d, %d]: %lld, %lld\\n&quot;, la + 1, pos[i], f1[p1], f2[p2]);\n            if (pos[i] + 1 &lt;= n)\n                (diff[pos[i] + 1] += mod - f1[p1] * f2[p2] + 1) %= mod;\n            la = pos[i];\n        &#125;\n    &#125;\n    // std::cout &lt;&lt; s &lt;&lt; &#39;\\n&#39;;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        (diff[i] += diff[i - 1]) %= mod;\n        std::cout &lt;&lt; (s + mod - diff[i]) % mod &lt;&lt; &#39; &#39;;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<p>æˆ‘ä¸€å¼€å§‹å°† <span class=\"math inline\">\\(f\\)</span> å®šä¹‰ä¸ºå•ç‚¹ç­”æ¡ˆè€Œéå‰ç¼€å’Œï¼Œä¼šå¯¼è‡´éœ€è¦çº¿æ®µæ ‘ç»´æŠ¤ç­‰å·®åºåˆ—ï¼Œè¿˜ä¸¢å¤±äº†ç­”æ¡ˆæ®µæ•°ä¸å¤šè¿™ä¸ªæ€§è´¨ï¼Œéå¸¸éº»çƒ¦ã€‚å°† <span class=\"math inline\">\\(f\\)</span> çš„æ„ä¹‰æ›¿æ¢ä¸ºå‰ç¼€å’Œåï¼Œå°±å¯ä»¥å¾ˆè½»æ¾åœ°åšäº†ã€‚</p>\n<hr />\n<h2 id=\"a.-å®‡å®™\">A. å®‡å®™</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6535/problem/1\" class=\"uri\">http://222.180.160.110:61235/contest/6535/problem/1</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œå¯¹äº <span class=\"math inline\">\\(k=1,2,\\cdots,n-1\\)</span>ï¼Œå›ç­”ï¼š</p>\n<ul>\n<li>ä»¤ <span class=\"math inline\">\\(i\\)</span> ä» <span class=\"math inline\">\\(1\\)</span> å¼€å§‹è‡ªå¢ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œéƒ½å¯ä»¥é€‰å– <span class=\"math inline\">\\(k\\)</span> ä¸ªäº’ä¸ç›¸åŒçš„ä¸‹æ ‡ï¼Œå¹¶ä½¿å®ƒä»¬å¯¹åº”çš„å…ƒç´ å¢åŠ  1ã€‚æ­¤æ—¶ï¼Œè‹¥å­˜åœ¨å…ƒç´ ä¸å¤§äº <span class=\"math inline\">\\(i\\)</span>ï¼Œåœæ­¢ã€‚è¾“å‡ºåœæ­¢æ—¶ <span class=\"math inline\">\\(i\\)</span> å¯èƒ½çš„æœ€å¤§å€¼ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n\\le 10^6,V\\le 10^9\\)</span>ã€‚</p>\n</blockquote>\n<p>å‘ç°ä¸å¤§äºè¿™ä¸ª condition æœ‰äº›åäººç±»ï¼Œå…ˆå°† <span class=\"math inline\">\\(a\\)</span> å…¨éƒ¨å‡ 1ï¼Œè½¬åŒ–æˆå°äºæ¥è€ƒè™‘</p>\n<p>è€ƒè™‘èƒ½åšæŒåˆ° <span class=\"math inline\">\\(i\\)</span> çš„ä¸€ä¸ªå¿…è¦æ¡ä»¶ï¼Œå³ <span class=\"math inline\">\\(\\sum\\limits_{a_j&lt;i} i-a_j\\le k\\cdot i\\)</span></p>\n<p>å®¹æ˜“å‘ç°è¯¥æ¡ä»¶åŒæ—¶æ˜¯å……åˆ†çš„ï¼Œå¯ä»¥æœæ‘©å°”æŠ•ç¥¨æ€è€ƒ</p>\n<p>å¯¹ <span class=\"math inline\">\\(a\\)</span> æ’åºï¼Œåœæ­¢æ—¶å‚ä¸è¿ç®—çš„ <span class=\"math inline\">\\(a_j\\)</span> æ˜¯è¶Šæ¥è¶Šå¤šçš„ï¼Œæ•…è®°å½•æœ€åä¸€ä¸ªå‚ä¸è¿ç®—çš„ä¸‹æ ‡ï¼Œé€æ­¥æŒªåŠ¨ï¼ˆå½“å‘ç°è§£å‡ºæ¥çš„ <span class=\"math inline\">\\(i\\)</span> æ¯”ä¸‹ä¸€ä¸ªæ›´å¤§æ—¶å°±éœ€è¦æŒªåŠ¨ï¼‰ï¼ŒåŒæ—¶è§£ä¸ç­‰å¼å³å¯ã€‚</p>\n<p><span class=\"citation\" data-cites=\"Quack\">@Quack</span> äº‘æˆ‘åœ¨åœºä¸Šèƒ½æƒ³å‡ºå®˜è§£å¯¹æˆ‘æ¥è¯´æ˜¯éå¸¸äº†ä¸èµ·çš„ï¼ˆå…¶å®åœºä¸Šå†™æ­£è§£çš„äººå°‘å¾—å‡ºå¥‡ï¼‰ï¼Œæˆ‘ä¹Ÿä¸å¾—ä¸æ‰¿è®¤æˆ‘èƒ½åšå‡ºæ¥ç¡®å®æœ‰ä¸€å®šè¿æ°”æˆåˆ†ï¼Œä¹Ÿèƒ½ä»ä¸­ä¸€çª¥æˆ‘ä»¤äººçœ¼å‰ä¸€é»‘çš„æ•°å­¦ç´ å…»ï¼</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n    std::freopen(&quot;universe.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;universe.out&quot;, &quot;w&quot;, stdout);\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    int n;\n    std::cin &gt;&gt; n, std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i], --a[i];\n    std::sort(a.begin() + 1, a.end());\n    int id = 1;\n    long long s = a[1];\n    for (int i = 1; i &lt; n; ++i) &#123;\n        if (id &lt; i + 1)\n            s += a[++id];\n        long long x = s / (id - i);\n        for (; id != n &amp;&amp; x &gt; a[id + 1]; s += a[++id], x = s / (id - i));\n        std::cout &lt;&lt; x &lt;&lt; &#39; &#39;;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b.-è·³è·ƒ\">B. è·³è·ƒ</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6535/problem/2\" class=\"uri\">http://222.180.160.110:61235/contest/6535/problem/2</a></p>\n<blockquote>\n<p>ç»™å®šé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„ 01 åºåˆ—å’Œè·³è·ƒä¸Šé™ <span class=\"math inline\">\\(k\\)</span>ã€‚ç»™å®š <span class=\"math inline\">\\(q\\)</span> ä¸ªè¯¢é—®ï¼Œå›ç­”ï¼š</p>\n<ul>\n<li>ä» <span class=\"math inline\">\\(a\\)</span> è·³åˆ° <span class=\"math inline\">\\(b\\)</span>ï¼Œä¿è¯ <span class=\"math inline\">\\(a,b\\)</span> çš„é¢œè‰²å‡ä¸º 1ï¼Œæ¯æ¬¡ä¸èƒ½è·³è¶…è¿‡ <span class=\"math inline\">\\(k\\)</span> æ ¼æˆ–è·³å‡ºå»ï¼Œåœ¨æœ€å°åŒ–è¸©åˆ° 0 æ•°é‡çš„å‰æä¸‹ï¼Œæœ€å°åŒ–è·³è·ƒæ¬¡æ•°ï¼Œè¾“å‡ºè¿™ä¸¤ä¸ªå€¼ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n,q\\le5\\times10^5\\)</span>ã€‚</p>\n</blockquote>\n<p>å®¹æ˜“å‘ç°åªèƒ½å¾€ä¸€ä¸ªæ–¹å‘è·³ï¼Œé‚£ä¹ˆä¸å¦¨ä»¤ <span class=\"math inline\">\\(a&lt;b\\)</span>ã€‚æœ‰ä¸€ä¸ªè´ªå¿ƒçš„æƒ³æ³•æ˜¯èƒ½å¾€å³å°±å¾€å³ï¼Œæ‰‹ç©å‘ç°<strong>æ˜¯å¯¹çš„</strong>ï¼ˆæˆ‘åœºä¸Šæ‰‹ç©è¿‡ååšå®šåœ°è®¤ä¸ºæ˜¯é”™çš„ï¼›å¯èƒ½å’Œæ²¡æ—¶é—´äº†å…µè’é©¬ä¹±æœ‰å…³ï¼‰ã€‚è¿™æ ·å°±å¾ˆå¥½æƒ³åˆ°ç¬¬äºŒé—®éœ€è¦å€å¢ï¼›ä½†æŠŠä¸¤ä¸ªé—®ç»“åˆèµ·æ¥è€ƒè™‘æ˜¯æœ‰ç‚¹å›°éš¾çš„ï¼Œèµ›æ—¶å°±æ„è¯†åˆ°è¿™ä¸¤é—®çš„è”ç³»æ²¡æœ‰çœ‹èµ·æ¥é‚£ä¹ˆå¤§ï¼Œç”šè‡³å¾ˆå¯èƒ½æ˜¯å‰²è£‚çš„ã€‚</p>\n<p>å•ç‹¬è€ƒè™‘ç¬¬ä¸€é—®ï¼Œå‘ç°å¯¹äºä¸€æ®µé•¿åº¦ä¸º <span class=\"math inline\">\\(len\\)</span> çš„ 0ï¼Œéœ€è¦è¸©åˆ°æ°å¥½ <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {len}k\\right\\rfloor\\)</span> ä¸ª 0ã€‚ç­”æ¡ˆå®¹æ˜“è®¡ç®—ã€‚</p>\n<p>å•ç‹¬è€ƒè™‘ç¬¬äºŒé—®ï¼Œè€ƒè™‘ä¸€ä¸ªç¬¬ä¸€é—®ç­”æ¡ˆå›ºå®šä¸º 0 çš„æƒ…å†µï¼Œä¹Ÿå³æ¯ä¸ª len éƒ½æ¯” <span class=\"math inline\">\\(k\\)</span> å°ã€‚åˆ™é—®é¢˜è½¬åŒ–æˆåœ¨ä¸è¸© 0 çš„æƒ…å†µä¸‹æœ€å°çš„æ­¥æ•°ã€‚å®¹æ˜“ç”¨å€å¢è§£å†³ã€‚</p>\n<p>æœ¬é¢˜æœ€ä»¤äººå°è±¡æ·±åˆ»çš„ç‚¹åœ¨äºäºŒè€…çš„ç»“åˆï¼Œå‘ç°è¿™ <span class=\"math inline\">\\(\\left\\lfloor\\dfrac {len}k\\right\\rfloor\\cdot k\\)</span> ä¸ª 0 æ˜¯æ— è®ºå¦‚ä½•éƒ½ä¼šè¢«ç»è¿‡çš„ï¼Œæ‰€ä»¥å¯ä»¥åœ¨åŸå§‹æ•°ç»„é‡Œåˆ æ‰å®ƒä»¬ï¼Œè½¬åŒ–æˆåªè€ƒè™‘ç¬¬äºŒé—®çš„æƒ…å†µ</p>\n<details>\n<p>ï¼Ÿï¼Ÿï¼Ÿ</p>\n<p>æˆ‘å¯¹äºè‡ªå·±è«åå…¶å¦™è·‘å¾—æ¯”åˆ«äººå¿«ä¸€å¤§æˆªè¿™ä»¶äº‹æƒ…å·²ç»å¿«è¦è§æ€ªä¸æ€ªäº†ï¼Œè¿™æ¬¡åˆæ˜¯ä»€ä¹ˆåŸç†ï¼Œæˆ‘é¢„å¤„ç†å†™å¾—æ¯”è¾ƒæ¼‚äº®å—ï¼Ÿï¼Ÿ</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;jump.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;jump.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, k, q, op;\n    std::cin &gt;&gt; n, std::cin &gt;&gt; n &gt;&gt; q &gt;&gt; k &gt;&gt; op;\n    std::vector&lt;int&gt; tmp(n + 1), a(1), s(1), to(n + 2);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        tmp[i] = t - &#39;0&#39;;\n    &#125;\n    tmp.push_back(1), ++n;\n    int cnt = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (tmp[i] == 1) &#123;\n            a.push_back(1), to[i] = (int)a.size() - 1;\n            s.push_back(s.back() + cnt), cnt = 0;\n        &#125;\n        else &#123;\n            ++cnt;\n            if (i == n || tmp[i + 1] == 1) &#123;\n                for (int j = 1; j &lt;= cnt % k; ++j)\n                    a.push_back(0), s.push_back(s.back());\n                cnt /= k;\n            &#125;\n        &#125;\n    &#125;\n    n = (int)a.size() - 1;\n    std::vector&lt;std::vector&lt;int&gt; &gt; f(20, std::vector&lt;int&gt; (n + 1));\n    for (int i = 0; i &lt; 20; ++i)\n        f[i][n] = n;\n    for (int i = n - 1; i; --i) &#123;\n        f[0][i] = std::min(&#123; n, i + k, f[0][i + 1] &#125;);\n        for (; !a[f[0][i]]; --f[0][i]);\n        if (a[i] == 1) &#123;\n            for (int j = 1; j &lt; 20; ++j)\n                f[j][i] = f[j - 1][f[j - 1][i]];\n        &#125;\n    &#125;\n    for (int a, b; q--; ) &#123;\n        std::cin &gt;&gt; a &gt;&gt; b;\n        if (a &gt; b)\n            std::swap(a, b);\n        a = to[a], b = to[b];\n        std::cout &lt;&lt; s[b] - s[a];\n        if (op == 1) &#123;\n            int res = s[b] - s[a];\n            for (int i = 19; ~i; --i)\n                if (f[i][a] &lt; b)\n                    a = f[i][a], res += (1 &lt;&lt; i);\n            std::cout &lt;&lt; &#39; &#39; &lt;&lt; res + 1;\n        &#125;\n        std::cout &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-jongmah\">D. Jongmah</h2>\n<p><a href=\"https://codeforces.com/contest/1110/problem/D\" class=\"uri\">https://codeforces.com/contest/1110/problem/D</a></p>\n<p>å®¹æ˜“å‘ç°å½“è¿ç»­å‡ºç°ä¸‰æ¬¡ <span class=\"math inline\">\\((i-1,i,i+1)\\)</span> æ—¶ï¼Œå¯ä»¥è¢«ä¸‰æ¬¡ç›¸åŒä»£æ›¿ï¼›</p>\n<p>å®¹æ˜“å‘ç°éœ€è¦ä½¿ç”¨ <span class=\"math inline\">\\(f_{i,a,b}\\)</span> æ¥ä»£è¡¨ DP åˆ° <span class=\"math inline\">\\(i\\)</span> æ—¶ï¼Œç”¨äº† <span class=\"math inline\">\\(a\\)</span> ç»„ <span class=\"math inline\">\\((i-1,i,i+1)\\)</span> å’Œ <span class=\"math inline\">\\(b\\)</span> ç»„ <span class=\"math inline\">\\((i,i+1,i+2)\\)</span> æ—¶çš„æœ€å¤§ç»„æ•°ï¼›</p>\n<p>ä½†æ˜¯å¹¶æ²¡æœ‰æƒ³åˆ°è¦å°†äºŒè€…ç»“åˆèµ·æ¥ï¼æ„Ÿè§‰åº”è¯¥æ˜¯èƒ½æ¯”è¾ƒå¿«åšå‡ºæ¥çš„æ°´å¹³ã€‚èƒ½å¯Ÿè§‰åˆ°ä¸å¤ªè®¤çœŸã€‚æ‚”è¿‡ï¼</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 0x3f3f3f3f;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; cnt(m + 1);\n    for (int i = 1, x; i &lt;= n; ++i)\n        std::cin &gt;&gt; x, ++cnt[x];\n    std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(m + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (3, std::vector&lt;int&gt; (3, -inf)));\n    f[0][0][0] = 0ll;\n    for (int i = 1; i &lt;= m; ++i)\n        for (int a = 0; a &lt;= 2; ++a) // i - 1, i, i + 1\n            for (int b = 0; b &lt;= 2; ++b) // i, i + 1, i + 2\n                for (int c = 0; c &lt;= 2; ++c) &#123; // i - 2, i - 1, i\n                    if (a + b + c &gt; cnt[i]) continue;\n                    f[i][a][b] = std::max(f[i][a][b], f[i - 1][c][a] + b + (cnt[i] - a - b - c) / 3);\n                &#125;\n    std::cout &lt;&lt; f[m][0][0] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e.-magic-stones\">E. Magic Stones</h2>\n<p><a href=\"https://codeforces.com/contest/1110/problem/F\" class=\"uri\">https://codeforces.com/contest/1110/problem/F</a></p>\n<p>å®¹æ˜“æƒ³åˆ°è€ƒå¯Ÿå·®åˆ†æ•°ç»„ï¼Œå‘ç°è¿™ä¸ªæ“ä½œå°±æ˜¯äº¤æ¢äº†å·®åˆ†æ•°ç»„çš„ç›¸é‚»ä¸¤ä¸ªå…ƒç´ ã€‚æ•…å¯¹äº <span class=\"math inline\">\\(c\\)</span> å’Œ <span class=\"math inline\">\\(t\\)</span> çš„å·®åˆ†æ•°ç»„åˆ†åˆ«æ’åºï¼Œç„¶å check æ˜¯å¦ç›¸ç­‰å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), b(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; b[i];\n    if (a[1] != b[1] || a[n] != b[n]) &#123;\n        std::cout &lt;&lt; &quot;No&quot; &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;int&gt; da(n), db(n);\n    std::adjacent_difference(a.begin() + 1, a.end(), da.begin());\n    std::adjacent_difference(b.begin() + 1, b.end(), db.begin());\n    std::sort(da.begin(), da.end());\n    std::sort(db.begin(), db.end());\n    std::cout &lt;&lt; (da == db ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "å€å¢",
                "æ ‘å½¢ DP",
                "Kruskal é‡æ„æ ‘"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250820/",
            "url": "https://xsc062.netlify.app/20250820/",
            "title": "æ‚é¢˜",
            "date_published": "2025-08-20T12:26:44.000Z",
            "content_html": "<p>å›°éš¾</p>\n<span id=\"more\"></span>\n<hr />\n<h3 id=\"b.-beautyæ‹†è´¡çŒ®\">B. beautyï¼ˆæ‹†è´¡çŒ®ï¼‰</h3>\n<p><a href=\"http://222.180.160.110:61235/contest/6513/problem/2\" class=\"uri\">http://222.180.160.110:61235/contest/6513/problem/2</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(n,V\\)</span>ï¼Œæ±‚å‡ºå¯¹äºæ‰€æœ‰é•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span>ï¼Œå€¼åŸŸä¸º <span class=\"math inline\">\\([1,V]\\)</span> çš„åºåˆ— <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œ<span class=\"math inline\">\\(\\sum_{i=1}^n |a_i-a_{n-i+1}|\\)</span> çš„å’Œã€‚</p>\n<p><span class=\"math inline\">\\(n,V\\le 5000\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>å®¹æ˜“æƒ³åˆ°ç®—è´¡çŒ®ï¼Œä¼šæœ‰ä¸€ä¸ª <span class=\"math inline\">\\(O(n^2V)\\)</span> çš„åšæ³•ã€‚ä½†æ˜¯æƒ³ <span class=\"math inline\">\\(O(nV)\\)</span> åšæ˜¯å¾ˆæŠ½è±¡çš„ï¼Œå’Œ <span class=\"math inline\">\\(O(n^2V)\\)</span> çš„æ€è·¯å·²ç»å¾ˆä¸ä¸€æ ·äº†</li>\n<li>ç»å…¸ trickï¼Œ<span class=\"math inline\">\\(a_{i+n/2}-a_i=\\sum\\limits_{x=0}^{+\\infty} [a_i\\le x&lt;a_{i+n/2}]\\)</span> æ‹†è´¡çŒ® ã€‚æ•…è¦ç®— <span class=\"math inline\">\\(a_{i}-a_{i+n/2}\\)</span>ï¼Œåªéœ€è¦å¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(x\\in[a_i,a_{i+n/2})\\)</span> è®¡ç®—è´¡çŒ®ã€‚</li>\n<li>æšä¸¾ <span class=\"math inline\">\\(x\\in [1,V)\\)</span>ï¼Œå†æšä¸¾æœ€å¤§çš„ <span class=\"math inline\">\\(t\\)</span>ï¼Œæ»¡è¶³ <span class=\"math inline\">\\(a_t\\ge x\\)</span>ã€‚é‚£ä¹ˆæœ‰ <span class=\"math inline\">\\(t\\)</span> ä¸ª <span class=\"math inline\">\\(a_i\\le x\\)</span>ï¼ŒåŒæ—¶æœ‰ <span class=\"math inline\">\\(n-t\\)</span> ä¸ª <span class=\"math inline\">\\(a_i&gt;x\\)</span>ï¼›æ»¡è¶³ <span class=\"math inline\">\\(i\\le n/2\\)</span> çš„ <span class=\"math inline\">\\(a_{i},a_{i+n/2}\\)</span> å¯¹æ•°åº”è¯¥æ˜¯ <span class=\"math inline\">\\(\\min(t,n-t)\\)</span>ã€‚æ•…å¯¹äºä¸€ä¸ªç¡®å®šçš„åºåˆ—ï¼Œ<span class=\"math inline\">\\(x\\)</span> å…±æœ‰ <span class=\"math inline\">\\(\\min(t,n-t)\\)</span> çš„è´¡çŒ®ã€‚</li>\n<li>è€ƒè™‘è®¡æ•°æ»¡è¶³ <span class=\"math inline\">\\(a_t\\le x\\)</span> çš„ <span class=\"math inline\">\\(a\\)</span>ï¼Œè¿™è¦æ±‚ç¬¬ <span class=\"math inline\">\\(t\\)</span> å¤§çš„æ•° <span class=\"math inline\">\\(\\le x\\)</span> è€Œç¬¬ <span class=\"math inline\">\\(t+1\\)</span> å¤§çš„æ•° <span class=\"math inline\">\\(&gt;x\\)</span>ï¼Œä¹Ÿå³åœ¨ <span class=\"math inline\">\\([1,x]\\)</span> é‡Œæ‰¾ <span class=\"math inline\">\\(t\\)</span> ä¸ªæ•°å†åœ¨ <span class=\"math inline\">\\((x,V]\\)</span> é‡Œæ‰¾ <span class=\"math inline\">\\(n-t\\)</span> ä¸ªæ•°ï¼Œæ³¨æ„è¿˜è¦å†ä¹˜ä¸Šè¿™ä¸¤ç§æ•°æ‹¼èµ·æ¥çš„æ–¹æ¡ˆæ•°ã€‚</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;beauty.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;beauty.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    std::vector&lt;long long&gt; fac(5001), inv(5001);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; pw(5001, std::vector&lt;long long&gt; (5001));\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= 5000; ++i) &#123;\n        fac[i] = fac[i - 1] * i % mod;\n        pw[i][0] = 1ll;\n        for (int j = 1; j &lt;= 5000; ++j)\n            pw[i][j] = pw[i][j - 1] * i % mod;\n    &#125;\n    auto qkp = [](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[5000] = qkp(fac[5000], mod - 2);\n    for (int i = 4999; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        return fac[n] * inv[m] % mod * inv[n - m] % mod;\n    &#125;;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n, V;\n        std::cin &gt;&gt; n &gt;&gt; V;\n        auto res(0ll);\n        for (int x = 1; x &lt; V; ++x)\n            for (int t = 1; t &lt; n; ++t) &#123;\n                int k = std::min(t, n - t);\n                (res += k * pw[x][t] % mod * pw[V - x][n - t] % mod * C(n, t) % mod) %= mod;\n            &#125;\n        std::cout &lt;&lt; res * 2 % mod &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"c.-drink-barå®¹æ–¥-ååº\">C. Drink Barï¼ˆå®¹æ–¥ + ååºï¼‰</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/AT_snuke21_j\" class=\"uri\">https://www.luogu.com.cn/problem/AT_snuke21_j</a></p>\n<ul>\n<li>ä¸‰ä¸ªå±æ€§éƒ½æ˜¯æ’åˆ—ï¼Œå¯ä»¥æ¨ç†å‡ºåªè¦ä¸¤ä¸ªä¸‰å…ƒç»„ä¸­ï¼Œä½œå‡ºè´¡çŒ®çš„å…ƒç´ ä¸å®Œå…¨ç›¸åŒï¼Œä¸¤ä¸ªä¸‰å…ƒç»„å°±ä¸åŒã€‚è®¨è®ºä½œå‡ºè´¡çŒ®çš„å…ƒç´ æ•°é‡ã€‚</li>\n<li>åªæœ‰ä¸€ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œç­”æ¡ˆä¸º <span class=\"math inline\">\\(n\\)</span>ã€‚</li>\n<li>æœ‰ä¸¤ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œä»»é€‰çš„è¯ç­”æ¡ˆä¸º <span class=\"math inline\">\\(C_n^2\\)</span>ï¼Œè¦å‡å»ä¸€ä¸ªå…ƒç´ ä¸¥æ ¼ä¼˜äºå¦ä¸€ä¸ªå…ƒç´ çš„æƒ…å†µï¼Œä¸‰ç»´ååºå³å¯ã€‚</li>\n<li><p>æœ‰ä¸‰ä¸ªå…ƒç´ ä½œå‡ºè´¡çŒ®ï¼Œæ˜¯ä¸ªæœ‰ç‚¹å¤æ‚çš„å®¹æ–¥ï¼Œä¸å¦¨è®¾ä¸‰å…ƒç»„ä¸º <span class=\"math inline\">\\((i,j,k)\\)</span>ï¼Œå…¶ä¸­è´¡çŒ®æ¬¡æ•°æœ€å¤šçš„ä¸º <span class=\"math inline\">\\(i\\)</span></p>\n<ol type=\"1\">\n<li><span class=\"math inline\">\\(i\\)</span> è´¡çŒ®äº† <span class=\"math inline\">\\(\\ge 1\\)</span> æ¬¡ï¼Œæ–¹æ¡ˆæ•°ä¸º <span class=\"math inline\">\\(C_n^3\\)</span></li>\n<li><span class=\"math inline\">\\(i\\)</span> è´¡çŒ®äº† <span class=\"math inline\">\\(\\ge 2\\)</span> æ¬¡ï¼Œæšä¸¾ä½œå‡ºä¸¤æ¬¡è´¡çŒ®çš„å±æ€§ï¼Œä»¥ <span class=\"math inline\">\\(a,b\\)</span> ä¸ºä¾‹ï¼Œé‚£ä¹ˆæœ‰ <span class=\"math inline\">\\(a_j,a_k&lt;a_i\\)</span>ï¼Œä»¥åŠ <span class=\"math inline\">\\(b_j,b_k&lt;b_i\\)</span>ï¼ŒäºŒç»´ååºå³å¯</li>\n<li><span class=\"math inline\">\\(i\\)</span> è´¡çŒ®äº† <span class=\"math inline\">\\(\\ge 3\\)</span> æ¬¡ï¼Œä¾ç„¶æ˜¯ä¸‰ç»´ååºï¼Œå¯ä»¥ç”¨ã€ä¸¤ä¸ªå…ƒç´ åšå‡ºè´¡çŒ®ã€ä¸­ cdq å¾—åˆ°çš„å€¼ç®—å‡ºç­”æ¡ˆã€‚è®°å¾—ä¹˜ 2ï¼Œå› ä¸ºè¢«å¤šå‡äº† 2 æ¬¡ã€‚</li>\n</ol></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    struct node &#123; int a, b, c, res; &#125;;\n    std::vector&lt;node&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i].a &gt;&gt; a[i].b &gt;&gt; a[i].c;\n        a[i].res = 0;\n    &#125;\n    long long res = n;\n    res += (long long)n * (n - 1) / 2;\n    std::vector&lt;int&gt; bit(n + 1);\n    auto lowbit = [](int x) &#123;\n        return x &amp; -x;\n    &#125;;\n    auto add = [&amp;](int x, int v) &#123;\n        for (; x &lt;= n; x += lowbit(x))\n            bit[x] += v;\n        return;\n    &#125;;\n    auto ask = [&amp;](int x) &#123;\n        int res = 0;\n        for (; x; x -= lowbit(x))\n            res += bit[x];\n        return res;\n    &#125;;\n    std::function&lt;void(int, int)&gt; calc = [&amp;](int l, int r) &#123;\n        if (l == r)\n            return;\n        int mid = (l + r) &gt;&gt; 1;\n        calc(l, mid), calc(mid + 1, r);\n        int j = l;\n        for (int i = mid + 1; i &lt;= r; ++i) &#123;\n            for (; j &lt;= mid &amp;&amp; a[j].b &lt; a[i].b; ++j)\n                add(a[j].c, 1);\n            a[i].res += ask(a[i].c);\n        &#125;\n        for (int i = l; i &lt; j; ++i)\n            add(a[i].c, -1);\n        std::inplace_merge(a.begin() + l, a.begin() + mid + 1, a.begin() + r + 1, [&amp;](node x, node y) &#123; return x.b &lt; y.b; &#125;);\n        return;\n    &#125;;\n    std::sort(a.begin() + 1, a.end(), [&amp;](node x, node y) &#123; return x.a &lt; y.a; &#125;);\n    calc(1, n);\n    for (int i = 1; i &lt;= n; ++i)\n        res -= a[i].res;\n    res += (long long)n * (n - 1) * (n - 2) / 6;\n    for (int k = 0; k &lt; 3; ++k) &#123;\n        std::sort(a.begin() + 1, a.end(), [&amp;](node x, node y) &#123; return x.a &lt; y.a; &#125;);\n        std::fill(bit.begin() + 1, bit.end(), 0);\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            int t = ask(a[i].b);\n            res -= (long long)t * (t - 1) / 2;\n            add(a[i].b, 1);\n            std::tie(a[i].a, a[i].b, a[i].c) = std::make_tuple(a[i].b, a[i].c, a[i].a);\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        res += (long long)a[i].res * (a[i].res - 1);\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"c.-æ˜Ÿç™½-by-ttpandasç¬›å¡å°”æ ‘-dsu-on-tree\">C. æ˜Ÿç™½ by TTpandaSï¼ˆç¬›å¡å°”æ ‘ + dsu on treeï¼‰</h3>\n<p><a href=\"/20250819/#æ˜Ÿç™½-by-ttpandasç¬›å¡å°”æ ‘-dsu-on-tree\">link</a></p>\n<hr />\n<h3 id=\"c.-isn\">C. isn</h3>\n<p><a href=\"https://hydro.ac/p/bzoj-P4361\" class=\"uri\">https://hydro.ac/p/bzoj-P4361</a></p>\n<ul>\n<li><p>æœ€åä¸€ä¸ªåˆ å»çš„ä¸€å®šæ˜¯è¿æ¥ <code>&gt;</code> çš„æ•°ï¼Œå¯ä»¥ DP è¿˜å‰©ä¸€ä¸ªæ•°æ²¡åˆ æ—¶å¯èƒ½çš„åºåˆ—ã€‚</p>\nä»¤ <span class=\"math inline\">\\(f_{i,j,0/1}\\)</span> è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ä¸º <span class=\"math inline\">\\(i\\)</span>ï¼Œåºåˆ—é•¿ä¸º <span class=\"math inline\">\\(j\\)</span>ï¼Œæœ€åä¸€ä¸ªè¢«åˆ å»çš„æ•°ï¼ˆæœªï¼‰è¢«ç¡®å®šçš„æ–¹æ¡ˆæ•°ã€‚<strong>æ³¨æ„ç¡®å®šæœ€åä¸€ä¸ªè¢«åˆ å»çš„æ•°è¦åœ¨è½¬ç§»è¿‡ç¨‹ä¸­è¿›è¡Œï¼Œè€Œä¸æ˜¯ä½œä¸ºä¸€ä¸ª DP èŠ‚ç‚¹</strong>ï¼Œå¾ˆå®¹æ˜“å‘ç°åè€…æ˜¯é”™çš„ã€‚</li>\n<li><p>ä¼˜åŒ–çš„æ€è·¯å°±ä¸ä¸€æ ·äº†ã€‚å› ä¸ºè¦ä¹˜ä¸Š <span class=\"math inline\">\\((n-j)!\\)</span>ï¼Œæ‰€ä»¥ <span class=\"math inline\">\\(j\\)</span> çš„è¿™ä¸€ç»´æ˜¯çœä¸æ‰çš„</p>\nè€ƒè™‘ä¸ç®¡æœ€åä¸€ä¸ªè¢«åˆ æ‰çš„æ•°ï¼Œç›´æ¥ä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºæœ€åä¸€ä¸ªå…ƒç´ ä¸º <span class=\"math inline\">\\(i\\)</span>ï¼Œåºåˆ—é•¿ä¸º <span class=\"math inline\">\\(j\\)</span> çš„æ–¹æ¡ˆæ•°ã€‚æœ‰ <span class=\"math inline\">\\(f_{i,j}=\\sum\\limits_{a_k\\le a_i}f_{k,j - 1}\\)</span>ï¼Œå¯ä»¥ DS ä¼˜åŒ–ã€‚ä½†è¿™æ ·ä¼šäº§ç”Ÿä¸åˆæ³•çš„æƒ…å†µã€‚</li>\n<li><p>è€ƒå¯Ÿä»€ä¹ˆæ ·çš„åºåˆ—åˆæ³•ï¼Œå‘ç°<strong>åˆ å»çš„æœ€åä¸€ä¸ªæ•°ä¸€å®šæ˜¯éæ³•çš„ï¼Œä¹Ÿå°±æ˜¯åŒ…å«ä¹‹çš„åºåˆ—éƒ½æ˜¯éæ³•çš„ï¼›åä¹‹æ˜“å¾—è¢«åˆæ³•åºåˆ—åŒ…å«çš„åºåˆ—éƒ½éæ³•</strong></p>\n<p>æ˜ç™½äº†è¿™ä¸€ç‚¹è¿‡åå°±ä¼šçŸ¥é“é•¿åº¦ä¸º <span class=\"math inline\">\\(j\\)</span> çš„åˆæ³•åºåˆ—ç³»æ•°éƒ½ä¸º <span class=\"math inline\">\\((n-j)!\\)</span></p>\n<p>æ•…å®¹æ–¥ï¼Œä»¤ <span class=\"math inline\">\\(g_i\\)</span> è¡¨ç¤ºåºåˆ—é•¿ä¸º <span class=\"math inline\">\\(i\\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œ<span class=\"math inline\">\\(h_i\\)</span> è¡¨ç¤ºåºåˆ—é•¿ä¸º <span class=\"math inline\">\\(i\\)</span> çš„åˆæ³•æ–¹æ¡ˆæ•°ã€‚ä»å¼‚æˆ–è§’åº¦è€ƒè™‘ï¼Œæ˜“å¾— <span class=\"math inline\">\\(h_i=g_i-\\sum\\limits_{j=i+1}h_j\\times (j-i)!\\times C_j^i\\)</span>ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;isn.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;isn.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), l(1);\n    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i], l.push_back(a[i]);\n        fac[i] = fac[i - 1] * i % mod;\n    &#125;\n    auto qkp = [](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[n] = qkp(fac[n], mod - 2);\n    for (int i = n - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        return fac[n] * inv[m] % mod * inv[n - m] % mod;\n    &#125;;\n    std::sort(l.begin(), l.end());\n    l.erase(std::unique(l.begin(), l.end()), l.end());\n    for (int i = 0; i &lt;= n; ++i)\n        a[i] = std::lower_bound(l.begin(), l.end(), a[i]) - l.begin() + 1;\n    int m = (int)l.size();\n    std::vector&lt;std::vector&lt;long long&gt; &gt; bit(n + 1, std::vector&lt;long long&gt; (m + 1));\n    auto lowbit = [](int x) &#123;\n        return x &amp; -x;\n    &#125;;\n    auto add = [&amp;](int id, int x, long long v) &#123;\n        for (; x &lt;= m; x += lowbit(x))\n            (bit[id][x] += v) %= mod;\n        return;\n    &#125;;\n    auto ask = [&amp;](int id, int x) &#123;\n        auto res(0ll);\n        for (; x; x -= lowbit(x))\n            (res += bit[id][x]) %= mod;\n        return res;\n    &#125;;\n    std::vector&lt;long long&gt; g(n + 1), h(n + 1);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (n + 1));\n    add(0, a[0], 1ll), f[0][0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        for (int j = n; j; --j) &#123;\n            f[i][j] = ask(j - 1, a[i]);\n            add(j, a[i], f[i][j]);\n            (g[j] += f[i][j] * fac[n - j]) %= mod;\n        &#125;\n    auto res(0ll);\n    for (int i = n; i; --i) &#123;\n        h[i] = g[i];\n        for (int j = i + 1; j &lt;= n; ++j)\n            (h[i] += mod - h[j] * fac[j - i] % mod * C(j, i) % mod) %= mod;\n        (res += h[i]) %= mod;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"d.-thepowers\">D. ThePowers</h3>\n<p>TopCoder - 12185ï¼ŒåŸé¢˜äº¤ä¸äº†æ•…ä¸æ”¾é“¾æ¥äº†</p>\n<p><a href=\"http://222.180.160.110:61235/contest/6522/problem/4\" class=\"uri\">http://222.180.160.110:61235/contest/6522/problem/4</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(A,B\\)</span>ï¼Œå¯¹äºæ‰€æœ‰ <span class=\"math inline\">\\(X\\le A,Y\\le B\\)</span>ï¼Œæ±‚ <span class=\"math inline\">\\(X^Y\\)</span> çš„å¯èƒ½å–å€¼æ•°é‡ã€‚<span class=\"math inline\">\\(A,B\\le10^9\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>è€ƒè™‘ä»€ä¹ˆæ—¶å€™ç®—é‡ã€‚å‘ç°å½“ä¸”ä»…å½“ <span class=\"math inline\">\\(x^a=y^b\\)</span>ï¼Œæ­¤æ—¶è®° <span class=\"math inline\">\\(a&#39;=a\\div\\gcd(a,b),b&#39;=b\\div \\gcd(a,b)\\)</span>ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(t=\\sqrt[a&#39;]x=\\sqrt[b&#39;]y\\)</span> ä¸ºæ•´ï¼ˆå†™æˆè´¨å› æ•°ä¹˜ç§¯æ˜¯æ˜“è¯çš„ï¼‰ï¼Œåˆ™ <span class=\"math inline\">\\(x=t^b,y=t^a\\)</span>ï¼Œæ˜¯åŒä¸€ä¸ªæ•°çš„ä¸åŒæ¬¡å¹‚</li>\n<li><p>æ•…æŠŠ <span class=\"math inline\">\\(A\\)</span> å†…æ‰€æœ‰æ•°åˆ†ç»„ï¼Œè®° <span class=\"math inline\">\\(S_x\\)</span> è¡¨ç¤ºæ‰€æœ‰ <span class=\"math inline\">\\(x\\)</span> çš„æ¬¡å¹‚ï¼Œå…¶ä¸­ <span class=\"math inline\">\\(x\\)</span> ä¸æ˜¯å…¶ä»–æ•°çš„æ¬¡å¹‚</p>\nå‘ç°ä¸€ä¸ªå¯¹äº <span class=\"math inline\">\\(&gt;\\sqrt A\\)</span> çš„æ•° <span class=\"math inline\">\\(y\\)</span>ï¼Œåªæœ‰å¯èƒ½å±äº <span class=\"math inline\">\\(S_y\\)</span>ï¼Œæˆ–ä¸€ä¸ª <span class=\"math inline\">\\(x\\le \\sqrt A\\)</span> çš„ <span class=\"math inline\">\\(S_x\\)</span>ã€‚æ¯ç»„æœ€å¤šæœ‰ <span class=\"math inline\">\\(30\\)</span> ä¸ªï¼Œæ•…æ‰«ä¸€é <span class=\"math inline\">\\(\\le\\sqrt A\\)</span> çš„æ•°å³å¯å®Œæˆåˆ†ç»„ã€‚</li>\n<li><p>è¿™æ ·å°±åªç”¨è€ƒè™‘åŒç»„å†…çš„è®¡æ•°ã€‚å³å¯¹äº <span class=\"math inline\">\\(x\\)</span> å’Œ <span class=\"math inline\">\\(p\\le |S_x|,y\\le B\\)</span>ï¼Œ<span class=\"math inline\">\\(x^{py}\\)</span> æœ‰å¤šå°‘ç§å–å€¼ï¼Œä¹Ÿå³ <span class=\"math inline\">\\(py\\)</span> æœ‰å¤šå°‘ç§å–å€¼</p>\nå‘ç°å› ä¸ºå€¼åŸŸæ˜¯è¿ç»­çš„ï¼Œå¯¹äºä¸€ä¸ª <span class=\"math inline\">\\(p\\)</span>ï¼Œåªè¦ <span class=\"math inline\">\\(pB\\)</span> èŒƒå›´å†…æŸä¸ªæ•°æ˜¯ <span class=\"math inline\">\\(p\\)</span> çš„å€æ•°å°±å¯ä»¥å–åˆ°ï¼Œæšä¸¾ <span class=\"math inline\">\\([(p-1)B+1,pB]\\)</span>ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(p\\)</span> å®¹æ–¥ï¼Œå°±éœ€è¦è®¡ç®— <span class=\"math inline\">\\(p\\sim |S_x|\\)</span> çš„æ¯ä¸ªå­é›†ï¼Œå¤æ‚åº¦ä¼šçˆ†ç‚¸ã€‚</li>\n<li><p>å¯¹äº <span class=\"math inline\">\\(x,y\\in[p,|S_x|]\\)</span>ï¼Œå¦‚æœ <span class=\"math inline\">\\(y\\)</span> æ˜¯ <span class=\"math inline\">\\(x\\)</span> çš„å€æ•°ï¼Œå°±å¯ä»¥ skipï¼Œåªåœ¨å‰©ä¸‹çš„å…ƒç´ é‡Œæšä¸¾å­é›†ï¼Œå¯ä»¥ä»£ç éªŒè¯ä¸€ä¸‹ <span class=\"math inline\">\\(30\\)</span> ä»¥å†…æœ€å¤šå‰©ä¸‹ <span class=\"math inline\">\\(15\\)</span> ä¸ªæ•°ï¼Œå¯ä»¥æ¥å—ï¼Œæ³¨æ„å­é›†ä¿¡æ¯ç±»ä¼¼é«˜ç»´å‰ç¼€å’Œåœ° <span class=\"math inline\">\\(O(1)\\)</span> æ±‚å°±è¡Œäº†</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;power.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;power.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    long long A, B, mx = 1ll;\n    std::cin &gt;&gt; A &gt;&gt; B;\n    if (A == 1) &#123;\n        std::cout &lt;&lt; 1 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    int cnt = 1;\n    long long res = 1ll;\n    for (; (mx + 1) * (mx + 1) &lt;= A; ++mx);\n    std::vector&lt;int&gt; tag(mx + 1);\n    for (int i = 2; i &lt;= mx; ++i)\n        if (!tag[i]) &#123;\n            int siz = 1;\n            for (long long j = i; j &lt;= A; j *= i, ++siz)\n                if (j &lt;= mx)\n                    tag[j] = 1;\n            cnt += --siz;\n            for (int j = 1; j &lt;= siz; ++j) &#123;\n                std::vector&lt;int&gt; p(&#123; j &#125;);\n                for (int k = j + 1; k &lt;= siz; ++k) &#123;\n                    bool flag = 1;\n                    for (auto l : p)\n                        if (k % l == 0) &#123;\n                            flag = 0;\n                            break;\n                        &#125;\n                    if (flag)\n                        p.push_back(k);\n                &#125;\n                int m = (int)p.size(), s = 1 &lt;&lt; m;\n                std::vector&lt;long long&gt; mul(s);\n                mul[0] = 1ll;\n                auto lcm = [&amp;](long long x, long long y) &#123;\n                    return x / std::__gcd(x, y) * y;\n                &#125;;\n                for (int k = 1; k &lt; s; ++k) &#123;\n                    mul[k] = lcm(p[std::__lg(k ^ ((k - 1) &amp; k))], mul[(k - 1) &amp; k]);\n                    if (__builtin_popcount(k) &amp; 1)\n                        res += j * B / mul[k] - (j - 1) * B / mul[k];\n                    else\n                        res -= j * B / mul[k] - (j - 1) * B / mul[k];\n                &#125;\n            &#125;\n        &#125;\n    res += (A - cnt) * B;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<p>æœç´¢åšæ³•æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œå°±ä¸èµ˜è¿°äº†</p>\n",
            "tags": [
                "DP",
                "å®¹æ–¥"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250819/",
            "url": "https://xsc062.netlify.app/20250819/",
            "title": "log æ•°æ®ç»“æ„çš„ä¸€äº›é¢˜",
            "date_published": "2025-08-19T01:44:25.000Z",
            "content_html": "<p>çº¿æ®µæ ‘ã€æ ‘çŠ¶æ•°ç»„ã€å€å¢ã€åˆ†æ²»ï¼ˆæœ´ç´ åˆ†æ²» / CDQ / æ•´ä½“äºŒåˆ†ï¼‰ã€å¹³è¡¡æ ‘ã€å­—å…¸æ ‘ã€ç¬›å¡å°”æ ‘</p>\n<p>å¤šä¹å“‰ï¼Ÿä¸å¤šä¹Ÿã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<p>é¢˜ç›®æ¥æºï¼š</p>\n<ol type=\"1\">\n<li>llswâ€™s pdf</li>\n<li>æ´›è°·æ–‡ç« å¹¿åœºé¢˜è§£åŒºæœç´¢å¯¹åº”ç®—æ³•</li>\n<li>è‡ªå·±ä»¥å‰çš„ä¸€äº›é›¶æ•£é¢˜è§£</li>\n</ol>\n<p>æ‰¾äº†ä¸€äº›æœ‰æ•°æ®ç»“æ„æ–¹é¢æ€ç»´éš¾ç‚¹çš„é¢˜ï¼Œå®ç°éš¾åº¦é€šå¸¸ä¸ä¼šå¾ˆå¤§ï¼Œä¹Ÿæœ‰å°‘è®¸ç²‘ç²‘å¤¹æ‚å…¶ä¸­</p>\n<hr />\n<p><code>#</code> æ˜¯ç¼ºé¢˜è§£ï¼Œ<code>*</code> æ˜¯ç¼ºä»£ç </p>\n<hr />\n<h2 id=\"çº¿æ®µæ ‘\">çº¿æ®µæ ‘</h2>\n<h3 id=\"ç»´æŠ¤ç‰¹æ®Šä¿¡æ¯\">ç»´æŠ¤ç‰¹æ®Šä¿¡æ¯</h3>\n<h4 id=\"é‡‘é±¼è‰-curtainsåŒºé—´è¦†ç›–ä¿¡æ¯\">é‡‘é±¼è‰ / Curtainsï¼ˆåŒºé—´è¦†ç›–ä¿¡æ¯ï¼‰</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P11536\" class=\"uri\">https://www.luogu.com.cn/problem/P11536</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(n\\)</span> ä¸ªåŒºé—´ <span class=\"math inline\">\\([l,r]\\)</span>ï¼Œç»™å‡º <span class=\"math inline\">\\(q\\)</span> ä¸ªè¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—® <span class=\"math inline\">\\([L,R]\\)</span> æ˜¯å¦èƒ½è¢«è¡¨ç¤ºä¸ºè‹¥å¹² <span class=\"math inline\">\\([l,r]\\)</span> çš„å¹¶é›†ã€‚æ³¨æ„ä¸èƒ½è¦†ç›–åˆ° <span class=\"math inline\">\\([L,R]\\)</span> ä¹‹å¤–çš„ç‚¹ã€‚</p>\n<p><span class=\"math inline\">\\(n,q\\le 5\\times 10^5,|V|\\le 10^9\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>é¢˜ç›®æ‰€æ±‚ç­‰ä»·äº check æ»¡è¶³ <span class=\"math inline\">\\(l\\ge L\\land r\\le R\\)</span> çš„æ‰€æœ‰åŒºé—´æ˜¯å¦èƒ½å¤Ÿè¦†ç›– <span class=\"math inline\">\\([L,R]\\)</span></li>\n<li>è¿™ä¸ªå¾ˆç®€å•ï¼Œéœ€è¦åŒºé—´ä¿®æ”¹çš„åšæ³•å°±ä¸æäº†ã€‚å¯ä»¥æƒ³ä¸€ä¸‹æœ‰æ²¡æœ‰åªéœ€è¦å•ç‚¹ä¿®æ”¹çš„åšæ³•</li>\n<li><p>å‘ç°æƒå€¼çº¿æ®µæ ‘å¯ä»¥ç»´æŠ¤ã€Œä¸€æ®µè¿ç»­å·¦ç«¯ç‚¹å¯¹åº”åŒºé—´çš„å¹¶ã€æ˜¯å¦æ˜¯è¿ç»­çš„ï¼š</p>\nç»´æŠ¤ä½äºåŒºé—´å†…çš„å·¦ç«¯ç‚¹æœ€åä¸€ä¸ªè¦†ç›–åˆ°çš„ç‚¹ <span class=\"math inline\">\\(rv\\)</span>ï¼ˆå¯ä»¥åœ¨åŒºé—´å¤–ï¼›å‘ç°ä»åŒºé—´å·¦ç«¯ç‚¹åˆ° <span class=\"math inline\">\\(rv\\)</span> ä¼šè¢«è¿ç»­è¦†ç›–ï¼‰ï¼Œ<strong>åŒºé—´å†…</strong>æœ€åä¸€ä¸ªæ²¡æœ‰è¢«è¦†ç›–åˆ°çš„ç‚¹ <span class=\"math inline\">\\(p\\)</span>ï¼Œå’Œè¡¨ç¤ºåŒºé—´æ˜¯å¦èƒ½è¢«å®Œæ•´è¦†ç›–çš„æ ‡è®° flagã€‚pushup æ˜¯å®¹æ˜“çš„ã€‚</li>\n<li><p>å®¹æ˜“å‘ç°å¦‚æœæˆ‘ä»¬åœ¨æ ‘ä¸Šè¯¢é—® <span class=\"math inline\">\\([L,R]\\)</span> ä¸­æ‰€æœ‰å·¦ç«¯ç‚¹çš„ flagï¼Œæ— æ³•ä¿è¯å‚ä¸è¦†ç›–çš„ <span class=\"math inline\">\\(r\\le R\\)</span>ã€‚æ•…ç¦»çº¿ä¸‹æ¥æ‰«æçº¿å³å¯ã€‚</p>\n<p>å®é™…ä¸Šç”±äºæœªçŸ¥åŸå› è·‘å¾—å¾ˆå¯èƒ½ä¸å¦‚åŒºé—´ä¿®æ”¹çš„æ–¹æ³•å¿« TAT</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 5e5 + 5;\nstruct _ &#123;\n    bool flag;\n    int l, r, rv, p;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid pushup(int p) &#123;\n    t[p].rv = std::max(t[lt].rv, t[rt].rv);\n    if (!t[lt].flag) &#123;\n        t[p].flag = 0;\n        if (!t[rt].flag &amp;&amp; t[lt].rv &lt; t[rt].p)\n            t[p].p = t[rt].p;\n        else\n            t[p].p = t[lt].p;\n    &#125;\n    else if (!t[rt].flag &amp;&amp; t[lt].rv &lt; t[rt].p)\n        t[p].flag = 0, t[p].p = t[rt].p;\n    else\n        t[p].flag = 1, t[p].p = 0;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = t[p].p = r;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid add(int p, int x, int v) &#123;\n    if(t[p].l == t[p].r) &#123;\n        t[p].flag = 1, t[p].p = 0;\n        t[p].rv = std::max(t[p].rv, v);\n        return;\n    &#125;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, x, v);\n    else\n        add(rt, x, v);\n    pushup(p);\n    return;\n&#125;\n_ ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p];\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (r &lt;= mid)\n        return ask(lt, l, r);\n    if (l &gt; mid)\n        return ask(rt, l, r);\n    auto ls(ask(lt, l, r)), rs(ask(rt, l, r));\n    if (!ls.flag) &#123;\n        if (!rs.flag &amp;&amp; ls.rv &lt; rs.p)\n            ls.p = rs.p;\n    &#125;\n    else if (!rs.flag &amp;&amp; ls.rv &lt; rs.p)\n        ls.flag = 0, ls.p = rs.p;\n    ls.rv = std::max(ls.rv, rs.rv);\n    return ls;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m, q;\n    std::cin &gt;&gt; m &gt;&gt; n &gt;&gt; q;\n    bld(1, 1, m);\n    std::vector&lt;std::vector&lt;int&gt; &gt; t(m + 1);\n    for (int i = 1, l, r; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r;\n        t[r].push_back(l);\n    &#125;\n    std::vector&lt;int&gt; res(q + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; tq(m + 1);\n    for (int i = 1, l, r; i &lt;= q; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r;\n        tq[r].emplace_back(l, i);\n    &#125;\n    for (int i = 1; i &lt;= m; ++i) &#123;\n        for (auto l : t[i])\n            add(1, l, i);\n        for (auto [l, id] : tq[i])\n            res[id] = ask(1, l, i).flag;\n    &#125;\n    for (int i = 1; i &lt;= q; ++i)\n        std::cout &lt;&lt; (res[i] ? &quot;YES&quot; : &quot;NO&quot;) &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<h4 id=\"é¢˜æ—¥-zapatakå“ˆå¸Œ\"># é¢˜æ—¥ Zapatakï¼ˆå“ˆå¸Œï¼‰</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P11262\" class=\"uri\">https://www.luogu.com.cn/problem/P11262</a></p>\n<h4 id=\"ç®€å•æ•°æ®ç»“æ„å¸¦ä¸€ç‚¹é€’æ¨æ€§è´¨\">ç®€å•æ•°æ®ç»“æ„ï¼ˆå¸¦ä¸€ç‚¹é€’æ¨æ€§è´¨ï¼‰</h4>\n<p><a href=\"https://pjudge.ac/problem/21636\" class=\"uri\">https://pjudge.ac/problem/21636</a></p>\n<blockquote>\n<p>ç»™å®šåˆå§‹ä¸ºç©ºçš„å¤šé‡é›† <span class=\"math inline\">\\(p\\)</span>, <span class=\"math inline\">\\(q\\)</span>ï¼Œè¿™ä¸¤ä¸ªå¤šé‡é›†ä¸­çš„å…ƒç´ éƒ½æœ‰ <span class=\"math inline\">\\(a,b\\)</span> ä¸¤ç§å±æ€§ã€‚éœ€è¦éœ€è¦ç»´æŠ¤ <span class=\"math inline\">\\(p\\)</span> å’Œ <span class=\"math inline\">\\(q\\)</span> çš„åŠ ç‚¹å’Œåˆ ç‚¹æ“ä½œï¼Œè¯¢é—® <span class=\"math inline\">\\(\\forall \\,i\\in p,j\\in q\\)</span>ï¼Œ<span class=\"math inline\">\\(\\max(i_x + j_x, i_y + j_y)\\)</span> çš„æœ€å°å€¼ã€‚</p>\n<p><span class=\"math inline\">\\(m\\le 10^6,V\\le 10^9\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>è€ƒè™‘<strong>å¯¹ä¸ç­‰å¼æ’ç­‰å˜å½¢ï¼Œè½¬åŒ–ä¸ºååºé—®é¢˜</strong>ã€‚è‹¥ <span class=\"math inline\">\\(a_{i,0}+b_{j,0}\\ge a_{i,1}+b_{j,1}\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(a_{i,0}-a_{i,1}\\ge b_{j,1}-b_{j,0}\\)</span>ã€‚</li>\n<li><p>æŠŠ <span class=\"math inline\">\\(a\\)</span> æŒ‰ç…§ <span class=\"math inline\">\\(a_{i,0}-a_{i,1}\\)</span> æ’åºã€æŠŠ <span class=\"math inline\">\\(b\\)</span> æŒ‰ç…§ <span class=\"math inline\">\\(b_{j,1}-b_{j,0}\\)</span> æ’åºã€‚</p>\n<p>è¦æ±‚æŸä¸ªæ—¶åˆ»çš„ç­”æ¡ˆï¼Œéœ€è¦å¯¹äºæ¯ä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span> æ‰¾åˆ°æœ€å°çš„ <span class=\"math inline\">\\(b_{j,0}\\)</span>ï¼Œä½¿å¾— <span class=\"math inline\">\\(b_{j,1}-b_{j,0}\\)</span> åœ¨ <span class=\"math inline\">\\([-\\infty, a_{i,0}-a_{i,1}]\\)</span> ä¸­ï¼ŒåŒæ—¶æ‰¾åˆ°æœ€å°çš„ <span class=\"math inline\">\\(b_{j,1}\\)</span>ï¼Œä½¿å¾— <span class=\"math inline\">\\(b_{j,1}-b_{j,0}\\)</span> åœ¨ <span class=\"math inline\">\\([a_{i, 0}-a_{i,1},+\\infty]\\)</span> ä¸­ã€‚</p>\n<p>è¿™ä¸ªå¸¦æœ‰ä¸€ç‚¹é€’æ¨çš„æ€§è´¨ï¼Œåœ¨çº¿æ®µæ ‘ pushup çš„æ—¶å€™ï¼Œç”¨å·¦è¾¹çš„ <span class=\"math inline\">\\(b_{j,0}\\)</span> ç»“åˆå³è¾¹çš„ç­”æ¡ˆå¾—åˆ°çˆ¶äº²çš„ç­”æ¡ˆã€‚</p></li>\n</ul>\n<p><em>å¬è¯´æˆ‘ä¹‹å‰èµ›æ—¶åˆ‡äº†è¿™é¢˜ï¼Ÿæ€ä¹ˆæ²¡å°è±¡ã€‚llsw è®²é¢˜çš„æ—¶å€™è¯´è¦ç¦»çº¿ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°ç¦»çº¿åšæ³• orz</em></p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 2e9 + 1;\nstruct _ &#123; long long aa, ab, ba, bb, u; int l, r, id; &#125;;\nstd::vector&lt;_&gt; t(1);\nstd::vector&lt;std::multiset&lt;long long&gt; &gt; aa(1), ab(1), ba(1), bb(1);\nint tot, cnt;\n#define lt t[p].l\n#define rt t[p].r\nvoid pushup(int p) &#123;\n    t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;\n    if (lt) &#123;\n        t[p].u = t[lt].u;\n        t[p].aa = t[lt].aa, t[p].ab = t[lt].ab, t[p].ba = t[lt].ba, t[p].bb = t[lt].bb;\n    &#125;\n    if (rt) &#123;\n        t[p].u = std::min(t[p].u, t[rt].u);\n        t[p].aa = std::min(t[p].aa, t[rt].aa);\n        t[p].ab = std::min(t[p].ab, t[rt].ab);\n        t[p].ba = std::min(t[p].ba, t[rt].ba);\n        t[p].bb = std::min(t[p].bb, t[rt].bb);\n    &#125;\n    if (lt &amp;&amp; rt)\n        t[p].u = std::min(&#123; t[p].u, t[lt].ba + t[rt].aa, t[lt].ab + t[rt].bb &#125;);\n    return;\n&#125;\nint adda(int p, long long l, long long r, int x, int a, int b) &#123;\n    if (!p)\n        p = ++tot, t.emplace_back(), t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;\n    if (l == r) &#123;\n        if (!t[p].id)\n            t[p].id = ++cnt, aa.emplace_back(), ab.emplace_back(), ba.emplace_back(), bb.emplace_back();\n        int id = t[p].id;\n        aa[id].insert(a), ab[id].insert(b);\n        t[p].aa = *aa[id].begin(), t[p].ab = *ab[id].begin();\n        if (!aa[id].empty() &amp;&amp; !ba[id].empty())\n            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());\n        else\n            t[p].u = inf;\n        return p;\n    &#125;\n    long long mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid) &#123;\n        auto s(adda(lt, l, mid, x, a, b));\n        lt = s;\n    &#125;\n    else &#123;\n        auto s(adda(rt, mid + 1, r, x, a, b));\n        rt = s;\n    &#125;\n    pushup(p);\n    return p;\n&#125;\nint addb(int p, long long l, long long r, int x, int a, int b) &#123;\n    if (!p)\n        p = ++tot, t.emplace_back(), t[p].aa = t[p].ab = t[p].ba = t[p].bb = t[p].u = inf;\n    if (l == r) &#123;\n        if (!t[p].id)\n            t[p].id = ++cnt, aa.emplace_back(), ab.emplace_back(), ba.emplace_back(), bb.emplace_back();\n        int id = t[p].id;\n        ba[id].insert(a), bb[id].insert(b);\n        t[p].ba = *ba[id].begin(), t[p].bb = *bb[id].begin();\n        if (!aa[id].empty() &amp;&amp; !ba[id].empty())\n            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());\n        else\n            t[p].u = inf;\n        return p;\n    &#125;\n    long long mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid) &#123;\n        auto s(addb(lt, l, mid, x, a, b));\n        lt = s;\n    &#125;\n    else &#123;\n        auto s(addb(rt, mid + 1, r, x, a, b));\n        rt = s;\n    &#125;\n    pushup(p);\n    return p;\n&#125;\nvoid dela(int p, long long l, long long r, int x, int a, int b) &#123;\n    if (l == r) &#123;\n        int id = t[p].id;\n        aa[id].erase(aa[id].find(a)), ab[id].erase(ab[id].find(b));\n        t[p].aa = (aa[id].empty() ? inf : *aa[id].begin());\n        t[p].ab = (ab[id].empty() ? inf : *ab[id].begin());\n        if (!aa[id].empty() &amp;&amp; !ba[id].empty())\n            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());\n        else\n            t[p].u = inf;\n        return;\n    &#125;\n    long long mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        dela(lt, l, mid, x, a, b);\n    else\n        dela(rt, mid + 1, r, x, a, b);\n    pushup(p);\n    return;\n&#125;\nvoid delb(int p, long long l, long long r, int x, int a, int b) &#123;\n    if (l == r) &#123;\n        int id = t[p].id;\n        ba[id].erase(ba[id].find(a)), bb[id].erase(bb[id].find(b));\n        t[p].ba = (ba[id].empty() ? inf : *ba[id].begin());\n        t[p].bb = (bb[id].empty() ? inf : *bb[id].begin());\n        if (!aa[id].empty() &amp;&amp; !ba[id].empty())\n            t[p].u = std::min(*aa[id].begin() + *ba[id].begin(), *ab[id].begin() + *bb[id].begin());\n        else\n            t[p].u = inf;\n        return;\n    &#125;\n    long long mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        delb(lt, l, mid, x, a, b);\n    else\n        delb(rt, mid + 1, r, x, a, b);\n    pushup(p);\n    return;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;set.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;set.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int q, rt = 0;\n    std::cin &gt;&gt; q;\n    for (int i = 1; i &lt;= q; ++i) &#123;\n        int op, d, a, b;\n        std::cin &gt;&gt; op &gt;&gt; d &gt;&gt; a &gt;&gt; b;\n        if (op == 0 &amp;&amp; d == 0)\n            dela(rt, -inf, inf, a - b, a, b);\n        else if (op == 0)\n            delb(rt, -inf, inf, b - a, a, b);\n        else if (d == 0)\n            rt = adda(rt, -inf, inf, a - b, a, b);\n        else\n            rt = addb(rt, -inf, inf, b - a, a, b);\n        std::cout &lt;&lt; (t[1].u == inf ? -1 : t[1].u) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"å‘½è¿åˆ©ç”¨çº¿æ®µæ ‘çš„åˆ†æ²»ç»“æ„é€’æ¨\"># å‘½è¿ï¼ˆåˆ©ç”¨çº¿æ®µæ ‘çš„åˆ†æ²»ç»“æ„é€’æ¨ï¼‰</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P6773\" class=\"uri\">https://www.luogu.com.cn/problem/P6773</a></p>\n<hr />\n<h4 id=\"å¯¹æ•°æ®ç»“æ„çš„çˆ±ç»´æŠ¤å‡½æ•°\">* å¯¹æ•°æ®ç»“æ„çš„çˆ±ï¼ˆç»´æŠ¤å‡½æ•°ï¼‰</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P5609\" class=\"uri\">https://www.luogu.com.cn/problem/P5609</a></p>\n<blockquote>\n<p>ç»™å®šé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„æ•°ç»„ <span class=\"math inline\">\\(a\\)</span> å’Œæ¨¡æ•° <span class=\"math inline\">\\(p\\)</span>ï¼ˆ<span class=\"math inline\">\\(a_i\\)</span> åˆå§‹å¯èƒ½æ¯” <span class=\"math inline\">\\(p\\)</span> å¤§å¾ˆå¤šï¼Œè¿˜æœ‰å¯èƒ½ä¸ºè´Ÿï¼‰ï¼Œç»™å®š <span class=\"math inline\">\\(m\\)</span> æ¬¡è¯¢é—®ï¼Œæ¯æ¬¡é—®åŒºé—´ <span class=\"math inline\">\\([l,r]\\)</span>ï¼Œè¿›è¡Œè¿™æ ·çš„æ“ä½œï¼š</p>\n<p>åˆå§‹ <span class=\"math inline\">\\(sum=0\\)</span>ï¼Œä» <span class=\"math inline\">\\(l\\)</span> åˆ° <span class=\"math inline\">\\(r\\)</span>ï¼Œä¾æ¬¡ä»¤ <span class=\"math inline\">\\(sum\\gets sum+a_i\\)</span>ï¼Œå½“ä¸”ä»…å½“ <span class=\"math inline\">\\(sum\\ge p\\)</span> æ—¶ä»¤ <span class=\"math inline\">\\(sum\\gets sum-p\\)</span>ï¼ˆæ³¨æ„è¿™ä¸æ˜¯å–æ¨¡ï¼Œå‡å®Œä¹‹åè¿˜æ˜¯å¯èƒ½ <span class=\"math inline\">\\(\\ge p\\)</span>ï¼‰ã€‚</p>\n<p>é—®æœ€ç»ˆ <span class=\"math inline\">\\(sum\\)</span> çš„å€¼ã€‚<span class=\"math inline\">\\(n\\le 10^6,m\\le 2\\times 10^5\\)</span>ã€‚</p>\n</blockquote>\n<p>è€ƒè™‘çº¿æ®µæ ‘ç»´æŠ¤å‡½æ•°ã€‚å®šä¹‰ <span class=\"math inline\">\\(f(x)\\)</span> è¡¨ç¤ºåŒºé—´ä¸Šæƒ³è¦å‡å» <span class=\"math inline\">\\(x\\)</span> æ¬¡ <span class=\"math inline\">\\(p\\)</span> éœ€è¦çš„æœ€å°åˆå§‹å€¼ï¼ˆè¿™æ ·æ‰èƒ½è®©å®šä¹‰åŸŸå’ŒåŒºé—´é•¿æœ‰å…³ï¼‰ï¼ŒæŸ¥è¯¢æ—¶ç›´æ¥äºŒåˆ†å³å¯ï¼›è€ƒè™‘åˆå§‹åŒ–æ—¶å¦‚ä½•åˆå¹¶ã€‚</p>\n<p>é¦–å…ˆæ€è€ƒè¾ƒä¸ºæš´åŠ›çš„åšæ³•ï¼Œå¯¹äºå·¦ä¾§ç‚¹ <span class=\"math inline\">\\(a\\)</span> å’Œå³ä¾§ç‚¹ <span class=\"math inline\">\\(b\\)</span>ï¼Œè‹¥ <span class=\"math inline\">\\(f(a+1)-1+s_l-a\\cdot p\\ge f(b)\\)</span>ï¼Œä¹Ÿå³å¯ä»¥å‡å» <span class=\"math inline\">\\(a+b\\)</span> æ¬¡ï¼Œå°±å¯ä»¥ç”¨ <span class=\"math inline\">\\(\\max(f(a),f(b)-s_l+a\\cdot p)\\)</span> æ¥æ›´æ–° <span class=\"math inline\">\\(f(a+b)\\)</span>ã€‚</p>\n<p>å‘ç° <span class=\"math inline\">\\((a,b)\\)</span> çš„è´¡çŒ®ä¸€å®šå°äº <span class=\"math inline\">\\((a+1,b-1)\\)</span> çš„è´¡çŒ®ï¼›å…·ä½“åœ°ï¼Œå‘ç° <span class=\"math inline\">\\(f(x+1)-f(x)\\ge p\\)</span> åå°±å¾ˆæ˜¾ç„¶äº†ã€‚é‡‡ç”¨åŒæŒ‡é’ˆï¼Œä¼˜å…ˆç§»åŠ¨ <span class=\"math inline\">\\(b\\)</span>ï¼Œå°±èƒ½æŠŠæœ€çŸ­åŒºé—´æ‰«ä¸€éã€‚</p>\n<details>\n<p><summary>å…³äºçº¿æ®µæ ‘ç»´æŠ¤å‡½æ•°</summary></p>\n<p>ç»´æŠ¤ä¸€ä¸ªå‡½æ•°ï¼Œå½¢å¦‚ <span class=\"math inline\">\\(f_{[l,r]}(x)\\)</span> è¡¨ç¤ºåœ¨ <span class=\"math inline\">\\([l,r]\\)</span> åŒºé—´ä¸Šï¼Œ<span class=\"math inline\">\\(x\\)</span> çš„ä¸€ä¸ªæ˜ å°„</p>\n<p>å¦‚æœç›¸é‚»åŒºé—´çš„å‡½æ•°å¯ä»¥ç”¨æŸç§æ–¹å¼åˆå¹¶ï¼Œå°±å¯ä»¥ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤</p>\n<p>æŠŠæ ‘å»ºåœ¨å€¼åŸŸä¸Šï¼Œå°±å¯ä»¥åœ¨èŠ‚ç‚¹å†…æŠŠè¿™æ®µåŒºé—´æ¯ä¸ªç‚¹å¯¹åº”çš„å‡½æ•°å€¼å­˜ä¸‹æ¥ã€‚ä¸€èˆ¬æ¥è¯´æ˜¯é™æ€çš„ï¼Œå› ä¸ºè¿™æ˜¯ä¸€ä¸ªç±»å‰ç¼€å’Œçš„å½¢å¼ï¼Œæ²¡åŠæ³•ä¿®æ”¹</p>\n<p>æ¯ä¸ªç‚¹çš„ç‚¹å€¼æ•°ç»„ä¼šåœ¨å½“å‰å±‚è¢«æ‰«ä¸€éï¼Œä¸Šä¸€å±‚è¢«æ‰«ä¸€éï¼Œå¦‚æœåˆå¹¶èƒ½å¤Ÿåšåˆ°çº¿æ€§ï¼Œæ€»å¤æ‚åº¦å°±æ˜¯å• <span class=\"math inline\">\\(\\log\\)</span> çš„ã€‚</p>\n<p>å®é™…æƒ…å½¢ä¸‹å‡½æ•°æœ¬èº«å¯èƒ½å¾ˆéšç§˜ã€å¾ˆæŠ½è±¡ï¼Œæ€ä¹ˆä¼˜åŒ–åˆ°çº¿æ€§åˆå¹¶ä¹Ÿä¸å¤ªå¥½æƒ³</p>\n</details>\n<hr />\n<h4 id=\"compoundsæ¨¡æ„ä¹‰ä¸‹é—®é¢˜\">* COmPoUNdSï¼ˆæ¨¡æ„ä¹‰ä¸‹é—®é¢˜ï¼‰</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P12389\" class=\"uri\">https://www.luogu.com.cn/problem/P12389</a></p>\n<blockquote>\n<p>ç»™å®šå¸¸æ•°æ¨¡æ•°ï¼Œç»´æŠ¤æ¨¡æ„ä¹‰ä¸‹çš„åŒºé—´åŠ ã€åŒºé—´å“ˆå¸Œã€‚<span class=\"math inline\">\\(n\\le 10^6\\)</span>ã€‚</p>\n</blockquote>\n<p><strong>çº¿æ®µæ ‘å“ˆå¸Œæ˜¯å¯ä»¥ç»´æŠ¤åŒºé—´åŠ çš„</strong>ï¼Œä½†æ˜¯æ²¡åŠæ³•ç»´æŠ¤åŒºé—´å–æ¨¡</p>\n<p>ç±»ä¼¼ <a href=\"/20250816/#e---subarray-sum-divisibility\">ABC419E</a> é‡Œé¢ç”¨åˆ°çš„ï¼Œæ¨¡æ„ä¹‰ä¸‹åºåˆ—å…¨ç­‰å¯ä»¥è½¬åŒ–æˆå·®åˆ†å…¨ç­‰ï¼ŒåŒºé—´ä¿®æ”¹å°±å¯ä»¥ç®€åŒ–æˆå•ç‚¹ä¿®æ”¹äº†</p>\n<p>é¢å¤–åˆ¤ä¸€ä¸‹å¼€å¤´çš„å…ƒç´ ï¼ˆç»´æŠ¤åŸæ•°ç»„æˆ–è€…æ˜¯å·®åˆ†æ•°ç»„ä¹‹å’Œï¼‰æ˜¯å¦ç›¸ç­‰å°±å¯ä»¥äº†</p>\n<hr />\n<h4 id=\"æ”¹è¿›ä»£ç æ¨¡æ„ä¹‰ä¸‹é—®é¢˜\">* æ”¹è¿›ä»£ç ï¼ˆæ¨¡æ„ä¹‰ä¸‹é—®é¢˜ï¼‰</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P4635\" class=\"uri\">https://www.luogu.com.cn/problem/P4635</a></p>\n<blockquote>\n<p>ç»™å®šåºåˆ— <span class=\"math inline\">\\(a_{1\\sim n}\\)</span> å’Œå¸¸æ•° <span class=\"math inline\">\\(p\\)</span>ï¼Œç»´æŠ¤:</p>\n<ul>\n<li>ä¿®æ”¹ï¼šæ¨¡ <span class=\"math inline\">\\(p\\)</span> æ„ä¹‰ä¸‹åŒºé—´åŠ ï¼›</li>\n<li>è¯¢é—®ï¼šåŒºé—´ä¸­ <span class=\"math inline\">\\(\\sum\\limits_{i=l}^{r-1}[a_i&gt;a_{i+1}]\\)</span>ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n\\le 10^5,p\\le 10^6\\)</span>ã€‚</p>\n</blockquote>\n<p>è¯¢é—®ä¹Ÿå’Œæ¨¡æ„ä¹‰å·®åˆ†æœ‰å…³ç³»ï¼Œå‡å¦‚ <span class=\"math inline\">\\(s\\)</span> ä¸ºå½“å‰å·®åˆ†æ•°ç»„å‰ç¼€å’Œæ¨¡ <span class=\"math inline\">\\(p\\)</span> çš„å€¼ï¼ˆä¹Ÿå°±æ˜¯åŸæ•°ï¼‰ï¼Œå‘ç°<strong>å‰ä¸€ä¸ªæ•° <span class=\"math inline\">\\(&gt;\\)</span> åä¸€ä¸ªæ•°å½“ä¸”ä»…å½“ <span class=\"math inline\">\\(s\\)</span> åŠ çˆ†äº†</strong>ã€‚ç»´æŠ¤åŸæ•°ç»„ç”¨æ¥ç¡®å®š <span class=\"math inline\">\\(s\\)</span> çš„åˆå€¼ã€‚å†ç»´æŠ¤åŒºé—´å†…å·®åˆ†æ•°ç»„ä¹‹å’Œï¼ˆä¸å–æ¨¡ï¼‰ï¼Œ<strong>åœ¨è¿™ä¸ªå’Œé‡Œæœ‰å¤šå°‘ä¸ª <span class=\"math inline\">\\(p\\)</span> å°±ä¼šçˆ†å¤šå°‘æ¬¡</strong>ã€‚</p>\n<hr />\n<h4 id=\"é»‘ç™½æ ‘å¾ˆæ–°çš„ä¸œè¥¿\">é»‘ç™½æ ‘ï¼ˆå¾ˆæ–°çš„ä¸œè¥¿ï¼‰</h4>\n<p><a href=\"http://222.180.160.110:61235/problem/46907\" class=\"uri\">http://222.180.160.110:61235/problem/46907</a></p>\n<hr />\n<h3 id=\"ä»¥æ¥¼æˆ¿é‡å»ºä¸ºä»£è¡¨çš„-log2-ä¸€ç±»å‰ç¼€ä¿¡æ¯ç»´æŠ¤\">ä»¥æ¥¼æˆ¿é‡å»ºä¸ºä»£è¡¨çš„ <span class=\"math inline\">\\(\\log^2\\)</span> ä¸€ç±»å‰ç¼€ä¿¡æ¯ç»´æŠ¤</h3>\n<p>ç‰¹ç‚¹ï¼špushup æ—¶éœ€è¦å…ˆè·å¾—ä¸€è¾¹çš„ä¿¡æ¯ï¼Œåœ¨å¦ä¸€è¾¹è¿›è¡Œçº¿æ®µæ ‘ä¸ŠäºŒåˆ†ï¼Œå•æ¬¡æ“ä½œæ˜¯ <span class=\"math inline\">\\(O(\\log^2)\\)</span> çš„</p>\n<p>æœ¬è´¨æ˜¯ä¸€ç±»å…·æœ‰<strong>å•è°ƒæ€§</strong>çš„å‰ / åç¼€ä¿¡æ¯ï¼Œ<strong>åŒºé—´å¯¹å…¨å±€çš„è´¡çŒ®</strong>å’Œ<strong>åŒºé—´å¤–çš„ä¿¡æ¯</strong>æœ‰å…³ï¼Œæ•…ä¸èƒ½ç›´æ¥ç»´æŠ¤å¯¹å…¨å±€çš„è´¡çŒ®ï¼Œåªèƒ½ç»´æŠ¤åŒºé—´å†…çš„ç­”æ¡ˆã€‚ä½†ç”±äºä¸¤ä¸ªå­åŒºé—´ç­”æ¡ˆå¯ä»¥åˆå¹¶å‡ºå¤§åŒºé—´ç­”æ¡ˆï¼ˆé€šè¿‡çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å¾—åˆ°éœ€è¦çš„ä¿¡æ¯ï¼‰ï¼Œæ‰€ä»¥åªéœ€è¦é€å±‚å‘ä¸Šåˆå¹¶å°±å¯ä»¥å¾—åˆ°å…¨å±€ç­”æ¡ˆ</p>\n<p>ä¸€ä¸ªåå­—æ˜¯ã€çº¿æ®µæ ‘ç»´æŠ¤å‰ç¼€ä¿¡æ¯ã€ï¼Œæ„Ÿè§‰ä¸å¾ˆç²¾ç¡®ã€‚log æ–¹çº¿æ®µæ ‘åˆæ˜¯ä»€ä¹ˆé¬¼åå­—ï¼Ÿå…”é˜Ÿçº¿æ®µæ ‘åˆæ˜¯è°èµ·çš„ï¼ˆupdï¼šç–‘ä¼¼çšæœˆåŠæ´’èŠ±ï¼‰ï¼Ÿæ›´å¤šè¿˜æ˜¯å«çš„æ¥¼æˆ¿é‡å»ºçº¿æ®µæ ‘å§</p>\n<hr />\n<h4 id=\"æ¥¼æˆ¿é‡å»º\">æ¥¼æˆ¿é‡å»º</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P4198\" class=\"uri\">https://www.luogu.com.cn/problem/P4198</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œç»´æŠ¤ <span class=\"math inline\">\\(q\\)</span> æ¬¡æ“ä½œï¼š</p>\n<ul>\n<li>å•ç‚¹ä¿®æ”¹ï¼›</li>\n<li>æŸ¥è¯¢ <span class=\"math inline\">\\(\\dfrac{a_i}i\\)</span> çš„å‰ç¼€æœ€å¤§å€¼åºåˆ—é•¿åº¦ã€‚</li>\n</ul>\n<p><span class=\"math inline\">\\(n,q\\le 10^5\\)</span>ã€‚</p>\n</blockquote>\n<p>Fractures è¯´å½“å¹´ï¼ˆåˆä¸€ï¼‰æ˜¯ä»–åŠ›è gm ç»™æˆ‘ä»¬æ‹‰è¿™ä¸ªé¢˜çš„ã€‚dashenaï¼</p>\n<ul>\n<li>çº¿æ®µæ ‘ç»´æŠ¤å•è°ƒæ ˆï¼Œæˆ–è€…è¯´å‰ç¼€æœ€å€¼ï¼Œç»´æŠ¤æ–¹å¼è¿‡äºç»å…¸ï¼Œä½¿å¾—ã€æ¥¼æˆ¿é‡å»ºã€æˆä¸ºè¯¥ trick ç§°å‘¼ä¹‹ä¸€</li>\n<li><p>è€ƒè™‘ pushupã€‚ä¿ç•™å·¦è¾¹æ•´æ®µåŒºé—´ï¼Œå¯¹äºå·¦åŒºé—´åºåˆ—æœ«çš„å…ƒç´  <code>l.rv</code>ï¼Œæˆ‘ä»¬åœ¨å³åŒºé—´å†…æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºä¹‹çš„å…ƒç´  <span class=\"math inline\">\\(x\\)</span>ï¼Œä»å®ƒå¼€å§‹çš„åºåˆ—å°±æ˜¯ç­”æ¡ˆã€‚</p>\nåè¯æ³•æ˜“å¾— <span class=\"math inline\">\\(x\\)</span> ä¸€å®šåœ¨å³åŒºé—´ç­”æ¡ˆåºåˆ—å†…ï¼šè‹¥ <span class=\"math inline\">\\(x\\)</span> ä¸åœ¨ç­”æ¡ˆåºåˆ—å†…ï¼Œåˆ™å³åŒºé—´å†…å­˜åœ¨ä¸€ä¸ª <span class=\"math inline\">\\(&gt;x\\)</span> ä¸”ä½äº <span class=\"math inline\">\\(x\\)</span> ä¹‹å‰çš„å…ƒç´ ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(x\\)</span> å°±ä¸æ˜¯ç¬¬ä¸€ä¸ª <code>&gt; l.rv</code> çš„å…ƒç´ ï¼ŒçŸ›ç›¾ã€‚</li>\n<li><p>æ•…åœ¨å³åŒºé—´ä¸­äºŒåˆ†èƒ½å¤Ÿæ¥ä¸Šå»çš„åŒºé—´é•¿åº¦ï¼ŒåŠ èµ·æ¥å³å¯ã€‚</p>\n<p>é¢˜ç›®åªè¦æ±‚æ€»åŒºé—´ç­”æ¡ˆï¼Œæ•…ä¸éœ€è¦æŸ¥è¯¢ã€‚åŠ¨æ€å¼€ç‚¹å¯èƒ½éœ€è¦å°å¿ƒå¤„ç†ä¸€ä¸‹ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e5 + 5;\nstruct &#123;\n    int l, r, u;\n    double lv, rv, mv;\n&#125; t[maxn &lt;&lt; 2];\nint tot;\n#define lt t[p].l\n#define rt t[p].r\nint askt(int p, int l, int r, double v) &#123;\n    if (l == r)\n        return t[p].u;\n    int mid = (l + r) &gt;&gt; 1;\n    if (lt &amp;&amp; t[p].mv &gt; v)\n        return t[p].u - t[lt].u + askt(lt, l, mid, v);\n    return askt(rt, mid + 1, r, v);\n&#125;\nvoid pushup(int p, int l, int r) &#123;\n    t[p].mv = t[lt].rv;\n    if (lt &amp;&amp; rt) &#123;\n        t[p].lv = t[lt].lv;\n        t[p].rv = std::max(t[lt].rv, t[rt].rv);\n        if (t[lt].rv &lt; t[rt].lv)\n            t[p].u = t[lt].u + t[rt].u;\n        else if (t[lt].rv &gt;= t[rt].rv)\n            t[p].u = t[lt].u;\n        else &#123;\n            int mid = (l + r) &gt;&gt; 1;\n            t[p].u = t[lt].u + askt(rt, mid + 1, r, t[lt].rv);\n        &#125;\n    &#125;\n    else &#123;\n        t[p].u = t[lt + rt].u;\n        t[p].lv = t[lt + rt].lv, t[p].rv = t[lt + rt].rv;\n    &#125;\n    return;\n&#125;\nvoid upd(int &amp;p, int l, int r, int x, double v) &#123;\n    if (!p)\n        p = ++tot;\n    if (l == r) &#123;\n        t[p].lv = t[p].rv = v, t[p].u = 1;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        upd(lt, l, mid, x, v);\n    else\n        upd(rt, mid + 1, r, x, v);\n    pushup(p, l, r);\n    return;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;P4198_2.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m, rt = 0;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;double&gt; a(n + 1);\n    for (int x; m--; ) &#123;\n        double y;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        a[x] = y / x;\n        upd(rt, 1, n, x, y / x);\n        std::cout &lt;&lt; t[1].u &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"äºŒå‰æœç´¢æ ‘\">äºŒå‰æœç´¢æ ‘</h4>\n<p><a href=\"https://pjudge.ac/problem/21889\" class=\"uri\">https://pjudge.ac/problem/21889</a></p>\n<blockquote>\n<p>ç»™å®šä¸€ä¸ªå¤§å°ä¸º <span class=\"math inline\">\\(n\\)</span> çš„æ ‘ï¼Œæ ‘ä¸Šæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª BSTï¼Œä½ éœ€è¦ç»´æŠ¤ <span class=\"math inline\">\\(q\\)</span> æ¬¡æ“ä½œï¼š</p>\n<ol type=\"1\">\n<li>å¯¹äºæ ‘ä¸Šçš„ä¸€æ¡è·¯å¾„ <span class=\"math inline\">\\((u,v)\\)</span>ï¼Œåœ¨ç»è¿‡çš„æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„ BST æ’å…¥ <span class=\"math inline\">\\(x\\)</span>ï¼Œä¿è¯ä»»æ„æ—¶åˆ» BST ä¸­æ— ç›¸åŒå€¼</li>\n<li>åœ¨ç‚¹ <span class=\"math inline\">\\(u\\)</span> æŸ¥æ‰¾ <span class=\"math inline\">\\(x\\)</span>ï¼Œå¦‚æœ <span class=\"math inline\">\\(x\\)</span> å­˜åœ¨åˆ™è¿”å›å…¶åˆ° BST æ ¹çš„å…ƒç´ å’Œï¼Œå¦åˆ™è¿”å›æŸ¥æ‰¾æ—¶æœ€è¿œèµ°åˆ°çš„é‚£ä¸ªç‚¹ï¼Œåˆ° BST æ ¹çš„å…ƒç´ å’Œã€‚</li>\n</ol>\n<p><span class=\"math inline\">\\(n,q\\le 2\\times 10^5\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>è€ƒè™‘é“¾ä¸Šé—®é¢˜ã€‚å·®åˆ†ï¼ŒæŠŠæ›´æ–° <span class=\"math inline\">\\([l, r]\\)</span> çœ‹ä½œåœ¨å·®åˆ†æ•°ç»„ <span class=\"math inline\">\\(l\\)</span> å¤„æ’å…¥ï¼Œåœ¨ <span class=\"math inline\">\\(r+1\\)</span> å¤„åˆ é™¤ï¼Œç¦»çº¿ä¸‹æ¥å†ä»å·¦åˆ°å³æ‰«ä¸€éæ“ä½œå°±èƒ½æ›´æ–°ã€‚</li>\n<li>è€ƒè™‘æŸ¥è¯¢ã€‚<span class=\"math inline\">\\(i\\)</span> æ ‘ä¸Šå­˜åœ¨è¿‡çš„æ‰€æœ‰å…ƒç´ æ˜¯å·²çŸ¥çš„ï¼Œè€ƒè™‘å¦‚ä½•åŸºäºæ­¤è·å– <span class=\"math inline\">\\(i\\)</span> æ ‘ä¸Š <span class=\"math inline\">\\(t_0\\)</span> æ—¶åˆ»ï¼Œ<span class=\"math inline\">\\(x\\)</span> çš„æ‰€æœ‰ç¥–å…ˆã€‚</li>\n<li><p>å¯¹äºæ¯” <span class=\"math inline\">\\(x\\)</span> å¤§çš„å…ƒç´ ï¼Œè€ƒè™‘ç¥–å…ˆ <span class=\"math inline\">\\(p_a\\)</span> å’Œéç¥–å…ˆ <span class=\"math inline\">\\(p\\)</span> çš„åŒºåˆ«ï¼š</p>\n<p>æ ¹æ® BST çš„æ€§è´¨æ˜“å¾—ï¼Œå¯¹äºæœ€ä½çš„å³ä¾§ç¥–å…ˆ <span class=\"math inline\">\\({p_a}_0\\)</span>ï¼Œå…¶æ˜¯ <span class=\"math inline\">\\(\\ge x\\)</span> çš„æœ€å°çš„å…ƒç´ ï¼ˆåŠ å…¥æ—¶åˆ» <span class=\"math inline\">\\(t_a&lt;t_0\\)</span>ï¼‰ï¼›</p>\nåŒç†å¯ä»¥æ‰¾åˆ° <span class=\"math inline\">\\({p_a}_0\\)</span> å³ä¾§æœ€ä½çš„ç¥–å…ˆï¼ˆå…¶å·¦ä¾§çš„ç¥–å…ˆæ˜¾ç„¶ä¹Ÿåœ¨ <span class=\"math inline\">\\(x\\)</span> å·¦ä¾§ï¼‰ï¼Œè¯¥ç¥–å…ˆæ»¡è¶³ <span class=\"math inline\">\\(t&lt;t_a\\)</span>ã€‚ä»å·¦å³ä¸¤è¾¹åˆ†åˆ«å¾—åˆ° <span class=\"math inline\">\\(x\\)</span> çš„æ‰€æœ‰ç¥–å…ˆã€‚å®¹æ˜“è¯æ˜è¯¥è¿‡ç¨‹å¯¹äºä¸åœ¨æ ‘ä¸Šçš„ <span class=\"math inline\">\\(x\\)</span> ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</li>\n<li>å…·ä½“åœ°ï¼Œéœ€è¦èƒ½å¤Ÿæ±‚å‡º <span class=\"math inline\">\\(\\ge x\\)</span> çš„å…ƒç´ ä¸­ï¼Œä»¥ <span class=\"math inline\">\\(t_0\\)</span> ä¸ºèµ·ç‚¹çš„å‰ç¼€æœ€å°å€¼åºåˆ—çš„åŒºé—´å’Œã€‚çº¿æ®µæ ‘ç»´æŠ¤å•è°ƒæ ˆå®¹æ˜“è§£å†³ä¸å¸¦ <span class=\"math inline\">\\(t_0\\)</span> é™åˆ¶çš„ç­”æ¡ˆï¼›å†æ¬¡åˆ©ç”¨æ€§è´¨å°±èƒ½æ»¡è¶³é™åˆ¶ã€‚</li>\n<li><p>å¯¹äºæ ‘çš„æƒ…å†µï¼ŒæŠŠå·®åˆ†æ”¾åˆ°æ ‘ä¸Šï¼Œçº¿æ®µæ ‘åˆå¹¶å³å¯ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int lim = 2e5;\nconst int maxn = 2e7 + 5;\nconst int inf = 0x3f3f3f3f;\nstruct &#123;\n    int l, r, rv;\n    long long u;\n&#125; t[maxn];\nstd::vector&lt;int&gt; tr;\n#define lt t[p].l\n#define rt t[p].r\nint newnode(void) &#123;\n    static int tot = 0;\n    if (tr.empty())\n        return ++tot;\n    auto p(tr.back());\n    t[p].l = t[p].r = 0;\n    tr.pop_back();\n    return p;\n&#125;\nlong long askv(int p, int l, int r, int v) &#123;\n    if (l == r)\n        return t[p].rv &lt; v ? t[p].u : 0;\n    int mid = (l + r) &gt;&gt; 1;\n    if (v &gt; t[lt].rv)\n        return t[p].u - t[lt].u + askv(lt, l, mid, v);\n    return askv(rt, mid + 1, r, v);\n&#125;\nvoid pushup(int p, int l, int r) &#123;\n    t[p].rv = std::min(t[lt].rv, t[rt].rv);\n    int mid = (l + r) &gt;&gt; 1;\n    t[p].u = t[lt].u + askv(rt, mid + 1, r, t[lt].rv);\n    return;\n&#125;\nvoid upd(int &amp;p, int l, int r, int x, int v, int u) &#123;\n    if (!p)\n        p = newnode();\n    if (l == r) &#123;\n        t[p].rv = v, t[p].u = u;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        upd(lt, l, mid, x, v, u);\n    else\n        upd(rt, mid + 1, r, x, v, u);\n    pushup(p, l, r);\n    return;\n&#125;\nvoid merge(int &amp;p, int q, int l, int r) &#123;\n    if (!p || !q) &#123;\n        p += q;\n        return;\n    &#125;\n    if (l == r) &#123;\n        t[p].rv = std::min(t[p].rv, t[q].rv);\n        t[p].u = std::max(t[p].u, t[q].u);\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    merge(t[p].l, t[q].l, l, mid), merge(t[p].r, t[q].r, mid + 1, r);\n    pushup(p, l, r), tr.push_back(q);\n    return;\n&#125;\nint qv = inf;\nlong long ask(int p, int l, int r, int ql, int qr) &#123;\n    if (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;\n        auto s(askv(p, l, r, qv));\n        qv = std::min(qv, t[p].rv);\n        return s;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    long long res = 0ll;\n    if (ql &lt;= mid)\n        res = ask(lt, l, mid, ql, qr);\n    if (qr &gt; mid)\n        res += ask(rt, mid + 1, r, ql, qr);\n    return res;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;ex_problem4.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; top(n + 1), fa(n + 1), siz(n + 1), son(n + 1), dep(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int faa) &#123;\n        siz[x] = 1;\n        for (auto i : g[x])\n            if (i != faa) &#123;\n                fa[i] = x, dep[i] = dep[x] + 1;\n                DFS(i, x), siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    DFS = [&amp;](int x, int topp) &#123;\n        top[x] = topp;\n        if (son[x])\n            DFS(son[x], topp);\n        for (auto i : g[x])\n            if (i != fa[x] &amp;&amp; i != son[x])\n                DFS(i, i);\n        return;\n    &#125;;\n    DFS(1, 1);\n    auto getLCA = [&amp;](int x, int y) &#123;\n        for (; top[x] != top[y]; x = fa[top[x]])\n            if (dep[top[y]] &gt; dep[top[x]])\n                std::swap(x, y);\n        return (dep[x] &lt; dep[y] ? x : y);\n    &#125;;\n    std::vector&lt;std::vector&lt;int&gt; &gt; d(n + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; u(n + 1);\n    std::vector&lt;std::vector&lt;std::tuple&lt;int, int, int&gt; &gt; &gt; q(n + 1);\n    int cnt = 0;\n    for (int i = 1; i &lt;= m; ++i) &#123;\n        int op;\n        std::cin &gt;&gt; op;\n        if (op == 0) &#123;\n            int x, v;\n            std::cin &gt;&gt; x &gt;&gt; v;\n            q[x].emplace_back(++cnt, i, v);\n        &#125; else &#123;\n            int x, y, v;\n            std::cin &gt;&gt; x &gt;&gt; y &gt;&gt; v;\n            int faa = getLCA(x, y);\n            u[x].emplace_back(i, v), u[y].emplace_back(i, v);\n            if (fa[faa])\n                d[fa[faa]].emplace_back(v);\n        &#125;\n    &#125;\n    std::vector&lt;long long&gt; res(cnt + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; rt(2, std::vector&lt;int&gt; (n + 1));\n    t[0].rv = inf;\n    DFS = [&amp;](int x, int fa) &#123;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                merge(rt[0][x], rt[0][i], 1, lim);\n                merge(rt[1][x], rt[1][i], 1, lim);\n            &#125;\n        for (auto [t, v] : u[x]) &#123;\n            upd(rt[0][x], 1, lim, v, t, v);\n            upd(rt[1][x], 1, lim, lim - v + 1, t, v);\n        &#125;\n        for (auto v : d[x]) &#123;\n            upd(rt[0][x], 1, lim, v, inf, 0);\n            upd(rt[1][x], 1, lim, lim - v + 1, inf, 0);\n        &#125;\n        for (auto [id, t, v] : q[x]) &#123;\n            qv = t, res[id] = ask(rt[0][x], 1, lim, v, lim);\n            qv = t, res[id] += ask(rt[1][x], 1, lim, lim - v + 1, lim);\n            qv = t, res[id] -= ask(rt[0][x], 1, lim, v, v);\n        &#125;\n    &#125;;\n    DFS(1, -1);\n    for (int i = 1; i &lt;= cnt; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"nastya-and-cbs\">Nastya and CBS</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1340F\" class=\"uri\">https://www.luogu.com.cn/problem/CF1340F</a></p>\n<blockquote>\n<p>ç»™å®šé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„æ‹¬å·åºåˆ—ï¼Œç”± <span class=\"math inline\">\\(k\\)</span> ç§æ‹¬å·å¯¹ï¼ˆ<span class=\"math inline\">\\(-i,i\\)</span> è¡¨ç¤ºç¬¬ <span class=\"math inline\">\\(i\\)</span> ç§å·¦ã€å³æ‹¬å·ï¼‰ç»„æˆï¼Œä½ éœ€è¦ç»´æŠ¤å•ç‚¹ä¿®æ”¹å…ƒç´ ã€åŒºé—´æŸ¥è¯¢æ˜¯å¦ä¸ºåˆæ³•æ‹¬å·åºåˆ—ã€‚</p>\n<p><span class=\"math inline\">\\(1\\le k\\le n\\le 10^5,q\\le 10^5\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>è€ƒè™‘ä¸å¸¦ä¿®ä¸”å…è®¸ <span class=\"math inline\">\\(O(n)\\)</span> è¯¢é—®çš„æƒ…æ™¯ï¼Œç»å…¸é¢˜ï¼Œæ‰«ä¸€éï¼Œç”¨æ ˆç»´æŠ¤å³å¯ï¼›</li>\n<li><p><span class=\"math inline\">\\(k=1\\)</span> æ—¶æ˜¯çº¿æ®µæ ‘ç»å…¸é¢˜ï¼Œå¯ä»¥ç±»æ¯”è¿™ä¸ªç»å…¸é¢˜ï¼Œä»åˆ»ç”»åˆæ³•çš„æ¡ä»¶å…¥æ‰‹ã€‚</p>\nå¦‚æœå­˜åœ¨ç›¸é‚»ä¸”å¯ä»¥åŒ¹é…çš„å¯ä»¥ç›´æ¥æ¶ˆæ‰ï¼Œä¸€ç›´é‡å¤è¿™æ ·çš„æ“ä½œï¼Œæ­¤æ—¶è¦ä¹ˆåŒ…å«ä¸èƒ½åŒ¹é…çš„å­ä¸²ï¼Œå¦‚ <code>&#123;[)&#125;</code>ï¼Œè¦ä¹ˆæ˜¯ <code>)]&#125; (&#123;[&#123;&#123;</code> çš„å½¢å¼ã€‚</li>\n<li>è€ƒè™‘æ€ä¹ˆ pushupï¼Œå‘ç°ä¸­é—´ç”Ÿæˆçš„ä¸€æ®µ <code>([()])</code> å¿…é¡»å®Œå…¨åŒ¹é…ï¼Œæ¶ˆæ‰å®ƒä»¬ä¹‹åï¼Œå¤§åŒºé—´åˆå˜æˆ <code>)]&#125; (&#123;[&#123;&#123;</code> çš„å½¢å¼ã€‚</li>\n<li>æ¯æ¬¡ pushup è¦åˆå¹¶çš„åŒºé—´å¾ˆé•¿ï¼Œè€ƒè™‘æ€ä¹ˆå¿«é€Ÿåœ°åšã€æ¶ˆé™¤ç›¸é‚»åŒ¹é…æ‹¬å·ã€è¿™ä¸€æ­¥ã€‚å®¹æ˜“æƒ³åˆ°è®°å½•ä¸€æ®µæ‹¬å·ï¼ˆä¾‹ï¼š<code>([&#123;</code>ï¼‰åŠå…¶å¯¹åº”åæ‹¬å·ï¼ˆä¾‹ï¼š<code>&#125;])</code>ï¼‰çš„å“ˆå¸Œå€¼ï¼Œcheck æ˜¯å¦ç›¸ç­‰ï¼Œç„¶åå°±å¯ä»¥ä¸ç®¡å®ƒä»¬äº†ï¼Œå¹¶ä¸æ˜¯çœŸçš„è¦åˆ å»ã€‚</li>\n<li><p>çº¿æ®µæ ‘ä¸èƒ½ç»´æŠ¤æ¯ä¸ªå‰åç¼€çš„å“ˆå¸Œå€¼ï¼Œä½†éœ€è¦çš„åªæ˜¯åœ¨<strong>åˆ é™¤è¿ç»­åŒ¹é…æ‹¬å·å</strong>é•¿åº¦ä¸º <span class=\"math inline\">\\(len\\)</span> çš„å“ˆå¸Œå€¼ï¼Œå¯ä»¥çº¿æ®µæ ‘ä¸ŠäºŒåˆ†ã€‚</p>\nè¿™ä¸ªè¿‡ç¨‹æœ‰ç‚¹å›°éš¾ï¼Œéœ€è¦åœ¨è¯¢é—®çš„åŒæ—¶åŒ¹é…ã€æ¶ˆé™¤ï¼›ä½†å‘ç°æ‰€è°“æ¶ˆé™¤å°±æ˜¯å¯¹ä½ç›¸å‡ï¼Œæ³¨æ„ä¸€ä¸‹ä»€ä¹ˆæ—¶å€™ç§»ä½ï¼Œè¿˜æ˜¯å¥½å†™çš„ã€‚</li>\n<li><p>è¯¢é—®çœ‹ä¼¼ä¸å¤ªå¯åšï¼Œå› ä¸ºä¸­é€”çš„ç­”æ¡ˆä¸æ˜¯çº¿æ®µæ ‘çš„èŠ‚ç‚¹ï¼›å¦‚æœæŠŠè¯¢é—®çœ‹æˆä¸€æ¬¡ä¿®æ”¹ï¼Œå°±å¯ä»¥ç”¨ç±»ä¼¼å¯æŒä¹…åŒ–çš„æ–¹å¼å®ç°ã€‚</p>\n<p>ç”±äºå¹¶ä¸æ˜¯çœŸçš„è¦å¯æŒä¹…åŒ–ï¼Œè¯¢é—®æ–°å»ºçš„ç‚¹å¯ä»¥é‡å¤åˆ©ç”¨ã€‚å¦‚æœä¸é‡å¤åˆ©ç”¨ï¼Œæ¯æ¬¡è¯¢é—®æœ€å¤šæ–°å»º <span class=\"math inline\">\\(O(\\log n)\\)</span> ä¸ªç‚¹ï¼Œç©ºé—´å¤æ‚åº¦ <span class=\"math inline\">\\(O(q\\log n)\\)</span>ï¼Œåœ¨ CF ä¸Šæœ‰ç‚¹å¡ï¼Œä¹Ÿæ˜¯èƒ½è¿‡çš„ã€‚</p></li>\n</ul>\n<details>\n<p>Hintï¼šæœ‰å¡ 998244353 çš„ Hackï¼Œæ•…å¯ä»¥ç”¨ 1e9 + 7 å½“æ¨¡æ•°ï¼›WA on 7 æ˜¯æ­£ç¡®æ€§æœ‰å·¨å¤§é—®é¢˜ï¼ŒWA on 8 å¯èƒ½æ˜¯ long long æ²¡å¼€å®Œ / æ•°ç»„å¼€å°äº† / å“ˆå¸Œæ–¹å‘æœ‰é—®é¢˜ / çº¿æ®µæ ‘ä¸ŠäºŒåˆ†å†™æŒ‚äº†ï¼ˆé€šå¸¸æ˜¯æ¶ˆæ‹¬å·æ¶ˆé”™äº†ï¼‰ã€‚å‰äººè¸©å‘åäººå˜²ç¬‘ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nconst int base = 1e5 + 3;\nconst int maxn = 7e5 + 5;\nstruct Node &#123;\n    bool flag;\n    long long hr0, hl1;\n    int l, r, lc, rc, ll, rl;\n    Node&amp; operator= (const Node &amp;q) &#123;\n        flag = q.flag, hr0 = q.hr0, hl1 = q.hl1;\n        l = q.l, r = q.r, ll = q.ll, rl = q.rl;\n        return *this;\n    &#125;\n    Node operator+ (const Node &amp;q) const;\n&#125; t[maxn &lt;&lt; 2];\nint tot;\nint a[maxn];\nlong long bpow[maxn], inv[maxn];\nlong long askhl1(const Node &amp;p, int k) &#123;\n    if (k == 0)\n        return 0ll;\n    if (k &gt; p.ll)\n        return -1ll;\n    if (p.ll == k)\n        return p.hl1;\n    int ll = t[p.lc].ll, rl = t[p.lc].rl;\n    if (ll &gt;= k)\n        return askhl1(t[p.lc], k);\n    k -= ll, k += rl;\n    auto hl1 = askhl1(t[p.rc], k);\n    hl1 = ((hl1 + mod - t[p.lc].hr0) * inv[rl] % mod * bpow[ll] % mod + t[p.lc].hl1) % mod;\n    return hl1;\n&#125;\nlong long askhr0(const Node &amp;p, int k) &#123;\n    if (k == 0)\n        return 0ll;\n    if (k &gt; p.rl)\n        return -1ll;\n    if (p.rl == k)\n        return p.hr0;\n    int rl = t[p.rc].rl, ll = t[p.rc].ll;\n    if (rl &gt;= k)\n        return askhr0(t[p.rc], k);\n    k -= rl, k += ll;\n    auto hr0 = askhr0(t[p.lc], k);\n    hr0 = ((hr0 + mod - t[p.rc].hl1) * inv[ll] % mod * bpow[rl] % mod + t[p.rc].hr0) % mod;\n    return hr0;\n&#125;\nNode Node::operator+ (const Node &amp;q) const  &#123;\n    Node res;\n    res.l = l, res.r = q.r;\n    if (flag || q.flag)\n        res.flag = 1;\n    else &#123;\n        if (rl == q.ll) &#123;\n            if (hr0 == q.hl1) &#123;\n                res.flag = 0;\n                res.ll = ll, res.rl = q.rl;\n                res.hl1 = hl1, res.hr0 = q.hr0;\n            &#125;\n            else\n                res.flag = 1;\n        &#125;\n        else if (rl &lt; q.ll) &#123;\n            auto qhl1 = askhl1(q, rl);\n            if (hr0 == qhl1) &#123;\n                res.flag = 0;\n                res.ll = ll + q.ll - rl, res.rl = q.rl;\n                res.hl1 = ((q.hl1 + mod - qhl1) % mod * inv[rl] % mod * bpow[ll] % mod + hl1) % mod;\n                res.hr0 = q.hr0;\n            &#125;\n            else\n                res.flag = 1;\n        &#125;\n        else &#123;\n            auto phr0 = askhr0(*this, q.ll);\n            if (phr0 == q.hl1) &#123;\n                res.flag = 0;\n                res.ll = ll, res.rl = rl - q.ll + q.rl;\n                res.hl1 = hl1;\n                res.hr0 = ((hr0 + mod - phr0) % mod * inv[q.ll] % mod * bpow[q.rl] % mod + q.hr0) % mod;\n            &#125;\n            else\n                res.flag = 1;\n        &#125;\n    &#125;\n    return res;\n&#125;\nvoid bld(int &amp;p, int l, int r) &#123;\n    p = ++tot;\n    if (l == r) &#123;\n        t[p].l = t[p].r = l;\n        if (a[l] &lt; 0)\n            t[p].ll = 1, t[p].hl1 = -a[l];\n        else\n            t[p].rl = 1, t[p].hr0 = a[l];\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(t[p].lc, l, mid), bld(t[p].rc, mid + 1, r);\n    t[p] = t[t[p].lc] + t[t[p].rc];\n    return;\n&#125;\nvoid add(int p, int x, int v) &#123;\n    if (t[p].l == t[p].r) &#123;\n        if (v &lt; 0) &#123;\n            t[p].rl = 0, t[p].hr0 = 0ll;\n            t[p].ll = 1, t[p].hl1 = -v;\n        &#125;\n        else &#123;\n            t[p].ll = 0, t[p].hl1 = 0ll;\n            t[p].rl = 1, t[p].hr0 = v;\n        &#125;\n        return;\n    &#125;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(t[p].lc, x, v);\n    else\n        add(t[p].rc, x, v);\n    t[p] = t[t[p].lc] + t[t[p].rc];\n    return;\n&#125;\nint ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return p;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (r &lt;= mid)\n        return ask(t[p].lc, l, r);\n    if (l &gt; mid)\n        return ask(t[p].rc, l, r);\n    int q = ++tot;\n    t[q].lc = ask(t[p].lc, l, r);\n    t[q].rc = ask(t[p].rc, l, r);\n    t[q] = t[t[q].lc] + t[t[q].rc];\n    return q;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, k, rt = 0;\n    std::cin &gt;&gt; n &gt;&gt; k;\n    bpow[0] = inv[0] = 1ll;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[1] = qkp(base, mod - 2);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        bpow[i] = bpow[i - 1] * base % mod;\n        if (i &gt;= 2)\n            inv[i] = inv[i - 1] * inv[1] % mod;\n    &#125;\n    bld(rt, 1, n);\n    int q;\n    std::cin &gt;&gt; q;\n    for (int op; q--; ) &#123;\n        std::cin &gt;&gt; op;\n        if (op == 1) &#123;\n            int x, v;\n            std::cin &gt;&gt; x &gt;&gt; v;\n            add(1, x, v);\n        &#125;\n        else &#123;\n            int l, r;\n            std::cin &gt;&gt; l &gt;&gt; r;\n            if ((r - l + 1) &amp; 1)\n                std::cout &lt;&lt; &quot;No&quot; &lt;&lt; &#39;\\n&#39;;\n            else &#123;\n                auto s(ask(1, l, r));\n                std::cout &lt;&lt; ((!t[s].flag &amp;&amp; !t[s].ll &amp;&amp; !t[s].rl) ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n            &#125;\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"hungry-cow-p\"># Hungry Cow P</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P9130\" class=\"uri\">https://www.luogu.com.cn/problem/P9130</a></p>\n<hr />\n<h4 id=\"ç‰›åŠä»™çš„å¦¹å­åºåˆ—\"># ç‰›åŠä»™çš„å¦¹å­åºåˆ—</h4>\n<p><a href=\"http://222.180.160.110:61235/problem/29550\" class=\"uri\">http://222.180.160.110:61235/problem/29550</a></p>\n<hr />\n<h4 id=\"organizing-a-race\"># Organizing a Race</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/CF671E\" class=\"uri\">https://www.luogu.com.cn/problem/CF671E</a></p>\n<p>è¿™ä¸ªé¢˜ä¸å¤ªåº”è¯¥æ”¾åœ¨è¿™é‡Œçš„ï¼Œå› ä¸ºå­˜åœ¨åªç”¨ä¸€åª log çš„çº¯çº¿æ®µæ ‘ä¸ŠäºŒåˆ†åšæ³•ï¼Œç”¨æ¥¼æˆ¿é‡å»ºæ˜¾å¾—æœ‰ç‚¹å”äº†</p>\n<hr />\n<h4 id=\"è½¬ç›˜\"># è½¬ç›˜</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P4425\" class=\"uri\">https://www.luogu.com.cn/problem/P4425</a></p>\n<hr />\n<h4 id=\"å‰è¿›å››æ¥¼æˆ¿é‡å»º-ver\"># å‰è¿›å››ï¼ˆæ¥¼æˆ¿é‡å»º verï¼‰</h4>\n<p><a href=\"https://uoj.ac/problem/515\" class=\"uri\">https://uoj.ac/problem/515</a></p>\n<p>å¦è§ <a href=\"#-å‰è¿›å››segment-tree-beats-ver\">segment tree beats ver</a></p>\n<h3 id=\"å¯æŒä¹…åŒ–çº¿æ®µæ ‘\">å¯æŒä¹…åŒ–çº¿æ®µæ ‘</h3>\n<h4 id=\"card-game\"># Card Game</h4>\n<p><a href=\"https://qoj.ac/problem/8240\" class=\"uri\">https://qoj.ac/problem/8240</a></p>\n<hr />\n<h3 id=\"å†å²ä¿¡æ¯\">å†å²ä¿¡æ¯</h3>\n<ul>\n<li>ä¸€ç±»å½¢å¦‚ã€è¯¢é—® <span class=\"math inline\">\\([l,r]\\)</span> å†…åˆæ³•å­åŒºé—´æ•°é‡ã€çš„é¢˜ç›®æ˜¯å¯ä»¥è€ƒè™‘å†å²ä¿¡æ¯çš„</li>\n<li>å…·ä½“åœ°ï¼Œæ‰«æçº¿ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(r\\)</span>ï¼ŒæŠŠåˆæ³•çš„ <span class=\"math inline\">\\(l\\)</span> ç­”æ¡ˆåŠ ä¸€</li>\n<li>åœ¨æ¯ä¸ª <span class=\"math inline\">\\(r\\)</span> å¤„æŸ¥è¯¢ <span class=\"math inline\">\\([l,r]\\)</span> çš„åŒºé—´å’Œå°±å¯ä»¥å¾—å‡ºç­”æ¡ˆ</li>\n</ul>\n<h4 id=\"é“ƒåŸéœ²éœ²\">é“ƒåŸéœ²éœ²</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P8528\" class=\"uri\">https://www.luogu.com.cn/problem/P8528</a></p>\n<ul>\n<li>é¢˜ç›®å½¢å¼æ»¡è¶³æ ‘ä¸Šæ”¯é…å¯¹ï¼Œè€ƒè™‘å¯»æ‰¾æ”¯é…å…³ç³»</li>\n<li><p>å›ºå®šä¸€ä¸ª LCA <span class=\"math inline\">\\(z\\)</span>ï¼Œè®¨è®º <span class=\"math inline\">\\(a_z\\)</span> ä¸ <span class=\"math inline\">\\(a_x,a_y\\)</span> çš„å¤§å°å…³ç³»ç»™ <span class=\"math inline\">\\([1,a_x]\\)</span> é—´çš„ <span class=\"math inline\">\\(l\\)</span> å¸¦æ¥çš„é™åˆ¶ï¼š</p>\n<ul>\n<li><span class=\"math inline\">\\(a_z\\in[a_x,a_y]\\)</span>ï¼Œ<span class=\"math inline\">\\((x,y)\\)</span> æ€»æ˜¯åˆæ³•ï¼Œæ— é™åˆ¶ã€‚</li>\n<li><span class=\"math inline\">\\(a_z&lt;a_x\\)</span>ï¼Œå¯¹äº <span class=\"math inline\">\\(r\\ge a_y\\)</span>ï¼Œå½“ <span class=\"math inline\">\\(l\\in(a_z,a_x]\\)</span> æ—¶ï¼Œ<span class=\"math inline\">\\((x,y)\\)</span> éæ³•ã€‚</li>\n<li><span class=\"math inline\">\\(a_z&gt;a_y\\)</span>ï¼Œå½“ <span class=\"math inline\">\\(r\\in[a_y,a_z)\\)</span> æ—¶ï¼Œ<span class=\"math inline\">\\((x,y)\\)</span> æ€»æ˜¯éæ³•ã€‚æ­¤æ—¶æ‰€æœ‰ <span class=\"math inline\">\\(l\\in[1,a_x]\\)</span> ä¸å¯é€‰ã€‚</li>\n</ul></li>\n<li>å‘ç°å›ºå®š <span class=\"math inline\">\\(a_z,a_x\\)</span>ï¼Œé‚£ä¹ˆå½“ <span class=\"math inline\">\\(a_y\\)</span> è¶Šé è¿‘ <span class=\"math inline\">\\(a_x\\)</span> æ—¶ç»™å‡ºçš„é™åˆ¶è¶Šç´§ï¼Œåä¹‹äº¦ç„¶ï¼Œå°±å¯ä»¥å¾—åˆ°è¿™æ ·çš„æ”¯é…å…³ç³»</li>\n<li>å®¹æ˜“å‘ç°å½“ <span class=\"math inline\">\\(a_z\\notin [a_x,a_y]\\)</span> æ—¶ï¼Œ<span class=\"math inline\">\\((x,y)\\)</span> ä¸åˆæ³•ï¼›æ•…åªéœ€è¦åœ¨ dsu on tree ä¸Šæ‰¾åˆ° <span class=\"math inline\">\\(a_x\\)</span> çš„å‰é©±ã€åç»§å¹¶ç»Ÿè®¡æ”¯é…å¯¹å³å¯</li>\n<li><p>è€ƒè™‘è¯¢é—®ï¼Œå‘ç°éœ€è¦ç»´æŠ¤åŒºé—´åŠ ã€åŒºé—´å†å² 0 ä¸ªæ•°ï¼Œæ˜¯å¥½åšçš„ï¼ˆè¿™é‡Œçš„åŒºé—´åŠ å¹¶ä¸å¯¹åº” summary ä¸­æåˆ°çš„åŒºé—´åŠ ï¼›å¯¹ 0 çš„æ›´æ–°æ‰æ˜¯ï¼‰ã€‚</p></li>\n</ul>\n<p>å†å²æ ‡è®°çš„ä¸‹ä¼ éœ€è¦æ ¼å¤–æ³¨æ„ä¸€ä¸‹ï¼Œåº”è¯¥åªä¿è¯æ ‡è®°æœŸé—´å­˜åœ¨ 0 çš„åŒºé—´æ‹¥æœ‰æ‡’æ ‡è®°ï¼›å…·ä½“åœ°ï¼Œ<strong>åªåº”å°†å…¶ä¸‹ä¼ åˆ°å’Œå½“å‰åŒºé—´æœ€å°å€¼ç›¸åŒçš„å­åŒºé—´</strong>ï¼ˆå…·ä½“å¯ä»¥çœ‹ä»£ç ï¼‰ï¼Œå®¹æ˜“è¯æ˜æ˜¯å¯¹çš„ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 2e5 + 5;\nstruct node &#123;\n    long long s;\n    int l, r, u, c, d, d1;\n    node operator+ (const node q) const &#123;\n        node res;\n        res.s = s + q.s;\n        res.l = l, res.r = q.r;\n        res.u = std::min(u, q.u);\n        res.d = res.d1 = res.c = 0;\n        if (u == res.u)\n            res.c = c;\n        if (q.u == res.u)\n            res.c += q.c;\n        return res;\n    &#125;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].c = r - l + 1;\n    t[p].l = l, t[p].r = r;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    if (t[p].d) &#123;\n        t[lt].d += t[p].d, t[lt].u += t[p].d;\n        t[rt].d += t[p].d, t[rt].u += t[p].d;\n        t[p].d = 0;\n    &#125;\n    if (t[p].d1) &#123;\n        if (t[lt].u == t[p].u) &#123;\n            t[lt].s += (long long)t[lt].c * t[p].d1;\n            t[lt].d1 += t[p].d1;\n        &#125;\n        if (t[rt].u == t[p].u) &#123;\n            t[rt].s += (long long)t[rt].c * t[p].d1;\n            t[rt].d1 += t[p].d1;\n        &#125;\n        t[p].d1 = 0;\n    &#125;\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        t[p].d += v, t[p].u += v;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        add(lt, l, r, v);\n    if (r &gt; mid)\n        add(rt, l, r, v);\n    t[p] = t[lt] + t[rt];\n    return;\n&#125;\nvoid upd(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        if (!t[p].u)\n            t[p].s += t[p].c, ++t[p].d1;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        upd(lt, l, r);\n    if (r &gt; mid)\n        upd(rt, l, r);\n    t[p] = t[lt] + t[rt];\n    return;\n&#125;\nlong long ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].s;\n    pushdown(p);\n    auto res(0ll);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        res = ask(lt, l, r);\n    if (r &gt; mid)\n        res += ask(rt, l, r);\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1); \n    for (int i = 2, x; i &lt;= n; ++i)\n        std::cin &gt;&gt; x, g[x].push_back(i);\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g[x]) &#123;\n            DFS(i);\n            siz[x] += siz[i];\n            if (siz[i] &gt; siz[son[x]])\n                son[x] = i;\n        &#125;\n        return;\n    &#125;;\n    DFS(1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; u1(n + 1), u2(n + 1);\n    std::function&lt;void(int, int, std::set&lt;int&gt; &amp;)&gt; DFS2 = [&amp;](int col, int x, std::set&lt;int&gt; &amp;t) &#123;\n        auto p = t.lower_bound(a[x]);\n        if (col == -1)\n            t.insert(a[x]);\n        else &#123;\n            if (p != t.begin()) &#123;\n                int y = *std::prev(p);\n                if (col &lt; y)\n                    u1[a[x]].emplace_back(col + 1, y);\n                else if (col &gt; a[x]) &#123;\n                    u1[a[x]].emplace_back(1, y);\n                    u2[col].emplace_back(1, y);\n                &#125;\n            &#125;\n            if (p != t.end()) &#123;\n                int y = *p;\n                if (col &lt; a[x])\n                    u1[y].emplace_back(col + 1, a[x]);\n                else if (col &gt; y) &#123;\n                    u1[y].emplace_back(1, a[x]);\n                    u2[col].emplace_back(1, a[x]);\n                &#125;\n            &#125;\n        &#125;\n        for (auto i : g[x])\n            DFS2(col, i, t);\n        return;\n    &#125;;\n    std::function&lt;void(int, std::set&lt;int&gt; &amp;)&gt; DFS1 = [&amp;](int x, std::set&lt;int&gt; &amp;t) &#123;\n        if (son[x])\n            DFS1(son[x], t);\n        for (auto i : g[x])\n            if (i != son[x]) &#123;\n                std::set&lt;int&gt; nt;\n                DFS1(i, nt);\n            &#125;\n        t.insert(a[x]);\n        for (auto i : g[x])\n            if (i != son[x])\n                DFS2(a[x], i, t), DFS2(-1, i, t);\n        return;\n    &#125;;\n    &#123;\n        std::set&lt;int&gt; t;\n        DFS1(1, t);\n    &#125;\n    std::vector&lt;long long&gt; res(m + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; t(n + 1);\n    for (int i = 1, l, r; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r;\n        t[r].emplace_back(l, i);\n    &#125;\n    bld(1, 1, n);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (auto [l, r] : u1[i])\n            add(1, l, r, 1);\n        for (auto [l, r] : u2[i])\n            add(1, l, r, -1);\n        upd(1, 1, i);\n        for (auto [l, id] : t[i])\n            res[id] = ask(1, l, i);\n    &#125;\n    for (int i = 1; i &lt;= m; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"prof.-pangs-sequence-test_90\">Prof.Â Pangâ€™s sequence / TEST_90</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P10822\" class=\"uri\">https://www.luogu.com.cn/problem/P10822</a> / <a href=\"https://www.luogu.com.cn/problem/P9990\" class=\"uri\">https://www.luogu.com.cn/problem/P9990</a></p>\n<ul>\n<li>ç¦»çº¿æ‰«æçº¿ï¼Œå¯¹äºå½“å‰å³ç«¯ç‚¹ <span class=\"math inline\">\\(r\\)</span>ï¼Œè®°å½•æ¯ç§æ•°æœ€åä¸€æ¬¡å‡ºç°çš„ä½ç½® <span class=\"math inline\">\\(pos\\)</span>ã€‚ä»¤ <span class=\"math inline\">\\(r\\)</span> çš„é¢œè‰²ä¸º <code>1</code>ï¼Œä»å³åˆ°å·¦ï¼Œæ¯ç¢°åˆ°ä¸€ä¸ªæ–°çš„ <span class=\"math inline\">\\(pos\\)</span> å°±åˆ‡æ¢é¢œè‰²ã€‚</li>\n<li>æ˜¾ç„¶å¯¹äºå½“å‰ <span class=\"math inline\">\\(r\\)</span>ï¼Œåº”è¯¥è¢«åŠ ä¸€çš„ <span class=\"math inline\">\\(l\\)</span> å°±æ˜¯é¢œè‰²ä¸º <code>1</code> çš„è¿™äº›ä½ç½®ã€‚</li>\n<li>è€ƒè™‘æ›´å¿«åœ°ç»´æŠ¤è¿™ä¸ªè¿‡ç¨‹ï¼Œä¹Ÿå°±æ˜¯åœ¨ <span class=\"math inline\">\\(r\\)</span> çš„é¢œè‰²å’Œ <span class=\"math inline\">\\(r-1\\)</span> ä¸åŒæ—¶å°±å¯ä»¥å¯¹ <span class=\"math inline\">\\([1,r)\\)</span> åšä¸€æ¬¡ flipï¼Œæ˜¯å¯è¡Œçš„</li>\n<li>åœ¨æ¯ä¸ª <span class=\"math inline\">\\(r\\)</span> å¤„æŸ¥è¯¢ <span class=\"math inline\">\\([l,r]\\)</span> çš„åŒºé—´å’Œå³å¯ã€‚</li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 5e5 + 5;\nstruct &#123;\n    long long s;\n    int l, r, d0, d1, df, ds, u0, u1;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid pushup(int p) &#123;\n    t[p].u0 = t[lt].u0 + t[rt].u0;\n    t[p].u1 = t[lt].u1 + t[rt].u1;\n    return;\n&#125;\nvoid pushval(int p, long long v0, long long v1, bool f) &#123;\n    if (f) &#123;\n        t[p].df ^= 1;\n        std::swap(t[p].u0, t[p].u1);\n        std::swap(t[p].d0, t[p].d1);\n    &#125;\n    t[p].d0 += v0, t[p].d1 += v1;\n    t[p].s += t[p].u0 * v0 + t[p].u1 * v1;\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    pushval(lt, t[p].d0, t[p].d1, t[p].df);\n    pushval(rt, t[p].d0, t[p].d1, t[p].df);\n    t[p].d0 = t[p].d1 = t[p].df = 0;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    t[p].u0 = r - l + 1;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid flip(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        pushval(p, 0, 0, 1);\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        flip(lt, l, r);\n    if (r &gt; mid)\n        flip(rt, l, r);\n    pushup(p);\n    return;\n&#125;\nlong long ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].s;\n    pushdown(p);\n    auto res(0ll);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        res = ask(lt, l, r);\n    if (r &gt; mid)\n        res += ask(rt, l, r);\n    return res;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), la(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    int m;\n    std::cin &gt;&gt; m;\n    std::vector&lt;long long&gt; res(m + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; u(n + 1);\n    for (int i = 1, l, r; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r;\n        u[r].emplace_back(l, i);\n    &#125;\n    bld(1, 1, n);\n    for (int r = 1; r &lt;= n; ++r) &#123;\n        flip(1, la[a[r]] + 1, r);\n        pushval(1, 0, 1, 0);\n        for (auto [l, id] : u[r])\n            res[id] = ask(1, l, r);\n        la[a[r]] = r;\n    &#125;\n    for (int i = 1; i &lt;= m; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"æ¯”èµ›\"># æ¯”èµ›</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P8868\" class=\"uri\">https://www.luogu.com.cn/problem/P8868</a></p>\n<hr />\n<h4 id=\"v\"># V</h4>\n<p><a href=\"https://uoj.ac/problem/164\" class=\"uri\">https://uoj.ac/problem/164</a></p>\n<hr />\n<h4 id=\"cartesian-tree\"># Cartesian Tree</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/CF1290E\" class=\"uri\">https://www.luogu.com.cn/problem/CF1290E</a></p>\n<hr />\n<h4 id=\"rprmq1\"># rprmq1</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P6109\" class=\"uri\">https://www.luogu.com.cn/problem/P6109</a></p>\n<hr />\n<h4 id=\"rpfrdtzls\"># rpfrdtzls</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P9057\" class=\"uri\">https://www.luogu.com.cn/problem/P9057</a></p>\n<hr />\n<h3 id=\"çº¿æ®µæ ‘åˆå¹¶\">çº¿æ®µæ ‘åˆå¹¶</h3>\n<p>æ ‘ä¸Šçš„çº¿æ®µæ ‘åˆå¹¶éƒ½å¾ˆç†Ÿæ‚‰äº†ï¼Œåˆ©ç”¨äº†çº¿æ®µæ ‘åˆå¹¶æ˜¯çº¿æ€§çš„ï¼Œä»¥åŠ dsu on tree</p>\n<p>ä¸å¦‚è¯´ç»å¤§å¤šæ•°çº¿æ®µæ ‘åˆå¹¶éƒ½æœ‰æ ‘ä¸ŠèƒŒæ™¯ï¼Œå› ä¸ºè‡ªå¸¦åˆå¹¶é¡ºåºå’Œå¤æ‚åº¦ä¿è¯</p>\n<p>Tipï¼šæ ‘ä¸Šåˆå¹¶çš„èƒŒæ™¯ä¸‹ï¼Œçº¿æ®µæ ‘åˆå¹¶çš„è¡¨ç°ä¼šæ¯”ä¸»å¸­æ ‘ä¼˜ç§€å¾ˆå¤šï¼Œå› ä¸ºå‰è€…è·‘ä¸æ»¡</p>\n<p>ä¸åœ¨æ ‘ä¸Šçš„é—®é¢˜ï¼Œé¢˜ç›®å¯èƒ½ä¼šé€šè¿‡å„ç§æ–¹å¼ä¿è¯å¤æ‚åº¦ï¼Œæ¯”å¦‚ä¿è¯æ¯ä¸ªç‚¹åªä¼šè¢«åˆå¹¶ä¸€æ¬¡ä¹‹ç±»</p>\n<hr />\n<h4 id=\"è¿ç§»è®¡åˆ’-migration-plan\"># è¿ç§»è®¡åˆ’ / Migration Plan</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P11993\" class=\"uri\">https://www.luogu.com.cn/problem/P11993</a></p>\n<hr />\n<h4 id=\"æ°¸æ— ä¹¡\"># æ°¸æ— ä¹¡</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P3224\" class=\"uri\">https://www.luogu.com.cn/problem/P3224</a></p>\n<hr />\n<h4 id=\"è¯­è¨€\"># è¯­è¨€</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P5327\" class=\"uri\">https://www.luogu.com.cn/problem/P5327</a></p>\n<hr />\n<h4 id=\"æ¢¦å¹»å¸ƒä¸\"># æ¢¦å¹»å¸ƒä¸</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P3201\" class=\"uri\">https://www.luogu.com.cn/problem/P3201</a></p>\n<hr />\n<p>è¿˜æœ‰ä¸¤ä¸ªæ¯”è¾ƒå±çš„ P7563 å’Œ P7963</p>\n<h3 id=\"æ‰«æçº¿\">æ‰«æçº¿</h3>\n<p>ç¦»çº¿ï¼ŒæŒ‰ç…§ä¸‹æ ‡æ’åºï¼Œæ‰«ä¸€éå¤„ç†è¯¢é—®ï¼Œå°±å¯ä»¥åˆ©ç”¨ã€æ‰€æœ‰æ›´é å‰çš„ä¸‹æ ‡éƒ½ä»¥è¢«è®¡ç®—è¿‡ã€æ¥å¤„ç†é—®é¢˜</p>\n<p>ä¸åªå±€é™äºåŒºé—´è¯¢é—®ï¼Œå•ç‚¹çš„å¯èƒ½åè€Œæ›´éš¾ä¸€ç‚¹ï¼Œéœ€è¦å‘ç°å’Œä¸‹æ ‡å¤§å°æœ‰å…³çš„æ€§è´¨</p>\n<h4 id=\"ç­‰å·®å­åºåˆ—\">ç­‰å·®å­åºåˆ—</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P2757\" class=\"uri\">https://www.luogu.com.cn/problem/P2757</a></p>\n<blockquote>\n<p>ç»™å®šä¸€ä¸ª <span class=\"math inline\">\\(n\\)</span> çš„æ’åˆ—ï¼Œé—®æ˜¯å¦èƒ½æ‰¾åˆ° <span class=\"math inline\">\\(len\\ge 3\\)</span> çš„å­åºåˆ—ï¼Œä½¿å¾—å…¶æ˜¯ç­‰å·®çš„ã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 5\\times 10^5\\)</span>ã€‚</p>\n</blockquote>\n<p>æ ¹æ®å•è°ƒæ€§ï¼Œå¯ä»¥ç®€åŒ–ä¸º <span class=\"math inline\">\\(len=3\\)</span> æ—¶çš„ç­”æ¡ˆ</p>\n<p>ä¹Ÿå°±æ˜¯å¯¹äºä¸­é¡¹ <span class=\"math inline\">\\(j\\)</span>ï¼Œèƒ½ä¸èƒ½æ‰¾åˆ° <span class=\"math inline\">\\(i&lt;j&lt;k\\)</span>ï¼Œä½¿å¾— <span class=\"math inline\">\\(a_j-a_i=a_k-a_j\\)</span>ã€‚ä»ä¸‹æ ‡å‡ºå‘ï¼Œå·®å€¼æ˜¯ä¸å¥½ç»´æŠ¤çš„ï¼›æ³¨æ„åˆ°æ˜¯æ’åˆ—ï¼Œå¯ä»¥ä»å€¼å‡ºå‘ï¼Œè½¬åŒ–æˆæ˜¯å¦å­˜åœ¨ä¸€ä¸ª <span class=\"math inline\">\\(d\\)</span>ï¼Œä½¿å¾— <span class=\"math inline\">\\(a_j-d\\)</span> åœ¨ä¹‹å‰å‡ºç°ï¼Œ<span class=\"math inline\">\\(a_j+d\\)</span> åœ¨ä¹‹åå‡ºç°ã€‚</p>\n<p>åˆ©ç”¨ä¸‹æ ‡ã€ä¹‹å‰ã€å’Œã€ä¹‹åã€çš„é™åˆ¶ï¼Œåšæ‰«æçº¿ï¼ŒæŸ¥çœ‹æ˜¯å¦å­˜åœ¨ <span class=\"math inline\">\\(d\\)</span> ä½¿ <span class=\"math inline\">\\(a_j-d\\)</span> å‡ºç°è¿‡ä½†æ˜¯ <span class=\"math inline\">\\(a_j+d\\)</span> æ²¡æœ‰å‡ºç°è¿‡ï¼›è¿˜æ˜¯å› ä¸ºæ˜¯æ’åˆ—ï¼Œæ•°é‡åªä¼šä¸º <span class=\"math inline\">\\(0\\)</span> æˆ– <span class=\"math inline\">\\(1\\)</span>ï¼Œå¦‚æœéæ³•è¯´æ˜ <span class=\"math inline\">\\(a_j-d\\)</span> å’Œ <span class=\"math inline\">\\(a_j+d\\)</span> éƒ½æ˜¯ <span class=\"math inline\">\\(0\\)</span> æˆ–è€…éƒ½æ˜¯ <span class=\"math inline\">\\(1\\)</span>ï¼Œå‘ç°æ˜¯å…³äº <span class=\"math inline\">\\(a_j\\)</span> çš„å›æ–‡ï¼Œæ•…æƒå€¼çº¿æ®µæ ‘ç»´æŠ¤å“ˆå¸Œï¼Œå¦‚æœ <span class=\"math inline\">\\(a_j\\)</span> ä¸¤ä¾§å…¨éƒ¨å›æ–‡ï¼Œè¯´æ˜ <span class=\"math inline\">\\(j\\)</span> ä¸æ˜¯åˆæ³•ä¸­é¡¹ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nnamespace fastIO &#123;\nconst int LEN = (1 &lt;&lt; 20);\n#ifdef ONLINE_JUDGE\ninline int nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf)\n            return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\ninline bool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF)\n            return 0;\n        if (ch == &#39;-&#39;)\n            f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f)\n        x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0) &#123;\n        putchar(&#39;-&#39;);\n        x = -x;\n    &#125;\n    if (x &gt;= 10)\n        print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x);\n    putchar(ch);\n    return;\n&#125;\n&#125; // namespace fastIO\nnamespace XSC062 &#123;\nusing namespace fastIO;\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nusing sc = unsigned long long;\nconst int p = 13331; // 0103 Â¿Ã‰Â°Â®ÂµÃÃ„Ã³ \nconst int lim = 5e5;\nconst int maxn = 5e5 + 5;\nstruct _ &#123;\n    int l, r;\n    sc lh, rh;\n&#125;;\nint T, n;\nint a[maxn];\nsc base[maxn];\n_ t[maxn &lt;&lt; 2];\nint min(int x, int y) &#123;\n    return x &lt; y ? x : y;\n&#125;\nint max(int x, int y) &#123;\n    return x &gt; y ? x : y;\n&#125;\nvoid pushup(int p) &#123;\n    int ll = t[lt].r - t[lt].l + 1;\n    int rl = t[rt].r - t[rt].l + 1;\n    t[p].lh = t[lt].lh * base[rl] + t[rt].lh;\n    t[p].rh = t[rt].rh * base[ll] + t[lt].rh;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].lh = t[p].rh = 0;\n    t[p].l = l, t[p].r = r;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid);\n    bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid upd(int p, int x, int v) &#123;\n    if (t[p].l == t[p].r) &#123;\n        t[p].lh = t[p].rh = v;\n        return;\n    &#125;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        upd(lt, x, v);\n    else upd(rt, x, v);\n    pushup(p);\n    return;\n&#125;\nsc qryl(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].lh;\n    sc ans = 0;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        ans = qryl(lt, l, r);\n    if (r &gt; mid) &#123;\n        ans *= base[min(r, t[p].r) - mid];\n        ans += qryl(rt, l, r);\n    &#125;\n    return ans;\n&#125;\nsc qryr(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].rh;\n    sc ans = 0;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (r &gt; mid)\n        ans = qryr(rt, l, r);\n    if (l &lt;= mid) &#123;\n        ans *= base[mid - max(l, t[p].l) + 1];\n        ans += qryr(lt, l, r);\n    &#125;\n    return ans;\n&#125;\nint main() &#123;\n    read(T);\n    base[0] = 1;\n    for (int i = 1; i &lt;= lim; ++i)\n        base[i] = base[i - 1] * p;\n    while (T--) &#123;\n        read(n);\n        bld(1, 1, n);\n        for (int i = 1; i &lt;= n; ++i)\n            read(a[i]);\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            int len = min(n - a[i], a[i] - 1);\n            if (i &gt; 1) &#123;\n                upd(1, a[i - 1], 1);\n            &#125;\n            if (len == 0)\n                continue;\n            int l = a[i] - len;\n            int r = a[i] + len;\n            if (qryl(1, l, a[i] - 1) !=\n                qryr(1, a[i] + 1, r)) &#123;\n                puts(&quot;Y&quot;);\n                goto isSol;\n            &#125;\n        &#125;\n        puts(&quot;N&quot;);\n        isSol: ;\n    &#125;\n    return 0;\n&#125;\n&#125; // namespace XSC062\nint main() &#123;\n    XSC062::main();\n    return 0;\n&#125;</code></pre>\n</details>\n<h4 id=\"å°å¥‡çš„ç³–æœ\">å°å¥‡çš„ç³–æœ</h4>\n<p><a href=\"https://hydro.ac/p/bzoj-P4548\" class=\"uri\">https://hydro.ac/p/bzoj-P4548</a></p>\n<blockquote>\n<p>æœ‰ <span class=\"math inline\">\\(N\\)</span> ä¸ªæœ‰é¢œè‰²ï¼ˆ<span class=\"math inline\">\\(M\\)</span> ç§ï¼‰çš„ç‚¹åœ¨å¹³é¢ä¸Šï¼Œåœ¨å¹³é¢ä¸Šå–ä¸€æ¡æ°´å¹³çš„çº¿æ®µï¼Œå¯ä»¥é€‰æ‹©çº¿æ®µä¸Šæ–¹çš„æ‰€æœ‰ç‚¹ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©ä¸‹æ–¹çš„æ‰€æœ‰ç‚¹ã€‚æ‰¾å‡ºä¸€æ¡çº¿æ®µå’Œé€‰å–çš„æ–¹å‘ï¼Œä½¿å¾—åœ¨é€‰å–çš„ç‚¹ä¸åŒ…å«æ‰€æœ‰é¢œè‰²çš„å‰æä¸‹ï¼Œæœ€å¤§åŒ–é€‰åˆ°ç‚¹çš„æ•°é‡ã€‚</p>\n<p><span class=\"math inline\">\\(N,M\\le 10^6,|x|,|y|\\le 10^9\\)</span>ã€‚</p>\n</blockquote>\n<p>å…ˆç¦»æ•£åŒ– + æŒ‰ <span class=\"math inline\">\\(y\\)</span> æ’åºé™ä¸€ç»´ï¼Œè´ªå¿ƒåœ°æšä¸¾æŸç§é¢œè‰² <span class=\"math inline\">\\(c\\)</span> ä¸é€‰ã€‚è€ƒè™‘çº¿æ®µåœ¨å¹³é¢æœ€åº•éƒ¨æ—¶çš„ç­”æ¡ˆï¼Œå–å‡ºæ‰€æœ‰é¢œè‰²ä¸º <span class=\"math inline\">\\(c\\)</span> çš„ç‚¹çš„ <span class=\"math inline\">\\(x\\)</span> åæ ‡ï¼Œåªèƒ½é€‰æ‹©ç›¸é‚»çš„ <span class=\"math inline\">\\(x\\)</span> ä¹‹é—´çš„æ‰€æœ‰ç‚¹ã€‚æšä¸¾æ¯ä¸€å¯¹ç›¸é‚»çš„ç‚¹è®¡ç®—ç­”æ¡ˆã€‚æŠŠçº¿æ®µä¸Šç§»ï¼Œå¦‚æœç¢°åˆ°äº†ä¸€ä¸ªé¢œè‰²ä¸º <span class=\"math inline\">\\(c\\)</span> çš„ç‚¹ï¼Œå°±è¯´æ˜è¿™ä¸ªç‚¹ä¸å†å‚ä¸é™åˆ¶ï¼Œåˆ å»å³å¯ï¼Œè¯¥ç‚¹åŸå‰é©±å’Œåç»§å›´å‡ºæ¥çš„åŒºé—´å°±èƒ½å¤Ÿæ›´æ–°ç­”æ¡ˆã€‚ç”¨é“¾è¡¨ / å•è°ƒæ ˆå°±èƒ½å¾ˆå¿«åœ°ç»´æŠ¤ã€‚</p>\n<p>å…ˆæšä¸¾é¢œè‰²å†è·‘æ‰«æçº¿æ˜¯ <span class=\"math inline\">\\(O(n^2\\log n)\\)</span> çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ã€‚æ³¨æ„åˆ°æ•°æ®ç»“æ„é‡Œå­˜åœ¨å½“å‰é¢œè‰²æ²¡æœ‰å½±å“ï¼Œå› ä¸ºä¸€å®šä¸åœ¨è¯¢é—®åŒºé—´å†…ã€‚æ•´ä½“åšæ‰«æçº¿ï¼Œå¤æ‚åº¦ <span class=\"math inline\">\\(O(n\\log n)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>namespace XSC062 &#123;\nusing namespace fastIO;\nconst int maxn = 2e5 + 5;\nstruct _ &#123;\n    int x, y, c;\n    bool operator&lt; (const _ &amp;q) const &#123;\n        return y &lt; q.y;\n    &#125;\n&#125;;\n_ a[maxn];\nint s[maxn], t[maxn];\nint ls[maxn], rs[maxn];\nint cp[maxn], cn[maxn];\nint pre[maxn], nex[maxn];\nstd::vector&lt;int&gt; g[maxn];\nint div[maxn], Bit[maxn];\nint T, n, k, tot, cnt, now, res;\nint max(int x, int y) &#123; return x &gt; y ? x : y; &#125;\nint lowbit(int x) &#123; return x &amp; -x; &#125;\nvoid add(int x, int v) &#123;\n    for (; x &lt;= n; x += lowbit(x)) Bit[x] += v;\n    return;\n&#125;\nint ask(int x) &#123;\n    int res = 0;\n    for (; x; x -= lowbit(x)) res += Bit[x];\n    return res;\n&#125;\nint ask(int l, int r) &#123;\n    if (l &gt; r) return 0;\n    return ask(r) - ask(l - 1);\n&#125;\nint main() &#123;\n//  freopen(&quot;1.in&quot;, &quot;r&quot;, stdin); \n    read(T);\n    while (T--) &#123;\n        read(n), read(k), now = res = 0;\n        for (int i = 1; i &lt;= k; ++i) &#123;\n            s[i] = ++now, t[i] = ++now;\n            div[s[i]] = 0, div[t[i]] = n + 1;\n            nex[s[i]] = t[i], pre[t[i]] = s[i];\n            pre[s[i]] = nex[t[i]] = 0;\n        &#125;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            read(a[i].x), read(a[i].y), read(a[i].c);\n            ls[i] = a[i].x, rs[i] = a[i].y;\n        &#125;\n        std::sort(a + 1, a + n + 1, [&amp;](_ x, _ y) &#123; return x.x &lt; y.x; &#125;);\n        std::sort(ls + 1, ls + n + 1);\n        std::sort(rs + 1, rs + n + 1);\n        tot = std::unique(ls + 1, ls + n + 1) - ls - 1;\n        cnt = std::unique(rs + 1, rs + n + 1) - rs - 1;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            a[i].x = std::lower_bound(ls + 1, ls + tot + 1, a[i].x) - ls;\n            a[i].y = std::lower_bound(rs + 1, rs + cnt + 1, a[i].y) - rs;\n        &#125;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            div[++now] = a[i].x;\n            add(a[i].x, 1), g[a[i].y].push_back(now);\n            pre[now] = pre[t[a[i].c]], nex[pre[t[a[i].c]]] = now;\n            pre[t[a[i].c]] = now, nex[now] = t[a[i].c];\n        &#125;\n        memcpy(cp, pre, sizeof (cp));\n        memcpy(cn, nex, sizeof (cn));\n        for (int i = 1; i &lt;= k; ++i) &#123;\n            for (int j = s[i]; j != t[i]; j = nex[j])\n                res = max(res, ask(div[j] + 1, div[nex[j]] - 1));\n        &#125;\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            for (auto j : g[i]) add(div[j], -1);\n            for (auto j : g[i]) &#123;\n                res = max(res, ask(div[pre[j]] + 1, div[nex[j]] - 1));\n                nex[pre[j]] = nex[j], pre[nex[j]] = pre[j];\n            &#125;\n        &#125;\n        for (int i = 1; i &lt;= n; ++i) add(a[i].x, 1);\n        for (int i = n; i; --i) &#123;\n            for (auto j : g[i]) add(div[j], -1);\n            for (auto j : g[i]) &#123;\n                res = max(res, ask(div[cp[j]] + 1, div[cn[j]] - 1));\n                cn[cp[j]] = cn[j], cp[cn[j]] = cp[j];\n            &#125;\n        &#125;\n        print(res, &#39;\\n&#39;);\n        for (int i = 1; i &lt;= n; ++i)\n            g[i].clear(), g[i].shrink_to_fit();\n    &#125;\n    return 0;\n&#125;\n&#125; // namespace XSC062</code></pre>\n</details>\n<hr />\n<h4 id=\"rmscne\">rmscne</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P7907\" class=\"uri\">https://www.luogu.com.cn/problem/P7907</a></p>\n<blockquote>\n<p>ç»™å®šé•¿ä¸º <span class=\"math inline\">\\(n\\)</span> çš„åºåˆ—ï¼Œ<span class=\"math inline\">\\(q\\)</span> æ¬¡è¯¢é—® <span class=\"math inline\">\\([l,r]\\)</span> ä¸­çš„æœ€çŸ­å­åŒºé—´ <span class=\"math inline\">\\([l&#39;,r&#39;]\\)</span>ï¼Œä½¿å¾—å…¶åŒ…å« <span class=\"math inline\">\\([l,r]\\)</span> ä¸­å‡ºç°çš„å…¨éƒ¨å€¼ã€‚è¾“å‡ºé•¿åº¦å³å¯ã€‚</p>\n<p><span class=\"math inline\">\\(n,q,V\\le 2\\times 10^6\\)</span>ã€‚</p>\n</blockquote>\n<p>åŒºé—´é‡Œé¢æ‰¾å­åŒºé—´ä¹Ÿæ˜¯æ‰«æçº¿ç»å…¸é—®é¢˜ã€‚</p>\n<p>åŒºé—´ç§ç±»æ•°ä¼šæœ‰å‡ ç§æ€è·¯ï¼šé›†åˆå“ˆå¸Œã€å‰é©±åç»§ã€è«é˜Ÿä¹‹ç±»ã€‚PSï¼šè¿™ä¸ªé¢˜ç”¨ ODT å¯ä»¥æ‹¿åˆ°æœ€ä¼˜è§£</p>\n<p>å¯¹äº <span class=\"math inline\">\\(i=1\\sim n\\)</span>ï¼Œä¾æ¬¡è€ƒè™‘ <span class=\"math inline\">\\(i\\)</span> ä½œä¸ºå³ç«¯ç‚¹çš„æƒ…å†µã€‚çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ª <span class=\"math inline\">\\(j\\)</span> ä½œä¸ºå·¦ç«¯ç‚¹æ—¶çš„ <span class=\"math inline\">\\(i-r_j\\)</span>ï¼Œå…¶ä¸­ <span class=\"math inline\">\\([j, r_j]\\)</span> æ˜¯ä¸ <span class=\"math inline\">\\([j,i]\\)</span> ç§ç±»ç›¸åŒçš„æœ€å°åŒºé—´ã€‚</p>\n<p>è¯¢é—®çš„æ—¶å€™ï¼Œåªéœ€è¦æ‰¾åˆ°æœ€å¤§çš„ <span class=\"math inline\">\\(j&#39;\\)</span>ï¼Œæ»¡è¶³ <span class=\"math inline\">\\([j, r]\\)</span> ä¸ <span class=\"math inline\">\\([l, r]\\)</span> ç§ç±»ç›¸åŒï¼Œæ±‚ <span class=\"math inline\">\\([l, j&#39;]\\)</span> çš„åŒºé—´å’Œå³å¯ã€‚æ‰¾ <span class=\"math inline\">\\(j&#39;\\)</span> å¯ä»¥è®°å½•å‰é©±åç»§ï¼Œåˆå§‹æ¯ä¸ª <span class=\"math inline\">\\(l\\)</span> å¯¹åº”çš„ <span class=\"math inline\">\\(j&#39;\\)</span> å°±æ˜¯è‡ªå·±ã€‚è‹¥åŠ å…¥äº†ä¸€ä¸ªä¸ <span class=\"math inline\">\\(l\\)</span> ç›¸åŒçš„æ–°å…ƒç´ ï¼Œé‚£ä¹ˆ <span class=\"math inline\">\\(l\\)</span> å°±ä¸å†æœ‰è´¡çŒ®ï¼Œæ­¤æ—¶ <span class=\"math inline\">\\(l\\)</span> çš„ <span class=\"math inline\">\\(j&#39;\\)</span> å°±ä¼šç»§æ‰¿ <span class=\"math inline\">\\(l+1\\)</span> çš„ <span class=\"math inline\">\\(j&#39;\\)</span>ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”¨å¹¶æŸ¥é›†å³å¯ç®€å•ç»´æŠ¤ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int lim = 2e6;\nconst int maxn = 2e6 + 5;\nconst int maxm = 5e7 + 5;\nconst int inf = 0x3f3f3f3f;\nstruct &#123; int l, r, u, d; &#125; t[maxn &lt;&lt; 2];\nint tot;\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid pushdown(int p) &#123;\n    if (~t[p].d) &#123;\n        t[lt].d = t[rt].d = t[p].d;\n        t[lt].u = t[p].d - t[lt].r + 1;\n        t[rt].u = t[p].d - t[rt].r + 1;\n        t[p].d = -1;\n    &#125;\n    return;\n&#125;\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r, t[p].d = -1;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid upd(int p, int l, int r, int v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        t[p].d = v, t[p].u = v - t[p].r + 1;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (l &lt;= mid)\n        upd(lt, l, r, v);\n    if (r &gt; mid)\n        upd(rt, l, r, v);\n    t[p].u = std::min(t[lt].u, t[rt].u);\n    return;\n&#125;\nint ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].u;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1, res = inf;\n    if (l &lt;= mid)\n        res = ask(lt, l, r);\n    if (r &gt; mid)\n        res = std::min(res, ask(rt, l, r));\n    return res;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, q;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), la(lim + 1), pre(n + 1), f(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        pre[i] = la[a[i]], la[a[i]] = i, f[i] = i;\n    &#125;\n    std::cin &gt;&gt; q;\n    std::vector&lt;int&gt; res(q + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; t(n + 1);\n    for (int i = 1, l, r; i &lt;= q; ++i) &#123;\n        std::cin &gt;&gt; l &gt;&gt; r;\n        t[r].emplace_back(l, i);\n    &#125;\n    bld(1, 1, n);\n    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;\n        return x == f[x] ? x : f[x] = find(f[x]);\n    &#125;;\n    auto merge = [&amp;](int x, int y) &#123;\n        x = find(x), y = find(y);\n        f[std::min(x, y)] = std::max(x, y);\n        return;\n    &#125;;\n    for (int r = 1; r &lt;= n; ++r) &#123;\n        if (pre[r])\n            merge(pre[r], pre[r] + 1);\n        upd(1, pre[r] + 1, r, r);\n        for (auto [l, i] : t[r])\n            res[i] = ask(1, l, find(l));\n    &#125;\n    for (int i = 1; i &lt;= q; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h4 id=\"é¢œè‰²\"># é¢œè‰²</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P4065\" class=\"uri\">https://www.luogu.com.cn/problem/P4065</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(n\\)</span> ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ æœ‰ä¸€ä¸ªé¢œè‰²ã€‚é€‰æ‹©è‹¥å¹²é¢œè‰²ï¼ˆä¸èƒ½å…¨é€‰æˆ–å…¨ä¸é€‰ï¼‰ï¼Œé—®æœ‰å¤šå°‘ç§é€‰å–æ–¹æ¡ˆä½¿å¾—æ‹¥æœ‰è¿™äº›é¢œè‰²çš„ç‚¹æ˜¯ä¸€æ®µè¿ç»­çš„åŒºé—´ã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 3\\times 10^5\\)</span>ã€‚</p>\n</blockquote>\n<hr />\n<h3 id=\"åŠ¿èƒ½çº¿æ®µæ ‘\">åŠ¿èƒ½çº¿æ®µæ ‘</h3>\n<h4 id=\"å¸‚åœº\"># å¸‚åœº</h4>\n<p><a href=\"https://loj.ac/p/6029\" class=\"uri\">https://loj.ac/p/6029</a></p>\n<hr />\n<h4 id=\"segment-tree-beats\"># Segment Tree Beats!</h4>\n<blockquote>\n<p>ç»´æŠ¤åŒºé—´å– minï¼ŒåŒºé—´æ±‚å’Œã€‚</p>\n</blockquote>\n<p>pdf P57</p>\n<hr />\n<h4 id=\"segment-tree-beats-plus\"># Segment Tree Beats! Plus</h4>\n<blockquote>\n<p>ç»´æŠ¤åŒºé—´åŠ ï¼ŒåŒºé—´å– minï¼ŒåŒºé—´æ±‚å’Œã€‚</p>\n</blockquote>\n<p>pdf P60</p>\n<hr />\n<h4 id=\"æœ€å‡å¥³é€‰æ‰‹\"># æœ€å‡å¥³é€‰æ‰‹</h4>\n<p><a href=\"https://loj.ac/p/6565\" class=\"uri\">https://loj.ac/p/6565</a></p>\n<hr />\n<h4 id=\"mzl-loves-segment-tree\"># Mzl loves segment tree</h4>\n<p><a href=\"http://222.180.160.110:61235/problem/10203\" class=\"uri\">http://222.180.160.110:61235/problem/10203</a></p>\n<p>pdf P66</p>\n<hr />\n<h4 id=\"ctsn-loves-segment-tree\"># CTSN loves segment tree</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/U180387\" class=\"uri\">https://www.luogu.com.cn/problem/U180387</a></p>\n<hr />\n<h4 id=\"å‰è¿›å››segment-tree-beats-ver\"># å‰è¿›å››ï¼ˆsegment tree beats verï¼‰</h4>\n<p><a href=\"https://uoj.ac/problem/515\" class=\"uri\">https://uoj.ac/problem/515</a></p>\n<p>å¦è§ <a href=\"#-å‰è¿›å››æ¥¼æˆ¿é‡å»º-ver\">æ¥¼æˆ¿é‡å»º ver</a></p>\n<hr />\n<h4 id=\"åŸºç¡€æ•°æ®ç»“æ„ç»ƒä¹ é¢˜\"># åŸºç¡€æ•°æ®ç»“æ„ç»ƒä¹ é¢˜</h4>\n<p><a href=\"https://uoj.ac/problem/228\" class=\"uri\">https://uoj.ac/problem/228</a></p>\n<hr />\n<h4 id=\"çº¿æ®µæ ‘-3\"># çº¿æ®µæ ‘ 3</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P6242\" class=\"uri\">https://www.luogu.com.cn/problem/P6242</a></p>\n<hr />\n<h4 id=\"èµ›æ ¼è’™ç‰¹å½¼èŒ¨\"># èµ›æ ¼è’™ç‰¹å½¼èŒ¨</h4>\n<p>pdf P70</p>\n<hr />\n<h4 id=\"å •å¤©ä½œæˆ˜-test_98\"># å •å¤©ä½œæˆ˜ TEST_98</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P9069\" class=\"uri\">https://www.luogu.com.cn/problem/P9069</a></p>\n<hr />\n<h3 id=\"çº¿æ®µæ ‘åˆ†æ²»\">çº¿æ®µæ ‘åˆ†æ²»</h3>\n<h4 id=\"meetings-ä¼šè®®\"># meetings ä¼šè®®</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P5044\" class=\"uri\">https://www.luogu.com.cn/problem/P5044</a></p>\n<h4 id=\"å…«çºµå…«æ¨ª\"># å…«çºµå…«æ¨ª</h4>\n<p><a href=\"https://www.luogu.com.cn/problem/P3733\" class=\"uri\">https://www.luogu.com.cn/problem/P3733</a></p>\n<h2 id=\"ç¬›å¡å°”æ ‘\">ç¬›å¡å°”æ ‘</h2>\n<p>ä¸€äº›æ€è€ƒæ–¹å¼å’Œ trick å§</p>\n<h3 id=\"ç”±ä¹ƒæ•‘çˆ·çˆ·\">* ç”±ä¹ƒæ•‘çˆ·çˆ·</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P3793\" class=\"uri\">https://www.luogu.com.cn/problem/P3793</a></p>\n<blockquote>\n<p>å°½å¯èƒ½å¿«åœ°ç»´æŠ¤éšæœºåºåˆ—åŒºé—´æœ€å€¼ã€‚</p>\n</blockquote>\n<p>éšæœºåºåˆ—ç¬›å¡å°”æ ‘æœŸæœ›æ·±åº¦æ˜¯ <span class=\"math inline\">\\(\\log\\)</span>ã€‚å°±å¯ä»¥åšäº†ã€‚</p>\n<p>æ¥è‡ª <a href=\"https://www.luogu.com/article/hj9ci08q\">UnyieldingTrilobite çš„æ–‡ç« </a>ï¼šåŒæ ·å¯ä»¥ç”¨æ‚¬çº¿ï¼<a href=\"/20231117/#éšæœºåºåˆ—æ‚¬çº¿ç»“åˆåˆ†å—\">æ‚¬çº¿ + åˆ†å—</a> å°±å¯ä»¥åšäº†ã€‚</p>\n<hr />\n<h3 id=\"æƒ…æ™¯å‰§æœ€å€¼çš„æ€§è´¨ç»´æŠ¤æ–¹å¼çš„å–èˆ\">* æƒ…æ™¯å‰§ï¼ˆæœ€å€¼çš„æ€§è´¨ï¼Œç»´æŠ¤æ–¹å¼çš„å–èˆï¼‰</h3>\n<p><a href=\"http://222.180.160.110:61235/contest/4273/problem/1\" class=\"uri\">http://222.180.160.110:61235/contest/4273/problem/1</a></p>\n<blockquote>\n<p>ç»™å®šé•¿åº¦ä¸º <span class=\"math inline\">\\(n\\)</span> çš„åºåˆ— <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œæ‰¾åˆ°ä¸€ä¸ªåŒºé—´ï¼Œä½¿å¾— åŒºé—´é•¿åº¦ <span class=\"math inline\">\\(\\times\\)</span> åŒºé—´æœ€å¤§å€¼ <span class=\"math inline\">\\(\\times\\)</span> åŒºé—´æœ€å°å€¼ æœ€å¤§ã€‚è¾“å‡ºæœ€å¤§å€¼ã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 10^6,V\\le 10^9\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>å®¹æ˜“æƒ³åˆ°å»ºç¬›å¡å°”æ ‘ã€‚è¿™é‡Œçš„ æœ€å¤§å€¼ å’Œ æœ€å°å€¼ åœ°ä½ç›¸ç­‰å—ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</li>\n<li>å¦‚æœæˆ‘ä»¬æ˜¯é’¦å®šæœ€å¤§å€¼ï¼Œå†å»æœ€å¤§åŒ–ã€æœ€å°å€¼ <span class=\"math inline\">\\(\\times\\)</span> åŒºé—´é•¿ã€ï¼Œå¥½åƒæ²¡åŠæ³•åšï¼Œå› ä¸ºè¿™ä¸ªæœ€å¤§è´¡çŒ®æ²¡ä»€ä¹ˆæ€§è´¨</li>\n<li><p>ä½†å¦‚æœé’¦å®šæœ€å°å€¼ï¼Œèƒ½å–åˆ°çš„æœ€é•¿åŒºé—´å°±æ˜¯åœ¨å°æ ¹ç¬›å¡å°”æ ‘ä¸Šçš„ç®¡è¾–åŒºé—´ï¼Œæ˜¾ç„¶åŒºé—´è¶Šé•¿å–åˆ°çš„æœ€å¤§å€¼ä¹Ÿè¶Šå¤§ï¼Œç›´æ¥å–è¿™é‡Œçš„æœ€å¤§å€¼å³å¯</p>\næ‰€ä»¥æœ€å¤§å€¼å’Œæœ€å°å€¼åœ°ä½ä¸ç­‰æ˜¯å› ä¸ºï¼ŒåŒºé—´é•¿å’Œæœ€å¤§å€¼å¤§å°æ˜¯æ­£ç›¸å…³çš„ï¼Œæ‰€ä»¥åªéœ€è¦æœ€å¤§åŒ–åŒºé—´é•¿ï¼Œæœ€å¤§å€¼ä¹Ÿå°±æœ€å¤§åŒ–äº†</li>\n<li><p>æ‰€ä»¥åœ¨å°æ ¹ç¬›å¡å°”æ ‘ä¸Šç»´æŠ¤åŒºé—´æœ€å¤§å€¼å³å¯</p></li>\n</ul>\n<hr />\n<h3 id=\"å°è“çš„å¥½å‹\"># å°è“çš„å¥½å‹</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P2611\" class=\"uri\">https://www.luogu.com.cn/problem/P2611</a></p>\n<hr />\n<h3 id=\"æ˜Ÿç™½-by-ttpandasç¬›å¡å°”æ ‘-dsu-on-tree\">æ˜Ÿç™½ by TTpandaSï¼ˆç¬›å¡å°”æ ‘ + dsu on treeï¼‰</h3>\n<p><a href=\"http://222.180.160.110:61235/contest/6517/problem/3\" class=\"uri\">http://222.180.160.110:61235/contest/6517/problem/3</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(n\\)</span> çš„æ’åˆ— <span class=\"math inline\">\\(a_{1\\sim n}\\)</span>ï¼Œå›ç­” <span class=\"math inline\">\\(q\\)</span> ä¸ªè¯¢é—®ï¼š</p>\n<ul>\n<li><p>ç»™å®š <span class=\"math inline\">\\([l,r]\\)</span>ï¼Œæ˜¯å¦å­˜åœ¨ <span class=\"math inline\">\\(l\\le x&lt;y\\le r\\)</span>ï¼Œä½¿å¾—ï¼š</p>\n<ul>\n<li><span class=\"math inline\">\\(a_x&lt;a_y\\)</span>ï¼Œä¸” <span class=\"math inline\">\\(a_x\\)</span> ä¸ä¸º <span class=\"math inline\">\\([x,y]\\)</span> ä¸­æœ€å°å€¼ï¼›</li>\n<li>ä»¤ <span class=\"math inline\">\\(a_i\\)</span> ä¸º <span class=\"math inline\">\\([x, y]\\)</span> ä¸­æœ€å°å€¼ï¼Œåˆ™ <span class=\"math inline\">\\(a_i\\mid (a_x\\cdot a_y)\\)</span>ã€‚</li>\n</ul></li>\n</ul>\n<p><span class=\"math inline\">\\(n\\le 3\\times 10^5,q\\le10^6\\)</span>ã€‚</p>\n</blockquote>\n<ul>\n<li>å®¹æ˜“æƒ³åˆ°å¯¹äº <span class=\"math inline\">\\(i\\)</span> åè¿‡æ¥æ‰¾ <span class=\"math inline\">\\([x,y]\\)</span>ã€‚å¦‚æœå»ºç«‹å°æ ¹ç¬›å¡å°”æ ‘ï¼Œåœ¨ <span class=\"math inline\">\\(i\\)</span> çš„å·¦è¾¹æ‰¾ <span class=\"math inline\">\\(x\\)</span>ã€å³è¾¹æ‰¾ <span class=\"math inline\">\\(y\\)</span>ã€‚</li>\n<li><p>ä¸€ä¸ªè‡ªç„¶çš„æƒ³æ³•æ˜¯å¯¹äºå·¦ä¾§çš„æ¯ä¸ª <span class=\"math inline\">\\(x\\)</span>ï¼Œç»´æŠ¤æœ€è¿‘çš„åˆæ³• <span class=\"math inline\">\\(y\\)</span>ï¼›æˆ–æ˜¯å¯¹äºå³ä¾§çš„æ¯ä¸ª <span class=\"math inline\">\\(y\\)</span>ï¼Œç»´æŠ¤æœ€è¿‘çš„åˆæ³• <span class=\"math inline\">\\(x\\)</span>ã€‚</p>\nåšä¸€ä¸ª DSU on Treeï¼Œå“ªè¾¹åŒºé—´çŸ­å°±ç»´æŠ¤å“ªè¾¹ï¼Œæ˜¯å• <span class=\"math inline\">\\(\\log\\)</span> çš„ã€‚</li>\n<li><p>éœ€è¦è§£å†³ç‚¹å†…é¢„å¤„ç†ï¼Œä»¥ <span class=\"math inline\">\\(x\\)</span> ä¸ºä¾‹ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(x\\)</span> å’Œå½“å‰ç‚¹ <span class=\"math inline\">\\((p,l,r)\\)</span>ï¼Œéœ€è¦æŸ¥è¯¢ <span class=\"math inline\">\\((p, r]\\)</span> ä¸­æœ€å°çš„ <span class=\"math inline\">\\(y\\)</span>ï¼Œä½¿å¾— <span class=\"math inline\">\\(a_y\\)</span> æ˜¯ <span class=\"math inline\">\\(\\dfrac {a_p}{\\gcd(a_x,a_p)}\\)</span> çš„å€æ•°ã€‚ç¦»çº¿ä¸‹æ¥æ‰«æçº¿ï¼Œ<del>å¼€ <span class=\"math inline\">\\(n\\)</span> æ£µçº¿æ®µæ ‘</del>ï¼Œè·‘ <span class=\"math inline\">\\(n\\)</span> æ¬¡æ ‘çŠ¶æ•°ç»„ï¼Œç”¨ <span class=\"math inline\">\\(y\\)</span> æ›´æ–°æ‰€æœ‰ <span class=\"math inline\">\\(a_y\\)</span> å› æ•°åœ¨ <span class=\"math inline\">\\(a_y\\)</span> å¤„çš„ min / maxï¼Œå¯ä»¥åœ¨ä¸¤ä¸ª log å†…è·å¾—æ”¯é…å¯¹ç±»ä¼¼ç‰©ã€‚</p>\nä¸æ˜¯å¾ˆç†è§£ä¸ºä»€ä¹ˆé¢˜ç›®è¦å†åŠ ä¸€ä¸ªååºé™åˆ¶ï¼Œé™¤äº†å¢åŠ ä»£ç é‡å’Œç”¨æ—¶å¤–ä¼¼ä¹å¹¶æ²¡æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</li>\n<li><p>æŸ¥è¯¢æ—¶ç›´æ¥ rmqï¼ˆè¿™é‡Œå”äº†å†™äº† st è¡¨ï¼Œå®é™…ä¸Šåªéœ€è¦å‰åç¼€ï¼‰å³å¯ã€‚æ•´ä½“å¤æ‚åº¦ <span class=\"math inline\">\\(O(n\\log^2 n)\\)</span>ã€‚</p></li>\n</ul>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int LEN = (1 &lt;&lt; 20);\n#ifdef ONLINE_JUDGE\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n#endif\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    read(n);\n    std::vector&lt;std::vector&lt;int&gt; &gt; mul(n + 1);\n    std::vector&lt;int&gt; a(n + 1), l(n + 1), r(n + 1), pos(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        read(a[i]), pos[a[i]] = i;\n        for (l[i] = i; l[i] != 1 &amp;&amp; a[i] &lt; a[l[i] - 1]; l[i] = l[l[i] - 1]);\n    &#125;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        for (int j = i; j &lt;= n; j += i)\n            mul[i].push_back(pos[j]);\n        std::sort(mul[i].begin(), mul[i].end());\n    &#125;\n    for (int i = n; i; --i)\n        for (r[i] = i; r[i] != n &amp;&amp; a[i] &lt; a[r[i] + 1]; r[i] = r[r[i] + 1]);\n    struct query &#123; int id, l, r; &#125;;\n    std::vector&lt;std::vector&lt;query&gt; &gt; ql(n + 1), qr(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        if (i - l[i] &lt; r[i] - i)\n            for (int j = l[i]; j &lt; i; ++j)\n                qr[a[i] / std::__gcd(a[i], a[j])].push_back(&#123; j, i + 1, r[i] &#125;);\n        else\n            for (int j = i + 1; j &lt;= r[i]; ++j)\n                ql[a[i] / std::__gcd(a[i], a[j])].push_back(&#123; j, l[i], i - 1 &#125;);\n    std::vector&lt;int&gt; u(n + 1), rt(n + 1), bit(n + 1);\n    auto lowbit = [](int x) &#123;\n        return x &amp; -x;\n    &#125;;\n    auto add = [&amp;](int x, int v) &#123;\n        for (; x &lt;= n; x += lowbit(x))\n            bit[x] = v;\n        return;\n    &#125;;\n    std::function&lt;int(int)&gt; ask = [&amp;](int x) &#123;\n        int res = 0;\n        for (; x; x -= lowbit(x))\n            res = std::max(res, bit[x]);\n        return res;\n    &#125;;\n    for (int fac = 1; fac &lt;= n; ++fac) &#123;\n        std::sort(ql[fac].begin(), ql[fac].end(), [&amp;](query x, query y) &#123; return x.r &lt; y.r; &#125;);\n        auto i = mul[fac].begin();\n        for (auto [id, l, r] : ql[fac]) &#123;\n            for (; i != mul[fac].end() &amp;&amp; *i &lt;= r; ++i)\n                add(a[*i], *i);\n            auto mx(ask(a[id]));\n            if (mx &gt;= l)\n                u[id] = std::max(u[id], mx);\n        &#125;\n        for (auto i : mul[fac])\n            add(a[i], 0);\n    &#125;\n    bit.assign(n + 1, 0x3f3f3f3f);\n    ask = [&amp;](int x) &#123;\n        int res = 0x3f3f3f3f;\n        for (; x; x -= lowbit(x))\n            res = std::min(res, bit[x]);\n        return res;\n    &#125;;\n    for (int fac = 1; fac &lt;= n; ++fac) &#123;\n        std::sort(qr[fac].begin(), qr[fac].end(), [&amp;](query x, query y) &#123; return x.l &gt; y.l; &#125;);\n        std::reverse(mul[fac].begin(), mul[fac].end());\n        auto i = mul[fac].begin();\n        for (auto [id, l, r] : qr[fac]) &#123;\n            for (; i != mul[fac].end() &amp;&amp; *i &gt;= l; ++i)\n                add(n - a[*i] + 1, *i);\n            auto mn(ask(n - a[id] + 1));\n            if (mn &lt;= r)\n                u[mn] = std::max(u[mn], id);\n        &#125;\n        for (auto i : mul[fac])\n            add(n - a[i] + 1, 0x3f3f3f3f);\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; st(20, std::vector&lt;int&gt; (n + 1));\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        // if (u[i] != 0)\n        //     printf(&quot;%d %d\\n&quot;, u[i], i);\n        st[0][i] = u[i];\n    &#125;\n    for (int j = 1; (1 &lt;&lt; j) &lt;= n; ++j)\n        for (int i = 1; i + (1 &lt;&lt; j) - 1 &lt;= n; ++i)\n            st[j][i] = std::max(st[j - 1][i], st[j - 1][i + (1 &lt;&lt; (j - 1))]);\n    auto askmx = [&amp;](int l, int r) &#123;\n        int k = std::__lg(r - l + 1);\n        return std::max(st[k][l], st[k][r - (1 &lt;&lt; k) + 1]);\n    &#125;;\n    int q;\n    read(q);\n    for (int l, r; q--; ) &#123;\n        read(l), read(r);\n        std::cout &lt;&lt; (askmx(l, r) &gt;= l ? &quot;Yes&quot; : &quot;No&quot;) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"periodni\"># PERIODNI</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P6453\" class=\"uri\">https://www.luogu.com.cn/problem/P6453</a></p>\n<hr />\n<h2 id=\"cdq-åˆ†æ²»\">CDQ åˆ†æ²»</h2>\n<h3 id=\"coloring-nodesååºå¾ˆéšç§˜\"># Coloring Nodesï¼ˆååºå¾ˆéšç§˜ï¼‰</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P12423\" class=\"uri\">https://www.luogu.com.cn/problem/P12423</a></p>\n<hr />\n<h2 id=\"å­—å…¸æ ‘\">å­—å…¸æ ‘</h2>\n<p>å­—å…¸æ ‘ä½œä¸º log æ•°æ®ç»“æ„çš„æ—¶å€™ï¼Œç­‰ä»·æƒå€¼çº¿æ®µæ ‘ï¼Œè€Œä¸”æ”¯æŒåˆå¹¶ã€åˆ†è£‚ï¼ˆæƒå€¼çº¿æ®µæ ‘ also OKï¼Œå¼ºè°ƒä¸€ä¸‹è€Œå·²ï¼‰</p>\n<p>æœ‰äº›æƒ…æ™¯ Trie å†™èµ·æ¥ä¼šæ¯”æƒå€¼çº¿æ®µæ ‘èˆ’æœä¸€äº›ï¼Œæ¯”å¦‚å€¼åŸŸæ“ä½œã€äºŒè¿›åˆ¶æ“ä½œä¹‹ç±»</p>\n<h3 id=\"å¼‚æˆ–ç²½å­\"># å¼‚æˆ–ç²½å­</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P5283\" class=\"uri\">https://www.luogu.com.cn/problem/P5283</a></p>\n<hr />\n<h3 id=\"friends\"># Friends</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/CF241B\" class=\"uri\">https://www.luogu.com.cn/problem/CF241B</a></p>\n",
            "tags": [
                "çº¿æ®µæ ‘"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250816/",
            "url": "https://xsc062.netlify.app/20250816/",
            "title": "è¿‘æœŸæ‚é¢˜ II",
            "date_published": "2025-08-16T08:14:12.000Z",
            "content_html": "<p>å’Œ Aug 9th çš„æ‚é¢˜ä¸å¤ªèƒ½åˆå¹¶ï¼Œæ‰€ä»¥åˆ†å¼€äº†</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"b.-gas-fire-extinguishers\">B. GAS-Fire Extinguishers</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P3479\" class=\"uri\">https://www.luogu.com.cn/problem/P3479</a></p>\n<p>æ˜¾ç„¶å¯ä»¥è´ªå¿ƒï¼Œä¸å¦¨ä»ä¸‹åˆ°ä¸Šï¼Œè®°å½•å½“å‰éå†è¿‡çš„ã€ç©ºä½™å‡ºæ¥çš„ç­ç«å™¨ï¼ˆå…¶å®ç®—çš„æ˜¯å¯ä»¥ä¾›ç»™çš„æˆ¿é—´æ•°ï¼‰å’Œè¿˜æœªåˆ†é…ç­ç«å™¨çš„æˆ¿é—´ï¼ŒæŒ‰è·ç¦»ä¸º <span class=\"math inline\">\\(0\\sim k\\)</span> åˆ†ç»„ã€‚</p>\n<p>ä¸éš¾å‘ç°å¦‚æœåœ¨æŸä¸ªç‚¹ <span class=\"math inline\">\\(u\\)</span> å¤„å­˜åœ¨è·ç¦»ä¸º <span class=\"math inline\">\\(k\\)</span> çš„ç©ºé—²ç­ç«å™¨ï¼Œå¯ä»¥è´ªå¿ƒåœ°åˆ†é…ç»™ <span class=\"math inline\">\\(u\\)</span>ï¼›å¦‚æœå­˜åœ¨è·ç¦»ä¸º <span class=\"math inline\">\\(k\\)</span> çš„æœªåˆ†é…æˆ¿é—´ï¼Œä¹Ÿå¯ä»¥åœ¨ <span class=\"math inline\">\\(u\\)</span> å¤„æ”¾ç½®ç­ç«å™¨å¹¶åˆ†é…ç»™è¿™äº›æˆ¿é—´ã€‚ç±»ä¼¼åœ°ï¼Œè¿›è¡Œä¸¤ä¸¤é…å¯¹ä¸€å®šæ˜¯ä¸åŠ£çš„ã€‚</p>\n<p>å‘ç°åŒå­æ ‘å†…è·ç¦»ä¸º <span class=\"math inline\">\\(k-1\\)</span> çš„ç‚¹å¯¹ç•™åˆ° <span class=\"math inline\">\\(fa\\)</span> å†åŒ¹é…æ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºè¿™æ—¶è·ç¦»ä¼šå˜æˆ <span class=\"math inline\">\\(k+1\\)</span>ï¼Œä¸èƒ½åŒ¹é…ä¸Šï¼›å¯ä»¥æ„Ÿå—åˆ°è¿™æ ·æ˜¯æ›´åŠ£çš„ã€‚</p>\n<p>ç„¶åå°±å¯ä»¥åšäº†ï¼Œæ ¹èŠ‚ç‚¹ç‰¹æ®Šä¹±è´ªå¿ƒä¸€ä¸‹å°±è¡Œäº†ã€‚è®°å¾—å¼€ long longã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\n#define int long long\nsigned main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, s, k, res = 0;\n    std::cin &gt;&gt; n &gt;&gt; s &gt;&gt; k;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1), p(n + 1, std::vector&lt;int&gt; (k + 1)), q(n + 1, std::vector&lt;int&gt; (k + 1));\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        for (auto i : g[x])\n            if (i != fa)  &#123;\n                DFS(i, x);\n                for (int j = 0; j &lt; k; ++j)\n                    p[x][j + 1] += p[i][j], q[x][j + 1] += q[i][j];\n            &#125;\n        ++q[x][0];\n        if (x != 1) &#123;\n            int v = (q[x][k] + s - 1) / s;\n            p[x][0] = v * s, res += v;\n            for (int i = 0; i &lt;= k; ++i) &#123;\n                int v = std::min(p[x][i], q[x][k - i]);\n                p[x][i] -= v, q[x][k - i] -= v;\n            &#125;\n            for (int i = 0; i &lt; k; ++i) &#123;\n                int v = std::min(p[x][i], q[x][k - 1 - i]);\n                p[x][i] -= v, q[x][k - 1 - i] -= v;\n            &#125;\n        &#125;\n        else &#123;\n            // std::cerr &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n            int sum = 0ll, r = 0;\n            for (int i = k; ~i; --i) &#123;\n                sum += p[x][k - i];\n                // std::cerr &lt;&lt; sum &lt;&lt; &#39;\\n&#39;;\n                int v = std::min(sum, q[x][i]);\n                sum -= v, q[x][i] -= v;\n                r += q[x][i];\n            &#125;\n            res += (r + s - 1) / s;\n        &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c.-æ‰«åœ°æœºå™¨äºº\">C. æ‰«åœ°æœºå™¨äºº</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6502/problem/3\" class=\"uri\">http://222.180.160.110:61235/contest/6502/problem/3</a></p>\n<blockquote>\n<p>é¢˜æ„ï¼šç»™å®š <span class=\"math inline\">\\(n\\)</span> å †è´§ç‰©ï¼Œæ¯å †è´§ç‰©æœ‰é‡é‡ <span class=\"math inline\">\\(v_i\\)</span> å’Œä¸€ä¸ªå‚æ•° <span class=\"math inline\">\\(a_i\\)</span>ã€‚æœ‰ä¸€ä¸ªåˆå§‹è´Ÿè½½ä¸º <span class=\"math inline\">\\(0\\)</span>ã€è´Ÿè½½ä¸Šé™ä¸º <span class=\"math inline\">\\(c\\)</span> çš„æœºå™¨äººï¼Œä» <span class=\"math inline\">\\(1\\)</span> åˆ° <span class=\"math inline\">\\(n\\)</span> éå†è¿™äº›è´§ç‰©ï¼Œå¯¹æ¯ä¸€å¤„è´§ç‰©æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼Œç›´åˆ°æ¸…ç©ºè¿™å †è´§ç‰©ï¼š</p>\n<ul>\n<li>å½“å‰è´Ÿè½½æœªæ»¡ï¼šå¯ä»¥é€‰æ‹©è¿›è¡Œè£…è½½ç›´åˆ°è¾¾åˆ°è´Ÿè½½ä¸Šé™ï¼Œæˆ–è´§ç‰©æ¸…ç©ºã€‚èŠ±è´¹ <span class=\"math inline\">\\(a_i\\)</span> çš„ä»£ä»·ã€‚</li>\n<li>ä¸ç®¡å½“å‰è´Ÿè½½æ»¡æ²¡æ»¡ï¼šå¯ä»¥é€‰æ‹©æ¸…ç©ºå½“å‰è´Ÿè½½ï¼ŒèŠ±è´¹ <span class=\"math inline\">\\(b\\)</span> çš„ä»£ä»·ã€‚</li>\n</ul>\n<p>æ¯ä¸€å¤„å¯ä»¥ä»»æ„æ“ä½œï¼Œè¦æ±‚éå†å®Œä¹‹åæœºå™¨äººè´Ÿè½½ä¸º <span class=\"math inline\">\\(0\\)</span>ï¼Œé—®æœ€å°ä»£ä»·ã€‚<span class=\"math inline\">\\(n\\le 2\\times 10^5,c\\le 10^9\\)</span>ã€‚</p>\n</blockquote>\n<p><em>é¢˜é¢æ˜¯é‡æ„è¿‡çš„ï¼ŒåŸæ¥çš„é¢˜é¢å¤ªæœ‰æ­§ä¹‰äº†ã€‚ç»å¤§å¤šæ•°äººæ²¡åšå‡ºæ¥å°±æ˜¯å› ä¸ºæ²¡çœ‹æ‡‚é¢˜å§ï¼</em></p>\n<p>è€ƒè™‘æš´åŠ›ï¼Œå¯ä»¥æƒ³åˆ°ä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºå¤„ç†å®Œ <span class=\"math inline\">\\(i\\)</span> è¿‡åè´Ÿè½½ä¸º <span class=\"math inline\">\\(j\\)</span> çš„æœ€å°ä»£ä»·ï¼ˆæ˜¾ç„¶ <span class=\"math inline\">\\(f_{i,c}\\)</span> å’Œ <span class=\"math inline\">\\(f_{i,0}\\)</span> æ˜¯ç­‰æ•ˆçš„ï¼Œæ•…èˆå¼ƒå‰è€…ï¼‰ã€‚è®° <span class=\"math inline\">\\(k=\\left\\lceil\\dfrac {v_i}c\\right\\rceil,w=(v_i\\bmod c - 1)\\bmod c+1\\)</span>ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{i,(j+v_i)\\bmod c}\\gets f_{i-1,j}+k\\cdot a_i+(k-1)\\cdot b +\n\\begin{cases}\nb&amp;j+w=c\\\\\na_i+b&amp;j+w&gt; c\\\\\n0&amp;\\text{otherwise}\n\\end{cases}\\\\\nf_{i,0}\\gets f_{i,j}+b\n\\]</span></p>\n<p>å‘ç° <span class=\"math inline\">\\(f_{i-1}\\)</span> å’Œ <span class=\"math inline\">\\(f_i\\)</span> ä¹‹é—´æ˜¯å­˜åœ¨å¯¹åº”å…³ç³»çš„ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥ç»§æ‰¿ï¼ˆçœŸå®çš„ <span class=\"math inline\">\\(0\\)</span> åº”è¯¥ä½äº <span class=\"math inline\">\\(-s_i\\)</span> çš„ä½ç½®ï¼‰ï¼Œå†åšå…¨å±€åŠ ã€åŒºé—´åŠ ï¼Œ<span class=\"math inline\">\\(f_{i,0}\\)</span> çš„è½¬ç§»æ˜¯å…¨å±€ minï¼Œçº¿æ®µæ ‘ç»´æŠ¤å³å¯ï¼›æ¯æ¬¡åªä¼šæ–°å¢ä¸€ä¸ªçŠ¶æ€ï¼ŒåŠ¨æ€å¼€ç‚¹å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 5e6 + 5;\nconst __int128 inf = 1e18;\nstruct &#123;\n    int l, r;\n    __int128 u, d;\n&#125; t[maxn];\n#define lt t[p].l\n#define rt t[p].r\nint tot;\nvoid pushdown(int p) &#123;\n    if (t[p].d) &#123;\n        t[lt].d += t[p].d, t[lt].u += t[p].d;\n        t[rt].d += t[p].d, t[rt].u += t[p].d;\n        t[p].d = 0ll;\n    &#125;\n    return;\n&#125;\nvoid upd(int &amp;p, int l, int r, int x, __int128 v) &#123;\n    if (!p)\n        p = ++tot, t[p].u = v;\n    else\n        t[p].u = std::min(t[p].u, v);\n    if (l == r)\n        return;\n    pushdown(p);\n    int mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        upd(lt, l, mid, x, v);\n    else\n        upd(rt, mid + 1, r, x, v);\n    return;\n&#125;\nvoid add(int p, int l, int r, int ql, int qr, __int128 v) &#123;\n    if (!p)\n        return;\n    if (ql &lt;= l &amp;&amp; r &lt;= qr) &#123;\n        t[p].d += v, t[p].u += v;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    pushdown(p);\n    if (ql &lt;= mid)\n        add(lt, l, mid, ql, qr, v);\n    if (qr &gt; mid)\n        add(rt, mid + 1, r, ql, qr, v);\n    t[p].u = std::min(t[lt].u, t[rt].u);\n    return;\n&#125;\n__int128 ask(int p, int l, int r, int x) &#123;\n    if (l == r)\n        return t[p].u;\n    int mid = (l + r) &gt;&gt; 1;\n    pushdown(p);\n    if (x &lt;= mid)\n        return ask(lt, l, mid, x);\n    return ask(rt, mid + 1, r, x);\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;robot.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;robot.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;ex_robot4.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    t[0].u = inf;\n    int n, b, c, p0 = 0, rt = 0;\n    std::cin &gt;&gt; n &gt;&gt; c &gt;&gt; b;\n    std::vector&lt;int&gt; a(n + 1), v(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; v[i];\n    upd(rt, 0, c - 1, 0, 0ll);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        __int128 k = (v[i] + c - 1) / c, w = (v[i] % c == 0 ? c : v[i] % c);\n        t[rt].d += k * a[i] + (k - 1) * b;\n        t[rt].u += k * a[i] + (k - 1) * b;\n        if (w &lt;= c)\n            add(rt, 0, c - 1, (c - w + p0) % c, (c - w + p0) % c, b);\n        if (w != 1) &#123;\n            int l = (c - w + p0 + 1) % c, r = (p0 + c - 1) % c;\n            if (l &lt;= r)\n                add(rt, 0, c - 1, l, r, a[i] + b);\n            else &#123;\n                add(rt, 0, c - 1, 0, r, a[i] + b);\n                add(rt, 0, c - 1, l, c - 1, a[i] + b);\n            &#125;\n        &#125;\n        p0 = (p0 + c - v[i] % c) % c;\n        upd(rt, 0, c - 1, p0, t[rt].u + b);\n    &#125;\n    std::cout &lt;&lt; (long long)ask(rt, 0, c - 1, p0) &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-å¥—å¨ƒ\">D. å¥—å¨ƒ</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6502/problem/4\" class=\"uri\">http://222.180.160.110:61235/contest/6502/problem/4</a></p>\n<blockquote>\n<p>é¢˜æ„ï¼šç»™å®šåˆå§‹ä¸ºå…¨ <span class=\"math inline\">\\(0\\)</span> çš„æ•°ç»„ <span class=\"math inline\">\\(a_{1\\sim n + 1}\\)</span> å’Œ <span class=\"math inline\">\\(n\\)</span> æ¬¡å•ç‚¹ +1 æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåï¼Œæ±‚è§£ï¼š</p>\n<p>ä»¤ <span class=\"math inline\">\\(a\\)</span> çš„å‰ç¼€å’Œæ•°ç»„ä¸º <span class=\"math inline\">\\(s\\)</span>ï¼Œæ‰¾åˆ°ä¸€ä¸ªæœ€å°çš„ <span class=\"math inline\">\\(k\\)</span>ï¼Œä½¿å¾—å¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œå‡æœ‰ <span class=\"math inline\">\\(k\\cdot i\\ge s_i\\)</span> æˆç«‹ã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 10^6\\)</span>ï¼Œæ—¶é™ 0.5sã€‚</p>\n</blockquote>\n<details>\n<p><summary>è¶£äº‹ä¸€åˆ™</summary></p>\n<p>è€ƒåœºä¸Šæœ€å 10min æ‹¿åˆ°é¢˜ï¼Œæ†‹äº†ä¸€ä¸ªèƒ½æ‹¿åˆ° 96pts çš„å‡åšæ³•ï¼šæ³¨æ„åˆ°å‰ç¼€å’Œæ˜¯å•å¢çš„ï¼Œéœ€è¦ç»´æŠ¤æœ€å¤§çš„ <span class=\"math inline\">\\(\\dfrac {s_i}i\\)</span>ï¼Œç”±äºåç¼€ +1 å¸¦æ¥çš„å½±å“å¾ˆå°ï¼Œæ‰€ä»¥å¯ä»¥çŒœæµ‹åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹æœ€å¤§çš„ <span class=\"math inline\">\\(i\\)</span> åªä¼šåœ¨åŸæ¥çš„å’Œä¿®æ”¹çš„ç‚¹ä¹‹é—´å˜åŒ–ã€‚åªç”¨ 10 è¡Œçš„æ ¸å¿ƒä»£ç å°±èƒ½æ‹¿åˆ°å¾ˆå¤šåˆ†ã€‚ä½†æ˜¯å±…ç„¶æœ‰è¿™ä¹ˆå¤šï¼Œå¯èƒ½å‡ºé¢˜äººéƒ½æ²¡æœ‰æƒ³åˆ°çœŸæœ‰äººæ•¢äº¤è¿™ç§åšæ³•å§ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n    std::freopen(&quot;doll.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;doll.out&quot;, &quot;w&quot;, stdout);\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    auto stime = std::chrono::steady_clock::now();\n    int n, res = 0;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; bit(n + 2);\n    auto lowbit = [](int x) &#123;\n        return x &amp; -x;\n    &#125;;\n    auto add = [&amp;](int x) &#123;\n        for (; x &lt;= n + 1; x += lowbit(x))\n            ++bit[x];\n        return;\n    &#125;;\n    auto ask = [&amp;](int x) &#123;\n        int res = 0;\n        for (; x; x -= lowbit(x))\n            res += bit[x];\n        return res;\n    &#125;;\n    int p = 1;\n    for (int i = 1, x; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; x, add(++x);\n        long long s = ask(x), t = ask(p);\n        if (s * p == t * x ? x &gt; p : s * p &gt; t * x)\n            p = x;\n        else\n            s = t;\n        if (s &gt; p * res)\n            ++res;\n        std::cout &lt;&lt; res &lt;&lt; &#39; &#39;;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n    std::cerr &lt;&lt; std::chrono::duration&lt;double&gt;(std::chrono::steady_clock::now() - stime).count() &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<p>å¾ˆå®¹æ˜“å†™å‡ºæš´åŠ›ï¼Œè§‚å¯Ÿæ ·ä¾‹å°±èƒ½å‘ç°æ¯æ¬¡ä¿®æ”¹åç­”æ¡ˆæœ€å¤šå¢åŠ  <span class=\"math inline\">\\(1\\)</span>ã€‚è®°å½“å‰ç­”æ¡ˆä¸º <span class=\"math inline\">\\(res\\)</span>ï¼Œçº¿æ®µæ ‘ç»´æŠ¤ <span class=\"math inline\">\\(s_i-res\\cdot i\\)</span> çš„æœ€å°å€¼ï¼Œè‹¥å…¶ä¸ºè´Ÿåˆ™ res++ï¼Œç„¶åé‡æ„çº¿æ®µæ ‘ï¼ˆç­‰å·®æ•°åˆ—å’Œ min ä¸å…¼å®¹ï¼‰ã€‚</p>\n<p>æ€ä¹ˆåˆæœ‰ä¸ç­‰å¼ ğŸ˜±</p>\n<p>ç›®çš„æ˜¯åœ¨æœ¬æ¥åˆæ³•çš„èŒƒå›´é‡Œæ‰¾åˆ°æ–°çš„ä¸åˆæ³•å€¼ã€‚è€ƒè™‘åˆæ³•èŒƒå›´ï¼š<span class=\"math inline\">\\(s_i-res\\cdot i\\ge 0\\)</span>ï¼Œè§£ä¸€ä¸‹å¾—åˆ° <span class=\"math inline\">\\(i\\le \\dfrac {s_i}{res}\\)</span>ï¼Œæ”¾ç¼©å¾—åˆ° <span class=\"math inline\">\\(i\\le\\dfrac {n}{res}\\)</span>ï¼Œæ¯æ¬¡ <span class=\"math inline\">\\(res\\)</span> å˜åŒ–æ—¶åªé‡æ„ <span class=\"math inline\">\\(\\dfrac {n}{res}\\)</span> ä»¥å‰çš„ä½ç½®ï¼Œé‡æ„çš„æ€»é•¿æ˜¯ <span class=\"math inline\">\\(O(n\\ln n)\\)</span> çš„ã€‚ï¼ˆçº¿æ®µæ ‘å»ºæ ‘æ˜¯çº¿æ€§çš„ï¼‰</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e6 + 5;\nconst int inf = 0x3f3f3f3f;\nstruct &#123;\n    int l, r, u, d;\n&#125; t[maxn &lt;&lt; 2];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].u = t[p].l = l, t[p].r = r;\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    if (t[p].d) &#123;\n        t[lt].d += t[p].d, t[rt].d += t[p].d;\n        t[lt].u -= t[p].d, t[rt].u -= t[p].d;\n        t[p].d = 0;\n    &#125;\n    return;\n&#125;\nvoid add(int p, int x) &#123;\n    if (x &lt;= t[p].l) &#123;\n        ++t[p].d, --t[p].u;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, x);\n    add(rt, x);\n    t[p].u = std::min(t[lt].u, t[rt].u);\n    // printf(&quot;[%d, %d]: %d, [%d, %d]: %d\\n&quot;, t[p].l, mid, t[lt].u, mid + 1, t[p].r, t[rt].u);\n    return;\n&#125;\nvoid rem(int p, int r) &#123;\n    if (t[p].l == t[p].r) &#123;\n        t[p].u += t[p].l;\n        return;\n    &#125;\n    pushdown(p);\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (r &lt;= mid)\n        rem(lt, r), t[rt].u = inf;\n    else\n        rem(lt, r), rem(rt, r);\n    t[p].u = std::min(t[lt].u, t[rt].u);\n    return;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;doll.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;doll.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    bld(1, 1, n + 1);\n    for (int i = 1, x, res = 1, now = n; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; x;\n        if (x &lt;= now)\n            add(1, ++x);\n        if (t[1].u &lt; 0) &#123;\n            std::cout &lt;&lt; ++res &lt;&lt; &#39; &#39;;\n            rem(1, now = n / res);\n        &#125;\n        else\n            std::cout &lt;&lt; res &lt;&lt; &#39; &#39;;\n        // puts(&quot;&quot;);\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---subarray-sum-divisibility\">E - Subarray Sum Divisibility</h2>\n<p><a href=\"https://atcoder.jp/contests/abc419/tasks/abc419_e\" class=\"uri\">https://atcoder.jp/contests/abc419/tasks/abc419_e</a></p>\n<p>æ¨¡æ„ä¹‰ä¸‹çš„æ•°åˆ—å…¨ç­‰ï¼Œå¯ä»¥å¯¹åº”åŸæ•°ç»„å…¨ç­‰ã€å·®åˆ†å…¨ç­‰ã€å‰ç¼€å’Œå…¨ç­‰ï¼ˆéƒ½æ˜¯æ¨¡æ„ä¹‰ä¸‹çš„ï¼Œè¿˜æœ‰å…¶ä»–çš„ä¸€äº›çº¿æ€§å’Œéçº¿æ€§çš„å˜æ¢ä¹Ÿå¯ä»¥ï¼‰</p>\n<p>æœ¬ç€ä¿®æ”¹çš„ç‚¹å°½é‡å°‘çš„æƒ³æ³•ï¼Œå¦‚æœé¢˜ç›®ç»™å®šå•ç‚¹ä¿®æ”¹å°±å¯ä»¥åœ¨åŸæ•°ç»„ä¸Šåšæ–‡ç« ï¼Œç»™å®šåŒºé—´ä¿®æ”¹å¯ä»¥è€ƒè™‘å·®åˆ†æ•°ç»„ï¼Œå‰ç¼€å’Œå¯¹äºä¸€äº›åŒºé—´æŸ¥è¯¢æœ‰ä¼˜åŠ¿</p>\n<p>å…¶ä»–ä¸¤ç§ç”¨å¾—ä¹Ÿå¾ˆå¤šï¼Œåƒè¿™é¢˜åªéœ€è¦ç”¨åŸæ•°ç»„å…¨ç­‰å°±å¯ä»¥åšäº†</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int inf = 0x3f3f3f3f;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m, l;\n    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; l;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;std::vector&lt;int&gt; &gt; u(l + 1, std::vector&lt;int&gt; (m));\n    for (int i = 1; i &lt;= l; ++i)\n        for (int j = 0; j &lt; m; ++j)\n            for (int k = i; k &lt;= n; k += l)\n                u[i][j] += (j + m - a[k]) % m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; f(l + 1, std::vector&lt;int&gt; (m, inf));\n    f[0][0] = 0;\n    for (int i = 1; i &lt;= l; ++i)\n        for (int j = 0; j &lt; m; ++j)\n            for (int k = 0; k &lt; m; ++k)\n                f[i][(j + k) % m] = std::min(f[i][(j + k) % m], f[i - 1][j] + u[i][k]);\n    std::cout &lt;&lt; f[l][0] &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;\n</code></pre>\n</details>\n<hr />\n<h2 id=\"f---all-included\">F - All Included</h2>\n<p><a href=\"https://atcoder.jp/contests/abc419/tasks/abc419_f\" class=\"uri\">https://atcoder.jp/contests/abc419/tasks/abc419_f</a></p>\n<p>åŸé¢˜æ„è½¬åŒ–ä¸ºåœ¨ AC è‡ªåŠ¨æœºä¸Šèµ° <span class=\"math inline\">\\(L\\)</span> æ­¥ï¼Œè¦æ±‚ç»è¿‡ <span class=\"math inline\">\\(n\\)</span> ä¸ªå¶å­çš„æ–¹æ¡ˆæ•°ã€‚ä¸å¤ªå¯åšï¼Œè½¬åŒ–æˆå®¹æ–¥ï¼ˆä»¤å­—ç¬¦ä¸²ç»ˆç‚¹ä¸å¯è¾¾ï¼‰ã€‚åœ¨å¤–å±‚æšä¸¾æ­¥æ•°æš´åŠ›æ¸¸èµ°ã€‚</p>\n<p>è¦æ±‚æ°å¥½èµ° <span class=\"math inline\">\\(L\\)</span> æ­¥ï¼Œä¹Ÿå¯ä»¥ç”¨çŸ©é˜µï¼›ä½†åŸå›¾å¾ˆç¨€ç–ï¼Œæ‰€ä»¥çŸ©é˜µå¹¶æ²¡æœ‰ä¼˜åŠ¿ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint tot = 1, T[805][26], fail[805];\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, l;\n    std::cin &gt;&gt; n &gt;&gt; l;\n    std::vector&lt;std::string&gt; a;\n    &#123;\n        std::vector&lt;std::string&gt; s(n + 1);\n        for (int i = 1; i &lt;= n; ++i)\n            std::cin &gt;&gt; s[i];\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            bool flag = 1;\n            for (int j = 1; j &lt;= n; ++j)\n                if (j != i)\n                    if (s[j].find(s[i]) != std::string::npos) &#123;\n                        flag = 0;\n                        break;\n                    &#125;\n            if (flag)\n                a.push_back(s[i]);\n        &#125;\n        n = (int)a.size();\n    &#125;\n    std::vector&lt;int&gt; pos(n);\n    for (int i = 0; i &lt; n; ++i) &#123;\n        int &amp;p = pos[i];\n        for (auto j : a[i]) &#123;\n            if (!T[p][j - &#39;a&#39;])\n                T[p][j - &#39;a&#39;] = tot++;\n            p = T[p][j - &#39;a&#39;];\n        &#125;\n    &#125;\n    &#123;\n        std::queue&lt;int&gt; q;\n        for (int i = 0; i &lt; 26; ++i)\n            if (T[0][i])\n                q.push(T[0][i]);\n        for (; !q.empty(); ) &#123;\n            int u = q.front();\n            q.pop();\n            for (int i = 0; i &lt; 26; ++i)\n                if (T[u][i]) &#123;\n                    int v = T[u][i];\n                    fail[v] = T[fail[u]][i];\n                    q.push(v);\n                &#125;\n                else\n                    T[u][i] = T[fail[u]][i];\n        &#125;\n    &#125;\n    auto res = 0ll;\n    int siz = 1 &lt;&lt; n;\n    for (int i = 0; i &lt; siz; ++i) &#123;\n        std::vector&lt;int&gt; tag(tot);\n        for (int j = 0; j &lt; n; ++j)\n            if ((i &gt;&gt; j) &amp; 1)\n                tag[pos[j]] = 1;\n        std::vector&lt;std::vector&lt;long long&gt; &gt; f(l + 1, std::vector&lt;long long&gt; (tot));\n        f[0][0] = 1ll;\n        for (int j = 0; j &lt; l; ++j)\n            for (int k = 0; k &lt; tot; ++k)\n                for (int a = 0; a &lt; 26; ++a) &#123;\n                    if (!tag[T[k][a]])\n                        (f[j + 1][T[k][a]] += f[j][k]) %= mod;\n                &#125;\n        int k = (__builtin_popcount(i) &amp; 1 ? mod - 1 : 1);\n        auto s = 0ll;\n        for (int j = 0; j &lt; tot; ++j)\n            if (!tag[j])\n                (s += f[l][j]) %= mod;\n        (res += k * s) %= mod;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"g---count-simple-paths-2\">G - Count Simple Paths 2</h2>\n<p><a href=\"https://atcoder.jp/contests/abc419/tasks/abc419_g\" class=\"uri\">https://atcoder.jp/contests/abc419/tasks/abc419_g</a></p>\n<p>å¾ˆæ–°çš„æ€§è´¨ã€‚è€ƒè™‘ã€ä»¥ <span class=\"math inline\">\\(1\\)</span> ä¸ºèµ·ç‚¹çš„ç®€å•è·¯å¾„æ•°ã€å’Œåç¥–è¾¹æ•°é‡çš„å…³ç³»ï¼šé€‰å®šä¸€æ¡åç¥–è¾¹å¿…é¡»è¢«ç»è¿‡æ—¶ï¼ˆæ˜¾ç„¶åªæœ‰ä¸€ç§å¯èƒ½çš„ç»è¿‡æ–¹å‘ï¼‰ï¼Œæ ‘çš„å½¢æ€å‘ç”Ÿå˜åŒ–ï¼š</p>\n<p><img src=\"image.png\" /></p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ç§åç¥–è¾¹çš„é€‰å–æ–¹æ¡ˆå¯¹åº”ä¸€ç§æ ‘ï¼Œéå†å…¶ä» <span class=\"math inline\">\\(1\\)</span> å¼€å§‹çš„ç®€å•è·¯å¾„å¤æ‚åº¦ä¸º <span class=\"math inline\">\\(O(n)\\)</span>ã€‚è®¾åç¥–è¾¹æ•°é‡ä¸º <span class=\"math inline\">\\(k\\)</span>ï¼Œé‚£ä¹ˆåˆæ³•çš„æ–¹æ¡ˆæ•°ä¸è¶…è¿‡ <span class=\"math inline\">\\(2^k\\)</span>ï¼Œæš´åŠ› DFS çš„æ•´ä¸ªå›¾å¤æ‚åº¦ä¸º <span class=\"math inline\">\\(O(2^k\\cdot n)\\)</span>ã€‚</p>\n<p>å‘ç°å¾ˆå¤šè·Ÿåç¥–è¾¹æ— å…³çš„éå†æ˜¯ä¸å¿…è¦çš„ï¼ˆåªæœ‰ä¸€ç§èµ°æ³•ï¼Œå¯ä»¥è®¾æˆè¾¹æƒï¼‰ï¼Œè€ƒè™‘å¯¹æ‰€æœ‰è¿æ¥åç¥–è¾¹çš„ç‚¹å»ºç«‹è™šæ ‘ï¼Œå¹¶æŠŠåŸæ ‘ä¸Šçš„åç¥–è¾¹ä¹Ÿç§»åˆ°è™šæ ‘ä¸Šï¼Œå°±èƒ½ <span class=\"math inline\">\\(O(2^k\\cdot k)\\)</span> è§£å†³é—®é¢˜ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1), g1(n + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g2(n + 1);\n    for (int x, y; m--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; tag(n + 1), vis(n + 1);\n    std::vector&lt;std::pair&lt;int, int&gt; &gt; be;\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        static int now = 0;\n        tag[x] = 1, vis[x] = ++now;\n        for (auto i : g[x])\n            if (!tag[i]) &#123;\n                // fprintf(stderr, &quot;%d -&gt; %d\\n&quot;, x, i);\n                g1[x].push_back(i), DFS(i, x);\n            &#125;\n            else if (i != fa &amp;&amp; vis[i] &lt; vis[x])\n                be.emplace_back(i, x);\n        return;\n    &#125;;\n    DFS(1, -1);\n    &#123; // æ±‚è™šæ ‘\n        std::vector&lt;int&gt; dep(n + 1), fa(n + 1), top(n + 1), siz(n + 1), son(n + 1), dfn(n + 1), rfn(n + 1);\n        std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n            siz[x] = 1;\n            for (auto i : g1[x]) &#123;\n                dep[i] = dep[x] + 1;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n            return;\n        &#125;;\n        DFS(1);\n        DFS = [&amp;](int x) &#123;\n            static int now = 0;\n            dfn[x] = ++now;\n            if (son[x])\n                top[son[x]] = top[x], DFS(son[x]);\n            for (auto i : g1[x])\n                if (i != son[x])\n                    top[i] = i, DFS(i);\n            rfn[x] = now;\n            // printf(&quot;%d: [%d, %d]\\n&quot;, x, dfn[x], rfn[x]);\n            return;\n        &#125;;\n        top[1] = 1, DFS(1);\n        auto getLCA = [&amp;](int x, int y) &#123;\n            for (; top[x] != top[y]; x = fa[top[x]])\n                if (dep[top[x]] &lt; dep[top[y]])\n                    std::swap(x, y);\n            return dep[x] &lt; dep[y] ? x : y;\n        &#125;;\n        tag.assign(n + 1, 0);\n        tag[1] = tag[n] = 1;\n        for (auto [u, v] : be)\n            tag[u] = 1, tag[v] = 1;\n        std::vector&lt;int&gt; p;\n        for (int i = 1; i &lt;= n; ++i)\n            if (tag[i])\n                p.push_back(i);\n        std::sort(p.begin(), p.end(), [&amp;](int i, int j) &#123; return dfn[i] &lt; dfn[j]; &#125;);\n        for (int i = 1; i &lt; (int)p.size(); ++i) &#123;\n            int fa = getLCA(p[i], p[i - 1]);\n            if (!tag[fa])\n                tag[fa] = 1;\n        &#125;\n        p.clear();\n        for (int i = 1; i &lt;= n; ++i)\n            if (tag[i])\n                p.push_back(i);\n        std::sort(p.begin(), p.end(), [&amp;](int i, int j) &#123; return dfn[i] &lt; dfn[j]; &#125;);\n        std::vector&lt;int&gt; st;\n        for (auto i : p) &#123;\n            if (st.empty())\n                st.push_back(i);\n            else &#123;\n                for (; rfn[st.back()] &lt; dfn[i]; st.pop_back());\n                g2[st.back()].emplace_back(i, dep[i] - dep[st.back()]);\n                g2[i].emplace_back(st.back(), dep[i] - dep[st.back()]);\n                // printf(&quot;add (%d, %d): %d\\n&quot;, st.back(), i, dep[i] - dep[st.back()]);\n                st.push_back(i);\n            &#125;\n        &#125;\n        for (auto [u, v] : be) &#123;\n            g2[u].emplace_back(v, 1), g2[v].emplace_back(u, 1);\n            // printf(&quot;# add(%d, %d): 1\\n&quot;, u, v);\n        &#125;\n    &#125;\n    tag.assign(n + 1, 0);\n    std::vector&lt;int&gt; res(n + 1);\n    DFS = [&amp;](int x, int s) &#123;\n        if (x == n)\n            ++res[s];\n        tag[x] = 1;\n        for (auto [i, w] : g2[x])\n            if (!tag[i])\n                DFS(i, s + w);\n        tag[x] = 0;\n        return;\n    &#125;;\n    DFS(1, 0);\n    for (int i = 1; i &lt; n; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39; &#39;;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "çº¿æ®µæ ‘",
                "AC è‡ªåŠ¨æœº",
                "è´ªå¿ƒ",
                "DP ä¼˜åŒ–",
                "è™šæ ‘"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250814/",
            "url": "https://xsc062.netlify.app/20250814/",
            "title": "DDP ä¸ GBT ç»ƒä¹ ",
            "date_published": "2025-08-14T09:08:21.000Z",
            "content_html": "<p>çº¿æ®µæ ‘æ˜¯å¯¹çš„ï¼ˆå­˜ç–‘ï¼‰</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a---æ•°æ®ä¼ è¾“\">A - æ•°æ®ä¼ è¾“</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P8820\" class=\"uri\">https://www.luogu.com.cn/problem/P8820</a></p>\n<p>æˆ‘åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°äº† <a href=\"/20250812/#æ ‘ä¸Šè·¯å¾„æŸ¥è¯¢\">DDP &amp; è·¯å¾„æŸ¥è¯¢é—®é¢˜</a>ï¼Œåœ¨è¿™ä¸ªé¢˜ä¸­å°±æœ‰ä½“ç°ã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(f_{u,0/1/2}\\)</span> è¡¨ç¤ºæ•°æ®ä¿å­˜åœ¨ <span class=\"math inline\">\\(u\\)</span> å¾€ä¸‹æ•° <span class=\"math inline\">\\(0/1/2\\)</span> ä¸ªç‚¹å¤„çš„æœ€å°ä»£ä»·ï¼Œæ‰‹ç©å®¹æ˜“å‘ç° <span class=\"math inline\">\\(k=3\\)</span> æ—¶<strong>æœ€ä¼˜è·¯å¾„å¯èƒ½ä¼šå¾€æŸä¸ª <span class=\"math inline\">\\(x\\)</span> æˆ– <span class=\"math inline\">\\(fa\\)</span> å¤„çš„æœ€å°ä»£ä»·å„¿å­å¤„ç»•ä¸€åœˆæ¥é¿å…è¿™ä¸ª <span class=\"math inline\">\\(x\\)</span> æˆ– <span class=\"math inline\">\\(fa\\)</span> çš„ä»£ä»·</strong>ã€‚ä½†è¯¥å€¼æ˜¯å®šå€¼ï¼Œé—®é¢˜è¿˜æ˜¯çº¯è·¯å¾„é—®é¢˜ï¼Œå°±å¯ä»¥ DDP äº†ã€‚</p>\n<figure>\n<img src=\"image.png\" alt=\"å…±ä¸¤ç§å¯èƒ½æ€§ï¼ˆä»»æ„ä¸€ä¸ªç®­å¤´é•¿åº¦ä¸ä¸º 3 æ—¶ç»•ä¸€åœˆä¸€å®šä¸æ¯”ç›´æ¥èµ°æ›´ä¼˜ï¼‰\" /><figcaption>å…±ä¸¤ç§å¯èƒ½æ€§ï¼ˆä»»æ„ä¸€ä¸ªç®­å¤´é•¿åº¦ä¸ä¸º <span class=\"math inline\">\\(3\\)</span> æ—¶ç»•ä¸€åœˆä¸€å®šä¸æ¯”ç›´æ¥èµ°æ›´ä¼˜ï¼‰</figcaption>\n</figure>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nstruct mat &#123;\n    long long a[3][3];\n    long long* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    mat() &#123;\n        memset(a, 0x3f, sizeof (a));\n        return;\n    &#125;\n    mat(int flag) &#123;\n        memset(a, 0x3f, sizeof (a));\n        a[0][0] = a[1][1] = a[2][2] = 0ll;\n        return;\n    &#125;\n    mat operator* (mat &amp;q) const &#123;\n        mat res;\n        for (int i = 0; i &lt; 3; ++i)\n            for (int k = 0; k &lt; 3; ++k)\n                for (int j = 0; j &lt; 3; ++j)\n                    res[i][k] = std::min(res[i][k], a[i][j] + q[j][k]);\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, q, k;\n    std::cin &gt;&gt; n &gt;&gt; q &gt;&gt; k;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;int&gt; mx(n + 1, 0x3f3f3f3f);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        mx[x] = std::min(mx[x], a[y]);\n        mx[y] = std::min(mx[y], a[x]);\n        g1[x].push_back(y), g1[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; dep(n + 1);\n    std::vector&lt;std::array&lt;int, 18&gt; &gt; f(n + 1);\n    std::vector&lt;std::array&lt;mat, 18&gt; &gt; u(n + 1), d(n + 1);\n    u[0][0] = d[0][0] = mat(1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        for (auto i : g1[x])\n            if (i != f[x][0]) &#123;\n                f[i][0] = x;\n                &#123;\n                    mat s;\n                    s[0][0] = a[x];\n                    if (k &gt;= 2) &#123;\n                        s[0][1] = 0;\n                        s[1][0] = a[x];\n                    &#125;\n                    if (k &gt;= 3) &#123;\n                        s[1][2] = 0;\n                        s[2][0] = a[x];\n                        s[1][1] = mx[x];\n                        s[2][2] = mx[i];\n                    &#125;\n                    u[i][0] = s; \n                    s[0][0] = a[i];\n                    if (k &gt;= 2)\n                        s[1][0] = a[i];\n                    if (k &gt;= 3) &#123;\n                        s[2][0] = a[i];\n                        s[1][1] = mx[i];\n                        s[2][2] = mx[x];\n                    &#125;\n                    d[i][0] = s; \n                &#125;\n                for (int j = 1; j &lt; 18; ++j) &#123;\n                    f[i][j] = f[f[i][j - 1]][j - 1];\n                    u[i][j] = u[i][j - 1] * u[f[i][j - 1]][j - 1];\n                    d[i][j] = d[f[i][j - 1]][j - 1] * d[i][j - 1];\n                &#125;\n                dep[i] = dep[x] + 1;\n                DFS(i);\n            &#125;\n        return;\n    &#125;;\n    dep[1] = 1, DFS(1);\n    for (int x, y; q--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        long long res = a[x];\n        mat r1(1), r2(1);\n        if (dep[x] &gt; dep[y]) &#123;\n            for (int i = 17; ~i; --i)\n                if (dep[f[x][i]] &gt;= dep[y]) &#123;\n                    r1 = r1 * u[x][i];\n                    x = f[x][i];\n                &#125;\n        &#125;\n        else if (dep[y] &gt; dep[x]) &#123;\n            for (int i = 17; ~i; --i)\n                if (dep[f[y][i]] &gt;= dep[x]) &#123;\n                    r2 = d[y][i] * r2;\n                    y = f[y][i];\n                &#125;\n        &#125;\n        if (x != y) &#123;\n            for (int i = 17; ~i; --i)\n                if (f[x][i] != f[y][i]) &#123;\n                    r1 = r1 * u[x][i];\n                    r2 = d[y][i] * r2;\n                    x = f[x][i], y = f[y][i];\n                &#125;\n            r1 = r1 * u[x][0], r2 = d[y][0] * r2;\n        &#125;\n        std::cout &lt;&lt; res + (r1 * r2)[0][0] &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---the-silk-road-with-robots\">B - The Silk Road â€¦ with Robots!</h2>\n<p><a href=\"https://qoj.ac/problem/10410\" class=\"uri\">https://qoj.ac/problem/10410</a></p>\n<blockquote>\n<p>é¢˜æ„ï¼šåˆå§‹æœ‰ä¸€ä¸ªé•¿ä¸º <span class=\"math inline\">\\(10^8\\)</span> çš„ç©ºæ•°è½´ï¼Œç»™å®š <span class=\"math inline\">\\(n\\)</span> æ¬¡æ“ä½œï¼Œæ¯æ¬¡æ“ä½œåœ¨æ•°è½´ä¸Šçš„ä¸€ä¸ªç©ºä½æ”¾ä¸€ä¸ª A ç±»ç‚¹æˆ– B ç±»ç‚¹ã€‚æ¯ä¸ª A ç±»ç‚¹æœ‰å…¶<strong>ä»·å€¼</strong>ã€‚</p>\n<p>ä»»æ„åœ¨æ•°è½´ä¸Šç§»åŠ¨è¿™äº› B ç±»ç‚¹ï¼Œ<strong>æ€»ä»·å€¼</strong>ä¸ºæ‰€æœ‰è¢«ç»è¿‡çš„ A ç±»ç‚¹çš„<strong>ä»·å€¼</strong> - B ç±»ç‚¹ç§»åŠ¨æ€»è·¯ç¨‹ã€‚æ¯æ¬¡æ“ä½œåè¾“å‡ºæœ€å¤§<strong>æ€»ä»·å€¼</strong>ï¼Œé‡å¤ç»è¿‡çš„ A ç±»ç‚¹åªè®¡ä¸€æ¬¡ã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 2\\times 10^5\\)</span>ã€‚</p>\n</blockquote>\n<p>è¿™ä¸ªé¢˜ç¡®å®å¯ä»¥å¸¦æ¥å¾ˆå¤šå¯å‘ï¼Œæˆ‘ä¸€å¼€å§‹ç›´æ¥è®¾ <span class=\"math inline\">\\(f_j\\)</span> ä¸ºçŠ¶æ€ï¼Œè¿™æ ·å¯¹äºæš´åŠ›æ˜¯å¯åšçš„ï¼Œä½†æ˜¯ä¼šå‡ºç°ä¸€äº›éœ€è¦è¢«åŒºé—´ä¿®æ”¹çš„ç³»æ•°ï¼Œæ¯”å¦‚<strong>å‰ç¼€å’Œ</strong>ã€‚æœ€å¥½è®¾è®¡çŠ¶æ€ï¼Œè®©è½¬ç§»çš„æ—¶å€™åªéœ€è¦ç”¨åˆ°å¸¸æ•°ã€å·®åˆ†å€¼ç­‰ä¿®æ”¹æ¬¡æ•°å¾ˆå°‘çš„ç³»æ•°ã€‚</p>\n<p>è®¾ <span class=\"math inline\">\\(f_{i,0/1/2/3}\\)</span> åˆ†åˆ«è¡¨ç¤ºï¼š</p>\n<p><img src=\"image-1.png\" /></p>\n<p>é‚£ä¹ˆå¯ä»¥å†™å‡ºè½¬ç§»å¼ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{i,0}=\\max(mx+a_i+x_i,f_{i-1,0}+a_i)\\\\\nf_{i,1}=\\max(mx+a_i+2x_i,f_{i-1,1}+a_i)\\\\\nf_{i,2}=f_{i-1,2}-(x_i-x_{i-1}) + a_i\\\\\nf_{i,3}=f_{i-1,3}-2(x_i-x_{i-1})+a_i\n\\]</span></p>\n<p>å…¶ä¸­ <span class=\"math inline\">\\(mx\\)</span> ä¸º <span class=\"math inline\">\\(f_{i,2/3}\\)</span> çš„å‰ç¼€æœ€å¤§å€¼ã€‚åœ¨ B ç±»ç‚¹å¤„å¯ä»¥è®© <span class=\"math inline\">\\(f_{2/3}\\)</span> ç»§æ‰¿å¯¹åº”çš„ <span class=\"math inline\">\\(f_{0/1}\\)</span>ï¼Œæ–°å¼€ä¸€ç»´è®°å½• <span class=\"math inline\">\\(mx\\)</span> å°±å¯ä»¥ç»´æŠ¤çŸ©ä¹˜äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int lim = 1e8;\nconst int maxn = 5e6 + 5;\nconst long long inf = 1e12;\nstruct mat &#123;\n    long long a[5][5];\n    mat() &#123;&#125;\n    long long* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    mat operator* (mat &amp;q) const &#123;\n        mat res;\n        for (int i = 0; i &lt; 5; ++i)\n            for (int k = 0; k &lt; 5; ++k) &#123;\n                auto u(-inf);\n                for (int j = 0; j &lt; 5; ++j)\n                    u = std::max(u, a[i][j] + q[j][k]);\n                res[i][k] = u;\n            &#125;\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int l, r; mat u; &#125; t[maxn];\n#define lt t[p].l\n#define rt t[p].r\nvoid add(int &amp;p, int l, int r, int x, mat &amp;v) &#123;\n    static int tot = 0;\n    if (!p)\n        p = ++tot;\n    if (l == r) &#123;\n        t[p].u = v;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, l, mid, x, v);\n    else\n        add(rt, mid + 1, r, x, v);\n    t[p].u = t[lt].u * t[rt].u;\n    return;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    &#123;\n        mat &amp;u = t[0].u;\n        for (int i = 0; i &lt; 5; ++i)\n            for (int j = 0; j &lt; 5; ++j)\n                u[i][j] = -inf;\n        u[0][0] = u[1][1] = u[2][2] = u[3][3] = u[4][4] = 0ll;\n    &#125;\n    int m, rt = 0;\n    std::cin &gt;&gt; m;\n    std::vector&lt;mat&gt; a(m + 1);\n    std::vector&lt;int&gt; ty(m + 1);\n    std::set&lt;std::pair&lt;long long, int&gt; &gt; s;\n    s.emplace(-inf, 0);\n    for (int op, x, i = 1; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; op &gt;&gt; x;\n        auto &amp;u = a[i];\n        for (int i = 0; i &lt; 5; ++i)\n            for (int j = 0; j &lt; 5; ++j)\n                u[i][j] = -inf;\n        auto p = --s.lower_bound(std::make_pair(x, 0)), q = s.upper_bound(std::make_pair(x, 0));\n        int v = 0;\n        if (op == 2)\n            std::cin &gt;&gt; v;\n        u[0][0] = v, u[1][1] = v, u[4][0] = v + x, u[4][1] = v + 2 * x;\n        if (op == 1) &#123;\n            ty[i] = 0;\n            u[4][2] = u[4][1] - 2 * x;\n            u[1][2] = u[1][1] - 2 * x;\n            u[4][3] = u[4][0] - x;\n            u[0][3] = u[0][0] - x;\n        &#125;\n        else &#123;\n            ty[i] = 1;\n            u[2][2] = v - (x - p-&gt;first);\n            u[3][3] = v - 2 * (x - p-&gt;first);\n        &#125;\n        u[4][4] = std::max(&#123; 0ll, u[4][2], u[4][3] &#125;);\n        u[1][4] = u[1][2], u[0][4] = u[0][3], u[2][4] = u[2][2], u[3][4] = u[3][3];\n        add(rt, 0, lim, x, u);\n        if (q != s.end() &amp;&amp; ty[q-&gt;second] == 1) &#123;\n            auto &amp;u = a[q-&gt;second];\n            u[2][2] -= p-&gt;first, u[2][2] += x;\n            u[3][3] -= 2 * p-&gt;first, u[3][3] += 2 * x;\n            u[2][4] = u[2][2], u[3][4] = u[3][3];\n            add(rt, 0, lim, q-&gt;first, a[q-&gt;second]);\n        &#125;\n        s.emplace(x, i);\n        std::cout &lt;&lt; t[1].u[4][4] &lt;&lt; &#39;\\n&#39;;\n        // for (int i = 0; i &lt; 5; ++i, puts(&quot;&quot;))\n        //     for (int j = 0; j &lt; 5; ++j)\n        //         if (t[1].u[i][j] &lt; -200)\n        //             printf(&quot;  x &quot;);\n        //         else\n        //             printf(&quot;%3lld &quot;, t[1].u[i][j]);\n        // puts(&quot;=============&quot;);\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---å¯†ç ç®±\">C - å¯†ç ç®±</h2>\n<p><a href=\"/20250818/#c---%E5%AF%86%E7%A0%81%E7%AE%B1\">link</a>;</p>\n",
            "tags": [
                "çº¿æ®µæ ‘",
                "DDP"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250812/",
            "url": "https://xsc062.netlify.app/20250812/",
            "title": "DDP ä¸å…¨å±€å¹³è¡¡äºŒå‰æ ‘",
            "date_published": "2025-08-12T00:16:52.000Z",
            "content_html": "<p>å…¶å®åŠ¨æ€ DP ä¸æ˜¯åŠ¨æ€æ ‘ DP çš„åŒä¹‰è¯</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"åŠ¨æ€-dp\">åŠ¨æ€ DP</h2>\n<p>å¯¹äºè½¬ç§»åªä¾èµ–å‰å‡ é¡¹çš„ DPï¼Œå¯ä»¥æ”¾è¿›çŸ©é˜µã€‚</p>\n<p>é»˜è®¤è½¬ç§»èŒƒå›´æ˜¯ <span class=\"math inline\">\\([1,n]\\)</span>ï¼›å¦‚æœæˆ‘ä»¬éœ€è¦æ”¹å˜æ±‚è§£èŒƒå›´ï¼Œå‘ç°å¦‚æœèƒ½è·å–è½¬ç§»çŸ©é˜µçš„ä¹˜ç§¯å°±å¾ˆå¿«äº†ã€‚è€ƒè™‘å­˜ä¸‹æ¥ã€‚</p>\n<p>å¦‚æœéœ€è¦å•ç‚¹ä¿®æ”¹ï¼Œç­‰ä»·äºä¿®æ”¹å…¶æ‰€åœ¨çŸ©é˜µï¼Œåˆ™æƒ³è¦å°½å¯èƒ½å°‘åœ°ä¿®æ”¹å­˜å‚¨çš„ç­”æ¡ˆï¼Œè€ƒè™‘ä½¿ç”¨çº¿æ®µæ ‘ä¼˜åŒ–è¯¥è¿‡ç¨‹ã€‚</p>\n<h3 id=\"ä¾‹æµ·æŠ¥\">ä¾‹ï¼šæµ·æŠ¥</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P9790\" class=\"uri\">https://www.luogu.com.cn/problem/P9790</a></p>\n<p>å®¹æ˜“åˆ—å‡ºæš´åŠ› DP å¼ï¼šä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºæšä¸¾åˆ° <span class=\"math inline\">\\(i\\)</span> æ—¶ï¼ŒåŒ…å« <span class=\"math inline\">\\(i\\)</span> åœ¨å†…å·²ç»æœ‰ <span class=\"math inline\">\\(j\\)</span> ä¸ªè¿ç»­çš„äººä¸¾èµ·æµ·æŠ¥ï¼Œæ˜“å¾—ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{i,0}=\\max(f_{i-1,0},f_{i-1,1},f_{i-1,2},f_{i-1,3})\\\\\nf_{i,j}=f_{i-1,j-1}+a_i \\forall 1\\le j\\le 3\n\\]</span></p>\n<p>å‘ç°æ»¡è¶³ + / max <strong>çŸ©é˜µä¹˜æ³•</strong> çš„å½¢å¼ï¼›æƒ³åˆ°ç”¨çº¿æ®µæ ‘ä¿å­˜æ¯æ®µåŒºé—´å¯¹åº”çŸ©é˜µï¼ˆå¯¹åº”æ€§è´¨ï¼šç»“åˆå¾‹ï¼‰ï¼Œæ¯æ¬¡ä¿®æ”¹ / æŸ¥è¯¢å°±èƒ½åœ¨ <span class=\"math inline\">\\(O(\\log n)\\)</span> ä¹‹å†…å®Œæˆã€‚</p>\n<p>åŸé—®é¢˜æ˜¯ç¯å½¢çš„ï¼Œå¯ä»¥å†åŠ ä¸€ç»´ <span class=\"math inline\">\\(k\\)</span> è¡¨ç¤ºé’¦å®šé€‰äº†å‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªä¸”ä¸é€‰ç¬¬ <span class=\"math inline\">\\(k+1\\)</span> ä¸ªæ—¶çš„ç­”æ¡ˆã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 4e4 + 5;\nconst long long inf = 1e18;\nstruct mat &#123;\n    int n, m;\n    long long a[4][4];\n    mat() &#123;&#125;\n    mat(int n1, int m1): n(n1), m(m1) &#123;\n        for (int i = 0; i &lt; n; ++i)\n            for (int j = 0; j &lt; m; ++j)\n                a[i][j] = -inf;\n        return;\n    &#125;\n    long long* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    mat operator* (mat &amp;q) const &#123;\n        mat res(n, q.m);\n        for (int i = 0; i &lt; n; ++i)\n            for (int k = 0; k &lt; q.m; ++k)\n                for (int j = 0; j &lt; m; ++j)\n                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int l, r; mat u[4]; &#125; t[maxn &lt;&lt; 2];\nint a[maxn];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\n#define c t[p].u[i]\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        for (int i = 0; i &lt;= 3; ++i) &#123;\n            c = mat(4, 4);\n            if (l &gt; i + 1) &#123;\n                c[0][0] = c[1][0] = c[2][0] = c[3][0] = 0;\n                c[0][1] = c[1][2] = c[2][3] = a[l];\n            &#125;\n            else if (l == i + 1)\n                c[0][0] = c[1][0] = c[2][0] = c[3][0] = 0;\n            else\n                c[0][1] = c[1][2] = c[2][3] = a[l];\n        &#125;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    for (int i = 0; i &lt;= 3; ++i)\n        t[p].u[i] = t[lt].u[i] * t[rt].u[i];\n    return;\n&#125;\nvoid add(int p, int x, int v) &#123;\n    if (t[p].l == t[p].r) &#123;\n        for (int i = 0; i &lt;= 3; ++i)\n            if (t[p].l != i + 1) \n                c[0][1] = c[1][2] = c[2][3] = v;\n        return;\n    &#125;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, x, v);\n    else\n        add(rt, x, v);\n    for (int i = 0; i &lt;= 3; ++i)\n        t[p].u[i] = t[lt].u[i] * t[rt].u[i];\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    bld(1, 1, n);\n    auto calc = [&amp;](void) &#123;\n        mat f(1, 4);\n        f[0][0] = 0;\n        auto res = -inf;\n        for (int i = 0; i &lt;= 3; ++i) &#123;\n            auto r = (f * t[1].u[i]);\n            for (int j = 0; j &lt;= 3; ++j)\n                if (i + j &lt;= 3) &#123;\n                    res = std::max(res, r[0][j]);\n                    // printf(&quot;f[%d][%d] = %lld\\n&quot;, i, j, f[i][j]);\n                &#125;\n        &#125;\n        return res;\n    &#125;;\n    std::cout &lt;&lt; calc() &lt;&lt; &#39;\\n&#39;;\n    int q;\n    std::cin &gt;&gt; q;\n    for (int x, v; q--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; v;\n        add(1, x, v);\n        std::cout &lt;&lt; calc() &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<p>å‘ç°çŸ©é˜µæœ¬èº«å’Œ <span class=\"math inline\">\\(k\\)</span> æ— å…³ï¼Œè¿˜å¯ä»¥å¯ä»¥å…±ç”¨ä¸€ä¸ªçº¿æ®µæ ‘ä¸Šçš„ä¿¡æ¯ï¼Œå°±å¯ä»¥åªå¼€ä¸€ä¸ªçº¿æ®µæ ‘äº†ã€‚</p>\n<details>\n<p>æˆ‘å†™è¿™ä¸€ç‰ˆæœ¬çš„åŸå› æ˜¯ <code>maxn</code> å¼€å¤§äº†å¯¼è‡´ MLEï¼Œå®é™…ä¸Šå››ä¸ªçº¿æ®µæ ‘æ˜¯æ²¡æœ‰ä»»ä½•ç©ºé—´å‹åŠ›çš„ ğŸ˜…</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 4e5 + 5;\nconst long long inf = 1e18;\nstruct mat &#123;\n    int n, m;\n    long long a[4][4];\n    mat() &#123;&#125;\n    mat(int n1, int m1): n(n1), m(m1) &#123;\n        for (int i = 0; i &lt; n; ++i)\n            for (int j = 0; j &lt; m; ++j)\n                a[i][j] = -inf;\n        return;\n    &#125;\n    long long* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    mat operator* (mat q) const &#123;\n        mat res(n, q.m);\n        for (int i = 0; i &lt; n; ++i)\n            for (int k = 0; k &lt; q.m; ++k)\n                for (int j = 0; j &lt; m; ++j)\n                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int l, r; mat u; &#125; t[maxn &lt;&lt; 2];\nint a[maxn];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        t[p].u = mat(4, 4);\n        t[p].u[0][0] = t[p].u[1][0] = t[p].u[2][0] = t[p].u[3][0] = 0;\n        t[p].u[0][1] = t[p].u[1][2] = t[p].u[2][3] = a[l];\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    t[p].u = t[lt].u * t[rt].u;\n    return;\n&#125;\nvoid add(int p, int x, int v) &#123;\n    if (t[p].l == t[p].r) &#123;\n        t[p].u[0][1] = t[p].u[1][2] = t[p].u[2][3] = v;\n        return;\n    &#125;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, x, v);\n    else\n        add(rt, x, v);\n    t[p].u = t[lt].u * t[rt].u;\n    return;\n&#125;\nmat ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].u;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (r &lt;= mid)\n        return ask(lt, l, r);\n    if (l &gt; mid)\n        return ask(rt, l, r);\n    return ask(lt, l, r) * ask(rt, l, r);\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    bld(1, 1, n);\n    auto calc = [&amp;](void) &#123;\n        mat f(1, 4);\n        f[0][0] = 0, f[0][1] = f[0][2] = f[0][3] = -inf;\n        auto r(f * ask(1, 2, n));\n        auto res(*std::max_element(r[0], r[0] + 4));\n        mat z(4, 4);\n        z[0][0] = z[1][0] = z[2][0] = z[3][0] = 0ll;\n        for (int i = 1; i &lt;= 3; ++i) &#123;\n            mat op(4, 4);\n            op[0][1] = op[1][2] = op[2][3] = a[i];\n            f *= op;\n            if (i + 2 &lt;= n)\n                r = f * z * ask(1, i + 2, n);\n            else\n                r = f * z;\n            res = std::max(res, *std::max_element(r[0], r[0] + 4 - i));\n        &#125;\n        return res;\n    &#125;;\n    std::cout &lt;&lt; calc() &lt;&lt; &#39;\\n&#39;;\n    int q;\n    std::cin &gt;&gt; q;\n    for (int x, v; q--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; v, a[x] = v;\n        add(1, x, v);\n        std::cout &lt;&lt; calc() &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"ç»å…¸é¢˜gss3\">ç»å…¸é¢˜ï¼šGSS3</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/SP1716\" class=\"uri\">https://www.luogu.com.cn/problem/SP1716</a></p>\n<p>æ€ä¹ˆæ˜¯å­æ®µå’Œ ğŸ˜“</p>\n<p>åŒæ ·åˆ—å‡ºèƒ½å¤ŸçŸ©é˜µä¹˜æ³•çš„ DP å¼ï¼Œå‘ç°é™åˆ¶åœ¨äºè‡³å°‘è¦é€‰ä¸€ä¸ªæ•°ã€‚è®¾ <span class=\"math inline\">\\(f_{i}\\)</span> è¡¨ç¤ºé€‰äº† <span class=\"math inline\">\\(i\\)</span> çš„æœ€å¤§å€¼ï¼Œ<span class=\"math inline\">\\(g_i\\)</span> è¡¨ç¤ºå†å²æœ€å¤§å€¼ï¼Œåˆ™ï¼š</p>\n<p><span class=\"math display\">\\[\nf_i=\\max(f_{i-1}+a_i,0+a_i)\\\\\ng_i=\\max(g_{i-1}+0,f_{i-1}+a_i,0+a_i)\n\\]</span></p>\n<p>å®¹æ˜“å‘ç°æ˜¯ä¸€ä¸ª + / max çŸ©ä¹˜ï¼Œçº¿æ®µæ ‘ç»´æŠ¤å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 4e5 + 5;\nconst long long inf = 1e18;\nstruct mat &#123;\n    int n, m;\n    long long a[3][3];\n    mat() &#123;&#125;\n    mat(int n1, int m1): n(n1), m(m1) &#123;\n        for (int i = 0; i &lt; n; ++i)\n            for (int j = 0; j &lt; m; ++j)\n                a[i][j] = -inf;\n        return;\n    &#125;\n    long long* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    mat operator* (mat q) const &#123;\n        mat res(n, q.m);\n        for (int i = 0; i &lt; n; ++i)\n            for (int k = 0; k &lt; q.m; ++k)\n                for (int j = 0; j &lt; m; ++j)\n                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int l, r; mat u; &#125; t[maxn &lt;&lt; 2]; \nint a[maxn];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        t[p].u = mat(3, 3);\n        t[p].u[0][0] = t[p].u[2][0] = a[l];\n        t[p].u[0][1] = a[l], t[p].u[1][1] = 0ll, t[p].u[2][1] = a[l];\n        t[p].u[2][2] = 0ll;\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    t[p].u = t[lt].u * t[rt].u;\n    return;\n&#125;\nvoid add(int p, int x, int v) &#123;\n    if (t[p].l == t[p].r) &#123;\n        t[p].u[0][0] = t[p].u[2][0] = t[p].u[0][1] = t[p].u[2][1] = v;\n        return;\n    &#125;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, x, v);\n    else\n        add(rt, x, v);\n    t[p].u = t[lt].u * t[rt].u;\n    return;\n&#125;\nmat ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].u;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (r &lt;= mid)\n        return ask(lt, l, r);\n    if (l &gt; mid)\n        return ask(rt, l, r);\n    return ask(lt, l, r) * ask(rt, l, r);\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    bld(1, 1, n);\n    auto calc = [&amp;](int l, int r) &#123;\n        mat f(1, 3);\n        f[0][2] = 0ll;\n        auto res(f * ask(1, l, r));\n        return res[0][1];\n    &#125;;\n    int q;\n    std::cin &gt;&gt; q;\n    for (int op; q--; ) &#123;\n        std::cin &gt;&gt; op;\n        if (op == 1) &#123;\n            int l, r;\n            std::cin &gt;&gt; l &gt;&gt; r;\n            std::cout &lt;&lt; calc(l, r) &lt;&lt; &#39;\\n&#39;;\n        &#125;\n        else &#123;\n            int x, v;\n            std::cin &gt;&gt; x &gt;&gt; v;\n            a[x] = v, add(1, x, v);\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"åŠ¨æ€æ ‘-dp\">åŠ¨æ€æ ‘ DP</h2>\n<p>æŠŠä¸Šè¿°è¿‡ç¨‹æ”¾åˆ°æ ‘ä¸Šï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°æ ‘å‰– + çº¿æ®µæ ‘ã€‚</p>\n<p>ç”±äºè®¤ä¸ºçº¿æ®µæ ‘ä¸Šçš„çŸ©ä¹˜åªèƒ½è¿›è¡Œä»é‡å„¿å­åˆ°çˆ¶äº²çš„è½¬ç§»ï¼Œè½»å„¿å­çš„è½¬ç§»ä¼šè¢«åˆå¹¶ä¸ºä¸€ä¸ªæ–°å‡½æ•°ï¼ˆåŒæ—¶æ˜¯çŸ©é˜µçš„ç³»æ•°ï¼‰ï¼Œåœ¨è·³é‡é“¾çš„æ—¶å€™è¢«å•ç‹¬æ›´æ–°ã€‚</p>\n<p>ç”±äºä¸¤ä¸ªå‡½æ•°ç›¸äº’ä¾èµ–ï¼Œéœ€è¦æ€è€ƒæ¸…æ¥šæ›´æ–°çš„å…ˆåé¡ºåºã€‚</p>\n<h3 id=\"æ¨¡æ¿åŠ¨æ€-dp\">ã€æ¨¡æ¿ã€‘åŠ¨æ€ DP</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P4719\" class=\"uri\">https://www.luogu.com.cn/problem/P4719</a></p>\n<p>ä»¤ <span class=\"math inline\">\\(f_{u,0/1}\\)</span> è¡¨ç¤ºåœ¨ <span class=\"math inline\">\\(u\\)</span> ä¸Šï¼Œé€‰ / ä¸é€‰ <span class=\"math inline\">\\(u\\)</span> çš„æœ€å¤§ä»·å€¼ã€‚å®¹æ˜“å¾—å‡ºè½¬ç§»ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{u,0}=\\sum\\max(f_{v,0},f_{v,1})\\\\\nf_{u,1}=a_i+\\sum f_{v,0}\n\\]</span></p>\n<p>æŠŠè½¬ç§»çŸ©é˜µæ”¾åˆ°æ ‘å‰–ä¸Šåï¼Œè€ƒè™‘æ›´æ–°ï¼Œå‘ç°æ±‚å’Œè¿™ä¸€æ­¥å¾ˆå›°éš¾ã€‚è§£å†³æ–¹æ¡ˆæ˜¯<strong>ç›´æ¥å°†æ±‚å’Œç”¨å¦ä¸€ä¸ªå‡½æ•°ä»£æ›¿</strong>ã€‚å®šä¹‰ <span class=\"math inline\">\\(g_{u,0}\\)</span> è¡¨ç¤ºå– <span class=\"math inline\">\\(u\\)</span>ã€ä¸å– <span class=\"math inline\">\\(u\\)</span> çš„æ‰€æœ‰è½»å„¿å­çš„ç­”æ¡ˆï¼Œ<span class=\"math inline\">\\(g_{u,1}\\)</span> ä¸å– <span class=\"math inline\">\\(u\\)</span>ï¼Œè½»å„¿å­å¯é€‰å¯ä¸é€‰çš„ç­”æ¡ˆã€‚</p>\n<p><span class=\"math inline\">\\(g\\)</span> æ˜¯å¯æ±‚çš„ï¼Œä¸”åªéœ€è¦åœ¨è·³é‡é“¾çš„æ—¶å€™æ›´æ–° <span class=\"math inline\">\\(g\\)</span>ã€‚å…·ä½“æ›´æ–°èµ·æ¥éå¸¸ç»ï¼Œå› ä¸º <span class=\"math inline\">\\(g\\)</span> å’Œ <span class=\"math inline\">\\(f\\)</span> æ˜¯ç›¸äº’ä¾èµ–çš„ï¼Œéœ€è¦åˆ†æ¸…æ¥šå…ˆåå…³ç³»ã€‚</p>\n<p>é¦–å…ˆ <span class=\"math inline\">\\(g_u\\)</span> å’Œ <span class=\"math inline\">\\(f_u\\)</span> éƒ½ä¼šè¢«æ›´æ–°ï¼›æ¥ç€ï¼Œé‡é“¾ä¸Šå…¶å®ƒçš„ <span class=\"math inline\">\\(g\\)</span> ä¸ä¼šè¢«å½±å“ï¼Œè€Œé“¾é¡¶çš„ <span class=\"math inline\">\\(f\\)</span> éœ€è¦è¢«æ–°çš„ <span class=\"math inline\">\\(g_u\\)</span> æ›´æ–°ï¼›ç”±æ­¤é“¾é¡¶çˆ¶äº²çš„ <span class=\"math inline\">\\(g\\)</span> è¢«æ›´æ–°ï¼›ä¾æ¬¡ç±»æ¨ã€‚æ³¨æ„åˆ°å¯¹äºä¸€ä¸ªé“¾é¡¶ï¼Œå…¶ <span class=\"math inline\">\\(f\\)</span> å€¼æ˜¯æ•´æ¡é‡é“¾çš„ä¹˜ç§¯ï¼Œæ•…éœ€è¦è®°å½•é“¾åº•ã€‚</p>\n<p>å¤æ‚åº¦ <span class=\"math inline\">\\(O(q\\log ^2n)\\)</span>ã€‚æ³¨æ„å¾ˆé‡è¦çš„ä¸€ç‚¹æ˜¯çº¿æ®µæ ‘å†…ä¹˜æ³•åº”ä»å³å¾€å·¦ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e5 + 5;\nconst int inf = 0x3f3f3f3f;\nstruct mat &#123;\n    int n, m, a[2][2];\n    mat() &#123;&#125;\n    mat(int n1, int m1): n(n1), m(m1) &#123;\n        for (int i = 0; i &lt; n; ++i)\n            for (int j = 0; j &lt; m; ++j)\n                a[i][j] = -inf;\n        return;\n    &#125;\n    int* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    mat operator* (mat q) const &#123;\n        mat res(n, q.m);\n        for (int i = 0; i &lt; n; ++i)\n            for (int k = 0; k &lt; q.m; ++k)\n                for (int j = 0; j &lt; m; ++j)\n                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int l, r; mat u; &#125; t[maxn &lt;&lt; 2]; \nint g[maxn][2], tab[maxn];\n#define lt (p &lt;&lt; 1)\n#define rt (lt | 1)\nvoid bld(int p, int l, int r) &#123;\n    t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        int u = tab[l];\n        t[p].u = mat(2, 2);\n        t[p].u[0][0] = t[p].u[1][0] = g[u][1];\n        t[p].u[0][1] = g[u][0];\n        return;\n    &#125;\n    int mid = (l + r) &gt;&gt; 1;\n    bld(lt, l, mid), bld(rt, mid + 1, r);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\nvoid add(int p, int x) &#123;\n    if (t[p].l == t[p].r) &#123;\n        int u = tab[x];\n        t[p].u[0][0] = t[p].u[1][0] = g[u][1];\n        t[p].u[0][1] = g[u][0];\n        return;\n    &#125;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, x);\n    else\n        add(rt, x);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\nmat ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].u;\n    int mid = (t[p].l + t[p].r) &gt;&gt; 1;\n    if (r &lt;= mid)\n        return ask(lt, l, r);\n    if (l &gt; mid)\n        return ask(rt, l, r);\n    return ask(rt, l, r) * ask(lt, l, r);\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, q;\n    std::cin &gt;&gt; n &gt;&gt; q;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g1[x].push_back(y), g1[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1), fa(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g1[x])\n            if (i != fa[x]) &#123;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1);\n    std::vector&lt;std::array&lt;int, 2&gt; &gt; f(n + 1);\n    std::vector&lt;int&gt; top(n + 1), bot(n + 1), dfn(n + 1);\n    DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now, tab[now] = x;\n        if (son[x]) &#123;\n            top[son[x]] = top[x], DFS(son[x]);\n            bot[x] = bot[son[x]];\n            g[x][0] = a[x];\n            for (auto i : g1[x])\n                if (i != son[x] &amp;&amp; i != fa[x]) &#123;\n                    top[i] = i, DFS(i);\n                    g[x][0] += f[i][0];\n                    g[x][1] += std::max(f[i][1], f[i][0]);\n                &#125;\n            f[x][0] = g[x][1] + std::max(f[son[x]][0], f[son[x]][1]);\n            f[x][1] = g[x][0] + f[son[x]][0];\n        &#125;\n        else\n            f[x][1] = g[x][0] = a[x], bot[x] = x;\n        return;\n    &#125;;\n    top[1] = 1, DFS(1);\n    bld(1, 1, n);\n    for (int x, v; q--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; v;\n        g[x][0] -= a[x], g[x][0] += v, a[x] = v;\n        for (; top[x] != 1; ) &#123;\n            auto r = ask(1, dfn[top[x]], dfn[bot[x]]);\n            f[top[x]][0] = r[0][0], f[top[x]][1] = r[0][1];\n            g[fa[top[x]]][0] -= f[top[x]][0];\n            g[fa[top[x]]][1] -= std::max(f[top[x]][0], f[top[x]][1]);\n            add(1, dfn[x]);\n            r = ask(1, dfn[top[x]], dfn[bot[x]]);\n            f[top[x]][0] = r[0][0], f[top[x]][1] = r[0][1];\n            g[fa[top[x]]][0] += f[top[x]][0];\n            g[fa[top[x]]][1] += std::max(f[top[x]][0], f[top[x]][1]);\n            x = fa[top[x]];\n        &#125;\n        add(1, dfn[x]);\n        auto r = ask(1, dfn[1], dfn[bot[1]]);\n        f[1][0] = r[0][0], f[1][1] = r[0][1];\n        std::cout &lt;&lt; std::max(f[1][0], f[1][1]) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"å…¨å±€å¹³è¡¡äºŒå‰æ ‘\">å…¨å±€å¹³è¡¡äºŒå‰æ ‘</h2>\n<p>å›é¡¾æ ‘å‰–ï¼ˆé‡å‰–ï¼‰ï¼ŒåŠŸèƒ½åœ¨äºè§£å†³è·¯å¾„é—®é¢˜ï¼Œå•æ¬¡æ“ä½œèƒ½å¤Ÿåœ¨ <span class=\"math inline\">\\(O(\\log^2 n)\\)</span> çš„æ—¶é—´å†…å®Œæˆã€‚è¿™ä¸ªåŠŸèƒ½å¯ä»¥è¢«<strong>å…¨å±€å¹³è¡¡äºŒå‰æ ‘ï¼ˆGBTï¼‰</strong>ä¸Šä½æ›¿ä»£ã€‚GBT èƒ½å¤Ÿåœ¨å•æ¬¡ <span class=\"math inline\">\\(O(\\log n)\\)</span> çš„å¤æ‚åº¦å†…å®Œæˆé“¾æ“ä½œã€å­æ ‘æ“ä½œã€‚<em><a href=\"QTREEè§£æ³•çš„ä¸€äº›ç ”ç©¶.pdf\">Yang Zhe - SPOJ375 QTREE è§£æ³•çš„ä¸€äº›ç ”ç©¶</a> ä¸­æ›´ä¸ºè¯¦ç»†ä¸¥è°¨åœ°å¯¹ GBT è¿›è¡Œäº†è¯´æ˜ï¼Œæˆ‘ä¼ äº†ä»½æ–‡ä»¶ä¸Šæ¥ã€‚</em></p>\n<p>è€ƒè™‘æ ‘å‰–èƒ½è¢«å¡çš„åŸå› ï¼šæ¯æ¬¡çº¿æ®µæ ‘è¯¢é—®éƒ½ä¼šå¡æ»¡ <span class=\"math inline\">\\(O(\\log n)\\)</span>ï¼Œæ‰¾ä¸€æ¡å¡å¾—æ»¡ <span class=\"math inline\">\\(O(\\log n)\\)</span> æ¬¡è·³é‡é“¾æ¬¡æ•°çš„è·¯å¾„ä¸€ç›´è–…ï¼Œå°±å¯ä»¥å¡åˆ° <span class=\"math inline\">\\(O(\\log^2 n)\\)</span>ã€‚</p>\n<p>åœ¨å®ç°çº¿æ®µæ ‘æ—¶å‘ç°ï¼Œå¯¹äº<strong>è·¯å¾„æ“ä½œ</strong>å’Œ<strong>å•ç‚¹æ“ä½œ</strong>ï¼Œæ ‘å‰–åªéœ€è¦ç»´æŠ¤åŒä¸€æ¡é‡é“¾çš„ä¿¡æ¯ï¼Œå»ºä¸€ä¸ªå¤§çº¿æ®µæ ‘ä¼šäº§ç”Ÿè®¸å¤šé‡é“¾é—´çš„æ— æ•ˆç»´æŠ¤ã€‚æ•…ä¸€ç§ç»å…¸çš„æ ‘å‰–å¡å¸¸æŠ€å·§æ˜¯å¯¹äºæ¯ä¸€æ¡é‡é“¾å»ºå‡ºçº¿æ®µæ ‘ã€‚</p>\n<p>åœ¨æœ¬æ–‡ä¸­å®šä¹‰<strong>å…¨å±€äºŒå‰æ ‘</strong>ï¼šå°†å•ä¸ªçº¿æ®µæ ‘æŒ‰ç…§åœ¨åŸæ ‘ä¸Šé‡é“¾é¡¶çš„ç›¸å¯¹ç¥–å­™å…³ç³»è¿è¾¹å¾—åˆ°çš„æ¨¡å‹ã€‚è¿™é‡Œä¸ºäº†å’Œ<strong>å…¨å±€å¹³è¡¡äºŒå‰æ ‘</strong>å½¢æˆç…§åº”è€Œå‘½åï¼Œå®é™…ä¸Šæ¨¡å‹å¹¶ä¸æ˜¯äºŒå‰æ ‘ã€‚å®¹æ˜“å‘ç°<strong>ä¿®æ”¹æŸä¸ªç‚¹èŠ±è´¹çš„æ“ä½œæ¬¡æ•°å’Œå…¶åœ¨å…¨å±€äºŒå‰æ ‘ä¸­çš„æ·±åº¦ç›¸åŒ</strong>ã€‚</p>\n<p>è€ƒè™‘æœ¬æ–¹æ³•ç†è®ºä¸Šä»å¯å¡åˆ° <span class=\"math inline\">\\(O(\\log^2 n)\\)</span> å•æ¬¡æ“ä½œçš„åŸå› ï¼Œè™½ç„¶å•ä¸ªçº¿æ®µæ ‘å¹³è¡¡ï¼Œä½†<strong>å…¨å±€äºŒå‰æ ‘</strong>å¹¶ä¸å¹³è¡¡ï¼›èƒ½å¤Ÿæ„é€ æ•°æ®ä½¿å¾—æ ‘é«˜è¾¾åˆ° <span class=\"math inline\">\\(\\log^2 n\\)</span>ã€‚è€ƒè™‘ä½¿å¾—å…¨å±€äºŒå‰æ ‘å¹³è¡¡ï¼Œå³è°ƒæ•´çº¿æ®µæ ‘ç»“æ„ä½¿å¾—ä»»ä½•ä¸€ä¸ªç‚¹åœ¨å…¨å±€äºŒå‰æ ‘ä¸Šçš„å·¦å³å„¿å­å¤§å°æœ€æ¥è¿‘ã€‚å‘ç°æ˜¯æ˜“åšçš„ï¼Œåªéœ€åœ¨å»ºçº¿æ®µæ ‘æ—¶ç§»åŠ¨å·¦å³å„¿å­åˆ†å‰²ç‚¹ä½¿å¾—ä¸¤è¾¹å­æ ‘å¤§å°å‡ä¸ºå…¨æ ‘çš„ä¸€åŠå³å¯ã€‚</p>\n<p>æ³•ä¸€ï¼šæ±‚å‡ºæ¯ä¸ªç‚¹çš„è½»å­æ ‘å¤§å° <span class=\"math inline\">\\(ls_u=1+\\sum siz_v\\)</span>ï¼Œä½œä¸ºåŠ æƒåœ¨çº¿æ®µæ ‘ä¸Šæ‰¾ mid å°±èƒ½æ»¡è¶³å…¨å±€å¹³è¡¡ï¼›è¯æ˜å¯ä»¥è§ä¸Šé¢çš„è®ºæ–‡ã€‚è¿™é‡Œç”¨çº¿æ®µæ ‘ä»£æ›¿äº† BSTï¼Œå¸¸æ•°å¾ˆå¤§ã€‚</p>\n<p>æ³•äºŒï¼šç”¨ä¸€ä¸ª BST å®ç°ä¸Šè¿°åŠŸèƒ½ï¼Œéœ€è¦æ»¡è¶³ï¼šä»»æ„å­æ ‘çš„æ ¹ä¸ºå­æ ‘çš„å¸¦æƒ midï¼›BST çš„ä¸­åºéå†ä¸ºåŸé‡é“¾ã€‚æ˜¾ç„¶æœ‰ï¼šæ ‘é«˜ä¸º log çº§åˆ«ã€‚è¿™å°±å†³å®šäº†æ‰€æœ‰é—®é¢˜éƒ½å¯ä»¥é€šè¿‡æš´åŠ›çˆ¬å±±è§£å†³ã€‚</p>\n<p>GBT èƒ½å¤Ÿå¿«é€Ÿç»´æŠ¤<strong>æ™®é€šæ ‘å‰–æ“ä½œ</strong>å’Œ <strong>DDP ä¿¡æ¯</strong>ã€‚</p>\n<hr />\n<h3 id=\"ç»´æŠ¤-ddpæ¨¡æ¿åŠ¨æ€-dpåŠ å¼ºç‰ˆ\">ç»´æŠ¤ DDPï¼šã€æ¨¡æ¿ã€‘åŠ¨æ€ DPï¼ˆåŠ å¼ºç‰ˆï¼‰</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P4751\" class=\"uri\">https://www.luogu.com.cn/problem/P4751</a></p>\n<p>å’ŒæœªåŠ å¼ºç‰ˆç±»ä¼¼ï¼ŒæŠŠæ‰€æœ‰çº¿æ®µæ ‘æ“ä½œæ›¿æ¢ä¸º BST å³å¯ã€‚å¦‚æœå†™å¾—ä¸‘å¯èƒ½éœ€è¦ä¸€äº›é¢å¤–çš„å¡å¸¸æŠ€å·§ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e6 + 5;\nconst int inf = 0x3f3f3f3f;\nconst int LEN = (1 &lt;&lt; 20);\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nstruct mat &#123;\n    int a[2][2];\n    int* operator[] (const int q) &#123; \n        return a[q];\n    &#125;\n    mat operator* (mat &amp;q) const &#123;\n        mat res;\n        res[0][0] = res[0][1] = res[1][0] = res[1][1] = -inf;\n        for (int i = 0; i &lt; 2; ++i)\n            for (int k = 0; k &lt; 2; ++k)\n                for (int j = 0; j &lt; 2; ++j)\n                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int lc, rc, fa; mat u; &#125; t[maxn]; \nint g[maxn][2], tab[maxn], ls[maxn];\nmat p[maxn];\nvoid pushup(int x) &#123;\n    t[x].u = t[t[x].rc].u * p[x] * t[t[x].lc].u;\n    return;\n&#125;\nvoid bld(int &amp;x, int l, int r) &#123;\n    if (l &gt; r)\n        return;\n    int s = 0, k = 0;\n    for (int i = l; i &lt;= r; ++i)\n        s += ls[tab[i]];\n    for (int i = l; i &lt;= r; ++i, k += ls[tab[i]])\n        if ((k + ls[tab[i]]) * 2 &gt; s) &#123;\n            x = tab[i];\n            bld(t[x].lc, l, i - 1), t[t[x].lc].fa = x;\n            bld(t[x].rc, i + 1, r), t[t[x].rc].fa = x;\n            pushup(x);\n            break;\n        &#125;\n    return;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    t[0].u[0][0] = t[0].u[1][1] = 0, t[0].u[0][1] = t[0].u[1][0] = -inf;\n    int n, q;\n    read(n), read(q);\n    std::vector&lt;int&gt; a(n + 1), rt(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        read(a[i]);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        read(x), read(y);\n        g1[x].push_back(y), g1[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; son(n + 1), fa(n + 1), siz(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g1[x])\n            if (i != fa[x]) &#123;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1);\n    std::vector&lt;std::array&lt;int, 2&gt; &gt; f(n + 1);\n    std::vector&lt;int&gt; top(n + 1), bot(n + 1), dfn(n + 1);\n    DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now, tab[now] = x, ls[x] = 1;\n        if (son[x]) &#123;\n            top[son[x]] = top[x], DFS(son[x]);\n            bot[x] = bot[son[x]];\n            g[x][0] = a[x];\n            for (auto i : g1[x])\n                if (i != son[x] &amp;&amp; i != fa[x]) &#123;\n                    top[i] = i, DFS(i), t[rt[i]].fa = x;\n                    ls[x] += siz[i];\n                    g[x][0] += f[i][0];\n                    g[x][1] += std::max(f[i][1], f[i][0]);\n                &#125;\n            f[x][0] = g[x][1] + std::max(f[son[x]][0], f[son[x]][1]);\n            f[x][1] = g[x][0] + f[son[x]][0];\n        &#125;\n        else\n            f[x][1] = g[x][0] = a[x], bot[x] = x;\n        p[x][0][0] = p[x][1][0] = g[x][1];\n        p[x][0][1] = g[x][0], p[x][1][1] = -inf;\n        if (x == top[x])\n            bld(rt[x], dfn[x], dfn[bot[x]]);\n        return;\n    &#125;;\n    top[1] = 1, DFS(1);\n    for (int x, v, la = 0; q--; ) &#123;\n        read(x), read(v), x ^= la;\n        p[x][0][1] += v - a[x], a[x] = v;\n        for (; x; ) &#123;\n            int fa = t[x].fa;\n            if (fa &amp;&amp; x != t[fa].lc &amp;&amp; x != t[fa].rc) &#123;\n                int f0 = t[x].u[0][0], f1 = std::max(f0, t[x].u[0][1]);\n                pushup(x);\n                int F0 = t[x].u[0][0], F1 = std::max(F0, t[x].u[0][1]);\n                p[fa][0][0] += F1 - f1, p[fa][1][0] += F1 - f1;\n                p[fa][0][1] += F0 - f0;\n            &#125;\n            else\n                pushup(x);\n            x = fa;\n        &#125;\n        print(la = std::max(t[rt[1]].u[0][0], t[rt[1]].u[0][1]), &#39;\\n&#39;);\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<p>ä¹Ÿç»™å‡ºä¸€ä¸ªçº¿æ®µæ ‘ç‰ˆæœ¬çš„</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e6 + 5;\nconst int inf = 0x3f3f3f3f;\nconst int LEN = (1 &lt;&lt; 20);\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nstruct mat &#123;\n    int a[2][2];\n    int* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    mat operator* (mat q) const &#123;\n        mat res;\n        res[0][0] = res[0][1] = res[1][0] = res[1][1] = -inf;\n        for (int i = 0; i &lt; 2; ++i)\n            for (int k = 0; k &lt; 2; ++k)\n                for (int j = 0; j &lt; 2; ++j)\n                    res[i][k] = std::max(res[i][k], a[i][j] + q[j][k]);\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int lc, rc, l, r, mid; mat u; &#125; t[maxn &lt;&lt; 2]; \nint g[maxn][2], tab[maxn], ls[maxn];\n#define lt t[p].lc\n#define rt t[p].rc\nvoid bld(int &amp;p, int l, int r) &#123;\n    static int tot = 0;\n    p = ++tot, t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        int u = tab[l];\n        t[p].u[0][0] = t[p].u[1][0] = g[u][1];\n        t[p].u[0][1] = g[u][0], t[p].u[1][1] = -inf;\n        return;\n    &#125;\n    int s = 0, u = ls[tab[l]];\n    for (int i = l; i &lt;= r; ++i)\n        s += ls[tab[i]];\n    s &gt;&gt;= 1;\n    t[p].mid = r - 1;\n    for (int i = l + 1; i &lt; r; ++i) &#123;\n        u += ls[tab[i]];\n        if (u + ls[tab[i + 1]] &gt; s) &#123;\n            t[p].mid = i;\n            break;\n        &#125;\n    &#125;\n    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\nvoid add(int p, int x) &#123;\n    if (t[p].l == t[p].r) &#123;\n        int u = tab[x];\n        t[p].u[0][0] = t[p].u[1][0] = g[u][1];\n        t[p].u[0][1] = g[u][0];\n        return;\n    &#125;\n    if (x &lt;= t[p].mid)\n        add(lt, x);\n    else\n        add(rt, x);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\nmat ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p].u;\n    if (r &lt;= t[p].mid)\n        return ask(lt, l, r);\n    if (l &gt; t[p].mid)\n        return ask(rt, l, r);\n    return ask(rt, l, r) * ask(lt, l, r);\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, q;\n    read(n), read(q);\n    std::vector&lt;int&gt; a(n + 1), rt(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        read(a[i]);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        read(x), read(y);\n        g1[x].push_back(y), g1[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1), fa(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g1[x])\n            if (i != fa[x]) &#123;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1);\n    std::vector&lt;std::array&lt;int, 2&gt; &gt; f(n + 1);\n    std::vector&lt;int&gt; top(n + 1), bot(n + 1), dfn(n + 1);\n    DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now, tab[now] = x;\n        ls[x] = 1;\n        if (son[x]) &#123;\n            top[son[x]] = top[x], DFS(son[x]);\n            bot[x] = bot[son[x]];\n            g[x][0] = a[x];\n            for (auto i : g1[x])\n                if (i != son[x] &amp;&amp; i != fa[x]) &#123;\n                    top[i] = i, DFS(i);\n                    ls[x] += siz[i];\n                    g[x][0] += f[i][0];\n                    g[x][1] += std::max(f[i][1], f[i][0]);\n                &#125;\n            f[x][0] = g[x][1] + std::max(f[son[x]][0], f[son[x]][1]);\n            f[x][1] = g[x][0] + f[son[x]][0];\n        &#125;\n        else\n            f[x][1] = g[x][0] = a[x], bot[x] = x;\n        if (x == top[x])\n            bld(rt[x], dfn[x], dfn[bot[x]]);\n        return;\n    &#125;;\n    top[1] = 1, DFS(1);\n    for (int x, v, la = 0; q--; ) &#123;\n        read(x), read(v), x ^= la;\n        g[x][0] -= a[x], g[x][0] += v, a[x] = v;\n        for (; top[x] != 1; ) &#123;\n            auto r = t[rt[top[x]]].u;\n            f[top[x]][0] = r[0][0], f[top[x]][1] = r[0][1];\n            g[fa[top[x]]][0] -= f[top[x]][0];\n            g[fa[top[x]]][1] -= std::max(f[top[x]][0], f[top[x]][1]);\n            add(rt[top[x]], dfn[x]);\n            r = t[rt[top[x]]].u;\n            f[top[x]][0] = r[0][0], f[top[x]][1] = r[0][1];\n            g[fa[top[x]]][0] += f[top[x]][0];\n            g[fa[top[x]]][1] += std::max(f[top[x]][0], f[top[x]][1]);\n            x = fa[top[x]];\n        &#125;\n        add(rt[1], dfn[x]);\n        auto r =  t[rt[1]].u;\n        f[1][0] = r[0][0], f[1][1] = r[0][1];\n        std::cout &lt;&lt; (la = std::max(f[1][0], f[1][1])) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"æ ‘ä¸Šè·¯å¾„é—®é¢˜æŸ“è‰²\">æ ‘ä¸Šè·¯å¾„é—®é¢˜ï¼šæŸ“è‰²</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P2486\" class=\"uri\">https://www.luogu.com.cn/problem/P2486</a></p>\n<p>GBT ä¸Šçš„<strong>è·¯å¾„é—®é¢˜</strong>ã€‚</p>\n<p>BSTï¼šé¦–å…ˆæš´åŠ›çˆ¬å±±åˆ° LCAï¼Œç»Ÿè®¡ä¸€è·¯ä¸Šçš„ç­”æ¡ˆï¼›ç„¶åè·³åˆ°å½“å‰ BST çš„æ ¹ã€‚ç”±äºæœ¬é¢˜æœ‰æ ‡è®°ï¼Œæ‰€ä»¥éœ€è¦åœ¨è·³çš„åŒæ—¶æƒ³åŠæ³•æŠŠæ ‡è®°é—®é¢˜è§£å†³ä¸€ä¸‹ã€‚</p>\n<p>çº¿æ®µæ ‘ï¼šæŠŠæ ‘å‰–çš„çº¿æ®µæ ‘ç•¥æ”¹ä¸€ä¸‹å°±è¿‡äº†ã€‚ä»ä¸Šä¸€è¡Œæ¨¡æ£±ä¸¤å¯çš„æè¿°å°±å¯ä»¥çœ‹å‡ºæ¥ BST å®ç°èµ·æ¥ä¸å¤ªè½»æ¾ï¼›è¿˜æ˜¯çº¿æ®µæ ‘æ›´è½®æ¤…å•Šï¼</p>\n<details>\n<p>è·‘å¾—æ²¡çº¯æ ‘å‰–å¿«ï¼Œå› ä¸ºæ•°æ®æ²¡æœ‰åˆ»æ„æ„é€ å¯¼è‡´æ ‘é«˜å¾ˆä½ï¼Œå†åŠ ä¸Šå¸¸æ•°çš„å½±å“å§ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e5 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid read(char &amp;x) &#123;\n    for (x = nec(); x != &#39;C&#39; &amp;&amp; x != &#39;Q&#39;; x = nec());\n    return;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nclass node &#123;\nprivate:\n    int lt, rt;\npublic:\n    int l, r, mid, lc, rc, u, d;\n    node(): u(-1) &#123;&#125;\n    inline int&amp; ls(void) &#123; return lt; &#125;\n    inline int&amp; rs(void) &#123; return rt; &#125;\n    node&amp; operator= (const node &amp;q) &#123;\n        lc = q.lc, rc = q.rc, u = q.u;\n        return *this;\n    &#125;\n    node operator+ (const node &amp;q) const &#123;\n        if (u == -1)\n            return q;\n        if (q.u == -1)\n            return *this;\n        node res;\n        res.lc = lc, res.rc = q.rc, res.u = u + q.u - (rc == q.lc);\n        return res;\n    &#125;\n    inline void swap(void) &#123;\n        if (~u)\n            lc ^= rc ^= lc ^= rc;\n        return;\n    &#125;\n&#125; t[maxn &lt;&lt; 2]; \nint tab[maxn], ls[maxn], a[maxn];\n#define lt t[p].ls()\n#define rt t[p].rs()\nvoid bld(int &amp;p, int l, int r) &#123;\n    static int tot = 0;\n    p = ++tot, t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        t[p].u = 1;\n        t[p].lc = t[p].rc = a[tab[l]];\n        return;\n    &#125;\n    int s = 0, u = ls[tab[l]];\n    for (int i = l; i &lt;= r; ++i)\n        s += ls[tab[i]];\n    s &gt;&gt;= 1;\n    t[p].mid = r - 1;\n    for (int i = l + 1; i &lt; r; ++i) &#123;\n        u += ls[tab[i]];\n        if (u + ls[tab[i + 1]] &gt; s) &#123;\n            t[p].mid = i;\n            break;\n        &#125;\n    &#125;\n    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);\n    t[p] = t[lt] + t[rt];\n    return;\n&#125;\nvoid pushdown(int p) &#123;\n    if (t[p].d) &#123;\n        t[lt].d = t[lt].lc = t[lt].rc = t[rt].d = t[rt].lc = t[rt].rc = t[p].d;\n        t[lt].u = t[rt].u = 1;\n        t[p].d = 0;\n    &#125;\n    return;\n&#125;\nvoid add(int p, int l, int r, int v) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r) &#123;\n        t[p].u = 1;\n        t[p].lc = t[p].rc = t[p].d = v;\n        return;\n    &#125;\n    pushdown(p);\n    if (l &lt;= t[p].mid)\n        add(lt, l, r, v);\n    if (r &gt; t[p].mid)\n        add(rt, l, r, v);\n    t[p] = t[lt] + t[rt];\n    return;\n&#125;\nnode ask(int p, int l, int r) &#123;\n    if (l &lt;= t[p].l &amp;&amp; t[p].r &lt;= r)\n        return t[p];\n    pushdown(p);\n    if (r &lt;= t[p].mid)\n        return ask(lt, l, r);\n    if (l &gt; t[p].mid)\n        return ask(rt, l, r);\n    return ask(lt, l, r) + ask(rt, l, r);\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n#else\n    std::freopen(&quot;paint17.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, q;\n    read(n), read(q);\n    std::vector&lt;int&gt; rt(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        read(a[i]);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        read(x), read(y);\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1), fa(n + 1), dep(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g[x])\n            if (i != fa[x]) &#123;\n                dep[i] = dep[x] + 1;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1);\n    std::vector&lt;std::array&lt;int, 2&gt; &gt; f(n + 1);\n    std::vector&lt;int&gt; top(n + 1), bot(n + 1), dfn(n + 1);\n    DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now, tab[now] = x, ls[x] = 1;\n        if (son[x]) &#123;\n            top[son[x]] = top[x], DFS(son[x]);\n            bot[x] = bot[son[x]];\n        &#125;\n        else\n            bot[x] = x;\n        for (auto i : g[x])\n            if (i != son[x] &amp;&amp; i != fa[x]) &#123;\n                top[i] = i;\n                DFS(i);\n                ls[x] += siz[i];\n            &#125;\n        if (x == top[x])\n            bld(rt[x], dfn[x], dfn[bot[x]]);\n        return;\n    &#125;;\n    top[1] = 1, DFS(1);\n    for (char op; q--; ) &#123;\n        read(op);\n        if (op == &#39;C&#39;) &#123;\n            int x, y, c;\n            read(x), read(y), read(c);\n            for (; top[x] != top[y]; x = fa[top[x]]) &#123;\n                if (dep[top[x]] &lt; dep[top[y]])\n                    std::swap(x, y);\n                add(rt[top[x]], dfn[top[x]], dfn[x], c);\n            &#125;\n            if (dep[x] &gt; dep[y])\n                std::swap(x, y);\n            add(rt[top[x]], dfn[x], dfn[y], c);\n        &#125;\n        else &#123;\n            int x, y;\n            read(x), read(y);\n            node res1, res2;\n            for (; top[x] != top[y]; )\n                if (dep[top[x]] &lt; dep[top[y]]) &#123;\n                    res2 = ask(rt[top[y]], dfn[top[y]], dfn[y]) + res2;\n                    y = fa[top[y]];\n                &#125;\n                else &#123;\n                    res1 = ask(rt[top[x]], dfn[top[x]], dfn[x]) + res1;\n                    x = fa[top[x]];\n                &#125;\n            if (dep[x] &gt; dep[y])\n                res1 = ask(rt[top[y]], dfn[y], dfn[x]) + res1;\n            else\n                res2 = ask(rt[top[x]], dfn[x], dfn[y]) + res2;\n            res1.swap();\n            print((res1 + res2).u, &#39;\\n&#39;);\n        &#125;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"æ ‘ä¸Šè·¯å¾„æŸ¥è¯¢\">æ ‘ä¸Šè·¯å¾„æŸ¥è¯¢ï¼Ÿ</h3>\n<p>åšé¢˜çš„æ—¶å€™å¯ä»¥æ„Ÿå—åˆ°ï¼Œè·¯å¾„è¯¢é—®çš„å­˜åœ¨å¾ˆè¯¡å¼‚ï¼Œå› ä¸ºåªéœ€è¦ä¸€æ¡é“¾çš„æ“ä½œï¼Œæ›´åå‘é“¾ä¸Š DDP è€Œéæ ‘ä¸Šçš„ï¼›<strong>è½»å„¿å­çš„ä¿¡æ¯æ˜¯ä¸ç”¨ç»´æŠ¤çš„</strong>ï¼Œå½¢å¼ä¸Šæ›´åƒæ ‘å‰–ï¼ˆDSï¼‰ï¼›å½“æˆé“¾ä¸Šçš„ DDP å°±å¯ä»¥è§£å†³äº†ã€‚</p>\n<p>å¯ä»¥ç”¨å€å¢ç»´æŠ¤ DDPï¼ˆä¸ç”¨è€ƒè™‘è½»é‡å„¿å­ï¼Œåªç”¨ç»´æŠ¤çˆ¶å­å…³ç³»ï¼Œè¿›ä¸€æ­¥å‘åºåˆ— DDP é è¿‘ï¼‰ï¼Œå°±ä¸ç”¨æ‰“ GBT äº†ï¼Œå¸¸æ•°ä¹Ÿä¼šå°ä¸€äº›ã€‚</p>\n<hr />\n<h2 id=\"ä¹ é¢˜\">ä¹ é¢˜</h2>\n<p>GBT å°±ç»Ÿä¸€ç”¨çº¿æ®µæ ‘äº†ã€‚DDP ä¹Ÿå°±å¯ä»¥é¡ºå¸¦ç”¨ GBT ä¼˜åŒ–äº†ã€‚</p>\n<hr />\n<h3 id=\"e---çŒ«æˆ–ç‹—-cats-or-dogs\">E - çŒ«æˆ–ç‹— / Cats or Dogs</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P9597\" class=\"uri\">https://www.luogu.com.cn/problem/P9597</a></p>\n<p>è®¾ <span class=\"math inline\">\\(f_{u,0/1}\\)</span> è¡¨ç¤ºä»æ ¹ä¸Šé¢œè‰²ä¸º <span class=\"math inline\">\\(0/1\\)</span> æ—¶çš„æœ€å°æ–­è¾¹æ•°ï¼Œæ˜¾ç„¶æ— è‰²å¯ä»¥è§†ä½œä»»é€‰ä¸€ä¸ªé¢œè‰²ã€‚é‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{u,a}=\\sum\\limits_v\\min\\limits_{b\\in\\{0,1\\}}\\{f_{v,b}+[a\\ne b]\\}\n\\]</span></p>\n<p>ç›´æ¥æŠŠè½»å„¿å­çš„é¡¹æå‡ºæ¥ï¼Œè®° <span class=\"math inline\">\\(g_{u,0/1}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(f_{u,0/1}\\)</span> å¯¹åº”çš„è½»å„¿å­è´¡çŒ®å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e5 + 5;\nconst int inf = 0x3f3f3f3f;\nstruct mat &#123;\n    int a[2][2];\n    int* operator[] (const int q) &#123; \n        return a[q];\n    &#125;\n    mat operator* (mat &amp;q) const &#123;\n        mat res;\n        res[0][0] = res[0][1] = res[1][0] = res[1][1] = inf;\n        for (int i = 0; i &lt; 2; ++i)\n            for (int k = 0; k &lt; 2; ++k)\n                for (int j = 0; j &lt; 2; ++j)\n                    res[i][k] = std::min(res[i][k], a[i][j] + q[j][k]);\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125; p[maxn];\nstruct &#123; int lc, rc, l, r, mid; mat u; &#125; t[maxn &lt;&lt; 2]; \nint ls[maxn], tab[maxn], g[maxn][2], rt[maxn], top[maxn], dfn[maxn], fa[maxn];\nstd::vector&lt;int&gt; a;\n#define lt t[p].lc\n#define rt t[p].rc\nvoid bld(int &amp;p, int l, int r) &#123;\n    static int tot = 0;\n    p = ++tot, t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        t[p].u[0][1] = t[p].u[1][0] = 1;\n        return;\n    &#125;\n    int s = 0, u = ls[tab[l]];\n    for (int i = l; i &lt;= r; ++i)\n        s += ls[tab[i]];\n    s &gt;&gt;= 1;\n    t[p].mid = r - 1;\n    for (int i = l + 1; i &lt; r; ++i) &#123;\n        u += ls[tab[i]];\n        if (u + ls[tab[i + 1]] &gt; s) &#123;\n            t[p].mid = i;\n            break;\n        &#125;\n    &#125;\n    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\nvoid add(int p, int x) &#123;\n    if (t[p].l == t[p].r) &#123;\n        int u = tab[x], g0 = (a[u] == 1 ? inf : g[u][0]), g1 = (a[u] == 0 ? inf : g[u][1]);\n        t[p].u[0][0] = g0, t[p].u[0][1] = g1 + 1;\n        t[p].u[1][0] = g0 + 1, t[p].u[1][1] = g1;\n        return;\n    &#125;\n    if (x &lt;= t[p].mid)\n        add(lt, x);\n    else\n        add(rt, x);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\n#undef lt\n#undef rt\nvoid initialize(int n, std::vector&lt;int&gt; A, std::vector&lt;int&gt; B) &#123;\n    a.assign(n + 1, -1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n    for (int i = 0; i &lt; n - 1; ++i)\n        g1[A[i]].push_back(B[i]), g1[B[i]].push_back(A[i]);\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g1[x])\n            if (i != fa[x]) &#123;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1);\n    std::vector&lt;int&gt; bot(n + 1);\n    DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now, tab[now] = x, ls[x] = 1;\n        if (son[x]) &#123;\n            top[son[x]] = top[x], DFS(son[x]);\n            bot[x] = bot[son[x]];\n            for (auto i : g1[x])\n                if (i != son[x] &amp;&amp; i != fa[x]) &#123;\n                    top[i] = i, DFS(i);\n                    ls[x] += siz[i];\n                &#125;\n        &#125;\n        else\n            bot[x] = x;\n        if (x == top[x])\n            bld(rt[x], dfn[x], dfn[bot[x]]);\n        return;\n    &#125;;\n    top[1] = 1, DFS(1);\n    return;\n&#125;\nint upd(int x) &#123;\n    for (; top[x] != 1; ) &#123;\n        int faa = fa[top[x]];\n        auto &amp;id = t[rt[top[x]]].u;\n        int f0 = std::min(id[0][0], id[1][0]), f1 = std::min(id[0][1], id[1][1]);\n        g[faa][0] -= std::min(f0, f1 + 1);\n        g[faa][1] -= std::min(f0 + 1, f1);\n        add(rt[top[x]], dfn[x]);\n        f0 = std::min(id[0][0], id[1][0]), f1 = std::min(id[0][1], id[1][1]);\n        // printf(&quot;%d: f0 = %d, f1 = %d\\n&quot;, top[x], f0, f1);\n        g[faa][0] += std::min(f0, f1 + 1);\n        g[faa][1] += std::min(f0 + 1, f1);\n        x = faa;\n    &#125;\n    add(rt[1], dfn[x]);\n    auto &amp;id = t[rt[1]].u;\n    int f0 = std::min(id[0][0], id[1][0]), f1 = std::min(id[0][1], id[1][1]);\n    // printf(&quot;%d: f0 = %d, f1 = %d\\n&quot;, 1, f0, f1);\n    return std::min(f0, f1);\n&#125;\nint cat(int x) &#123;\n    a[x] = 0;\n    return upd(x);\n&#125;\nint dog(int x) &#123;\n    a[x] = 1;\n    return upd(x);\n&#125;\nint neighbor(int x) &#123;\n    a[x] = -1;\n    return upd(x);\n&#125;\n#ifndef ONLINE_JUDGE\nint main() &#123;\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; A(n - 1), B(n - 1);\n    for (int i = 0; i &lt; n - 1; ++i)\n        std::cin &gt;&gt; A[i] &gt;&gt; B[i];\n    initialize(n, A, B);\n    int q;\n    std::cin &gt;&gt; q;\n    for (int op, x; q--; ) &#123;\n        std::cin &gt;&gt; op &gt;&gt; x;\n        std::cout &lt;&lt; (op == 1 ? cat(x) : (op == 2 ? dog(x) : neighbor(x))) &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n    return 0;\n&#125;\n#endif</code></pre>\n</details>\n<hr />\n<h3 id=\"f---hash-on-tree\">F - Hash on Tree</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/AT_abc351_g\" class=\"uri\">https://www.luogu.com.cn/problem/AT_abc351_g</a></p>\n<p>è®° <span class=\"math inline\">\\(g_x\\)</span> ä¸ºè½»å„¿å­çš„å“ˆå¸Œå€¼ä¹‹ç§¯ï¼Œåˆ™ <span class=\"math inline\">\\(f_u=A_u+f_{son}\\cdot g_u\\)</span>ã€‚</p>\n<p>ç„¶åå¼€ä¸€ä¸ªå¸¸æ•°ç»´å³å¯ã€‚å¿«é€Ÿå¹‚çš„ log çœä¸æ‰ï¼Œæ‰€ä»¥æ˜¯åŒ log çš„ã€‚</p>\n<p>åˆå€¼å’Œä¿®æ”¹éƒ½æœ‰å¯èƒ½ä¸º <span class=\"math inline\">\\(0\\)</span>ï¼Œéœ€è¦ç»´æŠ¤å®é™…å“ˆå¸Œå€¼å’Œå»æ‰ <span class=\"math inline\">\\(0\\)</span> çš„å“ˆå¸Œå€¼ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e6 + 5;\nconst int LEN = (1 &lt;&lt; 20);\nconst int mod = 998244353;\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nstruct mat &#123;\n    int n, m;\n    long long a[2][2];\n    long long* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    mat operator* (mat &amp;q) const &#123;\n        mat res;\n        res.n = n, res.m = q.m;\n        res[0][0] = res[0][1] = res[1][0] = res[1][1] = 0ll;\n        for (int i = 0; i &lt; n; ++i)\n            for (int k = 0; k &lt; q.m; ++k) &#123;\n                for (int j = 0; j &lt; m; ++j)\n                    res[i][k] += a[i][j] * q[j][k];\n                res[i][k] %= mod;\n            &#125;\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int lc, rc, l, r, mid; mat u; &#125; t[maxn &lt;&lt; 2]; \nlong long g[maxn];\nint tab[maxn], ls[maxn], a[maxn];\n#define lt t[p].lc\n#define rt t[p].rc\nvoid bld(int &amp;p, int l, int r) &#123;\n    static int tot = 0;\n    p = ++tot, t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        int u = tab[l];\n        t[p].u.n = t[p].u.m = 2;\n        t[p].u[0][0] = g[u];\n        t[p].u[0][1] = 0ll;\n        t[p].u[1][0] = a[u];\n        t[p].u[1][1] = 1ll;\n        return;\n    &#125;\n    int s = 0, u = ls[tab[l]];\n    for (int i = l; i &lt;= r; ++i)\n        s += ls[tab[i]];\n    s &gt;&gt;= 1;\n    t[p].mid = r - 1;\n    for (int i = l + 1; i &lt; r; ++i) &#123;\n        u += ls[tab[i]];\n        if (u + ls[tab[i + 1]] &gt; s) &#123;\n            t[p].mid = i;\n            break;\n        &#125;\n    &#125;\n    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\nvoid add(int p, int x) &#123;\n    if (t[p].l == t[p].r) &#123;\n        int u = tab[x];\n        t[p].u[0][0] = g[u];\n        t[p].u[1][0] = a[u];\n        return;\n    &#125;\n    if (x &lt;= t[p].mid)\n        add(lt, x);\n    else\n        add(rt, x);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n, q;\n    read(n), read(q);\n    std::vector&lt;int&gt; rt(n + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n    for (int i = 2, x; i &lt;= n; ++i) &#123;\n        read(x);\n        g1[i].push_back(x), g1[x].push_back(i);\n    &#125;\n    for (int i = 1; i &lt;= n; ++i)\n        read(a[i]);\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1), fa(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g1[x])\n            if (i != fa[x]) &#123;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1);\n    std::vector&lt;long long&gt; f(n + 1);\n    std::vector&lt;int&gt; top(n + 1), bot(n + 1), dfn(n + 1), la(n + 1), cnt(n + 1);\n    DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now, tab[now] = x, ls[x] = 1;\n        if (son[x]) &#123;\n            top[son[x]] = top[x], DFS(son[x]);\n            bot[x] = bot[son[x]];\n            g[x] = 1ll;\n            for (auto i : g1[x])\n                if (i != son[x] &amp;&amp; i != fa[x]) &#123;\n                    top[i] = i, DFS(i);\n                    ls[x] += siz[i];\n                    if (f[i] == 0ll)\n                        ++cnt[x];\n                    else\n                        (la[x] *= f[i]) %= mod;\n                    (g[x] *= f[i]) %= mod;\n                &#125;\n            f[x] = (a[x] + g[x] * f[son[x]]) % mod;\n        &#125;\n        else\n            f[x] = a[x], bot[x] = x;\n        // printf(&quot;f[%d] = %lld\\n&quot;, x, f[x]);\n        if (x == top[x])\n            bld(rt[x], dfn[x], dfn[bot[x]]);\n        return;\n    &#125;;\n    top[1] = 1, DFS(1);\n    mat init;\n    init.n = 1, init.m = 2;\n    init[0][0] = 0ll, init[0][1] = 1ll;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    auto inv = [&amp;](int x) &#123;\n        return qkp(x, mod - 2);\n    &#125;;\n    for (int x, v; q--; ) &#123;\n        read(x), read(v);\n        a[x] = v;\n        for (; top[x] != 1; ) &#123;\n            int faa = fa[top[x]];\n            auto &amp;id = t[rt[top[x]]].u;\n            int f = (init * id)[0][0];\n            if (f == 0) &#123;\n                if (--cnt[faa] == 0)\n                    g[faa] = la[faa];\n            &#125;\n            else &#123;\n                f = inv(f);\n                (g[faa] *= f) %= mod;\n                (la[faa] *= f) %= mod;\n            &#125;\n            add(rt[top[x]], dfn[x]);\n            f = (init * id)[0][0];\n            if (f == 0) &#123;\n                if (cnt[faa]++ == 0)\n                    la[faa] = g[faa];\n                g[faa] = 0ll;\n            &#125;\n            else &#123;\n                (g[faa] *= f) %= mod;\n                (la[faa] *= f) %= mod;\n            &#125;\n            x = faa;\n        &#125;\n        add(rt[1], dfn[x]);\n        auto &amp;id = t[rt[1]].u;\n        int f = (init * id)[0][0];\n        std::cout &lt;&lt; f &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h3 id=\"g---è€ƒè¯•-2\">G - è€ƒè¯• 2</h3>\n<p><a href=\"https://www.luogu.com.cn/problem/P10626\" class=\"uri\">https://www.luogu.com.cn/problem/P10626</a></p>\n<p>è¿ç®—å‡æ˜¯çº¿æ€§çš„ï¼Œå®¹æ˜“æƒ³åˆ°ã€æŒ‰ä½ã€ç»´æŠ¤ï¼Œå³åªç»´æŠ¤æŸä¸ªç‰¹å®šç‚¹å€¼ã€‚å¦‚æœå°†è¯¢é—®ç¦»çº¿ä¸‹æ¥æ’åºï¼Œæ¯ä¸ªå‡½æ•°çš„ç‚¹å€¼åªä¼šå˜åŒ– <span class=\"math inline\">\\(O(1)\\)</span> æ¬¡ã€‚</p>\n<p>å»ºå‡ºç¬¦å·äºŒå‰æ ‘ï¼Œè¿›è¡Œ DDP å³å¯ã€‚å…·ä½“åœ°ï¼Œä»¤ <span class=\"math inline\">\\(f_u\\)</span> è¡¨ç¤ºåœ¨è¿ç®— <span class=\"math inline\">\\(u\\)</span> å¤„çš„ç­”æ¡ˆï¼Œè®¡ç®— <span class=\"math inline\">\\(g_u\\)</span> ä¸ºè½»å„¿å­çš„ç­”æ¡ˆï¼ŒæŒ‰ç…§ <span class=\"math inline\">\\(u\\)</span> å¤„çš„ç¬¦å·å†™çŸ©é˜µå³å¯ã€‚å¶å­ä¸æ˜¯ä¸€æ¬¡è¿ç®—ï¼Œåº”è¯¥ç›´æ¥å¡«å…¥ç‚¹å€¼ï¼ˆæ³¨æ„çº¿æ®µæ ‘ä¸Šçš„å¶å­ä¸ä¸€å®šæ˜¯åŸæ ‘ä¸Šçš„å¶å­ï¼‰ã€‚</p>\n<p>å»ºæ ‘å’ŒçŸ©é˜µæ›´æ–°æœ‰ç‚¹å²ï¼Œé€‚å½“å°è£…ä¸€ä¸‹æ„Ÿè§‰ä¼šå¥½ä¸€ç‚¹</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int maxn = 1e6 + 5;\nconst char mp[] = &quot;x!&amp;|^&quot;;\nconst int LEN = (1 &lt;&lt; 20);\n#define nec getchar\ninline bool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nstruct mat &#123;\n    int n, m;\n    int a[2][2];\n    int* operator[] (const int q) &#123;\n        return a[q];\n    &#125;\n    inline mat operator* (mat &amp;q) const &#123;\n        mat res;\n        res.n = n, res.m = q.m;\n        res[0][0] = res[0][1] = res[1][0] = res[1][1] = 0ll;\n        for (int i = 0; i &lt; n; ++i)\n            for (int k = 0; k &lt; q.m; ++k)\n                for (int j = 0; j &lt; m; ++j)\n                    res[i][k] += a[i][j] * q[j][k];\n        return res;\n    &#125;\n    mat&amp; operator*= (mat &amp;q) &#123;\n        return *this = *this * q;\n    &#125;\n&#125;;\nstruct &#123; int lc, rc, l, r, mid; mat u; &#125; t[maxn &lt;&lt; 2]; \nint g1[maxn][2];\nint g[maxn], ty[maxn];\nint tab[maxn], ls[maxn], lim[maxn];\n#define lt t[p].lc\n#define rt t[p].rc\nvoid fillmat(mat &amp;a, int op, int g) &#123;\n    if (op == 0) &#123;\n        a.n = 1, a.m = 2;\n        a[0][!g] = 0, a[0][g] = 1;\n        return;\n    &#125;\n    a.n = 2, a.m = 2;\n    switch (op) &#123;\n    case 1: // !\n        a[0][0] = 0, a[0][1] = 1;\n        a[1][0] = 1, a[1][1] = 0;\n        break;\n    case 2: // &amp;\n        a[0][0] = 1, a[0][1] = 0;\n        a[1][0] = !g, a[1][1] = g;\n        break;\n    case 3: // |\n        a[0][0] = !g, a[0][1] = g;\n        a[1][0] = 0, a[1][1] = 1;\n        break;\n    case 4: // ^\n        a[0][0] = !g, a[0][1] = g;\n        a[1][0] = g, a[1][1] = !g;\n        break;\n    default:\n        assert(0);\n    &#125;\n    return;\n&#125;\nvoid bld(int &amp;p, int l, int r) &#123;\n    static int tot = 0;\n    p = ++tot, t[p].l = l, t[p].r = r;\n    if (l == r) &#123;\n        fillmat(t[p].u, ty[tab[l]], g[tab[l]]);\n        return;\n    &#125;\n    int s = 0, u = ls[tab[l]];\n    for (int i = l; i &lt;= r; ++i)\n        s += ls[tab[i]];\n    s &gt;&gt;= 1;\n    t[p].mid = r - 1;\n    for (int i = l + 1; i &lt; r; ++i) &#123;\n        u += ls[tab[i]];\n        if (u + ls[tab[i + 1]] &gt; s) &#123;\n            t[p].mid = i;\n            break;\n        &#125;\n    &#125;\n    bld(lt, l, t[p].mid), bld(rt, t[p].mid + 1, r);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\nvoid add(int p, int x) &#123;\n    if (t[p].l == t[p].r) &#123;\n        fillmat(t[p].u, ty[tab[t[p].l]], g[tab[t[p].l]]);\n        return;\n    &#125;\n    if (x &lt;= t[p].mid)\n        add(lt, x);\n    else\n        add(rt, x);\n    t[p].u = t[rt].u * t[lt].u;\n    return;\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifndef ONLINE_JUDGE\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int n = 0, q, p;\n    read(q), read(q);\n    &#123;\n        std::string s;\n        std::cin &gt;&gt; s;\n        std::stringstream in(s);\n        std::stack&lt;char&gt; op;\n        std::stack&lt;int&gt; id;\n        auto trans = [&amp;](char t) &#123;\n            switch (t) &#123;\n            case &#39;!&#39;:\n                return 1;\n            case &#39;&amp;&#39;:\n                return 2;\n            case &#39;|&#39;:\n                return 3;\n            case &#39;^&#39;:\n                return 4;\n            &#125;\n            assert(0);\n            return -1;\n        &#125;;\n        auto calcNot = [&amp;](void) &#123;\n            for (; !op.empty() &amp;&amp; op.top() == &#39;!&#39;; ) &#123;\n                ty[++n] = trans(op.top());\n                g1[n][0] = id.top(), id.pop(), id.push(n);\n                op.pop();\n            &#125;\n            return;\n        &#125;;\n        auto opt = [&amp;](void) &#123;\n            ty[++n] = trans(op.top());\n            g1[n][0] = id.top(), id.pop();\n            g1[n][1] = id.top(), id.pop();\n            id.push(n), op.pop();\n            return;\n        &#125;;\n        for (char t; in &gt;&gt; t; )\n            if (t == &#39;[&#39;) &#123;\n                int x;\n                in &gt;&gt; x, in &gt;&gt; t;\n                lim[++n] = x - 1;\n                id.push(n), calcNot();\n            &#125;\n            else if (t == &#39;(&#39;)\n                op.push(t);\n            else if (t == &#39;)&#39;) &#123;\n                for (; op.top() != &#39;(&#39;; opt());\n                op.pop(), calcNot();\n            &#125;\n            else if (t == &#39;&amp;&#39;)\n                op.push(t);\n            else if (t == &#39;^&#39;) &#123;\n                for (; !op.empty() &amp;&amp; op.top() == &#39;&amp;&#39;; opt());\n                op.push(t);\n            &#125;\n            else if (t == &#39;|&#39;) &#123;\n                for (; !op.empty() &amp;&amp; (op.top() == &#39;&amp;&#39; || op.top() == &#39;^&#39;); opt());\n                op.push(t);\n            &#125;\n            else &#123;\n                assert(t == &#39;!&#39;);\n                op.push(t);\n            &#125;\n        for (; !op.empty(); opt());\n        p = id.top();\n    &#125;\n    std::vector&lt;int&gt; rt(n + 1);\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1), fa(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g1[x])\n            if (i != 0) &#123;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(p);\n    std::vector&lt;long long&gt; f(n + 1);\n    std::vector&lt;int&gt; top(n + 1), bot(n + 1), dfn(n + 1);\n    DFS = [&amp;](int x) &#123;\n        static int now = 0;\n        dfn[x] = ++now, tab[now] = x, ls[x] = 1;\n        if (son[x]) &#123;\n            top[son[x]] = top[x], DFS(son[x]);\n            bot[x] = bot[son[x]];\n            for (auto i : g1[x])\n                if (i != son[x] &amp;&amp; i != 0) &#123;\n                    top[i] = i, DFS(i);\n                    ls[x] += siz[i], g[x] = f[i];\n                &#125;\n            switch (ty[x]) &#123;\n            case 1:\n                f[x] = !f[son[x]];\n                break;\n            case 2:\n                f[x] = g[x] &amp; f[son[x]];\n                break;\n            case 3:\n                f[x] = g[x] | f[son[x]];\n                break;\n            case 4:\n                f[x] = g[x] ^ f[son[x]];\n                break;\n            default:\n                assert(0);\n                break;\n            &#125;\n        &#125;\n        else\n            assert(!ty[x]), f[x] = g[x] = 0, bot[x] = x;\n        if (x == top[x])\n            bld(rt[x], dfn[x], dfn[bot[x]]);\n        return;\n    &#125;;\n    top[p] = p, DFS(p);\n    std::vector&lt;int&gt; a(q + 1), res(q + 1);\n    for (int i = 1; i &lt;= q; ++i)\n        read(a[i]);\n    std::vector&lt;int&gt; qid(q), nid;\n    for (int i = 1; i &lt;= n; ++i)\n        if (ty[i] == 0)\n            nid.push_back(i);\n    std::iota(qid.begin(), qid.end(), 1);\n    std::sort(qid.begin(), qid.end(), [&amp;](int x, int y) &#123; return a[x] &lt; a[y]; &#125;);\n    std::sort(nid.begin(), nid.end(), [&amp;](int x, int y) &#123; return lim[x] &gt; lim[y]; &#125;);\n    for (auto i : qid) &#123;\n        for (; !nid.empty() &amp;&amp; lim[nid.back()] &lt; a[i]; ) &#123;\n            int x = nid.back();\n            nid.pop_back();\n            g[x] = 1;\n            for (; top[x] != p; ) &#123;\n                add(rt[top[x]], dfn[x]);\n                g[fa[top[x]]] = t[rt[top[x]]].u[0][1];\n                x = fa[top[x]];\n            &#125;\n            add(rt[p], dfn[x]);\n        &#125;\n        res[i] = t[rt[p]].u[0][1];\n    &#125;\n    for (int i = 1; i &lt;= q; ++i)\n        if (res[i])\n            std::cout &lt;&lt; &quot;True\\n&quot;;\n        else\n            std::cout &lt;&lt; &quot;False\\n&quot;;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "çº¿æ®µæ ‘",
                "DDP"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250809/",
            "url": "https://xsc062.netlify.app/20250809/",
            "title": "è¿‘æœŸæ‚é¢˜",
            "date_published": "2025-08-09T04:33:17.000Z",
            "content_html": "<p>è¿™æ®µæ—¶é—´æ¯”èµ›çš„ä¸€äº›é¢˜ å’Œ nKessiã€duanyu è®²çš„é¢˜ç›®ã€‚å¤ªåè®¡æ•°ã€æ•°å­¦çš„åŸºæœ¬ä¸Šæ²¡åŠæ³•åšäº†ã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a.-å‡ºå…³\">A. å‡ºå…³</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6462/problem/1\" class=\"uri\">http://222.180.160.110:61235/contest/6462/problem/1</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(s\\)</span>ï¼Œå¯¹äºä¸€ä¸ªç©ºä¸²ï¼Œä»»æ„åˆ©ç”¨ä¸‹åˆ—ä¸‰ç§æ“ä½œï¼Œä½¿å…¶å˜ä¸º <span class=\"math inline\">\\(s\\)</span>ï¼Œæ±‚æœ€å°ä»£ä»·ï¼š</p>\n<ol type=\"1\">\n<li>åœ¨æœ«å°¾æ·»åŠ å­—ç¬¦ <span class=\"math inline\">\\(c\\)</span>ï¼Œä»£ä»·ä¸º <span class=\"math inline\">\\(t_{0,c}\\)</span>ï¼›</li>\n<li>å¤åˆ¶æ•´ä¸ªå­—ç¬¦ä¸²å¹¶ç²˜è´´åœ¨æœ«å°¾ï¼Œä»£ä»·ä¸º <span class=\"math inline\">\\(t_1\\)</span>ï¼›</li>\n<li>åˆ é™¤æœ«å°¾å­—ç¬¦ï¼Œä»£ä»·ä¸º <span class=\"math inline\">\\(t_2\\)</span>ã€‚</li>\n</ol>\n<p><span class=\"math inline\">\\(|s|\\le 10^6\\)</span>ã€‚</p>\n</blockquote>\n<p>å¯ä»¥é¢„å¤„ç†å‡ºå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span> ç»“å°¾ï¼Œæœ€å¤šå¯ä»¥å¤åˆ¶åˆ°å“ªä¸ªåœ°æ–¹ï¼Œå‘ç°è¦æ±‚ <span class=\"math inline\">\\(z_i=lcp(s_{1\\dots n},s_{i+1\\dots n})\\)</span>ã€‚é‚£ä¹ˆä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span> çš„æœ€è¿œè½¬ç§»ç‚¹ <span class=\"math inline\">\\(r_i=i+z_{i+1}\\)</span>ï¼Œç”¨å•è°ƒé˜Ÿåˆ—å°±èƒ½ç»´æŠ¤ï¼Œä¼š exkmp å°±èƒ½çº¿æ€§ï¼›</p>\n<p>å¦åˆ™å¯ä»¥äºŒåˆ† + å“ˆå¸Œå¤šä¸ª logï¼Œåé¢ä¹Ÿæœ‰ç†ç”±å·æ‡’ç”¨ä¼˜å…ˆé˜Ÿåˆ—äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int p = 31;\nconst int mod = 998244353;\nint main() &#123;\n    std::freopen(&quot;laozi.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;laozi.out&quot;, &quot;w&quot;, stdout);\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::string s;\n    std::cin &gt;&gt; s;\n    int n = (int)s.length(), t1, t2;\n    std::vector&lt;long long&gt; h(n + 1), base(n + 1);\n    std::vector&lt;int&gt; a(n + 1), t0(27), z(n + 1), r(n + 1);\n    base[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        a[i] = s[i - 1] - &#39;a&#39; + 1;\n        h[i] = (h[i - 1] * p + a[i]) % mod;\n        base[i] = base[i - 1] * p % mod;\n    &#125;\n    auto gethash = [&amp;](int l, int r) &#123;\n        return (h[r] - h[l - 1] * base[r - l + 1] % mod + mod) % mod;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)\n        for (int l = 1, r = std::min(i - 1, n - i + 1), mid; l &lt;= r; ) &#123;\n            mid = (l + r) &gt;&gt; 1;\n            if (gethash(1, mid) == gethash(i, i + mid - 1))\n                z[i] = mid, l = mid + 1;\n            else\n                r = mid - 1;\n        &#125;\n    for (int i = 1; i &lt; n; ++i)\n        r[i] = i + std::min(i, z[i + 1]);\n    for (int i = 1; i &lt;= 26; ++i)\n        std::cin &gt;&gt; t0[i];\n    std::cin &gt;&gt; t1 &gt;&gt; t2;\n    std::vector&lt;long long&gt; f(n + 1);\n    std::priority_queue&lt;std::pair&lt;long long, int&gt; &gt; q;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        f[i] = f[i - 1] + t0[a[i]];\n        for (; !q.empty() &amp;&amp; r[q.top().second] &lt; i; q.pop());\n        if (!q.empty())\n            f[i] = std::min(f[i], t1 - q.top().first - (long long)t2 * i);\n        if (i != n)\n            q.emplace(-(f[i] + 2ll * t2 * i), i);\n    &#125;\n    std::cout &lt;&lt; f[n] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d.-éæ”»\">D. éæ”»</h2>\n<p><a href=\"http://222.180.160.110:61235/contest/6462/problem/4\" class=\"uri\">http://222.180.160.110:61235/contest/6462/problem/4</a></p>\n<blockquote>\n<p>ç»™å®š <span class=\"math inline\">\\(n\\)</span>ï¼Œå¯¹äºä¸€ä¸ª <span class=\"math inline\">\\(1\\sim n\\)</span> çš„æ’åˆ—ï¼Œä½¿ç”¨æœ€å°çš„äº¤æ¢æ¬¡æ•°ä½¿å¾—å…¶å•å¢ã€‚åœ¨è¯¥å‰æä¸‹ï¼Œå®šä¹‰ä»£ä»·ä¸ºæ¯æ¬¡äº¤æ¢çš„ä¸¤ä¸ªæ•°ä¹‹ç§¯ã€‚å¯¹äºæ‰€æœ‰ <span class=\"math inline\">\\(n!\\)</span> ä¸ªæ’åˆ—ï¼Œè®¡ç®—æœ€å°ä»£ä»·ä¹‹å’Œã€‚</p>\n<p><span class=\"math inline\">\\(n\\le 10^7\\)</span>ã€‚</p>\n</blockquote>\n<p>è½¬åŒ–æˆï¼ŒæŠŠ <span class=\"math inline\">\\(1\\sim n\\)</span> åˆ†æˆæ— æ ‡å·çš„è‹¥å¹²ç»„ï¼Œæ¯ç»„çš„ä»£ä»·æ˜¯ æœ€å°å€¼ <span class=\"math inline\">\\(\\times\\)</span> å…¶ä»–å…ƒç´ çš„å’Œï¼Œè¿˜æœ‰ä¸€ä¸ªé¡¹é“¾é—®é¢˜çš„ç³»æ•°ï¼Œå‘ç°ç»„é—´çš„ç¬¦å·æ˜¯æ±‚å’Œï¼Œè€ƒè™‘è®¡ç®—è´¡çŒ®ã€‚</p>\n<p>æšä¸¾ <span class=\"math inline\">\\(i,j\\)</span> å¹¶é’¦å®šä¸¤ä¸ªåŒå±ä¸€ä¸ªç¯ï¼Œä¸” <span class=\"math inline\">\\(i\\)</span> ä¸ºæœ€å°å€¼ï¼Œæšä¸¾ç¯å¤§å° <span class=\"math inline\">\\(s+2\\)</span>ï¼Œé‚£ä¹ˆæœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\n\\begin{aligned}\nres&amp;=\\sum_{i=1}^{n-1}\\sum_{j=i+1}^n i\\cdot j \\cdot \\sum_{s=0}^{n-i-1}\\binom{n-i-1}s \\cdot (s+1)!\\cdot (n-s-2)!\\\\\n&amp;=\\sum_{i=1}^{n-1}i\\cdot \\dfrac {(i+n+1)(n-i)}2 \\cdot \\sum_{s=0}^{n-i-1}\\binom{n-i-1}s\\cdot (s+1)!\\cdot (n-s-2)!\\\\\n&amp;=\\frac 12\\times\\sum_{i=1}^{n-1}i\\cdot (i+n+1)\\cdot (n-i)!\\cdot\\sum_{s=0}^{n-i-1}\\dfrac {(s + 1)\\cdot (n-s-2)!}{(n-i-1-s)!}\\\\\n\\end{aligned}\n\\]</span></p>\n<p>ä»¤ <span class=\"math inline\">\\(T=n-i-1\\)</span>ï¼Œå‘ç°æˆ‘ä»¬éœ€è¦å¿«é€Ÿè®¡ç®— <span class=\"math inline\">\\(f_T=\\sum\\limits_{i=0}^T \\dfrac{(i+1)\\cdot (n-i-2)!}{(T-i)!}\\)</span>ã€‚è®° <span class=\"math inline\">\\(m=n-2\\)</span>ï¼Œå˜å½¢å¾— <span class=\"math inline\">\\(f_T=(m-T)!\\cdot \\sum\\limits_{i=0}^{T} (i+1) \\binom{m-i}{m-T}\\)</span>ï¼Œå‘ç°ä¼¼ä¹å¯ä»¥ç®€åŒ–ï¼Œä»¤ <span class=\"math inline\">\\(k=m-T,t=T+1\\)</span>ï¼Œåˆ™ <span class=\"math inline\">\\(f_T=\\sum\\limits_{i=1}^T i\\cdot \\binom {k+t-i}k\\)</span>ã€‚</p>\n<p>ç„¶åæ˜¯ç»å…¸çš„ç»„åˆæ„ä¹‰ä¿å¹³å®‰ç¯èŠ‚ï¼Œå³ä» <span class=\"math inline\">\\(k+t\\)</span> ä¸ªæœ‰æ ‡å·å°çƒä¸­é€‰æ‹©ä¸€æ¡åˆ†ç•Œçº¿ï¼Œåˆ†ç•Œçº¿å·¦è¾¹é€‰ä¸€ä¸ªçƒã€å³è¾¹é€‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªçƒçš„æ–¹æ¡ˆæ•°ã€‚å‘ç°åˆ†ç•Œçº¿çš„å­˜åœ¨å¾ˆè¯¡å¼‚ï¼Œæ•…ç”¨åˆ†ç•Œçº¿åæ–¹çš„ç¬¬ä¸€ä¸ªçƒä»£æ›¿ï¼Œåœ¨ <span class=\"math inline\">\\(t+1\\)</span> å¤„æ–°å»ºä¸€ä¸ªè™šçƒï¼Œè§„å®šåœ¨å‰ <span class=\"math inline\">\\(t+1\\)</span> ä¸ªçƒä¸­é€‰ä¸¤ä¸ªçƒï¼Œå¹¶ä»¤åä¸€ä¸ªä¸ºåˆ†ç•Œçº¿ï¼Œä¸”ä»¤å‰ <span class=\"math inline\">\\(t+1\\)</span> ä¸ªä¸­çš„å…¶ä»–çƒä¸ºå®çƒï¼Œå°±èƒ½å»ºç«‹åŒå°„ã€‚åœ¨åˆ†ç•Œçº¿åå†é€‰ <span class=\"math inline\">\\(k\\)</span> ä¸ªçƒï¼Œå®¹æ˜“å‘ç°ç›´æ¥åœ¨èŒƒå›´å†…é€‰ <span class=\"math inline\">\\(k+2\\)</span> ä¸ªçƒå°±èƒ½æ»¡è¶³æ¡ä»¶ï¼Œæ•… <span class=\"math inline\">\\(f_T=(n-T-2)!\\cdot \\binom{t+k+1}{k+2}\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 1e9 + 7;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n    std::freopen(&quot;mozi.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;mozi.out&quot;, &quot;w&quot;, stdout);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;long long&gt; fac(n + 1), inv(n + 1), f(n + 1);\n    fac[0] = inv[0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    inv[n] = qkp(fac[n], mod - 2);\n    for (int i = n - 1; i; --i)\n        inv[i] = inv[i + 1] * (i + 1) % mod;\n    auto C = [&amp;](int n, int m) &#123;\n        return fac[n] * inv[n - m] % mod * inv[m] % mod;\n    &#125;;\n    int m = n - 2;\n    for (int T = 0; T &lt;= n - 2; ++T) &#123;\n        int k = m - T, t = T + 1;\n        f[T] = C(t + k + 1, k + 2) * fac[m - T] % mod;\n    &#125;\n    auto res = 0ll;\n    for (int i = 1; i &lt;= n - 1; ++i)\n        (res += (long long)i * (i + n + 1) % mod * fac[n - i] % mod * f[n - i - 1] % mod) %= mod;\n    std::cout &lt;&lt; res * inv[2] % mod &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---destruction-of-walls\">C - Destruction of Walls</h2>\n<p><a href=\"https://atcoder.jp/contests/arc203/tasks/arc203_c\" class=\"uri\">https://atcoder.jp/contests/arc203/tasks/arc203_c</a></p>\n<hr />\n<h2 id=\"d---insert-xor\">D - Insert XOR</h2>\n<p><a href=\"https://atcoder.jp/contests/arc203/tasks/arc203_d\" class=\"uri\">https://atcoder.jp/contests/arc203/tasks/arc203_d</a></p>\n<hr />\n<h2 id=\"a---è®°å¿†\">A - è®°å¿†</h2>\n<p><a href=\"https://ac.nowcoder.com/acm/problem/274793\" class=\"uri\">https://ac.nowcoder.com/acm/problem/274793</a></p>\n<p>éœ€è¦æ„è¯†åˆ°é—®é¢˜æ˜¯é™æ€çš„ï¼Œå¹¶ä¸”ä¸èƒ½ç”¨çº¿æ®µæ ‘ä¹‹ç±»ç»´æŠ¤ï¼›æ•…è€ƒè™‘ç¦»çº¿ä¸‹æ¥ï¼Œæƒ³åŠæ³•åœ¨ LCA å¤„ç»Ÿè®¡ç­”æ¡ˆã€‚</p>\n<p>è¿™ä¸ªæ—¶å€™å‘ç°éœ€è¦åˆå¹¶å­æ ‘çŠ¶æ€ã€æ•´ä½“å¼‚æˆ–ã€æ•´ä½“ +1ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ° Trieã€‚æŠŠ <span class=\"math inline\">\\(u\\to\\)</span> LCA çš„ç­”æ¡ˆä¿å­˜åœ¨ LCA å¤„ï¼Œç„¶åå†ç”¨ DFS + å›æº¯ç»Ÿè®¡ LCA <span class=\"math inline\">\\(\\to v\\)</span> çš„ç­”æ¡ˆã€‚æƒ³äº†åŠå¤©æ²¡æƒ³åˆ°æŠŠä¸Šä¸‹æ‹†å¼€æ¥åšä¹Ÿæ˜¯ç¥äº† ğŸ˜…</p>\n<p>å¯èƒ½æ¯”è¾ƒè€ƒéªŒå¯¹å­—å…¸æ ‘çš„ç†è§£ï¼Ÿåšä¸ªæ¯”å–»ï¼Œå­—å…¸æ ‘çš„ id å°±ç›¸å½“äºå¯¹è¿™ä¸ªç‚¹ä¸Šä¿¡æ¯çš„ã€å¼•ç”¨ã€ã€‚</p>\n<details>\n<p>å­—å…¸æ ‘åˆå¹¶çš„æ—¶å€™å¯ä»¥è€ƒè™‘å›æ”¶åºŸå¼ƒç‚¹ï¼Œä¸ç„¶å¯èƒ½æœ‰ç‚¹å¡ã€‚</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int X = 50;\nconst int maxn = 2e7 + 5;\nlong long d[maxn];\nint tot, T[maxn][2], f[maxn], fa[maxn];\n#define lc(p) T[p][0]\n#define rc(p) T[p][1]\nint find(int x) &#123; return x == f[x] ? x : f[x] = find(f[x]); &#125;\nint newnode(void) &#123;\n    int p = ++tot;\n    assert(p &lt; maxn);\n    d[p] = lc(p) = rc(p) = 0, f[p] = p;\n    return p;\n&#125;\nvoid pushdown(int p) &#123;\n    if (d[p]) &#123;\n        if (d[p] &amp; 1)\n            std::swap(lc(p), rc(p));\n        d[p] &gt;&gt;= 1;\n        if (lc(p))\n            d[lc(p)] ^= d[p];\n        if (rc(p))\n            d[rc(p)] ^= d[p];\n        d[p] = 0;\n    &#125;\n    return;\n&#125;\nint ins(int p, long long x) &#123;\n    for (int i = 0; i &lt; X; ++i) &#123;\n        pushdown(p);\n        if (!T[p][(x &gt;&gt; i) &amp; 1]) &#123;\n            T[p][(x &gt;&gt; i) &amp; 1] = newnode();\n            fa[T[p][(x &gt;&gt; i) &amp; 1]] = p;\n        &#125;\n        p = T[p][(x &gt;&gt; i) &amp; 1];\n    &#125;\n    return p;\n&#125;\nvoid merge(int &amp;p, int q) &#123;\n    if (!q)\n        return;\n    if (!p) &#123;\n        p = q;\n        return;\n    &#125;\n    pushdown(p), pushdown(q);\n    fa[lc(q)] = p, fa[rc(q)] = p;\n    merge(lc(p), lc(q)), merge(rc(p), rc(q));\n    assert(f[p] == p), assert(f[q] == q), f[q] = p;\n    return;\n&#125;\nlong long ask(int p) &#123;\n    std::vector&lt;int&gt; st;\n    for (int i = 0, j = p; i &lt; X; ++i)\n        st.push_back(fa[j]), j = fa[j];\n    for (int i = 0; i &lt; X; ++i)\n        pushdown(st.back()), st.pop_back();\n    long long x = 0;\n    for (int i = 0; i &lt; X; ++i) &#123;\n        x = x * 2 + (p == rc(fa[p]));\n        p = fa[p];\n    &#125;\n    return x;\n&#125;\nvoid add(int p) &#123;\n    for (int i = 0; p &amp;&amp; i &lt; X; ++i) &#123;\n        pushdown(p);\n        std::swap(lc(p), rc(p));\n        p = lc(p);\n    &#125;\n    return;\n&#125;\nvoid del(int p) &#123;\n    for (int i = 0; p &amp;&amp; i &lt; X; ++i) &#123;\n        pushdown(p);\n        std::swap(lc(p), rc(p));\n        p = rc(p);\n    &#125;\n    return;\n&#125;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; siz(n + 1), son(n + 1), top(n + 1), fa(n + 1), dep(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        siz[x] = 1;\n        for (auto i : g[x])\n            if (i != fa[x]) &#123;\n                dep[i] = dep[x] + 1;\n                fa[i] = x, DFS(i);\n                siz[x] += siz[i];\n                if (siz[i] &gt; siz[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1);\n    DFS = [&amp;](int x) &#123;\n        if (son[x])\n            top[son[x]] = top[x], DFS(son[x]);\n        for (auto i : g[x])\n            if (i != son[x] &amp;&amp; i != fa[x])\n                top[i] = i, DFS(i);\n        return;\n    &#125;;\n    top[1] = 1, DFS(1);\n    auto askLCA = [&amp;](int x, int y) &#123;\n        for (; top[x] != top[y]; x = fa[top[x]])\n            if (dep[top[x]] &lt; dep[top[y]])\n                std::swap(x, y);\n        return dep[x] &lt; dep[y] ? x : y;\n    &#125;;\n    struct node &#123; long long x; int u, v; &#125;;\n    std::vector&lt;node&gt; q(m + 1);\n    std::vector&lt;int&gt; id(m + 1);\n    std::vector&lt;long long&gt; res(m + 1), ans(m + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; up(n + 1), dn(n + 1), ed(n + 1);\n    for (int i = 1, x, u, v; i &lt;= m; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; u &gt;&gt; v;\n        q[i] = &#123; x, u, v &#125;;\n        up[u].push_back(i), dn[askLCA(u, v)].push_back(i), ed[v].push_back(i);\n    &#125;\n    std::vector&lt;int&gt; rt(n + 1);\n    DFS = [&amp;](int x) &#123;\n        rt[x] = newnode();\n        for (auto i : g[x])\n            if (i != fa[x]) &#123;\n                DFS(i);\n                merge(rt[x], rt[i]);\n            &#125;\n        add(rt[x]);\n        for (auto i : up[x])\n            id[i] = ins(rt[x], q[i].x);\n        d[rt[x]] ^= a[x];\n        for (auto i : dn[x])\n            res[i] = ask(find(id[i]));\n        return;\n    &#125;;\n    DFS(1);\n    tot = 0, rt[0] = newnode();\n    std::fill(id.begin() + 1, id.end(), 0);\n    DFS = [&amp;](int x) &#123;\n        d[rt[0]] ^= a[x];\n        for (auto i : dn[x])\n            id[i] = ins(rt[0], res[i]);\n        for (auto i : ed[x])\n            ans[i] = ask(id[i]);\n        add(rt[0]);\n        for (auto i : g[x])\n            if (i != fa[x])\n                DFS(i);\n        del(rt[0]);\n        d[rt[0]] ^= a[x];\n        return;\n    &#125;;\n    DFS(1);\n    for (int i = 1; i &lt;= m; ++i)\n        std::cout &lt;&lt; ans[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ-2-meetings-2\">B - ãƒ“ãƒ¼ãƒãƒ¼ã®ä¼šåˆ 2 (Meetings 2)</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/AT_joisc2021_j\" class=\"uri\">https://www.luogu.com.cn/problem/AT_joisc2021_j</a></p>\n<p>å®šä¹‰æ‰€æ±‚ç‚¹ä¸ºã€å±€éƒ¨é‡å¿ƒã€ï¼›ç±»ä¼¼æ ‘çš„é‡å¿ƒï¼Œå®¹æ˜“å‘ç°å½“å…³é”®ç‚¹æ•°é‡ä¸ºå¥‡æ—¶ï¼Œåªå­˜åœ¨ä¸€ä¸ªå±€éƒ¨é‡å¿ƒï¼›å¦åˆ™ï¼Œå±€éƒ¨é‡å¿ƒç»„æˆä¸€æ¡é“¾ã€‚</p>\n<p>å³å¯¹äºæ¯ä¸€ä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œéœ€è¦æ‰¾åˆ°ä¸€æ¡æœ€é•¿é“¾ï¼Œä½¿å¾—å…¶ä¸¤ç«¯å­˜åœ¨å¤§å°ä¸º <span class=\"math inline\">\\(i\\)</span> çš„å­æ ‘ï¼ˆå®¹æ˜“å‘ç°å–åç¼€ max å³å¯å¾—åˆ°çœŸå®ç­”æ¡ˆï¼‰ã€‚ä½¿ç”¨ç‚¹åˆ†æ²»ï¼Œç²¾ç»†å®ç°å®¹æ˜“åšåˆ° <span class=\"math inline\">\\(O(n\\log n)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; mx(n + 1), siz(n + 1), p, tag(n + 1), res(n + 1, 1);\n    std::function&lt;void(int, int)&gt; DFS1 = [&amp;](int x, int fa) &#123;\n        p.push_back(x);\n        siz[x] = 1, mx[x] = 0;\n        for (auto i : g[x])\n            if (!tag[i] &amp;&amp; i != fa) &#123;\n                DFS1(i, x);\n                siz[x] += siz[i];\n                mx[x] = std::max(mx[x], siz[i]);\n            &#125;\n        return;\n    &#125;;\n    auto findrt = [&amp;](int x) &#123;\n        p.clear(), DFS1(x, -1);\n        int n = (int)p.size();\n        for (auto i : p)\n            if (mx[i] &lt;= n / 2 &amp;&amp; n - siz[i] &lt;= n / 2)\n                return i;\n        assert(0);\n        return -1;\n    &#125;;\n    struct node &#123;\n        int u1, u2, id1, id2;\n        node(): u1(0), u2(0), id1(0), id2(0) &#123;&#125;\n        void upd(int u, int id) &#123;\n            if (id1 == id)\n                u1 = std::max(u1, u);\n            else if (u &gt;= u1)\n                u2 = u1, id2 = id1, u1 = u, id1 = id;\n            else if (u &gt;= u2)\n                u2 = u, id2 = id;\n            return;\n        &#125;\n    &#125;;\n    std::vector&lt;node&gt; s(n + 1);\n    std::function&lt;void(int, int, int, int)&gt; DFS2 = [&amp;](int x, int fa, int dep, int anc) &#123;\n        s[siz[x]].upd(dep, anc);\n        for (auto i : g[x])\n            if (!tag[i] &amp;&amp; i != fa)\n                DFS2(i, x, dep + 1, anc);\n        return;\n    &#125;;\n    std::function&lt;void(int, int, int, int)&gt; DFS3 = [&amp;](int x, int fa, int dep, int anc) &#123;\n        int v = ((s[siz[x]].id1 == anc) ? s[siz[x]].u2 : s[siz[x]].u1);\n        res[2 * siz[x]] = std::max(res[2 * siz[x]], dep + 1 + v);\n        for (auto i : g[x])\n            if (!tag[i] &amp;&amp; i != fa)\n                DFS3(i, x, dep + 1, anc);\n        return;\n    &#125;;\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        x = findrt(x), p.clear(), DFS1(x, -1);\n        // printf(&quot;rt = %d\\n&quot;, x);\n        for (auto i : g[x])\n            if (!tag[i])\n                DFS2(i, x, 1, i);\n        for (int i = siz[x] - 1; i; --i) &#123;\n            s[i].upd(s[i + 1].u1, s[i + 1].id1);\n            s[i].upd(s[i + 1].u2, s[i + 1].id2);\n        &#125;\n        for (auto i : g[x])\n            if (!tag[i])\n                DFS3(i, x, 1, i);\n        tag[x] = 1;\n        for (int i = 1; i &lt; siz[x]; ++i)\n            s[i] = node();\n        for (auto i : g[x])\n            if (!tag[i])\n                DFS(i);\n        return;\n    &#125;;\n    DFS(1);\n    for (int i = (n &gt;&gt; 1) * 2; i; --i)\n        if (i + 2 &lt;= n)\n            res[i] = std::max(res[i], res[i + 2]);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---the-closest-pair\">C - The Closest Pair</h2>\n<p><a href=\"https://ac.nowcoder.com/acm/problem/262593\" class=\"uri\">https://ac.nowcoder.com/acm/problem/262593</a></p>\n<p><strong>å¸¸è§„æ–¹æ³•</strong>ï¼šè€ƒè™‘<strong>æ”¯é…å¯¹</strong>ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(a_i\\)</span>ï¼Œæ‰¾åˆ°æ‰€æœ‰åˆæ³•çš„ <span class=\"math inline\">\\(a_j\\)</span>ã€‚å®¹æ˜“æƒ³åˆ°æšä¸¾ <span class=\"math inline\">\\(a_i\\div a_j\\)</span> æ¥åšï¼›å‡è®¾å­˜åœ¨ <span class=\"math inline\">\\(a_k\\div a_i=a_j\\div a_i\\)</span> ä¸” <span class=\"math inline\">\\(k&gt;j\\)</span>ã€‚</p>\n<p>ä¸å¦¨è®¾ <span class=\"math inline\">\\(a_j=K\\cdot a_i+p,a_k=K\\cdot a_i+q\\)</span>ï¼Œ<span class=\"math inline\">\\((a_i,a_j),(a_i,a_k)\\)</span> å‡åˆæ³•å½“ä¸”ä»…å½“ä¸‹åˆ—æ¡ä»¶å…¨éƒ¨æˆç«‹ï¼š</p>\n<ul>\n<li><span class=\"math inline\">\\(a_j\\bmod a_i&gt;a_k\\bmod a_i\\)</span>ï¼› åˆ™ <span class=\"math inline\">\\(a_j&gt;a_k\\)</span>ã€‚</li>\n<li><span class=\"math inline\">\\(a_j\\bmod a_k&gt;a_k\\bmod a_i\\)</span>ï¼›åˆ <span class=\"math inline\">\\(p-q\\ge a_j\\bmod a_k\\)</span>ï¼ˆ<strong>å¤ªç‰›äº†è¿™ä¸€æ­¥</strong>ï¼‰ï¼Œå³ <span class=\"math inline\">\\(p-q&gt;q\\iff p&gt;2q\\)</span>ã€‚</li>\n</ul>\n<p>è¯å¾—åªå…³å¿ƒåŒä¸€ä¸ª <span class=\"math inline\">\\(a_j\\div a_i\\)</span> æ—¶çš„æ”¯é…å¯¹æ•°é‡ä¸º <span class=\"math inline\">\\(\\log n\\)</span> çº§åˆ«ï¼›æ€»å¯¹æ•° <span class=\"math inline\">\\(O(n\\log n\\ln n)\\)</span>ã€‚ç¦»çº¿ä¸‹æ¥æ‰«æçº¿å°±è¡Œäº†ã€‚</p>\n<details>\n<p>å¯¹ç€ å•ç‚¹ä¿®æ”¹ åŒºé—´æœ€å€¼ æƒ³äº† 1h çš„å• log åšæ³• ğŸ˜° æœç„¶å°è„‘æ‰çº¿å¤ªå¯æ€•äº†ï¼Œç¬¬äºŒå¤©æ—©ä¸Šé‡ç½®å¤§è„‘ 1s å‘ç°è‡ªå·±æ˜¯æ–¯æ³¢ ğŸ˜“</p>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int LEN = (1 &lt;&lt; 20);\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nconst int maxn = 4e6 + 5;\nstruct &#123; int l, r, u[2]; &#125; t[maxn];\n#define lt (t[p].l)\n#define rt (t[p].r)\nint tot[2];\nvoid add(int &amp;p, int l, int r, int x, int v, int i) &#123;\n    if (!p)\n        p = ++tot[i], t[p].u[0] = -1, t[p].u[1] = 0x3f3f3f3f;\n    if (i == 0)\n        t[p].u[0] = std::max(t[p].u[0], v);\n    else\n        t[p].u[1] = std::min(t[p].u[1], v);\n    if (l == r)\n        return;\n    int mid = (l + r) &gt;&gt; 1;\n    if (x &lt;= mid)\n        add(lt, l, mid, x, v, i);\n    else\n        add(rt, mid + 1, r, x, v, i);\n    return;\n&#125;\nint ask(int p, int l, int r, int ql, int qr, int i) &#123;\n    if (!p || (ql &lt;= l &amp;&amp; r &lt;= qr))\n        return t[p].u[i];\n    int mid = (l + r) &gt;&gt; 1;\n    if (qr &lt;= mid)\n        return ask(lt, l, mid, ql, qr, i);\n    if (ql &gt; mid)\n        return ask(rt, mid + 1, r, ql, qr, i);\n    if (i == 0)\n        return std::max(ask(lt, l, mid, ql, qr, 0), ask(rt, mid + 1, r, ql, qr, 0));\n    return std::min(ask(lt, l, mid, ql, qr, 1), ask(rt, mid + 1, r, ql, qr, 1));\n&#125;\n#undef lt\n#undef rt\nint main() &#123;\n#ifndef ONLINE_JUDGE\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    const int m = 1e6;\n    int rt[2] = &#123; 0 &#125;, n;\n    t[0].u[0] = -1, t[0].u[1] = 0x3f3f3f3f;\n    read(n);\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        read(a[i]);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; t(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        if (i != 1) &#123;\n            for (int K = a[i]; K &lt;= m; K += a[i]) &#123;\n                for (int mx = std::min(a[i] - 1, m - K); ; ) &#123;\n                    int k = ask(rt[0], 1, m, K, K + mx, 0);\n                    if (k == -1)\n                        break;\n                    t[i].emplace_back(k, a[k] - K);\n                    if (k == 1 || !(a[k] - K))\n                        break;\n                    mx = (a[k] - K - 1) / 2;\n                &#125;\n            &#125;\n        &#125;\n        add(rt[0], 1, m, a[i], i, 0);\n    &#125;\n    for (int i = n; i; --i) &#123;\n        if (i != n)\n            for (int K = a[i]; K &lt;= m; K += a[i])\n                for (int mx = std::min(a[i] - 1, m - K); ; ) &#123;\n                    int k = ask(rt[1], 1, m, K, K + mx, 1);\n                    if (k == 0x3f3f3f3f)\n                        break;\n                    t[k].emplace_back(i, a[k] - K);\n                    if (k == n || !(a[k] - K))\n                        break;\n                    mx = (a[k] - K - 1) / 2;\n                &#125;\n        add(rt[1], 1, m, a[i], i, 1);\n    &#125;\n    int q;\n    read(q);\n    std::vector&lt;int&gt; res(q + 1);\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; u(n + 1);\n    for (int i = 1, l, r; i &lt;= q; ++i) &#123;\n        read(l), read(r);\n        if (l &gt; r)\n            std::swap(l, r);\n        u[r].emplace_back(l, i);\n    &#125;\n    std::vector&lt;int&gt; bit(n + 1, 0x3f3f3f3f);\n    auto lowbit = [&amp;](int x) &#123; return x &amp; -x; &#125;;\n    auto add = [&amp;](int x, int v) &#123;\n        for (; x &lt;= n; x += lowbit(x))\n            bit[x] = std::min(bit[x], v);\n        return;\n    &#125;;\n    auto ask = [&amp;](int x) &#123;\n        auto res = 0x3f3f3f3f;\n        for (; x; x -= lowbit(x))\n            res = std::min(res, bit[x]);\n        return res;\n    &#125;;\n    for (int r = 1; r &lt;= n; ++r) &#123;\n        for (auto [l, v] : t[r])\n            add(n - l + 1, v);\n        for (auto [l, i] : u[r])\n            res[i] = ask(n - l + 1);\n    &#125;\n    for (int i = 1; i &lt;= q; ++i)\n        print(res[i], &#39;\\n&#39;);\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<p>æ±‚æ”¯é…å¯¹çš„è¿‡ç¨‹ä¹Ÿè¦å¸¦ logï¼ˆçº¿æ®µæ ‘ï¼‰ï¼Œå†åŠ ä¸Šæ‰«æçº¿çš„ 3logï¼Œæ€»å…±æ˜¯å¸¸æ•°æ¯”è¾ƒå¤§çš„ 3logï¼ˆå¡äº†ä¸€ä¸ªä¸Šåˆçš„å¸¸ä¹Ÿæ˜¯æœ‰äº†ï¼‰ã€‚æ‰€ä»¥æ¥ä¸‹æ¥è®²è§£å¦ä¸€ç§å¥‡æŠ€æ·«å·§ã€‚</p>\n<p><strong>æš´åŠ›åˆ†æ²»</strong>ï¼šæ³¨æ„åˆ°å¯¹äºæ¯”è¾ƒé•¿ï¼ˆ<span class=\"math inline\">\\(len&gt; B\\)</span>ï¼‰çš„åŒºé—´ï¼Œç­”æ¡ˆæ¯”è¾ƒå°ï¼›æ•…è€ƒè™‘åˆ†æ²»ã€‚</p>\n<ul>\n<li>å¯¹äºé•¿è¯¢é—®ï¼ˆ<span class=\"math inline\">\\(len&gt;B\\)</span>ï¼‰ï¼Œä»å°åˆ°å¤§æšä¸¾ç­”æ¡ˆå¹¶ checkï¼›é¢„å¤„ç†æŸä¸ªèŒƒå›´ï¼ˆ<span class=\"math inline\">\\(V\\)</span>ï¼‰å†…çš„ <span class=\"math inline\">\\(res\\)</span> å‡ºç°çš„æ‰€æœ‰ä½ç½®ï¼Œå¹³è¡¡çš„æ—¶å€™è¿˜è¦ç®—ä¸Šè°ƒå’Œçº§æ•°å’Œ bitã€‚</li>\n<li>å¯¹äºçŸ­è¯¢é—®ï¼ˆ<span class=\"math inline\">\\(len\\le B\\)</span>ï¼‰ï¼Œå‘ç°æ¯æ¬¡åŒºé—´å†…æš´åŠ›æ˜¯ <span class=\"math inline\">\\(O(B^2q)\\)</span> çš„ï¼›æŠŠè¯¢é—®ç¦»çº¿ä¸‹æ¥ï¼Œç²¾ç»†å®ç°ï¼Œåˆ©ç”¨è¯¢é—®çš„å…¬å…±éƒ¨åˆ†ä½¿å¾—<strong>æ¯ä¸€å¯¹æ•°åªè¢«æšä¸¾ä¸€æ¬¡</strong>å°±èƒ½è¾¾åˆ° <span class=\"math inline\">\\(O(B^2 + Bq)\\)</span>ã€‚</li>\n</ul>\n<p>æœ€ä¼˜è§£å– <span class=\"math inline\">\\(B=333,V=483\\)</span>ï¼Œä¸è‡ªå·±å®ç°ä¸€éäº†ã€‚</p>\n<hr />\n<h2 id=\"d---ä»™äººæŒ\">D - ä»™äººæŒ</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P3687\" class=\"uri\">https://www.luogu.com.cn/problem/P3687</a></p>\n<p>æŠŠè¾¹åŒä»å›¾ä¸­åˆ é™¤ã€é—®é¢˜è½¬åŒ–ä¸ºæ ‘ä¸Š<strong>è¾¹</strong>ä¸äº¤çš„é“¾è¦†ç›–ï¼Œä½¿å¾—<strong>æ‰€æœ‰é“¾é•¿ <span class=\"math inline\">\\(\\ge 2\\)</span></strong> çš„æ–¹æ¡ˆæ•°ã€‚å‘ç°ç”±äº<strong>è¾¹å¯ä»¥ä¸è¢«è¦†ç›–</strong>ï¼Œå¸¸è§„ DP ä¼šä½¿å¾—åœ¨çˆ¶èŠ‚ç‚¹å¤„åˆå¹¶æ—¶éœ€è¦é¢å¤–çš„æ•°é‡ç»´ï¼Œå‚è€ƒæ ‘ä¸ŠèƒŒåŒ…ï¼Œå¤æ‚åº¦ <span class=\"math inline\">\\(O(n^2)\\)</span>ã€‚</p>\n<p>æ€è€ƒæ—¶ä¼šæ³¨æ„åˆ°ä¸¤ä¸ªé™åˆ¶å¯ä»¥æŠµæ¶ˆâ€”â€”å¦‚æœè®¤ä¸ºé•¿ä¸º <span class=\"math inline\">\\(1\\)</span> çš„é“¾å°±æ˜¯ä¸è¢«è¦†ç›–çš„è¾¹ï¼Œè¦†ç›–æ‰€æœ‰æ ‘è¾¹ï¼Œæ˜¾ç„¶å¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚æ­¤æ—¶åˆå¹¶æ˜¯éå¸¸æ–¹ä¾¿çš„ï¼Œæ³¨æ„åˆ°æ¯ä¸ªå„¿å­çš„ç³»æ•°ä¸€å®šéƒ½å‚ä¸ã€åˆ†æ­¥ã€ï¼Œåªéœ€è¦æ±‚å‡ºã€åˆ†ç±»ã€çš„ç³»æ•°ã€‚è¿™ä¸ªå¯ä»¥é¢„å¤„ç†ï¼ˆå’Œ <a href=\"/20250407/#a.-äºŒåˆ†å›¾æŸ“è‰²\">äºŒåˆ†å›¾æŸ“è‰²</a> è¿™ä¸ªé¢˜æœ‰ç‚¹åƒï¼‰ï¼Œä»¤ <span class=\"math inline\">\\(f_i\\)</span> è¡¨ç¤ºä¸€ä¸ªç‚¹åº¦æ•°ä¸º <span class=\"math inline\">\\(i\\)</span> æ—¶çš„ç­”æ¡ˆï¼Œå‚è€ƒé”™æ’çš„æ€è·¯ï¼Œåˆ™ <span class=\"math inline\">\\(i\\)</span> å¯ä»¥ä¸å‚ä¸é…å¯¹ï¼Œä¹Ÿå¯ä»¥ä¹±é€‰ä¸€ä¸ªç‚¹é…å¯¹ï¼Œå¦‚æœé€‰ä¸­äº†å·²é…å¯¹çš„ç‚¹å°±ä»¤å…¶å’Œ <span class=\"math inline\">\\(i-1\\)</span> äº¤æ¢ï¼Œå¯ä»¥å»ºç«‹å’Œåˆæ³•è§£çš„åŒå°„ã€‚åˆ™ <span class=\"math inline\">\\(f_i=f_{i-1}+(n-1)f_{i-2}\\)</span>ã€‚</p>\n<p>é¦–å…ˆéœ€è¦ check åŸå›¾æ˜¯å¦ä¸ºä»™äººæŒï¼Œé¡ºå¸¦å›å¿†ä¸€ä¸‹è¿é€šæ€§çš„çŸ¥è¯†â€”â€”åœ¨ DFS æ ‘ä¸Šå·®åˆ†ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰è¾¹è¢«è¦†ç›–ä¸¤æ¬¡å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n    const auto stime = std::chrono::steady_clock::now();\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        int n, m;\n        std::cin &gt;&gt; n &gt;&gt; m;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g1(n + 1);\n        for (int x, y; m--; ) &#123;\n            std::cin &gt;&gt; x &gt;&gt; y;\n            g1[x].push_back(y), g1[y].push_back(x);\n        &#125;\n        bool flag = 1;\n        int now = 0, cnt = 0;\n        std::vector&lt;int&gt; st, dfn(n + 1), low(n + 1), col(n + 1), diff(n + 1);\n        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n            st.push_back(x);\n            dfn[x] = low[x] = ++now;\n            for (auto i : g1[x])\n                if (!dfn[i]) &#123;\n                    // printf(&quot;x = %d, %d -&gt; %d\\n&quot;, x, x, i);\n                    DFS(i, x);\n                    diff[x] += diff[i];\n                    // printf(&quot;x = %d, diff[%d] += diff[%d]\\n&quot;, x, x, i);\n                    low[x] = std::min(low[x], low[i]);\n                &#125;\n                else if (i != fa &amp;&amp; dfn[i] &lt; dfn[x]) &#123;\n                    low[x] = std::min(low[x], dfn[i]);\n                    ++diff[x], --diff[i];\n                    // printf(&quot;x = %d, ++diff[%d], --diff[%d]\\n&quot;, x, x, i);\n                &#125;\n            if (diff[x] &gt;= 2)\n                flag = 0;\n            // printf(&quot;x = %d, diff[%d] = %d\\n&quot;, x, x, diff[x]);\n            if (low[x] == dfn[x]) &#123;\n                ++cnt;\n                for (int p = -1; p != x; ) &#123;\n                    p = st.back(), st.pop_back();\n                    col[p] = cnt;\n                &#125;\n            &#125;\n            return;\n        &#125;;\n        DFS(1, -1);\n        if (!flag) &#123;\n            std::cout &lt;&lt; 0 &lt;&lt; &#39;\\n&#39;;\n            continue;\n        &#125;\n        std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n        for (int i = 1; i &lt;= n; ++i)\n            for (auto j : g1[i])\n                if (col[i] != col[j])\n                    g[i].push_back(j);\n        std::vector&lt;long long&gt; f(n + 1), dp(n + 1);\n        dp[0] = 1ll, dp[1] = 1ll;\n        for (int i = 2; i &lt;= n; ++i)\n            dp[i] = (dp[i - 1] + (i - 1) * dp[i - 2]) % mod;\n        std::vector&lt;int&gt; tag(n + 1);\n        DFS = [&amp;](int x, int fa) &#123;\n            f[x] = 1ll, tag[x] = 1;\n            for (auto i : g[x])\n                if (i != fa) &#123;\n                    DFS(i, x);\n                    (f[x] *= f[i]) %= mod;\n                &#125;\n            (f[x] *= dp[(int)g[x].size()]) %= mod;\n            return;\n        &#125;;\n        auto res(1ll);\n        for (int i = 1; i &lt;= n; ++i)\n            if (!tag[i])\n                DFS(i, -1), (res *= f[i]) %= mod;\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n#ifndef ONLINE_JUDGE\n    std::cerr &lt;&lt; std::fixed &lt;&lt; std::setprecision(6) &lt;&lt; std::chrono::duration&lt;double&gt; (std::chrono::steady_clock::now() - stime).count() &lt;&lt; &quot;s\\n&quot;;\n#endif\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<p>E. Many Minimizations æ˜¯æ•°å­¦é¢˜ï¼Œè·³äº†ã€‚</p>\n<hr />\n<hr />\n<h2 id=\"æ— åé¢˜\">æ— åé¢˜</h2>\n<blockquote>\n<p>èƒŒæ™¯ï¼šç»™å®š <span class=\"math inline\">\\(n,k\\)</span>ï¼Œå¯¹äº <span class=\"math inline\">\\(\\forall\\, 1\\le i\\le n\\)</span>ï¼Œä»¤ <span class=\"math inline\">\\(a_i=i\\bmod k\\)</span>ï¼Œé—®ä¸€å…±æœ‰å¤šå°‘ä¸ªæœ¬è´¨ä¸åŒçš„å­åºåˆ—ï¼Ÿå¯¹äº <span class=\"math inline\">\\(k=1,2,\\cdots,n\\)</span> åˆ†åˆ«æ±‚å‡ºç­”æ¡ˆã€‚</p>\n</blockquote>\n<hr />\n<h2 id=\"maimai\">maimai</h2>\n<p><a href=\"https://ac.nowcoder.com/acm/contest/66112/F\" class=\"uri\">https://ac.nowcoder.com/acm/contest/66112/F</a></p>\n",
            "tags": [
                "å­—å…¸æ ‘",
                "å­—ç¬¦ä¸²",
                "ç»„åˆæ•°å­¦",
                "æ”¯é…å¯¹"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250807/",
            "url": "https://xsc062.netlify.app/20250807/",
            "title": "å­¦ä¹ ç¬”è®°ï¼šåˆ†æ‹†æ•°ä¸ Ferrers å›¾",
            "date_published": "2025-08-07T08:20:45.000Z",
            "content_html": "<p>éœ€è¦çŸ¥é“æ¦‚å¿µå’Œæ±‚æ³•ï¼Œæœ‰ä¸€å®šçš„ç”¨å¤„</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"åˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°\">åˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°</h2>\n<p>è¦æ±‚ï¼šç»™å®šä¸€ä¸ªæ­£æ•´æ•° <span class=\"math inline\">\\(n\\)</span>ï¼Œè¦æ±‚å°†å…¶åˆ’åˆ†ä¸º <span class=\"math inline\">\\(m\\)</span> ä¸ªå¯é‡ / ä¸å¯é‡çš„æ­£æ•´æ•°ï¼Œé—®æœ¬è´¨ä¸åŒçš„æ–¹æ¡ˆæ•°ã€‚ï¼ˆæ˜¾ç„¶ <span class=\"math inline\">\\(m\\)</span> ä¸ <span class=\"math inline\">\\(\\sqrt n\\)</span> åŒé˜¶ã€‚ï¼‰</p>\n<p>ä¸å¦¨ä»¤åˆ’åˆ†ç»“æœå•è°ƒä¸é™ï¼Œåˆ™æœ‰ä¸¤ç§ DP è·¯å¾„ï¼š</p>\n<ul>\n<li><p>æ³•ä¸€ï¼šä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> è¡¨ç¤ºæŠŠ <span class=\"math inline\">\\(i\\)</span> åˆ†æˆ <span class=\"math inline\">\\(j\\)</span> ä¸ªæ­£æ•´æ•°çš„æ–¹æ¡ˆæ•°ã€‚</p>\n<ul>\n<li>ä¸å¯é‡ï¼šè€ƒè™‘å°†è¿™ <span class=\"math inline\">\\(j\\)</span> ä¸ªæ•°å‡å» <span class=\"math inline\">\\(1\\)</span>ã€‚æœ€å¤šä¸€ä¸ªå…ƒç´ ç”± <span class=\"math inline\">\\(1\\)</span> å˜ä¸º <span class=\"math inline\">\\(0\\)</span>ï¼Œç»„æ•°å‡å°‘ <span class=\"math inline\">\\(1\\)</span>ï¼›å…¶ä»–æ—¶å€™è¿˜æ˜¯ <span class=\"math inline\">\\(j\\)</span> ç»„ã€‚æ•…äº‘ <span class=\"math inline\">\\(f_{i,j}=f_{i-j,j-1}+f_{i-j,j}\\)</span>ã€‚</li>\n<li>å¯é‡ï¼šå¦‚æœå­˜åœ¨ <span class=\"math inline\">\\(1\\)</span>ï¼Œå¯ä»¥åˆ é™¤ä¹‹ç„¶åè½¬ç§»ï¼›å¦åˆ™ä»æ•´ä½“å‡ <span class=\"math inline\">\\(1\\)</span> è½¬ç§»ã€‚æ•…æ›° <span class=\"math inline\">\\(f_{i,j}=f_{i-1,j-1}+f_{i-j,j}\\)</span>ã€‚</li>\n</ul>\nè¯¥è½¬ç§»æ–¹æ³•å”¯ä¸€æ€§å¾ˆæ˜¾ç„¶ã€‚<strong>æ³¨æ„åˆ°ç¬¬äºŒç»´åªå’Œ <span class=\"math inline\">\\(j,j-1\\)</span> æœ‰å…³ï¼›å¯ä»¥äº¤æ¢å‰åä¸¤ç»´é¡ºåºç„¶åæ»šåŠ¨ã€‚</strong></li>\n<li><p>æ³•äºŒï¼šä»¤ <span class=\"math inline\">\\(n=\\sum a_i\\)</span>ï¼Œå»ºç«‹ <span class=\"math inline\">\\(a\\)</span> çš„å·®åˆ†æ•°ç»„ <span class=\"math inline\">\\(d\\)</span>ï¼Œåˆ™æœ‰ <span class=\"math inline\">\\(n=\\sum\\limits_{i=1}^m \\sum\\limits_{j=1}^i c_j=\\sum\\limits_{i=1}^m (n-i+1)\\times a_i\\)</span>ã€‚å‘ç° <span class=\"math inline\">\\(a_i\\)</span> æ¯å¢å¤§ <span class=\"math inline\">\\(1\\)</span>ï¼Œç­”æ¡ˆä¼šå¢å¤§ <span class=\"math inline\">\\(n-i+1\\)</span>ã€‚æ•…è½¬åŒ–ä¸ºã€ç¬¬ <span class=\"math inline\">\\(i\\)</span> ä¸ªç‰©å“é‡é‡ä¸º <span class=\"math inline\">\\(n-i+1\\)</span>ã€çš„å®Œå…¨èƒŒåŒ…ã€‚</p>\n<ul>\n<li>ä¸å¯é‡ï¼šè¦æ±‚æ¯ä¸ªç‰©å“è‡³å°‘é€‰ä¸€æ¬¡ã€‚</li>\n<li>å¯é‡ï¼šæ— é™åˆ¶ã€‚</li>\n</ul>\n<p>è¯¥æ–¹æ³•å”¯ä¸€æ€§æ›´æ˜¾ç„¶ã€‚</p></li>\n</ul>\n<p>å¤æ‚åº¦å‡ä¸º <span class=\"math inline\">\\(O(nm)\\)</span>ï¼Œå³ <span class=\"math inline\">\\(O(V\\sqrt V)\\)</span>ã€‚</p>\n<h3 id=\"ä¾‹sets-of-complementary-sums\">ä¾‹ï¼šSets of Complementary Sums</h3>\n<p><a href=\"/20250723/#e.-sets-of-complementary-sums\">link</a></p>\n<h2 id=\"ferrers-å›¾\">Ferrers å›¾</h2>\n<p>å°† <span class=\"math inline\">\\(k\\)</span> ä¸ªåˆ†æ‹†å‡ºæ¥çš„æ•°ç”¨æ¨ªå‘æŸ±çŠ¶å›¾è¡¨ç¤ºå¹¶å•è°ƒä¸å¢æ’åˆ—ï¼Œå¾—åˆ° Ferrers å›¾ã€‚</p>\n<figure>\n<img src=\"image-1.png\" alt=\"ä¾‹ï¼š12=5+4+2+1 çš„ Ferrers å›¾ï¼ˆå›¾æº OI Wikiï¼‰\" /><figcaption>ä¾‹ï¼š<span class=\"math inline\">\\(12=5+4+2+1\\)</span> çš„ Ferrers å›¾ï¼ˆå›¾æº OI Wikiï¼‰</figcaption>\n</figure>\n<p>å°†å›¾åƒæ–œå‘ç¿»æŠ˜å¾—åˆ°ä¸€ç»„å…±è½­è§£ï¼ŒåŸå›¾ä¸­çš„ <span class=\"math inline\">\\(k\\)</span> å³ä¸ºå…±è½­è§£ä¸­çš„å…ƒç´ æœ€å€¼ã€‚æ•…äº¦å¯é™å®šåˆ†æ‹†ç»“æœçš„æœ€å€¼ä¸º <span class=\"math inline\">\\(k\\)</span>ï¼Œåˆ™ç»“æœä»ä¸º <span class=\"math inline\">\\(f_{n,k}\\)</span>ã€‚åŒæ—¶é€‚ç”¨äºåˆ†æ‹†æ•°ä¸äº’å¼‚åˆ†æ‹†æ•°ã€‚</p>\n<p>é¡ºå¸¦æä¸€å˜´æ¨è¡¨ï¼šæŠŠç‚¹æ›¿æ¢æˆ <span class=\"math inline\">\\(1\\sim n\\)</span>ï¼Œå¹¶ä½¿å¾—ä¸€ä¸ªç‚¹åŒæ—¶å¤§äºå·¦ä¾§å’Œä¸Šæ–¹çš„å€¼ã€‚</p>\n<p>ä¼¼ä¹å°±ä¸æ˜¯å¾ˆæœ‰ç”¨äº†ã€‚è®¡æ•°é¢˜å¯èƒ½ä¼šè€ƒã€‚</p>\n",
            "tags": [
                "DP"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250805/",
            "url": "https://xsc062.netlify.app/20250805/",
            "title": "çŠ¶å‹ DP",
            "date_published": "2025-08-05T06:33:55.000Z",
            "content_html": "<p>æ²¡è¡¥å®Œï¼ˆ1/3ï¼‰ï¼ŒåŠ¨ä½œè¿˜æ˜¯å¤ªæ…¢äº†</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a---åªä¸è¿‡æ˜¯é•¿çš„é¢†å¸¦-2-just-long-neckties-2\">A - åªä¸è¿‡æ˜¯é•¿çš„é¢†å¸¦ 2 / Just Long Neckties 2</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P11665\" class=\"uri\">https://www.luogu.com.cn/problem/P11665</a></p>\n<p>éœ€è¦è§‚å¯Ÿåˆ°ï¼Œä»»æ„æ—¶åˆ» <span class=\"math inline\">\\(B\\)</span> ä¸­ä¸å­˜åœ¨é‡å¤å…ƒç´ ã€‚æŠŠ <span class=\"math inline\">\\(B\\)</span> å‹å‡ºæ¥ï¼Œä»¤ <span class=\"math inline\">\\(f_{i,S}\\)</span> è¡¨ç¤ºé€‰äº† <span class=\"math inline\">\\(i\\)</span>ï¼Œå½“å‰ <span class=\"math inline\">\\(B\\)</span> ä¸º <span class=\"math inline\">\\(S\\)</span> æ˜¯å¦å¯è¡Œï¼Œèƒ½å¤Ÿ <span class=\"math inline\">\\(O(n\\cdot 2^V)\\)</span>ã€‚å¯¹äºæŸä¸ª <span class=\"math inline\">\\(S\\)</span>ï¼Œåªå…³å¿ƒå®ƒæœ€è¿œèƒ½åˆ°è¾¾å“ªä¸ª <span class=\"math inline\">\\(i\\)</span>ï¼Œæ•…ä»¤ <span class=\"math inline\">\\(f_S\\)</span> è®°å½•ä¹‹ã€‚å¯¹äºæ¯ä¸€ä¸ª <span class=\"math inline\">\\(S\\)</span>ï¼Œéƒ½å¯ä»¥æ‰¾åˆ° <span class=\"math inline\">\\(f_S\\)</span> åç¬¬ä¸€å¯¹ <span class=\"math inline\">\\(a_i,a_{i+1}\\notin S\\)</span>ï¼Œç”¨å…¶åˆ·è¡¨ã€‚</p>\n<p>å‘ç°ã€æ‰¾ <span class=\"math inline\">\\(f_S\\)</span> åç¬¬ä¸€å¯¹éæ³•å…ƒç´ ã€æ˜¯å¾ˆæ…¢çš„ï¼Œè€ƒè™‘ä¼˜åŒ–ï¼›å¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(i\\)</span> ç»´æŠ¤ <span class=\"math inline\">\\(p\\)</span> åœ¨å…¶åç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® <span class=\"math inline\">\\(x\\)</span>ï¼Œå¯¹äºæ¯ä¸ª <span class=\"math inline\">\\(a_x=p\\)</span> ç»´æŠ¤ <span class=\"math inline\">\\(x\\)</span> åæ–¹ <span class=\"math inline\">\\(a_y=p,a_{y+1}=q\\)</span> ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œç›¸å½“äº<strong>å…ˆæ‰¾ <span class=\"math inline\">\\(p\\)</span> å†æ‰¾ <span class=\"math inline\">\\((p,q)\\)</span></strong>ï¼Œå°±å¯ä»¥åšåˆ° <span class=\"math inline\">\\(O(V^2\\cdot 2^V+n\\cdot V)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    int V = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i];\n        V = std::max(V, a[i]--);\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; tx(n + 1, std::vector&lt;int&gt; (V)), ty(n + 1, std::vector&lt;int&gt; (V));\n    std::vector&lt;int&gt; lp(V);\n    std::vector&lt;std::vector&lt;int&gt; &gt; lpq(V, std::vector&lt;int&gt; (V));\n    for (int i = n; ~i; --i) &#123;\n        if (i &amp;&amp; i != n)\n            lpq[a[i]][a[i + 1]] = i;\n        for (int j = 0; j &lt; V; ++j) &#123;\n            tx[i][j] = lp[j];\n            if (i != n)\n                ty[i][j] = lpq[a[i]][j];\n        &#125;\n        if (i != 0)\n            lp[a[i]] = i;\n    &#125;\n    int siz = 1 &lt;&lt; V, res = 21;\n    std::vector&lt;int&gt; f(siz);\n    for (int i = 0; i &lt; siz; ++i) &#123;\n        std::vector&lt;int&gt; p0, p1;\n        for (int j = 0; j &lt; V; ++j)\n            if ((i &gt;&gt; j) &amp; 1)\n                p1.push_back(j);\n            else\n                p0.push_back(j);\n        int j = n;\n        for (auto p : p0)\n            if (tx[f[i]][p])\n                for (auto q : p0)\n                    if (ty[tx[f[i]][p]][q])\n                        j = std::min(j, ty[tx[f[i]][p]][q]);\n        if (j != n) &#123;\n            f[i ^ (1 &lt;&lt; a[j])] = std::max(f[i ^ (1 &lt;&lt; a[j])], j);\n            f[i ^ (1 &lt;&lt; a[j + 1])] = std::max(f[i ^ (1 &lt;&lt; a[j + 1])], j + 1);\n            for (auto k : p1) &#123;\n                f[i ^ (1 &lt;&lt; k) ^ (1 &lt;&lt; a[j])] = std::max(f[i ^ (1 &lt;&lt; k) ^ (1 &lt;&lt; a[j])], j);\n                f[i ^ (1 &lt;&lt; k) ^ (1 &lt;&lt; a[j + 1])] = std::max(f[i ^ (1 &lt;&lt; k) ^ (1 &lt;&lt; a[j + 1])], j + 1);\n            &#125;\n        &#125;\n        else\n            res = std::min(res, __builtin_popcount(i));\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---cut-and-reorder\">B - Cut and Reorder</h2>\n<p><a href=\"https://atcoder.jp/contests/abc328/tasks/abc328_g\" class=\"uri\">https://atcoder.jp/contests/abc328/tasks/abc328_g</a></p>\n<p>ä¸å¦¨å…ˆé‡æ’å†ä¿®æ”¹ï¼Œä»¤ <span class=\"math inline\">\\(f_{i,S}\\)</span> è¡¨ç¤ºå·²ç»é‡æ’å¥½æ–°åºåˆ—çš„å‰ <span class=\"math inline\">\\(i\\)</span> ä¸ªå…ƒç´ ï¼Œå¯¹åº”åŸåºåˆ—çŠ¶æ€ <span class=\"math inline\">\\(S\\)</span> çš„æœ€å°ä»£ä»·ã€‚æšä¸¾æ–°åŒºé—´å®¹æ˜“è½¬ç§»ã€‚å¯ä»¥å‘ç°æšä¸¾ <span class=\"math inline\">\\(i,S\\)</span> çš„å®é™…å¤æ‚åº¦ä¸º <span class=\"math inline\">\\(O(2^n)\\)</span>ï¼ˆç©ºé—´ä¹Ÿå¯ä»¥è¿™ä¹ˆä¼˜åŒ–ï¼‰ï¼Œé¢„å¤„ç†ä¹‹åæ€»æ—¶é—´å¤æ‚åº¦ <span class=\"math inline\">\\(O(n^2\\cdot 2^n)\\)</span>ï¼Œè·‘ä¸æ»¡ï¼Œå¯ä»¥é€šè¿‡ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    long long c;\n    std::cin &gt;&gt; n &gt;&gt; c;\n    std::vector&lt;long long&gt; a(n), b(n);\n    for (int i = 0; i &lt; n; ++i)\n        std::cin &gt;&gt; a[i];\n    for (int i = 0; i &lt; n; ++i)\n        std::cin &gt;&gt; b[i];\n    using arr = std::vector&lt;long long&gt;;\n    using brr = std::vector&lt;arr&gt;;\n    using crr = std::vector&lt;brr&gt;;\n    brr p(n, arr(n));\n    crr g(n, brr(n, arr(n)));\n    for (int l = 0; l &lt; n; ++l)\n        for (int r = l; r &lt; n; ++r) &#123;\n            for (int k = l; k &lt;= r; ++k)\n                p[l][r] ^= (1 &lt;&lt; k);\n            for (int R = r - l; R &lt; n; ++R)\n                for (int L = R, j = r; j &gt;= l; --L, --j)\n                    g[l][r][R] += std::abs(b[L] - a[j]);\n        &#125;\n    int siz = 1 &lt;&lt; n;\n    std::vector&lt;long long&gt; f(siz, inf);\n    f[0] = 0ll;\n    for (int j = 1; j &lt; siz; ++j) &#123;\n        int i = __builtin_popcount(j) - 1;\n        for (int r = 0; r &lt; n; ++r)\n            for (int l = r; ~l &amp;&amp; ((j &gt;&gt; l) &amp; 1); --l)\n                f[j] = std::min(f[j], f[j ^ p[l][r]] + g[l][r][i] + c);\n    &#125;\n    std::cout &lt;&lt; f[siz - 1] - c &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---electric-circuit\">C - Electric Circuit</h2>\n<p><a href=\"https://atcoder.jp/contests/abc321/tasks/abc321_g\" class=\"uri\">https://atcoder.jp/contests/abc321/tasks/abc321_g</a></p>\n<p>å¾ˆåƒ<a href=\"/20250430/#æœ‰æ ‡å·æ— å‘å›¾è®¡æ•°\">æ— å‘å›¾å®¹æ–¥</a>ï¼Ÿä»¤ <span class=\"math inline\">\\(f_S\\)</span> è¡¨ç¤ºè®© <span class=\"math inline\">\\(S\\)</span> å†…éƒ¨å®Œæˆé…å¯¹ï¼Œå¯ä»¥ä¸è¿é€šçš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆå½“ä¸”ä»…å½“ <span class=\"math inline\">\\(S\\)</span> å†…éƒ¨ç‚¹å‡ºã€å…¥åº¦ä¹‹å’Œç›¸ç­‰ï¼ˆè®°ä¸º <span class=\"math inline\">\\(cnt\\)</span>ï¼‰æ—¶ï¼Œ<span class=\"math inline\">\\(f_S\\)</span> æœ‰å€¼ <span class=\"math inline\">\\(cnt!\\)</span>ã€‚ç›¸ä¼¼åœ°ï¼Œè®¾ <span class=\"math inline\">\\(g_S\\)</span> è¡¨ç¤ºè®© <span class=\"math inline\">\\(S\\)</span> å®Œæˆé…å¯¹ï¼Œæˆä¸ºä¸€ä¸ªè¿é€šå—çš„æ–¹æ¡ˆæ•°ï¼Œå¾—åˆ° <span class=\"math inline\">\\(g_S=f_S-\\sum\\limits_{v\\in S} f_{S\\oplus v}\\cdot g_v\\)</span>ã€‚è®© <span class=\"math inline\">\\(v\\)</span> å¿…é¡»åŒ…å« <span class=\"math inline\">\\(S\\)</span> ä¸­ç¼–å·æœ€å°çš„ç‚¹å°±å¯ä»¥å»é‡ã€‚</p>\n<p>ä»è´¡çŒ®çš„è§’åº¦å‡ºå‘ï¼Œ<span class=\"math inline\">\\(S\\)</span> å¸¦æ¥çš„è´¡çŒ®å°±æ˜¯ <span class=\"math inline\">\\(g_S\\cdot f_{U\\oplus S}\\)</span>ï¼Œå…¶ä¸­ <span class=\"math inline\">\\(U\\)</span> æ˜¯å…¨é›†ã€‚æœ€åé™¤ä»¥ <span class=\"math inline\">\\(M!\\)</span> æ±‚å‡ºæœŸæœ›ã€‚</p>\n<p>å¤æ‚åº¦ <span class=\"math inline\">\\(O(3^n)\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::vector&lt;int&gt; ci(n), co(n);\n    for (int i = 1, x; i &lt;= m; ++i)\n        std::cin &gt;&gt; x, ++ci[x - 1];\n    for (int i = 1, x; i &lt;= m; ++i)\n        std::cin &gt;&gt; x, ++co[x - 1];\n    std::vector&lt;long long&gt; fac(m + 1);\n    fac[0] = 1ll;\n    for (int i = 1; i &lt;= m; ++i)\n        fac[i] = fac[i - 1] * i % mod;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    int siz = 1 &lt;&lt; n;\n    std::vector&lt;long long&gt; f(siz), g(siz);\n    for (int i = 1; i &lt; siz; ++i) &#123;\n        int si = 0, so = 0;\n        for (int j = 0; j &lt; n; ++j)\n            if ((i &gt;&gt; j) &amp; 1)\n                si += ci[j], so += co[j];\n        if (si == so)\n            f[i] = fac[si];\n    &#125;\n    auto res(0ll);\n    for (int i = 1; i &lt; siz; ++i) &#123;\n        g[i] = f[i];\n        int mn = 0;\n        for (int j = 0; j &lt; n; ++j)\n            if ((i &gt;&gt; j) &amp; 1) &#123;\n                mn = j;\n                break;\n            &#125;\n        int s = i ^ (1 &lt;&lt; mn);\n        (g[i] += mod - g[1 &lt;&lt; mn] * f[s] % mod) %= mod;\n        for (int j = (s - 1) &amp; s; j; j = (j - 1) &amp; s)\n            (g[i] += mod - g[j ^ (1 &lt;&lt; mn)] * f[s ^ j] % mod) %= mod;\n        if (i != siz - 1)\n            (res += g[i] * f[(siz - 1) ^ i]) %= mod;\n        else\n            (res += g[i]) %= mod;\n    &#125;\n    std::cout &lt;&lt; res * qkp(fac[m], mod - 2) % mod &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---count-grid-3-coloring\">D - Count Grid 3-coloring</h2>\n<p><a href=\"https://atcoder.jp/contests/abc379/tasks/abc379_g\" class=\"uri\">https://atcoder.jp/contests/abc379/tasks/abc379_g</a></p>\n<p>è½®å»“çº¿ DPã€‚æŠŠæ¯ä¸€åˆ—å·²ç»ç¡®å®šçš„æœ€é ä¸‹çš„å…ƒç´ å‹èµ·æ¥ï¼Œæ¯è¡Œé€ä¸ªç¡®å®šå³å¯ã€‚</p>\n<p>å‘ç°æœ‰æ•ˆçŠ¶æ€ä¸­åªèƒ½å®¹è®¸æœ€å¤šä¸€å¯¹ç›¸é‚»ç›¸åŒå…ƒç´ ï¼Œè¿™æ ·å¤æ‚åº¦å°±èƒ½é™ä¸‹æ¥äº†ã€‚æ³¨æ„ç‰¹åˆ¤ <span class=\"math inline\">\\(1\\times 1\\)</span> çš„æƒ…å†µã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m;\n    std::cin &gt;&gt; n &gt;&gt; m;\n    std::array&lt;int, 15&gt; p;\n    p[0] = 1;\n    for (int i = 1; i &lt; 15; ++i)\n        p[i] = p[i - 1] * 3;\n    std::vector&lt;std::vector&lt;int&gt; &gt; a;\n    if (n &gt;= m) &#123;\n        a.assign(n + 1, std::vector&lt;int&gt; (m + 1));\n        for (int i = 1; i &lt;= n; ++i) \n            for (int j = 1; j &lt;= m; ++j) &#123;\n                char t;\n                std::cin &gt;&gt; t, a[i][j] = (t == &#39;?&#39; ? -1 : t - &#39;1&#39;);\n            &#125;\n    &#125;\n    else &#123;\n        std::swap(n, m);\n        a.assign(n + 1, std::vector&lt;int&gt; (m + 1));\n        for (int i = 1; i &lt;= m; ++i)\n            for (int j = 1; j &lt;= n; ++j) &#123;\n                char t;\n                std::cin &gt;&gt; t, a[j][i] = (t == &#39;?&#39; ? -1 : t - &#39;1&#39;);\n            &#125;\n    &#125;\n    int siz = p[m];\n    using arr = std::vector&lt;long long&gt;;\n    using brr = std::vector&lt;arr&gt;;\n    using crr = std::vector&lt;brr&gt;;\n    std::vector&lt;int&gt; s, tab(siz, -1);\n    auto getv_1 = [&amp;](int j, int i) &#123;\n        return (j / p[i - 1]) % 3;\n    &#125;;\n    auto getv = [&amp;](int j, int i) &#123;\n        return (s[j] / p[i - 1]) % 3;\n    &#125;;\n    auto chg = [&amp;](int j, int i, int v) &#123;\n        return tab[s[j] - p[i - 1] * getv(j, i) + p[i - 1] * v];\n    &#125;;\n    auto out = [&amp;](int i) &#123;\n        std::string s;\n        for (int j = 1; j &lt;= m; ++j)\n            s += &#39;1&#39; + getv_1(i, j);\n        return s.c_str();\n    &#125;;\n    for (int i = 0; i &lt; siz; ++i) &#123;\n        s.push_back(i);\n        int cnt = 0;\n        for (int j = 2; j &lt;= m; ++j)\n            if (getv_1(i, j - 1) == getv_1(i, j) &amp;&amp; ++cnt &gt;= 2) &#123;\n                s.pop_back();\n                break;\n            &#125;\n    &#125;\n    for (int i = 0; i &lt; (int)s.size(); ++i)\n        tab[s[i]] = i;\n    siz = (int)s.size();\n    if (n == 1) &#123;\n        std::cout &lt;&lt; (a[1][1] == -1 ? 3 : 1) &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    crr f(n + 1, brr(m + 1, arr(siz)));\n    for (int i = 0; i &lt; siz; ++i)\n        if ([&amp;](int i, int s) &#123;\n            for (int j = 1; j &lt;= m; ++j) &#123;\n                if (a[i][j] != -1 &amp;&amp; a[i][j] != getv(s, j))\n                    return false;\n                if (j != 1 &amp;&amp; getv(s, j) == getv(s, j - 1))\n                    return false;\n            &#125;\n            return true;\n        &#125; (1, i)) &#123;\n            for (int p = 0; p &lt; 3; ++p)\n                if ((a[2][1] == -1 || a[2][1] == p) &amp;&amp; getv(i, 1) != p &amp;&amp; ~chg(i, 1, p))\n                    (++f[2][1][chg(i, 1, p)]) %= mod;\n        &#125;\n    for (int i = 2; i &lt;= n; ++i) &#123;\n        for (int k = 1; k &lt; m; ++k)\n            for (int j = 0; j &lt; siz; ++j)\n                if (f[i][k][j]) &#123;\n                    // printf(&quot;f[%d][%d][%s] = %lld\\n&quot;, i, k, out(s[j]), f[i][k][j]);\n                    for (int p = 0; p &lt; 3; ++p)\n                        if ((a[i][k + 1] == -1 || a[i][k + 1] == p) &amp;&amp; getv(j, k) != p &amp;&amp; getv(j, k + 1) != p &amp;&amp; ~chg(j, k + 1, p))\n                            (f[i][k + 1][chg(j, k + 1, p)] += f[i][k][j]) %= mod;\n                &#125;\n        for (int j = 0; j &lt; siz; ++j)\n            if (i != n &amp;&amp; f[i][m][j])\n                for (int p = 0; p &lt; 3; ++p)\n                    if ((a[i + 1][1] == -1 || a[i + 1][1] == p) &amp;&amp; getv(j, 1) != p &amp;&amp; ~chg(j, 1, p))\n                        (f[i + 1][1][chg(j, 1, p)] += f[i][m][j]) %= mod;\n    &#125;\n    auto res = 0ll;\n    for (int i = 0; i &lt; siz; ++i)\n        (res += f[n][m][i]) %= mod;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---pure-straight\">E - Pure Straight</h2>\n<p><a href=\"https://atcoder.jp/contests/arc126/tasks/arc126_d\" class=\"uri\">https://atcoder.jp/contests/arc126/tasks/arc126_d</a></p>\n<p>æ‰‹ç©å‘ç°åªè¦æœ€ç»ˆåºåˆ—ç¡®å®šï¼Œé‚£ä¹ˆç§»åŠ¨çš„é¡ºåºä¸å½±å“ç­”æ¡ˆã€‚æ•…è€ƒè™‘ç¡®å®šç›®æ ‡ä½ç½®å’Œç§»åŠ¨åºåˆ—ã€‚è€ƒè™‘ç»å¯¹å€¼çš„å‡ ä½•æ„ä¹‰ï¼Œä¸å¦¨ä»¤ç›®æ ‡å­åºåˆ—ä¸­å…ƒç´ é›†ä¸­åˆ°è¢«é€‰ä¸­ä½ç½®çš„ä¸­é—´å…ƒç´ ï¼Œæ­¤æ—¶çš„ä»£ä»·å¯ä»¥è®¡ç®—ã€‚ç”¨ç‚¹äºŒè¿›åˆ¶æŠ€å·§å’Œåº“å‡½æ•°å¯ä»¥ <span class=\"math inline\">\\(O(1)\\)</span> ç®—ä»£ä»·ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, k;\n    std::cin &gt;&gt; n &gt;&gt; k;\n    int siz = 1 &lt;&lt; k;\n    std::vector&lt;int&gt; a(n + 1), f(siz, 0x3f3f3f3f);\n    auto out = [&amp;](int j) &#123;\n        std::string s;\n        for (int i = 0; i &lt; k; ++i)\n            s += (&#39;0&#39; + ((j &gt;&gt; i) &amp; 1));\n        return s.c_str();\n    &#125;;\n    f[0] = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; a[i], --a[i];\n        for (int j = siz - 1; j &gt;= 0; --j) &#123;\n            if (!((j &gt;&gt; a[i]) &amp; 1))\n                f[j | (1 &lt;&lt; a[i])] = std::min(f[j | (1 &lt;&lt; a[i])], f[j] + __builtin_popcount(j &amp; (~((1 &lt;&lt; a[i]) - 1))));\n            f[j] += std::min(__builtin_popcount(j), k - __builtin_popcount(j));\n        &#125;\n    &#125;\n    std::cout &lt;&lt; f[siz - 1] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"f---123-set\">F - 123 Set</h2>\n<p><a href=\"https://atcoder.jp/contests/arc184/tasks/arc184_b\" class=\"uri\">https://atcoder.jp/contests/arc184/tasks/arc184_b</a></p>\n<p>åšè¿‡ <a href=\"https://www.luogu.com.cn/problem/P3226\">é›†åˆé€‰æ•°</a>ï¼ˆè¿™ä¸ª trick è§è¿‡å¾ˆå¤šæ¬¡äº†ï¼Œåº”è¯¥ä¸åªè¿™ä¸€é“ï¼Œä½†æˆ‘æƒ³ä¸èµ·æ¥äº†ï¼‰å¾ˆå®¹æ˜“æƒ³åˆ°ç”»ä¸€ä¸ªè¡¨æ ¼æˆ–è€… DAG å‡ºæ¥ï¼Œå…¶å®éƒ½èƒ½åš</p>\n<p>å¯¹äºè¡¨æ ¼å·¦ä¸Šè§’å’Œ DAG çš„æºç‚¹ï¼Œè‚¯å®šæ˜¯ä¸€ä¸ª <span class=\"math inline\">\\(x\\)</span>ï¼Œå…¶ä¸æ˜¯ <span class=\"math inline\">\\(2\\)</span> æˆ– <span class=\"math inline\">\\(3\\)</span> çš„å€æ•°ã€‚å¦‚æœç”»è¡¨ï¼Œæ¨ªä¹˜ 3 ç«–ä¹˜ 2ï¼Œè§‚å¯Ÿä¸€ä¸‹æ˜¯åŒ…å«äº† <span class=\"math inline\">\\(1\\sim n\\)</span> æ°å¥½ä¸€æ¬¡çš„å¾ˆå¤šä¸ªæ¨è¡¨ï¼ˆæ²¡ä»€ä¹ˆç”¨ï¼Œæä¸€å˜´è€Œå·²ï¼‰ï¼Œè€ƒè™‘è½¬åŒ–ç›®æ ‡ï¼Œå‘ç°æ˜¯ç”¨ä¸€ä¸ªä¸å¯æ—‹è½¬çš„å€’ L å½¢éª¨ç‰Œå¯å æ”¾åœ°é“ºæ»¡å¼‚å½¢è¡¨æ ¼ï¼Œå¯ä»¥è€ƒè™‘è½®å»“çº¿ DP</p>\n<p>å…·ä½“åœ°ï¼Œç”¨ 1 æ¥è¡¨ç¤ºæ‹è§’å¤„ï¼Œ0 è¡¨ç¤ºå…¶ä»–ï¼Œå æ”¾çš„æ—¶å€™ 1 çš„ä¼˜å…ˆçº§æ¯” 0 é«˜ï¼Œç„¶åå°±å¯ä»¥åšäº†ã€‚ä»¥ 3 ä¸ºè¡Œï¼Œæ‚²è§‚ä¼°è®¡å•ä¸ªè¡¨æ ¼å¤§æ¦‚æœ‰ <span class=\"math inline\">\\(31\\times 2^{19}\\)</span> ä¸ªçŠ¶æ€ï¼Œè¿ç®—æ¬¡æ•°å·®ä¸å¤š <span class=\"math inline\">\\(31\\times 19\\times 2^{19}\\)</span>ï¼›å†å‘ç°é•¿å¾—ä¸€æ¨¡ä¸€æ ·çš„è¡¨æ ¼è‚¯å®šæ–¹æ¡ˆæ•°æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœæŠŠä»»æ„ä¸€ä¸ªè¡¨æ ¼å…¨éƒ¨é™¤ä»¥ <span class=\"math inline\">\\(x\\)</span>ï¼Œå°±ä¼šå¾—åˆ° <span class=\"math inline\">\\(n=10^9\\div x\\)</span> æ—¶ <span class=\"math inline\">\\(1\\)</span> ä¸ºå·¦ä¸Šè§’çš„æ¨è¡¨ï¼Œå°±æ˜¯è¯´é•¿ç›¸åªå’Œ <span class=\"math inline\">\\(10^9\\div x\\)</span> çš„å€¼æœ‰å…³ï¼Œå¯ä»¥æ•´é™¤åˆ†å— ğŸ˜± å¯é¢„è®¡çš„è·‘å¾—éå¸¸ä¸æ»¡ï¼Œå®è·µä¸‹æ¥æ˜¯å¯ä»¥è¿‡çš„ï¼ˆä½†æ˜¯å¾ˆæ…¢ï¼‰</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    auto calc = [&amp;](int r) &#123;\n        return r - r / 2 - r / 3 + r / 6;\n    &#125;;\n    auto dp = [&amp;](int lim) &#123;\n        if (lim == 1) &#123;\n            // printf(&quot;lim = 1, ret 1&quot;);\n            return 1;\n        &#125;\n        int n = 1, m = 1;\n        for (int k = 1; k * 2 &lt;= lim; ++n, k *= 2);\n        for (int k = 1; k * 3 &lt;= lim; ++m, k *= 3);\n        int siz = 1 &lt;&lt; m;\n        std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(2, std::vector&lt;std::vector&lt;int&gt; &gt; (2, std::vector&lt;int&gt; (siz))), p(n + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (m));\n        std::vector&lt;std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; &gt; t(2, std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; (2, std::vector&lt;std::pair&lt;int, int&gt; &gt; (siz))); // sb\n        auto upd = [&amp;](int i, int k, int j, int v) &#123;\n            if (t[i &amp; 1][k &amp; 1][j] != std::make_pair(i, k)) &#123;\n                p[i][k].push_back(j);\n                t[i &amp; 1][k &amp; 1][j] = &#123; i, k &#125;, f[i &amp; 1][k &amp; 1][j] = v;\n            &#125;\n            else\n                f[i &amp; 1][k &amp; 1][j] = std::min(f[i &amp; 1][k &amp; 1][j], v);\n            return;\n        &#125;;\n        auto chg = [&amp;](int i, int j, int v) &#123;\n            return i ^ (((i &gt;&gt; j) &amp; 1) &lt;&lt; j) ^ (v &lt;&lt; j);\n        &#125;;\n        for (int i = 0; i &lt; siz; ++i) &#123;\n            bool flag = 0;\n            for (int j = 0; j &lt; m; ++j)\n                if (((i &gt;&gt; j) &amp; 1) || (j &amp;&amp; ((i &gt;&gt; (j - 1)) &amp; 1)));\n                else &#123;\n                    flag = 1;\n                    break;\n                &#125;\n            if (!flag)\n                upd(1, m - 1, i, __builtin_popcount(i));\n        &#125;\n        for (int i = 2; i &lt;= n; i++) &#123;\n            int m1 = 1;\n            for (int x = (1 &lt;&lt; (i - 1)); x * 3ll &lt;= lim; ++m1, x *= 3);\n            int siz1 = 1 &lt;&lt; m1;\n            for (auto j : p[i - 1][m - 1]) &#123;\n                if (j &amp; 1)\n                    upd(i, 0, chg(j &amp; (siz1 - 1), 0, 0), f[(i - 1) &amp; 1][(m - 1) &amp; 1][j]);\n                upd(i, 0, chg(j &amp; (siz1 - 1), 0, 1), f[(i - 1) &amp; 1][(m - 1) &amp; 1][j] + 1);\n            &#125;\n            m = m1, siz = siz1;\n            for (int k = 0; k &lt; m - 1; ++k)\n                for (auto j : p[i][k]) &#123;\n                    if (((j &gt;&gt; k) &amp; 1) || ((j &gt;&gt; (k + 1)) &amp; 1))\n                        upd(i, k + 1, chg(j, k + 1, 0), f[i &amp; 1][k &amp; 1][j]);\n                    upd(i, k + 1, chg(j, k + 1, 1), f[i &amp; 1][k &amp; 1][j] + 1);\n                &#125;\n        &#125;\n        int res = 0x3f3f3f3f;\n        for (auto i : p[n][m - 1])\n            res = std::min(res, f[n &amp; 1][(m - 1) &amp; 1][i]);\n        return res;\n    &#125;;\n    int res = 0;\n    for (int l = 1, r; l &lt;= n; l = r + 1) &#123;\n        r = n / (n / l);\n        if (calc(r) - calc(l - 1))\n            res += (calc(r) - calc(l - 1)) * dp(n / l);\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "DP",
                "çŠ¶å‹ DP"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250803/",
            "url": "https://xsc062.netlify.app/20250803/",
            "title": "æ ‘ DP",
            "date_published": "2025-08-03T03:44:54.000Z",
            "content_html": "<p>æ ‘ä¸Šçš„ DP ä»¥åŠ å’Œæ ‘æœ‰å…³çš„ DP</p>\n<span id=\"more\"></span>\n<hr />\n<h2 id=\"a---svjetlo\">A - Svjetlo</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P7163\" class=\"uri\">https://www.luogu.com.cn/problem/P7163</a></p>\n<p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œå³ä»¤ <span class=\"math inline\">\\(f_{x,0/1/2}\\)</span> åˆ†åˆ«è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(0/1/2\\)</span> ä¸ªç«¯ç‚¹åœ¨å­æ ‘å†…éƒ¨çš„æƒ…å†µï¼›ç„¶åå°±å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ»¡è¶³å¯¹äºå¼€å…³çŠ¶æ€çš„è¦æ±‚ï¼Ÿ</p>\n<p>è¿˜æ˜¯æƒ³å°‘äº†ã€‚å¦‚æœå†åŠ ä¸€ç»´ï¼Œä»ã€çŠ¶æ€ä¸ºå¼€æˆ–å…³ã€æ€è€ƒå°±ä¼šè½»æ¾å¾ˆå¤šï¼Œä»¤ <span class=\"math inline\">\\(f_{x,0/1/2,0/1}\\)</span> è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(0/1/2\\)</span> ä¸ªç«¯ç‚¹å†å­æ ‘å¤–éƒ¨ï¼Œä¸”å­æ ‘å†…æ“ä½œå®Œå <span class=\"math inline\">\\(x\\)</span> ä¸ºå…³ / å¼€çš„æœ€å°‘æ­¥æ•°ã€‚ç„¶ååˆ†ç±»è®¨è®ºè½¬ç§»æ–¹å¼å³å¯ã€‚</p>\n<p>ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„è®¨è®ºæ–¹å¼æ˜¯ï¼Œå…ˆç¡®å®šæŸç§æƒ…å†µä¸‹ï¼Œè®¿é—® <span class=\"math inline\">\\(u\\)</span> ä¸ <span class=\"math inline\">\\(v\\)</span> çš„æ¬¡æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°å®ƒä»¬åŸæœ¬çš„çŠ¶æ€ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, rt = -1;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        a[i] = t - &#39;0&#39;;\n        if (!a[i])\n            rt = i;\n    &#125;\n    if (rt == -1) &#123;\n        std::cout &lt;&lt; 0 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; tag(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        tag[x] = a[x];\n        for (auto i : g[x])\n            if (i != fa)\n                DFS(i, x), tag[x] &amp;= tag[i];\n        return;\n    &#125;;\n    DFS(rt, -1);\n    std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(n + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (3, std::vector&lt;int&gt; (2, 0x3f3f3f3f)));\n    DFS = [&amp;](int x, int fa) &#123;\n        f[x][0][a[x]] = 0;\n        for (auto i : g[x])\n            if (i != fa &amp;&amp; !tag[i]) &#123;\n                DFS(i, x);\n                auto g = f[x];\n                f[x][0][0] = std::min(g[0][0] + f[i][0][1] + 4, g[0][1] + f[i][0][0] + 2);\n                f[x][0][1] = std::min(g[0][1] + f[i][0][1] + 4, g[0][0] + f[i][0][0] + 2);\n                f[x][1][0] = std::min(&#123; g[1][0] + f[i][0][1] + 4, g[1][1] + f[i][0][0] + 2, g[0][0] + f[i][1][0] + 3, g[0][1] + f[i][1][1] + 1 &#125;);\n                f[x][1][1] = std::min(&#123; g[1][1] + f[i][0][1] + 4, g[1][0] + f[i][0][0] + 2, g[0][1] + f[i][1][0] + 3, g[0][0] + f[i][1][1] + 1 &#125;);\n                f[x][2][0] = std::min(&#123; g[2][0] + f[i][0][1] + 4, g[2][1] + f[i][0][0] + 2, g[1][0] + f[i][1][1], g[1][1] + f[i][1][0] + 2, g[0][0] + f[i][2][1] + 4, g[0][1] + f[i][2][0] + 2 &#125;);\n                f[x][2][1] = std::min(&#123; g[2][1] + f[i][0][1] + 4, g[2][0] + f[i][0][0] + 2, g[1][1] + f[i][1][1], g[1][0] + f[i][1][0] + 2, g[0][1] + f[i][2][1] + 4, g[0][0] + f[i][2][0] + 2 &#125;);\n            &#125;\n        f[x][1][0] = std::min(f[x][1][0], f[x][0][1] + 1);\n        f[x][1][1] = std::min(f[x][1][1], f[x][0][0] + 1);\n        f[x][2][0] = std::min(f[x][2][0], f[x][1][0]);\n        f[x][2][1] = std::min(f[x][2][1], f[x][1][1]);\n        // for (int i = 0; i &lt; 3; ++i)\n        //     for (int j = 0; j &lt; 2; ++j)\n        //         printf(&quot;f[%d][%d][%d] = %d\\n&quot;, x, i, j, f[x][i][j]);\n        return;\n    &#125;;\n    DFS(rt, -1);\n    std::cout &lt;&lt; f[rt][2][1] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---one-to-one\">B - One to One</h2>\n<p><a href=\"https://atcoder.jp/contests/arc140/tasks/arc140_d\" class=\"uri\">https://atcoder.jp/contests/arc140/tasks/arc140_d</a></p>\n<p>è§‚å¯ŸåŸå›¾ä¸Šè¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯æ²¡æœ‰æœªç¡®å®šè¾¹çš„åŸºç¯æ ‘ï¼Œè¦ä¹ˆæ˜¯æœ‰æ°å¥½ä¸€æ¡æœªç¡®å®šè¾¹çš„æ ‘ã€‚ç¼©ç‚¹ï¼Œä»»æ„ä¸ºæœªç¡®å®šè¾¹èµ‹å€¼ï¼Œè€ƒå¯Ÿæœ€åå¾—åˆ°çš„è¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯ä»¥ã€åŸºç¯æ ‘ç‚¹ã€ä¸ºæ ¹çš„æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸åŒ…å«ã€åŸºç¯æ ‘ç‚¹ã€çš„ï¼ˆå†…å‘ï¼‰åŸºç¯æ ‘ã€‚</p>\n<p>è¿™é‡Œè¦ç”¨åˆ°è´¡çŒ®çš„æ€æƒ³ã€‚è€ƒè™‘å°†å…¨å±€åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œä¿è¯æ¯éƒ¨åˆ†çš„å•æ­¥ä»·å€¼æ˜¯å¯ç¡®å®šçš„ã€‚å°†ç¬¬ä¸€æ­¥ï¼Œå³å¯¹æ ‘å’ŒåŸºç¯æ ‘çš„è®¨è®ºæ‹†å¼€ï¼Œå¯¹äºæ ‘ï¼Œå…¶æ•°é‡ç¡®å®šï¼›å¯¹äºåŸºç¯æ ‘ï¼Œå‘ç°ç¯çš„æ•°é‡å³ä¸ºåŸºç¯æ ‘çš„æ•°é‡ï¼Œè¿›ä¸€æ­¥å°†æ‰€æœ‰æ­¥ä¸­çš„ã€ç¯ã€è¿™ä¸€ç±»åˆ†å¼€ï¼Œç»Ÿè®¡æˆç¯çš„æ–¹æ¡ˆæ•°å°±å¯ä»¥å¾—åˆ°åŸºç¯æ ‘çš„è´¡çŒ®ã€‚å…·ä½“åœ°ï¼Œä»¤ <span class=\"math inline\">\\(f_{i,j}\\)</span> ä¸ºåœ¨å‰ <span class=\"math inline\">\\(i\\)</span> ä¸ªç‚¹ä¸­é€‰æ‹© <span class=\"math inline\">\\(j\\)</span> ä¸ªæˆä¸€ä¸ªç¯çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š</p>\n<p><span class=\"math display\">\\[\nf_{i,j}=f_{i-1,j}+f_{i-1,j-1}\\times siz_i\n\\]</span></p>\n<p>æœ€åè®¡ç®—æ¯ä¸ªç¯çš„è´¡çŒ®å³å¯ã€‚æ³¨æ„è¿˜è¦ç®—ä¸Šç¯å†…éƒ¨çš„æ’åˆ—ï¼ˆæ³¨æ„å¾ªç¯ä½ç§»ï¼‰ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1), tag(n + 1), s(n + 1, 1), fa(n + 1), siz(n + 1);\n    std::iota(fa.begin() + 1, fa.end(), 1);\n    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;\n        return x == fa[x] ? x : fa[x] = find(fa[x]);\n    &#125;;\n    auto merge = [&amp;](int x, int y) &#123;\n        x = find(x), y = find(y);\n        if (x != y) &#123;\n            tag[y] += tag[x];\n            s[y] += s[x];\n            fa[x] = y;\n        &#125;\n        return;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)  &#123;\n        std::cin &gt;&gt; a[i], fa[i] = i;\n        if (a[i] == -1)\n            tag[i] = 1;\n        else\n            merge(i, a[i]);\n    &#125;\n    int cnt1 = 0, cnt2 = 0;\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        cnt1 += (fa[i] == i &amp;&amp; !tag[i]);\n        if (fa[i] == i &amp;&amp; tag[i])\n            siz[++cnt2] = s[i];\n    &#125;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    auto res(cnt1 * qkp(n, cnt2) % mod);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(cnt2 + 1, std::vector&lt;long long&gt; (cnt2 + 1));\n    f[0][0] = 1ll;\n    for (int i = 1; i &lt;= cnt2; ++i) &#123;\n        // printf(&quot;i = %d, siz = %d: \\n&quot;, i, siz[i]);\n        for (int j = 0; j &lt;= i; ++j) &#123;\n            f[i][j] = f[i - 1][j];\n            if (j != 0)\n                (f[i][j] += f[i - 1][j - 1] * siz[i]) %= mod;\n            // printf(&quot;  f[%d][%d] = %lld\\n&quot;, i, j, f[i][j]);\n        &#125;\n    &#125;\n    for (int i = 1; i &lt;= cnt2; ++i) &#123;\n        static auto fac(1ll);\n        (res += f[cnt2][i] * fac % mod * qkp(n, cnt2 - i) % mod) %= mod;\n        (fac *= i) %= mod;\n    &#125;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---diameter-cuts\">C - Diameter Cuts</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1499/F\" class=\"uri\">https://codeforces.com/problemset/problem/1499/F</a></p>\n<p>ä»¤ <span class=\"math inline\">\\(f_{x,i}\\)</span> è¡¨ç¤º <span class=\"math inline\">\\(x\\)</span> ä¸Šçš„æœ€é•¿é“¾é•¿ä¸º <span class=\"math inline\">\\(i\\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªç±»ä¼¼èƒŒåŒ…çš„è¿‡ç¨‹æ±‚ç­”æ¡ˆäº†ã€‚å‘ç°è¿™ä¸ªèƒŒåŒ…æ»¡è¶³å¯ä»¥è¢«ä¼˜åŒ–çš„å½¢å¼ï¼Œæ•…èƒ½åœ¨ <span class=\"math inline\">\\(O(nk)\\)</span> å†…è§£å†³é—®é¢˜ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, k;\n    std::cin &gt;&gt; n &gt;&gt; k, ++k;\n    if (k == 0) &#123;\n        std::cout &lt;&lt; 1 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; h(n + 1);\n    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (k + 1));\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        f[x][1] = 1ll, h[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                std::vector&lt;long long&gt; g(k + 1);\n                g.swap(f[x]);\n                for (int j = std::min(h[x], k); j; --j)\n                    for (int l = std::min(h[i], k - j); ~l; --l)\n                        (f[x][std::max(j, l + 1)] += g[j] * f[i][l] % mod) %= mod;\n                h[x] = std::max(h[x], h[i] + 1);\n            &#125;\n        for (int i = 1; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)\n            (f[x][0] += f[x][i]) %= mod;\n        // for (int i = 0; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)\n        //     printf(&quot;f[%d][%d] = %lld\\n&quot;, x, i, f[x][i]);\n        return;\n    &#125;;\n    DFS(1, -1);\n    auto res(0ll);\n    for (int i = 1; i &lt;= k; ++i)\n        (res += f[1][i]) %= mod;\n    std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---leaf-partition\">D - Leaf Partition</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1146/F\" class=\"uri\">https://codeforces.com/problemset/problem/1146/F</a></p>\n<p>å‡è®¾å·²ç»å®Œæˆåˆ†ç»„ï¼Œæ¬²åˆ¤å®šè¿™ç§æ–¹å¼æ˜¯å¦åˆæ³•ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ¯ä¸€ç»„å¶å­å»ºç«‹è™šæ ‘ï¼Œåˆ™è¯¥åˆ†ç»„æ–¹å¼åˆæ³•ï¼Œå½“ä¸”ä»…å½“æ²¡æœ‰ä¸€ä¸ªç‚¹è¢«å¤šä¸ªè™šæ ‘å ç”¨ã€‚ä¹Ÿå³ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ€»çš„è™šæ ‘ä¸Šé€‰å‡ºä¸€äº›ç‚¹ï¼Œè®©å®ƒä»¬å¯ä»¥è¦†ç›–æ‰€æœ‰å¶å­ã€‚</p>\n<p>è™šæ ‘ä¸Š DPï¼Œå®¹æ˜“å‘ç°å½“ä¸”ä»…å½“å­˜åœ¨ <span class=\"math inline\">\\(\\ge 2\\)</span> ä¸ªå„¿å­æƒ³è¦åˆ†è¿›åŒä¸€ä¸ªè™šæ ‘æ—¶ï¼Œ<span class=\"math inline\">\\(i\\)</span> ä¼šè¢«é€‰åˆ°ã€‚æ•…ä»¤ <span class=\"math inline\">\\(f_{i, 0/1/2}\\)</span> è¡¨ç¤ºå½“å‰æœ‰ <span class=\"math inline\">\\(0/1/\\ge 2\\)</span> ä¸ªå„¿å­æƒ³è¦é€‰æ‹© <span class=\"math inline\">\\(i\\)</span> æ—¶çš„æ–¹æ¡ˆæ•°ï¼ŒDP å³å¯ã€‚</p>\n<p>åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç°æ ¹æœ¬ä¸éœ€è¦æ±‚è™šæ ‘ï¼ŒåŸæ ‘ä¸Š DP å°±å¯ä»¥äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; fa(n + 1);\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 2; i &lt;= n; ++i)\n        std::cin &gt;&gt; fa[i], g[fa[i]].push_back(i);\n    std::vector&lt;std::array&lt;long long, 3&gt; &gt; f(n + 1);\n    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;\n        if (g[x].empty())\n            f[x][2] = 1ll;\n        else\n            f[x][0] = 1ll;\n        for (auto i : g[x]) &#123;\n            DFS(i);\n            auto F0 = (f[i][0] + f[i][2]) % mod, F1 = (f[i][1] + f[i][2]) % mod;\n            f[x][2] = (f[x][2] * F0 % mod + f[x][2] * F1 % mod + f[x][1] * F1 % mod) % mod;\n            f[x][1] = (f[x][1] * F0 % mod + f[x][0] * F1 % mod) % mod;\n            (f[x][0] *= F0) %= mod;\n        &#125;\n        // printf(&quot;%d: %lld / %lld / %lld\\n&quot;, x, f[x][0], f[x][1], f[x][2]);\n        return;\n    &#125;;\n    DFS(1);\n    std::cout &lt;&lt; (f[1][0] + f[1][2]) % mod &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---uniformly-branched-trees\">E - Uniformly Branched Trees</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/724/F\" class=\"uri\">https://codeforces.com/problemset/problem/724/F</a></p>\n<p>æ„Ÿè§‰æ˜¯å¾ˆå¸¸è§çš„å¥—è·¯ï¼Œä½†æ˜¯æˆ‘ä¸ä¼š ğŸ˜±</p>\n<p>åœ¨æ‰‹ç©æ ·ä¾‹çš„æ—¶å€™å¯ä»¥æ„Ÿæ€§è®¤çŸ¥åˆ°ï¼Œæ¯ä¸ªæ ‘ä¼šè¢«æ¯ç§ç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µç»Ÿè®¡ä¸€æ¬¡ã€‚ä¸”å¦‚æœå›ºå®šä»¥æŸç§ï¼ˆåŒ–å­¦ç¯å¢ƒï¼‰çš„ç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥é€šè¿‡æŒ‰ siz ä»å°åˆ°å¤§æ’åˆ—å”¯ä¸€æ±‚è§£å‡ºè¯¥æ ‘ã€‚</p>\n<p>å‘ç°ä»¥é‡å¿ƒä¸ºæ ¹ï¼ˆå³é’¦å®šæ ¹ä¸ºé‡å¿ƒï¼‰å¯ä»¥å¸¦æ¥å¾ˆå¤šä¼˜ç¾çš„æ€§è´¨ã€‚å› ä¸º siz æ˜¯å¥½ç¡®å®šçš„ï¼Œä¸”æ˜¯å„¿å­çš„æ’åºä¾æ®ï¼Œæ‰€ä»¥é€‰é‡å¿ƒä¾¿äºç»Ÿè®¡ï¼ŒåŒæ—¶æ»¡è¶³æ¯ç§æ ‘æœ€å¤šè¢«ç»Ÿè®¡ä¸¤æ¬¡ï¼ˆå½“ä¸”ä»…å½“æœ‰ä¸¤ä¸ªé‡å¿ƒï¼‰ã€‚</p>\n<p>å‘ç°è¿™å°±å˜æˆäº†å¤šé‡é›†çš„ç»„åˆæ•°ï¼Œè®¾ <span class=\"math inline\">\\(f_{i,j,k}\\)</span> è¡¨ç¤ºå·²ç»èŠ±è´¹ <span class=\"math inline\">\\(i\\)</span> ä¸ªç‚¹ç»„æˆä¸€ä¸ªå­æ ‘ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹å½“å‰å·²ç»ç¡®è®¤äº† <span class=\"math inline\">\\(j\\)</span> ä¸ªå„¿å­ï¼Œæœ€é å³çš„ä¸€ä¸ª siz <span class=\"math inline\">\\(\\le k\\)</span> çš„æ–¹æ¡ˆæ•°ã€‚å¾—åˆ° <span class=\"math inline\">\\(f_{i,j,k}=\\sum_{x=0} f_{i-x\\cdot k,j-x,k-1}\\cdot \\binom{f_{k,d-1,k}+x-1}{x}\\)</span>ï¼ˆç›¸å½“äºå°† <span class=\"math inline\">\\(x\\)</span> ä¸ªæ— æ ‡å·çš„ä½ç½® / çƒåˆ†é…ç»™ <span class=\"math inline\">\\(f_{k,d-1,k}\\)</span> ä¸ªæœ‰æ ‡å·çš„é€‰é¡¹ / ç›’å­ï¼Œæ’æ¿å³å¯ï¼‰ã€‚</p>\n<p>è‹¥ <span class=\"math inline\">\\(n\\)</span> ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ç›´æ¥è¾“å‡º <span class=\"math inline\">\\(f_{n,d,\\lfloor\\frac n2\\rfloor}\\)</span>ï¼›è‹¥ <span class=\"math inline\">\\(n\\)</span> ä¸ºå¶æ•°ï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸¤ä¸ªé‡å¿ƒï¼Œå³éœ€è¦ç»Ÿè®¡æ‹¥æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸”ä»¥ä¸¤ä¸ªé‡å¿ƒåˆ†åˆ«ä¸ºæ ¹æ—¶é•¿ç›¸ä¸åŒçš„æ ‘ç§ç±»ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¾ç„¶å­˜åœ¨ä¸€æ¡è¾¹ï¼Œå·¦å³ä¸¤è¾¹ siz ç›¸åŒä¸”é•¿ç›¸ä¸åŒã€‚æ•…æ•°é‡ä¸º <span class=\"math inline\">\\(\\binom{f_{\\lfloor \\frac n2\\rfloor, d-1,\\lfloor \\frac n2\\rfloor}}{2}\\)</span>ï¼Œå®¹æ–¥æ‰å³å¯ã€‚</p>\n<p>éœ€è¦ç‰¹åˆ¤ <span class=\"math inline\">\\(n\\le2\\)</span> çš„æƒ…å†µã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, d, mod;\n    std::cin &gt;&gt; n &gt;&gt; d &gt;&gt; mod;\n    if (n &lt;= 2) &#123;\n        std::cout &lt;&lt; 1 &lt;&lt; &#39;\\n&#39;;\n        return 0;\n    &#125;\n    using arr = std::vector&lt;long long&gt;;\n    using brr = std::vector&lt;arr&gt;;\n    using crr = std::vector&lt;brr&gt;;\n    auto qkp = [&amp;](long long x, int y) &#123;\n        auto res(1ll);\n        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)\n            if (y &amp; 1)\n                (res *= x) %= mod;\n        return res;\n    &#125;;\n    arr inv(d + 1);\n    inv[0] = inv[1] = 1ll;\n    auto fac = 1ll;\n    for (int i = 2; i &lt;= d; ++i) &#123;\n        (fac *= i) %= mod;\n        inv[i] = qkp(fac, mod - 2);\n    &#125;\n    auto C = [&amp;](long long n, int m) &#123;\n        if (m == 0)\n            return 1ll;\n        if (m &gt; n)\n            return 0ll;\n        auto res(1ll);\n        for (auto i = 0; i &lt; m; ++i)\n            (res *= n - i) %= mod;\n        return res * inv[m] % mod;\n    &#125;;\n    crr f(n + 1, brr(d + 1, arr(n / 2 + 1)));\n    f[1][0][0] = 1ll;\n    for (int i = 1; i &lt;= n; ++i)\n        for (int j = 0; j &lt;= d &amp;&amp; 1 + j &lt;= i; ++j) &#123;\n            for (int x = 0; x &lt;= j &amp;&amp; x &lt;= i; ++x)\n                f[i][j][1] += f[i - x][j - x][0];\n            f[i][j][1] %= mod;\n            for (int k = 2; k &lt;= n / 2; ++k) &#123;\n                // bool flag = (i == 10 &amp;&amp; j == 3 &amp;&amp; k == 3);\n                for (int x = 0; x &lt;= j &amp;&amp; x * k &lt;= i; ++x) &#123;\n                    f[i][j][k] += f[i - x * k][j - x][k - 1] * C(f[k][d - 1][k - 1] + x - 1, x);\n                    // if (flag)\n                    //     printf(&quot;x = %d, f[%d][%d][%d](%lld) * C(%lld, %d)(%lld)\\n&quot;, x, i - x * k, j - x, k - 1, f[i - x * k][j - x][k - 1], f[k][d - 1][k - 1] + x - 1, x, C(f[k][d - 1][k - 1] + x - 1, x));\n                &#125;\n                f[i][j][k] %= mod;\n            &#125;\n        &#125;\n    // for (int i = 1; i &lt;= n; ++i)\n    //     for (int j = 0; j &lt;= d &amp;&amp; j &lt;= i - 1; ++j, puts(&quot;&quot;))\n    //         for (int k = 0; k &lt;= n / 2; ++k) &#123;\n    //             printf(&quot;f[%d][%d][%d] = %lld\\n&quot;, i, j, k, f[i][j][k]);\n    //         &#125;\n    if (n &amp; 1)\n        std::cout &lt;&lt; f[n][d][n / 2] &lt;&lt; &#39;\\n&#39;;\n    else &#123;\n        auto res(f[n][d][n / 2]);\n        res = (res + mod - C(f[n / 2][d - 1][n / 2 - 1], 2)) % mod;\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"a---dominant-indices\">A - Dominant Indices</h2>\n<p><a href=\"https://codeforces.com/problemset/problem/1009/F\" class=\"uri\">https://codeforces.com/problemset/problem/1009/F</a></p>\n<p>é•¿å‰–æ¿å­ï¼›éš¾ç‚¹åœ¨äºå¯èƒ½è¦å¤ä¹ ä¸€ä¸‹é•¿å‰–æ€ä¹ˆå†™ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; h(n + 1), son(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        h[x] = 1;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                h[x] = std::max(h[x], h[i] + 1);\n                if (h[i] &gt; h[son[x]])\n                    son[x] = i;\n            &#125;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::vector&lt;int&gt; _f(2 * n + 1), res(n + 1);\n    auto pos(_f.begin());\n    std::vector&lt;decltype(pos)&gt; f(n + 1);\n    DFS = [&amp;](int x, int fa) &#123;\n        ++f[x][0];\n        if (!son[x]) &#123;\n            res[x] = 0;\n            return;\n        &#125;\n        f[son[x]] = std::next(f[x]);\n        DFS(son[x], x);\n        int mx = -std::max(std::make_pair(f[x][res[son[x]] + 1], -(res[son[x]] + 1)), std::make_pair(1, 0)).second;\n        for (auto i : g[x])\n            if (i != fa &amp;&amp; i != son[x]) &#123;\n                f[i] = pos, pos = std::next(pos, h[i] + 1);\n                DFS(i, x);\n                for (int j = 0; j &lt;= h[i]; ++j) &#123;\n                    f[x][j + 1] += f[i][j];\n                    if (j + 1 != mx &amp;&amp; std::make_pair(f[x][j + 1], -(j + 1)) &gt; std::make_pair(f[x][mx], -mx))\n                        mx = j + 1;\n                &#125;\n            &#125;\n        // printf(&quot;%d: &quot;, x);\n        // for (int i = 0; i &lt;= h[x]; ++i)\n        //     printf(&quot;%d &quot;, f[x][i]);\n        // puts(&quot;&quot;);\n        res[x] = mx;\n        return;\n    &#125;;\n    f[1] = pos, pos = std::next(pos, h[1]);\n    DFS(1, -1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"b---æ ‘ä¸Šå¼‚æˆ–\">B - æ ‘ä¸Šå¼‚æˆ–</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P9745\" class=\"uri\">https://www.luogu.com.cn/problem/P9745</a></p>\n<p>å’Œ <a href=\"#a---svjetlo\">Svjetlo</a> å¾ˆåƒï¼ŒæŠŠè¿é€šå—çš„å¼‚æˆ–å’Œæ”¾åˆ°çŠ¶æ€é‡Œï¼Œæ‹†ä½åä»¤ <span class=\"math inline\">\\(f_{i,j,0/1}\\)</span> è¡¨ç¤ºç‚¹ <span class=\"math inline\">\\(i\\)</span> æ‰€åœ¨çš„è¿é€šå—åœ¨ç¬¬ <span class=\"math inline\">\\(j\\)</span> ä½å¼‚æˆ–å’Œä¸º <span class=\"math inline\">\\(0/1\\)</span> çš„æƒå€¼ï¼ˆ<strong>ä¸è®¡ <span class=\"math inline\">\\(i\\)</span> æ‰€åœ¨è¿é€šå—</strong>ï¼‰ï¼Œè½¬ç§»å³å¯ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;long long&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i)\n        std::cin &gt;&gt; a[i];\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 2, x; i &lt;= n; ++i) &#123;\n        std::cin &gt;&gt; x;\n        g[x].push_back(i), g[i].push_back(x);\n    &#125;\n    std::vector&lt;long long&gt; dp(n + 1);\n    std::vector&lt;std::array&lt;std::array&lt;long long, 2&gt;, 60&gt; &gt; f(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        for (int i = 0; i &lt; 60; ++i)\n            f[x][i][(a[x] &gt;&gt; i) &amp; 1] = 1ll;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                for (int j = 0; j &lt; 60; ++j) &#123;\n                    auto f1 = f[x][j];\n                    f[x][j][0] = (f1[0] * dp[i] % mod + f1[0] * f[i][j][0] % mod + f1[1] * f[i][j][1] % mod) % mod;\n                    f[x][j][1] = (f1[1] * dp[i] % mod + f1[0] * f[i][j][1] % mod + f1[1] * f[i][j][0] % mod) % mod;\n                &#125;\n            &#125;\n        for (int i = 0; i &lt; 60; ++i)\n            dp[x] += (1ll &lt;&lt; i) % mod * f[x][i][1] % mod;\n        dp[x] %= mod;\n        return;\n    &#125;;\n    DFS(1, -1);\n    std::cout &lt;&lt; dp[1] &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"c---ä¸€ä¸ªç½‘çš„è·¯\">C - ä¸€ä¸ªç½‘çš„è·¯</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P8595\" class=\"uri\">https://www.luogu.com.cn/problem/P8595</a></p>\n<p>é¦–å…ˆéœ€è¦æ„è¯†åˆ°ï¼Œæ ‘å’Œé“¾çš„è¾¹æ•°æ˜¯ä¸€æ ·çš„ï¼Œç‚¸æ‰äº†å¤šå°‘æ¡è¾¹ï¼Œåœ¨ä¹‹åå°±ä¼šèŠ±å¤šå°‘ä»£ä»·è¡¥å›æ¥ã€‚æ•…ç‚¸ä¸€ä¸ªç‚¹çš„ä»£ä»·ä¸ºåº¦æ•° +1ã€‚å¯¹äºä¸€ä¸ªç‚¹ <span class=\"math inline\">\\(u\\)</span>ï¼Œåˆ†ä¸ºå››ç§å¯èƒ½æ€§ï¼š</p>\n<ul>\n<li>è¢«ç‚¸äº†ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿é€šå—ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œå„¿å­å…¨éƒ¨è¢«ç‚¸äº†ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 1 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li>\n<li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 2 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li>\n</ul>\n<p>åˆ†åˆ«ç”¨ <span class=\"math inline\">\\(f_{u,0/1/2/3}\\)</span> ä»£è¡¨ä¸Šé¢å››ç§å¯èƒ½æ€§ï¼Œè½¬ç§»å³å¯ã€‚</p>\n<p>è´ºäº†ä¸ª freadï¼Œæ“¦è¾¹è·‘è¿‡äº†ã€‚è¿™ä¸ªä¸æ˜¯ <span class=\"math inline\">\\(O(n)\\)</span> çš„å—ï¼Ÿ</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int LEN = (1 &lt;&lt; 20);\n#ifdef ONLINE_JUDGE\nint nec(void) &#123;\n    static char buf[LEN], *p = buf, *e = buf;\n    if (p == e) &#123;\n        e = buf + fread(buf, 1, LEN, stdin);\n        if (e == buf) return EOF;\n        p = buf;\n    &#125;\n    return *p++;\n&#125;\n#else\n#define nec getchar\n\n#endif\nbool read(int &amp;x) &#123;\n    x = 0;\n    bool f = 0;\n    char ch = nec();\n    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;\n        if (ch == EOF) return 0;\n        if (ch == &#39;-&#39;) f = 1;\n        ch = nec();\n    &#125;\n    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;\n        x = x * 10 + ch - &#39;0&#39;;\n        ch = nec();\n    &#125;\n    if (f) x = -x;\n    return 1;\n&#125;\nvoid print(int x) &#123;\n    if (x &lt; 0)\n        putchar(&#39;-&#39;), x = -x;\n    if (x &gt;= 10) print(x / 10);\n    putchar(x % 10 + &#39;0&#39;);\n    return;\n&#125;\nvoid print(int x, char ch) &#123;\n    print(x), putchar(ch);\n    return;\n&#125;\nint main() &#123;\n    int n, m;\n    read(n), read(m);\n    int res = (n - 1) - m;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int x, y; m--; ) &#123;\n        read(x), read(y);\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    std::vector&lt;int&gt; tag(n + 1);\n    std::vector&lt;std::array&lt;int, 4&gt; &gt; f(n + 1);\n    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n        tag[x] = 1;\n        f[x][0] = (fa != -1) + 1;\n        f[x][2] = f[x][3] = 0x3f3f3f3f;\n        for (auto i : g[x])\n            if (i != fa) &#123;\n                DFS(i, x);\n                f[x][3] = std::min(f[x][3] + f[i][0], f[x][2] + std::min(f[i][1], f[i][2]));\n                f[x][2] = std::min(f[x][2] + f[i][0], f[x][1] + std::min(f[i][1], f[i][2]));\n                f[x][1] += f[i][0];\n                f[x][0] += std::min(&#123; f[i][0] - 1, f[i][1], f[i][2], f[i][3] &#125;) + 1;\n            &#125;\n        return;\n    &#125;;\n    for (int i = 1; i &lt;= n; ++i)\n        if (!tag[i]) &#123;\n            DFS(i, -1);\n            res += *std::min_element(f[i].begin(), f[i].end());\n        &#125;\n    print(res, &#39;\\n&#39;);\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"d---éšæœºæ ‘\">D - éšæœºæ ‘</h2>\n<p><a href=\"https://www.luogu.com.cn/problem/P3830\" class=\"uri\">https://www.luogu.com.cn/problem/P3830</a></p>\n<p>å¯¹äºç¬¬ä¸€é—®ï¼Œä»¤ <span class=\"math inline\">\\(f_x\\)</span> è¡¨ç¤ºå…±æœ‰ <span class=\"math inline\">\\(x\\)</span> ä¸ªå¶å­æ—¶çš„æœŸæœ›æ·±åº¦ï¼Œä¸¤ä¸ªæ–°å¶å­çš„æœŸæœ›æ·±åº¦ä¸º <span class=\"math inline\">\\(f_{x-1}+1\\)</span>ï¼Œdelta ä¸º <span class=\"math inline\">\\(f_{x-1}+2\\)</span>ï¼Œæ•…æœ‰ <span class=\"math inline\">\\(f_x=\\dfrac {(x-1)f_{x-1}+f_{x-1}+2}x\\)</span>ï¼Œé€’æ¨å³å¯ã€‚</p>\n<p>å¯¹äºç¬¬äºŒé—®ï¼Œä»¤ <span class=\"math inline\">\\(f_{x,k}\\)</span> è¡¨ç¤ºæœ‰ <span class=\"math inline\">\\(x\\)</span> ä¸ªå¶å­ï¼Œæ·±åº¦ <span class=\"math inline\">\\(\\ge k\\)</span> çš„æ¦‚ç‡ï¼ˆä¸€ç§ç†è§£æ˜¯ä»æ•´æ•°æ¦‚ç‡å…¬å¼çš„è§’åº¦å‡ºå‘ï¼‰ã€‚åˆ™è€ƒè™‘æšä¸¾å·¦ã€å³å¶å­æ•°ï¼Œå¯¹äºå·¦ä¾§å¶å­æ•°ä¸º <span class=\"math inline\">\\(i\\)</span> çš„æƒ…å†µï¼Œ<strong>ä¸ºäº†å»é‡ï¼Œåªé€‰æ‹©æ·±åº¦ä¸º <span class=\"math inline\">\\(k-1\\)</span> çš„å¶å­å±•å¼€</strong>ã€‚åªè€ƒè™‘æŸç§ç»„åˆçš„å‡ºç°æ¦‚ç‡ï¼Œä¸º <span class=\"math inline\">\\(f_{i,k-1}+f_{x-i,k-1}-f_{i,k-1}\\cdot f_{x-i,k-1}\\)</span>ã€‚æ•°å½’å¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»æ„ <span class=\"math inline\">\\(i\\)</span>ï¼Œæ·±åº¦ä¸º <span class=\"math inline\">\\(k-1\\)</span> çš„å¶å­è¢«é€‰ä¸­çš„æ¦‚ç‡å‡ä¸º <span class=\"math inline\">\\(\\dfrac 1{x-1}\\)</span>ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int q, n;\n    std::cin &gt;&gt; q &gt;&gt; n;\n    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(6);\n    if (q == 1) &#123;\n        std::vector&lt;double&gt; f(n + 1);\n        for (int i = 2; i &lt;= n; ++i)\n            f[i] = (f[i - 1] * (i - 1) + f[i - 1] + 2.) / i;\n        std::cout &lt;&lt; f[n] &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    else &#123;\n        std::vector&lt;std::vector&lt;double&gt; &gt; f(n + 1, std::vector&lt;double&gt; (n + 1));\n        for (int i = 1; i &lt;= n; ++i) &#123;\n            f[i][0] = 1.;\n            for (int j = 1; j &lt; i; ++j) &#123;\n                auto s(0.);\n                for (int k = 1; k &lt; i; ++k)\n                    s += f[k][j - 1] + f[i - k][j - 1] - f[k][j - 1] * f[i - k][j - 1];\n                f[i][j] = s / (i - 1);\n            &#125;\n        &#125;\n        auto res(0.);\n        for (int i = 1; i &lt; n; ++i)\n            res += f[n][i];\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"e---complete-compress\">E - Complete Compress</h2>\n<p><a href=\"https://atcoder.jp/contests/agc034/tasks/agc034_e\" class=\"uri\">https://atcoder.jp/contests/agc034/tasks/agc034_e</a></p>\n<p>å¯¹äºé“¾ï¼Œå‘ç°å¯ä»¥æšä¸¾æœ€åèšé›†çš„ç‚¹ï¼Œç­”æ¡ˆä¸é…å¯¹æ–¹å¼æ— å…³ï¼Œcheck æ˜¯å¦èƒ½é…å¯¹å³å¯ã€‚</p>\n<p>å¦‚æœä¸æ˜¯é“¾ï¼Œåˆ™ç›¸æ¯”é“¾ï¼Œè¿˜å¯ä»¥é€‰æ‹©åŒä¸€å­æ ‘ä¸­ä¸å­˜åœ¨ç¥–å­™å…³ç³»çš„ä¸¤ä¸ªç‚¹ï¼Œå°†å®ƒä»¬éƒ½å‘ LCA ç§»ä¸€æ­¥ã€‚</p>\n<p>æ•…è€Œï¼Œå¯ä»¥åœ¨é“¾çš„åšæ³•ä¸Šæ‰“ä¸€ä¸ªè¡¥ä¸ï¼Œè§‚å¯Ÿåˆ°å…ˆã€å†…éƒ¨æ¶ˆåŒ–ã€ï¼Œå†åœ¨å­æ ‘é—´é…å¯¹ä¸€å®šä¸åŠ£ï¼Œä¸”ç­”æ¡ˆä»ç„¶å’Œé…å¯¹æ–¹å¼æ— å…³ã€‚æ•…ä»¤ <span class=\"math inline\">\\(f_x\\)</span> è¡¨ç¤ºç‚¹ <span class=\"math inline\">\\(x\\)</span> å†…æœ€å¤šæ¶ˆæ‰å¤šå°‘å¯¹ï¼Œå°±å¯ä»¥ check äº†ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst long long inf = 1e18;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;line_02.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n;\n    std::cin &gt;&gt; n;\n    std::vector&lt;int&gt; a(n + 1);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        char t;\n        std::cin &gt;&gt; t;\n        a[i] = t - &#39;0&#39;;\n    &#125;\n    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);\n    for (int i = 1, x, y; i &lt; n; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].push_back(y), g[y].push_back(x);\n    &#125;\n    auto res(inf);\n    for (int i = 1; i &lt;= n; ++i) &#123;\n        std::vector&lt;int&gt; s(n + 1);\n        std::vector&lt;long long&gt; f(n + 1), cnt(n + 1);\n        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;\n            s[x] = a[x];\n            int son = 0;\n            auto sum(0ll);\n            for (auto i : g[x])\n                if (i != fa) &#123;\n                    DFS(i, x), s[x] += s[i];\n                    sum += cnt[i];\n                    if (cnt[i] &gt; cnt[son])\n                        son = i;\n                &#125;\n            if (son) &#123;\n                if (cnt[son] * 2 &lt;= sum)\n                    f[x] = sum / 2;\n                else\n                    f[x] = sum - cnt[son] + std::min(f[son], (cnt[son] - (sum - cnt[son])) / 2);\n            &#125;\n            cnt[x] = sum;\n            if (x != i)\n                cnt[x] += s[x];\n            return;\n        &#125;;\n        DFS(i, -1);\n        if (cnt[i] % 2 == 0 &amp;&amp; f[i] == cnt[i] / 2)\n            res = std::min(res, cnt[i] / 2);\n    &#125;\n    if (res == inf)\n        std::cout &lt;&lt; -1 &lt;&lt; &#39;\\n&#39;;\n    else\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "DP",
                "æ ‘å½¢ DP",
                "é•¿é“¾å‰–åˆ†"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250723/",
            "url": "https://xsc062.netlify.app/20250723/",
            "title": "vp è®°å½• edu 181",
            "date_published": "2025-07-23T07:06:07.000Z",
            "content_html": "<p>tzl å¤ªå¼ºäº†ï¼çœŸæŒšçš„è†œæ‹œ</p>\n<span id=\"more\"></span>\n<p>lhy å¤ªå¼ºäº†ï¼çœŸæŒšçš„è†œæ‹œ</p>\n<hr />\n<h2 id=\"e.-sets-of-complementary-sums\">E. Sets of Complementary Sums</h2>\n<p><a href=\"https://codeforces.com/contest/2125/problem/E\" class=\"uri\">https://codeforces.com/contest/2125/problem/E</a></p>\n<p>åˆ†æ‹†æ•°ã€å…¶å®æ˜¯ä¸ªä¸ç‰›çš„ä¸œè¥¿ï¼Œä½†æ˜¯å†™å‡äº† ğŸ˜…</p>\n<p>ä»¤é›†åˆå…ƒç´ å‡åºæ’åˆ—ä¸º <span class=\"math inline\">\\(b_{1\\sim n}\\)</span>ã€‚æ˜¾ç„¶æœ‰ç»“è®º <span class=\"math inline\">\\(\\sum b\\geqslant (n-1)(b_n+1)\\)</span>ï¼ŒåŒ–ä¸€ä¸‹å°±æœ‰ <span class=\"math inline\">\\(b_n\\geqslant \\left(\\sum\\limits_{i=1}^{n-1} b_n-b_i\\right)+(n-1)\\)</span>ã€‚å‘ç° RSH å–å€¼å¯¹ LSH æ— å½±å“ï¼ˆä»å–ç­‰å¼€å§‹ï¼ŒRSH ä¸å˜ï¼Œè‹¥ <span class=\"math inline\">\\(b_n\\gets b_n+1\\)</span>ï¼Œåªéœ€å°†æ¯ä¸ª <span class=\"math inline\">\\(b_i\\gets b_i+1\\)</span> å³å¯æ„é€ å‡ºä¸€ç»„è§£ï¼‰ï¼Œæ•…åªç”¨è€ƒè™‘ RSH çš„æ¯ç§å–å€¼ä¸‹çš„æ–¹æ¡ˆã€‚</p>\n<p>ç„¶åå°±å¯ä»¥åš <a href=\"/20250807/\">åˆ†æ‹†æ•°</a> äº†ã€‚å‘ç°ä¼š MLEï¼Œæ»šåŠ¨å³å¯ã€‚æ¯æ¬¡æš´åŠ› assign ä¼šå¾ˆæ…¢ï¼Œå¯ä»¥ç”¨ä¸€ç‚¹å·§æ€æ¸…ç©ºæ»šåŠ¨æ•°ç»„ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nconst int mod = 998244353;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int T;\n    for (std::cin &gt;&gt; T; T--; ) &#123;\n        long long n, m;\n        std::cin &gt;&gt; n &gt;&gt; m;\n        if (n * (n - 1) / 2 &gt; m) &#123;\n            std::cout &lt;&lt; 0 &lt;&lt; &#39;\\n&#39;;\n            continue;\n        &#125;\n        if (n == 1) &#123;\n            std::cout &lt;&lt; m &lt;&lt; &#39;\\n&#39;;\n            continue;\n        &#125;\n        --n;\n        std::vector&lt;std::vector&lt;long long&gt; &gt; f(2, std::vector &lt;long long&gt; (m + 1));\n        f[0][0] = 1ll;\n        for (int j = 1, at = 1; j &lt;= n; ++j, at ^= 1)\n            for (int i = 0; i &lt;= m; ++i) &#123;\n                if (i &lt; j)\n                    f[at][i] = 0;\n                else\n                    f[at][i] = (f[at ^ 1][i - j] + f[at][i - j]) % mod;\n            &#125;\n        auto res(0ll);\n        for (int i = 1; i &lt;= m - n; ++i)\n            (res += f[n &amp; 1][i] * (m - (i + n) + 1)) %= mod;\n        std::cout &lt;&lt; res &lt;&lt; &#39;\\n&#39;;\n    &#125;\n    return 0;\n&#125;</code></pre>\n</details>\n<hr />\n<h2 id=\"vp-è®°å½•\">vp è®°å½•</h2>\n<h3 id=\"a\">A</h3>\n<p>1:43 åˆ‡ã€‚æ‰“ <code>std::</code> è¿˜æ˜¯å¤ªè´¹æ—¶é—´äº†ã€‚</p>\n<h3 id=\"b\">B</h3>\n<p>5:46 åˆ‡ï¼Œçœ‹å®Œé¢˜æ²¡æƒ³åˆ° gcdï¼Œè¾“å‡ºçš„æ—¶å€™æƒ³åˆ°äº†ã€‚è¼èœã€‚</p>\n<h3 id=\"c\">C</h3>\n<p>11:23 åˆ‡ï¼ŒåŸå› æ˜¯å®¹æ–¥ç¬¦å·ä¹±å†™ã€‚</p>\n<h3 id=\"d\">D</h3>\n<p>24:21 åˆ‡ï¼Œä¸­é—´é‡æ„äº†ä¸€æ¬¡å¹¶ä¸”å‰ç¼€å’Œçš„éƒ¨åˆ†è€ƒè™‘å¾—æœ‰ç‚¹é—®é¢˜ã€‚ç»…å£«ï¼ˆ38:35ï¼‰é—®æˆ‘ä¸ºå•¥åšè¿™ä¹ˆå¿«ã€‚</p>\n<h3 id=\"e.0\">E.0</h3>\n<p>çœ‹äº†ä¸€çœ¼æ„Ÿè§‰ä¸å¤ªå¯åšã€‚quack è¯´ F æ¿æ¿ï¼Œæ•…è·³ã€‚</p>\n<h3 id=\"f\">F</h3>\n<p>01:13:41 è‰å®Œã€‚å¥‡æ€ªçš„ WQS äºŒåˆ†æ¿æ¿ã€‚åƒäº†ä¸€å‘ç½šæ—¶ï¼ŒåŸå› æ˜¯æ²¡äººåˆæ³•çš„æ—¶å€™è¦è¾“å‡º <span class=\"math inline\">\\(0\\)</span>ã€‚ä½†å’Œ maimai çš„ 30 å‘æ¯”èµ·æ¥è¿˜æ˜¯ç›¸å½¢è§ç»Œã€‚ç»…å£«è€ƒè™‘äº†è¿™ä¸ªï¼Œä½†æ˜¯æ²¡åˆ¤ç›®æ ‡ <span class=\"math inline\">\\(&lt;\\)</span> å½“å‰çš„æƒ…å†µé—æ†¾ 4 é¢˜ç¦»åœºã€‚</p>\n<p>åœºä¸‹çœ‹äº† Diagnosticsï¼Œå‘ç°å…¶å®ç¬¬äºŒå‘æœ‰ä¸ªåœ°æ–¹æ˜¯ RE äº†çš„ï¼ˆé•¿åº¦ä¸è¶³ <span class=\"math inline\">\\(6\\)</span> æˆ‘çš„ <code>*std::max_element</code> ä¼šé£èµ·æ¥ï¼‰ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥å°±æ˜¯ A äº†ã€‚</p>\n<h3 id=\"e.1\">E.1</h3>\n<p>çŒœåˆ°ç»“è®ºä¹‹åæ­¢æ­¥äºæ­¤ã€‚è¯•ç€æ‰“äº†åˆ†æ‹†æ•°ç„¶åï¼ˆå®é™…ä¸Šæ˜¯ï¼‰å†™æŒ‚äº†ï¼Œæ€€ç–‘è‡ªå·±ç»“è®ºå‡ºé”™ç›´åˆ° 5 é¢˜æ‹›ç¬‘ç¦»åœº ğŸ˜…</p>\n<h3 id=\"b.1\">B.1</h3>\n<p>å“ˆå“ˆ B çš„ gcd æ²¡å¼€ <code>long long</code> è¢« hack äº†ï¼Œrk55 to 6000+</p>\n",
            "tags": [
                "å·®åˆ†",
                "èƒŒåŒ…"
            ]
        },
        {
            "id": "https://xsc062.netlify.app/20250721/",
            "url": "https://xsc062.netlify.app/20250721/",
            "title": "è§£é¢˜æŠ¥å‘Š CF1804F Approximate Diameter",
            "date_published": "2025-07-21T14:00:00.000Z",
            "content_html": "<p>å”‰ç¡®å®æ²¡è§è¿‡è¿™ç§äºŒåˆ†å½¢å¼ã€‚</p>\n<span id=\"more\"></span>\n<hr />\n<p><a href=\"https://codeforces.com/problemset/problem/1804/F\" class=\"uri\">https://codeforces.com/problemset/problem/1804/F</a></p>\n<p>æ³¨æ„åˆ°è¿™ä¸ªèŒƒå›´åŸºæœ¬ä¸Šå°±æ˜¯ <a href=\"/20231117/#æ ‘çš„ç›´å¾„å›¾çš„ç›´å¾„\">å›¾ç›´å¾„çš„è¿™ä¸ªæ€§è´¨</a>ï¼Œä½†æ˜¯æˆ‘ä¸è®¤è¯† ğŸ˜…</p>\n<p>æ¯æ¬¡ä¿®æ”¹åšä¸€æ¬¡ BFS è¿‡äºæŠ½è±¡ï¼Œå‘ç°è¿™ä¸ªä¸Šç•Œå¤šäº†ä¸ª <span class=\"math inline\">\\(2\\)</span> çš„ç³»æ•°ï¼ŒæŠŠä¸»å…ƒæ¢æˆ <span class=\"math inline\">\\(d\\)</span> å¯ä»¥å¾—åˆ° <span class=\"math inline\">\\(d\\in[0.5s,2s]\\)</span>ã€‚æœ‰ä¸€ä¸ªå¾ˆç‰›çš„æ“ä½œï¼Œå‡è®¾åœ¨å½“å‰å›¾ä¸Šæ±‚å‡ºæ¥äº†ä¸€ä¸ª <span class=\"math inline\">\\(s&#39;\\)</span>ï¼Œæ˜¾ç„¶ä¸€ç›´åŠ è¾¹ï¼Œ<span class=\"math inline\">\\(2s\\)</span> è¿™ä¸ªä¸Šç•Œæ˜¯åœ¨å˜å°çš„ï¼Œä½†åªè¦ <span class=\"math inline\">\\(s&#39;\\le 2s\\)</span> æˆç«‹ï¼Œ<span class=\"math inline\">\\(s&#39;\\)</span> å°±ä¸€ç›´å¯ä»¥ä½œä¸ºåŒºé—´é‡Œçš„ä¸€ä¸ªä¼°å€¼ã€‚å¦‚æœä¸æˆç«‹ï¼Œå‘ç°é™¤ä»¥äºŒå°±æˆç«‹äº†ã€‚</p>\n<p>è½¬åŒ–æˆäºŒåˆ† <span class=\"math inline\">\\(s&#39;\\)</span> æœ€è¿œå¯ä»¥è¾¾åˆ°çš„è·ç¦»å³å¯ã€‚æ¯æ¬¡ <span class=\"math inline\">\\(s&#39;\\)</span> é™¤ä»¥äºŒï¼Œå…±é™¤äº† <span class=\"math inline\">\\(\\log n\\)</span> æ¬¡ï¼›å¤æ‚åº¦ <span class=\"math inline\">\\(O(n\\log^2 n)\\)</span>ã€‚</p>\n<p>ç„¶åæ³¨æ„ä¸è¦æ¯æ¬¡ check éƒ½å¤åˆ¶ä¸€éåŸæ•°ç»„ç„¶ååŠ è¾¹ï¼›åº”è¯¥é¢„å…ˆåœ¨åŸå›¾ä¸ŠåŠ å¥½æ‰€æœ‰è¾¹ï¼Œè®°å½•ç‰ˆæœ¬ã€‚åŸå› æ˜¯ç”³è¯·ç©ºé—´ç‰¹åˆ«è´¹æ—¶é—´ã€‚</p>\n<details>\n<pre class=\"cpp\"><code>#include &lt;bits/stdc++.h&gt;\nint main() &#123;\n#ifdef ONLINE_JUDGE\n    std::ios::sync_with_stdio(false);\n    std::cin.tie(nullptr), std::cout.tie(nullptr);\n#else\n    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);\n    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);\n#endif\n    int n, m, q;\n    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; q;\n    std::vector&lt;std::vector&lt;std::pair&lt;int, int&gt; &gt; &gt; g(n + 1);\n    for (int x, y; m--; ) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].emplace_back(y, 0), g[y].emplace_back(x, 0);\n    &#125;\n    for (int i = 1, x, y; i &lt;= q; ++i) &#123;\n        std::cin &gt;&gt; x &gt;&gt; y;\n        g[x].emplace_back(y, i), g[y].emplace_back(x, i);\n    &#125;\n    std::vector&lt;int&gt; mem(q + 1, -1);\n    auto calc = [&amp;](int id) &#123;\n        if (~mem[id])\n            return mem[id];\n        std::queue&lt;std::pair&lt;int, int&gt; &gt; q;\n        std::vector&lt;int&gt; tag(n + 1);\n        q.emplace(1, 0), tag[1] = 1;\n        int mx = 0;\n        for (; !q.empty(); ) &#123;\n            auto [x, w] = q.front();\n            q.pop(), mx = w;\n            for (auto [i, ver] : g[x])\n                if (ver &lt;= id &amp;&amp; !tag[i]) &#123;\n                    tag[i] = 1;\n                    q.emplace(i, w + 1);\n                &#125;\n        &#125;\n        return mem[id] = mx;\n    &#125;;\n    int s = calc(0);\n    for (int i = 0; i &lt;= q; ) &#123;\n        int j = i;\n        for (int l = i + 1, r = q, mid; l &lt;= r; ) &#123;\n            mid = (l + r) &gt;&gt; 1;\n            if (s &lt;= 2 * calc(mid))\n                j = mid, l = mid + 1;\n            else\n                r = mid - 1;\n        &#125;\n        for (; i &lt;= j; ++i)\n            std::cout &lt;&lt; s &lt;&lt; &#39; &#39;;\n        s /= 2;\n    &#125;\n    std::cout &lt;&lt; &#39;\\n&#39;;\n    return 0;\n&#125;</code></pre>\n</details>\n",
            "tags": [
                "äºŒåˆ†"
            ]
        }
    ]
}