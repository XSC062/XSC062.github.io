<!DOCTYPE html>
<html>
<head>
    <!-- ç½‘ç«™å›¾æ ‡ -->
<link rel="icon" type="image/png" sizes="32x32" href="/images/icon.svg">
<!-- å…¶ä»–å›¾æ ‡æ”¯æŒ -->
<link rel="stylesheet" href="/css/facss/fa-brands.min.css">
<link rel="stylesheet" href="/css/facss/fa-regular.min.css">
<link rel="stylesheet" href="/css/facss/fa-solid.min.css">
<link rel="stylesheet" href="/css/facss/fontawesome.min.css">
<link rel="stylesheet" href="/css/facss/fontawesome-all.css">
<link href="https://use.fontawesome.com/releases/v5.0.4/css/all.css" rel="stylesheet">
<!-- ç½‘ç«™æ ‡é¢˜ -->
<title>
	
		å­¦ä¹ ç¬”è®°ï¼šFWT -
	
	XSC062 çš„åšå®¢
</title>
<!-- js å¼•å…¥ -->

<script src="/js/afterloaded.js"></script>


<script src="/js/jQuery.js"></script>

<!-- è½½å…¥ Valine -->

<script src="/js/Valine.min.js"></script>

<!-- css å¼•å…¥ -->

<link rel="stylesheet" href="/css/layout.css">


<link rel="stylesheet" href="/css/prcss/prism.css">



<meta charset="utf-8"> 
<meta name="generator" content="Hexo 7.2.0"></head>
<body class="line-numbers match-braces no-brace-select rainbow-braces">
	
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            processEscapes: true
          }
        });
      </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
            tex2jax: {
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
          });
      </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
              var all = MathJax.Hub.getAllJax(), i;
              for(i=0; i < all.length; i += 1) {
                  all[i].SourceElement().parentNode.className += ' has-jax';
              }
          });
      </script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

	<!-- æœç´¢ -->
<div id="search-bg">
	<div id="search-box">
		<input type="text" id="search-input" placeholder="Type to search...">
		<div id="search-results"></div>
		<p>æ­å–œä½ è§¦å‘äº†è¿™ä¸ª boxï¼Œç”±äºæˆ‘è¿˜æ²¡æœ‰å†™å…³é—­é”®ï¼Œä½ åªèƒ½é€šè¿‡åˆ·æ–°é¡µé¢æ¥å…³é—­å®ƒã€‚éå¸¸æŠ±æ­‰ ;-)</p>
		<p>ä¸ºäº†è¯æ˜æˆ‘æ²¡æœ‰æ‘†çƒ‚ï¼Œåœ¨è¿™é‡Œæ”¾ä¸€ä¸ªè¿›åº¦ï¼š</p>
		<p>- 250715ï¼šå°è¯•å®ç°æœç´¢åŠŸèƒ½ï¼Œåˆæ­¥æˆåŠŸï¼Œèƒ½å¤Ÿæœç´¢åˆ°åŒ…å«å…³é”®è¯çš„æ–‡ç« äº†ï¼ˆä¹Ÿèƒ½å…³æ‰äº†ï¼‰ã€‚ä¸çŸ¥é“ä¸ºå•¥è¾“å…¥ 123 å¯ä»¥åŒ¹é…æ‰€æœ‰æ–‡ç« ï¼Œä½†æ˜¯è¾“å…¥ 1234 å°±ä¸€ç¯‡éƒ½åŒ¹é…ä¸ä¸Šã€‚</p>
		<p>- 250716ï¼šå°è¯•åŠ å…¥å…³é”®è¯ä¸Šä¸‹æ–‡æ¥ de ä¸Šé¢çš„ bugï¼Œç„¶åæŠŠ js å†™æˆå²äº†ï¼Œç°åœ¨è¿™ä¸ªæ¡†æ¡†å¹¶ä¸å…·å¤‡æœç´¢åŠŸèƒ½ï¼ˆä¹Ÿä¸å…·å¤‡å…³é—­åŠŸèƒ½ï¼‰ :-(</p>
	</div>
</div>
<!-- é¡¶æ æ•´ä½“å¯¼èˆªèœå• -->
<div class="ui top menu">
	<!-- å·¦å¯¹é½ logo -->
	<a class="logo" href="/">
		<img src="/images/icon.png"></img>
		<div id="bartitle">
			XSC062 çš„åšå®¢
		</div>
	</a>
	<!-- å³å¯¹é½éƒ¨åˆ†å¯¼èˆª -->
	<script>
		function toSearch() {
			// goto search.ejs
			$("#search-bg, #search-bg *").css("z-index", "1002"); 
			$("#search-bg, #search-bg *").css("opacity", "100%");
		}
	</script>
	<div id="rightali">
		<a class="item" id="Search" type="button" onclick="toSearch()">
			<i class="btn text-muted fa fa-search" id="search-icon" disabled></i>
		</a>
		<a class="item" id="Home" href="/">
			Home
		</a>
		<a class="item" id="Arch" href="/archives">
			Archives
		</a>
		<!-- <a class="item" id="Cate" href="/categories">
			Categories
		</a> -->
		<a class="item" id="Tags" href="/tags">
			Tags
		</a>
		<a class="item" id="Frie" href="/friends">
			Friends
		</a>
		<a class="item" id="Abou" href="/about">
			About
		</a>
	</div>
</div>
    
<link rel="stylesheet" href="/css/post.css">


<script src="/js/post.js"></script>


<div class="main">
	<div id="sidebar">
		<aside id="toc">
			<span id="toctitle">
				<i class="fas fa-list"></i>
				ç›®å½•
			</span>
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#emiya-%E5%AE%B6%E6%98%8E%E5%A4%A9%E7%9A%84%E9%A5%AD"><span class="toc-text">Emiya å®¶æ˜å¤©çš„é¥­</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nim-counting"><span class="toc-text">Nim Counting</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#binary-table"><span class="toc-text">Binary Table</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#hard-nim"><span class="toc-text">Hard Nim</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%90%E9%9B%86%E5%8D%B7%E7%A7%AF"><span class="toc-text">å­é›†å·ç§¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B7%9E%E5%8C%BA%E5%88%92%E5%88%86"><span class="toc-text">å·åŒºåˆ’åˆ†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b---sum-the-fibonacci"><span class="toc-text">B - Sum the Fibonacci</span></a></li></ol>
		</aside>
	</div>
	<div class="ui post container">
		<div class="ui text container">
			<span id="postcon">
				<span id="postinfo">
					<div class="ui post title">
						<div id="fortitle" data-content="å­¦ä¹ ç¬”è®°ï¼šFWT">
							å­¦ä¹ ç¬”è®°ï¼šFWT
						</div>
						<div class="ui title background">
						</div>
					</div>
					<span id="date">
						<i class="fas fa-calendar-alt" style="margin-right: 4px;"></i>
						2025-03-29
					</span>
				</span>
			</span>
			<div id="posttags" class="dotted border">
				
					
						<a href="/tags/é«˜ç»´å‰ç¼€å’Œ/" class="citem">é«˜ç»´å‰ç¼€å’Œ</a>
					
						<a href="/tags/FWT/" class="citem">FWT</a>
					
				
			</div>
			<!-- æœ¬æ¥ç”¨çš„æ˜¯ fromNow ç„¶åå­—ç¬¦ä¸²åˆ¤æ–­ï¼Œæ²¡æƒ³åˆ°å¯ä»¥ç›´æ¥è°ƒç”¨ moment() -->
			
			<div id="content">
				<p>æ´»äº†å“¥ä»¬ï¼Œå¤æ´»äº†ã€‚</p>
<span id="more"></span>
<hr />
<p>è€ƒè™‘ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ul>
<li>å¯¹äº <span class="math inline">\(\forall \,i\in U\)</span>ï¼Œæ±‚ <span class="math inline">\(c_i=\sum\limits_{j\cup k=i}a_j\cdot b_k\)</span>ã€‚</li>
</ul>
<p>å½“ç„¶è¿™é‡Œå¯ä»¥æŠŠé›†åˆçœ‹æˆäºŒè¿›åˆ¶çŠ¶æ€ï¼Œé‚£ä¹ˆå–å¹¶é›†å°±æ˜¯æŒ‰ä½æˆ–äº†ã€‚</p>
<p>å’•å’•å’•</p>
<hr />
<h2 id="emiya-å®¶æ˜å¤©çš„é¥­">Emiya å®¶æ˜å¤©çš„é¥­</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P10242" class="uri">https://www.luogu.com.cn/problem/P10242</a></p>
<p>å†·çŸ¥è¯†ï¼š<em>Emiya å®¶æ˜å¤©çš„é¥­</em> å’Œ <em>Emiya å®¶ä»Šå¤©çš„é¥­</em> æ‹¥æœ‰ç›¸åŒçš„éš¾åº¦è¯„çº§ <img src="/em/kt.gif" alt="ç£•å¤´" /></p>
<p>è€ƒè™‘æš´åŠ›çš„åšæ³•ï¼Œå¦‚æœæˆ‘ä»¬å…ˆé’¦å®šå¿…é¡»åˆ°è¾¾çš„äººï¼ˆè¿™æ˜¯ <span class="math inline">\(O(2^n)\)</span> çš„ï¼‰ï¼Œå†èŠ±è´¹ <span class="math inline">\(O(nm)\)</span> çš„æ—¶é—´ä¾æ¬¡åˆ¤å®šæ¯é“èœæ˜¯å¦å¯ä»¥è¢«é€‰æ‹©ï¼Œå°±å¯ä»¥ è§£å†³é—®é¢˜ã€‚ä½†å‘ç°æ—¶é—´æ˜¯ä¸èƒ½æ‰¿å—çš„ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©ä¼˜åŒ– <span class="math inline">\(O(nm)\)</span> çš„åˆ¤å®šã€‚</p>
<p>ç°åœ¨å·²çŸ¥äººå‘˜é›†åˆ <span class="math inline">\(s\)</span>ï¼Œå¯¹äºä¸€é“èœ <span class="math inline">\(i\)</span>ï¼Œè®¾å®ƒé€‚é…çš„äººå‘˜é›†åˆä¸º <span class="math inline">\(T_i\)</span>ï¼Œé‚£ä¹ˆæœ‰ <span class="math inline">\(s\subseteq T_i\)</span>ã€‚æ‰€æ±‚å³ä¸º <span class="math inline">\(\max\limits_s\{\sum\limits_{T_i\supseteq s}\sum\limits_{j\in s}a_{i,j}\}\)</span>ã€‚<span class="math inline">\(O(nm)\)</span> é¢„å¤„ç†å‡º <span class="math inline">\(f_j(u)=\sum\limits_{T_i=u}a_{j, i}\)</span>ï¼Œé‚£ä¹ˆå¾…æ±‚å³ä¸º <span class="math inline">\(\max\limits_{s}\{\sum\limits_{j\in s}\sum\limits_{u\supseteq s}f_j(u)\}\)</span>ï¼Œå‘ç°è¿™ä¸ªä¸œè¥¿å¯ä»¥ç”¨ FWT æ±‚ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m, k;
    std::cin &gt;&gt; k &gt;&gt; m, n = 1 &lt;&lt; k;
    using arr = std::vector&lt;long long&gt;;
    std::vector&lt;int&gt; t(m + 1);
    std::vector&lt;arr&gt; a(k + 1, arr(m + 1)), f(k + 1, arr(n));
    for (int i = 1; i &lt;= k; ++i)
        for (int j = 1; j &lt;= m; ++j) &#123;
            std::cin &gt;&gt; a[i][j];
            if (a[i][j] &gt;= 0)
                t[j] |= 1 &lt;&lt; (i - 1);
        &#125;
    for (int i = 1; i &lt;= k; ++i)
        for (int j = 1; j &lt;= m; ++j)
            if (a[i][j] &gt;= 0)
                f[i][t[j]] += a[i][j];
    &#123;
        std::vector&lt;arr&gt; mT(2, arr(2));
        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 0ll, mT[1][1] = 1ll;
        auto calc = [&amp;](arr a, arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;
            f = a;
            for (int len = 2; len &lt;= n; len &lt;&lt;= 1) &#123;
                for (int i = 0; i &lt; n; i += len)
                    for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)
                        std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);
            &#125;
            return;
        &#125;;
        for (int i = 1; i &lt;= k; ++i)
            calc(f[i], f[i], mT);
    &#125;
    long long res = 0ll;
    for (int s = 0; s &lt; n; ++s) &#123;
        long long sum = 0ll;
        for (int i = 1; i &lt;= k; ++i)
            if ((s &gt;&gt; (i - 1)) &amp; 1)
                sum += f[i][s];
        res = std::max(res, sum);
    &#125;
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="nim-counting">Nim Counting</h2>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc212/tasks/abc212_h" class="uri">https://atcoder.jp/contests/abc212/tasks/abc212_h</a></p>
<p>å³ï¼Œä» <span class="math inline">\(A_N\)</span> ä¸­æœ‰æ”¾å›åœ°é€‰æ‹© <span class="math inline">\(\le M\)</span> ä¸ªæ•°ï¼Œé—®å®ƒä»¬å¼‚æˆ–èµ·æ¥ä¸ä¸º <span class="math inline">\(0\)</span> çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>å¦‚æœä»¤ <span class="math inline">\(f_{i, j}\)</span> è¡¨ç¤ºé€‰äº† <span class="math inline">\(i\)</span> æ¬¡ï¼Œå¼‚æˆ–å’Œä¸º <span class="math inline">\(j\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œæ˜¾ç„¶ <span class="math inline">\(f_{1,i}=\sum [a_j=i]\)</span> ä¸ºå…³äº <span class="math inline">\(a\)</span> çš„æ¡¶ã€‚æ­¤æ—¶æœ‰ <span class="math inline">\(f_{i,j}=\sum\limits_{k=1}^n f_{i-1,j\oplus a_k}=\sum\limits_{k=0}^V f_{i-1,j\oplus k}\cdot f_{1,k}\)</span>ï¼Œå‘ç°æŠŠ <span class="math inline">\(f_1\)</span> è¿™ä¸ªæ¡¶åœ¨ <span class="math inline">\(f\)</span> ä¸Šåš <span class="math inline">\(N\)</span> æ¬¡ xor-FWT å°±å¯ä»¥å¾—åˆ° <span class="math inline">\(f_n\)</span>ã€‚</p>
<p>ä½†å¦‚æœç›´æ¥å· <span class="math inline">\(N\)</span> æ¬¡æ˜¯ <span class="math inline">\(O(N\cdot V\log V)\)</span> çš„ï¼Œä¸å¤ªç¾å¥½ï¼Œä½†æˆ‘ä»¬çœ‹çœ‹æˆ‘ä»¬å®é™…ä¸Šéœ€è¦åšä»€ä¹ˆï¼š</p>
<ol type="1">
<li>æ±‚ <span class="math inline">\(f_i\)</span> çš„ FWTã€‚</li>
<li>æ±‚åˆå§‹æ¡¶ <span class="math inline">\(f_1\)</span> çš„ FWTã€‚</li>
<li>å¯¹ä½ç›¸ä¹˜å¾—åˆ° <span class="math inline">\(f_{i+1}\)</span> çš„ FWTã€‚</li>
<li>é€šè¿‡ FWT æ±‚å¾—åŸæœ¬çš„ <span class="math inline">\(f_{i+1}\)</span>ã€‚</li>
</ol>
<p>å½“è¿™ä¸ªæ“ä½œè¢«æ”¾åœ¨ <span class="math inline">\(i=1\sim n\)</span> ä¸Šä¾æ¬¡è¿›è¡Œæ—¶ï¼Œæˆ‘ä»¬å‘ç°ç¬¬ä¸€æ­¥å’Œæœ€åä¸€æ­¥ä¼šç›¸äº’æŠµæ¶ˆï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡º <span class="math inline">\(f_1\)</span> çš„ FWTï¼Œ<span class="math inline">\(FWT_{i, j}(f)\)</span> å³ä¸º <span class="math inline">\(FWT_{1, j}(f)^i\)</span>ã€‚å› ä¸ºæˆ‘ä»¬è¦æ±‚çš„æ˜¯ <span class="math inline">\(\sum\limits_{i, j}f_{i,j}\)</span> å¯ä»¥é€šè¿‡ç­‰æ¯”æ•°åˆ—æ±‚å’Œæ±‚å‡º <span class="math inline">\(FWT_j(s)=\sum f_{i, j}\)</span>ã€‚ç”±å‰æ–‡æ¨å¯¼å¯çŸ¥ç›´æ¥åšä¸€æ¬¡é€†å˜æ¢æ±‚å¾— <span class="math inline">\(s_j\)</span> å³å¯ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    struct mint &#123;
        const int mod = 998244353;
        long long x;
        mint(): x(0ll) &#123;&#125;
        mint(long long x1): x((x1 + mod) % mod) &#123;&#125;
        mint&amp; operator= (const mint q) &#123;
            x = q.x;
            return *this;
        &#125;
        bool operator== (const mint q) const &#123;
            return x == q.x;
        &#125;
        mint operator* (const mint q) const &#123;
            return x * q.x % mod;
        &#125;
        mint&amp; operator*= (const mint q) &#123;
            return *this = *this * q;
        &#125;
        mint operator+ (const mint q) &#123;
            return (x + q.x) % mod;
        &#125;
        mint&amp; operator+= (const mint q) &#123;
            return *this = *this + q;
        &#125;
        mint operator- (const mint q) &#123;
            return (x + mod - q.x) % mod;
        &#125;
        mint qkp(int y) &#123;
            mint res(1ll), x(this-&gt;x);
            for (; y; y &gt;&gt;= 1, x *= x)
                if (y &amp; 1)
                    res *= x;
            return res;
        &#125;
        mint inv(void) &#123;
            return qkp(mod - 2);
        &#125;
    &#125;;
    int n, m, k = 16, l = 1 &lt;&lt; k;
    std::cin &gt;&gt; m &gt;&gt; n;
    using arr = std::vector&lt;mint&gt;;
    arr a(n + 1), c(l);
    for (int i = 1; i &lt;= n; ++i)
        std::cin &gt;&gt; a[i].x, c[a[i].x] += 1;
    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));
    mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = -1ll;
    mI[0][0] = mI[0][1] = mI[1][0] = mint(2ll).inv(), mI[1][1] = mint(-2ll).inv();
    auto calc = [&amp;](arr a, arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;
        f = a;
        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)
            for (int i = 0; i &lt; l; i += len)
                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);
        return;
    &#125;;
    calc(c, c, mT);
    arr s(l);
    for (int i = 0; i &lt; l; ++i)
        if (c[i] == 1ll)
            s[i] = m;
        else
            s[i] = c[i] * (mint(1ll) - c[i].qkp(m)) * (mint(1ll) - c[i]).inv();
    calc(s, s, mI);
    mint res;
    for (int i = 1; i &lt; l; ++i)
        res += s[i];
    std::cout &lt;&lt; res.x &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="binary-table">Binary Table</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/662/C" class="uri">https://codeforces.com/problemset/problem/662/C</a></p>
<p>å‘ç°è¿™ä¸ªé¢˜å’Œ <em>Emiya å®¶ä»Šå¤©çš„é¥­</em> å¾ˆåƒï¼Œéƒ½æ˜¯æœ‰ä¸€ä¸ªå¾ˆå°çš„ç»´å’Œä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒå¤§çš„ç»´ã€‚</p>
<p>æ˜¾ç„¶ï¼Œæˆ‘ä»¬æ‰€æœ‰çš„æ“ä½œé¡ºåºéƒ½å¯ä»¥ä»»æ„è°ƒæ¢ï¼›æœ´ç´ åœ°ï¼Œæˆ‘ä»¬æšä¸¾ <span class="math inline">\(2^n\)</span> ç§ç»™è¿™ <span class="math inline">\(n\)</span> è¡Œåè½¬çš„æƒ…å†µï¼›å†å¯¹äºæ¯ä¸€åˆ—ï¼Œ<span class="math inline">\(O(n)\)</span> é€‰æ‹©åº”è¯¥åè½¬è¿˜æ˜¯ä¸åè½¬ï¼Œè¿™æ ·æ€»å…±æ˜¯ <span class="math inline">\(O(2^n\cdot nm)\)</span> çš„ã€‚</p>
<p>å‘ç°æŠŠä¸€åˆ—åˆå§‹çŠ¶æ€å‹æˆä¸€ä¸ªäºŒè¿›åˆ¶æ•° <span class="math inline">\(a\)</span>ï¼Œå‡è®¾æˆ‘ä»¬ç°åœ¨æšä¸¾çš„è¡Œåè½¬çŠ¶æ€ä¸º <span class="math inline">\(s\)</span>ï¼Œæ˜¾ç„¶ç”¨ <span class="math inline">\(s\oplus a\)</span> å¯ä»¥å¾—åˆ°å½“å‰çŠ¶æ€ã€‚æ€ä¹ˆåˆ©ç”¨è¿™ä¸ªå» FWT å‘¢ï¼Ÿè¿™å¼•å¯¼æˆ‘ä»¬ä¾ç„¶æšä¸¾ <span class="math inline">\(s\)</span>ï¼Œç”¨ä¸€ä¸ªå’Œ <span class="math inline">\(s\oplus a\)</span> æœ‰å…³çš„é‡è·Ÿä¸€ä¸ªå’Œ <span class="math inline">\(a\)</span> æœ‰å…³çš„é‡ç›¸ä¹˜å¾—åˆ°å…³äº <span class="math inline">\(s\)</span> çš„ç­”æ¡ˆã€‚</p>
<p>å®¹æ˜“å‘ç°ä»¤ <span class="math inline">\(f_{s\oplus a}\)</span> è¡¨ç¤º <span class="math inline">\(s\oplus a\)</span> è¿™ä¸ªçŠ¶æ€åè½¬å’Œä¸åè½¬ä¸¤ä¸ªé€‰é¡¹ä¸­å¯ä»¥è·å–çš„æœ€å°‘ 1 çš„ä¸ªæ•°ï¼›å†ä»¤ <span class="math inline">\(c_s\)</span> è¡¨ç¤ºçŠ¶æ€ä¸º <span class="math inline">\(s\)</span> çš„åˆ—çš„ä¸ªæ•°ï¼Œé‚£ä¹ˆ <span class="math inline">\(\sum\limits_s c_s\times f_{s\oplus a}\)</span> å°±å¯ä»¥å¾—åˆ°æšä¸¾çš„åè½¬æ–¹æ¡ˆä¸º <span class="math inline">\(s\)</span> çš„ç­”æ¡ˆï¼Œæ±‚æœ€å°å³å¯ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    struct mint &#123;
        const int mod = 998244353;
        long long x;
        mint(): x(0ll) &#123;&#125;
        mint(long long x1): x((x1 + mod) % mod) &#123;&#125;
        mint&amp; operator= (const mint q) &#123;
            x = q.x;
            return *this;
        &#125;
        bool operator== (const mint q) const &#123;
            return x == q.x;
        &#125;
        mint operator* (const mint q) const &#123;
            return x * q.x % mod;
        &#125;
        mint&amp; operator*= (const mint q) &#123;
            return *this = *this * q;
        &#125;
        mint operator+ (const mint q) &#123;
            return (x + q.x) % mod;
        &#125;
        mint&amp; operator+= (const mint q) &#123;
            return *this = *this + q;
        &#125;
        mint operator- (const mint q) &#123;
            return (x + mod - q.x) % mod;
        &#125;
        mint qkp(int y) &#123;
            mint res(1ll), x(this-&gt;x);
            for (; y; y &gt;&gt;= 1, x *= x)
                if (y &amp; 1)
                    res *= x;
            return res;
        &#125;
        mint inv(void) &#123;
            return qkp(mod - 2);
        &#125;
    &#125;;
    int n, m, l;
    std::cin &gt;&gt; n &gt;&gt; m, l = 1 &lt;&lt; n;
    using arr = std::vector&lt;mint&gt;;
    arr c(l), f(l);
    std::vector&lt;std::vector&lt;char&gt; &gt; a(n + 1, std::vector&lt;char&gt; (m + 1));
    for (int i = 1; i &lt;= n; ++i)
        for (int j = 1; j &lt;= m; ++j)
            std::cin &gt;&gt; a[i][j];
    for (int j = 1; j &lt;= m; ++j) &#123;
        int s = 0;
        for (int i = 1; i &lt;= n; ++i)
            s = (s &lt;&lt; 1) + a[i][j] - &#39;0&#39;;
        c[s] += 1;
    &#125;
    for (int i = 0, t; i &lt; l; ++i)
        t = (__builtin_popcount(i)), f[i] = std::min(t, n - t);
    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));
    mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = -1ll;
    mI[0][0] = mI[0][1] = mI[1][0] = mint(2ll).inv(), mI[1][1] = mint(-2ll).inv();
    auto calc = [&amp;](arr a, arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;
        f = a;
        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)
            for (int i = 0; i &lt; l; i += len)
                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple(f[p] * w[0][0] + f[q] * w[0][1], f[p] * w[1][0] + f[q] * w[1][1]);
        return;
    &#125;;
    calc(c, c, mT), calc(f, f, mT);
    arr s(l);
    for (int i = 0; i &lt; l; ++i)
        s[i] = c[i] * f[i];
    calc(s, s, mI);
    int res = 0x3f3f3f3f;
    for (int i = 0; i &lt; l; ++i)
        res = std::min(res, (int)s[i].x);
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="hard-nim">Hard Nim</h2>
<p><a target="_blank" rel="noopener" href="https://hydro.ac/p/bzoj-P4589" class="uri">https://hydro.ac/p/bzoj-P4589</a></p>
<p><em>Nim Counting</em> ç„¶åç¼äº†ä¸ªç­›å­ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int mod = 1e9 + 7;
const int inv2 = 5e8 + 4;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    std::vector&lt;int&gt; p, tag(50001);
    for (int i = 2; i &lt;= 50000; ++i)
        if (!tag[i]) &#123;
            p.push_back(i);
            for (int j = 2 * i; j &lt;= 50000; j += i)
                tag[j] = 1;
        &#125;
    auto qkp = [&amp;](long long x, int y) &#123;
        long long res = 1ll;
        for (; y; y &gt;&gt;= 1, (x *= x) %= mod)
            if (y &amp; 1)
                (res *= x) %= mod;
        return res;
    &#125;;
    for (int n, m; std::cin &gt;&gt; n &gt;&gt; m; ) &#123;
        int k = std::__lg(m) + 1, l = 1 &lt;&lt; k;
        using arr = std::vector&lt;long long&gt;;
        arr c(l);
        for (auto i : p)
            if (i &lt;= m)
                c[i] += 1;
            else
                break;
        std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));
        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = mod - 1ll;
        mI[0][0] = mI[0][1] = mI[1][0] = inv2, mI[1][1] = mod - inv2;
        auto calc = [&amp;](arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;
            for (int len = 2; len &lt;= l; len &lt;&lt;= 1)
                for (int i = 0; i &lt; l; i += len)
                    for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)
                        std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);
            return;
        &#125;;
        calc(c, mT);
        arr s(l);
        for (int i = 0; i &lt; l; ++i)
            s[i] = qkp(c[i], n);
        calc(s, mI);
        std::cout &lt;&lt; s[0] &lt;&lt; &#39;\n&#39;;
    &#125;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="å­é›†å·ç§¯">å­é›†å·ç§¯</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P6097" class="uri">https://www.luogu.com.cn/problem/P6097</a></p>
<p>è¿™ä¸ªæ˜¯åœ¨è®¸å¤š DP ä¸­éƒ½å¯èƒ½è§åˆ°è¿‡çš„ç»“æ„ï¼Œç›¸ä¿¡å¤§å®¶éƒ½æ·±æœ‰ä½“ä¼šã€‚</p>
<p>ç­‰ä»·äºæ±‚ <span class="math inline">\(c_s=\sum\limits_{i\cap j=\varnothing\land i\cup j=s}a_i\cdot b_j\)</span>ï¼Œé¦–å…ˆå…³æ³¨ <span class="math inline">\(i\cup j=s\)</span>ï¼Œå¯ä»¥ç”¨ FWT è§£å†³ï¼›å¯¹äº <span class="math inline">\(i\cap j = \varnothing\)</span> å‘¢ï¼Ÿ</p>
<p>æœ‰ä¸€ä¸ªå¾ˆèªæ˜çš„åŠæ³•ï¼Œæˆ‘ä»¬å‘ç° <span class="math inline">\(i\cap j=\varnothing\land i\cup j = s\iff \operatorname{ctz}(i)+\operatorname{ctz}(j)=\operatorname{ctz}(s)\)</span>ï¼Œå…¶ä¸­ <span class="math inline">\(\operatorname{ctz}(i)\)</span> è¡¨ç¤º <span class="math inline">\(i\)</span> ä¸­ <span class="math inline">\(1\)</span> çš„ä¸ªæ•°ï¼Œå³ <code>popcount(i)</code>ã€‚</p>
<p>æ˜¾ç„¶åè€…æ˜¯ä¸ªç®€å•çš„åŠ æ³•è¿ç®—ï¼Œè¿™é‡Œåˆæœ‰ä¸€ä¸ªå¾ˆèªæ˜åˆå¾ˆåŸºæœ¬çš„åŠæ³•ï¼Œæˆ‘ä»¬ä»¤ <span class="math inline">\(A_{\operatorname{ctz}(i),i}=a_i,B_{\operatorname{ctz}(j),j}=b_j\)</span>ï¼Œé‚£ä¹ˆç­”æ¡ˆå°±è½¬åŒ–ä¸º <span class="math inline">\(\sum\limits_{i}\sum\limits_{j\cup k=s}A_{i,j}\cdot B_{\operatorname{ctz}(s)-i,j}\)</span>ï¼Œå°±å¯ä»¥ <span class="math inline">\(O(n\log^2n)\)</span> åœ°è§£å†³é—®é¢˜äº†ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int mod = 1e9 + 9;
using arr = std::vector&lt;long long&gt;;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    int l = 1 &lt;&lt; n;
    std::vector&lt;arr&gt; a(n + 1, arr(l)), b(n + 1, arr(l)), c(n + 1, arr(l));
    for (int i = 0, x; i &lt; l; ++i)
        std::cin &gt;&gt; x, a[__builtin_popcount(i)][i] = x;
    for (int i = 0, x; i &lt; l; ++i)
        std::cin &gt;&gt; x, b[__builtin_popcount(i)][i] = x;
    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));
    mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;
    mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;
    auto calc = [&amp;](arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;
        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)
            for (int i = 0; i &lt; l; i += len)
                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);
        return;
    &#125;;
    for (int i = 0; i &lt;= n; ++i)
        calc(a[i], mT), calc(b[i], mT);
    for (int i = 0; i &lt;= n; ++i) &#123;
        for (int k = 0; k &lt;= i; ++k)
            for (int j = 0; j &lt; l; ++j)
                (c[i][j] += a[k][j] * b[i - k][j]) %= mod;
        calc(c[i], mI);
    &#125;
    for (int j = 0; j &lt; l; ++j)
        std::cout &lt;&lt; c[__builtin_popcount(j)][j] &lt;&lt; &#39; &#39;;
    std::cout &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="å·åŒºåˆ’åˆ†">å·åŒºåˆ’åˆ†</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4221" class="uri">https://www.luogu.com.cn/problem/P4221</a></p>
<p>äººè¯ï¼šæŠŠ <span class="math inline">\(n\)</span> ä¸ªç‚¹åˆ’åˆ†æˆè‹¥å¹²ä¸ªç‚¹é›†ï¼Œä¿è¯æ¯ä¸ªç‚¹é›†çš„å¯¼å‡ºå­å›¾ä¸æ˜¯æ¬§æ‹‰å›è·¯ï¼ˆæ¯ä¸ªç‚¹çš„åº¦æ•°ä¸ºå¶ä¸”å›¾è¿é€šï¼‰ã€‚</p>
<p>é‚£ä¹ˆæšä¸¾æ¯ä¸€ä¸ªç‚¹é›†åˆ¤å®šæ˜¯å¦åˆæ³•ï¼Œå†ä»¤ <span class="math inline">\(f_{i}={w_i}^{-p}\times\sum\limits_{j\cup k = i\land j\cap k=\varnothing}f_{j}\times {w_k}^p\)</span>ã€‚</p>
<p>å‘ç°åé¢é‚£ä¸ª sigma é‡Œé¢æ˜¯ä¸€ä¸ªç®€å•çš„å­é›†å·ç§¯ï¼›ä½†æ˜¯æˆ‘ä»¬å‘ç°å‰é¢æœ‰ä¸€ä¸ªå’Œ <span class="math inline">\(i\)</span> æœ‰å…³çš„å¸¸æ•°ï¼Œå¯¼è‡´æ²¡åŠæ³•ç›´æ¥å· <span class="math inline">\(n\)</span> æ¬¡ã€‚</p>
<p>ä½†æˆ‘ä»¬å‘ç°è¿™ä¸ª DP å…¶å®æ˜¯æœ‰ä¸€å®šéšå«æ¡ä»¶çš„â€”â€”éƒ½æ˜¯æŒ‰ç…§ <span class="math inline">\(\text{ctz}\)</span> ä»å°åˆ°å¤§è½¬ç§»ã€‚è€ƒè™‘å­é›†å·ç§¯çš„ç¬¬ä¸€ç»´ï¼Œå¾—åˆ° <span class="math inline">\(FWT_{f_i}\)</span> åå…ˆ IFWT å›æ¥ï¼Œä¹˜ä¸Š <span class="math inline">\({w_i}^{-p}\)</span>ï¼Œå† FWT å›å»å³å¯ã€‚è€ƒå¯Ÿå­é›†å·ç§¯çš„ç»“æ„ï¼Œå‘ç°è¿™ä¸ªæ˜¯å¯ä»¥æƒ³åŠæ³•å¥—è¿›å»çš„ã€‚</p>
<p>å¤æ‚åº¦ <a target="_blank" rel="noopener" href="https://atcoder.jp/contests/abc400/tasks/abc400_c"><span class="math inline">\(O(n^2\cdot 2^n)\)</span></a>ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int mod = 998244353;
using arr = std::vector&lt;long long&gt;;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, m, p;
    std::cin &gt;&gt; n &gt;&gt; m &gt;&gt; p;
    int l = 1 &lt;&lt; n;
    auto qkp = [&amp;](long long x, int y = mod - 2) &#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)
            if (y &amp; 1)
                (res *= x) %= mod;
        return res;
    &#125;;
    arr w(n), inv(l);
    std::vector&lt;arr&gt; f(n + 1, arr(l)), s(n + 1, arr(l));
    std::vector&lt;std::vector&lt;int&gt; &gt; g(n);
    for (int x, y; m--; ) &#123;
        std::cin &gt;&gt; x &gt;&gt; y, --x, --y;
        g[x].push_back(y);
    &#125;
    auto check = [&amp;](int s) &#123;
        std::vector&lt;int&gt; f(n), deg(n);
        std::iota(f.begin(), f.end(), 0);
        std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;
            return x == f[x] ? x : f[x] = find(f[x]);
        &#125;;
        auto merge = [&amp;](int x, int y) &#123;
            f[find(x)] = find(y);
            return;
        &#125;;
        for (int i = 0; i &lt; n; ++i)
            if ((s &gt;&gt; i) &amp; 1)
                for (auto j : g[i])
                    if ((s &gt;&gt; j) &amp; 1)
                        merge(i, j), ++deg[i], ++deg[j];
        int fa = -1;
        for (int i = 0; i &lt; n; ++i)
            if ((s &gt;&gt; i) &amp; 1) &#123;
                if (deg[i] &amp; 1)
                    return 1;
                if (fa == -1 || fa == find(i))
                    fa = find(i);
                else
                    return 1;
            &#125;
        return 0;
    &#125;;
    for (int i = 0; i &lt; n; ++i)
        std::cin &gt;&gt; w[i];
    for (int i = 0; i &lt; l; ++i) &#123;
        int ctz = __builtin_popcount(i);
        for (int j = 0; j &lt; n; ++j)
            if ((i &gt;&gt; j) &amp; 1) 
                s[ctz][i] += w[j];
        s[ctz][i] = qkp(s[ctz][i], p);
        inv[i] = qkp(s[ctz][i]);
        if (!check(i))
            s[ctz][i] = 0ll;
    &#125;
    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));
    mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;
    mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;
    auto calc = [&amp;](arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;
        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)
            for (int i = 0; i &lt; l; i += len)
                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);
        return;
    &#125;;
    f[0][0] = 1ll;
    for (int i = 0; i &lt;= n; ++i)
        calc(s[i], mT);
    for (int i = 1; i &lt;= n; ++i) &#123;
        calc(f[i - 1], mT);
        for (int k = 0; k &lt; i; ++k)
            for (int j = 0; j &lt; l; ++j)
                (f[i][j] += f[k][j] * s[i - k][j]) %= mod;
        calc(f[i], mI);
        for (int j = 0; j &lt; l; ++j)
            (f[i][j] *= inv[j]) %= mod;
    &#125;
    std::cout &lt;&lt; f[n][l - 1] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="b---sum-the-fibonacci">B - Sum the Fibonacci</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/914/G" class="uri">https://codeforces.com/problemset/problem/914/G</a></p>
<p>é¦–å…ˆï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ çš„ <span class="math inline">\(cnt\)</span> æ˜¯å¥½åšçš„â€”â€”åšä¸€æ¬¡å­é›†å·ç§¯å¾—åˆ° <span class="math inline">\(cnt_1(a\cup b)\)</span>ï¼Œåšä¸€æ¬¡ xor-FWT å¾—åˆ° <span class="math inline">\(cnt_2(d\oplus e)\)</span>ï¼Œä¸­é—´çš„ <span class="math inline">\(cnt(c)\)</span> å°±æ˜¯åŸæ ·ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯å¯ä»¥åœ¨ä¸€æ¬¡ and-FWT åæŠŠ <span class="math inline">\(cnt,cnt_1,cnt_2\)</span> ç›´æ¥å·èµ·æ¥â€”â€”ç”±çŸ©é˜µä¹˜æ³•ç»“åˆå¾‹å¾—ï¼ˆå“ˆå“ˆå¤§ç¬‘äº†ï¼‰ã€‚ä½†æ€ä¹ˆæŠŠ <span class="math inline">\(f\)</span> å¡è¿›å»å‘¢ï¼Ÿå¦‚æœä½ æ‹¥æœ‰å°å­¦ç”Ÿçš„æ•°å­¦æ°´å¹³ï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°æƒ³åˆ°ç›´æ¥åœ¨ <span class="math inline">\(cnt,cnt_1,cnt_2\)</span> IFWT åçš„ç»“æœåˆ†åˆ«å¯¹ä½ä¹˜ä¸Š <span class="math inline">\(f\)</span> å³å¯ï¼Œå¾ˆå¯æƒœæˆ‘å¹¶æ²¡æœ‰è¿™æ ·çš„æ•°å­¦èƒ½åŠ› <img src="/em/kt.gif" /></p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int N = 17;
const int mod = 1e9 + 7;
using arr = std::vector&lt;long long&gt;;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, l;
    std::cin &gt;&gt; n, l = 1 &lt;&lt; N;
    std::vector&lt;int&gt; a(n + 1);
    arr f(l), cnt(l), cnt1(l), cnt2(l);
    for (int i = 1; i &lt;= n; ++i)
        std::cin &gt;&gt; a[i], ++cnt[a[i]];
    f[0] = 0ll, f[1] = 1ll;
    for (int i = 2; i &lt; l; ++i)
        f[i] = (f[i - 1] + f[i - 2]) % mod;
    auto qkp = [&amp;](long long x, int y = mod - 2) &#123;
        auto res = 1ll;
        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)
            if (y &amp; 1)
                (res *= x) %= mod;
        return res;
    &#125;;
    const int inv2 = qkp(2ll);
    std::vector&lt;arr&gt; mT(2, arr(2)), mI(2, arr(2));
    auto calc = [&amp;](arr a, arr &amp;f, std::vector&lt;arr&gt; &amp;w) &#123;
        f = a;
        for (int len = 2; len &lt;= l; len &lt;&lt;= 1)
            for (int i = 0; i &lt; l; i += len)
                for (int p = i, q = i + len / 2; q &lt; i + len; ++p, ++q)
                    std::tie(f[p], f[q]) = std::make_tuple((f[p] * w[0][0] + f[q] * w[0][1]) % mod, (f[p] * w[1][0] + f[q] * w[1][1]) % mod);
        return;
    &#125;;
    &#123; // orFWT
        mT[0][0] = 1ll, mT[0][1] = 0ll, mT[1][0] = 1ll, mT[1][1] = 1ll;
        mI[0][0] = 1ll, mI[0][1] = 0ll, mI[1][0] = mod - 1ll, mI[1][1] = 1ll;
        std::vector&lt;arr&gt; u(N + 1, arr(l)), d(N + 1, arr(l));
        for (int i = 0; i &lt; l; ++i)
            u[__builtin_popcount(i)][i] = cnt[i];
        for (int i = 0; i &lt;= N; ++i)
            calc(u[i], u[i], mT);
        for (int i = 0; i &lt;= N; ++i) &#123;
            for (int j = 0; j &lt; l; ++j)
                for (int k = 0; k &lt;= i; ++k)
                    (d[i][j] += u[k][j] * u[i - k][j]) %= mod;
            calc(d[i], d[i], mI);
        &#125;
        for (int i = 0; i &lt; l; ++i)
            cnt1[i] = d[__builtin_popcount(i)][i] * f[i] % mod;
    &#125;
    &#123; // xor FWT
        mT[0][0] = 1ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = mod - 1ll;
        mI[0][0] = mI[0][1] = mI[1][0] = inv2, mI[1][1] = mod - inv2;
        calc(cnt, cnt2, mT);
        for (int i = 0; i &lt; l; ++i)
            (cnt2[i] *= cnt2[i]) %= mod;
        calc(cnt2, cnt2, mI);
        for (int i = 0; i &lt; l; ++i)
            (cnt2[i] *= f[i]) %= mod;
    &#125;
    &#123; // andFWT
        mT[0][0] = 0ll, mT[0][1] = 1ll, mT[1][0] = 1ll, mT[1][1] = 1ll;
        mI[0][0] = mod - 1ll, mI[0][1] = 1ll, mI[1][0] = 1ll, mI[1][1] = 0ll;
        for (int i = 0; i &lt; l; ++i) // è¿™ä¸€æ­¥è¦æ”¾åœ¨ FWT ä¹‹å‰ï¼ŒåŸå› æ˜¾ç„¶ ğŸ¤—
            (cnt[i] *= f[i]) %= mod;
        calc(cnt2, cnt2, mT), calc(cnt1, cnt1, mT), calc(cnt, cnt, mT);
        for (int i = 0; i &lt; l; ++i)
            cnt[i] = cnt[i] * cnt1[i] % mod * cnt2[i] % mod % mod;
        calc(cnt, cnt, mI);
    &#125;
    long long res = 0ll;
    for (int i = 0; i &lt; N; ++i)
        (res += cnt[1 &lt;&lt; i] % mod) %= mod;
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>

			</div>
			<hr class="dotted">
			<div class="post footer">
				<div id="hitokoto">
					<h3 id="hitokoto-title">
						è¨€è®º
					</h3>
					<div id="hitokoto-content">
					</div>
					<div id="hitokoto-from">
					</div>
				</div>
				<div class="button flex">
					<div id="prev">
						
							<!-- åæ§½ï¼Œä¸ºå•¥è¿˜éœ€è¦åŠ  / -->
							<a href="/20250404/">
								<i class="fas fa-angle-double-left" style="margin-right: 10px;"></i>
								æ‚é¢˜é€‰è°ˆ
							</a>
						
					</div>
					<div id="next">
						
							<a href="/20250219/">
								æ‚é¢˜é›†
								<i class="fas fa-angle-double-right" style="margin-left: 10px;"></i>
							</a>
						
					</div>
				</div>
				<div id="vcomments" class="yahei"></div>
<script>
	new Valine({
		el: '#vcomments',
		appId: 'OlmvQ0a2Zw7xo3no2bwabOzx-gzGzoHsz',
		appKey: 'TW6t8mFeGLmhPjWisvmllvvo',
		recordIP: true,
		enableQQ: true, 
		// ç›®å‰ Valine çš„ QQ è‡ªåŠ¨è·å–æ˜µç§°ä¼¼ä¹ä¸å¯ç”¨ æ•…ä¸å»ºè®®å¼€å¯
		pageSize: 10,
		requiredFields:
			
				['nick']
			,
		placeholder: "The world is but a little place after all...\nèƒ½å¤Ÿæ ¹æ®é‚®ç®±è·å–ä½ çš„ Gravatar å¤´åƒã€‚æ˜µç§°æ˜¯å¿…å¡«é¡¹ï¼Œé•¿åº¦éœ€ä¸ä½äº 3ã€‚",
		avatar: 'mp',
		avatar_cdn: 'https://cravatar.cn/avatar/',
		emojiCDN: 'https://xsc062.netlify.app/em/', 
		emojiMaps: {
			
				"å¾®ç¬‘": "wx.gif",
			
				"é¾‡ç‰™": "cy.gif",
			
				"æµæ³ª": "ll.gif",
			
				"ç¬‘å“­": "xk.gif",
			
				"æµæ±—": "lh.gif",
			
				"æ“¦æ±—": "ch.gif",
			
				"äº²äº²": "qq.gif",
			
				"è‰²": "se.gif",
			
				"ç–‘é—®": "yiw.gif",
			
				"å‘å‘†": "fd.gif",
			
				"æ™•": "yun.gif",
			
				"é¼“æŒ": "gz.gif",
			
				"æ†¨ç¬‘": "hanx.gif",
			
				"å¿«å“­äº†": "kk.gif",
			
				"å¾—æ„": "dy.gif",
			
				"ç‹‚ç¬‘": "kx.gif",
			
				"å®³ç¾": "hx.gif",
			
				"å¦ˆå¦ˆç”Ÿçš„": "dz.gif",
			
				"ç³—å¤§äº†": "qd.gif",
			
				"åƒç“œ": "cg.gif",
			
				"ççœ¼": "zy.webp",
			
				"è¾£çœ¼ç›": "lyj.gif",
			
				"é…¸äº†": "nm.gif",
			
				"æ»š": "gun.webp",
			
				"æƒŠæ": "jk.gif",
			
				"å¹½çµ": "youl.gif",
			
				"æ— èŠ": "wul.gif",
			
				"åƒ": "eat.gif",
			
				"ä½ å¾ˆæ£’æ£’": "bb.gif",
			
				"èµ": "qiang.gif",
			
				"è¸©": "ruo.gif",
			
				"æ¡æ‰‹": "wsh.gif",
			
				"å‘æŠ–": "fad.gif",
			
				"æŒ¥æ‰‹": "hsh.gif",
			
				"ç£•å¤´": "kt.gif",
			
				"æ€„ç«": "oh.gif",
			
		},
	})
</script>
			</div>
			<script>setHitokoto();</script>
		</div> 
	</div>
</div>
    <!-- é¡µè„šå¼€å§‹ -->
<div id="footer" class="yahei">
    Powered by
    <a target="_blank" rel="noopener" href="https://hexo.io">
        Hexo
    </a>
    &
    <a href="/about-this-theme">
        iwll
    </a>
    <p style="margin-top: 5px;">
        2021 - 2025
    </p>
</div>
<!-- Valine ç›¸å…³é…ç½® -->
<script>
    const getValineDomTimer = setInterval(() => {
        // ä¸çŸ¥é“ä¸ºä»€ä¹ˆ æˆ‘ä»åŸåšå®¢ js æ–‡ä»¶ç²˜è¿‡æ¥çš„å‚æ•°æ˜¯
        // "#valine .vcards .vcard"
        // DEBUG äº†åŠå¤©æ‰å®šä½åˆ°è¿™ä¸ªé—®é¢˜ã€‚ã€‚ã€‚
        const vcards =
            document.querySelectorAll('#valine, .vcards, .vcard');
        if (vcards.length > 0) {
            let author = 'XSC062';
            for (let vcard of vcards) {
                const vnick_dom = vcard.querySelector('.vhead .vnick');
                if (vnick_dom != null) {
                    const vnick = vnick_dom.innerHTML;
                    if (vnick === author) {
                        vnick_dom.innerHTML =
                        `${vnick} <span id="rootitem" class="fira">root</span>`
                    }
                }
            }
        }
        else {
            clearInterval(getValineDomTimer);
        }
    }, 2000);
    SetActiveItem();
    setDetailsSummary();
    setTitleAnchor();
    setEmptyToc();
    setCodeClassName();
</script>


<!-- js -->
<!-- æœç´¢åŠŸèƒ½ç›¸å…³é…ç½® -->

<script src="/js/search.js"></script>

</script>
<!-- prism ç›¸å…³é…ç½® -->
<script type="text/javascript" src="/js/prism.js" defer></script>
<!-- ä»£ç å—å¤åˆ¶åŠŸèƒ½ -->
<script type="text/javascript" src="/js/clipboard.min.js"></script>
<script type="text/javascript" src="/js/clipboard-use.js"></script>
<!-- é¡µè„šç»“æŸ -->
</body>
</html>