<!DOCTYPE html>
<html>
<head>
    <!-- ç½‘ç«™å›¾æ ‡ -->
<link rel="icon" type="image/png" sizes="32x32" href="/images/icon.svg">
<!-- å…¶ä»–å›¾æ ‡æ”¯æŒ -->
<link rel="stylesheet" href="/css/facss/fa-brands.min.css">
<link rel="stylesheet" href="/css/facss/fa-regular.min.css">
<link rel="stylesheet" href="/css/facss/fa-solid.min.css">
<link rel="stylesheet" href="/css/facss/fontawesome.min.css">
<link rel="stylesheet" href="/css/facss/fontawesome-all.css">
<link href="https://use.fontawesome.com/releases/v5.0.4/css/all.css" rel="stylesheet">
<!-- ç½‘ç«™æ ‡é¢˜ -->
<title>
	
		æ ‘ DP -
	
	XSC062 çš„åšå®¢
</title>
<!-- js å¼•å…¥ -->
<script>
const searchPath = "/search.xml"
</script>

<script src="/js/afterloaded.js"></script>


<script src="/js/jQuery.js"></script>

<!-- è½½å…¥ Valine -->

<script src="/js/Valine.min.js"></script>

<!-- css å¼•å…¥ -->

<link rel="stylesheet" href="/css/layout.css">


<link rel="stylesheet" href="/css/prcss/prism.css">



<!-- rss -->
<link rel="alternate" type="application/rss+xml" title="" href="https://xsc062.netlify.app/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="" href="https://xsc062.netlify.app/atom.xml" />
<link rel="alternate" type="application/json" title="" href="https://xsc062.netlify.app/feed.json" />

<meta charset="utf-8"> 
<meta name="generator" content="Hexo 7.2.0"></head>
<body class="line-numbers match-braces no-brace-select rainbow-braces">
	
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
            inlineMath: [ ['$','$'], ["\\(","\\)"] ],
            processEscapes: true
          }
        });
      </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
            tex2jax: {
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
            }
          });
      </script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
              var all = MathJax.Hub.getAllJax(), i;
              for(i=0; i < all.length; i += 1) {
                  all[i].SourceElement().parentNode.className += ' has-jax';
              }
          });
      </script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML"></script>

	<!-- æœç´¢ -->
<script>
	function closeSearchBox() {
		$("#search-bg").css("transition", "null"); 
		$("#search-bg").css("z-index", "-1"); 
		$("#search-bg").css("opacity", "0%");
		return;
	}
</script>
<div id="search-bg">
	<div id="search-box">
		<button id="close-button" onclick="closeSearchBox()">
			<i class="fas fa-times"></i>
		</button>
		<input type="text" id="search-input" placeholder="Type to search...">
		<div id="search-results">
			<div id="emptyInput">
				<p>é”®å…¥ä»¥æœç´¢â€¦</p>
				<p><i>åŒ¹é…ç®—æ³•</i>ï¼šæŠŠè¾“å…¥æŒ‰ç©ºæ ¼æ‹†åˆ†ï¼Œå•ç‹¬<strong>åŒ¹é…</strong>æ¯ä¸€æ®µè¾“å…¥ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼Œä»…åŒ¹é…æ–‡ç« æ–‡æœ¬å†…å®¹ï¼‰ï¼Œè¾“å‡ºå–æˆ–åçš„ç»“æœã€‚</p>
				<p>æ¨¡ç³Šæœç´¢ä¼¼ä¹å¾ˆéš¾æï¼Œç›®å‰æ²¡æœ‰ç›¸å…³æ‰“ç®—ã€‚</p>
			</div>
		</div>
	</div>
</div>
<!-- é¡¶æ æ•´ä½“å¯¼èˆªèœå• -->
<div class="ui top menu">
	<!-- å·¦å¯¹é½ logo -->
	<a class="logo" href="/">
		<img width="25px" height="25px" style="border: solid transparent 2.5px" src="/images/icon.svg"></img>
		<div id="bartitle" class="text">
			XSC062 çš„åšå®¢
		</div>
	</a>
	<!-- å³å¯¹é½éƒ¨åˆ†å¯¼èˆª -->
	<div id="rightali" class="serif">
		<a class="item" id="Search" type="button">
			<i class="btn text-muted fa fa-search" id="search-icon" disabled></i>
		</a>
		<a class="item" id="Home" href="/">
			Home
		</a>
		<a class="item" id="Arch" href="/archives">
			Archives
		</a>
		<!-- <a class="item" id="Cate" href="/categories">
			Categories
		</a> -->
		<a class="item" id="Tags" href="/tags">
			Tags
		</a>
		<a class="item" id="Frie" href="/friends">
			Friends
		</a>
		<a class="item" id="Abou" href="/about">
			About
		</a>
	</div>
</div>
    
<link rel="stylesheet" href="/css/post.css">


<script src="/js/post.js"></script>


<div class="main">
	<div id="sidebar" class="text">
		<aside id="toc">
			<span id="toctitle">
				<i class="fas fa-list"></i>
				ç›®å½•
			</span>
			<ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#a---svjetlo"><span class="toc-text">A - Svjetlo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b---one-to-one"><span class="toc-text">B - One to One</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#c---diameter-cuts"><span class="toc-text">C - Diameter Cuts</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#d---leaf-partition"><span class="toc-text">D - Leaf Partition</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#e---uniformly-branched-trees"><span class="toc-text">E - Uniformly Branched Trees</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#a---dominant-indices"><span class="toc-text">A - Dominant Indices</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#b---%E6%A0%91%E4%B8%8A%E5%BC%82%E6%88%96"><span class="toc-text">B - æ ‘ä¸Šå¼‚æˆ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#c---%E4%B8%80%E4%B8%AA%E7%BD%91%E7%9A%84%E8%B7%AF"><span class="toc-text">C - ä¸€ä¸ªç½‘çš„è·¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#d---%E9%9A%8F%E6%9C%BA%E6%A0%91"><span class="toc-text">D - éšæœºæ ‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#e---complete-compress"><span class="toc-text">E - Complete Compress</span></a></li></ol>
		</aside>
	</div>
	<div class="ui post container">
		<div class="ui text container">
			<span id="postcon">
				<span id="postinfo">
					<div class="ui post title serif">
						<div id="fortitle" data-content="æ ‘ DP">
							æ ‘ DP
						</div>
						<div class="ui title background">
						</div>
					</div>
					<span id="date">
						<i class="fas fa-calendar-alt" style="margin-right: 4px;"></i>
						2025-08-03
					</span>
				</span>
			</span>
			<div id="posttags" class="dotted border">
				
					
						<a href="/tags/DP/" class="citem">DP</a>
					
						<a href="/tags/æ ‘å½¢-DP/" class="citem">æ ‘å½¢ DP</a>
					
						<a href="/tags/é•¿é“¾å‰–åˆ†/" class="citem">é•¿é“¾å‰–åˆ†</a>
					
				
			</div>
			<!-- æœ¬æ¥ç”¨çš„æ˜¯ fromNow ç„¶åå­—ç¬¦ä¸²åˆ¤æ–­ï¼Œæ²¡æƒ³åˆ°å¯ä»¥ç›´æ¥è°ƒç”¨ moment() -->
			
			<div id="content">
				<p>æ ‘ä¸Šçš„ DP ä»¥åŠ å’Œæ ‘æœ‰å…³çš„ DP</p>
<span id="more"></span>
<hr />
<h2 id="a---svjetlo">A - Svjetlo</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P7163" class="uri">https://www.luogu.com.cn/problem/P7163</a></p>
<p>å¾ˆå®¹æ˜“æƒ³åˆ°ä¸€ç§çŠ¶æ€è®¾è®¡ï¼Œå³ä»¤ <span class="math inline">\(f_{x,0/1/2}\)</span> åˆ†åˆ«è¡¨ç¤ºæœ‰ <span class="math inline">\(0/1/2\)</span> ä¸ªç«¯ç‚¹åœ¨å­æ ‘å†…éƒ¨çš„æƒ…å†µï¼›ç„¶åå°±å¼€å§‹æ€è€ƒï¼Œå¦‚ä½•æ»¡è¶³å¯¹äºå¼€å…³çŠ¶æ€çš„è¦æ±‚ï¼Ÿ</p>
<p>è¿˜æ˜¯æƒ³å°‘äº†ã€‚å¦‚æœå†åŠ ä¸€ç»´ï¼Œä»ã€çŠ¶æ€ä¸ºå¼€æˆ–å…³ã€æ€è€ƒå°±ä¼šè½»æ¾å¾ˆå¤šï¼Œä»¤ <span class="math inline">\(f_{x,0/1/2,0/1}\)</span> è¡¨ç¤ºæœ‰ <span class="math inline">\(0/1/2\)</span> ä¸ªç«¯ç‚¹å†å­æ ‘å¤–éƒ¨ï¼Œä¸”å­æ ‘å†…æ“ä½œå®Œå <span class="math inline">\(x\)</span> ä¸ºå…³ / å¼€çš„æœ€å°‘æ­¥æ•°ã€‚ç„¶ååˆ†ç±»è®¨è®ºè½¬ç§»æ–¹å¼å³å¯ã€‚</p>
<p>ä¸€ä¸ªæ¯”è¾ƒæ–¹ä¾¿çš„è®¨è®ºæ–¹å¼æ˜¯ï¼Œå…ˆç¡®å®šæŸç§æƒ…å†µä¸‹ï¼Œè®¿é—® <span class="math inline">\(u\)</span> ä¸ <span class="math inline">\(v\)</span> çš„æ¬¡æ•°ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°å®ƒä»¬åŸæœ¬çš„çŠ¶æ€ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, rt = -1;
    std::cin &gt;&gt; n;
    std::vector&lt;int&gt; a(n + 1);
    for (int i = 1; i &lt;= n; ++i) &#123;
        char t;
        std::cin &gt;&gt; t;
        a[i] = t - &#39;0&#39;;
        if (!a[i])
            rt = i;
    &#125;
    if (rt == -1) &#123;
        std::cout &lt;&lt; 0 &lt;&lt; &#39;\n&#39;;
        return 0;
    &#125;
    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);
    for (int i = 1, x, y; i &lt; n; ++i) &#123;
        std::cin &gt;&gt; x &gt;&gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &#125;
    std::vector&lt;int&gt; tag(n + 1);
    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;
        tag[x] = a[x];
        for (auto i : g[x])
            if (i != fa)
                DFS(i, x), tag[x] &amp;= tag[i];
        return;
    &#125;;
    DFS(rt, -1);
    std::vector&lt;std::vector&lt;std::vector&lt;int&gt; &gt; &gt; f(n + 1, std::vector&lt;std::vector&lt;int&gt; &gt; (3, std::vector&lt;int&gt; (2, 0x3f3f3f3f)));
    DFS = [&amp;](int x, int fa) &#123;
        f[x][0][a[x]] = 0;
        for (auto i : g[x])
            if (i != fa &amp;&amp; !tag[i]) &#123;
                DFS(i, x);
                auto g = f[x];
                f[x][0][0] = std::min(g[0][0] + f[i][0][1] + 4, g[0][1] + f[i][0][0] + 2);
                f[x][0][1] = std::min(g[0][1] + f[i][0][1] + 4, g[0][0] + f[i][0][0] + 2);
                f[x][1][0] = std::min(&#123; g[1][0] + f[i][0][1] + 4, g[1][1] + f[i][0][0] + 2, g[0][0] + f[i][1][0] + 3, g[0][1] + f[i][1][1] + 1 &#125;);
                f[x][1][1] = std::min(&#123; g[1][1] + f[i][0][1] + 4, g[1][0] + f[i][0][0] + 2, g[0][1] + f[i][1][0] + 3, g[0][0] + f[i][1][1] + 1 &#125;);
                f[x][2][0] = std::min(&#123; g[2][0] + f[i][0][1] + 4, g[2][1] + f[i][0][0] + 2, g[1][0] + f[i][1][1], g[1][1] + f[i][1][0] + 2, g[0][0] + f[i][2][1] + 4, g[0][1] + f[i][2][0] + 2 &#125;);
                f[x][2][1] = std::min(&#123; g[2][1] + f[i][0][1] + 4, g[2][0] + f[i][0][0] + 2, g[1][1] + f[i][1][1], g[1][0] + f[i][1][0] + 2, g[0][1] + f[i][2][1] + 4, g[0][0] + f[i][2][0] + 2 &#125;);
            &#125;
        f[x][1][0] = std::min(f[x][1][0], f[x][0][1] + 1);
        f[x][1][1] = std::min(f[x][1][1], f[x][0][0] + 1);
        f[x][2][0] = std::min(f[x][2][0], f[x][1][0]);
        f[x][2][1] = std::min(f[x][2][1], f[x][1][1]);
        // for (int i = 0; i &lt; 3; ++i)
        //     for (int j = 0; j &lt; 2; ++j)
        //         printf(&quot;f[%d][%d][%d] = %d\n&quot;, x, i, j, f[x][i][j]);
        return;
    &#125;;
    DFS(rt, -1);
    std::cout &lt;&lt; f[rt][2][1] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="b---one-to-one">B - One to One</h2>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/arc140/tasks/arc140_d" class="uri">https://atcoder.jp/contests/arc140/tasks/arc140_d</a></p>
<p>è§‚å¯ŸåŸå›¾ä¸Šè¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯æ²¡æœ‰æœªç¡®å®šè¾¹çš„åŸºç¯æ ‘ï¼Œè¦ä¹ˆæ˜¯æœ‰æ°å¥½ä¸€æ¡æœªç¡®å®šè¾¹çš„æ ‘ã€‚ç¼©ç‚¹ï¼Œä»»æ„ä¸ºæœªç¡®å®šè¾¹èµ‹å€¼ï¼Œè€ƒå¯Ÿæœ€åå¾—åˆ°çš„è¿é€šå—ï¼Œå‘ç°è¦ä¹ˆæ˜¯ä»¥ã€åŸºç¯æ ‘ç‚¹ã€ä¸ºæ ¹çš„æ ‘ï¼Œè¦ä¹ˆæ˜¯ä¸åŒ…å«ã€åŸºç¯æ ‘ç‚¹ã€çš„ï¼ˆå†…å‘ï¼‰åŸºç¯æ ‘ã€‚</p>
<p>è¿™é‡Œè¦ç”¨åˆ°è´¡çŒ®çš„æ€æƒ³ã€‚è€ƒè™‘å°†å…¨å±€åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªéƒ¨åˆ†ï¼Œä¿è¯æ¯éƒ¨åˆ†çš„å•æ­¥ä»·å€¼æ˜¯å¯ç¡®å®šçš„ã€‚å°†ç¬¬ä¸€æ­¥ï¼Œå³å¯¹æ ‘å’ŒåŸºç¯æ ‘çš„è®¨è®ºæ‹†å¼€ï¼Œå¯¹äºæ ‘ï¼Œå…¶æ•°é‡ç¡®å®šï¼›å¯¹äºåŸºç¯æ ‘ï¼Œå‘ç°ç¯çš„æ•°é‡å³ä¸ºåŸºç¯æ ‘çš„æ•°é‡ï¼Œè¿›ä¸€æ­¥å°†æ‰€æœ‰æ­¥ä¸­çš„ã€ç¯ã€è¿™ä¸€ç±»åˆ†å¼€ï¼Œç»Ÿè®¡æˆç¯çš„æ–¹æ¡ˆæ•°å°±å¯ä»¥å¾—åˆ°åŸºç¯æ ‘çš„è´¡çŒ®ã€‚å…·ä½“åœ°ï¼Œä»¤ <span class="math inline">\(f_{i,j}\)</span> ä¸ºåœ¨å‰ <span class="math inline">\(i\)</span> ä¸ªç‚¹ä¸­é€‰æ‹© <span class="math inline">\(j\)</span> ä¸ªæˆä¸€ä¸ªç¯çš„æ–¹æ¡ˆæ•°ï¼Œåˆ™æœ‰ï¼š</p>
<p><span class="math display">\[
f_{i,j}=f_{i-1,j}+f_{i-1,j-1}\times siz_i
\]</span></p>
<p>æœ€åè®¡ç®—æ¯ä¸ªç¯çš„è´¡çŒ®å³å¯ã€‚æ³¨æ„è¿˜è¦ç®—ä¸Šç¯å†…éƒ¨çš„æ’åˆ—ï¼ˆæ³¨æ„å¾ªç¯ä½ç§»ï¼‰ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int mod = 998244353;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    std::vector&lt;int&gt; a(n + 1), tag(n + 1), s(n + 1, 1), fa(n + 1), siz(n + 1);
    std::iota(fa.begin() + 1, fa.end(), 1);
    std::function&lt;int(int)&gt; find = [&amp;](int x) &#123;
        return x == fa[x] ? x : fa[x] = find(fa[x]);
    &#125;;
    auto merge = [&amp;](int x, int y) &#123;
        x = find(x), y = find(y);
        if (x != y) &#123;
            tag[y] += tag[x];
            s[y] += s[x];
            fa[x] = y;
        &#125;
        return;
    &#125;;
    for (int i = 1; i &lt;= n; ++i)  &#123;
        std::cin &gt;&gt; a[i], fa[i] = i;
        if (a[i] == -1)
            tag[i] = 1;
        else
            merge(i, a[i]);
    &#125;
    int cnt1 = 0, cnt2 = 0;
    for (int i = 1; i &lt;= n; ++i) &#123;
        cnt1 += (fa[i] == i &amp;&amp; !tag[i]);
        if (fa[i] == i &amp;&amp; tag[i])
            siz[++cnt2] = s[i];
    &#125;
    auto qkp = [&amp;](long long x, int y) &#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)
            if (y &amp; 1)
                (res *= x) %= mod;
        return res;
    &#125;;
    auto res(cnt1 * qkp(n, cnt2) % mod);
    std::vector&lt;std::vector&lt;long long&gt; &gt; f(cnt2 + 1, std::vector&lt;long long&gt; (cnt2 + 1));
    f[0][0] = 1ll;
    for (int i = 1; i &lt;= cnt2; ++i) &#123;
        // printf(&quot;i = %d, siz = %d: \n&quot;, i, siz[i]);
        for (int j = 0; j &lt;= i; ++j) &#123;
            f[i][j] = f[i - 1][j];
            if (j != 0)
                (f[i][j] += f[i - 1][j - 1] * siz[i]) %= mod;
            // printf(&quot;  f[%d][%d] = %lld\n&quot;, i, j, f[i][j]);
        &#125;
    &#125;
    for (int i = 1; i &lt;= cnt2; ++i) &#123;
        static auto fac(1ll);
        (res += f[cnt2][i] * fac % mod * qkp(n, cnt2 - i) % mod) %= mod;
        (fac *= i) %= mod;
    &#125;
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="c---diameter-cuts">C - Diameter Cuts</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/1499/F" class="uri">https://codeforces.com/problemset/problem/1499/F</a></p>
<p>ä»¤ <span class="math inline">\(f_{x,i}\)</span> è¡¨ç¤º <span class="math inline">\(x\)</span> ä¸Šçš„æœ€é•¿é“¾é•¿ä¸º <span class="math inline">\(i\)</span> çš„æ–¹æ¡ˆæ•°ï¼Œå°±å¯ä»¥ç”¨ä¸€ä¸ªç±»ä¼¼èƒŒåŒ…çš„è¿‡ç¨‹æ±‚ç­”æ¡ˆäº†ã€‚å‘ç°è¿™ä¸ªèƒŒåŒ…æ»¡è¶³å¯ä»¥è¢«ä¼˜åŒ–çš„å½¢å¼ï¼Œæ•…èƒ½åœ¨ <span class="math inline">\(O(nk)\)</span> å†…è§£å†³é—®é¢˜ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int mod = 998244353;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, k;
    std::cin &gt;&gt; n &gt;&gt; k, ++k;
    if (k == 0) &#123;
        std::cout &lt;&lt; 1 &lt;&lt; &#39;\n&#39;;
        return 0;
    &#125;
    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);
    for (int i = 1, x, y; i &lt; n; ++i) &#123;
        std::cin &gt;&gt; x &gt;&gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &#125;
    std::vector&lt;int&gt; h(n + 1);
    std::vector&lt;std::vector&lt;long long&gt; &gt; f(n + 1, std::vector&lt;long long&gt; (k + 1));
    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;
        f[x][1] = 1ll, h[x] = 1;
        for (auto i : g[x])
            if (i != fa) &#123;
                DFS(i, x);
                std::vector&lt;long long&gt; g(k + 1);
                g.swap(f[x]);
                for (int j = std::min(h[x], k); j; --j)
                    for (int l = std::min(h[i], k - j); ~l; --l)
                        (f[x][std::max(j, l + 1)] += g[j] * f[i][l] % mod) %= mod;
                h[x] = std::max(h[x], h[i] + 1);
            &#125;
        for (int i = 1; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)
            (f[x][0] += f[x][i]) %= mod;
        // for (int i = 0; i &lt;= h[x] &amp;&amp; i &lt;= k; ++i)
        //     printf(&quot;f[%d][%d] = %lld\n&quot;, x, i, f[x][i]);
        return;
    &#125;;
    DFS(1, -1);
    auto res(0ll);
    for (int i = 1; i &lt;= k; ++i)
        (res += f[1][i]) %= mod;
    std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="d---leaf-partition">D - Leaf Partition</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/1146/F" class="uri">https://codeforces.com/problemset/problem/1146/F</a></p>
<p>å‡è®¾å·²ç»å®Œæˆåˆ†ç»„ï¼Œæ¬²åˆ¤å®šè¿™ç§æ–¹å¼æ˜¯å¦åˆæ³•ï¼Œå®¹æ˜“æƒ³åˆ°å¯¹æ¯ä¸€ç»„å¶å­å»ºç«‹è™šæ ‘ï¼Œåˆ™è¯¥åˆ†ç»„æ–¹å¼åˆæ³•ï¼Œå½“ä¸”ä»…å½“æ²¡æœ‰ä¸€ä¸ªç‚¹è¢«å¤šä¸ªè™šæ ‘å ç”¨ã€‚ä¹Ÿå³ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ€»çš„è™šæ ‘ä¸Šé€‰å‡ºä¸€äº›ç‚¹ï¼Œè®©å®ƒä»¬å¯ä»¥è¦†ç›–æ‰€æœ‰å¶å­ã€‚</p>
<p>è™šæ ‘ä¸Š DPï¼Œå®¹æ˜“å‘ç°å½“ä¸”ä»…å½“å­˜åœ¨ <span class="math inline">\(\ge 2\)</span> ä¸ªå„¿å­æƒ³è¦åˆ†è¿›åŒä¸€ä¸ªè™šæ ‘æ—¶ï¼Œ<span class="math inline">\(i\)</span> ä¼šè¢«é€‰åˆ°ã€‚æ•…ä»¤ <span class="math inline">\(f_{i, 0/1/2}\)</span> è¡¨ç¤ºå½“å‰æœ‰ <span class="math inline">\(0/1/\ge 2\)</span> ä¸ªå„¿å­æƒ³è¦é€‰æ‹© <span class="math inline">\(i\)</span> æ—¶çš„æ–¹æ¡ˆæ•°ï¼ŒDP å³å¯ã€‚</p>
<p>åœ¨å®ç°çš„è¿‡ç¨‹ä¸­å°±ä¼šå‘ç°æ ¹æœ¬ä¸éœ€è¦æ±‚è™šæ ‘ï¼ŒåŸæ ‘ä¸Š DP å°±å¯ä»¥äº†ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int mod = 998244353;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    std::vector&lt;int&gt; fa(n + 1);
    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);
    for (int i = 2; i &lt;= n; ++i)
        std::cin &gt;&gt; fa[i], g[fa[i]].push_back(i);
    std::vector&lt;std::array&lt;long long, 3&gt; &gt; f(n + 1);
    std::function&lt;void(int)&gt; DFS = [&amp;](int x) &#123;
        if (g[x].empty())
            f[x][2] = 1ll;
        else
            f[x][0] = 1ll;
        for (auto i : g[x]) &#123;
            DFS(i);
            auto F0 = (f[i][0] + f[i][2]) % mod, F1 = (f[i][1] + f[i][2]) % mod;
            f[x][2] = (f[x][2] * F0 % mod + f[x][2] * F1 % mod + f[x][1] * F1 % mod) % mod;
            f[x][1] = (f[x][1] * F0 % mod + f[x][0] * F1 % mod) % mod;
            (f[x][0] *= F0) %= mod;
        &#125;
        // printf(&quot;%d: %lld / %lld / %lld\n&quot;, x, f[x][0], f[x][1], f[x][2]);
        return;
    &#125;;
    DFS(1);
    std::cout &lt;&lt; (f[1][0] + f[1][2]) % mod &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="e---uniformly-branched-trees">E - Uniformly Branched Trees</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/724/F" class="uri">https://codeforces.com/problemset/problem/724/F</a></p>
<p>æ„Ÿè§‰æ˜¯å¾ˆå¸¸è§çš„å¥—è·¯ï¼Œä½†æ˜¯æˆ‘ä¸ä¼š ğŸ˜±</p>
<p>åœ¨æ‰‹ç©æ ·ä¾‹çš„æ—¶å€™å¯ä»¥æ„Ÿæ€§è®¤çŸ¥åˆ°ï¼Œæ¯ä¸ªæ ‘ä¼šè¢«æ¯ç§ç‚¹ä½œä¸ºæ ¹çš„æƒ…å†µç»Ÿè®¡ä¸€æ¬¡ã€‚ä¸”å¦‚æœå›ºå®šä»¥æŸç§ï¼ˆåŒ–å­¦ç¯å¢ƒï¼‰çš„ç‚¹ä¸ºæ ¹ï¼Œå¯ä»¥é€šè¿‡æŒ‰ siz ä»å°åˆ°å¤§æ’åˆ—å”¯ä¸€æ±‚è§£å‡ºè¯¥æ ‘ã€‚</p>
<p>å‘ç°ä»¥é‡å¿ƒä¸ºæ ¹ï¼ˆå³é’¦å®šæ ¹ä¸ºé‡å¿ƒï¼‰å¯ä»¥å¸¦æ¥å¾ˆå¤šä¼˜ç¾çš„æ€§è´¨ã€‚å› ä¸º siz æ˜¯å¥½ç¡®å®šçš„ï¼Œä¸”æ˜¯å„¿å­çš„æ’åºä¾æ®ï¼Œæ‰€ä»¥é€‰é‡å¿ƒä¾¿äºç»Ÿè®¡ï¼ŒåŒæ—¶æ»¡è¶³æ¯ç§æ ‘æœ€å¤šè¢«ç»Ÿè®¡ä¸¤æ¬¡ï¼ˆå½“ä¸”ä»…å½“æœ‰ä¸¤ä¸ªé‡å¿ƒï¼‰ã€‚</p>
<p>å‘ç°è¿™å°±å˜æˆäº†å¤šé‡é›†çš„ç»„åˆæ•°ï¼Œè®¾ <span class="math inline">\(f_{i,j,k}\)</span> è¡¨ç¤ºå·²ç»èŠ±è´¹ <span class="math inline">\(i\)</span> ä¸ªç‚¹ç»„æˆä¸€ä¸ªå­æ ‘ï¼Œå­æ ‘çš„æ ¹èŠ‚ç‚¹å½“å‰å·²ç»ç¡®è®¤äº† <span class="math inline">\(j\)</span> ä¸ªå„¿å­ï¼Œæœ€é å³çš„ä¸€ä¸ª siz <span class="math inline">\(\le k\)</span> çš„æ–¹æ¡ˆæ•°ã€‚å¾—åˆ° <span class="math inline">\(f_{i,j,k}=\sum_{x=0} f_{i-x\cdot k,j-x,k-1}\cdot \binom{f_{k,d-1,k}+x-1}{x}\)</span>ï¼ˆç›¸å½“äºå°† <span class="math inline">\(x\)</span> ä¸ªæ— æ ‡å·çš„ä½ç½® / çƒåˆ†é…ç»™ <span class="math inline">\(f_{k,d-1,k}\)</span> ä¸ªæœ‰æ ‡å·çš„é€‰é¡¹ / ç›’å­ï¼Œæ’æ¿å³å¯ï¼‰ã€‚</p>
<p>è‹¥ <span class="math inline">\(n\)</span> ä¸ºå¥‡æ•°ï¼Œåˆ™å¯ç›´æ¥è¾“å‡º <span class="math inline">\(f_{n,d,\lfloor\frac n2\rfloor}\)</span>ï¼›è‹¥ <span class="math inline">\(n\)</span> ä¸ºå¶æ•°ï¼Œåˆ™å¯èƒ½å­˜åœ¨ä¸¤ä¸ªé‡å¿ƒï¼Œå³éœ€è¦ç»Ÿè®¡æ‹¥æœ‰ä¸¤ä¸ªé‡å¿ƒï¼Œä¸”ä»¥ä¸¤ä¸ªé‡å¿ƒåˆ†åˆ«ä¸ºæ ¹æ—¶é•¿ç›¸ä¸åŒçš„æ ‘ç§ç±»ã€‚è¿™ç§æƒ…å†µä¸‹æ˜¾ç„¶å­˜åœ¨ä¸€æ¡è¾¹ï¼Œå·¦å³ä¸¤è¾¹ siz ç›¸åŒä¸”é•¿ç›¸ä¸åŒã€‚æ•…æ•°é‡ä¸º <span class="math inline">\(\binom{f_{\lfloor \frac n2\rfloor, d-1,\lfloor \frac n2\rfloor}}{2}\)</span>ï¼Œå®¹æ–¥æ‰å³å¯ã€‚</p>
<p>éœ€è¦ç‰¹åˆ¤ <span class="math inline">\(n\le2\)</span> çš„æƒ…å†µã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n, d, mod;
    std::cin &gt;&gt; n &gt;&gt; d &gt;&gt; mod;
    if (n &lt;= 2) &#123;
        std::cout &lt;&lt; 1 &lt;&lt; &#39;\n&#39;;
        return 0;
    &#125;
    using arr = std::vector&lt;long long&gt;;
    using brr = std::vector&lt;arr&gt;;
    using crr = std::vector&lt;brr&gt;;
    auto qkp = [&amp;](long long x, int y) &#123;
        auto res(1ll);
        for (; y; (x *= x) %= mod, y &gt;&gt;= 1)
            if (y &amp; 1)
                (res *= x) %= mod;
        return res;
    &#125;;
    arr inv(d + 1);
    inv[0] = inv[1] = 1ll;
    auto fac = 1ll;
    for (int i = 2; i &lt;= d; ++i) &#123;
        (fac *= i) %= mod;
        inv[i] = qkp(fac, mod - 2);
    &#125;
    auto C = [&amp;](long long n, int m) &#123;
        if (m == 0)
            return 1ll;
        if (m &gt; n)
            return 0ll;
        auto res(1ll);
        for (auto i = 0; i &lt; m; ++i)
            (res *= n - i) %= mod;
        return res * inv[m] % mod;
    &#125;;
    crr f(n + 1, brr(d + 1, arr(n / 2 + 1)));
    f[1][0][0] = 1ll;
    for (int i = 1; i &lt;= n; ++i)
        for (int j = 0; j &lt;= d &amp;&amp; 1 + j &lt;= i; ++j) &#123;
            for (int x = 0; x &lt;= j &amp;&amp; x &lt;= i; ++x)
                f[i][j][1] += f[i - x][j - x][0];
            f[i][j][1] %= mod;
            for (int k = 2; k &lt;= n / 2; ++k) &#123;
                // bool flag = (i == 10 &amp;&amp; j == 3 &amp;&amp; k == 3);
                for (int x = 0; x &lt;= j &amp;&amp; x * k &lt;= i; ++x) &#123;
                    f[i][j][k] += f[i - x * k][j - x][k - 1] * C(f[k][d - 1][k - 1] + x - 1, x);
                    // if (flag)
                    //     printf(&quot;x = %d, f[%d][%d][%d](%lld) * C(%lld, %d)(%lld)\n&quot;, x, i - x * k, j - x, k - 1, f[i - x * k][j - x][k - 1], f[k][d - 1][k - 1] + x - 1, x, C(f[k][d - 1][k - 1] + x - 1, x));
                &#125;
                f[i][j][k] %= mod;
            &#125;
        &#125;
    // for (int i = 1; i &lt;= n; ++i)
    //     for (int j = 0; j &lt;= d &amp;&amp; j &lt;= i - 1; ++j, puts(&quot;&quot;))
    //         for (int k = 0; k &lt;= n / 2; ++k) &#123;
    //             printf(&quot;f[%d][%d][%d] = %lld\n&quot;, i, j, k, f[i][j][k]);
    //         &#125;
    if (n &amp; 1)
        std::cout &lt;&lt; f[n][d][n / 2] &lt;&lt; &#39;\n&#39;;
    else &#123;
        auto res(f[n][d][n / 2]);
        res = (res + mod - C(f[n / 2][d - 1][n / 2 - 1], 2)) % mod;
        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    &#125;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="a---dominant-indices">A - Dominant Indices</h2>
<p><a target="_blank" rel="noopener" href="https://codeforces.com/problemset/problem/1009/F" class="uri">https://codeforces.com/problemset/problem/1009/F</a></p>
<p>é•¿å‰–æ¿å­ï¼›éš¾ç‚¹åœ¨äºå¯èƒ½è¦å¤ä¹ ä¸€ä¸‹é•¿å‰–æ€ä¹ˆå†™ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);
    for (int i = 1, x, y; i &lt; n; ++i) &#123;
        std::cin &gt;&gt; x &gt;&gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &#125;
    std::vector&lt;int&gt; h(n + 1), son(n + 1);
    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;
        h[x] = 1;
        for (auto i : g[x])
            if (i != fa) &#123;
                DFS(i, x);
                h[x] = std::max(h[x], h[i] + 1);
                if (h[i] &gt; h[son[x]])
                    son[x] = i;
            &#125;
        return;
    &#125;;
    DFS(1, -1);
    std::vector&lt;int&gt; _f(2 * n + 1), res(n + 1);
    auto pos(_f.begin());
    std::vector&lt;decltype(pos)&gt; f(n + 1);
    DFS = [&amp;](int x, int fa) &#123;
        ++f[x][0];
        if (!son[x]) &#123;
            res[x] = 0;
            return;
        &#125;
        f[son[x]] = std::next(f[x]);
        DFS(son[x], x);
        int mx = -std::max(std::make_pair(f[x][res[son[x]] + 1], -(res[son[x]] + 1)), std::make_pair(1, 0)).second;
        for (auto i : g[x])
            if (i != fa &amp;&amp; i != son[x]) &#123;
                f[i] = pos, pos = std::next(pos, h[i] + 1);
                DFS(i, x);
                for (int j = 0; j &lt;= h[i]; ++j) &#123;
                    f[x][j + 1] += f[i][j];
                    if (j + 1 != mx &amp;&amp; std::make_pair(f[x][j + 1], -(j + 1)) &gt; std::make_pair(f[x][mx], -mx))
                        mx = j + 1;
                &#125;
            &#125;
        // printf(&quot;%d: &quot;, x);
        // for (int i = 0; i &lt;= h[x]; ++i)
        //     printf(&quot;%d &quot;, f[x][i]);
        // puts(&quot;&quot;);
        res[x] = mx;
        return;
    &#125;;
    f[1] = pos, pos = std::next(pos, h[1]);
    DFS(1, -1);
    for (int i = 1; i &lt;= n; ++i)
        std::cout &lt;&lt; res[i] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="b---æ ‘ä¸Šå¼‚æˆ–">B - æ ‘ä¸Šå¼‚æˆ–</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P9745" class="uri">https://www.luogu.com.cn/problem/P9745</a></p>
<p>å’Œ <a href="#a---svjetlo">Svjetlo</a> å¾ˆåƒï¼ŒæŠŠè¿é€šå—çš„å¼‚æˆ–å’Œæ”¾åˆ°çŠ¶æ€é‡Œï¼Œæ‹†ä½åä»¤ <span class="math inline">\(f_{i,j,0/1}\)</span> è¡¨ç¤ºç‚¹ <span class="math inline">\(i\)</span> æ‰€åœ¨çš„è¿é€šå—åœ¨ç¬¬ <span class="math inline">\(j\)</span> ä½å¼‚æˆ–å’Œä¸º <span class="math inline">\(0/1\)</span> çš„æƒå€¼ï¼ˆ<strong>ä¸è®¡ <span class="math inline">\(i\)</span> æ‰€åœ¨è¿é€šå—</strong>ï¼‰ï¼Œè½¬ç§»å³å¯ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int mod = 998244353;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    std::vector&lt;long long&gt; a(n + 1);
    for (int i = 1; i &lt;= n; ++i)
        std::cin &gt;&gt; a[i];
    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);
    for (int i = 2, x; i &lt;= n; ++i) &#123;
        std::cin &gt;&gt; x;
        g[x].push_back(i), g[i].push_back(x);
    &#125;
    std::vector&lt;long long&gt; dp(n + 1);
    std::vector&lt;std::array&lt;std::array&lt;long long, 2&gt;, 60&gt; &gt; f(n + 1);
    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;
        for (int i = 0; i &lt; 60; ++i)
            f[x][i][(a[x] &gt;&gt; i) &amp; 1] = 1ll;
        for (auto i : g[x])
            if (i != fa) &#123;
                DFS(i, x);
                for (int j = 0; j &lt; 60; ++j) &#123;
                    auto f1 = f[x][j];
                    f[x][j][0] = (f1[0] * dp[i] % mod + f1[0] * f[i][j][0] % mod + f1[1] * f[i][j][1] % mod) % mod;
                    f[x][j][1] = (f1[1] * dp[i] % mod + f1[0] * f[i][j][1] % mod + f1[1] * f[i][j][0] % mod) % mod;
                &#125;
            &#125;
        for (int i = 0; i &lt; 60; ++i)
            dp[x] += (1ll &lt;&lt; i) % mod * f[x][i][1] % mod;
        dp[x] %= mod;
        return;
    &#125;;
    DFS(1, -1);
    std::cout &lt;&lt; dp[1] &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="c---ä¸€ä¸ªç½‘çš„è·¯">C - ä¸€ä¸ªç½‘çš„è·¯</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P8595" class="uri">https://www.luogu.com.cn/problem/P8595</a></p>
<p>é¦–å…ˆéœ€è¦æ„è¯†åˆ°ï¼Œæ ‘å’Œé“¾çš„è¾¹æ•°æ˜¯ä¸€æ ·çš„ï¼Œç‚¸æ‰äº†å¤šå°‘æ¡è¾¹ï¼Œåœ¨ä¹‹åå°±ä¼šèŠ±å¤šå°‘ä»£ä»·è¡¥å›æ¥ã€‚æ•…ç‚¸ä¸€ä¸ªç‚¹çš„ä»£ä»·ä¸ºåº¦æ•° +1ã€‚å¯¹äºä¸€ä¸ªç‚¹ <span class="math inline">\(u\)</span>ï¼Œåˆ†ä¸ºå››ç§å¯èƒ½æ€§ï¼š</p>
<ul>
<li>è¢«ç‚¸äº†ï¼Œå•ç‹¬ä½œä¸ºä¸€ä¸ªè¿é€šå—ã€‚</li>
<li>æ²¡è¢«ç‚¸ï¼Œå„¿å­å…¨éƒ¨è¢«ç‚¸äº†ã€‚</li>
<li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 1 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li>
<li>æ²¡è¢«ç‚¸ï¼Œæœ‰ 2 ä¸ªå„¿å­æ²¡è¢«ç‚¸ã€‚</li>
</ul>
<p>åˆ†åˆ«ç”¨ <span class="math inline">\(f_{u,0/1/2/3}\)</span> ä»£è¡¨ä¸Šé¢å››ç§å¯èƒ½æ€§ï¼Œè½¬ç§»å³å¯ã€‚</p>
<p>è´ºäº†ä¸ª freadï¼Œæ“¦è¾¹è·‘è¿‡äº†ã€‚è¿™ä¸ªä¸æ˜¯ <span class="math inline">\(O(n)\)</span> çš„å—ï¼Ÿ</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const int LEN = (1 &lt;&lt; 20);
#ifdef ONLINE_JUDGE
int nec(void) &#123;
    static char buf[LEN], *p = buf, *e = buf;
    if (p == e) &#123;
        e = buf + fread(buf, 1, LEN, stdin);
        if (e == buf) return EOF;
        p = buf;
    &#125;
    return *p++;
&#125;
#else
#define nec getchar

#endif
bool read(int &amp;x) &#123;
    x = 0;
    bool f = 0;
    char ch = nec();
    while (ch &lt; &#39;0&#39; || ch &gt; &#39;9&#39;) &#123;
        if (ch == EOF) return 0;
        if (ch == &#39;-&#39;) f = 1;
        ch = nec();
    &#125;
    while (ch &gt;= &#39;0&#39; &amp;&amp; ch &lt;= &#39;9&#39;) &#123;
        x = x * 10 + ch - &#39;0&#39;;
        ch = nec();
    &#125;
    if (f) x = -x;
    return 1;
&#125;
void print(int x) &#123;
    if (x &lt; 0)
        putchar(&#39;-&#39;), x = -x;
    if (x &gt;= 10) print(x / 10);
    putchar(x % 10 + &#39;0&#39;);
    return;
&#125;
void print(int x, char ch) &#123;
    print(x), putchar(ch);
    return;
&#125;
int main() &#123;
    int n, m;
    read(n), read(m);
    int res = (n - 1) - m;
    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);
    for (int x, y; m--; ) &#123;
        read(x), read(y);
        g[x].push_back(y), g[y].push_back(x);
    &#125;
    std::vector&lt;int&gt; tag(n + 1);
    std::vector&lt;std::array&lt;int, 4&gt; &gt; f(n + 1);
    std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;
        tag[x] = 1;
        f[x][0] = (fa != -1) + 1;
        f[x][2] = f[x][3] = 0x3f3f3f3f;
        for (auto i : g[x])
            if (i != fa) &#123;
                DFS(i, x);
                f[x][3] = std::min(f[x][3] + f[i][0], f[x][2] + std::min(f[i][1], f[i][2]));
                f[x][2] = std::min(f[x][2] + f[i][0], f[x][1] + std::min(f[i][1], f[i][2]));
                f[x][1] += f[i][0];
                f[x][0] += std::min(&#123; f[i][0] - 1, f[i][1], f[i][2], f[i][3] &#125;) + 1;
            &#125;
        return;
    &#125;;
    for (int i = 1; i &lt;= n; ++i)
        if (!tag[i]) &#123;
            DFS(i, -1);
            res += *std::min_element(f[i].begin(), f[i].end());
        &#125;
    print(res, &#39;\n&#39;);
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="d---éšæœºæ ‘">D - éšæœºæ ‘</h2>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3830" class="uri">https://www.luogu.com.cn/problem/P3830</a></p>
<p>å¯¹äºç¬¬ä¸€é—®ï¼Œä»¤ <span class="math inline">\(f_x\)</span> è¡¨ç¤ºå…±æœ‰ <span class="math inline">\(x\)</span> ä¸ªå¶å­æ—¶çš„æœŸæœ›æ·±åº¦ï¼Œä¸¤ä¸ªæ–°å¶å­çš„æœŸæœ›æ·±åº¦ä¸º <span class="math inline">\(f_{x-1}+1\)</span>ï¼Œdelta ä¸º <span class="math inline">\(f_{x-1}+2\)</span>ï¼Œæ•…æœ‰ <span class="math inline">\(f_x=\dfrac {(x-1)f_{x-1}+f_{x-1}+2}x\)</span>ï¼Œé€’æ¨å³å¯ã€‚</p>
<p>å¯¹äºç¬¬äºŒé—®ï¼Œä»¤ <span class="math inline">\(f_{x,k}\)</span> è¡¨ç¤ºæœ‰ <span class="math inline">\(x\)</span> ä¸ªå¶å­ï¼Œæ·±åº¦ <span class="math inline">\(\ge k\)</span> çš„æ¦‚ç‡ï¼ˆä¸€ç§ç†è§£æ˜¯ä»æ•´æ•°æ¦‚ç‡å…¬å¼çš„è§’åº¦å‡ºå‘ï¼‰ã€‚åˆ™è€ƒè™‘æšä¸¾å·¦ã€å³å¶å­æ•°ï¼Œå¯¹äºå·¦ä¾§å¶å­æ•°ä¸º <span class="math inline">\(i\)</span> çš„æƒ…å†µï¼Œ<strong>ä¸ºäº†å»é‡ï¼Œåªé€‰æ‹©æ·±åº¦ä¸º <span class="math inline">\(k-1\)</span> çš„å¶å­å±•å¼€</strong>ã€‚åªè€ƒè™‘æŸç§ç»„åˆçš„å‡ºç°æ¦‚ç‡ï¼Œä¸º <span class="math inline">\(f_{i,k-1}+f_{x-i,k-1}-f_{i,k-1}\cdot f_{x-i,k-1}\)</span>ã€‚æ•°å½’å¯ä»¥è¯æ˜ï¼Œå¯¹äºä»»æ„ <span class="math inline">\(i\)</span>ï¼Œæ·±åº¦ä¸º <span class="math inline">\(k-1\)</span> çš„å¶å­è¢«é€‰ä¸­çš„æ¦‚ç‡å‡ä¸º <span class="math inline">\(\dfrac 1{x-1}\)</span>ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int q, n;
    std::cin &gt;&gt; q &gt;&gt; n;
    std::cout &lt;&lt; std::fixed &lt;&lt; std::setprecision(6);
    if (q == 1) &#123;
        std::vector&lt;double&gt; f(n + 1);
        for (int i = 2; i &lt;= n; ++i)
            f[i] = (f[i - 1] * (i - 1) + f[i - 1] + 2.) / i;
        std::cout &lt;&lt; f[n] &lt;&lt; &#39;\n&#39;;
    &#125;
    else &#123;
        std::vector&lt;std::vector&lt;double&gt; &gt; f(n + 1, std::vector&lt;double&gt; (n + 1));
        for (int i = 1; i &lt;= n; ++i) &#123;
            f[i][0] = 1.;
            for (int j = 1; j &lt; i; ++j) &#123;
                auto s(0.);
                for (int k = 1; k &lt; i; ++k)
                    s += f[k][j - 1] + f[i - k][j - 1] - f[k][j - 1] * f[i - k][j - 1];
                f[i][j] = s / (i - 1);
            &#125;
        &#125;
        auto res(0.);
        for (int i = 1; i &lt; n; ++i)
            res += f[n][i];
        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    &#125;
    return 0;
&#125;</code></pre>
</details>
<hr />
<h2 id="e---complete-compress">E - Complete Compress</h2>
<p><a target="_blank" rel="noopener" href="https://atcoder.jp/contests/agc034/tasks/agc034_e" class="uri">https://atcoder.jp/contests/agc034/tasks/agc034_e</a></p>
<p>å¯¹äºé“¾ï¼Œå‘ç°å¯ä»¥æšä¸¾æœ€åèšé›†çš„ç‚¹ï¼Œç­”æ¡ˆä¸é…å¯¹æ–¹å¼æ— å…³ï¼Œcheck æ˜¯å¦èƒ½é…å¯¹å³å¯ã€‚</p>
<p>å¦‚æœä¸æ˜¯é“¾ï¼Œåˆ™ç›¸æ¯”é“¾ï¼Œè¿˜å¯ä»¥é€‰æ‹©åŒä¸€å­æ ‘ä¸­ä¸å­˜åœ¨ç¥–å­™å…³ç³»çš„ä¸¤ä¸ªç‚¹ï¼Œå°†å®ƒä»¬éƒ½å‘ LCA ç§»ä¸€æ­¥ã€‚</p>
<p>æ•…è€Œï¼Œå¯ä»¥åœ¨é“¾çš„åšæ³•ä¸Šæ‰“ä¸€ä¸ªè¡¥ä¸ï¼Œè§‚å¯Ÿåˆ°å…ˆã€å†…éƒ¨æ¶ˆåŒ–ã€ï¼Œå†åœ¨å­æ ‘é—´é…å¯¹ä¸€å®šä¸åŠ£ï¼Œä¸”ç­”æ¡ˆä»ç„¶å’Œé…å¯¹æ–¹å¼æ— å…³ã€‚æ•…ä»¤ <span class="math inline">\(f_x\)</span> è¡¨ç¤ºç‚¹ <span class="math inline">\(x\)</span> å†…æœ€å¤šæ¶ˆæ‰å¤šå°‘å¯¹ï¼Œå°±å¯ä»¥ check äº†ã€‚</p>
<details>
<pre class="cpp"><code>#include &lt;bits/stdc++.h&gt;
const long long inf = 1e18;
int main() &#123;
#ifdef ONLINE_JUDGE
    std::ios::sync_with_stdio(false);
    std::cin.tie(nullptr), std::cout.tie(nullptr);
#else
    std::freopen(&quot;line_02.in&quot;, &quot;r&quot;, stdin);
    std::freopen(&quot;.out&quot;, &quot;w&quot;, stdout);
#endif
    int n;
    std::cin &gt;&gt; n;
    std::vector&lt;int&gt; a(n + 1);
    for (int i = 1; i &lt;= n; ++i) &#123;
        char t;
        std::cin &gt;&gt; t;
        a[i] = t - &#39;0&#39;;
    &#125;
    std::vector&lt;std::vector&lt;int&gt; &gt; g(n + 1);
    for (int i = 1, x, y; i &lt; n; ++i) &#123;
        std::cin &gt;&gt; x &gt;&gt; y;
        g[x].push_back(y), g[y].push_back(x);
    &#125;
    auto res(inf);
    for (int i = 1; i &lt;= n; ++i) &#123;
        std::vector&lt;int&gt; s(n + 1);
        std::vector&lt;long long&gt; f(n + 1), cnt(n + 1);
        std::function&lt;void(int, int)&gt; DFS = [&amp;](int x, int fa) &#123;
            s[x] = a[x];
            int son = 0;
            auto sum(0ll);
            for (auto i : g[x])
                if (i != fa) &#123;
                    DFS(i, x), s[x] += s[i];
                    sum += cnt[i];
                    if (cnt[i] &gt; cnt[son])
                        son = i;
                &#125;
            if (son) &#123;
                if (cnt[son] * 2 &lt;= sum)
                    f[x] = sum / 2;
                else
                    f[x] = sum - cnt[son] + std::min(f[son], (cnt[son] - (sum - cnt[son])) / 2);
            &#125;
            cnt[x] = sum;
            if (x != i)
                cnt[x] += s[x];
            return;
        &#125;;
        DFS(i, -1);
        if (cnt[i] % 2 == 0 &amp;&amp; f[i] == cnt[i] / 2)
            res = std::min(res, cnt[i] / 2);
    &#125;
    if (res == inf)
        std::cout &lt;&lt; -1 &lt;&lt; &#39;\n&#39;;
    else
        std::cout &lt;&lt; res &lt;&lt; &#39;\n&#39;;
    return 0;
&#125;</code></pre>
</details>

			</div>
			<hr class="dotted">
			<div class="post footer">
				<div id="hitokoto">
					<h3 id="hitokoto-title">
						è¨€è®º
					</h3>
					<div id="hitokoto-content">
					</div>
					<div id="hitokoto-from">
					</div>
				</div>
				<div class="button flex">
					<div id="prev">
						
							<!-- åæ§½ï¼Œä¸ºå•¥è¿˜éœ€è¦åŠ  / -->
							<a href="/20250805/">
								<i class="fas fa-angle-double-left" style="margin-right: 10px;"></i>
								çŠ¶å‹ DP
							</a>
						
					</div>
					<div id="next">
						
							<a href="/20250723/">
								vp è®°å½• edu 181
								<i class="fas fa-angle-double-right" style="margin-left: 10px;"></i>
							</a>
						
					</div>
				</div>
				<div id="vcomments" class="text"></div>
<script>
	new Valine({
		el: '#vcomments',
		appId: 'OlmvQ0a2Zw7xo3no2bwabOzx-gzGzoHsz',
		appKey: 'TW6t8mFeGLmhPjWisvmllvvo',
		recordIP: true,
		enableQQ: true, 
		// [EDITED] ç›®å‰ Valine çš„ QQ è‡ªåŠ¨è·å–æ˜µç§°ä¼¼ä¹ä¸å¯ç”¨
		// è¯¥é—®é¢˜åœ¨ v1.5.3 ä¸­å·²ä¿®å¤
		pageSize: 10,
		requiredFields:
			
				['nick']
			,
		placeholder: "The world is but a little place after all...\nèƒ½å¤Ÿæ ¹æ®é‚®ç®±è·å–ä½ çš„ Gravatar å¤´åƒã€‚æ˜µç§°æ˜¯å¿…å¡«é¡¹ï¼Œé•¿åº¦éœ€ä¸ä½äº 3ã€‚",
		avatar: 'identicon',
		avatar_cdn: 'https://cravatar.cn/avatar/',
		emojiCDN: 'https://xsc062.netlify.app/em/', 
		emojiMaps: {
			
				"å¾®ç¬‘": "wx.gif",
			
				"é¾‡ç‰™": "cy.gif",
			
				"æµæ³ª": "ll.gif",
			
				"ç¬‘å“­": "xk.gif",
			
				"æµæ±—": "lh.gif",
			
				"æ“¦æ±—": "ch.gif",
			
				"äº²äº²": "qq.gif",
			
				"è‰²": "se.gif",
			
				"ç–‘é—®": "yiw.gif",
			
				"å‘å‘†": "fd.gif",
			
				"æ™•": "yun.gif",
			
				"é¼“æŒ": "gz.gif",
			
				"æ†¨ç¬‘": "hanx.gif",
			
				"å¿«å“­äº†": "kk.gif",
			
				"å¾—æ„": "dy.gif",
			
				"ç‹‚ç¬‘": "kx.gif",
			
				"å®³ç¾": "hx.gif",
			
				"å¦ˆå¦ˆç”Ÿçš„": "dz.gif",
			
				"ç³—å¤§äº†": "qd.gif",
			
				"åƒç“œ": "cg.gif",
			
				"ççœ¼": "zy.webp",
			
				"è¾£çœ¼ç›": "lyj.gif",
			
				"é…¸äº†": "nm.gif",
			
				"æ»š": "gun.webp",
			
				"æƒŠæ": "jk.gif",
			
				"å¹½çµ": "youl.gif",
			
				"æ— èŠ": "wul.gif",
			
				"åƒ": "eat.gif",
			
				"ä½ å¾ˆæ£’æ£’": "bb.gif",
			
				"èµ": "qiang.gif",
			
				"è¸©": "ruo.gif",
			
				"æ¡æ‰‹": "wsh.gif",
			
				"å‘æŠ–": "fad.gif",
			
				"æŒ¥æ‰‹": "hsh.gif",
			
				"ç£•å¤´": "kt.gif",
			
				"æ€„ç«": "oh.gif",
			
		},
	})
</script>
			</div>
			<script>setHitokoto();</script>
		</div> 
	</div>
</div>
    <!-- é¡µè„šå¼€å§‹ -->
<div id="footer" class="serif">
    Powered by
    <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a>
    &
    <a href="/about-this-theme">
        iwll
    </a>
    <p style="margin-top: 5px;">
        2021 - 2025
    </p>
    <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" id="CCTAG"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg"></a>
</div>
<!-- Valine ç›¸å…³é…ç½® -->
<script>
    const getValineDomTimer = setInterval(() => {
        // ä¸çŸ¥é“ä¸ºä»€ä¹ˆ æˆ‘ä»åŸåšå®¢ js æ–‡ä»¶ç²˜è¿‡æ¥çš„å‚æ•°æ˜¯
        // "#valine .vcards .vcard"
        // DEBUG äº†åŠå¤©æ‰å®šä½åˆ°è¿™ä¸ªé—®é¢˜ã€‚ã€‚ã€‚
        const vcards =
            document.querySelectorAll('#valine, .vcards, .vcard');
        if (vcards.length > 0) {
            let author = 'XSC062';
            for (let vcard of vcards) {
                const vnick_dom = vcard.querySelector('.vhead .vnick');
                if (vnick_dom != null) {
                    const vnick = vnick_dom.innerHTML;
                    if (vnick === author) {
                        vnick_dom.innerHTML =
                        `${vnick} <span id="rootitem" class="code">root</span>`
                    }
                }
            }
        }
        else {
            clearInterval(getValineDomTimer);
        }
    }, 2000);
    SetActiveItem();
    setDetailsSummary();
    setTitleAnchor();
    setEmptyToc();
    setCodeClassName();
</script>


<!-- js -->
<!-- æœç´¢åŠŸèƒ½ç›¸å…³é…ç½® -->

<script src="/js/search.js"></script>


<script src="/js/local-search.js"></script>

</script>
<!-- prism ç›¸å…³é…ç½® -->
<script type="text/javascript" src="/js/prism.js" defer></script>
<!-- ä»£ç å—å¤åˆ¶åŠŸèƒ½ -->
<script type="text/javascript" src="/js/clipboard.min.js"></script>
<script type="text/javascript" src="/js/clipboard-use.js"></script>
<!-- é¡µè„šç»“æŸ -->
</body>
</html>